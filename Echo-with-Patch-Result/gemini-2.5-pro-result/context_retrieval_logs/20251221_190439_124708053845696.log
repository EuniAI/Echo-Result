2025-12-21 19:04:39,135 - thread-124708053845696.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Complement doesn't work when input is a mixture of Symbols and numbers

Description: ```
>>> a=FiniteSet(x,y,2)
>>> b=Interval(-10,10)
>>> Complement(a,b)
{x, y}
```
`{x, y} \ [-10,10]` is expected as output.

Patch information:
diff --git a/sympy/sets/sets.py b/sympy/sets/sets.py
index 917717bb74..7a6e87d043 100644
--- a/sympy/sets/sets.py
+++ b/sympy/sets/sets.py
@@ -217,7 +217,60 @@ def _complement(self, other):
             return S.EmptySet
 
         elif isinstance(other, FiniteSet):
-            return FiniteSet(*[el for el in other if self.contains(el) != True])
+            if isinstance(self, FiniteSet):
+                # both are FiniteSet: use exact membership and prune RHS
+                inter = self._elements & other._elements
+                A_rem = [e for e in other._elements if e not in inter]
+                B_rem = [e for e in self._elements if e not in inter]
+                outside = []
+                unknown = []
+                if not B_rem:
+                    outside = list(A_rem)
+                else:
+                    for a in A_rem:
+                        if all(sympify(Eq(a, b)) is S.false for b in B_rem):
+                            outside.append(a)
+                        else:
+                            unknown.append(a)
+                # prune RHS to only elements possibly equal to unknowns
+                if unknown:
+                    pruned_rhs = []
+                    for b in B_rem:
+                        if not all(sympify(Eq(u, b)) is S.false for u in unknown):
+                            pruned_rhs.append(b)
+                else:
+                    pruned_rhs = []
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), FiniteSet(*pruned_rhs), evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+            else:
+                outside = []
+                unknown = []
+                for el in other:
+                    ret = sympify(self.contains(el))
+                    if ret is S.true:
+                        continue
+                    elif ret is S.false:
+                        outside.append(el)
+                    else:
+                        unknown.append(el)
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), self, evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
 
     def symmetric_difference(self, other):
         """
@@ -1725,6 +1778,60 @@ def reduce(A, B):
         if isinstance(B, Union):
             return Intersection(s.complement(A) for s in B.args)
 
+        # Handle FiniteSet minuend by removing definite members and
+        # keeping indeterminate membership as an unevaluated Complement
+        if isinstance(A, FiniteSet):
+            outside = []
+            unknown = []
+            if isinstance(B, FiniteSet):
+                inter = A._elements & B._elements
+                A_rem = [e for e in A._elements if e not in inter]
+                B_rem = [e for e in B._elements if e not in inter]
+                if not B_rem:
+                    outside = list(A_rem)
+                else:
+                    for a in A_rem:
+                        if all(sympify(Eq(a, b)) is S.false for b in B_rem):
+                            outside.append(a)
+                        else:
+                            unknown.append(a)
+                if unknown:
+                    pruned_rhs = []
+                    for b in B_rem:
+                        if not all(sympify(Eq(u, b)) is S.false for u in unknown):
+                            pruned_rhs.append(b)
+                else:
+                    pruned_rhs = []
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), FiniteSet(*pruned_rhs), evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+            else:
+                for el in A:
+                    ret = sympify(B.contains(el))
+                    if ret is S.true:
+                        continue
+                    elif ret is S.false:
+                        outside.append(el)
+                    else:
+                        unknown.append(el)
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), B, evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+
         result = B._complement(A)
         if result != None:
             return result


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 19:04:39,203 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── python-comparisons.rst
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── ffunctions.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_ffunctions.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_eval_power.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_1_2.py
    |   |   |   ├── test_1_3.py
    |   |   |   ├── test_1_4.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   ├── sympy_tokenize.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── unitsystems.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   └── test_theanocode.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       └── test_mutable_ndim_array.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_functions.py
    |       ├── test_index_methods.py
    |       ├── test_indexed.py
    |       └── test_tensor.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   └── timeutils.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Complement doesn't work when input is a mixture of Symbols and numbers

Description: ```
>>> a=FiniteSet(x,y,2)
>>> b=Interval(-10,10)
>>> Complement(a,b)
{x, y}
```
`{x, y} \ [-10,10]` is expected as output.

Patch information:
diff --git a/sympy/sets/sets.py b/sympy/sets/sets.py
index 917717bb74..7a6e87d043 100644
--- a/sympy/sets/sets.py
+++ b/sympy/sets/sets.py
@@ -217,7 +217,60 @@ def _complement(self, other):
             return S.EmptySet
 
         elif isinstance(other, FiniteSet):
-            return FiniteSet(*[el for el in other if self.contains(el) != True])
+            if isinstance(self, FiniteSet):
+                # both are FiniteSet: use exact membership and prune RHS
+                inter = self._elements & other._elements
+                A_rem = [e for e in other._elements if e not in inter]
+                B_rem = [e for e in self._elements if e not in inter]
+                outside = []
+                unknown = []
+                if not B_rem:
+                    outside = list(A_rem)
+                else:
+                    for a in A_rem:
+                        if all(sympify(Eq(a, b)) is S.false for b in B_rem):
+                            outside.append(a)
+                        else:
+                            unknown.append(a)
+                # prune RHS to only elements possibly equal to unknowns
+                if unknown:
+                    pruned_rhs = []
+                    for b in B_rem:
+                        if not all(sympify(Eq(u, b)) is S.false for u in unknown):
+                            pruned_rhs.append(b)
+                else:
+                    pruned_rhs = []
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), FiniteSet(*pruned_rhs), evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+            else:
+                outside = []
+                unknown = []
+                for el in other:
+                    ret = sympify(self.contains(el))
+                    if ret is S.true:
+                        continue
+                    elif ret is S.false:
+                        outside.append(el)
+                    else:
+                        unknown.append(el)
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), self, evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
 
     def symmetric_difference(self, other):
         """
@@ -1725,6 +1778,60 @@ def reduce(A, B):
         if isinstance(B, Union):
             return Intersection(s.complement(A) for s in B.args)
 
+        # Handle FiniteSet minuend by removing definite members and
+        # keeping indeterminate membership as an unevaluated Complement
+        if isinstance(A, FiniteSet):
+            outside = []
+            unknown = []
+            if isinstance(B, FiniteSet):
+                inter = A._elements & B._elements
+                A_rem = [e for e in A._elements if e not in inter]
+                B_rem = [e for e in B._elements if e not in inter]
+                if not B_rem:
+                    outside = list(A_rem)
+                else:
+                    for a in A_rem:
+                        if all(sympify(Eq(a, b)) is S.false for b in B_rem):
+                            outside.append(a)
+                        else:
+                            unknown.append(a)
+                if unknown:
+                    pruned_rhs = []
+                    for b in B_rem:
+                        if not all(sympify(Eq(u, b)) is S.false for u in unknown):
+                            pruned_rhs.append(b)
+                else:
+                    pruned_rhs = []
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), FiniteSet(*pruned_rhs), evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+            else:
+                for el in A:
+                    ret = sympify(B.contains(el))
+                    if ret is S.true:
+                        continue
+                    elif ret is S.false:
+                        outside.append(el)
+                    else:
+                        unknown.append(el)
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), B, evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+
         result = B._complement(A)
         if result != None:
             return result


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:05:05,906 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a bug related to the `Complement` of `FiniteSet` objects. The patch is in `sympy/sets/sets.py`. To find relevant tests, I need to examine the corresponding test file, which is `sympy/sets/tests/test_sets.py`. The current context is empty, so I need to request this file.' query='Please provide the full content of sympy/sets/tests/test_sets.py.' extra_requirements='' purpose='I need the content of the test file to identify existing test cases that cover `Complement` operations on `FiniteSet`s, which is necessary to find analogous tests for the reported bug.'
2025-12-21 19:05:05,907 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of sympy/sets/tests/test_sets.py.
2025-12-21 19:05:05,907 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 19:05:05,908 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 19:05:05,910 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 19:05:05,910 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of sympy/sets/tests/test_sets.py.
Purpose: I need the content of the test file to identify existing test cases that cover `Complement` operations on `FiniteSet`s, which is necessary to find analogous tests for the reported bug.
2025-12-21 19:05:08,678 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will read the full content of the `sympy/sets/tests/test_sets.py` file. This will allow me to identify existing test cases that cover `Complement` operations on `FiniteSet`s, which is necessary to find analogous tests for the reported bug.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/sets/tests/test_sets.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2112, 'candidates_token_count': 82, 'total_token_count': 2345, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2112}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 151, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13252387395719203, 'model_name': 'gemini-2.5-pro'} id='run--0098990c-d67d-409f-9c52-ffefbbc9b621-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/sets/tests/test_sets.py'}, 'id': '64806d46-ce19-4bbf-97fd-6234170d1dd5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2112, 'output_tokens': 82, 'total_tokens': 2345, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 151}}
2025-12-21 19:05:10,733 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the initial 500 lines of the requested test file. I will now proceed to fetch the remaining content to provide you with the complete file.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "sympy/sets/tests/test_sets.py", "start_line": 501.0, "end_line": 1000.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11995, 'candidates_token_count': 64, 'total_token_count': 12100, 'cached_content_token_count': 1893, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11995}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1893}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 41}, 'finish_reason': 'STOP', 'avg_logprobs': -0.14166294038295746, 'model_name': 'gemini-2.5-pro'} id='run--8200277c-c948-44a1-ac04-f785da378be8-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'sympy/sets/tests/test_sets.py', 'start_line': 501.0, 'end_line': 1000.0}, 'id': '26d8112c-ce9b-4828-9086-534ad8932d5d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11995, 'output_tokens': 64, 'total_tokens': 12100, 'input_token_details': {'cache_read': 1893}, 'output_token_details': {'reasoning': 41}}
2025-12-21 19:05:12,468 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the first 1000 lines of the test file. I will now fetch the remaining content to provide you with the complete file.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "sympy/sets/tests/test_sets.py", "start_line": 1001.0, "end_line": 1500.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21397, 'candidates_token_count': 63, 'total_token_count': 21460, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21397}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 63}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.05852081283690438, 'model_name': 'gemini-2.5-pro'} id='run--7620a11d-63ee-4b4b-bd38-aebfbffd3538-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'sympy/sets/tests/test_sets.py', 'start_line': 1001.0, 'end_line': 1500.0}, 'id': '542bb72a-c72b-44dd-aff2-273ec0a9747f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21397, 'output_tokens': 63, 'total_tokens': 21460, 'input_token_details': {'cache_read': 0}}
2025-12-21 19:05:13,677 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now retrieved the entire content of `sympy/sets/tests/test_sets.py`. The full file is now available for review to identify test cases related to `Complement` operations on `FiniteSet`s.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22537, 'candidates_token_count': 46, 'total_token_count': 22583, 'cached_content_token_count': 19450, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22537}], 'cache_tokens_details': [{'modality': 1, 'token_count': 19450}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 46}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1958269036334494, 'model_name': 'gemini-2.5-pro'} id='run--eb7594a9-02b6-4d8f-b13b-ba9cce62ce49-0' usage_metadata={'input_tokens': 22537, 'output_tokens': 46, 'total_tokens': 22583, 'input_token_details': {'cache_read': 19450}}
2025-12-21 19:05:13,679 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of sympy/sets/tests/test_sets.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need the content of the test file to identify existing test cases that cover `Complement` operations on `FiniteSet`s, which is necessary to find analogous tests for the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/sets/tests/test_sets.py
Line number range: 1 - 500
Content:
1. from sympy import (Symbol, Set, Union, Interval, oo, S, sympify, nan,
2.     GreaterThan, LessThan, Max, Min, And, Or, Eq, Ge, Le, Gt, Lt, Float,
3.     FiniteSet, Intersection, imageset, I, true, false, ProductSet, E,
4.     sqrt, Complement, EmptySet, sin, cos, Lambda, ImageSet, pi,
5.     Eq, Pow, Contains, Sum, rootof, SymmetricDifference, Piecewise,
6.     Matrix, signsimp, Range)
7. from mpmath import mpi
8. 
9. from sympy.core.compatibility import range
10. from sympy.utilities.pytest import raises, XFAIL
11. 
12. from sympy.abc import x, y, z, m, n
13. 
14. 
15. def test_imageset():
16.     ints = S.Integers
17.     raises(TypeError, lambda: imageset(x, ints))
18.     raises(ValueError, lambda: imageset(x, y, z, ints))
19.     raises(ValueError, lambda: imageset(Lambda(x, cos(x)), y))
20.     assert imageset(cos, ints) == ImageSet(Lambda(x, cos(x)), ints)
21.     def f(x):
22.         return cos(x)
23.     raises(TypeError, lambda: imageset(f, ints))
24.     f = lambda x: cos(x)
25.     assert imageset(f, ints) == ImageSet(Lambda(x, cos(x)), ints)
26.     assert imageset(x, 1, ints) == FiniteSet(1)
27.     assert imageset(x, y, ints) == FiniteSet(y)
28.     assert (str(imageset(lambda y: x + y, Interval(-2, 1)).lamda.expr)
29.         in ('_x + x', 'x + _x'))
30. 
31. 
32. def test_interval_arguments():
33.     assert Interval(0, oo) == Interval(0, oo, False, True)
34.     assert Interval(0, oo).right_open is true
35.     assert Interval(-oo, 0) == Interval(-oo, 0, True, False)
36.     assert Interval(-oo, 0).left_open is true
37.     assert Interval(oo, -oo) == S.EmptySet
38.     assert Interval(oo, oo) == S.EmptySet
39.     assert Interval(-oo, -oo) == S.EmptySet
40. 
41.     assert isinstance(Interval(1, 1), FiniteSet)
42.     e = Sum(x, (x, 1, 3))
43.     assert isinstance(Interval(e, e), FiniteSet)
44. 
45.     assert Interval(1, 0) == S.EmptySet
46.     assert Interval(1, 1).measure == 0
47. 
48.     assert Interval(1, 1, False, True) == S.EmptySet
49.     assert Interval(1, 1, True, False) == S.EmptySet
50.     assert Interval(1, 1, True, True) == S.EmptySet
51. 
52. 
53.     assert isinstance(Interval(0, Symbol('a')), Interval)
54.     assert Interval(Symbol('a', real=True, positive=True), 0) == S.EmptySet
55.     raises(ValueError, lambda: Interval(0, S.ImaginaryUnit))
56.     raises(ValueError, lambda: Interval(0, Symbol('z', real=False)))
57. 
58.     raises(NotImplementedError, lambda: Interval(0, 1, And(x, y)))
59.     raises(NotImplementedError, lambda: Interval(0, 1, False, And(x, y)))
60.     raises(NotImplementedError, lambda: Interval(0, 1, z, And(x, y)))
61. 
62. 
63. 
64. def test_interval_symbolic_end_points():
65.     a = Symbol('a', real=True)
66. 
67.     assert Union(Interval(0, a), Interval(0, 3)).sup == Max(a, 3)
68.     assert Union(Interval(a, 0), Interval(-3, 0)).inf == Min(-3, a)
69. 
70.     assert Interval(0, a).contains(1) == LessThan(1, a)
71. 
72. 
73. def test_union():
74.     assert Union(Interval(1, 2), Interval(2, 3)) == Interval(1, 3)
75.     assert Union(Interval(1, 2), Interval(2, 3, True)) == Interval(1, 3)
76.     assert Union(Interval(1, 3), Interval(2, 4)) == Interval(1, 4)
77.     assert Union(Interval(1, 2), Interval(1, 3)) == Interval(1, 3)
78.     assert Union(Interval(1, 3), Interval(1, 2)) == Interval(1, 3)
79.     assert Union(Interval(1, 3, False, True), Interval(1, 2)) == \
80.         Interval(1, 3, False, True)
81.     assert Union(Interval(1, 3), Interval(1, 2, False, True)) == Interval(1, 3)
82.     assert Union(Interval(1, 2, True), Interval(1, 3)) == Interval(1, 3)
83.     assert Union(Interval(1, 2, True), Interval(1, 3, True)) == \
84.         Interval(1, 3, True)
85.     assert Union(Interval(1, 2, True), Interval(1, 3, True, True)) == \
86.         Interval(1, 3, True, True)
87.     assert Union(Interval(1, 2, True, True), Interval(1, 3, True)) == \
88.         Interval(1, 3, True)
89.     assert Union(Interval(1, 3), Interval(2, 3)) == Interval(1, 3)
90.     assert Union(Interval(1, 3, False, True), Interval(2, 3)) == \
91.         Interval(1, 3)
92.     assert Union(Interval(1, 2, False, True), Interval(2, 3, True)) != \
93.         Interval(1, 3)
94.     assert Union(Interval(1, 2), S.EmptySet) == Interval(1, 2)
95.     assert Union(S.EmptySet) == S.EmptySet
96. 
97.     assert Union(Interval(0, 1), [FiniteSet(1.0/n) for n in range(1, 10)]) == \
98.         Interval(0, 1)
99. 
100.     assert Interval(1, 2).union(Interval(2, 3)) == \
101.         Interval(1, 2) + Interval(2, 3)
102. 
103.     assert Interval(1, 2).union(Interval(2, 3)) == Interval(1, 3)
104. 
105.     assert Union(Set()) == Set()
106. 
107.     assert FiniteSet(1) + FiniteSet(2) + FiniteSet(3) == FiniteSet(1, 2, 3)
108.     assert FiniteSet('ham') + FiniteSet('eggs') == FiniteSet('ham', 'eggs')
109.     assert FiniteSet(1, 2, 3) + S.EmptySet == FiniteSet(1, 2, 3)
110. 
111.     assert FiniteSet(1, 2, 3) & FiniteSet(2, 3, 4) == FiniteSet(2, 3)
112.     assert FiniteSet(1, 2, 3) | FiniteSet(2, 3, 4) == FiniteSet(1, 2, 3, 4)
113. 
114.     x = Symbol("x")
115.     y = Symbol("y")
116.     z = Symbol("z")
117.     assert S.EmptySet | FiniteSet(x, FiniteSet(y, z)) == \
118.         FiniteSet(x, FiniteSet(y, z))
119. 
120.     # Test that Intervals and FiniteSets play nicely
121.     assert Interval(1, 3) + FiniteSet(2) == Interval(1, 3)
122.     assert Interval(1, 3, True, True) + FiniteSet(3) == \
123.         Interval(1, 3, True, False)
124.     X = Interval(1, 3) + FiniteSet(5)
125.     Y = Interval(1, 2) + FiniteSet(3)
126.     XandY = X.intersect(Y)
127.     assert 2 in X and 3 in X and 3 in XandY
128.     assert XandY.is_subset(X) and XandY.is_subset(Y)
129. 
130.     raises(TypeError, lambda: Union(1, 2, 3))
131. 
132.     assert X.is_iterable is False
133. 
134.     # issue 7843
135.     assert Union(S.EmptySet, FiniteSet(-sqrt(-I), sqrt(-I))) == \
136.         FiniteSet(-sqrt(-I), sqrt(-I))
137. 
138.     assert Union(S.Reals, S.Integers) == S.Reals
139. 
140. 
141. def test_union_iter():
142.     # Use Range because it is ordered
143.     u = Union(Range(3), Range(5), Range(3), evaluate=False)
144. 
145.     # Round robin
146.     assert list(u) == [0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 4]
147. 
148. def test_difference():
149.     assert Interval(1, 3) - Interval(1, 2) == Interval(2, 3, True)
150.     assert Interval(1, 3) - Interval(2, 3) == Interval(1, 2, False, True)
151.     assert Interval(1, 3, True) - Interval(2, 3) == Interval(1, 2, True, True)
152.     assert Interval(1, 3, True) - Interval(2, 3, True) == \
153.         Interval(1, 2, True, False)
154.     assert Interval(0, 2) - FiniteSet(1) == \
155.         Union(Interval(0, 1, False, True), Interval(1, 2, True, False))
156. 
157.     assert FiniteSet(1, 2, 3) - FiniteSet(2) == FiniteSet(1, 3)
158.     assert FiniteSet('ham', 'eggs') - FiniteSet('eggs') == FiniteSet('ham')
159.     assert FiniteSet(1, 2, 3, 4) - Interval(2, 10, True, False) == \
160.         FiniteSet(1, 2)
161.     assert FiniteSet(1, 2, 3, 4) - S.EmptySet == FiniteSet(1, 2, 3, 4)
162.     assert Union(Interval(0, 2), FiniteSet(2, 3, 4)) - Interval(1, 3) == \
163.         Union(Interval(0, 1, False, True), FiniteSet(4))
164. 
165.     assert -1 in S.Reals - S.Naturals
166. 
167. 
168. def test_Complement():
169.     assert Complement(Interval(1, 3), Interval(1, 2)) == Interval(2, 3, True)
170.     assert Complement(FiniteSet(1, 3, 4), FiniteSet(3, 4)) == FiniteSet(1)
171.     assert Complement(Union(Interval(0, 2),
172.                             FiniteSet(2, 3, 4)), Interval(1, 3)) == \
173.         Union(Interval(0, 1, False, True), FiniteSet(4))
174. 
175.     assert not 3 in Complement(Interval(0, 5), Interval(1, 4), evaluate=False)
176.     assert -1 in Complement(S.Reals, S.Naturals, evaluate=False)
177.     assert not 1 in Complement(S.Reals, S.Naturals, evaluate=False)
178. 
179.     assert Complement(S.Integers, S.UniversalSet) == EmptySet()
180.     assert S.UniversalSet.complement(S.Integers) == EmptySet()
181. 
182.     assert (not 0 in S.Reals.intersect(S.Integers - FiniteSet(0)))
183. 
184.     assert S.EmptySet - S.Integers == S.EmptySet
185. 
186.     assert (S.Integers - FiniteSet(0)) - FiniteSet(1) == S.Integers - FiniteSet(0, 1)
187. 
188.     assert S.Reals - Union(S.Naturals, FiniteSet(pi)) == \
189.             Intersection(S.Reals - S.Naturals, S.Reals - FiniteSet(pi))
190. 
191. def test_complement():
192.     assert Interval(0, 1).complement(S.Reals) == \
193.         Union(Interval(-oo, 0, True, True), Interval(1, oo, True, True))
194.     assert Interval(0, 1, True, False).complement(S.Reals) == \
195.         Union(Interval(-oo, 0, True, False), Interval(1, oo, True, True))
196.     assert Interval(0, 1, False, True).complement(S.Reals) == \
197.         Union(Interval(-oo, 0, True, True), Interval(1, oo, False, True))
198.     assert Interval(0, 1, True, True).complement(S.Reals) == \
199.         Union(Interval(-oo, 0, True, False), Interval(1, oo, False, True))
200. 
201.     assert S.UniversalSet.complement(S.EmptySet) == S.EmptySet
202.     assert S.UniversalSet.complement(S.Reals) == S.EmptySet
203.     assert S.UniversalSet.complement(S.UniversalSet) == S.EmptySet
204. 
205.     assert S.EmptySet.complement(S.Reals) == S.Reals
206. 
207.     assert Union(Interval(0, 1), Interval(2, 3)).complement(S.Reals) == \
208.         Union(Interval(-oo, 0, True, True), Interval(1, 2, True, True),
209.               Interval(3, oo, True, True))
210. 
211.     assert FiniteSet(0).complement(S.Reals) ==  \
212.         Union(Interval(-oo, 0, True, True), Interval(0, oo, True, True))
213. 
214.     assert (FiniteSet(5) + Interval(S.NegativeInfinity,
215.                                     0)).complement(S.Reals) == \
216.         Interval(0, 5, True, True) + Interval(5, S.Infinity, True, True)
217. 
218.     assert FiniteSet(1, 2, 3).complement(S.Reals) == \
219.         Interval(S.NegativeInfinity, 1, True, True) + \
220.         Interval(1, 2, True, True) + Interval(2, 3, True, True) +\
221.         Interval(3, S.Infinity, True, True)
222. 
223.     assert FiniteSet(x).complement(S.Reals) == Complement(S.Reals, FiniteSet(x))
224. 
225.     assert FiniteSet(0, x).complement(S.Reals) == Complement(Interval(-oo, 0, True, True) +
226.                                                              Interval(0, oo, True, True)
227.                                                              ,FiniteSet(x), evaluate=False)
228. 
229.     square = Interval(0, 1) * Interval(0, 1)
230.     notsquare = square.complement(S.Reals*S.Reals)
231. 
232.     assert all(pt in square for pt in [(0, 0), (.5, .5), (1, 0), (1, 1)])
233.     assert not any(
234.         pt in notsquare for pt in [(0, 0), (.5, .5), (1, 0), (1, 1)])
235.     assert not any(pt in square for pt in [(-1, 0), (1.5, .5), (10, 10)])
236.     assert all(pt in notsquare for pt in [(-1, 0), (1.5, .5), (10, 10)])
237. 
238. 
239. def test_intersect():
240.     x = Symbol('x')
241.     assert Interval(0, 2).intersect(Interval(1, 2)) == Interval(1, 2)
242.     assert Interval(0, 2).intersect(Interval(1, 2, True)) == \
243.         Interval(1, 2, True)
244.     assert Interval(0, 2, True).intersect(Interval(1, 2)) == \
245.         Interval(1, 2, False, False)
246.     assert Interval(0, 2, True, True).intersect(Interval(1, 2)) == \
247.         Interval(1, 2, False, True)
248.     assert Interval(0, 2).intersect(Union(Interval(0, 1), Interval(2, 3))) == \
249.         Union(Interval(0, 1), Interval(2, 2))
250. 
251.     assert FiniteSet(1, 2)._intersect((1, 2, 3)) == FiniteSet(1, 2)
252.     assert FiniteSet(1, 2, x).intersect(FiniteSet(x)) == FiniteSet(x)
253.     assert FiniteSet('ham', 'eggs').intersect(FiniteSet('ham')) == \
254.         FiniteSet('ham')
255.     assert FiniteSet(1, 2, 3, 4, 5).intersect(S.EmptySet) == S.EmptySet
256. 
257.     assert Interval(0, 5).intersect(FiniteSet(1, 3)) == FiniteSet(1, 3)
258.     assert Interval(0, 1, True, True).intersect(FiniteSet(1)) == S.EmptySet
259. 
260.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(Interval(1, 2)) == \
261.         Union(Interval(1, 1), Interval(2, 2))
262.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(Interval(0, 2)) == \
263.         Union(Interval(0, 1), Interval(2, 2))
264.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(Interval(1, 2, True, True)) == \
265.         S.EmptySet
266.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(S.EmptySet) == \
267.         S.EmptySet
268.     assert Union(Interval(0, 5), FiniteSet('ham')).intersect(FiniteSet(2, 3, 4, 5, 6)) == \
269.         Union(FiniteSet(2, 3, 4, 5), Intersection(FiniteSet(6), Union(Interval(0, 5), FiniteSet('ham'))))
270. 
271.     # issue 8217
272.     assert Intersection(FiniteSet(x), FiniteSet(y)) == \
273.         Intersection(FiniteSet(x), FiniteSet(y), evaluate=False)
274.     assert FiniteSet(x).intersect(S.Reals) == \
275.         Intersection(S.Reals, FiniteSet(x), evaluate=False)
276. 
277.     # tests for the intersection alias
278.     assert Interval(0, 5).intersection(FiniteSet(1, 3)) == FiniteSet(1, 3)
279.     assert Interval(0, 1, True, True).intersection(FiniteSet(1)) == S.EmptySet
280. 
281.     assert Union(Interval(0, 1), Interval(2, 3)).intersection(Interval(1, 2)) == \
282.         Union(Interval(1, 1), Interval(2, 2))
283. 
284. 
285. def test_intersection():
286.     # iterable
287.     i = Intersection(FiniteSet(1, 2, 3), Interval(2, 5), evaluate=False)
288.     assert i.is_iterable
289.     assert set(i) == {S(2), S(3)}
290. 
291.     # challenging intervals
292.     x = Symbol('x', real=True)
293.     i = Intersection(Interval(0, 3), Interval(x, 6))
294.     assert (5 in i) is False
295.     raises(TypeError, lambda: 2 in i)
296. 
297.     # Singleton special cases
298.     assert Intersection(Interval(0, 1), S.EmptySet) == S.EmptySet
299.     assert Intersection(Interval(-oo, oo), Interval(-oo, x)) == Interval(-oo, x)
300. 
301.     # Products
302.     line = Interval(0, 5)
303.     i = Intersection(line**2, line**3, evaluate=False)
304.     assert (2, 2) not in i
305.     assert (2, 2, 2) not in i
306.     raises(ValueError, lambda: list(i))
307. 
308.     assert Intersection(Intersection(S.Integers, S.Naturals, evaluate=False),
309.                         S.Reals, evaluate=False) == \
310.             Intersection(S.Integers, S.Naturals, S.Reals, evaluate=False)
311. 
312.     assert Intersection(S.Complexes, FiniteSet(S.ComplexInfinity)) == S.EmptySet
313. 
314.     # issue 12178
315.     assert Intersection() == S.UniversalSet
316. 
317. def test_issue_9623():
318.     n = Symbol('n')
319. 
320.     a = S.Reals
321.     b = Interval(0, oo)
322.     c = FiniteSet(n)
323. 
324.     assert Intersection(a, b, c) == Intersection(b, c)
325.     assert Intersection(Interval(1, 2), Interval(3, 4), FiniteSet(n)) == EmptySet()
326. 
327. 
328. def test_is_disjoint():
329.     assert Interval(0, 2).is_disjoint(Interval(1, 2)) == False
330.     assert Interval(0, 2).is_disjoint(Interval(3, 4)) == True
331. 
332. 
333. def test_ProductSet_of_single_arg_is_arg():
334.     assert ProductSet(Interval(0, 1)) == Interval(0, 1)
335. 
336. 
337. def test_interval_subs():
338.     a = Symbol('a', real=True)
339. 
340.     assert Interval(0, a).subs(a, 2) == Interval(0, 2)
341.     assert Interval(a, 0).subs(a, 2) == S.EmptySet
342. 
343. 
344. def test_interval_to_mpi():
345.     assert Interval(0, 1).to_mpi() == mpi(0, 1)
346.     assert Interval(0, 1, True, False).to_mpi() == mpi(0, 1)
347.     assert type(Interval(0, 1).to_mpi()) == type(mpi(0, 1))
348. 
349. 
350. def test_measure():
351.     a = Symbol('a', real=True)
352. 
353.     assert Interval(1, 3).measure == 2
354.     assert Interval(0, a).measure == a
355.     assert Interval(1, a).measure == a - 1
356. 
357.     assert Union(Interval(1, 2), Interval(3, 4)).measure == 2
358.     assert Union(Interval(1, 2), Interval(3, 4), FiniteSet(5, 6, 7)).measure \
359.         == 2
360. 
361.     assert FiniteSet(1, 2, oo, a, -oo, -5).measure == 0
362. 
363.     assert S.EmptySet.measure == 0
364. 
365.     square = Interval(0, 10) * Interval(0, 10)
366.     offsetsquare = Interval(5, 15) * Interval(5, 15)
367.     band = Interval(-oo, oo) * Interval(2, 4)
368. 
369.     assert square.measure == offsetsquare.measure == 100
370.     assert (square + offsetsquare).measure == 175  # there is some overlap
371.     assert (square - offsetsquare).measure == 75
372.     assert (square * FiniteSet(1, 2, 3)).measure == 0
373.     assert (square.intersect(band)).measure == 20
374.     assert (square + band).measure == oo
375.     assert (band * FiniteSet(1, 2, 3)).measure == nan
376. 
377. 
378. def test_is_subset():
379.     assert Interval(0, 1).is_subset(Interval(0, 2)) is True
380.     assert Interval(0, 3).is_subset(Interval(0, 2)) is False
381. 
382.     assert FiniteSet(1, 2).is_subset(FiniteSet(1, 2, 3, 4))
383.     assert FiniteSet(4, 5).is_subset(FiniteSet(1, 2, 3, 4)) is False
384.     assert FiniteSet(1).is_subset(Interval(0, 2))
385.     assert FiniteSet(1, 2).is_subset(Interval(0, 2, True, True)) is False
386.     assert (Interval(1, 2) + FiniteSet(3)).is_subset(
387.         (Interval(0, 2, False, True) + FiniteSet(2, 3)))
388. 
389.     assert Interval(3, 4).is_subset(Union(Interval(0, 1), Interval(2, 5))) is True
390.     assert Interval(3, 6).is_subset(Union(Interval(0, 1), Interval(2, 5))) is False
391. 
392.     assert FiniteSet(1, 2, 3, 4).is_subset(Interval(0, 5)) is True
393.     assert S.EmptySet.is_subset(FiniteSet(1, 2, 3)) is True
394. 
395.     assert Interval(0, 1).is_subset(S.EmptySet) is False
396.     assert S.EmptySet.is_subset(S.EmptySet) is True
397. 
398.     raises(ValueError, lambda: S.EmptySet.is_subset(1))
399. 
400.     # tests for the issubset alias
401.     assert FiniteSet(1, 2, 3, 4).issubset(Interval(0, 5)) is True
402.     assert S.EmptySet.issubset(FiniteSet(1, 2, 3)) is True
403. 
404. 
405. def test_is_proper_subset():
406.     assert Interval(0, 1).is_proper_subset(Interval(0, 2)) is True
407.     assert Interval(0, 3).is_proper_subset(Interval(0, 2)) is False
408.     assert S.EmptySet.is_proper_subset(FiniteSet(1, 2, 3)) is True
409. 
410.     raises(ValueError, lambda: Interval(0, 1).is_proper_subset(0))
411. 
412. 
413. def test_is_superset():
414.     assert Interval(0, 1).is_superset(Interval(0, 2)) == False
415.     assert Interval(0, 3).is_superset(Interval(0, 2))
416. 
417.     assert FiniteSet(1, 2).is_superset(FiniteSet(1, 2, 3, 4)) == False
418.     assert FiniteSet(4, 5).is_superset(FiniteSet(1, 2, 3, 4)) == False
419.     assert FiniteSet(1).is_superset(Interval(0, 2)) == False
420.     assert FiniteSet(1, 2).is_superset(Interval(0, 2, True, True)) == False
421.     assert (Interval(1, 2) + FiniteSet(3)).is_superset(
422.         (Interval(0, 2, False, True) + FiniteSet(2, 3))) == False
423. 
424.     assert Interval(3, 4).is_superset(Union(Interval(0, 1), Interval(2, 5))) == False
425. 
426.     assert FiniteSet(1, 2, 3, 4).is_superset(Interval(0, 5)) == False
427.     assert S.EmptySet.is_superset(FiniteSet(1, 2, 3)) == False
428. 
429.     assert Interval(0, 1).is_superset(S.EmptySet) == True
430.     assert S.EmptySet.is_superset(S.EmptySet) == True
431. 
432.     raises(ValueError, lambda: S.EmptySet.is_superset(1))
433. 
434.     # tests for the issuperset alias
435.     assert Interval(0, 1).issuperset(S.EmptySet) == True
436.     assert S.EmptySet.issuperset(S.EmptySet) == True
437. 
438. 
439. def test_is_proper_superset():
440.     assert Interval(0, 1).is_proper_superset(Interval(0, 2)) is False
441.     assert Interval(0, 3).is_proper_superset(Interval(0, 2)) is True
442.     assert FiniteSet(1, 2, 3).is_proper_superset(S.EmptySet) is True
443. 
444.     raises(ValueError, lambda: Interval(0, 1).is_proper_superset(0))
445. 
446. 
447. def test_contains():
448.     assert Interval(0, 2).contains(1) is S.true
449.     assert Interval(0, 2).contains(3) is S.false
450.     assert Interval(0, 2, True, False).contains(0) is S.false
451.     assert Interval(0, 2, True, False).contains(2) is S.true
452.     assert Interval(0, 2, False, True).contains(0) is S.true
453.     assert Interval(0, 2, False, True).contains(2) is S.false
454.     assert Interval(0, 2, True, True).contains(0) is S.false
455.     assert Interval(0, 2, True, True).contains(2) is S.false
456. 
457.     assert (Interval(0, 2) in Interval(0, 2)) is False
458. 
459.     assert FiniteSet(1, 2, 3).contains(2) is S.true
460.     assert FiniteSet(1, 2, Symbol('x')).contains(Symbol('x')) is S.true
461. 
462.     # issue 8197
463.     from sympy.abc import a, b
464.     assert isinstance(FiniteSet(b).contains(-a), Contains)
465.     assert isinstance(FiniteSet(b).contains(a), Contains)
466.     assert isinstance(FiniteSet(a).contains(1), Contains)
467.     raises(TypeError, lambda: 1 in FiniteSet(a))
468. 
469.     # issue 8209
470.     rad1 = Pow(Pow(2, S(1)/3) - 1, S(1)/3)
471.     rad2 = Pow(S(1)/9, S(1)/3) - Pow(S(2)/9, S(1)/3) + Pow(S(4)/9, S(1)/3)
472.     s1 = FiniteSet(rad1)
473.     s2 = FiniteSet(rad2)
474.     assert s1 - s2 == S.EmptySet
475. 
476.     items = [1, 2, S.Infinity, S('ham'), -1.1]
477.     fset = FiniteSet(*items)
478.     assert all(item in fset for item in items)
479.     assert all(fset.contains(item) is S.true for item in items)
480. 
481.     assert Union(Interval(0, 1), Interval(2, 5)).contains(3) is S.true
482.     assert Union(Interval(0, 1), Interval(2, 5)).contains(6) is S.false
483.     assert Union(Interval(0, 1), FiniteSet(2, 5)).contains(3) is S.false
484. 
485.     assert S.EmptySet.contains(1) is S.false
486.     assert FiniteSet(rootof(x**3 + x - 1, 0)).contains(S.Infinity) is S.false
487. 
488.     assert rootof(x**5 + x**3 + 1, 0) in S.Reals
489.     assert not rootof(x**5 + x**3 + 1, 1) in S.Reals
490. 
491.     # non-bool results
492.     assert Union(Interval(1, 2), Interval(3, 4)).contains(x) == \
493.         Or(And(x <= 2, x >= 1), And(x <= 4, x >= 3))
494.     assert Intersection(Interval(1, x), Interval(2, 3)).contains(y) == \
495.         And(y <= 3, y <= x, y >= 1, y >= 2)
496. 
497.     assert (S.Complexes).contains(S.ComplexInfinity) == S.false
498. 
499. 
500. def test_interval_symbolic():


File: sympy/sets/tests/test_sets.py
Line number range: 501 - 1000
Content:
501.     x = Symbol('x')
502.     e = Interval(0, 1)
503.     assert e.contains(x) == And(0 <= x, x <= 1)
504.     raises(TypeError, lambda: x in e)
505.     e = Interval(0, 1, True, True)
506.     assert e.contains(x) == And(0 < x, x < 1)
507. 
508. 
509. def test_union_contains():
510.     x = Symbol('x')
511.     i1 = Interval(0, 1)
512.     i2 = Interval(2, 3)
513.     i3 = Union(i1, i2)
514.     raises(TypeError, lambda: x in i3)
515.     e = i3.contains(x)
516.     assert e == Or(And(0 <= x, x <= 1), And(2 <= x, x <= 3))
517.     assert e.subs(x, -0.5) is false
518.     assert e.subs(x, 0.5) is true
519.     assert e.subs(x, 1.5) is false
520.     assert e.subs(x, 2.5) is true
521.     assert e.subs(x, 3.5) is false
522. 
523.     U = Interval(0, 2, True, True) + Interval(10, oo) + FiniteSet(-1, 2, 5, 6)
524.     assert all(el not in U for el in [0, 4, -oo])
525.     assert all(el in U for el in [2, 5, 10])
526. 
527. 
528. def test_is_number():
529.     assert Interval(0, 1).is_number is False
530.     assert Set().is_number is False
531. 
532. 
533. def test_Interval_is_left_unbounded():
534.     assert Interval(3, 4).is_left_unbounded is False
535.     assert Interval(-oo, 3).is_left_unbounded is True
536.     assert Interval(Float("-inf"), 3).is_left_unbounded is True
537. 
538. 
539. def test_Interval_is_right_unbounded():
540.     assert Interval(3, 4).is_right_unbounded is False
541.     assert Interval(3, oo).is_right_unbounded is True
542.     assert Interval(3, Float("+inf")).is_right_unbounded is True
543. 
544. 
545. def test_Interval_as_relational():
546.     x = Symbol('x')
547. 
548.     assert Interval(-1, 2, False, False).as_relational(x) == \
549.         And(Le(-1, x), Le(x, 2))
550.     assert Interval(-1, 2, True, False).as_relational(x) == \
551.         And(Lt(-1, x), Le(x, 2))
552.     assert Interval(-1, 2, False, True).as_relational(x) == \
553.         And(Le(-1, x), Lt(x, 2))
554.     assert Interval(-1, 2, True, True).as_relational(x) == \
555.         And(Lt(-1, x), Lt(x, 2))
556. 
557.     assert Interval(-oo, 2, right_open=False).as_relational(x) == And(Lt(-oo, x), Le(x, 2))
558.     assert Interval(-oo, 2, right_open=True).as_relational(x) == And(Lt(-oo, x), Lt(x, 2))
559. 
560.     assert Interval(-2, oo, left_open=False).as_relational(x) == And(Le(-2, x), Lt(x, oo))
561.     assert Interval(-2, oo, left_open=True).as_relational(x) == And(Lt(-2, x), Lt(x, oo))
562. 
563.     assert Interval(-oo, oo).as_relational(x) == And(Lt(-oo, x), Lt(x, oo))
564.     x = Symbol('x', real=True)
565.     y = Symbol('y', real=True)
566.     assert Interval(x, y).as_relational(x) == (x <= y)
567.     assert Interval(y, x).as_relational(x) == (y <= x)
568. 
569. 
570. def test_Finite_as_relational():
571.     x = Symbol('x')
572.     y = Symbol('y')
573. 
574.     assert FiniteSet(1, 2).as_relational(x) == Or(Eq(x, 1), Eq(x, 2))
575.     assert FiniteSet(y, -5).as_relational(x) == Or(Eq(x, y), Eq(x, -5))
576. 
577. 
578. def test_Union_as_relational():
579.     x = Symbol('x')
580.     assert (Interval(0, 1) + FiniteSet(2)).as_relational(x) == \
581.         Or(And(Le(0, x), Le(x, 1)), Eq(x, 2))
582.     assert (Interval(0, 1, True, True) + FiniteSet(1)).as_relational(x) == \
583.         And(Lt(0, x), Le(x, 1))
584. 
585. 
586. def test_Intersection_as_relational():
587.     x = Symbol('x')
588.     assert (Intersection(Interval(0, 1), FiniteSet(2),
589.             evaluate=False).as_relational(x)
590.             == And(And(Le(0, x), Le(x, 1)), Eq(x, 2)))
591. 
592. 
593. def test_EmptySet():
594.     assert S.EmptySet.as_relational(Symbol('x')) is S.false
595.     assert S.EmptySet.intersect(S.UniversalSet) == S.EmptySet
596.     assert S.EmptySet.boundary == S.EmptySet
597. 
598. 
599. def test_finite_basic():
600.     x = Symbol('x')
601.     A = FiniteSet(1, 2, 3)
602.     B = FiniteSet(3, 4, 5)
603.     AorB = Union(A, B)
604.     AandB = A.intersect(B)
605.     assert A.is_subset(AorB) and B.is_subset(AorB)
606.     assert AandB.is_subset(A)
607.     assert AandB == FiniteSet(3)
608. 
609.     assert A.inf == 1 and A.sup == 3
610.     assert AorB.inf == 1 and AorB.sup == 5
611.     assert FiniteSet(x, 1, 5).sup == Max(x, 5)
612.     assert FiniteSet(x, 1, 5).inf == Min(x, 1)
613. 
614.     # issue 7335
615.     assert FiniteSet(S.EmptySet) != S.EmptySet
616.     assert FiniteSet(FiniteSet(1, 2, 3)) != FiniteSet(1, 2, 3)
617.     assert FiniteSet((1, 2, 3)) != FiniteSet(1, 2, 3)
618. 
619.     # Ensure a variety of types can exist in a FiniteSet
620.     s = FiniteSet((1, 2), Float, A, -5, x, 'eggs', x**2, Interval)
621. 
622.     assert (A > B) is False
623.     assert (A >= B) is False
624.     assert (A < B) is False
625.     assert (A <= B) is False
626.     assert AorB > A and AorB > B
627.     assert AorB >= A and AorB >= B
628.     assert A >= A and A <= A
629.     assert A >= AandB and B >= AandB
630.     assert A > AandB and B > AandB
631. 
632. 
633. def test_powerset():
634.     # EmptySet
635.     A = FiniteSet()
636.     pset = A.powerset()
637.     assert len(pset) == 1
638.     assert pset ==  FiniteSet(S.EmptySet)
639. 
640.     # FiniteSets
641.     A = FiniteSet(1, 2)
642.     pset = A.powerset()
643.     assert len(pset) == 2**len(A)
644.     assert pset == FiniteSet(FiniteSet(), FiniteSet(1),
645.                              FiniteSet(2), A)
646.     # Not finite sets
647.     I = Interval(0, 1)
648.     raises(NotImplementedError, I.powerset)
649. 
650. 
651. def test_product_basic():
652.     H, T = 'H', 'T'
653.     unit_line = Interval(0, 1)
654.     d6 = FiniteSet(1, 2, 3, 4, 5, 6)
655.     d4 = FiniteSet(1, 2, 3, 4)
656.     coin = FiniteSet(H, T)
657. 
658.     square = unit_line * unit_line
659. 
660.     assert (0, 0) in square
661.     assert 0 not in square
662.     assert (H, T) in coin ** 2
663.     assert (.5, .5, .5) in square * unit_line
664.     assert (H, 3, 3) in coin * d6* d6
665.     HH, TT = sympify(H), sympify(T)
666.     assert set(coin**2) == set(((HH, HH), (HH, TT), (TT, HH), (TT, TT)))
667. 
668.     assert (d4*d4).is_subset(d6*d6)
669. 
670.     assert square.complement(Interval(-oo, oo)*Interval(-oo, oo)) == Union(
671.         (Interval(-oo, 0, True, True) +
672.          Interval(1, oo, True, True))*Interval(-oo, oo),
673.          Interval(-oo, oo)*(Interval(-oo, 0, True, True) +
674.                   Interval(1, oo, True, True)))
675. 
676.     assert (Interval(-5, 5)**3).is_subset(Interval(-10, 10)**3)
677.     assert not (Interval(-10, 10)**3).is_subset(Interval(-5, 5)**3)
678.     assert not (Interval(-5, 5)**2).is_subset(Interval(-10, 10)**3)
679. 
680.     assert (Interval(.2, .5)*FiniteSet(.5)).is_subset(square)  # segment in square
681. 
682.     assert len(coin*coin*coin) == 8
683.     assert len(S.EmptySet*S.EmptySet) == 0
684.     assert len(S.EmptySet*coin) == 0
685.     raises(TypeError, lambda: len(coin*Interval(0, 2)))
686. 
687. 
688. def test_real():
689.     x = Symbol('x', real=True, finite=True)
690. 
691.     I = Interval(0, 5)
692.     J = Interval(10, 20)
693.     A = FiniteSet(1, 2, 30, x, S.Pi)
694.     B = FiniteSet(-4, 0)
695.     C = FiniteSet(100)
696.     D = FiniteSet('Ham', 'Eggs')
697. 
698.     assert all(s.is_subset(S.Reals) for s in [I, J, A, B, C])
699.     assert not D.is_subset(S.Reals)
700.     assert all((a + b).is_subset(S.Reals) for a in [I, J, A, B, C] for b in [I, J, A, B, C])
701.     assert not any((a + D).is_subset(S.Reals) for a in [I, J, A, B, C, D])
702. 
703.     assert not (I + A + D).is_subset(S.Reals)
704. 
705. 
706. def test_supinf():
707.     x = Symbol('x', real=True)
708.     y = Symbol('y', real=True)
709. 
710.     assert (Interval(0, 1) + FiniteSet(2)).sup == 2
711.     assert (Interval(0, 1) + FiniteSet(2)).inf == 0
712.     assert (Interval(0, 1) + FiniteSet(x)).sup == Max(1, x)
713.     assert (Interval(0, 1) + FiniteSet(x)).inf == Min(0, x)
714.     assert FiniteSet(5, 1, x).sup == Max(5, x)
715.     assert FiniteSet(5, 1, x).inf == Min(1, x)
716.     assert FiniteSet(5, 1, x, y).sup == Max(5, x, y)
717.     assert FiniteSet(5, 1, x, y).inf == Min(1, x, y)
718.     assert FiniteSet(5, 1, x, y, S.Infinity, S.NegativeInfinity).sup == \
719.         S.Infinity
720.     assert FiniteSet(5, 1, x, y, S.Infinity, S.NegativeInfinity).inf == \
721.         S.NegativeInfinity
722.     assert FiniteSet('Ham', 'Eggs').sup == Max('Ham', 'Eggs')
723. 
724. 
725. def test_universalset():
726.     U = S.UniversalSet
727.     x = Symbol('x')
728.     assert U.as_relational(x) is S.true
729.     assert U.union(Interval(2, 4)) == U
730. 
731.     assert U.intersect(Interval(2, 4)) == Interval(2, 4)
732.     assert U.measure == S.Infinity
733.     assert U.boundary == S.EmptySet
734.     assert U.contains(0) is S.true
735. 
736. 
737. def test_Union_of_ProductSets_shares():
738.     line = Interval(0, 2)
739.     points = FiniteSet(0, 1, 2)
740.     assert Union(line * line, line * points) == line * line
741. 
742. 
743. def test_Interval_free_symbols():
744.     # issue 6211
745.     assert Interval(0, 1).free_symbols == set()
746.     x = Symbol('x', real=True)
747.     assert Interval(0, x).free_symbols == {x}
748. 
749. 
750. def test_image_interval():
751.     from sympy.core.numbers import Rational
752.     x = Symbol('x', real=True)
753.     a = Symbol('a', real=True)
754.     assert imageset(x, 2*x, Interval(-2, 1)) == Interval(-4, 2)
755.     assert imageset(x, 2*x, Interval(-2, 1, True, False)) == \
756.         Interval(-4, 2, True, False)
757.     assert imageset(x, x**2, Interval(-2, 1, True, False)) == \
758.         Interval(0, 4, False, True)
759.     assert imageset(x, x**2, Interval(-2, 1)) == Interval(0, 4)
760.     assert imageset(x, x**2, Interval(-2, 1, True, False)) == \
761.         Interval(0, 4, False, True)
762.     assert imageset(x, x**2, Interval(-2, 1, True, True)) == \
763.         Interval(0, 4, False, True)
764.     assert imageset(x, (x - 2)**2, Interval(1, 3)) == Interval(0, 1)
765.     assert imageset(x, 3*x**4 - 26*x**3 + 78*x**2 - 90*x, Interval(0, 4)) == \
766.         Interval(-35, 0)  # Multiple Maxima
767.     assert imageset(x, x + 1/x, Interval(-oo, oo)) == Interval(-oo, -2) \
768.         + Interval(2, oo)  # Single Infinite discontinuity
769.     assert imageset(x, 1/x + 1/(x-1)**2, Interval(0, 2, True, False)) == \
770.         Interval(Rational(3, 2), oo, False)  # Multiple Infinite discontinuities
771. 
772.     # Test for Python lambda
773.     assert imageset(lambda x: 2*x, Interval(-2, 1)) == Interval(-4, 2)
774. 
775.     assert imageset(Lambda(x, a*x), Interval(0, 1)) == \
776.             ImageSet(Lambda(x, a*x), Interval(0, 1))
777. 
778.     assert imageset(Lambda(x, sin(cos(x))), Interval(0, 1)) == \
779.             ImageSet(Lambda(x, sin(cos(x))), Interval(0, 1))
780. 
781. 
782. def test_image_piecewise():
783.     f = Piecewise((x, x <= -1), (1/x**2, x <= 5), (x**3, True))
784.     f1 = Piecewise((0, x <= 1), (1, x <= 2), (2, True))
785.     assert imageset(x, f, Interval(-5, 5)) == Union(Interval(-5, -1), Interval(S(1)/25, oo))
786.     assert imageset(x, f1, Interval(1, 2)) == FiniteSet(0, 1)
787. 
788. 
789. @XFAIL  # See: https://github.com/sympy/sympy/pull/2723#discussion_r8659826
790. def test_image_Intersection():
791.     x = Symbol('x', real=True)
792.     y = Symbol('y', real=True)
793.     assert imageset(x, x**2, Interval(-2, 0).intersect(Interval(x, y))) == \
794.            Interval(0, 4).intersect(Interval(Min(x**2, y**2), Max(x**2, y**2)))
795. 
796. 
797. def test_image_FiniteSet():
798.     x = Symbol('x', real=True)
799.     assert imageset(x, 2*x, FiniteSet(1, 2, 3)) == FiniteSet(2, 4, 6)
800. 
801. def test_image_Union():
802.     x = Symbol('x', real=True)
803.     assert imageset(x, x**2, Interval(-2, 0) + FiniteSet(1, 2, 3)) == \
804.             (Interval(0, 4) + FiniteSet(9))
805. 
806. 
807. def test_image_EmptySet():
808.     x = Symbol('x', real=True)
809.     assert imageset(x, 2*x, S.EmptySet) == S.EmptySet
810. 
811. 
812. def test_issue_5724_7680():
813.     assert I not in S.Reals  # issue 7680
814.     assert Interval(-oo, oo).contains(I) is S.false
815. 
816. 
817. def test_boundary():
818.     x = Symbol('x', real=True)
819.     y = Symbol('y', real=True)
820.     assert FiniteSet(1).boundary == FiniteSet(1)
821.     assert all(Interval(0, 1, left_open, right_open).boundary == FiniteSet(0, 1)
822.             for left_open in (true, false) for right_open in (true, false))
823. 
824. 
825. def test_boundary_Union():
826.     assert (Interval(0, 1) + Interval(2, 3)).boundary == FiniteSet(0, 1, 2, 3)
827.     assert ((Interval(0, 1, False, True)
828.            + Interval(1, 2, True, False)).boundary == FiniteSet(0, 1, 2))
829. 
830.     assert (Interval(0, 1) + FiniteSet(2)).boundary == FiniteSet(0, 1, 2)
831.     assert Union(Interval(0, 10), Interval(5, 15), evaluate=False).boundary \
832.             == FiniteSet(0, 15)
833. 
834.     assert Union(Interval(0, 10), Interval(0, 1), evaluate=False).boundary \
835.             == FiniteSet(0, 10)
836.     assert Union(Interval(0, 10, True, True),
837.                  Interval(10, 15, True, True), evaluate=False).boundary \
838.             == FiniteSet(0, 10, 15)
839. 
840. 
841. @XFAIL
842. def test_union_boundary_of_joining_sets():
843.     """ Testing the boundary of unions is a hard problem """
844.     assert Union(Interval(0, 10), Interval(10, 15), evaluate=False).boundary \
845.             == FiniteSet(0, 15)
846. 
847. 
848. def test_boundary_ProductSet():
849.     open_square = Interval(0, 1, True, True) ** 2
850.     assert open_square.boundary == (FiniteSet(0, 1) * Interval(0, 1)
851.                                   + Interval(0, 1) * FiniteSet(0, 1))
852. 
853.     second_square = Interval(1, 2, True, True) * Interval(0, 1, True, True)
854.     assert (open_square + second_square).boundary == (
855.                 FiniteSet(0, 1) * Interval(0, 1)
856.               + FiniteSet(1, 2) * Interval(0, 1)
857.               + Interval(0, 1) * FiniteSet(0, 1)
858.               + Interval(1, 2) * FiniteSet(0, 1))
859. 
860. 
861. def test_boundary_ProductSet_line():
862.     line_in_r2 = Interval(0, 1) * FiniteSet(0)
863.     assert line_in_r2.boundary == line_in_r2
864. 
865. 
866. def test_is_open():
867.     assert not Interval(0, 1, False, False).is_open
868.     assert not Interval(0, 1, True, False).is_open
869.     assert Interval(0, 1, True, True).is_open
870.     assert not FiniteSet(1, 2, 3).is_open
871. 
872. 
873. def test_is_closed():
874.     assert Interval(0, 1, False, False).is_closed
875.     assert not Interval(0, 1, True, False).is_closed
876.     assert FiniteSet(1, 2, 3).is_closed
877. 
878. 
879. def test_closure():
880.     assert Interval(0, 1, False, True).closure == Interval(0, 1, False, False)
881. 
882. 
883. def test_interior():
884.     assert Interval(0, 1, False, True).interior == Interval(0, 1, True, True)
885. 
886. 
887. def test_issue_7841():
888.     raises(TypeError, lambda: x in S.Reals)
889. 
890. 
891. def test_Eq():
892.     assert Eq(Interval(0, 1), Interval(0, 1))
893.     assert Eq(Interval(0, 1), Interval(0, 2)) == False
894. 
895.     s1 = FiniteSet(0, 1)
896.     s2 = FiniteSet(1, 2)
897. 
898.     assert Eq(s1, s1)
899.     assert Eq(s1, s2) == False
900. 
901.     assert Eq(s1*s2, s1*s2)
902.     assert Eq(s1*s2, s2*s1) == False
903. 
904. 
905. def test_SymmetricDifference():
906.    assert SymmetricDifference(FiniteSet(0, 1, 2, 3, 4, 5), \
907.           FiniteSet(2, 4, 6, 8, 10)) == FiniteSet(0, 1, 3, 5, 6, 8, 10)
908.    assert SymmetricDifference(FiniteSet(2, 3, 4), FiniteSet(2, 3 ,4 ,5 )) \
909.           == FiniteSet(5)
910.    assert FiniteSet(1, 2, 3, 4, 5) ^ FiniteSet(1, 2, 5, 6) == \
911.           FiniteSet(3, 4, 6)
912.    assert Set(1, 2 ,3) ^ Set(2, 3, 4) == Union(Set(1, 2, 3) - Set(2, 3, 4), \
913.           Set(2, 3, 4) - Set(1, 2, 3))
914.    assert Interval(0, 4) ^ Interval(2, 5) == Union(Interval(0, 4) - \
915.           Interval(2, 5), Interval(2, 5) - Interval(0, 4))
916. 
917. 
918. def test_issue_9536():
919.     from sympy.functions.elementary.exponential import log
920.     a = Symbol('a', real=True)
921.     assert FiniteSet(log(a)).intersect(S.Reals) == Intersection(S.Reals, FiniteSet(log(a)))
922. 
923. 
924. def test_issue_9637():
925.     n = Symbol('n')
926.     a = FiniteSet(n)
927.     b = FiniteSet(2, n)
928.     assert Complement(S.Reals, a) == Complement(S.Reals, a, evaluate=False)
929.     assert Complement(Interval(1, 3), a) == Complement(Interval(1, 3), a, evaluate=False)
930.     assert Complement(Interval(1, 3), b) == \
931.         Complement(Union(Interval(1, 2, False, True), Interval(2, 3, True, False)), a)
932.     assert Complement(a, S.Reals) == Complement(a, S.Reals, evaluate=False)
933.     assert Complement(a, Interval(1, 3)) == Complement(a, Interval(1, 3), evaluate=False)
934. 
935. 
936. def test_issue_9808():
937.     assert Complement(FiniteSet(y), FiniteSet(1)) == Complement(FiniteSet(y), FiniteSet(1), evaluate=False)
938.     assert Complement(FiniteSet(1, 2, x), FiniteSet(x, y, 2, 3)) == \
939.         Complement(FiniteSet(1), FiniteSet(y), evaluate=False)
940. 
941. 
942. def test_issue_9956():
943.     assert Union(Interval(-oo, oo), FiniteSet(1)) == Interval(-oo, oo)
944.     assert Interval(-oo, oo).contains(1) is S.true
945. 
946. 
947. def test_issue_Symbol_inter():
948.     i = Interval(0, oo)
949.     r = S.Reals
950.     mat = Matrix([0, 0, 0])
951.     assert Intersection(r, i, FiniteSet(m), FiniteSet(m, n)) == \
952.         Intersection(i, FiniteSet(m))
953.     assert Intersection(FiniteSet(1, m, n), FiniteSet(m, n, 2), i) == \
954.         Intersection(i, FiniteSet(m, n))
955.     assert Intersection(FiniteSet(m, n, x), FiniteSet(m, z), r) == \
956.         Intersection(r, FiniteSet(m, z), FiniteSet(n, x))
957.     assert Intersection(FiniteSet(m, n, 3), FiniteSet(m, n, x), r) == \
958.         Intersection(r, FiniteSet(3, m, n), evaluate=False)
959.     assert Intersection(FiniteSet(m, n, 3), FiniteSet(m, n, 2, 3), r) == \
960.         Union(FiniteSet(3), Intersection(r, FiniteSet(m, n)))
961.     assert Intersection(r, FiniteSet(mat, 2, n), FiniteSet(0, mat, n)) == \
962.         Intersection(r, FiniteSet(n))
963.     assert Intersection(FiniteSet(sin(x), cos(x)), FiniteSet(sin(x), cos(x), 1), r) == \
964.         Intersection(r, FiniteSet(sin(x), cos(x)))
965.     assert Intersection(FiniteSet(x**2, 1, sin(x)), FiniteSet(x**2, 2, sin(x)), r) == \
966.         Intersection(r, FiniteSet(x**2, sin(x)))
967. 
968. def test_issue_11827():
969.     assert S.Naturals0**4
970. 
971. def test_issue_10113():
972.     f = x**2/(x**2 - 4)
973.     assert imageset(x, f, S.Reals) == Union(Interval(-oo, 0), Interval(1, oo, True, True))
974.     assert imageset(x, f, Interval(-2, 2)) == Interval(-oo, 0)
975.     assert imageset(x, f, Interval(-2, 3)) == Union(Interval(-oo, 0), Interval(S(9)/5, oo))
976. 
977. 
978. def test_issue_10248():
979.     assert list(Intersection(S.Reals, FiniteSet(x))) == [
980.         And(x < oo, x > -oo)]
981. 
982. 
983. def test_issue_9447():
984.     a = Interval(0, 1) + Interval(2, 3)
985.     assert Complement(S.UniversalSet, a) == Complement(
986.             S.UniversalSet, Union(Interval(0, 1), Interval(2, 3)), evaluate=False)
987.     assert Complement(S.Naturals, a) == Complement(
988.             S.Naturals, Union(Interval(0, 1), Interval(2, 3)), evaluate=False)
989. 
990. 
991. def test_issue_10337():
992.     assert (FiniteSet(2) == 3) is False
993.     assert (FiniteSet(2) != 3) is True
994.     raises(TypeError, lambda: FiniteSet(2) < 3)
995.     raises(TypeError, lambda: FiniteSet(2) <= 3)
996.     raises(TypeError, lambda: FiniteSet(2) > 3)
997.     raises(TypeError, lambda: FiniteSet(2) >= 3)
998. 
999. 
1000. def test_issue_10326():


File: sympy/sets/tests/test_sets.py
Line number range: 1001 - 1500
Content:
1001.     bad = [
1002.         EmptySet(),
1003.         FiniteSet(1),
1004.         Interval(1, 2),
1005.         S.ComplexInfinity,
1006.         S.ImaginaryUnit,
1007.         S.Infinity,
1008.         S.NaN,
1009.         S.NegativeInfinity,
1010.         ]
1011.     interval = Interval(0, 5)
1012.     for i in bad:
1013.         assert i not in interval
1014. 
1015.     x = Symbol('x', real=True)
1016.     nr = Symbol('nr', real=False)
1017.     assert x + 1 in Interval(x, x + 4)
1018.     assert nr not in Interval(x, x + 4)
1019.     assert Interval(1, 2) in FiniteSet(Interval(0, 5), Interval(1, 2))
1020.     assert Interval(-oo, oo).contains(oo) is S.false
1021.     assert Interval(-oo, oo).contains(-oo) is S.false
1022. 
1023. 
1024. def test_issue_2799():
1025.     U = S.UniversalSet
1026.     a = Symbol('a', real=True)
1027.     inf_interval = Interval(a, oo)
1028.     R = S.Reals
1029. 
1030.     assert U + inf_interval == inf_interval + U
1031.     assert U + R == R + U
1032.     assert R + inf_interval == inf_interval + R
1033. 
1034. 
1035. def test_issue_9706():
1036.     assert Interval(-oo, 0).closure == Interval(-oo, 0, True, False)
1037.     assert Interval(0, oo).closure == Interval(0, oo, False, True)
1038.     assert Interval(-oo, oo).closure == Interval(-oo, oo)
1039. 
1040. 
1041. def test_issue_8257():
1042.     reals_plus_infinity = Union(Interval(-oo, oo), FiniteSet(oo))
1043.     reals_plus_negativeinfinity = Union(Interval(-oo, oo), FiniteSet(-oo))
1044.     assert Interval(-oo, oo) + FiniteSet(oo) == reals_plus_infinity
1045.     assert FiniteSet(oo) + Interval(-oo, oo) == reals_plus_infinity
1046.     assert Interval(-oo, oo) + FiniteSet(-oo) == reals_plus_negativeinfinity
1047.     assert FiniteSet(-oo) + Interval(-oo, oo) == reals_plus_negativeinfinity
1048. 
1049. 
1050. def test_issue_10931():
1051.     assert S.Integers - S.Integers == EmptySet()
1052.     assert S.Integers - S.Reals == EmptySet()
1053. 
1054. 
1055. def test_issue_11174():
1056.     soln = Intersection(Interval(-oo, oo), FiniteSet(-x), evaluate=False)
1057.     assert Intersection(FiniteSet(-x), S.Reals) == soln
1058. 
1059.     soln = Intersection(S.Reals, FiniteSet(x), evaluate=False)
1060.     assert Intersection(FiniteSet(x), S.Reals) == soln

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 19:05:20,117 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user requested the full content of the file 'sympy/sets/tests/test_sets.py'. The provided context contains the content of this file from line 1 to 1060, which appears to be the complete file. Returning the entire file content fulfills the user's request.", relative_path='sympy/sets/tests/test_sets.py', start_line=1, end_line=1060)]
2025-12-21 19:05:20,119 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of sympy/sets/tests/test_sets.py.
2025-12-21 19:05:20,119 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 19:05:20,119 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 19:05:20,120 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 19:05:20,120 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 19:05:20,121 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── python-comparisons.rst
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── ffunctions.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_ffunctions.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_eval_power.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_1_2.py
    |   |   |   ├── test_1_3.py
    |   |   |   ├── test_1_4.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   ├── sympy_tokenize.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── unitsystems.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   └── test_theanocode.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       └── test_mutable_ndim_array.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_functions.py
    |       ├── test_index_methods.py
    |       ├── test_indexed.py
    |       └── test_tensor.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   └── timeutils.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Complement doesn't work when input is a mixture of Symbols and numbers

Description: ```
>>> a=FiniteSet(x,y,2)
>>> b=Interval(-10,10)
>>> Complement(a,b)
{x, y}
```
`{x, y} \ [-10,10]` is expected as output.

Patch information:
diff --git a/sympy/sets/sets.py b/sympy/sets/sets.py
index 917717bb74..7a6e87d043 100644
--- a/sympy/sets/sets.py
+++ b/sympy/sets/sets.py
@@ -217,7 +217,60 @@ def _complement(self, other):
             return S.EmptySet
 
         elif isinstance(other, FiniteSet):
-            return FiniteSet(*[el for el in other if self.contains(el) != True])
+            if isinstance(self, FiniteSet):
+                # both are FiniteSet: use exact membership and prune RHS
+                inter = self._elements & other._elements
+                A_rem = [e for e in other._elements if e not in inter]
+                B_rem = [e for e in self._elements if e not in inter]
+                outside = []
+                unknown = []
+                if not B_rem:
+                    outside = list(A_rem)
+                else:
+                    for a in A_rem:
+                        if all(sympify(Eq(a, b)) is S.false for b in B_rem):
+                            outside.append(a)
+                        else:
+                            unknown.append(a)
+                # prune RHS to only elements possibly equal to unknowns
+                if unknown:
+                    pruned_rhs = []
+                    for b in B_rem:
+                        if not all(sympify(Eq(u, b)) is S.false for u in unknown):
+                            pruned_rhs.append(b)
+                else:
+                    pruned_rhs = []
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), FiniteSet(*pruned_rhs), evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+            else:
+                outside = []
+                unknown = []
+                for el in other:
+                    ret = sympify(self.contains(el))
+                    if ret is S.true:
+                        continue
+                    elif ret is S.false:
+                        outside.append(el)
+                    else:
+                        unknown.append(el)
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), self, evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
 
     def symmetric_difference(self, other):
         """
@@ -1725,6 +1778,60 @@ def reduce(A, B):
         if isinstance(B, Union):
             return Intersection(s.complement(A) for s in B.args)
 
+        # Handle FiniteSet minuend by removing definite members and
+        # keeping indeterminate membership as an unevaluated Complement
+        if isinstance(A, FiniteSet):
+            outside = []
+            unknown = []
+            if isinstance(B, FiniteSet):
+                inter = A._elements & B._elements
+                A_rem = [e for e in A._elements if e not in inter]
+                B_rem = [e for e in B._elements if e not in inter]
+                if not B_rem:
+                    outside = list(A_rem)
+                else:
+                    for a in A_rem:
+                        if all(sympify(Eq(a, b)) is S.false for b in B_rem):
+                            outside.append(a)
+                        else:
+                            unknown.append(a)
+                if unknown:
+                    pruned_rhs = []
+                    for b in B_rem:
+                        if not all(sympify(Eq(u, b)) is S.false for u in unknown):
+                            pruned_rhs.append(b)
+                else:
+                    pruned_rhs = []
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), FiniteSet(*pruned_rhs), evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+            else:
+                for el in A:
+                    ret = sympify(B.contains(el))
+                    if ret is S.true:
+                        continue
+                    elif ret is S.false:
+                        outside.append(el)
+                    else:
+                        unknown.append(el)
+                parts = []
+                if outside:
+                    parts.append(FiniteSet(*outside))
+                if unknown:
+                    parts.append(Complement(FiniteSet(*unknown), B, evaluate=False))
+                if not parts:
+                    return S.EmptySet
+                if len(parts) == 1:
+                    return parts[0]
+                return Union(*parts, evaluate=False)
+
         result = B._complement(A)
         if result != None:
             return result


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of sympy/sets/tests/test_sets.py.
Extra Requirements: 
Purpose: I need the content of the test file to identify existing test cases that cover `Complement` operations on `FiniteSet`s, which is necessary to find analogous tests for the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/sets/tests/test_sets.py
Line number range: 1 - 1060
Content:
1. from sympy import (Symbol, Set, Union, Interval, oo, S, sympify, nan,
2.     GreaterThan, LessThan, Max, Min, And, Or, Eq, Ge, Le, Gt, Lt, Float,
3.     FiniteSet, Intersection, imageset, I, true, false, ProductSet, E,
4.     sqrt, Complement, EmptySet, sin, cos, Lambda, ImageSet, pi,
5.     Eq, Pow, Contains, Sum, rootof, SymmetricDifference, Piecewise,
6.     Matrix, signsimp, Range)
7. from mpmath import mpi
8. 
9. from sympy.core.compatibility import range
10. from sympy.utilities.pytest import raises, XFAIL
11. 
12. from sympy.abc import x, y, z, m, n
13. 
14. 
15. def test_imageset():
16.     ints = S.Integers
17.     raises(TypeError, lambda: imageset(x, ints))
18.     raises(ValueError, lambda: imageset(x, y, z, ints))
19.     raises(ValueError, lambda: imageset(Lambda(x, cos(x)), y))
20.     assert imageset(cos, ints) == ImageSet(Lambda(x, cos(x)), ints)
21.     def f(x):
22.         return cos(x)
23.     raises(TypeError, lambda: imageset(f, ints))
24.     f = lambda x: cos(x)
25.     assert imageset(f, ints) == ImageSet(Lambda(x, cos(x)), ints)
26.     assert imageset(x, 1, ints) == FiniteSet(1)
27.     assert imageset(x, y, ints) == FiniteSet(y)
28.     assert (str(imageset(lambda y: x + y, Interval(-2, 1)).lamda.expr)
29.         in ('_x + x', 'x + _x'))
30. 
31. 
32. def test_interval_arguments():
33.     assert Interval(0, oo) == Interval(0, oo, False, True)
34.     assert Interval(0, oo).right_open is true
35.     assert Interval(-oo, 0) == Interval(-oo, 0, True, False)
36.     assert Interval(-oo, 0).left_open is true
37.     assert Interval(oo, -oo) == S.EmptySet
38.     assert Interval(oo, oo) == S.EmptySet
39.     assert Interval(-oo, -oo) == S.EmptySet
40. 
41.     assert isinstance(Interval(1, 1), FiniteSet)
42.     e = Sum(x, (x, 1, 3))
43.     assert isinstance(Interval(e, e), FiniteSet)
44. 
45.     assert Interval(1, 0) == S.EmptySet
46.     assert Interval(1, 1).measure == 0
47. 
48.     assert Interval(1, 1, False, True) == S.EmptySet
49.     assert Interval(1, 1, True, False) == S.EmptySet
50.     assert Interval(1, 1, True, True) == S.EmptySet
51. 
52. 
53.     assert isinstance(Interval(0, Symbol('a')), Interval)
54.     assert Interval(Symbol('a', real=True, positive=True), 0) == S.EmptySet
55.     raises(ValueError, lambda: Interval(0, S.ImaginaryUnit))
56.     raises(ValueError, lambda: Interval(0, Symbol('z', real=False)))
57. 
58.     raises(NotImplementedError, lambda: Interval(0, 1, And(x, y)))
59.     raises(NotImplementedError, lambda: Interval(0, 1, False, And(x, y)))
60.     raises(NotImplementedError, lambda: Interval(0, 1, z, And(x, y)))
61. 
62. 
63. 
64. def test_interval_symbolic_end_points():
65.     a = Symbol('a', real=True)
66. 
67.     assert Union(Interval(0, a), Interval(0, 3)).sup == Max(a, 3)
68.     assert Union(Interval(a, 0), Interval(-3, 0)).inf == Min(-3, a)
69. 
70.     assert Interval(0, a).contains(1) == LessThan(1, a)
71. 
72. 
73. def test_union():
74.     assert Union(Interval(1, 2), Interval(2, 3)) == Interval(1, 3)
75.     assert Union(Interval(1, 2), Interval(2, 3, True)) == Interval(1, 3)
76.     assert Union(Interval(1, 3), Interval(2, 4)) == Interval(1, 4)
77.     assert Union(Interval(1, 2), Interval(1, 3)) == Interval(1, 3)
78.     assert Union(Interval(1, 3), Interval(1, 2)) == Interval(1, 3)
79.     assert Union(Interval(1, 3, False, True), Interval(1, 2)) == \
80.         Interval(1, 3, False, True)
81.     assert Union(Interval(1, 3), Interval(1, 2, False, True)) == Interval(1, 3)
82.     assert Union(Interval(1, 2, True), Interval(1, 3)) == Interval(1, 3)
83.     assert Union(Interval(1, 2, True), Interval(1, 3, True)) == \
84.         Interval(1, 3, True)
85.     assert Union(Interval(1, 2, True), Interval(1, 3, True, True)) == \
86.         Interval(1, 3, True, True)
87.     assert Union(Interval(1, 2, True, True), Interval(1, 3, True)) == \
88.         Interval(1, 3, True)
89.     assert Union(Interval(1, 3), Interval(2, 3)) == Interval(1, 3)
90.     assert Union(Interval(1, 3, False, True), Interval(2, 3)) == \
91.         Interval(1, 3)
92.     assert Union(Interval(1, 2, False, True), Interval(2, 3, True)) != \
93.         Interval(1, 3)
94.     assert Union(Interval(1, 2), S.EmptySet) == Interval(1, 2)
95.     assert Union(S.EmptySet) == S.EmptySet
96. 
97.     assert Union(Interval(0, 1), [FiniteSet(1.0/n) for n in range(1, 10)]) == \
98.         Interval(0, 1)
99. 
100.     assert Interval(1, 2).union(Interval(2, 3)) == \
101.         Interval(1, 2) + Interval(2, 3)
102. 
103.     assert Interval(1, 2).union(Interval(2, 3)) == Interval(1, 3)
104. 
105.     assert Union(Set()) == Set()
106. 
107.     assert FiniteSet(1) + FiniteSet(2) + FiniteSet(3) == FiniteSet(1, 2, 3)
108.     assert FiniteSet('ham') + FiniteSet('eggs') == FiniteSet('ham', 'eggs')
109.     assert FiniteSet(1, 2, 3) + S.EmptySet == FiniteSet(1, 2, 3)
110. 
111.     assert FiniteSet(1, 2, 3) & FiniteSet(2, 3, 4) == FiniteSet(2, 3)
112.     assert FiniteSet(1, 2, 3) | FiniteSet(2, 3, 4) == FiniteSet(1, 2, 3, 4)
113. 
114.     x = Symbol("x")
115.     y = Symbol("y")
116.     z = Symbol("z")
117.     assert S.EmptySet | FiniteSet(x, FiniteSet(y, z)) == \
118.         FiniteSet(x, FiniteSet(y, z))
119. 
120.     # Test that Intervals and FiniteSets play nicely
121.     assert Interval(1, 3) + FiniteSet(2) == Interval(1, 3)
122.     assert Interval(1, 3, True, True) + FiniteSet(3) == \
123.         Interval(1, 3, True, False)
124.     X = Interval(1, 3) + FiniteSet(5)
125.     Y = Interval(1, 2) + FiniteSet(3)
126.     XandY = X.intersect(Y)
127.     assert 2 in X and 3 in X and 3 in XandY
128.     assert XandY.is_subset(X) and XandY.is_subset(Y)
129. 
130.     raises(TypeError, lambda: Union(1, 2, 3))
131. 
132.     assert X.is_iterable is False
133. 
134.     # issue 7843
135.     assert Union(S.EmptySet, FiniteSet(-sqrt(-I), sqrt(-I))) == \
136.         FiniteSet(-sqrt(-I), sqrt(-I))
137. 
138.     assert Union(S.Reals, S.Integers) == S.Reals
139. 
140. 
141. def test_union_iter():
142.     # Use Range because it is ordered
143.     u = Union(Range(3), Range(5), Range(3), evaluate=False)
144. 
145.     # Round robin
146.     assert list(u) == [0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 4]
147. 
148. def test_difference():
149.     assert Interval(1, 3) - Interval(1, 2) == Interval(2, 3, True)
150.     assert Interval(1, 3) - Interval(2, 3) == Interval(1, 2, False, True)
151.     assert Interval(1, 3, True) - Interval(2, 3) == Interval(1, 2, True, True)
152.     assert Interval(1, 3, True) - Interval(2, 3, True) == \
153.         Interval(1, 2, True, False)
154.     assert Interval(0, 2) - FiniteSet(1) == \
155.         Union(Interval(0, 1, False, True), Interval(1, 2, True, False))
156. 
157.     assert FiniteSet(1, 2, 3) - FiniteSet(2) == FiniteSet(1, 3)
158.     assert FiniteSet('ham', 'eggs') - FiniteSet('eggs') == FiniteSet('ham')
159.     assert FiniteSet(1, 2, 3, 4) - Interval(2, 10, True, False) == \
160.         FiniteSet(1, 2)
161.     assert FiniteSet(1, 2, 3, 4) - S.EmptySet == FiniteSet(1, 2, 3, 4)
162.     assert Union(Interval(0, 2), FiniteSet(2, 3, 4)) - Interval(1, 3) == \
163.         Union(Interval(0, 1, False, True), FiniteSet(4))
164. 
165.     assert -1 in S.Reals - S.Naturals
166. 
167. 
168. def test_Complement():
169.     assert Complement(Interval(1, 3), Interval(1, 2)) == Interval(2, 3, True)
170.     assert Complement(FiniteSet(1, 3, 4), FiniteSet(3, 4)) == FiniteSet(1)
171.     assert Complement(Union(Interval(0, 2),
172.                             FiniteSet(2, 3, 4)), Interval(1, 3)) == \
173.         Union(Interval(0, 1, False, True), FiniteSet(4))
174. 
175.     assert not 3 in Complement(Interval(0, 5), Interval(1, 4), evaluate=False)
176.     assert -1 in Complement(S.Reals, S.Naturals, evaluate=False)
177.     assert not 1 in Complement(S.Reals, S.Naturals, evaluate=False)
178. 
179.     assert Complement(S.Integers, S.UniversalSet) == EmptySet()
180.     assert S.UniversalSet.complement(S.Integers) == EmptySet()
181. 
182.     assert (not 0 in S.Reals.intersect(S.Integers - FiniteSet(0)))
183. 
184.     assert S.EmptySet - S.Integers == S.EmptySet
185. 
186.     assert (S.Integers - FiniteSet(0)) - FiniteSet(1) == S.Integers - FiniteSet(0, 1)
187. 
188.     assert S.Reals - Union(S.Naturals, FiniteSet(pi)) == \
189.             Intersection(S.Reals - S.Naturals, S.Reals - FiniteSet(pi))
190. 
191. def test_complement():
192.     assert Interval(0, 1).complement(S.Reals) == \
193.         Union(Interval(-oo, 0, True, True), Interval(1, oo, True, True))
194.     assert Interval(0, 1, True, False).complement(S.Reals) == \
195.         Union(Interval(-oo, 0, True, False), Interval(1, oo, True, True))
196.     assert Interval(0, 1, False, True).complement(S.Reals) == \
197.         Union(Interval(-oo, 0, True, True), Interval(1, oo, False, True))
198.     assert Interval(0, 1, True, True).complement(S.Reals) == \
199.         Union(Interval(-oo, 0, True, False), Interval(1, oo, False, True))
200. 
201.     assert S.UniversalSet.complement(S.EmptySet) == S.EmptySet
202.     assert S.UniversalSet.complement(S.Reals) == S.EmptySet
203.     assert S.UniversalSet.complement(S.UniversalSet) == S.EmptySet
204. 
205.     assert S.EmptySet.complement(S.Reals) == S.Reals
206. 
207.     assert Union(Interval(0, 1), Interval(2, 3)).complement(S.Reals) == \
208.         Union(Interval(-oo, 0, True, True), Interval(1, 2, True, True),
209.               Interval(3, oo, True, True))
210. 
211.     assert FiniteSet(0).complement(S.Reals) ==  \
212.         Union(Interval(-oo, 0, True, True), Interval(0, oo, True, True))
213. 
214.     assert (FiniteSet(5) + Interval(S.NegativeInfinity,
215.                                     0)).complement(S.Reals) == \
216.         Interval(0, 5, True, True) + Interval(5, S.Infinity, True, True)
217. 
218.     assert FiniteSet(1, 2, 3).complement(S.Reals) == \
219.         Interval(S.NegativeInfinity, 1, True, True) + \
220.         Interval(1, 2, True, True) + Interval(2, 3, True, True) +\
221.         Interval(3, S.Infinity, True, True)
222. 
223.     assert FiniteSet(x).complement(S.Reals) == Complement(S.Reals, FiniteSet(x))
224. 
225.     assert FiniteSet(0, x).complement(S.Reals) == Complement(Interval(-oo, 0, True, True) +
226.                                                              Interval(0, oo, True, True)
227.                                                              ,FiniteSet(x), evaluate=False)
228. 
229.     square = Interval(0, 1) * Interval(0, 1)
230.     notsquare = square.complement(S.Reals*S.Reals)
231. 
232.     assert all(pt in square for pt in [(0, 0), (.5, .5), (1, 0), (1, 1)])
233.     assert not any(
234.         pt in notsquare for pt in [(0, 0), (.5, .5), (1, 0), (1, 1)])
235.     assert not any(pt in square for pt in [(-1, 0), (1.5, .5), (10, 10)])
236.     assert all(pt in notsquare for pt in [(-1, 0), (1.5, .5), (10, 10)])
237. 
238. 
239. def test_intersect():
240.     x = Symbol('x')
241.     assert Interval(0, 2).intersect(Interval(1, 2)) == Interval(1, 2)
242.     assert Interval(0, 2).intersect(Interval(1, 2, True)) == \
243.         Interval(1, 2, True)
244.     assert Interval(0, 2, True).intersect(Interval(1, 2)) == \
245.         Interval(1, 2, False, False)
246.     assert Interval(0, 2, True, True).intersect(Interval(1, 2)) == \
247.         Interval(1, 2, False, True)
248.     assert Interval(0, 2).intersect(Union(Interval(0, 1), Interval(2, 3))) == \
249.         Union(Interval(0, 1), Interval(2, 2))
250. 
251.     assert FiniteSet(1, 2)._intersect((1, 2, 3)) == FiniteSet(1, 2)
252.     assert FiniteSet(1, 2, x).intersect(FiniteSet(x)) == FiniteSet(x)
253.     assert FiniteSet('ham', 'eggs').intersect(FiniteSet('ham')) == \
254.         FiniteSet('ham')
255.     assert FiniteSet(1, 2, 3, 4, 5).intersect(S.EmptySet) == S.EmptySet
256. 
257.     assert Interval(0, 5).intersect(FiniteSet(1, 3)) == FiniteSet(1, 3)
258.     assert Interval(0, 1, True, True).intersect(FiniteSet(1)) == S.EmptySet
259. 
260.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(Interval(1, 2)) == \
261.         Union(Interval(1, 1), Interval(2, 2))
262.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(Interval(0, 2)) == \
263.         Union(Interval(0, 1), Interval(2, 2))
264.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(Interval(1, 2, True, True)) == \
265.         S.EmptySet
266.     assert Union(Interval(0, 1), Interval(2, 3)).intersect(S.EmptySet) == \
267.         S.EmptySet
268.     assert Union(Interval(0, 5), FiniteSet('ham')).intersect(FiniteSet(2, 3, 4, 5, 6)) == \
269.         Union(FiniteSet(2, 3, 4, 5), Intersection(FiniteSet(6), Union(Interval(0, 5), FiniteSet('ham'))))
270. 
271.     # issue 8217
272.     assert Intersection(FiniteSet(x), FiniteSet(y)) == \
273.         Intersection(FiniteSet(x), FiniteSet(y), evaluate=False)
274.     assert FiniteSet(x).intersect(S.Reals) == \
275.         Intersection(S.Reals, FiniteSet(x), evaluate=False)
276. 
277.     # tests for the intersection alias
278.     assert Interval(0, 5).intersection(FiniteSet(1, 3)) == FiniteSet(1, 3)
279.     assert Interval(0, 1, True, True).intersection(FiniteSet(1)) == S.EmptySet
280. 
281.     assert Union(Interval(0, 1), Interval(2, 3)).intersection(Interval(1, 2)) == \
282.         Union(Interval(1, 1), Interval(2, 2))
283. 
284. 
285. def test_intersection():
286.     # iterable
287.     i = Intersection(FiniteSet(1, 2, 3), Interval(2, 5), evaluate=False)
288.     assert i.is_iterable
289.     assert set(i) == {S(2), S(3)}
290. 
291.     # challenging intervals
292.     x = Symbol('x', real=True)
293.     i = Intersection(Interval(0, 3), Interval(x, 6))
294.     assert (5 in i) is False
295.     raises(TypeError, lambda: 2 in i)
296. 
297.     # Singleton special cases
298.     assert Intersection(Interval(0, 1), S.EmptySet) == S.EmptySet
299.     assert Intersection(Interval(-oo, oo), Interval(-oo, x)) == Interval(-oo, x)
300. 
301.     # Products
302.     line = Interval(0, 5)
303.     i = Intersection(line**2, line**3, evaluate=False)
304.     assert (2, 2) not in i
305.     assert (2, 2, 2) not in i
306.     raises(ValueError, lambda: list(i))
307. 
308.     assert Intersection(Intersection(S.Integers, S.Naturals, evaluate=False),
309.                         S.Reals, evaluate=False) == \
310.             Intersection(S.Integers, S.Naturals, S.Reals, evaluate=False)
311. 
312.     assert Intersection(S.Complexes, FiniteSet(S.ComplexInfinity)) == S.EmptySet
313. 
314.     # issue 12178
315.     assert Intersection() == S.UniversalSet
316. 
317. def test_issue_9623():
318.     n = Symbol('n')
319. 
320.     a = S.Reals
321.     b = Interval(0, oo)
322.     c = FiniteSet(n)
323. 
324.     assert Intersection(a, b, c) == Intersection(b, c)
325.     assert Intersection(Interval(1, 2), Interval(3, 4), FiniteSet(n)) == EmptySet()
326. 
327. 
328. def test_is_disjoint():
329.     assert Interval(0, 2).is_disjoint(Interval(1, 2)) == False
330.     assert Interval(0, 2).is_disjoint(Interval(3, 4)) == True
331. 
332. 
333. def test_ProductSet_of_single_arg_is_arg():
334.     assert ProductSet(Interval(0, 1)) == Interval(0, 1)
335. 
336. 
337. def test_interval_subs():
338.     a = Symbol('a', real=True)
339. 
340.     assert Interval(0, a).subs(a, 2) == Interval(0, 2)
341.     assert Interval(a, 0).subs(a, 2) == S.EmptySet
342. 
343. 
344. def test_interval_to_mpi():
345.     assert Interval(0, 1).to_mpi() == mpi(0, 1)
346.     assert Interval(0, 1, True, False).to_mpi() == mpi(0, 1)
347.     assert type(Interval(0, 1).to_mpi()) == type(mpi(0, 1))
348. 
349. 
350. def test_measure():
351.     a = Symbol('a', real=True)
352. 
353.     assert Interval(1, 3).measure == 2
354.     assert Interval(0, a).measure == a
355.     assert Interval(1, a).measure == a - 1
356. 
357.     assert Union(Interval(1, 2), Interval(3, 4)).measure == 2
358.     assert Union(Interval(1, 2), Interval(3, 4), FiniteSet(5, 6, 7)).measure \
359.         == 2
360. 
361.     assert FiniteSet(1, 2, oo, a, -oo, -5).measure == 0
362. 
363.     assert S.EmptySet.measure == 0
364. 
365.     square = Interval(0, 10) * Interval(0, 10)
366.     offsetsquare = Interval(5, 15) * Interval(5, 15)
367.     band = Interval(-oo, oo) * Interval(2, 4)
368. 
369.     assert square.measure == offsetsquare.measure == 100
370.     assert (square + offsetsquare).measure == 175  # there is some overlap
371.     assert (square - offsetsquare).measure == 75
372.     assert (square * FiniteSet(1, 2, 3)).measure == 0
373.     assert (square.intersect(band)).measure == 20
374.     assert (square + band).measure == oo
375.     assert (band * FiniteSet(1, 2, 3)).measure == nan
376. 
377. 
378. def test_is_subset():
379.     assert Interval(0, 1).is_subset(Interval(0, 2)) is True
380.     assert Interval(0, 3).is_subset(Interval(0, 2)) is False
381. 
382.     assert FiniteSet(1, 2).is_subset(FiniteSet(1, 2, 3, 4))
383.     assert FiniteSet(4, 5).is_subset(FiniteSet(1, 2, 3, 4)) is False
384.     assert FiniteSet(1).is_subset(Interval(0, 2))
385.     assert FiniteSet(1, 2).is_subset(Interval(0, 2, True, True)) is False
386.     assert (Interval(1, 2) + FiniteSet(3)).is_subset(
387.         (Interval(0, 2, False, True) + FiniteSet(2, 3)))
388. 
389.     assert Interval(3, 4).is_subset(Union(Interval(0, 1), Interval(2, 5))) is True
390.     assert Interval(3, 6).is_subset(Union(Interval(0, 1), Interval(2, 5))) is False
391. 
392.     assert FiniteSet(1, 2, 3, 4).is_subset(Interval(0, 5)) is True
393.     assert S.EmptySet.is_subset(FiniteSet(1, 2, 3)) is True
394. 
395.     assert Interval(0, 1).is_subset(S.EmptySet) is False
396.     assert S.EmptySet.is_subset(S.EmptySet) is True
397. 
398.     raises(ValueError, lambda: S.EmptySet.is_subset(1))
399. 
400.     # tests for the issubset alias
401.     assert FiniteSet(1, 2, 3, 4).issubset(Interval(0, 5)) is True
402.     assert S.EmptySet.issubset(FiniteSet(1, 2, 3)) is True
403. 
404. 
405. def test_is_proper_subset():
406.     assert Interval(0, 1).is_proper_subset(Interval(0, 2)) is True
407.     assert Interval(0, 3).is_proper_subset(Interval(0, 2)) is False
408.     assert S.EmptySet.is_proper_subset(FiniteSet(1, 2, 3)) is True
409. 
410.     raises(ValueError, lambda: Interval(0, 1).is_proper_subset(0))
411. 
412. 
413. def test_is_superset():
414.     assert Interval(0, 1).is_superset(Interval(0, 2)) == False
415.     assert Interval(0, 3).is_superset(Interval(0, 2))
416. 
417.     assert FiniteSet(1, 2).is_superset(FiniteSet(1, 2, 3, 4)) == False
418.     assert FiniteSet(4, 5).is_superset(FiniteSet(1, 2, 3, 4)) == False
419.     assert FiniteSet(1).is_superset(Interval(0, 2)) == False
420.     assert FiniteSet(1, 2).is_superset(Interval(0, 2, True, True)) == False
421.     assert (Interval(1, 2) + FiniteSet(3)).is_superset(
422.         (Interval(0, 2, False, True) + FiniteSet(2, 3))) == False
423. 
424.     assert Interval(3, 4).is_superset(Union(Interval(0, 1), Interval(2, 5))) == False
425. 
426.     assert FiniteSet(1, 2, 3, 4).is_superset(Interval(0, 5)) == False
427.     assert S.EmptySet.is_superset(FiniteSet(1, 2, 3)) == False
428. 
429.     assert Interval(0, 1).is_superset(S.EmptySet) == True
430.     assert S.EmptySet.is_superset(S.EmptySet) == True
431. 
432.     raises(ValueError, lambda: S.EmptySet.is_superset(1))
433. 
434.     # tests for the issuperset alias
435.     assert Interval(0, 1).issuperset(S.EmptySet) == True
436.     assert S.EmptySet.issuperset(S.EmptySet) == True
437. 
438. 
439. def test_is_proper_superset():
440.     assert Interval(0, 1).is_proper_superset(Interval(0, 2)) is False
441.     assert Interval(0, 3).is_proper_superset(Interval(0, 2)) is True
442.     assert FiniteSet(1, 2, 3).is_proper_superset(S.EmptySet) is True
443. 
444.     raises(ValueError, lambda: Interval(0, 1).is_proper_superset(0))
445. 
446. 
447. def test_contains():
448.     assert Interval(0, 2).contains(1) is S.true
449.     assert Interval(0, 2).contains(3) is S.false
450.     assert Interval(0, 2, True, False).contains(0) is S.false
451.     assert Interval(0, 2, True, False).contains(2) is S.true
452.     assert Interval(0, 2, False, True).contains(0) is S.true
453.     assert Interval(0, 2, False, True).contains(2) is S.false
454.     assert Interval(0, 2, True, True).contains(0) is S.false
455.     assert Interval(0, 2, True, True).contains(2) is S.false
456. 
457.     assert (Interval(0, 2) in Interval(0, 2)) is False
458. 
459.     assert FiniteSet(1, 2, 3).contains(2) is S.true
460.     assert FiniteSet(1, 2, Symbol('x')).contains(Symbol('x')) is S.true
461. 
462.     # issue 8197
463.     from sympy.abc import a, b
464.     assert isinstance(FiniteSet(b).contains(-a), Contains)
465.     assert isinstance(FiniteSet(b).contains(a), Contains)
466.     assert isinstance(FiniteSet(a).contains(1), Contains)
467.     raises(TypeError, lambda: 1 in FiniteSet(a))
468. 
469.     # issue 8209
470.     rad1 = Pow(Pow(2, S(1)/3) - 1, S(1)/3)
471.     rad2 = Pow(S(1)/9, S(1)/3) - Pow(S(2)/9, S(1)/3) + Pow(S(4)/9, S(1)/3)
472.     s1 = FiniteSet(rad1)
473.     s2 = FiniteSet(rad2)
474.     assert s1 - s2 == S.EmptySet
475. 
476.     items = [1, 2, S.Infinity, S('ham'), -1.1]
477.     fset = FiniteSet(*items)
478.     assert all(item in fset for item in items)
479.     assert all(fset.contains(item) is S.true for item in items)
480. 
481.     assert Union(Interval(0, 1), Interval(2, 5)).contains(3) is S.true
482.     assert Union(Interval(0, 1), Interval(2, 5)).contains(6) is S.false
483.     assert Union(Interval(0, 1), FiniteSet(2, 5)).contains(3) is S.false
484. 
485.     assert S.EmptySet.contains(1) is S.false
486.     assert FiniteSet(rootof(x**3 + x - 1, 0)).contains(S.Infinity) is S.false
487. 
488.     assert rootof(x**5 + x**3 + 1, 0) in S.Reals
489.     assert not rootof(x**5 + x**3 + 1, 1) in S.Reals
490. 
491.     # non-bool results
492.     assert Union(Interval(1, 2), Interval(3, 4)).contains(x) == \
493.         Or(And(x <= 2, x >= 1), And(x <= 4, x >= 3))
494.     assert Intersection(Interval(1, x), Interval(2, 3)).contains(y) == \
495.         And(y <= 3, y <= x, y >= 1, y >= 2)
496. 
497.     assert (S.Complexes).contains(S.ComplexInfinity) == S.false
498. 
499. 
500. def test_interval_symbolic():
501.     x = Symbol('x')
502.     e = Interval(0, 1)
503.     assert e.contains(x) == And(0 <= x, x <= 1)
504.     raises(TypeError, lambda: x in e)
505.     e = Interval(0, 1, True, True)
506.     assert e.contains(x) == And(0 < x, x < 1)
507. 
508. 
509. def test_union_contains():
510.     x = Symbol('x')
511.     i1 = Interval(0, 1)
512.     i2 = Interval(2, 3)
513.     i3 = Union(i1, i2)
514.     raises(TypeError, lambda: x in i3)
515.     e = i3.contains(x)
516.     assert e == Or(And(0 <= x, x <= 1), And(2 <= x, x <= 3))
517.     assert e.subs(x, -0.5) is false
518.     assert e.subs(x, 0.5) is true
519.     assert e.subs(x, 1.5) is false
520.     assert e.subs(x, 2.5) is true
521.     assert e.subs(x, 3.5) is false
522. 
523.     U = Interval(0, 2, True, True) + Interval(10, oo) + FiniteSet(-1, 2, 5, 6)
524.     assert all(el not in U for el in [0, 4, -oo])
525.     assert all(el in U for el in [2, 5, 10])
526. 
527. 
528. def test_is_number():
529.     assert Interval(0, 1).is_number is False
530.     assert Set().is_number is False
531. 
532. 
533. def test_Interval_is_left_unbounded():
534.     assert Interval(3, 4).is_left_unbounded is False
535.     assert Interval(-oo, 3).is_left_unbounded is True
536.     assert Interval(Float("-inf"), 3).is_left_unbounded is True
537. 
538. 
539. def test_Interval_is_right_unbounded():
540.     assert Interval(3, 4).is_right_unbounded is False
541.     assert Interval(3, oo).is_right_unbounded is True
542.     assert Interval(3, Float("+inf")).is_right_unbounded is True
543. 
544. 
545. def test_Interval_as_relational():
546.     x = Symbol('x')
547. 
548.     assert Interval(-1, 2, False, False).as_relational(x) == \
549.         And(Le(-1, x), Le(x, 2))
550.     assert Interval(-1, 2, True, False).as_relational(x) == \
551.         And(Lt(-1, x), Le(x, 2))
552.     assert Interval(-1, 2, False, True).as_relational(x) == \
553.         And(Le(-1, x), Lt(x, 2))
554.     assert Interval(-1, 2, True, True).as_relational(x) == \
555.         And(Lt(-1, x), Lt(x, 2))
556. 
557.     assert Interval(-oo, 2, right_open=False).as_relational(x) == And(Lt(-oo, x), Le(x, 2))
558.     assert Interval(-oo, 2, right_open=True).as_relational(x) == And(Lt(-oo, x), Lt(x, 2))
559. 
560.     assert Interval(-2, oo, left_open=False).as_relational(x) == And(Le(-2, x), Lt(x, oo))
561.     assert Interval(-2, oo, left_open=True).as_relational(x) == And(Lt(-2, x), Lt(x, oo))
562. 
563.     assert Interval(-oo, oo).as_relational(x) == And(Lt(-oo, x), Lt(x, oo))
564.     x = Symbol('x', real=True)
565.     y = Symbol('y', real=True)
566.     assert Interval(x, y).as_relational(x) == (x <= y)
567.     assert Interval(y, x).as_relational(x) == (y <= x)
568. 
569. 
570. def test_Finite_as_relational():
571.     x = Symbol('x')
572.     y = Symbol('y')
573. 
574.     assert FiniteSet(1, 2).as_relational(x) == Or(Eq(x, 1), Eq(x, 2))
575.     assert FiniteSet(y, -5).as_relational(x) == Or(Eq(x, y), Eq(x, -5))
576. 
577. 
578. def test_Union_as_relational():
579.     x = Symbol('x')
580.     assert (Interval(0, 1) + FiniteSet(2)).as_relational(x) == \
581.         Or(And(Le(0, x), Le(x, 1)), Eq(x, 2))
582.     assert (Interval(0, 1, True, True) + FiniteSet(1)).as_relational(x) == \
583.         And(Lt(0, x), Le(x, 1))
584. 
585. 
586. def test_Intersection_as_relational():
587.     x = Symbol('x')
588.     assert (Intersection(Interval(0, 1), FiniteSet(2),
589.             evaluate=False).as_relational(x)
590.             == And(And(Le(0, x), Le(x, 1)), Eq(x, 2)))
591. 
592. 
593. def test_EmptySet():
594.     assert S.EmptySet.as_relational(Symbol('x')) is S.false
595.     assert S.EmptySet.intersect(S.UniversalSet) == S.EmptySet
596.     assert S.EmptySet.boundary == S.EmptySet
597. 
598. 
599. def test_finite_basic():
600.     x = Symbol('x')
601.     A = FiniteSet(1, 2, 3)
602.     B = FiniteSet(3, 4, 5)
603.     AorB = Union(A, B)
604.     AandB = A.intersect(B)
605.     assert A.is_subset(AorB) and B.is_subset(AorB)
606.     assert AandB.is_subset(A)
607.     assert AandB == FiniteSet(3)
608. 
609.     assert A.inf == 1 and A.sup == 3
610.     assert AorB.inf == 1 and AorB.sup == 5
611.     assert FiniteSet(x, 1, 5).sup == Max(x, 5)
612.     assert FiniteSet(x, 1, 5).inf == Min(x, 1)
613. 
614.     # issue 7335
615.     assert FiniteSet(S.EmptySet) != S.EmptySet
616.     assert FiniteSet(FiniteSet(1, 2, 3)) != FiniteSet(1, 2, 3)
617.     assert FiniteSet((1, 2, 3)) != FiniteSet(1, 2, 3)
618. 
619.     # Ensure a variety of types can exist in a FiniteSet
620.     s = FiniteSet((1, 2), Float, A, -5, x, 'eggs', x**2, Interval)
621. 
622.     assert (A > B) is False
623.     assert (A >= B) is False
624.     assert (A < B) is False
625.     assert (A <= B) is False
626.     assert AorB > A and AorB > B
627.     assert AorB >= A and AorB >= B
628.     assert A >= A and A <= A
629.     assert A >= AandB and B >= AandB
630.     assert A > AandB and B > AandB
631. 
632. 
633. def test_powerset():
634.     # EmptySet
635.     A = FiniteSet()
636.     pset = A.powerset()
637.     assert len(pset) == 1
638.     assert pset ==  FiniteSet(S.EmptySet)
639. 
640.     # FiniteSets
641.     A = FiniteSet(1, 2)
642.     pset = A.powerset()
643.     assert len(pset) == 2**len(A)
644.     assert pset == FiniteSet(FiniteSet(), FiniteSet(1),
645.                              FiniteSet(2), A)
646.     # Not finite sets
647.     I = Interval(0, 1)
648.     raises(NotImplementedError, I.powerset)
649. 
650. 
651. def test_product_basic():
652.     H, T = 'H', 'T'
653.     unit_line = Interval(0, 1)
654.     d6 = FiniteSet(1, 2, 3, 4, 5, 6)
655.     d4 = FiniteSet(1, 2, 3, 4)
656.     coin = FiniteSet(H, T)
657. 
658.     square = unit_line * unit_line
659. 
660.     assert (0, 0) in square
661.     assert 0 not in square
662.     assert (H, T) in coin ** 2
663.     assert (.5, .5, .5) in square * unit_line
664.     assert (H, 3, 3) in coin * d6* d6
665.     HH, TT = sympify(H), sympify(T)
666.     assert set(coin**2) == set(((HH, HH), (HH, TT), (TT, HH), (TT, TT)))
667. 
668.     assert (d4*d4).is_subset(d6*d6)
669. 
670.     assert square.complement(Interval(-oo, oo)*Interval(-oo, oo)) == Union(
671.         (Interval(-oo, 0, True, True) +
672.          Interval(1, oo, True, True))*Interval(-oo, oo),
673.          Interval(-oo, oo)*(Interval(-oo, 0, True, True) +
674.                   Interval(1, oo, True, True)))
675. 
676.     assert (Interval(-5, 5)**3).is_subset(Interval(-10, 10)**3)
677.     assert not (Interval(-10, 10)**3).is_subset(Interval(-5, 5)**3)
678.     assert not (Interval(-5, 5)**2).is_subset(Interval(-10, 10)**3)
679. 
680.     assert (Interval(.2, .5)*FiniteSet(.5)).is_subset(square)  # segment in square
681. 
682.     assert len(coin*coin*coin) == 8
683.     assert len(S.EmptySet*S.EmptySet) == 0
684.     assert len(S.EmptySet*coin) == 0
685.     raises(TypeError, lambda: len(coin*Interval(0, 2)))
686. 
687. 
688. def test_real():
689.     x = Symbol('x', real=True, finite=True)
690. 
691.     I = Interval(0, 5)
692.     J = Interval(10, 20)
693.     A = FiniteSet(1, 2, 30, x, S.Pi)
694.     B = FiniteSet(-4, 0)
695.     C = FiniteSet(100)
696.     D = FiniteSet('Ham', 'Eggs')
697. 
698.     assert all(s.is_subset(S.Reals) for s in [I, J, A, B, C])
699.     assert not D.is_subset(S.Reals)
700.     assert all((a + b).is_subset(S.Reals) for a in [I, J, A, B, C] for b in [I, J, A, B, C])
701.     assert not any((a + D).is_subset(S.Reals) for a in [I, J, A, B, C, D])
702. 
703.     assert not (I + A + D).is_subset(S.Reals)
704. 
705. 
706. def test_supinf():
707.     x = Symbol('x', real=True)
708.     y = Symbol('y', real=True)
709. 
710.     assert (Interval(0, 1) + FiniteSet(2)).sup == 2
711.     assert (Interval(0, 1) + FiniteSet(2)).inf == 0
712.     assert (Interval(0, 1) + FiniteSet(x)).sup == Max(1, x)
713.     assert (Interval(0, 1) + FiniteSet(x)).inf == Min(0, x)
714.     assert FiniteSet(5, 1, x).sup == Max(5, x)
715.     assert FiniteSet(5, 1, x).inf == Min(1, x)
716.     assert FiniteSet(5, 1, x, y).sup == Max(5, x, y)
717.     assert FiniteSet(5, 1, x, y).inf == Min(1, x, y)
718.     assert FiniteSet(5, 1, x, y, S.Infinity, S.NegativeInfinity).sup == \
719.         S.Infinity
720.     assert FiniteSet(5, 1, x, y, S.Infinity, S.NegativeInfinity).inf == \
721.         S.NegativeInfinity
722.     assert FiniteSet('Ham', 'Eggs').sup == Max('Ham', 'Eggs')
723. 
724. 
725. def test_universalset():
726.     U = S.UniversalSet
727.     x = Symbol('x')
728.     assert U.as_relational(x) is S.true
729.     assert U.union(Interval(2, 4)) == U
730. 
731.     assert U.intersect(Interval(2, 4)) == Interval(2, 4)
732.     assert U.measure == S.Infinity
733.     assert U.boundary == S.EmptySet
734.     assert U.contains(0) is S.true
735. 
736. 
737. def test_Union_of_ProductSets_shares():
738.     line = Interval(0, 2)
739.     points = FiniteSet(0, 1, 2)
740.     assert Union(line * line, line * points) == line * line
741. 
742. 
743. def test_Interval_free_symbols():
744.     # issue 6211
745.     assert Interval(0, 1).free_symbols == set()
746.     x = Symbol('x', real=True)
747.     assert Interval(0, x).free_symbols == {x}
748. 
749. 
750. def test_image_interval():
751.     from sympy.core.numbers import Rational
752.     x = Symbol('x', real=True)
753.     a = Symbol('a', real=True)
754.     assert imageset(x, 2*x, Interval(-2, 1)) == Interval(-4, 2)
755.     assert imageset(x, 2*x, Interval(-2, 1, True, False)) == \
756.         Interval(-4, 2, True, False)
757.     assert imageset(x, x**2, Interval(-2, 1, True, False)) == \
758.         Interval(0, 4, False, True)
759.     assert imageset(x, x**2, Interval(-2, 1)) == Interval(0, 4)
760.     assert imageset(x, x**2, Interval(-2, 1, True, False)) == \
761.         Interval(0, 4, False, True)
762.     assert imageset(x, x**2, Interval(-2, 1, True, True)) == \
763.         Interval(0, 4, False, True)
764.     assert imageset(x, (x - 2)**2, Interval(1, 3)) == Interval(0, 1)
765.     assert imageset(x, 3*x**4 - 26*x**3 + 78*x**2 - 90*x, Interval(0, 4)) == \
766.         Interval(-35, 0)  # Multiple Maxima
767.     assert imageset(x, x + 1/x, Interval(-oo, oo)) == Interval(-oo, -2) \
768.         + Interval(2, oo)  # Single Infinite discontinuity
769.     assert imageset(x, 1/x + 1/(x-1)**2, Interval(0, 2, True, False)) == \
770.         Interval(Rational(3, 2), oo, False)  # Multiple Infinite discontinuities
771. 
772.     # Test for Python lambda
773.     assert imageset(lambda x: 2*x, Interval(-2, 1)) == Interval(-4, 2)
774. 
775.     assert imageset(Lambda(x, a*x), Interval(0, 1)) == \
776.             ImageSet(Lambda(x, a*x), Interval(0, 1))
777. 
778.     assert imageset(Lambda(x, sin(cos(x))), Interval(0, 1)) == \
779.             ImageSet(Lambda(x, sin(cos(x))), Interval(0, 1))
780. 
781. 
782. def test_image_piecewise():
783.     f = Piecewise((x, x <= -1), (1/x**2, x <= 5), (x**3, True))
784.     f1 = Piecewise((0, x <= 1), (1, x <= 2), (2, True))
785.     assert imageset(x, f, Interval(-5, 5)) == Union(Interval(-5, -1), Interval(S(1)/25, oo))
786.     assert imageset(x, f1, Interval(1, 2)) == FiniteSet(0, 1)
787. 
788. 
789. @XFAIL  # See: https://github.com/sympy/sympy/pull/2723#discussion_r8659826
790. def test_image_Intersection():
791.     x = Symbol('x', real=True)
792.     y = Symbol('y', real=True)
793.     assert imageset(x, x**2, Interval(-2, 0).intersect(Interval(x, y))) == \
794.            Interval(0, 4).intersect(Interval(Min(x**2, y**2), Max(x**2, y**2)))
795. 
796. 
797. def test_image_FiniteSet():
798.     x = Symbol('x', real=True)
799.     assert imageset(x, 2*x, FiniteSet(1, 2, 3)) == FiniteSet(2, 4, 6)
800. 
801. def test_image_Union():
802.     x = Symbol('x', real=True)
803.     assert imageset(x, x**2, Interval(-2, 0) + FiniteSet(1, 2, 3)) == \
804.             (Interval(0, 4) + FiniteSet(9))
805. 
806. 
807. def test_image_EmptySet():
808.     x = Symbol('x', real=True)
809.     assert imageset(x, 2*x, S.EmptySet) == S.EmptySet
810. 
811. 
812. def test_issue_5724_7680():
813.     assert I not in S.Reals  # issue 7680
814.     assert Interval(-oo, oo).contains(I) is S.false
815. 
816. 
817. def test_boundary():
818.     x = Symbol('x', real=True)
819.     y = Symbol('y', real=True)
820.     assert FiniteSet(1).boundary == FiniteSet(1)
821.     assert all(Interval(0, 1, left_open, right_open).boundary == FiniteSet(0, 1)
822.             for left_open in (true, false) for right_open in (true, false))
823. 
824. 
825. def test_boundary_Union():
826.     assert (Interval(0, 1) + Interval(2, 3)).boundary == FiniteSet(0, 1, 2, 3)
827.     assert ((Interval(0, 1, False, True)
828.            + Interval(1, 2, True, False)).boundary == FiniteSet(0, 1, 2))
829. 
830.     assert (Interval(0, 1) + FiniteSet(2)).boundary == FiniteSet(0, 1, 2)
831.     assert Union(Interval(0, 10), Interval(5, 15), evaluate=False).boundary \
832.             == FiniteSet(0, 15)
833. 
834.     assert Union(Interval(0, 10), Interval(0, 1), evaluate=False).boundary \
835.             == FiniteSet(0, 10)
836.     assert Union(Interval(0, 10, True, True),
837.                  Interval(10, 15, True, True), evaluate=False).boundary \
838.             == FiniteSet(0, 10, 15)
839. 
840. 
841. @XFAIL
842. def test_union_boundary_of_joining_sets():
843.     """ Testing the boundary of unions is a hard problem """
844.     assert Union(Interval(0, 10), Interval(10, 15), evaluate=False).boundary \
845.             == FiniteSet(0, 15)
846. 
847. 
848. def test_boundary_ProductSet():
849.     open_square = Interval(0, 1, True, True) ** 2
850.     assert open_square.boundary == (FiniteSet(0, 1) * Interval(0, 1)
851.                                   + Interval(0, 1) * FiniteSet(0, 1))
852. 
853.     second_square = Interval(1, 2, True, True) * Interval(0, 1, True, True)
854.     assert (open_square + second_square).boundary == (
855.                 FiniteSet(0, 1) * Interval(0, 1)
856.               + FiniteSet(1, 2) * Interval(0, 1)
857.               + Interval(0, 1) * FiniteSet(0, 1)
858.               + Interval(1, 2) * FiniteSet(0, 1))
859. 
860. 
861. def test_boundary_ProductSet_line():
862.     line_in_r2 = Interval(0, 1) * FiniteSet(0)
863.     assert line_in_r2.boundary == line_in_r2
864. 
865. 
866. def test_is_open():
867.     assert not Interval(0, 1, False, False).is_open
868.     assert not Interval(0, 1, True, False).is_open
869.     assert Interval(0, 1, True, True).is_open
870.     assert not FiniteSet(1, 2, 3).is_open
871. 
872. 
873. def test_is_closed():
874.     assert Interval(0, 1, False, False).is_closed
875.     assert not Interval(0, 1, True, False).is_closed
876.     assert FiniteSet(1, 2, 3).is_closed
877. 
878. 
879. def test_closure():
880.     assert Interval(0, 1, False, True).closure == Interval(0, 1, False, False)
881. 
882. 
883. def test_interior():
884.     assert Interval(0, 1, False, True).interior == Interval(0, 1, True, True)
885. 
886. 
887. def test_issue_7841():
888.     raises(TypeError, lambda: x in S.Reals)
889. 
890. 
891. def test_Eq():
892.     assert Eq(Interval(0, 1), Interval(0, 1))
893.     assert Eq(Interval(0, 1), Interval(0, 2)) == False
894. 
895.     s1 = FiniteSet(0, 1)
896.     s2 = FiniteSet(1, 2)
897. 
898.     assert Eq(s1, s1)
899.     assert Eq(s1, s2) == False
900. 
901.     assert Eq(s1*s2, s1*s2)
902.     assert Eq(s1*s2, s2*s1) == False
903. 
904. 
905. def test_SymmetricDifference():
906.    assert SymmetricDifference(FiniteSet(0, 1, 2, 3, 4, 5), \
907.           FiniteSet(2, 4, 6, 8, 10)) == FiniteSet(0, 1, 3, 5, 6, 8, 10)
908.    assert SymmetricDifference(FiniteSet(2, 3, 4), FiniteSet(2, 3 ,4 ,5 )) \
909.           == FiniteSet(5)
910.    assert FiniteSet(1, 2, 3, 4, 5) ^ FiniteSet(1, 2, 5, 6) == \
911.           FiniteSet(3, 4, 6)
912.    assert Set(1, 2 ,3) ^ Set(2, 3, 4) == Union(Set(1, 2, 3) - Set(2, 3, 4), \
913.           Set(2, 3, 4) - Set(1, 2, 3))
914.    assert Interval(0, 4) ^ Interval(2, 5) == Union(Interval(0, 4) - \
915.           Interval(2, 5), Interval(2, 5) - Interval(0, 4))
916. 
917. 
918. def test_issue_9536():
919.     from sympy.functions.elementary.exponential import log
920.     a = Symbol('a', real=True)
921.     assert FiniteSet(log(a)).intersect(S.Reals) == Intersection(S.Reals, FiniteSet(log(a)))
922. 
923. 
924. def test_issue_9637():
925.     n = Symbol('n')
926.     a = FiniteSet(n)
927.     b = FiniteSet(2, n)
928.     assert Complement(S.Reals, a) == Complement(S.Reals, a, evaluate=False)
929.     assert Complement(Interval(1, 3), a) == Complement(Interval(1, 3), a, evaluate=False)
930.     assert Complement(Interval(1, 3), b) == \
931.         Complement(Union(Interval(1, 2, False, True), Interval(2, 3, True, False)), a)
932.     assert Complement(a, S.Reals) == Complement(a, S.Reals, evaluate=False)
933.     assert Complement(a, Interval(1, 3)) == Complement(a, Interval(1, 3), evaluate=False)
934. 
935. 
936. def test_issue_9808():
937.     assert Complement(FiniteSet(y), FiniteSet(1)) == Complement(FiniteSet(y), FiniteSet(1), evaluate=False)
938.     assert Complement(FiniteSet(1, 2, x), FiniteSet(x, y, 2, 3)) == \
939.         Complement(FiniteSet(1), FiniteSet(y), evaluate=False)
940. 
941. 
942. def test_issue_9956():
943.     assert Union(Interval(-oo, oo), FiniteSet(1)) == Interval(-oo, oo)
944.     assert Interval(-oo, oo).contains(1) is S.true
945. 
946. 
947. def test_issue_Symbol_inter():
948.     i = Interval(0, oo)
949.     r = S.Reals
950.     mat = Matrix([0, 0, 0])
951.     assert Intersection(r, i, FiniteSet(m), FiniteSet(m, n)) == \
952.         Intersection(i, FiniteSet(m))
953.     assert Intersection(FiniteSet(1, m, n), FiniteSet(m, n, 2), i) == \
954.         Intersection(i, FiniteSet(m, n))
955.     assert Intersection(FiniteSet(m, n, x), FiniteSet(m, z), r) == \
956.         Intersection(r, FiniteSet(m, z), FiniteSet(n, x))
957.     assert Intersection(FiniteSet(m, n, 3), FiniteSet(m, n, x), r) == \
958.         Intersection(r, FiniteSet(3, m, n), evaluate=False)
959.     assert Intersection(FiniteSet(m, n, 3), FiniteSet(m, n, 2, 3), r) == \
960.         Union(FiniteSet(3), Intersection(r, FiniteSet(m, n)))
961.     assert Intersection(r, FiniteSet(mat, 2, n), FiniteSet(0, mat, n)) == \
962.         Intersection(r, FiniteSet(n))
963.     assert Intersection(FiniteSet(sin(x), cos(x)), FiniteSet(sin(x), cos(x), 1), r) == \
964.         Intersection(r, FiniteSet(sin(x), cos(x)))
965.     assert Intersection(FiniteSet(x**2, 1, sin(x)), FiniteSet(x**2, 2, sin(x)), r) == \
966.         Intersection(r, FiniteSet(x**2, sin(x)))
967. 
968. def test_issue_11827():
969.     assert S.Naturals0**4
970. 
971. def test_issue_10113():
972.     f = x**2/(x**2 - 4)
973.     assert imageset(x, f, S.Reals) == Union(Interval(-oo, 0), Interval(1, oo, True, True))
974.     assert imageset(x, f, Interval(-2, 2)) == Interval(-oo, 0)
975.     assert imageset(x, f, Interval(-2, 3)) == Union(Interval(-oo, 0), Interval(S(9)/5, oo))
976. 
977. 
978. def test_issue_10248():
979.     assert list(Intersection(S.Reals, FiniteSet(x))) == [
980.         And(x < oo, x > -oo)]
981. 
982. 
983. def test_issue_9447():
984.     a = Interval(0, 1) + Interval(2, 3)
985.     assert Complement(S.UniversalSet, a) == Complement(
986.             S.UniversalSet, Union(Interval(0, 1), Interval(2, 3)), evaluate=False)
987.     assert Complement(S.Naturals, a) == Complement(
988.             S.Naturals, Union(Interval(0, 1), Interval(2, 3)), evaluate=False)
989. 
990. 
991. def test_issue_10337():
992.     assert (FiniteSet(2) == 3) is False
993.     assert (FiniteSet(2) != 3) is True
994.     raises(TypeError, lambda: FiniteSet(2) < 3)
995.     raises(TypeError, lambda: FiniteSet(2) <= 3)
996.     raises(TypeError, lambda: FiniteSet(2) > 3)
997.     raises(TypeError, lambda: FiniteSet(2) >= 3)
998. 
999. 
1000. def test_issue_10326():
1001.     bad = [
1002.         EmptySet(),
1003.         FiniteSet(1),
1004.         Interval(1, 2),
1005.         S.ComplexInfinity,
1006.         S.ImaginaryUnit,
1007.         S.Infinity,
1008.         S.NaN,
1009.         S.NegativeInfinity,
1010.         ]
1011.     interval = Interval(0, 5)
1012.     for i in bad:
1013.         assert i not in interval
1014. 
1015.     x = Symbol('x', real=True)
1016.     nr = Symbol('nr', real=False)
1017.     assert x + 1 in Interval(x, x + 4)
1018.     assert nr not in Interval(x, x + 4)
1019.     assert Interval(1, 2) in FiniteSet(Interval(0, 5), Interval(1, 2))
1020.     assert Interval(-oo, oo).contains(oo) is S.false
1021.     assert Interval(-oo, oo).contains(-oo) is S.false
1022. 
1023. 
1024. def test_issue_2799():
1025.     U = S.UniversalSet
1026.     a = Symbol('a', real=True)
1027.     inf_interval = Interval(a, oo)
1028.     R = S.Reals
1029. 
1030.     assert U + inf_interval == inf_interval + U
1031.     assert U + R == R + U
1032.     assert R + inf_interval == inf_interval + R
1033. 
1034. 
1035. def test_issue_9706():
1036.     assert Interval(-oo, 0).closure == Interval(-oo, 0, True, False)
1037.     assert Interval(0, oo).closure == Interval(0, oo, False, True)
1038.     assert Interval(-oo, oo).closure == Interval(-oo, oo)
1039. 
1040. 
1041. def test_issue_8257():
1042.     reals_plus_infinity = Union(Interval(-oo, oo), FiniteSet(oo))
1043.     reals_plus_negativeinfinity = Union(Interval(-oo, oo), FiniteSet(-oo))
1044.     assert Interval(-oo, oo) + FiniteSet(oo) == reals_plus_infinity
1045.     assert FiniteSet(oo) + Interval(-oo, oo) == reals_plus_infinity
1046.     assert Interval(-oo, oo) + FiniteSet(-oo) == reals_plus_negativeinfinity
1047.     assert FiniteSet(-oo) + Interval(-oo, oo) == reals_plus_negativeinfinity
1048. 
1049. 
1050. def test_issue_10931():
1051.     assert S.Integers - S.Integers == EmptySet()
1052.     assert S.Integers - S.Reals == EmptySet()
1053. 
1054. 
1055. def test_issue_11174():
1056.     soln = Intersection(Interval(-oo, oo), FiniteSet(-x), evaluate=False)
1057.     assert Intersection(FiniteSet(-x), S.Reals) == soln
1058. 
1059.     soln = Intersection(S.Reals, FiniteSet(x), evaluate=False)
1060.     assert Intersection(FiniteSet(x), S.Reals) == soln

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 19:05:37,265 - thread-124708053845696.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have the full content of `sympy/sets/tests/test_sets.py`, which contains multiple test cases for `Complement` operations involving `FiniteSet`, symbols, and numbers. I can identify `test_issue_9637`, `test_issue_9808`, and parts of `test_complement` as highly relevant to the bug report and the provided patch. The file includes all necessary imports and definitions to make these test cases self-contained. Therefore, I have sufficient context to fulfill the user's request." query='' extra_requirements='' purpose=''
2025-12-21 19:05:37,266 - thread-124708053845696.prometheus_context_collector - INFO - Successfully retrieved 1 context snippets
