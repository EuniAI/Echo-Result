2025-12-21 01:06:58,021 - thread-131294979688128.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

Description: **Describe the bug**
viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

**To Reproduce**
```
$ make html epub
```

**Expected behavior**
module pages should not be created for epub by default.

**Your project**
No

**Screenshots**
No

**Environment info**
- OS: Mac
- Python version: 3.9.1
- Sphinx version: HEAD of 3.x
- Sphinx extensions:  sphinx.ext.viewcode
- Extra tools: No

**Additional context**
No


Patch information:
diff --git a/sphinx/ext/viewcode.py b/sphinx/ext/viewcode.py
index a7d52a91c..417f0db97 100644
--- a/sphinx/ext/viewcode.py
+++ b/sphinx/ext/viewcode.py
@@ -52,12 +52,12 @@ def _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str
 
 def doctree_read(app: Sphinx, doctree: Node) -> None:
     env = app.builder.env
-    if not hasattr(env, '_viewcode_modules'):
-        env._viewcode_modules = {}  # type: ignore
     if app.builder.name == "singlehtml":
         return
     if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
         return
+    if not hasattr(env, '_viewcode_modules'):
+        env._viewcode_modules = {}  # type: ignore
 
     def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:
         entry = env._viewcode_modules.get(modname, None)  # type: ignore
@@ -180,6 +180,10 @@ def should_generate_module_page(app: Sphinx, modname: str) -> bool:
 
 def collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:
     env = app.builder.env
+    if app.builder.name == "singlehtml":
+        return
+    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
+        return
     if not hasattr(env, '_viewcode_modules'):
         return
     highlighter = app.builder.highlighter  # type: ignore


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 01:06:58,080 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── lint.yml
|       ├── main.yml
|       └── nodejs.yml
├── .readthedocs.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   └── themes
|   |       └── fullsize
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── develop.rst
|   ├── development
|   |   ├── builders.rst
|   |   ├── index.rst
|   |   ├── overview.rst
|   |   ├── theming.rst
|   |   └── tutorials
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── applehelp.py
|   |   ├── changes.py
|   |   ├── devhelp.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── htmlhelp.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── qthelp.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── indexentries.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── deprecated.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── jsmath.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── jssplitter.py
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.3.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── jsonimpl.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── __init__.py
|   ├── certs
|   ├── conftest.py
|   ├── ext_napoleon_pep526_data_google.py
|   ├── ext_napoleon_pep526_data_numpy.py
|   ├── js
|   |   └── doctools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── function_param_target.rst
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── semicolon.rst
|   |   ├── test-domain-c-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-cpp-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── abbr.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py-xref-warning
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── TYPE_CHECKING.py
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── annotations.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── bound_method.py
|   |   |       ├── cached_property.py
|   |   |       ├── callable.py
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── empty_all.py
|   |   |       ├── enums.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── generic_class.py
|   |   |       ├── genericalias.py
|   |   |       ├── hide_value.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── instance_variable.py
|   |   |       ├── methods.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── overload2.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-filename-map
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   ├── nomath.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-highlight_options
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-linkcheck-localserver
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-anchor
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-https
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autoattribute.py
|   ├── test_ext_autodoc_autoclass.py
|   ├── test_ext_autodoc_autodata.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_automodule.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_pycompat.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   ├── typing_test_data.py
|   └── utils.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    ├── checks.py
    ├── doclinter.py
    └── jssplitter_generator.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

Description: **Describe the bug**
viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

**To Reproduce**
```
$ make html epub
```

**Expected behavior**
module pages should not be created for epub by default.

**Your project**
No

**Screenshots**
No

**Environment info**
- OS: Mac
- Python version: 3.9.1
- Sphinx version: HEAD of 3.x
- Sphinx extensions:  sphinx.ext.viewcode
- Extra tools: No

**Additional context**
No


Patch information:
diff --git a/sphinx/ext/viewcode.py b/sphinx/ext/viewcode.py
index a7d52a91c..417f0db97 100644
--- a/sphinx/ext/viewcode.py
+++ b/sphinx/ext/viewcode.py
@@ -52,12 +52,12 @@ def _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str
 
 def doctree_read(app: Sphinx, doctree: Node) -> None:
     env = app.builder.env
-    if not hasattr(env, '_viewcode_modules'):
-        env._viewcode_modules = {}  # type: ignore
     if app.builder.name == "singlehtml":
         return
     if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
         return
+    if not hasattr(env, '_viewcode_modules'):
+        env._viewcode_modules = {}  # type: ignore
 
     def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:
         entry = env._viewcode_modules.get(modname, None)  # type: ignore
@@ -180,6 +180,10 @@ def should_generate_module_page(app: Sphinx, modname: str) -> bool:
 
 def collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:
     env = app.builder.env
+    if app.builder.name == "singlehtml":
+        return
+    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
+        return
     if not hasattr(env, '_viewcode_modules'):
         return
     highlighter = app.builder.highlighter  # type: ignore


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 01:07:09,388 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to a bug in the `viewcode` extension when used with the `epub` builder. The most relevant file for this is likely `tests/test_ext_viewcode.py`. I need to analyze its content to find tests that use the `epub` builder, check for page generation, and potentially configure `viewcode_enable_epub`. Without the file content, I cannot identify any relevant test cases.' query='Please provide the full content of the file `tests/test_ext_viewcode.py`.' extra_requirements='' purpose='I need to examine the tests for the `viewcode` extension to find ones relevant to the reported bug concerning the `epub` builder.'
2025-12-21 01:07:09,389 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `tests/test_ext_viewcode.py`.
2025-12-21 01:07:09,389 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 01:07:09,390 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 01:07:09,390 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 01:07:09,390 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `tests/test_ext_viewcode.py`.
Purpose: I need to examine the tests for the `viewcode` extension to find ones relevant to the reported bug concerning the `epub` builder.
2025-12-21 01:07:11,515 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will read the full content of the file `tests/test_ext_viewcode.py` to help you examine the tests for the `viewcode` extension. This will allow you to identify tests relevant to the reported bug concerning the `epub` builder.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/test_ext_viewcode.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2084, 'candidates_token_count': 78, 'total_token_count': 2253, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2084}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 91, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.05576089100959974, 'model_name': 'gemini-2.5-pro'} id='run--a28f5457-4b4f-4269-b830-b5ac672921d5-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_ext_viewcode.py'}, 'id': 'bb5a8084-d134-414c-a1bb-a34921d95c34', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2084, 'output_tokens': 78, 'total_tokens': 2253, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 91}}
2025-12-21 01:07:13,591 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have provided the full content of `tests/test_ext_viewcode.py` by reading the file. You can now examine the tests for the `viewcode` extension to find ones relevant to the reported bug concerning the `epub` builder.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 500.0, "start_line": 105.0, "relative_path": "tests/test_ext_viewcode.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4073, 'candidates_token_count': 82, 'total_token_count': 4211, 'cached_content_token_count': 1643, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4073}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1643}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 56}, 'finish_reason': 'STOP', 'avg_logprobs': -0.07880307406913943, 'model_name': 'gemini-2.5-pro'} id='run--cb3ae12c-dc2c-4531-8187-b1e63d9c84d2-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 500.0, 'start_line': 105.0, 'relative_path': 'tests/test_ext_viewcode.py'}, 'id': '4293320e-20cb-4a11-a757-0ee6450739c3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4073, 'output_tokens': 82, 'total_tokens': 4211, 'input_token_details': {'cache_read': 1643}, 'output_token_details': {'reasoning': 56}}
2025-12-21 01:07:18,085 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the file `tests/test_ext_viewcode.py` and provided its full content. You can now use this information to examine the tests for the `viewcode` extension and identify any that are relevant to the bug in the `epub` builder.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4245, 'candidates_token_count': 56, 'total_token_count': 4746, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4245}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 56}], 'thoughts_token_count': 445, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7933003561837333, 'model_name': 'gemini-2.5-pro'} id='run--4055e3f7-f8f0-4651-a1c1-037a9ca7c2de-0' usage_metadata={'input_tokens': 4245, 'output_tokens': 56, 'total_tokens': 4746, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 445}}
2025-12-21 01:07:18,087 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `tests/test_ext_viewcode.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to examine the tests for the `viewcode` extension to find ones relevant to the reported bug concerning the `epub` builder.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/test_ext_viewcode.py
Line number range: 1 - 104
Content:
1. """
2.     test_ext_viewcode
3.     ~~~~~~~~~~~~~~~~~
4. 
5.     Test sphinx.ext.viewcode extension.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import re
12. 
13. import pytest
14. 
15. 
16. @pytest.mark.sphinx(testroot='ext-viewcode')
17. def test_viewcode(app, status, warning):
18.     app.builder.build_all()
19. 
20.     warnings = re.sub(r'\\+', '/', warning.getvalue())
21.     assert re.findall(
22.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
23.         r"file .*/spam/__init__.py'",
24.         warnings
25.     )
26. 
27.     result = (app.outdir / 'index.html').read_text()
28.     assert result.count('href="_modules/spam/mod1.html#func1"') == 2
29.     assert result.count('href="_modules/spam/mod2.html#func2"') == 2
30.     assert result.count('href="_modules/spam/mod1.html#Class1"') == 2
31.     assert result.count('href="_modules/spam/mod2.html#Class2"') == 2
32.     assert result.count('@decorator') == 1
33. 
34.     # test that the class attribute is correctly documented
35.     assert result.count('this is Class3') == 2
36.     assert 'this is the class attribute class_attr' in result
37.     # the next assert fails, until the autodoc bug gets fixed
38.     assert result.count('this is the class attribute class_attr') == 2
39. 
40.     result = (app.outdir / '_modules/spam/mod1.html').read_text()
41.     result = re.sub('<span class=".*?">', '<span>', result)  # filter pygments classes
42.     assert ('<div class="viewcode-block" id="Class1"><a class="viewcode-back" '
43.             'href="../../index.html#spam.Class1">[docs]</a>'
44.             '<span>@decorator</span>\n'
45.             '<span>class</span> <span>Class1</span>'
46.             '<span>(</span><span>object</span><span>):</span>\n'
47.             '    <span>&quot;&quot;&quot;</span>\n'
48.             '<span>    this is Class1</span>\n'
49.             '<span>    &quot;&quot;&quot;</span></div>\n') in result
50. 
51. 
52. @pytest.mark.sphinx(testroot='ext-viewcode', tags=['test_linkcode'])
53. def test_linkcode(app, status, warning):
54.     app.builder.build(['objects'])
55. 
56.     stuff = (app.outdir / 'objects.html').read_text()
57. 
58.     assert 'http://foobar/source/foolib.py' in stuff
59.     assert 'http://foobar/js/' in stuff
60.     assert 'http://foobar/c/' in stuff
61.     assert 'http://foobar/cpp/' in stuff
62. 
63. 
64. @pytest.mark.sphinx(testroot='ext-viewcode-find')
65. def test_local_source_files(app, status, warning):
66.     def find_source(app, modname):
67.         if modname == 'not_a_package':
68.             source = (app.srcdir / 'not_a_package/__init__.py').read_text()
69.             tags = {
70.                 'func1': ('def', 1, 1),
71.                 'Class1': ('class', 1, 1),
72.                 'not_a_package.submodule.func1': ('def', 1, 1),
73.                 'not_a_package.submodule.Class1': ('class', 1, 1),
74.             }
75.         else:
76.             source = (app.srcdir / 'not_a_package/submodule.py').read_text()
77.             tags = {
78.                 'not_a_package.submodule.func1': ('def', 11, 15),
79.                 'Class1': ('class', 19, 22),
80.                 'not_a_package.submodule.Class1': ('class', 19, 22),
81.                 'Class3': ('class', 25, 30),
82.                 'not_a_package.submodule.Class3.class_attr': ('other', 29, 29),
83.             }
84.         return (source, tags)
85. 
86.     app.connect('viewcode-find-source', find_source)
87.     app.builder.build_all()
88. 
89.     warnings = re.sub(r'\\+', '/', warning.getvalue())
90.     assert re.findall(
91.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
92.         r"file .*/not_a_package/__init__.py'",
93.         warnings
94.     )
95. 
96.     result = (app.outdir / 'index.html').read_text()
97.     assert result.count('href="_modules/not_a_package.html#func1"') == 1
98.     assert result.count('href="_modules/not_a_package.html#not_a_package.submodule.func1"') == 1
99.     assert result.count('href="_modules/not_a_package/submodule.html#Class1"') == 1
100.     assert result.count('href="_modules/not_a_package/submodule.html#Class3"') == 1
101.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class1"') == 1
102. 
103.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class3.class_attr"') == 1
104.     assert result.count('This is the class attribute class_attr') == 1

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 01:07:21,372 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user has asked for the full content of the file `tests/test_ext_viewcode.py`. The provided context contains the entire file, so I am returning the whole content as requested.', relative_path='tests/test_ext_viewcode.py', start_line=1, end_line=104)]
2025-12-21 01:07:21,373 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `tests/test_ext_viewcode.py`.
2025-12-21 01:07:21,373 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 01:07:21,373 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 01:07:21,373 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 01:07:21,373 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 01:07:21,374 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── lint.yml
|       ├── main.yml
|       └── nodejs.yml
├── .readthedocs.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   └── themes
|   |       └── fullsize
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── develop.rst
|   ├── development
|   |   ├── builders.rst
|   |   ├── index.rst
|   |   ├── overview.rst
|   |   ├── theming.rst
|   |   └── tutorials
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── applehelp.py
|   |   ├── changes.py
|   |   ├── devhelp.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── htmlhelp.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── qthelp.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── indexentries.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── deprecated.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── jsmath.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── jssplitter.py
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.3.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── jsonimpl.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── __init__.py
|   ├── certs
|   ├── conftest.py
|   ├── ext_napoleon_pep526_data_google.py
|   ├── ext_napoleon_pep526_data_numpy.py
|   ├── js
|   |   └── doctools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── function_param_target.rst
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── semicolon.rst
|   |   ├── test-domain-c-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-cpp-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── abbr.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py-xref-warning
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── TYPE_CHECKING.py
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── annotations.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── bound_method.py
|   |   |       ├── cached_property.py
|   |   |       ├── callable.py
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── empty_all.py
|   |   |       ├── enums.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── generic_class.py
|   |   |       ├── genericalias.py
|   |   |       ├── hide_value.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── instance_variable.py
|   |   |       ├── methods.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── overload2.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-filename-map
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   ├── nomath.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-highlight_options
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-linkcheck-localserver
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-anchor
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-https
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autoattribute.py
|   ├── test_ext_autodoc_autoclass.py
|   ├── test_ext_autodoc_autodata.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_automodule.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_pycompat.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   ├── typing_test_data.py
|   └── utils.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    ├── checks.py
    ├── doclinter.py
    └── jssplitter_generator.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

Description: **Describe the bug**
viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

**To Reproduce**
```
$ make html epub
```

**Expected behavior**
module pages should not be created for epub by default.

**Your project**
No

**Screenshots**
No

**Environment info**
- OS: Mac
- Python version: 3.9.1
- Sphinx version: HEAD of 3.x
- Sphinx extensions:  sphinx.ext.viewcode
- Extra tools: No

**Additional context**
No


Patch information:
diff --git a/sphinx/ext/viewcode.py b/sphinx/ext/viewcode.py
index a7d52a91c..417f0db97 100644
--- a/sphinx/ext/viewcode.py
+++ b/sphinx/ext/viewcode.py
@@ -52,12 +52,12 @@ def _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str
 
 def doctree_read(app: Sphinx, doctree: Node) -> None:
     env = app.builder.env
-    if not hasattr(env, '_viewcode_modules'):
-        env._viewcode_modules = {}  # type: ignore
     if app.builder.name == "singlehtml":
         return
     if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
         return
+    if not hasattr(env, '_viewcode_modules'):
+        env._viewcode_modules = {}  # type: ignore
 
     def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:
         entry = env._viewcode_modules.get(modname, None)  # type: ignore
@@ -180,6 +180,10 @@ def should_generate_module_page(app: Sphinx, modname: str) -> bool:
 
 def collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:
     env = app.builder.env
+    if app.builder.name == "singlehtml":
+        return
+    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
+        return
     if not hasattr(env, '_viewcode_modules'):
         return
     highlighter = app.builder.highlighter  # type: ignore


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `tests/test_ext_viewcode.py`.
Extra Requirements: 
Purpose: I need to examine the tests for the `viewcode` extension to find ones relevant to the reported bug concerning the `epub` builder.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/test_ext_viewcode.py
Line number range: 1 - 104
Content:
1. """
2.     test_ext_viewcode
3.     ~~~~~~~~~~~~~~~~~
4. 
5.     Test sphinx.ext.viewcode extension.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import re
12. 
13. import pytest
14. 
15. 
16. @pytest.mark.sphinx(testroot='ext-viewcode')
17. def test_viewcode(app, status, warning):
18.     app.builder.build_all()
19. 
20.     warnings = re.sub(r'\\+', '/', warning.getvalue())
21.     assert re.findall(
22.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
23.         r"file .*/spam/__init__.py'",
24.         warnings
25.     )
26. 
27.     result = (app.outdir / 'index.html').read_text()
28.     assert result.count('href="_modules/spam/mod1.html#func1"') == 2
29.     assert result.count('href="_modules/spam/mod2.html#func2"') == 2
30.     assert result.count('href="_modules/spam/mod1.html#Class1"') == 2
31.     assert result.count('href="_modules/spam/mod2.html#Class2"') == 2
32.     assert result.count('@decorator') == 1
33. 
34.     # test that the class attribute is correctly documented
35.     assert result.count('this is Class3') == 2
36.     assert 'this is the class attribute class_attr' in result
37.     # the next assert fails, until the autodoc bug gets fixed
38.     assert result.count('this is the class attribute class_attr') == 2
39. 
40.     result = (app.outdir / '_modules/spam/mod1.html').read_text()
41.     result = re.sub('<span class=".*?">', '<span>', result)  # filter pygments classes
42.     assert ('<div class="viewcode-block" id="Class1"><a class="viewcode-back" '
43.             'href="../../index.html#spam.Class1">[docs]</a>'
44.             '<span>@decorator</span>\n'
45.             '<span>class</span> <span>Class1</span>'
46.             '<span>(</span><span>object</span><span>):</span>\n'
47.             '    <span>&quot;&quot;&quot;</span>\n'
48.             '<span>    this is Class1</span>\n'
49.             '<span>    &quot;&quot;&quot;</span></div>\n') in result
50. 
51. 
52. @pytest.mark.sphinx(testroot='ext-viewcode', tags=['test_linkcode'])
53. def test_linkcode(app, status, warning):
54.     app.builder.build(['objects'])
55. 
56.     stuff = (app.outdir / 'objects.html').read_text()
57. 
58.     assert 'http://foobar/source/foolib.py' in stuff
59.     assert 'http://foobar/js/' in stuff
60.     assert 'http://foobar/c/' in stuff
61.     assert 'http://foobar/cpp/' in stuff
62. 
63. 
64. @pytest.mark.sphinx(testroot='ext-viewcode-find')
65. def test_local_source_files(app, status, warning):
66.     def find_source(app, modname):
67.         if modname == 'not_a_package':
68.             source = (app.srcdir / 'not_a_package/__init__.py').read_text()
69.             tags = {
70.                 'func1': ('def', 1, 1),
71.                 'Class1': ('class', 1, 1),
72.                 'not_a_package.submodule.func1': ('def', 1, 1),
73.                 'not_a_package.submodule.Class1': ('class', 1, 1),
74.             }
75.         else:
76.             source = (app.srcdir / 'not_a_package/submodule.py').read_text()
77.             tags = {
78.                 'not_a_package.submodule.func1': ('def', 11, 15),
79.                 'Class1': ('class', 19, 22),
80.                 'not_a_package.submodule.Class1': ('class', 19, 22),
81.                 'Class3': ('class', 25, 30),
82.                 'not_a_package.submodule.Class3.class_attr': ('other', 29, 29),
83.             }
84.         return (source, tags)
85. 
86.     app.connect('viewcode-find-source', find_source)
87.     app.builder.build_all()
88. 
89.     warnings = re.sub(r'\\+', '/', warning.getvalue())
90.     assert re.findall(
91.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
92.         r"file .*/not_a_package/__init__.py'",
93.         warnings
94.     )
95. 
96.     result = (app.outdir / 'index.html').read_text()
97.     assert result.count('href="_modules/not_a_package.html#func1"') == 1
98.     assert result.count('href="_modules/not_a_package.html#not_a_package.submodule.func1"') == 1
99.     assert result.count('href="_modules/not_a_package/submodule.html#Class1"') == 1
100.     assert result.count('href="_modules/not_a_package/submodule.html#Class3"') == 1
101.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class1"') == 1
102. 
103.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class3.class_attr"') == 1
104.     assert result.count('This is the class attribute class_attr') == 1

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 01:07:33,616 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to a `viewcode` extension bug that incorrectly generates files for the `epub` builder. The previously provided context from `tests/test_ext_viewcode.py` does not contain any tests for the `epub` builder. To find relevant tests, I need to examine the tests specifically designed for the `epub` builder, which are most likely located in `tests/test_build_epub.py`.' query='Please provide the full content of the file `tests/test_build_epub.py`.' extra_requirements='' purpose='I need to analyze the epub builder tests to find cases that involve the `viewcode` extension and check for correct file generation behavior based on configuration.'
2025-12-21 01:07:33,617 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file `tests/test_build_epub.py`.
2025-12-21 01:07:33,618 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 01:07:33,618 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 01:07:33,619 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 01:07:33,619 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file `tests/test_build_epub.py`.
Purpose: I need to analyze the epub builder tests to find cases that involve the `viewcode` extension and check for correct file generation behavior based on configuration.
2025-12-21 01:07:36,065 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `tests/test_build_epub.py` as requested. This will allow you to analyze the epub builder tests, specifically looking for cases related to the `viewcode` extension and verifying the correct file generation behavior based on the configuration.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/test_build_epub.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2085, 'candidates_token_count': 81, 'total_token_count': 2300, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2085}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 81}], 'thoughts_token_count': 134, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1370816054167571, 'model_name': 'gemini-2.5-pro'} id='run--bb8256f8-c2f1-47c0-a7e0-305364d53c74-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_build_epub.py'}, 'id': 'fe916a54-d68c-410c-83dc-b53b24ff0e0b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2085, 'output_tokens': 81, 'total_tokens': 2300, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 134}}
2025-12-21 01:07:40,668 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of `tests/test_build_epub.py` and am now searching for tests related to the `viewcode` extension. This will help identify the specific test cases that demonstrate how `viewcode` interacts with the epub builder and how its behavior is verified.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "viewcode", "relative_path": "tests/test_build_epub.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9463, 'candidates_token_count': 93, 'total_token_count': 9795, 'cached_content_token_count': 1791, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9463}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1791}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 93}], 'thoughts_token_count': 239}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2829236676616053, 'model_name': 'gemini-2.5-pro'} id='run--bc26c469-d01a-48ed-b7e6-f6311c410378-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'viewcode', 'relative_path': 'tests/test_build_epub.py'}, 'id': 'e54bd4b8-9e3a-46d1-8bdd-3f70fb559f42', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9463, 'output_tokens': 93, 'total_tokens': 9795, 'input_token_details': {'cache_read': 1791}, 'output_token_details': {'reasoning': 239}}
2025-12-21 01:07:53,223 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed the full content of `tests/test_build_epub.py`. My search for the term "viewcode" within this file did not yield any results, which suggests that the `viewcode` extension is not directly tested in this specific file. To investigate further, I will now broaden my search to the entire codebase to find any mentions of "viewcode" in text files or documentation, which may provide clues as to where `viewcode`-related epub tests are located.' additional_kwargs={'function_call': {'name': 'find_text_node_with_text', 'arguments': '{"text": "viewcode"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9588, 'candidates_token_count': 112, 'total_token_count': 10646, 'cached_content_token_count': 8943, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9588}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8943}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 112}], 'thoughts_token_count': 946}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4717419488089425, 'model_name': 'gemini-2.5-pro'} id='run--5a607f03-8399-41a7-a3b0-e6cf3e3386da-0' tool_calls=[{'name': 'find_text_node_with_text', 'args': {'text': 'viewcode'}, 'id': '1312aeb3-7f7a-4264-b54b-37935cc38db3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9588, 'output_tokens': 112, 'total_tokens': 10646, 'input_token_details': {'cache_read': 8943}, 'output_token_details': {'reasoning': 946}}
2025-12-21 01:07:59,613 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='My previous search for "viewcode" in `tests/test_build_epub.py` was unsuccessful. However, a broader search across the codebase for text containing "viewcode" revealed documentation indicating that the `viewcode` extension is not enabled by default for epub builds and requires the `viewcode_enable_epub` configuration to be set to `True`. This suggests that tests for this functionality would involve this specific configuration. Therefore, I am now searching the codebase for any files that reference `viewcode_enable_epub` to locate the relevant tests.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "viewcode_enable_epub"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12833, 'candidates_token_count': 139, 'total_token_count': 13398, 'cached_content_token_count': 9153, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12833}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9153}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 139}], 'thoughts_token_count': 426}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3292967981571774, 'model_name': 'gemini-2.5-pro'} id='run--86782ba4-ea78-476f-af68-d922fd699a55-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'viewcode_enable_epub'}, 'id': '227e2067-e37b-45cb-97d4-4eb669d8525d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12833, 'output_tokens': 139, 'total_tokens': 13398, 'input_token_details': {'cache_read': 9153}, 'output_token_details': {'reasoning': 426}}
2025-12-21 01:08:19,366 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I previously searched for "viewcode" in `tests/test_build_epub.py` and found no direct references. However, my subsequent search for "viewcode" in the project\'s text files revealed the `viewcode_enable_epub` configuration option. My attempt to find where this option is used failed due to a tool error. I am now trying to locate the relevant test file by searching for a file named `test_ext_viewcode.py`, which is a likely candidate for `viewcode` extension tests.' additional_kwargs={'function_call': {'name': 'find_file_node_with_basename', 'arguments': '{"basename": "test_ext_viewcode.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13032, 'candidates_token_count': 129, 'total_token_count': 14877, 'cached_content_token_count': 12805, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13032}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12805}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 129}], 'thoughts_token_count': 1716}, 'finish_reason': 'STOP', 'avg_logprobs': -2.0982571387475777, 'model_name': 'gemini-2.5-pro'} id='run--18a83cf9-fd87-4ed3-9a0a-edfe646beb37-0' tool_calls=[{'name': 'find_file_node_with_basename', 'args': {'basename': 'test_ext_viewcode.py'}, 'id': '06271a72-a4c7-4f96-91e6-138f88bd4b03', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13032, 'output_tokens': 129, 'total_tokens': 14877, 'input_token_details': {'cache_read': 12805}, 'output_token_details': {'reasoning': 1716}}
2025-12-21 01:08:23,559 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the file `tests/test_ext_viewcode.py`, which appears to be the correct location for tests related to the `viewcode` extension. I will now read the contents of this file to identify the specific tests that involve epub builds and the `viewcode_enable_epub` configuration. This will allow me to provide you with the exact code snippets you need to analyze the file generation behavior.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/test_ext_viewcode.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13223, 'candidates_token_count': 110, 'total_token_count': 13628, 'cached_content_token_count': 12792, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13223}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12792}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 110}], 'thoughts_token_count': 295}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2651206450028853, 'model_name': 'gemini-2.5-pro'} id='run--5aa0d9a9-6940-4be2-aec4-f146cce8f611-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_ext_viewcode.py'}, 'id': 'fda0f7e7-f7f5-47b1-a197-01dc2046adae', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13223, 'output_tokens': 110, 'total_tokens': 13628, 'input_token_details': {'cache_read': 12792}, 'output_token_details': {'reasoning': 295}}
2025-12-21 01:08:27,722 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have now examined `tests/test_ext_viewcode.py` and found that it does not contain any tests related to epub builds. To locate the relevant tests that involve both `viewcode` and epub, I will now search for the `viewcode_enable_epub` configuration being used in any file within the `tests` directory. This will pinpoint the exact test that validates the `viewcode` extension's behavior in epub generation." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"relative_path": "tests/test_ext_viewcode.py", "text": "viewcode_enable_epub"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 15244, 'candidates_token_count': 132, 'total_token_count': 15600, 'cached_content_token_count': 12852, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15244}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12852}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 132}], 'thoughts_token_count': 224}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2774959622007428, 'model_name': 'gemini-2.5-pro'} id='run--4b8e5a25-1f3b-4ae9-a6ac-b45745b899f1-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'relative_path': 'tests/test_ext_viewcode.py', 'text': 'viewcode_enable_epub'}, 'id': 'ba98a559-fca5-4c4a-b1ff-716af9de05bb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 15244, 'output_tokens': 132, 'total_tokens': 15600, 'input_token_details': {'cache_read': 12852}, 'output_token_details': {'reasoning': 224}}
2025-12-21 01:08:51,492 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have been unable to locate a specific test file that directly combines the `viewcode` extension with epub builds. My investigation of `tests/test_build_epub.py` and `tests/test_ext_viewcode.py` did not reveal any tests that use the `viewcode_enable_epub` configuration. However, I did find the documentation for the `viewcode` extension, which clearly states that `viewcode_enable_epub` must be set to `True` to enable the extension for epub output. This information is crucial for creating such a test. I am now searching for the usage of `confoverrides` in `test_build_epub.py` to see if any existing tests modify epub-related configurations, which might provide a template for the test you want to create.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "confoverrides", "relative_path": "tests/test_build_epub.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 15408, 'candidates_token_count': 203, 'total_token_count': 17570, 'cached_content_token_count': 14675, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15408}], 'cache_tokens_details': [{'modality': 1, 'token_count': 14675}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 203}], 'thoughts_token_count': 1959}, 'finish_reason': 'STOP', 'avg_logprobs': -1.6282350136141472, 'model_name': 'gemini-2.5-pro'} id='run--67a07c40-0f93-4cdd-982e-5bbb3bdd8484-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'confoverrides', 'relative_path': 'tests/test_build_epub.py'}, 'id': '496fd53d-d44a-4148-93f1-2208bfefac4b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 15408, 'output_tokens': 203, 'total_tokens': 17570, 'input_token_details': {'cache_read': 14675}, 'output_token_details': {'reasoning': 1959}}
2025-12-21 01:08:58,333 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="After a thorough investigation, I have determined that there are no existing tests that specifically cover the `viewcode` extension's integration with the epub builder. I have examined both `tests/test_build_epub.py` and `tests/test_ext_viewcode.py` and found no tests that enable `viewcode_enable_epub` and verify the output. However, I have found the necessary components to construct such a test. By combining the knowledge of the `viewcode_enable_epub` configuration and the use of `confoverrides` in `tests/test_build_epub.py`, a new test can be created to validate this functionality." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16248, 'candidates_token_count': 139, 'total_token_count': 16846, 'cached_content_token_count': 14675, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16248}], 'cache_tokens_details': [{'modality': 1, 'token_count': 14675}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 139}], 'thoughts_token_count': 459}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5025312025770009, 'model_name': 'gemini-2.5-pro'} id='run--b37e982c-f7a7-4c25-aebd-0869a7212462-0' usage_metadata={'input_tokens': 16248, 'output_tokens': 139, 'total_tokens': 16846, 'input_token_details': {'cache_read': 14675}, 'output_token_details': {'reasoning': 459}}
2025-12-21 01:08:58,336 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file `tests/test_build_epub.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to analyze the epub builder tests to find cases that involve the `viewcode` extension and check for correct file generation behavior based on configuration.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: doc/usage/extensions/index.rst
Line number range: 1 - 76
Content:
==========
Extensions
==========

Since many projects will need special features in their documentation, Sphinx
allows adding "extensions" to the build process, each of which can modify
almost any aspect of document processing.

This chapter describes the extensions bundled with Sphinx.  For the API
documentation on writing your own extension, refer to :ref:`dev-extensions`.


Built-in extensions
-------------------

These extensions are built in and can be activated by respective entries in the
:confval:`extensions` configuration value:

.. toctree::

   autodoc
   autosectionlabel
   autosummary
   coverage
   doctest
   duration
   extlinks
   githubpages
   graphviz
   ifconfig
   imgconverter
   inheritance
   intersphinx
   linkcode
   math
   napoleon
   todo
   viewcode


Third-party extensions
----------------------

.. todo:: This should reference the GitHub organization now

You can find several extensions contributed by users in the `Sphinx Contrib`_
repository.  It is open for anyone who wants to maintain an extension publicly;
just send a short message asking for write permissions.

There are also several extensions hosted elsewhere.  The `Sphinx extension
survey <https://sphinxext-survey.readthedocs.io/>`__ and `awesome-sphinxdoc
<https://github.com/yoloseem/awesome-sphinxdoc>`__ contains a comprehensive
list.

If you write an extension that you think others will find useful or you think
should be included as a part of Sphinx, please write to the project mailing
list (`join here <https://groups.google.com/forum/#!forum/sphinx-dev>`_).

.. _Sphinx Contrib: https://bitbucket.org/birkenfeld/sphinx-contrib

Where to put your own extensions?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Extensions local to a project should be put within the project's directory
structure.  Set Python's module search path, ``sys.path``, accordingly so that
Sphinx can find them.  For example, if your extension ``foo.py`` lies in the
``exts`` subdirectory of the project root, put into :file:`conf.py`::

   import sys, os

   sys.path.append(os.path.abspath('exts'))

   extensions = ['foo']

You can also install extensions anywhere else on ``sys.path``, e.g. in the
``site-packages`` directory.


File: doc/usage/extensions/linkcode.rst
Line number range: 1 - 51
Content:
:mod:`sphinx.ext.linkcode` -- Add external links to source code
===============================================================

.. module:: sphinx.ext.linkcode
   :synopsis: Add external links to source code.
.. moduleauthor:: Pauli Virtanen

.. versionadded:: 1.2

This extension looks at your object descriptions (``.. class::``,
``.. function::`` etc.) and adds external links to code hosted
somewhere on the web. The intent is similar to the
``sphinx.ext.viewcode`` extension, but assumes the source code can be
found somewhere on the Internet.

In your configuration, you need to specify a :confval:`linkcode_resolve`
function that returns an URL based on the object.


Configuration
-------------

.. confval:: linkcode_resolve

   This is a function ``linkcode_resolve(domain, info)``,
   which should return the URL to source code corresponding to
   the object in given domain with given information.

   The function should return ``None`` if no link is to be added.

   The argument ``domain`` specifies the language domain the object is
   in. ``info`` is a dictionary with the following keys guaranteed to
   be present (dependent on the domain):

   - ``py``: ``module`` (name of the module), ``fullname`` (name of the object)
   - ``c``: ``names`` (list of names for the object)
   - ``cpp``: ``names`` (list of names for the object)
   - ``javascript``: ``object`` (name of the object), ``fullname``
     (name of the item)

   Example:

   .. code-block:: python

      def linkcode_resolve(domain, info):
          if domain != 'py':
              return None
          if not info['module']:
              return None
          filename = info['module'].replace('.', '/')
          return "https://somesite/sourcerepo/%s.py" % filename


File: doc/usage/extensions/viewcode.rst
Line number range: 1 - 98
Content:
:mod:`sphinx.ext.viewcode` -- Add links to highlighted source code
==================================================================

.. module:: sphinx.ext.viewcode
   :synopsis: Add links to a highlighted version of the source code.
.. moduleauthor:: Georg Brandl

.. versionadded:: 1.0

This extension looks at your Python object descriptions (``.. class::``, ``..
function::`` etc.) and tries to find the source files where the objects are
contained.  When found, a separate HTML page will be output for each module with
a highlighted version of the source code, and a link will be added to all object
descriptions that leads to the source code of the described object.  A link back
from the source to the description will also be inserted.

.. warning::

   Basically, ``viewcode`` extension will import the modules being linked to.
   If any modules have side effects on import, these will be executed when
   ``sphinx-build`` is run.

   If you document scripts (as opposed to library modules), make sure their
   main routine is protected by a ``if __name__ == '__main__'`` condition.

   In addition, if you don't want to import the modules by ``viewcode``,
   you can tell the location of the location of source code to ``viewcode``
   using the :event:`viewcode-find-source` event.

   If :confval:`viewcode_follow_imported_members` is enabled,
   you will also need to resolve imported attributes
   using the :event:`viewcode-follow-imported` event.

This extension works only on HTML related builders like ``html``,
``applehelp``, ``devhelp``, ``htmlhelp``, ``qthelp`` and so on except
``singlehtml``. By default ``epub`` builder doesn't
support this extension (see :confval:`viewcode_enable_epub`).

Configuration
-------------

.. confval:: viewcode_follow_imported_members

   If this is ``True``, viewcode extension will emit
   :event:`viewcode-follow-imported` event to resolve the name of the module
   by other extensions.  The default is ``True``.

   .. versionadded:: 1.3

   .. versionchanged:: 1.8
      Renamed from ``viewcode_import`` to ``viewcode_follow_imported_members``.

.. confval:: viewcode_enable_epub

   If this is ``True``, viewcode extension is also enabled even if you use
   epub builders. This extension generates pages outside toctree, but this
   is not preferred as epub format.

   Until 1.4.x, this extension is always enabled. If you want to generate
   epub as same as 1.4.x, you should set ``True``, but epub format checker's
   score becomes worse.

   The default is ``False``.

   .. versionadded:: 1.5

   .. warning::

      Not all epub readers support pages generated by viewcode extension.
      These readers ignore links to pages are not under toctree.

      Some reader's rendering result are corrupted and
      `epubcheck <https://github.com/IDPF/epubcheck>`_'s score
      becomes worse even if the reader supports.

.. event:: viewcode-find-source (app, modname)

   .. versionadded:: 1.8

   Find the source code for a module.
   An event handler for this event should return
   a tuple of the source code itself and a dictionary of tags.
   The dictionary maps the name of a class, function, attribute, etc
   to a tuple of its type, the start line number, and the end line number.
   The type should be one of "class", "def", or "other".

   :param app: The Sphinx application object.
   :param modname: The name of the module to find source code for.

.. event:: viewcode-follow-imported (app, modname, attribute)

   .. versionadded:: 1.8

   Find the name of the original module for an attribute.

   :param app: The Sphinx application object.
   :param modname: The name of the module that the attribute belongs to.
   :param attribute: The name of the member to follow.


File: tests/roots/test-ext-viewcode-find/index.rst
Line number range: 1 - 38
Content:
viewcode
========

.. py:module:: not_a_package

.. py:function:: func1(a, b)

   This is func1

.. py:function:: not_a_package.submodule.func1(a, b)

   This is func1

.. py:module:: not_a_package.submodule

.. py:class:: Class1

   This is Class1

.. py:class:: Class3

   This is Class3

.. py:class:: not_a_package.submodule.Class1

   This is Class1

.. literalinclude:: not_a_package/__init__.py
   :language: python
   :pyobject: func1

.. literalinclude:: not_a_package/submodule.py
   :language: python
   :pyobject: func1

.. py:attribute:: not_a_package.submodule.Class3.class_attr

   This is the class attribute class_attr


File: tests/roots/test-ext-viewcode/index.rst
Line number range: 1 - 39
Content:
viewcode
========

.. py:module:: spam

.. autofunction:: func1

.. autofunction:: func2

.. autofunction:: spam.mod1.func1

.. autofunction:: spam.mod2.func2

.. autofunction:: Class1

.. autofunction:: Class2

.. autofunction:: spam.mod1.Class1

.. autofunction:: spam.mod2.Class2


.. literalinclude:: spam/__init__.py
   :language: python
   :pyobject: func1

.. literalinclude:: spam/mod1.py
   :language: python
   :pyobject: func1

.. autoclass:: spam.mod3.Class3
   :members:

.. automodule:: spam.mod3
   :members:

.. toctree::

   objects


File: tests/test_build_epub.py
Line number range: 1 - 396
Content:
1. """
2.     test_build_html
3.     ~~~~~~~~~~~~~~~
4. 
5.     Test the HTML builder and check output against XPath.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import os
12. import subprocess
13. from subprocess import PIPE, CalledProcessError
14. from xml.etree import ElementTree
15. 
16. import pytest
17. 
18. from sphinx.util import docutils
19. 
20. 
21. # check given command is runnable
22. def runnable(command):
23.     try:
24.         subprocess.run(command, stdout=PIPE, stderr=PIPE, check=True)
25.         return True
26.     except (OSError, CalledProcessError):
27.         return False  # command not found or exit with non-zero
28. 
29. 
30. class EPUBElementTree:
31.     """Test helper for content.opf and toc.ncx"""
32.     namespaces = {
33.         'idpf': 'http://www.idpf.org/2007/opf',
34.         'dc': 'http://purl.org/dc/elements/1.1/',
35.         'ibooks': 'http://vocabulary.itunes.apple.com/rdf/ibooks/vocabulary-extensions-1.0/',
36.         'ncx': 'http://www.daisy.org/z3986/2005/ncx/',
37.         'xhtml': 'http://www.w3.org/1999/xhtml',
38.         'epub': 'http://www.idpf.org/2007/ops'
39.     }
40. 
41.     def __init__(self, tree):
42.         self.tree = tree
43. 
44.     @classmethod
45.     def fromstring(cls, string):
46.         return cls(ElementTree.fromstring(string))
47. 
48.     def find(self, match):
49.         ret = self.tree.find(match, namespaces=self.namespaces)
50.         if ret is not None:
51.             return self.__class__(ret)
52.         else:
53.             return ret
54. 
55.     def findall(self, match):
56.         ret = self.tree.findall(match, namespaces=self.namespaces)
57.         return [self.__class__(e) for e in ret]
58. 
59.     def __getattr__(self, name):
60.         return getattr(self.tree, name)
61. 
62.     def __iter__(self):
63.         for child in self.tree:
64.             yield self.__class__(child)
65. 
66. 
67. @pytest.mark.sphinx('epub', testroot='basic')
68. def test_build_epub(app):
69.     app.build()
70.     assert (app.outdir / 'mimetype').read_text() == 'application/epub+zip'
71.     assert (app.outdir / 'META-INF' / 'container.xml').exists()
72. 
73.     # toc.ncx
74.     toc = EPUBElementTree.fromstring((app.outdir / 'toc.ncx').read_text())
75.     assert toc.find("./ncx:docTitle/ncx:text").text == 'Python'
76. 
77.     # toc.ncx / head
78.     meta = list(toc.find("./ncx:head"))
79.     assert meta[0].attrib == {'name': 'dtb:uid', 'content': 'unknown'}
80.     assert meta[1].attrib == {'name': 'dtb:depth', 'content': '1'}
81.     assert meta[2].attrib == {'name': 'dtb:totalPageCount', 'content': '0'}
82.     assert meta[3].attrib == {'name': 'dtb:maxPageNumber', 'content': '0'}
83. 
84.     # toc.ncx / navMap
85.     navpoints = toc.findall("./ncx:navMap/ncx:navPoint")
86.     assert len(navpoints) == 1
87.     assert navpoints[0].attrib == {'id': 'navPoint1', 'playOrder': '1'}
88.     assert navpoints[0].find("./ncx:content").attrib == {'src': 'index.xhtml'}
89. 
90.     navlabel = navpoints[0].find("./ncx:navLabel/ncx:text")
91.     assert navlabel.text == 'The basic Sphinx documentation for testing'
92. 
93.     # content.opf
94.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
95. 
96.     # content.opf / metadata
97.     metadata = opf.find("./idpf:metadata")
98.     assert metadata.find("./dc:language").text == 'en'
99.     assert metadata.find("./dc:title").text == 'Python'
100.     assert metadata.find("./dc:description").text == 'unknown'
101.     assert metadata.find("./dc:creator").text == 'unknown'
102.     assert metadata.find("./dc:contributor").text == 'unknown'
103.     assert metadata.find("./dc:publisher").text == 'unknown'
104.     assert metadata.find("./dc:rights").text is None
105.     assert metadata.find("./idpf:meta[@property='ibooks:version']").text is None
106.     assert metadata.find("./idpf:meta[@property='ibooks:specified-fonts']").text == 'true'
107.     assert metadata.find("./idpf:meta[@property='ibooks:binding']").text == 'true'
108.     assert metadata.find("./idpf:meta[@property='ibooks:scroll-axis']").text == 'vertical'
109. 
110.     # content.opf / manifest
111.     manifest = opf.find("./idpf:manifest")
112.     items = list(manifest)
113.     assert items[0].attrib == {'id': 'ncx',
114.                                'href': 'toc.ncx',
115.                                'media-type': 'application/x-dtbncx+xml'}
116.     assert items[1].attrib == {'id': 'nav',
117.                                'href': 'nav.xhtml',
118.                                'media-type': 'application/xhtml+xml',
119.                                'properties': 'nav'}
120.     assert items[2].attrib == {'id': 'epub-0',
121.                                'href': 'genindex.xhtml',
122.                                'media-type': 'application/xhtml+xml'}
123.     assert items[3].attrib == {'id': 'epub-1',
124.                                'href': 'index.xhtml',
125.                                'media-type': 'application/xhtml+xml'}
126. 
127.     for i, item in enumerate(items[2:]):
128.         # items are named as epub-NN
129.         assert item.get('id') == 'epub-%d' % i
130. 
131.     # content.opf / spine
132.     spine = opf.find("./idpf:spine")
133.     itemrefs = list(spine)
134.     assert spine.get('toc') == 'ncx'
135.     assert spine.get('page-progression-direction') == 'ltr'
136.     assert itemrefs[0].get('idref') == 'epub-1'
137.     assert itemrefs[1].get('idref') == 'epub-0'
138. 
139.     # content.opf / guide
140.     reference = opf.find("./idpf:guide/idpf:reference")
141.     assert reference.get('type') == 'toc'
142.     assert reference.get('title') == 'Table of Contents'
143.     assert reference.get('href') == 'index.xhtml'
144. 
145.     # nav.xhtml
146.     nav = EPUBElementTree.fromstring((app.outdir / 'nav.xhtml').read_text())
147.     assert nav.attrib == {'lang': 'en',
148.                           '{http://www.w3.org/XML/1998/namespace}lang': 'en'}
149.     assert nav.find("./xhtml:head/xhtml:title").text == 'Table of Contents'
150. 
151.     # nav.xhtml / nav
152.     navlist = nav.find("./xhtml:body/xhtml:nav")
153.     toc = navlist.findall("./xhtml:ol/xhtml:li")
154.     assert navlist.find("./xhtml:h1").text == 'Table of Contents'
155.     assert len(toc) == 1
156.     assert toc[0].find("./xhtml:a").get("href") == 'index.xhtml'
157.     assert toc[0].find("./xhtml:a").text == 'The basic Sphinx documentation for testing'
158. 
159. 
160. @pytest.mark.sphinx('epub', testroot='footnotes',
161.                     confoverrides={'epub_cover': ('_images/rimg.png', None)})
162. def test_epub_cover(app):
163.     app.build()
164. 
165.     # content.opf / metadata
166.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
167.     cover_image = opf.find("./idpf:manifest/idpf:item[@href='%s']" % app.config.epub_cover[0])
168.     cover = opf.find("./idpf:metadata/idpf:meta[@name='cover']")
169.     assert cover
170.     assert cover.get('content') == cover_image.get('id')
171. 
172. 
173. @pytest.mark.sphinx('epub', testroot='toctree')
174. def test_nested_toc(app):
175.     app.build()
176. 
177.     # toc.ncx
178.     toc = EPUBElementTree.fromstring((app.outdir / 'toc.ncx').read_bytes())
179.     assert toc.find("./ncx:docTitle/ncx:text").text == 'Python'
180. 
181.     # toc.ncx / navPoint
182.     def navinfo(elem):
183.         label = elem.find("./ncx:navLabel/ncx:text")
184.         content = elem.find("./ncx:content")
185.         return (elem.get('id'), elem.get('playOrder'),
186.                 content.get('src'), label.text)
187. 
188.     navpoints = toc.findall("./ncx:navMap/ncx:navPoint")
189.     assert len(navpoints) == 4
190.     assert navinfo(navpoints[0]) == ('navPoint1', '1', 'index.xhtml',
191.                                      "Welcome to Sphinx Tests’s documentation!")
192.     assert navpoints[0].findall("./ncx:navPoint") == []
193. 
194.     # toc.ncx / nested navPoints
195.     assert navinfo(navpoints[1]) == ('navPoint2', '2', 'foo.xhtml', 'foo')
196.     navchildren = navpoints[1].findall("./ncx:navPoint")
197.     assert len(navchildren) == 4
198.     assert navinfo(navchildren[0]) == ('navPoint3', '2', 'foo.xhtml', 'foo')
199.     assert navinfo(navchildren[1]) == ('navPoint4', '3', 'quux.xhtml', 'quux')
200.     assert navinfo(navchildren[2]) == ('navPoint5', '4', 'foo.xhtml#foo-1', 'foo.1')
201.     assert navinfo(navchildren[3]) == ('navPoint8', '6', 'foo.xhtml#foo-2', 'foo.2')
202. 
203.     # nav.xhtml / nav
204.     def navinfo(elem):
205.         anchor = elem.find("./xhtml:a")
206.         return (anchor.get('href'), anchor.text)
207. 
208.     nav = EPUBElementTree.fromstring((app.outdir / 'nav.xhtml').read_bytes())
209.     toc = nav.findall("./xhtml:body/xhtml:nav/xhtml:ol/xhtml:li")
210.     assert len(toc) == 4
211.     assert navinfo(toc[0]) == ('index.xhtml',
212.                                "Welcome to Sphinx Tests’s documentation!")
213.     assert toc[0].findall("./xhtml:ol") == []
214. 
215.     # nav.xhtml / nested toc
216.     assert navinfo(toc[1]) == ('foo.xhtml', 'foo')
217.     tocchildren = toc[1].findall("./xhtml:ol/xhtml:li")
218.     assert len(tocchildren) == 3
219.     assert navinfo(tocchildren[0]) == ('quux.xhtml', 'quux')
220.     assert navinfo(tocchildren[1]) == ('foo.xhtml#foo-1', 'foo.1')
221.     assert navinfo(tocchildren[2]) == ('foo.xhtml#foo-2', 'foo.2')
222. 
223.     grandchild = tocchildren[1].findall("./xhtml:ol/xhtml:li")
224.     assert len(grandchild) == 1
225.     assert navinfo(grandchild[0]) == ('foo.xhtml#foo-1-1', 'foo.1-1')
226. 
227. 
228. @pytest.mark.sphinx('epub', testroot='need-escaped')
229. def test_escaped_toc(app):
230.     app.build()
231. 
232.     # toc.ncx
233.     toc = EPUBElementTree.fromstring((app.outdir / 'toc.ncx').read_bytes())
234.     assert toc.find("./ncx:docTitle/ncx:text").text == 'need <b>"escaped"</b> project'
235. 
236.     # toc.ncx / navPoint
237.     def navinfo(elem):
238.         label = elem.find("./ncx:navLabel/ncx:text")
239.         content = elem.find("./ncx:content")
240.         return (elem.get('id'), elem.get('playOrder'),
241.                 content.get('src'), label.text)
242. 
243.     navpoints = toc.findall("./ncx:navMap/ncx:navPoint")
244.     assert len(navpoints) == 4
245.     assert navinfo(navpoints[0]) == ('navPoint1', '1', 'index.xhtml',
246.                                      "Welcome to Sphinx Tests's documentation!")
247.     assert navpoints[0].findall("./ncx:navPoint") == []
248. 
249.     # toc.ncx / nested navPoints
250.     assert navinfo(navpoints[1]) == ('navPoint2', '2', 'foo.xhtml', '<foo>')
251.     navchildren = navpoints[1].findall("./ncx:navPoint")
252.     assert len(navchildren) == 4
253.     assert navinfo(navchildren[0]) == ('navPoint3', '2', 'foo.xhtml', '<foo>')
254.     assert navinfo(navchildren[1]) == ('navPoint4', '3', 'quux.xhtml', 'quux')
255.     assert navinfo(navchildren[2]) == ('navPoint5', '4', 'foo.xhtml#foo-1', 'foo “1”')
256.     assert navinfo(navchildren[3]) == ('navPoint8', '6', 'foo.xhtml#foo-2', 'foo.2')
257. 
258.     # nav.xhtml / nav
259.     def navinfo(elem):
260.         anchor = elem.find("./xhtml:a")
261.         return (anchor.get('href'), anchor.text)
262. 
263.     nav = EPUBElementTree.fromstring((app.outdir / 'nav.xhtml').read_bytes())
264.     toc = nav.findall("./xhtml:body/xhtml:nav/xhtml:ol/xhtml:li")
265.     assert len(toc) == 4
266.     assert navinfo(toc[0]) == ('index.xhtml',
267.                                "Welcome to Sphinx Tests's documentation!")
268.     assert toc[0].findall("./xhtml:ol") == []
269. 
270.     # nav.xhtml / nested toc
271.     assert navinfo(toc[1]) == ('foo.xhtml', '<foo>')
272.     tocchildren = toc[1].findall("./xhtml:ol/xhtml:li")
273.     assert len(tocchildren) == 3
274.     assert navinfo(tocchildren[0]) == ('quux.xhtml', 'quux')
275.     assert navinfo(tocchildren[1]) == ('foo.xhtml#foo-1', 'foo “1”')
276.     assert navinfo(tocchildren[2]) == ('foo.xhtml#foo-2', 'foo.2')
277. 
278.     grandchild = tocchildren[1].findall("./xhtml:ol/xhtml:li")
279.     assert len(grandchild) == 1
280.     assert navinfo(grandchild[0]) == ('foo.xhtml#foo-1-1', 'foo.1-1')
281. 
282. 
283. @pytest.mark.sphinx('epub', testroot='basic')
284. def test_epub_writing_mode(app):
285.     # horizontal (default)
286.     app.build()
287. 
288.     # horizontal / page-progression-direction
289.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
290.     assert opf.find("./idpf:spine").get('page-progression-direction') == 'ltr'
291. 
292.     # horizontal / ibooks:scroll-axis
293.     metadata = opf.find("./idpf:metadata")
294.     assert metadata.find("./idpf:meta[@property='ibooks:scroll-axis']").text == 'vertical'
295. 
296.     # horizontal / writing-mode (CSS)
297.     css = (app.outdir / '_static' / 'epub.css').read_text()
298.     assert 'writing-mode: horizontal-tb;' in css
299. 
300.     # vertical
301.     app.config.epub_writing_mode = 'vertical'
302.     (app.outdir / 'index.xhtml').unlink()  # forcely rebuild
303.     app.build()
304. 
305.     # vertical / page-progression-direction
306.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
307.     assert opf.find("./idpf:spine").get('page-progression-direction') == 'rtl'
308. 
309.     # vertical / ibooks:scroll-axis
310.     metadata = opf.find("./idpf:metadata")
311.     assert metadata.find("./idpf:meta[@property='ibooks:scroll-axis']").text == 'horizontal'
312. 
313.     # vertical / writing-mode (CSS)
314.     css = (app.outdir / '_static' / 'epub.css').read_text()
315.     assert 'writing-mode: vertical-rl;' in css
316. 
317. 
318. @pytest.mark.sphinx('epub', testroot='epub-anchor-id')
319. def test_epub_anchor_id(app):
320.     app.build()
321. 
322.     html = (app.outdir / 'index.xhtml').read_text()
323.     assert ('<p id="std-setting-STATICFILES_FINDERS">'
324.             'blah blah blah</p>' in html)
325.     assert ('<span id="std-setting-STATICFILES_SECTION"></span>'
326.             '<h1>blah blah blah</h1>' in html)
327.     assert 'see <a class="reference internal" href="#std-setting-STATICFILES_FINDERS">' in html
328. 
329. 
330. @pytest.mark.sphinx('epub', testroot='html_assets')
331. def test_epub_assets(app):
332.     app.builder.build_all()
333. 
334.     # epub_sytlesheets (same as html_css_files)
335.     content = (app.outdir / 'index.xhtml').read_text()
336.     assert ('<link rel="stylesheet" type="text/css" href="_static/css/style.css" />'
337.             in content)
338.     assert ('<link media="print" rel="stylesheet" title="title" type="text/css" '
339.             'href="https://example.com/custom.css" />' in content)
340. 
341. 
342. @pytest.mark.sphinx('epub', testroot='html_assets',
343.                     confoverrides={'epub_css_files': ['css/epub.css']})
344. def test_epub_css_files(app):
345.     app.builder.build_all()
346. 
347.     # epub_css_files
348.     content = (app.outdir / 'index.xhtml').read_text()
349.     assert '<link rel="stylesheet" type="text/css" href="_static/css/epub.css" />' in content
350. 
351.     # files in html_css_files are not outputed
352.     assert ('<link rel="stylesheet" type="text/css" href="_static/css/style.css" />'
353.             not in content)
354.     assert ('<link media="print" rel="stylesheet" title="title" type="text/css" '
355.             'href="https://example.com/custom.css" />' not in content)
356. 
357. 
358. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
359.                     reason='docutils-0.13 or above is required')
360. @pytest.mark.sphinx('epub', testroot='roles-download')
361. def test_html_download_role(app, status, warning):
362.     app.build()
363.     assert not (app.outdir / '_downloads' / 'dummy.dat').exists()
364. 
365.     content = (app.outdir / 'index.xhtml').read_text()
366.     assert ('<li><p><code class="xref download docutils literal notranslate">'
367.             '<span class="pre">dummy.dat</span></code></p></li>' in content)
368.     assert ('<li><p><code class="xref download docutils literal notranslate">'
369.             '<span class="pre">not_found.dat</span></code></p></li>' in content)
370.     assert ('<li><p><code class="xref download docutils literal notranslate">'
371.             '<span class="pre">Sphinx</span> <span class="pre">logo</span></code>'
372.             '<span class="link-target"> [http://www.sphinx-doc.org/en/master'
373.             '/_static/sphinxheader.png]</span></p></li>' in content)
374. 
375. 
376. @pytest.mark.sphinx('epub', testroot='toctree-duplicated')
377. def test_duplicated_toctree_entry(app, status, warning):
378.     app.build()
379.     assert 'WARNING: duplicated ToC entry found: foo.xhtml' in warning.getvalue()
380. 
381. 
382. @pytest.mark.skipif('DO_EPUBCHECK' not in os.environ,
383.                     reason='Skipped because DO_EPUBCHECK is not set')
384. @pytest.mark.sphinx('epub')
385. def test_run_epubcheck(app):
386.     app.build()
387. 
388.     epubcheck = os.environ.get('EPUBCHECK_PATH', '/usr/share/java/epubcheck.jar')
389.     if runnable(['java', '-version']) and os.path.exists(epubcheck):
390.         try:
391.             subprocess.run(['java', '-jar', epubcheck, app.outdir / 'SphinxTests.epub'],
392.                            stdout=PIPE, stderr=PIPE, check=True)
393.         except CalledProcessError as exc:
394.             print(exc.stdout.decode('utf-8'))
395.             print(exc.stderr.decode('utf-8'))
396.             assert False, 'epubcheck exited with return code %s' % exc.returncode


File: tests/test_ext_viewcode.py
Line number range: 1 - 104
Content:
1. """
2.     test_ext_viewcode
3.     ~~~~~~~~~~~~~~~~~
4. 
5.     Test sphinx.ext.viewcode extension.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import re
12. 
13. import pytest
14. 
15. 
16. @pytest.mark.sphinx(testroot='ext-viewcode')
17. def test_viewcode(app, status, warning):
18.     app.builder.build_all()
19. 
20.     warnings = re.sub(r'\\+', '/', warning.getvalue())
21.     assert re.findall(
22.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
23.         r"file .*/spam/__init__.py'",
24.         warnings
25.     )
26. 
27.     result = (app.outdir / 'index.html').read_text()
28.     assert result.count('href="_modules/spam/mod1.html#func1"') == 2
29.     assert result.count('href="_modules/spam/mod2.html#func2"') == 2
30.     assert result.count('href="_modules/spam/mod1.html#Class1"') == 2
31.     assert result.count('href="_modules/spam/mod2.html#Class2"') == 2
32.     assert result.count('@decorator') == 1
33. 
34.     # test that the class attribute is correctly documented
35.     assert result.count('this is Class3') == 2
36.     assert 'this is the class attribute class_attr' in result
37.     # the next assert fails, until the autodoc bug gets fixed
38.     assert result.count('this is the class attribute class_attr') == 2
39. 
40.     result = (app.outdir / '_modules/spam/mod1.html').read_text()
41.     result = re.sub('<span class=".*?">', '<span>', result)  # filter pygments classes
42.     assert ('<div class="viewcode-block" id="Class1"><a class="viewcode-back" '
43.             'href="../../index.html#spam.Class1">[docs]</a>'
44.             '<span>@decorator</span>\n'
45.             '<span>class</span> <span>Class1</span>'
46.             '<span>(</span><span>object</span><span>):</span>\n'
47.             '    <span>&quot;&quot;&quot;</span>\n'
48.             '<span>    this is Class1</span>\n'
49.             '<span>    &quot;&quot;&quot;</span></div>\n') in result
50. 
51. 
52. @pytest.mark.sphinx(testroot='ext-viewcode', tags=['test_linkcode'])
53. def test_linkcode(app, status, warning):
54.     app.builder.build(['objects'])
55. 
56.     stuff = (app.outdir / 'objects.html').read_text()
57. 
58.     assert 'http://foobar/source/foolib.py' in stuff
59.     assert 'http://foobar/js/' in stuff
60.     assert 'http://foobar/c/' in stuff
61.     assert 'http://foobar/cpp/' in stuff
62. 
63. 
64. @pytest.mark.sphinx(testroot='ext-viewcode-find')
65. def test_local_source_files(app, status, warning):
66.     def find_source(app, modname):
67.         if modname == 'not_a_package':
68.             source = (app.srcdir / 'not_a_package/__init__.py').read_text()
69.             tags = {
70.                 'func1': ('def', 1, 1),
71.                 'Class1': ('class', 1, 1),
72.                 'not_a_package.submodule.func1': ('def', 1, 1),
73.                 'not_a_package.submodule.Class1': ('class', 1, 1),
74.             }
75.         else:
76.             source = (app.srcdir / 'not_a_package/submodule.py').read_text()
77.             tags = {
78.                 'not_a_package.submodule.func1': ('def', 11, 15),
79.                 'Class1': ('class', 19, 22),
80.                 'not_a_package.submodule.Class1': ('class', 19, 22),
81.                 'Class3': ('class', 25, 30),
82.                 'not_a_package.submodule.Class3.class_attr': ('other', 29, 29),
83.             }
84.         return (source, tags)
85. 
86.     app.connect('viewcode-find-source', find_source)
87.     app.builder.build_all()
88. 
89.     warnings = re.sub(r'\\+', '/', warning.getvalue())
90.     assert re.findall(
91.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
92.         r"file .*/not_a_package/__init__.py'",
93.         warnings
94.     )
95. 
96.     result = (app.outdir / 'index.html').read_text()
97.     assert result.count('href="_modules/not_a_package.html#func1"') == 1
98.     assert result.count('href="_modules/not_a_package.html#not_a_package.submodule.func1"') == 1
99.     assert result.count('href="_modules/not_a_package/submodule.html#Class1"') == 1
100.     assert result.count('href="_modules/not_a_package/submodule.html#Class3"') == 1
101.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class1"') == 1
102. 
103.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class3.class_attr"') == 1
104.     assert result.count('This is the class attribute class_attr') == 1

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 01:09:01,727 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file `tests/test_build_epub.py`. This context represents the entire file, fulfilling the user's request directly.", relative_path='tests/test_build_epub.py', start_line=1, end_line=396)]
2025-12-21 01:09:01,729 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file `tests/test_build_epub.py`.
2025-12-21 01:09:01,729 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 01:09:01,729 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 01:09:01,730 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-21 01:09:01,730 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-21 01:09:01,731 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sphinx
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.md
|   |   ├── config.yml
|   |   └── feature_request.md
|   ├── PULL_REQUEST_TEMPLATE.md
|   └── workflows
|       ├── builddoc.yml
|       ├── lint.yml
|       ├── main.yml
|       └── nodejs.yml
├── .readthedocs.yml
├── CONTRIBUTING.rst
├── README.rst
├── bindep.txt
├── doc
|   ├── _static
|   |   ├── conf.py.txt
|   |   └── themes
|   |       └── fullsize
|   ├── _templates
|   |   ├── index.html
|   |   └── indexsidebar.html
|   ├── _themes
|   |   └── sphinx13
|   |       ├── layout.html
|   |       └── static
|   |           └── sphinx13.css
|   ├── changes.rst
|   ├── conf.py
|   ├── contents.rst
|   ├── develop.rst
|   ├── development
|   |   ├── builders.rst
|   |   ├── index.rst
|   |   ├── overview.rst
|   |   ├── theming.rst
|   |   └── tutorials
|   |       ├── examples
|   |       |   ├── README.rst
|   |       |   ├── helloworld.py
|   |       |   ├── recipe.py
|   |       |   └── todo.py
|   |       ├── helloworld.rst
|   |       ├── index.rst
|   |       ├── recipe.rst
|   |       └── todo.rst
|   ├── examples.rst
|   ├── extdev
|   |   ├── appapi.rst
|   |   ├── builderapi.rst
|   |   ├── collectorapi.rst
|   |   ├── deprecated.rst
|   |   ├── domainapi.rst
|   |   ├── envapi.rst
|   |   ├── i18n.rst
|   |   ├── index.rst
|   |   ├── logging.rst
|   |   ├── markupapi.rst
|   |   ├── nodes.rst
|   |   ├── parserapi.rst
|   |   ├── projectapi.rst
|   |   └── utils.rst
|   ├── faq.rst
|   ├── glossary.rst
|   ├── internals
|   |   ├── authors.rst
|   |   ├── code-of-conduct.rst
|   |   ├── contributing.rst
|   |   ├── index.rst
|   |   ├── organization.rst
|   |   └── release-process.rst
|   ├── latex.rst
|   ├── man
|   |   ├── index.rst
|   |   ├── sphinx-apidoc.rst
|   |   ├── sphinx-autogen.rst
|   |   ├── sphinx-build.rst
|   |   └── sphinx-quickstart.rst
|   ├── templating.rst
|   └── usage
|       ├── advanced
|       |   ├── intl.rst
|       |   ├── setuptools.rst
|       |   └── websupport
|       |       ├── api.rst
|       |       ├── index.rst
|       |       ├── quickstart.rst
|       |       ├── searchadapters.rst
|       |       └── storagebackends.rst
|       ├── builders
|       |   └── index.rst
|       ├── configuration.rst
|       ├── extensions
|       |   ├── autodoc.rst
|       |   ├── autosectionlabel.rst
|       |   ├── autosummary.rst
|       |   ├── coverage.rst
|       |   ├── doctest.rst
|       |   ├── duration.rst
|       |   ├── example_google.py
|       |   ├── example_google.rst
|       |   ├── example_numpy.py
|       |   ├── example_numpy.rst
|       |   ├── extlinks.rst
|       |   ├── githubpages.rst
|       |   ├── graphviz.rst
|       |   ├── ifconfig.rst
|       |   ├── imgconverter.rst
|       |   ├── index.rst
|       |   ├── inheritance.rst
|       |   ├── intersphinx.rst
|       |   ├── linkcode.rst
|       |   ├── math.rst
|       |   ├── napoleon.rst
|       |   ├── todo.rst
|       |   └── viewcode.rst
|       ├── index.rst
|       ├── installation.rst
|       ├── markdown.rst
|       ├── quickstart.rst
|       ├── restructuredtext
|       |   ├── basics.rst
|       |   ├── directives.rst
|       |   ├── domains.rst
|       |   ├── field-lists.rst
|       |   ├── index.rst
|       |   └── roles.rst
|       └── theming.rst
├── karma.conf.js
├── setup.py
├── sphinx
|   ├── __init__.py
|   ├── __main__.py
|   ├── addnodes.py
|   ├── application.py
|   ├── builders
|   |   ├── __init__.py
|   |   ├── _epub_base.py
|   |   ├── applehelp.py
|   |   ├── changes.py
|   |   ├── devhelp.py
|   |   ├── dirhtml.py
|   |   ├── dummy.py
|   |   ├── epub3.py
|   |   ├── gettext.py
|   |   ├── html
|   |   |   ├── __init__.py
|   |   |   └── transforms.py
|   |   ├── htmlhelp.py
|   |   ├── latex
|   |   |   ├── __init__.py
|   |   |   ├── constants.py
|   |   |   ├── nodes.py
|   |   |   ├── theming.py
|   |   |   ├── transforms.py
|   |   |   └── util.py
|   |   ├── linkcheck.py
|   |   ├── manpage.py
|   |   ├── qthelp.py
|   |   ├── singlehtml.py
|   |   ├── texinfo.py
|   |   ├── text.py
|   |   └── xml.py
|   ├── cmd
|   |   ├── __init__.py
|   |   ├── build.py
|   |   ├── make_mode.py
|   |   └── quickstart.py
|   ├── config.py
|   ├── deprecation.py
|   ├── directives
|   |   ├── __init__.py
|   |   ├── code.py
|   |   ├── other.py
|   |   └── patches.py
|   ├── domains
|   |   ├── __init__.py
|   |   ├── c.py
|   |   ├── changeset.py
|   |   ├── citation.py
|   |   ├── cpp.py
|   |   ├── index.py
|   |   ├── javascript.py
|   |   ├── math.py
|   |   ├── python.py
|   |   ├── rst.py
|   |   └── std.py
|   ├── environment
|   |   ├── __init__.py
|   |   ├── adapters
|   |   |   ├── __init__.py
|   |   |   ├── asset.py
|   |   |   ├── indexentries.py
|   |   |   └── toctree.py
|   |   └── collectors
|   |       ├── __init__.py
|   |       ├── asset.py
|   |       ├── dependencies.py
|   |       ├── indexentries.py
|   |       ├── metadata.py
|   |       ├── title.py
|   |       └── toctree.py
|   ├── errors.py
|   ├── events.py
|   ├── ext
|   |   ├── __init__.py
|   |   ├── apidoc.py
|   |   ├── autodoc
|   |   |   ├── __init__.py
|   |   |   ├── deprecated.py
|   |   |   ├── directive.py
|   |   |   ├── importer.py
|   |   |   ├── mock.py
|   |   |   ├── type_comment.py
|   |   |   └── typehints.py
|   |   ├── autosectionlabel.py
|   |   ├── autosummary
|   |   |   ├── __init__.py
|   |   |   ├── generate.py
|   |   |   └── templates
|   |   |       └── autosummary
|   |   ├── coverage.py
|   |   ├── doctest.py
|   |   ├── duration.py
|   |   ├── extlinks.py
|   |   ├── githubpages.py
|   |   ├── graphviz.py
|   |   ├── ifconfig.py
|   |   ├── imgconverter.py
|   |   ├── imgmath.py
|   |   ├── inheritance_diagram.py
|   |   ├── intersphinx.py
|   |   ├── jsmath.py
|   |   ├── linkcode.py
|   |   ├── mathjax.py
|   |   ├── napoleon
|   |   |   ├── __init__.py
|   |   |   ├── docstring.py
|   |   |   └── iterators.py
|   |   ├── todo.py
|   |   └── viewcode.py
|   ├── extension.py
|   ├── highlighting.py
|   ├── io.py
|   ├── jinja2glue.py
|   ├── locale
|   |   ├── __init__.py
|   |   ├── ar
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bg
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── bn
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ca
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cak
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cs
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── cy
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── da
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── de
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── el
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eo
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── es
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── et
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── eu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fa
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── fr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── he
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hi_IN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── hu
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── id
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── it
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ja
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ko
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── lv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── mk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nb_NO
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ne
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── nl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_BR
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── pt_PT
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ro
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ru
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── si
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sk
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sl
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sq
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr@latin
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sr_RS
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── sv
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ta
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── te
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── tr
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── uk_UA
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── ur
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── vi
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   ├── zh_CN
|   |   |   └── LC_MESSAGES
|   |   |       └── sphinx.js
|   |   └── zh_TW
|   |       └── LC_MESSAGES
|   |           └── sphinx.js
|   ├── parsers.py
|   ├── project.py
|   ├── pycode
|   |   ├── __init__.py
|   |   ├── ast.py
|   |   └── parser.py
|   ├── pygments_styles.py
|   ├── registry.py
|   ├── roles.py
|   ├── search
|   |   ├── __init__.py
|   |   ├── da.py
|   |   ├── de.py
|   |   ├── en.py
|   |   ├── es.py
|   |   ├── fi.py
|   |   ├── fr.py
|   |   ├── hu.py
|   |   ├── it.py
|   |   ├── ja.py
|   |   ├── jssplitter.py
|   |   ├── nl.py
|   |   ├── no.py
|   |   ├── non-minified-js
|   |   |   ├── danish-stemmer.js
|   |   |   ├── dutch-stemmer.js
|   |   |   ├── finnish-stemmer.js
|   |   |   ├── french-stemmer.js
|   |   |   ├── german-stemmer.js
|   |   |   ├── hungarian-stemmer.js
|   |   |   ├── italian-stemmer.js
|   |   |   ├── norwegian-stemmer.js
|   |   |   ├── porter-stemmer.js
|   |   |   ├── portuguese-stemmer.js
|   |   |   ├── romanian-stemmer.js
|   |   |   ├── russian-stemmer.js
|   |   |   ├── spanish-stemmer.js
|   |   |   ├── swedish-stemmer.js
|   |   |   └── turkish-stemmer.js
|   |   ├── pt.py
|   |   ├── ro.py
|   |   ├── ru.py
|   |   ├── sv.py
|   |   ├── tr.py
|   |   └── zh.py
|   ├── setup_command.py
|   ├── templates
|   |   ├── apidoc
|   |   ├── epub3
|   |   |   └── container.xml
|   |   ├── gettext
|   |   ├── graphviz
|   |   |   └── graphviz.css
|   |   ├── htmlhelp
|   |   ├── imgmath
|   |   ├── latex
|   |   ├── quickstart
|   |   └── texinfo
|   ├── testing
|   |   ├── __init__.py
|   |   ├── comparer.py
|   |   ├── fixtures.py
|   |   ├── path.py
|   |   ├── restructuredtext.py
|   |   └── util.py
|   ├── texinputs
|   ├── texinputs_win
|   ├── themes
|   |   ├── agogo
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── basic
|   |   |   ├── changes
|   |   |   |   ├── frameset.html
|   |   |   |   ├── rstsource.html
|   |   |   |   └── versionchanges.html
|   |   |   ├── defindex.html
|   |   |   ├── domainindex.html
|   |   |   ├── genindex-single.html
|   |   |   ├── genindex-split.html
|   |   |   ├── genindex.html
|   |   |   ├── globaltoc.html
|   |   |   ├── layout.html
|   |   |   ├── localtoc.html
|   |   |   ├── opensearch.xml
|   |   |   ├── page.html
|   |   |   ├── relations.html
|   |   |   ├── search.html
|   |   |   ├── searchbox.html
|   |   |   ├── sourcelink.html
|   |   |   └── static
|   |   |       ├── doctools.js
|   |   |       ├── jquery-3.5.1.js
|   |   |       ├── jquery.js
|   |   |       ├── searchtools.js
|   |   |       ├── underscore-1.3.1.js
|   |   |       └── underscore.js
|   |   ├── bizstyle
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── css3-mediaqueries.js
|   |   |       └── css3-mediaqueries_src.js
|   |   ├── classic
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── default
|   |   |   └── static
|   |   |       └── default.css
|   |   ├── epub
|   |   |   ├── epub-cover.html
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── haiku
|   |   |   ├── layout.html
|   |   |   └── static
|   |   ├── nature
|   |   |   └── static
|   |   ├── nonav
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       └── nonav.css
|   |   ├── pyramid
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── epub.css
|   |   |       └── ie6.css
|   |   ├── scrolls
|   |   |   ├── artwork
|   |   |   ├── layout.html
|   |   |   └── static
|   |   |       ├── print.css
|   |   |       └── theme_extras.js
|   |   ├── sphinxdoc
|   |   |   └── static
|   |   └── traditional
|   |       └── static
|   ├── theming.py
|   ├── transforms
|   |   ├── __init__.py
|   |   ├── compact_bullet_list.py
|   |   ├── i18n.py
|   |   ├── post_transforms
|   |   |   ├── __init__.py
|   |   |   ├── code.py
|   |   |   └── images.py
|   |   └── references.py
|   ├── util
|   |   ├── __init__.py
|   |   ├── build_phase.py
|   |   ├── cfamily.py
|   |   ├── compat.py
|   |   ├── console.py
|   |   ├── docfields.py
|   |   ├── docstrings.py
|   |   ├── docutils.py
|   |   ├── fileutil.py
|   |   ├── i18n.py
|   |   ├── images.py
|   |   ├── inspect.py
|   |   ├── inventory.py
|   |   ├── jsdump.py
|   |   ├── jsonimpl.py
|   |   ├── logging.py
|   |   ├── matching.py
|   |   ├── math.py
|   |   ├── nodes.py
|   |   ├── osutil.py
|   |   ├── parallel.py
|   |   ├── png.py
|   |   ├── pycompat.py
|   |   ├── requests.py
|   |   ├── rst.py
|   |   ├── smartypants.py
|   |   ├── stemmer
|   |   |   ├── __init__.py
|   |   |   └── porter.py
|   |   ├── tags.py
|   |   ├── template.py
|   |   ├── texescape.py
|   |   └── typing.py
|   ├── versioning.py
|   └── writers
|       ├── __init__.py
|       ├── html.py
|       ├── html5.py
|       ├── latex.py
|       ├── manpage.py
|       ├── texinfo.py
|       ├── text.py
|       └── xml.py
├── tests
|   ├── __init__.py
|   ├── certs
|   ├── conftest.py
|   ├── ext_napoleon_pep526_data_google.py
|   ├── ext_napoleon_pep526_data_numpy.py
|   ├── js
|   |   └── doctools.js
|   ├── roots
|   |   ├── test-add_enumerable_node
|   |   |   ├── conf.py
|   |   |   ├── enumerable_node.py
|   |   |   └── index.rst
|   |   ├── test-add_source_parser
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-add_source_parser-conflicts-with-users-setting
|   |   |   ├── conf.py
|   |   |   └── source_parser.py
|   |   ├── test-api-set-translator
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nonext
|   |   |   |   └── conf.py
|   |   |   └── translator.py
|   |   ├── test-apidoc-pep420
|   |   |   └── a
|   |   |       └── b
|   |   ├── test-apidoc-subpackage-in-toc
|   |   |   └── parent
|   |   |       ├── __init__.py
|   |   |       └── child
|   |   ├── test-apidoc-toc
|   |   |   └── mypackage
|   |   |       ├── __init__.py
|   |   |       ├── main.py
|   |   |       ├── no_init
|   |   |       ├── resource
|   |   |       └── something
|   |   ├── test-apidoc-trailing-underscore
|   |   |   └── package_
|   |   |       ├── __init__.py
|   |   |       └── module_.py
|   |   ├── test-autosummary
|   |   |   ├── conf.py
|   |   |   ├── dummy_module.py
|   |   |   ├── index.rst
|   |   |   ├── sphinx.rst
|   |   |   └── underscore_module_.py
|   |   ├── test-basic
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-html-translator
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-build-text
|   |   |   ├── conf.py
|   |   |   ├── doc1.txt
|   |   |   ├── doc2.txt
|   |   |   ├── index.txt
|   |   |   ├── lineblock.txt
|   |   |   ├── listitems.txt
|   |   |   ├── maxwidth.txt
|   |   |   ├── nonascii_maxwidth.txt
|   |   |   ├── nonascii_table.txt
|   |   |   ├── nonascii_title.txt
|   |   |   ├── table.txt
|   |   |   ├── table_colspan.txt
|   |   |   ├── table_colspan_and_rowspan.txt
|   |   |   ├── table_colspan_left.txt
|   |   |   └── table_rowspan.txt
|   |   ├── test-builder-dirhtml
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo
|   |   |   |   ├── foo_1.rst
|   |   |   |   ├── foo_2.rst
|   |   |   |   └── index.rst
|   |   |   └── index.rst
|   |   ├── test-builder-gettext-dont-rebuild-mo
|   |   |   ├── bom.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-changes
|   |   |   ├── base.rst
|   |   |   ├── c-api.rst
|   |   |   ├── conf.py
|   |   |   ├── contents.rst
|   |   |   └── library
|   |   |       └── utils.rst
|   |   ├── test-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-config
|   |   |   └── conf.py
|   |   ├── test-correct-year
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-default_role
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-directive-code
|   |   |   ├── caption.rst
|   |   |   ├── classes.rst
|   |   |   ├── conf.py
|   |   |   ├── emphasize.rst
|   |   |   ├── force.rst
|   |   |   ├── highlight.rst
|   |   |   ├── index.rst
|   |   |   ├── linenos.rst
|   |   |   ├── linenothreshold.rst
|   |   |   ├── namedblocks.rst
|   |   |   ├── py-decorators.rst
|   |   |   ├── python.rst
|   |   |   └── target.py
|   |   ├── test-directive-only
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── only.rst
|   |   ├── test-directives-raw
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-docutilsconf
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-c
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── conf.py
|   |   |   ├── function_param_target.rst
|   |   |   ├── index.rst
|   |   |   ├── namespace.rst
|   |   |   └── semicolon.rst
|   |   ├── test-domain-c-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-cpp
|   |   |   ├── anon-dup-decl.rst
|   |   |   ├── any-role.rst
|   |   |   ├── backslash.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── lookup-key-overload.rst
|   |   |   ├── multi-decl-lookup.rst
|   |   |   ├── roles-targets-ok.rst
|   |   |   ├── roles-targets-warn.rst
|   |   |   ├── roles.rst
|   |   |   ├── roles2.rst
|   |   |   ├── semicolon.rst
|   |   |   ├── warn-template-param-qualified-name.rst
|   |   |   └── xref_consistency.rst
|   |   ├── test-domain-cpp-intersphinx
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-domain-js
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py
|   |   |   ├── abbr.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── module.rst
|   |   |   ├── module_option.rst
|   |   |   └── roles.rst
|   |   ├── test-domain-py-xref-warning
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-double-inheriting-theme
|   |   |   ├── base_themes_dir
|   |   |   |   ├── base_theme1
|   |   |   |   └── base_theme2
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-epub-anchor-id
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autodoc
|   |   |   ├── autodoc_dummy_bar.py
|   |   |   ├── autodoc_dummy_module.py
|   |   |   ├── bug2437
|   |   |   |   ├── __init__.py
|   |   |   |   └── autodoc_dummy_foo.py
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target
|   |   |       ├── TYPE_CHECKING.py
|   |   |       ├── __init__.py
|   |   |       ├── abstractmethods.py
|   |   |       ├── annotated.py
|   |   |       ├── annotations.py
|   |   |       ├── autoclass_content.py
|   |   |       ├── bound_method.py
|   |   |       ├── cached_property.py
|   |   |       ├── callable.py
|   |   |       ├── classes.py
|   |   |       ├── coroutine.py
|   |   |       ├── decorator.py
|   |   |       ├── descriptor.py
|   |   |       ├── docstring_signature.py
|   |   |       ├── empty_all.py
|   |   |       ├── enums.py
|   |   |       ├── final.py
|   |   |       ├── functions.py
|   |   |       ├── generic_class.py
|   |   |       ├── genericalias.py
|   |   |       ├── hide_value.py
|   |   |       ├── imported_members.py
|   |   |       ├── inheritance.py
|   |   |       ├── instance_variable.py
|   |   |       ├── methods.py
|   |   |       ├── name_conflict
|   |   |       ├── name_mangling.py
|   |   |       ├── need_mocks.py
|   |   |       ├── overload.py
|   |   |       ├── overload2.py
|   |   |       ├── partialfunction.py
|   |   |       ├── partialmethod.py
|   |   |       ├── pep570.py
|   |   |       ├── private.py
|   |   |       ├── process_docstring.py
|   |   |       ├── singledispatch.py
|   |   |       ├── singledispatchmethod.py
|   |   |       ├── slots.py
|   |   |       ├── sort_by_all.py
|   |   |       ├── typed_vars.py
|   |   |       ├── typehints.py
|   |   |       ├── typevar.py
|   |   |       └── wrappedfunction.py
|   |   ├── test-ext-autosectionlabel
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosectionlabel-prefix-document
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── autosummary_importfail.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-filename-map
|   |   |   ├── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-imported_members
|   |   |   ├── autosummary_dummy_package
|   |   |   |   ├── __init__.py
|   |   |   |   └── autosummary_dummy_module.py
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-mock_imports
|   |   |   ├── conf.py
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-autosummary-recursive
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── package
|   |   |   |   ├── __init__.py
|   |   |   |   ├── module.py
|   |   |   |   ├── module_importfail.py
|   |   |   |   └── package
|   |   |   └── package2
|   |   |       ├── __init__.py
|   |   |       └── module.py
|   |   ├── test-ext-autosummary-skip-member
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-autosummary-template
|   |   |   ├── _templates
|   |   |   |   └── empty.rst
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── target.py
|   |   ├── test-ext-coverage
|   |   |   ├── conf.py
|   |   |   ├── coverage_ignored.py
|   |   |   ├── coverage_not_ignored.py
|   |   |   └── index.rst
|   |   ├── test-ext-doctest
|   |   |   ├── conf.py
|   |   |   └── doctest.txt
|   |   ├── test-ext-doctest-skipif
|   |   |   ├── conf.py
|   |   |   └── skipif.txt
|   |   ├── test-ext-doctest-with-autodoc
|   |   |   ├── conf.py
|   |   |   ├── dir
|   |   |   |   ├── __init__.py
|   |   |   |   ├── bar.py
|   |   |   |   └── inner.rst
|   |   |   ├── foo.py
|   |   |   └── index.rst
|   |   ├── test-ext-githubpages
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-graphviz
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-ifconfig
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-imgconverter
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-inheritance_diagram
|   |   |   ├── conf.py
|   |   |   ├── example
|   |   |   |   ├── __init__.py
|   |   |   |   └── sphinx.py
|   |   |   ├── index.rst
|   |   |   └── test.py
|   |   ├── test-ext-intersphinx-cppdomain
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── math.rst
|   |   |   ├── nomath.rst
|   |   |   └── page.rst
|   |   ├── test-ext-math-compat
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-math-simple
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-ext-todo
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-ext-viewcode
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── objects.rst
|   |   |   └── spam
|   |   |       ├── __init__.py
|   |   |       ├── mod1.py
|   |   |       ├── mod2.py
|   |   |       └── mod3.py
|   |   ├── test-ext-viewcode-find
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── not_a_package
|   |   |       ├── __init__.py
|   |   |       └── submodule.py
|   |   ├── test-extensions
|   |   |   ├── conf.py
|   |   |   ├── read_parallel.py
|   |   |   ├── read_serial.py
|   |   |   ├── write_parallel.py
|   |   |   └── write_serial.py
|   |   ├── test-footnotes
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-gettext-template
|   |   |   ├── _templates
|   |   |   |   ├── template1.html
|   |   |   |   └── template2.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-glossary
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-highlight_options
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_assets
|   |   |   ├── conf.py
|   |   |   ├── extra
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   └── subdir
|   |   |   ├── index.rst
|   |   |   ├── static
|   |   |   |   ├── css
|   |   |   |   ├── index.rst
|   |   |   |   ├── js
|   |   |   |   └── subdir
|   |   |   └── subdir
|   |   |       └── _build
|   |   ├── test-html_entity
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_scaled_image_link
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-html_style
|   |   |   ├── _static
|   |   |   |   └── default.css
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-parsed-literal
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-image-in-section
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-images
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── subdir
|   |   |       └── index.rst
|   |   ├── test-index_on_title
|   |   |   ├── conf.py
|   |   |   └── contents.rst
|   |   ├── test-inheritance
|   |   |   ├── basic_diagram.rst
|   |   |   ├── conf.py
|   |   |   ├── diagram_module_w_2_top_classes.rst
|   |   |   ├── diagram_w_1_top_class.rst
|   |   |   ├── diagram_w_2_top_classes.rst
|   |   |   ├── diagram_w_nested_classes.rst
|   |   |   ├── diagram_w_parts.rst
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── test.py
|   |   |   |   └── test_nested.py
|   |   |   └── index.rst
|   |   ├── test-intl
|   |   |   ├── _templates
|   |   |   |   └── contents.html
|   |   |   ├── admonitions.txt
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── definition_terms.txt
|   |   |   ├── docfields.txt
|   |   |   ├── external_links.txt
|   |   |   ├── figure.txt
|   |   |   ├── footnote.txt
|   |   |   ├── glossary_terms.txt
|   |   |   ├── glossary_terms_inconsistency.txt
|   |   |   ├── index.txt
|   |   |   ├── index_entries.txt
|   |   |   ├── label_target.txt
|   |   |   ├── literalblock.txt
|   |   |   ├── only.txt
|   |   |   ├── raw.txt
|   |   |   ├── refs.txt
|   |   |   ├── refs_inconsistency.txt
|   |   |   ├── refs_python_domain.txt
|   |   |   ├── role_xref.txt
|   |   |   ├── rubric.txt
|   |   |   ├── section.txt
|   |   |   ├── seealso.txt
|   |   |   ├── subdir
|   |   |   |   └── index.txt
|   |   |   ├── table.txt
|   |   |   ├── toctree.txt
|   |   |   ├── topic.txt
|   |   |   ├── versionchange.txt
|   |   |   ├── warnings.txt
|   |   |   └── xx
|   |   |       └── LC_MESSAGES
|   |   ├── test-keep_warnings
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-babel
|   |   |   ├── bar.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-latex-equations
|   |   |   ├── conf.py
|   |   |   ├── equations.rst
|   |   |   └── expects
|   |   ├── test-latex-figure-in-admonition
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-includegraphics
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-index
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-labels
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── otherdoc.rst
|   |   ├── test-latex-numfig
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── indexhowto.rst
|   |   |   └── indexmanual.rst
|   |   ├── test-latex-table
|   |   |   ├── _mytemplates
|   |   |   |   └── latex
|   |   |   ├── complex.rst
|   |   |   ├── conf.py
|   |   |   ├── expects
|   |   |   ├── index.rst
|   |   |   ├── longtable.rst
|   |   |   └── tabular.rst
|   |   ├── test-latex-theme
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── theme
|   |   |       └── custom
|   |   ├── test-latex-title
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-latex-unicode
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck
|   |   |   ├── conf.py
|   |   |   └── links.txt
|   |   ├── test-linkcheck-localserver
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-anchor
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-linkcheck-localserver-https
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-locale
|   |   |   ├── locale1
|   |   |   |   └── en
|   |   |   └── locale2
|   |   |       └── en
|   |   ├── test-manpage_url
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-citation
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-markup-rubric
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-maxlistdepth
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-metadata
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-need-escaped
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux.rst
|   |   ├── test-nested-enumerated-list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-nested-tables
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-numbered-circular
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── sub.rst
|   |   ├── test-numfig
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-productionlist
|   |   |   ├── Bare.rst
|   |   |   ├── Dup1.rst
|   |   |   ├── Dup2.rst
|   |   |   ├── LineContinuation.rst
|   |   |   ├── P1.rst
|   |   |   ├── P2.rst
|   |   |   ├── conf.py
|   |   |   ├── firstLineRule.rst
|   |   |   └── index.rst
|   |   ├── test-prolog
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── markdown.md
|   |   |   ├── prolog_markdown_parser.py
|   |   |   └── restructuredtext.rst
|   |   ├── test-pycode
|   |   |   └── cp_1251_coded.py
|   |   ├── test-pycode-egg
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   └── src
|   |   |       ├── sample.py
|   |   |       └── setup.py
|   |   ├── test-reST-code-block
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-refonly_bullet_list
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-roles-download
|   |   |   ├── another
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-root
|   |   |   ├── _templates
|   |   |   |   ├── contentssb.html
|   |   |   |   ├── customsb.html
|   |   |   |   └── layout.html
|   |   |   ├── autodoc.txt
|   |   |   ├── autodoc_target.py
|   |   |   ├── bom.txt
|   |   |   ├── conf.py
|   |   |   ├── extapi.txt
|   |   |   ├── extensions.txt
|   |   |   ├── footnote.txt
|   |   |   ├── images.txt
|   |   |   ├── includes.txt
|   |   |   ├── index.txt
|   |   |   ├── lists.txt
|   |   |   ├── markup.txt
|   |   |   ├── math.txt
|   |   |   ├── objects.txt
|   |   |   ├── parsermod.py
|   |   |   ├── special
|   |   |   |   └── code.py
|   |   |   └── subdir
|   |   |       ├── excluded.txt
|   |   |       ├── images.txt
|   |   |       └── includes.txt
|   |   ├── test-search
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── nosearch.rst
|   |   |   └── tocitem.rst
|   |   ├── test-setup
|   |   |   ├── doc
|   |   |   |   ├── conf.py
|   |   |   |   └── index.txt
|   |   |   └── setup.py
|   |   ├── test-smartquotes
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-stylesheets
|   |   |   ├── _templates
|   |   |   |   └── layout.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-templating
|   |   |   ├── _templates
|   |   |   |   ├── autosummary
|   |   |   |   └── layout.html
|   |   |   ├── autosummary_templating.txt
|   |   |   ├── conf.py
|   |   |   └── index.txt
|   |   ├── test-theming
|   |   |   ├── conf.py
|   |   |   ├── index.rst
|   |   |   ├── setup.py
|   |   |   └── test_theme
|   |   |       ├── __init__.py
|   |   |       ├── staticfiles
|   |   |       └── test-theme
|   |   ├── test-tocdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   ├── qux.rst
|   |   |   └── tocdepth.rst
|   |   ├── test-toctree-duplicated
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   └── index.rst
|   |   ├── test-toctree-empty
|   |   |   ├── _templates
|   |   |   |   └── localtoc.html
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-toctree-glob
|   |   |   ├── bar
|   |   |   |   ├── bar_1.rst
|   |   |   |   ├── bar_2.rst
|   |   |   |   ├── bar_3.rst
|   |   |   |   ├── bar_4
|   |   |   |   └── index.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   ├── quux.rst
|   |   |   └── qux
|   |   |       ├── index.rst
|   |   |       ├── qux_1.rst
|   |   |       └── qux_2.rst
|   |   ├── test-toctree-maxdepth
|   |   |   ├── bar.rst
|   |   |   ├── baz.rst
|   |   |   ├── conf.py
|   |   |   ├── foo.rst
|   |   |   ├── index.rst
|   |   |   └── qux.rst
|   |   ├── test-trim_doctest_flags
|   |   |   ├── conf.py
|   |   |   └── index.rst
|   |   ├── test-versioning
|   |   |   ├── added.txt
|   |   |   ├── conf.py
|   |   |   ├── deleted.txt
|   |   |   ├── deleted_end.txt
|   |   |   ├── index.txt
|   |   |   ├── insert.txt
|   |   |   ├── insert_beginning.txt
|   |   |   ├── insert_similar.txt
|   |   |   ├── modified.txt
|   |   |   └── original.txt
|   |   └── test-warnings
|   |       ├── autodoc_fodder.py
|   |       ├── conf.py
|   |       ├── index.rst
|   |       └── undecodable.rst
|   ├── test_api_translator.py
|   ├── test_application.py
|   ├── test_build.py
|   ├── test_build_changes.py
|   ├── test_build_dirhtml.py
|   ├── test_build_epub.py
|   ├── test_build_gettext.py
|   ├── test_build_html.py
|   ├── test_build_latex.py
|   ├── test_build_linkcheck.py
|   ├── test_build_manpage.py
|   ├── test_build_texinfo.py
|   ├── test_build_text.py
|   ├── test_builder.py
|   ├── test_catalogs.py
|   ├── test_config.py
|   ├── test_correct_year.py
|   ├── test_directive_code.py
|   ├── test_directive_only.py
|   ├── test_directive_other.py
|   ├── test_directive_patch.py
|   ├── test_docutilsconf.py
|   ├── test_domain_c.py
|   ├── test_domain_cpp.py
|   ├── test_domain_js.py
|   ├── test_domain_py.py
|   ├── test_domain_rst.py
|   ├── test_domain_std.py
|   ├── test_environment.py
|   ├── test_environment_indexentries.py
|   ├── test_environment_toctree.py
|   ├── test_errors.py
|   ├── test_events.py
|   ├── test_ext_apidoc.py
|   ├── test_ext_autodoc.py
|   ├── test_ext_autodoc_autoattribute.py
|   ├── test_ext_autodoc_autoclass.py
|   ├── test_ext_autodoc_autodata.py
|   ├── test_ext_autodoc_autofunction.py
|   ├── test_ext_autodoc_automodule.py
|   ├── test_ext_autodoc_configs.py
|   ├── test_ext_autodoc_events.py
|   ├── test_ext_autodoc_mock.py
|   ├── test_ext_autodoc_private_members.py
|   ├── test_ext_autosectionlabel.py
|   ├── test_ext_autosummary.py
|   ├── test_ext_coverage.py
|   ├── test_ext_doctest.py
|   ├── test_ext_duration.py
|   ├── test_ext_githubpages.py
|   ├── test_ext_graphviz.py
|   ├── test_ext_ifconfig.py
|   ├── test_ext_imgconverter.py
|   ├── test_ext_inheritance_diagram.py
|   ├── test_ext_intersphinx.py
|   ├── test_ext_math.py
|   ├── test_ext_napoleon.py
|   ├── test_ext_napoleon_docstring.py
|   ├── test_ext_napoleon_iterators.py
|   ├── test_ext_todo.py
|   ├── test_ext_viewcode.py
|   ├── test_highlighting.py
|   ├── test_intl.py
|   ├── test_locale.py
|   ├── test_markup.py
|   ├── test_metadata.py
|   ├── test_parser.py
|   ├── test_project.py
|   ├── test_pycode.py
|   ├── test_pycode_ast.py
|   ├── test_pycode_parser.py
|   ├── test_quickstart.py
|   ├── test_roles.py
|   ├── test_search.py
|   ├── test_setup_command.py
|   ├── test_smartquotes.py
|   ├── test_templating.py
|   ├── test_theming.py
|   ├── test_toctree.py
|   ├── test_transforms_post_transforms_code.py
|   ├── test_util.py
|   ├── test_util_docstrings.py
|   ├── test_util_docutils.py
|   ├── test_util_fileutil.py
|   ├── test_util_i18n.py
|   ├── test_util_images.py
|   ├── test_util_inspect.py
|   ├── test_util_inventory.py
|   ├── test_util_jsdump.py
|   ├── test_util_logging.py
|   ├── test_util_matching.py
|   ├── test_util_nodes.py
|   ├── test_util_pycompat.py
|   ├── test_util_rst.py
|   ├── test_util_template.py
|   ├── test_util_typing.py
|   ├── test_versioning.py
|   ├── test_writer_latex.py
|   ├── typing_test_data.py
|   └── utils.py
└── utils
    ├── __init__.py
    ├── bump_docker.sh
    ├── bump_version.py
    ├── checks.py
    ├── doclinter.py
    └── jssplitter_generator.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

Description: **Describe the bug**
viewcode creates pages for epub even if `viewcode_enable_epub=False` on `make html epub`

**To Reproduce**
```
$ make html epub
```

**Expected behavior**
module pages should not be created for epub by default.

**Your project**
No

**Screenshots**
No

**Environment info**
- OS: Mac
- Python version: 3.9.1
- Sphinx version: HEAD of 3.x
- Sphinx extensions:  sphinx.ext.viewcode
- Extra tools: No

**Additional context**
No


Patch information:
diff --git a/sphinx/ext/viewcode.py b/sphinx/ext/viewcode.py
index a7d52a91c..417f0db97 100644
--- a/sphinx/ext/viewcode.py
+++ b/sphinx/ext/viewcode.py
@@ -52,12 +52,12 @@ def _get_full_modname(app: Sphinx, modname: str, attribute: str) -> Optional[str
 
 def doctree_read(app: Sphinx, doctree: Node) -> None:
     env = app.builder.env
-    if not hasattr(env, '_viewcode_modules'):
-        env._viewcode_modules = {}  # type: ignore
     if app.builder.name == "singlehtml":
         return
     if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
         return
+    if not hasattr(env, '_viewcode_modules'):
+        env._viewcode_modules = {}  # type: ignore
 
     def has_tag(modname: str, fullname: str, docname: str, refname: str) -> bool:
         entry = env._viewcode_modules.get(modname, None)  # type: ignore
@@ -180,6 +180,10 @@ def should_generate_module_page(app: Sphinx, modname: str) -> bool:
 
 def collect_pages(app: Sphinx) -> Generator[Tuple[str, Dict[str, Any], str], None, None]:
     env = app.builder.env
+    if app.builder.name == "singlehtml":
+        return
+    if app.builder.name.startswith("epub") and not env.config.viewcode_enable_epub:
+        return
     if not hasattr(env, '_viewcode_modules'):
         return
     highlighter = app.builder.highlighter  # type: ignore


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file `tests/test_ext_viewcode.py`.
Extra Requirements: 
Purpose: I need to examine the tests for the `viewcode` extension to find ones relevant to the reported bug concerning the `epub` builder.

Previous refined query 2:
Essential Query: Please provide the full content of the file `tests/test_build_epub.py`.
Extra Requirements: 
Purpose: I need to analyze the epub builder tests to find cases that involve the `viewcode` extension and check for correct file generation behavior based on configuration.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/test_build_epub.py
Line number range: 1 - 396
Content:
1. """
2.     test_build_html
3.     ~~~~~~~~~~~~~~~
4. 
5.     Test the HTML builder and check output against XPath.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import os
12. import subprocess
13. from subprocess import PIPE, CalledProcessError
14. from xml.etree import ElementTree
15. 
16. import pytest
17. 
18. from sphinx.util import docutils
19. 
20. 
21. # check given command is runnable
22. def runnable(command):
23.     try:
24.         subprocess.run(command, stdout=PIPE, stderr=PIPE, check=True)
25.         return True
26.     except (OSError, CalledProcessError):
27.         return False  # command not found or exit with non-zero
28. 
29. 
30. class EPUBElementTree:
31.     """Test helper for content.opf and toc.ncx"""
32.     namespaces = {
33.         'idpf': 'http://www.idpf.org/2007/opf',
34.         'dc': 'http://purl.org/dc/elements/1.1/',
35.         'ibooks': 'http://vocabulary.itunes.apple.com/rdf/ibooks/vocabulary-extensions-1.0/',
36.         'ncx': 'http://www.daisy.org/z3986/2005/ncx/',
37.         'xhtml': 'http://www.w3.org/1999/xhtml',
38.         'epub': 'http://www.idpf.org/2007/ops'
39.     }
40. 
41.     def __init__(self, tree):
42.         self.tree = tree
43. 
44.     @classmethod
45.     def fromstring(cls, string):
46.         return cls(ElementTree.fromstring(string))
47. 
48.     def find(self, match):
49.         ret = self.tree.find(match, namespaces=self.namespaces)
50.         if ret is not None:
51.             return self.__class__(ret)
52.         else:
53.             return ret
54. 
55.     def findall(self, match):
56.         ret = self.tree.findall(match, namespaces=self.namespaces)
57.         return [self.__class__(e) for e in ret]
58. 
59.     def __getattr__(self, name):
60.         return getattr(self.tree, name)
61. 
62.     def __iter__(self):
63.         for child in self.tree:
64.             yield self.__class__(child)
65. 
66. 
67. @pytest.mark.sphinx('epub', testroot='basic')
68. def test_build_epub(app):
69.     app.build()
70.     assert (app.outdir / 'mimetype').read_text() == 'application/epub+zip'
71.     assert (app.outdir / 'META-INF' / 'container.xml').exists()
72. 
73.     # toc.ncx
74.     toc = EPUBElementTree.fromstring((app.outdir / 'toc.ncx').read_text())
75.     assert toc.find("./ncx:docTitle/ncx:text").text == 'Python'
76. 
77.     # toc.ncx / head
78.     meta = list(toc.find("./ncx:head"))
79.     assert meta[0].attrib == {'name': 'dtb:uid', 'content': 'unknown'}
80.     assert meta[1].attrib == {'name': 'dtb:depth', 'content': '1'}
81.     assert meta[2].attrib == {'name': 'dtb:totalPageCount', 'content': '0'}
82.     assert meta[3].attrib == {'name': 'dtb:maxPageNumber', 'content': '0'}
83. 
84.     # toc.ncx / navMap
85.     navpoints = toc.findall("./ncx:navMap/ncx:navPoint")
86.     assert len(navpoints) == 1
87.     assert navpoints[0].attrib == {'id': 'navPoint1', 'playOrder': '1'}
88.     assert navpoints[0].find("./ncx:content").attrib == {'src': 'index.xhtml'}
89. 
90.     navlabel = navpoints[0].find("./ncx:navLabel/ncx:text")
91.     assert navlabel.text == 'The basic Sphinx documentation for testing'
92. 
93.     # content.opf
94.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
95. 
96.     # content.opf / metadata
97.     metadata = opf.find("./idpf:metadata")
98.     assert metadata.find("./dc:language").text == 'en'
99.     assert metadata.find("./dc:title").text == 'Python'
100.     assert metadata.find("./dc:description").text == 'unknown'
101.     assert metadata.find("./dc:creator").text == 'unknown'
102.     assert metadata.find("./dc:contributor").text == 'unknown'
103.     assert metadata.find("./dc:publisher").text == 'unknown'
104.     assert metadata.find("./dc:rights").text is None
105.     assert metadata.find("./idpf:meta[@property='ibooks:version']").text is None
106.     assert metadata.find("./idpf:meta[@property='ibooks:specified-fonts']").text == 'true'
107.     assert metadata.find("./idpf:meta[@property='ibooks:binding']").text == 'true'
108.     assert metadata.find("./idpf:meta[@property='ibooks:scroll-axis']").text == 'vertical'
109. 
110.     # content.opf / manifest
111.     manifest = opf.find("./idpf:manifest")
112.     items = list(manifest)
113.     assert items[0].attrib == {'id': 'ncx',
114.                                'href': 'toc.ncx',
115.                                'media-type': 'application/x-dtbncx+xml'}
116.     assert items[1].attrib == {'id': 'nav',
117.                                'href': 'nav.xhtml',
118.                                'media-type': 'application/xhtml+xml',
119.                                'properties': 'nav'}
120.     assert items[2].attrib == {'id': 'epub-0',
121.                                'href': 'genindex.xhtml',
122.                                'media-type': 'application/xhtml+xml'}
123.     assert items[3].attrib == {'id': 'epub-1',
124.                                'href': 'index.xhtml',
125.                                'media-type': 'application/xhtml+xml'}
126. 
127.     for i, item in enumerate(items[2:]):
128.         # items are named as epub-NN
129.         assert item.get('id') == 'epub-%d' % i
130. 
131.     # content.opf / spine
132.     spine = opf.find("./idpf:spine")
133.     itemrefs = list(spine)
134.     assert spine.get('toc') == 'ncx'
135.     assert spine.get('page-progression-direction') == 'ltr'
136.     assert itemrefs[0].get('idref') == 'epub-1'
137.     assert itemrefs[1].get('idref') == 'epub-0'
138. 
139.     # content.opf / guide
140.     reference = opf.find("./idpf:guide/idpf:reference")
141.     assert reference.get('type') == 'toc'
142.     assert reference.get('title') == 'Table of Contents'
143.     assert reference.get('href') == 'index.xhtml'
144. 
145.     # nav.xhtml
146.     nav = EPUBElementTree.fromstring((app.outdir / 'nav.xhtml').read_text())
147.     assert nav.attrib == {'lang': 'en',
148.                           '{http://www.w3.org/XML/1998/namespace}lang': 'en'}
149.     assert nav.find("./xhtml:head/xhtml:title").text == 'Table of Contents'
150. 
151.     # nav.xhtml / nav
152.     navlist = nav.find("./xhtml:body/xhtml:nav")
153.     toc = navlist.findall("./xhtml:ol/xhtml:li")
154.     assert navlist.find("./xhtml:h1").text == 'Table of Contents'
155.     assert len(toc) == 1
156.     assert toc[0].find("./xhtml:a").get("href") == 'index.xhtml'
157.     assert toc[0].find("./xhtml:a").text == 'The basic Sphinx documentation for testing'
158. 
159. 
160. @pytest.mark.sphinx('epub', testroot='footnotes',
161.                     confoverrides={'epub_cover': ('_images/rimg.png', None)})
162. def test_epub_cover(app):
163.     app.build()
164. 
165.     # content.opf / metadata
166.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
167.     cover_image = opf.find("./idpf:manifest/idpf:item[@href='%s']" % app.config.epub_cover[0])
168.     cover = opf.find("./idpf:metadata/idpf:meta[@name='cover']")
169.     assert cover
170.     assert cover.get('content') == cover_image.get('id')
171. 
172. 
173. @pytest.mark.sphinx('epub', testroot='toctree')
174. def test_nested_toc(app):
175.     app.build()
176. 
177.     # toc.ncx
178.     toc = EPUBElementTree.fromstring((app.outdir / 'toc.ncx').read_bytes())
179.     assert toc.find("./ncx:docTitle/ncx:text").text == 'Python'
180. 
181.     # toc.ncx / navPoint
182.     def navinfo(elem):
183.         label = elem.find("./ncx:navLabel/ncx:text")
184.         content = elem.find("./ncx:content")
185.         return (elem.get('id'), elem.get('playOrder'),
186.                 content.get('src'), label.text)
187. 
188.     navpoints = toc.findall("./ncx:navMap/ncx:navPoint")
189.     assert len(navpoints) == 4
190.     assert navinfo(navpoints[0]) == ('navPoint1', '1', 'index.xhtml',
191.                                      "Welcome to Sphinx Tests’s documentation!")
192.     assert navpoints[0].findall("./ncx:navPoint") == []
193. 
194.     # toc.ncx / nested navPoints
195.     assert navinfo(navpoints[1]) == ('navPoint2', '2', 'foo.xhtml', 'foo')
196.     navchildren = navpoints[1].findall("./ncx:navPoint")
197.     assert len(navchildren) == 4
198.     assert navinfo(navchildren[0]) == ('navPoint3', '2', 'foo.xhtml', 'foo')
199.     assert navinfo(navchildren[1]) == ('navPoint4', '3', 'quux.xhtml', 'quux')
200.     assert navinfo(navchildren[2]) == ('navPoint5', '4', 'foo.xhtml#foo-1', 'foo.1')
201.     assert navinfo(navchildren[3]) == ('navPoint8', '6', 'foo.xhtml#foo-2', 'foo.2')
202. 
203.     # nav.xhtml / nav
204.     def navinfo(elem):
205.         anchor = elem.find("./xhtml:a")
206.         return (anchor.get('href'), anchor.text)
207. 
208.     nav = EPUBElementTree.fromstring((app.outdir / 'nav.xhtml').read_bytes())
209.     toc = nav.findall("./xhtml:body/xhtml:nav/xhtml:ol/xhtml:li")
210.     assert len(toc) == 4
211.     assert navinfo(toc[0]) == ('index.xhtml',
212.                                "Welcome to Sphinx Tests’s documentation!")
213.     assert toc[0].findall("./xhtml:ol") == []
214. 
215.     # nav.xhtml / nested toc
216.     assert navinfo(toc[1]) == ('foo.xhtml', 'foo')
217.     tocchildren = toc[1].findall("./xhtml:ol/xhtml:li")
218.     assert len(tocchildren) == 3
219.     assert navinfo(tocchildren[0]) == ('quux.xhtml', 'quux')
220.     assert navinfo(tocchildren[1]) == ('foo.xhtml#foo-1', 'foo.1')
221.     assert navinfo(tocchildren[2]) == ('foo.xhtml#foo-2', 'foo.2')
222. 
223.     grandchild = tocchildren[1].findall("./xhtml:ol/xhtml:li")
224.     assert len(grandchild) == 1
225.     assert navinfo(grandchild[0]) == ('foo.xhtml#foo-1-1', 'foo.1-1')
226. 
227. 
228. @pytest.mark.sphinx('epub', testroot='need-escaped')
229. def test_escaped_toc(app):
230.     app.build()
231. 
232.     # toc.ncx
233.     toc = EPUBElementTree.fromstring((app.outdir / 'toc.ncx').read_bytes())
234.     assert toc.find("./ncx:docTitle/ncx:text").text == 'need <b>"escaped"</b> project'
235. 
236.     # toc.ncx / navPoint
237.     def navinfo(elem):
238.         label = elem.find("./ncx:navLabel/ncx:text")
239.         content = elem.find("./ncx:content")
240.         return (elem.get('id'), elem.get('playOrder'),
241.                 content.get('src'), label.text)
242. 
243.     navpoints = toc.findall("./ncx:navMap/ncx:navPoint")
244.     assert len(navpoints) == 4
245.     assert navinfo(navpoints[0]) == ('navPoint1', '1', 'index.xhtml',
246.                                      "Welcome to Sphinx Tests's documentation!")
247.     assert navpoints[0].findall("./ncx:navPoint") == []
248. 
249.     # toc.ncx / nested navPoints
250.     assert navinfo(navpoints[1]) == ('navPoint2', '2', 'foo.xhtml', '<foo>')
251.     navchildren = navpoints[1].findall("./ncx:navPoint")
252.     assert len(navchildren) == 4
253.     assert navinfo(navchildren[0]) == ('navPoint3', '2', 'foo.xhtml', '<foo>')
254.     assert navinfo(navchildren[1]) == ('navPoint4', '3', 'quux.xhtml', 'quux')
255.     assert navinfo(navchildren[2]) == ('navPoint5', '4', 'foo.xhtml#foo-1', 'foo “1”')
256.     assert navinfo(navchildren[3]) == ('navPoint8', '6', 'foo.xhtml#foo-2', 'foo.2')
257. 
258.     # nav.xhtml / nav
259.     def navinfo(elem):
260.         anchor = elem.find("./xhtml:a")
261.         return (anchor.get('href'), anchor.text)
262. 
263.     nav = EPUBElementTree.fromstring((app.outdir / 'nav.xhtml').read_bytes())
264.     toc = nav.findall("./xhtml:body/xhtml:nav/xhtml:ol/xhtml:li")
265.     assert len(toc) == 4
266.     assert navinfo(toc[0]) == ('index.xhtml',
267.                                "Welcome to Sphinx Tests's documentation!")
268.     assert toc[0].findall("./xhtml:ol") == []
269. 
270.     # nav.xhtml / nested toc
271.     assert navinfo(toc[1]) == ('foo.xhtml', '<foo>')
272.     tocchildren = toc[1].findall("./xhtml:ol/xhtml:li")
273.     assert len(tocchildren) == 3
274.     assert navinfo(tocchildren[0]) == ('quux.xhtml', 'quux')
275.     assert navinfo(tocchildren[1]) == ('foo.xhtml#foo-1', 'foo “1”')
276.     assert navinfo(tocchildren[2]) == ('foo.xhtml#foo-2', 'foo.2')
277. 
278.     grandchild = tocchildren[1].findall("./xhtml:ol/xhtml:li")
279.     assert len(grandchild) == 1
280.     assert navinfo(grandchild[0]) == ('foo.xhtml#foo-1-1', 'foo.1-1')
281. 
282. 
283. @pytest.mark.sphinx('epub', testroot='basic')
284. def test_epub_writing_mode(app):
285.     # horizontal (default)
286.     app.build()
287. 
288.     # horizontal / page-progression-direction
289.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
290.     assert opf.find("./idpf:spine").get('page-progression-direction') == 'ltr'
291. 
292.     # horizontal / ibooks:scroll-axis
293.     metadata = opf.find("./idpf:metadata")
294.     assert metadata.find("./idpf:meta[@property='ibooks:scroll-axis']").text == 'vertical'
295. 
296.     # horizontal / writing-mode (CSS)
297.     css = (app.outdir / '_static' / 'epub.css').read_text()
298.     assert 'writing-mode: horizontal-tb;' in css
299. 
300.     # vertical
301.     app.config.epub_writing_mode = 'vertical'
302.     (app.outdir / 'index.xhtml').unlink()  # forcely rebuild
303.     app.build()
304. 
305.     # vertical / page-progression-direction
306.     opf = EPUBElementTree.fromstring((app.outdir / 'content.opf').read_text())
307.     assert opf.find("./idpf:spine").get('page-progression-direction') == 'rtl'
308. 
309.     # vertical / ibooks:scroll-axis
310.     metadata = opf.find("./idpf:metadata")
311.     assert metadata.find("./idpf:meta[@property='ibooks:scroll-axis']").text == 'horizontal'
312. 
313.     # vertical / writing-mode (CSS)
314.     css = (app.outdir / '_static' / 'epub.css').read_text()
315.     assert 'writing-mode: vertical-rl;' in css
316. 
317. 
318. @pytest.mark.sphinx('epub', testroot='epub-anchor-id')
319. def test_epub_anchor_id(app):
320.     app.build()
321. 
322.     html = (app.outdir / 'index.xhtml').read_text()
323.     assert ('<p id="std-setting-STATICFILES_FINDERS">'
324.             'blah blah blah</p>' in html)
325.     assert ('<span id="std-setting-STATICFILES_SECTION"></span>'
326.             '<h1>blah blah blah</h1>' in html)
327.     assert 'see <a class="reference internal" href="#std-setting-STATICFILES_FINDERS">' in html
328. 
329. 
330. @pytest.mark.sphinx('epub', testroot='html_assets')
331. def test_epub_assets(app):
332.     app.builder.build_all()
333. 
334.     # epub_sytlesheets (same as html_css_files)
335.     content = (app.outdir / 'index.xhtml').read_text()
336.     assert ('<link rel="stylesheet" type="text/css" href="_static/css/style.css" />'
337.             in content)
338.     assert ('<link media="print" rel="stylesheet" title="title" type="text/css" '
339.             'href="https://example.com/custom.css" />' in content)
340. 
341. 
342. @pytest.mark.sphinx('epub', testroot='html_assets',
343.                     confoverrides={'epub_css_files': ['css/epub.css']})
344. def test_epub_css_files(app):
345.     app.builder.build_all()
346. 
347.     # epub_css_files
348.     content = (app.outdir / 'index.xhtml').read_text()
349.     assert '<link rel="stylesheet" type="text/css" href="_static/css/epub.css" />' in content
350. 
351.     # files in html_css_files are not outputed
352.     assert ('<link rel="stylesheet" type="text/css" href="_static/css/style.css" />'
353.             not in content)
354.     assert ('<link media="print" rel="stylesheet" title="title" type="text/css" '
355.             'href="https://example.com/custom.css" />' not in content)
356. 
357. 
358. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
359.                     reason='docutils-0.13 or above is required')
360. @pytest.mark.sphinx('epub', testroot='roles-download')
361. def test_html_download_role(app, status, warning):
362.     app.build()
363.     assert not (app.outdir / '_downloads' / 'dummy.dat').exists()
364. 
365.     content = (app.outdir / 'index.xhtml').read_text()
366.     assert ('<li><p><code class="xref download docutils literal notranslate">'
367.             '<span class="pre">dummy.dat</span></code></p></li>' in content)
368.     assert ('<li><p><code class="xref download docutils literal notranslate">'
369.             '<span class="pre">not_found.dat</span></code></p></li>' in content)
370.     assert ('<li><p><code class="xref download docutils literal notranslate">'
371.             '<span class="pre">Sphinx</span> <span class="pre">logo</span></code>'
372.             '<span class="link-target"> [http://www.sphinx-doc.org/en/master'
373.             '/_static/sphinxheader.png]</span></p></li>' in content)
374. 
375. 
376. @pytest.mark.sphinx('epub', testroot='toctree-duplicated')
377. def test_duplicated_toctree_entry(app, status, warning):
378.     app.build()
379.     assert 'WARNING: duplicated ToC entry found: foo.xhtml' in warning.getvalue()
380. 
381. 
382. @pytest.mark.skipif('DO_EPUBCHECK' not in os.environ,
383.                     reason='Skipped because DO_EPUBCHECK is not set')
384. @pytest.mark.sphinx('epub')
385. def test_run_epubcheck(app):
386.     app.build()
387. 
388.     epubcheck = os.environ.get('EPUBCHECK_PATH', '/usr/share/java/epubcheck.jar')
389.     if runnable(['java', '-version']) and os.path.exists(epubcheck):
390.         try:
391.             subprocess.run(['java', '-jar', epubcheck, app.outdir / 'SphinxTests.epub'],
392.                            stdout=PIPE, stderr=PIPE, check=True)
393.         except CalledProcessError as exc:
394.             print(exc.stdout.decode('utf-8'))
395.             print(exc.stderr.decode('utf-8'))
396.             assert False, 'epubcheck exited with return code %s' % exc.returncode


File: tests/test_ext_viewcode.py
Line number range: 1 - 104
Content:
1. """
2.     test_ext_viewcode
3.     ~~~~~~~~~~~~~~~~~
4. 
5.     Test sphinx.ext.viewcode extension.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import re
12. 
13. import pytest
14. 
15. 
16. @pytest.mark.sphinx(testroot='ext-viewcode')
17. def test_viewcode(app, status, warning):
18.     app.builder.build_all()
19. 
20.     warnings = re.sub(r'\\+', '/', warning.getvalue())
21.     assert re.findall(
22.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
23.         r"file .*/spam/__init__.py'",
24.         warnings
25.     )
26. 
27.     result = (app.outdir / 'index.html').read_text()
28.     assert result.count('href="_modules/spam/mod1.html#func1"') == 2
29.     assert result.count('href="_modules/spam/mod2.html#func2"') == 2
30.     assert result.count('href="_modules/spam/mod1.html#Class1"') == 2
31.     assert result.count('href="_modules/spam/mod2.html#Class2"') == 2
32.     assert result.count('@decorator') == 1
33. 
34.     # test that the class attribute is correctly documented
35.     assert result.count('this is Class3') == 2
36.     assert 'this is the class attribute class_attr' in result
37.     # the next assert fails, until the autodoc bug gets fixed
38.     assert result.count('this is the class attribute class_attr') == 2
39. 
40.     result = (app.outdir / '_modules/spam/mod1.html').read_text()
41.     result = re.sub('<span class=".*?">', '<span>', result)  # filter pygments classes
42.     assert ('<div class="viewcode-block" id="Class1"><a class="viewcode-back" '
43.             'href="../../index.html#spam.Class1">[docs]</a>'
44.             '<span>@decorator</span>\n'
45.             '<span>class</span> <span>Class1</span>'
46.             '<span>(</span><span>object</span><span>):</span>\n'
47.             '    <span>&quot;&quot;&quot;</span>\n'
48.             '<span>    this is Class1</span>\n'
49.             '<span>    &quot;&quot;&quot;</span></div>\n') in result
50. 
51. 
52. @pytest.mark.sphinx(testroot='ext-viewcode', tags=['test_linkcode'])
53. def test_linkcode(app, status, warning):
54.     app.builder.build(['objects'])
55. 
56.     stuff = (app.outdir / 'objects.html').read_text()
57. 
58.     assert 'http://foobar/source/foolib.py' in stuff
59.     assert 'http://foobar/js/' in stuff
60.     assert 'http://foobar/c/' in stuff
61.     assert 'http://foobar/cpp/' in stuff
62. 
63. 
64. @pytest.mark.sphinx(testroot='ext-viewcode-find')
65. def test_local_source_files(app, status, warning):
66.     def find_source(app, modname):
67.         if modname == 'not_a_package':
68.             source = (app.srcdir / 'not_a_package/__init__.py').read_text()
69.             tags = {
70.                 'func1': ('def', 1, 1),
71.                 'Class1': ('class', 1, 1),
72.                 'not_a_package.submodule.func1': ('def', 1, 1),
73.                 'not_a_package.submodule.Class1': ('class', 1, 1),
74.             }
75.         else:
76.             source = (app.srcdir / 'not_a_package/submodule.py').read_text()
77.             tags = {
78.                 'not_a_package.submodule.func1': ('def', 11, 15),
79.                 'Class1': ('class', 19, 22),
80.                 'not_a_package.submodule.Class1': ('class', 19, 22),
81.                 'Class3': ('class', 25, 30),
82.                 'not_a_package.submodule.Class3.class_attr': ('other', 29, 29),
83.             }
84.         return (source, tags)
85. 
86.     app.connect('viewcode-find-source', find_source)
87.     app.builder.build_all()
88. 
89.     warnings = re.sub(r'\\+', '/', warning.getvalue())
90.     assert re.findall(
91.         r"index.rst:\d+: WARNING: Object named 'func1' not found in include " +
92.         r"file .*/not_a_package/__init__.py'",
93.         warnings
94.     )
95. 
96.     result = (app.outdir / 'index.html').read_text()
97.     assert result.count('href="_modules/not_a_package.html#func1"') == 1
98.     assert result.count('href="_modules/not_a_package.html#not_a_package.submodule.func1"') == 1
99.     assert result.count('href="_modules/not_a_package/submodule.html#Class1"') == 1
100.     assert result.count('href="_modules/not_a_package/submodule.html#Class3"') == 1
101.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class1"') == 1
102. 
103.     assert result.count('href="_modules/not_a_package/submodule.html#not_a_package.submodule.Class3.class_attr"') == 1
104.     assert result.count('This is the class attribute class_attr') == 1

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 01:09:40,179 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find three existing test cases that are relevant to a bug concerning the `viewcode` extension and the `epub` builder. The bug is that `viewcode` generates pages for epub even when `viewcode_enable_epub` is false. The provided context from `tests/test_ext_viewcode.py` and `tests/test_build_epub.py` is insufficient. The former lacks tests for the epub builder, and the latter doesn't test `viewcode` integration. To find analogous tests that check for conditional output based on configuration flags and builder types, I need to examine tests for other extensions that have similar configurable behavior. `sphinx.ext.todo` (with its `todo_include_todos` config) and `sphinx.ext.ifconfig` are strong candidates for finding such test patterns." query='Please provide the full content of `tests/test_ext_todo.py` and `tests/test_ext_ifconfig.py`.' extra_requirements='' purpose="I need to find test cases demonstrating conditional output based on configuration flags to find relevant examples for the user's request, and the current context is insufficient."
2025-12-21 01:09:40,180 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/test_ext_todo.py` and `tests/test_ext_ifconfig.py`.
2025-12-21 01:09:40,180 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 01:09:40,181 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 01:09:40,182 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 01:09:40,182 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/test_ext_todo.py` and `tests/test_ext_ifconfig.py`.
Purpose: I need to find test cases demonstrating conditional output based on configuration flags to find relevant examples for the user's request, and the current context is insufficient.
2025-12-21 01:09:43,211 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the two test files you requested and will now read their contents to identify relevant examples of conditional output. This will help me find test cases that demonstrate how to use configuration flags to control output.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/test_ext_ifconfig.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2097, 'candidates_token_count': 88, 'total_token_count': 2361, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2097}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 88}], 'thoughts_token_count': 176, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.20219100605357776, 'model_name': 'gemini-2.5-pro'} id='run--3abd0f54-9f66-4afd-8c2a-19e0267925f5-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_ext_todo.py'}, 'id': '7f82619b-df62-493c-beee-d410955757eb', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/test_ext_ifconfig.py'}, 'id': '1d9e9bd7-61f3-4fd3-aaec-bbd96d47c330', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2097, 'output_tokens': 88, 'total_tokens': 2361, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 176}}
2025-12-21 01:09:47,250 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of `tests/test_ext_todo.py` and `tests/test_ext_ifconfig.py` to find examples of conditional output based on configuration flags. The `test_ext_todo.py` file contains tests that show how the `todo_include_todos` configuration affects the output, which is a great example of what you are looking for. Similarly, `test_ext_ifconfig.py` provides a concise test demonstrating content being included or excluded based on a flag.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4312, 'candidates_token_count': 109, 'total_token_count': 4701, 'cached_content_token_count': 1653, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4312}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1653}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 109}], 'thoughts_token_count': 280}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2133909452945814, 'model_name': 'gemini-2.5-pro'} id='run--f8dd485c-ca51-4226-9239-aab66b96fc45-0' usage_metadata={'input_tokens': 4312, 'output_tokens': 109, 'total_tokens': 4701, 'input_token_details': {'cache_read': 1653}, 'output_token_details': {'reasoning': 280}}
2025-12-21 01:09:47,252 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/test_ext_todo.py` and `tests/test_ext_ifconfig.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to find test cases demonstrating conditional output based on configuration flags to find relevant examples for the user's request, and the current context is insufficient.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/test_ext_ifconfig.py
Line number range: 1 - 19
Content:
1. """
2.     test_ext_ifconfig
3.     ~~~~~~~~~~~~~~~~~
4. 
5.     Test sphinx.ext.ifconfig extension.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import pytest
12. 
13. 
14. @pytest.mark.sphinx('text', testroot='ext-ifconfig')
15. def test_ifconfig(app, status, warning):
16.     app.builder.build_all()
17.     result = (app.outdir / 'index.txt').read_text()
18.     assert 'spam' in result
19.     assert 'ham' not in result


File: tests/test_ext_todo.py
Line number range: 1 - 121
Content:
1. """
2.     test_ext_todo
3.     ~~~~~~~~~~~~~
4. 
5.     Test sphinx.ext.todo extension.
6. 
7.     :copyright: Copyright 2007-2021 by the Sphinx team, see AUTHORS.
8.     :license: BSD, see LICENSE for details.
9. """
10. 
11. import re
12. 
13. import pytest
14. 
15. from sphinx.util import docutils
16. 
17. 
18. @pytest.mark.skipif(docutils.__version_info__ < (0, 13),
19.                     reason='docutils-0.13 or above is required')
20. @pytest.mark.sphinx('html', testroot='ext-todo', freshenv=True,
21.                     confoverrides={'todo_include_todos': True, 'todo_emit_warnings': True})
22. def test_todo(app, status, warning):
23.     todos = []
24. 
25.     def on_todo_defined(app, node):
26.         todos.append(node)
27. 
28.     app.connect('todo-defined', on_todo_defined)
29.     app.builder.build_all()
30. 
31.     # check todolist
32.     content = (app.outdir / 'index.html').read_text()
33.     assert ('<p class="admonition-title">Todo</p>\n'
34.             '<p>todo in foo</p>') in content
35. 
36.     assert ('<p class="admonition-title">Todo</p>\n'
37.             '<p>todo in bar</p>') in content
38. 
39.     # check todo
40.     content = (app.outdir / 'foo.html').read_text()
41.     assert ('<p class="admonition-title">Todo</p>\n'
42.             '<p>todo in foo</p>') in content
43. 
44.     assert ('<p class="admonition-title">Todo</p>\n'
45.             '<p>todo in param field</p>') in content
46. 
47.     # check emitted warnings
48.     assert 'WARNING: TODO entry found: todo in foo' in warning.getvalue()
49.     assert 'WARNING: TODO entry found: todo in bar' in warning.getvalue()
50. 
51.     # check handled event
52.     assert len(todos) == 3
53.     assert {todo[1].astext() for todo in todos} == {'todo in foo',
54.                                                     'todo in bar',
55.                                                     'todo in param field'}
56. 
57. 
58. @pytest.mark.sphinx('html', testroot='ext-todo', freshenv=True,
59.                     confoverrides={'todo_include_todos': False, 'todo_emit_warnings': True})
60. def test_todo_not_included(app, status, warning):
61.     todos = []
62. 
63.     def on_todo_defined(app, node):
64.         todos.append(node)
65. 
66.     app.connect('todo-defined', on_todo_defined)
67.     app.builder.build_all()
68. 
69.     # check todolist
70.     content = (app.outdir / 'index.html').read_text()
71.     assert ('<p class="admonition-title">Todo</p>\n'
72.             '<p>todo in foo</p>') not in content
73. 
74.     assert ('<p class="admonition-title">Todo</p>\n'
75.             '<p>todo in bar</p>') not in content
76. 
77.     # check todo
78.     content = (app.outdir / 'foo.html').read_text()
79.     assert ('<p class="admonition-title">Todo</p>\n'
80.             '<p>todo in foo</p>') not in content
81. 
82.     # check emitted warnings
83.     assert 'WARNING: TODO entry found: todo in foo' in warning.getvalue()
84.     assert 'WARNING: TODO entry found: todo in bar' in warning.getvalue()
85. 
86.     # check handled event
87.     assert len(todos) == 3
88.     assert {todo[1].astext() for todo in todos} == {'todo in foo',
89.                                                     'todo in bar',
90.                                                     'todo in param field'}
91. 
92. 
93. @pytest.mark.sphinx('latex', testroot='ext-todo', freshenv=True,
94.                     confoverrides={'todo_include_todos': True})
95. def test_todo_valid_link(app, status, warning):
96.     """
97.     Test that the inserted "original entry" links for todo items have a target
98.     that exists in the LaTeX output. The target was previously incorrectly
99.     omitted (GitHub issue #1020).
100.     """
101. 
102.     # Ensure the LaTeX output is built.
103.     app.builder.build_all()
104. 
105.     content = (app.outdir / 'python.tex').read_text()
106. 
107.     # Look for the link to foo. Note that there are two of them because the
108.     # source document uses todolist twice. We could equally well look for links
109.     # to bar.
110.     link = (r'{\\hyperref\[\\detokenize{(.*?foo.*?)}]{\\sphinxcrossref{'
111.             r'\\sphinxstyleemphasis{original entry}}}}')
112.     m = re.findall(link, content)
113.     assert len(m) == 4
114.     target = m[0]
115. 
116.     # Look for the targets of this link.
117.     labels = re.findall(r'\\label{\\detokenize{([^}]*)}}', content)
118.     matched = [l for l in labels if l == target]
119. 
120.     # If everything is correct we should have exactly one target.
121.     assert len(matched) == 1

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 01:09:52,893 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of the file `tests/test_ext_ifconfig.py`. The provided context contains the entire file.', relative_path='tests/test_ext_ifconfig.py', start_line=1, end_line=19), ContextOutput(reasoning='The user requested the full content of the file `tests/test_ext_todo.py`. The provided context contains the entire file.', relative_path='tests/test_ext_todo.py', start_line=1, end_line=121)]
2025-12-21 01:09:52,894 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `tests/test_ext_todo.py` and `tests/test_ext_ifconfig.py`.
2025-12-21 01:09:52,895 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 01:09:52,895 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 01:09:52,895 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 2 existing contexts
2025-12-21 01:09:52,895 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 4 total contexts (removed 0 duplicates)
2025-12-21 01:09:52,896 - thread-131294979688128.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-21 01:09:52,896 - thread-131294979688128.prometheus_context_collector - INFO - Successfully retrieved 4 context snippets
