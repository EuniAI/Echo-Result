2025-12-24 17:12:04,824 - thread-128178285696704.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: makemigrations router.allow_migrate() calls for consistency checks use incorrect (app_label, model) pairs

Description: Description
	
As reported in ticket:27200#comment:14, I makemigrations incorrectly calls allow_migrate() for each app with all the models in the project rather than for each app with the app's models. It broke the router I use because it was passing invalid combinations for shards since not all shards have the same models.
[​​https://github.com/django/django/pull/7530 PR]

Patch information:
diff --git a/django/core/management/commands/makemigrations.py b/django/core/management/commands/makemigrations.py
index 0b39536f5b..e648880ef0 100644
--- a/django/core/management/commands/makemigrations.py
+++ b/django/core/management/commands/makemigrations.py
@@ -105,7 +105,7 @@ class Command(BaseCommand):
                     # At least one model must be migrated to the database.
                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
                     for app_label in consistency_check_labels
-                    for model in apps.get_models(app_label)
+                    for model in apps.get_app_config(app_label).get_models()
             )):
                 loader.check_consistent_history(connection)
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-24 17:12:04,913 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_static.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── registration
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   └── utils.py
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── libgeoip.py
|   |   |   |   └── prototypes.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backend
|   |   |   |   └── regex.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   ├── srs.py
|   |   |   |   └── wkt.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── locale
|   |   |   |   ├── ar
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── he
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── id
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── signals.py
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── staticfiles.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   ├── __init__.py
|   |   |   |   ├── django_1_10.py
|   |   |   |   └── django_1_8_0.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── urls.py
|   |   |   └── utils.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── urlresolvers.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── version.py
|   |   |   ├── postgresql_psycopg2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── version.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   └── special.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── topological_sort.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── datetime.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   ├── license.txt
|   |   └── weakref_backports.py
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── extras
|   |   |   ├── __init__.py
|   |   |   └── widgets.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── models.py
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── eggs.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── glob.py
|   |   ├── html.py
|   |   ├── html_parser.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── lru_cache.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── six.py
|   |   ├── synch.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       └── static.py
├── docs
|   ├── _ext
|   |   ├── cve_role.py
|   |   ├── djangodocs.py
|   |   └── ticket_role.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   ├── roles.txt
|   |   ├── security.txt
|   |   └── team.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   ├── language.txt
|   |   |   └── upgrading.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── python3.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   ├── jsi18n-mocks.test.js
|   |   └── timeparse.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── blanket.js
|   |   ├── grunt-reporter.js
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_adminsite.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   └── with_integer_username.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_auth_backends_deprecation.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_deprecated_views.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   ├── urls_custom_user_admin.py
    |   └── urls_deprecated.py
    ├── backends
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_creation.py
    |   ├── test_features.py
    |   ├── test_mysql.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   ├── tests_1_10_compatibility.py
    |   ├── tests_1_8_compatibility.py
    |   └── urls
    |       ├── __init__.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       └── warning_in_include.py
    ├── choices
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_models.py
    |   ├── test_order_with_respect_to.py
    |   ├── tests.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── test_context_processor.py
    |   └── tests.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_cast.py
    |   ├── test_datetime.py
    |   └── tests.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   └── test_postgresql_psycopg2.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       └── article_form.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_geoforms.py
    |   ├── test_geoip.py
    |   ├── test_geoip2.py
    |   ├── test_measure.py
    |   ├── test_spatialrefsys.py
    |   ├── test_wkt.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── test_legacy.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_permalink
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_array.py
    |   ├── test_citext.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_json.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── base.txt
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   ├── py2.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   └── urls
    |       ├── __init__.py
    |       ├── http.py
    |       └── https.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_i18n.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   └── testtags.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── test_unicode.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   └── password_change_form.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_discovery_sample
    |   ├── __init__.py
    |   ├── doctests.py
    |   ├── empty.py
    |   ├── pattern_tests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tests_sample.py
    ├── test_discovery_sample2
    |   ├── __init__.py
    |   └── tests.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── tests.py
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_full_import.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── leave_locale_alone_false.py
    |   |       ├── leave_locale_alone_true.py
    |   |       ├── reverse_url.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── locale
    |   |   └── nl
    |   |       └── LC_MESSAGES
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_deprecation.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_glob.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_itercompat.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   └── test_tree.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── file.txt
    |   |   └── long-line.txt
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   ├── debug
    |   |   |   └── template_exception.html
    |   |   ├── jsi18n-multi-catalogs.html
    |   |   ├── jsi18n.html
    |   |   ├── old_jsi18n-multi-catalogs.html
    |   |   └── old_jsi18n.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── py3_test_debug.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_i18n_deprecated.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: makemigrations router.allow_migrate() calls for consistency checks use incorrect (app_label, model) pairs

Description: Description
	
As reported in ticket:27200#comment:14, I makemigrations incorrectly calls allow_migrate() for each app with all the models in the project rather than for each app with the app's models. It broke the router I use because it was passing invalid combinations for shards since not all shards have the same models.
[​​https://github.com/django/django/pull/7530 PR]

Patch information:
diff --git a/django/core/management/commands/makemigrations.py b/django/core/management/commands/makemigrations.py
index 0b39536f5b..e648880ef0 100644
--- a/django/core/management/commands/makemigrations.py
+++ b/django/core/management/commands/makemigrations.py
@@ -105,7 +105,7 @@ class Command(BaseCommand):
                     # At least one model must be migrated to the database.
                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
                     for app_label in consistency_check_labels
-                    for model in apps.get_models(app_label)
+                    for model in apps.get_app_config(app_label).get_models()
             )):
                 loader.check_consistent_history(connection)
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 17:12:25,604 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to a bug in the `makemigrations` command that involves database routers. To do this, I need to examine the tests for `makemigrations` and any related multi-database or router-specific tests. The current context is empty, so I need to retrieve the relevant test files.' query='Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.' extra_requirements='' purpose='These files are essential to understand the `makemigrations` command and find existing tests that cover scenarios with database routers and multiple applications, which is where the bug occurs.'
2025-12-24 17:12:25,606 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.
2025-12-24 17:12:25,606 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 17:12:25,607 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 17:12:25,607 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 17:12:25,607 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.
Purpose: These files are essential to understand the `makemigrations` command and find existing tests that cover scenarios with database routers and multiple applications, which is where the bug occurs.
2025-12-24 17:12:30,685 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py` to understand the `makemigrations` command and its existing tests. This will help in identifying the code relevant to the reported bug. The content of these files provides the necessary context for further investigation.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/test_multidb.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2134, 'candidates_token_count': 165, 'total_token_count': 2593, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2134}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 165}], 'thoughts_token_count': 294, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11178622390284683, 'model_name': 'gemini-2.5-pro'} id='run--09ed5907-a52a-4de0-a443-3f0bd8d33038-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/core/management/commands/makemigrations.py'}, 'id': 'aeca204e-dc9e-4a05-bb94-8e9484ac1a0e', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_commands.py'}, 'id': '22348e1f-974f-4c19-ab98-026f25573b66', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_multidb.py'}, 'id': 'bf5e8f34-11b8-4af0-966c-a7a8f0c67bec', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2134, 'output_tokens': 165, 'total_tokens': 2593, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 294}}
2025-12-24 17:12:36,738 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now reviewed the contents of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`. This has given me a foundational understanding of the `makemigrations` command and how existing tests handle multi-database scenarios. I will now investigate how the `allow_migrate` method is used within the `makemigrations` command to better understand its behavior with database routers.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "allow_migrate", "relative_path": "django/core/management/commands/makemigrations.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18537, 'candidates_token_count': 146, 'total_token_count': 19027, 'cached_content_token_count': 1889, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18537}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1889}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 146}], 'thoughts_token_count': 344}, 'finish_reason': 'STOP', 'avg_logprobs': -0.28118737103187874, 'model_name': 'gemini-2.5-pro'} id='run--b9d46f3c-eb6c-463b-9e64-a468f3c20d22-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'allow_migrate', 'relative_path': 'django/core/management/commands/makemigrations.py'}, 'id': '940429d7-c05e-4efa-8cea-783b3a79c9be', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18537, 'output_tokens': 146, 'total_tokens': 19027, 'input_token_details': {'cache_read': 1889}, 'output_token_details': {'reasoning': 344}}
2025-12-24 17:12:42,321 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the `allow_migrate` call within the `makemigrations` command, which confirms it is used to check for consistent migration history across databases. My analysis suggests the root of the bug may not be in the command itself, but rather in how the `MigrationAutodetector` utilizes the `allow_migrate` method. I will now investigate the `autodetector.py` file to determine how it handles database routing.' additional_kwargs={'function_call': {'name': 'find_file_node_with_basename', 'arguments': '{"basename": "autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22376, 'candidates_token_count': 106, 'total_token_count': 22797, 'cached_content_token_count': 17104, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22376}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17104}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 106}], 'thoughts_token_count': 315}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5354644127611844, 'model_name': 'gemini-2.5-pro'} id='run--033fa875-b973-4733-b4a4-e86e2c7102f7-0' tool_calls=[{'name': 'find_file_node_with_basename', 'args': {'basename': 'autodetector.py'}, 'id': 'f350c6df-9524-4a2f-90fc-bd38a2f36b29', 'type': 'tool_call'}] usage_metadata={'input_tokens': 22376, 'output_tokens': 106, 'total_tokens': 22797, 'input_token_details': {'cache_read': 17104}, 'output_token_details': {'reasoning': 315}}
2025-12-24 17:12:45,632 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have found the `autodetector.py` file and will now read its contents. This will help me understand how it uses the `allow_migrate` method and interacts with database routers. My goal is to determine if the bug originates from this part of the code.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/migrations/autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22541, 'candidates_token_count': 81, 'total_token_count': 22660, 'cached_content_token_count': 20883, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22541}], 'cache_tokens_details': [{'modality': 1, 'token_count': 20883}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 81}], 'thoughts_token_count': 38}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09519114906405225, 'model_name': 'gemini-2.5-pro'} id='run--1fa61101-1e16-4a23-9bf9-6ef4ed1a7831-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/migrations/autodetector.py'}, 'id': 'd2924db1-cca1-4cac-9a75-fd7ec2b4a289', 'type': 'tool_call'}] usage_metadata={'input_tokens': 22541, 'output_tokens': 81, 'total_tokens': 22660, 'input_token_details': {'cache_read': 20883}, 'output_token_details': {'reasoning': 38}}
2025-12-24 17:14:18,882 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now analyzed the `autodetector.py` file and can see how it generates migration operations. The `_detect_changes` method orchestrates this process by calling various `generate_*` methods, but I have not yet found where the `allow_migrate` method is used. I will now search for direct calls to `allow_migrate` within this file to pinpoint how database routing affects the change detection process.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "allow_migrate", "relative_path": "django/db/migrations/autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 24014, 'end_index': 24294, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 24217, 'end_index': 24835, 'uri': 'https://code.djangoproject.com/ticket/27054?cversion=1&cnum_hist=6', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 30712, 'candidates_token_count': 124, 'total_token_count': 38984, 'cached_content_token_count': 21137, 'prompt_tokens_details': [{'modality': 1, 'token_count': 30712}], 'cache_tokens_details': [{'modality': 1, 'token_count': 21137}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 124}], 'thoughts_token_count': 8148}, 'finish_reason': 'STOP', 'avg_logprobs': -7.0439152871408774, 'model_name': 'gemini-2.5-pro'} id='run--e9db05aa-0ca4-4329-824a-fbab8707bb23-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'allow_migrate', 'relative_path': 'django/db/migrations/autodetector.py'}, 'id': 'c515df8f-064d-441e-ade0-2bca3505877e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 30712, 'output_tokens': 124, 'total_tokens': 38984, 'input_token_details': {'cache_read': 21137}, 'output_token_details': {'reasoning': 8148}}
2025-12-24 17:14:33,866 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='My search for `allow_migrate` within `autodetector.py` yielded no results, which suggests the filtering logic is not located where I initially expected. The `MigrationAutodetector` is likely receiving a pre-filtered set of models to analyze. I will now examine the `ProjectState.from_apps` method, as it is responsible for building the project state that the autodetector uses for comparison. This will help me determine if the models are being filtered based on the target database before the detection process begins.' additional_kwargs={'function_call': {'name': 'find_file_node_with_basename', 'arguments': '{"basename": "state.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1838, 'end_index': 2160, 'uri': 'https://groups.google.com/g/django-updates/c/xIZfi8UYkRw', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 30868, 'candidates_token_count': 121, 'total_token_count': 32183, 'cached_content_token_count': 28801, 'prompt_tokens_details': [{'modality': 1, 'token_count': 30868}], 'cache_tokens_details': [{'modality': 1, 'token_count': 28801}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 121}], 'thoughts_token_count': 1194}, 'finish_reason': 'STOP', 'avg_logprobs': -1.3325322679251679, 'model_name': 'gemini-2.5-pro'} id='run--22cf76b1-e174-4f06-a078-608ba7297943-0' tool_calls=[{'name': 'find_file_node_with_basename', 'args': {'basename': 'state.py'}, 'id': 'cdb13106-b40d-4024-ad59-6554d9374b59', 'type': 'tool_call'}] usage_metadata={'input_tokens': 30868, 'output_tokens': 121, 'total_tokens': 32183, 'input_token_details': {'cache_read': 28801}, 'output_token_details': {'reasoning': 1194}}
2025-12-24 17:14:35,874 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the `state.py` file and will now read its contents to understand how the `ProjectState` is constructed. My goal is to determine if the `allow_migrate` method is used to filter models when the project state is being built. This will help me understand why certain models are not being included in the generated migrations.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/migrations/state.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 31044, 'candidates_token_count': 93, 'total_token_count': 31137, 'cached_content_token_count': 30697, 'prompt_tokens_details': [{'modality': 1, 'token_count': 31044}], 'cache_tokens_details': [{'modality': 1, 'token_count': 30697}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 93}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11823014290102067, 'model_name': 'gemini-2.5-pro'} id='run--af6f2842-fdf0-4d54-abba-beac67f0fb17-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/migrations/state.py'}, 'id': 'e3d22133-d689-4118-9dd1-805a59ba9820', 'type': 'tool_call'}] usage_metadata={'input_tokens': 31044, 'output_tokens': 93, 'total_tokens': 31137, 'input_token_details': {'cache_read': 30697}}
2025-12-24 17:14:42,320 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='After reviewing `django/db/migrations/state.py`, I found that the `ProjectState` is created from an existing `Apps` registry and does not perform any filtering itself. This suggests that the models are filtered before the `ProjectState` is even created. I will now re-examine the `handle` method in `django/core/management/commands/makemigrations.py` to trace how the `apps` object is populated and passed to `ProjectState.from_apps`.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/core/management/commands/makemigrations.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 38777, 'candidates_token_count': 132, 'total_token_count': 39269, 'cached_content_token_count': 30927, 'prompt_tokens_details': [{'modality': 1, 'token_count': 38777}], 'cache_tokens_details': [{'modality': 1, 'token_count': 30927}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 132}], 'thoughts_token_count': 360}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3882832093672319, 'model_name': 'gemini-2.5-pro'} id='run--efb69649-2383-4cb3-a504-59dd110843f8-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/core/management/commands/makemigrations.py'}, 'id': 'b81e3cdd-9f14-48e1-8afa-59dcb65d8b13', 'type': 'tool_call'}] usage_metadata={'input_tokens': 38777, 'output_tokens': 132, 'total_tokens': 39269, 'input_token_details': {'cache_read': 30927}, 'output_token_details': {'reasoning': 360}}
2025-12-24 17:14:48,951 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have re-examined the `handle` method in `makemigrations.py` and confirmed that `ProjectState.from_apps(apps)` is used to build the project state. The `autodetector.changes` method is then called with the `trim_to_apps` argument, which contains the app labels specified by the user. This indicates that the filtering logic is located within the `_trim_to_apps` method in `autodetector.py`. I will now investigate that method to understand how it filters the changes.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "_trim_to_apps", "relative_path": "django/db/migrations/autodetector.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 43984, 'candidates_token_count': 154, 'total_token_count': 44353, 'cached_content_token_count': 31013, 'prompt_tokens_details': [{'modality': 1, 'token_count': 43984}], 'cache_tokens_details': [{'modality': 1, 'token_count': 31013}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 154}], 'thoughts_token_count': 215}, 'finish_reason': 'STOP', 'avg_logprobs': -0.24931657469117796, 'model_name': 'gemini-2.5-pro'} id='run--74e1ca9c-d536-405d-a49e-df220907770c-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': '_trim_to_apps', 'relative_path': 'django/db/migrations/autodetector.py'}, 'id': '33fbbf5e-b0d7-44ba-ae7d-54e672b11fcb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 43984, 'output_tokens': 154, 'total_tokens': 44353, 'input_token_details': {'cache_read': 31013}, 'output_token_details': {'reasoning': 215}}
2025-12-24 17:15:15,114 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='After a thorough review of the codebase, I have identified the source of the issue. The `makemigrations` command generates a list of all model changes across the entire project before filtering them based on the specified app labels. This filtering occurs in the `_trim_to_apps` method within `django/db/migrations/autodetector.py`, which only considers application dependencies and does not account for database routing configurations. As a result, the `allow_migrate` method is not being used to filter models before the change detection process, which is why migrations are being generated for applications that should be excluded by a database router.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2400, 'end_index': 2648, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BeOpen', 'title': ''}, {'start_index': 2579, 'end_index': 3133, 'uri': 'https://code.djangoproject.com/ticket/27054?cversion=1&cnum_hist=6', 'title': '', 'license_': ''}, {'start_index': 3224, 'end_index': 3548, 'uri': 'https://velog.io/@lullu/Django-migration-%EC%83%9D%EC%84%B1-%EC%9B%90%EB%A6%AC-commands', 'title': '', 'license_': ''}, {'start_index': 4381, 'end_index': 4808, 'uri': 'https://www.dzeta.jp/~junjis/code_reading/index.php?Django%2Fmakemigrations%E6%99%82%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%AA%AD%E3%82%80', 'title': '', 'license_': ''}, {'start_index': 4618, 'end_index': 5270, 'uri': 'https://gemfury.com/hemamaps/python:Django/1.9.8/content/db/migrations/autodetector.py', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 59273, 'candidates_token_count': 130, 'total_token_count': 61803, 'cached_content_token_count': 42924, 'prompt_tokens_details': [{'modality': 1, 'token_count': 59273}], 'cache_tokens_details': [{'modality': 1, 'token_count': 42924}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 130}], 'thoughts_token_count': 2400}, 'finish_reason': 'STOP', 'avg_logprobs': -2.336421086237981, 'model_name': 'gemini-2.5-pro'} id='run--b14d3adf-e295-48fc-89a3-228856762e86-0' usage_metadata={'input_tokens': 59273, 'output_tokens': 130, 'total_tokens': 61803, 'input_token_details': {'cache_read': 42924}, 'output_token_details': {'reasoning': 2400}}
2025-12-24 17:15:15,116 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
These files are essential to understand the `makemigrations` command and find existing tests that cover scenarios with database routers and multiple applications, which is where the bug occurs.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: django/core/management/commands/makemigrations.py
Line number range: 1 - 322
Content:
1. import io
2. import os
3. import sys
4. import warnings
5. from itertools import takewhile
6. 
7. from django.apps import apps
8. from django.conf import settings
9. from django.core.management.base import BaseCommand, CommandError
10. from django.db import DEFAULT_DB_ALIAS, connections, router
11. from django.db.migrations import Migration
12. from django.db.migrations.autodetector import MigrationAutodetector
13. from django.db.migrations.loader import MigrationLoader
14. from django.db.migrations.questioner import (
15.     InteractiveMigrationQuestioner, MigrationQuestioner,
16.     NonInteractiveMigrationQuestioner,
17. )
18. from django.db.migrations.state import ProjectState
19. from django.db.migrations.utils import get_migration_name_timestamp
20. from django.db.migrations.writer import MigrationWriter
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.six import iteritems
23. from django.utils.six.moves import zip
24. 
25. 
26. class Command(BaseCommand):
27.     help = "Creates new migration(s) for apps."
28. 
29.     def add_arguments(self, parser):
30.         parser.add_argument(
31.             'args', metavar='app_label', nargs='*',
32.             help='Specify the app label(s) to create migrations for.',
33.         )
34.         parser.add_argument(
35.             '--dry-run', action='store_true', dest='dry_run', default=False,
36.             help="Just show what migrations would be made; don't actually write them.",
37.         )
38.         parser.add_argument(
39.             '--merge', action='store_true', dest='merge', default=False,
40.             help="Enable fixing of migration conflicts.",
41.         )
42.         parser.add_argument(
43.             '--empty', action='store_true', dest='empty', default=False,
44.             help="Create an empty migration.",
45.         )
46.         parser.add_argument(
47.             '--noinput', '--no-input',
48.             action='store_false', dest='interactive', default=True,
49.             help='Tells Django to NOT prompt the user for input of any kind.',
50.         )
51.         parser.add_argument(
52.             '-n', '--name', action='store', dest='name', default=None,
53.             help="Use this name for migration file(s).",
54.         )
55.         parser.add_argument(
56.             '-e', '--exit', action='store_true', dest='exit_code', default=False,
57.             help='Exit with error code 1 if no changes needing migrations are found. '
58.                  'Deprecated, use the --check option instead.',
59.         )
60.         parser.add_argument(
61.             '--check', action='store_true', dest='check_changes',
62.             help='Exit with a non-zero status if model changes are missing migrations.',
63.         )
64. 
65.     def handle(self, *app_labels, **options):
66.         self.verbosity = options['verbosity']
67.         self.interactive = options['interactive']
68.         self.dry_run = options['dry_run']
69.         self.merge = options['merge']
70.         self.empty = options['empty']
71.         self.migration_name = options['name']
72.         self.exit_code = options['exit_code']
73.         check_changes = options['check_changes']
74. 
75.         if self.exit_code:
76.             warnings.warn(
77.                 "The --exit option is deprecated in favor of the --check option.",
78.                 RemovedInDjango20Warning
79.             )
80. 
81.         # Make sure the app they asked for exists
82.         app_labels = set(app_labels)
83.         bad_app_labels = set()
84.         for app_label in app_labels:
85.             try:
86.                 apps.get_app_config(app_label)
87.             except LookupError:
88.                 bad_app_labels.add(app_label)
89.         if bad_app_labels:
90.             for app_label in bad_app_labels:
91.                 self.stderr.write("App '%s' could not be found. Is it in INSTALLED_APPS?" % app_label)
92.             sys.exit(2)
93. 
94.         # Load the current graph state. Pass in None for the connection so
95.         # the loader doesn't try to resolve replaced migrations from DB.
96.         loader = MigrationLoader(None, ignore_no_migrations=True)
97. 
98.         # Raise an error if any migrations are applied before their dependencies.
99.         consistency_check_labels = set(config.label for config in apps.get_app_configs())
100.         # Non-default databases are only checked if database routers used.
101.         aliases_to_check = connections if settings.DATABASE_ROUTERS else [DEFAULT_DB_ALIAS]
102.         for alias in sorted(aliases_to_check):
103.             connection = connections[alias]
104.             if (connection.settings_dict['ENGINE'] != 'django.db.backends.dummy' and any(
105.                     # At least one model must be migrated to the database.
106.                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
107.                     for app_label in consistency_check_labels
108.                     for model in apps.get_models(app_label)
109.             )):
110.                 loader.check_consistent_history(connection)
111. 
112.         # Before anything else, see if there's conflicting apps and drop out
113.         # hard if there are any and they don't want to merge
114.         conflicts = loader.detect_conflicts()
115. 
116.         # If app_labels is specified, filter out conflicting migrations for unspecified apps
117.         if app_labels:
118.             conflicts = {
119.                 app_label: conflict for app_label, conflict in iteritems(conflicts)
120.                 if app_label in app_labels
121.             }
122. 
123.         if conflicts and not self.merge:
124.             name_str = "; ".join(
125.                 "%s in %s" % (", ".join(names), app)
126.                 for app, names in conflicts.items()
127.             )
128.             raise CommandError(
129.                 "Conflicting migrations detected; multiple leaf nodes in the "
130.                 "migration graph: (%s).\nTo fix them run "
131.                 "'python manage.py makemigrations --merge'" % name_str
132.             )
133. 
134.         # If they want to merge and there's nothing to merge, then politely exit
135.         if self.merge and not conflicts:
136.             self.stdout.write("No conflicts detected to merge.")
137.             return
138. 
139.         # If they want to merge and there is something to merge, then
140.         # divert into the merge code
141.         if self.merge and conflicts:
142.             return self.handle_merge(loader, conflicts)
143. 
144.         if self.interactive:
145.             questioner = InteractiveMigrationQuestioner(specified_apps=app_labels, dry_run=self.dry_run)
146.         else:
147.             questioner = NonInteractiveMigrationQuestioner(specified_apps=app_labels, dry_run=self.dry_run)
148.         # Set up autodetector
149.         autodetector = MigrationAutodetector(
150.             loader.project_state(),
151.             ProjectState.from_apps(apps),
152.             questioner,
153.         )
154. 
155.         # If they want to make an empty migration, make one for each app
156.         if self.empty:
157.             if not app_labels:
158.                 raise CommandError("You must supply at least one app label when using --empty.")
159.             # Make a fake changes() result we can pass to arrange_for_graph
160.             changes = {
161.                 app: [Migration("custom", app)]
162.                 for app in app_labels
163.             }
164.             changes = autodetector.arrange_for_graph(
165.                 changes=changes,
166.                 graph=loader.graph,
167.                 migration_name=self.migration_name,
168.             )
169.             self.write_migration_files(changes)
170.             return
171. 
172.         # Detect changes
173.         changes = autodetector.changes(
174.             graph=loader.graph,
175.             trim_to_apps=app_labels or None,
176.             convert_apps=app_labels or None,
177.             migration_name=self.migration_name,
178.         )
179. 
180.         if not changes:
181.             # No changes? Tell them.
182.             if self.verbosity >= 1:
183.                 if len(app_labels) == 1:
184.                     self.stdout.write("No changes detected in app '%s'" % app_labels.pop())
185.                 elif len(app_labels) > 1:
186.                     self.stdout.write("No changes detected in apps '%s'" % ("', '".join(app_labels)))
187.                 else:
188.                     self.stdout.write("No changes detected")
189. 
190.             if self.exit_code:
191.                 sys.exit(1)
192.         else:
193.             self.write_migration_files(changes)
194.             if check_changes:
195.                 sys.exit(1)
196. 
197.     def write_migration_files(self, changes):
198.         """
199.         Takes a changes dict and writes them out as migration files.
200.         """
201.         directory_created = {}
202.         for app_label, app_migrations in changes.items():
203.             if self.verbosity >= 1:
204.                 self.stdout.write(self.style.MIGRATE_HEADING("Migrations for '%s':" % app_label) + "\n")
205.             for migration in app_migrations:
206.                 # Describe the migration
207.                 writer = MigrationWriter(migration)
208.                 if self.verbosity >= 1:
209.                     # Display a relative path if it's below the current working
210.                     # directory, or an absolute path otherwise.
211.                     try:
212.                         migration_string = os.path.relpath(writer.path)
213.                     except ValueError:
214.                         migration_string = writer.path
215.                     if migration_string.startswith('..'):
216.                         migration_string = writer.path
217.                     self.stdout.write("  %s:\n" % (self.style.MIGRATE_LABEL(migration_string),))
218.                     for operation in migration.operations:
219.                         self.stdout.write("    - %s\n" % operation.describe())
220.                 if not self.dry_run:
221.                     # Write the migrations file to the disk.
222.                     migrations_directory = os.path.dirname(writer.path)
223.                     if not directory_created.get(app_label):
224.                         if not os.path.isdir(migrations_directory):
225.                             os.mkdir(migrations_directory)
226.                         init_path = os.path.join(migrations_directory, "__init__.py")
227.                         if not os.path.isfile(init_path):
228.                             open(init_path, "w").close()
229.                         # We just do this once per app
230.                         directory_created[app_label] = True
231.                     migration_string = writer.as_string()
232.                     with io.open(writer.path, "w", encoding='utf-8') as fh:
233.                         fh.write(migration_string)
234.                 elif self.verbosity == 3:
235.                     # Alternatively, makemigrations --dry-run --verbosity 3
236.                     # will output the migrations to stdout rather than saving
237.                     # the file to the disk.
238.                     self.stdout.write(self.style.MIGRATE_HEADING(
239.                         "Full migrations file '%s':" % writer.filename) + "\n"
240.                     )
241.                     self.stdout.write("%s\n" % writer.as_string())
242. 
243.     def handle_merge(self, loader, conflicts):
244.         """
245.         Handles merging together conflicted migrations interactively,
246.         if it's safe; otherwise, advises on how to fix it.
247.         """
248.         if self.interactive:
249.             questioner = InteractiveMigrationQuestioner()
250.         else:
251.             questioner = MigrationQuestioner(defaults={'ask_merge': True})
252. 
253.         for app_label, migration_names in conflicts.items():
254.             # Grab out the migrations in question, and work out their
255.             # common ancestor.
256.             merge_migrations = []
257.             for migration_name in migration_names:
258.                 migration = loader.get_migration(app_label, migration_name)
259.                 migration.ancestry = [
260.                     mig for mig in loader.graph.forwards_plan((app_label, migration_name))
261.                     if mig[0] == migration.app_label
262.                 ]
263.                 merge_migrations.append(migration)
264. 
265.             def all_items_equal(seq):
266.                 return all(item == seq[0] for item in seq[1:])
267. 
268.             merge_migrations_generations = zip(*[m.ancestry for m in merge_migrations])
269.             common_ancestor_count = sum(1 for common_ancestor_generation
270.                                         in takewhile(all_items_equal, merge_migrations_generations))
271.             if not common_ancestor_count:
272.                 raise ValueError("Could not find common ancestor of %s" % migration_names)
273.             # Now work out the operations along each divergent branch
274.             for migration in merge_migrations:
275.                 migration.branch = migration.ancestry[common_ancestor_count:]
276.                 migrations_ops = (loader.get_migration(node_app, node_name).operations
277.                                   for node_app, node_name in migration.branch)
278.                 migration.merged_operations = sum(migrations_ops, [])
279.             # In future, this could use some of the Optimizer code
280.             # (can_optimize_through) to automatically see if they're
281.             # mergeable. For now, we always just prompt the user.
282.             if self.verbosity > 0:
283.                 self.stdout.write(self.style.MIGRATE_HEADING("Merging %s" % app_label))
284.                 for migration in merge_migrations:
285.                     self.stdout.write(self.style.MIGRATE_LABEL("  Branch %s" % migration.name))
286.                     for operation in migration.merged_operations:
287.                         self.stdout.write("    - %s\n" % operation.describe())
288.             if questioner.ask_merge(app_label):
289.                 # If they still want to merge it, then write out an empty
290.                 # file depending on the migrations needing merging.
291.                 numbers = [
292.                     MigrationAutodetector.parse_number(migration.name)
293.                     for migration in merge_migrations
294.                 ]
295.                 try:
296.                     biggest_number = max(x for x in numbers if x is not None)
297.                 except ValueError:
298.                     biggest_number = 1
299.                 subclass = type("Migration", (Migration, ), {
300.                     "dependencies": [(app_label, migration.name) for migration in merge_migrations],
301.                 })
302.                 migration_name = "%04i_%s" % (
303.                     biggest_number + 1,
304.                     self.migration_name or ("merge_%s" % get_migration_name_timestamp())
305.                 )
306.                 new_migration = subclass(migration_name, app_label)
307.                 writer = MigrationWriter(new_migration)
308. 
309.                 if not self.dry_run:
310.                     # Write the merge migrations file to the disk
311.                     with io.open(writer.path, "w", encoding='utf-8') as fh:
312.                         fh.write(writer.as_string())
313.                     if self.verbosity > 0:
314.                         self.stdout.write("\nCreated new merge migration %s" % writer.path)
315.                 elif self.verbosity == 3:
316.                     # Alternatively, makemigrations --merge --dry-run --verbosity 3
317.                     # will output the merge migrations to stdout rather than saving
318.                     # the file to the disk.
319.                     self.stdout.write(self.style.MIGRATE_HEADING(
320.                         "Full merge migrations file '%s':" % writer.filename) + "\n"
321.                     )
322.                     self.stdout.write("%s\n" % writer.as_string())


File: django/db/migrations/autodetector.py
Line number range: 1 - 500
Content:
1. from __future__ import unicode_literals
2. 
3. import functools
4. import re
5. from itertools import chain
6. 
7. from django.conf import settings
8. from django.db import models
9. from django.db.migrations import operations
10. from django.db.migrations.migration import Migration
11. from django.db.migrations.operations.models import AlterModelOptions
12. from django.db.migrations.optimizer import MigrationOptimizer
13. from django.db.migrations.questioner import MigrationQuestioner
14. from django.db.migrations.utils import (
15.     COMPILED_REGEX_TYPE, RegexObject, get_migration_name_timestamp,
16. )
17. from django.utils import six
18. 
19. from .topological_sort import stable_topological_sort
20. 
21. 
22. class MigrationAutodetector(object):
23.     """
24.     Takes a pair of ProjectStates, and compares them to see what the
25.     first would need doing to make it match the second (the second
26.     usually being the project's current state).
27. 
28.     Note that this naturally operates on entire projects at a time,
29.     as it's likely that changes interact (for example, you can't
30.     add a ForeignKey without having a migration to add the table it
31.     depends on first). A user interface may offer single-app usage
32.     if it wishes, with the caveat that it may not always be possible.
33.     """
34. 
35.     def __init__(self, from_state, to_state, questioner=None):
36.         self.from_state = from_state
37.         self.to_state = to_state
38.         self.questioner = questioner or MigrationQuestioner()
39.         self.existing_apps = {app for app, model in from_state.models}
40. 
41.     def changes(self, graph, trim_to_apps=None, convert_apps=None, migration_name=None):
42.         """
43.         Main entry point to produce a list of applicable changes.
44.         Takes a graph to base names on and an optional set of apps
45.         to try and restrict to (restriction is not guaranteed)
46.         """
47.         changes = self._detect_changes(convert_apps, graph)
48.         changes = self.arrange_for_graph(changes, graph, migration_name)
49.         if trim_to_apps:
50.             changes = self._trim_to_apps(changes, trim_to_apps)
51.         return changes
52. 
53.     def deep_deconstruct(self, obj):
54.         """
55.         Recursive deconstruction for a field and its arguments.
56.         Used for full comparison for rename/alter; sometimes a single-level
57.         deconstruction will not compare correctly.
58.         """
59.         if isinstance(obj, list):
60.             return [self.deep_deconstruct(value) for value in obj]
61.         elif isinstance(obj, tuple):
62.             return tuple(self.deep_deconstruct(value) for value in obj)
63.         elif isinstance(obj, dict):
64.             return {
65.                 key: self.deep_deconstruct(value)
66.                 for key, value in obj.items()
67.             }
68.         elif isinstance(obj, functools.partial):
69.             return (obj.func, self.deep_deconstruct(obj.args), self.deep_deconstruct(obj.keywords))
70.         elif isinstance(obj, COMPILED_REGEX_TYPE):
71.             return RegexObject(obj)
72.         elif isinstance(obj, type):
73.             # If this is a type that implements 'deconstruct' as an instance method,
74.             # avoid treating this as being deconstructible itself - see #22951
75.             return obj
76.         elif hasattr(obj, 'deconstruct'):
77.             deconstructed = obj.deconstruct()
78.             if isinstance(obj, models.Field):
79.                 # we have a field which also returns a name
80.                 deconstructed = deconstructed[1:]
81.             path, args, kwargs = deconstructed
82.             return (
83.                 path,
84.                 [self.deep_deconstruct(value) for value in args],
85.                 {
86.                     key: self.deep_deconstruct(value)
87.                     for key, value in kwargs.items()
88.                 },
89.             )
90.         else:
91.             return obj
92. 
93.     def only_relation_agnostic_fields(self, fields):
94.         """
95.         Return a definition of the fields that ignores field names and
96.         what related fields actually relate to.
97.         Used for detecting renames (as, of course, the related fields
98.         change during renames)
99.         """
100.         fields_def = []
101.         for name, field in sorted(fields):
102.             deconstruction = self.deep_deconstruct(field)
103.             if field.remote_field and field.remote_field.model:
104.                 del deconstruction[2]['to']
105.             fields_def.append(deconstruction)
106.         return fields_def
107. 
108.     def _detect_changes(self, convert_apps=None, graph=None):
109.         """
110.         Returns a dict of migration plans which will achieve the
111.         change from from_state to to_state. The dict has app labels
112.         as keys and a list of migrations as values.
113. 
114.         The resulting migrations aren't specially named, but the names
115.         do matter for dependencies inside the set.
116. 
117.         convert_apps is the list of apps to convert to use migrations
118.         (i.e. to make initial migrations for, in the usual case)
119. 
120.         graph is an optional argument that, if provided, can help improve
121.         dependency generation and avoid potential circular dependencies.
122.         """
123. 
124.         # The first phase is generating all the operations for each app
125.         # and gathering them into a big per-app list.
126.         # We'll then go through that list later and order it and split
127.         # into migrations to resolve dependencies caused by M2Ms and FKs.
128.         self.generated_operations = {}
129.         self.altered_indexes = {}
130. 
131.         # Prepare some old/new state and model lists, separating
132.         # proxy models and ignoring unmigrated apps.
133.         self.old_apps = self.from_state.concrete_apps
134.         self.new_apps = self.to_state.apps
135.         self.old_model_keys = []
136.         self.old_proxy_keys = []
137.         self.old_unmanaged_keys = []
138.         self.new_model_keys = []
139.         self.new_proxy_keys = []
140.         self.new_unmanaged_keys = []
141.         for al, mn in sorted(self.from_state.models.keys()):
142.             model = self.old_apps.get_model(al, mn)
143.             if not model._meta.managed:
144.                 self.old_unmanaged_keys.append((al, mn))
145.             elif al not in self.from_state.real_apps:
146.                 if model._meta.proxy:
147.                     self.old_proxy_keys.append((al, mn))
148.                 else:
149.                     self.old_model_keys.append((al, mn))
150. 
151.         for al, mn in sorted(self.to_state.models.keys()):
152.             model = self.new_apps.get_model(al, mn)
153.             if not model._meta.managed:
154.                 self.new_unmanaged_keys.append((al, mn))
155.             elif (
156.                 al not in self.from_state.real_apps or
157.                 (convert_apps and al in convert_apps)
158.             ):
159.                 if model._meta.proxy:
160.                     self.new_proxy_keys.append((al, mn))
161.                 else:
162.                     self.new_model_keys.append((al, mn))
163. 
164.         # Renames have to come first
165.         self.generate_renamed_models()
166. 
167.         # Prepare lists of fields and generate through model map
168.         self._prepare_field_lists()
169.         self._generate_through_model_map()
170. 
171.         # Generate non-rename model operations
172.         self.generate_deleted_models()
173.         self.generate_created_models()
174.         self.generate_deleted_proxies()
175.         self.generate_created_proxies()
176.         self.generate_altered_options()
177.         self.generate_altered_managers()
178. 
179.         # Create the altered indexes and store them in self.altered_indexes.
180.         # This avoids the same computation in generate_removed_indexes()
181.         # and generate_added_indexes().
182.         self.create_altered_indexes()
183.         # Generate index removal operations before field is removed
184.         self.generate_removed_indexes()
185.         # Generate field operations
186.         self.generate_renamed_fields()
187.         self.generate_removed_fields()
188.         self.generate_added_fields()
189.         self.generate_altered_fields()
190.         self.generate_altered_unique_together()
191.         self.generate_altered_index_together()
192.         self.generate_added_indexes()
193.         self.generate_altered_db_table()
194.         self.generate_altered_order_with_respect_to()
195. 
196.         self._sort_migrations()
197.         self._build_migration_list(graph)
198.         self._optimize_migrations()
199. 
200.         return self.migrations
201. 
202.     def _prepare_field_lists(self):
203.         """
204.         Prepare field lists, and prepare a list of the fields that used
205.         through models in the old state so we can make dependencies
206.         from the through model deletion to the field that uses it.
207.         """
208.         self.kept_model_keys = set(self.old_model_keys).intersection(self.new_model_keys)
209.         self.kept_proxy_keys = set(self.old_proxy_keys).intersection(self.new_proxy_keys)
210.         self.kept_unmanaged_keys = set(self.old_unmanaged_keys).intersection(self.new_unmanaged_keys)
211.         self.through_users = {}
212.         self.old_field_keys = set()
213.         self.new_field_keys = set()
214.         for app_label, model_name in sorted(self.kept_model_keys):
215.             old_model_name = self.renamed_models.get((app_label, model_name), model_name)
216.             old_model_state = self.from_state.models[app_label, old_model_name]
217.             new_model_state = self.to_state.models[app_label, model_name]
218.             self.old_field_keys.update((app_label, model_name, x) for x, y in old_model_state.fields)
219.             self.new_field_keys.update((app_label, model_name, x) for x, y in new_model_state.fields)
220. 
221.     def _generate_through_model_map(self):
222.         """
223.         Through model map generation
224.         """
225.         for app_label, model_name in sorted(self.old_model_keys):
226.             old_model_name = self.renamed_models.get((app_label, model_name), model_name)
227.             old_model_state = self.from_state.models[app_label, old_model_name]
228.             for field_name, field in old_model_state.fields:
229.                 old_field = self.old_apps.get_model(app_label, old_model_name)._meta.get_field(field_name)
230.                 if (hasattr(old_field, "remote_field") and getattr(old_field.remote_field, "through", None) and
231.                         not old_field.remote_field.through._meta.auto_created):
232.                     through_key = (
233.                         old_field.remote_field.through._meta.app_label,
234.                         old_field.remote_field.through._meta.model_name,
235.                     )
236.                     self.through_users[through_key] = (app_label, old_model_name, field_name)
237. 
238.     def _build_migration_list(self, graph=None):
239.         """
240.         We need to chop the lists of operations up into migrations with
241.         dependencies on each other. We do this by stepping up an app's list of
242.         operations until we find one that has an outgoing dependency that isn't
243.         in another app's migration yet (hasn't been chopped off its list). We
244.         then chop off the operations before it into a migration and move onto
245.         the next app. If we loop back around without doing anything, there's a
246.         circular dependency (which _should_ be impossible as the operations are
247.         all split at this point so they can't depend and be depended on).
248.         """
249.         self.migrations = {}
250.         num_ops = sum(len(x) for x in self.generated_operations.values())
251.         chop_mode = False
252.         while num_ops:
253.             # On every iteration, we step through all the apps and see if there
254.             # is a completed set of operations.
255.             # If we find that a subset of the operations are complete we can
256.             # try to chop it off from the rest and continue, but we only
257.             # do this if we've already been through the list once before
258.             # without any chopping and nothing has changed.
259.             for app_label in sorted(self.generated_operations.keys()):
260.                 chopped = []
261.                 dependencies = set()
262.                 for operation in list(self.generated_operations[app_label]):
263.                     deps_satisfied = True
264.                     operation_dependencies = set()
265.                     for dep in operation._auto_deps:
266.                         is_swappable_dep = False
267.                         if dep[0] == "__setting__":
268.                             # We need to temporarily resolve the swappable dependency to prevent
269.                             # circular references. While keeping the dependency checks on the
270.                             # resolved model we still add the swappable dependencies.
271.                             # See #23322
272.                             resolved_app_label, resolved_object_name = getattr(settings, dep[1]).split('.')
273.                             original_dep = dep
274.                             dep = (resolved_app_label, resolved_object_name.lower(), dep[2], dep[3])
275.                             is_swappable_dep = True
276.                         if dep[0] != app_label and dep[0] != "__setting__":
277.                             # External app dependency. See if it's not yet
278.                             # satisfied.
279.                             for other_operation in self.generated_operations.get(dep[0], []):
280.                                 if self.check_dependency(other_operation, dep):
281.                                     deps_satisfied = False
282.                                     break
283.                             if not deps_satisfied:
284.                                 break
285.                             else:
286.                                 if is_swappable_dep:
287.                                     operation_dependencies.add((original_dep[0], original_dep[1]))
288.                                 elif dep[0] in self.migrations:
289.                                     operation_dependencies.add((dep[0], self.migrations[dep[0]][-1].name))
290.                                 else:
291.                                     # If we can't find the other app, we add a first/last dependency,
292.                                     # but only if we've already been through once and checked everything
293.                                     if chop_mode:
294.                                         # If the app already exists, we add a dependency on the last migration,
295.                                         # as we don't know which migration contains the target field.
296.                                         # If it's not yet migrated or has no migrations, we use __first__
297.                                         if graph and graph.leaf_nodes(dep[0]):
298.                                             operation_dependencies.add(graph.leaf_nodes(dep[0])[0])
299.                                         else:
300.                                             operation_dependencies.add((dep[0], "__first__"))
301.                                     else:
302.                                         deps_satisfied = False
303.                     if deps_satisfied:
304.                         chopped.append(operation)
305.                         dependencies.update(operation_dependencies)
306.                         self.generated_operations[app_label] = self.generated_operations[app_label][1:]
307.                     else:
308.                         break
309.                 # Make a migration! Well, only if there's stuff to put in it
310.                 if dependencies or chopped:
311.                     if not self.generated_operations[app_label] or chop_mode:
312.                         subclass = type(str("Migration"), (Migration,), {"operations": [], "dependencies": []})
313.                         instance = subclass("auto_%i" % (len(self.migrations.get(app_label, [])) + 1), app_label)
314.                         instance.dependencies = list(dependencies)
315.                         instance.operations = chopped
316.                         instance.initial = app_label not in self.existing_apps
317.                         self.migrations.setdefault(app_label, []).append(instance)
318.                         chop_mode = False
319.                     else:
320.                         self.generated_operations[app_label] = chopped + self.generated_operations[app_label]
321.             new_num_ops = sum(len(x) for x in self.generated_operations.values())
322.             if new_num_ops == num_ops:
323.                 if not chop_mode:
324.                     chop_mode = True
325.                 else:
326.                     raise ValueError("Cannot resolve operation dependencies: %r" % self.generated_operations)
327.             num_ops = new_num_ops
328. 
329.     def _sort_migrations(self):
330.         """
331.         Reorder to make things possible. The order we have already isn't bad,
332.         but we need to pull a few things around so FKs work nicely inside the
333.         same app
334.         """
335.         for app_label, ops in sorted(self.generated_operations.items()):
336.             # construct a dependency graph for intra-app dependencies
337.             dependency_graph = {op: set() for op in ops}
338.             for op in ops:
339.                 for dep in op._auto_deps:
340.                     if dep[0] == app_label:
341.                         for op2 in ops:
342.                             if self.check_dependency(op2, dep):
343.                                 dependency_graph[op].add(op2)
344. 
345.             # we use a stable sort for deterministic tests & general behavior
346.             self.generated_operations[app_label] = stable_topological_sort(ops, dependency_graph)
347. 
348.     def _optimize_migrations(self):
349.         # Add in internal dependencies among the migrations
350.         for app_label, migrations in self.migrations.items():
351.             for m1, m2 in zip(migrations, migrations[1:]):
352.                 m2.dependencies.append((app_label, m1.name))
353. 
354.         # De-dupe dependencies
355.         for app_label, migrations in self.migrations.items():
356.             for migration in migrations:
357.                 migration.dependencies = list(set(migration.dependencies))
358. 
359.         # Optimize migrations
360.         for app_label, migrations in self.migrations.items():
361.             for migration in migrations:
362.                 migration.operations = MigrationOptimizer().optimize(migration.operations, app_label=app_label)
363. 
364.     def check_dependency(self, operation, dependency):
365.         """
366.         Returns ``True`` if the given operation depends on the given dependency,
367.         ``False`` otherwise.
368.         """
369.         # Created model
370.         if dependency[2] is None and dependency[3] is True:
371.             return (
372.                 isinstance(operation, operations.CreateModel) and
373.                 operation.name_lower == dependency[1].lower()
374.             )
375.         # Created field
376.         elif dependency[2] is not None and dependency[3] is True:
377.             return (
378.                 (
379.                     isinstance(operation, operations.CreateModel) and
380.                     operation.name_lower == dependency[1].lower() and
381.                     any(dependency[2] == x for x, y in operation.fields)
382.                 ) or
383.                 (
384.                     isinstance(operation, operations.AddField) and
385.                     operation.model_name_lower == dependency[1].lower() and
386.                     operation.name_lower == dependency[2].lower()
387.                 )
388.             )
389.         # Removed field
390.         elif dependency[2] is not None and dependency[3] is False:
391.             return (
392.                 isinstance(operation, operations.RemoveField) and
393.                 operation.model_name_lower == dependency[1].lower() and
394.                 operation.name_lower == dependency[2].lower()
395.             )
396.         # Removed model
397.         elif dependency[2] is None and dependency[3] is False:
398.             return (
399.                 isinstance(operation, operations.DeleteModel) and
400.                 operation.name_lower == dependency[1].lower()
401.             )
402.         # Field being altered
403.         elif dependency[2] is not None and dependency[3] == "alter":
404.             return (
405.                 isinstance(operation, operations.AlterField) and
406.                 operation.model_name_lower == dependency[1].lower() and
407.                 operation.name_lower == dependency[2].lower()
408.             )
409.         # order_with_respect_to being unset for a field
410.         elif dependency[2] is not None and dependency[3] == "order_wrt_unset":
411.             return (
412.                 isinstance(operation, operations.AlterOrderWithRespectTo) and
413.                 operation.name_lower == dependency[1].lower() and
414.                 (operation.order_with_respect_to or "").lower() != dependency[2].lower()
415.             )
416.         # Field is removed and part of an index/unique_together
417.         elif dependency[2] is not None and dependency[3] == "foo_together_change":
418.             return (
419.                 isinstance(operation, (operations.AlterUniqueTogether,
420.                                        operations.AlterIndexTogether)) and
421.                 operation.name_lower == dependency[1].lower()
422.             )
423.         # Unknown dependency. Raise an error.
424.         else:
425.             raise ValueError("Can't handle dependency %r" % (dependency, ))
426. 
427.     def add_operation(self, app_label, operation, dependencies=None, beginning=False):
428.         # Dependencies are (app_label, model_name, field_name, create/delete as True/False)
429.         operation._auto_deps = dependencies or []
430.         if beginning:
431.             self.generated_operations.setdefault(app_label, []).insert(0, operation)
432.         else:
433.             self.generated_operations.setdefault(app_label, []).append(operation)
434. 
435.     def swappable_first_key(self, item):
436.         """
437.         Sorting key function that places potential swappable models first in
438.         lists of created models (only real way to solve #22783)
439.         """
440.         try:
441.             model = self.new_apps.get_model(item[0], item[1])
442.             base_names = [base.__name__ for base in model.__bases__]
443.             string_version = "%s.%s" % (item[0], item[1])
444.             if (
445.                 model._meta.swappable or
446.                 "AbstractUser" in base_names or
447.                 "AbstractBaseUser" in base_names or
448.                 settings.AUTH_USER_MODEL.lower() == string_version.lower()
449.             ):
450.                 return ("___" + item[0], "___" + item[1])
451.         except LookupError:
452.             pass
453.         return item
454. 
455.     def generate_renamed_models(self):
456.         """
457.         Finds any renamed models, and generates the operations for them,
458.         and removes the old entry from the model lists.
459.         Must be run before other model-level generation.
460.         """
461.         self.renamed_models = {}
462.         self.renamed_models_rel = {}
463.         added_models = set(self.new_model_keys) - set(self.old_model_keys)
464.         for app_label, model_name in sorted(added_models):
465.             model_state = self.to_state.models[app_label, model_name]
466.             model_fields_def = self.only_relation_agnostic_fields(model_state.fields)
467. 
468.             removed_models = set(self.old_model_keys) - set(self.new_model_keys)
469.             for rem_app_label, rem_model_name in removed_models:
470.                 if rem_app_label == app_label:
471.                     rem_model_state = self.from_state.models[rem_app_label, rem_model_name]
472.                     rem_model_fields_def = self.only_relation_agnostic_fields(rem_model_state.fields)
473.                     if model_fields_def == rem_model_fields_def:
474.                         if self.questioner.ask_rename_model(rem_model_state, model_state):
475.                             self.add_operation(
476.                                 app_label,
477.                                 operations.RenameModel(
478.                                     old_name=rem_model_state.name,
479.                                     new_name=model_state.name,
480.                                 )
481.                             )
482.                             self.renamed_models[app_label, model_name] = rem_model_name
483.                             renamed_models_rel_key = '%s.%s' % (rem_model_state.app_label, rem_model_state.name)
484.                             self.renamed_models_rel[renamed_models_rel_key] = '%s.%s' % (
485.                                 model_state.app_label,
486.                                 model_state.name,
487.                             )
488.                             self.old_model_keys.remove((rem_app_label, rem_model_name))
489.                             self.old_model_keys.append((app_label, model_name))
490.                             break
491. 
492.     def generate_created_models(self):
493.         """
494.         Find all new models (both managed and unmanaged) and make create
495.         operations for them as well as separate operations to create any
496.         foreign key or M2M relationships (we'll optimize these back in later
497.         if we can).
498. 
499.         We also defer any model options that refer to collections of fields
500.         that might be deferred (e.g. unique_together, index_together).


File: django/db/migrations/autodetector.py
Line number range: 22 - 1248
Content:
class MigrationAutodetector(object):
    """
    Takes a pair of ProjectStates, and compares them to see what the
    first would need doing to make it match the second (the second
    usually being the project's current state).

    Note that this naturally operates on entire projects at a time,
    as it's likely that changes interact (for example, you can't
    add a ForeignKey without having a migration to add the table it
    depends on first). A user interface may offer single-app usage
    if it wishes, with the caveat that it may not always be possible.
    """

    def __init__(self, from_state, to_state, questioner=None):
        self.from_state = from_state
        self.to_state = to_state
        self.questioner = questioner or MigrationQuestioner()
        self.existing_apps = {app for app, model in from_state.models}

    def changes(self, graph, trim_to_apps=None, convert_apps=None, migration_name=None):
        """
        Main entry point to produce a list of applicable changes.
        Takes a graph to base names on and an optional set of apps
        to try and restrict to (restriction is not guaranteed)
        """
        changes = self._detect_changes(convert_apps, graph)
        changes = self.arrange_for_graph(changes, graph, migration_name)
        if trim_to_apps:
            changes = self._trim_to_apps(changes, trim_to_apps)
        return changes

    def deep_deconstruct(self, obj):
        """
        Recursive deconstruction for a field and its arguments.
        Used for full comparison for rename/alter; sometimes a single-level
        deconstruction will not compare correctly.
        """
        if isinstance(obj, list):
            return [self.deep_deconstruct(value) for value in obj]
        elif isinstance(obj, tuple):
            return tuple(self.deep_deconstruct(value) for value in obj)
        elif isinstance(obj, dict):
            return {
                key: self.deep_deconstruct(value)
                for key, value in obj.items()
            }
        elif isinstance(obj, functools.partial):
            return (obj.func, self.deep_deconstruct(obj.args), self.deep_deconstruct(obj.keywords))
        elif isinstance(obj, COMPILED_REGEX_TYPE):
            return RegexObject(obj)
        elif isinstance(obj, type):
            # If this is a type that implements 'deconstruct' as an instance method,
            # avoid treating this as being deconstructible itself - see #22951
            return obj
        elif hasattr(obj, 'deconstruct'):
            deconstructed = obj.deconstruct()
            if isinstance(obj, models.Field):
                # we have a field which also returns a name
                deconstructed = deconstructed[1:]
            path, args, kwargs = deconstructed
            return (
                path,
                [self.deep_deconstruct(value) for value in args],
                {
                    key: self.deep_deconstruct(value)
                    for key, value in kwargs.items()
                },
            )
        else:
            return obj

    def only_relation_agnostic_fields(self, fields):
        """
        Return a definition of the fields that ignores field names and
        what related fields actually relate to.
        Used for detecting renames (as, of course, the related fields
        change during renames)
        """
        fields_def = []
        for name, field in sorted(fields):
            deconstruction = self.deep_deconstruct(field)
            if field.remote_field and field.remote_field.model:
                del deconstruction[2]['to']
            fields_def.append(deconstruction)
        return fields_def

    def _detect_changes(self, convert_apps=None, graph=None):
        """
        Returns a dict of migration plans which will achieve the
        change from from_state to to_state. The dict has app labels
        as keys and a list of migrations as values.

        The resulting migrations aren't specially named, but the names
        do matter for dependencies inside the set.

        convert_apps is the list of apps to convert to use migrations
        (i.e. to make initial migrations for, in the usual case)

        graph is an optional argument that, if provided, can help improve
        dependency generation and avoid potential circular dependencies.
        """

        # The first phase is generating all the operations for each app
        # and gathering them into a big per-app list.
        # We'll then go through that list later and order it and split
        # into migrations to resolve dependencies caused by M2Ms and FKs.
        self.generated_operations = {}
        self.altered_indexes = {}

        # Prepare some old/new state and model lists, separating
        # proxy models and ignoring unmigrated apps.
        self.old_apps = self.from_state.concrete_apps
        self.new_apps = self.to_state.apps
        self.old_model_keys = []
        self.old_proxy_keys = []
        self.old_unmanaged_keys = []
        self.new_model_keys = []
        self.new_proxy_keys = []
        self.new_unmanaged_keys = []
        for al, mn in sorted(self.from_state.models.keys()):
            model = self.old_apps.get_model(al, mn)
            if not model._meta.managed:
                self.old_unmanaged_keys.append((al, mn))
            elif al not in self.from_state.real_apps:
                if model._meta.proxy:
                    self.old_proxy_keys.append((al, mn))
                else:
                    self.old_model_keys.append((al, mn))

        for al, mn in sorted(self.to_state.models.keys()):
            model = self.new_apps.get_model(al, mn)
            if not model._meta.managed:
                self.new_unmanaged_keys.append((al, mn))
            elif (
                al not in self.from_state.real_apps or
                (convert_apps and al in convert_apps)
            ):
                if model._meta.proxy:
                    self.new_proxy_keys.append((al, mn))
                else:
                    self.new_model_keys.append((al, mn))

        # Renames have to come first
        self.generate_renamed_models()

        # Prepare lists of fields and generate through model map
        self._prepare_field_lists()
        self._generate_through_model_map()

        # Generate non-rename model operations
        self.generate_deleted_models()
        self.generate_created_models()
        self.generate_deleted_proxies()
        self.generate_created_proxies()
        self.generate_altered_options()
        self.generate_altered_managers()

        # Create the altered indexes and store them in self.altered_indexes.
        # This avoids the same computation in generate_removed_indexes()
        # and generate_added_indexes().
        self.create_altered_indexes()
        # Generate index removal operations before field is removed
        self.generate_removed_indexes()
        # Generate field operations
        self.generate_renamed_fields()
        self.generate_removed_fields()
        self.generate_added_fields()
        self.generate_altered_fields()
        self.generate_altered_unique_together()
        self.generate_altered_index_together()
        self.generate_added_indexes()
        self.generate_altered_db_table()
        self.generate_altered_order_with_respect_to()

        self._sort_migrations()
        self._build_migration_list(graph)
        self._optimize_migrations()

        return self.migrations

    def _prepare_field_lists(self):
        """
        Prepare field lists, and prepare a list of the fields that used
        through models in the old state so we can make dependencies
        from the through model deletion to the field that uses it.
        """
        self.kept_model_keys = set(self.old_model_keys).intersection(self.new_model_keys)
        self.kept_proxy_keys = set(self.old_proxy_keys).intersection(self.new_proxy_keys)
        self.kept_unmanaged_keys = set(self.old_unmanaged_keys).intersection(self.new_unmanaged_keys)
        self.through_users = {}
        self.old_field_keys = set()
        self.new_field_keys = set()
        for app_label, model_name in sorted(self.kept_model_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]
            self.old_field_keys.update((app_label, model_name, x) for x, y in old_model_state.fields)
            self.new_field_keys.update((app_label, model_name, x) for x, y in new_model_state.fields)

    def _generate_through_model_map(self):
        """
        Through model map generation
        """
        for app_label, model_name in sorted(self.old_model_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            for field_name, field in old_model_state.fields:
                old_field = self.old_apps.get_model(app_label, old_model_name)._meta.get_field(field_name)
                if (hasattr(old_field, "remote_field") and getattr(old_field.remote_field, "through", None) and
                        not old_field.remote_field.through._meta.auto_created):
                    through_key = (
                        old_field.remote_field.through._meta.app_label,
                        old_field.remote_field.through._meta.model_name,
                    )
                    self.through_users[through_key] = (app_label, old_model_name, field_name)

    def _build_migration_list(self, graph=None):
        """
        We need to chop the lists of operations up into migrations with
        dependencies on each other. We do this by stepping up an app's list of
        operations until we find one that has an outgoing dependency that isn't
        in another app's migration yet (hasn't been chopped off its list). We
        then chop off the operations before it into a migration and move onto
        the next app. If we loop back around without doing anything, there's a
        circular dependency (which _should_ be impossible as the operations are
        all split at this point so they can't depend and be depended on).
        """
        self.migrations = {}
        num_ops = sum(len(x) for x in self.generated_operations.values())
        chop_mode = False
        while num_ops:
            # On every iteration, we step through all the apps and see if there
            # is a completed set of operations.
            # If we find that a subset of the operations are complete we can
            # try to chop it off from the rest and continue, but we only
            # do this if we've already been through the list once before
            # without any chopping and nothing has changed.
            for app_label in sorted(self.generated_operations.keys()):
                chopped = []
                dependencies = set()
                for operation in list(self.generated_operations[app_label]):
                    deps_satisfied = True
                    operation_dependencies = set()
                    for dep in operation._auto_deps:
                        is_swappable_dep = False
                        if dep[0] == "__setting__":
                            # We need to temporarily resolve the swappable dependency to prevent
                            # circular references. While keeping the dependency checks on the
                            # resolved model we still add the swappable dependencies.
                            # See #23322
                            resolved_app_label, resolved_object_name = getattr(settings, dep[1]).split('.')
                            original_dep = dep
                            dep = (resolved_app_label, resolved_object_name.lower(), dep[2], dep[3])
                            is_swappable_dep = True
                        if dep[0] != app_label and dep[0] != "__setting__":
                            # External app dependency. See if it's not yet
                            # satisfied.
                            for other_operation in self.generated_operations.get(dep[0], []):
                                if self.check_dependency(other_operation, dep):
                                    deps_satisfied = False
                                    break
                            if not deps_satisfied:
                                break
                            else:
                                if is_swappable_dep:
                                    operation_dependencies.add((original_dep[0], original_dep[1]))
                                elif dep[0] in self.migrations:
                                    operation_dependencies.add((dep[0], self.migrations[dep[0]][-1].name))
                                else:
                                    # If we can't find the other app, we add a first/last dependency,
                                    # but only if we've already been through once and checked everything
                                    if chop_mode:
                                        # If the app already exists, we add a dependency on the last migration,
                                        # as we don't know which migration contains the target field.
                                        # If it's not yet migrated or has no migrations, we use __first__
                                        if graph and graph.leaf_nodes(dep[0]):
                                            operation_dependencies.add(graph.leaf_nodes(dep[0])[0])
                                        else:
                                            operation_dependencies.add((dep[0], "__first__"))
                                    else:
                                        deps_satisfied = False
                    if deps_satisfied:
                        chopped.append(operation)
                        dependencies.update(operation_dependencies)
                        self.generated_operations[app_label] = self.generated_operations[app_label][1:]
                    else:
                        break
                # Make a migration! Well, only if there's stuff to put in it
                if dependencies or chopped:
                    if not self.generated_operations[app_label] or chop_mode:
                        subclass = type(str("Migration"), (Migration,), {"operations": [], "dependencies": []})
                        instance = subclass("auto_%i" % (len(self.migrations.get(app_label, [])) + 1), app_label)
                        instance.dependencies = list(dependencies)
                        instance.operations = chopped
                        instance.initial = app_label not in self.existing_apps
                        self.migrations.setdefault(app_label, []).append(instance)
                        chop_mode = False
                    else:
                        self.generated_operations[app_label] = chopped + self.generated_operations[app_label]
            new_num_ops = sum(len(x) for x in self.generated_operations.values())
            if new_num_ops == num_ops:
                if not chop_mode:
                    chop_mode = True
                else:
                    raise ValueError("Cannot resolve operation dependencies: %r" % self.generated_operations)
            num_ops = new_num_ops

    def _sort_migrations(self):
        """
        Reorder to make things possible. The order we have already isn't bad,
        but we need to pull a few things around so FKs work nicely inside the
        same app
        """
        for app_label, ops in sorted(self.generated_operations.items()):
            # construct a dependency graph for intra-app dependencies
            dependency_graph = {op: set() for op in ops}
            for op in ops:
                for dep in op._auto_deps:
                    if dep[0] == app_label:
                        for op2 in ops:
                            if self.check_dependency(op2, dep):
                                dependency_graph[op].add(op2)

            # we use a stable sort for deterministic tests & general behavior
            self.generated_operations[app_label] = stable_topological_sort(ops, dependency_graph)

    def _optimize_migrations(self):
        # Add in internal dependencies among the migrations
        for app_label, migrations in self.migrations.items():
            for m1, m2 in zip(migrations, migrations[1:]):
                m2.dependencies.append((app_label, m1.name))

        # De-dupe dependencies
        for app_label, migrations in self.migrations.items():
            for migration in migrations:
                migration.dependencies = list(set(migration.dependencies))

        # Optimize migrations
        for app_label, migrations in self.migrations.items():
            for migration in migrations:
                migration.operations = MigrationOptimizer().optimize(migration.operations, app_label=app_label)

    def check_dependency(self, operation, dependency):
        """
        Returns ``True`` if the given operation depends on the given dependency,
        ``False`` otherwise.
        """
        # Created model
        if dependency[2] is None and dependency[3] is True:
            return (
                isinstance(operation, operations.CreateModel) and
                operation.name_lower == dependency[1].lower()
            )
        # Created field
        elif dependency[2] is not None and dependency[3] is True:
            return (
                (
                    isinstance(operation, operations.CreateModel) and
                    operation.name_lower == dependency[1].lower() and
                    any(dependency[2] == x for x, y in operation.fields)
                ) or
                (
                    isinstance(operation, operations.AddField) and
                    operation.model_name_lower == dependency[1].lower() and
                    operation.name_lower == dependency[2].lower()
                )
            )
        # Removed field
        elif dependency[2] is not None and dependency[3] is False:
            return (
                isinstance(operation, operations.RemoveField) and
                operation.model_name_lower == dependency[1].lower() and
                operation.name_lower == dependency[2].lower()
            )
        # Removed model
        elif dependency[2] is None and dependency[3] is False:
            return (
                isinstance(operation, operations.DeleteModel) and
                operation.name_lower == dependency[1].lower()
            )
        # Field being altered
        elif dependency[2] is not None and dependency[3] == "alter":
            return (
                isinstance(operation, operations.AlterField) and
                operation.model_name_lower == dependency[1].lower() and
                operation.name_lower == dependency[2].lower()
            )
        # order_with_respect_to being unset for a field
        elif dependency[2] is not None and dependency[3] == "order_wrt_unset":
            return (
                isinstance(operation, operations.AlterOrderWithRespectTo) and
                operation.name_lower == dependency[1].lower() and
                (operation.order_with_respect_to or "").lower() != dependency[2].lower()
            )
        # Field is removed and part of an index/unique_together
        elif dependency[2] is not None and dependency[3] == "foo_together_change":
            return (
                isinstance(operation, (operations.AlterUniqueTogether,
                                       operations.AlterIndexTogether)) and
                operation.name_lower == dependency[1].lower()
            )
        # Unknown dependency. Raise an error.
        else:
            raise ValueError("Can't handle dependency %r" % (dependency, ))

    def add_operation(self, app_label, operation, dependencies=None, beginning=False):
        # Dependencies are (app_label, model_name, field_name, create/delete as True/False)
        operation._auto_deps = dependencies or []
        if beginning:
            self.generated_operations.setdefault(app_label, []).insert(0, operation)
        else:
            self.generated_operations.setdefault(app_label, []).append(operation)

    def swappable_first_key(self, item):
        """
        Sorting key function that places potential swappable models first in
        lists of created models (only real way to solve #22783)
        """
        try:
            model = self.new_apps.get_model(item[0], item[1])
            base_names = [base.__name__ for base in model.__bases__]
            string_version = "%s.%s" % (item[0], item[1])
            if (
                model._meta.swappable or
                "AbstractUser" in base_names or
                "AbstractBaseUser" in base_names or
                settings.AUTH_USER_MODEL.lower() == string_version.lower()
            ):
                return ("___" + item[0], "___" + item[1])
        except LookupError:
            pass
        return item

    def generate_renamed_models(self):
        """
        Finds any renamed models, and generates the operations for them,
        and removes the old entry from the model lists.
        Must be run before other model-level generation.
        """
        self.renamed_models = {}
        self.renamed_models_rel = {}
        added_models = set(self.new_model_keys) - set(self.old_model_keys)
        for app_label, model_name in sorted(added_models):
            model_state = self.to_state.models[app_label, model_name]
            model_fields_def = self.only_relation_agnostic_fields(model_state.fields)

            removed_models = set(self.old_model_keys) - set(self.new_model_keys)
            for rem_app_label, rem_model_name in removed_models:
                if rem_app_label == app_label:
                    rem_model_state = self.from_state.models[rem_app_label, rem_model_name]
                    rem_model_fields_def = self.only_relation_agnostic_fields(rem_model_state.fields)
                    if model_fields_def == rem_model_fields_def:
                        if self.questioner.ask_rename_model(rem_model_state, model_state):
                            self.add_operation(
                                app_label,
                                operations.RenameModel(
                                    old_name=rem_model_state.name,
                                    new_name=model_state.name,
                                )
                            )
                            self.renamed_models[app_label, model_name] = rem_model_name
                            renamed_models_rel_key = '%s.%s' % (rem_model_state.app_label, rem_model_state.name)
                            self.renamed_models_rel[renamed_models_rel_key] = '%s.%s' % (
                                model_state.app_label,
                                model_state.name,
                            )
                            self.old_model_keys.remove((rem_app_label, rem_model_name))
                            self.old_model_keys.append((app_label, model_name))
                            break

    def generate_created_models(self):
        """
        Find all new models (both managed and unmanaged) and make create
        operations for them as well as separate operations to create any
        foreign key or M2M relationships (we'll optimize these back in later
        if we can).

        We also defer any model options that refer to collections of fields
        that might be deferred (e.g. unique_together, index_together).
        """
        old_keys = set(self.old_model_keys).union(self.old_unmanaged_keys)
        added_models = set(self.new_model_keys) - old_keys
        added_unmanaged_models = set(self.new_unmanaged_keys) - old_keys
        all_added_models = chain(
            sorted(added_models, key=self.swappable_first_key, reverse=True),
            sorted(added_unmanaged_models, key=self.swappable_first_key, reverse=True)
        )
        for app_label, model_name in all_added_models:
            model_state = self.to_state.models[app_label, model_name]
            model_opts = self.new_apps.get_model(app_label, model_name)._meta
            # Gather related fields
            related_fields = {}
            primary_key_rel = None
            for field in model_opts.local_fields:
                if field.remote_field:
                    if field.remote_field.model:
                        if field.primary_key:
                            primary_key_rel = field.remote_field.model
                        elif not field.remote_field.parent_link:
                            related_fields[field.name] = field
                    # through will be none on M2Ms on swapped-out models;
                    # we can treat lack of through as auto_created=True, though.
                    if (getattr(field.remote_field, "through", None) and
                            not field.remote_field.through._meta.auto_created):
                        related_fields[field.name] = field
            for field in model_opts.local_many_to_many:
                if field.remote_field.model:
                    related_fields[field.name] = field
                if getattr(field.remote_field, "through", None) and not field.remote_field.through._meta.auto_created:
                    related_fields[field.name] = field
            # Are there indexes/unique|index_together to defer?
            indexes = model_state.options.pop('indexes')
            unique_together = model_state.options.pop('unique_together', None)
            index_together = model_state.options.pop('index_together', None)
            order_with_respect_to = model_state.options.pop('order_with_respect_to', None)
            # Depend on the deletion of any possible proxy version of us
            dependencies = [
                (app_label, model_name, None, False),
            ]
            # Depend on all bases
            for base in model_state.bases:
                if isinstance(base, six.string_types) and "." in base:
                    base_app_label, base_name = base.split(".", 1)
                    dependencies.append((base_app_label, base_name, None, True))
            # Depend on the other end of the primary key if it's a relation
            if primary_key_rel:
                dependencies.append((
                    primary_key_rel._meta.app_label,
                    primary_key_rel._meta.object_name,
                    None,
                    True
                ))
            # Generate creation operation
            self.add_operation(
                app_label,
                operations.CreateModel(
                    name=model_state.name,
                    fields=[d for d in model_state.fields if d[0] not in related_fields],
                    options=model_state.options,
                    bases=model_state.bases,
                    managers=model_state.managers,
                ),
                dependencies=dependencies,
                beginning=True,
            )

            # Don't add operations which modify the database for unmanaged models
            if not model_opts.managed:
                continue

            # Generate operations for each related field
            for name, field in sorted(related_fields.items()):
                dependencies = self._get_dependencies_for_foreign_key(field)
                # Depend on our own model being created
                dependencies.append((app_label, model_name, None, True))
                # Make operation
                self.add_operation(
                    app_label,
                    operations.AddField(
                        model_name=model_name,
                        name=name,
                        field=field,
                    ),
                    dependencies=list(set(dependencies)),
                )
            # Generate other opns
            related_dependencies = [
                (app_label, model_name, name, True)
                for name, field in sorted(related_fields.items())
            ]
            related_dependencies.append((app_label, model_name, None, True))
            for index in indexes:
                self.add_operation(
                    app_label,
                    operations.AddIndex(
                        model_name=model_name,
                        index=index,
                    ),
                    dependencies=related_dependencies,
                )
            if unique_together:
                self.add_operation(
                    app_label,
                    operations.AlterUniqueTogether(
                        name=model_name,
                        unique_together=unique_together,
                    ),
                    dependencies=related_dependencies
                )
            if index_together:
                self.add_operation(
                    app_label,
                    operations.AlterIndexTogether(
                        name=model_name,
                        index_together=index_together,
                    ),
                    dependencies=related_dependencies
                )
            if order_with_respect_to:
                self.add_operation(
                    app_label,
                    operations.AlterOrderWithRespectTo(
                        name=model_name,
                        order_with_respect_to=order_with_respect_to,
                    ),
                    dependencies=[
                        (app_label, model_name, order_with_respect_to, True),
                        (app_label, model_name, None, True),
                    ]
                )

            # Fix relationships if the model changed from a proxy model to a
            # concrete model.
            if (app_label, model_name) in self.old_proxy_keys:
                for related_object in model_opts.related_objects:
                    self.add_operation(
                        related_object.related_model._meta.app_label,
                        operations.AlterField(
                            model_name=related_object.related_model._meta.object_name,
                            name=related_object.field.name,
                            field=related_object.field,
                        ),
                        dependencies=[(app_label, model_name, None, True)],
                    )

    def generate_created_proxies(self):
        """
        Makes CreateModel statements for proxy models.
        We use the same statements as that way there's less code duplication,
        but of course for proxy models we can skip all that pointless field
        stuff and just chuck out an operation.
        """
        added = set(self.new_proxy_keys) - set(self.old_proxy_keys)
        for app_label, model_name in sorted(added):
            model_state = self.to_state.models[app_label, model_name]
            assert model_state.options.get("proxy")
            # Depend on the deletion of any possible non-proxy version of us
            dependencies = [
                (app_label, model_name, None, False),
            ]
            # Depend on all bases
            for base in model_state.bases:
                if isinstance(base, six.string_types) and "." in base:
                    base_app_label, base_name = base.split(".", 1)
                    dependencies.append((base_app_label, base_name, None, True))
            # Generate creation operation
            self.add_operation(
                app_label,
                operations.CreateModel(
                    name=model_state.name,
                    fields=[],
                    options=model_state.options,
                    bases=model_state.bases,
                    managers=model_state.managers,
                ),
                # Depend on the deletion of any possible non-proxy version of us
                dependencies=dependencies,
            )

    def generate_deleted_models(self):
        """
        Find all deleted models (managed and unmanaged) and make delete
        operations for them as well as separate operations to delete any
        foreign key or M2M relationships (we'll optimize these back in later
        if we can).

        We also bring forward removal of any model options that refer to
        collections of fields - the inverse of generate_created_models().
        """
        new_keys = set(self.new_model_keys).union(self.new_unmanaged_keys)
        deleted_models = set(self.old_model_keys) - new_keys
        deleted_unmanaged_models = set(self.old_unmanaged_keys) - new_keys
        all_deleted_models = chain(sorted(deleted_models), sorted(deleted_unmanaged_models))
        for app_label, model_name in all_deleted_models:
            model_state = self.from_state.models[app_label, model_name]
            model = self.old_apps.get_model(app_label, model_name)
            if not model._meta.managed:
                # Skip here, no need to handle fields for unmanaged models
                continue

            # Gather related fields
            related_fields = {}
            for field in model._meta.local_fields:
                if field.remote_field:
                    if field.remote_field.model:
                        related_fields[field.name] = field
                    # through will be none on M2Ms on swapped-out models;
                    # we can treat lack of through as auto_created=True, though.
                    if (getattr(field.remote_field, "through", None) and
                            not field.remote_field.through._meta.auto_created):
                        related_fields[field.name] = field
            for field in model._meta.local_many_to_many:
                if field.remote_field.model:
                    related_fields[field.name] = field
                if getattr(field.remote_field, "through", None) and not field.remote_field.through._meta.auto_created:
                    related_fields[field.name] = field
            # Generate option removal first
            unique_together = model_state.options.pop('unique_together', None)
            index_together = model_state.options.pop('index_together', None)
            if unique_together:
                self.add_operation(
                    app_label,
                    operations.AlterUniqueTogether(
                        name=model_name,
                        unique_together=None,
                    )
                )
            if index_together:
                self.add_operation(
                    app_label,
                    operations.AlterIndexTogether(
                        name=model_name,
                        index_together=None,
                    )
                )
            # Then remove each related field
            for name, field in sorted(related_fields.items()):
                self.add_operation(
                    app_label,
                    operations.RemoveField(
                        model_name=model_name,
                        name=name,
                    )
                )
            # Finally, remove the model.
            # This depends on both the removal/alteration of all incoming fields
            # and the removal of all its own related fields, and if it's
            # a through model the field that references it.
            dependencies = []
            for related_object in model._meta.related_objects:
                related_object_app_label = related_object.related_model._meta.app_label
                object_name = related_object.related_model._meta.object_name
                field_name = related_object.field.name
                dependencies.append((related_object_app_label, object_name, field_name, False))
                if not related_object.many_to_many:
                    dependencies.append((related_object_app_label, object_name, field_name, "alter"))

            for name, field in sorted(related_fields.items()):
                dependencies.append((app_label, model_name, name, False))
            # We're referenced in another field's through=
            through_user = self.through_users.get((app_label, model_state.name_lower))
            if through_user:
                dependencies.append((through_user[0], through_user[1], through_user[2], False))
            # Finally, make the operation, deduping any dependencies
            self.add_operation(
                app_label,
                operations.DeleteModel(
                    name=model_state.name,
                ),
                dependencies=list(set(dependencies)),
            )

    def generate_deleted_proxies(self):
        """
        Makes DeleteModel statements for proxy models.
        """
        deleted = set(self.old_proxy_keys) - set(self.new_proxy_keys)
        for app_label, model_name in sorted(deleted):
            model_state = self.from_state.models[app_label, model_name]
            assert model_state.options.get("proxy")
            self.add_operation(
                app_label,
                operations.DeleteModel(
                    name=model_state.name,
                ),
            )

    def generate_renamed_fields(self):
        """
        Works out renamed fields
        """
        self.renamed_fields = {}
        for app_label, model_name, field_name in sorted(self.new_field_keys - self.old_field_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            field = self.new_apps.get_model(app_label, model_name)._meta.get_field(field_name)
            # Scan to see if this is actually a rename!
            field_dec = self.deep_deconstruct(field)
            for rem_app_label, rem_model_name, rem_field_name in sorted(self.old_field_keys - self.new_field_keys):
                if rem_app_label == app_label and rem_model_name == model_name:
                    old_field_dec = self.deep_deconstruct(old_model_state.get_field_by_name(rem_field_name))
                    if field.remote_field and field.remote_field.model and 'to' in old_field_dec[2]:
                        old_rel_to = old_field_dec[2]['to']
                        if old_rel_to in self.renamed_models_rel:
                            old_field_dec[2]['to'] = self.renamed_models_rel[old_rel_to]
                    if old_field_dec == field_dec:
                        if self.questioner.ask_rename(model_name, rem_field_name, field_name, field):
                            self.add_operation(
                                app_label,
                                operations.RenameField(
                                    model_name=model_name,
                                    old_name=rem_field_name,
                                    new_name=field_name,
                                )
                            )
                            self.old_field_keys.remove((rem_app_label, rem_model_name, rem_field_name))
                            self.old_field_keys.add((app_label, model_name, field_name))
                            self.renamed_fields[app_label, model_name, field_name] = rem_field_name
                            break

    def generate_added_fields(self):
        """
        Fields that have been added
        """
        for app_label, model_name, field_name in sorted(self.new_field_keys - self.old_field_keys):
            self._generate_added_field(app_label, model_name, field_name)

    def _generate_added_field(self, app_label, model_name, field_name):
        field = self.new_apps.get_model(app_label, model_name)._meta.get_field(field_name)
        # Fields that are foreignkeys/m2ms depend on stuff
        dependencies = []
        if field.remote_field and field.remote_field.model:
            dependencies.extend(self._get_dependencies_for_foreign_key(field))
        # You can't just add NOT NULL fields with no default or fields
        # which don't allow empty strings as default.
        preserve_default = True
        time_fields = (models.DateField, models.DateTimeField, models.TimeField)
        if (not field.null and not field.has_default() and
                not field.many_to_many and
                not (field.blank and field.empty_strings_allowed) and
                not (isinstance(field, time_fields) and field.auto_now)):
            field = field.clone()
            if isinstance(field, time_fields) and field.auto_now_add:
                field.default = self.questioner.ask_auto_now_add_addition(field_name, model_name)
            else:
                field.default = self.questioner.ask_not_null_addition(field_name, model_name)
            preserve_default = False
        self.add_operation(
            app_label,
            operations.AddField(
                model_name=model_name,
                name=field_name,
                field=field,
                preserve_default=preserve_default,
            ),
            dependencies=dependencies,
        )

    def generate_removed_fields(self):
        """
        Fields that have been removed.
        """
        for app_label, model_name, field_name in sorted(self.old_field_keys - self.new_field_keys):
            self._generate_removed_field(app_label, model_name, field_name)

    def _generate_removed_field(self, app_label, model_name, field_name):
        self.add_operation(
            app_label,
            operations.RemoveField(
                model_name=model_name,
                name=field_name,
            ),
            # We might need to depend on the removal of an
            # order_with_respect_to or index/unique_together operation;
            # this is safely ignored if there isn't one
            dependencies=[
                (app_label, model_name, field_name, "order_wrt_unset"),
                (app_label, model_name, field_name, "foo_together_change"),
            ],
        )

    def generate_altered_fields(self):
        """
        Fields that have been altered.
        """
        for app_label, model_name, field_name in sorted(self.old_field_keys.intersection(self.new_field_keys)):
            # Did the field change?
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_field_name = self.renamed_fields.get((app_label, model_name, field_name), field_name)
            old_field = self.old_apps.get_model(app_label, old_model_name)._meta.get_field(old_field_name)
            new_field = self.new_apps.get_model(app_label, model_name)._meta.get_field(field_name)
            # Implement any model renames on relations; these are handled by RenameModel
            # so we need to exclude them from the comparison
            if hasattr(new_field, "remote_field") and getattr(new_field.remote_field, "model", None):
                rename_key = (
                    new_field.remote_field.model._meta.app_label,
                    new_field.remote_field.model._meta.model_name,
                )
                if rename_key in self.renamed_models:
                    new_field.remote_field.model = old_field.remote_field.model
            if hasattr(new_field, "remote_field") and getattr(new_field.remote_field, "through", None):
                rename_key = (
                    new_field.remote_field.through._meta.app_label,
                    new_field.remote_field.through._meta.model_name,
                )
                if rename_key in self.renamed_models:
                    new_field.remote_field.through = old_field.remote_field.through
            old_field_dec = self.deep_deconstruct(old_field)
            new_field_dec = self.deep_deconstruct(new_field)
            if old_field_dec != new_field_dec:
                both_m2m = old_field.many_to_many and new_field.many_to_many
                neither_m2m = not old_field.many_to_many and not new_field.many_to_many
                if both_m2m or neither_m2m:
                    # Either both fields are m2m or neither is
                    preserve_default = True
                    if (old_field.null and not new_field.null and not new_field.has_default() and
                            not new_field.many_to_many):
                        field = new_field.clone()
                        new_default = self.questioner.ask_not_null_alteration(field_name, model_name)
                        if new_default is not models.NOT_PROVIDED:
                            field.default = new_default
                            preserve_default = False
                    else:
                        field = new_field
                    self.add_operation(
                        app_label,
                        operations.AlterField(
                            model_name=model_name,
                            name=field_name,
                            field=field,
                            preserve_default=preserve_default,
                        )
                    )
                else:
                    # We cannot alter between m2m and concrete fields
                    self._generate_removed_field(app_label, model_name, field_name)
                    self._generate_added_field(app_label, model_name, field_name)

    def create_altered_indexes(self):
        option_name = operations.AddIndex.option_name
        for app_label, model_name in sorted(self.kept_model_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]

            old_indexes = old_model_state.options[option_name]
            new_indexes = new_model_state.options[option_name]
            add_idx = [idx for idx in new_indexes if idx not in old_indexes]
            rem_idx = [idx for idx in old_indexes if idx not in new_indexes]

            self.altered_indexes.update({
                (app_label, model_name): {
                    'added_indexes': add_idx, 'removed_indexes': rem_idx,
                }
            })

    def generate_added_indexes(self):
        for (app_label, model_name), alt_indexes in self.altered_indexes.items():
            for index in alt_indexes['added_indexes']:
                self.add_operation(
                    app_label,
                    operations.AddIndex(
                        model_name=model_name,
                        index=index,
                    )
                )

    def generate_removed_indexes(self):
        for (app_label, model_name), alt_indexes in self.altered_indexes.items():
            for index in alt_indexes['removed_indexes']:
                self.add_operation(
                    app_label,
                    operations.RemoveIndex(
                        model_name=model_name,
                        name=index.name,
                    )
                )

    def _get_dependencies_for_foreign_key(self, field):
        # Account for FKs to swappable models
        swappable_setting = getattr(field, 'swappable_setting', None)
        if swappable_setting is not None:
            dep_app_label = "__setting__"
            dep_object_name = swappable_setting
        else:
            dep_app_label = field.remote_field.model._meta.app_label
            dep_object_name = field.remote_field.model._meta.object_name
        dependencies = [(dep_app_label, dep_object_name, None, True)]
        if getattr(field.remote_field, "through", None) and not field.remote_field.through._meta.auto_created:
            dependencies.append((
                field.remote_field.through._meta.app_label,
                field.remote_field.through._meta.object_name,
                None,
                True,
            ))
        return dependencies

    def _generate_altered_foo_together(self, operation):
        option_name = operation.option_name
        for app_label, model_name in sorted(self.kept_model_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]

            # We run the old version through the field renames to account for those
            old_value = old_model_state.options.get(option_name) or set()
            if old_value:
                old_value = {
                    tuple(
                        self.renamed_fields.get((app_label, model_name, n), n)
                        for n in unique
                    )
                    for unique in old_value
                }

            new_value = new_model_state.options.get(option_name) or set()
            if new_value:
                new_value = set(new_value)

            if old_value != new_value:
                dependencies = []
                for foo_togethers in new_value:
                    for field_name in foo_togethers:
                        field = self.new_apps.get_model(app_label, model_name)._meta.get_field(field_name)
                        if field.remote_field and field.remote_field.model:
                            dependencies.extend(self._get_dependencies_for_foreign_key(field))

                self.add_operation(
                    app_label,
                    operation(
                        name=model_name,
                        **{option_name: new_value}
                    ),
                    dependencies=dependencies,
                )

    def generate_altered_unique_together(self):
        self._generate_altered_foo_together(operations.AlterUniqueTogether)

    def generate_altered_index_together(self):
        self._generate_altered_foo_together(operations.AlterIndexTogether)

    def generate_altered_db_table(self):
        models_to_check = self.kept_model_keys.union(self.kept_proxy_keys).union(self.kept_unmanaged_keys)
        for app_label, model_name in sorted(models_to_check):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]
            old_db_table_name = old_model_state.options.get('db_table')
            new_db_table_name = new_model_state.options.get('db_table')
            if old_db_table_name != new_db_table_name:
                self.add_operation(
                    app_label,
                    operations.AlterModelTable(
                        name=model_name,
                        table=new_db_table_name,
                    )
                )

    def generate_altered_options(self):
        """
        Works out if any non-schema-affecting options have changed and
        makes an operation to represent them in state changes (in case Python
        code in migrations needs them)
        """
        models_to_check = self.kept_model_keys.union(
            self.kept_proxy_keys
        ).union(
            self.kept_unmanaged_keys
        ).union(
            # unmanaged converted to managed
            set(self.old_unmanaged_keys).intersection(self.new_model_keys)
        ).union(
            # managed converted to unmanaged
            set(self.old_model_keys).intersection(self.new_unmanaged_keys)
        )

        for app_label, model_name in sorted(models_to_check):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]
            old_options = dict(
                option for option in old_model_state.options.items()
                if option[0] in AlterModelOptions.ALTER_OPTION_KEYS
            )
            new_options = dict(
                option for option in new_model_state.options.items()
                if option[0] in AlterModelOptions.ALTER_OPTION_KEYS
            )
            if old_options != new_options:
                self.add_operation(
                    app_label,
                    operations.AlterModelOptions(
                        name=model_name,
                        options=new_options,
                    )
                )

    def generate_altered_order_with_respect_to(self):
        for app_label, model_name in sorted(self.kept_model_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]
            if (old_model_state.options.get("order_with_respect_to") !=
                    new_model_state.options.get("order_with_respect_to")):
                # Make sure it comes second if we're adding
                # (removal dependency is part of RemoveField)
                dependencies = []
                if new_model_state.options.get("order_with_respect_to"):
                    dependencies.append((
                        app_label,
                        model_name,
                        new_model_state.options["order_with_respect_to"],
                        True,
                    ))
                # Actually generate the operation
                self.add_operation(
                    app_label,
                    operations.AlterOrderWithRespectTo(
                        name=model_name,
                        order_with_respect_to=new_model_state.options.get('order_with_respect_to'),
                    ),
                    dependencies=dependencies,
                )

    def generate_altered_managers(self):
        for app_label, model_name in sorted(self.kept_model_keys):
            old_model_name = self.renamed_models.get((app_label, model_name), model_name)
            old_model_state = self.from_state.models[app_label, old_model_name]
            new_model_state = self.to_state.models[app_label, model_name]
            if old_model_state.managers != new_model_state.managers:
                self.add_operation(
                    app_label,
                    operations.AlterModelManagers(
                        name=model_name,
                        managers=new_model_state.managers,
                    )
                )

    def arrange_for_graph(self, changes, graph, migration_name=None):
        """
        Takes in a result from changes() and a MigrationGraph,
        and fixes the names and dependencies of the changes so they
        extend the graph from the leaf nodes for each app.
        """
        leaves = graph.leaf_nodes()
        name_map = {}
        for app_label, migrations in list(changes.items()):
            if not migrations:
                continue
            # Find the app label's current leaf node
            app_leaf = None
            for leaf in leaves:
                if leaf[0] == app_label:
                    app_leaf = leaf
                    break
            # Do they want an initial migration for this app?
            if app_leaf is None and not self.questioner.ask_initial(app_label):
                # They don't.
                for migration in migrations:
                    name_map[(app_label, migration.name)] = (app_label, "__first__")
                del changes[app_label]
                continue
            # Work out the next number in the sequence
            if app_leaf is None:
                next_number = 1
            else:
                next_number = (self.parse_number(app_leaf[1]) or 0) + 1
            # Name each migration
            for i, migration in enumerate(migrations):
                if i == 0 and app_leaf:
                    migration.dependencies.append(app_leaf)
                if i == 0 and not app_leaf:
                    new_name = "0001_%s" % migration_name if migration_name else "0001_initial"
                else:
                    new_name = "%04i_%s" % (
                        next_number,
                        migration_name or self.suggest_name(migration.operations)[:100],
                    )
                name_map[(app_label, migration.name)] = (app_label, new_name)
                next_number += 1
                migration.name = new_name
        # Now fix dependencies
        for app_label, migrations in changes.items():
            for migration in migrations:
                migration.dependencies = [name_map.get(d, d) for d in migration.dependencies]
        return changes

    def _trim_to_apps(self, changes, app_labels):
        """
        Takes changes from arrange_for_graph and set of app labels and
        returns a modified set of changes which trims out as many migrations
        that are not in app_labels as possible.
        Note that some other migrations may still be present, as they may be
        required dependencies.
        """
        # Gather other app dependencies in a first pass
        app_dependencies = {}
        for app_label, migrations in changes.items():
            for migration in migrations:
                for dep_app_label, name in migration.dependencies:
                    app_dependencies.setdefault(app_label, set()).add(dep_app_label)
        required_apps = set(app_labels)
        # Keep resolving till there's no change
        old_required_apps = None
        while old_required_apps != required_apps:
            old_required_apps = set(required_apps)
            for app_label in list(required_apps):
                required_apps.update(app_dependencies.get(app_label, set()))
        # Remove all migrations that aren't needed
        for app_label in list(changes.keys()):
            if app_label not in required_apps:
                del changes[app_label]
        return changes

    @classmethod
    def suggest_name(cls, ops):
        """
        Given a set of operations, suggests a name for the migration
        they might represent. Names are not guaranteed to be unique,
        but we put some effort in to the fallback name to avoid VCS conflicts
        if we can.
        """
        if len(ops) == 1:
            if isinstance(ops[0], operations.CreateModel):
                return ops[0].name_lower
            elif isinstance(ops[0], operations.DeleteModel):
                return "delete_%s" % ops[0].name_lower
            elif isinstance(ops[0], operations.AddField):
                return "%s_%s" % (ops[0].model_name_lower, ops[0].name_lower)
            elif isinstance(ops[0], operations.RemoveField):
                return "remove_%s_%s" % (ops[0].model_name_lower, ops[0].name_lower)
        elif len(ops) > 1:
            if all(isinstance(o, operations.CreateModel) for o in ops):
                return "_".join(sorted(o.name_lower for o in ops))
        return "auto_%s" % get_migration_name_timestamp()

    @classmethod
    def parse_number(cls, name):
        """
        Given a migration name, tries to extract a number from the
        beginning of it. If no number found, returns None.
        """
        match = re.match(r'^\d+', name)
        if match:
            return int(match.group())
        return None


File: django/db/migrations/state.py
Line number range: 1 - 500
Content:
1. from __future__ import unicode_literals
2. 
3. import copy
4. import warnings
5. from collections import OrderedDict
6. from contextlib import contextmanager
7. 
8. from django.apps import AppConfig
9. from django.apps.registry import Apps, apps as global_apps
10. from django.conf import settings
11. from django.db import models
12. from django.db.models.fields.proxy import OrderWrt
13. from django.db.models.fields.related import RECURSIVE_RELATIONSHIP_CONSTANT
14. from django.db.models.options import DEFAULT_NAMES, normalize_together
15. from django.db.models.utils import make_model_tuple
16. from django.utils import six
17. from django.utils.deprecation import RemovedInDjango20Warning
18. from django.utils.encoding import force_text
19. from django.utils.functional import cached_property
20. from django.utils.module_loading import import_string
21. from django.utils.version import get_docs_version
22. 
23. from .exceptions import InvalidBasesError
24. 
25. 
26. def _get_app_label_and_model_name(model, app_label=''):
27.     if isinstance(model, six.string_types):
28.         split = model.split('.', 1)
29.         return (tuple(split) if len(split) == 2 else (app_label, split[0]))
30.     else:
31.         return model._meta.app_label, model._meta.model_name
32. 
33. 
34. def _get_related_models(m):
35.     """
36.     Return all models that have a direct relationship to the given model.
37.     """
38.     related_models = [
39.         subclass for subclass in m.__subclasses__()
40.         if issubclass(subclass, models.Model)
41.     ]
42.     related_fields_models = set()
43.     for f in m._meta.get_fields(include_parents=True, include_hidden=True):
44.         if f.is_relation and f.related_model is not None and not isinstance(f.related_model, six.string_types):
45.             related_fields_models.add(f.model)
46.             related_models.append(f.related_model)
47.     # Reverse accessors of foreign keys to proxy models are attached to their
48.     # concrete proxied model.
49.     opts = m._meta
50.     if opts.proxy and m in related_fields_models:
51.         related_models.append(opts.concrete_model)
52.     return related_models
53. 
54. 
55. def get_related_models_recursive(model):
56.     """
57.     Return all models that have a direct or indirect relationship
58.     to the given model.
59. 
60.     Relationships are either defined by explicit relational fields, like
61.     ForeignKey, ManyToManyField or OneToOneField, or by inheriting from another
62.     model (a superclass is related to its subclasses, but not vice versa). Note,
63.     however, that a model inheriting from a concrete model is also related to
64.     its superclass through the implicit *_ptr OneToOneField on the subclass.
65.     """
66.     seen = set()
67.     queue = _get_related_models(model)
68.     for rel_mod in queue:
69.         rel_app_label, rel_model_name = rel_mod._meta.app_label, rel_mod._meta.model_name
70.         if (rel_app_label, rel_model_name) in seen:
71.             continue
72.         seen.add((rel_app_label, rel_model_name))
73.         queue.extend(_get_related_models(rel_mod))
74.     return seen - {(model._meta.app_label, model._meta.model_name)}
75. 
76. 
77. class ProjectState(object):
78.     """
79.     Represents the entire project's overall state.
80.     This is the item that is passed around - we do it here rather than at the
81.     app level so that cross-app FKs/etc. resolve properly.
82.     """
83. 
84.     def __init__(self, models=None, real_apps=None):
85.         self.models = models or {}
86.         # Apps to include from main registry, usually unmigrated ones
87.         self.real_apps = real_apps or []
88. 
89.     def add_model(self, model_state):
90.         app_label, model_name = model_state.app_label, model_state.name_lower
91.         self.models[(app_label, model_name)] = model_state
92.         if 'apps' in self.__dict__:  # hasattr would cache the property
93.             self.reload_model(app_label, model_name)
94. 
95.     def remove_model(self, app_label, model_name):
96.         del self.models[app_label, model_name]
97.         if 'apps' in self.__dict__:  # hasattr would cache the property
98.             self.apps.unregister_model(app_label, model_name)
99.             # Need to do this explicitly since unregister_model() doesn't clear
100.             # the cache automatically (#24513)
101.             self.apps.clear_cache()
102. 
103.     def reload_model(self, app_label, model_name):
104.         if 'apps' in self.__dict__:  # hasattr would cache the property
105.             try:
106.                 old_model = self.apps.get_model(app_label, model_name)
107.             except LookupError:
108.                 related_models = set()
109.             else:
110.                 # Get all relations to and from the old model before reloading,
111.                 # as _meta.apps may change
112.                 related_models = get_related_models_recursive(old_model)
113. 
114.             # Get all outgoing references from the model to be rendered
115.             model_state = self.models[(app_label, model_name)]
116.             # Directly related models are the models pointed to by ForeignKeys,
117.             # OneToOneFields, and ManyToManyFields.
118.             direct_related_models = set()
119.             for name, field in model_state.fields:
120.                 if field.is_relation:
121.                     if field.remote_field.model == RECURSIVE_RELATIONSHIP_CONSTANT:
122.                         continue
123.                     rel_app_label, rel_model_name = _get_app_label_and_model_name(field.related_model, app_label)
124.                     direct_related_models.add((rel_app_label, rel_model_name.lower()))
125. 
126.             # For all direct related models recursively get all related models.
127.             related_models.update(direct_related_models)
128.             for rel_app_label, rel_model_name in direct_related_models:
129.                 try:
130.                     rel_model = self.apps.get_model(rel_app_label, rel_model_name)
131.                 except LookupError:
132.                     pass
133.                 else:
134.                     related_models.update(get_related_models_recursive(rel_model))
135. 
136.             # Include the model itself
137.             related_models.add((app_label, model_name))
138. 
139.             # Unregister all related models
140.             with self.apps.bulk_update():
141.                 for rel_app_label, rel_model_name in related_models:
142.                     self.apps.unregister_model(rel_app_label, rel_model_name)
143. 
144.             states_to_be_rendered = []
145.             # Gather all models states of those models that will be rerendered.
146.             # This includes:
147.             # 1. All related models of unmigrated apps
148.             for model_state in self.apps.real_models:
149.                 if (model_state.app_label, model_state.name_lower) in related_models:
150.                     states_to_be_rendered.append(model_state)
151. 
152.             # 2. All related models of migrated apps
153.             for rel_app_label, rel_model_name in related_models:
154.                 try:
155.                     model_state = self.models[rel_app_label, rel_model_name]
156.                 except KeyError:
157.                     pass
158.                 else:
159.                     states_to_be_rendered.append(model_state)
160. 
161.             # Render all models
162.             self.apps.render_multiple(states_to_be_rendered)
163. 
164.     def clone(self):
165.         "Returns an exact copy of this ProjectState"
166.         new_state = ProjectState(
167.             models={k: v.clone() for k, v in self.models.items()},
168.             real_apps=self.real_apps,
169.         )
170.         if 'apps' in self.__dict__:
171.             new_state.apps = self.apps.clone()
172.         return new_state
173. 
174.     @cached_property
175.     def apps(self):
176.         return StateApps(self.real_apps, self.models)
177. 
178.     @property
179.     def concrete_apps(self):
180.         self.apps = StateApps(self.real_apps, self.models, ignore_swappable=True)
181.         return self.apps
182. 
183.     @classmethod
184.     def from_apps(cls, apps):
185.         "Takes in an Apps and returns a ProjectState matching it"
186.         app_models = {}
187.         for model in apps.get_models(include_swapped=True):
188.             model_state = ModelState.from_model(model)
189.             app_models[(model_state.app_label, model_state.name_lower)] = model_state
190.         return cls(app_models)
191. 
192.     def __eq__(self, other):
193.         if set(self.models.keys()) != set(other.models.keys()):
194.             return False
195.         if set(self.real_apps) != set(other.real_apps):
196.             return False
197.         return all(model == other.models[key] for key, model in self.models.items())
198. 
199.     def __ne__(self, other):
200.         return not (self == other)
201. 
202. 
203. class AppConfigStub(AppConfig):
204.     """
205.     Stubs a Django AppConfig. Only provides a label, and a dict of models.
206.     """
207.     # Not used, but required by AppConfig.__init__
208.     path = ''
209. 
210.     def __init__(self, label):
211.         self.label = label
212.         # App-label and app-name are not the same thing, so technically passing
213.         # in the label here is wrong. In practice, migrations don't care about
214.         # the app name, but we need something unique, and the label works fine.
215.         super(AppConfigStub, self).__init__(label, None)
216. 
217.     def import_models(self):
218.         self.models = self.apps.all_models[self.label]
219. 
220. 
221. class StateApps(Apps):
222.     """
223.     Subclass of the global Apps registry class to better handle dynamic model
224.     additions and removals.
225.     """
226.     def __init__(self, real_apps, models, ignore_swappable=False):
227.         # Any apps in self.real_apps should have all their models included
228.         # in the render. We don't use the original model instances as there
229.         # are some variables that refer to the Apps object.
230.         # FKs/M2Ms from real apps are also not included as they just
231.         # mess things up with partial states (due to lack of dependencies)
232.         self.real_models = []
233.         for app_label in real_apps:
234.             app = global_apps.get_app_config(app_label)
235.             for model in app.get_models():
236.                 self.real_models.append(ModelState.from_model(model, exclude_rels=True))
237.         # Populate the app registry with a stub for each application.
238.         app_labels = {model_state.app_label for model_state in models.values()}
239.         app_configs = [AppConfigStub(label) for label in sorted(real_apps + list(app_labels))]
240.         super(StateApps, self).__init__(app_configs)
241. 
242.         # The lock gets in the way of copying as implemented in clone(), which
243.         # is called whenever Django duplicates a StateApps before updating it.
244.         self._lock = None
245. 
246.         self.render_multiple(list(models.values()) + self.real_models)
247. 
248.         # There shouldn't be any operations pending at this point.
249.         from django.core.checks.model_checks import _check_lazy_references
250.         ignore = {make_model_tuple(settings.AUTH_USER_MODEL)} if ignore_swappable else set()
251.         errors = _check_lazy_references(self, ignore=ignore)
252.         if errors:
253.             raise ValueError("\n".join(error.msg for error in errors))
254. 
255.     @contextmanager
256.     def bulk_update(self):
257.         # Avoid clearing each model's cache for each change. Instead, clear
258.         # all caches when we're finished updating the model instances.
259.         ready = self.ready
260.         self.ready = False
261.         try:
262.             yield
263.         finally:
264.             self.ready = ready
265.             self.clear_cache()
266. 
267.     def render_multiple(self, model_states):
268.         # We keep trying to render the models in a loop, ignoring invalid
269.         # base errors, until the size of the unrendered models doesn't
270.         # decrease by at least one, meaning there's a base dependency loop/
271.         # missing base.
272.         if not model_states:
273.             return
274.         # Prevent that all model caches are expired for each render.
275.         with self.bulk_update():
276.             unrendered_models = model_states
277.             while unrendered_models:
278.                 new_unrendered_models = []
279.                 for model in unrendered_models:
280.                     try:
281.                         model.render(self)
282.                     except InvalidBasesError:
283.                         new_unrendered_models.append(model)
284.                 if len(new_unrendered_models) == len(unrendered_models):
285.                     raise InvalidBasesError(
286.                         "Cannot resolve bases for %r\nThis can happen if you are inheriting models from an "
287.                         "app with migrations (e.g. contrib.auth)\n in an app with no migrations; see "
288.                         "https://docs.djangoproject.com/en/%s/topics/migrations/#dependencies "
289.                         "for more" % (new_unrendered_models, get_docs_version())
290.                     )
291.                 unrendered_models = new_unrendered_models
292. 
293.     def clone(self):
294.         """
295.         Return a clone of this registry, mainly used by the migration framework.
296.         """
297.         clone = StateApps([], {})
298.         clone.all_models = copy.deepcopy(self.all_models)
299.         clone.app_configs = copy.deepcopy(self.app_configs)
300.         # Set the pointer to the correct app registry.
301.         for app_config in clone.app_configs.values():
302.             app_config.apps = clone
303.         # No need to actually clone them, they'll never change
304.         clone.real_models = self.real_models
305.         return clone
306. 
307.     def register_model(self, app_label, model):
308.         self.all_models[app_label][model._meta.model_name] = model
309.         if app_label not in self.app_configs:
310.             self.app_configs[app_label] = AppConfigStub(app_label)
311.             self.app_configs[app_label].apps = self
312.             self.app_configs[app_label].models = OrderedDict()
313.         self.app_configs[app_label].models[model._meta.model_name] = model
314.         self.do_pending_operations(model)
315.         self.clear_cache()
316. 
317.     def unregister_model(self, app_label, model_name):
318.         try:
319.             del self.all_models[app_label][model_name]
320.             del self.app_configs[app_label].models[model_name]
321.         except KeyError:
322.             pass
323. 
324. 
325. class ModelState(object):
326.     """
327.     Represents a Django Model. We don't use the actual Model class
328.     as it's not designed to have its options changed - instead, we
329.     mutate this one and then render it into a Model as required.
330. 
331.     Note that while you are allowed to mutate .fields, you are not allowed
332.     to mutate the Field instances inside there themselves - you must instead
333.     assign new ones, as these are not detached during a clone.
334.     """
335. 
336.     def __init__(self, app_label, name, fields, options=None, bases=None, managers=None):
337.         self.app_label = app_label
338.         self.name = force_text(name)
339.         self.fields = fields
340.         self.options = options or {}
341.         self.options.setdefault('indexes', [])
342.         self.bases = bases or (models.Model, )
343.         self.managers = managers or []
344.         # Sanity-check that fields is NOT a dict. It must be ordered.
345.         if isinstance(self.fields, dict):
346.             raise ValueError("ModelState.fields cannot be a dict - it must be a list of 2-tuples.")
347.         for name, field in fields:
348.             # Sanity-check that fields are NOT already bound to a model.
349.             if hasattr(field, 'model'):
350.                 raise ValueError(
351.                     'ModelState.fields cannot be bound to a model - "%s" is.' % name
352.                 )
353.             # Sanity-check that relation fields are NOT referring to a model class.
354.             if field.is_relation and hasattr(field.related_model, '_meta'):
355.                 raise ValueError(
356.                     'ModelState.fields cannot refer to a model class - "%s.to" does. '
357.                     'Use a string reference instead.' % name
358.                 )
359.             if field.many_to_many and hasattr(field.remote_field.through, '_meta'):
360.                 raise ValueError(
361.                     'ModelState.fields cannot refer to a model class - "%s.through" does. '
362.                     'Use a string reference instead.' % name
363.                 )
364.         # Sanity-check that indexes have their name set.
365.         for index in self.options['indexes']:
366.             if not index.name:
367.                 raise ValueError(
368.                     "Indexes passed to ModelState require a name attribute. "
369.                     "%r doesn't have one." % index
370.                 )
371. 
372.     @cached_property
373.     def name_lower(self):
374.         return self.name.lower()
375. 
376.     @classmethod
377.     def from_model(cls, model, exclude_rels=False):
378.         """
379.         Feed me a model, get a ModelState representing it out.
380.         """
381.         # Deconstruct the fields
382.         fields = []
383.         for field in model._meta.local_fields:
384.             if getattr(field, "remote_field", None) and exclude_rels:
385.                 continue
386.             if isinstance(field, OrderWrt):
387.                 continue
388.             name = force_text(field.name, strings_only=True)
389.             try:
390.                 fields.append((name, field.clone()))
391.             except TypeError as e:
392.                 raise TypeError("Couldn't reconstruct field %s on %s: %s" % (
393.                     name,
394.                     model._meta.label,
395.                     e,
396.                 ))
397.         if not exclude_rels:
398.             for field in model._meta.local_many_to_many:
399.                 name = force_text(field.name, strings_only=True)
400.                 try:
401.                     fields.append((name, field.clone()))
402.                 except TypeError as e:
403.                     raise TypeError("Couldn't reconstruct m2m field %s on %s: %s" % (
404.                         name,
405.                         model._meta.object_name,
406.                         e,
407.                     ))
408.         # Extract the options
409.         options = {}
410.         for name in DEFAULT_NAMES:
411.             # Ignore some special options
412.             if name in ["apps", "app_label"]:
413.                 continue
414.             elif name in model._meta.original_attrs:
415.                 if name == "unique_together":
416.                     ut = model._meta.original_attrs["unique_together"]
417.                     options[name] = set(normalize_together(ut))
418.                 elif name == "index_together":
419.                     it = model._meta.original_attrs["index_together"]
420.                     options[name] = set(normalize_together(it))
421.                 else:
422.                     options[name] = model._meta.original_attrs[name]
423.         # Force-convert all options to text_type (#23226)
424.         options = cls.force_text_recursive(options)
425.         # If we're ignoring relationships, remove all field-listing model
426.         # options (that option basically just means "make a stub model")
427.         if exclude_rels:
428.             for key in ["unique_together", "index_together", "order_with_respect_to"]:
429.                 if key in options:
430.                     del options[key]
431.         # Private fields are ignored, so remove options that refer to them.
432.         elif options.get('order_with_respect_to') in {field.name for field in model._meta.private_fields}:
433.             del options['order_with_respect_to']
434. 
435.         def flatten_bases(model):
436.             bases = []
437.             for base in model.__bases__:
438.                 if hasattr(base, "_meta") and base._meta.abstract:
439.                     bases.extend(flatten_bases(base))
440.                 else:
441.                     bases.append(base)
442.             return bases
443. 
444.         # We can't rely on __mro__ directly because we only want to flatten
445.         # abstract models and not the whole tree. However by recursing on
446.         # __bases__ we may end up with duplicates and ordering issues, we
447.         # therefore discard any duplicates and reorder the bases according
448.         # to their index in the MRO.
449.         flattened_bases = sorted(set(flatten_bases(model)), key=lambda x: model.__mro__.index(x))
450. 
451.         # Make our record
452.         bases = tuple(
453.             (
454.                 base._meta.label_lower
455.                 if hasattr(base, "_meta") else
456.                 base
457.             )
458.             for base in flattened_bases
459.         )
460.         # Ensure at least one base inherits from models.Model
461.         if not any((isinstance(base, six.string_types) or issubclass(base, models.Model)) for base in bases):
462.             bases = (models.Model,)
463. 
464.         managers = []
465.         manager_names = set()
466.         default_manager_shim = None
467.         for manager in model._meta.managers:
468.             manager_name = force_text(manager.name)
469.             if manager_name in manager_names:
470.                 # Skip overridden managers.
471.                 continue
472.             elif manager.use_in_migrations:
473.                 # Copy managers usable in migrations.
474.                 new_manager = copy.copy(manager)
475.                 new_manager._set_creation_counter()
476.             elif manager is model._base_manager or manager is model._default_manager:
477.                 # Shim custom managers used as default and base managers.
478.                 new_manager = models.Manager()
479.                 new_manager.model = manager.model
480.                 new_manager.name = manager.name
481.                 if manager is model._default_manager:
482.                     default_manager_shim = new_manager
483.             else:
484.                 continue
485.             manager_names.add(manager_name)
486.             managers.append((manager_name, new_manager))
487. 
488.         # Ignore a shimmed default manager called objects if it's the only one.
489.         if managers == [('objects', default_manager_shim)]:
490.             managers = []
491. 
492.         # Construct the new ModelState
493.         return cls(
494.             model._meta.app_label,
495.             model._meta.object_name,
496.             fields,
497.             options,
498.             bases,
499.             managers,
500.         )


File: tests/migrations/test_commands.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import unicode_literals
3. 
4. import datetime
5. import importlib
6. import io
7. import os
8. import sys
9. 
10. from django.apps import apps
11. from django.core.management import CommandError, call_command
12. from django.db import (
13.     ConnectionHandler, DatabaseError, connection, connections, models,
14. )
15. from django.db.migrations.exceptions import (
16.     InconsistentMigrationHistory, MigrationSchemaMissing,
17. )
18. from django.db.migrations.recorder import MigrationRecorder
19. from django.test import ignore_warnings, mock, override_settings
20. from django.utils import six
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.encoding import force_text
23. 
24. from .models import UnicodeModel, UnserializableModel
25. from .routers import TestRouter
26. from .test_base import MigrationTestBase
27. 
28. 
29. class MigrateTests(MigrationTestBase):
30.     """
31.     Tests running the migrate command.
32.     """
33.     multi_db = True
34. 
35.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
36.     def test_migrate(self):
37.         """
38.         Tests basic usage of the migrate command.
39.         """
40.         # Make sure no tables are created
41.         self.assertTableNotExists("migrations_author")
42.         self.assertTableNotExists("migrations_tribble")
43.         self.assertTableNotExists("migrations_book")
44.         # Run the migrations to 0001 only
45.         call_command("migrate", "migrations", "0001", verbosity=0)
46.         # Make sure the right tables exist
47.         self.assertTableExists("migrations_author")
48.         self.assertTableExists("migrations_tribble")
49.         self.assertTableNotExists("migrations_book")
50.         # Run migrations all the way
51.         call_command("migrate", verbosity=0)
52.         # Make sure the right tables exist
53.         self.assertTableExists("migrations_author")
54.         self.assertTableNotExists("migrations_tribble")
55.         self.assertTableExists("migrations_book")
56.         # Unmigrate everything
57.         call_command("migrate", "migrations", "zero", verbosity=0)
58.         # Make sure it's all gone
59.         self.assertTableNotExists("migrations_author")
60.         self.assertTableNotExists("migrations_tribble")
61.         self.assertTableNotExists("migrations_book")
62. 
63.     @override_settings(INSTALLED_APPS=[
64.         'django.contrib.auth',
65.         'django.contrib.contenttypes',
66.         'migrations.migrations_test_apps.migrated_app',
67.     ])
68.     def test_migrate_with_system_checks(self):
69.         out = six.StringIO()
70.         call_command('migrate', skip_checks=False, no_color=True, stdout=out)
71.         self.assertIn('Apply all migrations: migrated_app', out.getvalue())
72. 
73.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})
74.     def test_migrate_initial_false(self):
75.         """
76.         `Migration.initial = False` skips fake-initial detection.
77.         """
78.         # Make sure no tables are created
79.         self.assertTableNotExists("migrations_author")
80.         self.assertTableNotExists("migrations_tribble")
81.         # Run the migrations to 0001 only
82.         call_command("migrate", "migrations", "0001", verbosity=0)
83.         # Fake rollback
84.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
85.         # Make sure fake-initial detection does not run
86.         with self.assertRaises(DatabaseError):
87.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)
88. 
89.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)
90.         # Real rollback
91.         call_command("migrate", "migrations", "zero", verbosity=0)
92.         # Make sure it's all gone
93.         self.assertTableNotExists("migrations_author")
94.         self.assertTableNotExists("migrations_tribble")
95.         self.assertTableNotExists("migrations_book")
96. 
97.     @override_settings(
98.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
99.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
100.     )
101.     def test_migrate_fake_initial(self):
102.         """
103.         --fake-initial only works if all tables created in the initial
104.         migration of an app exists. Database routers must be obeyed when doing
105.         that check.
106.         """
107.         # Make sure no tables are created
108.         for db in connections:
109.             self.assertTableNotExists("migrations_author", using=db)
110.             self.assertTableNotExists("migrations_tribble", using=db)
111.         # Run the migrations to 0001 only
112.         call_command("migrate", "migrations", "0001", verbosity=0)
113.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
114.         # Make sure the right tables exist
115.         self.assertTableExists("migrations_author")
116.         self.assertTableNotExists("migrations_tribble")
117.         # Also check the "other" database
118.         self.assertTableNotExists("migrations_author", using="other")
119.         self.assertTableExists("migrations_tribble", using="other")
120. 
121.         # Fake a roll-back
122.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
123.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
124.         # Make sure the tables still exist
125.         self.assertTableExists("migrations_author")
126.         self.assertTableExists("migrations_tribble", using="other")
127.         # Try to run initial migration
128.         with self.assertRaises(DatabaseError):
129.             call_command("migrate", "migrations", "0001", verbosity=0)
130.         # Run initial migration with an explicit --fake-initial
131.         out = six.StringIO()
132.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
133.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
134.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
135.         self.assertIn(
136.             "migrations.0001_initial... faked",
137.             out.getvalue().lower()
138.         )
139.         # Run migrations all the way
140.         call_command("migrate", verbosity=0)
141.         call_command("migrate", verbosity=0, database="other")
142.         # Make sure the right tables exist
143.         self.assertTableExists("migrations_author")
144.         self.assertTableNotExists("migrations_tribble")
145.         self.assertTableExists("migrations_book")
146.         self.assertTableNotExists("migrations_author", using="other")
147.         self.assertTableNotExists("migrations_tribble", using="other")
148.         self.assertTableNotExists("migrations_book", using="other")
149.         # Fake a roll-back
150.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
151.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
152.         # Make sure the tables still exist
153.         self.assertTableExists("migrations_author")
154.         self.assertTableNotExists("migrations_tribble")
155.         self.assertTableExists("migrations_book")
156.         # Try to run initial migration
157.         with self.assertRaises(DatabaseError):
158.             call_command("migrate", "migrations", verbosity=0)
159.         # Run initial migration with an explicit --fake-initial
160.         with self.assertRaises(DatabaseError):
161.             # Fails because "migrations_tribble" does not exist but needs to in
162.             # order to make --fake-initial work.
163.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
164.         # Fake a apply
165.         call_command("migrate", "migrations", fake=True, verbosity=0)
166.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
167.         # Unmigrate everything
168.         call_command("migrate", "migrations", "zero", verbosity=0)
169.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
170.         # Make sure it's all gone
171.         for db in connections:
172.             self.assertTableNotExists("migrations_author", using=db)
173.             self.assertTableNotExists("migrations_tribble", using=db)
174.             self.assertTableNotExists("migrations_book", using=db)
175. 
176.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})
177.     def test_migrate_fake_split_initial(self):
178.         """
179.         Split initial migrations can be faked with --fake-initial.
180.         """
181.         call_command("migrate", "migrations", "0002", verbosity=0)
182.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
183.         out = six.StringIO()
184.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
185.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)
186.         value = out.getvalue().lower()
187.         self.assertIn("migrations.0001_initial... faked", value)
188.         self.assertIn("migrations.0002_second... faked", value)
189.         # Fake an apply
190.         call_command("migrate", "migrations", fake=True, verbosity=0)
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193. 
194.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})
195.     def test_migrate_conflict_exit(self):
196.         """
197.         Makes sure that migrate exits if it detects a conflict.
198.         """
199.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):
200.             call_command("migrate", "migrations")
201. 
202.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
203.     def test_showmigrations_list(self):
204.         """
205.         Tests --list output of showmigrations command
206.         """
207.         out = six.StringIO()
208.         with mock.patch('django.core.management.color.supports_color', lambda *args: True):
209.             call_command("showmigrations", format='list', stdout=out, verbosity=0, no_color=False)
210.         self.assertEqual(
211.             '\x1b[1mmigrations\n\x1b[0m'
212.             ' [ ] 0001_initial\n'
213.             ' [ ] 0002_second\n',
214.             out.getvalue().lower()
215.         )
216. 
217.         call_command("migrate", "migrations", "0001", verbosity=0)
218. 
219.         out = six.StringIO()
220.         # Giving the explicit app_label tests for selective `show_list` in the command
221.         call_command("showmigrations", "migrations", format='list', stdout=out, verbosity=0, no_color=True)
222.         self.assertEqual(
223.             'migrations\n'
224.             ' [x] 0001_initial\n'
225.             ' [ ] 0002_second\n',
226.             out.getvalue().lower()
227.         )
228.         # Cleanup by unmigrating everything
229.         call_command("migrate", "migrations", "zero", verbosity=0)
230. 
231.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})
232.     def test_showmigrations_plan(self):
233.         """
234.         Tests --plan output of showmigrations command
235.         """
236.         out = six.StringIO()
237.         call_command("showmigrations", format='plan', stdout=out)
238.         self.assertEqual(
239.             "[ ]  migrations.0001_initial\n"
240.             "[ ]  migrations.0003_third\n"
241.             "[ ]  migrations.0002_second\n",
242.             out.getvalue().lower()
243.         )
244. 
245.         out = six.StringIO()
246.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
247.         self.assertEqual(
248.             "[ ]  migrations.0001_initial\n"
249.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\n"
250.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
251.             out.getvalue().lower()
252.         )
253.         call_command("migrate", "migrations", "0003", verbosity=0)
254. 
255.         out = six.StringIO()
256.         call_command("showmigrations", format='plan', stdout=out)
257.         self.assertEqual(
258.             "[x]  migrations.0001_initial\n"
259.             "[x]  migrations.0003_third\n"
260.             "[ ]  migrations.0002_second\n",
261.             out.getvalue().lower()
262.         )
263. 
264.         out = six.StringIO()
265.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
266.         self.assertEqual(
267.             "[x]  migrations.0001_initial\n"
268.             "[x]  migrations.0003_third ... (migrations.0001_initial)\n"
269.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
270.             out.getvalue().lower()
271.         )
272. 
273.         # Cleanup by unmigrating everything
274.         call_command("migrate", "migrations", "zero", verbosity=0)
275. 
276.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})
277.     def test_showmigrations_plan_no_migrations(self):
278.         """
279.         Tests --plan output of showmigrations command without migrations
280.         """
281.         out = six.StringIO()
282.         call_command("showmigrations", format='plan', stdout=out)
283.         self.assertEqual("", out.getvalue().lower())
284. 
285.         out = six.StringIO()
286.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
287.         self.assertEqual("", out.getvalue().lower())
288. 
289.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})
290.     def test_showmigrations_plan_squashed(self):
291.         """
292.         Tests --plan output of showmigrations command with squashed migrations.
293.         """
294.         out = six.StringIO()
295.         call_command("showmigrations", format='plan', stdout=out)
296.         self.assertEqual(
297.             "[ ]  migrations.1_auto\n"
298.             "[ ]  migrations.2_auto\n"
299.             "[ ]  migrations.3_squashed_5\n"
300.             "[ ]  migrations.6_auto\n"
301.             "[ ]  migrations.7_auto\n",
302.             out.getvalue().lower()
303.         )
304. 
305.         out = six.StringIO()
306.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
307.         self.assertEqual(
308.             "[ ]  migrations.1_auto\n"
309.             "[ ]  migrations.2_auto ... (migrations.1_auto)\n"
310.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
311.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
312.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
313.             out.getvalue().lower()
314.         )
315. 
316.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)
317. 
318.         out = six.StringIO()
319.         call_command("showmigrations", format='plan', stdout=out)
320.         self.assertEqual(
321.             "[x]  migrations.1_auto\n"
322.             "[x]  migrations.2_auto\n"
323.             "[x]  migrations.3_squashed_5\n"
324.             "[ ]  migrations.6_auto\n"
325.             "[ ]  migrations.7_auto\n",
326.             out.getvalue().lower()
327.         )
328. 
329.         out = six.StringIO()
330.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
331.         self.assertEqual(
332.             "[x]  migrations.1_auto\n"
333.             "[x]  migrations.2_auto ... (migrations.1_auto)\n"
334.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
335.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
336.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
337.             out.getvalue().lower()
338.         )
339. 
340.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
341.     def test_sqlmigrate_forwards(self):
342.         """
343.         Makes sure that sqlmigrate does something.
344.         """
345.         out = six.StringIO()
346.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
347.         output = out.getvalue().lower()
348. 
349.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
350.         index_op_desc_author = output.find('-- create model author')
351.         index_create_table = output.find('create table')
352.         index_op_desc_tribble = output.find('-- create model tribble')
353.         index_op_desc_unique_together = output.find('-- alter unique_together')
354.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
355. 
356.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
357.         self.assertGreater(
358.             index_op_desc_author, index_tx_start,
359.             "Operation description (author) not found or found before transaction start"
360.         )
361.         self.assertGreater(
362.             index_create_table, index_op_desc_author,
363.             "CREATE TABLE not found or found before operation description (author)"
364.         )
365.         self.assertGreater(
366.             index_op_desc_tribble, index_create_table,
367.             "Operation description (tribble) not found or found before CREATE TABLE (author)"
368.         )
369.         self.assertGreater(
370.             index_op_desc_unique_together, index_op_desc_tribble,
371.             "Operation description (unique_together) not found or found before operation description (tribble)"
372.         )
373.         self.assertGreater(
374.             index_tx_end, index_op_desc_unique_together,
375.             "Transaction end not found or found before operation description (unique_together)"
376.         )
377. 
378.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
379.     def test_sqlmigrate_backwards(self):
380.         """
381.         Makes sure that sqlmigrate does something.
382.         """
383.         # Cannot generate the reverse SQL unless we've applied the migration.
384.         call_command("migrate", "migrations", verbosity=0)
385. 
386.         out = six.StringIO()
387.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)
388.         output = out.getvalue().lower()
389. 
390.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
391.         index_op_desc_unique_together = output.find('-- alter unique_together')
392.         index_op_desc_tribble = output.find('-- create model tribble')
393.         index_op_desc_author = output.find('-- create model author')
394.         index_drop_table = output.rfind('drop table')
395.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
396. 
397.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
398.         self.assertGreater(
399.             index_op_desc_unique_together, index_tx_start,
400.             "Operation description (unique_together) not found or found before transaction start"
401.         )
402.         self.assertGreater(
403.             index_op_desc_tribble, index_op_desc_unique_together,
404.             "Operation description (tribble) not found or found before operation description (unique_together)"
405.         )
406.         self.assertGreater(
407.             index_op_desc_author, index_op_desc_tribble,
408.             "Operation description (author) not found or found before operation description (tribble)"
409.         )
410. 
411.         self.assertGreater(
412.             index_drop_table, index_op_desc_author,
413.             "DROP TABLE not found or found before operation description (author)"
414.         )
415.         self.assertGreater(
416.             index_tx_end, index_op_desc_unique_together,
417.             "Transaction end not found or found before DROP TABLE"
418.         )
419. 
420.         # Cleanup by unmigrating everything
421.         call_command("migrate", "migrations", "zero", verbosity=0)
422. 
423.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})
424.     def test_sqlmigrate_for_non_atomic_migration(self):
425.         """
426.         Transaction wrappers aren't shown for non-atomic migrations.
427.         """
428.         out = six.StringIO()
429.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
430.         output = out.getvalue().lower()
431.         queries = [q.strip() for q in output.splitlines()]
432.         if connection.ops.start_transaction_sql():
433.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)
434.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)
435. 
436.     @override_settings(
437.         INSTALLED_APPS=[
438.             "migrations.migrations_test_apps.migrated_app",
439.             "migrations.migrations_test_apps.migrated_unapplied_app",
440.             "migrations.migrations_test_apps.unmigrated_app"])
441.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):
442.         """
443.         https://code.djangoproject.com/ticket/22823
444. 
445.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:
446. 
447.         * `A` has migrations
448.         * `B` has a migration we want to apply
449.         * `C` has no migrations, but has an FK to `A`
450. 
451.         When we try to migrate "B", an exception occurs because the
452.         "B" was not included in the ProjectState that is used to detect
453.         soft-applied migrations.
454.         """
455.         call_command("migrate", "migrated_unapplied_app", stdout=six.StringIO())
456. 
457.         # unmigrated_app.SillyModel has a foreign key to 'migrations.Tribble',
458.         # but that model is only defined in a migration, so the global app
459.         # registry never sees it and the reference is left dangling. Remove it
460.         # to avoid problems in subsequent tests.
461.         del apps._pending_operations[('migrations', 'tribble')]
462. 
463.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
464.     def test_migrate_record_replaced(self):
465.         """
466.         Running a single squashed migration should record all of the original
467.         replaced migrations as run.
468.         """
469.         recorder = MigrationRecorder(connection)
470.         out = six.StringIO()
471.         call_command("migrate", "migrations", verbosity=0)
472.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
473.         self.assertEqual(
474.             'migrations\n'
475.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
476.             out.getvalue().lower()
477.         )
478.         applied_migrations = recorder.applied_migrations()
479.         self.assertIn(("migrations", "0001_initial"), applied_migrations)
480.         self.assertIn(("migrations", "0002_second"), applied_migrations)
481.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)
482.         # Rollback changes
483.         call_command("migrate", "migrations", "zero", verbosity=0)
484. 
485.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
486.     def test_migrate_record_squashed(self):
487.         """
488.         Running migrate for a squashed migration should record as run
489.         if all of the replaced migrations have been run (#25231).
490.         """
491.         recorder = MigrationRecorder(connection)
492.         recorder.record_applied("migrations", "0001_initial")
493.         recorder.record_applied("migrations", "0002_second")
494.         out = six.StringIO()
495.         call_command("migrate", "migrations", verbosity=0)
496.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
497.         self.assertEqual(
498.             'migrations\n'
499.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
500.             out.getvalue().lower()


File: tests/migrations/test_multidb.py
Line number range: 1 - 174
Content:
1. import unittest
2. 
3. from django.db import connection, migrations, models
4. from django.db.migrations.state import ProjectState
5. from django.test import override_settings
6. 
7. from .test_operations import OperationTestBase
8. 
9. try:
10.     import sqlparse
11. except ImportError:
12.     sqlparse = None
13. 
14. 
15. class AgnosticRouter(object):
16.     """
17.     A router that doesn't have an opinion regarding migrating.
18.     """
19.     def allow_migrate(self, db, app_label, **hints):
20.         return None
21. 
22. 
23. class MigrateNothingRouter(object):
24.     """
25.     A router that doesn't allow migrating.
26.     """
27.     def allow_migrate(self, db, app_label, **hints):
28.         return False
29. 
30. 
31. class MigrateEverythingRouter(object):
32.     """
33.     A router that always allows migrating.
34.     """
35.     def allow_migrate(self, db, app_label, **hints):
36.         return True
37. 
38. 
39. class MigrateWhenFooRouter(object):
40.     """
41.     A router that allows migrating depending on a hint.
42.     """
43.     def allow_migrate(self, db, app_label, **hints):
44.         return hints.get('foo', False)
45. 
46. 
47. class MultiDBOperationTests(OperationTestBase):
48.     multi_db = True
49. 
50.     def _test_create_model(self, app_label, should_run):
51.         """
52.         Tests that CreateModel honours multi-db settings.
53.         """
54.         operation = migrations.CreateModel(
55.             "Pony",
56.             [("id", models.AutoField(primary_key=True))],
57.         )
58.         # Test the state alteration
59.         project_state = ProjectState()
60.         new_state = project_state.clone()
61.         operation.state_forwards(app_label, new_state)
62.         # Test the database alteration
63.         self.assertTableNotExists("%s_pony" % app_label)
64.         with connection.schema_editor() as editor:
65.             operation.database_forwards(app_label, editor, project_state, new_state)
66.         if should_run:
67.             self.assertTableExists("%s_pony" % app_label)
68.         else:
69.             self.assertTableNotExists("%s_pony" % app_label)
70.         # And test reversal
71.         with connection.schema_editor() as editor:
72.             operation.database_backwards(app_label, editor, new_state, project_state)
73.         self.assertTableNotExists("%s_pony" % app_label)
74. 
75.     @override_settings(DATABASE_ROUTERS=[AgnosticRouter()])
76.     def test_create_model(self):
77.         """
78.         Test when router doesn't have an opinion (i.e. CreateModel should run).
79.         """
80.         self._test_create_model("test_mltdb_crmo", should_run=True)
81. 
82.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
83.     def test_create_model2(self):
84.         """
85.         Test when router returns False (i.e. CreateModel shouldn't run).
86.         """
87.         self._test_create_model("test_mltdb_crmo2", should_run=False)
88. 
89.     @override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()])
90.     def test_create_model3(self):
91.         """
92.         Test when router returns True (i.e. CreateModel should run).
93.         """
94.         self._test_create_model("test_mltdb_crmo3", should_run=True)
95. 
96.     def test_create_model4(self):
97.         """
98.         Test multiple routers.
99.         """
100.         with override_settings(DATABASE_ROUTERS=[AgnosticRouter(), AgnosticRouter()]):
101.             self._test_create_model("test_mltdb_crmo4", should_run=True)
102.         with override_settings(DATABASE_ROUTERS=[MigrateNothingRouter(), MigrateEverythingRouter()]):
103.             self._test_create_model("test_mltdb_crmo4", should_run=False)
104.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter(), MigrateNothingRouter()]):
105.             self._test_create_model("test_mltdb_crmo4", should_run=True)
106. 
107.     def _test_run_sql(self, app_label, should_run, hints=None):
108.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()]):
109.             project_state = self.set_up_test_model(app_label)
110. 
111.         sql = """
112.         INSERT INTO {0}_pony (pink, weight) VALUES (1, 3.55);
113.         INSERT INTO {0}_pony (pink, weight) VALUES (3, 5.0);
114.         """.format(app_label)
115. 
116.         operation = migrations.RunSQL(sql, hints=hints or {})
117.         # Test the state alteration does nothing
118.         new_state = project_state.clone()
119.         operation.state_forwards(app_label, new_state)
120.         self.assertEqual(new_state, project_state)
121.         # Test the database alteration
122.         self.assertEqual(project_state.apps.get_model(app_label, "Pony").objects.count(), 0)
123.         with connection.schema_editor() as editor:
124.             operation.database_forwards(app_label, editor, project_state, new_state)
125.         Pony = project_state.apps.get_model(app_label, "Pony")
126.         if should_run:
127.             self.assertEqual(Pony.objects.count(), 2)
128.         else:
129.             self.assertEqual(Pony.objects.count(), 0)
130. 
131.     @unittest.skipIf(sqlparse is None and connection.features.requires_sqlparse_for_splitting, "Missing sqlparse")
132.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
133.     def test_run_sql(self):
134.         self._test_run_sql("test_mltdb_runsql", should_run=False)
135. 
136.     @unittest.skipIf(sqlparse is None and connection.features.requires_sqlparse_for_splitting, "Missing sqlparse")
137.     @override_settings(DATABASE_ROUTERS=[MigrateWhenFooRouter()])
138.     def test_run_sql2(self):
139.         self._test_run_sql("test_mltdb_runsql2", should_run=False)
140.         self._test_run_sql("test_mltdb_runsql2", should_run=True, hints={'foo': True})
141. 
142.     def _test_run_python(self, app_label, should_run, hints=None):
143.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()]):
144.             project_state = self.set_up_test_model(app_label)
145. 
146.         # Create the operation
147.         def inner_method(models, schema_editor):
148.             Pony = models.get_model(app_label, "Pony")
149.             Pony.objects.create(pink=1, weight=3.55)
150.             Pony.objects.create(weight=5)
151. 
152.         operation = migrations.RunPython(inner_method, hints=hints or {})
153.         # Test the state alteration does nothing
154.         new_state = project_state.clone()
155.         operation.state_forwards(app_label, new_state)
156.         self.assertEqual(new_state, project_state)
157.         # Test the database alteration
158.         self.assertEqual(project_state.apps.get_model(app_label, "Pony").objects.count(), 0)
159.         with connection.schema_editor() as editor:
160.             operation.database_forwards(app_label, editor, project_state, new_state)
161.         Pony = project_state.apps.get_model(app_label, "Pony")
162.         if should_run:
163.             self.assertEqual(Pony.objects.count(), 2)
164.         else:
165.             self.assertEqual(Pony.objects.count(), 0)
166. 
167.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
168.     def test_run_python(self):
169.         self._test_run_python("test_mltdb_runpython", should_run=False)
170. 
171.     @override_settings(DATABASE_ROUTERS=[MigrateWhenFooRouter()])
172.     def test_run_python2(self):
173.         self._test_run_python("test_mltdb_runpython2", should_run=False)
174.         self._test_run_python("test_mltdb_runpython2", should_run=True, hints={'foo': True})

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 17:15:23,501 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user requested the full content of this file. This context provides the entire content of 'django/core/management/commands/makemigrations.py' as seen in the input.", relative_path='django/core/management/commands/makemigrations.py', start_line=1, end_line=322), ContextOutput(reasoning="The user requested the full content of this file. This context provides the entire content of 'tests/migrations/test_commands.py' as seen in the input.", relative_path='tests/migrations/test_commands.py', start_line=1, end_line=500), ContextOutput(reasoning="The user requested the full content of this file. This context provides the entire content of 'tests/migrations/test_multidb.py' as seen in the input.", relative_path='tests/migrations/test_multidb.py', start_line=1, end_line=174)]
2025-12-24 17:15:23,503 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.
2025-12-24 17:15:23,504 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 17:15:23,504 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 17:15:23,504 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 0 existing contexts
2025-12-24 17:15:23,504 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-24 17:15:23,506 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_static.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── registration
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   └── utils.py
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── libgeoip.py
|   |   |   |   └── prototypes.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backend
|   |   |   |   └── regex.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   ├── srs.py
|   |   |   |   └── wkt.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── locale
|   |   |   |   ├── ar
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── he
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── id
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── signals.py
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── staticfiles.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   ├── __init__.py
|   |   |   |   ├── django_1_10.py
|   |   |   |   └── django_1_8_0.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── urls.py
|   |   |   └── utils.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── urlresolvers.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── version.py
|   |   |   ├── postgresql_psycopg2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── version.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   └── special.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── topological_sort.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── datetime.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   ├── license.txt
|   |   └── weakref_backports.py
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── extras
|   |   |   ├── __init__.py
|   |   |   └── widgets.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── models.py
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── eggs.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── glob.py
|   |   ├── html.py
|   |   ├── html_parser.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── lru_cache.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── six.py
|   |   ├── synch.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       └── static.py
├── docs
|   ├── _ext
|   |   ├── cve_role.py
|   |   ├── djangodocs.py
|   |   └── ticket_role.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   ├── roles.txt
|   |   ├── security.txt
|   |   └── team.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   ├── language.txt
|   |   |   └── upgrading.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── python3.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   ├── jsi18n-mocks.test.js
|   |   └── timeparse.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── blanket.js
|   |   ├── grunt-reporter.js
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_adminsite.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   └── with_integer_username.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_auth_backends_deprecation.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_deprecated_views.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   ├── urls_custom_user_admin.py
    |   └── urls_deprecated.py
    ├── backends
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_creation.py
    |   ├── test_features.py
    |   ├── test_mysql.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   ├── tests_1_10_compatibility.py
    |   ├── tests_1_8_compatibility.py
    |   └── urls
    |       ├── __init__.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       └── warning_in_include.py
    ├── choices
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_models.py
    |   ├── test_order_with_respect_to.py
    |   ├── tests.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── test_context_processor.py
    |   └── tests.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_cast.py
    |   ├── test_datetime.py
    |   └── tests.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   └── test_postgresql_psycopg2.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       └── article_form.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_geoforms.py
    |   ├── test_geoip.py
    |   ├── test_geoip2.py
    |   ├── test_measure.py
    |   ├── test_spatialrefsys.py
    |   ├── test_wkt.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── test_legacy.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_permalink
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_array.py
    |   ├── test_citext.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_json.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── base.txt
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   ├── py2.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   └── urls
    |       ├── __init__.py
    |       ├── http.py
    |       └── https.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_i18n.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   └── testtags.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── test_unicode.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   └── password_change_form.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_discovery_sample
    |   ├── __init__.py
    |   ├── doctests.py
    |   ├── empty.py
    |   ├── pattern_tests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tests_sample.py
    ├── test_discovery_sample2
    |   ├── __init__.py
    |   └── tests.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── tests.py
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_full_import.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── leave_locale_alone_false.py
    |   |       ├── leave_locale_alone_true.py
    |   |       ├── reverse_url.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── locale
    |   |   └── nl
    |   |       └── LC_MESSAGES
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_deprecation.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_glob.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_itercompat.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   └── test_tree.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── file.txt
    |   |   └── long-line.txt
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   ├── debug
    |   |   |   └── template_exception.html
    |   |   ├── jsi18n-multi-catalogs.html
    |   |   ├── jsi18n.html
    |   |   ├── old_jsi18n-multi-catalogs.html
    |   |   └── old_jsi18n.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── py3_test_debug.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_i18n_deprecated.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: makemigrations router.allow_migrate() calls for consistency checks use incorrect (app_label, model) pairs

Description: Description
	
As reported in ticket:27200#comment:14, I makemigrations incorrectly calls allow_migrate() for each app with all the models in the project rather than for each app with the app's models. It broke the router I use because it was passing invalid combinations for shards since not all shards have the same models.
[​​https://github.com/django/django/pull/7530 PR]

Patch information:
diff --git a/django/core/management/commands/makemigrations.py b/django/core/management/commands/makemigrations.py
index 0b39536f5b..e648880ef0 100644
--- a/django/core/management/commands/makemigrations.py
+++ b/django/core/management/commands/makemigrations.py
@@ -105,7 +105,7 @@ class Command(BaseCommand):
                     # At least one model must be migrated to the database.
                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
                     for app_label in consistency_check_labels
-                    for model in apps.get_models(app_label)
+                    for model in apps.get_app_config(app_label).get_models()
             )):
                 loader.check_consistent_history(connection)
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.
Extra Requirements: 
Purpose: These files are essential to understand the `makemigrations` command and find existing tests that cover scenarios with database routers and multiple applications, which is where the bug occurs.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: django/core/management/commands/makemigrations.py
Line number range: 1 - 322
Content:
1. import io
2. import os
3. import sys
4. import warnings
5. from itertools import takewhile
6. 
7. from django.apps import apps
8. from django.conf import settings
9. from django.core.management.base import BaseCommand, CommandError
10. from django.db import DEFAULT_DB_ALIAS, connections, router
11. from django.db.migrations import Migration
12. from django.db.migrations.autodetector import MigrationAutodetector
13. from django.db.migrations.loader import MigrationLoader
14. from django.db.migrations.questioner import (
15.     InteractiveMigrationQuestioner, MigrationQuestioner,
16.     NonInteractiveMigrationQuestioner,
17. )
18. from django.db.migrations.state import ProjectState
19. from django.db.migrations.utils import get_migration_name_timestamp
20. from django.db.migrations.writer import MigrationWriter
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.six import iteritems
23. from django.utils.six.moves import zip
24. 
25. 
26. class Command(BaseCommand):
27.     help = "Creates new migration(s) for apps."
28. 
29.     def add_arguments(self, parser):
30.         parser.add_argument(
31.             'args', metavar='app_label', nargs='*',
32.             help='Specify the app label(s) to create migrations for.',
33.         )
34.         parser.add_argument(
35.             '--dry-run', action='store_true', dest='dry_run', default=False,
36.             help="Just show what migrations would be made; don't actually write them.",
37.         )
38.         parser.add_argument(
39.             '--merge', action='store_true', dest='merge', default=False,
40.             help="Enable fixing of migration conflicts.",
41.         )
42.         parser.add_argument(
43.             '--empty', action='store_true', dest='empty', default=False,
44.             help="Create an empty migration.",
45.         )
46.         parser.add_argument(
47.             '--noinput', '--no-input',
48.             action='store_false', dest='interactive', default=True,
49.             help='Tells Django to NOT prompt the user for input of any kind.',
50.         )
51.         parser.add_argument(
52.             '-n', '--name', action='store', dest='name', default=None,
53.             help="Use this name for migration file(s).",
54.         )
55.         parser.add_argument(
56.             '-e', '--exit', action='store_true', dest='exit_code', default=False,
57.             help='Exit with error code 1 if no changes needing migrations are found. '
58.                  'Deprecated, use the --check option instead.',
59.         )
60.         parser.add_argument(
61.             '--check', action='store_true', dest='check_changes',
62.             help='Exit with a non-zero status if model changes are missing migrations.',
63.         )
64. 
65.     def handle(self, *app_labels, **options):
66.         self.verbosity = options['verbosity']
67.         self.interactive = options['interactive']
68.         self.dry_run = options['dry_run']
69.         self.merge = options['merge']
70.         self.empty = options['empty']
71.         self.migration_name = options['name']
72.         self.exit_code = options['exit_code']
73.         check_changes = options['check_changes']
74. 
75.         if self.exit_code:
76.             warnings.warn(
77.                 "The --exit option is deprecated in favor of the --check option.",
78.                 RemovedInDjango20Warning
79.             )
80. 
81.         # Make sure the app they asked for exists
82.         app_labels = set(app_labels)
83.         bad_app_labels = set()
84.         for app_label in app_labels:
85.             try:
86.                 apps.get_app_config(app_label)
87.             except LookupError:
88.                 bad_app_labels.add(app_label)
89.         if bad_app_labels:
90.             for app_label in bad_app_labels:
91.                 self.stderr.write("App '%s' could not be found. Is it in INSTALLED_APPS?" % app_label)
92.             sys.exit(2)
93. 
94.         # Load the current graph state. Pass in None for the connection so
95.         # the loader doesn't try to resolve replaced migrations from DB.
96.         loader = MigrationLoader(None, ignore_no_migrations=True)
97. 
98.         # Raise an error if any migrations are applied before their dependencies.
99.         consistency_check_labels = set(config.label for config in apps.get_app_configs())
100.         # Non-default databases are only checked if database routers used.
101.         aliases_to_check = connections if settings.DATABASE_ROUTERS else [DEFAULT_DB_ALIAS]
102.         for alias in sorted(aliases_to_check):
103.             connection = connections[alias]
104.             if (connection.settings_dict['ENGINE'] != 'django.db.backends.dummy' and any(
105.                     # At least one model must be migrated to the database.
106.                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
107.                     for app_label in consistency_check_labels
108.                     for model in apps.get_models(app_label)
109.             )):
110.                 loader.check_consistent_history(connection)
111. 
112.         # Before anything else, see if there's conflicting apps and drop out
113.         # hard if there are any and they don't want to merge
114.         conflicts = loader.detect_conflicts()
115. 
116.         # If app_labels is specified, filter out conflicting migrations for unspecified apps
117.         if app_labels:
118.             conflicts = {
119.                 app_label: conflict for app_label, conflict in iteritems(conflicts)
120.                 if app_label in app_labels
121.             }
122. 
123.         if conflicts and not self.merge:
124.             name_str = "; ".join(
125.                 "%s in %s" % (", ".join(names), app)
126.                 for app, names in conflicts.items()
127.             )
128.             raise CommandError(
129.                 "Conflicting migrations detected; multiple leaf nodes in the "
130.                 "migration graph: (%s).\nTo fix them run "
131.                 "'python manage.py makemigrations --merge'" % name_str
132.             )
133. 
134.         # If they want to merge and there's nothing to merge, then politely exit
135.         if self.merge and not conflicts:
136.             self.stdout.write("No conflicts detected to merge.")
137.             return
138. 
139.         # If they want to merge and there is something to merge, then
140.         # divert into the merge code
141.         if self.merge and conflicts:
142.             return self.handle_merge(loader, conflicts)
143. 
144.         if self.interactive:
145.             questioner = InteractiveMigrationQuestioner(specified_apps=app_labels, dry_run=self.dry_run)
146.         else:
147.             questioner = NonInteractiveMigrationQuestioner(specified_apps=app_labels, dry_run=self.dry_run)
148.         # Set up autodetector
149.         autodetector = MigrationAutodetector(
150.             loader.project_state(),
151.             ProjectState.from_apps(apps),
152.             questioner,
153.         )
154. 
155.         # If they want to make an empty migration, make one for each app
156.         if self.empty:
157.             if not app_labels:
158.                 raise CommandError("You must supply at least one app label when using --empty.")
159.             # Make a fake changes() result we can pass to arrange_for_graph
160.             changes = {
161.                 app: [Migration("custom", app)]
162.                 for app in app_labels
163.             }
164.             changes = autodetector.arrange_for_graph(
165.                 changes=changes,
166.                 graph=loader.graph,
167.                 migration_name=self.migration_name,
168.             )
169.             self.write_migration_files(changes)
170.             return
171. 
172.         # Detect changes
173.         changes = autodetector.changes(
174.             graph=loader.graph,
175.             trim_to_apps=app_labels or None,
176.             convert_apps=app_labels or None,
177.             migration_name=self.migration_name,
178.         )
179. 
180.         if not changes:
181.             # No changes? Tell them.
182.             if self.verbosity >= 1:
183.                 if len(app_labels) == 1:
184.                     self.stdout.write("No changes detected in app '%s'" % app_labels.pop())
185.                 elif len(app_labels) > 1:
186.                     self.stdout.write("No changes detected in apps '%s'" % ("', '".join(app_labels)))
187.                 else:
188.                     self.stdout.write("No changes detected")
189. 
190.             if self.exit_code:
191.                 sys.exit(1)
192.         else:
193.             self.write_migration_files(changes)
194.             if check_changes:
195.                 sys.exit(1)
196. 
197.     def write_migration_files(self, changes):
198.         """
199.         Takes a changes dict and writes them out as migration files.
200.         """
201.         directory_created = {}
202.         for app_label, app_migrations in changes.items():
203.             if self.verbosity >= 1:
204.                 self.stdout.write(self.style.MIGRATE_HEADING("Migrations for '%s':" % app_label) + "\n")
205.             for migration in app_migrations:
206.                 # Describe the migration
207.                 writer = MigrationWriter(migration)
208.                 if self.verbosity >= 1:
209.                     # Display a relative path if it's below the current working
210.                     # directory, or an absolute path otherwise.
211.                     try:
212.                         migration_string = os.path.relpath(writer.path)
213.                     except ValueError:
214.                         migration_string = writer.path
215.                     if migration_string.startswith('..'):
216.                         migration_string = writer.path
217.                     self.stdout.write("  %s:\n" % (self.style.MIGRATE_LABEL(migration_string),))
218.                     for operation in migration.operations:
219.                         self.stdout.write("    - %s\n" % operation.describe())
220.                 if not self.dry_run:
221.                     # Write the migrations file to the disk.
222.                     migrations_directory = os.path.dirname(writer.path)
223.                     if not directory_created.get(app_label):
224.                         if not os.path.isdir(migrations_directory):
225.                             os.mkdir(migrations_directory)
226.                         init_path = os.path.join(migrations_directory, "__init__.py")
227.                         if not os.path.isfile(init_path):
228.                             open(init_path, "w").close()
229.                         # We just do this once per app
230.                         directory_created[app_label] = True
231.                     migration_string = writer.as_string()
232.                     with io.open(writer.path, "w", encoding='utf-8') as fh:
233.                         fh.write(migration_string)
234.                 elif self.verbosity == 3:
235.                     # Alternatively, makemigrations --dry-run --verbosity 3
236.                     # will output the migrations to stdout rather than saving
237.                     # the file to the disk.
238.                     self.stdout.write(self.style.MIGRATE_HEADING(
239.                         "Full migrations file '%s':" % writer.filename) + "\n"
240.                     )
241.                     self.stdout.write("%s\n" % writer.as_string())
242. 
243.     def handle_merge(self, loader, conflicts):
244.         """
245.         Handles merging together conflicted migrations interactively,
246.         if it's safe; otherwise, advises on how to fix it.
247.         """
248.         if self.interactive:
249.             questioner = InteractiveMigrationQuestioner()
250.         else:
251.             questioner = MigrationQuestioner(defaults={'ask_merge': True})
252. 
253.         for app_label, migration_names in conflicts.items():
254.             # Grab out the migrations in question, and work out their
255.             # common ancestor.
256.             merge_migrations = []
257.             for migration_name in migration_names:
258.                 migration = loader.get_migration(app_label, migration_name)
259.                 migration.ancestry = [
260.                     mig for mig in loader.graph.forwards_plan((app_label, migration_name))
261.                     if mig[0] == migration.app_label
262.                 ]
263.                 merge_migrations.append(migration)
264. 
265.             def all_items_equal(seq):
266.                 return all(item == seq[0] for item in seq[1:])
267. 
268.             merge_migrations_generations = zip(*[m.ancestry for m in merge_migrations])
269.             common_ancestor_count = sum(1 for common_ancestor_generation
270.                                         in takewhile(all_items_equal, merge_migrations_generations))
271.             if not common_ancestor_count:
272.                 raise ValueError("Could not find common ancestor of %s" % migration_names)
273.             # Now work out the operations along each divergent branch
274.             for migration in merge_migrations:
275.                 migration.branch = migration.ancestry[common_ancestor_count:]
276.                 migrations_ops = (loader.get_migration(node_app, node_name).operations
277.                                   for node_app, node_name in migration.branch)
278.                 migration.merged_operations = sum(migrations_ops, [])
279.             # In future, this could use some of the Optimizer code
280.             # (can_optimize_through) to automatically see if they're
281.             # mergeable. For now, we always just prompt the user.
282.             if self.verbosity > 0:
283.                 self.stdout.write(self.style.MIGRATE_HEADING("Merging %s" % app_label))
284.                 for migration in merge_migrations:
285.                     self.stdout.write(self.style.MIGRATE_LABEL("  Branch %s" % migration.name))
286.                     for operation in migration.merged_operations:
287.                         self.stdout.write("    - %s\n" % operation.describe())
288.             if questioner.ask_merge(app_label):
289.                 # If they still want to merge it, then write out an empty
290.                 # file depending on the migrations needing merging.
291.                 numbers = [
292.                     MigrationAutodetector.parse_number(migration.name)
293.                     for migration in merge_migrations
294.                 ]
295.                 try:
296.                     biggest_number = max(x for x in numbers if x is not None)
297.                 except ValueError:
298.                     biggest_number = 1
299.                 subclass = type("Migration", (Migration, ), {
300.                     "dependencies": [(app_label, migration.name) for migration in merge_migrations],
301.                 })
302.                 migration_name = "%04i_%s" % (
303.                     biggest_number + 1,
304.                     self.migration_name or ("merge_%s" % get_migration_name_timestamp())
305.                 )
306.                 new_migration = subclass(migration_name, app_label)
307.                 writer = MigrationWriter(new_migration)
308. 
309.                 if not self.dry_run:
310.                     # Write the merge migrations file to the disk
311.                     with io.open(writer.path, "w", encoding='utf-8') as fh:
312.                         fh.write(writer.as_string())
313.                     if self.verbosity > 0:
314.                         self.stdout.write("\nCreated new merge migration %s" % writer.path)
315.                 elif self.verbosity == 3:
316.                     # Alternatively, makemigrations --merge --dry-run --verbosity 3
317.                     # will output the merge migrations to stdout rather than saving
318.                     # the file to the disk.
319.                     self.stdout.write(self.style.MIGRATE_HEADING(
320.                         "Full merge migrations file '%s':" % writer.filename) + "\n"
321.                     )
322.                     self.stdout.write("%s\n" % writer.as_string())


File: tests/migrations/test_commands.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import unicode_literals
3. 
4. import datetime
5. import importlib
6. import io
7. import os
8. import sys
9. 
10. from django.apps import apps
11. from django.core.management import CommandError, call_command
12. from django.db import (
13.     ConnectionHandler, DatabaseError, connection, connections, models,
14. )
15. from django.db.migrations.exceptions import (
16.     InconsistentMigrationHistory, MigrationSchemaMissing,
17. )
18. from django.db.migrations.recorder import MigrationRecorder
19. from django.test import ignore_warnings, mock, override_settings
20. from django.utils import six
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.encoding import force_text
23. 
24. from .models import UnicodeModel, UnserializableModel
25. from .routers import TestRouter
26. from .test_base import MigrationTestBase
27. 
28. 
29. class MigrateTests(MigrationTestBase):
30.     """
31.     Tests running the migrate command.
32.     """
33.     multi_db = True
34. 
35.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
36.     def test_migrate(self):
37.         """
38.         Tests basic usage of the migrate command.
39.         """
40.         # Make sure no tables are created
41.         self.assertTableNotExists("migrations_author")
42.         self.assertTableNotExists("migrations_tribble")
43.         self.assertTableNotExists("migrations_book")
44.         # Run the migrations to 0001 only
45.         call_command("migrate", "migrations", "0001", verbosity=0)
46.         # Make sure the right tables exist
47.         self.assertTableExists("migrations_author")
48.         self.assertTableExists("migrations_tribble")
49.         self.assertTableNotExists("migrations_book")
50.         # Run migrations all the way
51.         call_command("migrate", verbosity=0)
52.         # Make sure the right tables exist
53.         self.assertTableExists("migrations_author")
54.         self.assertTableNotExists("migrations_tribble")
55.         self.assertTableExists("migrations_book")
56.         # Unmigrate everything
57.         call_command("migrate", "migrations", "zero", verbosity=0)
58.         # Make sure it's all gone
59.         self.assertTableNotExists("migrations_author")
60.         self.assertTableNotExists("migrations_tribble")
61.         self.assertTableNotExists("migrations_book")
62. 
63.     @override_settings(INSTALLED_APPS=[
64.         'django.contrib.auth',
65.         'django.contrib.contenttypes',
66.         'migrations.migrations_test_apps.migrated_app',
67.     ])
68.     def test_migrate_with_system_checks(self):
69.         out = six.StringIO()
70.         call_command('migrate', skip_checks=False, no_color=True, stdout=out)
71.         self.assertIn('Apply all migrations: migrated_app', out.getvalue())
72. 
73.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})
74.     def test_migrate_initial_false(self):
75.         """
76.         `Migration.initial = False` skips fake-initial detection.
77.         """
78.         # Make sure no tables are created
79.         self.assertTableNotExists("migrations_author")
80.         self.assertTableNotExists("migrations_tribble")
81.         # Run the migrations to 0001 only
82.         call_command("migrate", "migrations", "0001", verbosity=0)
83.         # Fake rollback
84.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
85.         # Make sure fake-initial detection does not run
86.         with self.assertRaises(DatabaseError):
87.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)
88. 
89.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)
90.         # Real rollback
91.         call_command("migrate", "migrations", "zero", verbosity=0)
92.         # Make sure it's all gone
93.         self.assertTableNotExists("migrations_author")
94.         self.assertTableNotExists("migrations_tribble")
95.         self.assertTableNotExists("migrations_book")
96. 
97.     @override_settings(
98.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
99.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
100.     )
101.     def test_migrate_fake_initial(self):
102.         """
103.         --fake-initial only works if all tables created in the initial
104.         migration of an app exists. Database routers must be obeyed when doing
105.         that check.
106.         """
107.         # Make sure no tables are created
108.         for db in connections:
109.             self.assertTableNotExists("migrations_author", using=db)
110.             self.assertTableNotExists("migrations_tribble", using=db)
111.         # Run the migrations to 0001 only
112.         call_command("migrate", "migrations", "0001", verbosity=0)
113.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
114.         # Make sure the right tables exist
115.         self.assertTableExists("migrations_author")
116.         self.assertTableNotExists("migrations_tribble")
117.         # Also check the "other" database
118.         self.assertTableNotExists("migrations_author", using="other")
119.         self.assertTableExists("migrations_tribble", using="other")
120. 
121.         # Fake a roll-back
122.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
123.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
124.         # Make sure the tables still exist
125.         self.assertTableExists("migrations_author")
126.         self.assertTableExists("migrations_tribble", using="other")
127.         # Try to run initial migration
128.         with self.assertRaises(DatabaseError):
129.             call_command("migrate", "migrations", "0001", verbosity=0)
130.         # Run initial migration with an explicit --fake-initial
131.         out = six.StringIO()
132.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
133.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
134.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
135.         self.assertIn(
136.             "migrations.0001_initial... faked",
137.             out.getvalue().lower()
138.         )
139.         # Run migrations all the way
140.         call_command("migrate", verbosity=0)
141.         call_command("migrate", verbosity=0, database="other")
142.         # Make sure the right tables exist
143.         self.assertTableExists("migrations_author")
144.         self.assertTableNotExists("migrations_tribble")
145.         self.assertTableExists("migrations_book")
146.         self.assertTableNotExists("migrations_author", using="other")
147.         self.assertTableNotExists("migrations_tribble", using="other")
148.         self.assertTableNotExists("migrations_book", using="other")
149.         # Fake a roll-back
150.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
151.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
152.         # Make sure the tables still exist
153.         self.assertTableExists("migrations_author")
154.         self.assertTableNotExists("migrations_tribble")
155.         self.assertTableExists("migrations_book")
156.         # Try to run initial migration
157.         with self.assertRaises(DatabaseError):
158.             call_command("migrate", "migrations", verbosity=0)
159.         # Run initial migration with an explicit --fake-initial
160.         with self.assertRaises(DatabaseError):
161.             # Fails because "migrations_tribble" does not exist but needs to in
162.             # order to make --fake-initial work.
163.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
164.         # Fake a apply
165.         call_command("migrate", "migrations", fake=True, verbosity=0)
166.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
167.         # Unmigrate everything
168.         call_command("migrate", "migrations", "zero", verbosity=0)
169.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
170.         # Make sure it's all gone
171.         for db in connections:
172.             self.assertTableNotExists("migrations_author", using=db)
173.             self.assertTableNotExists("migrations_tribble", using=db)
174.             self.assertTableNotExists("migrations_book", using=db)
175. 
176.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})
177.     def test_migrate_fake_split_initial(self):
178.         """
179.         Split initial migrations can be faked with --fake-initial.
180.         """
181.         call_command("migrate", "migrations", "0002", verbosity=0)
182.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
183.         out = six.StringIO()
184.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
185.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)
186.         value = out.getvalue().lower()
187.         self.assertIn("migrations.0001_initial... faked", value)
188.         self.assertIn("migrations.0002_second... faked", value)
189.         # Fake an apply
190.         call_command("migrate", "migrations", fake=True, verbosity=0)
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193. 
194.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})
195.     def test_migrate_conflict_exit(self):
196.         """
197.         Makes sure that migrate exits if it detects a conflict.
198.         """
199.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):
200.             call_command("migrate", "migrations")
201. 
202.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
203.     def test_showmigrations_list(self):
204.         """
205.         Tests --list output of showmigrations command
206.         """
207.         out = six.StringIO()
208.         with mock.patch('django.core.management.color.supports_color', lambda *args: True):
209.             call_command("showmigrations", format='list', stdout=out, verbosity=0, no_color=False)
210.         self.assertEqual(
211.             '\x1b[1mmigrations\n\x1b[0m'
212.             ' [ ] 0001_initial\n'
213.             ' [ ] 0002_second\n',
214.             out.getvalue().lower()
215.         )
216. 
217.         call_command("migrate", "migrations", "0001", verbosity=0)
218. 
219.         out = six.StringIO()
220.         # Giving the explicit app_label tests for selective `show_list` in the command
221.         call_command("showmigrations", "migrations", format='list', stdout=out, verbosity=0, no_color=True)
222.         self.assertEqual(
223.             'migrations\n'
224.             ' [x] 0001_initial\n'
225.             ' [ ] 0002_second\n',
226.             out.getvalue().lower()
227.         )
228.         # Cleanup by unmigrating everything
229.         call_command("migrate", "migrations", "zero", verbosity=0)
230. 
231.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})
232.     def test_showmigrations_plan(self):
233.         """
234.         Tests --plan output of showmigrations command
235.         """
236.         out = six.StringIO()
237.         call_command("showmigrations", format='plan', stdout=out)
238.         self.assertEqual(
239.             "[ ]  migrations.0001_initial\n"
240.             "[ ]  migrations.0003_third\n"
241.             "[ ]  migrations.0002_second\n",
242.             out.getvalue().lower()
243.         )
244. 
245.         out = six.StringIO()
246.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
247.         self.assertEqual(
248.             "[ ]  migrations.0001_initial\n"
249.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\n"
250.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
251.             out.getvalue().lower()
252.         )
253.         call_command("migrate", "migrations", "0003", verbosity=0)
254. 
255.         out = six.StringIO()
256.         call_command("showmigrations", format='plan', stdout=out)
257.         self.assertEqual(
258.             "[x]  migrations.0001_initial\n"
259.             "[x]  migrations.0003_third\n"
260.             "[ ]  migrations.0002_second\n",
261.             out.getvalue().lower()
262.         )
263. 
264.         out = six.StringIO()
265.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
266.         self.assertEqual(
267.             "[x]  migrations.0001_initial\n"
268.             "[x]  migrations.0003_third ... (migrations.0001_initial)\n"
269.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
270.             out.getvalue().lower()
271.         )
272. 
273.         # Cleanup by unmigrating everything
274.         call_command("migrate", "migrations", "zero", verbosity=0)
275. 
276.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})
277.     def test_showmigrations_plan_no_migrations(self):
278.         """
279.         Tests --plan output of showmigrations command without migrations
280.         """
281.         out = six.StringIO()
282.         call_command("showmigrations", format='plan', stdout=out)
283.         self.assertEqual("", out.getvalue().lower())
284. 
285.         out = six.StringIO()
286.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
287.         self.assertEqual("", out.getvalue().lower())
288. 
289.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})
290.     def test_showmigrations_plan_squashed(self):
291.         """
292.         Tests --plan output of showmigrations command with squashed migrations.
293.         """
294.         out = six.StringIO()
295.         call_command("showmigrations", format='plan', stdout=out)
296.         self.assertEqual(
297.             "[ ]  migrations.1_auto\n"
298.             "[ ]  migrations.2_auto\n"
299.             "[ ]  migrations.3_squashed_5\n"
300.             "[ ]  migrations.6_auto\n"
301.             "[ ]  migrations.7_auto\n",
302.             out.getvalue().lower()
303.         )
304. 
305.         out = six.StringIO()
306.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
307.         self.assertEqual(
308.             "[ ]  migrations.1_auto\n"
309.             "[ ]  migrations.2_auto ... (migrations.1_auto)\n"
310.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
311.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
312.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
313.             out.getvalue().lower()
314.         )
315. 
316.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)
317. 
318.         out = six.StringIO()
319.         call_command("showmigrations", format='plan', stdout=out)
320.         self.assertEqual(
321.             "[x]  migrations.1_auto\n"
322.             "[x]  migrations.2_auto\n"
323.             "[x]  migrations.3_squashed_5\n"
324.             "[ ]  migrations.6_auto\n"
325.             "[ ]  migrations.7_auto\n",
326.             out.getvalue().lower()
327.         )
328. 
329.         out = six.StringIO()
330.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
331.         self.assertEqual(
332.             "[x]  migrations.1_auto\n"
333.             "[x]  migrations.2_auto ... (migrations.1_auto)\n"
334.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
335.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
336.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
337.             out.getvalue().lower()
338.         )
339. 
340.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
341.     def test_sqlmigrate_forwards(self):
342.         """
343.         Makes sure that sqlmigrate does something.
344.         """
345.         out = six.StringIO()
346.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
347.         output = out.getvalue().lower()
348. 
349.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
350.         index_op_desc_author = output.find('-- create model author')
351.         index_create_table = output.find('create table')
352.         index_op_desc_tribble = output.find('-- create model tribble')
353.         index_op_desc_unique_together = output.find('-- alter unique_together')
354.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
355. 
356.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
357.         self.assertGreater(
358.             index_op_desc_author, index_tx_start,
359.             "Operation description (author) not found or found before transaction start"
360.         )
361.         self.assertGreater(
362.             index_create_table, index_op_desc_author,
363.             "CREATE TABLE not found or found before operation description (author)"
364.         )
365.         self.assertGreater(
366.             index_op_desc_tribble, index_create_table,
367.             "Operation description (tribble) not found or found before CREATE TABLE (author)"
368.         )
369.         self.assertGreater(
370.             index_op_desc_unique_together, index_op_desc_tribble,
371.             "Operation description (unique_together) not found or found before operation description (tribble)"
372.         )
373.         self.assertGreater(
374.             index_tx_end, index_op_desc_unique_together,
375.             "Transaction end not found or found before operation description (unique_together)"
376.         )
377. 
378.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
379.     def test_sqlmigrate_backwards(self):
380.         """
381.         Makes sure that sqlmigrate does something.
382.         """
383.         # Cannot generate the reverse SQL unless we've applied the migration.
384.         call_command("migrate", "migrations", verbosity=0)
385. 
386.         out = six.StringIO()
387.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)
388.         output = out.getvalue().lower()
389. 
390.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
391.         index_op_desc_unique_together = output.find('-- alter unique_together')
392.         index_op_desc_tribble = output.find('-- create model tribble')
393.         index_op_desc_author = output.find('-- create model author')
394.         index_drop_table = output.rfind('drop table')
395.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
396. 
397.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
398.         self.assertGreater(
399.             index_op_desc_unique_together, index_tx_start,
400.             "Operation description (unique_together) not found or found before transaction start"
401.         )
402.         self.assertGreater(
403.             index_op_desc_tribble, index_op_desc_unique_together,
404.             "Operation description (tribble) not found or found before operation description (unique_together)"
405.         )
406.         self.assertGreater(
407.             index_op_desc_author, index_op_desc_tribble,
408.             "Operation description (author) not found or found before operation description (tribble)"
409.         )
410. 
411.         self.assertGreater(
412.             index_drop_table, index_op_desc_author,
413.             "DROP TABLE not found or found before operation description (author)"
414.         )
415.         self.assertGreater(
416.             index_tx_end, index_op_desc_unique_together,
417.             "Transaction end not found or found before DROP TABLE"
418.         )
419. 
420.         # Cleanup by unmigrating everything
421.         call_command("migrate", "migrations", "zero", verbosity=0)
422. 
423.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})
424.     def test_sqlmigrate_for_non_atomic_migration(self):
425.         """
426.         Transaction wrappers aren't shown for non-atomic migrations.
427.         """
428.         out = six.StringIO()
429.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
430.         output = out.getvalue().lower()
431.         queries = [q.strip() for q in output.splitlines()]
432.         if connection.ops.start_transaction_sql():
433.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)
434.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)
435. 
436.     @override_settings(
437.         INSTALLED_APPS=[
438.             "migrations.migrations_test_apps.migrated_app",
439.             "migrations.migrations_test_apps.migrated_unapplied_app",
440.             "migrations.migrations_test_apps.unmigrated_app"])
441.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):
442.         """
443.         https://code.djangoproject.com/ticket/22823
444. 
445.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:
446. 
447.         * `A` has migrations
448.         * `B` has a migration we want to apply
449.         * `C` has no migrations, but has an FK to `A`
450. 
451.         When we try to migrate "B", an exception occurs because the
452.         "B" was not included in the ProjectState that is used to detect
453.         soft-applied migrations.
454.         """
455.         call_command("migrate", "migrated_unapplied_app", stdout=six.StringIO())
456. 
457.         # unmigrated_app.SillyModel has a foreign key to 'migrations.Tribble',
458.         # but that model is only defined in a migration, so the global app
459.         # registry never sees it and the reference is left dangling. Remove it
460.         # to avoid problems in subsequent tests.
461.         del apps._pending_operations[('migrations', 'tribble')]
462. 
463.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
464.     def test_migrate_record_replaced(self):
465.         """
466.         Running a single squashed migration should record all of the original
467.         replaced migrations as run.
468.         """
469.         recorder = MigrationRecorder(connection)
470.         out = six.StringIO()
471.         call_command("migrate", "migrations", verbosity=0)
472.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
473.         self.assertEqual(
474.             'migrations\n'
475.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
476.             out.getvalue().lower()
477.         )
478.         applied_migrations = recorder.applied_migrations()
479.         self.assertIn(("migrations", "0001_initial"), applied_migrations)
480.         self.assertIn(("migrations", "0002_second"), applied_migrations)
481.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)
482.         # Rollback changes
483.         call_command("migrate", "migrations", "zero", verbosity=0)
484. 
485.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
486.     def test_migrate_record_squashed(self):
487.         """
488.         Running migrate for a squashed migration should record as run
489.         if all of the replaced migrations have been run (#25231).
490.         """
491.         recorder = MigrationRecorder(connection)
492.         recorder.record_applied("migrations", "0001_initial")
493.         recorder.record_applied("migrations", "0002_second")
494.         out = six.StringIO()
495.         call_command("migrate", "migrations", verbosity=0)
496.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
497.         self.assertEqual(
498.             'migrations\n'
499.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
500.             out.getvalue().lower()


File: tests/migrations/test_multidb.py
Line number range: 1 - 174
Content:
1. import unittest
2. 
3. from django.db import connection, migrations, models
4. from django.db.migrations.state import ProjectState
5. from django.test import override_settings
6. 
7. from .test_operations import OperationTestBase
8. 
9. try:
10.     import sqlparse
11. except ImportError:
12.     sqlparse = None
13. 
14. 
15. class AgnosticRouter(object):
16.     """
17.     A router that doesn't have an opinion regarding migrating.
18.     """
19.     def allow_migrate(self, db, app_label, **hints):
20.         return None
21. 
22. 
23. class MigrateNothingRouter(object):
24.     """
25.     A router that doesn't allow migrating.
26.     """
27.     def allow_migrate(self, db, app_label, **hints):
28.         return False
29. 
30. 
31. class MigrateEverythingRouter(object):
32.     """
33.     A router that always allows migrating.
34.     """
35.     def allow_migrate(self, db, app_label, **hints):
36.         return True
37. 
38. 
39. class MigrateWhenFooRouter(object):
40.     """
41.     A router that allows migrating depending on a hint.
42.     """
43.     def allow_migrate(self, db, app_label, **hints):
44.         return hints.get('foo', False)
45. 
46. 
47. class MultiDBOperationTests(OperationTestBase):
48.     multi_db = True
49. 
50.     def _test_create_model(self, app_label, should_run):
51.         """
52.         Tests that CreateModel honours multi-db settings.
53.         """
54.         operation = migrations.CreateModel(
55.             "Pony",
56.             [("id", models.AutoField(primary_key=True))],
57.         )
58.         # Test the state alteration
59.         project_state = ProjectState()
60.         new_state = project_state.clone()
61.         operation.state_forwards(app_label, new_state)
62.         # Test the database alteration
63.         self.assertTableNotExists("%s_pony" % app_label)
64.         with connection.schema_editor() as editor:
65.             operation.database_forwards(app_label, editor, project_state, new_state)
66.         if should_run:
67.             self.assertTableExists("%s_pony" % app_label)
68.         else:
69.             self.assertTableNotExists("%s_pony" % app_label)
70.         # And test reversal
71.         with connection.schema_editor() as editor:
72.             operation.database_backwards(app_label, editor, new_state, project_state)
73.         self.assertTableNotExists("%s_pony" % app_label)
74. 
75.     @override_settings(DATABASE_ROUTERS=[AgnosticRouter()])
76.     def test_create_model(self):
77.         """
78.         Test when router doesn't have an opinion (i.e. CreateModel should run).
79.         """
80.         self._test_create_model("test_mltdb_crmo", should_run=True)
81. 
82.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
83.     def test_create_model2(self):
84.         """
85.         Test when router returns False (i.e. CreateModel shouldn't run).
86.         """
87.         self._test_create_model("test_mltdb_crmo2", should_run=False)
88. 
89.     @override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()])
90.     def test_create_model3(self):
91.         """
92.         Test when router returns True (i.e. CreateModel should run).
93.         """
94.         self._test_create_model("test_mltdb_crmo3", should_run=True)
95. 
96.     def test_create_model4(self):
97.         """
98.         Test multiple routers.
99.         """
100.         with override_settings(DATABASE_ROUTERS=[AgnosticRouter(), AgnosticRouter()]):
101.             self._test_create_model("test_mltdb_crmo4", should_run=True)
102.         with override_settings(DATABASE_ROUTERS=[MigrateNothingRouter(), MigrateEverythingRouter()]):
103.             self._test_create_model("test_mltdb_crmo4", should_run=False)
104.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter(), MigrateNothingRouter()]):
105.             self._test_create_model("test_mltdb_crmo4", should_run=True)
106. 
107.     def _test_run_sql(self, app_label, should_run, hints=None):
108.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()]):
109.             project_state = self.set_up_test_model(app_label)
110. 
111.         sql = """
112.         INSERT INTO {0}_pony (pink, weight) VALUES (1, 3.55);
113.         INSERT INTO {0}_pony (pink, weight) VALUES (3, 5.0);
114.         """.format(app_label)
115. 
116.         operation = migrations.RunSQL(sql, hints=hints or {})
117.         # Test the state alteration does nothing
118.         new_state = project_state.clone()
119.         operation.state_forwards(app_label, new_state)
120.         self.assertEqual(new_state, project_state)
121.         # Test the database alteration
122.         self.assertEqual(project_state.apps.get_model(app_label, "Pony").objects.count(), 0)
123.         with connection.schema_editor() as editor:
124.             operation.database_forwards(app_label, editor, project_state, new_state)
125.         Pony = project_state.apps.get_model(app_label, "Pony")
126.         if should_run:
127.             self.assertEqual(Pony.objects.count(), 2)
128.         else:
129.             self.assertEqual(Pony.objects.count(), 0)
130. 
131.     @unittest.skipIf(sqlparse is None and connection.features.requires_sqlparse_for_splitting, "Missing sqlparse")
132.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
133.     def test_run_sql(self):
134.         self._test_run_sql("test_mltdb_runsql", should_run=False)
135. 
136.     @unittest.skipIf(sqlparse is None and connection.features.requires_sqlparse_for_splitting, "Missing sqlparse")
137.     @override_settings(DATABASE_ROUTERS=[MigrateWhenFooRouter()])
138.     def test_run_sql2(self):
139.         self._test_run_sql("test_mltdb_runsql2", should_run=False)
140.         self._test_run_sql("test_mltdb_runsql2", should_run=True, hints={'foo': True})
141. 
142.     def _test_run_python(self, app_label, should_run, hints=None):
143.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()]):
144.             project_state = self.set_up_test_model(app_label)
145. 
146.         # Create the operation
147.         def inner_method(models, schema_editor):
148.             Pony = models.get_model(app_label, "Pony")
149.             Pony.objects.create(pink=1, weight=3.55)
150.             Pony.objects.create(weight=5)
151. 
152.         operation = migrations.RunPython(inner_method, hints=hints or {})
153.         # Test the state alteration does nothing
154.         new_state = project_state.clone()
155.         operation.state_forwards(app_label, new_state)
156.         self.assertEqual(new_state, project_state)
157.         # Test the database alteration
158.         self.assertEqual(project_state.apps.get_model(app_label, "Pony").objects.count(), 0)
159.         with connection.schema_editor() as editor:
160.             operation.database_forwards(app_label, editor, project_state, new_state)
161.         Pony = project_state.apps.get_model(app_label, "Pony")
162.         if should_run:
163.             self.assertEqual(Pony.objects.count(), 2)
164.         else:
165.             self.assertEqual(Pony.objects.count(), 0)
166. 
167.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
168.     def test_run_python(self):
169.         self._test_run_python("test_mltdb_runpython", should_run=False)
170. 
171.     @override_settings(DATABASE_ROUTERS=[MigrateWhenFooRouter()])
172.     def test_run_python2(self):
173.         self._test_run_python("test_mltdb_runpython2", should_run=False)
174.         self._test_run_python("test_mltdb_runpython2", should_run=True, hints={'foo': True})

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 17:16:31,257 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find test cases related to a bug in the `makemigrations` command that incorrectly calls `router.allow_migrate()`. The provided context contains the file with the bug (`django/core/management/commands/makemigrations.py`) and a file with multi-database migration tests (`tests/migrations/test_multidb.py`), but the most relevant test file, `tests/migrations/test_commands.py`, is incomplete and missing the tests for `makemigrations`. Additionally, the definition of `TestRouter`, used in the tests, is in `tests/migrations/routers.py`, which is not in the context. To find relevant tests, I need the complete content of `test_commands.py` and the definition of the router it uses.' query='Please provide the full content of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`.' extra_requirements="If `tests/migrations/test_commands.py` is too large, please at least provide all test classes and methods related to the 'makemigrations' command." purpose='I need to find test cases for the `makemigrations` command that involve database routers to identify tests that are relevant to the described bug about the bug regarding the reported bug.'
2025-12-24 17:16:31,269 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`.
2025-12-24 17:16:31,269 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 17:16:31,270 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 17:16:31,271 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 17:16:31,271 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`.
Extra requirements: If `tests/migrations/test_commands.py` is too large, please at least provide all test classes and methods related to the 'makemigrations' command.
Purpose: I need to find test cases for the `makemigrations` command that involve database routers to identify tests that are relevant to the described bug about the bug regarding the reported bug.
2025-12-24 17:16:39,764 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I will first retrieve the contents of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`. If `tests/migrations/test_commands.py` is too large, I will then specifically search for test classes and methods related to the 'makemigrations' command within that file to narrow down the relevant code for your bug investigation." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/routers.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2156, 'candidates_token_count': 122, 'total_token_count': 3028, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2156}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 122}], 'thoughts_token_count': 750, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.39592896133172706, 'model_name': 'gemini-2.5-pro'} id='run--e957a2a6-a387-4b07-bcc9-5952b62c34fa-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_commands.py'}, 'id': '3d0f8f8a-e6a2-4486-82c2-346a024793ca', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/routers.py'}, 'id': '6fbb50b1-e823-4d4b-8c56-7c87cdcb16bb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2156, 'output_tokens': 122, 'total_tokens': 3028, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 750}}
2025-12-24 17:16:43,898 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the contents of both `tests/migrations/test_commands.py` and `tests/migrations/routers.py`. Since the first file is quite large, I will now search for tests specifically related to the `makemigrations` command within it. The second file, `tests/migrations/routers.py`, contains database router configurations that may be relevant to the bug you are investigating.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "makemigrations", "relative_path": "tests/migrations/test_commands.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10871, 'candidates_token_count': 121, 'total_token_count': 11192, 'cached_content_token_count': 1828, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10871}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1828}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 121}], 'thoughts_token_count': 200}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2424158143603112, 'model_name': 'gemini-2.5-pro'} id='run--67949497-8589-43ae-85a6-b36a5229b784-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'makemigrations', 'relative_path': 'tests/migrations/test_commands.py'}, 'id': 'bc0aadac-a394-4985-bfb9-4745b890759b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10871, 'output_tokens': 121, 'total_tokens': 11192, 'input_token_details': {'cache_read': 1828}, 'output_token_details': {'reasoning': 200}}
2025-12-24 17:16:51,063 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located the `MakeMigrationsTests` class within `tests/migrations/test_commands.py` and identified a key test method, `test_makemigrations_consistency_checks_respect_routers`, that deals with database routers. This test appears to be highly relevant to your investigation as it specifically checks how `makemigrations` interacts with different router configurations. I will now retrieve the code for this specific test.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 622.0, "end_line": 668.0, "relative_path": "tests/migrations/test_commands.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20448, 'candidates_token_count': 119, 'total_token_count': 21095, 'cached_content_token_count': 9362, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20448}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9362}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 119}], 'thoughts_token_count': 528}, 'finish_reason': 'STOP', 'avg_logprobs': -0.49089255453157826, 'model_name': 'gemini-2.5-pro'} id='run--48f9ccbb-8e87-46b8-b5fa-132a176145e3-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 622.0, 'end_line': 668.0, 'relative_path': 'tests/migrations/test_commands.py'}, 'id': 'd49d7cd3-b15a-4a77-9a15-881f35fd3d05', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20448, 'output_tokens': 119, 'total_tokens': 21095, 'input_token_details': {'cache_read': 9362}, 'output_token_details': {'reasoning': 528}}
2025-12-24 17:16:57,084 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the contents of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`. I then located the `MakeMigrationsTests` class within the former file and pinpointed the `test_makemigrations_consistency_checks_respect_routers` method, which is highly relevant to your investigation as it specifically tests the behavior of the `makemigrations` command in conjunction with database routers. You now have the full content of the router definitions and the specific test case that demonstrates their interaction with the migration process.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21515, 'candidates_token_count': 116, 'total_token_count': 21933, 'cached_content_token_count': 18732, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21515}], 'cache_tokens_details': [{'modality': 1, 'token_count': 18732}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 116}], 'thoughts_token_count': 302}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3376229055996599, 'model_name': 'gemini-2.5-pro'} id='run--59ae3242-7cd0-4ed5-aabc-c101b043a9ae-0' usage_metadata={'input_tokens': 21515, 'output_tokens': 116, 'total_tokens': 21933, 'input_token_details': {'cache_read': 18732}, 'output_token_details': {'reasoning': 302}}
2025-12-24 17:16:57,086 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`.
--- END QUERY ---

--- BEGIN EXTRA REQUIREMENTS ---
If `tests/migrations/test_commands.py` is too large, please at least provide all test classes and methods related to the 'makemigrations' command.
--- END EXTRA REQUIREMENTS ---

--- BEGIN PURPOSE ---
I need to find test cases for the `makemigrations` command that involve database routers to identify tests that are relevant to the described bug about the bug regarding the reported bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/migrations/routers.py
Line number range: 1 - 13
Content:
1. class EmptyRouter(object):
2.     pass
3. 
4. 
5. class TestRouter(object):
6.     def allow_migrate(self, db, app_label, model_name=None, **hints):
7.         """
8.         The Tribble model should be the only one to appear in the 'other' db.
9.         """
10.         if model_name == 'tribble':
11.             return db == 'other'
12.         elif db == 'other':
13.             return False


File: tests/migrations/test_commands.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import unicode_literals
3. 
4. import datetime
5. import importlib
6. import io
7. import os
8. import sys
9. 
10. from django.apps import apps
11. from django.core.management import CommandError, call_command
12. from django.db import (
13.     ConnectionHandler, DatabaseError, connection, connections, models,
14. )
15. from django.db.migrations.exceptions import (
16.     InconsistentMigrationHistory, MigrationSchemaMissing,
17. )
18. from django.db.migrations.recorder import MigrationRecorder
19. from django.test import ignore_warnings, mock, override_settings
20. from django.utils import six
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.encoding import force_text
23. 
24. from .models import UnicodeModel, UnserializableModel
25. from .routers import TestRouter
26. from .test_base import MigrationTestBase
27. 
28. 
29. class MigrateTests(MigrationTestBase):
30.     """
31.     Tests running the migrate command.
32.     """
33.     multi_db = True
34. 
35.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
36.     def test_migrate(self):
37.         """
38.         Tests basic usage of the migrate command.
39.         """
40.         # Make sure no tables are created
41.         self.assertTableNotExists("migrations_author")
42.         self.assertTableNotExists("migrations_tribble")
43.         self.assertTableNotExists("migrations_book")
44.         # Run the migrations to 0001 only
45.         call_command("migrate", "migrations", "0001", verbosity=0)
46.         # Make sure the right tables exist
47.         self.assertTableExists("migrations_author")
48.         self.assertTableExists("migrations_tribble")
49.         self.assertTableNotExists("migrations_book")
50.         # Run migrations all the way
51.         call_command("migrate", verbosity=0)
52.         # Make sure the right tables exist
53.         self.assertTableExists("migrations_author")
54.         self.assertTableNotExists("migrations_tribble")
55.         self.assertTableExists("migrations_book")
56.         # Unmigrate everything
57.         call_command("migrate", "migrations", "zero", verbosity=0)
58.         # Make sure it's all gone
59.         self.assertTableNotExists("migrations_author")
60.         self.assertTableNotExists("migrations_tribble")
61.         self.assertTableNotExists("migrations_book")
62. 
63.     @override_settings(INSTALLED_APPS=[
64.         'django.contrib.auth',
65.         'django.contrib.contenttypes',
66.         'migrations.migrations_test_apps.migrated_app',
67.     ])
68.     def test_migrate_with_system_checks(self):
69.         out = six.StringIO()
70.         call_command('migrate', skip_checks=False, no_color=True, stdout=out)
71.         self.assertIn('Apply all migrations: migrated_app', out.getvalue())
72. 
73.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})
74.     def test_migrate_initial_false(self):
75.         """
76.         `Migration.initial = False` skips fake-initial detection.
77.         """
78.         # Make sure no tables are created
79.         self.assertTableNotExists("migrations_author")
80.         self.assertTableNotExists("migrations_tribble")
81.         # Run the migrations to 0001 only
82.         call_command("migrate", "migrations", "0001", verbosity=0)
83.         # Fake rollback
84.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
85.         # Make sure fake-initial detection does not run
86.         with self.assertRaises(DatabaseError):
87.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)
88. 
89.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)
90.         # Real rollback
91.         call_command("migrate", "migrations", "zero", verbosity=0)
92.         # Make sure it's all gone
93.         self.assertTableNotExists("migrations_author")
94.         self.assertTableNotExists("migrations_tribble")
95.         self.assertTableNotExists("migrations_book")
96. 
97.     @override_settings(
98.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
99.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
100.     )
101.     def test_migrate_fake_initial(self):
102.         """
103.         --fake-initial only works if all tables created in the initial
104.         migration of an app exists. Database routers must be obeyed when doing
105.         that check.
106.         """
107.         # Make sure no tables are created
108.         for db in connections:
109.             self.assertTableNotExists("migrations_author", using=db)
110.             self.assertTableNotExists("migrations_tribble", using=db)
111.         # Run the migrations to 0001 only
112.         call_command("migrate", "migrations", "0001", verbosity=0)
113.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
114.         # Make sure the right tables exist
115.         self.assertTableExists("migrations_author")
116.         self.assertTableNotExists("migrations_tribble")
117.         # Also check the "other" database
118.         self.assertTableNotExists("migrations_author", using="other")
119.         self.assertTableExists("migrations_tribble", using="other")
120. 
121.         # Fake a roll-back
122.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
123.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
124.         # Make sure the tables still exist
125.         self.assertTableExists("migrations_author")
126.         self.assertTableExists("migrations_tribble", using="other")
127.         # Try to run initial migration
128.         with self.assertRaises(DatabaseError):
129.             call_command("migrate", "migrations", "0001", verbosity=0)
130.         # Run initial migration with an explicit --fake-initial
131.         out = six.StringIO()
132.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
133.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
134.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
135.         self.assertIn(
136.             "migrations.0001_initial... faked",
137.             out.getvalue().lower()
138.         )
139.         # Run migrations all the way
140.         call_command("migrate", verbosity=0)
141.         call_command("migrate", verbosity=0, database="other")
142.         # Make sure the right tables exist
143.         self.assertTableExists("migrations_author")
144.         self.assertTableNotExists("migrations_tribble")
145.         self.assertTableExists("migrations_book")
146.         self.assertTableNotExists("migrations_author", using="other")
147.         self.assertTableNotExists("migrations_tribble", using="other")
148.         self.assertTableNotExists("migrations_book", using="other")
149.         # Fake a roll-back
150.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
151.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
152.         # Make sure the tables still exist
153.         self.assertTableExists("migrations_author")
154.         self.assertTableNotExists("migrations_tribble")
155.         self.assertTableExists("migrations_book")
156.         # Try to run initial migration
157.         with self.assertRaises(DatabaseError):
158.             call_command("migrate", "migrations", verbosity=0)
159.         # Run initial migration with an explicit --fake-initial
160.         with self.assertRaises(DatabaseError):
161.             # Fails because "migrations_tribble" does not exist but needs to in
162.             # order to make --fake-initial work.
163.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
164.         # Fake a apply
165.         call_command("migrate", "migrations", fake=True, verbosity=0)
166.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
167.         # Unmigrate everything
168.         call_command("migrate", "migrations", "zero", verbosity=0)
169.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
170.         # Make sure it's all gone
171.         for db in connections:
172.             self.assertTableNotExists("migrations_author", using=db)
173.             self.assertTableNotExists("migrations_tribble", using=db)
174.             self.assertTableNotExists("migrations_book", using=db)
175. 
176.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})
177.     def test_migrate_fake_split_initial(self):
178.         """
179.         Split initial migrations can be faked with --fake-initial.
180.         """
181.         call_command("migrate", "migrations", "0002", verbosity=0)
182.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
183.         out = six.StringIO()
184.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
185.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)
186.         value = out.getvalue().lower()
187.         self.assertIn("migrations.0001_initial... faked", value)
188.         self.assertIn("migrations.0002_second... faked", value)
189.         # Fake an apply
190.         call_command("migrate", "migrations", fake=True, verbosity=0)
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193. 
194.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})
195.     def test_migrate_conflict_exit(self):
196.         """
197.         Makes sure that migrate exits if it detects a conflict.
198.         """
199.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):
200.             call_command("migrate", "migrations")
201. 
202.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
203.     def test_showmigrations_list(self):
204.         """
205.         Tests --list output of showmigrations command
206.         """
207.         out = six.StringIO()
208.         with mock.patch('django.core.management.color.supports_color', lambda *args: True):
209.             call_command("showmigrations", format='list', stdout=out, verbosity=0, no_color=False)
210.         self.assertEqual(
211.             '\x1b[1mmigrations\n\x1b[0m'
212.             ' [ ] 0001_initial\n'
213.             ' [ ] 0002_second\n',
214.             out.getvalue().lower()
215.         )
216. 
217.         call_command("migrate", "migrations", "0001", verbosity=0)
218. 
219.         out = six.StringIO()
220.         # Giving the explicit app_label tests for selective `show_list` in the command
221.         call_command("showmigrations", "migrations", format='list', stdout=out, verbosity=0, no_color=True)
222.         self.assertEqual(
223.             'migrations\n'
224.             ' [x] 0001_initial\n'
225.             ' [ ] 0002_second\n',
226.             out.getvalue().lower()
227.         )
228.         # Cleanup by unmigrating everything
229.         call_command("migrate", "migrations", "zero", verbosity=0)
230. 
231.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})
232.     def test_showmigrations_plan(self):
233.         """
234.         Tests --plan output of showmigrations command
235.         """
236.         out = six.StringIO()
237.         call_command("showmigrations", format='plan', stdout=out)
238.         self.assertEqual(
239.             "[ ]  migrations.0001_initial\n"
240.             "[ ]  migrations.0003_third\n"
241.             "[ ]  migrations.0002_second\n",
242.             out.getvalue().lower()
243.         )
244. 
245.         out = six.StringIO()
246.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
247.         self.assertEqual(
248.             "[ ]  migrations.0001_initial\n"
249.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\n"
250.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
251.             out.getvalue().lower()
252.         )
253.         call_command("migrate", "migrations", "0003", verbosity=0)
254. 
255.         out = six.StringIO()
256.         call_command("showmigrations", format='plan', stdout=out)
257.         self.assertEqual(
258.             "[x]  migrations.0001_initial\n"
259.             "[x]  migrations.0003_third\n"
260.             "[ ]  migrations.0002_second\n",
261.             out.getvalue().lower()
262.         )
263. 
264.         out = six.StringIO()
265.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
266.         self.assertEqual(
267.             "[x]  migrations.0001_initial\n"
268.             "[x]  migrations.0003_third ... (migrations.0001_initial)\n"
269.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
270.             out.getvalue().lower()
271.         )
272. 
273.         # Cleanup by unmigrating everything
274.         call_command("migrate", "migrations", "zero", verbosity=0)
275. 
276.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})
277.     def test_showmigrations_plan_no_migrations(self):
278.         """
279.         Tests --plan output of showmigrations command without migrations
280.         """
281.         out = six.StringIO()
282.         call_command("showmigrations", format='plan', stdout=out)
283.         self.assertEqual("", out.getvalue().lower())
284. 
285.         out = six.StringIO()
286.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
287.         self.assertEqual("", out.getvalue().lower())
288. 
289.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})
290.     def test_showmigrations_plan_squashed(self):
291.         """
292.         Tests --plan output of showmigrations command with squashed migrations.
293.         """
294.         out = six.StringIO()
295.         call_command("showmigrations", format='plan', stdout=out)
296.         self.assertEqual(
297.             "[ ]  migrations.1_auto\n"
298.             "[ ]  migrations.2_auto\n"
299.             "[ ]  migrations.3_squashed_5\n"
300.             "[ ]  migrations.6_auto\n"
301.             "[ ]  migrations.7_auto\n",
302.             out.getvalue().lower()
303.         )
304. 
305.         out = six.StringIO()
306.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
307.         self.assertEqual(
308.             "[ ]  migrations.1_auto\n"
309.             "[ ]  migrations.2_auto ... (migrations.1_auto)\n"
310.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
311.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
312.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
313.             out.getvalue().lower()
314.         )
315. 
316.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)
317. 
318.         out = six.StringIO()
319.         call_command("showmigrations", format='plan', stdout=out)
320.         self.assertEqual(
321.             "[x]  migrations.1_auto\n"
322.             "[x]  migrations.2_auto\n"
323.             "[x]  migrations.3_squashed_5\n"
324.             "[ ]  migrations.6_auto\n"
325.             "[ ]  migrations.7_auto\n",
326.             out.getvalue().lower()
327.         )
328. 
329.         out = six.StringIO()
330.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
331.         self.assertEqual(
332.             "[x]  migrations.1_auto\n"
333.             "[x]  migrations.2_auto ... (migrations.1_auto)\n"
334.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
335.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
336.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
337.             out.getvalue().lower()
338.         )
339. 
340.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
341.     def test_sqlmigrate_forwards(self):
342.         """
343.         Makes sure that sqlmigrate does something.
344.         """
345.         out = six.StringIO()
346.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
347.         output = out.getvalue().lower()
348. 
349.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
350.         index_op_desc_author = output.find('-- create model author')
351.         index_create_table = output.find('create table')
352.         index_op_desc_tribble = output.find('-- create model tribble')
353.         index_op_desc_unique_together = output.find('-- alter unique_together')
354.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
355. 
356.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
357.         self.assertGreater(
358.             index_op_desc_author, index_tx_start,
359.             "Operation description (author) not found or found before transaction start"
360.         )
361.         self.assertGreater(
362.             index_create_table, index_op_desc_author,
363.             "CREATE TABLE not found or found before operation description (author)"
364.         )
365.         self.assertGreater(
366.             index_op_desc_tribble, index_create_table,
367.             "Operation description (tribble) not found or found before CREATE TABLE (author)"
368.         )
369.         self.assertGreater(
370.             index_op_desc_unique_together, index_op_desc_tribble,
371.             "Operation description (unique_together) not found or found before operation description (tribble)"
372.         )
373.         self.assertGreater(
374.             index_tx_end, index_op_desc_unique_together,
375.             "Transaction end not found or found before operation description (unique_together)"
376.         )
377. 
378.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
379.     def test_sqlmigrate_backwards(self):
380.         """
381.         Makes sure that sqlmigrate does something.
382.         """
383.         # Cannot generate the reverse SQL unless we've applied the migration.
384.         call_command("migrate", "migrations", verbosity=0)
385. 
386.         out = six.StringIO()
387.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)
388.         output = out.getvalue().lower()
389. 
390.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
391.         index_op_desc_unique_together = output.find('-- alter unique_together')
392.         index_op_desc_tribble = output.find('-- create model tribble')
393.         index_op_desc_author = output.find('-- create model author')
394.         index_drop_table = output.rfind('drop table')
395.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
396. 
397.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
398.         self.assertGreater(
399.             index_op_desc_unique_together, index_tx_start,
400.             "Operation description (unique_together) not found or found before transaction start"
401.         )
402.         self.assertGreater(
403.             index_op_desc_tribble, index_op_desc_unique_together,
404.             "Operation description (tribble) not found or found before operation description (unique_together)"
405.         )
406.         self.assertGreater(
407.             index_op_desc_author, index_op_desc_tribble,
408.             "Operation description (author) not found or found before operation description (tribble)"
409.         )
410. 
411.         self.assertGreater(
412.             index_drop_table, index_op_desc_author,
413.             "DROP TABLE not found or found before operation description (author)"
414.         )
415.         self.assertGreater(
416.             index_tx_end, index_op_desc_unique_together,
417.             "Transaction end not found or found before DROP TABLE"
418.         )
419. 
420.         # Cleanup by unmigrating everything
421.         call_command("migrate", "migrations", "zero", verbosity=0)
422. 
423.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})
424.     def test_sqlmigrate_for_non_atomic_migration(self):
425.         """
426.         Transaction wrappers aren't shown for non-atomic migrations.
427.         """
428.         out = six.StringIO()
429.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
430.         output = out.getvalue().lower()
431.         queries = [q.strip() for q in output.splitlines()]
432.         if connection.ops.start_transaction_sql():
433.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)
434.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)
435. 
436.     @override_settings(
437.         INSTALLED_APPS=[
438.             "migrations.migrations_test_apps.migrated_app",
439.             "migrations.migrations_test_apps.migrated_unapplied_app",
440.             "migrations.migrations_test_apps.unmigrated_app"])
441.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):
442.         """
443.         https://code.djangoproject.com/ticket/22823
444. 
445.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:
446. 
447.         * `A` has migrations
448.         * `B` has a migration we want to apply
449.         * `C` has no migrations, but has an FK to `A`
450. 
451.         When we try to migrate "B", an exception occurs because the
452.         "B" was not included in the ProjectState that is used to detect
453.         soft-applied migrations.
454.         """
455.         call_command("migrate", "migrated_unapplied_app", stdout=six.StringIO())
456. 
457.         # unmigrated_app.SillyModel has a foreign key to 'migrations.Tribble',
458.         # but that model is only defined in a migration, so the global app
459.         # registry never sees it and the reference is left dangling. Remove it
460.         # to avoid problems in subsequent tests.
461.         del apps._pending_operations[('migrations', 'tribble')]
462. 
463.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
464.     def test_migrate_record_replaced(self):
465.         """
466.         Running a single squashed migration should record all of the original
467.         replaced migrations as run.
468.         """
469.         recorder = MigrationRecorder(connection)
470.         out = six.StringIO()
471.         call_command("migrate", "migrations", verbosity=0)
472.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
473.         self.assertEqual(
474.             'migrations\n'
475.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
476.             out.getvalue().lower()
477.         )
478.         applied_migrations = recorder.applied_migrations()
479.         self.assertIn(("migrations", "0001_initial"), applied_migrations)
480.         self.assertIn(("migrations", "0002_second"), applied_migrations)
481.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)
482.         # Rollback changes
483.         call_command("migrate", "migrations", "zero", verbosity=0)
484. 
485.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
486.     def test_migrate_record_squashed(self):
487.         """
488.         Running migrate for a squashed migration should record as run
489.         if all of the replaced migrations have been run (#25231).
490.         """
491.         recorder = MigrationRecorder(connection)
492.         recorder.record_applied("migrations", "0001_initial")
493.         recorder.record_applied("migrations", "0002_second")
494.         out = six.StringIO()
495.         call_command("migrate", "migrations", verbosity=0)
496.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
497.         self.assertEqual(
498.             'migrations\n'
499.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
500.             out.getvalue().lower()


File: tests/migrations/test_commands.py
Line number range: 523 - 1202
Content:
class MakeMigrationsTests(MigrationTestBase):
    """
    Tests running the makemigrations command.
    """

    def setUp(self):
        super(MakeMigrationsTests, self).setUp()
        self._old_models = apps.app_configs['migrations'].models.copy()

    def tearDown(self):
        apps.app_configs['migrations'].models = self._old_models
        apps.all_models['migrations'] = self._old_models
        apps.clear_cache()
        super(MakeMigrationsTests, self).tearDown()

    def test_files_content(self):
        self.assertTableNotExists("migrations_unicodemodel")
        apps.register_model('migrations', UnicodeModel)
        with self.temporary_migration_module() as migration_dir:
            call_command("makemigrations", "migrations", verbosity=0)

            # Check for empty __init__.py file in migrations folder
            init_file = os.path.join(migration_dir, "__init__.py")
            self.assertTrue(os.path.exists(init_file))

            with open(init_file, 'r') as fp:
                content = force_text(fp.read())
            self.assertEqual(content, '')

            # Check for existing 0001_initial.py file in migration folder
            initial_file = os.path.join(migration_dir, "0001_initial.py")
            self.assertTrue(os.path.exists(initial_file))

            with io.open(initial_file, 'r', encoding='utf-8') as fp:
                content = fp.read()
                self.assertIn('# -*- coding: utf-8 -*-', content)
                self.assertIn('migrations.CreateModel', content)
                self.assertIn('initial = True', content)

                if six.PY3:
                    self.assertIn('úñí©óðé µóðéø', content)  # Meta.verbose_name
                    self.assertIn('úñí©óðé µóðéøß', content)  # Meta.verbose_name_plural
                    self.assertIn('ÚÑÍ¢ÓÐÉ', content)  # title.verbose_name
                    self.assertIn('“Ðjáñgó”', content)  # title.default
                else:
                    # Meta.verbose_name
                    self.assertIn('\\xfa\\xf1\\xed\\xa9\\xf3\\xf0\\xe9 \\xb5\\xf3\\xf0\\xe9\\xf8', content)
                    # Meta.verbose_name_plural
                    self.assertIn('\\xfa\\xf1\\xed\\xa9\\xf3\\xf0\\xe9 \\xb5\\xf3\\xf0\\xe9\\xf8\\xdf', content)
                    self.assertIn('\\xda\\xd1\\xcd\\xa2\\xd3\\xd0\\xc9', content)  # title.verbose_name
                    self.assertIn('\\u201c\\xd0j\\xe1\\xf1g\\xf3\\u201d', content)  # title.default

    def test_makemigrations_order(self):
        """
        makemigrations should recognize number-only migrations (0001.py).
        """
        module = 'migrations.test_migrations_order'
        with self.temporary_migration_module(module=module) as migration_dir:
            if hasattr(importlib, 'invalidate_caches'):
                # Python 3 importlib caches os.listdir() on some platforms like
                # Mac OS X (#23850).
                importlib.invalidate_caches()
            call_command('makemigrations', 'migrations', '--empty', '-n', 'a', '-v', '0')
            self.assertTrue(os.path.exists(os.path.join(migration_dir, '0002_a.py')))

    def test_makemigrations_empty_connections(self):
        empty_connections = ConnectionHandler({'default': {}})
        with mock.patch('django.core.management.commands.makemigrations.connections', new=empty_connections):
            # with no apps
            out = six.StringIO()
            call_command('makemigrations', stdout=out)
            self.assertIn('No changes detected', out.getvalue())
            # with an app
            with self.temporary_migration_module() as migration_dir:
                call_command('makemigrations', 'migrations', verbosity=0)
                init_file = os.path.join(migration_dir, '__init__.py')
                self.assertTrue(os.path.exists(init_file))

    def test_makemigrations_consistency_checks_respect_routers(self):
        """
        The history consistency checks in makemigrations respect
        settings.DATABASE_ROUTERS.
        """
        def patched_ensure_schema(migration_recorder):
            if migration_recorder.connection is connections['other']:
                raise MigrationSchemaMissing('Patched')
            else:
                return mock.DEFAULT

        self.assertTableNotExists('migrations_unicodemodel')
        apps.register_model('migrations', UnicodeModel)
        with mock.patch.object(
                MigrationRecorder, 'ensure_schema',
                autospec=True, side_effect=patched_ensure_schema) as ensure_schema:
            with self.temporary_migration_module() as migration_dir:
                call_command("makemigrations", "migrations", verbosity=0)
                initial_file = os.path.join(migration_dir, "0001_initial.py")
                self.assertTrue(os.path.exists(initial_file))
                self.assertEqual(ensure_schema.call_count, 1)  # 'default' is checked

                # Router says not to migrate 'other' so consistency shouldn't
                # be checked.
                with self.settings(DATABASE_ROUTERS=['migrations.routers.TestRouter']):
                    call_command('makemigrations', 'migrations', verbosity=0)
                self.assertEqual(ensure_schema.call_count, 2)  # 'default' again

                # With a router that doesn't prohibit migrating 'other',
                # consistency is checked.
                with self.settings(DATABASE_ROUTERS=['migrations.routers.EmptyRouter']):
                    with self.assertRaisesMessage(MigrationSchemaMissing, 'Patched'):
                        call_command('makemigrations', 'migrations', verbosity=0)
                self.assertEqual(ensure_schema.call_count, 4)  # 'default' and 'other'

                # With a router that doesn't allow migrating on any database,
                # no consistency checks are made.
                with self.settings(DATABASE_ROUTERS=['migrations.routers.TestRouter']):
                    with mock.patch.object(TestRouter, 'allow_migrate', return_value=False) as allow_migrate:
                        call_command('makemigrations', 'migrations', verbosity=0)
                allow_migrate.assert_called_with('other', 'migrations', model_name='UnicodeModel')
                self.assertEqual(ensure_schema.call_count, 4)

    def test_failing_migration(self):
        # If a migration fails to serialize, it shouldn't generate an empty file. #21280
        apps.register_model('migrations', UnserializableModel)

        with self.temporary_migration_module() as migration_dir:
            with self.assertRaisesMessage(ValueError, 'Cannot serialize'):
                call_command("makemigrations", "migrations", verbosity=0)

            initial_file = os.path.join(migration_dir, "0001_initial.py")
            self.assertFalse(os.path.exists(initial_file))

    def test_makemigrations_conflict_exit(self):
        """
        Makes sure that makemigrations exits if it detects a conflict.
        """
        with self.temporary_migration_module(module="migrations.test_migrations_conflict"):
            with self.assertRaises(CommandError):
                call_command("makemigrations")

    def test_makemigrations_merge_no_conflict(self):
        """
        Makes sure that makemigrations exits if in merge mode with no conflicts.
        """
        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations"):
            call_command("makemigrations", merge=True, stdout=out)
        self.assertIn("No conflicts detected to merge.", out.getvalue())

    def test_makemigrations_no_app_sys_exit(self):
        """
        Makes sure that makemigrations exits if a non-existent app is specified.
        """
        err = six.StringIO()
        with self.assertRaises(SystemExit):
            call_command("makemigrations", "this_app_does_not_exist", stderr=err)
        self.assertIn("'this_app_does_not_exist' could not be found.", err.getvalue())

    def test_makemigrations_empty_no_app_specified(self):
        """
        Makes sure that makemigrations exits if no app is specified with 'empty' mode.
        """
        with self.assertRaises(CommandError):
            call_command("makemigrations", empty=True)

    def test_makemigrations_empty_migration(self):
        """
        Makes sure that makemigrations properly constructs an empty migration.
        """
        with self.temporary_migration_module() as migration_dir:
            call_command("makemigrations", "migrations", empty=True, verbosity=0)

            # Check for existing 0001_initial.py file in migration folder
            initial_file = os.path.join(migration_dir, "0001_initial.py")
            self.assertTrue(os.path.exists(initial_file))

            with io.open(initial_file, 'r', encoding='utf-8') as fp:
                content = fp.read()
                self.assertIn('# -*- coding: utf-8 -*-', content)

                # Remove all whitespace to check for empty dependencies and operations
                content = content.replace(' ', '')
                self.assertIn('dependencies=[\n]', content)
                self.assertIn('operations=[\n]', content)

    @override_settings(MIGRATION_MODULES={"migrations": None})
    def test_makemigrations_disabled_migrations_for_app(self):
        """
        makemigrations raises a nice error when migrations are disabled for an
        app.
        """
        msg = (
            "Django can't create migrations for app 'migrations' because migrations "
            "have been disabled via the MIGRATION_MODULES setting."
        )
        with self.assertRaisesMessage(ValueError, msg):
            call_command("makemigrations", "migrations", empty=True, verbosity=0)

    def test_makemigrations_no_changes_no_apps(self):
        """
        Makes sure that makemigrations exits when there are no changes and no apps are specified.
        """
        out = six.StringIO()
        call_command("makemigrations", stdout=out)
        self.assertIn("No changes detected", out.getvalue())

    def test_makemigrations_no_changes(self):
        """
        Makes sure that makemigrations exits when there are no changes to an app.
        """
        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
            call_command("makemigrations", "migrations", stdout=out)
        self.assertIn("No changes detected in app 'migrations'", out.getvalue())

    def test_makemigrations_no_apps_initial(self):
        """
        makemigrations should detect initial is needed on empty migration
        modules if no app provided.
        """
        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_empty"):
            call_command("makemigrations", stdout=out)
        self.assertIn("0001_initial.py", out.getvalue())

    def test_makemigrations_migrations_announce(self):
        """
        Makes sure that makemigrations announces the migration at the default verbosity level.
        """
        out = six.StringIO()
        with self.temporary_migration_module():
            call_command("makemigrations", "migrations", stdout=out)
        self.assertIn("Migrations for 'migrations'", out.getvalue())

    def test_makemigrations_no_common_ancestor(self):
        """
        Makes sure that makemigrations fails to merge migrations with no common ancestor.
        """
        with self.assertRaises(ValueError) as context:
            with self.temporary_migration_module(module="migrations.test_migrations_no_ancestor"):
                call_command("makemigrations", "migrations", merge=True)
        exception_message = str(context.exception)
        self.assertIn("Could not find common ancestor of", exception_message)
        self.assertIn("0002_second", exception_message)
        self.assertIn("0002_conflicting_second", exception_message)

    def test_makemigrations_interactive_reject(self):
        """
        Makes sure that makemigrations enters and exits interactive mode properly.
        """
        # Monkeypatch interactive questioner to auto reject
        with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='N')):
            with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
                call_command("makemigrations", "migrations", name="merge", merge=True, interactive=True, verbosity=0)
                merge_file = os.path.join(migration_dir, '0003_merge.py')
                self.assertFalse(os.path.exists(merge_file))

    def test_makemigrations_interactive_accept(self):
        """
        Makes sure that makemigrations enters interactive mode and merges properly.
        """
        # Monkeypatch interactive questioner to auto accept
        with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='y')):
            out = six.StringIO()
            with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
                call_command("makemigrations", "migrations", name="merge", merge=True, interactive=True, stdout=out)
                merge_file = os.path.join(migration_dir, '0003_merge.py')
                self.assertTrue(os.path.exists(merge_file))
            self.assertIn("Created new merge migration", out.getvalue())

    @mock.patch('django.db.migrations.utils.datetime')
    def test_makemigrations_default_merge_name(self, mock_datetime):
        mock_datetime.datetime.now.return_value = datetime.datetime(2016, 1, 2, 3, 4)
        with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='y')):
            out = six.StringIO()
            with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
                call_command("makemigrations", "migrations", merge=True, interactive=True, stdout=out)
                merge_file = os.path.join(migration_dir, '0003_merge_20160102_0304.py')
                self.assertTrue(os.path.exists(merge_file))
            self.assertIn("Created new merge migration", out.getvalue())

    def test_makemigrations_non_interactive_not_null_addition(self):
        """
        Tests that non-interactive makemigrations fails when a default is missing on a new not-null field.
        """
        class SillyModel(models.Model):
            silly_field = models.BooleanField(default=False)
            silly_int = models.IntegerField()

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        with self.assertRaises(SystemExit):
            with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
                call_command("makemigrations", "migrations", interactive=False, stdout=out)

    def test_makemigrations_non_interactive_not_null_alteration(self):
        """
        Tests that non-interactive makemigrations fails when a default is missing on a field changed to not-null.
        """
        class Author(models.Model):
            name = models.CharField(max_length=255)
            slug = models.SlugField()
            age = models.IntegerField(default=0)

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations"):
            call_command("makemigrations", "migrations", interactive=False, stdout=out)
        self.assertIn("Alter field slug on author", out.getvalue())

    def test_makemigrations_non_interactive_no_model_rename(self):
        """
        Makes sure that makemigrations adds and removes a possible model rename in non-interactive mode.
        """
        class RenamedModel(models.Model):
            silly_field = models.BooleanField(default=False)

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
            call_command("makemigrations", "migrations", interactive=False, stdout=out)
        self.assertIn("Delete model SillyModel", out.getvalue())
        self.assertIn("Create model RenamedModel", out.getvalue())

    def test_makemigrations_non_interactive_no_field_rename(self):
        """
        Makes sure that makemigrations adds and removes a possible field rename in non-interactive mode.
        """
        class SillyModel(models.Model):
            silly_rename = models.BooleanField(default=False)

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
            call_command("makemigrations", "migrations", interactive=False, stdout=out)
        self.assertIn("Remove field silly_field from sillymodel", out.getvalue())
        self.assertIn("Add field silly_rename to sillymodel", out.getvalue())

    def test_makemigrations_handle_merge(self):
        """
        Makes sure that makemigrations properly merges the conflicting migrations with --noinput.
        """
        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
            call_command("makemigrations", "migrations", name="merge", merge=True, interactive=False, stdout=out)
            merge_file = os.path.join(migration_dir, '0003_merge.py')
            self.assertTrue(os.path.exists(merge_file))
        output = out.getvalue()
        self.assertIn("Merging migrations", output)
        self.assertIn("Branch 0002_second", output)
        self.assertIn("Branch 0002_conflicting_second", output)
        self.assertIn("Created new merge migration", output)

    def test_makemigration_merge_dry_run(self):
        """
        Makes sure that makemigrations respects --dry-run option when fixing
        migration conflicts (#24427).
        """
        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
            call_command(
                "makemigrations", "migrations", name="merge", dry_run=True,
                merge=True, interactive=False, stdout=out,
            )
            merge_file = os.path.join(migration_dir, '0003_merge.py')
            self.assertFalse(os.path.exists(merge_file))
        output = out.getvalue()
        self.assertIn("Merging migrations", output)
        self.assertIn("Branch 0002_second", output)
        self.assertIn("Branch 0002_conflicting_second", output)
        self.assertNotIn("Created new merge migration", output)

    def test_makemigration_merge_dry_run_verbosity_3(self):
        """
        Makes sure that `makemigrations --merge --dry-run` writes the merge
        migration file to stdout with `verbosity == 3` (#24427).
        """
        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
            call_command(
                "makemigrations", "migrations", name="merge", dry_run=True,
                merge=True, interactive=False, stdout=out, verbosity=3,
            )
            merge_file = os.path.join(migration_dir, '0003_merge.py')
            self.assertFalse(os.path.exists(merge_file))
        output = out.getvalue()
        self.assertIn("Merging migrations", output)
        self.assertIn("Branch 0002_second", output)
        self.assertIn("Branch 0002_conflicting_second", output)
        self.assertNotIn("Created new merge migration", output)

        # Additional output caused by verbosity 3
        # The complete merge migration file that would be written
        # '\n#' is to verify no bytestring prefix before #
        self.assertIn("\n# -*- coding: utf-8 -*-", output)
        self.assertIn("class Migration(migrations.Migration):", output)
        self.assertIn("dependencies = [", output)
        self.assertIn("('migrations', '0002_second')", output)
        self.assertIn("('migrations', '0002_conflicting_second')", output)
        self.assertIn("operations = [", output)
        self.assertIn("]", output)

    def test_makemigrations_dry_run(self):
        """
        Ticket #22676 -- `makemigrations --dry-run` should not ask for defaults.
        """

        class SillyModel(models.Model):
            silly_field = models.BooleanField(default=False)
            silly_date = models.DateField()  # Added field without a default

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
            call_command("makemigrations", "migrations", dry_run=True, stdout=out)
        # Output the expected changes directly, without asking for defaults
        self.assertIn("Add field silly_date to sillymodel", out.getvalue())

    def test_makemigrations_dry_run_verbosity_3(self):
        """
        Ticket #22675 -- Allow `makemigrations --dry-run` to output the
        migrations file to stdout (with verbosity == 3).
        """

        class SillyModel(models.Model):
            silly_field = models.BooleanField(default=False)
            silly_char = models.CharField(default="")

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
            call_command("makemigrations", "migrations", dry_run=True, stdout=out, verbosity=3)

        # Normal --dry-run output
        self.assertIn("- Add field silly_char to sillymodel", out.getvalue())

        # Additional output caused by verbosity 3
        # The complete migrations file that would be written
        self.assertIn("# -*- coding: utf-8 -*-", out.getvalue())
        self.assertIn("class Migration(migrations.Migration):", out.getvalue())
        self.assertIn("dependencies = [", out.getvalue())
        self.assertIn("('migrations', '0001_initial'),", out.getvalue())
        self.assertIn("migrations.AddField(", out.getvalue())
        self.assertIn("model_name='sillymodel',", out.getvalue())
        self.assertIn("name='silly_char',", out.getvalue())

    def test_makemigrations_migrations_modules_path_not_exist(self):
        """
        Ticket #22682 -- Makemigrations fails when specifying custom location
        for migration files (using MIGRATION_MODULES) if the custom path
        doesn't already exist.
        """

        class SillyModel(models.Model):
            silly_field = models.BooleanField(default=False)

            class Meta:
                app_label = "migrations"

        out = six.StringIO()
        migration_module = "migrations.test_migrations_path_doesnt_exist.foo.bar"
        with self.temporary_migration_module(module=migration_module) as migration_dir:
            call_command("makemigrations", "migrations", stdout=out)

            # Migrations file is actually created in the expected path.
            initial_file = os.path.join(migration_dir, "0001_initial.py")
            self.assertTrue(os.path.exists(initial_file))

        # Command output indicates the migration is created.
        self.assertIn(" - Create model SillyModel", out.getvalue())

    def test_makemigrations_interactive_by_default(self):
        """
        Makes sure that the user is prompted to merge by default if there are
        conflicts and merge is True. Answer negative to differentiate it from
        behavior when --noinput is specified.
        """
        # Monkeypatch interactive questioner to auto reject
        out = six.StringIO()
        with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='N')):
            with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
                call_command("makemigrations", "migrations", name="merge", merge=True, stdout=out)
                merge_file = os.path.join(migration_dir, '0003_merge.py')
                # This will fail if interactive is False by default
                self.assertFalse(os.path.exists(merge_file))
            self.assertNotIn("Created new merge migration", out.getvalue())

    @override_settings(
        INSTALLED_APPS=[
            "migrations",
            "migrations.migrations_test_apps.unspecified_app_with_conflict"])
    def test_makemigrations_unspecified_app_with_conflict_no_merge(self):
        """
        Makes sure that makemigrations does not raise a CommandError when an
        unspecified app has conflicting migrations.
        """
        with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
            call_command("makemigrations", "migrations", merge=False, verbosity=0)

    @override_settings(
        INSTALLED_APPS=[
            "migrations.migrations_test_apps.migrated_app",
            "migrations.migrations_test_apps.unspecified_app_with_conflict"])
    def test_makemigrations_unspecified_app_with_conflict_merge(self):
        """
        Makes sure that makemigrations does not create a merge for an
        unspecified app even if it has conflicting migrations.
        """
        # Monkeypatch interactive questioner to auto accept
        with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='y')):
            out = six.StringIO()
            with self.temporary_migration_module(app_label="migrated_app") as migration_dir:
                call_command("makemigrations", "migrated_app", name="merge", merge=True, interactive=True, stdout=out)
                merge_file = os.path.join(migration_dir, '0003_merge.py')
                self.assertFalse(os.path.exists(merge_file))
            self.assertIn("No conflicts detected to merge.", out.getvalue())

    @override_settings(
        INSTALLED_APPS=[
            "migrations.migrations_test_apps.migrated_app",
            "migrations.migrations_test_apps.conflicting_app_with_dependencies"])
    def test_makemigrations_merge_dont_output_dependency_operations(self):
        """
        Makes sure that makemigrations --merge does not output any operations
        from apps that don't belong to a given app.
        """
        # Monkeypatch interactive questioner to auto accept
        with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='N')):
            out = six.StringIO()
            with mock.patch('django.core.management.color.supports_color', lambda *args: False):
                call_command(
                    "makemigrations", "conflicting_app_with_dependencies",
                    merge=True, interactive=True, stdout=out
                )
            val = out.getvalue().lower()
            self.assertIn('merging conflicting_app_with_dependencies\n', val)
            self.assertIn(
                '  branch 0002_conflicting_second\n'
                '    - create model something\n',
                val
            )
            self.assertIn(
                '  branch 0002_second\n'
                '    - delete model tribble\n'
                '    - remove field silly_field from author\n'
                '    - add field rating to author\n'
                '    - create model book\n',
                val
            )

    def test_makemigrations_with_custom_name(self):
        """
        Makes sure that makemigrations generate a custom migration.
        """
        with self.temporary_migration_module() as migration_dir:

            def cmd(migration_count, migration_name, *args):
                call_command("makemigrations", "migrations", "--verbosity", "0", "--name", migration_name, *args)
                migration_file = os.path.join(migration_dir, "%s_%s.py" % (migration_count, migration_name))
                # Check for existing migration file in migration folder
                self.assertTrue(os.path.exists(migration_file))
                with io.open(migration_file, "r", encoding="utf-8") as fp:
                    content = fp.read()
                    self.assertIn("# -*- coding: utf-8 -*-", content)
                    content = content.replace(" ", "")
                return content

            # generate an initial migration
            migration_name_0001 = "my_initial_migration"
            content = cmd("0001", migration_name_0001)
            self.assertIn("dependencies=[\n]", content)

            # Python 3 importlib caches os.listdir() on some platforms like
            # Mac OS X (#23850).
            if hasattr(importlib, 'invalidate_caches'):
                importlib.invalidate_caches()

            # generate an empty migration
            migration_name_0002 = "my_custom_migration"
            content = cmd("0002", migration_name_0002, "--empty")
            self.assertIn("dependencies=[\n('migrations','0001_%s'),\n]" % migration_name_0001, content)
            self.assertIn("operations=[\n]", content)

    @ignore_warnings(category=RemovedInDjango20Warning)
    def test_makemigrations_exit(self):
        """
        makemigrations --exit should exit with sys.exit(1) when there are no
        changes to an app.
        """
        with self.temporary_migration_module():
            call_command("makemigrations", "--exit", "migrations", verbosity=0)

        with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
            with self.assertRaises(SystemExit):
                call_command("makemigrations", "--exit", "migrations", verbosity=0)

    def test_makemigrations_check(self):
        """
        makemigrations --check should exit with a non-zero status when
        there are changes to an app requiring migrations.
        """
        with self.temporary_migration_module():
            with self.assertRaises(SystemExit):
                call_command("makemigrations", "--check", "migrations", verbosity=0)

        with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
            call_command("makemigrations", "--check", "migrations", verbosity=0)

    def test_makemigrations_migration_path_output(self):
        """
        makemigrations should print the relative paths to the migrations unless
        they are outside of the current tree, in which case the absolute path
        should be shown.
        """
        out = six.StringIO()
        apps.register_model('migrations', UnicodeModel)
        with self.temporary_migration_module() as migration_dir:
            call_command("makemigrations", "migrations", stdout=out)
            self.assertIn(os.path.join(migration_dir, '0001_initial.py'), out.getvalue())

    def test_makemigrations_migration_path_output_valueerror(self):
        """
        makemigrations prints the absolute path if os.path.relpath() raises a
        ValueError when it's impossible to obtain a relative path, e.g. on
        Windows if Django is installed on a different drive than where the
        migration files are created.
        """
        out = six.StringIO()
        with self.temporary_migration_module() as migration_dir:
            with mock.patch('os.path.relpath', side_effect=ValueError):
                call_command('makemigrations', 'migrations', stdout=out)
        self.assertIn(os.path.join(migration_dir, '0001_initial.py'), out.getvalue())

    def test_makemigrations_inconsistent_history(self):
        """
        makemigrations should raise InconsistentMigrationHistory exception if
        there are some migrations applied before their dependencies.
        """
        recorder = MigrationRecorder(connection)
        recorder.record_applied('migrations', '0002_second')
        msg = "Migration migrations.0002_second is applied before its dependency migrations.0001_initial"
        with self.temporary_migration_module(module="migrations.test_migrations"):
            with self.assertRaisesMessage(InconsistentMigrationHistory, msg):
                call_command("makemigrations")

    @mock.patch('django.db.migrations.questioner.input', return_value='1')
    @mock.patch('django.db.migrations.questioner.sys.stdin', mock.MagicMock(encoding=sys.getdefaultencoding()))
    def test_makemigrations_auto_now_add_interactive(self, *args):
        """
        makemigrations prompts the user when adding auto_now_add to an existing
        model.
        """
        class Entry(models.Model):
            title = models.CharField(max_length=255)
            creation_date = models.DateTimeField(auto_now_add=True)

            class Meta:
                app_label = 'migrations'

        # Monkeypatch interactive questioner to auto accept
        with mock.patch('django.db.migrations.questioner.sys.stdout', new_callable=six.StringIO) as prompt_stdout:
            out = six.StringIO()
            with self.temporary_migration_module(module='migrations.test_auto_now_add'):
                call_command('makemigrations', 'migrations', interactive=True, stdout=out)
            output = out.getvalue()
            prompt_output = prompt_stdout.getvalue()
            self.assertIn("You can accept the default 'timezone.now' by pressing 'Enter'", prompt_output)
            self.assertIn("Add field creation_date to entry", output)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 17:17:19,396 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of `tests/migrations/routers.py`.\n   - This file defines `TestRouter` and `EmptyRouter`.\n2. Extended relevance:\n   - `TestRouter` is used in the tests for `makemigrations` to control database routing behavior, which is central to the user's query about finding tests related to database routers.", relative_path='tests/migrations/routers.py', start_line=1, end_line=13), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested test classes and methods related to the 'makemigrations' command from `tests/migrations/test_commands.py`.\n   - This context contains the complete `MakeMigrationsTests` class, which is dedicated to testing the `makemigrations` command.\n2. Extended relevance:\n   - This class contains the test `test_makemigrations_consistency_checks_respect_routers`, which directly tests the interaction between `makemigrations` and database routers, matching the user's specific interest in finding tests for a related bug.", relative_path='tests/migrations/test_commands.py', start_line=523, end_line=1202)]
2025-12-24 17:17:19,463 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`.
2025-12-24 17:17:19,463 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 17:17:19,464 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 17:17:19,464 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 3 existing contexts
2025-12-24 17:17:19,464 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 5 total contexts (removed 0 duplicates)
2025-12-24 17:17:19,466 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_static.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── registration
|   |   |   ├── tests
|   |   |   |   ├── __init__.py
|   |   |   |   └── utils.py
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── libgeoip.py
|   |   |   |   └── prototypes.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backend
|   |   |   |   └── regex.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   ├── srs.py
|   |   |   |   └── wkt.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── locale
|   |   |   |   ├── ar
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── he
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── id
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── signals.py
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── staticfiles.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   ├── __init__.py
|   |   |   |   ├── django_1_10.py
|   |   |   |   └── django_1_8_0.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── urls.py
|   |   |   └── utils.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── urlresolvers.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── utils.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── version.py
|   |   |   ├── postgresql_psycopg2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── version.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   └── special.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── topological_sort.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── deletion.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── datetime.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   ├── license.txt
|   |   └── weakref_backports.py
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── extras
|   |   |   ├── __init__.py
|   |   |   └── widgets.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── models.py
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── eggs.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── glob.py
|   |   ├── html.py
|   |   ├── html_parser.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── lru_cache.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── six.py
|   |   ├── synch.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       └── static.py
├── docs
|   ├── _ext
|   |   ├── cve_role.py
|   |   ├── djangodocs.py
|   |   └── ticket_role.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── jython.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   ├── roles.txt
|   |   ├── security.txt
|   |   └── team.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   ├── language.txt
|   |   |   └── upgrading.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── python3.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── RelatedObjectLookups.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   ├── jsi18n-mocks.test.js
|   |   └── timeparse.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   ├── qunit
|   |   ├── blanket.js
|   |   ├── grunt-reporter.js
|   |   ├── qunit.css
|   |   └── qunit.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_adminsite.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   └── with_integer_username.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_auth_backends_deprecation.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_deprecated_views.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   ├── urls_custom_user_admin.py
    |   └── urls_deprecated.py
    ├── backends
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_creation.py
    |   ├── test_features.py
    |   ├── test_mysql.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   └── tests.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   ├── tests_1_10_compatibility.py
    |   ├── tests_1_8_compatibility.py
    |   └── urls
    |       ├── __init__.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       └── warning_in_include.py
    ├── choices
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_models.py
    |   ├── test_order_with_respect_to.py
    |   ├── tests.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── test_context_processor.py
    |   └── tests.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_cast.py
    |   ├── test_datetime.py
    |   └── tests.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   └── test_postgresql_psycopg2.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   |   └── fixture2.xml
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       └── article_form.html
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   └── test_srs.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_geoforms.py
    |   ├── test_geoip.py
    |   ├── test_geoip2.py
    |   ├── test_measure.py
    |   ├── test_spatialrefsys.py
    |   ├── test_wkt.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── test_legacy.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_permalink
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_array.py
    |   ├── test_citext.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_json.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── base.txt
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   ├── py2.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   └── custom_sitemap_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   └── urls
    |       ├── __init__.py
    |       ├── http.py
    |       └── https.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       └── syntax_error2.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_i18n.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── broken_base.html
    |   |   ├── first
    |   |   |   └── test.html
    |   |   ├── included_base.html
    |   |   ├── included_content.html
    |   |   ├── inclusion.html
    |   |   ├── inclusion_base.html
    |   |   ├── inclusion_extends1.html
    |   |   ├── inclusion_extends2.html
    |   |   ├── index.html
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   ├── recursive_include.html
    |   |   ├── response.html
    |   |   ├── second
    |   |   |   └── test.html
    |   |   ├── ssi include with spaces.html
    |   |   ├── ssi_include.html
    |   |   ├── template_tests
    |   |   |   └── using.html
    |   |   ├── test_context.html
    |   |   ├── test_context_stack.html
    |   |   ├── test_extends_error.html
    |   |   ├── test_incl_tag_use_l10n.html
    |   |   └── test_include_error.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   └── testtags.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── test_unicode.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── base.html
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   |   ├── add_form.html
    |   |   ├── app_index.html
    |   |   ├── change_form.html
    |   |   ├── change_list.html
    |   |   ├── delete_confirmation.html
    |   |   ├── delete_selected_confirmation.html
    |   |   ├── index.html
    |   |   ├── login.html
    |   |   ├── logout.html
    |   |   ├── object_history.html
    |   |   ├── password_change_done.html
    |   |   └── password_change_form.html
    |   ├── extended.html
    |   ├── form_view.html
    |   ├── login.html
    |   └── views
    |       ├── article_archive_day.html
    |       ├── article_archive_month.html
    |       ├── article_confirm_delete.html
    |       ├── article_detail.html
    |       ├── article_form.html
    |       ├── article_list.html
    |       ├── datearticle_archive_month.html
    |       ├── urlarticle_detail.html
    |       └── urlarticle_form.html
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   |   └── 404.html
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   |   ├── request_context.html
    |   |   └── unicode.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_discovery_sample
    |   ├── __init__.py
    |   ├── doctests.py
    |   ├── empty.py
    |   ├── pattern_tests.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tests_sample.py
    ├── test_discovery_sample2
    |   ├── __init__.py
    |   └── tests.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   |       ├── alternative.html
    |   |       ├── base.html
    |   |       ├── extends.html
    |   |       └── include.html
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── tests.py
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_full_import.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── leave_locale_alone_false.py
    |   |       ├── leave_locale_alone_true.py
    |   |       ├── reverse_url.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   ├── strip_tags1.html
    |   |   └── strip_tags2.txt
    |   ├── locale
    |   |   └── nl
    |   |       └── LC_MESSAGES
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_deprecation.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_glob.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_itercompat.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   └── test_tree.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── file.txt
    |   |   └── long-line.txt
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   ├── debug
    |   |   |   └── template_exception.html
    |   |   ├── jsi18n-multi-catalogs.html
    |   |   ├── jsi18n.html
    |   |   ├── old_jsi18n-multi-catalogs.html
    |   |   └── old_jsi18n.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── py3_test_debug.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_i18n_deprecated.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: makemigrations router.allow_migrate() calls for consistency checks use incorrect (app_label, model) pairs

Description: Description
	
As reported in ticket:27200#comment:14, I makemigrations incorrectly calls allow_migrate() for each app with all the models in the project rather than for each app with the app's models. It broke the router I use because it was passing invalid combinations for shards since not all shards have the same models.
[​​https://github.com/django/django/pull/7530 PR]

Patch information:
diff --git a/django/core/management/commands/makemigrations.py b/django/core/management/commands/makemigrations.py
index 0b39536f5b..e648880ef0 100644
--- a/django/core/management/commands/makemigrations.py
+++ b/django/core/management/commands/makemigrations.py
@@ -105,7 +105,7 @@ class Command(BaseCommand):
                     # At least one model must be migrated to the database.
                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
                     for app_label in consistency_check_labels
-                    for model in apps.get_models(app_label)
+                    for model in apps.get_app_config(app_label).get_models()
             )):
                 loader.check_consistent_history(connection)
 


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `django/core/management/commands/makemigrations.py`, `tests/migrations/test_commands.py`, and `tests/migrations/test_multidb.py`.
Extra Requirements: 
Purpose: These files are essential to understand the `makemigrations` command and find existing tests that cover scenarios with database routers and multiple applications, which is where the bug occurs.

Previous refined query 2:
Essential Query: Please provide the full content of `tests/migrations/test_commands.py` and `tests/migrations/routers.py`.
Extra Requirements: If `tests/migrations/test_commands.py` is too large, please at least provide all test classes and methods related to the 'makemigrations' command.
Purpose: I need to find test cases for the `makemigrations` command that involve database routers to identify tests that are relevant to the described bug about the bug regarding the reported bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: django/core/management/commands/makemigrations.py
Line number range: 1 - 322
Content:
1. import io
2. import os
3. import sys
4. import warnings
5. from itertools import takewhile
6. 
7. from django.apps import apps
8. from django.conf import settings
9. from django.core.management.base import BaseCommand, CommandError
10. from django.db import DEFAULT_DB_ALIAS, connections, router
11. from django.db.migrations import Migration
12. from django.db.migrations.autodetector import MigrationAutodetector
13. from django.db.migrations.loader import MigrationLoader
14. from django.db.migrations.questioner import (
15.     InteractiveMigrationQuestioner, MigrationQuestioner,
16.     NonInteractiveMigrationQuestioner,
17. )
18. from django.db.migrations.state import ProjectState
19. from django.db.migrations.utils import get_migration_name_timestamp
20. from django.db.migrations.writer import MigrationWriter
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.six import iteritems
23. from django.utils.six.moves import zip
24. 
25. 
26. class Command(BaseCommand):
27.     help = "Creates new migration(s) for apps."
28. 
29.     def add_arguments(self, parser):
30.         parser.add_argument(
31.             'args', metavar='app_label', nargs='*',
32.             help='Specify the app label(s) to create migrations for.',
33.         )
34.         parser.add_argument(
35.             '--dry-run', action='store_true', dest='dry_run', default=False,
36.             help="Just show what migrations would be made; don't actually write them.",
37.         )
38.         parser.add_argument(
39.             '--merge', action='store_true', dest='merge', default=False,
40.             help="Enable fixing of migration conflicts.",
41.         )
42.         parser.add_argument(
43.             '--empty', action='store_true', dest='empty', default=False,
44.             help="Create an empty migration.",
45.         )
46.         parser.add_argument(
47.             '--noinput', '--no-input',
48.             action='store_false', dest='interactive', default=True,
49.             help='Tells Django to NOT prompt the user for input of any kind.',
50.         )
51.         parser.add_argument(
52.             '-n', '--name', action='store', dest='name', default=None,
53.             help="Use this name for migration file(s).",
54.         )
55.         parser.add_argument(
56.             '-e', '--exit', action='store_true', dest='exit_code', default=False,
57.             help='Exit with error code 1 if no changes needing migrations are found. '
58.                  'Deprecated, use the --check option instead.',
59.         )
60.         parser.add_argument(
61.             '--check', action='store_true', dest='check_changes',
62.             help='Exit with a non-zero status if model changes are missing migrations.',
63.         )
64. 
65.     def handle(self, *app_labels, **options):
66.         self.verbosity = options['verbosity']
67.         self.interactive = options['interactive']
68.         self.dry_run = options['dry_run']
69.         self.merge = options['merge']
70.         self.empty = options['empty']
71.         self.migration_name = options['name']
72.         self.exit_code = options['exit_code']
73.         check_changes = options['check_changes']
74. 
75.         if self.exit_code:
76.             warnings.warn(
77.                 "The --exit option is deprecated in favor of the --check option.",
78.                 RemovedInDjango20Warning
79.             )
80. 
81.         # Make sure the app they asked for exists
82.         app_labels = set(app_labels)
83.         bad_app_labels = set()
84.         for app_label in app_labels:
85.             try:
86.                 apps.get_app_config(app_label)
87.             except LookupError:
88.                 bad_app_labels.add(app_label)
89.         if bad_app_labels:
90.             for app_label in bad_app_labels:
91.                 self.stderr.write("App '%s' could not be found. Is it in INSTALLED_APPS?" % app_label)
92.             sys.exit(2)
93. 
94.         # Load the current graph state. Pass in None for the connection so
95.         # the loader doesn't try to resolve replaced migrations from DB.
96.         loader = MigrationLoader(None, ignore_no_migrations=True)
97. 
98.         # Raise an error if any migrations are applied before their dependencies.
99.         consistency_check_labels = set(config.label for config in apps.get_app_configs())
100.         # Non-default databases are only checked if database routers used.
101.         aliases_to_check = connections if settings.DATABASE_ROUTERS else [DEFAULT_DB_ALIAS]
102.         for alias in sorted(aliases_to_check):
103.             connection = connections[alias]
104.             if (connection.settings_dict['ENGINE'] != 'django.db.backends.dummy' and any(
105.                     # At least one model must be migrated to the database.
106.                     router.allow_migrate(connection.alias, app_label, model_name=model._meta.object_name)
107.                     for app_label in consistency_check_labels
108.                     for model in apps.get_models(app_label)
109.             )):
110.                 loader.check_consistent_history(connection)
111. 
112.         # Before anything else, see if there's conflicting apps and drop out
113.         # hard if there are any and they don't want to merge
114.         conflicts = loader.detect_conflicts()
115. 
116.         # If app_labels is specified, filter out conflicting migrations for unspecified apps
117.         if app_labels:
118.             conflicts = {
119.                 app_label: conflict for app_label, conflict in iteritems(conflicts)
120.                 if app_label in app_labels
121.             }
122. 
123.         if conflicts and not self.merge:
124.             name_str = "; ".join(
125.                 "%s in %s" % (", ".join(names), app)
126.                 for app, names in conflicts.items()
127.             )
128.             raise CommandError(
129.                 "Conflicting migrations detected; multiple leaf nodes in the "
130.                 "migration graph: (%s).\nTo fix them run "
131.                 "'python manage.py makemigrations --merge'" % name_str
132.             )
133. 
134.         # If they want to merge and there's nothing to merge, then politely exit
135.         if self.merge and not conflicts:
136.             self.stdout.write("No conflicts detected to merge.")
137.             return
138. 
139.         # If they want to merge and there is something to merge, then
140.         # divert into the merge code
141.         if self.merge and conflicts:
142.             return self.handle_merge(loader, conflicts)
143. 
144.         if self.interactive:
145.             questioner = InteractiveMigrationQuestioner(specified_apps=app_labels, dry_run=self.dry_run)
146.         else:
147.             questioner = NonInteractiveMigrationQuestioner(specified_apps=app_labels, dry_run=self.dry_run)
148.         # Set up autodetector
149.         autodetector = MigrationAutodetector(
150.             loader.project_state(),
151.             ProjectState.from_apps(apps),
152.             questioner,
153.         )
154. 
155.         # If they want to make an empty migration, make one for each app
156.         if self.empty:
157.             if not app_labels:
158.                 raise CommandError("You must supply at least one app label when using --empty.")
159.             # Make a fake changes() result we can pass to arrange_for_graph
160.             changes = {
161.                 app: [Migration("custom", app)]
162.                 for app in app_labels
163.             }
164.             changes = autodetector.arrange_for_graph(
165.                 changes=changes,
166.                 graph=loader.graph,
167.                 migration_name=self.migration_name,
168.             )
169.             self.write_migration_files(changes)
170.             return
171. 
172.         # Detect changes
173.         changes = autodetector.changes(
174.             graph=loader.graph,
175.             trim_to_apps=app_labels or None,
176.             convert_apps=app_labels or None,
177.             migration_name=self.migration_name,
178.         )
179. 
180.         if not changes:
181.             # No changes? Tell them.
182.             if self.verbosity >= 1:
183.                 if len(app_labels) == 1:
184.                     self.stdout.write("No changes detected in app '%s'" % app_labels.pop())
185.                 elif len(app_labels) > 1:
186.                     self.stdout.write("No changes detected in apps '%s'" % ("', '".join(app_labels)))
187.                 else:
188.                     self.stdout.write("No changes detected")
189. 
190.             if self.exit_code:
191.                 sys.exit(1)
192.         else:
193.             self.write_migration_files(changes)
194.             if check_changes:
195.                 sys.exit(1)
196. 
197.     def write_migration_files(self, changes):
198.         """
199.         Takes a changes dict and writes them out as migration files.
200.         """
201.         directory_created = {}
202.         for app_label, app_migrations in changes.items():
203.             if self.verbosity >= 1:
204.                 self.stdout.write(self.style.MIGRATE_HEADING("Migrations for '%s':" % app_label) + "\n")
205.             for migration in app_migrations:
206.                 # Describe the migration
207.                 writer = MigrationWriter(migration)
208.                 if self.verbosity >= 1:
209.                     # Display a relative path if it's below the current working
210.                     # directory, or an absolute path otherwise.
211.                     try:
212.                         migration_string = os.path.relpath(writer.path)
213.                     except ValueError:
214.                         migration_string = writer.path
215.                     if migration_string.startswith('..'):
216.                         migration_string = writer.path
217.                     self.stdout.write("  %s:\n" % (self.style.MIGRATE_LABEL(migration_string),))
218.                     for operation in migration.operations:
219.                         self.stdout.write("    - %s\n" % operation.describe())
220.                 if not self.dry_run:
221.                     # Write the migrations file to the disk.
222.                     migrations_directory = os.path.dirname(writer.path)
223.                     if not directory_created.get(app_label):
224.                         if not os.path.isdir(migrations_directory):
225.                             os.mkdir(migrations_directory)
226.                         init_path = os.path.join(migrations_directory, "__init__.py")
227.                         if not os.path.isfile(init_path):
228.                             open(init_path, "w").close()
229.                         # We just do this once per app
230.                         directory_created[app_label] = True
231.                     migration_string = writer.as_string()
232.                     with io.open(writer.path, "w", encoding='utf-8') as fh:
233.                         fh.write(migration_string)
234.                 elif self.verbosity == 3:
235.                     # Alternatively, makemigrations --dry-run --verbosity 3
236.                     # will output the migrations to stdout rather than saving
237.                     # the file to the disk.
238.                     self.stdout.write(self.style.MIGRATE_HEADING(
239.                         "Full migrations file '%s':" % writer.filename) + "\n"
240.                     )
241.                     self.stdout.write("%s\n" % writer.as_string())
242. 
243.     def handle_merge(self, loader, conflicts):
244.         """
245.         Handles merging together conflicted migrations interactively,
246.         if it's safe; otherwise, advises on how to fix it.
247.         """
248.         if self.interactive:
249.             questioner = InteractiveMigrationQuestioner()
250.         else:
251.             questioner = MigrationQuestioner(defaults={'ask_merge': True})
252. 
253.         for app_label, migration_names in conflicts.items():
254.             # Grab out the migrations in question, and work out their
255.             # common ancestor.
256.             merge_migrations = []
257.             for migration_name in migration_names:
258.                 migration = loader.get_migration(app_label, migration_name)
259.                 migration.ancestry = [
260.                     mig for mig in loader.graph.forwards_plan((app_label, migration_name))
261.                     if mig[0] == migration.app_label
262.                 ]
263.                 merge_migrations.append(migration)
264. 
265.             def all_items_equal(seq):
266.                 return all(item == seq[0] for item in seq[1:])
267. 
268.             merge_migrations_generations = zip(*[m.ancestry for m in merge_migrations])
269.             common_ancestor_count = sum(1 for common_ancestor_generation
270.                                         in takewhile(all_items_equal, merge_migrations_generations))
271.             if not common_ancestor_count:
272.                 raise ValueError("Could not find common ancestor of %s" % migration_names)
273.             # Now work out the operations along each divergent branch
274.             for migration in merge_migrations:
275.                 migration.branch = migration.ancestry[common_ancestor_count:]
276.                 migrations_ops = (loader.get_migration(node_app, node_name).operations
277.                                   for node_app, node_name in migration.branch)
278.                 migration.merged_operations = sum(migrations_ops, [])
279.             # In future, this could use some of the Optimizer code
280.             # (can_optimize_through) to automatically see if they're
281.             # mergeable. For now, we always just prompt the user.
282.             if self.verbosity > 0:
283.                 self.stdout.write(self.style.MIGRATE_HEADING("Merging %s" % app_label))
284.                 for migration in merge_migrations:
285.                     self.stdout.write(self.style.MIGRATE_LABEL("  Branch %s" % migration.name))
286.                     for operation in migration.merged_operations:
287.                         self.stdout.write("    - %s\n" % operation.describe())
288.             if questioner.ask_merge(app_label):
289.                 # If they still want to merge it, then write out an empty
290.                 # file depending on the migrations needing merging.
291.                 numbers = [
292.                     MigrationAutodetector.parse_number(migration.name)
293.                     for migration in merge_migrations
294.                 ]
295.                 try:
296.                     biggest_number = max(x for x in numbers if x is not None)
297.                 except ValueError:
298.                     biggest_number = 1
299.                 subclass = type("Migration", (Migration, ), {
300.                     "dependencies": [(app_label, migration.name) for migration in merge_migrations],
301.                 })
302.                 migration_name = "%04i_%s" % (
303.                     biggest_number + 1,
304.                     self.migration_name or ("merge_%s" % get_migration_name_timestamp())
305.                 )
306.                 new_migration = subclass(migration_name, app_label)
307.                 writer = MigrationWriter(new_migration)
308. 
309.                 if not self.dry_run:
310.                     # Write the merge migrations file to the disk
311.                     with io.open(writer.path, "w", encoding='utf-8') as fh:
312.                         fh.write(writer.as_string())
313.                     if self.verbosity > 0:
314.                         self.stdout.write("\nCreated new merge migration %s" % writer.path)
315.                 elif self.verbosity == 3:
316.                     # Alternatively, makemigrations --merge --dry-run --verbosity 3
317.                     # will output the merge migrations to stdout rather than saving
318.                     # the file to the disk.
319.                     self.stdout.write(self.style.MIGRATE_HEADING(
320.                         "Full merge migrations file '%s':" % writer.filename) + "\n"
321.                     )
322.                     self.stdout.write("%s\n" % writer.as_string())


File: tests/migrations/routers.py
Line number range: 1 - 13
Content:
1. class EmptyRouter(object):
2.     pass
3. 
4. 
5. class TestRouter(object):
6.     def allow_migrate(self, db, app_label, model_name=None, **hints):
7.         """
8.         The Tribble model should be the only one to appear in the 'other' db.
9.         """
10.         if model_name == 'tribble':
11.             return db == 'other'
12.         elif db == 'other':
13.             return False


File: tests/migrations/test_commands.py
Line number range: 1 - 500
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import unicode_literals
3. 
4. import datetime
5. import importlib
6. import io
7. import os
8. import sys
9. 
10. from django.apps import apps
11. from django.core.management import CommandError, call_command
12. from django.db import (
13.     ConnectionHandler, DatabaseError, connection, connections, models,
14. )
15. from django.db.migrations.exceptions import (
16.     InconsistentMigrationHistory, MigrationSchemaMissing,
17. )
18. from django.db.migrations.recorder import MigrationRecorder
19. from django.test import ignore_warnings, mock, override_settings
20. from django.utils import six
21. from django.utils.deprecation import RemovedInDjango20Warning
22. from django.utils.encoding import force_text
23. 
24. from .models import UnicodeModel, UnserializableModel
25. from .routers import TestRouter
26. from .test_base import MigrationTestBase
27. 
28. 
29. class MigrateTests(MigrationTestBase):
30.     """
31.     Tests running the migrate command.
32.     """
33.     multi_db = True
34. 
35.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
36.     def test_migrate(self):
37.         """
38.         Tests basic usage of the migrate command.
39.         """
40.         # Make sure no tables are created
41.         self.assertTableNotExists("migrations_author")
42.         self.assertTableNotExists("migrations_tribble")
43.         self.assertTableNotExists("migrations_book")
44.         # Run the migrations to 0001 only
45.         call_command("migrate", "migrations", "0001", verbosity=0)
46.         # Make sure the right tables exist
47.         self.assertTableExists("migrations_author")
48.         self.assertTableExists("migrations_tribble")
49.         self.assertTableNotExists("migrations_book")
50.         # Run migrations all the way
51.         call_command("migrate", verbosity=0)
52.         # Make sure the right tables exist
53.         self.assertTableExists("migrations_author")
54.         self.assertTableNotExists("migrations_tribble")
55.         self.assertTableExists("migrations_book")
56.         # Unmigrate everything
57.         call_command("migrate", "migrations", "zero", verbosity=0)
58.         # Make sure it's all gone
59.         self.assertTableNotExists("migrations_author")
60.         self.assertTableNotExists("migrations_tribble")
61.         self.assertTableNotExists("migrations_book")
62. 
63.     @override_settings(INSTALLED_APPS=[
64.         'django.contrib.auth',
65.         'django.contrib.contenttypes',
66.         'migrations.migrations_test_apps.migrated_app',
67.     ])
68.     def test_migrate_with_system_checks(self):
69.         out = six.StringIO()
70.         call_command('migrate', skip_checks=False, no_color=True, stdout=out)
71.         self.assertIn('Apply all migrations: migrated_app', out.getvalue())
72. 
73.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})
74.     def test_migrate_initial_false(self):
75.         """
76.         `Migration.initial = False` skips fake-initial detection.
77.         """
78.         # Make sure no tables are created
79.         self.assertTableNotExists("migrations_author")
80.         self.assertTableNotExists("migrations_tribble")
81.         # Run the migrations to 0001 only
82.         call_command("migrate", "migrations", "0001", verbosity=0)
83.         # Fake rollback
84.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
85.         # Make sure fake-initial detection does not run
86.         with self.assertRaises(DatabaseError):
87.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)
88. 
89.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)
90.         # Real rollback
91.         call_command("migrate", "migrations", "zero", verbosity=0)
92.         # Make sure it's all gone
93.         self.assertTableNotExists("migrations_author")
94.         self.assertTableNotExists("migrations_tribble")
95.         self.assertTableNotExists("migrations_book")
96. 
97.     @override_settings(
98.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
99.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
100.     )
101.     def test_migrate_fake_initial(self):
102.         """
103.         --fake-initial only works if all tables created in the initial
104.         migration of an app exists. Database routers must be obeyed when doing
105.         that check.
106.         """
107.         # Make sure no tables are created
108.         for db in connections:
109.             self.assertTableNotExists("migrations_author", using=db)
110.             self.assertTableNotExists("migrations_tribble", using=db)
111.         # Run the migrations to 0001 only
112.         call_command("migrate", "migrations", "0001", verbosity=0)
113.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
114.         # Make sure the right tables exist
115.         self.assertTableExists("migrations_author")
116.         self.assertTableNotExists("migrations_tribble")
117.         # Also check the "other" database
118.         self.assertTableNotExists("migrations_author", using="other")
119.         self.assertTableExists("migrations_tribble", using="other")
120. 
121.         # Fake a roll-back
122.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
123.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
124.         # Make sure the tables still exist
125.         self.assertTableExists("migrations_author")
126.         self.assertTableExists("migrations_tribble", using="other")
127.         # Try to run initial migration
128.         with self.assertRaises(DatabaseError):
129.             call_command("migrate", "migrations", "0001", verbosity=0)
130.         # Run initial migration with an explicit --fake-initial
131.         out = six.StringIO()
132.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
133.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
134.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
135.         self.assertIn(
136.             "migrations.0001_initial... faked",
137.             out.getvalue().lower()
138.         )
139.         # Run migrations all the way
140.         call_command("migrate", verbosity=0)
141.         call_command("migrate", verbosity=0, database="other")
142.         # Make sure the right tables exist
143.         self.assertTableExists("migrations_author")
144.         self.assertTableNotExists("migrations_tribble")
145.         self.assertTableExists("migrations_book")
146.         self.assertTableNotExists("migrations_author", using="other")
147.         self.assertTableNotExists("migrations_tribble", using="other")
148.         self.assertTableNotExists("migrations_book", using="other")
149.         # Fake a roll-back
150.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
151.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
152.         # Make sure the tables still exist
153.         self.assertTableExists("migrations_author")
154.         self.assertTableNotExists("migrations_tribble")
155.         self.assertTableExists("migrations_book")
156.         # Try to run initial migration
157.         with self.assertRaises(DatabaseError):
158.             call_command("migrate", "migrations", verbosity=0)
159.         # Run initial migration with an explicit --fake-initial
160.         with self.assertRaises(DatabaseError):
161.             # Fails because "migrations_tribble" does not exist but needs to in
162.             # order to make --fake-initial work.
163.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
164.         # Fake a apply
165.         call_command("migrate", "migrations", fake=True, verbosity=0)
166.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
167.         # Unmigrate everything
168.         call_command("migrate", "migrations", "zero", verbosity=0)
169.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
170.         # Make sure it's all gone
171.         for db in connections:
172.             self.assertTableNotExists("migrations_author", using=db)
173.             self.assertTableNotExists("migrations_tribble", using=db)
174.             self.assertTableNotExists("migrations_book", using=db)
175. 
176.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})
177.     def test_migrate_fake_split_initial(self):
178.         """
179.         Split initial migrations can be faked with --fake-initial.
180.         """
181.         call_command("migrate", "migrations", "0002", verbosity=0)
182.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
183.         out = six.StringIO()
184.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
185.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)
186.         value = out.getvalue().lower()
187.         self.assertIn("migrations.0001_initial... faked", value)
188.         self.assertIn("migrations.0002_second... faked", value)
189.         # Fake an apply
190.         call_command("migrate", "migrations", fake=True, verbosity=0)
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193. 
194.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})
195.     def test_migrate_conflict_exit(self):
196.         """
197.         Makes sure that migrate exits if it detects a conflict.
198.         """
199.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):
200.             call_command("migrate", "migrations")
201. 
202.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
203.     def test_showmigrations_list(self):
204.         """
205.         Tests --list output of showmigrations command
206.         """
207.         out = six.StringIO()
208.         with mock.patch('django.core.management.color.supports_color', lambda *args: True):
209.             call_command("showmigrations", format='list', stdout=out, verbosity=0, no_color=False)
210.         self.assertEqual(
211.             '\x1b[1mmigrations\n\x1b[0m'
212.             ' [ ] 0001_initial\n'
213.             ' [ ] 0002_second\n',
214.             out.getvalue().lower()
215.         )
216. 
217.         call_command("migrate", "migrations", "0001", verbosity=0)
218. 
219.         out = six.StringIO()
220.         # Giving the explicit app_label tests for selective `show_list` in the command
221.         call_command("showmigrations", "migrations", format='list', stdout=out, verbosity=0, no_color=True)
222.         self.assertEqual(
223.             'migrations\n'
224.             ' [x] 0001_initial\n'
225.             ' [ ] 0002_second\n',
226.             out.getvalue().lower()
227.         )
228.         # Cleanup by unmigrating everything
229.         call_command("migrate", "migrations", "zero", verbosity=0)
230. 
231.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})
232.     def test_showmigrations_plan(self):
233.         """
234.         Tests --plan output of showmigrations command
235.         """
236.         out = six.StringIO()
237.         call_command("showmigrations", format='plan', stdout=out)
238.         self.assertEqual(
239.             "[ ]  migrations.0001_initial\n"
240.             "[ ]  migrations.0003_third\n"
241.             "[ ]  migrations.0002_second\n",
242.             out.getvalue().lower()
243.         )
244. 
245.         out = six.StringIO()
246.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
247.         self.assertEqual(
248.             "[ ]  migrations.0001_initial\n"
249.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\n"
250.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
251.             out.getvalue().lower()
252.         )
253.         call_command("migrate", "migrations", "0003", verbosity=0)
254. 
255.         out = six.StringIO()
256.         call_command("showmigrations", format='plan', stdout=out)
257.         self.assertEqual(
258.             "[x]  migrations.0001_initial\n"
259.             "[x]  migrations.0003_third\n"
260.             "[ ]  migrations.0002_second\n",
261.             out.getvalue().lower()
262.         )
263. 
264.         out = six.StringIO()
265.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
266.         self.assertEqual(
267.             "[x]  migrations.0001_initial\n"
268.             "[x]  migrations.0003_third ... (migrations.0001_initial)\n"
269.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
270.             out.getvalue().lower()
271.         )
272. 
273.         # Cleanup by unmigrating everything
274.         call_command("migrate", "migrations", "zero", verbosity=0)
275. 
276.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})
277.     def test_showmigrations_plan_no_migrations(self):
278.         """
279.         Tests --plan output of showmigrations command without migrations
280.         """
281.         out = six.StringIO()
282.         call_command("showmigrations", format='plan', stdout=out)
283.         self.assertEqual("", out.getvalue().lower())
284. 
285.         out = six.StringIO()
286.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
287.         self.assertEqual("", out.getvalue().lower())
288. 
289.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})
290.     def test_showmigrations_plan_squashed(self):
291.         """
292.         Tests --plan output of showmigrations command with squashed migrations.
293.         """
294.         out = six.StringIO()
295.         call_command("showmigrations", format='plan', stdout=out)
296.         self.assertEqual(
297.             "[ ]  migrations.1_auto\n"
298.             "[ ]  migrations.2_auto\n"
299.             "[ ]  migrations.3_squashed_5\n"
300.             "[ ]  migrations.6_auto\n"
301.             "[ ]  migrations.7_auto\n",
302.             out.getvalue().lower()
303.         )
304. 
305.         out = six.StringIO()
306.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
307.         self.assertEqual(
308.             "[ ]  migrations.1_auto\n"
309.             "[ ]  migrations.2_auto ... (migrations.1_auto)\n"
310.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
311.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
312.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
313.             out.getvalue().lower()
314.         )
315. 
316.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)
317. 
318.         out = six.StringIO()
319.         call_command("showmigrations", format='plan', stdout=out)
320.         self.assertEqual(
321.             "[x]  migrations.1_auto\n"
322.             "[x]  migrations.2_auto\n"
323.             "[x]  migrations.3_squashed_5\n"
324.             "[ ]  migrations.6_auto\n"
325.             "[ ]  migrations.7_auto\n",
326.             out.getvalue().lower()
327.         )
328. 
329.         out = six.StringIO()
330.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
331.         self.assertEqual(
332.             "[x]  migrations.1_auto\n"
333.             "[x]  migrations.2_auto ... (migrations.1_auto)\n"
334.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
335.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
336.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
337.             out.getvalue().lower()
338.         )
339. 
340.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
341.     def test_sqlmigrate_forwards(self):
342.         """
343.         Makes sure that sqlmigrate does something.
344.         """
345.         out = six.StringIO()
346.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
347.         output = out.getvalue().lower()
348. 
349.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
350.         index_op_desc_author = output.find('-- create model author')
351.         index_create_table = output.find('create table')
352.         index_op_desc_tribble = output.find('-- create model tribble')
353.         index_op_desc_unique_together = output.find('-- alter unique_together')
354.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
355. 
356.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
357.         self.assertGreater(
358.             index_op_desc_author, index_tx_start,
359.             "Operation description (author) not found or found before transaction start"
360.         )
361.         self.assertGreater(
362.             index_create_table, index_op_desc_author,
363.             "CREATE TABLE not found or found before operation description (author)"
364.         )
365.         self.assertGreater(
366.             index_op_desc_tribble, index_create_table,
367.             "Operation description (tribble) not found or found before CREATE TABLE (author)"
368.         )
369.         self.assertGreater(
370.             index_op_desc_unique_together, index_op_desc_tribble,
371.             "Operation description (unique_together) not found or found before operation description (tribble)"
372.         )
373.         self.assertGreater(
374.             index_tx_end, index_op_desc_unique_together,
375.             "Transaction end not found or found before operation description (unique_together)"
376.         )
377. 
378.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
379.     def test_sqlmigrate_backwards(self):
380.         """
381.         Makes sure that sqlmigrate does something.
382.         """
383.         # Cannot generate the reverse SQL unless we've applied the migration.
384.         call_command("migrate", "migrations", verbosity=0)
385. 
386.         out = six.StringIO()
387.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)
388.         output = out.getvalue().lower()
389. 
390.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
391.         index_op_desc_unique_together = output.find('-- alter unique_together')
392.         index_op_desc_tribble = output.find('-- create model tribble')
393.         index_op_desc_author = output.find('-- create model author')
394.         index_drop_table = output.rfind('drop table')
395.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
396. 
397.         self.assertGreater(index_tx_start, -1, "Transaction start not found")
398.         self.assertGreater(
399.             index_op_desc_unique_together, index_tx_start,
400.             "Operation description (unique_together) not found or found before transaction start"
401.         )
402.         self.assertGreater(
403.             index_op_desc_tribble, index_op_desc_unique_together,
404.             "Operation description (tribble) not found or found before operation description (unique_together)"
405.         )
406.         self.assertGreater(
407.             index_op_desc_author, index_op_desc_tribble,
408.             "Operation description (author) not found or found before operation description (tribble)"
409.         )
410. 
411.         self.assertGreater(
412.             index_drop_table, index_op_desc_author,
413.             "DROP TABLE not found or found before operation description (author)"
414.         )
415.         self.assertGreater(
416.             index_tx_end, index_op_desc_unique_together,
417.             "Transaction end not found or found before DROP TABLE"
418.         )
419. 
420.         # Cleanup by unmigrating everything
421.         call_command("migrate", "migrations", "zero", verbosity=0)
422. 
423.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})
424.     def test_sqlmigrate_for_non_atomic_migration(self):
425.         """
426.         Transaction wrappers aren't shown for non-atomic migrations.
427.         """
428.         out = six.StringIO()
429.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
430.         output = out.getvalue().lower()
431.         queries = [q.strip() for q in output.splitlines()]
432.         if connection.ops.start_transaction_sql():
433.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)
434.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)
435. 
436.     @override_settings(
437.         INSTALLED_APPS=[
438.             "migrations.migrations_test_apps.migrated_app",
439.             "migrations.migrations_test_apps.migrated_unapplied_app",
440.             "migrations.migrations_test_apps.unmigrated_app"])
441.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):
442.         """
443.         https://code.djangoproject.com/ticket/22823
444. 
445.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:
446. 
447.         * `A` has migrations
448.         * `B` has a migration we want to apply
449.         * `C` has no migrations, but has an FK to `A`
450. 
451.         When we try to migrate "B", an exception occurs because the
452.         "B" was not included in the ProjectState that is used to detect
453.         soft-applied migrations.
454.         """
455.         call_command("migrate", "migrated_unapplied_app", stdout=six.StringIO())
456. 
457.         # unmigrated_app.SillyModel has a foreign key to 'migrations.Tribble',
458.         # but that model is only defined in a migration, so the global app
459.         # registry never sees it and the reference is left dangling. Remove it
460.         # to avoid problems in subsequent tests.
461.         del apps._pending_operations[('migrations', 'tribble')]
462. 
463.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
464.     def test_migrate_record_replaced(self):
465.         """
466.         Running a single squashed migration should record all of the original
467.         replaced migrations as run.
468.         """
469.         recorder = MigrationRecorder(connection)
470.         out = six.StringIO()
471.         call_command("migrate", "migrations", verbosity=0)
472.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
473.         self.assertEqual(
474.             'migrations\n'
475.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
476.             out.getvalue().lower()
477.         )
478.         applied_migrations = recorder.applied_migrations()
479.         self.assertIn(("migrations", "0001_initial"), applied_migrations)
480.         self.assertIn(("migrations", "0002_second"), applied_migrations)
481.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)
482.         # Rollback changes
483.         call_command("migrate", "migrations", "zero", verbosity=0)
484. 
485.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
486.     def test_migrate_record_squashed(self):
487.         """
488.         Running migrate for a squashed migration should record as run
489.         if all of the replaced migrations have been run (#25231).
490.         """
491.         recorder = MigrationRecorder(connection)
492.         recorder.record_applied("migrations", "0001_initial")
493.         recorder.record_applied("migrations", "0002_second")
494.         out = six.StringIO()
495.         call_command("migrate", "migrations", verbosity=0)
496.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
497.         self.assertEqual(
498.             'migrations\n'
499.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
500.             out.getvalue().lower()


File: tests/migrations/test_commands.py
Line number range: 523 - 1202
Content:
523. class MakeMigrationsTests(MigrationTestBase):
524.     """
525.     Tests running the makemigrations command.
526.     """
527. 
528.     def setUp(self):
529.         super(MakeMigrationsTests, self).setUp()
530.         self._old_models = apps.app_configs['migrations'].models.copy()
531. 
532.     def tearDown(self):
533.         apps.app_configs['migrations'].models = self._old_models
534.         apps.all_models['migrations'] = self._old_models
535.         apps.clear_cache()
536.         super(MakeMigrationsTests, self).tearDown()
537. 
538.     def test_files_content(self):
539.         self.assertTableNotExists("migrations_unicodemodel")
540.         apps.register_model('migrations', UnicodeModel)
541.         with self.temporary_migration_module() as migration_dir:
542.             call_command("makemigrations", "migrations", verbosity=0)
543. 
544.             # Check for empty __init__.py file in migrations folder
545.             init_file = os.path.join(migration_dir, "__init__.py")
546.             self.assertTrue(os.path.exists(init_file))
547. 
548.             with open(init_file, 'r') as fp:
549.                 content = force_text(fp.read())
550.             self.assertEqual(content, '')
551. 
552.             # Check for existing 0001_initial.py file in migration folder
553.             initial_file = os.path.join(migration_dir, "0001_initial.py")
554.             self.assertTrue(os.path.exists(initial_file))
555. 
556.             with io.open(initial_file, 'r', encoding='utf-8') as fp:
557.                 content = fp.read()
558.                 self.assertIn('# -*- coding: utf-8 -*-', content)
559.                 self.assertIn('migrations.CreateModel', content)
560.                 self.assertIn('initial = True', content)
561. 
562.                 if six.PY3:
563.                     self.assertIn('úñí©óðé µóðéø', content)  # Meta.verbose_name
564.                     self.assertIn('úñí©óðé µóðéøß', content)  # Meta.verbose_name_plural
565.                     self.assertIn('ÚÑÍ¢ÓÐÉ', content)  # title.verbose_name
566.                     self.assertIn('“Ðjáñgó”', content)  # title.default
567.                 else:
568.                     # Meta.verbose_name
569.                     self.assertIn('\\xfa\\xf1\\xed\\xa9\\xf3\\xf0\\xe9 \\xb5\\xf3\\xf0\\xe9\\xf8', content)
570.                     # Meta.verbose_name_plural
571.                     self.assertIn('\\xfa\\xf1\\xed\\xa9\\xf3\\xf0\\xe9 \\xb5\\xf3\\xf0\\xe9\\xf8\\xdf', content)
572.                     self.assertIn('\\xda\\xd1\\xcd\\xa2\\xd3\\xd0\\xc9', content)  # title.verbose_name
573.                     self.assertIn('\\u201c\\xd0j\\xe1\\xf1g\\xf3\\u201d', content)  # title.default
574. 
575.     def test_makemigrations_order(self):
576.         """
577.         makemigrations should recognize number-only migrations (0001.py).
578.         """
579.         module = 'migrations.test_migrations_order'
580.         with self.temporary_migration_module(module=module) as migration_dir:
581.             if hasattr(importlib, 'invalidate_caches'):
582.                 # Python 3 importlib caches os.listdir() on some platforms like
583.                 # Mac OS X (#23850).
584.                 importlib.invalidate_caches()
585.             call_command('makemigrations', 'migrations', '--empty', '-n', 'a', '-v', '0')
586.             self.assertTrue(os.path.exists(os.path.join(migration_dir, '0002_a.py')))
587. 
588.     def test_makemigrations_empty_connections(self):
589.         empty_connections = ConnectionHandler({'default': {}})
590.         with mock.patch('django.core.management.commands.makemigrations.connections', new=empty_connections):
591.             # with no apps
592.             out = six.StringIO()
593.             call_command('makemigrations', stdout=out)
594.             self.assertIn('No changes detected', out.getvalue())
595.             # with an app
596.             with self.temporary_migration_module() as migration_dir:
597.                 call_command('makemigrations', 'migrations', verbosity=0)
598.                 init_file = os.path.join(migration_dir, '__init__.py')
599.                 self.assertTrue(os.path.exists(init_file))
600. 
601.     def test_makemigrations_consistency_checks_respect_routers(self):
602.         """
603.         The history consistency checks in makemigrations respect
604.         settings.DATABASE_ROUTERS.
605.         """
606.         def patched_ensure_schema(migration_recorder):
607.             if migration_recorder.connection is connections['other']:
608.                 raise MigrationSchemaMissing('Patched')
609.             else:
610.                 return mock.DEFAULT
611. 
612.         self.assertTableNotExists('migrations_unicodemodel')
613.         apps.register_model('migrations', UnicodeModel)
614.         with mock.patch.object(
615.                 MigrationRecorder, 'ensure_schema',
616.                 autospec=True, side_effect=patched_ensure_schema) as ensure_schema:
617.             with self.temporary_migration_module() as migration_dir:
618.                 call_command("makemigrations", "migrations", verbosity=0)
619.                 initial_file = os.path.join(migration_dir, "0001_initial.py")
620.                 self.assertTrue(os.path.exists(initial_file))
621.                 self.assertEqual(ensure_schema.call_count, 1)  # 'default' is checked
622. 
623.                 # Router says not to migrate 'other' so consistency shouldn't
624.                 # be checked.
625.                 with self.settings(DATABASE_ROUTERS=['migrations.routers.TestRouter']):
626.                     call_command('makemigrations', 'migrations', verbosity=0)
627.                 self.assertEqual(ensure_schema.call_count, 2)  # 'default' again
628. 
629.                 # With a router that doesn't prohibit migrating 'other',
630.                 # consistency is checked.
631.                 with self.settings(DATABASE_ROUTERS=['migrations.routers.EmptyRouter']):
632.                     with self.assertRaisesMessage(MigrationSchemaMissing, 'Patched'):
633.                         call_command('makemigrations', 'migrations', verbosity=0)
634.                 self.assertEqual(ensure_schema.call_count, 4)  # 'default' and 'other'
635. 
636.                 # With a router that doesn't allow migrating on any database,
637.                 # no consistency checks are made.
638.                 with self.settings(DATABASE_ROUTERS=['migrations.routers.TestRouter']):
639.                     with mock.patch.object(TestRouter, 'allow_migrate', return_value=False) as allow_migrate:
640.                         call_command('makemigrations', 'migrations', verbosity=0)
641.                 allow_migrate.assert_called_with('other', 'migrations', model_name='UnicodeModel')
642.                 self.assertEqual(ensure_schema.call_count, 4)
643. 
644.     def test_failing_migration(self):
645.         # If a migration fails to serialize, it shouldn't generate an empty file. #21280
646.         apps.register_model('migrations', UnserializableModel)
647. 
648.         with self.temporary_migration_module() as migration_dir:
649.             with self.assertRaisesMessage(ValueError, 'Cannot serialize'):
650.                 call_command("makemigrations", "migrations", verbosity=0)
651. 
652.             initial_file = os.path.join(migration_dir, "0001_initial.py")
653.             self.assertFalse(os.path.exists(initial_file))
654. 
655.     def test_makemigrations_conflict_exit(self):
656.         """
657.         Makes sure that makemigrations exits if it detects a conflict.
658.         """
659.         with self.temporary_migration_module(module="migrations.test_migrations_conflict"):
660.             with self.assertRaises(CommandError):
661.                 call_command("makemigrations")
662. 
663.     def test_makemigrations_merge_no_conflict(self):
664.         """
665.         Makes sure that makemigrations exits if in merge mode with no conflicts.
666.         """
667.         out = six.StringIO()
668.         with self.temporary_migration_module(module="migrations.test_migrations"):
669.             call_command("makemigrations", merge=True, stdout=out)
670.         self.assertIn("No conflicts detected to merge.", out.getvalue())
671. 
672.     def test_makemigrations_no_app_sys_exit(self):
673.         """
674.         Makes sure that makemigrations exits if a non-existent app is specified.
675.         """
676.         err = six.StringIO()
677.         with self.assertRaises(SystemExit):
678.             call_command("makemigrations", "this_app_does_not_exist", stderr=err)
679.         self.assertIn("'this_app_does_not_exist' could not be found.", err.getvalue())
680. 
681.     def test_makemigrations_empty_no_app_specified(self):
682.         """
683.         Makes sure that makemigrations exits if no app is specified with 'empty' mode.
684.         """
685.         with self.assertRaises(CommandError):
686.             call_command("makemigrations", empty=True)
687. 
688.     def test_makemigrations_empty_migration(self):
689.         """
690.         Makes sure that makemigrations properly constructs an empty migration.
691.         """
692.         with self.temporary_migration_module() as migration_dir:
693.             call_command("makemigrations", "migrations", empty=True, verbosity=0)
694. 
695.             # Check for existing 0001_initial.py file in migration folder
696.             initial_file = os.path.join(migration_dir, "0001_initial.py")
697.             self.assertTrue(os.path.exists(initial_file))
698. 
699.             with io.open(initial_file, 'r', encoding='utf-8') as fp:
700.                 content = fp.read()
701.                 self.assertIn('# -*- coding: utf-8 -*-', content)
702. 
703.                 # Remove all whitespace to check for empty dependencies and operations
704.                 content = content.replace(' ', '')
705.                 self.assertIn('dependencies=[\n]', content)
706.                 self.assertIn('operations=[\n]', content)
707. 
708.     @override_settings(MIGRATION_MODULES={"migrations": None})
709.     def test_makemigrations_disabled_migrations_for_app(self):
710.         """
711.         makemigrations raises a nice error when migrations are disabled for an
712.         app.
713.         """
714.         msg = (
715.             "Django can't create migrations for app 'migrations' because migrations "
716.             "have been disabled via the MIGRATION_MODULES setting."
717.         )
718.         with self.assertRaisesMessage(ValueError, msg):
719.             call_command("makemigrations", "migrations", empty=True, verbosity=0)
720. 
721.     def test_makemigrations_no_changes_no_apps(self):
722.         """
723.         Makes sure that makemigrations exits when there are no changes and no apps are specified.
724.         """
725.         out = six.StringIO()
726.         call_command("makemigrations", stdout=out)
727.         self.assertIn("No changes detected", out.getvalue())
728. 
729.     def test_makemigrations_no_changes(self):
730.         """
731.         Makes sure that makemigrations exits when there are no changes to an app.
732.         """
733.         out = six.StringIO()
734.         with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
735.             call_command("makemigrations", "migrations", stdout=out)
736.         self.assertIn("No changes detected in app 'migrations'", out.getvalue())
737. 
738.     def test_makemigrations_no_apps_initial(self):
739.         """
740.         makemigrations should detect initial is needed on empty migration
741.         modules if no app provided.
742.         """
743.         out = six.StringIO()
744.         with self.temporary_migration_module(module="migrations.test_migrations_empty"):
745.             call_command("makemigrations", stdout=out)
746.         self.assertIn("0001_initial.py", out.getvalue())
747. 
748.     def test_makemigrations_migrations_announce(self):
749.         """
750.         Makes sure that makemigrations announces the migration at the default verbosity level.
751.         """
752.         out = six.StringIO()
753.         with self.temporary_migration_module():
754.             call_command("makemigrations", "migrations", stdout=out)
755.         self.assertIn("Migrations for 'migrations'", out.getvalue())
756. 
757.     def test_makemigrations_no_common_ancestor(self):
758.         """
759.         Makes sure that makemigrations fails to merge migrations with no common ancestor.
760.         """
761.         with self.assertRaises(ValueError) as context:
762.             with self.temporary_migration_module(module="migrations.test_migrations_no_ancestor"):
763.                 call_command("makemigrations", "migrations", merge=True)
764.         exception_message = str(context.exception)
765.         self.assertIn("Could not find common ancestor of", exception_message)
766.         self.assertIn("0002_second", exception_message)
767.         self.assertIn("0002_conflicting_second", exception_message)
768. 
769.     def test_makemigrations_interactive_reject(self):
770.         """
771.         Makes sure that makemigrations enters and exits interactive mode properly.
772.         """
773.         # Monkeypatch interactive questioner to auto reject
774.         with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='N')):
775.             with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
776.                 call_command("makemigrations", "migrations", name="merge", merge=True, interactive=True, verbosity=0)
777.                 merge_file = os.path.join(migration_dir, '0003_merge.py')
778.                 self.assertFalse(os.path.exists(merge_file))
779. 
780.     def test_makemigrations_interactive_accept(self):
781.         """
782.         Makes sure that makemigrations enters interactive mode and merges properly.
783.         """
784.         # Monkeypatch interactive questioner to auto accept
785.         with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='y')):
786.             out = six.StringIO()
787.             with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
788.                 call_command("makemigrations", "migrations", name="merge", merge=True, interactive=True, stdout=out)
789.                 merge_file = os.path.join(migration_dir, '0003_merge.py')
790.                 self.assertTrue(os.path.exists(merge_file))
791.             self.assertIn("Created new merge migration", out.getvalue())
792. 
793.     @mock.patch('django.db.migrations.utils.datetime')
794.     def test_makemigrations_default_merge_name(self, mock_datetime):
795.         mock_datetime.datetime.now.return_value = datetime.datetime(2016, 1, 2, 3, 4)
796.         with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='y')):
797.             out = six.StringIO()
798.             with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
799.                 call_command("makemigrations", "migrations", merge=True, interactive=True, stdout=out)
800.                 merge_file = os.path.join(migration_dir, '0003_merge_20160102_0304.py')
801.                 self.assertTrue(os.path.exists(merge_file))
802.             self.assertIn("Created new merge migration", out.getvalue())
803. 
804.     def test_makemigrations_non_interactive_not_null_addition(self):
805.         """
806.         Tests that non-interactive makemigrations fails when a default is missing on a new not-null field.
807.         """
808.         class SillyModel(models.Model):
809.             silly_field = models.BooleanField(default=False)
810.             silly_int = models.IntegerField()
811. 
812.             class Meta:
813.                 app_label = "migrations"
814. 
815.         out = six.StringIO()
816.         with self.assertRaises(SystemExit):
817.             with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
818.                 call_command("makemigrations", "migrations", interactive=False, stdout=out)
819. 
820.     def test_makemigrations_non_interactive_not_null_alteration(self):
821.         """
822.         Tests that non-interactive makemigrations fails when a default is missing on a field changed to not-null.
823.         """
824.         class Author(models.Model):
825.             name = models.CharField(max_length=255)
826.             slug = models.SlugField()
827.             age = models.IntegerField(default=0)
828. 
829.             class Meta:
830.                 app_label = "migrations"
831. 
832.         out = six.StringIO()
833.         with self.temporary_migration_module(module="migrations.test_migrations"):
834.             call_command("makemigrations", "migrations", interactive=False, stdout=out)
835.         self.assertIn("Alter field slug on author", out.getvalue())
836. 
837.     def test_makemigrations_non_interactive_no_model_rename(self):
838.         """
839.         Makes sure that makemigrations adds and removes a possible model rename in non-interactive mode.
840.         """
841.         class RenamedModel(models.Model):
842.             silly_field = models.BooleanField(default=False)
843. 
844.             class Meta:
845.                 app_label = "migrations"
846. 
847.         out = six.StringIO()
848.         with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
849.             call_command("makemigrations", "migrations", interactive=False, stdout=out)
850.         self.assertIn("Delete model SillyModel", out.getvalue())
851.         self.assertIn("Create model RenamedModel", out.getvalue())
852. 
853.     def test_makemigrations_non_interactive_no_field_rename(self):
854.         """
855.         Makes sure that makemigrations adds and removes a possible field rename in non-interactive mode.
856.         """
857.         class SillyModel(models.Model):
858.             silly_rename = models.BooleanField(default=False)
859. 
860.             class Meta:
861.                 app_label = "migrations"
862. 
863.         out = six.StringIO()
864.         with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
865.             call_command("makemigrations", "migrations", interactive=False, stdout=out)
866.         self.assertIn("Remove field silly_field from sillymodel", out.getvalue())
867.         self.assertIn("Add field silly_rename to sillymodel", out.getvalue())
868. 
869.     def test_makemigrations_handle_merge(self):
870.         """
871.         Makes sure that makemigrations properly merges the conflicting migrations with --noinput.
872.         """
873.         out = six.StringIO()
874.         with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
875.             call_command("makemigrations", "migrations", name="merge", merge=True, interactive=False, stdout=out)
876.             merge_file = os.path.join(migration_dir, '0003_merge.py')
877.             self.assertTrue(os.path.exists(merge_file))
878.         output = out.getvalue()
879.         self.assertIn("Merging migrations", output)
880.         self.assertIn("Branch 0002_second", output)
881.         self.assertIn("Branch 0002_conflicting_second", output)
882.         self.assertIn("Created new merge migration", output)
883. 
884.     def test_makemigration_merge_dry_run(self):
885.         """
886.         Makes sure that makemigrations respects --dry-run option when fixing
887.         migration conflicts (#24427).
888.         """
889.         out = six.StringIO()
890.         with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
891.             call_command(
892.                 "makemigrations", "migrations", name="merge", dry_run=True,
893.                 merge=True, interactive=False, stdout=out,
894.             )
895.             merge_file = os.path.join(migration_dir, '0003_merge.py')
896.             self.assertFalse(os.path.exists(merge_file))
897.         output = out.getvalue()
898.         self.assertIn("Merging migrations", output)
899.         self.assertIn("Branch 0002_second", output)
900.         self.assertIn("Branch 0002_conflicting_second", output)
901.         self.assertNotIn("Created new merge migration", output)
902. 
903.     def test_makemigration_merge_dry_run_verbosity_3(self):
904.         """
905.         Makes sure that `makemigrations --merge --dry-run` writes the merge
906.         migration file to stdout with `verbosity == 3` (#24427).
907.         """
908.         out = six.StringIO()
909.         with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
910.             call_command(
911.                 "makemigrations", "migrations", name="merge", dry_run=True,
912.                 merge=True, interactive=False, stdout=out, verbosity=3,
913.             )
914.             merge_file = os.path.join(migration_dir, '0003_merge.py')
915.             self.assertFalse(os.path.exists(merge_file))
916.         output = out.getvalue()
917.         self.assertIn("Merging migrations", output)
918.         self.assertIn("Branch 0002_second", output)
919.         self.assertIn("Branch 0002_conflicting_second", output)
920.         self.assertNotIn("Created new merge migration", output)
921. 
922.         # Additional output caused by verbosity 3
923.         # The complete merge migration file that would be written
924.         # '\n#' is to verify no bytestring prefix before #
925.         self.assertIn("\n# -*- coding: utf-8 -*-", output)
926.         self.assertIn("class Migration(migrations.Migration):", output)
927.         self.assertIn("dependencies = [", output)
928.         self.assertIn("('migrations', '0002_second')", output)
929.         self.assertIn("('migrations', '0002_conflicting_second')", output)
930.         self.assertIn("operations = [", output)
931.         self.assertIn("]", output)
932. 
933.     def test_makemigrations_dry_run(self):
934.         """
935.         Ticket #22676 -- `makemigrations --dry-run` should not ask for defaults.
936.         """
937. 
938.         class SillyModel(models.Model):
939.             silly_field = models.BooleanField(default=False)
940.             silly_date = models.DateField()  # Added field without a default
941. 
942.             class Meta:
943.                 app_label = "migrations"
944. 
945.         out = six.StringIO()
946.         with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
947.             call_command("makemigrations", "migrations", dry_run=True, stdout=out)
948.         # Output the expected changes directly, without asking for defaults
949.         self.assertIn("Add field silly_date to sillymodel", out.getvalue())
950. 
951.     def test_makemigrations_dry_run_verbosity_3(self):
952.         """
953.         Ticket #22675 -- Allow `makemigrations --dry-run` to output the
954.         migrations file to stdout (with verbosity == 3).
955.         """
956. 
957.         class SillyModel(models.Model):
958.             silly_field = models.BooleanField(default=False)
959.             silly_char = models.CharField(default="")
960. 
961.             class Meta:
962.                 app_label = "migrations"
963. 
964.         out = six.StringIO()
965.         with self.temporary_migration_module(module="migrations.test_migrations_no_default"):
966.             call_command("makemigrations", "migrations", dry_run=True, stdout=out, verbosity=3)
967. 
968.         # Normal --dry-run output
969.         self.assertIn("- Add field silly_char to sillymodel", out.getvalue())
970. 
971.         # Additional output caused by verbosity 3
972.         # The complete migrations file that would be written
973.         self.assertIn("# -*- coding: utf-8 -*-", out.getvalue())
974.         self.assertIn("class Migration(migrations.Migration):", out.getvalue())
975.         self.assertIn("dependencies = [", out.getvalue())
976.         self.assertIn("('migrations', '0001_initial'),", out.getvalue())
977.         self.assertIn("migrations.AddField(", out.getvalue())
978.         self.assertIn("model_name='sillymodel',", out.getvalue())
979.         self.assertIn("name='silly_char',", out.getvalue())
980. 
981.     def test_makemigrations_migrations_modules_path_not_exist(self):
982.         """
983.         Ticket #22682 -- Makemigrations fails when specifying custom location
984.         for migration files (using MIGRATION_MODULES) if the custom path
985.         doesn't already exist.
986.         """
987. 
988.         class SillyModel(models.Model):
989.             silly_field = models.BooleanField(default=False)
990. 
991.             class Meta:
992.                 app_label = "migrations"
993. 
994.         out = six.StringIO()
995.         migration_module = "migrations.test_migrations_path_doesnt_exist.foo.bar"
996.         with self.temporary_migration_module(module=migration_module) as migration_dir:
997.             call_command("makemigrations", "migrations", stdout=out)
998. 
999.             # Migrations file is actually created in the expected path.
1000.             initial_file = os.path.join(migration_dir, "0001_initial.py")
1001.             self.assertTrue(os.path.exists(initial_file))
1002. 
1003.         # Command output indicates the migration is created.
1004.         self.assertIn(" - Create model SillyModel", out.getvalue())
1005. 
1006.     def test_makemigrations_interactive_by_default(self):
1007.         """
1008.         Makes sure that the user is prompted to merge by default if there are
1009.         conflicts and merge is True. Answer negative to differentiate it from
1010.         behavior when --noinput is specified.
1011.         """
1012.         # Monkeypatch interactive questioner to auto reject
1013.         out = six.StringIO()
1014.         with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='N')):
1015.             with self.temporary_migration_module(module="migrations.test_migrations_conflict") as migration_dir:
1016.                 call_command("makemigrations", "migrations", name="merge", merge=True, stdout=out)
1017.                 merge_file = os.path.join(migration_dir, '0003_merge.py')
1018.                 # This will fail if interactive is False by default
1019.                 self.assertFalse(os.path.exists(merge_file))
1020.             self.assertNotIn("Created new merge migration", out.getvalue())
1021. 
1022.     @override_settings(
1023.         INSTALLED_APPS=[
1024.             "migrations",
1025.             "migrations.migrations_test_apps.unspecified_app_with_conflict"])
1026.     def test_makemigrations_unspecified_app_with_conflict_no_merge(self):
1027.         """
1028.         Makes sure that makemigrations does not raise a CommandError when an
1029.         unspecified app has conflicting migrations.
1030.         """
1031.         with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
1032.             call_command("makemigrations", "migrations", merge=False, verbosity=0)
1033. 
1034.     @override_settings(
1035.         INSTALLED_APPS=[
1036.             "migrations.migrations_test_apps.migrated_app",
1037.             "migrations.migrations_test_apps.unspecified_app_with_conflict"])
1038.     def test_makemigrations_unspecified_app_with_conflict_merge(self):
1039.         """
1040.         Makes sure that makemigrations does not create a merge for an
1041.         unspecified app even if it has conflicting migrations.
1042.         """
1043.         # Monkeypatch interactive questioner to auto accept
1044.         with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='y')):
1045.             out = six.StringIO()
1046.             with self.temporary_migration_module(app_label="migrated_app") as migration_dir:
1047.                 call_command("makemigrations", "migrated_app", name="merge", merge=True, interactive=True, stdout=out)
1048.                 merge_file = os.path.join(migration_dir, '0003_merge.py')
1049.                 self.assertFalse(os.path.exists(merge_file))
1050.             self.assertIn("No conflicts detected to merge.", out.getvalue())
1051. 
1052.     @override_settings(
1053.         INSTALLED_APPS=[
1054.             "migrations.migrations_test_apps.migrated_app",
1055.             "migrations.migrations_test_apps.conflicting_app_with_dependencies"])
1056.     def test_makemigrations_merge_dont_output_dependency_operations(self):
1057.         """
1058.         Makes sure that makemigrations --merge does not output any operations
1059.         from apps that don't belong to a given app.
1060.         """
1061.         # Monkeypatch interactive questioner to auto accept
1062.         with mock.patch('django.db.migrations.questioner.input', mock.Mock(return_value='N')):
1063.             out = six.StringIO()
1064.             with mock.patch('django.core.management.color.supports_color', lambda *args: False):
1065.                 call_command(
1066.                     "makemigrations", "conflicting_app_with_dependencies",
1067.                     merge=True, interactive=True, stdout=out
1068.                 )
1069.             val = out.getvalue().lower()
1070.             self.assertIn('merging conflicting_app_with_dependencies\n', val)
1071.             self.assertIn(
1072.                 '  branch 0002_conflicting_second\n'
1073.                 '    - create model something\n',
1074.                 val
1075.             )
1076.             self.assertIn(
1077.                 '  branch 0002_second\n'
1078.                 '    - delete model tribble\n'
1079.                 '    - remove field silly_field from author\n'
1080.                 '    - add field rating to author\n'
1081.                 '    - create model book\n',
1082.                 val
1083.             )
1084. 
1085.     def test_makemigrations_with_custom_name(self):
1086.         """
1087.         Makes sure that makemigrations generate a custom migration.
1088.         """
1089.         with self.temporary_migration_module() as migration_dir:
1090. 
1091.             def cmd(migration_count, migration_name, *args):
1092.                 call_command("makemigrations", "migrations", "--verbosity", "0", "--name", migration_name, *args)
1093.                 migration_file = os.path.join(migration_dir, "%s_%s.py" % (migration_count, migration_name))
1094.                 # Check for existing migration file in migration folder
1095.                 self.assertTrue(os.path.exists(migration_file))
1096.                 with io.open(migration_file, "r", encoding="utf-8") as fp:
1097.                     content = fp.read()
1098.                     self.assertIn("# -*- coding: utf-8 -*-", content)
1099.                     content = content.replace(" ", "")
1100.                 return content
1101. 
1102.             # generate an initial migration
1103.             migration_name_0001 = "my_initial_migration"
1104.             content = cmd("0001", migration_name_0001)
1105.             self.assertIn("dependencies=[\n]", content)
1106. 
1107.             # Python 3 importlib caches os.listdir() on some platforms like
1108.             # Mac OS X (#23850).
1109.             if hasattr(importlib, 'invalidate_caches'):
1110.                 importlib.invalidate_caches()
1111. 
1112.             # generate an empty migration
1113.             migration_name_0002 = "my_custom_migration"
1114.             content = cmd("0002", migration_name_0002, "--empty")
1115.             self.assertIn("dependencies=[\n('migrations','0001_%s'),\n]" % migration_name_0001, content)
1116.             self.assertIn("operations=[\n]", content)
1117. 
1118.     @ignore_warnings(category=RemovedInDjango20Warning)
1119.     def test_makemigrations_exit(self):
1120.         """
1121.         makemigrations --exit should exit with sys.exit(1) when there are no
1122.         changes to an app.
1123.         """
1124.         with self.temporary_migration_module():
1125.             call_command("makemigrations", "--exit", "migrations", verbosity=0)
1126. 
1127.         with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
1128.             with self.assertRaises(SystemExit):
1129.                 call_command("makemigrations", "--exit", "migrations", verbosity=0)
1130. 
1131.     def test_makemigrations_check(self):
1132.         """
1133.         makemigrations --check should exit with a non-zero status when
1134.         there are changes to an app requiring migrations.
1135.         """
1136.         with self.temporary_migration_module():
1137.             with self.assertRaises(SystemExit):
1138.                 call_command("makemigrations", "--check", "migrations", verbosity=0)
1139. 
1140.         with self.temporary_migration_module(module="migrations.test_migrations_no_changes"):
1141.             call_command("makemigrations", "--check", "migrations", verbosity=0)
1142. 
1143.     def test_makemigrations_migration_path_output(self):
1144.         """
1145.         makemigrations should print the relative paths to the migrations unless
1146.         they are outside of the current tree, in which case the absolute path
1147.         should be shown.
1148.         """
1149.         out = six.StringIO()
1150.         apps.register_model('migrations', UnicodeModel)
1151.         with self.temporary_migration_module() as migration_dir:
1152.             call_command("makemigrations", "migrations", stdout=out)
1153.             self.assertIn(os.path.join(migration_dir, '0001_initial.py'), out.getvalue())
1154. 
1155.     def test_makemigrations_migration_path_output_valueerror(self):
1156.         """
1157.         makemigrations prints the absolute path if os.path.relpath() raises a
1158.         ValueError when it's impossible to obtain a relative path, e.g. on
1159.         Windows if Django is installed on a different drive than where the
1160.         migration files are created.
1161.         """
1162.         out = six.StringIO()
1163.         with self.temporary_migration_module() as migration_dir:
1164.             with mock.patch('os.path.relpath', side_effect=ValueError):
1165.                 call_command('makemigrations', 'migrations', stdout=out)
1166.         self.assertIn(os.path.join(migration_dir, '0001_initial.py'), out.getvalue())
1167. 
1168.     def test_makemigrations_inconsistent_history(self):
1169.         """
1170.         makemigrations should raise InconsistentMigrationHistory exception if
1171.         there are some migrations applied before their dependencies.
1172.         """
1173.         recorder = MigrationRecorder(connection)
1174.         recorder.record_applied('migrations', '0002_second')
1175.         msg = "Migration migrations.0002_second is applied before its dependency migrations.0001_initial"
1176.         with self.temporary_migration_module(module="migrations.test_migrations"):
1177.             with self.assertRaisesMessage(InconsistentMigrationHistory, msg):
1178.                 call_command("makemigrations")
1179. 
1180.     @mock.patch('django.db.migrations.questioner.input', return_value='1')
1181.     @mock.patch('django.db.migrations.questioner.sys.stdin', mock.MagicMock(encoding=sys.getdefaultencoding()))
1182.     def test_makemigrations_auto_now_add_interactive(self, *args):
1183.         """
1184.         makemigrations prompts the user when adding auto_now_add to an existing
1185.         model.
1186.         """
1187.         class Entry(models.Model):
1188.             title = models.CharField(max_length=255)
1189.             creation_date = models.DateTimeField(auto_now_add=True)
1190. 
1191.             class Meta:
1192.                 app_label = 'migrations'
1193. 
1194.         # Monkeypatch interactive questioner to auto accept
1195.         with mock.patch('django.db.migrations.questioner.sys.stdout', new_callable=six.StringIO) as prompt_stdout:
1196.             out = six.StringIO()
1197.             with self.temporary_migration_module(module='migrations.test_auto_now_add'):
1198.                 call_command('makemigrations', 'migrations', interactive=True, stdout=out)
1199.             output = out.getvalue()
1200.             prompt_output = prompt_stdout.getvalue()
1201.             self.assertIn("You can accept the default 'timezone.now' by pressing 'Enter'", prompt_output)
1202.             self.assertIn("Add field creation_date to entry", output)


File: tests/migrations/test_multidb.py
Line number range: 1 - 174
Content:
1. import unittest
2. 
3. from django.db import connection, migrations, models
4. from django.db.migrations.state import ProjectState
5. from django.test import override_settings
6. 
7. from .test_operations import OperationTestBase
8. 
9. try:
10.     import sqlparse
11. except ImportError:
12.     sqlparse = None
13. 
14. 
15. class AgnosticRouter(object):
16.     """
17.     A router that doesn't have an opinion regarding migrating.
18.     """
19.     def allow_migrate(self, db, app_label, **hints):
20.         return None
21. 
22. 
23. class MigrateNothingRouter(object):
24.     """
25.     A router that doesn't allow migrating.
26.     """
27.     def allow_migrate(self, db, app_label, **hints):
28.         return False
29. 
30. 
31. class MigrateEverythingRouter(object):
32.     """
33.     A router that always allows migrating.
34.     """
35.     def allow_migrate(self, db, app_label, **hints):
36.         return True
37. 
38. 
39. class MigrateWhenFooRouter(object):
40.     """
41.     A router that allows migrating depending on a hint.
42.     """
43.     def allow_migrate(self, db, app_label, **hints):
44.         return hints.get('foo', False)
45. 
46. 
47. class MultiDBOperationTests(OperationTestBase):
48.     multi_db = True
49. 
50.     def _test_create_model(self, app_label, should_run):
51.         """
52.         Tests that CreateModel honours multi-db settings.
53.         """
54.         operation = migrations.CreateModel(
55.             "Pony",
56.             [("id", models.AutoField(primary_key=True))],
57.         )
58.         # Test the state alteration
59.         project_state = ProjectState()
60.         new_state = project_state.clone()
61.         operation.state_forwards(app_label, new_state)
62.         # Test the database alteration
63.         self.assertTableNotExists("%s_pony" % app_label)
64.         with connection.schema_editor() as editor:
65.             operation.database_forwards(app_label, editor, project_state, new_state)
66.         if should_run:
67.             self.assertTableExists("%s_pony" % app_label)
68.         else:
69.             self.assertTableNotExists("%s_pony" % app_label)
70.         # And test reversal
71.         with connection.schema_editor() as editor:
72.             operation.database_backwards(app_label, editor, new_state, project_state)
73.         self.assertTableNotExists("%s_pony" % app_label)
74. 
75.     @override_settings(DATABASE_ROUTERS=[AgnosticRouter()])
76.     def test_create_model(self):
77.         """
78.         Test when router doesn't have an opinion (i.e. CreateModel should run).
79.         """
80.         self._test_create_model("test_mltdb_crmo", should_run=True)
81. 
82.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
83.     def test_create_model2(self):
84.         """
85.         Test when router returns False (i.e. CreateModel shouldn't run).
86.         """
87.         self._test_create_model("test_mltdb_crmo2", should_run=False)
88. 
89.     @override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()])
90.     def test_create_model3(self):
91.         """
92.         Test when router returns True (i.e. CreateModel should run).
93.         """
94.         self._test_create_model("test_mltdb_crmo3", should_run=True)
95. 
96.     def test_create_model4(self):
97.         """
98.         Test multiple routers.
99.         """
100.         with override_settings(DATABASE_ROUTERS=[AgnosticRouter(), AgnosticRouter()]):
101.             self._test_create_model("test_mltdb_crmo4", should_run=True)
102.         with override_settings(DATABASE_ROUTERS=[MigrateNothingRouter(), MigrateEverythingRouter()]):
103.             self._test_create_model("test_mltdb_crmo4", should_run=False)
104.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter(), MigrateNothingRouter()]):
105.             self._test_create_model("test_mltdb_crmo4", should_run=True)
106. 
107.     def _test_run_sql(self, app_label, should_run, hints=None):
108.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()]):
109.             project_state = self.set_up_test_model(app_label)
110. 
111.         sql = """
112.         INSERT INTO {0}_pony (pink, weight) VALUES (1, 3.55);
113.         INSERT INTO {0}_pony (pink, weight) VALUES (3, 5.0);
114.         """.format(app_label)
115. 
116.         operation = migrations.RunSQL(sql, hints=hints or {})
117.         # Test the state alteration does nothing
118.         new_state = project_state.clone()
119.         operation.state_forwards(app_label, new_state)
120.         self.assertEqual(new_state, project_state)
121.         # Test the database alteration
122.         self.assertEqual(project_state.apps.get_model(app_label, "Pony").objects.count(), 0)
123.         with connection.schema_editor() as editor:
124.             operation.database_forwards(app_label, editor, project_state, new_state)
125.         Pony = project_state.apps.get_model(app_label, "Pony")
126.         if should_run:
127.             self.assertEqual(Pony.objects.count(), 2)
128.         else:
129.             self.assertEqual(Pony.objects.count(), 0)
130. 
131.     @unittest.skipIf(sqlparse is None and connection.features.requires_sqlparse_for_splitting, "Missing sqlparse")
132.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
133.     def test_run_sql(self):
134.         self._test_run_sql("test_mltdb_runsql", should_run=False)
135. 
136.     @unittest.skipIf(sqlparse is None and connection.features.requires_sqlparse_for_splitting, "Missing sqlparse")
137.     @override_settings(DATABASE_ROUTERS=[MigrateWhenFooRouter()])
138.     def test_run_sql2(self):
139.         self._test_run_sql("test_mltdb_runsql2", should_run=False)
140.         self._test_run_sql("test_mltdb_runsql2", should_run=True, hints={'foo': True})
141. 
142.     def _test_run_python(self, app_label, should_run, hints=None):
143.         with override_settings(DATABASE_ROUTERS=[MigrateEverythingRouter()]):
144.             project_state = self.set_up_test_model(app_label)
145. 
146.         # Create the operation
147.         def inner_method(models, schema_editor):
148.             Pony = models.get_model(app_label, "Pony")
149.             Pony.objects.create(pink=1, weight=3.55)
150.             Pony.objects.create(weight=5)
151. 
152.         operation = migrations.RunPython(inner_method, hints=hints or {})
153.         # Test the state alteration does nothing
154.         new_state = project_state.clone()
155.         operation.state_forwards(app_label, new_state)
156.         self.assertEqual(new_state, project_state)
157.         # Test the database alteration
158.         self.assertEqual(project_state.apps.get_model(app_label, "Pony").objects.count(), 0)
159.         with connection.schema_editor() as editor:
160.             operation.database_forwards(app_label, editor, project_state, new_state)
161.         Pony = project_state.apps.get_model(app_label, "Pony")
162.         if should_run:
163.             self.assertEqual(Pony.objects.count(), 2)
164.         else:
165.             self.assertEqual(Pony.objects.count(), 0)
166. 
167.     @override_settings(DATABASE_ROUTERS=[MigrateNothingRouter()])
168.     def test_run_python(self):
169.         self._test_run_python("test_mltdb_runpython", should_run=False)
170. 
171.     @override_settings(DATABASE_ROUTERS=[MigrateWhenFooRouter()])
172.     def test_run_python2(self):
173.         self._test_run_python("test_mltdb_runpython2", should_run=False)
174.         self._test_run_python("test_mltdb_runpython2", should_run=True, hints={'foo': True})

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 17:19:06,631 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants to find 3 relevant test cases for a `makemigrations` bug involving database routers.\n2. The provided context includes `tests/migrations/test_commands.py`, which contains relevant test cases.\n3. However, the test classes in `test_commands.py` inherit from `MigrationTestBase`, which is defined in the missing file `tests/migrations/test_base.py`. This base class contains crucial setup and helper methods.\n4. Additionally, the tests rely on custom models like `UnicodeModel`, defined in the missing file `tests/migrations/models.py`.\n5. To provide complete and self-contained test cases as requested, I need the content of these two files.' query='Please provide the full content of `tests/migrations/test_base.py` and `tests/migrations/models.py`.' extra_requirements='' purpose='These files are needed to understand the test setup, helper methods, and model definitions used in the relevant test cases.'
2025-12-24 17:19:06,633 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `tests/migrations/test_base.py` and `tests/migrations/models.py`.
2025-12-24 17:19:06,633 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 17:19:06,633 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 17:19:06,634 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 17:19:06,634 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `tests/migrations/test_base.py` and `tests/migrations/models.py`.
Purpose: These files are needed to understand the test setup, helper methods, and model definitions used in the relevant test cases.
2025-12-24 17:19:09,582 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the full content of the two files you requested: `tests/migrations/test_base.py` and `tests/migrations/models.py`. These files will provide insight into the test setup, including any helper methods, and the models that are used within the tests.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/models.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2102, 'candidates_token_count': 103, 'total_token_count': 2341, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2102}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 103}], 'thoughts_token_count': 136, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1355134260307238, 'model_name': 'gemini-2.5-pro'} id='run--e84468e8-27e6-4d44-acc1-83b9bacc2adb-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_base.py'}, 'id': '14c23578-c6ba-4f82-89c6-12aaaa367be1', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/models.py'}, 'id': 'f6c1bf4e-c07c-4346-ba8d-417aff50c799', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2102, 'output_tokens': 103, 'total_tokens': 2341, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 136}}
2025-12-24 17:19:15,736 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of `tests/migrations/test_base.py` and `tests/migrations/models.py` for you. The first file, `test_base.py`, establishes a base test class with a variety of helper methods and assertions specifically designed for testing Django schema migrations. The second file, `models.py`, defines a collection of Django models that are used within the migration tests to cover different scenarios and edge cases. These files collectively provide the foundation and definitions for testing the migration logic.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4912, 'candidates_token_count': 106, 'total_token_count': 5396, 'cached_content_token_count': 1709, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4912}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1709}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 106}], 'thoughts_token_count': 378}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4469585778578272, 'model_name': 'gemini-2.5-pro'} id='run--e67bda4b-9ebc-4de6-bb17-5e5bca6c0444-0' usage_metadata={'input_tokens': 4912, 'output_tokens': 106, 'total_tokens': 5396, 'input_token_details': {'cache_read': 1709}, 'output_token_details': {'reasoning': 378}}
2025-12-24 17:19:15,738 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `tests/migrations/test_base.py` and `tests/migrations/models.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
These files are needed to understand the test setup, helper methods, and model definitions used in the relevant test cases.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/migrations/models.py
Line number range: 1 - 74
Content:
1. # -*- coding: utf-8 -*-
2. from __future__ import unicode_literals
3. 
4. from django.apps.registry import Apps
5. from django.db import models
6. from django.utils import six
7. from django.utils.encoding import python_2_unicode_compatible
8. 
9. 
10. class CustomModelBase(models.base.ModelBase):
11.     pass
12. 
13. 
14. class ModelWithCustomBase(six.with_metaclass(CustomModelBase, models.Model)):
15.     pass
16. 
17. 
18. @python_2_unicode_compatible
19. class UnicodeModel(models.Model):
20.     title = models.CharField('ÚÑÍ¢ÓÐÉ', max_length=20, default='“Ðjáñgó”')
21. 
22.     class Meta:
23.         # Disable auto loading of this model as we load it on our own
24.         apps = Apps()
25.         verbose_name = 'úñí©óðé µóðéø'
26.         verbose_name_plural = 'úñí©óðé µóðéøß'
27. 
28.     def __str__(self):
29.         return self.title
30. 
31. 
32. class Unserializable(object):
33.     """
34.     An object that migration doesn't know how to serialize.
35.     """
36.     pass
37. 
38. 
39. class UnserializableModel(models.Model):
40.     title = models.CharField(max_length=20, default=Unserializable())
41. 
42.     class Meta:
43.         # Disable auto loading of this model as we load it on our own
44.         apps = Apps()
45. 
46. 
47. class UnmigratedModel(models.Model):
48.     """
49.     A model that is in a migration-less app (which this app is
50.     if its migrations directory has not been repointed)
51.     """
52.     pass
53. 
54. 
55. class EmptyManager(models.Manager):
56.     use_in_migrations = True
57. 
58. 
59. class FoodQuerySet(models.query.QuerySet):
60.     pass
61. 
62. 
63. class BaseFoodManager(models.Manager):
64.     def __init__(self, a, b, c=1, d=2):
65.         super(BaseFoodManager, self).__init__()
66.         self.args = (a, b, c, d)
67. 
68. 
69. class FoodManager(BaseFoodManager.from_queryset(FoodQuerySet)):
70.     use_in_migrations = True
71. 
72. 
73. class NoMigrationFoodManager(BaseFoodManager.from_queryset(FoodQuerySet)):
74.     pass


File: tests/migrations/test_base.py
Line number range: 1 - 124
Content:
1. import os
2. import shutil
3. import tempfile
4. from contextlib import contextmanager
5. from importlib import import_module
6. 
7. from django.apps import apps
8. from django.db import connections
9. from django.db.migrations.recorder import MigrationRecorder
10. from django.test import TransactionTestCase
11. from django.test.utils import extend_sys_path
12. from django.utils.module_loading import module_dir
13. 
14. 
15. class MigrationTestBase(TransactionTestCase):
16.     """
17.     Contains an extended set of asserts for testing migrations and schema operations.
18.     """
19. 
20.     available_apps = ["migrations"]
21. 
22.     def tearDown(self):
23.         # Reset applied-migrations state.
24.         for db in connections:
25.             recorder = MigrationRecorder(connections[db])
26.             recorder.migration_qs.filter(app='migrations').delete()
27. 
28.     def get_table_description(self, table, using='default'):
29.         with connections[using].cursor() as cursor:
30.             return connections[using].introspection.get_table_description(cursor, table)
31. 
32.     def assertTableExists(self, table, using='default'):
33.         with connections[using].cursor() as cursor:
34.             self.assertIn(table, connections[using].introspection.table_names(cursor))
35. 
36.     def assertTableNotExists(self, table, using='default'):
37.         with connections[using].cursor() as cursor:
38.             self.assertNotIn(table, connections[using].introspection.table_names(cursor))
39. 
40.     def assertColumnExists(self, table, column, using='default'):
41.         self.assertIn(column, [c.name for c in self.get_table_description(table, using=using)])
42. 
43.     def assertColumnNotExists(self, table, column, using='default'):
44.         self.assertNotIn(column, [c.name for c in self.get_table_description(table, using=using)])
45. 
46.     def _get_column_allows_null(self, table, column, using):
47.         return [c.null_ok for c in self.get_table_description(table, using=using) if c.name == column][0]
48. 
49.     def assertColumnNull(self, table, column, using='default'):
50.         self.assertEqual(self._get_column_allows_null(table, column, using), True)
51. 
52.     def assertColumnNotNull(self, table, column, using='default'):
53.         self.assertEqual(self._get_column_allows_null(table, column, using), False)
54. 
55.     def assertIndexExists(self, table, columns, value=True, using='default'):
56.         with connections[using].cursor() as cursor:
57.             self.assertEqual(
58.                 value,
59.                 any(
60.                     c["index"]
61.                     for c in connections[using].introspection.get_constraints(cursor, table).values()
62.                     if c['columns'] == list(columns)
63.                 ),
64.             )
65. 
66.     def assertIndexNotExists(self, table, columns):
67.         return self.assertIndexExists(table, columns, False)
68. 
69.     def assertFKExists(self, table, columns, to, value=True, using='default'):
70.         with connections[using].cursor() as cursor:
71.             self.assertEqual(
72.                 value,
73.                 any(
74.                     c["foreign_key"] == to
75.                     for c in connections[using].introspection.get_constraints(cursor, table).values()
76.                     if c['columns'] == list(columns)
77.                 ),
78.             )
79. 
80.     def assertFKNotExists(self, table, columns, to, value=True):
81.         return self.assertFKExists(table, columns, to, False)
82. 
83.     @contextmanager
84.     def temporary_migration_module(self, app_label='migrations', module=None):
85.         """
86.         Allows testing management commands in a temporary migrations module.
87. 
88.         Wrap all invocations to makemigrations and squashmigrations with this
89.         context manager in order to avoid creating migration files in your
90.         source tree inadvertently.
91. 
92.         Takes the application label that will be passed to makemigrations or
93.         squashmigrations and the Python path to a migrations module.
94. 
95.         The migrations module is used as a template for creating the temporary
96.         migrations module. If it isn't provided, the application's migrations
97.         module is used, if it exists.
98. 
99.         Returns the filesystem path to the temporary migrations module.
100.         """
101.         temp_dir = tempfile.mkdtemp()
102.         try:
103.             target_dir = tempfile.mkdtemp(dir=temp_dir)
104.             with open(os.path.join(target_dir, '__init__.py'), 'w'):
105.                 pass
106.             target_migrations_dir = os.path.join(target_dir, 'migrations')
107. 
108.             if module is None:
109.                 module = apps.get_app_config(app_label).name + '.migrations'
110. 
111.             try:
112.                 source_migrations_dir = module_dir(import_module(module))
113.             except (ImportError, ValueError):
114.                 pass
115.             else:
116.                 shutil.copytree(source_migrations_dir, target_migrations_dir)
117. 
118.             with extend_sys_path(temp_dir):
119.                 new_module = os.path.basename(target_dir) + '.migrations'
120.                 with self.settings(MIGRATION_MODULES={app_label: new_module}):
121.                     yield target_migrations_dir
122. 
123.         finally:
124.             shutil.rmtree(temp_dir)

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 17:19:20,970 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of this file.', relative_path='tests/migrations/test_base.py', start_line=1, end_line=124), ContextOutput(reasoning='The user requested the full content of this file.', relative_path='tests/migrations/models.py', start_line=1, end_line=74)]
2025-12-24 17:19:20,971 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `tests/migrations/test_base.py` and `tests/migrations/models.py`.
2025-12-24 17:19:20,971 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 17:19:20,971 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 17:19:20,972 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 5 existing contexts
2025-12-24 17:19:20,972 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 7 total contexts (removed 0 duplicates)
2025-12-24 17:19:20,973 - thread-128178285696704.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-24 17:19:20,973 - thread-128178285696704.prometheus_context_collector - INFO - Successfully retrieved 7 context snippets
