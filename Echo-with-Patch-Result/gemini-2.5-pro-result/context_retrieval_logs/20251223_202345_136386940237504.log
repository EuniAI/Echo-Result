2025-12-23 20:23:45,522 - thread-136386940237504.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: autowrap with cython backend fails when array arguments do not appear in wrapped expr

Description: When using the cython backend for autowrap, it appears that the code is not correctly generated when the function in question has array arguments that do not appear in the final expression. A minimal counterexample is:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
expr = 1.0
f = autowrap(expr, args=(x,), backend='cython')

f(np.array([[1.0, 2.0]]))
```

This should of course return `1.0` but instead fails with:
```python
TypeError: only size-1 arrays can be converted to Python scalars
```

A little inspection reveals that this is because the corresponding C function is generated with an incorrect signature:

```C
double autofunc(double x) {

   double autofunc_result;
   autofunc_result = 1.0;
   return autofunc_result;

}
```

(`x` should be `double *`, not `double` in this case)

I've found that this error won't occur so long as `expr` depends at least in part on each argument. For example this slight modification of the above counterexample works perfectly:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
# now output depends on x
expr = x[0,0]
f = autowrap(expr, args=(x,), backend='cython')

# returns 1.0 as expected, without failure
f(np.array([[1.0, 2.0]]))
```

This may seem like a silly issue ("why even have `x` as an argument if it doesn't appear in the expression you're trying to evaluate?"). But of course in interfacing with external libraries (e.g. for numerical integration), one often needs functions to have a pre-defined signature regardless of whether a given argument contributes to the output.

I think I've identified the problem in `codegen` and will suggest a PR shortly.

Patch information:
diff --git a/sympy/utilities/codegen.py b/sympy/utilities/codegen.py
index f0befb2bd7..8cc1fb8668 100644
--- a/sympy/utilities/codegen.py
+++ b/sympy/utilities/codegen.py
@@ -700,6 +700,14 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
             array_symbols[array.base.label] = array
         for array in expressions.atoms(MatrixSymbol) | local_expressions.atoms(MatrixSymbol):
             array_symbols[array] = array
+        # Also include arrays from the user-specified argument sequence, if any
+        if argument_sequence is not None:
+            for arg in argument_sequence:
+                # Accept IndexedBase and MatrixSymbol in the argument list
+                if isinstance(arg, IndexedBase):
+                    array_symbols[arg.label] = arg
+                elif isinstance(arg, MatrixSymbol):
+                    array_symbols[arg] = arg
 
         for symbol in sorted(symbols, key=str):
             if symbol in array_symbols:
@@ -739,7 +747,16 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
                 try:
                     new_args.append(name_arg_dict[symbol])
                 except KeyError:
-                    new_args.append(InputArgument(symbol))
+                    # If the symbol corresponds to an array-like argument, infer dimensions
+                    if symbol in array_symbols:
+                        dims = []
+                        array = array_symbols[symbol]
+                        for dim in array.shape:
+                            dims.append((S.Zero, dim - 1))
+                        metadata = {'dimensions': dims}
+                    else:
+                        metadata = {}
+                    new_args.append(InputArgument(symbol, **metadata))
             arg_list = new_args
 
         return Routine(name, arg_list, return_val, local_vars, global_vars)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-23 20:23:45,597 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: autowrap with cython backend fails when array arguments do not appear in wrapped expr

Description: When using the cython backend for autowrap, it appears that the code is not correctly generated when the function in question has array arguments that do not appear in the final expression. A minimal counterexample is:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
expr = 1.0
f = autowrap(expr, args=(x,), backend='cython')

f(np.array([[1.0, 2.0]]))
```

This should of course return `1.0` but instead fails with:
```python
TypeError: only size-1 arrays can be converted to Python scalars
```

A little inspection reveals that this is because the corresponding C function is generated with an incorrect signature:

```C
double autofunc(double x) {

   double autofunc_result;
   autofunc_result = 1.0;
   return autofunc_result;

}
```

(`x` should be `double *`, not `double` in this case)

I've found that this error won't occur so long as `expr` depends at least in part on each argument. For example this slight modification of the above counterexample works perfectly:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
# now output depends on x
expr = x[0,0]
f = autowrap(expr, args=(x,), backend='cython')

# returns 1.0 as expected, without failure
f(np.array([[1.0, 2.0]]))
```

This may seem like a silly issue ("why even have `x` as an argument if it doesn't appear in the expression you're trying to evaluate?"). But of course in interfacing with external libraries (e.g. for numerical integration), one often needs functions to have a pre-defined signature regardless of whether a given argument contributes to the output.

I think I've identified the problem in `codegen` and will suggest a PR shortly.

Patch information:
diff --git a/sympy/utilities/codegen.py b/sympy/utilities/codegen.py
index f0befb2bd7..8cc1fb8668 100644
--- a/sympy/utilities/codegen.py
+++ b/sympy/utilities/codegen.py
@@ -700,6 +700,14 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
             array_symbols[array.base.label] = array
         for array in expressions.atoms(MatrixSymbol) | local_expressions.atoms(MatrixSymbol):
             array_symbols[array] = array
+        # Also include arrays from the user-specified argument sequence, if any
+        if argument_sequence is not None:
+            for arg in argument_sequence:
+                # Accept IndexedBase and MatrixSymbol in the argument list
+                if isinstance(arg, IndexedBase):
+                    array_symbols[arg.label] = arg
+                elif isinstance(arg, MatrixSymbol):
+                    array_symbols[arg] = arg
 
         for symbol in sorted(symbols, key=str):
             if symbol in array_symbols:
@@ -739,7 +747,16 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
                 try:
                     new_args.append(name_arg_dict[symbol])
                 except KeyError:
-                    new_args.append(InputArgument(symbol))
+                    # If the symbol corresponds to an array-like argument, infer dimensions
+                    if symbol in array_symbols:
+                        dims = []
+                        array = array_symbols[symbol]
+                        for dim in array.shape:
+                            dims.append((S.Zero, dim - 1))
+                        metadata = {'dimensions': dims}
+                    else:
+                        metadata = {}
+                    new_args.append(InputArgument(symbol, **metadata))
             arg_list = new_args
 
         return Routine(name, arg_list, return_val, local_vars, global_vars)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 20:24:04,587 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find relevant existing test cases for a bug in `autowrap`. The bug involves `autowrap`, the `cython` backend, and `MatrixSymbol` arguments that don't appear in the wrapped expression. The most relevant file to start looking for test cases is the test file for `autowrap` itself. I need the content of this file to analyze the existing tests and find the most similar ones." query='Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.' extra_requirements='' purpose='I need to inspect the tests for `autowrap` to find existing test cases that are relevant to the described bug, which will help in understanding how this functionality is currently tested.'
2025-12-23 20:24:04,589 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.
2025-12-23 20:24:04,589 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 20:24:04,590 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 20:24:04,590 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 20:24:04,590 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.
Purpose: I need to inspect the tests for `autowrap` to find existing test cases that are relevant to the described bug, which will help in understanding how this functionality is currently tested.
2025-12-23 20:24:06,687 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/utilities/tests/test_autowrap.py"}'}, '__gemini_function_call_thought_signatures__': {'ccd5f4f5-805e-4893-afe3-02849f9dc916': 'CvEDAY89a1+WEumCgu8Noh4UP+idpewUqUCpPhx3SFD/dr6FuitTz4zMVWbOr6s+DhmFt0TDO3UEpAVSAK7N9u7oZkkqWm50kGjFhbk++URcXTIruuHG75QFKHDG0sAtdap6f4hNlsrrdIsqSSf56pAB1jo1rLRbnXoM/xMEIHIxl3iGOx3G26gBOSGA90eAbAUdCJmEDdlNueCuJ3wj3M9tv4+fgfncOC3S81kBJ5Z6Ei+mAUHkcdUlf0HIBin/6KsVU2i4PyQlBktJ900rGqvlfsblEi7me+YD4dCczE4YrdVBkuyKm2nJzkORYuK21NXlGDvgQXussrGfVphFJgfQrR/y76lbKd/2RA6AWGewvCF7jsfMdxRMJj9PxAMHgAmYpXgmtWKaVSIQ7iGgxkJIHsNfM6WzIi54YlErITHEv8UcxqN/ARrWDixaaus4L5A/0ioPYH4kwrNixIuBFvzVwsMICiNxiEc/ULI/tnJBTp87FGbPx79SC0Sp1Uvi0kG2NriwZVas8osrAAtj2uHFlXsDe5rDuq/g0PGIm4YLnBJKaL/w3RnNPe6+8C7+8il20/KOSHJSVjWr58LTNtbvUnqqwgvW1Gz/UWR6A42/rjRJMX7l1qfzO1pu/3U62yJpxIF3oVJtCLhUVa+jyk2RCJY='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2117, 'candidates_token_count': 27, 'total_token_count': 2274, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2117}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 130, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.14349703435544614, 'model_name': 'gemini-2.5-pro'} id='run--994deff1-ebc7-469c-ac81-bdd3c6951f19-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/utilities/tests/test_autowrap.py'}, 'id': 'ccd5f4f5-805e-4893-afe3-02849f9dc916', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2117, 'output_tokens': 27, 'total_tokens': 2274, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 130}}
2025-12-23 20:24:08,649 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of the file `sympy/utilities/tests/test_autowrap.py`. This will allow you to examine the existing test cases for the `autowrap` functionality and help you understand how it is currently being tested. You can now proceed with analyzing the file to identify relevant examples for the bug you are addressing.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9633, 'candidates_token_count': 73, 'total_token_count': 9735, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9763}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 73}], 'thoughts_token_count': 29, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0878035793565724, 'model_name': 'gemini-2.5-pro'} id='run--41cda1fb-7660-452d-b6ef-eaf5d9989031-0' usage_metadata={'input_tokens': 9633, 'output_tokens': 73, 'total_tokens': 9735, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 29}}
2025-12-23 20:24:08,657 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to inspect the tests for `autowrap` to find existing test cases that are relevant to the described bug, which will help in understanding how this functionality is currently tested.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/utilities/tests/test_autowrap.py
Line number range: 1 - 469
Content:
1. # Tests that require installed backends go into
2. # sympy/test_external/test_autowrap
3. 
4. import os
5. import tempfile
6. import shutil
7. 
8. from sympy.core import symbols, Eq
9. from sympy.core.compatibility import StringIO
10. from sympy.utilities.autowrap import (autowrap, binary_function,
11.             CythonCodeWrapper, UfuncifyCodeWrapper, CodeWrapper)
12. from sympy.utilities.codegen import (
13.     CCodeGen, C99CodeGen, CodeGenArgumentListError, make_routine
14. )
15. from sympy.utilities.pytest import raises
16. from sympy.utilities.tmpfiles import TmpFileManager
17. 
18. 
19. def get_string(dump_fn, routines, prefix="file", **kwargs):
20.     """Wrapper for dump_fn. dump_fn writes its results to a stream object and
21.        this wrapper returns the contents of that stream as a string. This
22.        auxiliary function is used by many tests below.
23. 
24.        The header and the empty lines are not generator to facilitate the
25.        testing of the output.
26.     """
27.     output = StringIO()
28.     dump_fn(routines, output, prefix, **kwargs)
29.     source = output.getvalue()
30.     output.close()
31.     return source
32. 
33. 
34. def test_cython_wrapper_scalar_function():
35.     x, y, z = symbols('x,y,z')
36.     expr = (x + y)*z
37.     routine = make_routine("test", expr)
38.     code_gen = CythonCodeWrapper(CCodeGen())
39.     source = get_string(code_gen.dump_pyx, [routine])
40. 
41.     expected = (
42.         "cdef extern from 'file.h':\n"
43.         "    double test(double x, double y, double z)\n"
44.         "\n"
45.         "def test_c(double x, double y, double z):\n"
46.         "\n"
47.         "    return test(x, y, z)")
48.     assert source == expected
49. 
50. 
51. def test_cython_wrapper_outarg():
52.     from sympy import Equality
53.     x, y, z = symbols('x,y,z')
54.     code_gen = CythonCodeWrapper(C99CodeGen())
55. 
56.     routine = make_routine("test", Equality(z, x + y))
57.     source = get_string(code_gen.dump_pyx, [routine])
58.     expected = (
59.         "cdef extern from 'file.h':\n"
60.         "    void test(double x, double y, double *z)\n"
61.         "\n"
62.         "def test_c(double x, double y):\n"
63.         "\n"
64.         "    cdef double z = 0\n"
65.         "    test(x, y, &z)\n"
66.         "    return z")
67.     assert source == expected
68. 
69. 
70. def test_cython_wrapper_inoutarg():
71.     from sympy import Equality
72.     x, y, z = symbols('x,y,z')
73.     code_gen = CythonCodeWrapper(C99CodeGen())
74.     routine = make_routine("test", Equality(z, x + y + z))
75.     source = get_string(code_gen.dump_pyx, [routine])
76.     expected = (
77.         "cdef extern from 'file.h':\n"
78.         "    void test(double x, double y, double *z)\n"
79.         "\n"
80.         "def test_c(double x, double y, double z):\n"
81.         "\n"
82.         "    test(x, y, &z)\n"
83.         "    return z")
84.     assert source == expected
85. 
86. 
87. def test_cython_wrapper_compile_flags():
88.     from sympy import Equality
89.     x, y, z = symbols('x,y,z')
90.     routine = make_routine("test", Equality(z, x + y))
91. 
92.     code_gen = CythonCodeWrapper(CCodeGen())
93. 
94.     expected = """\
95. try:
96.     from setuptools import setup
97.     from setuptools import Extension
98. except ImportError:
99.     from distutils.core import setup
100.     from distutils.extension import Extension
101. from Cython.Build import cythonize
102. cy_opts = {}
103. 
104. ext_mods = [Extension(
105.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
106.     include_dirs=[],
107.     library_dirs=[],
108.     libraries=[],
109.     extra_compile_args=['-std=c99'],
110.     extra_link_args=[]
111. )]
112. setup(ext_modules=cythonize(ext_mods, **cy_opts))
113. """ % {'num': CodeWrapper._module_counter}
114. 
115.     temp_dir = tempfile.mkdtemp()
116.     TmpFileManager.tmp_folder(temp_dir)
117.     setup_file_path = os.path.join(temp_dir, 'setup.py')
118. 
119.     code_gen._prepare_files(routine, build_dir=temp_dir)
120.     with open(setup_file_path) as f:
121.         setup_text = f.read()
122.     assert setup_text == expected
123. 
124.     code_gen = CythonCodeWrapper(CCodeGen(),
125.                                  include_dirs=['/usr/local/include', '/opt/booger/include'],
126.                                  library_dirs=['/user/local/lib'],
127.                                  libraries=['thelib', 'nilib'],
128.                                  extra_compile_args=['-slow-math'],
129.                                  extra_link_args=['-lswamp', '-ltrident'],
130.                                  cythonize_options={'compiler_directives': {'boundscheck': False}}
131.                                  )
132.     expected = """\
133. try:
134.     from setuptools import setup
135.     from setuptools import Extension
136. except ImportError:
137.     from distutils.core import setup
138.     from distutils.extension import Extension
139. from Cython.Build import cythonize
140. cy_opts = {'compiler_directives': {'boundscheck': False}}
141. 
142. ext_mods = [Extension(
143.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
144.     include_dirs=['/usr/local/include', '/opt/booger/include'],
145.     library_dirs=['/user/local/lib'],
146.     libraries=['thelib', 'nilib'],
147.     extra_compile_args=['-slow-math', '-std=c99'],
148.     extra_link_args=['-lswamp', '-ltrident']
149. )]
150. setup(ext_modules=cythonize(ext_mods, **cy_opts))
151. """ % {'num': CodeWrapper._module_counter}
152. 
153.     code_gen._prepare_files(routine, build_dir=temp_dir)
154.     with open(setup_file_path) as f:
155.         setup_text = f.read()
156.     assert setup_text == expected
157. 
158.     expected = """\
159. try:
160.     from setuptools import setup
161.     from setuptools import Extension
162. except ImportError:
163.     from distutils.core import setup
164.     from distutils.extension import Extension
165. from Cython.Build import cythonize
166. cy_opts = {'compiler_directives': {'boundscheck': False}}
167. import numpy as np
168. 
169. ext_mods = [Extension(
170.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
171.     include_dirs=['/usr/local/include', '/opt/booger/include', np.get_include()],
172.     library_dirs=['/user/local/lib'],
173.     libraries=['thelib', 'nilib'],
174.     extra_compile_args=['-slow-math', '-std=c99'],
175.     extra_link_args=['-lswamp', '-ltrident']
176. )]
177. setup(ext_modules=cythonize(ext_mods, **cy_opts))
178. """ % {'num': CodeWrapper._module_counter}
179. 
180.     code_gen._need_numpy = True
181.     code_gen._prepare_files(routine, build_dir=temp_dir)
182.     with open(setup_file_path) as f:
183.         setup_text = f.read()
184.     assert setup_text == expected
185. 
186.     TmpFileManager.cleanup()
187. 
188. def test_cython_wrapper_unique_dummyvars():
189.     from sympy import Dummy, Equality
190.     x, y, z = Dummy('x'), Dummy('y'), Dummy('z')
191.     x_id, y_id, z_id = [str(d.dummy_index) for d in [x, y, z]]
192.     expr = Equality(z, x + y)
193.     routine = make_routine("test", expr)
194.     code_gen = CythonCodeWrapper(CCodeGen())
195.     source = get_string(code_gen.dump_pyx, [routine])
196.     expected_template = (
197.         "cdef extern from 'file.h':\n"
198.         "    void test(double x_{x_id}, double y_{y_id}, double *z_{z_id})\n"
199.         "\n"
200.         "def test_c(double x_{x_id}, double y_{y_id}):\n"
201.         "\n"
202.         "    cdef double z_{z_id} = 0\n"
203.         "    test(x_{x_id}, y_{y_id}, &z_{z_id})\n"
204.         "    return z_{z_id}")
205.     expected = expected_template.format(x_id=x_id, y_id=y_id, z_id=z_id)
206.     assert source == expected
207. 
208. def test_autowrap_dummy():
209.     x, y, z = symbols('x y z')
210. 
211.     # Uses DummyWrapper to test that codegen works as expected
212. 
213.     f = autowrap(x + y, backend='dummy')
214.     assert f() == str(x + y)
215.     assert f.args == "x, y"
216.     assert f.returns == "nameless"
217.     f = autowrap(Eq(z, x + y), backend='dummy')
218.     assert f() == str(x + y)
219.     assert f.args == "x, y"
220.     assert f.returns == "z"
221.     f = autowrap(Eq(z, x + y + z), backend='dummy')
222.     assert f() == str(x + y + z)
223.     assert f.args == "x, y, z"
224.     assert f.returns == "z"
225. 
226. 
227. def test_autowrap_args():
228.     x, y, z = symbols('x y z')
229. 
230.     raises(CodeGenArgumentListError, lambda: autowrap(Eq(z, x + y),
231.            backend='dummy', args=[x]))
232.     f = autowrap(Eq(z, x + y), backend='dummy', args=[y, x])
233.     assert f() == str(x + y)
234.     assert f.args == "y, x"
235.     assert f.returns == "z"
236. 
237.     raises(CodeGenArgumentListError, lambda: autowrap(Eq(z, x + y + z),
238.            backend='dummy', args=[x, y]))
239.     f = autowrap(Eq(z, x + y + z), backend='dummy', args=[y, x, z])
240.     assert f() == str(x + y + z)
241.     assert f.args == "y, x, z"
242.     assert f.returns == "z"
243. 
244.     f = autowrap(Eq(z, x + y + z), backend='dummy', args=(y, x, z))
245.     assert f() == str(x + y + z)
246.     assert f.args == "y, x, z"
247.     assert f.returns == "z"
248. 
249. def test_autowrap_store_files():
250.     x, y = symbols('x y')
251.     tmp = tempfile.mkdtemp()
252.     TmpFileManager.tmp_folder(tmp)
253. 
254.     f = autowrap(x + y, backend='dummy', tempdir=tmp)
255.     assert f() == str(x + y)
256.     assert os.access(tmp, os.F_OK)
257. 
258.     TmpFileManager.cleanup()
259. 
260. def test_autowrap_store_files_issue_gh12939():
261.     x, y = symbols('x y')
262.     tmp = './tmp'
263.     try:
264.         f = autowrap(x + y, backend='dummy', tempdir=tmp)
265.         assert f() == str(x + y)
266.         assert os.access(tmp, os.F_OK)
267.     finally:
268.         shutil.rmtree(tmp)
269. 
270. 
271. 
272. def test_binary_function():
273.     x, y = symbols('x y')
274.     f = binary_function('f', x + y, backend='dummy')
275.     assert f._imp_() == str(x + y)
276. 
277. 
278. def test_ufuncify_source():
279.     x, y, z = symbols('x,y,z')
280.     code_wrapper = UfuncifyCodeWrapper(C99CodeGen("ufuncify"))
281.     routine = make_routine("test", x + y + z)
282.     source = get_string(code_wrapper.dump_c, [routine])
283.     expected = """\
284. #include "Python.h"
285. #include "math.h"
286. #include "numpy/ndarraytypes.h"
287. #include "numpy/ufuncobject.h"
288. #include "numpy/halffloat.h"
289. #include "file.h"
290. 
291. static PyMethodDef wrapper_module_%(num)sMethods[] = {
292.         {NULL, NULL, 0, NULL}
293. };
294. 
295. static void test_ufunc(char **args, npy_intp *dimensions, npy_intp* steps, void* data)
296. {
297.     npy_intp i;
298.     npy_intp n = dimensions[0];
299.     char *in0 = args[0];
300.     char *in1 = args[1];
301.     char *in2 = args[2];
302.     char *out0 = args[3];
303.     npy_intp in0_step = steps[0];
304.     npy_intp in1_step = steps[1];
305.     npy_intp in2_step = steps[2];
306.     npy_intp out0_step = steps[3];
307.     for (i = 0; i < n; i++) {
308.         *((double *)out0) = test(*(double *)in0, *(double *)in1, *(double *)in2);
309.         in0 += in0_step;
310.         in1 += in1_step;
311.         in2 += in2_step;
312.         out0 += out0_step;
313.     }
314. }
315. PyUFuncGenericFunction test_funcs[1] = {&test_ufunc};
316. static char test_types[4] = {NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE};
317. static void *test_data[1] = {NULL};
318. 
319. #if PY_VERSION_HEX >= 0x03000000
320. static struct PyModuleDef moduledef = {
321.     PyModuleDef_HEAD_INIT,
322.     "wrapper_module_%(num)s",
323.     NULL,
324.     -1,
325.     wrapper_module_%(num)sMethods,
326.     NULL,
327.     NULL,
328.     NULL,
329.     NULL
330. };
331. 
332. PyMODINIT_FUNC PyInit_wrapper_module_%(num)s(void)
333. {
334.     PyObject *m, *d;
335.     PyObject *ufunc0;
336.     m = PyModule_Create(&moduledef);
337.     if (!m) {
338.         return NULL;
339.     }
340.     import_array();
341.     import_umath();
342.     d = PyModule_GetDict(m);
343.     ufunc0 = PyUFunc_FromFuncAndData(test_funcs, test_data, test_types, 1, 3, 1,
344.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
345.     PyDict_SetItemString(d, "test", ufunc0);
346.     Py_DECREF(ufunc0);
347.     return m;
348. }
349. #else
350. PyMODINIT_FUNC initwrapper_module_%(num)s(void)
351. {
352.     PyObject *m, *d;
353.     PyObject *ufunc0;
354.     m = Py_InitModule("wrapper_module_%(num)s", wrapper_module_%(num)sMethods);
355.     if (m == NULL) {
356.         return;
357.     }
358.     import_array();
359.     import_umath();
360.     d = PyModule_GetDict(m);
361.     ufunc0 = PyUFunc_FromFuncAndData(test_funcs, test_data, test_types, 1, 3, 1,
362.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
363.     PyDict_SetItemString(d, "test", ufunc0);
364.     Py_DECREF(ufunc0);
365. }
366. #endif""" % {'num': CodeWrapper._module_counter}
367.     assert source == expected
368. 
369. 
370. def test_ufuncify_source_multioutput():
371.     x, y, z = symbols('x,y,z')
372.     var_symbols = (x, y, z)
373.     expr = x + y**3 + 10*z**2
374.     code_wrapper = UfuncifyCodeWrapper(C99CodeGen("ufuncify"))
375.     routines = [make_routine("func{}".format(i), expr.diff(var_symbols[i]), var_symbols) for i in range(len(var_symbols))]
376.     source = get_string(code_wrapper.dump_c, routines, funcname='multitest')
377.     expected = """\
378. #include "Python.h"
379. #include "math.h"
380. #include "numpy/ndarraytypes.h"
381. #include "numpy/ufuncobject.h"
382. #include "numpy/halffloat.h"
383. #include "file.h"
384. 
385. static PyMethodDef wrapper_module_%(num)sMethods[] = {
386.         {NULL, NULL, 0, NULL}
387. };
388. 
389. static void multitest_ufunc(char **args, npy_intp *dimensions, npy_intp* steps, void* data)
390. {
391.     npy_intp i;
392.     npy_intp n = dimensions[0];
393.     char *in0 = args[0];
394.     char *in1 = args[1];
395.     char *in2 = args[2];
396.     char *out0 = args[3];
397.     char *out1 = args[4];
398.     char *out2 = args[5];
399.     npy_intp in0_step = steps[0];
400.     npy_intp in1_step = steps[1];
401.     npy_intp in2_step = steps[2];
402.     npy_intp out0_step = steps[3];
403.     npy_intp out1_step = steps[4];
404.     npy_intp out2_step = steps[5];
405.     for (i = 0; i < n; i++) {
406.         *((double *)out0) = func0(*(double *)in0, *(double *)in1, *(double *)in2);
407.         *((double *)out1) = func1(*(double *)in0, *(double *)in1, *(double *)in2);
408.         *((double *)out2) = func2(*(double *)in0, *(double *)in1, *(double *)in2);
409.         in0 += in0_step;
410.         in1 += in1_step;
411.         in2 += in2_step;
412.         out0 += out0_step;
413.         out1 += out1_step;
414.         out2 += out2_step;
415.     }
416. }
417. PyUFuncGenericFunction multitest_funcs[1] = {&multitest_ufunc};
418. static char multitest_types[6] = {NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE};
419. static void *multitest_data[1] = {NULL};
420. 
421. #if PY_VERSION_HEX >= 0x03000000
422. static struct PyModuleDef moduledef = {
423.     PyModuleDef_HEAD_INIT,
424.     "wrapper_module_%(num)s",
425.     NULL,
426.     -1,
427.     wrapper_module_%(num)sMethods,
428.     NULL,
429.     NULL,
430.     NULL,
431.     NULL
432. };
433. 
434. PyMODINIT_FUNC PyInit_wrapper_module_%(num)s(void)
435. {
436.     PyObject *m, *d;
437.     PyObject *ufunc0;
438.     m = PyModule_Create(&moduledef);
439.     if (!m) {
440.         return NULL;
441.     }
442.     import_array();
443.     import_umath();
444.     d = PyModule_GetDict(m);
445.     ufunc0 = PyUFunc_FromFuncAndData(multitest_funcs, multitest_data, multitest_types, 1, 3, 3,
446.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
447.     PyDict_SetItemString(d, "multitest", ufunc0);
448.     Py_DECREF(ufunc0);
449.     return m;
450. }
451. #else
452. PyMODINIT_FUNC initwrapper_module_%(num)s(void)
453. {
454.     PyObject *m, *d;
455.     PyObject *ufunc0;
456.     m = Py_InitModule("wrapper_module_%(num)s", wrapper_module_%(num)sMethods);
457.     if (m == NULL) {
458.         return;
459.     }
460.     import_array();
461.     import_umath();
462.     d = PyModule_GetDict(m);
463.     ufunc0 = PyUFunc_FromFuncAndData(multitest_funcs, multitest_data, multitest_types, 1, 3, 3,
464.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
465.     PyDict_SetItemString(d, "multitest", ufunc0);
466.     Py_DECREF(ufunc0);
467. }
468. #endif""" % {'num': CodeWrapper._module_counter}
469.     assert source == expected

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 20:24:13,563 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user has requested the full content of the file 'sympy/utilities/tests/test_autowrap.py'. This file contains the test suite for the `autowrap` functionality in SymPy, which is what the user needs to inspect.", relative_path='sympy/utilities/tests/test_autowrap.py', start_line=1, end_line=469)]
2025-12-23 20:24:13,571 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.
2025-12-23 20:24:13,571 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 20:24:13,571 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 20:24:13,572 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-23 20:24:13,572 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-23 20:24:13,573 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: autowrap with cython backend fails when array arguments do not appear in wrapped expr

Description: When using the cython backend for autowrap, it appears that the code is not correctly generated when the function in question has array arguments that do not appear in the final expression. A minimal counterexample is:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
expr = 1.0
f = autowrap(expr, args=(x,), backend='cython')

f(np.array([[1.0, 2.0]]))
```

This should of course return `1.0` but instead fails with:
```python
TypeError: only size-1 arrays can be converted to Python scalars
```

A little inspection reveals that this is because the corresponding C function is generated with an incorrect signature:

```C
double autofunc(double x) {

   double autofunc_result;
   autofunc_result = 1.0;
   return autofunc_result;

}
```

(`x` should be `double *`, not `double` in this case)

I've found that this error won't occur so long as `expr` depends at least in part on each argument. For example this slight modification of the above counterexample works perfectly:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
# now output depends on x
expr = x[0,0]
f = autowrap(expr, args=(x,), backend='cython')

# returns 1.0 as expected, without failure
f(np.array([[1.0, 2.0]]))
```

This may seem like a silly issue ("why even have `x` as an argument if it doesn't appear in the expression you're trying to evaluate?"). But of course in interfacing with external libraries (e.g. for numerical integration), one often needs functions to have a pre-defined signature regardless of whether a given argument contributes to the output.

I think I've identified the problem in `codegen` and will suggest a PR shortly.

Patch information:
diff --git a/sympy/utilities/codegen.py b/sympy/utilities/codegen.py
index f0befb2bd7..8cc1fb8668 100644
--- a/sympy/utilities/codegen.py
+++ b/sympy/utilities/codegen.py
@@ -700,6 +700,14 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
             array_symbols[array.base.label] = array
         for array in expressions.atoms(MatrixSymbol) | local_expressions.atoms(MatrixSymbol):
             array_symbols[array] = array
+        # Also include arrays from the user-specified argument sequence, if any
+        if argument_sequence is not None:
+            for arg in argument_sequence:
+                # Accept IndexedBase and MatrixSymbol in the argument list
+                if isinstance(arg, IndexedBase):
+                    array_symbols[arg.label] = arg
+                elif isinstance(arg, MatrixSymbol):
+                    array_symbols[arg] = arg
 
         for symbol in sorted(symbols, key=str):
             if symbol in array_symbols:
@@ -739,7 +747,16 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
                 try:
                     new_args.append(name_arg_dict[symbol])
                 except KeyError:
-                    new_args.append(InputArgument(symbol))
+                    # If the symbol corresponds to an array-like argument, infer dimensions
+                    if symbol in array_symbols:
+                        dims = []
+                        array = array_symbols[symbol]
+                        for dim in array.shape:
+                            dims.append((S.Zero, dim - 1))
+                        metadata = {'dimensions': dims}
+                    else:
+                        metadata = {}
+                    new_args.append(InputArgument(symbol, **metadata))
             arg_list = new_args
 
         return Routine(name, arg_list, return_val, local_vars, global_vars)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.
Extra Requirements: 
Purpose: I need to inspect the tests for `autowrap` to find existing test cases that are relevant to the described bug, which will help in understanding how this functionality is currently tested.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/utilities/tests/test_autowrap.py
Line number range: 1 - 469
Content:
1. # Tests that require installed backends go into
2. # sympy/test_external/test_autowrap
3. 
4. import os
5. import tempfile
6. import shutil
7. 
8. from sympy.core import symbols, Eq
9. from sympy.core.compatibility import StringIO
10. from sympy.utilities.autowrap import (autowrap, binary_function,
11.             CythonCodeWrapper, UfuncifyCodeWrapper, CodeWrapper)
12. from sympy.utilities.codegen import (
13.     CCodeGen, C99CodeGen, CodeGenArgumentListError, make_routine
14. )
15. from sympy.utilities.pytest import raises
16. from sympy.utilities.tmpfiles import TmpFileManager
17. 
18. 
19. def get_string(dump_fn, routines, prefix="file", **kwargs):
20.     """Wrapper for dump_fn. dump_fn writes its results to a stream object and
21.        this wrapper returns the contents of that stream as a string. This
22.        auxiliary function is used by many tests below.
23. 
24.        The header and the empty lines are not generator to facilitate the
25.        testing of the output.
26.     """
27.     output = StringIO()
28.     dump_fn(routines, output, prefix, **kwargs)
29.     source = output.getvalue()
30.     output.close()
31.     return source
32. 
33. 
34. def test_cython_wrapper_scalar_function():
35.     x, y, z = symbols('x,y,z')
36.     expr = (x + y)*z
37.     routine = make_routine("test", expr)
38.     code_gen = CythonCodeWrapper(CCodeGen())
39.     source = get_string(code_gen.dump_pyx, [routine])
40. 
41.     expected = (
42.         "cdef extern from 'file.h':\n"
43.         "    double test(double x, double y, double z)\n"
44.         "\n"
45.         "def test_c(double x, double y, double z):\n"
46.         "\n"
47.         "    return test(x, y, z)")
48.     assert source == expected
49. 
50. 
51. def test_cython_wrapper_outarg():
52.     from sympy import Equality
53.     x, y, z = symbols('x,y,z')
54.     code_gen = CythonCodeWrapper(C99CodeGen())
55. 
56.     routine = make_routine("test", Equality(z, x + y))
57.     source = get_string(code_gen.dump_pyx, [routine])
58.     expected = (
59.         "cdef extern from 'file.h':\n"
60.         "    void test(double x, double y, double *z)\n"
61.         "\n"
62.         "def test_c(double x, double y):\n"
63.         "\n"
64.         "    cdef double z = 0\n"
65.         "    test(x, y, &z)\n"
66.         "    return z")
67.     assert source == expected
68. 
69. 
70. def test_cython_wrapper_inoutarg():
71.     from sympy import Equality
72.     x, y, z = symbols('x,y,z')
73.     code_gen = CythonCodeWrapper(C99CodeGen())
74.     routine = make_routine("test", Equality(z, x + y + z))
75.     source = get_string(code_gen.dump_pyx, [routine])
76.     expected = (
77.         "cdef extern from 'file.h':\n"
78.         "    void test(double x, double y, double *z)\n"
79.         "\n"
80.         "def test_c(double x, double y, double z):\n"
81.         "\n"
82.         "    test(x, y, &z)\n"
83.         "    return z")
84.     assert source == expected
85. 
86. 
87. def test_cython_wrapper_compile_flags():
88.     from sympy import Equality
89.     x, y, z = symbols('x,y,z')
90.     routine = make_routine("test", Equality(z, x + y))
91. 
92.     code_gen = CythonCodeWrapper(CCodeGen())
93. 
94.     expected = """\
95. try:
96.     from setuptools import setup
97.     from setuptools import Extension
98. except ImportError:
99.     from distutils.core import setup
100.     from distutils.extension import Extension
101. from Cython.Build import cythonize
102. cy_opts = {}
103. 
104. ext_mods = [Extension(
105.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
106.     include_dirs=[],
107.     library_dirs=[],
108.     libraries=[],
109.     extra_compile_args=['-std=c99'],
110.     extra_link_args=[]
111. )]
112. setup(ext_modules=cythonize(ext_mods, **cy_opts))
113. """ % {'num': CodeWrapper._module_counter}
114. 
115.     temp_dir = tempfile.mkdtemp()
116.     TmpFileManager.tmp_folder(temp_dir)
117.     setup_file_path = os.path.join(temp_dir, 'setup.py')
118. 
119.     code_gen._prepare_files(routine, build_dir=temp_dir)
120.     with open(setup_file_path) as f:
121.         setup_text = f.read()
122.     assert setup_text == expected
123. 
124.     code_gen = CythonCodeWrapper(CCodeGen(),
125.                                  include_dirs=['/usr/local/include', '/opt/booger/include'],
126.                                  library_dirs=['/user/local/lib'],
127.                                  libraries=['thelib', 'nilib'],
128.                                  extra_compile_args=['-slow-math'],
129.                                  extra_link_args=['-lswamp', '-ltrident'],
130.                                  cythonize_options={'compiler_directives': {'boundscheck': False}}
131.                                  )
132.     expected = """\
133. try:
134.     from setuptools import setup
135.     from setuptools import Extension
136. except ImportError:
137.     from distutils.core import setup
138.     from distutils.extension import Extension
139. from Cython.Build import cythonize
140. cy_opts = {'compiler_directives': {'boundscheck': False}}
141. 
142. ext_mods = [Extension(
143.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
144.     include_dirs=['/usr/local/include', '/opt/booger/include'],
145.     library_dirs=['/user/local/lib'],
146.     libraries=['thelib', 'nilib'],
147.     extra_compile_args=['-slow-math', '-std=c99'],
148.     extra_link_args=['-lswamp', '-ltrident']
149. )]
150. setup(ext_modules=cythonize(ext_mods, **cy_opts))
151. """ % {'num': CodeWrapper._module_counter}
152. 
153.     code_gen._prepare_files(routine, build_dir=temp_dir)
154.     with open(setup_file_path) as f:
155.         setup_text = f.read()
156.     assert setup_text == expected
157. 
158.     expected = """\
159. try:
160.     from setuptools import setup
161.     from setuptools import Extension
162. except ImportError:
163.     from distutils.core import setup
164.     from distutils.extension import Extension
165. from Cython.Build import cythonize
166. cy_opts = {'compiler_directives': {'boundscheck': False}}
167. import numpy as np
168. 
169. ext_mods = [Extension(
170.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
171.     include_dirs=['/usr/local/include', '/opt/booger/include', np.get_include()],
172.     library_dirs=['/user/local/lib'],
173.     libraries=['thelib', 'nilib'],
174.     extra_compile_args=['-slow-math', '-std=c99'],
175.     extra_link_args=['-lswamp', '-ltrident']
176. )]
177. setup(ext_modules=cythonize(ext_mods, **cy_opts))
178. """ % {'num': CodeWrapper._module_counter}
179. 
180.     code_gen._need_numpy = True
181.     code_gen._prepare_files(routine, build_dir=temp_dir)
182.     with open(setup_file_path) as f:
183.         setup_text = f.read()
184.     assert setup_text == expected
185. 
186.     TmpFileManager.cleanup()
187. 
188. def test_cython_wrapper_unique_dummyvars():
189.     from sympy import Dummy, Equality
190.     x, y, z = Dummy('x'), Dummy('y'), Dummy('z')
191.     x_id, y_id, z_id = [str(d.dummy_index) for d in [x, y, z]]
192.     expr = Equality(z, x + y)
193.     routine = make_routine("test", expr)
194.     code_gen = CythonCodeWrapper(CCodeGen())
195.     source = get_string(code_gen.dump_pyx, [routine])
196.     expected_template = (
197.         "cdef extern from 'file.h':\n"
198.         "    void test(double x_{x_id}, double y_{y_id}, double *z_{z_id})\n"
199.         "\n"
200.         "def test_c(double x_{x_id}, double y_{y_id}):\n"
201.         "\n"
202.         "    cdef double z_{z_id} = 0\n"
203.         "    test(x_{x_id}, y_{y_id}, &z_{z_id})\n"
204.         "    return z_{z_id}")
205.     expected = expected_template.format(x_id=x_id, y_id=y_id, z_id=z_id)
206.     assert source == expected
207. 
208. def test_autowrap_dummy():
209.     x, y, z = symbols('x y z')
210. 
211.     # Uses DummyWrapper to test that codegen works as expected
212. 
213.     f = autowrap(x + y, backend='dummy')
214.     assert f() == str(x + y)
215.     assert f.args == "x, y"
216.     assert f.returns == "nameless"
217.     f = autowrap(Eq(z, x + y), backend='dummy')
218.     assert f() == str(x + y)
219.     assert f.args == "x, y"
220.     assert f.returns == "z"
221.     f = autowrap(Eq(z, x + y + z), backend='dummy')
222.     assert f() == str(x + y + z)
223.     assert f.args == "x, y, z"
224.     assert f.returns == "z"
225. 
226. 
227. def test_autowrap_args():
228.     x, y, z = symbols('x y z')
229. 
230.     raises(CodeGenArgumentListError, lambda: autowrap(Eq(z, x + y),
231.            backend='dummy', args=[x]))
232.     f = autowrap(Eq(z, x + y), backend='dummy', args=[y, x])
233.     assert f() == str(x + y)
234.     assert f.args == "y, x"
235.     assert f.returns == "z"
236. 
237.     raises(CodeGenArgumentListError, lambda: autowrap(Eq(z, x + y + z),
238.            backend='dummy', args=[x, y]))
239.     f = autowrap(Eq(z, x + y + z), backend='dummy', args=[y, x, z])
240.     assert f() == str(x + y + z)
241.     assert f.args == "y, x, z"
242.     assert f.returns == "z"
243. 
244.     f = autowrap(Eq(z, x + y + z), backend='dummy', args=(y, x, z))
245.     assert f() == str(x + y + z)
246.     assert f.args == "y, x, z"
247.     assert f.returns == "z"
248. 
249. def test_autowrap_store_files():
250.     x, y = symbols('x y')
251.     tmp = tempfile.mkdtemp()
252.     TmpFileManager.tmp_folder(tmp)
253. 
254.     f = autowrap(x + y, backend='dummy', tempdir=tmp)
255.     assert f() == str(x + y)
256.     assert os.access(tmp, os.F_OK)
257. 
258.     TmpFileManager.cleanup()
259. 
260. def test_autowrap_store_files_issue_gh12939():
261.     x, y = symbols('x y')
262.     tmp = './tmp'
263.     try:
264.         f = autowrap(x + y, backend='dummy', tempdir=tmp)
265.         assert f() == str(x + y)
266.         assert os.access(tmp, os.F_OK)
267.     finally:
268.         shutil.rmtree(tmp)
269. 
270. 
271. 
272. def test_binary_function():
273.     x, y = symbols('x y')
274.     f = binary_function('f', x + y, backend='dummy')
275.     assert f._imp_() == str(x + y)
276. 
277. 
278. def test_ufuncify_source():
279.     x, y, z = symbols('x,y,z')
280.     code_wrapper = UfuncifyCodeWrapper(C99CodeGen("ufuncify"))
281.     routine = make_routine("test", x + y + z)
282.     source = get_string(code_wrapper.dump_c, [routine])
283.     expected = """\
284. #include "Python.h"
285. #include "math.h"
286. #include "numpy/ndarraytypes.h"
287. #include "numpy/ufuncobject.h"
288. #include "numpy/halffloat.h"
289. #include "file.h"
290. 
291. static PyMethodDef wrapper_module_%(num)sMethods[] = {
292.         {NULL, NULL, 0, NULL}
293. };
294. 
295. static void test_ufunc(char **args, npy_intp *dimensions, npy_intp* steps, void* data)
296. {
297.     npy_intp i;
298.     npy_intp n = dimensions[0];
299.     char *in0 = args[0];
300.     char *in1 = args[1];
301.     char *in2 = args[2];
302.     char *out0 = args[3];
303.     npy_intp in0_step = steps[0];
304.     npy_intp in1_step = steps[1];
305.     npy_intp in2_step = steps[2];
306.     npy_intp out0_step = steps[3];
307.     for (i = 0; i < n; i++) {
308.         *((double *)out0) = test(*(double *)in0, *(double *)in1, *(double *)in2);
309.         in0 += in0_step;
310.         in1 += in1_step;
311.         in2 += in2_step;
312.         out0 += out0_step;
313.     }
314. }
315. PyUFuncGenericFunction test_funcs[1] = {&test_ufunc};
316. static char test_types[4] = {NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE};
317. static void *test_data[1] = {NULL};
318. 
319. #if PY_VERSION_HEX >= 0x03000000
320. static struct PyModuleDef moduledef = {
321.     PyModuleDef_HEAD_INIT,
322.     "wrapper_module_%(num)s",
323.     NULL,
324.     -1,
325.     wrapper_module_%(num)sMethods,
326.     NULL,
327.     NULL,
328.     NULL,
329.     NULL
330. };
331. 
332. PyMODINIT_FUNC PyInit_wrapper_module_%(num)s(void)
333. {
334.     PyObject *m, *d;
335.     PyObject *ufunc0;
336.     m = PyModule_Create(&moduledef);
337.     if (!m) {
338.         return NULL;
339.     }
340.     import_array();
341.     import_umath();
342.     d = PyModule_GetDict(m);
343.     ufunc0 = PyUFunc_FromFuncAndData(test_funcs, test_data, test_types, 1, 3, 1,
344.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
345.     PyDict_SetItemString(d, "test", ufunc0);
346.     Py_DECREF(ufunc0);
347.     return m;
348. }
349. #else
350. PyMODINIT_FUNC initwrapper_module_%(num)s(void)
351. {
352.     PyObject *m, *d;
353.     PyObject *ufunc0;
354.     m = Py_InitModule("wrapper_module_%(num)s", wrapper_module_%(num)sMethods);
355.     if (m == NULL) {
356.         return;
357.     }
358.     import_array();
359.     import_umath();
360.     d = PyModule_GetDict(m);
361.     ufunc0 = PyUFunc_FromFuncAndData(test_funcs, test_data, test_types, 1, 3, 1,
362.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
363.     PyDict_SetItemString(d, "test", ufunc0);
364.     Py_DECREF(ufunc0);
365. }
366. #endif""" % {'num': CodeWrapper._module_counter}
367.     assert source == expected
368. 
369. 
370. def test_ufuncify_source_multioutput():
371.     x, y, z = symbols('x,y,z')
372.     var_symbols = (x, y, z)
373.     expr = x + y**3 + 10*z**2
374.     code_wrapper = UfuncifyCodeWrapper(C99CodeGen("ufuncify"))
375.     routines = [make_routine("func{}".format(i), expr.diff(var_symbols[i]), var_symbols) for i in range(len(var_symbols))]
376.     source = get_string(code_wrapper.dump_c, routines, funcname='multitest')
377.     expected = """\
378. #include "Python.h"
379. #include "math.h"
380. #include "numpy/ndarraytypes.h"
381. #include "numpy/ufuncobject.h"
382. #include "numpy/halffloat.h"
383. #include "file.h"
384. 
385. static PyMethodDef wrapper_module_%(num)sMethods[] = {
386.         {NULL, NULL, 0, NULL}
387. };
388. 
389. static void multitest_ufunc(char **args, npy_intp *dimensions, npy_intp* steps, void* data)
390. {
391.     npy_intp i;
392.     npy_intp n = dimensions[0];
393.     char *in0 = args[0];
394.     char *in1 = args[1];
395.     char *in2 = args[2];
396.     char *out0 = args[3];
397.     char *out1 = args[4];
398.     char *out2 = args[5];
399.     npy_intp in0_step = steps[0];
400.     npy_intp in1_step = steps[1];
401.     npy_intp in2_step = steps[2];
402.     npy_intp out0_step = steps[3];
403.     npy_intp out1_step = steps[4];
404.     npy_intp out2_step = steps[5];
405.     for (i = 0; i < n; i++) {
406.         *((double *)out0) = func0(*(double *)in0, *(double *)in1, *(double *)in2);
407.         *((double *)out1) = func1(*(double *)in0, *(double *)in1, *(double *)in2);
408.         *((double *)out2) = func2(*(double *)in0, *(double *)in1, *(double *)in2);
409.         in0 += in0_step;
410.         in1 += in1_step;
411.         in2 += in2_step;
412.         out0 += out0_step;
413.         out1 += out1_step;
414.         out2 += out2_step;
415.     }
416. }
417. PyUFuncGenericFunction multitest_funcs[1] = {&multitest_ufunc};
418. static char multitest_types[6] = {NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE};
419. static void *multitest_data[1] = {NULL};
420. 
421. #if PY_VERSION_HEX >= 0x03000000
422. static struct PyModuleDef moduledef = {
423.     PyModuleDef_HEAD_INIT,
424.     "wrapper_module_%(num)s",
425.     NULL,
426.     -1,
427.     wrapper_module_%(num)sMethods,
428.     NULL,
429.     NULL,
430.     NULL,
431.     NULL
432. };
433. 
434. PyMODINIT_FUNC PyInit_wrapper_module_%(num)s(void)
435. {
436.     PyObject *m, *d;
437.     PyObject *ufunc0;
438.     m = PyModule_Create(&moduledef);
439.     if (!m) {
440.         return NULL;
441.     }
442.     import_array();
443.     import_umath();
444.     d = PyModule_GetDict(m);
445.     ufunc0 = PyUFunc_FromFuncAndData(multitest_funcs, multitest_data, multitest_types, 1, 3, 3,
446.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
447.     PyDict_SetItemString(d, "multitest", ufunc0);
448.     Py_DECREF(ufunc0);
449.     return m;
450. }
451. #else
452. PyMODINIT_FUNC initwrapper_module_%(num)s(void)
453. {
454.     PyObject *m, *d;
455.     PyObject *ufunc0;
456.     m = Py_InitModule("wrapper_module_%(num)s", wrapper_module_%(num)sMethods);
457.     if (m == NULL) {
458.         return;
459.     }
460.     import_array();
461.     import_umath();
462.     d = PyModule_GetDict(m);
463.     ufunc0 = PyUFunc_FromFuncAndData(multitest_funcs, multitest_data, multitest_types, 1, 3, 3,
464.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
465.     PyDict_SetItemString(d, "multitest", ufunc0);
466.     Py_DECREF(ufunc0);
467. }
468. #endif""" % {'num': CodeWrapper._module_counter}
469.     assert source == expected

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 20:24:33,670 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user is looking for test cases related to a bug in `autowrap` with the `cython` backend and array arguments. The currently provided test file, `sympy/utilities/tests/test_autowrap.py`, explicitly states that tests requiring installed backends are located elsewhere. The bug described is a runtime error that would only be caught by an integration test that compiles and runs the code. The file `sympy/external/tests/test_autowrap.py` seems to be the correct location for such tests. Therefore, I need the content of that file to find relevant test cases.' query='Please provide the full content of the file sympy/external/tests/test_autowrap.py.' extra_requirements='' purpose="This file is expected to contain integration tests for `autowrap` with installed backends like Cython, which are necessary to find test cases relevant to the user's bug involving array arguments and runtime behavior."
2025-12-23 20:24:33,671 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of the file sympy/external/tests/test_autowrap.py.
2025-12-23 20:24:33,671 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-23 20:24:33,672 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-23 20:24:33,672 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-23 20:24:33,673 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of the file sympy/external/tests/test_autowrap.py.
Purpose: This file is expected to contain integration tests for `autowrap` with installed backends like Cython, which are necessary to find test cases relevant to the user's bug involving array arguments and runtime behavior.
2025-12-23 20:24:35,599 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of the `sympy/external/tests/test_autowrap.py` file as you requested. This will allow you to examine the integration tests for `autowrap`, including those that are relevant to array arguments and runtime behavior.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/external/tests/test_autowrap.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2123, 'candidates_token_count': 82, 'total_token_count': 2269, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2123}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 64, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.07954858570564084, 'model_name': 'gemini-2.5-pro'} id='run--24007490-a90c-443d-8916-f6ac1c372f24-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/external/tests/test_autowrap.py'}, 'id': 'a243748a-3aaf-4231-827e-3cbd446e8717', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2123, 'output_tokens': 82, 'total_tokens': 2269, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 64}}
2025-12-23 20:24:38,990 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the entire content of the `sympy/external/tests/test_autowrap.py` file as you requested. This will allow you to examine the integration tests for `autowrap`, including those that are relevant to array arguments and runtime behavior.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/external/tests/test_autowrap.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7284, 'candidates_token_count': 82, 'total_token_count': 7624, 'cached_content_token_count': 1803, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7284}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1803}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 82}], 'thoughts_token_count': 258}, 'finish_reason': 'STOP', 'avg_logprobs': -0.12826012402046016, 'model_name': 'gemini-2.5-pro'} id='run--bac5a95f-c8cb-41d9-98e4-6c319f545f2d-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/external/tests/test_autowrap.py'}, 'id': '5a1b3a7f-ff2d-423b-9220-9d2406b6fa88', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7284, 'output_tokens': 82, 'total_tokens': 7624, 'input_token_details': {'cache_read': 1803}, 'output_token_details': {'reasoning': 258}}
2025-12-23 20:24:43,374 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `sympy/external/tests/test_autowrap.py` as requested. This file contains integration tests for `autowrap` with various backends. You can now examine the file to find test cases relevant to your issue.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12445, 'candidates_token_count': 56, 'total_token_count': 12827, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12445}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 56}], 'thoughts_token_count': 326, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.45542802129473003, 'model_name': 'gemini-2.5-pro'} id='run--5a5ac40a-4669-4744-a32a-503a95533d92-0' usage_metadata={'input_tokens': 12445, 'output_tokens': 56, 'total_tokens': 12827, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 326}}
2025-12-23 20:24:43,376 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of the file sympy/external/tests/test_autowrap.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file is expected to contain integration tests for `autowrap` with installed backends like Cython, which are necessary to find test cases relevant to the user's bug involving array arguments and runtime behavior.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/external/tests/test_autowrap.py
Line number range: 1 - 309
Content:
1. import sympy
2. import tempfile
3. import os
4. from sympy import symbols, Eq, Mod
5. from sympy.external import import_module
6. from sympy.tensor import IndexedBase, Idx
7. from sympy.utilities.autowrap import autowrap, ufuncify, CodeWrapError
8. from sympy.utilities.pytest import skip
9. 
10. numpy = import_module('numpy', min_module_version='1.6.1')
11. Cython = import_module('Cython', min_module_version='0.15.1')
12. f2py = import_module('numpy.f2py', __import__kwargs={'fromlist': ['f2py']})
13. 
14. f2pyworks = False
15. if f2py:
16.     try:
17.         autowrap(symbols('x'), 'f95', 'f2py')
18.     except (CodeWrapError, ImportError, OSError):
19.         f2pyworks = False
20.     else:
21.         f2pyworks = True
22. 
23. a, b, c = symbols('a b c')
24. n, m, d = symbols('n m d', integer=True)
25. A, B, C = symbols('A B C', cls=IndexedBase)
26. i = Idx('i', m)
27. j = Idx('j', n)
28. k = Idx('k', d)
29. 
30. 
31. def has_module(module):
32.     """
33.     Return True if module exists, otherwise run skip().
34. 
35.     module should be a string.
36.     """
37.     # To give a string of the module name to skip(), this function takes a
38.     # string.  So we don't waste time running import_module() more than once,
39.     # just map the three modules tested here in this dict.
40.     modnames = {'numpy': numpy, 'Cython': Cython, 'f2py': f2py}
41. 
42.     if modnames[module]:
43.         if module == 'f2py' and not f2pyworks:
44.             skip("Couldn't run f2py.")
45.         return True
46.     skip("Couldn't import %s." % module)
47. 
48. #
49. # test runners used by several language-backend combinations
50. #
51. 
52. def runtest_autowrap_twice(language, backend):
53.     f = autowrap((((a + b)/c)**5).expand(), language, backend)
54.     g = autowrap((((a + b)/c)**4).expand(), language, backend)
55. 
56.     # check that autowrap updates the module name.  Else, g gives the same as f
57.     assert f(1, -2, 1) == -1.0
58.     assert g(1, -2, 1) == 1.0
59. 
60. 
61. def runtest_autowrap_trace(language, backend):
62.     has_module('numpy')
63.     trace = autowrap(A[i, i], language, backend)
64.     assert trace(numpy.eye(100)) == 100
65. 
66. 
67. def runtest_autowrap_matrix_vector(language, backend):
68.     has_module('numpy')
69.     x, y = symbols('x y', cls=IndexedBase)
70.     expr = Eq(y[i], A[i, j]*x[j])
71.     mv = autowrap(expr, language, backend)
72. 
73.     # compare with numpy's dot product
74.     M = numpy.random.rand(10, 20)
75.     x = numpy.random.rand(20)
76.     y = numpy.dot(M, x)
77.     assert numpy.sum(numpy.abs(y - mv(M, x))) < 1e-13
78. 
79. 
80. def runtest_autowrap_matrix_matrix(language, backend):
81.     has_module('numpy')
82.     expr = Eq(C[i, j], A[i, k]*B[k, j])
83.     matmat = autowrap(expr, language, backend)
84. 
85.     # compare with numpy's dot product
86.     M1 = numpy.random.rand(10, 20)
87.     M2 = numpy.random.rand(20, 15)
88.     M3 = numpy.dot(M1, M2)
89.     assert numpy.sum(numpy.abs(M3 - matmat(M1, M2))) < 1e-13
90. 
91. 
92. def runtest_ufuncify(language, backend):
93.     has_module('numpy')
94.     a, b, c = symbols('a b c')
95.     fabc = ufuncify([a, b, c], a*b + c, backend=backend)
96.     facb = ufuncify([a, c, b], a*b + c, backend=backend)
97.     grid = numpy.linspace(-2, 2, 50)
98.     b = numpy.linspace(-5, 4, 50)
99.     c = numpy.linspace(-1, 1, 50)
100.     expected = grid*b + c
101.     numpy.testing.assert_allclose(fabc(grid, b, c), expected)
102.     numpy.testing.assert_allclose(facb(grid, c, b), expected)
103. 
104. 
105. def runtest_issue_10274(language, backend):
106.     expr = (a - b + c)**(13)
107.     tmp = tempfile.mkdtemp()
108.     f = autowrap(expr, language, backend, tempdir=tmp,
109.                  helpers=('helper', a - b + c, (a, b, c)))
110.     assert f(1, 1, 1) == 1
111. 
112.     for file in os.listdir(tmp):
113.         if file.startswith("wrapped_code_") and file.endswith(".c"):
114.             fil = open(tmp + '/' + file)
115.             lines = fil.readlines()
116.             assert lines[0] == "/******************************************************************************\n"
117.             assert "Code generated with sympy " + sympy.__version__ in lines[1]
118.             assert lines[2:] == [
119.                 " *                                                                            *\n",
120.                 " *              See http://www.sympy.org/ for more information.               *\n",
121.                 " *                                                                            *\n",
122.                 " *                      This file is part of 'autowrap'                       *\n",
123.                 " ******************************************************************************/\n",
124.                 "#include " + '"' + file[:-1]+ 'h"' + "\n",
125.                 "#include <math.h>\n",
126.                 "\n",
127.                 "double helper(double a, double b, double c) {\n",
128.                 "\n",
129.                 "   double helper_result;\n",
130.                 "   helper_result = a - b + c;\n",
131.                 "   return helper_result;\n",
132.                 "\n",
133.                 "}\n",
134.                 "\n",
135.                 "double autofunc(double a, double b, double c) {\n",
136.                 "\n",
137.                 "   double autofunc_result;\n",
138.                 "   autofunc_result = pow(helper(a, b, c), 13);\n",
139.                 "   return autofunc_result;\n",
140.                 "\n",
141.                 "}\n",
142.                 ]
143. 
144. 
145. def runtest_issue_15337(language, backend):
146.     has_module('numpy')
147.     # NOTE : autowrap was originally designed to only accept an iterable for
148.     # the kwarg "helpers", but in issue 10274 the user mistakenly thought that
149.     # if there was only a single helper it did not need to be passed via an
150.     # iterable that wrapped the helper tuple. There were no tests for this
151.     # behavior so when the code was changed to accept a single tuple it broke
152.     # the original behavior. These tests below ensure that both now work.
153.     a, b, c, d, e = symbols('a, b, c, d, e')
154.     expr = (a - b + c - d + e)**13
155.     exp_res = (1. - 2. + 3. - 4. + 5.)**13
156. 
157.     f = autowrap(expr, language, backend, args=(a, b, c, d, e),
158.                  helpers=('f1', a - b + c, (a, b, c)))
159.     numpy.testing.assert_allclose(f(1, 2, 3, 4, 5), exp_res)
160. 
161.     f = autowrap(expr, language, backend, args=(a, b, c, d, e),
162.                  helpers=(('f1', a - b, (a, b)), ('f2', c - d, (c, d))))
163.     numpy.testing.assert_allclose(f(1, 2, 3, 4, 5), exp_res)
164. 
165. 
166. def test_issue_15230():
167.     has_module('f2py')
168. 
169.     x, y = symbols('x, y')
170.     expr = Mod(x, 3.0) - Mod(y, -2.0)
171.     f = autowrap(expr, args=[x, y], language='F95')
172.     exp_res = float(expr.xreplace({x: 3.5, y: 2.7}).evalf())
173.     assert abs(f(3.5, 2.7) - exp_res) < 1e-14
174. 
175.     x, y = symbols('x, y', integer=True)
176.     expr = Mod(x, 3) - Mod(y, -2)
177.     f = autowrap(expr, args=[x, y], language='F95')
178.     assert f(3, 2) == expr.xreplace({x: 3, y: 2})
179. 
180. #
181. # tests of language-backend combinations
182. #
183. 
184. # f2py
185. 
186. 
187. def test_wrap_twice_f95_f2py():
188.     has_module('f2py')
189.     runtest_autowrap_twice('f95', 'f2py')
190. 
191. 
192. def test_autowrap_trace_f95_f2py():
193.     has_module('f2py')
194.     runtest_autowrap_trace('f95', 'f2py')
195. 
196. 
197. def test_autowrap_matrix_vector_f95_f2py():
198.     has_module('f2py')
199.     runtest_autowrap_matrix_vector('f95', 'f2py')
200. 
201. 
202. def test_autowrap_matrix_matrix_f95_f2py():
203.     has_module('f2py')
204.     runtest_autowrap_matrix_matrix('f95', 'f2py')
205. 
206. 
207. def test_ufuncify_f95_f2py():
208.     has_module('f2py')
209.     runtest_ufuncify('f95', 'f2py')
210. 
211. 
212. def test_issue_15337_f95_f2py():
213.     has_module('f2py')
214.     runtest_issue_15337('f95', 'f2py')
215. 
216. # Cython
217. 
218. 
219. def test_wrap_twice_c_cython():
220.     has_module('Cython')
221.     runtest_autowrap_twice('C', 'cython')
222. 
223. 
224. def test_autowrap_trace_C_Cython():
225.     has_module('Cython')
226.     runtest_autowrap_trace('C99', 'cython')
227. 
228. 
229. def test_autowrap_matrix_vector_C_cython():
230.     has_module('Cython')
231.     runtest_autowrap_matrix_vector('C99', 'cython')
232. 
233. 
234. def test_autowrap_matrix_matrix_C_cython():
235.     has_module('Cython')
236.     runtest_autowrap_matrix_matrix('C99', 'cython')
237. 
238. 
239. def test_ufuncify_C_Cython():
240.     has_module('Cython')
241.     runtest_ufuncify('C99', 'cython')
242. 
243. 
244. def test_issue_10274_C_cython():
245.     has_module('Cython')
246.     runtest_issue_10274('C89', 'cython')
247. 
248. 
249. def test_issue_15337_C_cython():
250.     has_module('Cython')
251.     runtest_issue_15337('C89', 'cython')
252. 
253. 
254. def test_autowrap_custom_printer():
255.     has_module('Cython')
256. 
257.     from sympy import pi
258.     from sympy.utilities.codegen import C99CodeGen
259.     from sympy.printing.ccode import C99CodePrinter
260.     from sympy.functions.elementary.exponential import exp
261. 
262.     class PiPrinter(C99CodePrinter):
263.         def _print_Pi(self, expr):
264.             return "S_PI"
265. 
266.     printer = PiPrinter()
267.     gen = C99CodeGen(printer=printer)
268.     gen.preprocessor_statements.append('#include "shortpi.h"')
269. 
270.     expr = pi * a
271. 
272.     expected = (
273.         '#include "%s"\n'
274.         '#include <math.h>\n'
275.         '#include "shortpi.h"\n'
276.         '\n'
277.         'double autofunc(double a) {\n'
278.         '\n'
279.         '   double autofunc_result;\n'
280.         '   autofunc_result = S_PI*a;\n'
281.         '   return autofunc_result;\n'
282.         '\n'
283.         '}\n'
284.     )
285. 
286.     tmpdir = tempfile.mkdtemp()
287.     # write a trivial header file to use in the generated code
288.     open(os.path.join(tmpdir, 'shortpi.h'), 'w').write('#define S_PI 3.14')
289. 
290.     func = autowrap(expr, backend='cython', tempdir=tmpdir, code_gen=gen)
291. 
292.     assert func(4.2) == 3.14 * 4.2
293. 
294.     # check that the generated code is correct
295.     for filename in os.listdir(tmpdir):
296.         if filename.startswith('wrapped_code') and filename.endswith('.c'):
297.             with open(os.path.join(tmpdir, filename)) as f:
298.                 lines = f.readlines()
299.                 expected = expected % filename.replace('.c', '.h')
300.                 assert ''.join(lines[7:]) == expected
301. 
302. 
303. # Numpy
304. 
305. def test_ufuncify_numpy():
306.     # This test doesn't use Cython, but if Cython works, then there is a valid
307.     # C compiler, which is needed.
308.     has_module('Cython')
309.     runtest_ufuncify('C99', 'numpy')

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-23 20:24:47,884 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user requested the full content of the file `sympy/external/tests/test_autowrap.py`. This context includes the entire file from line 1 to 309, which fulfills the user's request.", relative_path='sympy/external/tests/test_autowrap.py', start_line=1, end_line=309)]
2025-12-23 20:24:47,885 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of the file sympy/external/tests/test_autowrap.py.
2025-12-23 20:24:47,885 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-23 20:24:47,885 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-23 20:24:47,886 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 1 existing contexts
2025-12-23 20:24:47,886 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-23 20:24:47,887 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi.py
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   └── dpll2.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_rv.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: autowrap with cython backend fails when array arguments do not appear in wrapped expr

Description: When using the cython backend for autowrap, it appears that the code is not correctly generated when the function in question has array arguments that do not appear in the final expression. A minimal counterexample is:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
expr = 1.0
f = autowrap(expr, args=(x,), backend='cython')

f(np.array([[1.0, 2.0]]))
```

This should of course return `1.0` but instead fails with:
```python
TypeError: only size-1 arrays can be converted to Python scalars
```

A little inspection reveals that this is because the corresponding C function is generated with an incorrect signature:

```C
double autofunc(double x) {

   double autofunc_result;
   autofunc_result = 1.0;
   return autofunc_result;

}
```

(`x` should be `double *`, not `double` in this case)

I've found that this error won't occur so long as `expr` depends at least in part on each argument. For example this slight modification of the above counterexample works perfectly:

```python
from sympy.utilities.autowrap import autowrap
from sympy import MatrixSymbol
import numpy as np

x = MatrixSymbol('x', 2, 1)
# now output depends on x
expr = x[0,0]
f = autowrap(expr, args=(x,), backend='cython')

# returns 1.0 as expected, without failure
f(np.array([[1.0, 2.0]]))
```

This may seem like a silly issue ("why even have `x` as an argument if it doesn't appear in the expression you're trying to evaluate?"). But of course in interfacing with external libraries (e.g. for numerical integration), one often needs functions to have a pre-defined signature regardless of whether a given argument contributes to the output.

I think I've identified the problem in `codegen` and will suggest a PR shortly.

Patch information:
diff --git a/sympy/utilities/codegen.py b/sympy/utilities/codegen.py
index f0befb2bd7..8cc1fb8668 100644
--- a/sympy/utilities/codegen.py
+++ b/sympy/utilities/codegen.py
@@ -700,6 +700,14 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
             array_symbols[array.base.label] = array
         for array in expressions.atoms(MatrixSymbol) | local_expressions.atoms(MatrixSymbol):
             array_symbols[array] = array
+        # Also include arrays from the user-specified argument sequence, if any
+        if argument_sequence is not None:
+            for arg in argument_sequence:
+                # Accept IndexedBase and MatrixSymbol in the argument list
+                if isinstance(arg, IndexedBase):
+                    array_symbols[arg.label] = arg
+                elif isinstance(arg, MatrixSymbol):
+                    array_symbols[arg] = arg
 
         for symbol in sorted(symbols, key=str):
             if symbol in array_symbols:
@@ -739,7 +747,16 @@ def routine(self, name, expr, argument_sequence=None, global_vars=None):
                 try:
                     new_args.append(name_arg_dict[symbol])
                 except KeyError:
-                    new_args.append(InputArgument(symbol))
+                    # If the symbol corresponds to an array-like argument, infer dimensions
+                    if symbol in array_symbols:
+                        dims = []
+                        array = array_symbols[symbol]
+                        for dim in array.shape:
+                            dims.append((S.Zero, dim - 1))
+                        metadata = {'dimensions': dims}
+                    else:
+                        metadata = {}
+                    new_args.append(InputArgument(symbol, **metadata))
             arg_list = new_args
 
         return Routine(name, arg_list, return_val, local_vars, global_vars)


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of the file sympy/utilities/tests/test_autowrap.py.
Extra Requirements: 
Purpose: I need to inspect the tests for `autowrap` to find existing test cases that are relevant to the described bug, which will help in understanding how this functionality is currently tested.

Previous refined query 2:
Essential Query: Please provide the full content of the file sympy/external/tests/test_autowrap.py.
Extra Requirements: 
Purpose: This file is expected to contain integration tests for `autowrap` with installed backends like Cython, which are necessary to find test cases relevant to the user's bug involving array arguments and runtime behavior.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/external/tests/test_autowrap.py
Line number range: 1 - 309
Content:
1. import sympy
2. import tempfile
3. import os
4. from sympy import symbols, Eq, Mod
5. from sympy.external import import_module
6. from sympy.tensor import IndexedBase, Idx
7. from sympy.utilities.autowrap import autowrap, ufuncify, CodeWrapError
8. from sympy.utilities.pytest import skip
9. 
10. numpy = import_module('numpy', min_module_version='1.6.1')
11. Cython = import_module('Cython', min_module_version='0.15.1')
12. f2py = import_module('numpy.f2py', __import__kwargs={'fromlist': ['f2py']})
13. 
14. f2pyworks = False
15. if f2py:
16.     try:
17.         autowrap(symbols('x'), 'f95', 'f2py')
18.     except (CodeWrapError, ImportError, OSError):
19.         f2pyworks = False
20.     else:
21.         f2pyworks = True
22. 
23. a, b, c = symbols('a b c')
24. n, m, d = symbols('n m d', integer=True)
25. A, B, C = symbols('A B C', cls=IndexedBase)
26. i = Idx('i', m)
27. j = Idx('j', n)
28. k = Idx('k', d)
29. 
30. 
31. def has_module(module):
32.     """
33.     Return True if module exists, otherwise run skip().
34. 
35.     module should be a string.
36.     """
37.     # To give a string of the module name to skip(), this function takes a
38.     # string.  So we don't waste time running import_module() more than once,
39.     # just map the three modules tested here in this dict.
40.     modnames = {'numpy': numpy, 'Cython': Cython, 'f2py': f2py}
41. 
42.     if modnames[module]:
43.         if module == 'f2py' and not f2pyworks:
44.             skip("Couldn't run f2py.")
45.         return True
46.     skip("Couldn't import %s." % module)
47. 
48. #
49. # test runners used by several language-backend combinations
50. #
51. 
52. def runtest_autowrap_twice(language, backend):
53.     f = autowrap((((a + b)/c)**5).expand(), language, backend)
54.     g = autowrap((((a + b)/c)**4).expand(), language, backend)
55. 
56.     # check that autowrap updates the module name.  Else, g gives the same as f
57.     assert f(1, -2, 1) == -1.0
58.     assert g(1, -2, 1) == 1.0
59. 
60. 
61. def runtest_autowrap_trace(language, backend):
62.     has_module('numpy')
63.     trace = autowrap(A[i, i], language, backend)
64.     assert trace(numpy.eye(100)) == 100
65. 
66. 
67. def runtest_autowrap_matrix_vector(language, backend):
68.     has_module('numpy')
69.     x, y = symbols('x y', cls=IndexedBase)
70.     expr = Eq(y[i], A[i, j]*x[j])
71.     mv = autowrap(expr, language, backend)
72. 
73.     # compare with numpy's dot product
74.     M = numpy.random.rand(10, 20)
75.     x = numpy.random.rand(20)
76.     y = numpy.dot(M, x)
77.     assert numpy.sum(numpy.abs(y - mv(M, x))) < 1e-13
78. 
79. 
80. def runtest_autowrap_matrix_matrix(language, backend):
81.     has_module('numpy')
82.     expr = Eq(C[i, j], A[i, k]*B[k, j])
83.     matmat = autowrap(expr, language, backend)
84. 
85.     # compare with numpy's dot product
86.     M1 = numpy.random.rand(10, 20)
87.     M2 = numpy.random.rand(20, 15)
88.     M3 = numpy.dot(M1, M2)
89.     assert numpy.sum(numpy.abs(M3 - matmat(M1, M2))) < 1e-13
90. 
91. 
92. def runtest_ufuncify(language, backend):
93.     has_module('numpy')
94.     a, b, c = symbols('a b c')
95.     fabc = ufuncify([a, b, c], a*b + c, backend=backend)
96.     facb = ufuncify([a, c, b], a*b + c, backend=backend)
97.     grid = numpy.linspace(-2, 2, 50)
98.     b = numpy.linspace(-5, 4, 50)
99.     c = numpy.linspace(-1, 1, 50)
100.     expected = grid*b + c
101.     numpy.testing.assert_allclose(fabc(grid, b, c), expected)
102.     numpy.testing.assert_allclose(facb(grid, c, b), expected)
103. 
104. 
105. def runtest_issue_10274(language, backend):
106.     expr = (a - b + c)**(13)
107.     tmp = tempfile.mkdtemp()
108.     f = autowrap(expr, language, backend, tempdir=tmp,
109.                  helpers=('helper', a - b + c, (a, b, c)))
110.     assert f(1, 1, 1) == 1
111. 
112.     for file in os.listdir(tmp):
113.         if file.startswith("wrapped_code_") and file.endswith(".c"):
114.             fil = open(tmp + '/' + file)
115.             lines = fil.readlines()
116.             assert lines[0] == "/******************************************************************************\n"
117.             assert "Code generated with sympy " + sympy.__version__ in lines[1]
118.             assert lines[2:] == [
119.                 " *                                                                            *\n",
120.                 " *              See http://www.sympy.org/ for more information.               *\n",
121.                 " *                                                                            *\n",
122.                 " *                      This file is part of 'autowrap'                       *\n",
123.                 " ******************************************************************************/\n",
124.                 "#include " + '"' + file[:-1]+ 'h"' + "\n",
125.                 "#include <math.h>\n",
126.                 "\n",
127.                 "double helper(double a, double b, double c) {\n",
128.                 "\n",
129.                 "   double helper_result;\n",
130.                 "   helper_result = a - b + c;\n",
131.                 "   return helper_result;\n",
132.                 "\n",
133.                 "}\n",
134.                 "\n",
135.                 "double autofunc(double a, double b, double c) {\n",
136.                 "\n",
137.                 "   double autofunc_result;\n",
138.                 "   autofunc_result = pow(helper(a, b, c), 13);\n",
139.                 "   return autofunc_result;\n",
140.                 "\n",
141.                 "}\n",
142.                 ]
143. 
144. 
145. def runtest_issue_15337(language, backend):
146.     has_module('numpy')
147.     # NOTE : autowrap was originally designed to only accept an iterable for
148.     # the kwarg "helpers", but in issue 10274 the user mistakenly thought that
149.     # if there was only a single helper it did not need to be passed via an
150.     # iterable that wrapped the helper tuple. There were no tests for this
151.     # behavior so when the code was changed to accept a single tuple it broke
152.     # the original behavior. These tests below ensure that both now work.
153.     a, b, c, d, e = symbols('a, b, c, d, e')
154.     expr = (a - b + c - d + e)**13
155.     exp_res = (1. - 2. + 3. - 4. + 5.)**13
156. 
157.     f = autowrap(expr, language, backend, args=(a, b, c, d, e),
158.                  helpers=('f1', a - b + c, (a, b, c)))
159.     numpy.testing.assert_allclose(f(1, 2, 3, 4, 5), exp_res)
160. 
161.     f = autowrap(expr, language, backend, args=(a, b, c, d, e),
162.                  helpers=(('f1', a - b, (a, b)), ('f2', c - d, (c, d))))
163.     numpy.testing.assert_allclose(f(1, 2, 3, 4, 5), exp_res)
164. 
165. 
166. def test_issue_15230():
167.     has_module('f2py')
168. 
169.     x, y = symbols('x, y')
170.     expr = Mod(x, 3.0) - Mod(y, -2.0)
171.     f = autowrap(expr, args=[x, y], language='F95')
172.     exp_res = float(expr.xreplace({x: 3.5, y: 2.7}).evalf())
173.     assert abs(f(3.5, 2.7) - exp_res) < 1e-14
174. 
175.     x, y = symbols('x, y', integer=True)
176.     expr = Mod(x, 3) - Mod(y, -2)
177.     f = autowrap(expr, args=[x, y], language='F95')
178.     assert f(3, 2) == expr.xreplace({x: 3, y: 2})
179. 
180. #
181. # tests of language-backend combinations
182. #
183. 
184. # f2py
185. 
186. 
187. def test_wrap_twice_f95_f2py():
188.     has_module('f2py')
189.     runtest_autowrap_twice('f95', 'f2py')
190. 
191. 
192. def test_autowrap_trace_f95_f2py():
193.     has_module('f2py')
194.     runtest_autowrap_trace('f95', 'f2py')
195. 
196. 
197. def test_autowrap_matrix_vector_f95_f2py():
198.     has_module('f2py')
199.     runtest_autowrap_matrix_vector('f95', 'f2py')
200. 
201. 
202. def test_autowrap_matrix_matrix_f95_f2py():
203.     has_module('f2py')
204.     runtest_autowrap_matrix_matrix('f95', 'f2py')
205. 
206. 
207. def test_ufuncify_f95_f2py():
208.     has_module('f2py')
209.     runtest_ufuncify('f95', 'f2py')
210. 
211. 
212. def test_issue_15337_f95_f2py():
213.     has_module('f2py')
214.     runtest_issue_15337('f95', 'f2py')
215. 
216. # Cython
217. 
218. 
219. def test_wrap_twice_c_cython():
220.     has_module('Cython')
221.     runtest_autowrap_twice('C', 'cython')
222. 
223. 
224. def test_autowrap_trace_C_Cython():
225.     has_module('Cython')
226.     runtest_autowrap_trace('C99', 'cython')
227. 
228. 
229. def test_autowrap_matrix_vector_C_cython():
230.     has_module('Cython')
231.     runtest_autowrap_matrix_vector('C99', 'cython')
232. 
233. 
234. def test_autowrap_matrix_matrix_C_cython():
235.     has_module('Cython')
236.     runtest_autowrap_matrix_matrix('C99', 'cython')
237. 
238. 
239. def test_ufuncify_C_Cython():
240.     has_module('Cython')
241.     runtest_ufuncify('C99', 'cython')
242. 
243. 
244. def test_issue_10274_C_cython():
245.     has_module('Cython')
246.     runtest_issue_10274('C89', 'cython')
247. 
248. 
249. def test_issue_15337_C_cython():
250.     has_module('Cython')
251.     runtest_issue_15337('C89', 'cython')
252. 
253. 
254. def test_autowrap_custom_printer():
255.     has_module('Cython')
256. 
257.     from sympy import pi
258.     from sympy.utilities.codegen import C99CodeGen
259.     from sympy.printing.ccode import C99CodePrinter
260.     from sympy.functions.elementary.exponential import exp
261. 
262.     class PiPrinter(C99CodePrinter):
263.         def _print_Pi(self, expr):
264.             return "S_PI"
265. 
266.     printer = PiPrinter()
267.     gen = C99CodeGen(printer=printer)
268.     gen.preprocessor_statements.append('#include "shortpi.h"')
269. 
270.     expr = pi * a
271. 
272.     expected = (
273.         '#include "%s"\n'
274.         '#include <math.h>\n'
275.         '#include "shortpi.h"\n'
276.         '\n'
277.         'double autofunc(double a) {\n'
278.         '\n'
279.         '   double autofunc_result;\n'
280.         '   autofunc_result = S_PI*a;\n'
281.         '   return autofunc_result;\n'
282.         '\n'
283.         '}\n'
284.     )
285. 
286.     tmpdir = tempfile.mkdtemp()
287.     # write a trivial header file to use in the generated code
288.     open(os.path.join(tmpdir, 'shortpi.h'), 'w').write('#define S_PI 3.14')
289. 
290.     func = autowrap(expr, backend='cython', tempdir=tmpdir, code_gen=gen)
291. 
292.     assert func(4.2) == 3.14 * 4.2
293. 
294.     # check that the generated code is correct
295.     for filename in os.listdir(tmpdir):
296.         if filename.startswith('wrapped_code') and filename.endswith('.c'):
297.             with open(os.path.join(tmpdir, filename)) as f:
298.                 lines = f.readlines()
299.                 expected = expected % filename.replace('.c', '.h')
300.                 assert ''.join(lines[7:]) == expected
301. 
302. 
303. # Numpy
304. 
305. def test_ufuncify_numpy():
306.     # This test doesn't use Cython, but if Cython works, then there is a valid
307.     # C compiler, which is needed.
308.     has_module('Cython')
309.     runtest_ufuncify('C99', 'numpy')


File: sympy/utilities/tests/test_autowrap.py
Line number range: 1 - 469
Content:
1. # Tests that require installed backends go into
2. # sympy/test_external/test_autowrap
3. 
4. import os
5. import tempfile
6. import shutil
7. 
8. from sympy.core import symbols, Eq
9. from sympy.core.compatibility import StringIO
10. from sympy.utilities.autowrap import (autowrap, binary_function,
11.             CythonCodeWrapper, UfuncifyCodeWrapper, CodeWrapper)
12. from sympy.utilities.codegen import (
13.     CCodeGen, C99CodeGen, CodeGenArgumentListError, make_routine
14. )
15. from sympy.utilities.pytest import raises
16. from sympy.utilities.tmpfiles import TmpFileManager
17. 
18. 
19. def get_string(dump_fn, routines, prefix="file", **kwargs):
20.     """Wrapper for dump_fn. dump_fn writes its results to a stream object and
21.        this wrapper returns the contents of that stream as a string. This
22.        auxiliary function is used by many tests below.
23. 
24.        The header and the empty lines are not generator to facilitate the
25.        testing of the output.
26.     """
27.     output = StringIO()
28.     dump_fn(routines, output, prefix, **kwargs)
29.     source = output.getvalue()
30.     output.close()
31.     return source
32. 
33. 
34. def test_cython_wrapper_scalar_function():
35.     x, y, z = symbols('x,y,z')
36.     expr = (x + y)*z
37.     routine = make_routine("test", expr)
38.     code_gen = CythonCodeWrapper(CCodeGen())
39.     source = get_string(code_gen.dump_pyx, [routine])
40. 
41.     expected = (
42.         "cdef extern from 'file.h':\n"
43.         "    double test(double x, double y, double z)\n"
44.         "\n"
45.         "def test_c(double x, double y, double z):\n"
46.         "\n"
47.         "    return test(x, y, z)")
48.     assert source == expected
49. 
50. 
51. def test_cython_wrapper_outarg():
52.     from sympy import Equality
53.     x, y, z = symbols('x,y,z')
54.     code_gen = CythonCodeWrapper(C99CodeGen())
55. 
56.     routine = make_routine("test", Equality(z, x + y))
57.     source = get_string(code_gen.dump_pyx, [routine])
58.     expected = (
59.         "cdef extern from 'file.h':\n"
60.         "    void test(double x, double y, double *z)\n"
61.         "\n"
62.         "def test_c(double x, double y):\n"
63.         "\n"
64.         "    cdef double z = 0\n"
65.         "    test(x, y, &z)\n"
66.         "    return z")
67.     assert source == expected
68. 
69. 
70. def test_cython_wrapper_inoutarg():
71.     from sympy import Equality
72.     x, y, z = symbols('x,y,z')
73.     code_gen = CythonCodeWrapper(C99CodeGen())
74.     routine = make_routine("test", Equality(z, x + y + z))
75.     source = get_string(code_gen.dump_pyx, [routine])
76.     expected = (
77.         "cdef extern from 'file.h':\n"
78.         "    void test(double x, double y, double *z)\n"
79.         "\n"
80.         "def test_c(double x, double y, double z):\n"
81.         "\n"
82.         "    test(x, y, &z)\n"
83.         "    return z")
84.     assert source == expected
85. 
86. 
87. def test_cython_wrapper_compile_flags():
88.     from sympy import Equality
89.     x, y, z = symbols('x,y,z')
90.     routine = make_routine("test", Equality(z, x + y))
91. 
92.     code_gen = CythonCodeWrapper(CCodeGen())
93. 
94.     expected = """\
95. try:
96.     from setuptools import setup
97.     from setuptools import Extension
98. except ImportError:
99.     from distutils.core import setup
100.     from distutils.extension import Extension
101. from Cython.Build import cythonize
102. cy_opts = {}
103. 
104. ext_mods = [Extension(
105.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
106.     include_dirs=[],
107.     library_dirs=[],
108.     libraries=[],
109.     extra_compile_args=['-std=c99'],
110.     extra_link_args=[]
111. )]
112. setup(ext_modules=cythonize(ext_mods, **cy_opts))
113. """ % {'num': CodeWrapper._module_counter}
114. 
115.     temp_dir = tempfile.mkdtemp()
116.     TmpFileManager.tmp_folder(temp_dir)
117.     setup_file_path = os.path.join(temp_dir, 'setup.py')
118. 
119.     code_gen._prepare_files(routine, build_dir=temp_dir)
120.     with open(setup_file_path) as f:
121.         setup_text = f.read()
122.     assert setup_text == expected
123. 
124.     code_gen = CythonCodeWrapper(CCodeGen(),
125.                                  include_dirs=['/usr/local/include', '/opt/booger/include'],
126.                                  library_dirs=['/user/local/lib'],
127.                                  libraries=['thelib', 'nilib'],
128.                                  extra_compile_args=['-slow-math'],
129.                                  extra_link_args=['-lswamp', '-ltrident'],
130.                                  cythonize_options={'compiler_directives': {'boundscheck': False}}
131.                                  )
132.     expected = """\
133. try:
134.     from setuptools import setup
135.     from setuptools import Extension
136. except ImportError:
137.     from distutils.core import setup
138.     from distutils.extension import Extension
139. from Cython.Build import cythonize
140. cy_opts = {'compiler_directives': {'boundscheck': False}}
141. 
142. ext_mods = [Extension(
143.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
144.     include_dirs=['/usr/local/include', '/opt/booger/include'],
145.     library_dirs=['/user/local/lib'],
146.     libraries=['thelib', 'nilib'],
147.     extra_compile_args=['-slow-math', '-std=c99'],
148.     extra_link_args=['-lswamp', '-ltrident']
149. )]
150. setup(ext_modules=cythonize(ext_mods, **cy_opts))
151. """ % {'num': CodeWrapper._module_counter}
152. 
153.     code_gen._prepare_files(routine, build_dir=temp_dir)
154.     with open(setup_file_path) as f:
155.         setup_text = f.read()
156.     assert setup_text == expected
157. 
158.     expected = """\
159. try:
160.     from setuptools import setup
161.     from setuptools import Extension
162. except ImportError:
163.     from distutils.core import setup
164.     from distutils.extension import Extension
165. from Cython.Build import cythonize
166. cy_opts = {'compiler_directives': {'boundscheck': False}}
167. import numpy as np
168. 
169. ext_mods = [Extension(
170.     'wrapper_module_%(num)s', ['wrapper_module_%(num)s.pyx', 'wrapped_code_%(num)s.c'],
171.     include_dirs=['/usr/local/include', '/opt/booger/include', np.get_include()],
172.     library_dirs=['/user/local/lib'],
173.     libraries=['thelib', 'nilib'],
174.     extra_compile_args=['-slow-math', '-std=c99'],
175.     extra_link_args=['-lswamp', '-ltrident']
176. )]
177. setup(ext_modules=cythonize(ext_mods, **cy_opts))
178. """ % {'num': CodeWrapper._module_counter}
179. 
180.     code_gen._need_numpy = True
181.     code_gen._prepare_files(routine, build_dir=temp_dir)
182.     with open(setup_file_path) as f:
183.         setup_text = f.read()
184.     assert setup_text == expected
185. 
186.     TmpFileManager.cleanup()
187. 
188. def test_cython_wrapper_unique_dummyvars():
189.     from sympy import Dummy, Equality
190.     x, y, z = Dummy('x'), Dummy('y'), Dummy('z')
191.     x_id, y_id, z_id = [str(d.dummy_index) for d in [x, y, z]]
192.     expr = Equality(z, x + y)
193.     routine = make_routine("test", expr)
194.     code_gen = CythonCodeWrapper(CCodeGen())
195.     source = get_string(code_gen.dump_pyx, [routine])
196.     expected_template = (
197.         "cdef extern from 'file.h':\n"
198.         "    void test(double x_{x_id}, double y_{y_id}, double *z_{z_id})\n"
199.         "\n"
200.         "def test_c(double x_{x_id}, double y_{y_id}):\n"
201.         "\n"
202.         "    cdef double z_{z_id} = 0\n"
203.         "    test(x_{x_id}, y_{y_id}, &z_{z_id})\n"
204.         "    return z_{z_id}")
205.     expected = expected_template.format(x_id=x_id, y_id=y_id, z_id=z_id)
206.     assert source == expected
207. 
208. def test_autowrap_dummy():
209.     x, y, z = symbols('x y z')
210. 
211.     # Uses DummyWrapper to test that codegen works as expected
212. 
213.     f = autowrap(x + y, backend='dummy')
214.     assert f() == str(x + y)
215.     assert f.args == "x, y"
216.     assert f.returns == "nameless"
217.     f = autowrap(Eq(z, x + y), backend='dummy')
218.     assert f() == str(x + y)
219.     assert f.args == "x, y"
220.     assert f.returns == "z"
221.     f = autowrap(Eq(z, x + y + z), backend='dummy')
222.     assert f() == str(x + y + z)
223.     assert f.args == "x, y, z"
224.     assert f.returns == "z"
225. 
226. 
227. def test_autowrap_args():
228.     x, y, z = symbols('x y z')
229. 
230.     raises(CodeGenArgumentListError, lambda: autowrap(Eq(z, x + y),
231.            backend='dummy', args=[x]))
232.     f = autowrap(Eq(z, x + y), backend='dummy', args=[y, x])
233.     assert f() == str(x + y)
234.     assert f.args == "y, x"
235.     assert f.returns == "z"
236. 
237.     raises(CodeGenArgumentListError, lambda: autowrap(Eq(z, x + y + z),
238.            backend='dummy', args=[x, y]))
239.     f = autowrap(Eq(z, x + y + z), backend='dummy', args=[y, x, z])
240.     assert f() == str(x + y + z)
241.     assert f.args == "y, x, z"
242.     assert f.returns == "z"
243. 
244.     f = autowrap(Eq(z, x + y + z), backend='dummy', args=(y, x, z))
245.     assert f() == str(x + y + z)
246.     assert f.args == "y, x, z"
247.     assert f.returns == "z"
248. 
249. def test_autowrap_store_files():
250.     x, y = symbols('x y')
251.     tmp = tempfile.mkdtemp()
252.     TmpFileManager.tmp_folder(tmp)
253. 
254.     f = autowrap(x + y, backend='dummy', tempdir=tmp)
255.     assert f() == str(x + y)
256.     assert os.access(tmp, os.F_OK)
257. 
258.     TmpFileManager.cleanup()
259. 
260. def test_autowrap_store_files_issue_gh12939():
261.     x, y = symbols('x y')
262.     tmp = './tmp'
263.     try:
264.         f = autowrap(x + y, backend='dummy', tempdir=tmp)
265.         assert f() == str(x + y)
266.         assert os.access(tmp, os.F_OK)
267.     finally:
268.         shutil.rmtree(tmp)
269. 
270. 
271. 
272. def test_binary_function():
273.     x, y = symbols('x y')
274.     f = binary_function('f', x + y, backend='dummy')
275.     assert f._imp_() == str(x + y)
276. 
277. 
278. def test_ufuncify_source():
279.     x, y, z = symbols('x,y,z')
280.     code_wrapper = UfuncifyCodeWrapper(C99CodeGen("ufuncify"))
281.     routine = make_routine("test", x + y + z)
282.     source = get_string(code_wrapper.dump_c, [routine])
283.     expected = """\
284. #include "Python.h"
285. #include "math.h"
286. #include "numpy/ndarraytypes.h"
287. #include "numpy/ufuncobject.h"
288. #include "numpy/halffloat.h"
289. #include "file.h"
290. 
291. static PyMethodDef wrapper_module_%(num)sMethods[] = {
292.         {NULL, NULL, 0, NULL}
293. };
294. 
295. static void test_ufunc(char **args, npy_intp *dimensions, npy_intp* steps, void* data)
296. {
297.     npy_intp i;
298.     npy_intp n = dimensions[0];
299.     char *in0 = args[0];
300.     char *in1 = args[1];
301.     char *in2 = args[2];
302.     char *out0 = args[3];
303.     npy_intp in0_step = steps[0];
304.     npy_intp in1_step = steps[1];
305.     npy_intp in2_step = steps[2];
306.     npy_intp out0_step = steps[3];
307.     for (i = 0; i < n; i++) {
308.         *((double *)out0) = test(*(double *)in0, *(double *)in1, *(double *)in2);
309.         in0 += in0_step;
310.         in1 += in1_step;
311.         in2 += in2_step;
312.         out0 += out0_step;
313.     }
314. }
315. PyUFuncGenericFunction test_funcs[1] = {&test_ufunc};
316. static char test_types[4] = {NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE};
317. static void *test_data[1] = {NULL};
318. 
319. #if PY_VERSION_HEX >= 0x03000000
320. static struct PyModuleDef moduledef = {
321.     PyModuleDef_HEAD_INIT,
322.     "wrapper_module_%(num)s",
323.     NULL,
324.     -1,
325.     wrapper_module_%(num)sMethods,
326.     NULL,
327.     NULL,
328.     NULL,
329.     NULL
330. };
331. 
332. PyMODINIT_FUNC PyInit_wrapper_module_%(num)s(void)
333. {
334.     PyObject *m, *d;
335.     PyObject *ufunc0;
336.     m = PyModule_Create(&moduledef);
337.     if (!m) {
338.         return NULL;
339.     }
340.     import_array();
341.     import_umath();
342.     d = PyModule_GetDict(m);
343.     ufunc0 = PyUFunc_FromFuncAndData(test_funcs, test_data, test_types, 1, 3, 1,
344.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
345.     PyDict_SetItemString(d, "test", ufunc0);
346.     Py_DECREF(ufunc0);
347.     return m;
348. }
349. #else
350. PyMODINIT_FUNC initwrapper_module_%(num)s(void)
351. {
352.     PyObject *m, *d;
353.     PyObject *ufunc0;
354.     m = Py_InitModule("wrapper_module_%(num)s", wrapper_module_%(num)sMethods);
355.     if (m == NULL) {
356.         return;
357.     }
358.     import_array();
359.     import_umath();
360.     d = PyModule_GetDict(m);
361.     ufunc0 = PyUFunc_FromFuncAndData(test_funcs, test_data, test_types, 1, 3, 1,
362.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
363.     PyDict_SetItemString(d, "test", ufunc0);
364.     Py_DECREF(ufunc0);
365. }
366. #endif""" % {'num': CodeWrapper._module_counter}
367.     assert source == expected
368. 
369. 
370. def test_ufuncify_source_multioutput():
371.     x, y, z = symbols('x,y,z')
372.     var_symbols = (x, y, z)
373.     expr = x + y**3 + 10*z**2
374.     code_wrapper = UfuncifyCodeWrapper(C99CodeGen("ufuncify"))
375.     routines = [make_routine("func{}".format(i), expr.diff(var_symbols[i]), var_symbols) for i in range(len(var_symbols))]
376.     source = get_string(code_wrapper.dump_c, routines, funcname='multitest')
377.     expected = """\
378. #include "Python.h"
379. #include "math.h"
380. #include "numpy/ndarraytypes.h"
381. #include "numpy/ufuncobject.h"
382. #include "numpy/halffloat.h"
383. #include "file.h"
384. 
385. static PyMethodDef wrapper_module_%(num)sMethods[] = {
386.         {NULL, NULL, 0, NULL}
387. };
388. 
389. static void multitest_ufunc(char **args, npy_intp *dimensions, npy_intp* steps, void* data)
390. {
391.     npy_intp i;
392.     npy_intp n = dimensions[0];
393.     char *in0 = args[0];
394.     char *in1 = args[1];
395.     char *in2 = args[2];
396.     char *out0 = args[3];
397.     char *out1 = args[4];
398.     char *out2 = args[5];
399.     npy_intp in0_step = steps[0];
400.     npy_intp in1_step = steps[1];
401.     npy_intp in2_step = steps[2];
402.     npy_intp out0_step = steps[3];
403.     npy_intp out1_step = steps[4];
404.     npy_intp out2_step = steps[5];
405.     for (i = 0; i < n; i++) {
406.         *((double *)out0) = func0(*(double *)in0, *(double *)in1, *(double *)in2);
407.         *((double *)out1) = func1(*(double *)in0, *(double *)in1, *(double *)in2);
408.         *((double *)out2) = func2(*(double *)in0, *(double *)in1, *(double *)in2);
409.         in0 += in0_step;
410.         in1 += in1_step;
411.         in2 += in2_step;
412.         out0 += out0_step;
413.         out1 += out1_step;
414.         out2 += out2_step;
415.     }
416. }
417. PyUFuncGenericFunction multitest_funcs[1] = {&multitest_ufunc};
418. static char multitest_types[6] = {NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE, NPY_DOUBLE};
419. static void *multitest_data[1] = {NULL};
420. 
421. #if PY_VERSION_HEX >= 0x03000000
422. static struct PyModuleDef moduledef = {
423.     PyModuleDef_HEAD_INIT,
424.     "wrapper_module_%(num)s",
425.     NULL,
426.     -1,
427.     wrapper_module_%(num)sMethods,
428.     NULL,
429.     NULL,
430.     NULL,
431.     NULL
432. };
433. 
434. PyMODINIT_FUNC PyInit_wrapper_module_%(num)s(void)
435. {
436.     PyObject *m, *d;
437.     PyObject *ufunc0;
438.     m = PyModule_Create(&moduledef);
439.     if (!m) {
440.         return NULL;
441.     }
442.     import_array();
443.     import_umath();
444.     d = PyModule_GetDict(m);
445.     ufunc0 = PyUFunc_FromFuncAndData(multitest_funcs, multitest_data, multitest_types, 1, 3, 3,
446.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
447.     PyDict_SetItemString(d, "multitest", ufunc0);
448.     Py_DECREF(ufunc0);
449.     return m;
450. }
451. #else
452. PyMODINIT_FUNC initwrapper_module_%(num)s(void)
453. {
454.     PyObject *m, *d;
455.     PyObject *ufunc0;
456.     m = Py_InitModule("wrapper_module_%(num)s", wrapper_module_%(num)sMethods);
457.     if (m == NULL) {
458.         return;
459.     }
460.     import_array();
461.     import_umath();
462.     d = PyModule_GetDict(m);
463.     ufunc0 = PyUFunc_FromFuncAndData(multitest_funcs, multitest_data, multitest_types, 1, 3, 3,
464.             PyUFunc_None, "wrapper_module_%(num)s", "Created in SymPy with Ufuncify", 0);
465.     PyDict_SetItemString(d, "multitest", ufunc0);
466.     Py_DECREF(ufunc0);
467. }
468. #endif""" % {'num': CodeWrapper._module_counter}
469.     assert source == expected

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-23 20:25:37,651 - thread-136386940237504.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user's bug involves `autowrap` with the `cython` backend and an unused `MatrixSymbol` argument.\n2. I need to find existing tests that cover similar functionality, specifically `autowrap` with `cython` and array-like arguments.\n3. I have reviewed the provided test files `sympy/external/tests/test_autowrap.py` and `sympy/utilities/tests/test_autowrap.py`.\n4. `sympy/external/tests/test_autowrap.py` contains relevant integration tests for `autowrap` with different backends, including `cython` and `numpy` arrays, which is what I need.\n5. I have identified three relevant tests in `sympy/external/tests/test_autowrap.py`: `test_autowrap_trace_C_Cython`, `test_autowrap_matrix_vector_C_cython`, and `test_autowrap_matrix_matrix_C_cython`. These tests use `IndexedBase` for array arguments, which is analogous to `MatrixSymbol` for this purpose.\n6. The provided context is sufficient to construct the complete test cases as requested, including all imports and helper functions. Therefore, I do not need to request additional context." query='' extra_requirements='' purpose=''
2025-12-23 20:25:37,652 - thread-136386940237504.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
