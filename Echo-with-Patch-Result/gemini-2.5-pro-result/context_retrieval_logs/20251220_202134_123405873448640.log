2025-12-20 20:21:34,432 - thread-123405873448640.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

2025-12-20 20:21:34,500 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19214-DS.rst
|   |   |   |   ├── 19368-DS.rst
|   |   |   |   ├── 20426-JK.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   ├── 21026-DS.rst
|   |   |   |   ├── 21042-AL.rst
|   |   |   |   ├── 21238-AL.rst
|   |   |   |   ├── 21983-AL.rst
|   |   |   |   ├── 22013-AL.rst
|   |   |   |   ├── 22063-SR.rst
|   |   |   |   ├── 22204-AL.rst
|   |   |   |   ├── 22229-TAC.rst
|   |   |   |   ├── 22485-TH.rst
|   |   |   |   ├── 22567-IT.rst
|   |   |   |   ├── 22639-RA.rst
|   |   |   |   ├── 22691-JMK.rst
|   |   |   |   ├── 22745-JMK.rst
|   |   |   |   ├── 23031-AL.rst
|   |   |   |   ├── 23170-JMK.rst
|   |   |   |   ├── 23188-JMK.rst
|   |   |   |   └── 23270-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20071-AL.rst
|   |   |   |   ├── 20839-EP.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   ├── 21425-AL.rst
|   |   |   |   ├── 21584-AL.rst
|   |   |   |   ├── 21962-AL.rst
|   |   |   |   ├── 21965-AL.rst
|   |   |   |   ├── 21981-AL.rst
|   |   |   |   ├── 21982-AL.rst
|   |   |   |   ├── 21992-AL.rst
|   |   |   |   ├── 21995-AL.rst
|   |   |   |   ├── 22021-AL.rst
|   |   |   |   ├── 22025-AL.rst
|   |   |   |   ├── 22050-AL.rst
|   |   |   |   ├── 22051-AL.rst
|   |   |   |   ├── 22084-SS.rst
|   |   |   |   ├── 22097-AL.rst
|   |   |   |   ├── 22098-AL.rst
|   |   |   |   ├── 22123-TH.rst
|   |   |   |   ├── 22133-OG.rst
|   |   |   |   ├── 22134-OG.rst
|   |   |   |   ├── 22148-OG.rst
|   |   |   |   ├── 22167-EP.rst
|   |   |   |   ├── 22245-AL.rst
|   |   |   |   ├── 22268-OG.rst
|   |   |   |   ├── 22298-GL.rst
|   |   |   |   ├── 22317-AL.rst
|   |   |   |   ├── 22323-GL.rst
|   |   |   |   ├── 22345-JK.rst
|   |   |   |   ├── 22415-AL.rst
|   |   |   |   ├── 22418-AL.rst
|   |   |   |   ├── 22421-AL.rst
|   |   |   |   ├── 22422-AL.rst
|   |   |   |   ├── 22490-AL.rst
|   |   |   |   ├── 22503-AL.rst
|   |   |   |   ├── 22509-AL.rst
|   |   |   |   ├── 22539-AL.rst
|   |   |   |   ├── 22547-AL.rst
|   |   |   |   ├── 22554-AL.rst
|   |   |   |   ├── 22697-OG.rst
|   |   |   |   ├── 22725-AL.rst
|   |   |   |   ├── 22797-OG.rst
|   |   |   |   ├── 22813-GL.rst
|   |   |   |   ├── 22883-AL.rst
|   |   |   |   ├── 22885-AL.rst
|   |   |   |   ├── 23014-OG.rst
|   |   |   |   ├── 23045-OG.rst
|   |   |   |   ├── 23081-OG.rst
|   |   |   |   ├── 23166-ES.rst
|   |   |   |   ├── 23190-OG.rst
|   |   |   |   ├── 23232-TH.rst
|   |   |   |   ├── 23289-AL.rst
|   |   |   |   ├── 23302-TH.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 21415-AL.rst
|   |   |   |   ├── 22205-ES.rst
|   |   |   |   └── 22550-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 00001-DS.rst
|   |   |       ├── 20990-AL.rst
|   |   |       ├── 21395-AL.rst
|   |   |       ├── 21591-AL.rst
|   |   |       ├── 21980-CC.rst
|   |   |       ├── 22081-AL.rst
|   |   |       ├── 22107-OG.rst
|   |   |       ├── 22365-OG.rst
|   |   |       ├── 22465-AL.rst
|   |   |       ├── 22486-OG.rst
|   |   |       ├── 22514-OG.rst
|   |   |       ├── 22516-OG.rst
|   |   |       ├── 22738-JL.rst
|   |   |       ├── 22886-OG.rst
|   |   |       ├── 22952-TH.rst
|   |   |       ├── 23076-GL.rst
|   |   |       ├── 23077-GL.rst
|   |   |       ├── 23078-GL.rst
|   |   |       ├── 23079-GL.rst
|   |   |       ├── 23093-GL.rst
|   |   |       └── 23237-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   └── api_changes_3.5.2.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plot_focal_length.rst
|       |   ├── 3d_plot_roll_angle.rst
|       |   ├── README.rst
|       |   ├── asinh_scale.rst
|       |   ├── color_support_for_math_to_image.rst
|       |   ├── custom_cap_widths.rst
|       |   ├── double_quotes_matplolibrc.rst
|       |   ├── extending_MarkerStyle.rst
|       |   ├── inset_axes_improvements.rst
|       |   ├── layout_engine.rst
|       |   ├── list_font_names.rst
|       |   ├── marker_none.rst
|       |   ├── min_macos_version.rst
|       |   ├── modify_stairs_fill_edge_behaviour.rst
|       |   ├── no_broken_streamlines.rst
|       |   ├── polygon_selector_box.rst
|       |   ├── polygon_vert_setter.rst
|       |   ├── rectangle_patch_rotation.rst
|       |   ├── rename_ncol_keyword_in_legend.rst
|       |   ├── selector_improvement.rst
|       |   ├── snap_selector.rst
|       |   ├── striped_lines.rst
|       |   ├── url_active_areas_rotate.rst
|       |   ├── use_contourpy.rst
|       |   └── windows_arm64.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   └── whats_new_3.5.2.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 20:24:22,788 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to understand a bug related to Matplotlib's backend handling within an `rc_context`. To fully diagnose the issue and verify the provided patch, I need to examine the chain of function calls that lead to the bug. This involves how Matplotlib manages configuration (`RcParams`), switches backends (`switch_backend`, `pylab_setup`), creates figures (`pyplot.figure`), and stores them (`Gcf`). The provided context is empty, so I need to retrieve all these components." query='Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.' extra_requirements='' purpose='This information will allow me to trace the bug through the codebase, understand why creating a figure in `rc_context` causes issues, and confirm that the proposed patch correctly addresses the problem.'
2025-12-20 20:24:22,789 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.
2025-12-20 20:24:22,790 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 20:24:22,790 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 20:24:22,791 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 20:24:22,791 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.
Purpose: This information will allow me to trace the bug through the codebase, understand why creating a figure in `rc_context` causes issues, and confirm that the proposed patch correctly addresses the problem.
2025-12-20 20:24:57,702 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, and `figure`, as well as the classes `RcParams` and `Gcf` (`_Gcf`). The code for `RcParams` was found in `lib/matplotlib/__init__.py`, while the other functions and `_Gcf` were located in `lib/matplotlib/pyplot.py`. I am now providing the requested source code for your review.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 862.0, "relative_path": "lib/matplotlib/pyplot.py", "start_line": 825.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2172, 'candidates_token_count': 295, 'total_token_count': 6446, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2172}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 295}], 'thoughts_token_count': 3979, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4091145143670551, 'model_name': 'gemini-2.5-pro'} id='run--de5ded9b-9de4-4b36-b102-140cf082b477-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 991.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 971.0}, 'id': 'd7fce791-de38-4067-9036-91a1342d9e2b', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 1413.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 1398.0}, 'id': '1770c8d1-afee-46ac-9381-80a76b294a1f', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 152.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 139.0}, 'id': 'b3f0f948-6891-4699-9d59-6d0e4af8c36f', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 239.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 206.0}, 'id': '1c554ccd-e58c-485a-9faa-90e1dd7baf97', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 822.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 598.0}, 'id': 'e7b30f4e-8be2-43d2-9049-a832da21ef05', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 925.0, 'relative_path': 'lib/matplotlib/__init__.py', 'start_line': 728.0}, 'id': '36d7750d-a7b6-4f2a-bb4b-f31455eefc01', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 862.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 825.0}, 'id': '370eacfd-de45-4e95-89f1-ecb2dd0d2f2e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2172, 'output_tokens': 295, 'total_tokens': 6446, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 3979}}
2025-12-20 20:25:19,381 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the requested source code for `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, and `figure`, in addition to the classes `RcParams` and `Gcf`. The `RcParams` class and `rc_context` function were found within `lib/matplotlib/__init__.py`, and `Gcf` was located in `lib/matplotlib/_pylab_helpers.py`. All other functions were found in `lib/matplotlib/pyplot.py` as requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 85.0, "relative_path": "lib/matplotlib/_pylab_helpers.py", "start_line": 17.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11035, 'candidates_token_count': 302, 'total_token_count': 13644, 'cached_content_token_count': 1825, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11035}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1825}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 302}], 'thoughts_token_count': 2307}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5625710897887779, 'model_name': 'gemini-2.5-pro'} id='run--4b465aef-24c4-4b1f-b5fe-06f60bd0a5e8-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 996.0, 'relative_path': 'lib/matplotlib/__init__.py', 'start_line': 974.0}, 'id': '11ddca47-f3e2-4356-a066-c6f4a0eff3f5', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 207.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 204.0}, 'id': '22a29f45-dccb-4d72-b2a6-67c495179f33', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 163.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 139.0}, 'id': 'd0aa695b-a6d4-46ff-a6d5-587ecb157f29', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 281.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 209.0}, 'id': 'b92c5ac4-4ac9-4852-a508-0c4717b8350d', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 835.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 697.0}, 'id': '569a8593-a9c3-4a71-9955-f2e0277d0560', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 726.0, 'relative_path': 'lib/matplotlib/__init__.py', 'start_line': 282.0}, 'id': 'bb9b77a6-d842-42a8-8f6c-0474c7e44a05', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 85.0, 'relative_path': 'lib/matplotlib/_pylab_helpers.py', 'start_line': 17.0}, 'id': 'c2d319ba-99f1-4976-8126-490e7a1b5bec', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11035, 'output_tokens': 302, 'total_tokens': 13644, 'input_token_details': {'cache_read': 1825}, 'output_token_details': {'reasoning': 2307}}
2025-12-20 20:25:21,670 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located and provided the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, and `figure`, as well as the classes `RcParams` and `Gcf`. The code for `RcParams` and `rc_context` was found in `lib/matplotlib/__init__.py`, `Gcf` was in `lib/matplotlib/_pylab_helpers.py`, and the remaining functions were in `lib/matplotlib/pyplot.py`. This should provide the necessary context to trace the bug and verify the proposed patch.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 23112, 'candidates_token_count': 125, 'total_token_count': 23261, 'cached_content_token_count': 11331, 'prompt_tokens_details': [{'modality': 1, 'token_count': 23112}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11331}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 125}], 'thoughts_token_count': 24}, 'finish_reason': 'STOP', 'avg_logprobs': -0.04300293350219726, 'model_name': 'gemini-2.5-pro'} id='run--687f1852-e7e0-4500-8718-6d92c1d6c06f-0' usage_metadata={'input_tokens': 23112, 'output_tokens': 125, 'total_tokens': 23261, 'input_token_details': {'cache_read': 11331}, 'output_token_details': {'reasoning': 24}}
2025-12-20 20:25:21,673 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.
--- END QUERY ---



--- BEGIN PURPOSE ---
This information will allow me to trace the bug through the codebase, understand why creating a figure in `rc_context` causes issues, and confirm that the proposed patch correctly addresses the problem.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/__init__.py
Line number range: 282 - 726
Content:
282.         return ret
283. 
284.     return wrapper
285. 
286. 
287. _ExecInfo = namedtuple("_ExecInfo", "executable raw_version version")
288. 
289. 
290. class ExecutableNotFoundError(FileNotFoundError):
291.     """
292.     Error raised when an executable that Matplotlib optionally
293.     depends on can't be found.
294.     """
295.     pass
296. 
297. 
298. @functools.lru_cache()
299. def _get_executable_info(name):
300.     """
301.     Get the version of some executable that Matplotlib optionally depends on.
302. 
303.     .. warning::
304.        The list of executables that this function supports is set according to
305.        Matplotlib's internal needs, and may change without notice.
306. 
307.     Parameters
308.     ----------
309.     name : str
310.         The executable to query.  The following values are currently supported:
311.         "dvipng", "gs", "inkscape", "magick", "pdftocairo", "pdftops".  This
312.         list is subject to change without notice.
313. 
314.     Returns
315.     -------
316.     tuple
317.         A namedtuple with fields ``executable`` (`str`) and ``version``
318.         (`packaging.Version`, or ``None`` if the version cannot be determined).
319. 
320.     Raises
321.     ------
322.     ExecutableNotFoundError
323.         If the executable is not found or older than the oldest version
324.         supported by Matplotlib.  For debugging purposes, it is also
325.         possible to "hide" an executable from Matplotlib by adding it to the
326.         :envvar:`_MPLHIDEEXECUTABLES` environment variable (a comma-separated
327.         list), which must be set prior to any calls to this function.
328.     ValueError
329.         If the executable is not one that we know how to query.
330.     """
331. 
332.     def impl(args, regex, min_ver=None, ignore_exit_code=False):
333.         # Execute the subprocess specified by args; capture stdout and stderr.
334.         # Search for a regex match in the output; if the match succeeds, the
335.         # first group of the match is the version.
336.         # Return an _ExecInfo if the executable exists, and has a version of
337.         # at least min_ver (if set); else, raise ExecutableNotFoundError.
338.         try:
339.             output = subprocess.check_output(
340.                 args, stderr=subprocess.STDOUT,
341.                 universal_newlines=True, errors="replace")
342.         except subprocess.CalledProcessError as _cpe:
343.             if ignore_exit_code:
344.                 output = _cpe.output
345.             else:
346.                 raise ExecutableNotFoundError(str(_cpe)) from _cpe
347.         except OSError as _ose:
348.             raise ExecutableNotFoundError(str(_ose)) from _ose
349.         match = re.search(regex, output)
350.         if match:
351.             raw_version = match.group(1)
352.             version = parse_version(raw_version)
353.             if min_ver is not None and version < parse_version(min_ver):
354.                 raise ExecutableNotFoundError(
355.                     f"You have {args[0]} version {version} but the minimum "
356.                     f"version supported by Matplotlib is {min_ver}")
357.             return _ExecInfo(args[0], raw_version, version)
358.         else:
359.             raise ExecutableNotFoundError(
360.                 f"Failed to determine the version of {args[0]} from "
361.                 f"{' '.join(args)}, which output {output}")
362. 
363.     if name in os.environ.get("_MPLHIDEEXECUTABLES", "").split(","):
364.         raise ExecutableNotFoundError(f"{name} was hidden")
365. 
366.     if name == "dvipng":
367.         return impl(["dvipng", "-version"], "(?m)^dvipng(?: .*)? (.+)", "1.6")
368.     elif name == "gs":
369.         execs = (["gswin32c", "gswin64c", "mgs", "gs"]  # "mgs" for miktex.
370.                  if sys.platform == "win32" else
371.                  ["gs"])
372.         for e in execs:
373.             try:
374.                 return impl([e, "--version"], "(.*)", "9")
375.             except ExecutableNotFoundError:
376.                 pass
377.         message = "Failed to find a Ghostscript installation"
378.         raise ExecutableNotFoundError(message)
379.     elif name == "inkscape":
380.         try:
381.             # Try headless option first (needed for Inkscape version < 1.0):
382.             return impl(["inkscape", "--without-gui", "-V"],
383.                         "Inkscape ([^ ]*)")
384.         except ExecutableNotFoundError:
385.             pass  # Suppress exception chaining.
386.         # If --without-gui is not accepted, we may be using Inkscape >= 1.0 so
387.         # try without it:
388.         return impl(["inkscape", "-V"], "Inkscape ([^ ]*)")
389.     elif name == "magick":
390.         if sys.platform == "win32":
391.             # Check the registry to avoid confusing ImageMagick's convert with
392.             # Windows's builtin convert.exe.
393.             import winreg
394.             binpath = ""
395.             for flag in [0, winreg.KEY_WOW64_32KEY, winreg.KEY_WOW64_64KEY]:
396.                 try:
397.                     with winreg.OpenKeyEx(
398.                             winreg.HKEY_LOCAL_MACHINE,
399.                             r"Software\Imagemagick\Current",
400.                             0, winreg.KEY_QUERY_VALUE | flag) as hkey:
401.                         binpath = winreg.QueryValueEx(hkey, "BinPath")[0]
402.                 except OSError:
403.                     pass
404.             path = None
405.             if binpath:
406.                 for name in ["convert.exe", "magick.exe"]:
407.                     candidate = Path(binpath, name)
408.                     if candidate.exists():
409.                         path = str(candidate)
410.                         break
411.             if path is None:
412.                 raise ExecutableNotFoundError(
413.                     "Failed to find an ImageMagick installation")
414.         else:
415.             path = "convert"
416.         info = impl([path, "--version"], r"^Version: ImageMagick (\S*)")
417.         if info.raw_version == "7.0.10-34":
418.             # https://github.com/ImageMagick/ImageMagick/issues/2720
419.             raise ExecutableNotFoundError(
420.                 f"You have ImageMagick {info.version}, which is unsupported")
421.         return info
422.     elif name == "pdftocairo":
423.         return impl(["pdftocairo", "-v"], "pdftocairo version (.*)")
424.     elif name == "pdftops":
425.         info = impl(["pdftops", "-v"], "^pdftops version (.*)",
426.                     ignore_exit_code=True)
427.         if info and not (
428.                 3 <= info.version.major or
429.                 # poppler version numbers.
430.                 parse_version("0.9") <= info.version < parse_version("1.0")):
431.             raise ExecutableNotFoundError(
432.                 f"You have pdftops version {info.version} but the minimum "
433.                 f"version supported by Matplotlib is 3.0")
434.         return info
435.     else:
436.         raise ValueError("Unknown executable: {!r}".format(name))
437. 
438. 
439. @_api.deprecated("3.6", alternative="Vendor the code")
440. def checkdep_usetex(s):
441.     if not s:
442.         return False
443.     if not shutil.which("tex"):
444.         _log.warning("usetex mode requires TeX.")
445.         return False
446.     try:
447.         _get_executable_info("dvipng")
448.     except ExecutableNotFoundError:
449.         _log.warning("usetex mode requires dvipng.")
450.         return False
451.     try:
452.         _get_executable_info("gs")
453.     except ExecutableNotFoundError:
454.         _log.warning("usetex mode requires ghostscript.")
455.         return False
456.     return True
457. 
458. 
459. def _get_xdg_config_dir():
460.     """
461.     Return the XDG configuration directory, according to the XDG base
462.     directory spec:
463. 
464.     https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html
465.     """
466.     return os.environ.get('XDG_CONFIG_HOME') or str(Path.home() / ".config")
467. 
468. 
469. def _get_xdg_cache_dir():
470.     """
471.     Return the XDG cache directory, according to the XDG base directory spec:
472. 
473.     https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html
474.     """
475.     return os.environ.get('XDG_CACHE_HOME') or str(Path.home() / ".cache")
476. 
477. 
478. def _get_config_or_cache_dir(xdg_base_getter):
479.     configdir = os.environ.get('MPLCONFIGDIR')
480.     if configdir:
481.         configdir = Path(configdir).resolve()
482.     elif sys.platform.startswith(('linux', 'freebsd')):
483.         # Only call _xdg_base_getter here so that MPLCONFIGDIR is tried first,
484.         # as _xdg_base_getter can throw.
485.         configdir = Path(xdg_base_getter(), "matplotlib")
486.     else:
487.         configdir = Path.home() / ".matplotlib"
488.     try:
489.         configdir.mkdir(parents=True, exist_ok=True)
490.     except OSError:
491.         pass
492.     else:
493.         if os.access(str(configdir), os.W_OK) and configdir.is_dir():
494.             return str(configdir)
495.     # If the config or cache directory cannot be created or is not a writable
496.     # directory, create a temporary one.
497.     tmpdir = os.environ["MPLCONFIGDIR"] = \
498.         tempfile.mkdtemp(prefix="matplotlib-")
499.     atexit.register(shutil.rmtree, tmpdir)
500.     _log.warning(
501.         "Matplotlib created a temporary config/cache directory at %s because "
502.         "the default path (%s) is not a writable directory; it is highly "
503.         "recommended to set the MPLCONFIGDIR environment variable to a "
504.         "writable directory, in particular to speed up the import of "
505.         "Matplotlib and to better support multiprocessing.",
506.         tmpdir, configdir)
507.     return tmpdir
508. 
509. 
510. @_logged_cached('CONFIGDIR=%s')
511. def get_configdir():
512.     """
513.     Return the string path of the configuration directory.
514. 
515.     The directory is chosen as follows:
516. 
517.     1. If the MPLCONFIGDIR environment variable is supplied, choose that.
518.     2. On Linux, follow the XDG specification and look first in
519.        ``$XDG_CONFIG_HOME``, if defined, or ``$HOME/.config``.  On other
520.        platforms, choose ``$HOME/.matplotlib``.
521.     3. If the chosen directory exists and is writable, use that as the
522.        configuration directory.
523.     4. Else, create a temporary directory, and use it as the configuration
524.        directory.
525.     """
526.     return _get_config_or_cache_dir(_get_xdg_config_dir)
527. 
528. 
529. @_logged_cached('CACHEDIR=%s')
530. def get_cachedir():
531.     """
532.     Return the string path of the cache directory.
533. 
534.     The procedure used to find the directory is the same as for
535.     _get_config_dir, except using ``$XDG_CACHE_HOME``/``$HOME/.cache`` instead.
536.     """
537.     return _get_config_or_cache_dir(_get_xdg_cache_dir)
538. 
539. 
540. @_logged_cached('matplotlib data path: %s')
541. def get_data_path():
542.     """Return the path to Matplotlib data."""
543.     return str(Path(__file__).with_name("mpl-data"))
544. 
545. 
546. def matplotlib_fname():
547.     """
548.     Get the location of the config file.
549. 
550.     The file location is determined in the following order
551. 
552.     - ``$PWD/matplotlibrc``
553.     - ``$MATPLOTLIBRC`` if it is not a directory
554.     - ``$MATPLOTLIBRC/matplotlibrc``
555.     - ``$MPLCONFIGDIR/matplotlibrc``
556.     - On Linux,
557.         - ``$XDG_CONFIG_HOME/matplotlib/matplotlibrc`` (if ``$XDG_CONFIG_HOME``
558.           is defined)
559.         - or ``$HOME/.config/matplotlib/matplotlibrc`` (if ``$XDG_CONFIG_HOME``
560.           is not defined)
561.     - On other platforms,
562.       - ``$HOME/.matplotlib/matplotlibrc`` if ``$HOME`` is defined
563.     - Lastly, it looks in ``$MATPLOTLIBDATA/matplotlibrc``, which should always
564.       exist.
565.     """
566. 
567.     def gen_candidates():
568.         # rely on down-stream code to make absolute.  This protects us
569.         # from having to directly get the current working directory
570.         # which can fail if the user has ended up with a cwd that is
571.         # non-existent.
572.         yield 'matplotlibrc'
573.         try:
574.             matplotlibrc = os.environ['MATPLOTLIBRC']
575.         except KeyError:
576.             pass
577.         else:
578.             yield matplotlibrc
579.             yield os.path.join(matplotlibrc, 'matplotlibrc')
580.         yield os.path.join(get_configdir(), 'matplotlibrc')
581.         yield os.path.join(get_data_path(), 'matplotlibrc')
582. 
583.     for fname in gen_candidates():
584.         if os.path.exists(fname) and not os.path.isdir(fname):
585.             return fname
586. 
587.     raise RuntimeError("Could not find matplotlibrc file; your Matplotlib "
588.                        "install is broken")
589. 
590. 
591. # rcParams deprecated and automatically mapped to another key.
592. # Values are tuples of (version, new_name, f_old2new, f_new2old).
593. _deprecated_map = {}
594. # rcParams deprecated; some can manually be mapped to another key.
595. # Values are tuples of (version, new_name_or_None).
596. _deprecated_ignore_map = {}
597. # rcParams deprecated; can use None to suppress warnings; remain actually
598. # listed in the rcParams.
599. # Values are tuples of (version,)
600. _deprecated_remain_as_none = {}
601. 
602. 
603. @_docstring.Substitution(
604.     "\n".join(map("- {}".format, sorted(rcsetup._validators, key=str.lower)))
605. )
606. class RcParams(MutableMapping, dict):
607.     """
608.     A dictionary object including validation.
609. 
610.     Validating functions are defined and associated with rc parameters in
611.     :mod:`matplotlib.rcsetup`.
612. 
613.     The list of rcParams is:
614. 
615.     %s
616. 
617.     See Also
618.     --------
619.     :ref:`customizing-with-matplotlibrc-files`
620.     """
621. 
622.     validate = rcsetup._validators
623. 
624.     # validate values on the way in
625.     def __init__(self, *args, **kwargs):
626.         self.update(*args, **kwargs)
627. 
628.     def __setitem__(self, key, val):
629.         try:
630.             if key in _deprecated_map:
631.                 version, alt_key, alt_val, inverse_alt = _deprecated_map[key]
632.                 _api.warn_deprecated(
633.                     version, name=key, obj_type="rcparam", alternative=alt_key)
634.                 key = alt_key
635.                 val = alt_val(val)
636.             elif key in _deprecated_remain_as_none and val is not None:
637.                 version, = _deprecated_remain_as_none[key]
638.                 _api.warn_deprecated(version, name=key, obj_type="rcparam")
639.             elif key in _deprecated_ignore_map:
640.                 version, alt_key = _deprecated_ignore_map[key]
641.                 _api.warn_deprecated(
642.                     version, name=key, obj_type="rcparam", alternative=alt_key)
643.                 return
644.             elif key == 'backend':
645.                 if val is rcsetup._auto_backend_sentinel:
646.                     if 'backend' in self:
647.                         return
648.             try:
649.                 cval = self.validate[key](val)
650.             except ValueError as ve:
651.                 raise ValueError(f"Key {key}: {ve}") from None
652.             dict.__setitem__(self, key, cval)
653.         except KeyError as err:
654.             raise KeyError(
655.                 f"{key} is not a valid rc parameter (see rcParams.keys() for "
656.                 f"a list of valid parameters)") from err
657. 
658.     def __getitem__(self, key):
659.         if key in _deprecated_map:
660.             version, alt_key, alt_val, inverse_alt = _deprecated_map[key]
661.             _api.warn_deprecated(
662.                 version, name=key, obj_type="rcparam", alternative=alt_key)
663.             return inverse_alt(dict.__getitem__(self, alt_key))
664. 
665.         elif key in _deprecated_ignore_map:
666.             version, alt_key = _deprecated_ignore_map[key]
667.             _api.warn_deprecated(
668.                 version, name=key, obj_type="rcparam", alternative=alt_key)
669.             return dict.__getitem__(self, alt_key) if alt_key else None
670. 
671.         # In theory, this should only ever be used after the global rcParams
672.         # has been set up, but better be safe e.g. in presence of breakpoints.
673.         elif key == "backend" and self is globals().get("rcParams"):
674.             val = dict.__getitem__(self, key)
675.             if val is rcsetup._auto_backend_sentinel:
676.                 from matplotlib import pyplot as plt
677.                 plt.switch_backend(rcsetup._auto_backend_sentinel)
678. 
679.         return dict.__getitem__(self, key)
680. 
681.     def _get_backend_or_none(self):
682.         """Get the requested backend, if any, without triggering resolution."""
683.         backend = dict.__getitem__(self, "backend")
684.         return None if backend is rcsetup._auto_backend_sentinel else backend
685. 
686.     def __repr__(self):
687.         class_name = self.__class__.__name__
688.         indent = len(class_name) + 1
689.         with _api.suppress_matplotlib_deprecation_warning():
690.             repr_split = pprint.pformat(dict(self), indent=1,
691.                                         width=80 - indent).split('\n')
692.         repr_indented = ('\n' + ' ' * indent).join(repr_split)
693.         return '{}({})'.format(class_name, repr_indented)
694. 
695.     def __str__(self):
696.         return '\n'.join(map('{0[0]}: {0[1]}'.format, sorted(self.items())))
697. 
698.     def __iter__(self):
699.         """Yield sorted list of keys."""
700.         with _api.suppress_matplotlib_deprecation_warning():
701.             yield from sorted(dict.__iter__(self))
702. 
703.     def __len__(self):
704.         return dict.__len__(self)
705. 
706.     def find_all(self, pattern):
707.         """
708.         Return the subset of this RcParams dictionary whose keys match,
709.         using :func:`re.search`, the given ``pattern``.
710. 
711.         .. note::
712. 
713.             Changes to the returned dictionary are *not* propagated to
714.             the parent RcParams dictionary.
715. 
716.         """
717.         pattern_re = re.compile(pattern)
718.         return RcParams((key, value)
719.                         for key, value in self.items()
720.                         if pattern_re.search(key))
721. 
722.     def copy(self):
723.         rccopy = RcParams()
724.         for k in self:  # Skip deprecations and revalidation.
725.             dict.__setitem__(rccopy, k, dict.__getitem__(self, k))
726.         return rccopy


File: lib/matplotlib/__init__.py
Line number range: 728 - 925
Content:
728. 
729. def rc_params(fail_on_error=False):
730.     """Construct a `RcParams` instance from the default Matplotlib rc file."""
731.     return rc_params_from_file(matplotlib_fname(), fail_on_error)
732. 
733. 
734. @_api.deprecated("3.5")
735. def is_url(filename):
736.     """Return whether *filename* is an http, https, ftp, or file URL path."""
737.     return __getattr__("URL_REGEX").match(filename) is not None
738. 
739. 
740. @functools.lru_cache()
741. def _get_ssl_context():
742.     try:
743.         import certifi
744.     except ImportError:
745.         _log.debug("Could not import certifi.")
746.         return None
747.     import ssl
748.     return ssl.create_default_context(cafile=certifi.where())
749. 
750. 
751. @contextlib.contextmanager
752. def _open_file_or_url(fname):
753.     if (isinstance(fname, str)
754.             and fname.startswith(('http://', 'https://', 'ftp://', 'file:'))):
755.         import urllib.request
756.         ssl_ctx = _get_ssl_context()
757.         if ssl_ctx is None:
758.             _log.debug(
759.                 "Could not get certifi ssl context, https may not work."
760.             )
761.         with urllib.request.urlopen(fname, context=ssl_ctx) as f:
762.             yield (line.decode('utf-8') for line in f)
763.     else:
764.         fname = os.path.expanduser(fname)
765.         with open(fname, encoding='utf-8') as f:
766.             yield f
767. 
768. 
769. def _rc_params_in_file(fname, transform=lambda x: x, fail_on_error=False):
770.     """
771.     Construct a `RcParams` instance from file *fname*.
772. 
773.     Unlike `rc_params_from_file`, the configuration class only contains the
774.     parameters specified in the file (i.e. default values are not filled in).
775. 
776.     Parameters
777.     ----------
778.     fname : path-like
779.         The loaded file.
780.     transform : callable, default: the identity function
781.         A function called on each individual line of the file to transform it,
782.         before further parsing.
783.     fail_on_error : bool, default: False
784.         Whether invalid entries should result in an exception or a warning.
785.     """
786.     import matplotlib as mpl
787.     rc_temp = {}
788.     with _open_file_or_url(fname) as fd:
789.         try:
790.             for line_no, line in enumerate(fd, 1):
791.                 line = transform(line)
792.                 strippedline = cbook._strip_comment(line)
793.                 if not strippedline:
794.                     continue
795.                 tup = strippedline.split(':', 1)
796.                 if len(tup) != 2:
797.                     _log.warning('Missing colon in file %r, line %d (%r)',
798.                                  fname, line_no, line.rstrip('\n'))
799.                     continue
800.                 key, val = tup
801.                 key = key.strip()
802.                 val = val.strip()
803.                 if val.startswith('"') and val.endswith('"'):
804.                     val = val[1:-1]  # strip double quotes
805.                 if key in rc_temp:
806.                     _log.warning('Duplicate key in file %r, line %d (%r)',
807.                                  fname, line_no, line.rstrip('\n'))
808.                 rc_temp[key] = (val, line, line_no)
809.         except UnicodeDecodeError:
810.             _log.warning('Cannot decode configuration file %r as utf-8.',
811.                          fname)
812.             raise
813. 
814.     config = RcParams()
815. 
816.     for key, (val, line, line_no) in rc_temp.items():
817.         if key in rcsetup._validators:
818.             if fail_on_error:
819.                 config[key] = val  # try to convert to proper type or raise
820.             else:
821.                 try:
822.                     config[key] = val  # try to convert to proper type or skip
823.                 except Exception as msg:
824.                     _log.warning('Bad value in file %r, line %d (%r): %s',
825.                                  fname, line_no, line.rstrip('\n'), msg)
826.         elif key in _deprecated_ignore_map:
827.             version, alt_key = _deprecated_ignore_map[key]
828.             _api.warn_deprecated(
829.                 version, name=key, alternative=alt_key, obj_type='rcparam',
830.                 addendum="Please update your matplotlibrc.")
831.         else:
832.             # __version__ must be looked up as an attribute to trigger the
833.             # module-level __getattr__.
834.             version = ('main' if '.post' in mpl.__version__
835.                        else f'v{mpl.__version__}')
836.             _log.warning("""
837. Bad key %(key)s in file %(fname)s, line %(line_no)s (%(line)r)
838. You probably need to get an updated matplotlibrc file from
839. https://github.com/matplotlib/matplotlib/blob/%(version)s/matplotlibrc.template
840. or from the matplotlib source distribution""",
841.                          dict(key=key, fname=fname, line_no=line_no,
842.                               line=line.rstrip('\n'), version=version))
843.     return config
844. 
845. 
846. def rc_params_from_file(fname, fail_on_error=False, use_default_template=True):
847.     """
848.     Construct a `RcParams` from file *fname*.
849. 
850.     Parameters
851.     ----------
852.     fname : str or path-like
853.         A file with Matplotlib rc settings.
854.     fail_on_error : bool
855.         If True, raise an error when the parser fails to convert a parameter.
856.     use_default_template : bool
857.         If True, initialize with default parameters before updating with those
858.         in the given file. If False, the configuration class only contains the
859.         parameters specified in the file. (Useful for updating dicts.)
860.     """
861.     config_from_file = _rc_params_in_file(fname, fail_on_error=fail_on_error)
862. 
863.     if not use_default_template:
864.         return config_from_file
865. 
866.     with _api.suppress_matplotlib_deprecation_warning():
867.         config = RcParams({**rcParamsDefault, **config_from_file})
868. 
869.     if "".join(config['text.latex.preamble']):
870.         _log.info("""
871. *****************************************************************
872. You have the following UNSUPPORTED LaTeX preamble customizations:
873. %s
874. Please do not ask for support with these customizations active.
875. *****************************************************************
876. """, '\n'.join(config['text.latex.preamble']))
877.     _log.debug('loaded rc file %s', fname)
878. 
879.     return config
880. 
881. 
882. # When constructing the global instances, we need to perform certain updates
883. # by explicitly calling the superclass (dict.update, dict.items) to avoid
884. # triggering resolution of _auto_backend_sentinel.
885. rcParamsDefault = _rc_params_in_file(
886.     cbook._get_data_path("matplotlibrc"),
887.     # Strip leading comment.
888.     transform=lambda line: line[1:] if line.startswith("#") else line,
889.     fail_on_error=True)
890. dict.update(rcParamsDefault, rcsetup._hardcoded_defaults)
891. # Normally, the default matplotlibrc file contains *no* entry for backend (the
892. # corresponding line starts with ##, not #; we fill on _auto_backend_sentinel
893. # in that case.  However, packagers can set a different default backend
894. # (resulting in a normal `#backend: foo` line) in which case we should *not*
895. # fill in _auto_backend_sentinel.
896. dict.setdefault(rcParamsDefault, "backend", rcsetup._auto_backend_sentinel)
897. rcParams = RcParams()  # The global instance.
898. dict.update(rcParams, dict.items(rcParamsDefault))
899. dict.update(rcParams, _rc_params_in_file(matplotlib_fname()))
900. rcParamsOrig = rcParams.copy()
901. with _api.suppress_matplotlib_deprecation_warning():
902.     # This also checks that all rcParams are indeed listed in the template.
903.     # Assigning to rcsetup.defaultParams is left only for backcompat.
904.     defaultParams = rcsetup.defaultParams = {
905.         # We want to resolve deprecated rcParams, but not backend...
906.         key: [(rcsetup._auto_backend_sentinel if key == "backend" else
907.                rcParamsDefault[key]),
908.               validator]
909.         for key, validator in rcsetup._validators.items()}
910. if rcParams['axes.formatter.use_locale']:
911.     locale.setlocale(locale.LC_ALL, '')
912. 
913. 
914. def rc(group, **kwargs):
915.     """
916.     Set the current `.rcParams`.  *group* is the grouping for the rc, e.g.,
917.     for ``lines.linewidth`` the group is ``lines``, for
918.     ``axes.facecolor``, the group is ``axes``, and so on.  Group may
919.     also be a list or tuple of group names, e.g., (*xtick*, *ytick*).
920.     *kwargs* is a dictionary attribute name/value pairs, e.g.,::
921. 
922.       rc('lines', linewidth=2, color='r')
923. 
924.     sets the current `.rcParams` and is equivalent to::


File: lib/matplotlib/__init__.py
Line number range: 974 - 996
Content:
974.         'aa':  'antialiased',
975.         }
976. 
977.     if isinstance(group, str):
978.         group = (group,)
979.     for g in group:
980.         for k, v in kwargs.items():
981.             name = aliases.get(k) or k
982.             key = '%s.%s' % (g, name)
983.             try:
984.                 rcParams[key] = v
985.             except KeyError as err:
986.                 raise KeyError(('Unrecognized key "%s" for group "%s" and '
987.                                 'name "%s"') % (key, g, name)) from err
988. 
989. 
990. def rcdefaults():
991.     """
992.     Restore the `.rcParams` from Matplotlib's internal default style.
993. 
994.     Style-blacklisted `.rcParams` (defined in
995.     ``matplotlib.style.core.STYLE_BLACKLIST``) are not updated.


File: lib/matplotlib/_pylab_helpers.py
Line number range: 17 - 85
Content:
17.     pyplot keeps track of figure managers using an identifier, the "figure
18.     number" or "manager number" (which can actually be any hashable value);
19.     this number is available as the :attr:`number` attribute of the manager.
20. 
21.     This class is never instantiated; it consists of an `OrderedDict` mapping
22.     figure/manager numbers to managers, and a set of class methods that
23.     manipulate this `OrderedDict`.
24. 
25.     Attributes
26.     ----------
27.     figs : OrderedDict
28.         `OrderedDict` mapping numbers to managers; the active manager is at the
29.         end.
30.     """
31. 
32.     figs = OrderedDict()
33. 
34.     @classmethod
35.     def get_fig_manager(cls, num):
36.         """
37.         If manager number *num* exists, make it the active one and return it;
38.         otherwise return *None*.
39.         """
40.         manager = cls.figs.get(num, None)
41.         if manager is not None:
42.             cls.set_active(manager)
43.         return manager
44. 
45.     @classmethod
46.     def destroy(cls, num):
47.         """
48.         Destroy manager *num* -- either a manager instance or a manager number.
49. 
50.         In the interactive backends, this is bound to the window "destroy" and
51.         "delete" events.
52. 
53.         It is recommended to pass a manager instance, to avoid confusion when
54.         two managers share the same number.
55.         """
56.         if all(hasattr(num, attr) for attr in ["num", "destroy"]):
57.             manager = num
58.             if cls.figs.get(manager.num) is manager:
59.                 cls.figs.pop(manager.num)
60.         else:
61.             try:
62.                 manager = cls.figs.pop(num)
63.             except KeyError:
64.                 return
65.         if hasattr(manager, "_cidgcf"):
66.             manager.canvas.mpl_disconnect(manager._cidgcf)
67.         manager.destroy()
68.         del manager, num
69.         # Full cyclic garbage collection may be too expensive to do on every
70.         # figure destruction, so we collect only the youngest two generations.
71.         # see: https://github.com/matplotlib/matplotlib/pull/3045
72.         gc.collect(1)
73. 
74.     @classmethod
75.     def destroy_fig(cls, fig):
76.         """Destroy figure *fig*."""
77.         num = next((manager.num for manager in cls.figs.values()
78.                     if manager.canvas.figure == fig), None)
79.         if num is not None:
80.             cls.destroy(num)
81. 
82.     @classmethod
83.     def destroy_all(cls):
84.         """Destroy all figures."""
85.         # Reimport gc in case the module globals have already been removed


File: lib/matplotlib/pyplot.py
Line number range: 139 - 163
Content:
139.     mod_ipython = sys.modules.get("IPython")
140.     if not mod_ipython:
141.         _REPL_DISPLAYHOOK = _ReplDisplayHook.PLAIN
142.         return
143.     ip = mod_ipython.get_ipython()
144.     if not ip:
145.         _REPL_DISPLAYHOOK = _ReplDisplayHook.PLAIN
146.         return
147. 
148.     ip.events.register("post_execute", _draw_all_if_interactive)
149.     _REPL_DISPLAYHOOK = _ReplDisplayHook.IPYTHON
150. 
151.     from IPython.core.pylabtools import backend2gui
152.     # trigger IPython's eventloop integration, if available
153.     ipython_gui_name = backend2gui.get(get_backend())
154.     if ipython_gui_name:
155.         ip.enable_gui(ipython_gui_name)
156. 
157. 
158. def uninstall_repl_displayhook():
159.     """Disconnect from the display hook of the current shell."""
160.     global _REPL_DISPLAYHOOK
161.     if _REPL_DISPLAYHOOK is _ReplDisplayHook.IPYTHON:
162.         from IPython import get_ipython
163.         ip = get_ipython()


File: lib/matplotlib/pyplot.py
Line number range: 204 - 207
Content:
204.         # resolve the auto sentinel)
205.         switch_backend(dict.__getitem__(rcParams, "backend"))
206.     return _backend_mod


File: lib/matplotlib/pyplot.py
Line number range: 206 - 239
Content:
206.     return _backend_mod
207. 
208. 
209. def switch_backend(newbackend):
210.     """
211.     Close all open figures and set the Matplotlib backend.
212. 
213.     The argument is case-insensitive.  Switching to an interactive backend is
214.     possible only if no event loop for another interactive backend has started.
215.     Switching to and from non-interactive backends is always possible.
216. 
217.     Parameters
218.     ----------
219.     newbackend : str
220.         The name of the backend to use.
221.     """
222.     global _backend_mod
223.     # make sure the init is pulled up so we can assign to it later
224.     import matplotlib.backends
225.     close("all")
226. 
227.     if newbackend is rcsetup._auto_backend_sentinel:
228.         current_framework = cbook._get_running_interactive_framework()
229.         mapping = {'qt': 'qtagg',
230.                    'gtk3': 'gtk3agg',
231.                    'gtk4': 'gtk4agg',
232.                    'wx': 'wxagg',
233.                    'tk': 'tkagg',
234.                    'macosx': 'macosx',
235.                    'headless': 'agg'}
236. 
237.         best_guess = mapping.get(current_framework, None)
238.         if best_guess is not None:
239.             candidates = [best_guess]


File: lib/matplotlib/pyplot.py
Line number range: 209 - 281
Content:
209. def switch_backend(newbackend):
210.     """
211.     Close all open figures and set the Matplotlib backend.
212. 
213.     The argument is case-insensitive.  Switching to an interactive backend is
214.     possible only if no event loop for another interactive backend has started.
215.     Switching to and from non-interactive backends is always possible.
216. 
217.     Parameters
218.     ----------
219.     newbackend : str
220.         The name of the backend to use.
221.     """
222.     global _backend_mod
223.     # make sure the init is pulled up so we can assign to it later
224.     import matplotlib.backends
225.     close("all")
226. 
227.     if newbackend is rcsetup._auto_backend_sentinel:
228.         current_framework = cbook._get_running_interactive_framework()
229.         mapping = {'qt': 'qtagg',
230.                    'gtk3': 'gtk3agg',
231.                    'gtk4': 'gtk4agg',
232.                    'wx': 'wxagg',
233.                    'tk': 'tkagg',
234.                    'macosx': 'macosx',
235.                    'headless': 'agg'}
236. 
237.         best_guess = mapping.get(current_framework, None)
238.         if best_guess is not None:
239.             candidates = [best_guess]
240.         else:
241.             candidates = []
242.         candidates += [
243.             "macosx", "qtagg", "gtk4agg", "gtk3agg", "tkagg", "wxagg"]
244. 
245.         # Don't try to fallback on the cairo-based backends as they each have
246.         # an additional dependency (pycairo) over the agg-based backend, and
247.         # are of worse quality.
248.         for candidate in candidates:
249.             try:
250.                 switch_backend(candidate)
251.             except ImportError:
252.                 continue
253.             else:
254.                 rcParamsOrig['backend'] = candidate
255.                 return
256.         else:
257.             # Switching to Agg should always succeed; if it doesn't, let the
258.             # exception propagate out.
259.             switch_backend("agg")
260.             rcParamsOrig["backend"] = "agg"
261.             return
262. 
263.     backend_mod = importlib.import_module(
264.         cbook._backend_module_name(newbackend))
265.     canvas_class = backend_mod.FigureCanvas
266. 
267.     required_framework = _get_required_interactive_framework(backend_mod)
268.     if required_framework is not None:
269.         current_framework = cbook._get_running_interactive_framework()
270.         if (current_framework and required_framework
271.                 and current_framework != required_framework):
272.             raise ImportError(
273.                 "Cannot load backend {!r} which requires the {!r} interactive "
274.                 "framework, as {!r} is currently running".format(
275.                     newbackend, required_framework, current_framework))
276. 
277.     # Load the new_figure_manager(), draw_if_interactive(), and show()
278.     # functions from the backend.
279. 
280.     # Classically, backends can directly export these functions.  This should
281.     # keep working for backcompat.


File: lib/matplotlib/pyplot.py
Line number range: 598 - 822
Content:
598.         draw_all()
599. 
600. 
601. # getp/get/setp are explicitly reexported so that they show up in pyplot docs.
602. 
603. 
604. @_copy_docstring_and_deprecators(matplotlib.artist.getp)
605. def getp(obj, *args, **kwargs):
606.     return matplotlib.artist.getp(obj, *args, **kwargs)
607. 
608. 
609. @_copy_docstring_and_deprecators(matplotlib.artist.get)
610. def get(obj, *args, **kwargs):
611.     return matplotlib.artist.get(obj, *args, **kwargs)
612. 
613. 
614. @_copy_docstring_and_deprecators(matplotlib.artist.setp)
615. def setp(obj, *args, **kwargs):
616.     return matplotlib.artist.setp(obj, *args, **kwargs)
617. 
618. 
619. def xkcd(scale=1, length=100, randomness=2):
620.     """
621.     Turn on `xkcd <https://xkcd.com/>`_ sketch-style drawing mode.  This will
622.     only have effect on things drawn after this function is called.
623. 
624.     For best results, the "Humor Sans" font should be installed: it is
625.     not included with Matplotlib.
626. 
627.     Parameters
628.     ----------
629.     scale : float, optional
630.         The amplitude of the wiggle perpendicular to the source line.
631.     length : float, optional
632.         The length of the wiggle along the line.
633.     randomness : float, optional
634.         The scale factor by which the length is shrunken or expanded.
635. 
636.     Notes
637.     -----
638.     This function works by a number of rcParams, so it will probably
639.     override others you have set before.
640. 
641.     If you want the effects of this function to be temporary, it can
642.     be used as a context manager, for example::
643. 
644.         with plt.xkcd():
645.             # This figure will be in XKCD-style
646.             fig1 = plt.figure()
647.             # ...
648. 
649.         # This figure will be in regular style
650.         fig2 = plt.figure()
651.     """
652.     return _xkcd(scale, length, randomness)
653. 
654. 
655. class _xkcd:
656.     # This cannot be implemented in terms of rc_context() because this needs to
657.     # work as a non-contextmanager too.
658. 
659.     def __init__(self, scale, length, randomness):
660.         self._orig = rcParams.copy()
661. 
662.         if rcParams['text.usetex']:
663.             raise RuntimeError(
664.                 "xkcd mode is not compatible with text.usetex = True")
665. 
666.         from matplotlib import patheffects
667.         rcParams.update({
668.             'font.family': ['xkcd', 'xkcd Script', 'Humor Sans', 'Comic Neue',
669.                             'Comic Sans MS'],
670.             'font.size': 14.0,
671.             'path.sketch': (scale, length, randomness),
672.             'path.effects': [
673.                 patheffects.withStroke(linewidth=4, foreground="w")],
674.             'axes.linewidth': 1.5,
675.             'lines.linewidth': 2.0,
676.             'figure.facecolor': 'white',
677.             'grid.linewidth': 0.0,
678.             'axes.grid': False,
679.             'axes.unicode_minus': False,
680.             'axes.edgecolor': 'black',
681.             'xtick.major.size': 8,
682.             'xtick.major.width': 3,
683.             'ytick.major.size': 8,
684.             'ytick.major.width': 3,
685.         })
686. 
687.     def __enter__(self):
688.         return self
689. 
690.     def __exit__(self, *args):
691.         dict.update(rcParams, self._orig)
692. 
693. 
694. ## Figures ##
695. 
696. @_api.make_keyword_only("3.6", "facecolor")
697. def figure(num=None,  # autoincrement if None, else integer from 1-N
698.            figsize=None,  # defaults to rc figure.figsize
699.            dpi=None,  # defaults to rc figure.dpi
700.            facecolor=None,  # defaults to rc figure.facecolor
701.            edgecolor=None,  # defaults to rc figure.edgecolor
702.            frameon=True,
703.            FigureClass=Figure,
704.            clear=False,
705.            **kwargs
706.            ):
707.     """
708.     Create a new figure, or activate an existing figure.
709. 
710.     Parameters
711.     ----------
712.     num : int or str or `.Figure` or `.SubFigure`, optional
713.         A unique identifier for the figure.
714. 
715.         If a figure with that identifier already exists, this figure is made
716.         active and returned. An integer refers to the ``Figure.number``
717.         attribute, a string refers to the figure label.
718. 
719.         If there is no figure with the identifier or *num* is not given, a new
720.         figure is created, made active and returned.  If *num* is an int, it
721.         will be used for the ``Figure.number`` attribute, otherwise, an
722.         auto-generated integer value is used (starting at 1 and incremented
723.         for each new figure). If *num* is a string, the figure label and the
724.         window title is set to this value.  If num is a ``SubFigure``, its
725.         parent ``Figure`` is activated.
726. 
727.     figsize : (float, float), default: :rc:`figure.figsize`
728.         Width, height in inches.
729. 
730.     dpi : float, default: :rc:`figure.dpi`
731.         The resolution of the figure in dots-per-inch.
732. 
733.     facecolor : color, default: :rc:`figure.facecolor`
734.         The background color.
735. 
736.     edgecolor : color, default: :rc:`figure.edgecolor`
737.         The border color.
738. 
739.     frameon : bool, default: True
740.         If False, suppress drawing the figure frame.
741. 
742.     FigureClass : subclass of `~matplotlib.figure.Figure`
743.         If set, an instance of this subclass will be created, rather than a
744.         plain `.Figure`.
745. 
746.     clear : bool, default: False
747.         If True and the figure already exists, then it is cleared.
748. 
749.     layout : {'constrained', 'tight', `.LayoutEngine`, None}, default: None
750.         The layout mechanism for positioning of plot elements to avoid
751.         overlapping Axes decorations (labels, ticks, etc). Note that layout
752.         managers can measurably slow down figure display. Defaults to *None*
753.         (but see the documentation of the `.Figure` constructor regarding the
754.         interaction with rcParams).
755. 
756.     **kwargs
757.         Additional keyword arguments are passed to the `.Figure` constructor.
758. 
759.     Returns
760.     -------
761.     `~matplotlib.figure.Figure`
762. 
763.     Notes
764.     -----
765.     Newly created figures will be passed to the
766.     `~.backend_template.new_figure_manager` function provided by the current
767.     backend, which will install a canvas and a manager on the figure.
768. 
769.     If you are creating many figures, make sure you explicitly call
770.     `.pyplot.close` on the figures you are not using, because this will
771.     enable pyplot to properly clean up the memory.
772. 
773.     `~matplotlib.rcParams` defines the default values, which can be modified
774.     in the matplotlibrc file.
775.     """
776.     if isinstance(num, FigureBase):
777.         if num.canvas.manager is None:
778.             raise ValueError("The passed figure is not managed by pyplot")
779.         _pylab_helpers.Gcf.set_active(num.canvas.manager)
780.         return num.figure
781. 
782.     allnums = get_fignums()
783.     next_num = max(allnums) + 1 if allnums else 1
784.     fig_label = ''
785.     if num is None:
786.         num = next_num
787.     elif isinstance(num, str):
788.         fig_label = num
789.         all_labels = get_figlabels()
790.         if fig_label not in all_labels:
791.             if fig_label == 'all':
792.                 _api.warn_external("close('all') closes all existing figures.")
793.             num = next_num
794.         else:
795.             inum = all_labels.index(fig_label)
796.             num = allnums[inum]
797.     else:
798.         num = int(num)  # crude validation of num argument
799. 
800.     manager = _pylab_helpers.Gcf.get_fig_manager(num)
801.     if manager is None:
802.         max_open_warning = rcParams['figure.max_open_warning']
803.         if len(allnums) == max_open_warning >= 1:
804.             _api.warn_external(
805.                 f"More than {max_open_warning} figures have been opened. "
806.                 f"Figures created through the pyplot interface "
807.                 f"(`matplotlib.pyplot.figure`) are retained until explicitly "
808.                 f"closed and may consume too much memory. (To control this "
809.                 f"warning, see the rcParam `figure.max_open_warning`).",
810.                 RuntimeWarning)
811. 
812.         manager = new_figure_manager(
813.             num, figsize=figsize, dpi=dpi,
814.             facecolor=facecolor, edgecolor=edgecolor, frameon=frameon,
815.             FigureClass=FigureClass, **kwargs)
816.         fig = manager.canvas.figure
817.         if fig_label:
818.             fig.set_label(fig_label)
819. 
820.         _pylab_helpers.Gcf._set_new_active_manager(manager)
821. 
822.         # make sure backends (inline) that we don't ship that expect this


File: lib/matplotlib/pyplot.py
Line number range: 697 - 835
Content:
697. def figure(num=None,  # autoincrement if None, else integer from 1-N
698.            figsize=None,  # defaults to rc figure.figsize
699.            dpi=None,  # defaults to rc figure.dpi
700.            facecolor=None,  # defaults to rc figure.facecolor
701.            edgecolor=None,  # defaults to rc figure.edgecolor
702.            frameon=True,
703.            FigureClass=Figure,
704.            clear=False,
705.            **kwargs
706.            ):
707.     """
708.     Create a new figure, or activate an existing figure.
709. 
710.     Parameters
711.     ----------
712.     num : int or str or `.Figure` or `.SubFigure`, optional
713.         A unique identifier for the figure.
714. 
715.         If a figure with that identifier already exists, this figure is made
716.         active and returned. An integer refers to the ``Figure.number``
717.         attribute, a string refers to the figure label.
718. 
719.         If there is no figure with the identifier or *num* is not given, a new
720.         figure is created, made active and returned.  If *num* is an int, it
721.         will be used for the ``Figure.number`` attribute, otherwise, an
722.         auto-generated integer value is used (starting at 1 and incremented
723.         for each new figure). If *num* is a string, the figure label and the
724.         window title is set to this value.  If num is a ``SubFigure``, its
725.         parent ``Figure`` is activated.
726. 
727.     figsize : (float, float), default: :rc:`figure.figsize`
728.         Width, height in inches.
729. 
730.     dpi : float, default: :rc:`figure.dpi`
731.         The resolution of the figure in dots-per-inch.
732. 
733.     facecolor : color, default: :rc:`figure.facecolor`
734.         The background color.
735. 
736.     edgecolor : color, default: :rc:`figure.edgecolor`
737.         The border color.
738. 
739.     frameon : bool, default: True
740.         If False, suppress drawing the figure frame.
741. 
742.     FigureClass : subclass of `~matplotlib.figure.Figure`
743.         If set, an instance of this subclass will be created, rather than a
744.         plain `.Figure`.
745. 
746.     clear : bool, default: False
747.         If True and the figure already exists, then it is cleared.
748. 
749.     layout : {'constrained', 'tight', `.LayoutEngine`, None}, default: None
750.         The layout mechanism for positioning of plot elements to avoid
751.         overlapping Axes decorations (labels, ticks, etc). Note that layout
752.         managers can measurably slow down figure display. Defaults to *None*
753.         (but see the documentation of the `.Figure` constructor regarding the
754.         interaction with rcParams).
755. 
756.     **kwargs
757.         Additional keyword arguments are passed to the `.Figure` constructor.
758. 
759.     Returns
760.     -------
761.     `~matplotlib.figure.Figure`
762. 
763.     Notes
764.     -----
765.     Newly created figures will be passed to the
766.     `~.backend_template.new_figure_manager` function provided by the current
767.     backend, which will install a canvas and a manager on the figure.
768. 
769.     If you are creating many figures, make sure you explicitly call
770.     `.pyplot.close` on the figures you are not using, because this will
771.     enable pyplot to properly clean up the memory.
772. 
773.     `~matplotlib.rcParams` defines the default values, which can be modified
774.     in the matplotlibrc file.
775.     """
776.     if isinstance(num, FigureBase):
777.         if num.canvas.manager is None:
778.             raise ValueError("The passed figure is not managed by pyplot")
779.         _pylab_helpers.Gcf.set_active(num.canvas.manager)
780.         return num.figure
781. 
782.     allnums = get_fignums()
783.     next_num = max(allnums) + 1 if allnums else 1
784.     fig_label = ''
785.     if num is None:
786.         num = next_num
787.     elif isinstance(num, str):
788.         fig_label = num
789.         all_labels = get_figlabels()
790.         if fig_label not in all_labels:
791.             if fig_label == 'all':
792.                 _api.warn_external("close('all') closes all existing figures.")
793.             num = next_num
794.         else:
795.             inum = all_labels.index(fig_label)
796.             num = allnums[inum]
797.     else:
798.         num = int(num)  # crude validation of num argument
799. 
800.     manager = _pylab_helpers.Gcf.get_fig_manager(num)
801.     if manager is None:
802.         max_open_warning = rcParams['figure.max_open_warning']
803.         if len(allnums) == max_open_warning >= 1:
804.             _api.warn_external(
805.                 f"More than {max_open_warning} figures have been opened. "
806.                 f"Figures created through the pyplot interface "
807.                 f"(`matplotlib.pyplot.figure`) are retained until explicitly "
808.                 f"closed and may consume too much memory. (To control this "
809.                 f"warning, see the rcParam `figure.max_open_warning`).",
810.                 RuntimeWarning)
811. 
812.         manager = new_figure_manager(
813.             num, figsize=figsize, dpi=dpi,
814.             facecolor=facecolor, edgecolor=edgecolor, frameon=frameon,
815.             FigureClass=FigureClass, **kwargs)
816.         fig = manager.canvas.figure
817.         if fig_label:
818.             fig.set_label(fig_label)
819. 
820.         _pylab_helpers.Gcf._set_new_active_manager(manager)
821. 
822.         # make sure backends (inline) that we don't ship that expect this
823.         # to be called in plotting commands to make the figure call show
824.         # still work.  There is probably a better way to do this in the
825.         # FigureManager base class.
826.         draw_if_interactive()
827. 
828.         if _REPL_DISPLAYHOOK is _ReplDisplayHook.PLAIN:
829.             fig.stale_callback = _auto_draw_if_interactive
830. 
831.     if clear:
832.         manager.canvas.figure.clear()
833. 
834.     return manager.canvas.figure


File: lib/matplotlib/pyplot.py
Line number range: 825 - 862
Content:
825.         # FigureManager base class.
826.         draw_if_interactive()
827. 
828.         if _REPL_DISPLAYHOOK is _ReplDisplayHook.PLAIN:
829.             fig.stale_callback = _auto_draw_if_interactive
830. 
831.     if clear:
832.         manager.canvas.figure.clear()
833. 
834.     return manager.canvas.figure
835. 
836. 
837. def _auto_draw_if_interactive(fig, val):
838.     """
839.     An internal helper function for making sure that auto-redrawing
840.     works as intended in the plain python repl.
841. 
842.     Parameters
843.     ----------
844.     fig : Figure
845.         A figure object which is assumed to be associated with a canvas
846.     """
847.     if (val and matplotlib.is_interactive()
848.             and not fig.canvas.is_saving()
849.             and not fig.canvas._is_idle_drawing):
850.         # Some artists can mark themselves as stale in the middle of drawing
851.         # (e.g. axes position & tick labels being computed at draw time), but
852.         # this shouldn't trigger a redraw because the current redraw will
853.         # already take them into account.
854.         with fig.canvas._idle_draw_cntx():
855.             fig.canvas.draw_idle()
856. 
857. 
858. def gcf():
859.     """
860.     Get the current figure.
861. 
862.     If there is currently no figure on the pyplot figure stack, a new one is


File: lib/matplotlib/pyplot.py
Line number range: 971 - 991
Content:
971.     should be only rarely needed, but there may be ways to modify the state of
972.     a figure without marking it as "stale".  Please report these cases as bugs.
973. 
974.     This is equivalent to calling ``fig.canvas.draw_idle()``, where ``fig`` is
975.     the current figure.
976.     """
977.     gcf().canvas.draw_idle()
978. 
979. 
980. @_copy_docstring_and_deprecators(Figure.savefig)
981. def savefig(*args, **kwargs):
982.     fig = gcf()
983.     res = fig.savefig(*args, **kwargs)
984.     fig.canvas.draw_idle()  # Need this if 'transparent=True', to reset colors.
985.     return res
986. 
987. 
988. ## Putting things in figures ##
989. 
990. 
991. def figlegend(*args, **kwargs):


File: lib/matplotlib/pyplot.py
Line number range: 1398 - 1413
Content:
1398.             # using the variable axs for multiple Axes
1399.             fig, axs = plt.subplots(2, 2)
1400. 
1401.             # using tuple unpacking for multiple Axes
1402.             fig, (ax1, ax2) = plt.subplots(1, 2)
1403.             fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2)
1404. 
1405.         The names ``ax`` and pluralized ``axs`` are preferred over ``axes``
1406.         because for the latter it's not clear if it refers to a single
1407.         `~.axes.Axes` instance or a collection of these.
1408. 
1409.     See Also
1410.     --------
1411.     .pyplot.figure
1412.     .pyplot.subplot
1413.     .pyplot.axes

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 20:25:57,401 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="The user explicitly asked for the source code of the `RcParams` class. This context provides the complete definition of the `RcParams` class, which is essential for understanding how Matplotlib's runtime configuration is handled.", relative_path='lib/matplotlib/__init__.py', start_line=606, end_line=726), ContextOutput(reasoning='The user explicitly asked for the source code of the `Gcf` class. This context provides the definition of the `Gcf` class, which manages figure managers in pyplot.', relative_path='lib/matplotlib/_pylab_helpers.py', start_line=17, end_line=85), ContextOutput(reasoning='The user explicitly asked for the source code of the `switch_backend` function. This context provides the complete definition of the `switch_backend` function, which is used to change the Matplotlib backend.', relative_path='lib/matplotlib/pyplot.py', start_line=209, end_line=281), ContextOutput(reasoning='The user explicitly asked for the source code of the `figure` function. This context provides the complete definition of the `figure` function, which is used to create and manage figures in pyplot.', relative_path='lib/matplotlib/pyplot.py', start_line=697, end_line=835)]
2025-12-20 20:25:57,404 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 4 contexts to memory for query: Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.
2025-12-20 20:25:57,405 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 20:25:57,405 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 20:25:57,405 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 4 new contexts to 0 existing contexts
2025-12-20 20:25:57,405 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 4 total contexts (removed 0 duplicates)
2025-12-20 20:25:57,406 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19214-DS.rst
|   |   |   |   ├── 19368-DS.rst
|   |   |   |   ├── 20426-JK.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   ├── 21026-DS.rst
|   |   |   |   ├── 21042-AL.rst
|   |   |   |   ├── 21238-AL.rst
|   |   |   |   ├── 21983-AL.rst
|   |   |   |   ├── 22013-AL.rst
|   |   |   |   ├── 22063-SR.rst
|   |   |   |   ├── 22204-AL.rst
|   |   |   |   ├── 22229-TAC.rst
|   |   |   |   ├── 22485-TH.rst
|   |   |   |   ├── 22567-IT.rst
|   |   |   |   ├── 22639-RA.rst
|   |   |   |   ├── 22691-JMK.rst
|   |   |   |   ├── 22745-JMK.rst
|   |   |   |   ├── 23031-AL.rst
|   |   |   |   ├── 23170-JMK.rst
|   |   |   |   ├── 23188-JMK.rst
|   |   |   |   └── 23270-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20071-AL.rst
|   |   |   |   ├── 20839-EP.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   ├── 21425-AL.rst
|   |   |   |   ├── 21584-AL.rst
|   |   |   |   ├── 21962-AL.rst
|   |   |   |   ├── 21965-AL.rst
|   |   |   |   ├── 21981-AL.rst
|   |   |   |   ├── 21982-AL.rst
|   |   |   |   ├── 21992-AL.rst
|   |   |   |   ├── 21995-AL.rst
|   |   |   |   ├── 22021-AL.rst
|   |   |   |   ├── 22025-AL.rst
|   |   |   |   ├── 22050-AL.rst
|   |   |   |   ├── 22051-AL.rst
|   |   |   |   ├── 22084-SS.rst
|   |   |   |   ├── 22097-AL.rst
|   |   |   |   ├── 22098-AL.rst
|   |   |   |   ├── 22123-TH.rst
|   |   |   |   ├── 22133-OG.rst
|   |   |   |   ├── 22134-OG.rst
|   |   |   |   ├── 22148-OG.rst
|   |   |   |   ├── 22167-EP.rst
|   |   |   |   ├── 22245-AL.rst
|   |   |   |   ├── 22268-OG.rst
|   |   |   |   ├── 22298-GL.rst
|   |   |   |   ├── 22317-AL.rst
|   |   |   |   ├── 22323-GL.rst
|   |   |   |   ├── 22345-JK.rst
|   |   |   |   ├── 22415-AL.rst
|   |   |   |   ├── 22418-AL.rst
|   |   |   |   ├── 22421-AL.rst
|   |   |   |   ├── 22422-AL.rst
|   |   |   |   ├── 22490-AL.rst
|   |   |   |   ├── 22503-AL.rst
|   |   |   |   ├── 22509-AL.rst
|   |   |   |   ├── 22539-AL.rst
|   |   |   |   ├── 22547-AL.rst
|   |   |   |   ├── 22554-AL.rst
|   |   |   |   ├── 22697-OG.rst
|   |   |   |   ├── 22725-AL.rst
|   |   |   |   ├── 22797-OG.rst
|   |   |   |   ├── 22813-GL.rst
|   |   |   |   ├── 22883-AL.rst
|   |   |   |   ├── 22885-AL.rst
|   |   |   |   ├── 23014-OG.rst
|   |   |   |   ├── 23045-OG.rst
|   |   |   |   ├── 23081-OG.rst
|   |   |   |   ├── 23166-ES.rst
|   |   |   |   ├── 23190-OG.rst
|   |   |   |   ├── 23232-TH.rst
|   |   |   |   ├── 23289-AL.rst
|   |   |   |   ├── 23302-TH.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 21415-AL.rst
|   |   |   |   ├── 22205-ES.rst
|   |   |   |   └── 22550-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 00001-DS.rst
|   |   |       ├── 20990-AL.rst
|   |   |       ├── 21395-AL.rst
|   |   |       ├── 21591-AL.rst
|   |   |       ├── 21980-CC.rst
|   |   |       ├── 22081-AL.rst
|   |   |       ├── 22107-OG.rst
|   |   |       ├── 22365-OG.rst
|   |   |       ├── 22465-AL.rst
|   |   |       ├── 22486-OG.rst
|   |   |       ├── 22514-OG.rst
|   |   |       ├── 22516-OG.rst
|   |   |       ├── 22738-JL.rst
|   |   |       ├── 22886-OG.rst
|   |   |       ├── 22952-TH.rst
|   |   |       ├── 23076-GL.rst
|   |   |       ├── 23077-GL.rst
|   |   |       ├── 23078-GL.rst
|   |   |       ├── 23079-GL.rst
|   |   |       ├── 23093-GL.rst
|   |   |       └── 23237-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   └── api_changes_3.5.2.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plot_focal_length.rst
|       |   ├── 3d_plot_roll_angle.rst
|       |   ├── README.rst
|       |   ├── asinh_scale.rst
|       |   ├── color_support_for_math_to_image.rst
|       |   ├── custom_cap_widths.rst
|       |   ├── double_quotes_matplolibrc.rst
|       |   ├── extending_MarkerStyle.rst
|       |   ├── inset_axes_improvements.rst
|       |   ├── layout_engine.rst
|       |   ├── list_font_names.rst
|       |   ├── marker_none.rst
|       |   ├── min_macos_version.rst
|       |   ├── modify_stairs_fill_edge_behaviour.rst
|       |   ├── no_broken_streamlines.rst
|       |   ├── polygon_selector_box.rst
|       |   ├── polygon_vert_setter.rst
|       |   ├── rectangle_patch_rotation.rst
|       |   ├── rename_ncol_keyword_in_legend.rst
|       |   ├── selector_improvement.rst
|       |   ├── snap_selector.rst
|       |   ├── striped_lines.rst
|       |   ├── url_active_areas_rotate.rst
|       |   ├── use_contourpy.rst
|       |   └── windows_arm64.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   └── whats_new_3.5.2.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.
Extra Requirements: 
Purpose: This information will allow me to trace the bug through the codebase, understand why creating a figure in `rc_context` causes issues, and confirm that the proposed patch correctly addresses the problem.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/__init__.py
Line number range: 606 - 726
Content:
606. class RcParams(MutableMapping, dict):
607.     """
608.     A dictionary object including validation.
609. 
610.     Validating functions are defined and associated with rc parameters in
611.     :mod:`matplotlib.rcsetup`.
612. 
613.     The list of rcParams is:
614. 
615.     %s
616. 
617.     See Also
618.     --------
619.     :ref:`customizing-with-matplotlibrc-files`
620.     """
621. 
622.     validate = rcsetup._validators
623. 
624.     # validate values on the way in
625.     def __init__(self, *args, **kwargs):
626.         self.update(*args, **kwargs)
627. 
628.     def __setitem__(self, key, val):
629.         try:
630.             if key in _deprecated_map:
631.                 version, alt_key, alt_val, inverse_alt = _deprecated_map[key]
632.                 _api.warn_deprecated(
633.                     version, name=key, obj_type="rcparam", alternative=alt_key)
634.                 key = alt_key
635.                 val = alt_val(val)
636.             elif key in _deprecated_remain_as_none and val is not None:
637.                 version, = _deprecated_remain_as_none[key]
638.                 _api.warn_deprecated(version, name=key, obj_type="rcparam")
639.             elif key in _deprecated_ignore_map:
640.                 version, alt_key = _deprecated_ignore_map[key]
641.                 _api.warn_deprecated(
642.                     version, name=key, obj_type="rcparam", alternative=alt_key)
643.                 return
644.             elif key == 'backend':
645.                 if val is rcsetup._auto_backend_sentinel:
646.                     if 'backend' in self:
647.                         return
648.             try:
649.                 cval = self.validate[key](val)
650.             except ValueError as ve:
651.                 raise ValueError(f"Key {key}: {ve}") from None
652.             dict.__setitem__(self, key, cval)
653.         except KeyError as err:
654.             raise KeyError(
655.                 f"{key} is not a valid rc parameter (see rcParams.keys() for "
656.                 f"a list of valid parameters)") from err
657. 
658.     def __getitem__(self, key):
659.         if key in _deprecated_map:
660.             version, alt_key, alt_val, inverse_alt = _deprecated_map[key]
661.             _api.warn_deprecated(
662.                 version, name=key, obj_type="rcparam", alternative=alt_key)
663.             return inverse_alt(dict.__getitem__(self, alt_key))
664. 
665.         elif key in _deprecated_ignore_map:
666.             version, alt_key = _deprecated_ignore_map[key]
667.             _api.warn_deprecated(
668.                 version, name=key, obj_type="rcparam", alternative=alt_key)
669.             return dict.__getitem__(self, alt_key) if alt_key else None
670. 
671.         # In theory, this should only ever be used after the global rcParams
672.         # has been set up, but better be safe e.g. in presence of breakpoints.
673.         elif key == "backend" and self is globals().get("rcParams"):
674.             val = dict.__getitem__(self, key)
675.             if val is rcsetup._auto_backend_sentinel:
676.                 from matplotlib import pyplot as plt
677.                 plt.switch_backend(rcsetup._auto_backend_sentinel)
678. 
679.         return dict.__getitem__(self, key)
680. 
681.     def _get_backend_or_none(self):
682.         """Get the requested backend, if any, without triggering resolution."""
683.         backend = dict.__getitem__(self, "backend")
684.         return None if backend is rcsetup._auto_backend_sentinel else backend
685. 
686.     def __repr__(self):
687.         class_name = self.__class__.__name__
688.         indent = len(class_name) + 1
689.         with _api.suppress_matplotlib_deprecation_warning():
690.             repr_split = pprint.pformat(dict(self), indent=1,
691.                                         width=80 - indent).split('\n')
692.         repr_indented = ('\n' + ' ' * indent).join(repr_split)
693.         return '{}({})'.format(class_name, repr_indented)
694. 
695.     def __str__(self):
696.         return '\n'.join(map('{0[0]}: {0[1]}'.format, sorted(self.items())))
697. 
698.     def __iter__(self):
699.         """Yield sorted list of keys."""
700.         with _api.suppress_matplotlib_deprecation_warning():
701.             yield from sorted(dict.__iter__(self))
702. 
703.     def __len__(self):
704.         return dict.__len__(self)
705. 
706.     def find_all(self, pattern):
707.         """
708.         Return the subset of this RcParams dictionary whose keys match,
709.         using :func:`re.search`, the given ``pattern``.
710. 
711.         .. note::
712. 
713.             Changes to the returned dictionary are *not* propagated to
714.             the parent RcParams dictionary.
715. 
716.         """
717.         pattern_re = re.compile(pattern)
718.         return RcParams((key, value)
719.                         for key, value in self.items()
720.                         if pattern_re.search(key))
721. 
722.     def copy(self):
723.         rccopy = RcParams()
724.         for k in self:  # Skip deprecations and revalidation.
725.             dict.__setitem__(rccopy, k, dict.__getitem__(self, k))
726.         return rccopy


File: lib/matplotlib/_pylab_helpers.py
Line number range: 17 - 85
Content:
17.     pyplot keeps track of figure managers using an identifier, the "figure
18.     number" or "manager number" (which can actually be any hashable value);
19.     this number is available as the :attr:`number` attribute of the manager.
20. 
21.     This class is never instantiated; it consists of an `OrderedDict` mapping
22.     figure/manager numbers to managers, and a set of class methods that
23.     manipulate this `OrderedDict`.
24. 
25.     Attributes
26.     ----------
27.     figs : OrderedDict
28.         `OrderedDict` mapping numbers to managers; the active manager is at the
29.         end.
30.     """
31. 
32.     figs = OrderedDict()
33. 
34.     @classmethod
35.     def get_fig_manager(cls, num):
36.         """
37.         If manager number *num* exists, make it the active one and return it;
38.         otherwise return *None*.
39.         """
40.         manager = cls.figs.get(num, None)
41.         if manager is not None:
42.             cls.set_active(manager)
43.         return manager
44. 
45.     @classmethod
46.     def destroy(cls, num):
47.         """
48.         Destroy manager *num* -- either a manager instance or a manager number.
49. 
50.         In the interactive backends, this is bound to the window "destroy" and
51.         "delete" events.
52. 
53.         It is recommended to pass a manager instance, to avoid confusion when
54.         two managers share the same number.
55.         """
56.         if all(hasattr(num, attr) for attr in ["num", "destroy"]):
57.             manager = num
58.             if cls.figs.get(manager.num) is manager:
59.                 cls.figs.pop(manager.num)
60.         else:
61.             try:
62.                 manager = cls.figs.pop(num)
63.             except KeyError:
64.                 return
65.         if hasattr(manager, "_cidgcf"):
66.             manager.canvas.mpl_disconnect(manager._cidgcf)
67.         manager.destroy()
68.         del manager, num
69.         # Full cyclic garbage collection may be too expensive to do on every
70.         # figure destruction, so we collect only the youngest two generations.
71.         # see: https://github.com/matplotlib/matplotlib/pull/3045
72.         gc.collect(1)
73. 
74.     @classmethod
75.     def destroy_fig(cls, fig):
76.         """Destroy figure *fig*."""
77.         num = next((manager.num for manager in cls.figs.values()
78.                     if manager.canvas.figure == fig), None)
79.         if num is not None:
80.             cls.destroy(num)
81. 
82.     @classmethod
83.     def destroy_all(cls):
84.         """Destroy all figures."""
85.         # Reimport gc in case the module globals have already been removed


File: lib/matplotlib/pyplot.py
Line number range: 209 - 281
Content:
209. def switch_backend(newbackend):
210.     """
211.     Close all open figures and set the Matplotlib backend.
212. 
213.     The argument is case-insensitive.  Switching to an interactive backend is
214.     possible only if no event loop for another interactive backend has started.
215.     Switching to and from non-interactive backends is always possible.
216. 
217.     Parameters
218.     ----------
219.     newbackend : str
220.         The name of the backend to use.
221.     """
222.     global _backend_mod
223.     # make sure the init is pulled up so we can assign to it later
224.     import matplotlib.backends
225.     close("all")
226. 
227.     if newbackend is rcsetup._auto_backend_sentinel:
228.         current_framework = cbook._get_running_interactive_framework()
229.         mapping = {'qt': 'qtagg',
230.                    'gtk3': 'gtk3agg',
231.                    'gtk4': 'gtk4agg',
232.                    'wx': 'wxagg',
233.                    'tk': 'tkagg',
234.                    'macosx': 'macosx',
235.                    'headless': 'agg'}
236. 
237.         best_guess = mapping.get(current_framework, None)
238.         if best_guess is not None:
239.             candidates = [best_guess]
240.         else:
241.             candidates = []
242.         candidates += [
243.             "macosx", "qtagg", "gtk4agg", "gtk3agg", "tkagg", "wxagg"]
244. 
245.         # Don't try to fallback on the cairo-based backends as they each have
246.         # an additional dependency (pycairo) over the agg-based backend, and
247.         # are of worse quality.
248.         for candidate in candidates:
249.             try:
250.                 switch_backend(candidate)
251.             except ImportError:
252.                 continue
253.             else:
254.                 rcParamsOrig['backend'] = candidate
255.                 return
256.         else:
257.             # Switching to Agg should always succeed; if it doesn't, let the
258.             # exception propagate out.
259.             switch_backend("agg")
260.             rcParamsOrig["backend"] = "agg"
261.             return
262. 
263.     backend_mod = importlib.import_module(
264.         cbook._backend_module_name(newbackend))
265.     canvas_class = backend_mod.FigureCanvas
266. 
267.     required_framework = _get_required_interactive_framework(backend_mod)
268.     if required_framework is not None:
269.         current_framework = cbook._get_running_interactive_framework()
270.         if (current_framework and required_framework
271.                 and current_framework != required_framework):
272.             raise ImportError(
273.                 "Cannot load backend {!r} which requires the {!r} interactive "
274.                 "framework, as {!r} is currently running".format(
275.                     newbackend, required_framework, current_framework))
276. 
277.     # Load the new_figure_manager(), draw_if_interactive(), and show()
278.     # functions from the backend.
279. 
280.     # Classically, backends can directly export these functions.  This should
281.     # keep working for backcompat.


File: lib/matplotlib/pyplot.py
Line number range: 697 - 835
Content:
697. def figure(num=None,  # autoincrement if None, else integer from 1-N
698.            figsize=None,  # defaults to rc figure.figsize
699.            dpi=None,  # defaults to rc figure.dpi
700.            facecolor=None,  # defaults to rc figure.facecolor
701.            edgecolor=None,  # defaults to rc figure.edgecolor
702.            frameon=True,
703.            FigureClass=Figure,
704.            clear=False,
705.            **kwargs
706.            ):
707.     """
708.     Create a new figure, or activate an existing figure.
709. 
710.     Parameters
711.     ----------
712.     num : int or str or `.Figure` or `.SubFigure`, optional
713.         A unique identifier for the figure.
714. 
715.         If a figure with that identifier already exists, this figure is made
716.         active and returned. An integer refers to the ``Figure.number``
717.         attribute, a string refers to the figure label.
718. 
719.         If there is no figure with the identifier or *num* is not given, a new
720.         figure is created, made active and returned.  If *num* is an int, it
721.         will be used for the ``Figure.number`` attribute, otherwise, an
722.         auto-generated integer value is used (starting at 1 and incremented
723.         for each new figure). If *num* is a string, the figure label and the
724.         window title is set to this value.  If num is a ``SubFigure``, its
725.         parent ``Figure`` is activated.
726. 
727.     figsize : (float, float), default: :rc:`figure.figsize`
728.         Width, height in inches.
729. 
730.     dpi : float, default: :rc:`figure.dpi`
731.         The resolution of the figure in dots-per-inch.
732. 
733.     facecolor : color, default: :rc:`figure.facecolor`
734.         The background color.
735. 
736.     edgecolor : color, default: :rc:`figure.edgecolor`
737.         The border color.
738. 
739.     frameon : bool, default: True
740.         If False, suppress drawing the figure frame.
741. 
742.     FigureClass : subclass of `~matplotlib.figure.Figure`
743.         If set, an instance of this subclass will be created, rather than a
744.         plain `.Figure`.
745. 
746.     clear : bool, default: False
747.         If True and the figure already exists, then it is cleared.
748. 
749.     layout : {'constrained', 'tight', `.LayoutEngine`, None}, default: None
750.         The layout mechanism for positioning of plot elements to avoid
751.         overlapping Axes decorations (labels, ticks, etc). Note that layout
752.         managers can measurably slow down figure display. Defaults to *None*
753.         (but see the documentation of the `.Figure` constructor regarding the
754.         interaction with rcParams).
755. 
756.     **kwargs
757.         Additional keyword arguments are passed to the `.Figure` constructor.
758. 
759.     Returns
760.     -------
761.     `~matplotlib.figure.Figure`
762. 
763.     Notes
764.     -----
765.     Newly created figures will be passed to the
766.     `~.backend_template.new_figure_manager` function provided by the current
767.     backend, which will install a canvas and a manager on the figure.
768. 
769.     If you are creating many figures, make sure you explicitly call
770.     `.pyplot.close` on the figures you are not using, because this will
771.     enable pyplot to properly clean up the memory.
772. 
773.     `~matplotlib.rcParams` defines the default values, which can be modified
774.     in the matplotlibrc file.
775.     """
776.     if isinstance(num, FigureBase):
777.         if num.canvas.manager is None:
778.             raise ValueError("The passed figure is not managed by pyplot")
779.         _pylab_helpers.Gcf.set_active(num.canvas.manager)
780.         return num.figure
781. 
782.     allnums = get_fignums()
783.     next_num = max(allnums) + 1 if allnums else 1
784.     fig_label = ''
785.     if num is None:
786.         num = next_num
787.     elif isinstance(num, str):
788.         fig_label = num
789.         all_labels = get_figlabels()
790.         if fig_label not in all_labels:
791.             if fig_label == 'all':
792.                 _api.warn_external("close('all') closes all existing figures.")
793.             num = next_num
794.         else:
795.             inum = all_labels.index(fig_label)
796.             num = allnums[inum]
797.     else:
798.         num = int(num)  # crude validation of num argument
799. 
800.     manager = _pylab_helpers.Gcf.get_fig_manager(num)
801.     if manager is None:
802.         max_open_warning = rcParams['figure.max_open_warning']
803.         if len(allnums) == max_open_warning >= 1:
804.             _api.warn_external(
805.                 f"More than {max_open_warning} figures have been opened. "
806.                 f"Figures created through the pyplot interface "
807.                 f"(`matplotlib.pyplot.figure`) are retained until explicitly "
808.                 f"closed and may consume too much memory. (To control this "
809.                 f"warning, see the rcParam `figure.max_open_warning`).",
810.                 RuntimeWarning)
811. 
812.         manager = new_figure_manager(
813.             num, figsize=figsize, dpi=dpi,
814.             facecolor=facecolor, edgecolor=edgecolor, frameon=frameon,
815.             FigureClass=FigureClass, **kwargs)
816.         fig = manager.canvas.figure
817.         if fig_label:
818.             fig.set_label(fig_label)
819. 
820.         _pylab_helpers.Gcf._set_new_active_manager(manager)
821. 
822.         # make sure backends (inline) that we don't ship that expect this
823.         # to be called in plotting commands to make the figure call show
824.         # still work.  There is probably a better way to do this in the
825.         # FigureManager base class.
826.         draw_if_interactive()
827. 
828.         if _REPL_DISPLAYHOOK is _ReplDisplayHook.PLAIN:
829.             fig.stale_callback = _auto_draw_if_interactive
830. 
831.     if clear:
832.         manager.canvas.figure.clear()
833. 
834.     return manager.canvas.figure
835. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 20:26:24,099 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user\'s bug report indicates that `get_backend()` is the function that triggers the clearing of figures, but its implementation is missing. The bug only occurs when a figure is created inside an `rc_context`. The implementation of `rc_context` is also missing, but the provided patch suggests it\'s central to the issue. The backend resolution logic depends on `rcsetup._auto_backend_sentinel`, whose definition in `rcsetup.py` is also missing. I hypothesize that `get_backend()` accesses `rcParams[\'backend\']`, which triggers `pyplot.switch_backend` because the backend was reset to an "auto" sentinel when exiting `rc_context`. This call to `switch_backend` closes all figures. The missing code is needed to verify this hypothesis.' query='Please provide the source code for the functions `get_backend` and `rc_context` from `lib/matplotlib/__init__.py`, and the full content of `lib/matplotlib/rcsetup.py`.' extra_requirements='' purpose='This will allow me to trace the backend resolution mechanism and understand how `rc_context` interacts with it, which is the core of the bug.'
2025-12-20 20:26:24,101 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the source code for the functions `get_backend` and `rc_context` from `lib/matplotlib/__init__.py`, and the full content of `lib/matplotlib/rcsetup.py`.
2025-12-20 20:26:24,101 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 20:26:24,102 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 20:26:24,102 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 20:26:24,102 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the source code for the functions `get_backend` and `rc_context` from `lib/matplotlib/__init__.py`, and the full content of `lib/matplotlib/rcsetup.py`.
Purpose: This will allow me to trace the backend resolution mechanism and understand how `rc_context` interacts with it, which is the core of the bug.
2025-12-20 20:26:27,854 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I will first retrieve the definitions of the `get_backend` and `rc_context` functions from `lib/matplotlib/__init__.py`. Then, I will read the entire content of `lib/matplotlib/rcsetup.py` to provide the necessary context for understanding the backend resolution and its interaction with the rc parameters.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/__init__.py", "type": "function_definition"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2159, 'candidates_token_count': 100, 'total_token_count': 2520, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2159}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 100}], 'thoughts_token_count': 261, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.19799600601196288, 'model_name': 'gemini-2.5-pro'} id='run--8ea5a119-3ce0-4b74-8c7d-3d27f0162d1d-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/__init__.py', 'type': 'function_definition'}, 'id': '548c574b-1efa-4acf-8261-e2f79c285cb6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2159, 'output_tokens': 100, 'total_tokens': 2520, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 261}}
2025-12-20 20:26:30,196 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the `get_backend` function within `lib/matplotlib/__init__.py`. My next step is to find the `rc_context` function in the same file and then read the entire content of `lib/matplotlib/rcsetup.py` to get a complete picture of the backend and rc parameter handling.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/rcsetup.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3029, 'candidates_token_count': 122, 'total_token_count': 3223, 'cached_content_token_count': 1544, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3029}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1544}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 122}], 'thoughts_token_count': 72}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11922153879384526, 'model_name': 'gemini-2.5-pro'} id='run--e084a927-6cdb-4b7e-bd03-2a96637518fe-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'rc_context', 'relative_path': 'lib/matplotlib/__init__.py'}, 'id': '749d153d-eae0-44b9-9c9f-10fc84bf15c8', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/rcsetup.py'}, 'id': '7382efb5-02b0-4b0f-a883-666f0abbe0b6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3029, 'output_tokens': 122, 'total_tokens': 3223, 'input_token_details': {'cache_read': 1544}, 'output_token_details': {'reasoning': 72}}
2025-12-20 20:26:36,170 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the source code for the `get_backend` and `rc_context` functions from `lib/matplotlib/__init__.py`, as well as the complete content of `lib/matplotlib/rcsetup.py`. This information should provide a clear view of the backend resolution mechanism and how `rc_context` interacts with it, which will be helpful in addressing the bug. I have gathered all the necessary context for you to proceed with your analysis.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10632, 'candidates_token_count': 95, 'total_token_count': 11314, 'cached_content_token_count': 1808, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10632}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1808}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 95}], 'thoughts_token_count': 587}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6049529226202713, 'model_name': 'gemini-2.5-pro'} id='run--fc66dc84-65d6-4d9a-bb13-9deeab51d46b-0' usage_metadata={'input_tokens': 10632, 'output_tokens': 95, 'total_tokens': 11314, 'input_token_details': {'cache_read': 1808}, 'output_token_details': {'reasoning': 587}}
2025-12-20 20:26:36,171 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the source code for the functions `get_backend` and `rc_context` from `lib/matplotlib/__init__.py`, and the full content of `lib/matplotlib/rcsetup.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This will allow me to trace the backend resolution mechanism and understand how `rc_context` interacts with it, which is the core of the bug.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/__init__.py
Line number range: 729 - 731
Content:
def rc_params(fail_on_error=False):
    """Construct a `RcParams` instance from the default Matplotlib rc file."""
    return rc_params_from_file(matplotlib_fname(), fail_on_error)


File: lib/matplotlib/__init__.py
Line number range: 1057 - 1098
Content:
@contextlib.contextmanager
def rc_context(rc=None, fname=None):
    """
    Return a context manager for temporarily changing rcParams.

    Parameters
    ----------
    rc : dict
        The rcParams to temporarily set.
    fname : str or path-like
        A file with Matplotlib rc settings. If both *fname* and *rc* are given,
        settings from *rc* take precedence.

    See Also
    --------
    :ref:`customizing-with-matplotlibrc-files`

    Examples
    --------
    Passing explicit values via a dict::

        with mpl.rc_context({'interactive': False}):
            fig, ax = plt.subplots()
            ax.plot(range(3), range(3))
            fig.savefig('example.png')
            plt.close(fig)

    Loading settings from a file::

         with mpl.rc_context(fname='print.rc'):
             plt.plot(x, y)  # uses 'print.rc'

    """
    orig = rcParams.copy()
    try:
        if fname:
            rc_file(fname)
        if rc:
            rcParams.update(rc)
        yield
    finally:
        dict.update(rcParams, orig)  # Revert to the original rcs.


File: lib/matplotlib/__init__.py
Line number range: 1170 - 1178
Content:
def get_backend():
    """
    Return the name of the current backend.

    See Also
    --------
    matplotlib.use
    """
    return rcParams['backend']


File: lib/matplotlib/__init__.py
Line number range: 1181 - 1185
Content:
def interactive(b):
    """
    Set whether to redraw after every plotting command (e.g. `.pyplot.xlabel`).
    """
    rcParams['interactive'] = b


File: lib/matplotlib/__init__.py
Line number range: 1188 - 1197
Content:
def is_interactive():
    """
    Return whether to redraw after every plotting command.

    .. note::

        This function is only intended for use in backends. End users should
        use `.pyplot.isinteractive` instead.
    """
    return rcParams['interactive']


File: lib/matplotlib/__init__.py
Line number range: 1292 - 1298
Content:
def _label_from_arg(y, default_name):
    try:
        return y.name
    except AttributeError:
        if isinstance(default_name, str):
            return default_name
    return None


File: lib/matplotlib/rcsetup.py
Line number range: 1 - 500
Content:
1. """
2. The rcsetup module contains the validation code for customization using
3. Matplotlib's rc settings.
4. 
5. Each rc setting is assigned a function used to validate any attempted changes
6. to that setting.  The validation functions are defined in the rcsetup module,
7. and are used to construct the rcParams global object which stores the settings
8. and is referenced throughout Matplotlib.
9. 
10. The default values of the rc settings are set in the default matplotlibrc file.
11. Any additions or deletions to the parameter set listed here should also be
12. propagated to the :file:`matplotlibrc.template` in Matplotlib's root source
13. directory.
14. """
15. 
16. import ast
17. from functools import lru_cache, reduce
18. from numbers import Number
19. import operator
20. import os
21. import re
22. 
23. import numpy as np
24. 
25. from matplotlib import _api, cbook
26. from matplotlib.cbook import ls_mapper
27. from matplotlib.colors import Colormap, is_color_like
28. from matplotlib._fontconfig_pattern import parse_fontconfig_pattern
29. from matplotlib._enums import JoinStyle, CapStyle
30. 
31. # Don't let the original cycler collide with our validating cycler
32. from cycler import Cycler, cycler as ccycler
33. 
34. 
35. # The capitalized forms are needed for ipython at present; this may
36. # change for later versions.
37. interactive_bk = [
38.     'GTK3Agg', 'GTK3Cairo', 'GTK4Agg', 'GTK4Cairo',
39.     'MacOSX',
40.     'nbAgg',
41.     'QtAgg', 'QtCairo', 'Qt5Agg', 'Qt5Cairo',
42.     'TkAgg', 'TkCairo',
43.     'WebAgg',
44.     'WX', 'WXAgg', 'WXCairo',
45. ]
46. non_interactive_bk = ['agg', 'cairo',
47.                       'pdf', 'pgf', 'ps', 'svg', 'template']
48. all_backends = interactive_bk + non_interactive_bk
49. 
50. 
51. class ValidateInStrings:
52.     def __init__(self, key, valid, ignorecase=False, *,
53.                  _deprecated_since=None):
54.         """*valid* is a list of legal strings."""
55.         self.key = key
56.         self.ignorecase = ignorecase
57.         self._deprecated_since = _deprecated_since
58. 
59.         def func(s):
60.             if ignorecase:
61.                 return s.lower()
62.             else:
63.                 return s
64.         self.valid = {func(k): k for k in valid}
65. 
66.     def __call__(self, s):
67.         if self._deprecated_since:
68.             name, = (k for k, v in globals().items() if v is self)
69.             _api.warn_deprecated(
70.                 self._deprecated_since, name=name, obj_type="function")
71.         if self.ignorecase:
72.             s = s.lower()
73.         if s in self.valid:
74.             return self.valid[s]
75.         msg = (f"{s!r} is not a valid value for {self.key}; supported values "
76.                f"are {[*self.valid.values()]}")
77.         if (isinstance(s, str)
78.                 and (s.startswith('"') and s.endswith('"')
79.                      or s.startswith("'") and s.endswith("'"))
80.                 and s[1:-1] in self.valid):
81.             msg += "; remove quotes surrounding your string"
82.         raise ValueError(msg)
83. 
84. 
85. @lru_cache()
86. def _listify_validator(scalar_validator, allow_stringlist=False, *,
87.                        n=None, doc=None):
88.     def f(s):
89.         if isinstance(s, str):
90.             try:
91.                 val = [scalar_validator(v.strip()) for v in s.split(',')
92.                        if v.strip()]
93.             except Exception:
94.                 if allow_stringlist:
95.                     # Sometimes, a list of colors might be a single string
96.                     # of single-letter colornames. So give that a shot.
97.                     val = [scalar_validator(v.strip()) for v in s if v.strip()]
98.                 else:
99.                     raise
100.         # Allow any ordered sequence type -- generators, np.ndarray, pd.Series
101.         # -- but not sets, whose iteration order is non-deterministic.
102.         elif np.iterable(s) and not isinstance(s, (set, frozenset)):
103.             # The condition on this list comprehension will preserve the
104.             # behavior of filtering out any empty strings (behavior was
105.             # from the original validate_stringlist()), while allowing
106.             # any non-string/text scalar values such as numbers and arrays.
107.             val = [scalar_validator(v) for v in s
108.                    if not isinstance(v, str) or v]
109.         else:
110.             raise ValueError(
111.                 f"Expected str or other non-set iterable, but got {s}")
112.         if n is not None and len(val) != n:
113.             raise ValueError(
114.                 f"Expected {n} values, but there are {len(val)} values in {s}")
115.         return val
116. 
117.     try:
118.         f.__name__ = "{}list".format(scalar_validator.__name__)
119.     except AttributeError:  # class instance.
120.         f.__name__ = "{}List".format(type(scalar_validator).__name__)
121.     f.__qualname__ = f.__qualname__.rsplit(".", 1)[0] + "." + f.__name__
122.     f.__doc__ = doc if doc is not None else scalar_validator.__doc__
123.     return f
124. 
125. 
126. def validate_any(s):
127.     return s
128. validate_anylist = _listify_validator(validate_any)
129. 
130. 
131. def _validate_date(s):
132.     try:
133.         np.datetime64(s)
134.         return s
135.     except ValueError:
136.         raise ValueError(
137.             f'{s!r} should be a string that can be parsed by numpy.datetime64')
138. 
139. 
140. def validate_bool(b):
141.     """Convert b to ``bool`` or raise."""
142.     if isinstance(b, str):
143.         b = b.lower()
144.     if b in ('t', 'y', 'yes', 'on', 'true', '1', 1, True):
145.         return True
146.     elif b in ('f', 'n', 'no', 'off', 'false', '0', 0, False):
147.         return False
148.     else:
149.         raise ValueError(f'Cannot convert {b!r} to bool')
150. 
151. 
152. def validate_axisbelow(s):
153.     try:
154.         return validate_bool(s)
155.     except ValueError:
156.         if isinstance(s, str):
157.             if s == 'line':
158.                 return 'line'
159.     raise ValueError(f'{s!r} cannot be interpreted as'
160.                      ' True, False, or "line"')
161. 
162. 
163. def validate_dpi(s):
164.     """Confirm s is string 'figure' or convert s to float or raise."""
165.     if s == 'figure':
166.         return s
167.     try:
168.         return float(s)
169.     except ValueError as e:
170.         raise ValueError(f'{s!r} is not string "figure" and '
171.                          f'could not convert {s!r} to float') from e
172. 
173. 
174. def _make_type_validator(cls, *, allow_none=False):
175.     """
176.     Return a validator that converts inputs to *cls* or raises (and possibly
177.     allows ``None`` as well).
178.     """
179. 
180.     def validator(s):
181.         if (allow_none and
182.                 (s is None or isinstance(s, str) and s.lower() == "none")):
183.             return None
184.         if cls is str and not isinstance(s, str):
185.             _api.warn_deprecated(
186.                 "3.5", message="Support for setting an rcParam that expects a "
187.                 "str value to a non-str value is deprecated since %(since)s "
188.                 "and support will be removed %(removal)s.")
189.         try:
190.             return cls(s)
191.         except (TypeError, ValueError) as e:
192.             raise ValueError(
193.                 f'Could not convert {s!r} to {cls.__name__}') from e
194. 
195.     validator.__name__ = f"validate_{cls.__name__}"
196.     if allow_none:
197.         validator.__name__ += "_or_None"
198.     validator.__qualname__ = (
199.         validator.__qualname__.rsplit(".", 1)[0] + "." + validator.__name__)
200.     return validator
201. 
202. 
203. validate_string = _make_type_validator(str)
204. validate_string_or_None = _make_type_validator(str, allow_none=True)
205. validate_stringlist = _listify_validator(
206.     validate_string, doc='return a list of strings')
207. validate_int = _make_type_validator(int)
208. validate_int_or_None = _make_type_validator(int, allow_none=True)
209. validate_float = _make_type_validator(float)
210. validate_float_or_None = _make_type_validator(float, allow_none=True)
211. validate_floatlist = _listify_validator(
212.     validate_float, doc='return a list of floats')
213. 
214. 
215. def _validate_pathlike(s):
216.     if isinstance(s, (str, os.PathLike)):
217.         # Store value as str because savefig.directory needs to distinguish
218.         # between "" (cwd) and "." (cwd, but gets updated by user selections).
219.         return os.fsdecode(s)
220.     else:
221.         return validate_string(s)  # Emit deprecation warning.
222. 
223. 
224. def validate_fonttype(s):
225.     """
226.     Confirm that this is a Postscript or PDF font type that we know how to
227.     convert to.
228.     """
229.     fonttypes = {'type3':    3,
230.                  'truetype': 42}
231.     try:
232.         fonttype = validate_int(s)
233.     except ValueError:
234.         try:
235.             return fonttypes[s.lower()]
236.         except KeyError as e:
237.             raise ValueError('Supported Postscript/PDF font types are %s'
238.                              % list(fonttypes)) from e
239.     else:
240.         if fonttype not in fonttypes.values():
241.             raise ValueError(
242.                 'Supported Postscript/PDF font types are %s' %
243.                 list(fonttypes.values()))
244.         return fonttype
245. 
246. 
247. _validate_standard_backends = ValidateInStrings(
248.     'backend', all_backends, ignorecase=True)
249. _auto_backend_sentinel = object()
250. 
251. 
252. def validate_backend(s):
253.     backend = (
254.         s if s is _auto_backend_sentinel or s.startswith("module://")
255.         else _validate_standard_backends(s))
256.     return backend
257. 
258. 
259. def _validate_toolbar(s):
260.     s = ValidateInStrings(
261.         'toolbar', ['None', 'toolbar2', 'toolmanager'], ignorecase=True)(s)
262.     if s == 'toolmanager':
263.         _api.warn_external(
264.             "Treat the new Tool classes introduced in v1.5 as experimental "
265.             "for now; the API and rcParam may change in future versions.")
266.     return s
267. 
268. 
269. def validate_color_or_inherit(s):
270.     """Return a valid color arg."""
271.     if cbook._str_equal(s, 'inherit'):
272.         return s
273.     return validate_color(s)
274. 
275. 
276. def validate_color_or_auto(s):
277.     if cbook._str_equal(s, 'auto'):
278.         return s
279.     return validate_color(s)
280. 
281. 
282. def validate_color_for_prop_cycle(s):
283.     # N-th color cycle syntax can't go into the color cycle.
284.     if isinstance(s, str) and re.match("^C[0-9]$", s):
285.         raise ValueError(f"Cannot put cycle reference ({s!r}) in prop_cycler")
286.     return validate_color(s)
287. 
288. 
289. def _validate_color_or_linecolor(s):
290.     if cbook._str_equal(s, 'linecolor'):
291.         return s
292.     elif cbook._str_equal(s, 'mfc') or cbook._str_equal(s, 'markerfacecolor'):
293.         return 'markerfacecolor'
294.     elif cbook._str_equal(s, 'mec') or cbook._str_equal(s, 'markeredgecolor'):
295.         return 'markeredgecolor'
296.     elif s is None:
297.         return None
298.     elif isinstance(s, str) and len(s) == 6 or len(s) == 8:
299.         stmp = '#' + s
300.         if is_color_like(stmp):
301.             return stmp
302.         if s.lower() == 'none':
303.             return None
304.     elif is_color_like(s):
305.         return s
306. 
307.     raise ValueError(f'{s!r} does not look like a color arg')
308. 
309. 
310. def validate_color(s):
311.     """Return a valid color arg."""
312.     if isinstance(s, str):
313.         if s.lower() == 'none':
314.             return 'none'
315.         if len(s) == 6 or len(s) == 8:
316.             stmp = '#' + s
317.             if is_color_like(stmp):
318.                 return stmp
319. 
320.     if is_color_like(s):
321.         return s
322. 
323.     # If it is still valid, it must be a tuple (as a string from matplotlibrc).
324.     try:
325.         color = ast.literal_eval(s)
326.     except (SyntaxError, ValueError):
327.         pass
328.     else:
329.         if is_color_like(color):
330.             return color
331. 
332.     raise ValueError(f'{s!r} does not look like a color arg')
333. 
334. 
335. validate_colorlist = _listify_validator(
336.     validate_color, allow_stringlist=True, doc='return a list of colorspecs')
337. 
338. 
339. def _validate_cmap(s):
340.     _api.check_isinstance((str, Colormap), cmap=s)
341.     return s
342. 
343. 
344. def validate_aspect(s):
345.     if s in ('auto', 'equal'):
346.         return s
347.     try:
348.         return float(s)
349.     except ValueError as e:
350.         raise ValueError('not a valid aspect specification') from e
351. 
352. 
353. def validate_fontsize_None(s):
354.     if s is None or s == 'None':
355.         return None
356.     else:
357.         return validate_fontsize(s)
358. 
359. 
360. def validate_fontsize(s):
361.     fontsizes = ['xx-small', 'x-small', 'small', 'medium', 'large',
362.                  'x-large', 'xx-large', 'smaller', 'larger']
363.     if isinstance(s, str):
364.         s = s.lower()
365.     if s in fontsizes:
366.         return s
367.     try:
368.         return float(s)
369.     except ValueError as e:
370.         raise ValueError("%s is not a valid font size. Valid font sizes "
371.                          "are %s." % (s, ", ".join(fontsizes))) from e
372. 
373. 
374. validate_fontsizelist = _listify_validator(validate_fontsize)
375. 
376. 
377. def validate_fontweight(s):
378.     weights = [
379.         'ultralight', 'light', 'normal', 'regular', 'book', 'medium', 'roman',
380.         'semibold', 'demibold', 'demi', 'bold', 'heavy', 'extra bold', 'black']
381.     # Note: Historically, weights have been case-sensitive in Matplotlib
382.     if s in weights:
383.         return s
384.     try:
385.         return int(s)
386.     except (ValueError, TypeError) as e:
387.         raise ValueError(f'{s} is not a valid font weight.') from e
388. 
389. 
390. def validate_fontstretch(s):
391.     stretchvalues = [
392.         'ultra-condensed', 'extra-condensed', 'condensed', 'semi-condensed',
393.         'normal', 'semi-expanded', 'expanded', 'extra-expanded',
394.         'ultra-expanded']
395.     # Note: Historically, stretchvalues have been case-sensitive in Matplotlib
396.     if s in stretchvalues:
397.         return s
398.     try:
399.         return int(s)
400.     except (ValueError, TypeError) as e:
401.         raise ValueError(f'{s} is not a valid font stretch.') from e
402. 
403. 
404. def validate_font_properties(s):
405.     parse_fontconfig_pattern(s)
406.     return s
407. 
408. 
409. def _validate_mathtext_fallback(s):
410.     _fallback_fonts = ['cm', 'stix', 'stixsans']
411.     if isinstance(s, str):
412.         s = s.lower()
413.     if s is None or s == 'none':
414.         return None
415.     elif s.lower() in _fallback_fonts:
416.         return s
417.     else:
418.         raise ValueError(
419.             f"{s} is not a valid fallback font name. Valid fallback font "
420.             f"names are {','.join(_fallback_fonts)}. Passing 'None' will turn "
421.             "fallback off.")
422. 
423. 
424. def validate_whiskers(s):
425.     try:
426.         return _listify_validator(validate_float, n=2)(s)
427.     except (TypeError, ValueError):
428.         try:
429.             return float(s)
430.         except ValueError as e:
431.             raise ValueError("Not a valid whisker value [float, "
432.                              "(float, float)]") from e
433. 
434. 
435. def validate_ps_distiller(s):
436.     if isinstance(s, str):
437.         s = s.lower()
438.     if s in ('none', None, 'false', False):
439.         return None
440.     else:
441.         return ValidateInStrings('ps.usedistiller', ['ghostscript', 'xpdf'])(s)
442. 
443. 
444. # A validator dedicated to the named line styles, based on the items in
445. # ls_mapper, and a list of possible strings read from Line2D.set_linestyle
446. _validate_named_linestyle = ValidateInStrings(
447.     'linestyle',
448.     [*ls_mapper.keys(), *ls_mapper.values(), 'None', 'none', ' ', ''],
449.     ignorecase=True)
450. 
451. 
452. def _validate_linestyle(ls):
453.     """
454.     A validator for all possible line styles, the named ones *and*
455.     the on-off ink sequences.
456.     """
457.     if isinstance(ls, str):
458.         try:  # Look first for a valid named line style, like '--' or 'solid'.
459.             return _validate_named_linestyle(ls)
460.         except ValueError:
461.             pass
462.         try:
463.             ls = ast.literal_eval(ls)  # Parsing matplotlibrc.
464.         except (SyntaxError, ValueError):
465.             pass  # Will error with the ValueError at the end.
466. 
467.     def _is_iterable_not_string_like(x):
468.         # Explicitly exclude bytes/bytearrays so that they are not
469.         # nonsensically interpreted as sequences of numbers (codepoints).
470.         return np.iterable(x) and not isinstance(x, (str, bytes, bytearray))
471. 
472.     if _is_iterable_not_string_like(ls):
473.         if len(ls) == 2 and _is_iterable_not_string_like(ls[1]):
474.             # (offset, (on, off, on, off, ...))
475.             offset, onoff = ls
476.         else:
477.             # For backcompat: (on, off, on, off, ...); the offset is implicit.
478.             offset = 0
479.             onoff = ls
480. 
481.         if (isinstance(offset, Number)
482.                 and len(onoff) % 2 == 0
483.                 and all(isinstance(elem, Number) for elem in onoff)):
484.             return (offset, onoff)
485. 
486.     raise ValueError(f"linestyle {ls!r} is not a valid on-off ink sequence.")
487. 
488. 
489. validate_fillstyle = ValidateInStrings(
490.     'markers.fillstyle', ['full', 'left', 'right', 'bottom', 'top', 'none'])
491. 
492. 
493. validate_fillstylelist = _listify_validator(validate_fillstyle)
494. 
495. 
496. def validate_markevery(s):
497.     """
498.     Validate the markevery property of a Line2D object.
499. 
500.     Parameters

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 20:26:44,678 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The query specifically asks for the source code of the `rc_context` function from `lib/matplotlib/__init__.py`.\n   - This context provides the complete implementation of the `rc_context` function.\n2. Extended relevance:\n   - Understanding `rc_context` is crucial for tracing how Matplotlib's runtime configuration is managed, which is central to the user's goal of debugging backend resolution.", relative_path='lib/matplotlib/__init__.py', start_line=1057, end_line=1098), ContextOutput(reasoning='1. Query requirement analysis:\n   - The query explicitly requests the source code for the `get_backend` function in `lib/matplotlib/__init__.py`.\n   - This context directly provides the requested function.\n2. Extended relevance:\n   - The function is essential for understanding the backend resolution mechanism as it shows how the current backend is retrieved from the rcParams.', relative_path='lib/matplotlib/__init__.py', start_line=1170, end_line=1178), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user requested the full content of `lib/matplotlib/rcsetup.py`.\n   - This context provides the entire file content.\n2. Extended relevance:\n   - This file contains the validation logic for all rc settings, including the backend. This is critical for understanding how backend settings are processed and validated, which is part of the backend resolution mechanism the user wants to trace.', relative_path='lib/matplotlib/rcsetup.py', start_line=1, end_line=500)]
2025-12-20 20:26:44,680 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the source code for the functions `get_backend` and `rc_context` from `lib/matplotlib/__init__.py`, and the full content of `lib/matplotlib/rcsetup.py`.
2025-12-20 20:26:44,680 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 20:26:44,680 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 20:26:44,681 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 4 existing contexts
2025-12-20 20:26:44,681 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 7 total contexts (removed 0 duplicates)
2025-12-20 20:26:44,681 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   └── deploy-docs.sh
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.rst
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── blocking_input_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── fontconfig_pattern_api.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19214-DS.rst
|   |   |   |   ├── 19368-DS.rst
|   |   |   |   ├── 20426-JK.rst
|   |   |   |   ├── 20715-JKS.rst
|   |   |   |   ├── 21026-DS.rst
|   |   |   |   ├── 21042-AL.rst
|   |   |   |   ├── 21238-AL.rst
|   |   |   |   ├── 21983-AL.rst
|   |   |   |   ├── 22013-AL.rst
|   |   |   |   ├── 22063-SR.rst
|   |   |   |   ├── 22204-AL.rst
|   |   |   |   ├── 22229-TAC.rst
|   |   |   |   ├── 22485-TH.rst
|   |   |   |   ├── 22567-IT.rst
|   |   |   |   ├── 22639-RA.rst
|   |   |   |   ├── 22691-JMK.rst
|   |   |   |   ├── 22745-JMK.rst
|   |   |   |   ├── 23031-AL.rst
|   |   |   |   ├── 23170-JMK.rst
|   |   |   |   ├── 23188-JMK.rst
|   |   |   |   └── 23270-AL.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 20071-AL.rst
|   |   |   |   ├── 20839-EP.rst
|   |   |   |   ├── 20995-AL.rst
|   |   |   |   ├── 21056-AL.rst
|   |   |   |   ├── 21187-AL.rst
|   |   |   |   ├── 21356-AL.rst
|   |   |   |   ├── 21412-AL.rst
|   |   |   |   ├── 21425-AL.rst
|   |   |   |   ├── 21584-AL.rst
|   |   |   |   ├── 21962-AL.rst
|   |   |   |   ├── 21965-AL.rst
|   |   |   |   ├── 21981-AL.rst
|   |   |   |   ├── 21982-AL.rst
|   |   |   |   ├── 21992-AL.rst
|   |   |   |   ├── 21995-AL.rst
|   |   |   |   ├── 22021-AL.rst
|   |   |   |   ├── 22025-AL.rst
|   |   |   |   ├── 22050-AL.rst
|   |   |   |   ├── 22051-AL.rst
|   |   |   |   ├── 22084-SS.rst
|   |   |   |   ├── 22097-AL.rst
|   |   |   |   ├── 22098-AL.rst
|   |   |   |   ├── 22123-TH.rst
|   |   |   |   ├── 22133-OG.rst
|   |   |   |   ├── 22134-OG.rst
|   |   |   |   ├── 22148-OG.rst
|   |   |   |   ├── 22167-EP.rst
|   |   |   |   ├── 22245-AL.rst
|   |   |   |   ├── 22268-OG.rst
|   |   |   |   ├── 22298-GL.rst
|   |   |   |   ├── 22317-AL.rst
|   |   |   |   ├── 22323-GL.rst
|   |   |   |   ├── 22345-JK.rst
|   |   |   |   ├── 22415-AL.rst
|   |   |   |   ├── 22418-AL.rst
|   |   |   |   ├── 22421-AL.rst
|   |   |   |   ├── 22422-AL.rst
|   |   |   |   ├── 22490-AL.rst
|   |   |   |   ├── 22503-AL.rst
|   |   |   |   ├── 22509-AL.rst
|   |   |   |   ├── 22539-AL.rst
|   |   |   |   ├── 22547-AL.rst
|   |   |   |   ├── 22554-AL.rst
|   |   |   |   ├── 22697-OG.rst
|   |   |   |   ├── 22725-AL.rst
|   |   |   |   ├── 22797-OG.rst
|   |   |   |   ├── 22813-GL.rst
|   |   |   |   ├── 22883-AL.rst
|   |   |   |   ├── 22885-AL.rst
|   |   |   |   ├── 23014-OG.rst
|   |   |   |   ├── 23045-OG.rst
|   |   |   |   ├── 23081-OG.rst
|   |   |   |   ├── 23166-ES.rst
|   |   |   |   ├── 23190-OG.rst
|   |   |   |   ├── 23232-TH.rst
|   |   |   |   ├── 23289-AL.rst
|   |   |   |   ├── 23302-TH.rst
|   |   |   |   └── ZZZZZ-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 21415-AL.rst
|   |   |   |   ├── 22205-ES.rst
|   |   |   |   └── 22550-AL.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 00001-DS.rst
|   |   |       ├── 20990-AL.rst
|   |   |       ├── 21395-AL.rst
|   |   |       ├── 21591-AL.rst
|   |   |       ├── 21980-CC.rst
|   |   |       ├── 22081-AL.rst
|   |   |       ├── 22107-OG.rst
|   |   |       ├── 22365-OG.rst
|   |   |       ├── 22465-AL.rst
|   |   |       ├── 22486-OG.rst
|   |   |       ├── 22514-OG.rst
|   |   |       ├── 22516-OG.rst
|   |   |       ├── 22738-JL.rst
|   |   |       ├── 22886-OG.rst
|   |   |       ├── 22952-TH.rst
|   |   |       ├── 23076-GL.rst
|   |   |       ├── 23077-GL.rst
|   |   |       ├── 23078-GL.rst
|   |   |       ├── 23079-GL.rst
|   |   |       ├── 23093-GL.rst
|   |   |       └── 23237-AL.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   └── api_changes_3.5.2.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── textpath_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid.rst
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   └── faq.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── documenting_mpl.rst
|   |   ├── gitwash
|   |   |   ├── configure_git.rst
|   |   |   ├── development_workflow.rst
|   |   |   ├── dot2_dot3.rst
|   |   |   ├── following_latest.rst
|   |   |   ├── forking_hell.rst
|   |   |   ├── git_development.rst
|   |   |   ├── git_install.rst
|   |   |   ├── git_intro.rst
|   |   |   ├── git_resources.rst
|   |   |   ├── index.rst
|   |   |   ├── maintainer_workflow.rst
|   |   |   ├── patching.rst
|   |   |   └── set_up_fork.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   └── performance.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_plot_focal_length.rst
|       |   ├── 3d_plot_roll_angle.rst
|       |   ├── README.rst
|       |   ├── asinh_scale.rst
|       |   ├── color_support_for_math_to_image.rst
|       |   ├── custom_cap_widths.rst
|       |   ├── double_quotes_matplolibrc.rst
|       |   ├── extending_MarkerStyle.rst
|       |   ├── inset_axes_improvements.rst
|       |   ├── layout_engine.rst
|       |   ├── list_font_names.rst
|       |   ├── marker_none.rst
|       |   ├── min_macos_version.rst
|       |   ├── modify_stairs_fill_edge_behaviour.rst
|       |   ├── no_broken_streamlines.rst
|       |   ├── polygon_selector_box.rst
|       |   ├── polygon_vert_setter.rst
|       |   ├── rectangle_patch_rotation.rst
|       |   ├── rename_ncol_keyword_in_legend.rst
|       |   ├── selector_improvement.rst
|       |   ├── snap_selector.rst
|       |   ├── striped_lines.rst
|       |   ├── url_active_areas_rotate.rst
|       |   ├── use_contourpy.rst
|       |   └── windows_arm64.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   └── whats_new_3.5.2.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   └── license.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── pythonic_matplotlib.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── align_ylabels.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_polar.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axline.py
|   |   ├── boxplot_demo_pyplot.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── fig_axes_labels_simple.py
|   |   ├── fig_x.py
|   |   ├── pyplot_formatstr.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   ├── pyplot_two_subplots.py
|   |   ├── text_commands.py
|   |   └── text_layout.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── bachelors_degrees_by_gender.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bulleye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   ├── spines_bounds.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── angle_annotation.py
|   |   ├── annotation_demo.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── afm.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   ├── _secondary_axes.py
|   |   |   └── _subplots.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── blocking_input.py
|   |   ├── category.py
|   |   ├── cbook
|   |   |   └── __init__.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── docstring.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── fontconfig_pattern.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── tight_bbox.py
|   |   ├── tight_layout.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── type1font.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   └── parasite_axes.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── clip_path.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   └── parasite_axes.py
|   |   ├── mplot3d
|   |   |   ├── __init__.py
|   |   |   ├── art3d.py
|   |   |   ├── axes3d.py
|   |   |   ├── axis3d.py
|   |   |   └── proj3d.py
|   |   └── tests
|   |       ├── __init__.py
|   |       ├── baseline_images
|   |       |   ├── test_axes_grid
|   |       |   ├── test_axes_grid1
|   |       |   ├── test_axisartist_axis_artist
|   |       |   ├── test_axisartist_axislines
|   |       |   ├── test_axisartist_clip_path
|   |       |   ├── test_axisartist_floating_axes
|   |       |   ├── test_axisartist_grid_helper_curvelinear
|   |       |   └── test_mplot3d
|   |       ├── conftest.py
|   |       ├── test_axes_grid.py
|   |       ├── test_axes_grid1.py
|   |       ├── test_axisartist_angle_helper.py
|   |       ├── test_axisartist_axis_artist.py
|   |       ├── test_axisartist_axislines.py
|   |       ├── test_axisartist_clip_path.py
|   |       ├── test_axisartist_floating_axes.py
|   |       ├── test_axisartist_grid_finder.py
|   |       ├── test_axisartist_grid_helper_curvelinear.py
|   |       └── test_mplot3d.py
|   └── pylab.py
├── plot_types
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   ├── README.txt
    |   └── mosaic.py
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: get_backend() clears figures from Gcf.figs if they were created under rc_context

Description: ### Bug summary

calling `matplotlib.get_backend()` removes all figures from `Gcf` if the *first* figure in `Gcf.figs` was created in an `rc_context`.

### Code for reproduction

```python
import matplotlib.pyplot as plt
from matplotlib import get_backend, rc_context

# fig1 = plt.figure()  # <- UNCOMMENT THIS LINE AND IT WILL WORK
# plt.ion()            # <- ALTERNATIVELY, UNCOMMENT THIS LINE AND IT WILL ALSO WORK
with rc_context():
    fig2 = plt.figure()
before = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
get_backend()
after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'

assert before == after, '\n' + before + '\n' + after
```


### Actual outcome

```
---------------------------------------------------------------------------
AssertionError                            Traceback (most recent call last)
<ipython-input-1-fa4d099aa289> in <cell line: 11>()
      9 after = f'{id(plt._pylab_helpers.Gcf)} {plt._pylab_helpers.Gcf.figs!r}'
     10 
---> 11 assert before == after, '\n' + before + '\n' + after
     12 

AssertionError: 
94453354309744 OrderedDict([(1, <matplotlib.backends.backend_qt.FigureManagerQT object at 0x7fb33e26c220>)])
94453354309744 OrderedDict()
```

### Expected outcome

The figure should not be missing from `Gcf`.  Consequences of this are, e.g, `plt.close(fig2)` doesn't work because `Gcf.destroy_fig()` can't find it.

### Additional information

_No response_

### Operating system

Xubuntu

### Matplotlib Version

3.5.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.4

### Jupyter version

n/a

### Installation

conda

Patch information:
diff --git a/lib/matplotlib/__init__.py b/lib/matplotlib/__init__.py
index c268a56724..c5c1a8e71a 100644
--- a/lib/matplotlib/__init__.py
+++ b/lib/matplotlib/__init__.py
@@ -1095,7 +1095,19 @@ def rc_context(rc=None, fname=None):
             rcParams.update(rc)
         yield
     finally:
-        dict.update(rcParams, orig)  # Revert to the original rcs.
+        # Revert to the original rcs, but preserve a resolved backend if the
+        # original value was the auto backend sentinel.
+        try:
+            original_backend = dict.__getitem__(orig, "backend")
+        except KeyError:
+            original_backend = None
+        if original_backend is rcsetup._auto_backend_sentinel:
+            # Get current backend without triggering resolution.
+            current_backend = dict.__getitem__(rcParams, "backend")
+            if current_backend is not rcsetup._auto_backend_sentinel:
+                # Preserve the resolved backend selected during the context.
+                dict.__setitem__(orig, "backend", current_backend)
+        dict.update(rcParams, orig)
 
 
 def use(backend, *, force=True):


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the source code for the functions `rc_context`, `get_backend`, `pylab_setup`, `switch_backend`, `figure`, and the classes `RcParams` and `Gcf` from their respective files.
Extra Requirements: 
Purpose: This information will allow me to trace the bug through the codebase, understand why creating a figure in `rc_context` causes issues, and confirm that the proposed patch correctly addresses the problem.

Previous refined query 2:
Essential Query: Please provide the source code for the functions `get_backend` and `rc_context` from `lib/matplotlib/__init__.py`, and the full content of `lib/matplotlib/rcsetup.py`.
Extra Requirements: 
Purpose: This will allow me to trace the backend resolution mechanism and understand how `rc_context` interacts with it, which is the core of the bug.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/__init__.py
Line number range: 606 - 726
Content:
606. class RcParams(MutableMapping, dict):
607.     """
608.     A dictionary object including validation.
609. 
610.     Validating functions are defined and associated with rc parameters in
611.     :mod:`matplotlib.rcsetup`.
612. 
613.     The list of rcParams is:
614. 
615.     %s
616. 
617.     See Also
618.     --------
619.     :ref:`customizing-with-matplotlibrc-files`
620.     """
621. 
622.     validate = rcsetup._validators
623. 
624.     # validate values on the way in
625.     def __init__(self, *args, **kwargs):
626.         self.update(*args, **kwargs)
627. 
628.     def __setitem__(self, key, val):
629.         try:
630.             if key in _deprecated_map:
631.                 version, alt_key, alt_val, inverse_alt = _deprecated_map[key]
632.                 _api.warn_deprecated(
633.                     version, name=key, obj_type="rcparam", alternative=alt_key)
634.                 key = alt_key
635.                 val = alt_val(val)
636.             elif key in _deprecated_remain_as_none and val is not None:
637.                 version, = _deprecated_remain_as_none[key]
638.                 _api.warn_deprecated(version, name=key, obj_type="rcparam")
639.             elif key in _deprecated_ignore_map:
640.                 version, alt_key = _deprecated_ignore_map[key]
641.                 _api.warn_deprecated(
642.                     version, name=key, obj_type="rcparam", alternative=alt_key)
643.                 return
644.             elif key == 'backend':
645.                 if val is rcsetup._auto_backend_sentinel:
646.                     if 'backend' in self:
647.                         return
648.             try:
649.                 cval = self.validate[key](val)
650.             except ValueError as ve:
651.                 raise ValueError(f"Key {key}: {ve}") from None
652.             dict.__setitem__(self, key, cval)
653.         except KeyError as err:
654.             raise KeyError(
655.                 f"{key} is not a valid rc parameter (see rcParams.keys() for "
656.                 f"a list of valid parameters)") from err
657. 
658.     def __getitem__(self, key):
659.         if key in _deprecated_map:
660.             version, alt_key, alt_val, inverse_alt = _deprecated_map[key]
661.             _api.warn_deprecated(
662.                 version, name=key, obj_type="rcparam", alternative=alt_key)
663.             return inverse_alt(dict.__getitem__(self, alt_key))
664. 
665.         elif key in _deprecated_ignore_map:
666.             version, alt_key = _deprecated_ignore_map[key]
667.             _api.warn_deprecated(
668.                 version, name=key, obj_type="rcparam", alternative=alt_key)
669.             return dict.__getitem__(self, alt_key) if alt_key else None
670. 
671.         # In theory, this should only ever be used after the global rcParams
672.         # has been set up, but better be safe e.g. in presence of breakpoints.
673.         elif key == "backend" and self is globals().get("rcParams"):
674.             val = dict.__getitem__(self, key)
675.             if val is rcsetup._auto_backend_sentinel:
676.                 from matplotlib import pyplot as plt
677.                 plt.switch_backend(rcsetup._auto_backend_sentinel)
678. 
679.         return dict.__getitem__(self, key)
680. 
681.     def _get_backend_or_none(self):
682.         """Get the requested backend, if any, without triggering resolution."""
683.         backend = dict.__getitem__(self, "backend")
684.         return None if backend is rcsetup._auto_backend_sentinel else backend
685. 
686.     def __repr__(self):
687.         class_name = self.__class__.__name__
688.         indent = len(class_name) + 1
689.         with _api.suppress_matplotlib_deprecation_warning():
690.             repr_split = pprint.pformat(dict(self), indent=1,
691.                                         width=80 - indent).split('\n')
692.         repr_indented = ('\n' + ' ' * indent).join(repr_split)
693.         return '{}({})'.format(class_name, repr_indented)
694. 
695.     def __str__(self):
696.         return '\n'.join(map('{0[0]}: {0[1]}'.format, sorted(self.items())))
697. 
698.     def __iter__(self):
699.         """Yield sorted list of keys."""
700.         with _api.suppress_matplotlib_deprecation_warning():
701.             yield from sorted(dict.__iter__(self))
702. 
703.     def __len__(self):
704.         return dict.__len__(self)
705. 
706.     def find_all(self, pattern):
707.         """
708.         Return the subset of this RcParams dictionary whose keys match,
709.         using :func:`re.search`, the given ``pattern``.
710. 
711.         .. note::
712. 
713.             Changes to the returned dictionary are *not* propagated to
714.             the parent RcParams dictionary.
715. 
716.         """
717.         pattern_re = re.compile(pattern)
718.         return RcParams((key, value)
719.                         for key, value in self.items()
720.                         if pattern_re.search(key))
721. 
722.     def copy(self):
723.         rccopy = RcParams()
724.         for k in self:  # Skip deprecations and revalidation.
725.             dict.__setitem__(rccopy, k, dict.__getitem__(self, k))
726.         return rccopy


File: lib/matplotlib/__init__.py
Line number range: 1057 - 1098
Content:
1057. @contextlib.contextmanager
1058. def rc_context(rc=None, fname=None):
1059.     """
1060.     Return a context manager for temporarily changing rcParams.
1061. 
1062.     Parameters
1063.     ----------
1064.     rc : dict
1065.         The rcParams to temporarily set.
1066.     fname : str or path-like
1067.         A file with Matplotlib rc settings. If both *fname* and *rc* are given,
1068.         settings from *rc* take precedence.
1069. 
1070.     See Also
1071.     --------
1072.     :ref:`customizing-with-matplotlibrc-files`
1073. 
1074.     Examples
1075.     --------
1076.     Passing explicit values via a dict::
1077. 
1078.         with mpl.rc_context({'interactive': False}):
1079.             fig, ax = plt.subplots()
1080.             ax.plot(range(3), range(3))
1081.             fig.savefig('example.png')
1082.             plt.close(fig)
1083. 
1084.     Loading settings from a file::
1085. 
1086.          with mpl.rc_context(fname='print.rc'):
1087.              plt.plot(x, y)  # uses 'print.rc'
1088. 
1089.     """
1090.     orig = rcParams.copy()
1091.     try:
1092.         if fname:
1093.             rc_file(fname)
1094.         if rc:
1095.             rcParams.update(rc)
1096.         yield
1097.     finally:
1098.         dict.update(rcParams, orig)  # Revert to the original rcs.


File: lib/matplotlib/__init__.py
Line number range: 1170 - 1178
Content:
1170. def get_backend():
1171.     """
1172.     Return the name of the current backend.
1173. 
1174.     See Also
1175.     --------
1176.     matplotlib.use
1177.     """
1178.     return rcParams['backend']


File: lib/matplotlib/_pylab_helpers.py
Line number range: 17 - 85
Content:
17.     pyplot keeps track of figure managers using an identifier, the "figure
18.     number" or "manager number" (which can actually be any hashable value);
19.     this number is available as the :attr:`number` attribute of the manager.
20. 
21.     This class is never instantiated; it consists of an `OrderedDict` mapping
22.     figure/manager numbers to managers, and a set of class methods that
23.     manipulate this `OrderedDict`.
24. 
25.     Attributes
26.     ----------
27.     figs : OrderedDict
28.         `OrderedDict` mapping numbers to managers; the active manager is at the
29.         end.
30.     """
31. 
32.     figs = OrderedDict()
33. 
34.     @classmethod
35.     def get_fig_manager(cls, num):
36.         """
37.         If manager number *num* exists, make it the active one and return it;
38.         otherwise return *None*.
39.         """
40.         manager = cls.figs.get(num, None)
41.         if manager is not None:
42.             cls.set_active(manager)
43.         return manager
44. 
45.     @classmethod
46.     def destroy(cls, num):
47.         """
48.         Destroy manager *num* -- either a manager instance or a manager number.
49. 
50.         In the interactive backends, this is bound to the window "destroy" and
51.         "delete" events.
52. 
53.         It is recommended to pass a manager instance, to avoid confusion when
54.         two managers share the same number.
55.         """
56.         if all(hasattr(num, attr) for attr in ["num", "destroy"]):
57.             manager = num
58.             if cls.figs.get(manager.num) is manager:
59.                 cls.figs.pop(manager.num)
60.         else:
61.             try:
62.                 manager = cls.figs.pop(num)
63.             except KeyError:
64.                 return
65.         if hasattr(manager, "_cidgcf"):
66.             manager.canvas.mpl_disconnect(manager._cidgcf)
67.         manager.destroy()
68.         del manager, num
69.         # Full cyclic garbage collection may be too expensive to do on every
70.         # figure destruction, so we collect only the youngest two generations.
71.         # see: https://github.com/matplotlib/matplotlib/pull/3045
72.         gc.collect(1)
73. 
74.     @classmethod
75.     def destroy_fig(cls, fig):
76.         """Destroy figure *fig*."""
77.         num = next((manager.num for manager in cls.figs.values()
78.                     if manager.canvas.figure == fig), None)
79.         if num is not None:
80.             cls.destroy(num)
81. 
82.     @classmethod
83.     def destroy_all(cls):
84.         """Destroy all figures."""
85.         # Reimport gc in case the module globals have already been removed


File: lib/matplotlib/pyplot.py
Line number range: 209 - 281
Content:
209. def switch_backend(newbackend):
210.     """
211.     Close all open figures and set the Matplotlib backend.
212. 
213.     The argument is case-insensitive.  Switching to an interactive backend is
214.     possible only if no event loop for another interactive backend has started.
215.     Switching to and from non-interactive backends is always possible.
216. 
217.     Parameters
218.     ----------
219.     newbackend : str
220.         The name of the backend to use.
221.     """
222.     global _backend_mod
223.     # make sure the init is pulled up so we can assign to it later
224.     import matplotlib.backends
225.     close("all")
226. 
227.     if newbackend is rcsetup._auto_backend_sentinel:
228.         current_framework = cbook._get_running_interactive_framework()
229.         mapping = {'qt': 'qtagg',
230.                    'gtk3': 'gtk3agg',
231.                    'gtk4': 'gtk4agg',
232.                    'wx': 'wxagg',
233.                    'tk': 'tkagg',
234.                    'macosx': 'macosx',
235.                    'headless': 'agg'}
236. 
237.         best_guess = mapping.get(current_framework, None)
238.         if best_guess is not None:
239.             candidates = [best_guess]
240.         else:
241.             candidates = []
242.         candidates += [
243.             "macosx", "qtagg", "gtk4agg", "gtk3agg", "tkagg", "wxagg"]
244. 
245.         # Don't try to fallback on the cairo-based backends as they each have
246.         # an additional dependency (pycairo) over the agg-based backend, and
247.         # are of worse quality.
248.         for candidate in candidates:
249.             try:
250.                 switch_backend(candidate)
251.             except ImportError:
252.                 continue
253.             else:
254.                 rcParamsOrig['backend'] = candidate
255.                 return
256.         else:
257.             # Switching to Agg should always succeed; if it doesn't, let the
258.             # exception propagate out.
259.             switch_backend("agg")
260.             rcParamsOrig["backend"] = "agg"
261.             return
262. 
263.     backend_mod = importlib.import_module(
264.         cbook._backend_module_name(newbackend))
265.     canvas_class = backend_mod.FigureCanvas
266. 
267.     required_framework = _get_required_interactive_framework(backend_mod)
268.     if required_framework is not None:
269.         current_framework = cbook._get_running_interactive_framework()
270.         if (current_framework and required_framework
271.                 and current_framework != required_framework):
272.             raise ImportError(
273.                 "Cannot load backend {!r} which requires the {!r} interactive "
274.                 "framework, as {!r} is currently running".format(
275.                     newbackend, required_framework, current_framework))
276. 
277.     # Load the new_figure_manager(), draw_if_interactive(), and show()
278.     # functions from the backend.
279. 
280.     # Classically, backends can directly export these functions.  This should
281.     # keep working for backcompat.


File: lib/matplotlib/pyplot.py
Line number range: 697 - 835
Content:
697. def figure(num=None,  # autoincrement if None, else integer from 1-N
698.            figsize=None,  # defaults to rc figure.figsize
699.            dpi=None,  # defaults to rc figure.dpi
700.            facecolor=None,  # defaults to rc figure.facecolor
701.            edgecolor=None,  # defaults to rc figure.edgecolor
702.            frameon=True,
703.            FigureClass=Figure,
704.            clear=False,
705.            **kwargs
706.            ):
707.     """
708.     Create a new figure, or activate an existing figure.
709. 
710.     Parameters
711.     ----------
712.     num : int or str or `.Figure` or `.SubFigure`, optional
713.         A unique identifier for the figure.
714. 
715.         If a figure with that identifier already exists, this figure is made
716.         active and returned. An integer refers to the ``Figure.number``
717.         attribute, a string refers to the figure label.
718. 
719.         If there is no figure with the identifier or *num* is not given, a new
720.         figure is created, made active and returned.  If *num* is an int, it
721.         will be used for the ``Figure.number`` attribute, otherwise, an
722.         auto-generated integer value is used (starting at 1 and incremented
723.         for each new figure). If *num* is a string, the figure label and the
724.         window title is set to this value.  If num is a ``SubFigure``, its
725.         parent ``Figure`` is activated.
726. 
727.     figsize : (float, float), default: :rc:`figure.figsize`
728.         Width, height in inches.
729. 
730.     dpi : float, default: :rc:`figure.dpi`
731.         The resolution of the figure in dots-per-inch.
732. 
733.     facecolor : color, default: :rc:`figure.facecolor`
734.         The background color.
735. 
736.     edgecolor : color, default: :rc:`figure.edgecolor`
737.         The border color.
738. 
739.     frameon : bool, default: True
740.         If False, suppress drawing the figure frame.
741. 
742.     FigureClass : subclass of `~matplotlib.figure.Figure`
743.         If set, an instance of this subclass will be created, rather than a
744.         plain `.Figure`.
745. 
746.     clear : bool, default: False
747.         If True and the figure already exists, then it is cleared.
748. 
749.     layout : {'constrained', 'tight', `.LayoutEngine`, None}, default: None
750.         The layout mechanism for positioning of plot elements to avoid
751.         overlapping Axes decorations (labels, ticks, etc). Note that layout
752.         managers can measurably slow down figure display. Defaults to *None*
753.         (but see the documentation of the `.Figure` constructor regarding the
754.         interaction with rcParams).
755. 
756.     **kwargs
757.         Additional keyword arguments are passed to the `.Figure` constructor.
758. 
759.     Returns
760.     -------
761.     `~matplotlib.figure.Figure`
762. 
763.     Notes
764.     -----
765.     Newly created figures will be passed to the
766.     `~.backend_template.new_figure_manager` function provided by the current
767.     backend, which will install a canvas and a manager on the figure.
768. 
769.     If you are creating many figures, make sure you explicitly call
770.     `.pyplot.close` on the figures you are not using, because this will
771.     enable pyplot to properly clean up the memory.
772. 
773.     `~matplotlib.rcParams` defines the default values, which can be modified
774.     in the matplotlibrc file.
775.     """
776.     if isinstance(num, FigureBase):
777.         if num.canvas.manager is None:
778.             raise ValueError("The passed figure is not managed by pyplot")
779.         _pylab_helpers.Gcf.set_active(num.canvas.manager)
780.         return num.figure
781. 
782.     allnums = get_fignums()
783.     next_num = max(allnums) + 1 if allnums else 1
784.     fig_label = ''
785.     if num is None:
786.         num = next_num
787.     elif isinstance(num, str):
788.         fig_label = num
789.         all_labels = get_figlabels()
790.         if fig_label not in all_labels:
791.             if fig_label == 'all':
792.                 _api.warn_external("close('all') closes all existing figures.")
793.             num = next_num
794.         else:
795.             inum = all_labels.index(fig_label)
796.             num = allnums[inum]
797.     else:
798.         num = int(num)  # crude validation of num argument
799. 
800.     manager = _pylab_helpers.Gcf.get_fig_manager(num)
801.     if manager is None:
802.         max_open_warning = rcParams['figure.max_open_warning']
803.         if len(allnums) == max_open_warning >= 1:
804.             _api.warn_external(
805.                 f"More than {max_open_warning} figures have been opened. "
806.                 f"Figures created through the pyplot interface "
807.                 f"(`matplotlib.pyplot.figure`) are retained until explicitly "
808.                 f"closed and may consume too much memory. (To control this "
809.                 f"warning, see the rcParam `figure.max_open_warning`).",
810.                 RuntimeWarning)
811. 
812.         manager = new_figure_manager(
813.             num, figsize=figsize, dpi=dpi,
814.             facecolor=facecolor, edgecolor=edgecolor, frameon=frameon,
815.             FigureClass=FigureClass, **kwargs)
816.         fig = manager.canvas.figure
817.         if fig_label:
818.             fig.set_label(fig_label)
819. 
820.         _pylab_helpers.Gcf._set_new_active_manager(manager)
821. 
822.         # make sure backends (inline) that we don't ship that expect this
823.         # to be called in plotting commands to make the figure call show
824.         # still work.  There is probably a better way to do this in the
825.         # FigureManager base class.
826.         draw_if_interactive()
827. 
828.         if _REPL_DISPLAYHOOK is _ReplDisplayHook.PLAIN:
829.             fig.stale_callback = _auto_draw_if_interactive
830. 
831.     if clear:
832.         manager.canvas.figure.clear()
833. 
834.     return manager.canvas.figure
835. 


File: lib/matplotlib/rcsetup.py
Line number range: 1 - 500
Content:
1. """
2. The rcsetup module contains the validation code for customization using
3. Matplotlib's rc settings.
4. 
5. Each rc setting is assigned a function used to validate any attempted changes
6. to that setting.  The validation functions are defined in the rcsetup module,
7. and are used to construct the rcParams global object which stores the settings
8. and is referenced throughout Matplotlib.
9. 
10. The default values of the rc settings are set in the default matplotlibrc file.
11. Any additions or deletions to the parameter set listed here should also be
12. propagated to the :file:`matplotlibrc.template` in Matplotlib's root source
13. directory.
14. """
15. 
16. import ast
17. from functools import lru_cache, reduce
18. from numbers import Number
19. import operator
20. import os
21. import re
22. 
23. import numpy as np
24. 
25. from matplotlib import _api, cbook
26. from matplotlib.cbook import ls_mapper
27. from matplotlib.colors import Colormap, is_color_like
28. from matplotlib._fontconfig_pattern import parse_fontconfig_pattern
29. from matplotlib._enums import JoinStyle, CapStyle
30. 
31. # Don't let the original cycler collide with our validating cycler
32. from cycler import Cycler, cycler as ccycler
33. 
34. 
35. # The capitalized forms are needed for ipython at present; this may
36. # change for later versions.
37. interactive_bk = [
38.     'GTK3Agg', 'GTK3Cairo', 'GTK4Agg', 'GTK4Cairo',
39.     'MacOSX',
40.     'nbAgg',
41.     'QtAgg', 'QtCairo', 'Qt5Agg', 'Qt5Cairo',
42.     'TkAgg', 'TkCairo',
43.     'WebAgg',
44.     'WX', 'WXAgg', 'WXCairo',
45. ]
46. non_interactive_bk = ['agg', 'cairo',
47.                       'pdf', 'pgf', 'ps', 'svg', 'template']
48. all_backends = interactive_bk + non_interactive_bk
49. 
50. 
51. class ValidateInStrings:
52.     def __init__(self, key, valid, ignorecase=False, *,
53.                  _deprecated_since=None):
54.         """*valid* is a list of legal strings."""
55.         self.key = key
56.         self.ignorecase = ignorecase
57.         self._deprecated_since = _deprecated_since
58. 
59.         def func(s):
60.             if ignorecase:
61.                 return s.lower()
62.             else:
63.                 return s
64.         self.valid = {func(k): k for k in valid}
65. 
66.     def __call__(self, s):
67.         if self._deprecated_since:
68.             name, = (k for k, v in globals().items() if v is self)
69.             _api.warn_deprecated(
70.                 self._deprecated_since, name=name, obj_type="function")
71.         if self.ignorecase:
72.             s = s.lower()
73.         if s in self.valid:
74.             return self.valid[s]
75.         msg = (f"{s!r} is not a valid value for {self.key}; supported values "
76.                f"are {[*self.valid.values()]}")
77.         if (isinstance(s, str)
78.                 and (s.startswith('"') and s.endswith('"')
79.                      or s.startswith("'") and s.endswith("'"))
80.                 and s[1:-1] in self.valid):
81.             msg += "; remove quotes surrounding your string"
82.         raise ValueError(msg)
83. 
84. 
85. @lru_cache()
86. def _listify_validator(scalar_validator, allow_stringlist=False, *,
87.                        n=None, doc=None):
88.     def f(s):
89.         if isinstance(s, str):
90.             try:
91.                 val = [scalar_validator(v.strip()) for v in s.split(',')
92.                        if v.strip()]
93.             except Exception:
94.                 if allow_stringlist:
95.                     # Sometimes, a list of colors might be a single string
96.                     # of single-letter colornames. So give that a shot.
97.                     val = [scalar_validator(v.strip()) for v in s if v.strip()]
98.                 else:
99.                     raise
100.         # Allow any ordered sequence type -- generators, np.ndarray, pd.Series
101.         # -- but not sets, whose iteration order is non-deterministic.
102.         elif np.iterable(s) and not isinstance(s, (set, frozenset)):
103.             # The condition on this list comprehension will preserve the
104.             # behavior of filtering out any empty strings (behavior was
105.             # from the original validate_stringlist()), while allowing
106.             # any non-string/text scalar values such as numbers and arrays.
107.             val = [scalar_validator(v) for v in s
108.                    if not isinstance(v, str) or v]
109.         else:
110.             raise ValueError(
111.                 f"Expected str or other non-set iterable, but got {s}")
112.         if n is not None and len(val) != n:
113.             raise ValueError(
114.                 f"Expected {n} values, but there are {len(val)} values in {s}")
115.         return val
116. 
117.     try:
118.         f.__name__ = "{}list".format(scalar_validator.__name__)
119.     except AttributeError:  # class instance.
120.         f.__name__ = "{}List".format(type(scalar_validator).__name__)
121.     f.__qualname__ = f.__qualname__.rsplit(".", 1)[0] + "." + f.__name__
122.     f.__doc__ = doc if doc is not None else scalar_validator.__doc__
123.     return f
124. 
125. 
126. def validate_any(s):
127.     return s
128. validate_anylist = _listify_validator(validate_any)
129. 
130. 
131. def _validate_date(s):
132.     try:
133.         np.datetime64(s)
134.         return s
135.     except ValueError:
136.         raise ValueError(
137.             f'{s!r} should be a string that can be parsed by numpy.datetime64')
138. 
139. 
140. def validate_bool(b):
141.     """Convert b to ``bool`` or raise."""
142.     if isinstance(b, str):
143.         b = b.lower()
144.     if b in ('t', 'y', 'yes', 'on', 'true', '1', 1, True):
145.         return True
146.     elif b in ('f', 'n', 'no', 'off', 'false', '0', 0, False):
147.         return False
148.     else:
149.         raise ValueError(f'Cannot convert {b!r} to bool')
150. 
151. 
152. def validate_axisbelow(s):
153.     try:
154.         return validate_bool(s)
155.     except ValueError:
156.         if isinstance(s, str):
157.             if s == 'line':
158.                 return 'line'
159.     raise ValueError(f'{s!r} cannot be interpreted as'
160.                      ' True, False, or "line"')
161. 
162. 
163. def validate_dpi(s):
164.     """Confirm s is string 'figure' or convert s to float or raise."""
165.     if s == 'figure':
166.         return s
167.     try:
168.         return float(s)
169.     except ValueError as e:
170.         raise ValueError(f'{s!r} is not string "figure" and '
171.                          f'could not convert {s!r} to float') from e
172. 
173. 
174. def _make_type_validator(cls, *, allow_none=False):
175.     """
176.     Return a validator that converts inputs to *cls* or raises (and possibly
177.     allows ``None`` as well).
178.     """
179. 
180.     def validator(s):
181.         if (allow_none and
182.                 (s is None or isinstance(s, str) and s.lower() == "none")):
183.             return None
184.         if cls is str and not isinstance(s, str):
185.             _api.warn_deprecated(
186.                 "3.5", message="Support for setting an rcParam that expects a "
187.                 "str value to a non-str value is deprecated since %(since)s "
188.                 "and support will be removed %(removal)s.")
189.         try:
190.             return cls(s)
191.         except (TypeError, ValueError) as e:
192.             raise ValueError(
193.                 f'Could not convert {s!r} to {cls.__name__}') from e
194. 
195.     validator.__name__ = f"validate_{cls.__name__}"
196.     if allow_none:
197.         validator.__name__ += "_or_None"
198.     validator.__qualname__ = (
199.         validator.__qualname__.rsplit(".", 1)[0] + "." + validator.__name__)
200.     return validator
201. 
202. 
203. validate_string = _make_type_validator(str)
204. validate_string_or_None = _make_type_validator(str, allow_none=True)
205. validate_stringlist = _listify_validator(
206.     validate_string, doc='return a list of strings')
207. validate_int = _make_type_validator(int)
208. validate_int_or_None = _make_type_validator(int, allow_none=True)
209. validate_float = _make_type_validator(float)
210. validate_float_or_None = _make_type_validator(float, allow_none=True)
211. validate_floatlist = _listify_validator(
212.     validate_float, doc='return a list of floats')
213. 
214. 
215. def _validate_pathlike(s):
216.     if isinstance(s, (str, os.PathLike)):
217.         # Store value as str because savefig.directory needs to distinguish
218.         # between "" (cwd) and "." (cwd, but gets updated by user selections).
219.         return os.fsdecode(s)
220.     else:
221.         return validate_string(s)  # Emit deprecation warning.
222. 
223. 
224. def validate_fonttype(s):
225.     """
226.     Confirm that this is a Postscript or PDF font type that we know how to
227.     convert to.
228.     """
229.     fonttypes = {'type3':    3,
230.                  'truetype': 42}
231.     try:
232.         fonttype = validate_int(s)
233.     except ValueError:
234.         try:
235.             return fonttypes[s.lower()]
236.         except KeyError as e:
237.             raise ValueError('Supported Postscript/PDF font types are %s'
238.                              % list(fonttypes)) from e
239.     else:
240.         if fonttype not in fonttypes.values():
241.             raise ValueError(
242.                 'Supported Postscript/PDF font types are %s' %
243.                 list(fonttypes.values()))
244.         return fonttype
245. 
246. 
247. _validate_standard_backends = ValidateInStrings(
248.     'backend', all_backends, ignorecase=True)
249. _auto_backend_sentinel = object()
250. 
251. 
252. def validate_backend(s):
253.     backend = (
254.         s if s is _auto_backend_sentinel or s.startswith("module://")
255.         else _validate_standard_backends(s))
256.     return backend
257. 
258. 
259. def _validate_toolbar(s):
260.     s = ValidateInStrings(
261.         'toolbar', ['None', 'toolbar2', 'toolmanager'], ignorecase=True)(s)
262.     if s == 'toolmanager':
263.         _api.warn_external(
264.             "Treat the new Tool classes introduced in v1.5 as experimental "
265.             "for now; the API and rcParam may change in future versions.")
266.     return s
267. 
268. 
269. def validate_color_or_inherit(s):
270.     """Return a valid color arg."""
271.     if cbook._str_equal(s, 'inherit'):
272.         return s
273.     return validate_color(s)
274. 
275. 
276. def validate_color_or_auto(s):
277.     if cbook._str_equal(s, 'auto'):
278.         return s
279.     return validate_color(s)
280. 
281. 
282. def validate_color_for_prop_cycle(s):
283.     # N-th color cycle syntax can't go into the color cycle.
284.     if isinstance(s, str) and re.match("^C[0-9]$", s):
285.         raise ValueError(f"Cannot put cycle reference ({s!r}) in prop_cycler")
286.     return validate_color(s)
287. 
288. 
289. def _validate_color_or_linecolor(s):
290.     if cbook._str_equal(s, 'linecolor'):
291.         return s
292.     elif cbook._str_equal(s, 'mfc') or cbook._str_equal(s, 'markerfacecolor'):
293.         return 'markerfacecolor'
294.     elif cbook._str_equal(s, 'mec') or cbook._str_equal(s, 'markeredgecolor'):
295.         return 'markeredgecolor'
296.     elif s is None:
297.         return None
298.     elif isinstance(s, str) and len(s) == 6 or len(s) == 8:
299.         stmp = '#' + s
300.         if is_color_like(stmp):
301.             return stmp
302.         if s.lower() == 'none':
303.             return None
304.     elif is_color_like(s):
305.         return s
306. 
307.     raise ValueError(f'{s!r} does not look like a color arg')
308. 
309. 
310. def validate_color(s):
311.     """Return a valid color arg."""
312.     if isinstance(s, str):
313.         if s.lower() == 'none':
314.             return 'none'
315.         if len(s) == 6 or len(s) == 8:
316.             stmp = '#' + s
317.             if is_color_like(stmp):
318.                 return stmp
319. 
320.     if is_color_like(s):
321.         return s
322. 
323.     # If it is still valid, it must be a tuple (as a string from matplotlibrc).
324.     try:
325.         color = ast.literal_eval(s)
326.     except (SyntaxError, ValueError):
327.         pass
328.     else:
329.         if is_color_like(color):
330.             return color
331. 
332.     raise ValueError(f'{s!r} does not look like a color arg')
333. 
334. 
335. validate_colorlist = _listify_validator(
336.     validate_color, allow_stringlist=True, doc='return a list of colorspecs')
337. 
338. 
339. def _validate_cmap(s):
340.     _api.check_isinstance((str, Colormap), cmap=s)
341.     return s
342. 
343. 
344. def validate_aspect(s):
345.     if s in ('auto', 'equal'):
346.         return s
347.     try:
348.         return float(s)
349.     except ValueError as e:
350.         raise ValueError('not a valid aspect specification') from e
351. 
352. 
353. def validate_fontsize_None(s):
354.     if s is None or s == 'None':
355.         return None
356.     else:
357.         return validate_fontsize(s)
358. 
359. 
360. def validate_fontsize(s):
361.     fontsizes = ['xx-small', 'x-small', 'small', 'medium', 'large',
362.                  'x-large', 'xx-large', 'smaller', 'larger']
363.     if isinstance(s, str):
364.         s = s.lower()
365.     if s in fontsizes:
366.         return s
367.     try:
368.         return float(s)
369.     except ValueError as e:
370.         raise ValueError("%s is not a valid font size. Valid font sizes "
371.                          "are %s." % (s, ", ".join(fontsizes))) from e
372. 
373. 
374. validate_fontsizelist = _listify_validator(validate_fontsize)
375. 
376. 
377. def validate_fontweight(s):
378.     weights = [
379.         'ultralight', 'light', 'normal', 'regular', 'book', 'medium', 'roman',
380.         'semibold', 'demibold', 'demi', 'bold', 'heavy', 'extra bold', 'black']
381.     # Note: Historically, weights have been case-sensitive in Matplotlib
382.     if s in weights:
383.         return s
384.     try:
385.         return int(s)
386.     except (ValueError, TypeError) as e:
387.         raise ValueError(f'{s} is not a valid font weight.') from e
388. 
389. 
390. def validate_fontstretch(s):
391.     stretchvalues = [
392.         'ultra-condensed', 'extra-condensed', 'condensed', 'semi-condensed',
393.         'normal', 'semi-expanded', 'expanded', 'extra-expanded',
394.         'ultra-expanded']
395.     # Note: Historically, stretchvalues have been case-sensitive in Matplotlib
396.     if s in stretchvalues:
397.         return s
398.     try:
399.         return int(s)
400.     except (ValueError, TypeError) as e:
401.         raise ValueError(f'{s} is not a valid font stretch.') from e
402. 
403. 
404. def validate_font_properties(s):
405.     parse_fontconfig_pattern(s)
406.     return s
407. 
408. 
409. def _validate_mathtext_fallback(s):
410.     _fallback_fonts = ['cm', 'stix', 'stixsans']
411.     if isinstance(s, str):
412.         s = s.lower()
413.     if s is None or s == 'none':
414.         return None
415.     elif s.lower() in _fallback_fonts:
416.         return s
417.     else:
418.         raise ValueError(
419.             f"{s} is not a valid fallback font name. Valid fallback font "
420.             f"names are {','.join(_fallback_fonts)}. Passing 'None' will turn "
421.             "fallback off.")
422. 
423. 
424. def validate_whiskers(s):
425.     try:
426.         return _listify_validator(validate_float, n=2)(s)
427.     except (TypeError, ValueError):
428.         try:
429.             return float(s)
430.         except ValueError as e:
431.             raise ValueError("Not a valid whisker value [float, "
432.                              "(float, float)]") from e
433. 
434. 
435. def validate_ps_distiller(s):
436.     if isinstance(s, str):
437.         s = s.lower()
438.     if s in ('none', None, 'false', False):
439.         return None
440.     else:
441.         return ValidateInStrings('ps.usedistiller', ['ghostscript', 'xpdf'])(s)
442. 
443. 
444. # A validator dedicated to the named line styles, based on the items in
445. # ls_mapper, and a list of possible strings read from Line2D.set_linestyle
446. _validate_named_linestyle = ValidateInStrings(
447.     'linestyle',
448.     [*ls_mapper.keys(), *ls_mapper.values(), 'None', 'none', ' ', ''],
449.     ignorecase=True)
450. 
451. 
452. def _validate_linestyle(ls):
453.     """
454.     A validator for all possible line styles, the named ones *and*
455.     the on-off ink sequences.
456.     """
457.     if isinstance(ls, str):
458.         try:  # Look first for a valid named line style, like '--' or 'solid'.
459.             return _validate_named_linestyle(ls)
460.         except ValueError:
461.             pass
462.         try:
463.             ls = ast.literal_eval(ls)  # Parsing matplotlibrc.
464.         except (SyntaxError, ValueError):
465.             pass  # Will error with the ValueError at the end.
466. 
467.     def _is_iterable_not_string_like(x):
468.         # Explicitly exclude bytes/bytearrays so that they are not
469.         # nonsensically interpreted as sequences of numbers (codepoints).
470.         return np.iterable(x) and not isinstance(x, (str, bytes, bytearray))
471. 
472.     if _is_iterable_not_string_like(ls):
473.         if len(ls) == 2 and _is_iterable_not_string_like(ls[1]):
474.             # (offset, (on, off, on, off, ...))
475.             offset, onoff = ls
476.         else:
477.             # For backcompat: (on, off, on, off, ...); the offset is implicit.
478.             offset = 0
479.             onoff = ls
480. 
481.         if (isinstance(offset, Number)
482.                 and len(onoff) % 2 == 0
483.                 and all(isinstance(elem, Number) for elem in onoff)):
484.             return (offset, onoff)
485. 
486.     raise ValueError(f"linestyle {ls!r} is not a valid on-off ink sequence.")
487. 
488. 
489. validate_fillstyle = ValidateInStrings(
490.     'markers.fillstyle', ['full', 'left', 'right', 'bottom', 'top', 'none'])
491. 
492. 
493. validate_fillstylelist = _listify_validator(validate_fillstyle)
494. 
495. 
496. def validate_markevery(s):
497.     """
498.     Validate the markevery property of a Line2D object.
499. 
500.     Parameters

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-20 20:27:36,795 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="I have analyzed the provided code and determined that the root cause of the bug lies in how `rc_context` interacts with backend resolution, specifically how `get_backend()` can trigger `switch_backend`, leading to `close('all')`. However, to fully confirm the execution flow, I am missing three key pieces of code: the implementation of `new_figure_manager` which is responsible for creating figures and potentially triggering backend loading, the `close` function which is called by `switch_backend`, and the `Gcf.destroy_all` method which is responsible for clearing the figures. The provided context for `pyplot.py` and `_pylab_helpers.py` is incomplete and does not contain these." query='Please provide the full source code for the `Gcf` class from `lib/matplotlib/_pylab_helpers.py`, and the functions `new_figure_manager` and `close` from `lib/matplotlib/pyplot.py`.' extra_requirements='' purpose='This will allow me to build a complete execution trace, from figure creation with `new_figure_manager`, to its destruction through `close` and `Gcf.destroy_all`, confirming how the backend switching triggered by `get_backend` after the `rc_context` clears the figures.'
2025-12-20 20:27:36,798 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full source code for the `Gcf` class from `lib/matplotlib/_pylab_helpers.py`, and the functions `new_figure_manager` and `close` from `lib/matplotlib/pyplot.py`.
2025-12-20 20:27:36,798 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-20 20:27:36,799 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-20 20:27:36,804 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-20 20:27:36,804 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full source code for the `Gcf` class from `lib/matplotlib/_pylab_helpers.py`, and the functions `new_figure_manager` and `close` from `lib/matplotlib/pyplot.py`.
Purpose: This will allow me to build a complete execution trace, from figure creation with `new_figure_manager`, to its destruction through `close` and `Gcf.destroy_all`, confirming how the backend switching triggered by `get_backend` after the `rc_context` clears the figures.
2025-12-20 20:27:41,583 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have located the `Gcf` class in `lib/matplotlib/_pylab_helpers.py` and the `new_figure_manager` and `close` functions in `lib/matplotlib/pyplot.py`. I will now retrieve the full source code for these components to provide the complete execution trace you requested.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"relative_path": "lib/matplotlib/pyplot.py", "type": "function_definition"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2196, 'candidates_token_count': 135, 'total_token_count': 2720, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2196}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 135}], 'thoughts_token_count': 389, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13775884840223523, 'model_name': 'gemini-2.5-pro'} id='run--97d0f828-61dc-46e3-ac29-d58223ecefb3-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/_pylab_helpers.py', 'type': 'class_definition'}, 'id': '93cbc8f3-3bea-4396-9952-63d586aa3c22', 'type': 'tool_call'}, {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'relative_path': 'lib/matplotlib/pyplot.py', 'type': 'function_definition'}, 'id': '2cd71f11-abbd-4610-b489-5ca8e61b8265', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2196, 'output_tokens': 135, 'total_tokens': 2720, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 389}}
2025-12-20 20:27:47,008 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located the `Gcf` class and the `new_figure_manager` and `close` functions. I will now retrieve their source code to provide you with the complete execution trace.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "def close(", "relative_path": "lib/matplotlib/pyplot.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4329, 'candidates_token_count': 141, 'total_token_count': 4873, 'cached_content_token_count': 1637, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4329}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1637}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 141}], 'thoughts_token_count': 403}, 'finish_reason': 'STOP', 'avg_logprobs': -0.22247311747665946, 'model_name': 'gemini-2.5-pro'} id='run--6b956b85-d84a-4c0f-9798-f700f29d8278-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 141.0, 'relative_path': 'lib/matplotlib/_pylab_helpers.py', 'start_line': 10.0}, 'id': '46fa0724-e3a4-49c9-875c-dc6052030ff1', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def new_figure_manager(', 'relative_path': 'lib/matplotlib/pyplot.py'}, 'id': '965c71c4-df46-4f0f-8c36-e082f5b75e0c', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def close(', 'relative_path': 'lib/matplotlib/pyplot.py'}, 'id': '5cd0e7d3-5396-48af-b978-352fc90c794e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4329, 'output_tokens': 141, 'total_tokens': 4873, 'input_token_details': {'cache_read': 1637}, 'output_token_details': {'reasoning': 403}}
2025-12-20 20:27:50,446 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the source code for the `Gcf` class, as well as the `new_figure_manager` and `close` functions. I will now read the relevant source code snippets to provide you with the complete execution trace you requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 957.0, "relative_path": "lib/matplotlib/pyplot.py", "start_line": 918.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8314, 'candidates_token_count': 105, 'total_token_count': 8577, 'cached_content_token_count': 3513, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8314}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3513}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 105}], 'thoughts_token_count': 158}, 'finish_reason': 'STOP', 'avg_logprobs': -0.22821168445405507, 'model_name': 'gemini-2.5-pro'} id='run--8877eada-9aed-46b4-a6f2-7608fb5ed558-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 322.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 209.0}, 'id': '2df5d386-4ce5-41c3-880b-16e7be4426de', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'end_line': 957.0, 'relative_path': 'lib/matplotlib/pyplot.py', 'start_line': 918.0}, 'id': 'cfbbcbe5-78ba-4f77-8ca1-30e261e05491', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8314, 'output_tokens': 105, 'total_tokens': 8577, 'input_token_details': {'cache_read': 3513}, 'output_token_details': {'reasoning': 158}}
2025-12-20 20:28:02,115 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the source code for the `Gcf` class from `lib/matplotlib/_pylab_helpers.py`, and the `new_figure_manager` and `close` functions from `lib/matplotlib/pyplot.py`.\n\nHere is a summary of the execution trace based on the retrieved code:\n\nThe `new_figure_manager` function in `pyplot.py` is a wrapper that calls the `new_figure_manager` function of the currently selected backend. The `Gcf` class in `_pylab_helpers.py` is a singleton that manages all the figure managers. When a new figure is created, its manager is registered with the `Gcf` class. The `close` function in `pyplot.py` provides different ways to close a figure, including closing the current figure, all figures, or a specific figure by its number, name, or `Figure` instance. It uses the `Gcf` class to find the corresponding figure manager and calls its `destroy` method. The `Gcf.destroy_all` method is called when all figures are closed, which iterates through all the registered figure managers and destroys them. This confirms the execution flow from figure creation to destruction, and how `get_backend` can trigger a backend switch after the `rc_context` clears the figures.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10888, 'candidates_token_count': 277, 'total_token_count': 12038, 'cached_content_token_count': 7178, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10888}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7178}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 277}], 'thoughts_token_count': 873}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2609204454112139, 'model_name': 'gemini-2.5-pro'} id='run--45a152d3-2fc9-43e4-b4f8-5cafe81478dc-0' usage_metadata={'input_tokens': 10888, 'output_tokens': 277, 'total_tokens': 12038, 'input_token_details': {'cache_read': 7178}, 'output_token_details': {'reasoning': 873}}
2025-12-20 20:28:02,118 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full source code for the `Gcf` class from `lib/matplotlib/_pylab_helpers.py`, and the functions `new_figure_manager` and `close` from `lib/matplotlib/pyplot.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This will allow me to build a complete execution trace, from figure creation with `new_figure_manager`, to its destruction through `close` and `Gcf.destroy_all`, confirming how the backend switching triggered by `get_backend` after the `rc_context` clears the figures.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/_pylab_helpers.py
Line number range: 10 - 141
Content:
class Gcf:
    """
    Singleton to maintain the relation between figures and their managers, and
    keep track of and "active" figure and manager.

    The canvas of a figure created through pyplot is associated with a figure
    manager, which handles the interaction between the figure and the backend.
    pyplot keeps track of figure managers using an identifier, the "figure
    number" or "manager number" (which can actually be any hashable value);
    this number is available as the :attr:`number` attribute of the manager.

    This class is never instantiated; it consists of an `OrderedDict` mapping
    figure/manager numbers to managers, and a set of class methods that
    manipulate this `OrderedDict`.

    Attributes
    ----------
    figs : OrderedDict
        `OrderedDict` mapping numbers to managers; the active manager is at the
        end.
    """

    figs = OrderedDict()

    @classmethod
    def get_fig_manager(cls, num):
        """
        If manager number *num* exists, make it the active one and return it;
        otherwise return *None*.
        """
        manager = cls.figs.get(num, None)
        if manager is not None:
            cls.set_active(manager)
        return manager

    @classmethod
    def destroy(cls, num):
        """
        Destroy manager *num* -- either a manager instance or a manager number.

        In the interactive backends, this is bound to the window "destroy" and
        "delete" events.

        It is recommended to pass a manager instance, to avoid confusion when
        two managers share the same number.
        """
        if all(hasattr(num, attr) for attr in ["num", "destroy"]):
            manager = num
            if cls.figs.get(manager.num) is manager:
                cls.figs.pop(manager.num)
        else:
            try:
                manager = cls.figs.pop(num)
            except KeyError:
                return
        if hasattr(manager, "_cidgcf"):
            manager.canvas.mpl_disconnect(manager._cidgcf)
        manager.destroy()
        del manager, num
        # Full cyclic garbage collection may be too expensive to do on every
        # figure destruction, so we collect only the youngest two generations.
        # see: https://github.com/matplotlib/matplotlib/pull/3045
        gc.collect(1)

    @classmethod
    def destroy_fig(cls, fig):
        """Destroy figure *fig*."""
        num = next((manager.num for manager in cls.figs.values()
                    if manager.canvas.figure == fig), None)
        if num is not None:
            cls.destroy(num)

    @classmethod
    def destroy_all(cls):
        """Destroy all figures."""
        # Reimport gc in case the module globals have already been removed
        # during interpreter shutdown.
        import gc
        for manager in list(cls.figs.values()):
            manager.canvas.mpl_disconnect(manager._cidgcf)
            manager.destroy()
        cls.figs.clear()
        gc.collect(1)

    @classmethod
    def has_fignum(cls, num):
        """Return whether figure number *num* exists."""
        return num in cls.figs

    @classmethod
    def get_all_fig_managers(cls):
        """Return a list of figure managers."""
        return list(cls.figs.values())

    @classmethod
    def get_num_fig_managers(cls):
        """Return the number of figures being managed."""
        return len(cls.figs)

    @classmethod
    def get_active(cls):
        """Return the active manager, or *None* if there is no manager."""
        return next(reversed(cls.figs.values())) if cls.figs else None

    @classmethod
    def _set_new_active_manager(cls, manager):
        """Adopt *manager* into pyplot and make it the active manager."""
        if not hasattr(manager, "_cidgcf"):
            manager._cidgcf = manager.canvas.mpl_connect(
                "button_press_event", lambda event: cls.set_active(manager))
        fig = manager.canvas.figure
        fig.number = manager.num
        label = fig.get_label()
        if label:
            manager.set_window_title(label)
        cls.set_active(manager)

    @classmethod
    def set_active(cls, manager):
        """Make *manager* the active manager."""
        cls.figs[manager.num] = manager
        cls.figs.move_to_end(manager.num)

    @classmethod
    def draw_all(cls, force=False):
        """
        Redraw all stale managed figures, or, if *force* is True, all managed
        figures.
        """
        for manager in cls.get_all_fig_managers():
            if force or manager.canvas.figure.stale:
                manager.canvas.draw_idle()


File: lib/matplotlib/pyplot.py
Line number range: 116 - 118
Content:
def _draw_all_if_interactive():
    if matplotlib.is_interactive():
        draw_all()


File: lib/matplotlib/pyplot.py
Line number range: 209 - 322
Content:
def switch_backend(newbackend):
    """
    Close all open figures and set the Matplotlib backend.

    The argument is case-insensitive.  Switching to an interactive backend is
    possible only if no event loop for another interactive backend has started.
    Switching to and from non-interactive backends is always possible.

    Parameters
    ----------
    newbackend : str
        The name of the backend to use.
    """
    global _backend_mod
    # make sure the init is pulled up so we can assign to it later
    import matplotlib.backends
    close("all")

    if newbackend is rcsetup._auto_backend_sentinel:
        current_framework = cbook._get_running_interactive_framework()
        mapping = {'qt': 'qtagg',
                   'gtk3': 'gtk3agg',
                   'gtk4': 'gtk4agg',
                   'wx': 'wxagg',
                   'tk': 'tkagg',
                   'macosx': 'macosx',
                   'headless': 'agg'}

        best_guess = mapping.get(current_framework, None)
        if best_guess is not None:
            candidates = [best_guess]
        else:
            candidates = []
        candidates += [
            "macosx", "qtagg", "gtk4agg", "gtk3agg", "tkagg", "wxagg"]

        # Don't try to fallback on the cairo-based backends as they each have
        # an additional dependency (pycairo) over the agg-based backend, and
        # are of worse quality.
        for candidate in candidates:
            try:
                switch_backend(candidate)
            except ImportError:
                continue
            else:
                rcParamsOrig['backend'] = candidate
                return
        else:
            # Switching to Agg should always succeed; if it doesn't, let the
            # exception propagate out.
            switch_backend("agg")
            rcParamsOrig["backend"] = "agg"
            return

    backend_mod = importlib.import_module(
        cbook._backend_module_name(newbackend))
    canvas_class = backend_mod.FigureCanvas

    required_framework = _get_required_interactive_framework(backend_mod)
    if required_framework is not None:
        current_framework = cbook._get_running_interactive_framework()
        if (current_framework and required_framework
                and current_framework != required_framework):
            raise ImportError(
                "Cannot load backend {!r} which requires the {!r} interactive "
                "framework, as {!r} is currently running".format(
                    newbackend, required_framework, current_framework))

    # Load the new_figure_manager(), draw_if_interactive(), and show()
    # functions from the backend.

    # Classically, backends can directly export these functions.  This should
    # keep working for backcompat.
    new_figure_manager = getattr(backend_mod, "new_figure_manager", None)
    # draw_if_interactive = getattr(backend_mod, "draw_if_interactive", None)
    # show = getattr(backend_mod, "show", None)
    # In that classical approach, backends are implemented as modules, but
    # "inherit" default method implementations from backend_bases._Backend.
    # This is achieved by creating a "class" that inherits from
    # backend_bases._Backend and whose body is filled with the module globals.
    class backend_mod(matplotlib.backend_bases._Backend):
        locals().update(vars(backend_mod))

    # However, the newer approach for defining new_figure_manager (and, in
    # the future, draw_if_interactive and show) is to derive them from canvas
    # methods.  In that case, also update backend_mod accordingly.
    if new_figure_manager is None:
        def new_figure_manager_given_figure(num, figure):
            return canvas_class.new_manager(figure, num)

        def new_figure_manager(num, *args, FigureClass=Figure, **kwargs):
            fig = FigureClass(*args, **kwargs)
            return new_figure_manager_given_figure(num, fig)

        backend_mod.new_figure_manager_given_figure = \
            new_figure_manager_given_figure
        backend_mod.new_figure_manager = new_figure_manager

    _log.debug("Loaded backend %s version %s.",
               newbackend, backend_mod.backend_version)

    rcParams['backend'] = rcParamsDefault['backend'] = newbackend
    _backend_mod = backend_mod
    for func_name in ["new_figure_manager", "draw_if_interactive", "show"]:
        globals()[func_name].__signature__ = inspect.signature(
            getattr(backend_mod, func_name))

    # Need to keep a global reference to the backend for compatibility reasons.
    # See https://github.com/matplotlib/matplotlib/issues/6092
    matplotlib.backends.backend = newbackend

    # make sure the repl display hook is installed in case we become
    # interactive
    install_repl_displayhook()


File: lib/matplotlib/pyplot.py
Line number range: 334 - 337
Content:
def new_figure_manager(*args, **kwargs):
    """Create a new figure manager instance."""
    _warn_if_gui_out_of_main_thread()
    return _get_backend_mod().new_figure_manager(*args, **kwargs)


File: lib/matplotlib/pyplot.py
Line number range: 879 - 881
Content:
def get_fignums():
    """Return a list of existing figure numbers."""
    return sorted(_pylab_helpers.Gcf.figs)


File: lib/matplotlib/pyplot.py
Line number range: 918 - 957
Content:
def close(fig=None):
    """
    Close a figure window.

    Parameters
    ----------
    fig : None or int or str or `.Figure`
        The figure to close. There are a number of ways to specify this:

        - *None*: the current figure
        - `.Figure`: the given `.Figure` instance
        - ``int``: a figure number
        - ``str``: a figure name
        - 'all': all figures

    """
    if fig is None:
        manager = _pylab_helpers.Gcf.get_active()
        if manager is None:
            return
        else:
            _pylab_helpers.Gcf.destroy(manager)
    elif fig == 'all':
        _pylab_helpers.Gcf.destroy_all()
    elif isinstance(fig, int):
        _pylab_helpers.Gcf.destroy(fig)
    elif hasattr(fig, 'int'):
        # if we are dealing with a type UUID, we
        # can use its integer representation
        _pylab_helpers.Gcf.destroy(fig.int)
    elif isinstance(fig, str):
        all_labels = get_figlabels()
        if fig in all_labels:
            num = get_fignums()[all_labels.index(fig)]
            _pylab_helpers.Gcf.destroy(num)
    elif isinstance(fig, Figure):
        _pylab_helpers.Gcf.destroy_fig(fig)
    else:
        raise TypeError("close() argument must be a Figure, an int, a string, "
                        "or None, not %s" % type(fig))


File: lib/matplotlib/pyplot.py
Line number range: 960 - 962
Content:
def clf():
    """Clear the current figure."""
    gcf().clear()


File: lib/matplotlib/pyplot.py
Line number range: 991 - 992
Content:
def figlegend(*args, **kwargs):
    return gcf().legend(*args, **kwargs)


File: lib/matplotlib/pyplot.py
Line number range: 1114 - 1117
Content:
def cla():
    """Clear the current axes."""
    # Not generated via boilerplate.py to allow a different docstring.
    return gca().cla()

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-20 20:28:10,671 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user query specifically asks for the full source code of the `Gcf` class.\n   - This context provides the complete definition of the `Gcf` class.\n2. Extended relevance:\n   - The `Gcf` class is central to managing figures in pyplot, which is a core part of the user's purpose for understanding the execution trace of figure creation and destruction.", relative_path='lib/matplotlib/_pylab_helpers.py', start_line=10, end_line=141), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user query specifically asks for the source code of the `new_figure_manager` function.\n   - This context provides the definition of the `new_figure_manager` function in `pyplot`.\n2. Extended relevance:\n   - This function is the entry point for creating new figures in pyplot, making it a crucial starting point for the execution trace the user wants to build.', relative_path='lib/matplotlib/pyplot.py', start_line=334, end_line=337), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user query specifically asks for the source code of the `close` function.\n   - This context provides the complete implementation of the `close` function.\n2. Extended relevance:\n   - The `close` function is responsible for destroying figures, which is a key part of the execution trace the user wants to understand, especially in relation to `Gcf.destroy_all`.', relative_path='lib/matplotlib/pyplot.py', start_line=918, end_line=957)]
2025-12-20 20:28:10,674 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 3 contexts to memory for query: Please provide the full source code for the `Gcf` class from `lib/matplotlib/_pylab_helpers.py`, and the functions `new_figure_manager` and `close` from `lib/matplotlib/pyplot.py`.
2025-12-20 20:28:10,674 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-20 20:28:10,674 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-20 20:28:10,674 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 3 new contexts to 7 existing contexts
2025-12-20 20:28:10,674 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 9 total contexts (removed 1 duplicates)
2025-12-20 20:28:10,675 - thread-123405873448640.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-20 20:28:10,676 - thread-123405873448640.prometheus_context_collector - INFO - Successfully retrieved 9 context snippets
