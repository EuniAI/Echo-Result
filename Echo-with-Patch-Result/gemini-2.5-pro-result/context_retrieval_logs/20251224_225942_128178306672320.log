2025-12-24 22:59:42,900 - thread-128178306672320.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Using multiple FilteredRelation with different filters but for same relation is ignored.

Description: Description
	 
		(last modified by lind-marcus)
	 
I have a relation that ALWAYS have at least 1 entry with is_all=True and then I have an optional entry that could have is_all=False but instead have zone set.
I'm trying to use FilteredRelation together with Case(When()) to ensure that it use the zone level one (if exist) and fall back on "All" if zone do not exist.
from django.db.models import FilteredRelation
qs.alias(
	relation_zone=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__zone=F("zone"))
	),
	relation_all=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__is_all=True)
	),
	price_zone=F("relation_zone__price")
).annotate(
	price_final=Case(
		When(
			price_zone__isnull=True,
			then=F("relation_all__price"),
		),
		default=F("price_zone")
	)
)
I noticed that when using multiple FilteredRelation with the same relation (myrelation__nested) it actually just generates a single SQL JOIN (if inspecting the raw SQL) and ignores the other. So in this case if I do print(str(qs.query)) I would only see a join for relation_zone. Not for relation_all.
Is this intended behavior or should I be able to do the thing above?

Patch information:
diff --git a/django/db/models/sql/datastructures.py b/django/db/models/sql/datastructures.py
index 1edf040e82..3cdf602ef7 100644
--- a/django/db/models/sql/datastructures.py
+++ b/django/db/models/sql/datastructures.py
@@ -162,8 +162,9 @@ class Join:
         return hash(self.identity)
 
     def equals(self, other):
-        # Ignore filtered_relation in equality check.
-        return self.identity[:-1] == other.identity[:-1]
+        # Consider filtered_relation in equality check to avoid reusing joins
+        # with different FilteredRelation conditions.
+        return self.identity == other.identity
 
     def demote(self):
         new = self.relabeled_clone({})


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

2025-12-24 22:59:43,016 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── CODE_OF_CONDUCT.md
|   ├── FUNDING.yml
|   ├── SECURITY.md
|   └── workflows
|       ├── docs.yml
|       ├── linters.yml
|       ├── new_contributor_pr.yml
|       ├── schedule_tests.yml
|       ├── schedules.yml
|       └── tests.yml
├── .pre-commit-config.yaml
├── .readthedocs.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ig
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ms
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── ms
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tg
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── uz
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   ├── memcached.py
|   |   |   |   └── redis.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   ├── __init__.py
|   |   |   |   └── django_4_0.py
|   |   |   ├── database.py
|   |   |   ├── files.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── optimizemigration.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _functions.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   └── special.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── autoreload.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── connection.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── common.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── csrf.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── hypercorn.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── logging.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── filters.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── expressions.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── logging.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.15.txt
|   |   ├── 2.2.16.txt
|   |   ├── 2.2.17.txt
|   |   ├── 2.2.18.txt
|   |   ├── 2.2.19.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.20.txt
|   |   ├── 2.2.21.txt
|   |   ├── 2.2.22.txt
|   |   ├── 2.2.23.txt
|   |   ├── 2.2.24.txt
|   |   ├── 2.2.25.txt
|   |   ├── 2.2.26.txt
|   |   ├── 2.2.27.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.10.txt
|   |   ├── 3.0.11.txt
|   |   ├── 3.0.12.txt
|   |   ├── 3.0.13.txt
|   |   ├── 3.0.14.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.9.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.1.txt
|   |   ├── 3.1.10.txt
|   |   ├── 3.1.11.txt
|   |   ├── 3.1.12.txt
|   |   ├── 3.1.13.txt
|   |   ├── 3.1.14.txt
|   |   ├── 3.1.2.txt
|   |   ├── 3.1.3.txt
|   |   ├── 3.1.4.txt
|   |   ├── 3.1.5.txt
|   |   ├── 3.1.6.txt
|   |   ├── 3.1.7.txt
|   |   ├── 3.1.8.txt
|   |   ├── 3.1.9.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.1.txt
|   |   ├── 3.2.10.txt
|   |   ├── 3.2.11.txt
|   |   ├── 3.2.12.txt
|   |   ├── 3.2.2.txt
|   |   ├── 3.2.3.txt
|   |   ├── 3.2.4.txt
|   |   ├── 3.2.5.txt
|   |   ├── 3.2.6.txt
|   |   ├── 3.2.7.txt
|   |   ├── 3.2.8.txt
|   |   ├── 3.2.9.txt
|   |   ├── 3.2.txt
|   |   ├── 4.0.1.txt
|   |   ├── 4.0.2.txt
|   |   ├── 4.0.3.txt
|   |   ├── 4.0.4.txt
|   |   ├── 4.0.txt
|   |   ├── 4.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   ├── requirements.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   ├── jsi18n-mocks.test.js
|   |   └── navigation.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── .hidden
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       ├── noargs_command.py
    |   |       └── suppress_base_options_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_prevent_double_submission.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   ├── no_config_app
    |   |   └── __init__.py
    |   ├── one_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── tests.py
    |   ├── two_configs_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── two_configs_one_default_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   └── two_default_configs_app
    |       ├── __init__.py
    |       └── apps.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── app_unmigrated
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── test_base.py
    |   |   ├── test_client.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_functions.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   ├── tests.py
    |   └── tests_async.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models.py
    |   ├── template_test_apps
    |   |   ├── __init__.py
    |   |   ├── different_tags_app
    |   |   |   ├── __init__.py
    |   |   |   ├── apps.py
    |   |   |   └── templatetags
    |   |   ├── same_tags_app_1
    |   |   |   ├── __init__.py
    |   |   |   ├── apps.py
    |   |   |   └── templatetags
    |   |   └── same_tags_app_2
    |   |       ├── __init__.py
    |   |       ├── apps.py
    |   |       └── templatetags
    |   ├── test_4_0_compatibility.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_files.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_class_based_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── bad_function_based_error_handlers.py
    |       ├── beginning_with_slash.py
    |       ├── cbv_as_view.py
    |       ├── contains_tuple.py
    |       ├── good_class_based_error_handlers.py
    |       ├── good_function_based_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_migrations.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_collate.py
    |   |   ├── test_greatest.py
    |   |   ├── test_json_object.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_random.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── fake_client.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_csrf_cookie_masked.py
    |   ├── test_middleware_mixin.py
    |   ├── test_use_l10n.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       ├── custom_widget.html
    |   |       ├── cyclic_context_boundfield_render.html
    |   |       ├── error.html
    |   |       ├── form_snippet.html
    |   |       └── legend_test.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── tags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_deprecation_forms.py
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoadmin_deprecated
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── models.py
    |   |   |   └── test.html
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── unchanged
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_conflict_long_name
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second_migration_with_long_name.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_manual_porting
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_no_replaces
    |   |   ├── 0001_squashed_0002.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_pk.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── model_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_contains.py
    |   ├── test_db_returning.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   ├── test_sqlcompiler.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_clear_expired.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   ├── custom_sitemap_index.xml
    |   |   └── custom_sitemap_lastmod_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       ├── index_only.py
    |       └── sitemap_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── nested
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── one_var.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_debug.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Using multiple FilteredRelation with different filters but for same relation is ignored.

Description: Description
	 
		(last modified by lind-marcus)
	 
I have a relation that ALWAYS have at least 1 entry with is_all=True and then I have an optional entry that could have is_all=False but instead have zone set.
I'm trying to use FilteredRelation together with Case(When()) to ensure that it use the zone level one (if exist) and fall back on "All" if zone do not exist.
from django.db.models import FilteredRelation
qs.alias(
	relation_zone=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__zone=F("zone"))
	),
	relation_all=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__is_all=True)
	),
	price_zone=F("relation_zone__price")
).annotate(
	price_final=Case(
		When(
			price_zone__isnull=True,
			then=F("relation_all__price"),
		),
		default=F("price_zone")
	)
)
I noticed that when using multiple FilteredRelation with the same relation (myrelation__nested) it actually just generates a single SQL JOIN (if inspecting the raw SQL) and ignores the other. So in this case if I do print(str(qs.query)) I would only see a join for relation_zone. Not for relation_all.
Is this intended behavior or should I be able to do the thing above?

Patch information:
diff --git a/django/db/models/sql/datastructures.py b/django/db/models/sql/datastructures.py
index 1edf040e82..3cdf602ef7 100644
--- a/django/db/models/sql/datastructures.py
+++ b/django/db/models/sql/datastructures.py
@@ -162,8 +162,9 @@ class Join:
         return hash(self.identity)
 
     def equals(self, other):
-        # Ignore filtered_relation in equality check.
-        return self.identity[:-1] == other.identity[:-1]
+        # Consider filtered_relation in equality check to avoid reusing joins
+        # with different FilteredRelation conditions.
+        return self.identity == other.identity
 
     def demote(self):
         new = self.relabeled_clone({})


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 23:00:13,773 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user has reported an issue with how multiple `FilteredRelation` objects are handled and provided a patch modifying `django/db/models/sql/datastructures.py`. To understand the problem, I need to inspect the `Join` class within that file, specifically how its `identity` is created and used for equality checks, which is central to the bug. The current context is empty, so fetching this file is the first necessary step.' query='Please provide the full content of `django/db/models/sql/datastructures.py`.' extra_requirements='' purpose="This file contains the `Join` class, which is modified in the user's patch. Understanding its implementation is crucial to diagnosing the issue with `FilteredRelation`."
2025-12-24 23:00:13,774 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `django/db/models/sql/datastructures.py`.
2025-12-24 23:00:13,774 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 23:00:13,775 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 23:00:13,775 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 23:00:13,775 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `django/db/models/sql/datastructures.py`.
Purpose: This file contains the `Join` class, which is modified in the user's patch. Understanding its implementation is crucial to diagnosing the issue with `FilteredRelation`.
2025-12-24 23:00:15,852 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `django/db/models/sql/datastructures.py` as you requested. This will help you understand the implementation of the `Join` class and how it relates to the issue with `FilteredRelation`.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/sql/datastructures.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2109, 'candidates_token_count': 76, 'total_token_count': 2316, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2109}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 76}], 'thoughts_token_count': 131, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13537990419488205, 'model_name': 'gemini-2.5-pro'} id='run--24f1068b-ec71-41d1-ad7f-2d203f93f4a3-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/sql/datastructures.py'}, 'id': '88839b1d-e3b0-406f-aaea-641192789973', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2109, 'output_tokens': 76, 'total_tokens': 2316, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 131}}
2025-12-24 23:00:21,023 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have retrieved the full content of the file `django/db/models/sql/datastructures.py` for you. This file contains the `Join` class, which you noted was modified in the user's patch. Having the full implementation of this class and the surrounding code will be crucial for diagnosing the issue with `FilteredRelation`." additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5080, 'candidates_token_count': 70, 'total_token_count': 5579, 'cached_content_token_count': 1726, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5080}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1726}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 70}], 'thoughts_token_count': 429}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6606046949114118, 'model_name': 'gemini-2.5-pro'} id='run--9abf6282-ffdf-4202-abf6-0f7cc6a9bb33-0' usage_metadata={'input_tokens': 5080, 'output_tokens': 70, 'total_tokens': 5579, 'input_token_details': {'cache_read': 1726}, 'output_token_details': {'reasoning': 429}}
2025-12-24 23:00:21,025 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `django/db/models/sql/datastructures.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file contains the `Join` class, which is modified in the user's patch. Understanding its implementation is crucial to diagnosing the issue with `FilteredRelation`.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: django/db/models/sql/datastructures.py
Line number range: 1 - 220
Content:
1. """
2. Useful auxiliary data structures for query construction. Not useful outside
3. the SQL domain.
4. """
5. from django.db.models.sql.constants import INNER, LOUTER
6. 
7. 
8. class MultiJoin(Exception):
9.     """
10.     Used by join construction code to indicate the point at which a
11.     multi-valued join was attempted (if the caller wants to treat that
12.     exceptionally).
13.     """
14. 
15.     def __init__(self, names_pos, path_with_names):
16.         self.level = names_pos
17.         # The path travelled, this includes the path to the multijoin.
18.         self.names_with_path = path_with_names
19. 
20. 
21. class Empty:
22.     pass
23. 
24. 
25. class Join:
26.     """
27.     Used by sql.Query and sql.SQLCompiler to generate JOIN clauses into the
28.     FROM entry. For example, the SQL generated could be
29.         LEFT OUTER JOIN "sometable" T1
30.         ON ("othertable"."sometable_id" = "sometable"."id")
31. 
32.     This class is primarily used in Query.alias_map. All entries in alias_map
33.     must be Join compatible by providing the following attributes and methods:
34.         - table_name (string)
35.         - table_alias (possible alias for the table, can be None)
36.         - join_type (can be None for those entries that aren't joined from
37.           anything)
38.         - parent_alias (which table is this join's parent, can be None similarly
39.           to join_type)
40.         - as_sql()
41.         - relabeled_clone()
42.     """
43. 
44.     def __init__(
45.         self,
46.         table_name,
47.         parent_alias,
48.         table_alias,
49.         join_type,
50.         join_field,
51.         nullable,
52.         filtered_relation=None,
53.     ):
54.         # Join table
55.         self.table_name = table_name
56.         self.parent_alias = parent_alias
57.         # Note: table_alias is not necessarily known at instantiation time.
58.         self.table_alias = table_alias
59.         # LOUTER or INNER
60.         self.join_type = join_type
61.         # A list of 2-tuples to use in the ON clause of the JOIN.
62.         # Each 2-tuple will create one join condition in the ON clause.
63.         self.join_cols = join_field.get_joining_columns()
64.         # Along which field (or ForeignObjectRel in the reverse join case)
65.         self.join_field = join_field
66.         # Is this join nullabled?
67.         self.nullable = nullable
68.         self.filtered_relation = filtered_relation
69. 
70.     def as_sql(self, compiler, connection):
71.         """
72.         Generate the full
73.            LEFT OUTER JOIN sometable ON sometable.somecol = othertable.othercol, params
74.         clause for this join.
75.         """
76.         join_conditions = []
77.         params = []
78.         qn = compiler.quote_name_unless_alias
79.         qn2 = connection.ops.quote_name
80. 
81.         # Add a join condition for each pair of joining columns.
82.         for lhs_col, rhs_col in self.join_cols:
83.             join_conditions.append(
84.                 "%s.%s = %s.%s"
85.                 % (
86.                     qn(self.parent_alias),
87.                     qn2(lhs_col),
88.                     qn(self.table_alias),
89.                     qn2(rhs_col),
90.                 )
91.             )
92. 
93.         # Add a single condition inside parentheses for whatever
94.         # get_extra_restriction() returns.
95.         extra_cond = self.join_field.get_extra_restriction(
96.             self.table_alias, self.parent_alias
97.         )
98.         if extra_cond:
99.             extra_sql, extra_params = compiler.compile(extra_cond)
100.             join_conditions.append("(%s)" % extra_sql)
101.             params.extend(extra_params)
102.         if self.filtered_relation:
103.             extra_sql, extra_params = compiler.compile(self.filtered_relation)
104.             if extra_sql:
105.                 join_conditions.append("(%s)" % extra_sql)
106.                 params.extend(extra_params)
107.         if not join_conditions:
108.             # This might be a rel on the other end of an actual declared field.
109.             declared_field = getattr(self.join_field, "field", self.join_field)
110.             raise ValueError(
111.                 "Join generated an empty ON clause. %s did not yield either "
112.                 "joining columns or extra restrictions." % declared_field.__class__
113.             )
114.         on_clause_sql = " AND ".join(join_conditions)
115.         alias_str = (
116.             "" if self.table_alias == self.table_name else (" %s" % self.table_alias)
117.         )
118.         sql = "%s %s%s ON (%s)" % (
119.             self.join_type,
120.             qn(self.table_name),
121.             alias_str,
122.             on_clause_sql,
123.         )
124.         return sql, params
125. 
126.     def relabeled_clone(self, change_map):
127.         new_parent_alias = change_map.get(self.parent_alias, self.parent_alias)
128.         new_table_alias = change_map.get(self.table_alias, self.table_alias)
129.         if self.filtered_relation is not None:
130.             filtered_relation = self.filtered_relation.clone()
131.             filtered_relation.path = [
132.                 change_map.get(p, p) for p in self.filtered_relation.path
133.             ]
134.         else:
135.             filtered_relation = None
136.         return self.__class__(
137.             self.table_name,
138.             new_parent_alias,
139.             new_table_alias,
140.             self.join_type,
141.             self.join_field,
142.             self.nullable,
143.             filtered_relation=filtered_relation,
144.         )
145. 
146.     @property
147.     def identity(self):
148.         return (
149.             self.__class__,
150.             self.table_name,
151.             self.parent_alias,
152.             self.join_field,
153.             self.filtered_relation,
154.         )
155. 
156.     def __eq__(self, other):
157.         if not isinstance(other, Join):
158.             return NotImplemented
159.         return self.identity == other.identity
160. 
161.     def __hash__(self):
162.         return hash(self.identity)
163. 
164.     def equals(self, other):
165.         # Ignore filtered_relation in equality check.
166.         return self.identity[:-1] == other.identity[:-1]
167. 
168.     def demote(self):
169.         new = self.relabeled_clone({})
170.         new.join_type = INNER
171.         return new
172. 
173.     def promote(self):
174.         new = self.relabeled_clone({})
175.         new.join_type = LOUTER
176.         return new
177. 
178. 
179. class BaseTable:
180.     """
181.     The BaseTable class is used for base table references in FROM clause. For
182.     example, the SQL "foo" in
183.         SELECT * FROM "foo" WHERE somecond
184.     could be generated by this class.
185.     """
186. 
187.     join_type = None
188.     parent_alias = None
189.     filtered_relation = None
190. 
191.     def __init__(self, table_name, alias):
192.         self.table_name = table_name
193.         self.table_alias = alias
194. 
195.     def as_sql(self, compiler, connection):
196.         alias_str = (
197.             "" if self.table_alias == self.table_name else (" %s" % self.table_alias)
198.         )
199.         base_sql = compiler.quote_name_unless_alias(self.table_name)
200.         return base_sql + alias_str, []
201. 
202.     def relabeled_clone(self, change_map):
203.         return self.__class__(
204.             self.table_name, change_map.get(self.table_alias, self.table_alias)
205.         )
206. 
207.     @property
208.     def identity(self):
209.         return self.__class__, self.table_name, self.table_alias
210. 
211.     def __eq__(self, other):
212.         if not isinstance(other, BaseTable):
213.             return NotImplemented
214.         return self.identity == other.identity
215. 
216.     def __hash__(self):
217.         return hash(self.identity)
218. 
219.     def equals(self, other):
220.         return self.identity == other.identity

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 23:00:27,965 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of the file `django/db/models/sql/datastructures.py`.\n2. Extended relevance:\n   - The provided context contains the entire content of the requested file as seen so far. The purpose mentions the `Join` class, which is fully contained within this context and is crucial for the user's task of diagnosing an issue with `FilteredRelation`.", relative_path='django/db/models/sql/datastructures.py', start_line=1, end_line=220)]
2025-12-24 23:00:27,966 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of `django/db/models/sql/datastructures.py`.
2025-12-24 23:00:27,966 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 23:00:27,966 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 23:00:27,966 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-24 23:00:27,966 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-24 23:00:27,967 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── CODE_OF_CONDUCT.md
|   ├── FUNDING.yml
|   ├── SECURITY.md
|   └── workflows
|       ├── docs.yml
|       ├── linters.yml
|       ├── new_contributor_pr.yml
|       ├── schedule_tests.yml
|       ├── schedules.yml
|       └── tests.yml
├── .pre-commit-config.yaml
├── .readthedocs.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ig
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ms
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── ms
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tg
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── uz
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   ├── memcached.py
|   |   |   |   └── redis.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   ├── __init__.py
|   |   |   |   └── django_4_0.py
|   |   |   ├── database.py
|   |   |   ├── files.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── optimizemigration.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _functions.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   └── special.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── autoreload.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── connection.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── common.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── csrf.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── hypercorn.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── logging.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── filters.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── expressions.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── logging.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.15.txt
|   |   ├── 2.2.16.txt
|   |   ├── 2.2.17.txt
|   |   ├── 2.2.18.txt
|   |   ├── 2.2.19.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.20.txt
|   |   ├── 2.2.21.txt
|   |   ├── 2.2.22.txt
|   |   ├── 2.2.23.txt
|   |   ├── 2.2.24.txt
|   |   ├── 2.2.25.txt
|   |   ├── 2.2.26.txt
|   |   ├── 2.2.27.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.10.txt
|   |   ├── 3.0.11.txt
|   |   ├── 3.0.12.txt
|   |   ├── 3.0.13.txt
|   |   ├── 3.0.14.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.9.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.1.txt
|   |   ├── 3.1.10.txt
|   |   ├── 3.1.11.txt
|   |   ├── 3.1.12.txt
|   |   ├── 3.1.13.txt
|   |   ├── 3.1.14.txt
|   |   ├── 3.1.2.txt
|   |   ├── 3.1.3.txt
|   |   ├── 3.1.4.txt
|   |   ├── 3.1.5.txt
|   |   ├── 3.1.6.txt
|   |   ├── 3.1.7.txt
|   |   ├── 3.1.8.txt
|   |   ├── 3.1.9.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.1.txt
|   |   ├── 3.2.10.txt
|   |   ├── 3.2.11.txt
|   |   ├── 3.2.12.txt
|   |   ├── 3.2.2.txt
|   |   ├── 3.2.3.txt
|   |   ├── 3.2.4.txt
|   |   ├── 3.2.5.txt
|   |   ├── 3.2.6.txt
|   |   ├── 3.2.7.txt
|   |   ├── 3.2.8.txt
|   |   ├── 3.2.9.txt
|   |   ├── 3.2.txt
|   |   ├── 4.0.1.txt
|   |   ├── 4.0.2.txt
|   |   ├── 4.0.3.txt
|   |   ├── 4.0.4.txt
|   |   ├── 4.0.txt
|   |   ├── 4.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   ├── requirements.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   ├── jsi18n-mocks.test.js
|   |   └── navigation.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── .hidden
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       ├── noargs_command.py
    |   |       └── suppress_base_options_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_prevent_double_submission.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   ├── no_config_app
    |   |   └── __init__.py
    |   ├── one_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── tests.py
    |   ├── two_configs_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── two_configs_one_default_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   └── two_default_configs_app
    |       ├── __init__.py
    |       └── apps.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── app_unmigrated
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── test_base.py
    |   |   ├── test_client.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_functions.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   ├── tests.py
    |   └── tests_async.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models.py
    |   ├── template_test_apps
    |   |   ├── __init__.py
    |   |   ├── different_tags_app
    |   |   |   ├── __init__.py
    |   |   |   ├── apps.py
    |   |   |   └── templatetags
    |   |   ├── same_tags_app_1
    |   |   |   ├── __init__.py
    |   |   |   ├── apps.py
    |   |   |   └── templatetags
    |   |   └── same_tags_app_2
    |   |       ├── __init__.py
    |   |       ├── apps.py
    |   |       └── templatetags
    |   ├── test_4_0_compatibility.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_files.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_class_based_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── bad_function_based_error_handlers.py
    |       ├── beginning_with_slash.py
    |       ├── cbv_as_view.py
    |       ├── contains_tuple.py
    |       ├── good_class_based_error_handlers.py
    |       ├── good_function_based_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_migrations.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_collate.py
    |   |   ├── test_greatest.py
    |   |   ├── test_json_object.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_random.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── fake_client.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_csrf_cookie_masked.py
    |   ├── test_middleware_mixin.py
    |   ├── test_use_l10n.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       ├── custom_widget.html
    |   |       ├── cyclic_context_boundfield_render.html
    |   |       ├── error.html
    |   |       ├── form_snippet.html
    |   |       └── legend_test.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── tags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_deprecation_forms.py
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoadmin_deprecated
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── models.py
    |   |   |   └── test.html
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── unchanged
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_conflict_long_name
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second_migration_with_long_name.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_manual_porting
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_no_replaces
    |   |   ├── 0001_squashed_0002.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_pk.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── model_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_contains.py
    |   ├── test_db_returning.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   ├── test_sqlcompiler.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_clear_expired.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   ├── custom_sitemap_index.xml
    |   |   └── custom_sitemap_lastmod_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       ├── index_only.py
    |       └── sitemap_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── nested
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── one_var.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_debug.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Using multiple FilteredRelation with different filters but for same relation is ignored.

Description: Description
	 
		(last modified by lind-marcus)
	 
I have a relation that ALWAYS have at least 1 entry with is_all=True and then I have an optional entry that could have is_all=False but instead have zone set.
I'm trying to use FilteredRelation together with Case(When()) to ensure that it use the zone level one (if exist) and fall back on "All" if zone do not exist.
from django.db.models import FilteredRelation
qs.alias(
	relation_zone=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__zone=F("zone"))
	),
	relation_all=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__is_all=True)
	),
	price_zone=F("relation_zone__price")
).annotate(
	price_final=Case(
		When(
			price_zone__isnull=True,
			then=F("relation_all__price"),
		),
		default=F("price_zone")
	)
)
I noticed that when using multiple FilteredRelation with the same relation (myrelation__nested) it actually just generates a single SQL JOIN (if inspecting the raw SQL) and ignores the other. So in this case if I do print(str(qs.query)) I would only see a join for relation_zone. Not for relation_all.
Is this intended behavior or should I be able to do the thing above?

Patch information:
diff --git a/django/db/models/sql/datastructures.py b/django/db/models/sql/datastructures.py
index 1edf040e82..3cdf602ef7 100644
--- a/django/db/models/sql/datastructures.py
+++ b/django/db/models/sql/datastructures.py
@@ -162,8 +162,9 @@ class Join:
         return hash(self.identity)
 
     def equals(self, other):
-        # Ignore filtered_relation in equality check.
-        return self.identity[:-1] == other.identity[:-1]
+        # Consider filtered_relation in equality check to avoid reusing joins
+        # with different FilteredRelation conditions.
+        return self.identity == other.identity
 
     def demote(self):
         new = self.relabeled_clone({})


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `django/db/models/sql/datastructures.py`.
Extra Requirements: 
Purpose: This file contains the `Join` class, which is modified in the user's patch. Understanding its implementation is crucial to diagnosing the issue with `FilteredRelation`.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: django/db/models/sql/datastructures.py
Line number range: 1 - 220
Content:
1. """
2. Useful auxiliary data structures for query construction. Not useful outside
3. the SQL domain.
4. """
5. from django.db.models.sql.constants import INNER, LOUTER
6. 
7. 
8. class MultiJoin(Exception):
9.     """
10.     Used by join construction code to indicate the point at which a
11.     multi-valued join was attempted (if the caller wants to treat that
12.     exceptionally).
13.     """
14. 
15.     def __init__(self, names_pos, path_with_names):
16.         self.level = names_pos
17.         # The path travelled, this includes the path to the multijoin.
18.         self.names_with_path = path_with_names
19. 
20. 
21. class Empty:
22.     pass
23. 
24. 
25. class Join:
26.     """
27.     Used by sql.Query and sql.SQLCompiler to generate JOIN clauses into the
28.     FROM entry. For example, the SQL generated could be
29.         LEFT OUTER JOIN "sometable" T1
30.         ON ("othertable"."sometable_id" = "sometable"."id")
31. 
32.     This class is primarily used in Query.alias_map. All entries in alias_map
33.     must be Join compatible by providing the following attributes and methods:
34.         - table_name (string)
35.         - table_alias (possible alias for the table, can be None)
36.         - join_type (can be None for those entries that aren't joined from
37.           anything)
38.         - parent_alias (which table is this join's parent, can be None similarly
39.           to join_type)
40.         - as_sql()
41.         - relabeled_clone()
42.     """
43. 
44.     def __init__(
45.         self,
46.         table_name,
47.         parent_alias,
48.         table_alias,
49.         join_type,
50.         join_field,
51.         nullable,
52.         filtered_relation=None,
53.     ):
54.         # Join table
55.         self.table_name = table_name
56.         self.parent_alias = parent_alias
57.         # Note: table_alias is not necessarily known at instantiation time.
58.         self.table_alias = table_alias
59.         # LOUTER or INNER
60.         self.join_type = join_type
61.         # A list of 2-tuples to use in the ON clause of the JOIN.
62.         # Each 2-tuple will create one join condition in the ON clause.
63.         self.join_cols = join_field.get_joining_columns()
64.         # Along which field (or ForeignObjectRel in the reverse join case)
65.         self.join_field = join_field
66.         # Is this join nullabled?
67.         self.nullable = nullable
68.         self.filtered_relation = filtered_relation
69. 
70.     def as_sql(self, compiler, connection):
71.         """
72.         Generate the full
73.            LEFT OUTER JOIN sometable ON sometable.somecol = othertable.othercol, params
74.         clause for this join.
75.         """
76.         join_conditions = []
77.         params = []
78.         qn = compiler.quote_name_unless_alias
79.         qn2 = connection.ops.quote_name
80. 
81.         # Add a join condition for each pair of joining columns.
82.         for lhs_col, rhs_col in self.join_cols:
83.             join_conditions.append(
84.                 "%s.%s = %s.%s"
85.                 % (
86.                     qn(self.parent_alias),
87.                     qn2(lhs_col),
88.                     qn(self.table_alias),
89.                     qn2(rhs_col),
90.                 )
91.             )
92. 
93.         # Add a single condition inside parentheses for whatever
94.         # get_extra_restriction() returns.
95.         extra_cond = self.join_field.get_extra_restriction(
96.             self.table_alias, self.parent_alias
97.         )
98.         if extra_cond:
99.             extra_sql, extra_params = compiler.compile(extra_cond)
100.             join_conditions.append("(%s)" % extra_sql)
101.             params.extend(extra_params)
102.         if self.filtered_relation:
103.             extra_sql, extra_params = compiler.compile(self.filtered_relation)
104.             if extra_sql:
105.                 join_conditions.append("(%s)" % extra_sql)
106.                 params.extend(extra_params)
107.         if not join_conditions:
108.             # This might be a rel on the other end of an actual declared field.
109.             declared_field = getattr(self.join_field, "field", self.join_field)
110.             raise ValueError(
111.                 "Join generated an empty ON clause. %s did not yield either "
112.                 "joining columns or extra restrictions." % declared_field.__class__
113.             )
114.         on_clause_sql = " AND ".join(join_conditions)
115.         alias_str = (
116.             "" if self.table_alias == self.table_name else (" %s" % self.table_alias)
117.         )
118.         sql = "%s %s%s ON (%s)" % (
119.             self.join_type,
120.             qn(self.table_name),
121.             alias_str,
122.             on_clause_sql,
123.         )
124.         return sql, params
125. 
126.     def relabeled_clone(self, change_map):
127.         new_parent_alias = change_map.get(self.parent_alias, self.parent_alias)
128.         new_table_alias = change_map.get(self.table_alias, self.table_alias)
129.         if self.filtered_relation is not None:
130.             filtered_relation = self.filtered_relation.clone()
131.             filtered_relation.path = [
132.                 change_map.get(p, p) for p in self.filtered_relation.path
133.             ]
134.         else:
135.             filtered_relation = None
136.         return self.__class__(
137.             self.table_name,
138.             new_parent_alias,
139.             new_table_alias,
140.             self.join_type,
141.             self.join_field,
142.             self.nullable,
143.             filtered_relation=filtered_relation,
144.         )
145. 
146.     @property
147.     def identity(self):
148.         return (
149.             self.__class__,
150.             self.table_name,
151.             self.parent_alias,
152.             self.join_field,
153.             self.filtered_relation,
154.         )
155. 
156.     def __eq__(self, other):
157.         if not isinstance(other, Join):
158.             return NotImplemented
159.         return self.identity == other.identity
160. 
161.     def __hash__(self):
162.         return hash(self.identity)
163. 
164.     def equals(self, other):
165.         # Ignore filtered_relation in equality check.
166.         return self.identity[:-1] == other.identity[:-1]
167. 
168.     def demote(self):
169.         new = self.relabeled_clone({})
170.         new.join_type = INNER
171.         return new
172. 
173.     def promote(self):
174.         new = self.relabeled_clone({})
175.         new.join_type = LOUTER
176.         return new
177. 
178. 
179. class BaseTable:
180.     """
181.     The BaseTable class is used for base table references in FROM clause. For
182.     example, the SQL "foo" in
183.         SELECT * FROM "foo" WHERE somecond
184.     could be generated by this class.
185.     """
186. 
187.     join_type = None
188.     parent_alias = None
189.     filtered_relation = None
190. 
191.     def __init__(self, table_name, alias):
192.         self.table_name = table_name
193.         self.table_alias = alias
194. 
195.     def as_sql(self, compiler, connection):
196.         alias_str = (
197.             "" if self.table_alias == self.table_name else (" %s" % self.table_alias)
198.         )
199.         base_sql = compiler.quote_name_unless_alias(self.table_name)
200.         return base_sql + alias_str, []
201. 
202.     def relabeled_clone(self, change_map):
203.         return self.__class__(
204.             self.table_name, change_map.get(self.table_alias, self.table_alias)
205.         )
206. 
207.     @property
208.     def identity(self):
209.         return self.__class__, self.table_name, self.table_alias
210. 
211.     def __eq__(self, other):
212.         if not isinstance(other, BaseTable):
213.             return NotImplemented
214.         return self.identity == other.identity
215. 
216.     def __hash__(self):
217.         return hash(self.identity)
218. 
219.     def equals(self, other):
220.         return self.identity == other.identity

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 23:01:04,596 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's patch modifies `Join.equals()` in `django/db/models/sql/datastructures.py` to correctly handle multiple `FilteredRelation`s. To understand why this change is necessary, I need to examine how `Join.equals()` is used to determine if a join can be reused. My analysis suggests this logic resides in `django/db/models/sql/query.py`, specifically within methods like `setup_joins` and `join_is_needed`. This file is essential to understand the join generation process and the root cause of the bug." query='Please provide the full content of `django/db/models/sql/query.py`.' extra_requirements='' purpose="This file contains the core logic for creating and reusing joins, which is central to the user's reported issue with `FilteredRelation`."
2025-12-24 23:01:04,597 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `django/db/models/sql/query.py`.
2025-12-24 23:01:04,597 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 23:01:04,599 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 23:01:04,599 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 23:01:04,599 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `django/db/models/sql/query.py`.
Purpose: This file contains the core logic for creating and reusing joins, which is central to the user's reported issue with `FilteredRelation`.
2025-12-24 23:01:06,768 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/sql/query.py"}'}, '__gemini_function_call_thought_signatures__': {'015e6c7f-2e75-4535-ba5d-3aa694a799ca': 'CoIFAY89a1+N3C36hTC/XV50OMIhR/oRG3m2aSFzGhUJu16DH3SOq6Chqp7Y7PVV9v24T/hPDPlcYlihxEXRzUANWA5+JDZCDZ1dO71s7Z+G9PKvFwhlS33AxLvmlJvUKeTWdL7FO2u9SNRH5ga7txlNhh+x6wxqGVNXROMcmrZlsv1WnKjm8yE2EpTt314TJGfxhxQ08G9PgWdLp6zBOMZE7bq36Rlv1g/IzfS1m+Tx8vQaW1eGwHrXgtMWVov3+4vxYyOyCe7WOY6imyupEONC3X96xgaHFzzBNm7RYJ+qHyM7XcldF/r2IQCmE/TxIlJ/1nwY0i8a+bShCfytBXS+ByvDbRGSTqJV8STsDshSgz+5iaowU2o4bNMxVAdmwBf5LP3EDDFB136NRdV+5YmkOC7lYgjvdAZjqp/1tWHWkHZyxub0eVSgzVv6kiymmwxUxNd1s1M7/DQyncZZlTKHt7MGwia7JRCRL3cO+jmxFOCjNnsTyzc2n+xR3MvU3glTW2Prf616eJ7dFhKxLeJWngO2/ucslu/bZi/f3668QAJAyzttp4comApR3pyFr0CSxJJhwkX99LDW1Wf+DyPqj7owvtSCsyJFpO4akJFsZSiGSwvRuD0c0/e8x47dtHyqJWPsuI2B9vn5cj0zSJ3uVA+0Lehg6L79axWr99jx7q4z54McPsshgjFtAperh1FfFOrX6aOcLJCqf2SXPiGkB1Z3m8JWzDLLsoFJUrouALIC+44j5Ispc6v/snHwLBAAn2tTh7eyTcz+VLUmt9SYqnhEsr2P1pwmg07JgyXIIPKkWH7dEGvAzaXS3gk9QuNE69wpkL4OayINgA7M9xR0WW82'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2102, 'candidates_token_count': 25, 'total_token_count': 2273, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2102}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 146, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.24541208267211914, 'model_name': 'gemini-2.5-pro'} id='run--93d01bbf-d646-4070-a337-d10f9ec6389a-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/sql/query.py'}, 'id': '015e6c7f-2e75-4535-ba5d-3aa694a799ca', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2102, 'output_tokens': 25, 'total_tokens': 2273, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 146}}
2025-12-24 23:01:09,018 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 501.0, "end_line": 9999.0, "relative_path": "django/db/models/sql/query.py"}'}, '__gemini_function_call_thought_signatures__': {'bad2911b-0f7d-4e05-8a20-fd0ea74bb2a9': 'Cp0DAY89a19s9DvsMgi/92xhS1bUZ8g3/3pDnq9FKI5RtqMdUga0zDLPjoqIGVbBuLOcoPaRVE8KOhBFYK6f5uMixJ4DJrR2pRE3WtlGruIe9SPBwR7/da2aFG5xKOdXhUVuz0NymHKg83yiIzv/Eo2FDROlYSwzJdGWA1kRfeYsvIexeUEiLagRjrUGixBjxULzGa8JRF1rlbM/zDbGVExh5C5rQW+0RRCALNvNvnBL3ehVNHr0DpZhOKy4VT21m5MexxcpZrz8/TNPR4u46b9lS0W5DHnfkLO38vKr4U8aEEFk+7SYOTcXp8ruyG9+lfRT1UMAiUMQ7U2eGvlPzdQKGTJU4GlNMctW0A4w/ZfvSbsK7qDiGcfn7NuGXL9KBTMh52jwucojB9QAqWkhrwWY8KWAZ0yZBVQdwdjUu5s8H2LaiBM/27bXKa6GiQMI4e4w8TeDc4CXHOl9UDpIcRCKsp96ZiKTZS+3qabcQVpwmbpePsPKKbKtUfKjlkccnqNbr5bGgQth6FTDTTEFV8U8owieHonVdyS6/POA83A='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9316, 'candidates_token_count': 31, 'total_token_count': 9458, 'cached_content_token_count': 1846, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9462}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1846}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 111}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3157243113363943, 'model_name': 'gemini-2.5-pro'} id='run--269ce011-d997-426d-a542-d22122c8a458-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 501.0, 'end_line': 9999.0, 'relative_path': 'django/db/models/sql/query.py'}, 'id': 'bad2911b-0f7d-4e05-8a20-fd0ea74bb2a9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9316, 'output_tokens': 31, 'total_tokens': 9458, 'input_token_details': {'cache_read': 1846}, 'output_token_details': {'reasoning': 111}}
2025-12-24 23:01:11,934 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of `django/db/models/sql/query.py`. This was done by first reading the initial 500 lines of the file, and then fetching the remaining content from line 501 to the end. The full content of the file is now available.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 44122, 'candidates_token_count': 64, 'total_token_count': 44288, 'cached_content_token_count': 9826, 'prompt_tokens_details': [{'modality': 1, 'token_count': 44379}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9826}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 64}], 'thoughts_token_count': 102}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3188285231590271, 'model_name': 'gemini-2.5-pro'} id='run--d72783f4-0210-4699-8809-98e20de988e7-0' usage_metadata={'input_tokens': 44122, 'output_tokens': 64, 'total_tokens': 44288, 'input_token_details': {'cache_read': 9826}, 'output_token_details': {'reasoning': 102}}
2025-12-24 23:01:11,937 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `django/db/models/sql/query.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This file contains the core logic for creating and reusing joins, which is central to the user's reported issue with `FilteredRelation`.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: django/db/models/sql/query.py
Line number range: 1 - 500
Content:
1. """
2. Create SQL statements for QuerySets.
3. 
4. The code in here encapsulates all of the SQL construction so that QuerySets
5. themselves do not have to (and could be backed by things other than SQL
6. databases). The abstraction barrier only works one way: this module has to know
7. all about the internals of models in order to get the information it needs.
8. """
9. import copy
10. import difflib
11. import functools
12. import sys
13. from collections import Counter, namedtuple
14. from collections.abc import Iterator, Mapping
15. from itertools import chain, count, product
16. from string import ascii_uppercase
17. 
18. from django.core.exceptions import FieldDoesNotExist, FieldError
19. from django.db import DEFAULT_DB_ALIAS, NotSupportedError, connections
20. from django.db.models.aggregates import Count
21. from django.db.models.constants import LOOKUP_SEP
22. from django.db.models.expressions import (
23.     BaseExpression,
24.     Col,
25.     Exists,
26.     F,
27.     OuterRef,
28.     Ref,
29.     ResolvedOuterRef,
30. )
31. from django.db.models.fields import Field
32. from django.db.models.fields.related_lookups import MultiColSource
33. from django.db.models.lookups import Lookup
34. from django.db.models.query_utils import (
35.     Q,
36.     check_rel_lookup_compatibility,
37.     refs_expression,
38. )
39. from django.db.models.sql.constants import INNER, LOUTER, ORDER_DIR, SINGLE
40. from django.db.models.sql.datastructures import BaseTable, Empty, Join, MultiJoin
41. from django.db.models.sql.where import AND, OR, ExtraWhere, NothingNode, WhereNode
42. from django.utils.functional import cached_property
43. from django.utils.tree import Node
44. 
45. __all__ = ["Query", "RawQuery"]
46. 
47. 
48. def get_field_names_from_opts(opts):
49.     if opts is None:
50.         return set()
51.     return set(
52.         chain.from_iterable(
53.             (f.name, f.attname) if f.concrete else (f.name,) for f in opts.get_fields()
54.         )
55.     )
56. 
57. 
58. def get_children_from_q(q):
59.     for child in q.children:
60.         if isinstance(child, Node):
61.             yield from get_children_from_q(child)
62.         else:
63.             yield child
64. 
65. 
66. JoinInfo = namedtuple(
67.     "JoinInfo",
68.     ("final_field", "targets", "opts", "joins", "path", "transform_function"),
69. )
70. 
71. 
72. class RawQuery:
73.     """A single raw SQL query."""
74. 
75.     def __init__(self, sql, using, params=()):
76.         self.params = params
77.         self.sql = sql
78.         self.using = using
79.         self.cursor = None
80. 
81.         # Mirror some properties of a normal query so that
82.         # the compiler can be used to process results.
83.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
84.         self.extra_select = {}
85.         self.annotation_select = {}
86. 
87.     def chain(self, using):
88.         return self.clone(using)
89. 
90.     def clone(self, using):
91.         return RawQuery(self.sql, using, params=self.params)
92. 
93.     def get_columns(self):
94.         if self.cursor is None:
95.             self._execute_query()
96.         converter = connections[self.using].introspection.identifier_converter
97.         return [converter(column_meta[0]) for column_meta in self.cursor.description]
98. 
99.     def __iter__(self):
100.         # Always execute a new query for a new iterator.
101.         # This could be optimized with a cache at the expense of RAM.
102.         self._execute_query()
103.         if not connections[self.using].features.can_use_chunked_reads:
104.             # If the database can't use chunked reads we need to make sure we
105.             # evaluate the entire query up front.
106.             result = list(self.cursor)
107.         else:
108.             result = self.cursor
109.         return iter(result)
110. 
111.     def __repr__(self):
112.         return "<%s: %s>" % (self.__class__.__name__, self)
113. 
114.     @property
115.     def params_type(self):
116.         if self.params is None:
117.             return None
118.         return dict if isinstance(self.params, Mapping) else tuple
119. 
120.     def __str__(self):
121.         if self.params_type is None:
122.             return self.sql
123.         return self.sql % self.params_type(self.params)
124. 
125.     def _execute_query(self):
126.         connection = connections[self.using]
127. 
128.         # Adapt parameters to the database, as much as possible considering
129.         # that the target type isn't known. See #17755.
130.         params_type = self.params_type
131.         adapter = connection.ops.adapt_unknown_value
132.         if params_type is tuple:
133.             params = tuple(adapter(val) for val in self.params)
134.         elif params_type is dict:
135.             params = {key: adapter(val) for key, val in self.params.items()}
136.         elif params_type is None:
137.             params = None
138.         else:
139.             raise RuntimeError("Unexpected params type: %s" % params_type)
140. 
141.         self.cursor = connection.cursor()
142.         self.cursor.execute(self.sql, params)
143. 
144. 
145. ExplainInfo = namedtuple("ExplainInfo", ("format", "options"))
146. 
147. 
148. class Query(BaseExpression):
149.     """A single SQL query."""
150. 
151.     alias_prefix = "T"
152.     empty_result_set_value = None
153.     subq_aliases = frozenset([alias_prefix])
154. 
155.     compiler = "SQLCompiler"
156. 
157.     base_table_class = BaseTable
158.     join_class = Join
159. 
160.     default_cols = True
161.     default_ordering = True
162.     standard_ordering = True
163. 
164.     filter_is_sticky = False
165.     subquery = False
166. 
167.     # SQL-related attributes.
168.     # Select and related select clauses are expressions to use in the SELECT
169.     # clause of the query. The select is used for cases where we want to set up
170.     # the select clause to contain other than default fields (values(),
171.     # subqueries...). Note that annotations go to annotations dictionary.
172.     select = ()
173.     # The group_by attribute can have one of the following forms:
174.     #  - None: no group by at all in the query
175.     #  - A tuple of expressions: group by (at least) those expressions.
176.     #    String refs are also allowed for now.
177.     #  - True: group by all select fields of the model
178.     # See compiler.get_group_by() for details.
179.     group_by = None
180.     order_by = ()
181.     low_mark = 0  # Used for offset/limit.
182.     high_mark = None  # Used for offset/limit.
183.     distinct = False
184.     distinct_fields = ()
185.     select_for_update = False
186.     select_for_update_nowait = False
187.     select_for_update_skip_locked = False
188.     select_for_update_of = ()
189.     select_for_no_key_update = False
190.     select_related = False
191.     # Arbitrary limit for select_related to prevents infinite recursion.
192.     max_depth = 5
193.     # Holds the selects defined by a call to values() or values_list()
194.     # excluding annotation_select and extra_select.
195.     values_select = ()
196. 
197.     # SQL annotation-related attributes.
198.     annotation_select_mask = None
199.     _annotation_select_cache = None
200. 
201.     # Set combination attributes.
202.     combinator = None
203.     combinator_all = False
204.     combined_queries = ()
205. 
206.     # These are for extensions. The contents are more or less appended verbatim
207.     # to the appropriate clause.
208.     extra_select_mask = None
209.     _extra_select_cache = None
210. 
211.     extra_tables = ()
212.     extra_order_by = ()
213. 
214.     # A tuple that is a set of model field names and either True, if these are
215.     # the fields to defer, or False if these are the only fields to load.
216.     deferred_loading = (frozenset(), True)
217. 
218.     explain_info = None
219. 
220.     def __init__(self, model, alias_cols=True):
221.         self.model = model
222.         self.alias_refcount = {}
223.         # alias_map is the most important data structure regarding joins.
224.         # It's used for recording which joins exist in the query and what
225.         # types they are. The key is the alias of the joined table (possibly
226.         # the table name) and the value is a Join-like object (see
227.         # sql.datastructures.Join for more information).
228.         self.alias_map = {}
229.         # Whether to provide alias to columns during reference resolving.
230.         self.alias_cols = alias_cols
231.         # Sometimes the query contains references to aliases in outer queries (as
232.         # a result of split_exclude). Correct alias quoting needs to know these
233.         # aliases too.
234.         # Map external tables to whether they are aliased.
235.         self.external_aliases = {}
236.         self.table_map = {}  # Maps table names to list of aliases.
237.         self.used_aliases = set()
238. 
239.         self.where = WhereNode()
240.         # Maps alias -> Annotation Expression.
241.         self.annotations = {}
242.         # These are for extensions. The contents are more or less appended
243.         # verbatim to the appropriate clause.
244.         self.extra = {}  # Maps col_alias -> (col_sql, params).
245. 
246.         self._filtered_relations = {}
247. 
248.     @property
249.     def output_field(self):
250.         if len(self.select) == 1:
251.             select = self.select[0]
252.             return getattr(select, "target", None) or select.field
253.         elif len(self.annotation_select) == 1:
254.             return next(iter(self.annotation_select.values())).output_field
255. 
256.     @property
257.     def has_select_fields(self):
258.         return bool(
259.             self.select or self.annotation_select_mask or self.extra_select_mask
260.         )
261. 
262.     @cached_property
263.     def base_table(self):
264.         for alias in self.alias_map:
265.             return alias
266. 
267.     def __str__(self):
268.         """
269.         Return the query as a string of SQL with the parameter values
270.         substituted in (use sql_with_params() to see the unsubstituted string).
271. 
272.         Parameter values won't necessarily be quoted correctly, since that is
273.         done by the database interface at execution time.
274.         """
275.         sql, params = self.sql_with_params()
276.         return sql % params
277. 
278.     def sql_with_params(self):
279.         """
280.         Return the query as an SQL string and the parameters that will be
281.         substituted into the query.
282.         """
283.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
284. 
285.     def __deepcopy__(self, memo):
286.         """Limit the amount of work when a Query is deepcopied."""
287.         result = self.clone()
288.         memo[id(self)] = result
289.         return result
290. 
291.     def get_compiler(self, using=None, connection=None, elide_empty=True):
292.         if using is None and connection is None:
293.             raise ValueError("Need either using or connection")
294.         if using:
295.             connection = connections[using]
296.         return connection.ops.compiler(self.compiler)(
297.             self, connection, using, elide_empty
298.         )
299. 
300.     def get_meta(self):
301.         """
302.         Return the Options instance (the model._meta) from which to start
303.         processing. Normally, this is self.model._meta, but it can be changed
304.         by subclasses.
305.         """
306.         if self.model:
307.             return self.model._meta
308. 
309.     def clone(self):
310.         """
311.         Return a copy of the current Query. A lightweight alternative to
312.         to deepcopy().
313.         """
314.         obj = Empty()
315.         obj.__class__ = self.__class__
316.         # Copy references to everything.
317.         obj.__dict__ = self.__dict__.copy()
318.         # Clone attributes that can't use shallow copy.
319.         obj.alias_refcount = self.alias_refcount.copy()
320.         obj.alias_map = self.alias_map.copy()
321.         obj.external_aliases = self.external_aliases.copy()
322.         obj.table_map = self.table_map.copy()
323.         obj.where = self.where.clone()
324.         obj.annotations = self.annotations.copy()
325.         if self.annotation_select_mask is not None:
326.             obj.annotation_select_mask = self.annotation_select_mask.copy()
327.         if self.combined_queries:
328.             obj.combined_queries = tuple(
329.                 [query.clone() for query in self.combined_queries]
330.             )
331.         # _annotation_select_cache cannot be copied, as doing so breaks the
332.         # (necessary) state in which both annotations and
333.         # _annotation_select_cache point to the same underlying objects.
334.         # It will get re-populated in the cloned queryset the next time it's
335.         # used.
336.         obj._annotation_select_cache = None
337.         obj.extra = self.extra.copy()
338.         if self.extra_select_mask is not None:
339.             obj.extra_select_mask = self.extra_select_mask.copy()
340.         if self._extra_select_cache is not None:
341.             obj._extra_select_cache = self._extra_select_cache.copy()
342.         if self.select_related is not False:
343.             # Use deepcopy because select_related stores fields in nested
344.             # dicts.
345.             obj.select_related = copy.deepcopy(obj.select_related)
346.         if "subq_aliases" in self.__dict__:
347.             obj.subq_aliases = self.subq_aliases.copy()
348.         obj.used_aliases = self.used_aliases.copy()
349.         obj._filtered_relations = self._filtered_relations.copy()
350.         # Clear the cached_property, if it exists.
351.         obj.__dict__.pop("base_table", None)
352.         return obj
353. 
354.     def chain(self, klass=None):
355.         """
356.         Return a copy of the current Query that's ready for another operation.
357.         The klass argument changes the type of the Query, e.g. UpdateQuery.
358.         """
359.         obj = self.clone()
360.         if klass and obj.__class__ != klass:
361.             obj.__class__ = klass
362.         if not obj.filter_is_sticky:
363.             obj.used_aliases = set()
364.         obj.filter_is_sticky = False
365.         if hasattr(obj, "_setup_query"):
366.             obj._setup_query()
367.         return obj
368. 
369.     def relabeled_clone(self, change_map):
370.         clone = self.clone()
371.         clone.change_aliases(change_map)
372.         return clone
373. 
374.     def _get_col(self, target, field, alias):
375.         if not self.alias_cols:
376.             alias = None
377.         return target.get_col(alias, field)
378. 
379.     def rewrite_cols(self, annotation, col_cnt):
380.         # We must make sure the inner query has the referred columns in it.
381.         # If we are aggregating over an annotation, then Django uses Ref()
382.         # instances to note this. However, if we are annotating over a column
383.         # of a related model, then it might be that column isn't part of the
384.         # SELECT clause of the inner query, and we must manually make sure
385.         # the column is selected. An example case is:
386.         #    .aggregate(Sum('author__awards'))
387.         # Resolving this expression results in a join to author, but there
388.         # is no guarantee the awards column of author is in the select clause
389.         # of the query. Thus we must manually add the column to the inner
390.         # query.
391.         orig_exprs = annotation.get_source_expressions()
392.         new_exprs = []
393.         for expr in orig_exprs:
394.             # FIXME: These conditions are fairly arbitrary. Identify a better
395.             # method of having expressions decide which code path they should
396.             # take.
397.             if isinstance(expr, Ref):
398.                 # Its already a Ref to subquery (see resolve_ref() for
399.                 # details)
400.                 new_exprs.append(expr)
401.             elif isinstance(expr, (WhereNode, Lookup)):
402.                 # Decompose the subexpressions further. The code here is
403.                 # copied from the else clause, but this condition must appear
404.                 # before the contains_aggregate/is_summary condition below.
405.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
406.                 new_exprs.append(new_expr)
407.             else:
408.                 # Reuse aliases of expressions already selected in subquery.
409.                 for col_alias, selected_annotation in self.annotation_select.items():
410.                     if selected_annotation is expr:
411.                         new_expr = Ref(col_alias, expr)
412.                         break
413.                 else:
414.                     # An expression that is not selected the subquery.
415.                     if isinstance(expr, Col) or (
416.                         expr.contains_aggregate and not expr.is_summary
417.                     ):
418.                         # Reference column or another aggregate. Select it
419.                         # under a non-conflicting alias.
420.                         col_cnt += 1
421.                         col_alias = "__col%d" % col_cnt
422.                         self.annotations[col_alias] = expr
423.                         self.append_annotation_mask([col_alias])
424.                         new_expr = Ref(col_alias, expr)
425.                     else:
426.                         # Some other expression not referencing database values
427.                         # directly. Its subexpression might contain Cols.
428.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
429.                 new_exprs.append(new_expr)
430.         annotation.set_source_expressions(new_exprs)
431.         return annotation, col_cnt
432. 
433.     def get_aggregation(self, using, added_aggregate_names):
434.         """
435.         Return the dictionary with the values of the existing aggregations.
436.         """
437.         if not self.annotation_select:
438.             return {}
439.         existing_annotations = [
440.             annotation
441.             for alias, annotation in self.annotations.items()
442.             if alias not in added_aggregate_names
443.         ]
444.         # Decide if we need to use a subquery.
445.         #
446.         # Existing annotations would cause incorrect results as get_aggregation()
447.         # must produce just one result and thus must not use GROUP BY. But we
448.         # aren't smart enough to remove the existing annotations from the
449.         # query, so those would force us to use GROUP BY.
450.         #
451.         # If the query has limit or distinct, or uses set operations, then
452.         # those operations must be done in a subquery so that the query
453.         # aggregates on the limit and/or distinct results instead of applying
454.         # the distinct and limit after the aggregation.
455.         if (
456.             isinstance(self.group_by, tuple)
457.             or self.is_sliced
458.             or existing_annotations
459.             or self.distinct
460.             or self.combinator
461.         ):
462.             from django.db.models.sql.subqueries import AggregateQuery
463. 
464.             inner_query = self.clone()
465.             inner_query.subquery = True
466.             outer_query = AggregateQuery(self.model, inner_query)
467.             inner_query.select_for_update = False
468.             inner_query.select_related = False
469.             inner_query.set_annotation_mask(self.annotation_select)
470.             # Queries with distinct_fields need ordering and when a limit is
471.             # applied we must take the slice from the ordered query. Otherwise
472.             # no need for ordering.
473.             inner_query.clear_ordering(force=False)
474.             if not inner_query.distinct:
475.                 # If the inner query uses default select and it has some
476.                 # aggregate annotations, then we must make sure the inner
477.                 # query is grouped by the main model's primary key. However,
478.                 # clearing the select clause can alter results if distinct is
479.                 # used.
480.                 has_existing_aggregate_annotations = any(
481.                     annotation
482.                     for annotation in existing_annotations
483.                     if getattr(annotation, "contains_aggregate", True)
484.                 )
485.                 if inner_query.default_cols and has_existing_aggregate_annotations:
486.                     inner_query.group_by = (
487.                         self.model._meta.pk.get_col(inner_query.get_initial_alias()),
488.                     )
489.                 inner_query.default_cols = False
490. 
491.             relabels = {t: "subquery" for t in inner_query.alias_map}
492.             relabels[None] = "subquery"
493.             # Remove any aggregates marked for reduction from the subquery
494.             # and move them to the outer AggregateQuery.
495.             col_cnt = 0
496.             for alias, expression in list(inner_query.annotation_select.items()):
497.                 annotation_select_mask = inner_query.annotation_select_mask
498.                 if expression.is_summary:
499.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
500.                     outer_query.annotations[alias] = expression.relabeled_clone(


File: django/db/models/sql/query.py
Line number range: 501 - 9999
Content:
501.                         relabels
502.                     )
503.                     del inner_query.annotations[alias]
504.                     annotation_select_mask.remove(alias)
505.                 # Make sure the annotation_select wont use cached results.
506.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
507.             if (
508.                 inner_query.select == ()
509.                 and not inner_query.default_cols
510.                 and not inner_query.annotation_select_mask
511.             ):
512.                 # In case of Model.objects[0:3].count(), there would be no
513.                 # field selected in the inner query, yet we must use a subquery.
514.                 # So, make sure at least one field is selected.
515.                 inner_query.select = (
516.                     self.model._meta.pk.get_col(inner_query.get_initial_alias()),
517.                 )
518.         else:
519.             outer_query = self
520.             self.select = ()
521.             self.default_cols = False
522.             self.extra = {}
523. 
524.         empty_set_result = [
525.             expression.empty_result_set_value
526.             for expression in outer_query.annotation_select.values()
527.         ]
528.         elide_empty = not any(result is NotImplemented for result in empty_set_result)
529.         outer_query.clear_ordering(force=True)
530.         outer_query.clear_limits()
531.         outer_query.select_for_update = False
532.         outer_query.select_related = False
533.         compiler = outer_query.get_compiler(using, elide_empty=elide_empty)
534.         result = compiler.execute_sql(SINGLE)
535.         if result is None:
536.             result = empty_set_result
537. 
538.         converters = compiler.get_converters(outer_query.annotation_select.values())
539.         result = next(compiler.apply_converters((result,), converters))
540. 
541.         return dict(zip(outer_query.annotation_select, result))
542. 
543.     def get_count(self, using):
544.         """
545.         Perform a COUNT() query using the current filter constraints.
546.         """
547.         obj = self.clone()
548.         obj.add_annotation(Count("*"), alias="__count", is_summary=True)
549.         return obj.get_aggregation(using, ["__count"])["__count"]
550. 
551.     def has_filters(self):
552.         return self.where
553. 
554.     def exists(self, using, limit=True):
555.         q = self.clone()
556.         if not q.distinct:
557.             if q.group_by is True:
558.                 q.add_fields(
559.                     (f.attname for f in self.model._meta.concrete_fields), False
560.                 )
561.                 # Disable GROUP BY aliases to avoid orphaning references to the
562.                 # SELECT clause which is about to be cleared.
563.                 q.set_group_by(allow_aliases=False)
564.             q.clear_select_clause()
565.         if q.combined_queries and q.combinator == "union":
566.             limit_combined = connections[
567.                 using
568.             ].features.supports_slicing_ordering_in_compound
569.             q.combined_queries = tuple(
570.                 combined_query.exists(using, limit=limit_combined)
571.                 for combined_query in q.combined_queries
572.             )
573.         q.clear_ordering(force=True)
574.         if limit:
575.             q.set_limits(high=1)
576.         q.add_extra({"a": 1}, None, None, None, None, None)
577.         q.set_extra_mask(["a"])
578.         return q
579. 
580.     def has_results(self, using):
581.         q = self.exists(using)
582.         compiler = q.get_compiler(using=using)
583.         return compiler.has_results()
584. 
585.     def explain(self, using, format=None, **options):
586.         q = self.clone()
587.         q.explain_info = ExplainInfo(format, options)
588.         compiler = q.get_compiler(using=using)
589.         return "\n".join(compiler.explain_query())
590. 
591.     def combine(self, rhs, connector):
592.         """
593.         Merge the 'rhs' query into the current one (with any 'rhs' effects
594.         being applied *after* (that is, "to the right of") anything in the
595.         current query. 'rhs' is not modified during a call to this function.
596. 
597.         The 'connector' parameter describes how to connect filters from the
598.         'rhs' query.
599.         """
600.         if self.model != rhs.model:
601.             raise TypeError("Cannot combine queries on two different base models.")
602.         if self.is_sliced:
603.             raise TypeError("Cannot combine queries once a slice has been taken.")
604.         if self.distinct != rhs.distinct:
605.             raise TypeError("Cannot combine a unique query with a non-unique query.")
606.         if self.distinct_fields != rhs.distinct_fields:
607.             raise TypeError("Cannot combine queries with different distinct fields.")
608. 
609.         # If lhs and rhs shares the same alias prefix, it is possible to have
610.         # conflicting alias changes like T4 -> T5, T5 -> T6, which might end up
611.         # as T4 -> T6 while combining two querysets. To prevent this, change an
612.         # alias prefix of the rhs and update current aliases accordingly,
613.         # except if the alias is the base table since it must be present in the
614.         # query on both sides.
615.         initial_alias = self.get_initial_alias()
616.         rhs.bump_prefix(self, exclude={initial_alias})
617. 
618.         # Work out how to relabel the rhs aliases, if necessary.
619.         change_map = {}
620.         conjunction = connector == AND
621. 
622.         # Determine which existing joins can be reused. When combining the
623.         # query with AND we must recreate all joins for m2m filters. When
624.         # combining with OR we can reuse joins. The reason is that in AND
625.         # case a single row can't fulfill a condition like:
626.         #     revrel__col=1 & revrel__col=2
627.         # But, there might be two different related rows matching this
628.         # condition. In OR case a single True is enough, so single row is
629.         # enough, too.
630.         #
631.         # Note that we will be creating duplicate joins for non-m2m joins in
632.         # the AND case. The results will be correct but this creates too many
633.         # joins. This is something that could be fixed later on.
634.         reuse = set() if conjunction else set(self.alias_map)
635.         joinpromoter = JoinPromoter(connector, 2, False)
636.         joinpromoter.add_votes(
637.             j for j in self.alias_map if self.alias_map[j].join_type == INNER
638.         )
639.         rhs_votes = set()
640.         # Now, add the joins from rhs query into the new query (skipping base
641.         # table).
642.         rhs_tables = list(rhs.alias_map)[1:]
643.         for alias in rhs_tables:
644.             join = rhs.alias_map[alias]
645.             # If the left side of the join was already relabeled, use the
646.             # updated alias.
647.             join = join.relabeled_clone(change_map)
648.             new_alias = self.join(join, reuse=reuse)
649.             if join.join_type == INNER:
650.                 rhs_votes.add(new_alias)
651.             # We can't reuse the same join again in the query. If we have two
652.             # distinct joins for the same connection in rhs query, then the
653.             # combined query must have two joins, too.
654.             reuse.discard(new_alias)
655.             if alias != new_alias:
656.                 change_map[alias] = new_alias
657.             if not rhs.alias_refcount[alias]:
658.                 # The alias was unused in the rhs query. Unref it so that it
659.                 # will be unused in the new query, too. We have to add and
660.                 # unref the alias so that join promotion has information of
661.                 # the join type for the unused alias.
662.                 self.unref_alias(new_alias)
663.         joinpromoter.add_votes(rhs_votes)
664.         joinpromoter.update_join_types(self)
665. 
666.         # Combine subqueries aliases to ensure aliases relabelling properly
667.         # handle subqueries when combining where and select clauses.
668.         self.subq_aliases |= rhs.subq_aliases
669. 
670.         # Now relabel a copy of the rhs where-clause and add it to the current
671.         # one.
672.         w = rhs.where.clone()
673.         w.relabel_aliases(change_map)
674.         self.where.add(w, connector)
675. 
676.         # Selection columns and extra extensions are those provided by 'rhs'.
677.         if rhs.select:
678.             self.set_select([col.relabeled_clone(change_map) for col in rhs.select])
679.         else:
680.             self.select = ()
681. 
682.         if connector == OR:
683.             # It would be nice to be able to handle this, but the queries don't
684.             # really make sense (or return consistent value sets). Not worth
685.             # the extra complexity when you can write a real query instead.
686.             if self.extra and rhs.extra:
687.                 raise ValueError(
688.                     "When merging querysets using 'or', you cannot have "
689.                     "extra(select=...) on both sides."
690.                 )
691.         self.extra.update(rhs.extra)
692.         extra_select_mask = set()
693.         if self.extra_select_mask is not None:
694.             extra_select_mask.update(self.extra_select_mask)
695.         if rhs.extra_select_mask is not None:
696.             extra_select_mask.update(rhs.extra_select_mask)
697.         if extra_select_mask:
698.             self.set_extra_mask(extra_select_mask)
699.         self.extra_tables += rhs.extra_tables
700. 
701.         # Ordering uses the 'rhs' ordering, unless it has none, in which case
702.         # the current ordering is used.
703.         self.order_by = rhs.order_by or self.order_by
704.         self.extra_order_by = rhs.extra_order_by or self.extra_order_by
705. 
706.     def deferred_to_data(self, target, callback):
707.         """
708.         Convert the self.deferred_loading data structure to an alternate data
709.         structure, describing the field that *will* be loaded. This is used to
710.         compute the columns to select from the database and also by the
711.         QuerySet class to work out which fields are being initialized on each
712.         model. Models that have all their fields included aren't mentioned in
713.         the result, only those that have field restrictions in place.
714. 
715.         The "target" parameter is the instance that is populated (in place).
716.         The "callback" is a function that is called whenever a (model, field)
717.         pair need to be added to "target". It accepts three parameters:
718.         "target", and the model and list of fields being added for that model.
719.         """
720.         field_names, defer = self.deferred_loading
721.         if not field_names:
722.             return
723.         orig_opts = self.get_meta()
724.         seen = {}
725.         must_include = {orig_opts.concrete_model: {orig_opts.pk}}
726.         for field_name in field_names:
727.             parts = field_name.split(LOOKUP_SEP)
728.             cur_model = self.model._meta.concrete_model
729.             opts = orig_opts
730.             for name in parts[:-1]:
731.                 old_model = cur_model
732.                 if name in self._filtered_relations:
733.                     name = self._filtered_relations[name].relation_name
734.                 source = opts.get_field(name)
735.                 if is_reverse_o2o(source):
736.                     cur_model = source.related_model
737.                 else:
738.                     cur_model = source.remote_field.model
739.                 opts = cur_model._meta
740.                 # Even if we're "just passing through" this model, we must add
741.                 # both the current model's pk and the related reference field
742.                 # (if it's not a reverse relation) to the things we select.
743.                 if not is_reverse_o2o(source):
744.                     must_include[old_model].add(source)
745.                 add_to_dict(must_include, cur_model, opts.pk)
746.             field = opts.get_field(parts[-1])
747.             is_reverse_object = field.auto_created and not field.concrete
748.             model = field.related_model if is_reverse_object else field.model
749.             model = model._meta.concrete_model
750.             if model == opts.model:
751.                 model = cur_model
752.             if not is_reverse_o2o(field):
753.                 add_to_dict(seen, model, field)
754. 
755.         if defer:
756.             # We need to load all fields for each model, except those that
757.             # appear in "seen" (for all models that appear in "seen"). The only
758.             # slight complexity here is handling fields that exist on parent
759.             # models.
760.             workset = {}
761.             for model, values in seen.items():
762.                 for field in model._meta.local_fields:
763.                     if field not in values:
764.                         m = field.model._meta.concrete_model
765.                         add_to_dict(workset, m, field)
766.             for model, values in must_include.items():
767.                 # If we haven't included a model in workset, we don't add the
768.                 # corresponding must_include fields for that model, since an
769.                 # empty set means "include all fields". That's why there's no
770.                 # "else" branch here.
771.                 if model in workset:
772.                     workset[model].update(values)
773.             for model, values in workset.items():
774.                 callback(target, model, values)
775.         else:
776.             for model, values in must_include.items():
777.                 if model in seen:
778.                     seen[model].update(values)
779.                 else:
780.                     # As we've passed through this model, but not explicitly
781.                     # included any fields, we have to make sure it's mentioned
782.                     # so that only the "must include" fields are pulled in.
783.                     seen[model] = values
784.             # Now ensure that every model in the inheritance chain is mentioned
785.             # in the parent list. Again, it must be mentioned to ensure that
786.             # only "must include" fields are pulled in.
787.             for model in orig_opts.get_parent_list():
788.                 seen.setdefault(model, set())
789.             for model, values in seen.items():
790.                 callback(target, model, values)
791. 
792.     def table_alias(self, table_name, create=False, filtered_relation=None):
793.         """
794.         Return a table alias for the given table_name and whether this is a
795.         new alias or not.
796. 
797.         If 'create' is true, a new alias is always created. Otherwise, the
798.         most recently created alias for the table (if one exists) is reused.
799.         """
800.         alias_list = self.table_map.get(table_name)
801.         if not create and alias_list:
802.             alias = alias_list[0]
803.             self.alias_refcount[alias] += 1
804.             return alias, False
805. 
806.         # Create a new alias for this table.
807.         if alias_list:
808.             alias = "%s%d" % (self.alias_prefix, len(self.alias_map) + 1)
809.             alias_list.append(alias)
810.         else:
811.             # The first occurrence of a table uses the table name directly.
812.             alias = (
813.                 filtered_relation.alias if filtered_relation is not None else table_name
814.             )
815.             self.table_map[table_name] = [alias]
816.         self.alias_refcount[alias] = 1
817.         return alias, True
818. 
819.     def ref_alias(self, alias):
820.         """Increases the reference count for this alias."""
821.         self.alias_refcount[alias] += 1
822. 
823.     def unref_alias(self, alias, amount=1):
824.         """Decreases the reference count for this alias."""
825.         self.alias_refcount[alias] -= amount
826. 
827.     def promote_joins(self, aliases):
828.         """
829.         Promote recursively the join type of given aliases and its children to
830.         an outer join. If 'unconditional' is False, only promote the join if
831.         it is nullable or the parent join is an outer join.
832. 
833.         The children promotion is done to avoid join chains that contain a LOUTER
834.         b INNER c. So, if we have currently a INNER b INNER c and a->b is promoted,
835.         then we must also promote b->c automatically, or otherwise the promotion
836.         of a->b doesn't actually change anything in the query results.
837.         """
838.         aliases = list(aliases)
839.         while aliases:
840.             alias = aliases.pop(0)
841.             if self.alias_map[alias].join_type is None:
842.                 # This is the base table (first FROM entry) - this table
843.                 # isn't really joined at all in the query, so we should not
844.                 # alter its join type.
845.                 continue
846.             # Only the first alias (skipped above) should have None join_type
847.             assert self.alias_map[alias].join_type is not None
848.             parent_alias = self.alias_map[alias].parent_alias
849.             parent_louter = (
850.                 parent_alias and self.alias_map[parent_alias].join_type == LOUTER
851.             )
852.             already_louter = self.alias_map[alias].join_type == LOUTER
853.             if (self.alias_map[alias].nullable or parent_louter) and not already_louter:
854.                 self.alias_map[alias] = self.alias_map[alias].promote()
855.                 # Join type of 'alias' changed, so re-examine all aliases that
856.                 # refer to this one.
857.                 aliases.extend(
858.                     join
859.                     for join in self.alias_map
860.                     if self.alias_map[join].parent_alias == alias
861.                     and join not in aliases
862.                 )
863. 
864.     def demote_joins(self, aliases):
865.         """
866.         Change join type from LOUTER to INNER for all joins in aliases.
867. 
868.         Similarly to promote_joins(), this method must ensure no join chains
869.         containing first an outer, then an inner join are generated. If we
870.         are demoting b->c join in chain a LOUTER b LOUTER c then we must
871.         demote a->b automatically, or otherwise the demotion of b->c doesn't
872.         actually change anything in the query results. .
873.         """
874.         aliases = list(aliases)
875.         while aliases:
876.             alias = aliases.pop(0)
877.             if self.alias_map[alias].join_type == LOUTER:
878.                 self.alias_map[alias] = self.alias_map[alias].demote()
879.                 parent_alias = self.alias_map[alias].parent_alias
880.                 if self.alias_map[parent_alias].join_type == INNER:
881.                     aliases.append(parent_alias)
882. 
883.     def reset_refcounts(self, to_counts):
884.         """
885.         Reset reference counts for aliases so that they match the value passed
886.         in `to_counts`.
887.         """
888.         for alias, cur_refcount in self.alias_refcount.copy().items():
889.             unref_amount = cur_refcount - to_counts.get(alias, 0)
890.             self.unref_alias(alias, unref_amount)
891. 
892.     def change_aliases(self, change_map):
893.         """
894.         Change the aliases in change_map (which maps old-alias -> new-alias),
895.         relabelling any references to them in select columns and the where
896.         clause.
897.         """
898.         # If keys and values of change_map were to intersect, an alias might be
899.         # updated twice (e.g. T4 -> T5, T5 -> T6, so also T4 -> T6) depending
900.         # on their order in change_map.
901.         assert set(change_map).isdisjoint(change_map.values())
902. 
903.         # 1. Update references in "select" (normal columns plus aliases),
904.         # "group by" and "where".
905.         self.where.relabel_aliases(change_map)
906.         if isinstance(self.group_by, tuple):
907.             self.group_by = tuple(
908.                 [col.relabeled_clone(change_map) for col in self.group_by]
909.             )
910.         self.select = tuple([col.relabeled_clone(change_map) for col in self.select])
911.         self.annotations = self.annotations and {
912.             key: col.relabeled_clone(change_map)
913.             for key, col in self.annotations.items()
914.         }
915. 
916.         # 2. Rename the alias in the internal table/alias datastructures.
917.         for old_alias, new_alias in change_map.items():
918.             if old_alias not in self.alias_map:
919.                 continue
920.             alias_data = self.alias_map[old_alias].relabeled_clone(change_map)
921.             self.alias_map[new_alias] = alias_data
922.             self.alias_refcount[new_alias] = self.alias_refcount[old_alias]
923.             del self.alias_refcount[old_alias]
924.             del self.alias_map[old_alias]
925. 
926.             table_aliases = self.table_map[alias_data.table_name]
927.             for pos, alias in enumerate(table_aliases):
928.                 if alias == old_alias:
929.                     table_aliases[pos] = new_alias
930.                     break
931.         self.external_aliases = {
932.             # Table is aliased or it's being changed and thus is aliased.
933.             change_map.get(alias, alias): (aliased or alias in change_map)
934.             for alias, aliased in self.external_aliases.items()
935.         }
936. 
937.     def bump_prefix(self, other_query, exclude=None):
938.         """
939.         Change the alias prefix to the next letter in the alphabet in a way
940.         that the other query's aliases and this query's aliases will not
941.         conflict. Even tables that previously had no alias will get an alias
942.         after this call. To prevent changing aliases use the exclude parameter.
943.         """
944. 
945.         def prefix_gen():
946.             """
947.             Generate a sequence of characters in alphabetical order:
948.                 -> 'A', 'B', 'C', ...
949. 
950.             When the alphabet is finished, the sequence will continue with the
951.             Cartesian product:
952.                 -> 'AA', 'AB', 'AC', ...
953.             """
954.             alphabet = ascii_uppercase
955.             prefix = chr(ord(self.alias_prefix) + 1)
956.             yield prefix
957.             for n in count(1):
958.                 seq = alphabet[alphabet.index(prefix) :] if prefix else alphabet
959.                 for s in product(seq, repeat=n):
960.                     yield "".join(s)
961.                 prefix = None
962. 
963.         if self.alias_prefix != other_query.alias_prefix:
964.             # No clashes between self and outer query should be possible.
965.             return
966. 
967.         # Explicitly avoid infinite loop. The constant divider is based on how
968.         # much depth recursive subquery references add to the stack. This value
969.         # might need to be adjusted when adding or removing function calls from
970.         # the code path in charge of performing these operations.
971.         local_recursion_limit = sys.getrecursionlimit() // 16
972.         for pos, prefix in enumerate(prefix_gen()):
973.             if prefix not in self.subq_aliases:
974.                 self.alias_prefix = prefix
975.                 break
976.             if pos > local_recursion_limit:
977.                 raise RecursionError(
978.                     "Maximum recursion depth exceeded: too many subqueries."
979.                 )
980.         self.subq_aliases = self.subq_aliases.union([self.alias_prefix])
981.         other_query.subq_aliases = other_query.subq_aliases.union(self.subq_aliases)
982.         if exclude is None:
983.             exclude = {}
984.         self.change_aliases(
985.             {
986.                 alias: "%s%d" % (self.alias_prefix, pos)
987.                 for pos, alias in enumerate(self.alias_map)
988.                 if alias not in exclude
989.             }
990.         )
991. 
992.     def get_initial_alias(self):
993.         """
994.         Return the first alias for this query, after increasing its reference
995.         count.
996.         """
997.         if self.alias_map:
998.             alias = self.base_table
999.             self.ref_alias(alias)
1000.         elif self.model:
1001.             alias = self.join(self.base_table_class(self.get_meta().db_table, None))
1002.         else:
1003.             alias = None
1004.         return alias
1005. 
1006.     def count_active_tables(self):
1007.         """
1008.         Return the number of tables in this query with a non-zero reference
1009.         count. After execution, the reference counts are zeroed, so tables
1010.         added in compiler will not be seen by this method.
1011.         """
1012.         return len([1 for count in self.alias_refcount.values() if count])
1013. 
1014.     def join(self, join, reuse=None):
1015.         """
1016.         Return an alias for the 'join', either reusing an existing alias for
1017.         that join or creating a new one. 'join' is either a base_table_class or
1018.         join_class.
1019. 
1020.         The 'reuse' parameter can be either None which means all joins are
1021.         reusable, or it can be a set containing the aliases that can be reused.
1022. 
1023.         A join is always created as LOUTER if the lhs alias is LOUTER to make
1024.         sure chains like t1 LOUTER t2 INNER t3 aren't generated. All new
1025.         joins are created as LOUTER if the join is nullable.
1026.         """
1027.         reuse_aliases = [
1028.             a
1029.             for a, j in self.alias_map.items()
1030.             if (reuse is None or a in reuse) and j.equals(join)
1031.         ]
1032.         if reuse_aliases:
1033.             if join.table_alias in reuse_aliases:
1034.                 reuse_alias = join.table_alias
1035.             else:
1036.                 # Reuse the most recent alias of the joined table
1037.                 # (a many-to-many relation may be joined multiple times).
1038.                 reuse_alias = reuse_aliases[-1]
1039.             self.ref_alias(reuse_alias)
1040.             return reuse_alias
1041. 
1042.         # No reuse is possible, so we need a new alias.
1043.         alias, _ = self.table_alias(
1044.             join.table_name, create=True, filtered_relation=join.filtered_relation
1045.         )
1046.         if join.join_type:
1047.             if self.alias_map[join.parent_alias].join_type == LOUTER or join.nullable:
1048.                 join_type = LOUTER
1049.             else:
1050.                 join_type = INNER
1051.             join.join_type = join_type
1052.         join.table_alias = alias
1053.         self.alias_map[alias] = join
1054.         return alias
1055. 
1056.     def join_parent_model(self, opts, model, alias, seen):
1057.         """
1058.         Make sure the given 'model' is joined in the query. If 'model' isn't
1059.         a parent of 'opts' or if it is None this method is a no-op.
1060. 
1061.         The 'alias' is the root alias for starting the join, 'seen' is a dict
1062.         of model -> alias of existing joins. It must also contain a mapping
1063.         of None -> some alias. This will be returned in the no-op case.
1064.         """
1065.         if model in seen:
1066.             return seen[model]
1067.         chain = opts.get_base_chain(model)
1068.         if not chain:
1069.             return alias
1070.         curr_opts = opts
1071.         for int_model in chain:
1072.             if int_model in seen:
1073.                 curr_opts = int_model._meta
1074.                 alias = seen[int_model]
1075.                 continue
1076.             # Proxy model have elements in base chain
1077.             # with no parents, assign the new options
1078.             # object and skip to the next base in that
1079.             # case
1080.             if not curr_opts.parents[int_model]:
1081.                 curr_opts = int_model._meta
1082.                 continue
1083.             link_field = curr_opts.get_ancestor_link(int_model)
1084.             join_info = self.setup_joins([link_field.name], curr_opts, alias)
1085.             curr_opts = int_model._meta
1086.             alias = seen[int_model] = join_info.joins[-1]
1087.         return alias or seen[None]
1088. 
1089.     def add_annotation(self, annotation, alias, is_summary=False, select=True):
1090.         """Add a single annotation expression to the Query."""
1091.         annotation = annotation.resolve_expression(
1092.             self, allow_joins=True, reuse=None, summarize=is_summary
1093.         )
1094.         if select:
1095.             self.append_annotation_mask([alias])
1096.         else:
1097.             self.set_annotation_mask(set(self.annotation_select).difference({alias}))
1098.         self.annotations[alias] = annotation
1099. 
1100.     def resolve_expression(self, query, *args, **kwargs):
1101.         clone = self.clone()
1102.         # Subqueries need to use a different set of aliases than the outer query.
1103.         clone.bump_prefix(query)
1104.         clone.subquery = True
1105.         clone.where.resolve_expression(query, *args, **kwargs)
1106.         # Resolve combined queries.
1107.         if clone.combinator:
1108.             clone.combined_queries = tuple(
1109.                 [
1110.                     combined_query.resolve_expression(query, *args, **kwargs)
1111.                     for combined_query in clone.combined_queries
1112.                 ]
1113.             )
1114.         for key, value in clone.annotations.items():
1115.             resolved = value.resolve_expression(query, *args, **kwargs)
1116.             if hasattr(resolved, "external_aliases"):
1117.                 resolved.external_aliases.update(clone.external_aliases)
1118.             clone.annotations[key] = resolved
1119.         # Outer query's aliases are considered external.
1120.         for alias, table in query.alias_map.items():
1121.             clone.external_aliases[alias] = (
1122.                 isinstance(table, Join)
1123.                 and table.join_field.related_model._meta.db_table != alias
1124.             ) or (
1125.                 isinstance(table, BaseTable) and table.table_name != table.table_alias
1126.             )
1127.         return clone
1128. 
1129.     def get_external_cols(self):
1130.         exprs = chain(self.annotations.values(), self.where.children)
1131.         return [
1132.             col
1133.             for col in self._gen_cols(exprs, include_external=True)
1134.             if col.alias in self.external_aliases
1135.         ]
1136. 
1137.     def get_group_by_cols(self, alias=None):
1138.         if alias:
1139.             return [Ref(alias, self)]
1140.         external_cols = self.get_external_cols()
1141.         if any(col.possibly_multivalued for col in external_cols):
1142.             return [self]
1143.         return external_cols
1144. 
1145.     def as_sql(self, compiler, connection):
1146.         # Some backends (e.g. Oracle) raise an error when a subquery contains
1147.         # unnecessary ORDER BY clause.
1148.         if (
1149.             self.subquery
1150.             and not connection.features.ignores_unnecessary_order_by_in_subqueries
1151.         ):
1152.             self.clear_ordering(force=False)
1153.         sql, params = self.get_compiler(connection=connection).as_sql()
1154.         if self.subquery:
1155.             sql = "(%s)" % sql
1156.         return sql, params
1157. 
1158.     def resolve_lookup_value(self, value, can_reuse, allow_joins):
1159.         if hasattr(value, "resolve_expression"):
1160.             value = value.resolve_expression(
1161.                 self,
1162.                 reuse=can_reuse,
1163.                 allow_joins=allow_joins,
1164.             )
1165.         elif isinstance(value, (list, tuple)):
1166.             # The items of the iterable may be expressions and therefore need
1167.             # to be resolved independently.
1168.             values = (
1169.                 self.resolve_lookup_value(sub_value, can_reuse, allow_joins)
1170.                 for sub_value in value
1171.             )
1172.             type_ = type(value)
1173.             if hasattr(type_, "_make"):  # namedtuple
1174.                 return type_(*values)
1175.             return type_(values)
1176.         return value
1177. 
1178.     def solve_lookup_type(self, lookup):
1179.         """
1180.         Solve the lookup type from the lookup (e.g.: 'foobar__id__icontains').
1181.         """
1182.         lookup_splitted = lookup.split(LOOKUP_SEP)
1183.         if self.annotations:
1184.             expression, expression_lookups = refs_expression(
1185.                 lookup_splitted, self.annotations
1186.             )
1187.             if expression:
1188.                 return expression_lookups, (), expression
1189.         _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
1190.         field_parts = lookup_splitted[0 : len(lookup_splitted) - len(lookup_parts)]
1191.         if len(lookup_parts) > 1 and not field_parts:
1192.             raise FieldError(
1193.                 'Invalid lookup "%s" for model %s".'
1194.                 % (lookup, self.get_meta().model.__name__)
1195.             )
1196.         return lookup_parts, field_parts, False
1197. 
1198.     def check_query_object_type(self, value, opts, field):
1199.         """
1200.         Check whether the object passed while querying is of the correct type.
1201.         If not, raise a ValueError specifying the wrong object.
1202.         """
1203.         if hasattr(value, "_meta"):
1204.             if not check_rel_lookup_compatibility(value._meta.model, opts, field):
1205.                 raise ValueError(
1206.                     'Cannot query "%s": Must be "%s" instance.'
1207.                     % (value, opts.object_name)
1208.                 )
1209. 
1210.     def check_related_objects(self, field, value, opts):
1211.         """Check the type of object passed to query relations."""
1212.         if field.is_relation:
1213.             # Check that the field and the queryset use the same model in a
1214.             # query like .filter(author=Author.objects.all()). For example, the
1215.             # opts would be Author's (from the author field) and value.model
1216.             # would be Author.objects.all() queryset's .model (Author also).
1217.             # The field is the related field on the lhs side.
1218.             if (
1219.                 isinstance(value, Query)
1220.                 and not value.has_select_fields
1221.                 and not check_rel_lookup_compatibility(value.model, opts, field)
1222.             ):
1223.                 raise ValueError(
1224.                     'Cannot use QuerySet for "%s": Use a QuerySet for "%s".'
1225.                     % (value.model._meta.object_name, opts.object_name)
1226.                 )
1227.             elif hasattr(value, "_meta"):
1228.                 self.check_query_object_type(value, opts, field)
1229.             elif hasattr(value, "__iter__"):
1230.                 for v in value:
1231.                     self.check_query_object_type(v, opts, field)
1232. 
1233.     def check_filterable(self, expression):
1234.         """Raise an error if expression cannot be used in a WHERE clause."""
1235.         if hasattr(expression, "resolve_expression") and not getattr(
1236.             expression, "filterable", True
1237.         ):
1238.             raise NotSupportedError(
1239.                 expression.__class__.__name__ + " is disallowed in the filter "
1240.                 "clause."
1241.             )
1242.         if hasattr(expression, "get_source_expressions"):
1243.             for expr in expression.get_source_expressions():
1244.                 self.check_filterable(expr)
1245. 
1246.     def build_lookup(self, lookups, lhs, rhs):
1247.         """
1248.         Try to extract transforms and lookup from given lhs.
1249. 
1250.         The lhs value is something that works like SQLExpression.
1251.         The rhs value is what the lookup is going to compare against.
1252.         The lookups is a list of names to extract using get_lookup()
1253.         and get_transform().
1254.         """
1255.         # __exact is the default lookup if one isn't given.
1256.         *transforms, lookup_name = lookups or ["exact"]
1257.         for name in transforms:
1258.             lhs = self.try_transform(lhs, name)
1259.         # First try get_lookup() so that the lookup takes precedence if the lhs
1260.         # supports both transform and lookup for the name.
1261.         lookup_class = lhs.get_lookup(lookup_name)
1262.         if not lookup_class:
1263.             if lhs.field.is_relation:
1264.                 raise FieldError(
1265.                     "Related Field got invalid lookup: {}".format(lookup_name)
1266.                 )
1267.             # A lookup wasn't found. Try to interpret the name as a transform
1268.             # and do an Exact lookup against it.
1269.             lhs = self.try_transform(lhs, lookup_name)
1270.             lookup_name = "exact"
1271.             lookup_class = lhs.get_lookup(lookup_name)
1272.             if not lookup_class:
1273.                 return
1274. 
1275.         lookup = lookup_class(lhs, rhs)
1276.         # Interpret '__exact=None' as the sql 'is NULL'; otherwise, reject all
1277.         # uses of None as a query value unless the lookup supports it.
1278.         if lookup.rhs is None and not lookup.can_use_none_as_rhs:
1279.             if lookup_name not in ("exact", "iexact"):
1280.                 raise ValueError("Cannot use None as a query value")
1281.             return lhs.get_lookup("isnull")(lhs, True)
1282. 
1283.         # For Oracle '' is equivalent to null. The check must be done at this
1284.         # stage because join promotion can't be done in the compiler. Using
1285.         # DEFAULT_DB_ALIAS isn't nice but it's the best that can be done here.
1286.         # A similar thing is done in is_nullable(), too.
1287.         if (
1288.             lookup_name == "exact"
1289.             and lookup.rhs == ""
1290.             and connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls
1291.         ):
1292.             return lhs.get_lookup("isnull")(lhs, True)
1293. 
1294.         return lookup
1295. 
1296.     def try_transform(self, lhs, name):
1297.         """
1298.         Helper method for build_lookup(). Try to fetch and initialize
1299.         a transform for name parameter from lhs.
1300.         """
1301.         transform_class = lhs.get_transform(name)
1302.         if transform_class:
1303.             return transform_class(lhs)
1304.         else:
1305.             output_field = lhs.output_field.__class__
1306.             suggested_lookups = difflib.get_close_matches(
1307.                 name, output_field.get_lookups()
1308.             )
1309.             if suggested_lookups:
1310.                 suggestion = ", perhaps you meant %s?" % " or ".join(suggested_lookups)
1311.             else:
1312.                 suggestion = "."
1313.             raise FieldError(
1314.                 "Unsupported lookup '%s' for %s or join on the field not "
1315.                 "permitted%s" % (name, output_field.__name__, suggestion)
1316.             )
1317. 
1318.     def build_filter(
1319.         self,
1320.         filter_expr,
1321.         branch_negated=False,
1322.         current_negated=False,
1323.         can_reuse=None,
1324.         allow_joins=True,
1325.         split_subq=True,
1326.         check_filterable=True,
1327.     ):
1328.         """
1329.         Build a WhereNode for a single filter clause but don't add it
1330.         to this Query. Query.add_q() will then add this filter to the where
1331.         Node.
1332. 
1333.         The 'branch_negated' tells us if the current branch contains any
1334.         negations. This will be used to determine if subqueries are needed.
1335. 
1336.         The 'current_negated' is used to determine if the current filter is
1337.         negated or not and this will be used to determine if IS NULL filtering
1338.         is needed.
1339. 
1340.         The difference between current_negated and branch_negated is that
1341.         branch_negated is set on first negation, but current_negated is
1342.         flipped for each negation.
1343. 
1344.         Note that add_filter will not do any negating itself, that is done
1345.         upper in the code by add_q().
1346. 
1347.         The 'can_reuse' is a set of reusable joins for multijoins.
1348. 
1349.         The method will create a filter clause that can be added to the current
1350.         query. However, if the filter isn't added to the query then the caller
1351.         is responsible for unreffing the joins used.
1352.         """
1353.         if isinstance(filter_expr, dict):
1354.             raise FieldError("Cannot parse keyword query as dict")
1355.         if isinstance(filter_expr, Q):
1356.             return self._add_q(
1357.                 filter_expr,
1358.                 branch_negated=branch_negated,
1359.                 current_negated=current_negated,
1360.                 used_aliases=can_reuse,
1361.                 allow_joins=allow_joins,
1362.                 split_subq=split_subq,
1363.                 check_filterable=check_filterable,
1364.             )
1365.         if hasattr(filter_expr, "resolve_expression"):
1366.             if not getattr(filter_expr, "conditional", False):
1367.                 raise TypeError("Cannot filter against a non-conditional expression.")
1368.             condition = filter_expr.resolve_expression(self, allow_joins=allow_joins)
1369.             if not isinstance(condition, Lookup):
1370.                 condition = self.build_lookup(["exact"], condition, True)
1371.             return WhereNode([condition], connector=AND), []
1372.         arg, value = filter_expr
1373.         if not arg:
1374.             raise FieldError("Cannot parse keyword query %r" % arg)
1375.         lookups, parts, reffed_expression = self.solve_lookup_type(arg)
1376. 
1377.         if check_filterable:
1378.             self.check_filterable(reffed_expression)
1379. 
1380.         if not allow_joins and len(parts) > 1:
1381.             raise FieldError("Joined field references are not permitted in this query")
1382. 
1383.         pre_joins = self.alias_refcount.copy()
1384.         value = self.resolve_lookup_value(value, can_reuse, allow_joins)
1385.         used_joins = {
1386.             k for k, v in self.alias_refcount.items() if v > pre_joins.get(k, 0)
1387.         }
1388. 
1389.         if check_filterable:
1390.             self.check_filterable(value)
1391. 
1392.         if reffed_expression:
1393.             condition = self.build_lookup(lookups, reffed_expression, value)
1394.             return WhereNode([condition], connector=AND), []
1395. 
1396.         opts = self.get_meta()
1397.         alias = self.get_initial_alias()
1398.         allow_many = not branch_negated or not split_subq
1399. 
1400.         try:
1401.             join_info = self.setup_joins(
1402.                 parts,
1403.                 opts,
1404.                 alias,
1405.                 can_reuse=can_reuse,
1406.                 allow_many=allow_many,
1407.             )
1408. 
1409.             # Prevent iterator from being consumed by check_related_objects()
1410.             if isinstance(value, Iterator):
1411.                 value = list(value)
1412.             self.check_related_objects(join_info.final_field, value, join_info.opts)
1413. 
1414.             # split_exclude() needs to know which joins were generated for the
1415.             # lookup parts
1416.             self._lookup_joins = join_info.joins
1417.         except MultiJoin as e:
1418.             return self.split_exclude(filter_expr, can_reuse, e.names_with_path)
1419. 
1420.         # Update used_joins before trimming since they are reused to determine
1421.         # which joins could be later promoted to INNER.
1422.         used_joins.update(join_info.joins)
1423.         targets, alias, join_list = self.trim_joins(
1424.             join_info.targets, join_info.joins, join_info.path
1425.         )
1426.         if can_reuse is not None:
1427.             can_reuse.update(join_list)
1428. 
1429.         if join_info.final_field.is_relation:
1430.             # No support for transforms for relational fields
1431.             num_lookups = len(lookups)
1432.             if num_lookups > 1:
1433.                 raise FieldError(
1434.                     "Related Field got invalid lookup: {}".format(lookups[0])
1435.                 )
1436.             if len(targets) == 1:
1437.                 col = self._get_col(targets[0], join_info.final_field, alias)
1438.             else:
1439.                 col = MultiColSource(
1440.                     alias, targets, join_info.targets, join_info.final_field
1441.                 )
1442.         else:
1443.             col = self._get_col(targets[0], join_info.final_field, alias)
1444. 
1445.         condition = self.build_lookup(lookups, col, value)
1446.         lookup_type = condition.lookup_name
1447.         clause = WhereNode([condition], connector=AND)
1448. 
1449.         require_outer = (
1450.             lookup_type == "isnull" and condition.rhs is True and not current_negated
1451.         )
1452.         if (
1453.             current_negated
1454.             and (lookup_type != "isnull" or condition.rhs is False)
1455.             and condition.rhs is not None
1456.         ):
1457.             require_outer = True
1458.             if lookup_type != "isnull":
1459.                 # The condition added here will be SQL like this:
1460.                 # NOT (col IS NOT NULL), where the first NOT is added in
1461.                 # upper layers of code. The reason for addition is that if col
1462.                 # is null, then col != someval will result in SQL "unknown"
1463.                 # which isn't the same as in Python. The Python None handling
1464.                 # is wanted, and it can be gotten by
1465.                 # (col IS NULL OR col != someval)
1466.                 #   <=>
1467.                 # NOT (col IS NOT NULL AND col = someval).
1468.                 if (
1469.                     self.is_nullable(targets[0])
1470.                     or self.alias_map[join_list[-1]].join_type == LOUTER
1471.                 ):
1472.                     lookup_class = targets[0].get_lookup("isnull")
1473.                     col = self._get_col(targets[0], join_info.targets[0], alias)
1474.                     clause.add(lookup_class(col, False), AND)
1475.                 # If someval is a nullable column, someval IS NOT NULL is
1476.                 # added.
1477.                 if isinstance(value, Col) and self.is_nullable(value.target):
1478.                     lookup_class = value.target.get_lookup("isnull")
1479.                     clause.add(lookup_class(value, False), AND)
1480.         return clause, used_joins if not require_outer else ()
1481. 
1482.     def add_filter(self, filter_lhs, filter_rhs):
1483.         self.add_q(Q((filter_lhs, filter_rhs)))
1484. 
1485.     def add_q(self, q_object):
1486.         """
1487.         A preprocessor for the internal _add_q(). Responsible for doing final
1488.         join promotion.
1489.         """
1490.         # For join promotion this case is doing an AND for the added q_object
1491.         # and existing conditions. So, any existing inner join forces the join
1492.         # type to remain inner. Existing outer joins can however be demoted.
1493.         # (Consider case where rel_a is LOUTER and rel_a__col=1 is added - if
1494.         # rel_a doesn't produce any rows, then the whole condition must fail.
1495.         # So, demotion is OK.
1496.         existing_inner = {
1497.             a for a in self.alias_map if self.alias_map[a].join_type == INNER
1498.         }
1499.         clause, _ = self._add_q(q_object, self.used_aliases)
1500.         if clause:
1501.             self.where.add(clause, AND)
1502.         self.demote_joins(existing_inner)
1503. 
1504.     def build_where(self, filter_expr):
1505.         return self.build_filter(filter_expr, allow_joins=False)[0]
1506. 
1507.     def clear_where(self):
1508.         self.where = WhereNode()
1509. 
1510.     def _add_q(
1511.         self,
1512.         q_object,
1513.         used_aliases,
1514.         branch_negated=False,
1515.         current_negated=False,
1516.         allow_joins=True,
1517.         split_subq=True,
1518.         check_filterable=True,
1519.     ):
1520.         """Add a Q-object to the current filter."""
1521.         connector = q_object.connector
1522.         current_negated = current_negated ^ q_object.negated
1523.         branch_negated = branch_negated or q_object.negated
1524.         target_clause = WhereNode(connector=connector, negated=q_object.negated)
1525.         joinpromoter = JoinPromoter(
1526.             q_object.connector, len(q_object.children), current_negated
1527.         )
1528.         for child in q_object.children:
1529.             child_clause, needed_inner = self.build_filter(
1530.                 child,
1531.                 can_reuse=used_aliases,
1532.                 branch_negated=branch_negated,
1533.                 current_negated=current_negated,
1534.                 allow_joins=allow_joins,
1535.                 split_subq=split_subq,
1536.                 check_filterable=check_filterable,
1537.             )
1538.             joinpromoter.add_votes(needed_inner)
1539.             if child_clause:
1540.                 target_clause.add(child_clause, connector)
1541.         needed_inner = joinpromoter.update_join_types(self)
1542.         return target_clause, needed_inner
1543. 
1544.     def build_filtered_relation_q(
1545.         self, q_object, reuse, branch_negated=False, current_negated=False
1546.     ):
1547.         """Add a FilteredRelation object to the current filter."""
1548.         connector = q_object.connector
1549.         current_negated ^= q_object.negated
1550.         branch_negated = branch_negated or q_object.negated
1551.         target_clause = WhereNode(connector=connector, negated=q_object.negated)
1552.         for child in q_object.children:
1553.             if isinstance(child, Node):
1554.                 child_clause = self.build_filtered_relation_q(
1555.                     child,
1556.                     reuse=reuse,
1557.                     branch_negated=branch_negated,
1558.                     current_negated=current_negated,
1559.                 )
1560.             else:
1561.                 child_clause, _ = self.build_filter(
1562.                     child,
1563.                     can_reuse=reuse,
1564.                     branch_negated=branch_negated,
1565.                     current_negated=current_negated,
1566.                     allow_joins=True,
1567.                     split_subq=False,
1568.                 )
1569.             target_clause.add(child_clause, connector)
1570.         return target_clause
1571. 
1572.     def add_filtered_relation(self, filtered_relation, alias):
1573.         filtered_relation.alias = alias
1574.         lookups = dict(get_children_from_q(filtered_relation.condition))
1575.         relation_lookup_parts, relation_field_parts, _ = self.solve_lookup_type(
1576.             filtered_relation.relation_name
1577.         )
1578.         if relation_lookup_parts:
1579.             raise ValueError(
1580.                 "FilteredRelation's relation_name cannot contain lookups "
1581.                 "(got %r)." % filtered_relation.relation_name
1582.             )
1583.         for lookup in chain(lookups):
1584.             lookup_parts, lookup_field_parts, _ = self.solve_lookup_type(lookup)
1585.             shift = 2 if not lookup_parts else 1
1586.             lookup_field_path = lookup_field_parts[:-shift]
1587.             for idx, lookup_field_part in enumerate(lookup_field_path):
1588.                 if len(relation_field_parts) > idx:
1589.                     if relation_field_parts[idx] != lookup_field_part:
1590.                         raise ValueError(
1591.                             "FilteredRelation's condition doesn't support "
1592.                             "relations outside the %r (got %r)."
1593.                             % (filtered_relation.relation_name, lookup)
1594.                         )
1595.                 else:
1596.                     raise ValueError(
1597.                         "FilteredRelation's condition doesn't support nested "
1598.                         "relations deeper than the relation_name (got %r for "
1599.                         "%r)." % (lookup, filtered_relation.relation_name)
1600.                     )
1601.         self._filtered_relations[filtered_relation.alias] = filtered_relation
1602. 
1603.     def names_to_path(self, names, opts, allow_many=True, fail_on_missing=False):
1604.         """
1605.         Walk the list of names and turns them into PathInfo tuples. A single
1606.         name in 'names' can generate multiple PathInfos (m2m, for example).
1607. 
1608.         'names' is the path of names to travel, 'opts' is the model Options we
1609.         start the name resolving from, 'allow_many' is as for setup_joins().
1610.         If fail_on_missing is set to True, then a name that can't be resolved
1611.         will generate a FieldError.
1612. 
1613.         Return a list of PathInfo tuples. In addition return the final field
1614.         (the last used join field) and target (which is a field guaranteed to
1615.         contain the same value as the final field). Finally, return those names
1616.         that weren't found (which are likely transforms and the final lookup).
1617.         """
1618.         path, names_with_path = [], []
1619.         for pos, name in enumerate(names):
1620.             cur_names_with_path = (name, [])
1621.             if name == "pk":
1622.                 name = opts.pk.name
1623. 
1624.             field = None
1625.             filtered_relation = None
1626.             try:
1627.                 if opts is None:
1628.                     raise FieldDoesNotExist
1629.                 field = opts.get_field(name)
1630.             except FieldDoesNotExist:
1631.                 if name in self.annotation_select:
1632.                     field = self.annotation_select[name].output_field
1633.                 elif name in self._filtered_relations and pos == 0:
1634.                     filtered_relation = self._filtered_relations[name]
1635.                     if LOOKUP_SEP in filtered_relation.relation_name:
1636.                         parts = filtered_relation.relation_name.split(LOOKUP_SEP)
1637.                         filtered_relation_path, field, _, _ = self.names_to_path(
1638.                             parts,
1639.                             opts,
1640.                             allow_many,
1641.                             fail_on_missing,
1642.                         )
1643.                         path.extend(filtered_relation_path[:-1])
1644.                     else:
1645.                         field = opts.get_field(filtered_relation.relation_name)
1646.             if field is not None:
1647.                 # Fields that contain one-to-many relations with a generic
1648.                 # model (like a GenericForeignKey) cannot generate reverse
1649.                 # relations and therefore cannot be used for reverse querying.
1650.                 if field.is_relation and not field.related_model:
1651.                     raise FieldError(
1652.                         "Field %r does not generate an automatic reverse "
1653.                         "relation and therefore cannot be used for reverse "
1654.                         "querying. If it is a GenericForeignKey, consider "
1655.                         "adding a GenericRelation." % name
1656.                     )
1657.                 try:
1658.                     model = field.model._meta.concrete_model
1659.                 except AttributeError:
1660.                     # QuerySet.annotate() may introduce fields that aren't
1661.                     # attached to a model.
1662.                     model = None
1663.             else:
1664.                 # We didn't find the current field, so move position back
1665.                 # one step.
1666.                 pos -= 1
1667.                 if pos == -1 or fail_on_missing:
1668.                     available = sorted(
1669.                         [
1670.                             *get_field_names_from_opts(opts),
1671.                             *self.annotation_select,
1672.                             *self._filtered_relations,
1673.                         ]
1674.                     )
1675.                     raise FieldError(
1676.                         "Cannot resolve keyword '%s' into field. "
1677.                         "Choices are: %s" % (name, ", ".join(available))
1678.                     )
1679.                 break
1680.             # Check if we need any joins for concrete inheritance cases (the
1681.             # field lives in parent, but we are currently in one of its
1682.             # children)
1683.             if opts is not None and model is not opts.model:
1684.                 path_to_parent = opts.get_path_to_parent(model)
1685.                 if path_to_parent:
1686.                     path.extend(path_to_parent)
1687.                     cur_names_with_path[1].extend(path_to_parent)
1688.                     opts = path_to_parent[-1].to_opts
1689.             if hasattr(field, "path_infos"):
1690.                 if filtered_relation:
1691.                     pathinfos = field.get_path_info(filtered_relation)
1692.                 else:
1693.                     pathinfos = field.path_infos
1694.                 if not allow_many:
1695.                     for inner_pos, p in enumerate(pathinfos):
1696.                         if p.m2m:
1697.                             cur_names_with_path[1].extend(pathinfos[0 : inner_pos + 1])
1698.                             names_with_path.append(cur_names_with_path)
1699.                             raise MultiJoin(pos + 1, names_with_path)
1700.                 last = pathinfos[-1]
1701.                 path.extend(pathinfos)
1702.                 final_field = last.join_field
1703.                 opts = last.to_opts
1704.                 targets = last.target_fields
1705.                 cur_names_with_path[1].extend(pathinfos)
1706.                 names_with_path.append(cur_names_with_path)
1707.             else:
1708.                 # Local non-relational field.
1709.                 final_field = field
1710.                 targets = (field,)
1711.                 if fail_on_missing and pos + 1 != len(names):
1712.                     raise FieldError(
1713.                         "Cannot resolve keyword %r into field. Join on '%s'"
1714.                         " not permitted." % (names[pos + 1], name)
1715.                     )
1716.                 break
1717.         return path, final_field, targets, names[pos + 1 :]
1718. 
1719.     def setup_joins(self, names, opts, alias, can_reuse=None, allow_many=True):
1720.         """
1721.         Compute the necessary table joins for the passage through the fields
1722.         given in 'names'. 'opts' is the Options class for the current model
1723.         (which gives the table we are starting from), 'alias' is the alias for
1724.         the table to start the joining from.
1725. 
1726.         The 'can_reuse' defines the reverse foreign key joins we can reuse. It
1727.         can be None in which case all joins are reusable or a set of aliases
1728.         that can be reused. Note that non-reverse foreign keys are always
1729.         reusable when using setup_joins().
1730. 
1731.         If 'allow_many' is False, then any reverse foreign key seen will
1732.         generate a MultiJoin exception.
1733. 
1734.         Return the final field involved in the joins, the target field (used
1735.         for any 'where' constraint), the final 'opts' value, the joins, the
1736.         field path traveled to generate the joins, and a transform function
1737.         that takes a field and alias and is equivalent to `field.get_col(alias)`
1738.         in the simple case but wraps field transforms if they were included in
1739.         names.
1740. 
1741.         The target field is the field containing the concrete value. Final
1742.         field can be something different, for example foreign key pointing to
1743.         that value. Final field is needed for example in some value
1744.         conversions (convert 'obj' in fk__id=obj to pk val using the foreign
1745.         key field for example).
1746.         """
1747.         joins = [alias]
1748.         # The transform can't be applied yet, as joins must be trimmed later.
1749.         # To avoid making every caller of this method look up transforms
1750.         # directly, compute transforms here and create a partial that converts
1751.         # fields to the appropriate wrapped version.
1752. 
1753.         def final_transformer(field, alias):
1754.             if not self.alias_cols:
1755.                 alias = None
1756.             return field.get_col(alias)
1757. 
1758.         # Try resolving all the names as fields first. If there's an error,
1759.         # treat trailing names as lookups until a field can be resolved.
1760.         last_field_exception = None
1761.         for pivot in range(len(names), 0, -1):
1762.             try:
1763.                 path, final_field, targets, rest = self.names_to_path(
1764.                     names[:pivot],
1765.                     opts,
1766.                     allow_many,
1767.                     fail_on_missing=True,
1768.                 )
1769.             except FieldError as exc:
1770.                 if pivot == 1:
1771.                     # The first item cannot be a lookup, so it's safe
1772.                     # to raise the field error here.
1773.                     raise
1774.                 else:
1775.                     last_field_exception = exc
1776.             else:
1777.                 # The transforms are the remaining items that couldn't be
1778.                 # resolved into fields.
1779.                 transforms = names[pivot:]
1780.                 break
1781.         for name in transforms:
1782. 
1783.             def transform(field, alias, *, name, previous):
1784.                 try:
1785.                     wrapped = previous(field, alias)
1786.                     return self.try_transform(wrapped, name)
1787.                 except FieldError:
1788.                     # FieldError is raised if the transform doesn't exist.
1789.                     if isinstance(final_field, Field) and last_field_exception:
1790.                         raise last_field_exception
1791.                     else:
1792.                         raise
1793. 
1794.             final_transformer = functools.partial(
1795.                 transform, name=name, previous=final_transformer
1796.             )
1797.         # Then, add the path to the query's joins. Note that we can't trim
1798.         # joins at this stage - we will need the information about join type
1799.         # of the trimmed joins.
1800.         for join in path:
1801.             if join.filtered_relation:
1802.                 filtered_relation = join.filtered_relation.clone()
1803.                 table_alias = filtered_relation.alias
1804.             else:
1805.                 filtered_relation = None
1806.                 table_alias = None
1807.             opts = join.to_opts
1808.             if join.direct:
1809.                 nullable = self.is_nullable(join.join_field)
1810.             else:
1811.                 nullable = True
1812.             connection = self.join_class(
1813.                 opts.db_table,
1814.                 alias,
1815.                 table_alias,
1816.                 INNER,
1817.                 join.join_field,
1818.                 nullable,
1819.                 filtered_relation=filtered_relation,
1820.             )
1821.             reuse = can_reuse if join.m2m else None
1822.             alias = self.join(connection, reuse=reuse)
1823.             joins.append(alias)
1824.             if filtered_relation:
1825.                 filtered_relation.path = joins[:]
1826.         return JoinInfo(final_field, targets, opts, joins, path, final_transformer)
1827. 
1828.     def trim_joins(self, targets, joins, path):
1829.         """
1830.         The 'target' parameter is the final field being joined to, 'joins'
1831.         is the full list of join aliases. The 'path' contain the PathInfos
1832.         used to create the joins.
1833. 
1834.         Return the final target field and table alias and the new active
1835.         joins.
1836. 
1837.         Always trim any direct join if the target column is already in the
1838.         previous table. Can't trim reverse joins as it's unknown if there's
1839.         anything on the other side of the join.
1840.         """
1841.         joins = joins[:]
1842.         for pos, info in enumerate(reversed(path)):
1843.             if len(joins) == 1 or not info.direct:
1844.                 break
1845.             if info.filtered_relation:
1846.                 break
1847.             join_targets = {t.column for t in info.join_field.foreign_related_fields}
1848.             cur_targets = {t.column for t in targets}
1849.             if not cur_targets.issubset(join_targets):
1850.                 break
1851.             targets_dict = {
1852.                 r[1].column: r[0]
1853.                 for r in info.join_field.related_fields
1854.                 if r[1].column in cur_targets
1855.             }
1856.             targets = tuple(targets_dict[t.column] for t in targets)
1857.             self.unref_alias(joins.pop())
1858.         return targets, joins[-1], joins
1859. 
1860.     @classmethod
1861.     def _gen_cols(cls, exprs, include_external=False):
1862.         for expr in exprs:
1863.             if isinstance(expr, Col):
1864.                 yield expr
1865.             elif include_external and callable(
1866.                 getattr(expr, "get_external_cols", None)
1867.             ):
1868.                 yield from expr.get_external_cols()
1869.             elif hasattr(expr, "get_source_expressions"):
1870.                 yield from cls._gen_cols(
1871.                     expr.get_source_expressions(),
1872.                     include_external=include_external,
1873.                 )
1874. 
1875.     @classmethod
1876.     def _gen_col_aliases(cls, exprs):
1877.         yield from (expr.alias for expr in cls._gen_cols(exprs))
1878. 
1879.     def resolve_ref(self, name, allow_joins=True, reuse=None, summarize=False):
1880.         annotation = self.annotations.get(name)
1881.         if annotation is not None:
1882.             if not allow_joins:
1883.                 for alias in self._gen_col_aliases([annotation]):
1884.                     if isinstance(self.alias_map[alias], Join):
1885.                         raise FieldError(
1886.                             "Joined field references are not permitted in this query"
1887.                         )
1888.             if summarize:
1889.                 # Summarize currently means we are doing an aggregate() query
1890.                 # which is executed as a wrapped subquery if any of the
1891.                 # aggregate() elements reference an existing annotation. In
1892.                 # that case we need to return a Ref to the subquery's annotation.
1893.                 if name not in self.annotation_select:
1894.                     raise FieldError(
1895.                         "Cannot aggregate over the '%s' alias. Use annotate() "
1896.                         "to promote it." % name
1897.                     )
1898.                 return Ref(name, self.annotation_select[name])
1899.             else:
1900.                 return annotation
1901.         else:
1902.             field_list = name.split(LOOKUP_SEP)
1903.             annotation = self.annotations.get(field_list[0])
1904.             if annotation is not None:
1905.                 for transform in field_list[1:]:
1906.                     annotation = self.try_transform(annotation, transform)
1907.                 return annotation
1908.             join_info = self.setup_joins(
1909.                 field_list, self.get_meta(), self.get_initial_alias(), can_reuse=reuse
1910.             )
1911.             targets, final_alias, join_list = self.trim_joins(
1912.                 join_info.targets, join_info.joins, join_info.path
1913.             )
1914.             if not allow_joins and len(join_list) > 1:
1915.                 raise FieldError(
1916.                     "Joined field references are not permitted in this query"
1917.                 )
1918.             if len(targets) > 1:
1919.                 raise FieldError(
1920.                     "Referencing multicolumn fields with F() objects isn't supported"
1921.                 )
1922.             # Verify that the last lookup in name is a field or a transform:
1923.             # transform_function() raises FieldError if not.
1924.             transform = join_info.transform_function(targets[0], final_alias)
1925.             if reuse is not None:
1926.                 reuse.update(join_list)
1927.             return transform
1928. 
1929.     def split_exclude(self, filter_expr, can_reuse, names_with_path):
1930.         """
1931.         When doing an exclude against any kind of N-to-many relation, we need
1932.         to use a subquery. This method constructs the nested query, given the
1933.         original exclude filter (filter_expr) and the portion up to the first
1934.         N-to-many relation field.
1935. 
1936.         For example, if the origin filter is ~Q(child__name='foo'), filter_expr
1937.         is ('child__name', 'foo') and can_reuse is a set of joins usable for
1938.         filters in the original query.
1939. 
1940.         We will turn this into equivalent of:
1941.             WHERE NOT EXISTS(
1942.                 SELECT 1
1943.                 FROM child
1944.                 WHERE name = 'foo' AND child.parent_id = parent.id
1945.                 LIMIT 1
1946.             )
1947.         """
1948.         # Generate the inner query.
1949.         query = self.__class__(self.model)
1950.         query._filtered_relations = self._filtered_relations
1951.         filter_lhs, filter_rhs = filter_expr
1952.         if isinstance(filter_rhs, OuterRef):
1953.             filter_rhs = OuterRef(filter_rhs)
1954.         elif isinstance(filter_rhs, F):
1955.             filter_rhs = OuterRef(filter_rhs.name)
1956.         query.add_filter(filter_lhs, filter_rhs)
1957.         query.clear_ordering(force=True)
1958.         # Try to have as simple as possible subquery -> trim leading joins from
1959.         # the subquery.
1960.         trimmed_prefix, contains_louter = query.trim_start(names_with_path)
1961. 
1962.         col = query.select[0]
1963.         select_field = col.target
1964.         alias = col.alias
1965.         if alias in can_reuse:
1966.             pk = select_field.model._meta.pk
1967.             # Need to add a restriction so that outer query's filters are in effect for
1968.             # the subquery, too.
1969.             query.bump_prefix(self)
1970.             lookup_class = select_field.get_lookup("exact")
1971.             # Note that the query.select[0].alias is different from alias
1972.             # due to bump_prefix above.
1973.             lookup = lookup_class(pk.get_col(query.select[0].alias), pk.get_col(alias))
1974.             query.where.add(lookup, AND)
1975.             query.external_aliases[alias] = True
1976. 
1977.         lookup_class = select_field.get_lookup("exact")
1978.         lookup = lookup_class(col, ResolvedOuterRef(trimmed_prefix))
1979.         query.where.add(lookup, AND)
1980.         condition, needed_inner = self.build_filter(Exists(query))
1981. 
1982.         if contains_louter:
1983.             or_null_condition, _ = self.build_filter(
1984.                 ("%s__isnull" % trimmed_prefix, True),
1985.                 current_negated=True,
1986.                 branch_negated=True,
1987.                 can_reuse=can_reuse,
1988.             )
1989.             condition.add(or_null_condition, OR)
1990.             # Note that the end result will be:
1991.             # (outercol NOT IN innerq AND outercol IS NOT NULL) OR outercol IS NULL.
1992.             # This might look crazy but due to how IN works, this seems to be
1993.             # correct. If the IS NOT NULL check is removed then outercol NOT
1994.             # IN will return UNKNOWN. If the IS NULL check is removed, then if
1995.             # outercol IS NULL we will not match the row.
1996.         return condition, needed_inner
1997. 
1998.     def set_empty(self):
1999.         self.where.add(NothingNode(), AND)
2000.         for query in self.combined_queries:
2001.             query.set_empty()
2002. 
2003.     def is_empty(self):
2004.         return any(isinstance(c, NothingNode) for c in self.where.children)
2005. 
2006.     def set_limits(self, low=None, high=None):
2007.         """
2008.         Adjust the limits on the rows retrieved. Use low/high to set these,
2009.         as it makes it more Pythonic to read and write. When the SQL query is
2010.         created, convert them to the appropriate offset and limit values.
2011. 
2012.         Apply any limits passed in here to the existing constraints. Add low
2013.         to the current low value and clamp both to any existing high value.
2014.         """
2015.         if high is not None:
2016.             if self.high_mark is not None:
2017.                 self.high_mark = min(self.high_mark, self.low_mark + high)
2018.             else:
2019.                 self.high_mark = self.low_mark + high
2020.         if low is not None:
2021.             if self.high_mark is not None:
2022.                 self.low_mark = min(self.high_mark, self.low_mark + low)
2023.             else:
2024.                 self.low_mark = self.low_mark + low
2025. 
2026.         if self.low_mark == self.high_mark:
2027.             self.set_empty()
2028. 
2029.     def clear_limits(self):
2030.         """Clear any existing limits."""
2031.         self.low_mark, self.high_mark = 0, None
2032. 
2033.     @property
2034.     def is_sliced(self):
2035.         return self.low_mark != 0 or self.high_mark is not None
2036. 
2037.     def has_limit_one(self):
2038.         return self.high_mark is not None and (self.high_mark - self.low_mark) == 1
2039. 
2040.     def can_filter(self):
2041.         """
2042.         Return True if adding filters to this instance is still possible.
2043. 
2044.         Typically, this means no limits or offsets have been put on the results.
2045.         """
2046.         return not self.is_sliced
2047. 
2048.     def clear_select_clause(self):
2049.         """Remove all fields from SELECT clause."""
2050.         self.select = ()
2051.         self.default_cols = False
2052.         self.select_related = False
2053.         self.set_extra_mask(())
2054.         self.set_annotation_mask(())
2055. 
2056.     def clear_select_fields(self):
2057.         """
2058.         Clear the list of fields to select (but not extra_select columns).
2059.         Some queryset types completely replace any existing list of select
2060.         columns.
2061.         """
2062.         self.select = ()
2063.         self.values_select = ()
2064. 
2065.     def add_select_col(self, col, name):
2066.         self.select += (col,)
2067.         self.values_select += (name,)
2068. 
2069.     def set_select(self, cols):
2070.         self.default_cols = False
2071.         self.select = tuple(cols)
2072. 
2073.     def add_distinct_fields(self, *field_names):
2074.         """
2075.         Add and resolve the given fields to the query's "distinct on" clause.
2076.         """
2077.         self.distinct_fields = field_names
2078.         self.distinct = True
2079. 
2080.     def add_fields(self, field_names, allow_m2m=True):
2081.         """
2082.         Add the given (model) fields to the select set. Add the field names in
2083.         the order specified.
2084.         """
2085.         alias = self.get_initial_alias()
2086.         opts = self.get_meta()
2087. 
2088.         try:
2089.             cols = []
2090.             for name in field_names:
2091.                 # Join promotion note - we must not remove any rows here, so
2092.                 # if there is no existing joins, use outer join.
2093.                 join_info = self.setup_joins(
2094.                     name.split(LOOKUP_SEP), opts, alias, allow_many=allow_m2m
2095.                 )
2096.                 targets, final_alias, joins = self.trim_joins(
2097.                     join_info.targets,
2098.                     join_info.joins,
2099.                     join_info.path,
2100.                 )
2101.                 for target in targets:
2102.                     cols.append(join_info.transform_function(target, final_alias))
2103.             if cols:
2104.                 self.set_select(cols)
2105.         except MultiJoin:
2106.             raise FieldError("Invalid field name: '%s'" % name)
2107.         except FieldError:
2108.             if LOOKUP_SEP in name:
2109.                 # For lookups spanning over relationships, show the error
2110.                 # from the model on which the lookup failed.
2111.                 raise
2112.             elif name in self.annotations:
2113.                 raise FieldError(
2114.                     "Cannot select the '%s' alias. Use annotate() to promote "
2115.                     "it." % name
2116.                 )
2117.             else:
2118.                 names = sorted(
2119.                     [
2120.                         *get_field_names_from_opts(opts),
2121.                         *self.extra,
2122.                         *self.annotation_select,
2123.                         *self._filtered_relations,
2124.                     ]
2125.                 )
2126.                 raise FieldError(
2127.                     "Cannot resolve keyword %r into field. "
2128.                     "Choices are: %s" % (name, ", ".join(names))
2129.                 )
2130. 
2131.     def add_ordering(self, *ordering):
2132.         """
2133.         Add items from the 'ordering' sequence to the query's "order by"
2134.         clause. These items are either field names (not column names) --
2135.         possibly with a direction prefix ('-' or '?') -- or OrderBy
2136.         expressions.
2137. 
2138.         If 'ordering' is empty, clear all ordering from the query.
2139.         """
2140.         errors = []
2141.         for item in ordering:
2142.             if isinstance(item, str):
2143.                 if item == "?":
2144.                     continue
2145.                 if item.startswith("-"):
2146.                     item = item[1:]
2147.                 if item in self.annotations:
2148.                     continue
2149.                 if self.extra and item in self.extra:
2150.                     continue
2151.                 # names_to_path() validates the lookup. A descriptive
2152.                 # FieldError will be raise if it's not.
2153.                 self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
2154.             elif not hasattr(item, "resolve_expression"):
2155.                 errors.append(item)
2156.             if getattr(item, "contains_aggregate", False):
2157.                 raise FieldError(
2158.                     "Using an aggregate in order_by() without also including "
2159.                     "it in annotate() is not allowed: %s" % item
2160.                 )
2161.         if errors:
2162.             raise FieldError("Invalid order_by arguments: %s" % errors)
2163.         if ordering:
2164.             self.order_by += ordering
2165.         else:
2166.             self.default_ordering = False
2167. 
2168.     def clear_ordering(self, force=False, clear_default=True):
2169.         """
2170.         Remove any ordering settings if the current query allows it without
2171.         side effects, set 'force' to True to clear the ordering regardless.
2172.         If 'clear_default' is True, there will be no ordering in the resulting
2173.         query (not even the model's default).
2174.         """
2175.         if not force and (
2176.             self.is_sliced or self.distinct_fields or self.select_for_update
2177.         ):
2178.             return
2179.         self.order_by = ()
2180.         self.extra_order_by = ()
2181.         if clear_default:
2182.             self.default_ordering = False
2183. 
2184.     def set_group_by(self, allow_aliases=True):
2185.         """
2186.         Expand the GROUP BY clause required by the query.
2187. 
2188.         This will usually be the set of all non-aggregate fields in the
2189.         return data. If the database backend supports grouping by the
2190.         primary key, and the query would be equivalent, the optimization
2191.         will be made automatically.
2192.         """
2193.         # Column names from JOINs to check collisions with aliases.
2194.         if allow_aliases:
2195.             column_names = set()
2196.             seen_models = set()
2197.             for join in list(self.alias_map.values())[1:]:  # Skip base table.
2198.                 model = join.join_field.related_model
2199.                 if model not in seen_models:
2200.                     column_names.update(
2201.                         {field.column for field in model._meta.local_concrete_fields}
2202.                     )
2203.                     seen_models.add(model)
2204. 
2205.         group_by = list(self.select)
2206.         if self.annotation_select:
2207.             for alias, annotation in self.annotation_select.items():
2208.                 if not allow_aliases or alias in column_names:
2209.                     alias = None
2210.                 group_by_cols = annotation.get_group_by_cols(alias=alias)
2211.                 group_by.extend(group_by_cols)
2212.         self.group_by = tuple(group_by)
2213. 
2214.     def add_select_related(self, fields):
2215.         """
2216.         Set up the select_related data structure so that we only select
2217.         certain related models (as opposed to all models, when
2218.         self.select_related=True).
2219.         """
2220.         if isinstance(self.select_related, bool):
2221.             field_dict = {}
2222.         else:
2223.             field_dict = self.select_related
2224.         for field in fields:
2225.             d = field_dict
2226.             for part in field.split(LOOKUP_SEP):
2227.                 d = d.setdefault(part, {})
2228.         self.select_related = field_dict
2229. 
2230.     def add_extra(self, select, select_params, where, params, tables, order_by):
2231.         """
2232.         Add data to the various extra_* attributes for user-created additions
2233.         to the query.
2234.         """
2235.         if select:
2236.             # We need to pair any placeholder markers in the 'select'
2237.             # dictionary with their parameters in 'select_params' so that
2238.             # subsequent updates to the select dictionary also adjust the
2239.             # parameters appropriately.
2240.             select_pairs = {}
2241.             if select_params:
2242.                 param_iter = iter(select_params)
2243.             else:
2244.                 param_iter = iter([])
2245.             for name, entry in select.items():
2246.                 entry = str(entry)
2247.                 entry_params = []
2248.                 pos = entry.find("%s")
2249.                 while pos != -1:
2250.                     if pos == 0 or entry[pos - 1] != "%":
2251.                         entry_params.append(next(param_iter))
2252.                     pos = entry.find("%s", pos + 2)
2253.                 select_pairs[name] = (entry, entry_params)
2254.             self.extra.update(select_pairs)
2255.         if where or params:
2256.             self.where.add(ExtraWhere(where, params), AND)
2257.         if tables:
2258.             self.extra_tables += tuple(tables)
2259.         if order_by:
2260.             self.extra_order_by = order_by
2261. 
2262.     def clear_deferred_loading(self):
2263.         """Remove any fields from the deferred loading set."""
2264.         self.deferred_loading = (frozenset(), True)
2265. 
2266.     def add_deferred_loading(self, field_names):
2267.         """
2268.         Add the given list of model field names to the set of fields to
2269.         exclude from loading from the database when automatic column selection
2270.         is done. Add the new field names to any existing field names that
2271.         are deferred (or removed from any existing field names that are marked
2272.         as the only ones for immediate loading).
2273.         """
2274.         # Fields on related models are stored in the literal double-underscore
2275.         # format, so that we can use a set datastructure. We do the foo__bar
2276.         # splitting and handling when computing the SQL column names (as part of
2277.         # get_columns()).
2278.         existing, defer = self.deferred_loading
2279.         if defer:
2280.             # Add to existing deferred names.
2281.             self.deferred_loading = existing.union(field_names), True
2282.         else:
2283.             # Remove names from the set of any existing "immediate load" names.
2284.             if new_existing := existing.difference(field_names):
2285.                 self.deferred_loading = new_existing, False
2286.             else:
2287.                 self.clear_deferred_loading()
2288.                 if new_only := set(field_names).difference(existing):
2289.                     self.deferred_loading = new_only, True
2290. 
2291.     def add_immediate_loading(self, field_names):
2292.         """
2293.         Add the given list of model field names to the set of fields to
2294.         retrieve when the SQL is executed ("immediate loading" fields). The
2295.         field names replace any existing immediate loading field names. If
2296.         there are field names already specified for deferred loading, remove
2297.         those names from the new field_names before storing the new names
2298.         for immediate loading. (That is, immediate loading overrides any
2299.         existing immediate values, but respects existing deferrals.)
2300.         """
2301.         existing, defer = self.deferred_loading
2302.         field_names = set(field_names)
2303.         if "pk" in field_names:
2304.             field_names.remove("pk")
2305.             field_names.add(self.get_meta().pk.name)
2306. 
2307.         if defer:
2308.             # Remove any existing deferred names from the current set before
2309.             # setting the new names.
2310.             self.deferred_loading = field_names.difference(existing), False
2311.         else:
2312.             # Replace any existing "immediate load" field names.
2313.             self.deferred_loading = frozenset(field_names), False
2314. 
2315.     def get_loaded_field_names(self):
2316.         """
2317.         If any fields are marked to be deferred, return a dictionary mapping
2318.         models to a set of names in those fields that will be loaded. If a
2319.         model is not in the returned dictionary, none of its fields are
2320.         deferred.
2321. 
2322.         If no fields are marked for deferral, return an empty dictionary.
2323.         """
2324.         # We cache this because we call this function multiple times
2325.         # (compiler.fill_related_selections, query.iterator)
2326.         try:
2327.             return self._loaded_field_names_cache
2328.         except AttributeError:
2329.             collection = {}
2330.             self.deferred_to_data(collection, self.get_loaded_field_names_cb)
2331.             self._loaded_field_names_cache = collection
2332.             return collection
2333. 
2334.     def get_loaded_field_names_cb(self, target, model, fields):
2335.         """Callback used by get_deferred_field_names()."""
2336.         target[model] = {f.attname for f in fields}
2337. 
2338.     def set_annotation_mask(self, names):
2339.         """Set the mask of annotations that will be returned by the SELECT."""
2340.         if names is None:
2341.             self.annotation_select_mask = None
2342.         else:
2343.             self.annotation_select_mask = set(names)
2344.         self._annotation_select_cache = None
2345. 
2346.     def append_annotation_mask(self, names):
2347.         if self.annotation_select_mask is not None:
2348.             self.set_annotation_mask(self.annotation_select_mask.union(names))
2349. 
2350.     def set_extra_mask(self, names):
2351.         """
2352.         Set the mask of extra select items that will be returned by SELECT.
2353.         Don't remove them from the Query since they might be used later.
2354.         """
2355.         if names is None:
2356.             self.extra_select_mask = None
2357.         else:
2358.             self.extra_select_mask = set(names)
2359.         self._extra_select_cache = None
2360. 
2361.     def set_values(self, fields):
2362.         self.select_related = False
2363.         self.clear_deferred_loading()
2364.         self.clear_select_fields()
2365. 
2366.         if fields:
2367.             field_names = []
2368.             extra_names = []
2369.             annotation_names = []
2370.             if not self.extra and not self.annotations:
2371.                 # Shortcut - if there are no extra or annotations, then
2372.                 # the values() clause must be just field names.
2373.                 field_names = list(fields)
2374.             else:
2375.                 self.default_cols = False
2376.                 for f in fields:
2377.                     if f in self.extra_select:
2378.                         extra_names.append(f)
2379.                     elif f in self.annotation_select:
2380.                         annotation_names.append(f)
2381.                     else:
2382.                         field_names.append(f)
2383.             self.set_extra_mask(extra_names)
2384.             self.set_annotation_mask(annotation_names)
2385.             selected = frozenset(field_names + extra_names + annotation_names)
2386.         else:
2387.             field_names = [f.attname for f in self.model._meta.concrete_fields]
2388.             selected = frozenset(field_names)
2389.         # Selected annotations must be known before setting the GROUP BY
2390.         # clause.
2391.         if self.group_by is True:
2392.             self.add_fields(
2393.                 (f.attname for f in self.model._meta.concrete_fields), False
2394.             )
2395.             # Disable GROUP BY aliases to avoid orphaning references to the
2396.             # SELECT clause which is about to be cleared.
2397.             self.set_group_by(allow_aliases=False)
2398.             self.clear_select_fields()
2399.         elif self.group_by:
2400.             # Resolve GROUP BY annotation references if they are not part of
2401.             # the selected fields anymore.
2402.             group_by = []
2403.             for expr in self.group_by:
2404.                 if isinstance(expr, Ref) and expr.refs not in selected:
2405.                     expr = self.annotations[expr.refs]
2406.                 group_by.append(expr)
2407.             self.group_by = tuple(group_by)
2408. 
2409.         self.values_select = tuple(field_names)
2410.         self.add_fields(field_names, True)
2411. 
2412.     @property
2413.     def annotation_select(self):
2414.         """
2415.         Return the dictionary of aggregate columns that are not masked and
2416.         should be used in the SELECT clause. Cache this result for performance.
2417.         """
2418.         if self._annotation_select_cache is not None:
2419.             return self._annotation_select_cache
2420.         elif not self.annotations:
2421.             return {}
2422.         elif self.annotation_select_mask is not None:
2423.             self._annotation_select_cache = {
2424.                 k: v
2425.                 for k, v in self.annotations.items()
2426.                 if k in self.annotation_select_mask
2427.             }
2428.             return self._annotation_select_cache
2429.         else:
2430.             return self.annotations
2431. 
2432.     @property
2433.     def extra_select(self):
2434.         if self._extra_select_cache is not None:
2435.             return self._extra_select_cache
2436.         if not self.extra:
2437.             return {}
2438.         elif self.extra_select_mask is not None:
2439.             self._extra_select_cache = {
2440.                 k: v for k, v in self.extra.items() if k in self.extra_select_mask
2441.             }
2442.             return self._extra_select_cache
2443.         else:
2444.             return self.extra
2445. 
2446.     def trim_start(self, names_with_path):
2447.         """
2448.         Trim joins from the start of the join path. The candidates for trim
2449.         are the PathInfos in names_with_path structure that are m2m joins.
2450. 
2451.         Also set the select column so the start matches the join.
2452. 
2453.         This method is meant to be used for generating the subquery joins &
2454.         cols in split_exclude().
2455. 
2456.         Return a lookup usable for doing outerq.filter(lookup=self) and a
2457.         boolean indicating if the joins in the prefix contain a LEFT OUTER join.
2458.         _"""
2459.         all_paths = []
2460.         for _, paths in names_with_path:
2461.             all_paths.extend(paths)
2462.         contains_louter = False
2463.         # Trim and operate only on tables that were generated for
2464.         # the lookup part of the query. That is, avoid trimming
2465.         # joins generated for F() expressions.
2466.         lookup_tables = [
2467.             t for t in self.alias_map if t in self._lookup_joins or t == self.base_table
2468.         ]
2469.         for trimmed_paths, path in enumerate(all_paths):
2470.             if path.m2m:
2471.                 break
2472.             if self.alias_map[lookup_tables[trimmed_paths + 1]].join_type == LOUTER:
2473.                 contains_louter = True
2474.             alias = lookup_tables[trimmed_paths]
2475.             self.unref_alias(alias)
2476.         # The path.join_field is a Rel, lets get the other side's field
2477.         join_field = path.join_field.field
2478.         # Build the filter prefix.
2479.         paths_in_prefix = trimmed_paths
2480.         trimmed_prefix = []
2481.         for name, path in names_with_path:
2482.             if paths_in_prefix - len(path) < 0:
2483.                 break
2484.             trimmed_prefix.append(name)
2485.             paths_in_prefix -= len(path)
2486.         trimmed_prefix.append(join_field.foreign_related_fields[0].name)
2487.         trimmed_prefix = LOOKUP_SEP.join(trimmed_prefix)
2488.         # Lets still see if we can trim the first join from the inner query
2489.         # (that is, self). We can't do this for:
2490.         # - LEFT JOINs because we would miss those rows that have nothing on
2491.         #   the outer side,
2492.         # - INNER JOINs from filtered relations because we would miss their
2493.         #   filters.
2494.         first_join = self.alias_map[lookup_tables[trimmed_paths + 1]]
2495.         if first_join.join_type != LOUTER and not first_join.filtered_relation:
2496.             select_fields = [r[0] for r in join_field.related_fields]
2497.             select_alias = lookup_tables[trimmed_paths + 1]
2498.             self.unref_alias(lookup_tables[trimmed_paths])
2499.             extra_restriction = join_field.get_extra_restriction(
2500.                 None, lookup_tables[trimmed_paths + 1]
2501.             )
2502.             if extra_restriction:
2503.                 self.where.add(extra_restriction, AND)
2504.         else:
2505.             # TODO: It might be possible to trim more joins from the start of the
2506.             # inner query if it happens to have a longer join chain containing the
2507.             # values in select_fields. Lets punt this one for now.
2508.             select_fields = [r[1] for r in join_field.related_fields]
2509.             select_alias = lookup_tables[trimmed_paths]
2510.         # The found starting point is likely a join_class instead of a
2511.         # base_table_class reference. But the first entry in the query's FROM
2512.         # clause must not be a JOIN.
2513.         for table in self.alias_map:
2514.             if self.alias_refcount[table] > 0:
2515.                 self.alias_map[table] = self.base_table_class(
2516.                     self.alias_map[table].table_name,
2517.                     table,
2518.                 )
2519.                 break
2520.         self.set_select([f.get_col(select_alias) for f in select_fields])
2521.         return trimmed_prefix, contains_louter
2522. 
2523.     def is_nullable(self, field):
2524.         """
2525.         Check if the given field should be treated as nullable.
2526. 
2527.         Some backends treat '' as null and Django treats such fields as
2528.         nullable for those backends. In such situations field.null can be
2529.         False even if we should treat the field as nullable.
2530.         """
2531.         # We need to use DEFAULT_DB_ALIAS here, as QuerySet does not have
2532.         # (nor should it have) knowledge of which connection is going to be
2533.         # used. The proper fix would be to defer all decisions where
2534.         # is_nullable() is needed to the compiler stage, but that is not easy
2535.         # to do currently.
2536.         return field.null or (
2537.             field.empty_strings_allowed
2538.             and connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls
2539.         )
2540. 
2541. 
2542. def get_order_dir(field, default="ASC"):
2543.     """
2544.     Return the field name and direction for an order specification. For
2545.     example, '-foo' is returned as ('foo', 'DESC').
2546. 
2547.     The 'default' param is used to indicate which way no prefix (or a '+'
2548.     prefix) should sort. The '-' prefix always sorts the opposite way.
2549.     """
2550.     dirn = ORDER_DIR[default]
2551.     if field[0] == "-":
2552.         return field[1:], dirn[1]
2553.     return field, dirn[0]
2554. 
2555. 
2556. def add_to_dict(data, key, value):
2557.     """
2558.     Add "value" to the set of values for "key", whether or not "key" already
2559.     exists.
2560.     """
2561.     if key in data:
2562.         data[key].add(value)
2563.     else:
2564.         data[key] = {value}
2565. 
2566. 
2567. def is_reverse_o2o(field):
2568.     """
2569.     Check if the given field is reverse-o2o. The field is expected to be some
2570.     sort of relation field or related object.
2571.     """
2572.     return field.is_relation and field.one_to_one and not field.concrete
2573. 
2574. 
2575. class JoinPromoter:
2576.     """
2577.     A class to abstract away join promotion problems for complex filter
2578.     conditions.
2579.     """
2580. 
2581.     def __init__(self, connector, num_children, negated):
2582.         self.connector = connector
2583.         self.negated = negated
2584.         if self.negated:
2585.             if connector == AND:
2586.                 self.effective_connector = OR
2587.             else:
2588.                 self.effective_connector = AND
2589.         else:
2590.             self.effective_connector = self.connector
2591.         self.num_children = num_children
2592.         # Maps of table alias to how many times it is seen as required for
2593.         # inner and/or outer joins.
2594.         self.votes = Counter()
2595. 
2596.     def __repr__(self):
2597.         return (
2598.             f"{self.__class__.__qualname__}(connector={self.connector!r}, "
2599.             f"num_children={self.num_children!r}, negated={self.negated!r})"
2600.         )
2601. 
2602.     def add_votes(self, votes):
2603.         """
2604.         Add single vote per item to self.votes. Parameter can be any
2605.         iterable.
2606.         """
2607.         self.votes.update(votes)
2608. 
2609.     def update_join_types(self, query):
2610.         """
2611.         Change join types so that the generated query is as efficient as
2612.         possible, but still correct. So, change as many joins as possible
2613.         to INNER, but don't make OUTER joins INNER if that could remove
2614.         results from the query.
2615.         """
2616.         to_promote = set()
2617.         to_demote = set()
2618.         # The effective_connector is used so that NOT (a AND b) is treated
2619.         # similarly to (a OR b) for join promotion.
2620.         for table, votes in self.votes.items():
2621.             # We must use outer joins in OR case when the join isn't contained
2622.             # in all of the joins. Otherwise the INNER JOIN itself could remove
2623.             # valid results. Consider the case where a model with rel_a and
2624.             # rel_b relations is queried with rel_a__col=1 | rel_b__col=2. Now,
2625.             # if rel_a join doesn't produce any results is null (for example
2626.             # reverse foreign key or null value in direct foreign key), and
2627.             # there is a matching row in rel_b with col=2, then an INNER join
2628.             # to rel_a would remove a valid match from the query. So, we need
2629.             # to promote any existing INNER to LOUTER (it is possible this
2630.             # promotion in turn will be demoted later on).
2631.             if self.effective_connector == "OR" and votes < self.num_children:
2632.                 to_promote.add(table)
2633.             # If connector is AND and there is a filter that can match only
2634.             # when there is a joinable row, then use INNER. For example, in
2635.             # rel_a__col=1 & rel_b__col=2, if either of the rels produce NULL
2636.             # as join output, then the col=1 or col=2 can't match (as
2637.             # NULL=anything is always false).
2638.             # For the OR case, if all children voted for a join to be inner,
2639.             # then we can use INNER for the join. For example:
2640.             #     (rel_a__col__icontains=Alex | rel_a__col__icontains=Russell)
2641.             # then if rel_a doesn't produce any rows, the whole condition
2642.             # can't match. Hence we can safely use INNER join.
2643.             if self.effective_connector == "AND" or (
2644.                 self.effective_connector == "OR" and votes == self.num_children
2645.             ):
2646.                 to_demote.add(table)
2647.             # Finally, what happens in cases where we have:
2648.             #    (rel_a__col=1|rel_b__col=2) & rel_a__col__gte=0
2649.             # Now, we first generate the OR clause, and promote joins for it
2650.             # in the first if branch above. Both rel_a and rel_b are promoted
2651.             # to LOUTER joins. After that we do the AND case. The OR case
2652.             # voted no inner joins but the rel_a__col__gte=0 votes inner join
2653.             # for rel_a. We demote it back to INNER join (in AND case a single
2654.             # vote is enough). The demotion is OK, if rel_a doesn't produce
2655.             # rows, then the rel_a__col__gte=0 clause can't be true, and thus
2656.             # the whole clause must be false. So, it is safe to use INNER
2657.             # join.
2658.             # Note that in this example we could just as well have the __gte
2659.             # clause and the OR clause swapped. Or we could replace the __gte
2660.             # clause with an OR clause containing rel_a__col=1|rel_a__col=2,
2661.             # and again we could safely demote to INNER.
2662.         query.promote_joins(to_promote)
2663.         query.demote_joins(to_demote)
2664.         return to_demote

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 23:01:16,670 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of `django/db/models/sql/query.py`. This context represents the first part of the file.', relative_path='django/db/models/sql/query.py', start_line=1, end_line=500), ContextOutput(reasoning='The user requested the full content of `django/db/models/sql/query.py`. This context represents the second and final part of the file.', relative_path='django/db/models/sql/query.py', start_line=501, end_line=2664)]
2025-12-24 23:01:16,675 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `django/db/models/sql/query.py`.
2025-12-24 23:01:16,675 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 23:01:16,675 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 23:01:16,676 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 1 existing contexts
2025-12-24 23:01:16,676 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 3 total contexts (removed 0 duplicates)
2025-12-24 23:01:16,678 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   ├── CODE_OF_CONDUCT.md
|   ├── FUNDING.yml
|   ├── SECURITY.md
|   └── workflows
|       ├── docs.yml
|       ├── linters.yml
|       ├── new_contributor_pr.yml
|       ├── schedule_tests.yml
|       ├── schedules.yml
|       └── tests.yml
├── .pre-commit-config.yaml
├── .readthedocs.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ig
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ky
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ms
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── ms
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tg
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── uz
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_redirect_new_path_help_text.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   |   ├── sitemap.xml
|   |   |   |   └── sitemap_index.xml
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ar_DZ
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── ky
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── tg
|   |   |   |   ├── th
|   |   |   |   ├── tk
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   ├── memcached.py
|   |   |   |   └── redis.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   ├── __init__.py
|   |   |   |   └── django_4_0.py
|   |   |   ├── database.py
|   |   |   ├── files.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── __init__.py
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── optimizemigration.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── jsonl.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _functions.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   └── special.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── json.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── autoreload.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── connection.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── common.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           ├── default_urlconf.html
|           ├── technical_404.html
|           ├── technical_500.html
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   ├── genindex.html
|   |   |   ├── layout.html
|   |   |   ├── modindex.html
|   |   |   ├── search.html
|   |   |   └── static
|   |   |       ├── console-tabs.css
|   |   |       ├── default.css
|   |   |       ├── djangodocs.css
|   |   |       ├── fontawesome
|   |   |       ├── homepage.css
|   |   |       └── reset-fonts-grids.css
|   |   └── djangodocs-epub
|   |       ├── epub-cover.html
|   |       └── static
|   |           └── epub.css
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── _images
|   |   ├── auth-remote-user.txt
|   |   ├── csrf.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-backend.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── hypercorn.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── logging.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── filters.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── expressions.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── logging.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.13.txt
|   |   ├── 2.2.14.txt
|   |   ├── 2.2.15.txt
|   |   ├── 2.2.16.txt
|   |   ├── 2.2.17.txt
|   |   ├── 2.2.18.txt
|   |   ├── 2.2.19.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.20.txt
|   |   ├── 2.2.21.txt
|   |   ├── 2.2.22.txt
|   |   ├── 2.2.23.txt
|   |   ├── 2.2.24.txt
|   |   ├── 2.2.25.txt
|   |   ├── 2.2.26.txt
|   |   ├── 2.2.27.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.10.txt
|   |   ├── 3.0.11.txt
|   |   ├── 3.0.12.txt
|   |   ├── 3.0.13.txt
|   |   ├── 3.0.14.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.7.txt
|   |   ├── 3.0.8.txt
|   |   ├── 3.0.9.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.1.txt
|   |   ├── 3.1.10.txt
|   |   ├── 3.1.11.txt
|   |   ├── 3.1.12.txt
|   |   ├── 3.1.13.txt
|   |   ├── 3.1.14.txt
|   |   ├── 3.1.2.txt
|   |   ├── 3.1.3.txt
|   |   ├── 3.1.4.txt
|   |   ├── 3.1.5.txt
|   |   ├── 3.1.6.txt
|   |   ├── 3.1.7.txt
|   |   ├── 3.1.8.txt
|   |   ├── 3.1.9.txt
|   |   ├── 3.1.txt
|   |   ├── 3.2.1.txt
|   |   ├── 3.2.10.txt
|   |   ├── 3.2.11.txt
|   |   ├── 3.2.12.txt
|   |   ├── 3.2.2.txt
|   |   ├── 3.2.3.txt
|   |   ├── 3.2.4.txt
|   |   ├── 3.2.5.txt
|   |   ├── 3.2.6.txt
|   |   ├── 3.2.7.txt
|   |   ├── 3.2.8.txt
|   |   ├── 3.2.9.txt
|   |   ├── 3.2.txt
|   |   ├── 4.0.1.txt
|   |   ├── 4.0.2.txt
|   |   ├── 4.0.3.txt
|   |   ├── 4.0.4.txt
|   |   ├── 4.0.txt
|   |   ├── 4.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   ├── requirements.txt
|   └── topics
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   ├── jsi18n-mocks.test.js
|   |   └── navigation.test.js
|   ├── gis
|   |   └── mapwidget.test.js
|   └── tests.html
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── .hidden
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       ├── noargs_command.py
    |   |       └── suppress_base_options_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   ├── __init__.py
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── admin
    |   |   |   ├── admin_views
    |   |   |   └── base_site.html
    |   |   └── custom_filter_template.html
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_nav_sidebar.py
    |   ├── test_prevent_double_submission.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   ├── no_config_app
    |   |   └── __init__.py
    |   ├── one_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── tests.py
    |   ├── two_configs_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── two_configs_one_default_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   └── two_default_configs_app
    |       ├── __init__.py
    |       └── apps.py
    ├── asgi
    |   ├── __init__.py
    |   ├── project
    |   |   └── static
    |   |       └── file.txt
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   |   ├── auth_attrs_access.html
    |   |   |   ├── auth_attrs_messages.html
    |   |   |   ├── auth_attrs_no_access.html
    |   |   |   ├── auth_attrs_perm_in_perms.html
    |   |   |   ├── auth_attrs_perms.html
    |   |   |   ├── auth_attrs_test_access.html
    |   |   |   └── auth_attrs_user.html
    |   |   └── registration
    |   |       ├── html_password_reset_email.html
    |   |       ├── logged_out.html
    |   |       ├── login.html
    |   |       ├── password_change_form.html
    |   |       ├── password_reset_complete.html
    |   |       ├── password_reset_confirm.html
    |   |       ├── password_reset_done.html
    |   |       ├── password_reset_email.html
    |   |       ├── password_reset_form.html
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── app_unmigrated
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── test_base.py
    |   |   ├── test_client.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_functions.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   ├── __init__.py
    |   |   └── commands
    |   |       ├── __init__.py
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   ├── tests.py
    |   └── tests_async.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models.py
    |   ├── template_test_apps
    |   |   ├── __init__.py
    |   |   ├── different_tags_app
    |   |   |   ├── __init__.py
    |   |   |   ├── apps.py
    |   |   |   └── templatetags
    |   |   ├── same_tags_app_1
    |   |   |   ├── __init__.py
    |   |   |   ├── apps.py
    |   |   |   └── templatetags
    |   |   └── same_tags_app_2
    |   |       ├── __init__.py
    |   |       ├── apps.py
    |   |       └── templatetags
    |   ├── test_4_0_compatibility.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_files.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_class_based_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── bad_function_based_error_handlers.py
    |       ├── beginning_with_slash.py
    |       ├── cbv_as_view.py
    |       ├── contains_tuple.py
    |       ├── good_class_based_error_handlers.py
    |       ├── good_function_based_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_migrations.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   |       ├── debug.html
    |   |       └── request_attrs.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_collate.py
    |   |   ├── test_greatest.py
    |   |   ├── test_json_object.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_random.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── fake_client.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_csrf_cookie_masked.py
    |   ├── test_middleware_mixin.py
    |   ├── test_use_l10n.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── fixture2.xml
    |   |   ├── fixture3.xml
    |   |   ├── fixture7.xml
    |   |   └── fixture9.xml
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   |   ├── animal.xml
    |   |   ├── bad_fixture2.xml
    |   |   ├── nk-inheritance2.xml
    |   |   ├── non_natural_2.xml
    |   |   ├── pretty.xml
    |   |   └── sequence_extra_xml.xml
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   |   └── default.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_jsonfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   |       └── custom_widget.html
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   |       ├── article_form.html
    |   |       ├── custom_widget.html
    |   |       ├── cyclic_context_boundfield_render.html
    |   |       ├── error.html
    |   |       ├── form_snippet.html
    |   |       └── legend_test.html
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── tags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_deprecation_forms.py
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   |       └── using.html
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   ├── about.html
    |   |   |   ├── apple_detail.html
    |   |   |   ├── artist_detail.html
    |   |   |   ├── artist_form.html
    |   |   |   ├── author_confirm_delete.html
    |   |   |   ├── author_detail.html
    |   |   |   ├── author_form.html
    |   |   |   ├── author_list.html
    |   |   |   ├── author_objects.html
    |   |   |   ├── author_view.html
    |   |   |   ├── book_archive.html
    |   |   |   ├── book_archive_day.html
    |   |   |   ├── book_archive_month.html
    |   |   |   ├── book_archive_week.html
    |   |   |   ├── book_archive_year.html
    |   |   |   ├── book_detail.html
    |   |   |   ├── book_list.html
    |   |   |   ├── confirm_delete.html
    |   |   |   ├── detail.html
    |   |   |   ├── form.html
    |   |   |   ├── list.html
    |   |   |   ├── page_template.html
    |   |   |   ├── robots.txt
    |   |   |   └── using.html
    |   |   └── registration
    |   |       └── login.html
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoadmin_deprecated
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   |   └── test_handler.html
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   |   └── ignored.html
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   |   └── media_ignored.html
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   ├── javascript_ignored.js
    |   |   |   └── static_ignored.html
    |   |   └── templates
    |   |       ├── empty.html
    |   |       ├── subdir
    |   |       ├── test.html
    |   |       └── xxx_ignored.html
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── loading
    |   |   ├── en
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_AU
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_CA
    |   |   |   └── LC_MESSAGES
    |   |   └── en_NZ
    |   |       └── LC_MESSAGES
    |   ├── loading_app
    |   |   ├── __init__.py
    |   |   ├── apps.py
    |   |   └── locale
    |   |       └── en
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   |   ├── 404.html
    |   |   |   └── dummy.html
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── models.py
    |   |   |   └── test.html
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   |   └── percents.html
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── unchanged
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_conflict_long_name
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second_migration_with_long_name.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_manual_porting
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_no_replaces
    |   |   ├── 0001_squashed_0002.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_jsonfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_pk.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── model_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_contains.py
    |   ├── test_db_returning.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   ├── test_sqlcompiler.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_jsonl.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_clear_expired.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   |       └── using.html
    |   ├── templates
    |   |   └── shortcuts
    |   |       ├── render_test.html
    |   |       └── using.html
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   |   ├── custom_sitemap.xml
    |   |   ├── custom_sitemap_index.xml
    |   |   └── custom_sitemap_lastmod_index.xml
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       ├── index_only.py
    |       └── sitemap_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── absolute_root.css
    |   |   |   ├── cached
    |   |   |   ├── nested
    |   |   |   ├── styles_root.css
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   |   └── faulty.css
    |   |   ├── loop
    |   |   |   ├── bar.css
    |   |   |   └── foo.css
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   |       ├── description.html
    |   |       ├── description_context.html
    |   |       ├── title.html
    |   |       └── title_context.html
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   |       └── hello.html
    |   ├── jinja2
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       ├── syntax_error.html
    |   |       ├── syntax_error2.html
    |   |       └── syntax_error_include.html
    |   ├── template_strings
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_backends
    |   |       ├── csrf.html
    |   |       ├── django_escaping.html
    |   |       ├── hello.html
    |   |       └── syntax_error.html
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   |       └── hello.html
    |   ├── templates
    |   |   └── template_loader
    |   |       ├── goodbye.html
    |   |       ├── hello.html
    |   |       └── request.html
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   |       └── using.html
    |   ├── other_templates
    |   |   ├── priority
    |   |   |   └── foo.html
    |   |   └── test_dirs.html
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   |   ├── extend-missing.html
    |   |   |   ├── one.html
    |   |   |   ├── other-recursive.html
    |   |   |   ├── recursive.html
    |   |   |   ├── self.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── fs2
    |   |   |   └── recursive.html
    |   |   └── fs3
    |   |       └── recursive.html
    |   ├── relative_templates
    |   |   ├── dir1
    |   |   |   ├── dir2
    |   |   |   ├── looped.html
    |   |   |   ├── one.html
    |   |   |   ├── one1.html
    |   |   |   ├── one2.html
    |   |   |   ├── one3.html
    |   |   |   ├── three.html
    |   |   |   └── two.html
    |   |   ├── error_extends.html
    |   |   ├── error_include.html
    |   |   ├── one.html
    |   |   ├── one_var.html
    |   |   ├── three.html
    |   |   └── two.html
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_debug.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Using multiple FilteredRelation with different filters but for same relation is ignored.

Description: Description
	 
		(last modified by lind-marcus)
	 
I have a relation that ALWAYS have at least 1 entry with is_all=True and then I have an optional entry that could have is_all=False but instead have zone set.
I'm trying to use FilteredRelation together with Case(When()) to ensure that it use the zone level one (if exist) and fall back on "All" if zone do not exist.
from django.db.models import FilteredRelation
qs.alias(
	relation_zone=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__zone=F("zone"))
	),
	relation_all=FilteredRelation(
		"myrelation__nested",
		condition=Q(myrelation__nested__is_all=True)
	),
	price_zone=F("relation_zone__price")
).annotate(
	price_final=Case(
		When(
			price_zone__isnull=True,
			then=F("relation_all__price"),
		),
		default=F("price_zone")
	)
)
I noticed that when using multiple FilteredRelation with the same relation (myrelation__nested) it actually just generates a single SQL JOIN (if inspecting the raw SQL) and ignores the other. So in this case if I do print(str(qs.query)) I would only see a join for relation_zone. Not for relation_all.
Is this intended behavior or should I be able to do the thing above?

Patch information:
diff --git a/django/db/models/sql/datastructures.py b/django/db/models/sql/datastructures.py
index 1edf040e82..3cdf602ef7 100644
--- a/django/db/models/sql/datastructures.py
+++ b/django/db/models/sql/datastructures.py
@@ -162,8 +162,9 @@ class Join:
         return hash(self.identity)
 
     def equals(self, other):
-        # Ignore filtered_relation in equality check.
-        return self.identity[:-1] == other.identity[:-1]
+        # Consider filtered_relation in equality check to avoid reusing joins
+        # with different FilteredRelation conditions.
+        return self.identity == other.identity
 
     def demote(self):
         new = self.relabeled_clone({})


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `django/db/models/sql/datastructures.py`.
Extra Requirements: 
Purpose: This file contains the `Join` class, which is modified in the user's patch. Understanding its implementation is crucial to diagnosing the issue with `FilteredRelation`.

Previous refined query 2:
Essential Query: Please provide the full content of `django/db/models/sql/query.py`.
Extra Requirements: 
Purpose: This file contains the core logic for creating and reusing joins, which is central to the user's reported issue with `FilteredRelation`.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: django/db/models/sql/datastructures.py
Line number range: 1 - 220
Content:
1. """
2. Useful auxiliary data structures for query construction. Not useful outside
3. the SQL domain.
4. """
5. from django.db.models.sql.constants import INNER, LOUTER
6. 
7. 
8. class MultiJoin(Exception):
9.     """
10.     Used by join construction code to indicate the point at which a
11.     multi-valued join was attempted (if the caller wants to treat that
12.     exceptionally).
13.     """
14. 
15.     def __init__(self, names_pos, path_with_names):
16.         self.level = names_pos
17.         # The path travelled, this includes the path to the multijoin.
18.         self.names_with_path = path_with_names
19. 
20. 
21. class Empty:
22.     pass
23. 
24. 
25. class Join:
26.     """
27.     Used by sql.Query and sql.SQLCompiler to generate JOIN clauses into the
28.     FROM entry. For example, the SQL generated could be
29.         LEFT OUTER JOIN "sometable" T1
30.         ON ("othertable"."sometable_id" = "sometable"."id")
31. 
32.     This class is primarily used in Query.alias_map. All entries in alias_map
33.     must be Join compatible by providing the following attributes and methods:
34.         - table_name (string)
35.         - table_alias (possible alias for the table, can be None)
36.         - join_type (can be None for those entries that aren't joined from
37.           anything)
38.         - parent_alias (which table is this join's parent, can be None similarly
39.           to join_type)
40.         - as_sql()
41.         - relabeled_clone()
42.     """
43. 
44.     def __init__(
45.         self,
46.         table_name,
47.         parent_alias,
48.         table_alias,
49.         join_type,
50.         join_field,
51.         nullable,
52.         filtered_relation=None,
53.     ):
54.         # Join table
55.         self.table_name = table_name
56.         self.parent_alias = parent_alias
57.         # Note: table_alias is not necessarily known at instantiation time.
58.         self.table_alias = table_alias
59.         # LOUTER or INNER
60.         self.join_type = join_type
61.         # A list of 2-tuples to use in the ON clause of the JOIN.
62.         # Each 2-tuple will create one join condition in the ON clause.
63.         self.join_cols = join_field.get_joining_columns()
64.         # Along which field (or ForeignObjectRel in the reverse join case)
65.         self.join_field = join_field
66.         # Is this join nullabled?
67.         self.nullable = nullable
68.         self.filtered_relation = filtered_relation
69. 
70.     def as_sql(self, compiler, connection):
71.         """
72.         Generate the full
73.            LEFT OUTER JOIN sometable ON sometable.somecol = othertable.othercol, params
74.         clause for this join.
75.         """
76.         join_conditions = []
77.         params = []
78.         qn = compiler.quote_name_unless_alias
79.         qn2 = connection.ops.quote_name
80. 
81.         # Add a join condition for each pair of joining columns.
82.         for lhs_col, rhs_col in self.join_cols:
83.             join_conditions.append(
84.                 "%s.%s = %s.%s"
85.                 % (
86.                     qn(self.parent_alias),
87.                     qn2(lhs_col),
88.                     qn(self.table_alias),
89.                     qn2(rhs_col),
90.                 )
91.             )
92. 
93.         # Add a single condition inside parentheses for whatever
94.         # get_extra_restriction() returns.
95.         extra_cond = self.join_field.get_extra_restriction(
96.             self.table_alias, self.parent_alias
97.         )
98.         if extra_cond:
99.             extra_sql, extra_params = compiler.compile(extra_cond)
100.             join_conditions.append("(%s)" % extra_sql)
101.             params.extend(extra_params)
102.         if self.filtered_relation:
103.             extra_sql, extra_params = compiler.compile(self.filtered_relation)
104.             if extra_sql:
105.                 join_conditions.append("(%s)" % extra_sql)
106.                 params.extend(extra_params)
107.         if not join_conditions:
108.             # This might be a rel on the other end of an actual declared field.
109.             declared_field = getattr(self.join_field, "field", self.join_field)
110.             raise ValueError(
111.                 "Join generated an empty ON clause. %s did not yield either "
112.                 "joining columns or extra restrictions." % declared_field.__class__
113.             )
114.         on_clause_sql = " AND ".join(join_conditions)
115.         alias_str = (
116.             "" if self.table_alias == self.table_name else (" %s" % self.table_alias)
117.         )
118.         sql = "%s %s%s ON (%s)" % (
119.             self.join_type,
120.             qn(self.table_name),
121.             alias_str,
122.             on_clause_sql,
123.         )
124.         return sql, params
125. 
126.     def relabeled_clone(self, change_map):
127.         new_parent_alias = change_map.get(self.parent_alias, self.parent_alias)
128.         new_table_alias = change_map.get(self.table_alias, self.table_alias)
129.         if self.filtered_relation is not None:
130.             filtered_relation = self.filtered_relation.clone()
131.             filtered_relation.path = [
132.                 change_map.get(p, p) for p in self.filtered_relation.path
133.             ]
134.         else:
135.             filtered_relation = None
136.         return self.__class__(
137.             self.table_name,
138.             new_parent_alias,
139.             new_table_alias,
140.             self.join_type,
141.             self.join_field,
142.             self.nullable,
143.             filtered_relation=filtered_relation,
144.         )
145. 
146.     @property
147.     def identity(self):
148.         return (
149.             self.__class__,
150.             self.table_name,
151.             self.parent_alias,
152.             self.join_field,
153.             self.filtered_relation,
154.         )
155. 
156.     def __eq__(self, other):
157.         if not isinstance(other, Join):
158.             return NotImplemented
159.         return self.identity == other.identity
160. 
161.     def __hash__(self):
162.         return hash(self.identity)
163. 
164.     def equals(self, other):
165.         # Ignore filtered_relation in equality check.
166.         return self.identity[:-1] == other.identity[:-1]
167. 
168.     def demote(self):
169.         new = self.relabeled_clone({})
170.         new.join_type = INNER
171.         return new
172. 
173.     def promote(self):
174.         new = self.relabeled_clone({})
175.         new.join_type = LOUTER
176.         return new
177. 
178. 
179. class BaseTable:
180.     """
181.     The BaseTable class is used for base table references in FROM clause. For
182.     example, the SQL "foo" in
183.         SELECT * FROM "foo" WHERE somecond
184.     could be generated by this class.
185.     """
186. 
187.     join_type = None
188.     parent_alias = None
189.     filtered_relation = None
190. 
191.     def __init__(self, table_name, alias):
192.         self.table_name = table_name
193.         self.table_alias = alias
194. 
195.     def as_sql(self, compiler, connection):
196.         alias_str = (
197.             "" if self.table_alias == self.table_name else (" %s" % self.table_alias)
198.         )
199.         base_sql = compiler.quote_name_unless_alias(self.table_name)
200.         return base_sql + alias_str, []
201. 
202.     def relabeled_clone(self, change_map):
203.         return self.__class__(
204.             self.table_name, change_map.get(self.table_alias, self.table_alias)
205.         )
206. 
207.     @property
208.     def identity(self):
209.         return self.__class__, self.table_name, self.table_alias
210. 
211.     def __eq__(self, other):
212.         if not isinstance(other, BaseTable):
213.             return NotImplemented
214.         return self.identity == other.identity
215. 
216.     def __hash__(self):
217.         return hash(self.identity)
218. 
219.     def equals(self, other):
220.         return self.identity == other.identity


File: django/db/models/sql/query.py
Line number range: 1 - 500
Content:
1. """
2. Create SQL statements for QuerySets.
3. 
4. The code in here encapsulates all of the SQL construction so that QuerySets
5. themselves do not have to (and could be backed by things other than SQL
6. databases). The abstraction barrier only works one way: this module has to know
7. all about the internals of models in order to get the information it needs.
8. """
9. import copy
10. import difflib
11. import functools
12. import sys
13. from collections import Counter, namedtuple
14. from collections.abc import Iterator, Mapping
15. from itertools import chain, count, product
16. from string import ascii_uppercase
17. 
18. from django.core.exceptions import FieldDoesNotExist, FieldError
19. from django.db import DEFAULT_DB_ALIAS, NotSupportedError, connections
20. from django.db.models.aggregates import Count
21. from django.db.models.constants import LOOKUP_SEP
22. from django.db.models.expressions import (
23.     BaseExpression,
24.     Col,
25.     Exists,
26.     F,
27.     OuterRef,
28.     Ref,
29.     ResolvedOuterRef,
30. )
31. from django.db.models.fields import Field
32. from django.db.models.fields.related_lookups import MultiColSource
33. from django.db.models.lookups import Lookup
34. from django.db.models.query_utils import (
35.     Q,
36.     check_rel_lookup_compatibility,
37.     refs_expression,
38. )
39. from django.db.models.sql.constants import INNER, LOUTER, ORDER_DIR, SINGLE
40. from django.db.models.sql.datastructures import BaseTable, Empty, Join, MultiJoin
41. from django.db.models.sql.where import AND, OR, ExtraWhere, NothingNode, WhereNode
42. from django.utils.functional import cached_property
43. from django.utils.tree import Node
44. 
45. __all__ = ["Query", "RawQuery"]
46. 
47. 
48. def get_field_names_from_opts(opts):
49.     if opts is None:
50.         return set()
51.     return set(
52.         chain.from_iterable(
53.             (f.name, f.attname) if f.concrete else (f.name,) for f in opts.get_fields()
54.         )
55.     )
56. 
57. 
58. def get_children_from_q(q):
59.     for child in q.children:
60.         if isinstance(child, Node):
61.             yield from get_children_from_q(child)
62.         else:
63.             yield child
64. 
65. 
66. JoinInfo = namedtuple(
67.     "JoinInfo",
68.     ("final_field", "targets", "opts", "joins", "path", "transform_function"),
69. )
70. 
71. 
72. class RawQuery:
73.     """A single raw SQL query."""
74. 
75.     def __init__(self, sql, using, params=()):
76.         self.params = params
77.         self.sql = sql
78.         self.using = using
79.         self.cursor = None
80. 
81.         # Mirror some properties of a normal query so that
82.         # the compiler can be used to process results.
83.         self.low_mark, self.high_mark = 0, None  # Used for offset/limit
84.         self.extra_select = {}
85.         self.annotation_select = {}
86. 
87.     def chain(self, using):
88.         return self.clone(using)
89. 
90.     def clone(self, using):
91.         return RawQuery(self.sql, using, params=self.params)
92. 
93.     def get_columns(self):
94.         if self.cursor is None:
95.             self._execute_query()
96.         converter = connections[self.using].introspection.identifier_converter
97.         return [converter(column_meta[0]) for column_meta in self.cursor.description]
98. 
99.     def __iter__(self):
100.         # Always execute a new query for a new iterator.
101.         # This could be optimized with a cache at the expense of RAM.
102.         self._execute_query()
103.         if not connections[self.using].features.can_use_chunked_reads:
104.             # If the database can't use chunked reads we need to make sure we
105.             # evaluate the entire query up front.
106.             result = list(self.cursor)
107.         else:
108.             result = self.cursor
109.         return iter(result)
110. 
111.     def __repr__(self):
112.         return "<%s: %s>" % (self.__class__.__name__, self)
113. 
114.     @property
115.     def params_type(self):
116.         if self.params is None:
117.             return None
118.         return dict if isinstance(self.params, Mapping) else tuple
119. 
120.     def __str__(self):
121.         if self.params_type is None:
122.             return self.sql
123.         return self.sql % self.params_type(self.params)
124. 
125.     def _execute_query(self):
126.         connection = connections[self.using]
127. 
128.         # Adapt parameters to the database, as much as possible considering
129.         # that the target type isn't known. See #17755.
130.         params_type = self.params_type
131.         adapter = connection.ops.adapt_unknown_value
132.         if params_type is tuple:
133.             params = tuple(adapter(val) for val in self.params)
134.         elif params_type is dict:
135.             params = {key: adapter(val) for key, val in self.params.items()}
136.         elif params_type is None:
137.             params = None
138.         else:
139.             raise RuntimeError("Unexpected params type: %s" % params_type)
140. 
141.         self.cursor = connection.cursor()
142.         self.cursor.execute(self.sql, params)
143. 
144. 
145. ExplainInfo = namedtuple("ExplainInfo", ("format", "options"))
146. 
147. 
148. class Query(BaseExpression):
149.     """A single SQL query."""
150. 
151.     alias_prefix = "T"
152.     empty_result_set_value = None
153.     subq_aliases = frozenset([alias_prefix])
154. 
155.     compiler = "SQLCompiler"
156. 
157.     base_table_class = BaseTable
158.     join_class = Join
159. 
160.     default_cols = True
161.     default_ordering = True
162.     standard_ordering = True
163. 
164.     filter_is_sticky = False
165.     subquery = False
166. 
167.     # SQL-related attributes.
168.     # Select and related select clauses are expressions to use in the SELECT
169.     # clause of the query. The select is used for cases where we want to set up
170.     # the select clause to contain other than default fields (values(),
171.     # subqueries...). Note that annotations go to annotations dictionary.
172.     select = ()
173.     # The group_by attribute can have one of the following forms:
174.     #  - None: no group by at all in the query
175.     #  - A tuple of expressions: group by (at least) those expressions.
176.     #    String refs are also allowed for now.
177.     #  - True: group by all select fields of the model
178.     # See compiler.get_group_by() for details.
179.     group_by = None
180.     order_by = ()
181.     low_mark = 0  # Used for offset/limit.
182.     high_mark = None  # Used for offset/limit.
183.     distinct = False
184.     distinct_fields = ()
185.     select_for_update = False
186.     select_for_update_nowait = False
187.     select_for_update_skip_locked = False
188.     select_for_update_of = ()
189.     select_for_no_key_update = False
190.     select_related = False
191.     # Arbitrary limit for select_related to prevents infinite recursion.
192.     max_depth = 5
193.     # Holds the selects defined by a call to values() or values_list()
194.     # excluding annotation_select and extra_select.
195.     values_select = ()
196. 
197.     # SQL annotation-related attributes.
198.     annotation_select_mask = None
199.     _annotation_select_cache = None
200. 
201.     # Set combination attributes.
202.     combinator = None
203.     combinator_all = False
204.     combined_queries = ()
205. 
206.     # These are for extensions. The contents are more or less appended verbatim
207.     # to the appropriate clause.
208.     extra_select_mask = None
209.     _extra_select_cache = None
210. 
211.     extra_tables = ()
212.     extra_order_by = ()
213. 
214.     # A tuple that is a set of model field names and either True, if these are
215.     # the fields to defer, or False if these are the only fields to load.
216.     deferred_loading = (frozenset(), True)
217. 
218.     explain_info = None
219. 
220.     def __init__(self, model, alias_cols=True):
221.         self.model = model
222.         self.alias_refcount = {}
223.         # alias_map is the most important data structure regarding joins.
224.         # It's used for recording which joins exist in the query and what
225.         # types they are. The key is the alias of the joined table (possibly
226.         # the table name) and the value is a Join-like object (see
227.         # sql.datastructures.Join for more information).
228.         self.alias_map = {}
229.         # Whether to provide alias to columns during reference resolving.
230.         self.alias_cols = alias_cols
231.         # Sometimes the query contains references to aliases in outer queries (as
232.         # a result of split_exclude). Correct alias quoting needs to know these
233.         # aliases too.
234.         # Map external tables to whether they are aliased.
235.         self.external_aliases = {}
236.         self.table_map = {}  # Maps table names to list of aliases.
237.         self.used_aliases = set()
238. 
239.         self.where = WhereNode()
240.         # Maps alias -> Annotation Expression.
241.         self.annotations = {}
242.         # These are for extensions. The contents are more or less appended
243.         # verbatim to the appropriate clause.
244.         self.extra = {}  # Maps col_alias -> (col_sql, params).
245. 
246.         self._filtered_relations = {}
247. 
248.     @property
249.     def output_field(self):
250.         if len(self.select) == 1:
251.             select = self.select[0]
252.             return getattr(select, "target", None) or select.field
253.         elif len(self.annotation_select) == 1:
254.             return next(iter(self.annotation_select.values())).output_field
255. 
256.     @property
257.     def has_select_fields(self):
258.         return bool(
259.             self.select or self.annotation_select_mask or self.extra_select_mask
260.         )
261. 
262.     @cached_property
263.     def base_table(self):
264.         for alias in self.alias_map:
265.             return alias
266. 
267.     def __str__(self):
268.         """
269.         Return the query as a string of SQL with the parameter values
270.         substituted in (use sql_with_params() to see the unsubstituted string).
271. 
272.         Parameter values won't necessarily be quoted correctly, since that is
273.         done by the database interface at execution time.
274.         """
275.         sql, params = self.sql_with_params()
276.         return sql % params
277. 
278.     def sql_with_params(self):
279.         """
280.         Return the query as an SQL string and the parameters that will be
281.         substituted into the query.
282.         """
283.         return self.get_compiler(DEFAULT_DB_ALIAS).as_sql()
284. 
285.     def __deepcopy__(self, memo):
286.         """Limit the amount of work when a Query is deepcopied."""
287.         result = self.clone()
288.         memo[id(self)] = result
289.         return result
290. 
291.     def get_compiler(self, using=None, connection=None, elide_empty=True):
292.         if using is None and connection is None:
293.             raise ValueError("Need either using or connection")
294.         if using:
295.             connection = connections[using]
296.         return connection.ops.compiler(self.compiler)(
297.             self, connection, using, elide_empty
298.         )
299. 
300.     def get_meta(self):
301.         """
302.         Return the Options instance (the model._meta) from which to start
303.         processing. Normally, this is self.model._meta, but it can be changed
304.         by subclasses.
305.         """
306.         if self.model:
307.             return self.model._meta
308. 
309.     def clone(self):
310.         """
311.         Return a copy of the current Query. A lightweight alternative to
312.         to deepcopy().
313.         """
314.         obj = Empty()
315.         obj.__class__ = self.__class__
316.         # Copy references to everything.
317.         obj.__dict__ = self.__dict__.copy()
318.         # Clone attributes that can't use shallow copy.
319.         obj.alias_refcount = self.alias_refcount.copy()
320.         obj.alias_map = self.alias_map.copy()
321.         obj.external_aliases = self.external_aliases.copy()
322.         obj.table_map = self.table_map.copy()
323.         obj.where = self.where.clone()
324.         obj.annotations = self.annotations.copy()
325.         if self.annotation_select_mask is not None:
326.             obj.annotation_select_mask = self.annotation_select_mask.copy()
327.         if self.combined_queries:
328.             obj.combined_queries = tuple(
329.                 [query.clone() for query in self.combined_queries]
330.             )
331.         # _annotation_select_cache cannot be copied, as doing so breaks the
332.         # (necessary) state in which both annotations and
333.         # _annotation_select_cache point to the same underlying objects.
334.         # It will get re-populated in the cloned queryset the next time it's
335.         # used.
336.         obj._annotation_select_cache = None
337.         obj.extra = self.extra.copy()
338.         if self.extra_select_mask is not None:
339.             obj.extra_select_mask = self.extra_select_mask.copy()
340.         if self._extra_select_cache is not None:
341.             obj._extra_select_cache = self._extra_select_cache.copy()
342.         if self.select_related is not False:
343.             # Use deepcopy because select_related stores fields in nested
344.             # dicts.
345.             obj.select_related = copy.deepcopy(obj.select_related)
346.         if "subq_aliases" in self.__dict__:
347.             obj.subq_aliases = self.subq_aliases.copy()
348.         obj.used_aliases = self.used_aliases.copy()
349.         obj._filtered_relations = self._filtered_relations.copy()
350.         # Clear the cached_property, if it exists.
351.         obj.__dict__.pop("base_table", None)
352.         return obj
353. 
354.     def chain(self, klass=None):
355.         """
356.         Return a copy of the current Query that's ready for another operation.
357.         The klass argument changes the type of the Query, e.g. UpdateQuery.
358.         """
359.         obj = self.clone()
360.         if klass and obj.__class__ != klass:
361.             obj.__class__ = klass
362.         if not obj.filter_is_sticky:
363.             obj.used_aliases = set()
364.         obj.filter_is_sticky = False
365.         if hasattr(obj, "_setup_query"):
366.             obj._setup_query()
367.         return obj
368. 
369.     def relabeled_clone(self, change_map):
370.         clone = self.clone()
371.         clone.change_aliases(change_map)
372.         return clone
373. 
374.     def _get_col(self, target, field, alias):
375.         if not self.alias_cols:
376.             alias = None
377.         return target.get_col(alias, field)
378. 
379.     def rewrite_cols(self, annotation, col_cnt):
380.         # We must make sure the inner query has the referred columns in it.
381.         # If we are aggregating over an annotation, then Django uses Ref()
382.         # instances to note this. However, if we are annotating over a column
383.         # of a related model, then it might be that column isn't part of the
384.         # SELECT clause of the inner query, and we must manually make sure
385.         # the column is selected. An example case is:
386.         #    .aggregate(Sum('author__awards'))
387.         # Resolving this expression results in a join to author, but there
388.         # is no guarantee the awards column of author is in the select clause
389.         # of the query. Thus we must manually add the column to the inner
390.         # query.
391.         orig_exprs = annotation.get_source_expressions()
392.         new_exprs = []
393.         for expr in orig_exprs:
394.             # FIXME: These conditions are fairly arbitrary. Identify a better
395.             # method of having expressions decide which code path they should
396.             # take.
397.             if isinstance(expr, Ref):
398.                 # Its already a Ref to subquery (see resolve_ref() for
399.                 # details)
400.                 new_exprs.append(expr)
401.             elif isinstance(expr, (WhereNode, Lookup)):
402.                 # Decompose the subexpressions further. The code here is
403.                 # copied from the else clause, but this condition must appear
404.                 # before the contains_aggregate/is_summary condition below.
405.                 new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
406.                 new_exprs.append(new_expr)
407.             else:
408.                 # Reuse aliases of expressions already selected in subquery.
409.                 for col_alias, selected_annotation in self.annotation_select.items():
410.                     if selected_annotation is expr:
411.                         new_expr = Ref(col_alias, expr)
412.                         break
413.                 else:
414.                     # An expression that is not selected the subquery.
415.                     if isinstance(expr, Col) or (
416.                         expr.contains_aggregate and not expr.is_summary
417.                     ):
418.                         # Reference column or another aggregate. Select it
419.                         # under a non-conflicting alias.
420.                         col_cnt += 1
421.                         col_alias = "__col%d" % col_cnt
422.                         self.annotations[col_alias] = expr
423.                         self.append_annotation_mask([col_alias])
424.                         new_expr = Ref(col_alias, expr)
425.                     else:
426.                         # Some other expression not referencing database values
427.                         # directly. Its subexpression might contain Cols.
428.                         new_expr, col_cnt = self.rewrite_cols(expr, col_cnt)
429.                 new_exprs.append(new_expr)
430.         annotation.set_source_expressions(new_exprs)
431.         return annotation, col_cnt
432. 
433.     def get_aggregation(self, using, added_aggregate_names):
434.         """
435.         Return the dictionary with the values of the existing aggregations.
436.         """
437.         if not self.annotation_select:
438.             return {}
439.         existing_annotations = [
440.             annotation
441.             for alias, annotation in self.annotations.items()
442.             if alias not in added_aggregate_names
443.         ]
444.         # Decide if we need to use a subquery.
445.         #
446.         # Existing annotations would cause incorrect results as get_aggregation()
447.         # must produce just one result and thus must not use GROUP BY. But we
448.         # aren't smart enough to remove the existing annotations from the
449.         # query, so those would force us to use GROUP BY.
450.         #
451.         # If the query has limit or distinct, or uses set operations, then
452.         # those operations must be done in a subquery so that the query
453.         # aggregates on the limit and/or distinct results instead of applying
454.         # the distinct and limit after the aggregation.
455.         if (
456.             isinstance(self.group_by, tuple)
457.             or self.is_sliced
458.             or existing_annotations
459.             or self.distinct
460.             or self.combinator
461.         ):
462.             from django.db.models.sql.subqueries import AggregateQuery
463. 
464.             inner_query = self.clone()
465.             inner_query.subquery = True
466.             outer_query = AggregateQuery(self.model, inner_query)
467.             inner_query.select_for_update = False
468.             inner_query.select_related = False
469.             inner_query.set_annotation_mask(self.annotation_select)
470.             # Queries with distinct_fields need ordering and when a limit is
471.             # applied we must take the slice from the ordered query. Otherwise
472.             # no need for ordering.
473.             inner_query.clear_ordering(force=False)
474.             if not inner_query.distinct:
475.                 # If the inner query uses default select and it has some
476.                 # aggregate annotations, then we must make sure the inner
477.                 # query is grouped by the main model's primary key. However,
478.                 # clearing the select clause can alter results if distinct is
479.                 # used.
480.                 has_existing_aggregate_annotations = any(
481.                     annotation
482.                     for annotation in existing_annotations
483.                     if getattr(annotation, "contains_aggregate", True)
484.                 )
485.                 if inner_query.default_cols and has_existing_aggregate_annotations:
486.                     inner_query.group_by = (
487.                         self.model._meta.pk.get_col(inner_query.get_initial_alias()),
488.                     )
489.                 inner_query.default_cols = False
490. 
491.             relabels = {t: "subquery" for t in inner_query.alias_map}
492.             relabels[None] = "subquery"
493.             # Remove any aggregates marked for reduction from the subquery
494.             # and move them to the outer AggregateQuery.
495.             col_cnt = 0
496.             for alias, expression in list(inner_query.annotation_select.items()):
497.                 annotation_select_mask = inner_query.annotation_select_mask
498.                 if expression.is_summary:
499.                     expression, col_cnt = inner_query.rewrite_cols(expression, col_cnt)
500.                     outer_query.annotations[alias] = expression.relabeled_clone(


File: django/db/models/sql/query.py
Line number range: 501 - 2664
Content:
501.                         relabels
502.                     )
503.                     del inner_query.annotations[alias]
504.                     annotation_select_mask.remove(alias)
505.                 # Make sure the annotation_select wont use cached results.
506.                 inner_query.set_annotation_mask(inner_query.annotation_select_mask)
507.             if (
508.                 inner_query.select == ()
509.                 and not inner_query.default_cols
510.                 and not inner_query.annotation_select_mask
511.             ):
512.                 # In case of Model.objects[0:3].count(), there would be no
513.                 # field selected in the inner query, yet we must use a subquery.
514.                 # So, make sure at least one field is selected.
515.                 inner_query.select = (
516.                     self.model._meta.pk.get_col(inner_query.get_initial_alias()),
517.                 )
518.         else:
519.             outer_query = self
520.             self.select = ()
521.             self.default_cols = False
522.             self.extra = {}
523. 
524.         empty_set_result = [
525.             expression.empty_result_set_value
526.             for expression in outer_query.annotation_select.values()
527.         ]
528.         elide_empty = not any(result is NotImplemented for result in empty_set_result)
529.         outer_query.clear_ordering(force=True)
530.         outer_query.clear_limits()
531.         outer_query.select_for_update = False
532.         outer_query.select_related = False
533.         compiler = outer_query.get_compiler(using, elide_empty=elide_empty)
534.         result = compiler.execute_sql(SINGLE)
535.         if result is None:
536.             result = empty_set_result
537. 
538.         converters = compiler.get_converters(outer_query.annotation_select.values())
539.         result = next(compiler.apply_converters((result,), converters))
540. 
541.         return dict(zip(outer_query.annotation_select, result))
542. 
543.     def get_count(self, using):
544.         """
545.         Perform a COUNT() query using the current filter constraints.
546.         """
547.         obj = self.clone()
548.         obj.add_annotation(Count("*"), alias="__count", is_summary=True)
549.         return obj.get_aggregation(using, ["__count"])["__count"]
550. 
551.     def has_filters(self):
552.         return self.where
553. 
554.     def exists(self, using, limit=True):
555.         q = self.clone()
556.         if not q.distinct:
557.             if q.group_by is True:
558.                 q.add_fields(
559.                     (f.attname for f in self.model._meta.concrete_fields), False
560.                 )
561.                 # Disable GROUP BY aliases to avoid orphaning references to the
562.                 # SELECT clause which is about to be cleared.
563.                 q.set_group_by(allow_aliases=False)
564.             q.clear_select_clause()
565.         if q.combined_queries and q.combinator == "union":
566.             limit_combined = connections[
567.                 using
568.             ].features.supports_slicing_ordering_in_compound
569.             q.combined_queries = tuple(
570.                 combined_query.exists(using, limit=limit_combined)
571.                 for combined_query in q.combined_queries
572.             )
573.         q.clear_ordering(force=True)
574.         if limit:
575.             q.set_limits(high=1)
576.         q.add_extra({"a": 1}, None, None, None, None, None)
577.         q.set_extra_mask(["a"])
578.         return q
579. 
580.     def has_results(self, using):
581.         q = self.exists(using)
582.         compiler = q.get_compiler(using=using)
583.         return compiler.has_results()
584. 
585.     def explain(self, using, format=None, **options):
586.         q = self.clone()
587.         q.explain_info = ExplainInfo(format, options)
588.         compiler = q.get_compiler(using=using)
589.         return "\n".join(compiler.explain_query())
590. 
591.     def combine(self, rhs, connector):
592.         """
593.         Merge the 'rhs' query into the current one (with any 'rhs' effects
594.         being applied *after* (that is, "to the right of") anything in the
595.         current query. 'rhs' is not modified during a call to this function.
596. 
597.         The 'connector' parameter describes how to connect filters from the
598.         'rhs' query.
599.         """
600.         if self.model != rhs.model:
601.             raise TypeError("Cannot combine queries on two different base models.")
602.         if self.is_sliced:
603.             raise TypeError("Cannot combine queries once a slice has been taken.")
604.         if self.distinct != rhs.distinct:
605.             raise TypeError("Cannot combine a unique query with a non-unique query.")
606.         if self.distinct_fields != rhs.distinct_fields:
607.             raise TypeError("Cannot combine queries with different distinct fields.")
608. 
609.         # If lhs and rhs shares the same alias prefix, it is possible to have
610.         # conflicting alias changes like T4 -> T5, T5 -> T6, which might end up
611.         # as T4 -> T6 while combining two querysets. To prevent this, change an
612.         # alias prefix of the rhs and update current aliases accordingly,
613.         # except if the alias is the base table since it must be present in the
614.         # query on both sides.
615.         initial_alias = self.get_initial_alias()
616.         rhs.bump_prefix(self, exclude={initial_alias})
617. 
618.         # Work out how to relabel the rhs aliases, if necessary.
619.         change_map = {}
620.         conjunction = connector == AND
621. 
622.         # Determine which existing joins can be reused. When combining the
623.         # query with AND we must recreate all joins for m2m filters. When
624.         # combining with OR we can reuse joins. The reason is that in AND
625.         # case a single row can't fulfill a condition like:
626.         #     revrel__col=1 & revrel__col=2
627.         # But, there might be two different related rows matching this
628.         # condition. In OR case a single True is enough, so single row is
629.         # enough, too.
630.         #
631.         # Note that we will be creating duplicate joins for non-m2m joins in
632.         # the AND case. The results will be correct but this creates too many
633.         # joins. This is something that could be fixed later on.
634.         reuse = set() if conjunction else set(self.alias_map)
635.         joinpromoter = JoinPromoter(connector, 2, False)
636.         joinpromoter.add_votes(
637.             j for j in self.alias_map if self.alias_map[j].join_type == INNER
638.         )
639.         rhs_votes = set()
640.         # Now, add the joins from rhs query into the new query (skipping base
641.         # table).
642.         rhs_tables = list(rhs.alias_map)[1:]
643.         for alias in rhs_tables:
644.             join = rhs.alias_map[alias]
645.             # If the left side of the join was already relabeled, use the
646.             # updated alias.
647.             join = join.relabeled_clone(change_map)
648.             new_alias = self.join(join, reuse=reuse)
649.             if join.join_type == INNER:
650.                 rhs_votes.add(new_alias)
651.             # We can't reuse the same join again in the query. If we have two
652.             # distinct joins for the same connection in rhs query, then the
653.             # combined query must have two joins, too.
654.             reuse.discard(new_alias)
655.             if alias != new_alias:
656.                 change_map[alias] = new_alias
657.             if not rhs.alias_refcount[alias]:
658.                 # The alias was unused in the rhs query. Unref it so that it
659.                 # will be unused in the new query, too. We have to add and
660.                 # unref the alias so that join promotion has information of
661.                 # the join type for the unused alias.
662.                 self.unref_alias(new_alias)
663.         joinpromoter.add_votes(rhs_votes)
664.         joinpromoter.update_join_types(self)
665. 
666.         # Combine subqueries aliases to ensure aliases relabelling properly
667.         # handle subqueries when combining where and select clauses.
668.         self.subq_aliases |= rhs.subq_aliases
669. 
670.         # Now relabel a copy of the rhs where-clause and add it to the current
671.         # one.
672.         w = rhs.where.clone()
673.         w.relabel_aliases(change_map)
674.         self.where.add(w, connector)
675. 
676.         # Selection columns and extra extensions are those provided by 'rhs'.
677.         if rhs.select:
678.             self.set_select([col.relabeled_clone(change_map) for col in rhs.select])
679.         else:
680.             self.select = ()
681. 
682.         if connector == OR:
683.             # It would be nice to be able to handle this, but the queries don't
684.             # really make sense (or return consistent value sets). Not worth
685.             # the extra complexity when you can write a real query instead.
686.             if self.extra and rhs.extra:
687.                 raise ValueError(
688.                     "When merging querysets using 'or', you cannot have "
689.                     "extra(select=...) on both sides."
690.                 )
691.         self.extra.update(rhs.extra)
692.         extra_select_mask = set()
693.         if self.extra_select_mask is not None:
694.             extra_select_mask.update(self.extra_select_mask)
695.         if rhs.extra_select_mask is not None:
696.             extra_select_mask.update(rhs.extra_select_mask)
697.         if extra_select_mask:
698.             self.set_extra_mask(extra_select_mask)
699.         self.extra_tables += rhs.extra_tables
700. 
701.         # Ordering uses the 'rhs' ordering, unless it has none, in which case
702.         # the current ordering is used.
703.         self.order_by = rhs.order_by or self.order_by
704.         self.extra_order_by = rhs.extra_order_by or self.extra_order_by
705. 
706.     def deferred_to_data(self, target, callback):
707.         """
708.         Convert the self.deferred_loading data structure to an alternate data
709.         structure, describing the field that *will* be loaded. This is used to
710.         compute the columns to select from the database and also by the
711.         QuerySet class to work out which fields are being initialized on each
712.         model. Models that have all their fields included aren't mentioned in
713.         the result, only those that have field restrictions in place.
714. 
715.         The "target" parameter is the instance that is populated (in place).
716.         The "callback" is a function that is called whenever a (model, field)
717.         pair need to be added to "target". It accepts three parameters:
718.         "target", and the model and list of fields being added for that model.
719.         """
720.         field_names, defer = self.deferred_loading
721.         if not field_names:
722.             return
723.         orig_opts = self.get_meta()
724.         seen = {}
725.         must_include = {orig_opts.concrete_model: {orig_opts.pk}}
726.         for field_name in field_names:
727.             parts = field_name.split(LOOKUP_SEP)
728.             cur_model = self.model._meta.concrete_model
729.             opts = orig_opts
730.             for name in parts[:-1]:
731.                 old_model = cur_model
732.                 if name in self._filtered_relations:
733.                     name = self._filtered_relations[name].relation_name
734.                 source = opts.get_field(name)
735.                 if is_reverse_o2o(source):
736.                     cur_model = source.related_model
737.                 else:
738.                     cur_model = source.remote_field.model
739.                 opts = cur_model._meta
740.                 # Even if we're "just passing through" this model, we must add
741.                 # both the current model's pk and the related reference field
742.                 # (if it's not a reverse relation) to the things we select.
743.                 if not is_reverse_o2o(source):
744.                     must_include[old_model].add(source)
745.                 add_to_dict(must_include, cur_model, opts.pk)
746.             field = opts.get_field(parts[-1])
747.             is_reverse_object = field.auto_created and not field.concrete
748.             model = field.related_model if is_reverse_object else field.model
749.             model = model._meta.concrete_model
750.             if model == opts.model:
751.                 model = cur_model
752.             if not is_reverse_o2o(field):
753.                 add_to_dict(seen, model, field)
754. 
755.         if defer:
756.             # We need to load all fields for each model, except those that
757.             # appear in "seen" (for all models that appear in "seen"). The only
758.             # slight complexity here is handling fields that exist on parent
759.             # models.
760.             workset = {}
761.             for model, values in seen.items():
762.                 for field in model._meta.local_fields:
763.                     if field not in values:
764.                         m = field.model._meta.concrete_model
765.                         add_to_dict(workset, m, field)
766.             for model, values in must_include.items():
767.                 # If we haven't included a model in workset, we don't add the
768.                 # corresponding must_include fields for that model, since an
769.                 # empty set means "include all fields". That's why there's no
770.                 # "else" branch here.
771.                 if model in workset:
772.                     workset[model].update(values)
773.             for model, values in workset.items():
774.                 callback(target, model, values)
775.         else:
776.             for model, values in must_include.items():
777.                 if model in seen:
778.                     seen[model].update(values)
779.                 else:
780.                     # As we've passed through this model, but not explicitly
781.                     # included any fields, we have to make sure it's mentioned
782.                     # so that only the "must include" fields are pulled in.
783.                     seen[model] = values
784.             # Now ensure that every model in the inheritance chain is mentioned
785.             # in the parent list. Again, it must be mentioned to ensure that
786.             # only "must include" fields are pulled in.
787.             for model in orig_opts.get_parent_list():
788.                 seen.setdefault(model, set())
789.             for model, values in seen.items():
790.                 callback(target, model, values)
791. 
792.     def table_alias(self, table_name, create=False, filtered_relation=None):
793.         """
794.         Return a table alias for the given table_name and whether this is a
795.         new alias or not.
796. 
797.         If 'create' is true, a new alias is always created. Otherwise, the
798.         most recently created alias for the table (if one exists) is reused.
799.         """
800.         alias_list = self.table_map.get(table_name)
801.         if not create and alias_list:
802.             alias = alias_list[0]
803.             self.alias_refcount[alias] += 1
804.             return alias, False
805. 
806.         # Create a new alias for this table.
807.         if alias_list:
808.             alias = "%s%d" % (self.alias_prefix, len(self.alias_map) + 1)
809.             alias_list.append(alias)
810.         else:
811.             # The first occurrence of a table uses the table name directly.
812.             alias = (
813.                 filtered_relation.alias if filtered_relation is not None else table_name
814.             )
815.             self.table_map[table_name] = [alias]
816.         self.alias_refcount[alias] = 1
817.         return alias, True
818. 
819.     def ref_alias(self, alias):
820.         """Increases the reference count for this alias."""
821.         self.alias_refcount[alias] += 1
822. 
823.     def unref_alias(self, alias, amount=1):
824.         """Decreases the reference count for this alias."""
825.         self.alias_refcount[alias] -= amount
826. 
827.     def promote_joins(self, aliases):
828.         """
829.         Promote recursively the join type of given aliases and its children to
830.         an outer join. If 'unconditional' is False, only promote the join if
831.         it is nullable or the parent join is an outer join.
832. 
833.         The children promotion is done to avoid join chains that contain a LOUTER
834.         b INNER c. So, if we have currently a INNER b INNER c and a->b is promoted,
835.         then we must also promote b->c automatically, or otherwise the promotion
836.         of a->b doesn't actually change anything in the query results.
837.         """
838.         aliases = list(aliases)
839.         while aliases:
840.             alias = aliases.pop(0)
841.             if self.alias_map[alias].join_type is None:
842.                 # This is the base table (first FROM entry) - this table
843.                 # isn't really joined at all in the query, so we should not
844.                 # alter its join type.
845.                 continue
846.             # Only the first alias (skipped above) should have None join_type
847.             assert self.alias_map[alias].join_type is not None
848.             parent_alias = self.alias_map[alias].parent_alias
849.             parent_louter = (
850.                 parent_alias and self.alias_map[parent_alias].join_type == LOUTER
851.             )
852.             already_louter = self.alias_map[alias].join_type == LOUTER
853.             if (self.alias_map[alias].nullable or parent_louter) and not already_louter:
854.                 self.alias_map[alias] = self.alias_map[alias].promote()
855.                 # Join type of 'alias' changed, so re-examine all aliases that
856.                 # refer to this one.
857.                 aliases.extend(
858.                     join
859.                     for join in self.alias_map
860.                     if self.alias_map[join].parent_alias == alias
861.                     and join not in aliases
862.                 )
863. 
864.     def demote_joins(self, aliases):
865.         """
866.         Change join type from LOUTER to INNER for all joins in aliases.
867. 
868.         Similarly to promote_joins(), this method must ensure no join chains
869.         containing first an outer, then an inner join are generated. If we
870.         are demoting b->c join in chain a LOUTER b LOUTER c then we must
871.         demote a->b automatically, or otherwise the demotion of b->c doesn't
872.         actually change anything in the query results. .
873.         """
874.         aliases = list(aliases)
875.         while aliases:
876.             alias = aliases.pop(0)
877.             if self.alias_map[alias].join_type == LOUTER:
878.                 self.alias_map[alias] = self.alias_map[alias].demote()
879.                 parent_alias = self.alias_map[alias].parent_alias
880.                 if self.alias_map[parent_alias].join_type == INNER:
881.                     aliases.append(parent_alias)
882. 
883.     def reset_refcounts(self, to_counts):
884.         """
885.         Reset reference counts for aliases so that they match the value passed
886.         in `to_counts`.
887.         """
888.         for alias, cur_refcount in self.alias_refcount.copy().items():
889.             unref_amount = cur_refcount - to_counts.get(alias, 0)
890.             self.unref_alias(alias, unref_amount)
891. 
892.     def change_aliases(self, change_map):
893.         """
894.         Change the aliases in change_map (which maps old-alias -> new-alias),
895.         relabelling any references to them in select columns and the where
896.         clause.
897.         """
898.         # If keys and values of change_map were to intersect, an alias might be
899.         # updated twice (e.g. T4 -> T5, T5 -> T6, so also T4 -> T6) depending
900.         # on their order in change_map.
901.         assert set(change_map).isdisjoint(change_map.values())
902. 
903.         # 1. Update references in "select" (normal columns plus aliases),
904.         # "group by" and "where".
905.         self.where.relabel_aliases(change_map)
906.         if isinstance(self.group_by, tuple):
907.             self.group_by = tuple(
908.                 [col.relabeled_clone(change_map) for col in self.group_by]
909.             )
910.         self.select = tuple([col.relabeled_clone(change_map) for col in self.select])
911.         self.annotations = self.annotations and {
912.             key: col.relabeled_clone(change_map)
913.             for key, col in self.annotations.items()
914.         }
915. 
916.         # 2. Rename the alias in the internal table/alias datastructures.
917.         for old_alias, new_alias in change_map.items():
918.             if old_alias not in self.alias_map:
919.                 continue
920.             alias_data = self.alias_map[old_alias].relabeled_clone(change_map)
921.             self.alias_map[new_alias] = alias_data
922.             self.alias_refcount[new_alias] = self.alias_refcount[old_alias]
923.             del self.alias_refcount[old_alias]
924.             del self.alias_map[old_alias]
925. 
926.             table_aliases = self.table_map[alias_data.table_name]
927.             for pos, alias in enumerate(table_aliases):
928.                 if alias == old_alias:
929.                     table_aliases[pos] = new_alias
930.                     break
931.         self.external_aliases = {
932.             # Table is aliased or it's being changed and thus is aliased.
933.             change_map.get(alias, alias): (aliased or alias in change_map)
934.             for alias, aliased in self.external_aliases.items()
935.         }
936. 
937.     def bump_prefix(self, other_query, exclude=None):
938.         """
939.         Change the alias prefix to the next letter in the alphabet in a way
940.         that the other query's aliases and this query's aliases will not
941.         conflict. Even tables that previously had no alias will get an alias
942.         after this call. To prevent changing aliases use the exclude parameter.
943.         """
944. 
945.         def prefix_gen():
946.             """
947.             Generate a sequence of characters in alphabetical order:
948.                 -> 'A', 'B', 'C', ...
949. 
950.             When the alphabet is finished, the sequence will continue with the
951.             Cartesian product:
952.                 -> 'AA', 'AB', 'AC', ...
953.             """
954.             alphabet = ascii_uppercase
955.             prefix = chr(ord(self.alias_prefix) + 1)
956.             yield prefix
957.             for n in count(1):
958.                 seq = alphabet[alphabet.index(prefix) :] if prefix else alphabet
959.                 for s in product(seq, repeat=n):
960.                     yield "".join(s)
961.                 prefix = None
962. 
963.         if self.alias_prefix != other_query.alias_prefix:
964.             # No clashes between self and outer query should be possible.
965.             return
966. 
967.         # Explicitly avoid infinite loop. The constant divider is based on how
968.         # much depth recursive subquery references add to the stack. This value
969.         # might need to be adjusted when adding or removing function calls from
970.         # the code path in charge of performing these operations.
971.         local_recursion_limit = sys.getrecursionlimit() // 16
972.         for pos, prefix in enumerate(prefix_gen()):
973.             if prefix not in self.subq_aliases:
974.                 self.alias_prefix = prefix
975.                 break
976.             if pos > local_recursion_limit:
977.                 raise RecursionError(
978.                     "Maximum recursion depth exceeded: too many subqueries."
979.                 )
980.         self.subq_aliases = self.subq_aliases.union([self.alias_prefix])
981.         other_query.subq_aliases = other_query.subq_aliases.union(self.subq_aliases)
982.         if exclude is None:
983.             exclude = {}
984.         self.change_aliases(
985.             {
986.                 alias: "%s%d" % (self.alias_prefix, pos)
987.                 for pos, alias in enumerate(self.alias_map)
988.                 if alias not in exclude
989.             }
990.         )
991. 
992.     def get_initial_alias(self):
993.         """
994.         Return the first alias for this query, after increasing its reference
995.         count.
996.         """
997.         if self.alias_map:
998.             alias = self.base_table
999.             self.ref_alias(alias)
1000.         elif self.model:
1001.             alias = self.join(self.base_table_class(self.get_meta().db_table, None))
1002.         else:
1003.             alias = None
1004.         return alias
1005. 
1006.     def count_active_tables(self):
1007.         """
1008.         Return the number of tables in this query with a non-zero reference
1009.         count. After execution, the reference counts are zeroed, so tables
1010.         added in compiler will not be seen by this method.
1011.         """
1012.         return len([1 for count in self.alias_refcount.values() if count])
1013. 
1014.     def join(self, join, reuse=None):
1015.         """
1016.         Return an alias for the 'join', either reusing an existing alias for
1017.         that join or creating a new one. 'join' is either a base_table_class or
1018.         join_class.
1019. 
1020.         The 'reuse' parameter can be either None which means all joins are
1021.         reusable, or it can be a set containing the aliases that can be reused.
1022. 
1023.         A join is always created as LOUTER if the lhs alias is LOUTER to make
1024.         sure chains like t1 LOUTER t2 INNER t3 aren't generated. All new
1025.         joins are created as LOUTER if the join is nullable.
1026.         """
1027.         reuse_aliases = [
1028.             a
1029.             for a, j in self.alias_map.items()
1030.             if (reuse is None or a in reuse) and j.equals(join)
1031.         ]
1032.         if reuse_aliases:
1033.             if join.table_alias in reuse_aliases:
1034.                 reuse_alias = join.table_alias
1035.             else:
1036.                 # Reuse the most recent alias of the joined table
1037.                 # (a many-to-many relation may be joined multiple times).
1038.                 reuse_alias = reuse_aliases[-1]
1039.             self.ref_alias(reuse_alias)
1040.             return reuse_alias
1041. 
1042.         # No reuse is possible, so we need a new alias.
1043.         alias, _ = self.table_alias(
1044.             join.table_name, create=True, filtered_relation=join.filtered_relation
1045.         )
1046.         if join.join_type:
1047.             if self.alias_map[join.parent_alias].join_type == LOUTER or join.nullable:
1048.                 join_type = LOUTER
1049.             else:
1050.                 join_type = INNER
1051.             join.join_type = join_type
1052.         join.table_alias = alias
1053.         self.alias_map[alias] = join
1054.         return alias
1055. 
1056.     def join_parent_model(self, opts, model, alias, seen):
1057.         """
1058.         Make sure the given 'model' is joined in the query. If 'model' isn't
1059.         a parent of 'opts' or if it is None this method is a no-op.
1060. 
1061.         The 'alias' is the root alias for starting the join, 'seen' is a dict
1062.         of model -> alias of existing joins. It must also contain a mapping
1063.         of None -> some alias. This will be returned in the no-op case.
1064.         """
1065.         if model in seen:
1066.             return seen[model]
1067.         chain = opts.get_base_chain(model)
1068.         if not chain:
1069.             return alias
1070.         curr_opts = opts
1071.         for int_model in chain:
1072.             if int_model in seen:
1073.                 curr_opts = int_model._meta
1074.                 alias = seen[int_model]
1075.                 continue
1076.             # Proxy model have elements in base chain
1077.             # with no parents, assign the new options
1078.             # object and skip to the next base in that
1079.             # case
1080.             if not curr_opts.parents[int_model]:
1081.                 curr_opts = int_model._meta
1082.                 continue
1083.             link_field = curr_opts.get_ancestor_link(int_model)
1084.             join_info = self.setup_joins([link_field.name], curr_opts, alias)
1085.             curr_opts = int_model._meta
1086.             alias = seen[int_model] = join_info.joins[-1]
1087.         return alias or seen[None]
1088. 
1089.     def add_annotation(self, annotation, alias, is_summary=False, select=True):
1090.         """Add a single annotation expression to the Query."""
1091.         annotation = annotation.resolve_expression(
1092.             self, allow_joins=True, reuse=None, summarize=is_summary
1093.         )
1094.         if select:
1095.             self.append_annotation_mask([alias])
1096.         else:
1097.             self.set_annotation_mask(set(self.annotation_select).difference({alias}))
1098.         self.annotations[alias] = annotation
1099. 
1100.     def resolve_expression(self, query, *args, **kwargs):
1101.         clone = self.clone()
1102.         # Subqueries need to use a different set of aliases than the outer query.
1103.         clone.bump_prefix(query)
1104.         clone.subquery = True
1105.         clone.where.resolve_expression(query, *args, **kwargs)
1106.         # Resolve combined queries.
1107.         if clone.combinator:
1108.             clone.combined_queries = tuple(
1109.                 [
1110.                     combined_query.resolve_expression(query, *args, **kwargs)
1111.                     for combined_query in clone.combined_queries
1112.                 ]
1113.             )
1114.         for key, value in clone.annotations.items():
1115.             resolved = value.resolve_expression(query, *args, **kwargs)
1116.             if hasattr(resolved, "external_aliases"):
1117.                 resolved.external_aliases.update(clone.external_aliases)
1118.             clone.annotations[key] = resolved
1119.         # Outer query's aliases are considered external.
1120.         for alias, table in query.alias_map.items():
1121.             clone.external_aliases[alias] = (
1122.                 isinstance(table, Join)
1123.                 and table.join_field.related_model._meta.db_table != alias
1124.             ) or (
1125.                 isinstance(table, BaseTable) and table.table_name != table.table_alias
1126.             )
1127.         return clone
1128. 
1129.     def get_external_cols(self):
1130.         exprs = chain(self.annotations.values(), self.where.children)
1131.         return [
1132.             col
1133.             for col in self._gen_cols(exprs, include_external=True)
1134.             if col.alias in self.external_aliases
1135.         ]
1136. 
1137.     def get_group_by_cols(self, alias=None):
1138.         if alias:
1139.             return [Ref(alias, self)]
1140.         external_cols = self.get_external_cols()
1141.         if any(col.possibly_multivalued for col in external_cols):
1142.             return [self]
1143.         return external_cols
1144. 
1145.     def as_sql(self, compiler, connection):
1146.         # Some backends (e.g. Oracle) raise an error when a subquery contains
1147.         # unnecessary ORDER BY clause.
1148.         if (
1149.             self.subquery
1150.             and not connection.features.ignores_unnecessary_order_by_in_subqueries
1151.         ):
1152.             self.clear_ordering(force=False)
1153.         sql, params = self.get_compiler(connection=connection).as_sql()
1154.         if self.subquery:
1155.             sql = "(%s)" % sql
1156.         return sql, params
1157. 
1158.     def resolve_lookup_value(self, value, can_reuse, allow_joins):
1159.         if hasattr(value, "resolve_expression"):
1160.             value = value.resolve_expression(
1161.                 self,
1162.                 reuse=can_reuse,
1163.                 allow_joins=allow_joins,
1164.             )
1165.         elif isinstance(value, (list, tuple)):
1166.             # The items of the iterable may be expressions and therefore need
1167.             # to be resolved independently.
1168.             values = (
1169.                 self.resolve_lookup_value(sub_value, can_reuse, allow_joins)
1170.                 for sub_value in value
1171.             )
1172.             type_ = type(value)
1173.             if hasattr(type_, "_make"):  # namedtuple
1174.                 return type_(*values)
1175.             return type_(values)
1176.         return value
1177. 
1178.     def solve_lookup_type(self, lookup):
1179.         """
1180.         Solve the lookup type from the lookup (e.g.: 'foobar__id__icontains').
1181.         """
1182.         lookup_splitted = lookup.split(LOOKUP_SEP)
1183.         if self.annotations:
1184.             expression, expression_lookups = refs_expression(
1185.                 lookup_splitted, self.annotations
1186.             )
1187.             if expression:
1188.                 return expression_lookups, (), expression
1189.         _, field, _, lookup_parts = self.names_to_path(lookup_splitted, self.get_meta())
1190.         field_parts = lookup_splitted[0 : len(lookup_splitted) - len(lookup_parts)]
1191.         if len(lookup_parts) > 1 and not field_parts:
1192.             raise FieldError(
1193.                 'Invalid lookup "%s" for model %s".'
1194.                 % (lookup, self.get_meta().model.__name__)
1195.             )
1196.         return lookup_parts, field_parts, False
1197. 
1198.     def check_query_object_type(self, value, opts, field):
1199.         """
1200.         Check whether the object passed while querying is of the correct type.
1201.         If not, raise a ValueError specifying the wrong object.
1202.         """
1203.         if hasattr(value, "_meta"):
1204.             if not check_rel_lookup_compatibility(value._meta.model, opts, field):
1205.                 raise ValueError(
1206.                     'Cannot query "%s": Must be "%s" instance.'
1207.                     % (value, opts.object_name)
1208.                 )
1209. 
1210.     def check_related_objects(self, field, value, opts):
1211.         """Check the type of object passed to query relations."""
1212.         if field.is_relation:
1213.             # Check that the field and the queryset use the same model in a
1214.             # query like .filter(author=Author.objects.all()). For example, the
1215.             # opts would be Author's (from the author field) and value.model
1216.             # would be Author.objects.all() queryset's .model (Author also).
1217.             # The field is the related field on the lhs side.
1218.             if (
1219.                 isinstance(value, Query)
1220.                 and not value.has_select_fields
1221.                 and not check_rel_lookup_compatibility(value.model, opts, field)
1222.             ):
1223.                 raise ValueError(
1224.                     'Cannot use QuerySet for "%s": Use a QuerySet for "%s".'
1225.                     % (value.model._meta.object_name, opts.object_name)
1226.                 )
1227.             elif hasattr(value, "_meta"):
1228.                 self.check_query_object_type(value, opts, field)
1229.             elif hasattr(value, "__iter__"):
1230.                 for v in value:
1231.                     self.check_query_object_type(v, opts, field)
1232. 
1233.     def check_filterable(self, expression):
1234.         """Raise an error if expression cannot be used in a WHERE clause."""
1235.         if hasattr(expression, "resolve_expression") and not getattr(
1236.             expression, "filterable", True
1237.         ):
1238.             raise NotSupportedError(
1239.                 expression.__class__.__name__ + " is disallowed in the filter "
1240.                 "clause."
1241.             )
1242.         if hasattr(expression, "get_source_expressions"):
1243.             for expr in expression.get_source_expressions():
1244.                 self.check_filterable(expr)
1245. 
1246.     def build_lookup(self, lookups, lhs, rhs):
1247.         """
1248.         Try to extract transforms and lookup from given lhs.
1249. 
1250.         The lhs value is something that works like SQLExpression.
1251.         The rhs value is what the lookup is going to compare against.
1252.         The lookups is a list of names to extract using get_lookup()
1253.         and get_transform().
1254.         """
1255.         # __exact is the default lookup if one isn't given.
1256.         *transforms, lookup_name = lookups or ["exact"]
1257.         for name in transforms:
1258.             lhs = self.try_transform(lhs, name)
1259.         # First try get_lookup() so that the lookup takes precedence if the lhs
1260.         # supports both transform and lookup for the name.
1261.         lookup_class = lhs.get_lookup(lookup_name)
1262.         if not lookup_class:
1263.             if lhs.field.is_relation:
1264.                 raise FieldError(
1265.                     "Related Field got invalid lookup: {}".format(lookup_name)
1266.                 )
1267.             # A lookup wasn't found. Try to interpret the name as a transform
1268.             # and do an Exact lookup against it.
1269.             lhs = self.try_transform(lhs, lookup_name)
1270.             lookup_name = "exact"
1271.             lookup_class = lhs.get_lookup(lookup_name)
1272.             if not lookup_class:
1273.                 return
1274. 
1275.         lookup = lookup_class(lhs, rhs)
1276.         # Interpret '__exact=None' as the sql 'is NULL'; otherwise, reject all
1277.         # uses of None as a query value unless the lookup supports it.
1278.         if lookup.rhs is None and not lookup.can_use_none_as_rhs:
1279.             if lookup_name not in ("exact", "iexact"):
1280.                 raise ValueError("Cannot use None as a query value")
1281.             return lhs.get_lookup("isnull")(lhs, True)
1282. 
1283.         # For Oracle '' is equivalent to null. The check must be done at this
1284.         # stage because join promotion can't be done in the compiler. Using
1285.         # DEFAULT_DB_ALIAS isn't nice but it's the best that can be done here.
1286.         # A similar thing is done in is_nullable(), too.
1287.         if (
1288.             lookup_name == "exact"
1289.             and lookup.rhs == ""
1290.             and connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls
1291.         ):
1292.             return lhs.get_lookup("isnull")(lhs, True)
1293. 
1294.         return lookup
1295. 
1296.     def try_transform(self, lhs, name):
1297.         """
1298.         Helper method for build_lookup(). Try to fetch and initialize
1299.         a transform for name parameter from lhs.
1300.         """
1301.         transform_class = lhs.get_transform(name)
1302.         if transform_class:
1303.             return transform_class(lhs)
1304.         else:
1305.             output_field = lhs.output_field.__class__
1306.             suggested_lookups = difflib.get_close_matches(
1307.                 name, output_field.get_lookups()
1308.             )
1309.             if suggested_lookups:
1310.                 suggestion = ", perhaps you meant %s?" % " or ".join(suggested_lookups)
1311.             else:
1312.                 suggestion = "."
1313.             raise FieldError(
1314.                 "Unsupported lookup '%s' for %s or join on the field not "
1315.                 "permitted%s" % (name, output_field.__name__, suggestion)
1316.             )
1317. 
1318.     def build_filter(
1319.         self,
1320.         filter_expr,
1321.         branch_negated=False,
1322.         current_negated=False,
1323.         can_reuse=None,
1324.         allow_joins=True,
1325.         split_subq=True,
1326.         check_filterable=True,
1327.     ):
1328.         """
1329.         Build a WhereNode for a single filter clause but don't add it
1330.         to this Query. Query.add_q() will then add this filter to the where
1331.         Node.
1332. 
1333.         The 'branch_negated' tells us if the current branch contains any
1334.         negations. This will be used to determine if subqueries are needed.
1335. 
1336.         The 'current_negated' is used to determine if the current filter is
1337.         negated or not and this will be used to determine if IS NULL filtering
1338.         is needed.
1339. 
1340.         The difference between current_negated and branch_negated is that
1341.         branch_negated is set on first negation, but current_negated is
1342.         flipped for each negation.
1343. 
1344.         Note that add_filter will not do any negating itself, that is done
1345.         upper in the code by add_q().
1346. 
1347.         The 'can_reuse' is a set of reusable joins for multijoins.
1348. 
1349.         The method will create a filter clause that can be added to the current
1350.         query. However, if the filter isn't added to the query then the caller
1351.         is responsible for unreffing the joins used.
1352.         """
1353.         if isinstance(filter_expr, dict):
1354.             raise FieldError("Cannot parse keyword query as dict")
1355.         if isinstance(filter_expr, Q):
1356.             return self._add_q(
1357.                 filter_expr,
1358.                 branch_negated=branch_negated,
1359.                 current_negated=current_negated,
1360.                 used_aliases=can_reuse,
1361.                 allow_joins=allow_joins,
1362.                 split_subq=split_subq,
1363.                 check_filterable=check_filterable,
1364.             )
1365.         if hasattr(filter_expr, "resolve_expression"):
1366.             if not getattr(filter_expr, "conditional", False):
1367.                 raise TypeError("Cannot filter against a non-conditional expression.")
1368.             condition = filter_expr.resolve_expression(self, allow_joins=allow_joins)
1369.             if not isinstance(condition, Lookup):
1370.                 condition = self.build_lookup(["exact"], condition, True)
1371.             return WhereNode([condition], connector=AND), []
1372.         arg, value = filter_expr
1373.         if not arg:
1374.             raise FieldError("Cannot parse keyword query %r" % arg)
1375.         lookups, parts, reffed_expression = self.solve_lookup_type(arg)
1376. 
1377.         if check_filterable:
1378.             self.check_filterable(reffed_expression)
1379. 
1380.         if not allow_joins and len(parts) > 1:
1381.             raise FieldError("Joined field references are not permitted in this query")
1382. 
1383.         pre_joins = self.alias_refcount.copy()
1384.         value = self.resolve_lookup_value(value, can_reuse, allow_joins)
1385.         used_joins = {
1386.             k for k, v in self.alias_refcount.items() if v > pre_joins.get(k, 0)
1387.         }
1388. 
1389.         if check_filterable:
1390.             self.check_filterable(value)
1391. 
1392.         if reffed_expression:
1393.             condition = self.build_lookup(lookups, reffed_expression, value)
1394.             return WhereNode([condition], connector=AND), []
1395. 
1396.         opts = self.get_meta()
1397.         alias = self.get_initial_alias()
1398.         allow_many = not branch_negated or not split_subq
1399. 
1400.         try:
1401.             join_info = self.setup_joins(
1402.                 parts,
1403.                 opts,
1404.                 alias,
1405.                 can_reuse=can_reuse,
1406.                 allow_many=allow_many,
1407.             )
1408. 
1409.             # Prevent iterator from being consumed by check_related_objects()
1410.             if isinstance(value, Iterator):
1411.                 value = list(value)
1412.             self.check_related_objects(join_info.final_field, value, join_info.opts)
1413. 
1414.             # split_exclude() needs to know which joins were generated for the
1415.             # lookup parts
1416.             self._lookup_joins = join_info.joins
1417.         except MultiJoin as e:
1418.             return self.split_exclude(filter_expr, can_reuse, e.names_with_path)
1419. 
1420.         # Update used_joins before trimming since they are reused to determine
1421.         # which joins could be later promoted to INNER.
1422.         used_joins.update(join_info.joins)
1423.         targets, alias, join_list = self.trim_joins(
1424.             join_info.targets, join_info.joins, join_info.path
1425.         )
1426.         if can_reuse is not None:
1427.             can_reuse.update(join_list)
1428. 
1429.         if join_info.final_field.is_relation:
1430.             # No support for transforms for relational fields
1431.             num_lookups = len(lookups)
1432.             if num_lookups > 1:
1433.                 raise FieldError(
1434.                     "Related Field got invalid lookup: {}".format(lookups[0])
1435.                 )
1436.             if len(targets) == 1:
1437.                 col = self._get_col(targets[0], join_info.final_field, alias)
1438.             else:
1439.                 col = MultiColSource(
1440.                     alias, targets, join_info.targets, join_info.final_field
1441.                 )
1442.         else:
1443.             col = self._get_col(targets[0], join_info.final_field, alias)
1444. 
1445.         condition = self.build_lookup(lookups, col, value)
1446.         lookup_type = condition.lookup_name
1447.         clause = WhereNode([condition], connector=AND)
1448. 
1449.         require_outer = (
1450.             lookup_type == "isnull" and condition.rhs is True and not current_negated
1451.         )
1452.         if (
1453.             current_negated
1454.             and (lookup_type != "isnull" or condition.rhs is False)
1455.             and condition.rhs is not None
1456.         ):
1457.             require_outer = True
1458.             if lookup_type != "isnull":
1459.                 # The condition added here will be SQL like this:
1460.                 # NOT (col IS NOT NULL), where the first NOT is added in
1461.                 # upper layers of code. The reason for addition is that if col
1462.                 # is null, then col != someval will result in SQL "unknown"
1463.                 # which isn't the same as in Python. The Python None handling
1464.                 # is wanted, and it can be gotten by
1465.                 # (col IS NULL OR col != someval)
1466.                 #   <=>
1467.                 # NOT (col IS NOT NULL AND col = someval).
1468.                 if (
1469.                     self.is_nullable(targets[0])
1470.                     or self.alias_map[join_list[-1]].join_type == LOUTER
1471.                 ):
1472.                     lookup_class = targets[0].get_lookup("isnull")
1473.                     col = self._get_col(targets[0], join_info.targets[0], alias)
1474.                     clause.add(lookup_class(col, False), AND)
1475.                 # If someval is a nullable column, someval IS NOT NULL is
1476.                 # added.
1477.                 if isinstance(value, Col) and self.is_nullable(value.target):
1478.                     lookup_class = value.target.get_lookup("isnull")
1479.                     clause.add(lookup_class(value, False), AND)
1480.         return clause, used_joins if not require_outer else ()
1481. 
1482.     def add_filter(self, filter_lhs, filter_rhs):
1483.         self.add_q(Q((filter_lhs, filter_rhs)))
1484. 
1485.     def add_q(self, q_object):
1486.         """
1487.         A preprocessor for the internal _add_q(). Responsible for doing final
1488.         join promotion.
1489.         """
1490.         # For join promotion this case is doing an AND for the added q_object
1491.         # and existing conditions. So, any existing inner join forces the join
1492.         # type to remain inner. Existing outer joins can however be demoted.
1493.         # (Consider case where rel_a is LOUTER and rel_a__col=1 is added - if
1494.         # rel_a doesn't produce any rows, then the whole condition must fail.
1495.         # So, demotion is OK.
1496.         existing_inner = {
1497.             a for a in self.alias_map if self.alias_map[a].join_type == INNER
1498.         }
1499.         clause, _ = self._add_q(q_object, self.used_aliases)
1500.         if clause:
1501.             self.where.add(clause, AND)
1502.         self.demote_joins(existing_inner)
1503. 
1504.     def build_where(self, filter_expr):
1505.         return self.build_filter(filter_expr, allow_joins=False)[0]
1506. 
1507.     def clear_where(self):
1508.         self.where = WhereNode()
1509. 
1510.     def _add_q(
1511.         self,
1512.         q_object,
1513.         used_aliases,
1514.         branch_negated=False,
1515.         current_negated=False,
1516.         allow_joins=True,
1517.         split_subq=True,
1518.         check_filterable=True,
1519.     ):
1520.         """Add a Q-object to the current filter."""
1521.         connector = q_object.connector
1522.         current_negated = current_negated ^ q_object.negated
1523.         branch_negated = branch_negated or q_object.negated
1524.         target_clause = WhereNode(connector=connector, negated=q_object.negated)
1525.         joinpromoter = JoinPromoter(
1526.             q_object.connector, len(q_object.children), current_negated
1527.         )
1528.         for child in q_object.children:
1529.             child_clause, needed_inner = self.build_filter(
1530.                 child,
1531.                 can_reuse=used_aliases,
1532.                 branch_negated=branch_negated,
1533.                 current_negated=current_negated,
1534.                 allow_joins=allow_joins,
1535.                 split_subq=split_subq,
1536.                 check_filterable=check_filterable,
1537.             )
1538.             joinpromoter.add_votes(needed_inner)
1539.             if child_clause:
1540.                 target_clause.add(child_clause, connector)
1541.         needed_inner = joinpromoter.update_join_types(self)
1542.         return target_clause, needed_inner
1543. 
1544.     def build_filtered_relation_q(
1545.         self, q_object, reuse, branch_negated=False, current_negated=False
1546.     ):
1547.         """Add a FilteredRelation object to the current filter."""
1548.         connector = q_object.connector
1549.         current_negated ^= q_object.negated
1550.         branch_negated = branch_negated or q_object.negated
1551.         target_clause = WhereNode(connector=connector, negated=q_object.negated)
1552.         for child in q_object.children:
1553.             if isinstance(child, Node):
1554.                 child_clause = self.build_filtered_relation_q(
1555.                     child,
1556.                     reuse=reuse,
1557.                     branch_negated=branch_negated,
1558.                     current_negated=current_negated,
1559.                 )
1560.             else:
1561.                 child_clause, _ = self.build_filter(
1562.                     child,
1563.                     can_reuse=reuse,
1564.                     branch_negated=branch_negated,
1565.                     current_negated=current_negated,
1566.                     allow_joins=True,
1567.                     split_subq=False,
1568.                 )
1569.             target_clause.add(child_clause, connector)
1570.         return target_clause
1571. 
1572.     def add_filtered_relation(self, filtered_relation, alias):
1573.         filtered_relation.alias = alias
1574.         lookups = dict(get_children_from_q(filtered_relation.condition))
1575.         relation_lookup_parts, relation_field_parts, _ = self.solve_lookup_type(
1576.             filtered_relation.relation_name
1577.         )
1578.         if relation_lookup_parts:
1579.             raise ValueError(
1580.                 "FilteredRelation's relation_name cannot contain lookups "
1581.                 "(got %r)." % filtered_relation.relation_name
1582.             )
1583.         for lookup in chain(lookups):
1584.             lookup_parts, lookup_field_parts, _ = self.solve_lookup_type(lookup)
1585.             shift = 2 if not lookup_parts else 1
1586.             lookup_field_path = lookup_field_parts[:-shift]
1587.             for idx, lookup_field_part in enumerate(lookup_field_path):
1588.                 if len(relation_field_parts) > idx:
1589.                     if relation_field_parts[idx] != lookup_field_part:
1590.                         raise ValueError(
1591.                             "FilteredRelation's condition doesn't support "
1592.                             "relations outside the %r (got %r)."
1593.                             % (filtered_relation.relation_name, lookup)
1594.                         )
1595.                 else:
1596.                     raise ValueError(
1597.                         "FilteredRelation's condition doesn't support nested "
1598.                         "relations deeper than the relation_name (got %r for "
1599.                         "%r)." % (lookup, filtered_relation.relation_name)
1600.                     )
1601.         self._filtered_relations[filtered_relation.alias] = filtered_relation
1602. 
1603.     def names_to_path(self, names, opts, allow_many=True, fail_on_missing=False):
1604.         """
1605.         Walk the list of names and turns them into PathInfo tuples. A single
1606.         name in 'names' can generate multiple PathInfos (m2m, for example).
1607. 
1608.         'names' is the path of names to travel, 'opts' is the model Options we
1609.         start the name resolving from, 'allow_many' is as for setup_joins().
1610.         If fail_on_missing is set to True, then a name that can't be resolved
1611.         will generate a FieldError.
1612. 
1613.         Return a list of PathInfo tuples. In addition return the final field
1614.         (the last used join field) and target (which is a field guaranteed to
1615.         contain the same value as the final field). Finally, return those names
1616.         that weren't found (which are likely transforms and the final lookup).
1617.         """
1618.         path, names_with_path = [], []
1619.         for pos, name in enumerate(names):
1620.             cur_names_with_path = (name, [])
1621.             if name == "pk":
1622.                 name = opts.pk.name
1623. 
1624.             field = None
1625.             filtered_relation = None
1626.             try:
1627.                 if opts is None:
1628.                     raise FieldDoesNotExist
1629.                 field = opts.get_field(name)
1630.             except FieldDoesNotExist:
1631.                 if name in self.annotation_select:
1632.                     field = self.annotation_select[name].output_field
1633.                 elif name in self._filtered_relations and pos == 0:
1634.                     filtered_relation = self._filtered_relations[name]
1635.                     if LOOKUP_SEP in filtered_relation.relation_name:
1636.                         parts = filtered_relation.relation_name.split(LOOKUP_SEP)
1637.                         filtered_relation_path, field, _, _ = self.names_to_path(
1638.                             parts,
1639.                             opts,
1640.                             allow_many,
1641.                             fail_on_missing,
1642.                         )
1643.                         path.extend(filtered_relation_path[:-1])
1644.                     else:
1645.                         field = opts.get_field(filtered_relation.relation_name)
1646.             if field is not None:
1647.                 # Fields that contain one-to-many relations with a generic
1648.                 # model (like a GenericForeignKey) cannot generate reverse
1649.                 # relations and therefore cannot be used for reverse querying.
1650.                 if field.is_relation and not field.related_model:
1651.                     raise FieldError(
1652.                         "Field %r does not generate an automatic reverse "
1653.                         "relation and therefore cannot be used for reverse "
1654.                         "querying. If it is a GenericForeignKey, consider "
1655.                         "adding a GenericRelation." % name
1656.                     )
1657.                 try:
1658.                     model = field.model._meta.concrete_model
1659.                 except AttributeError:
1660.                     # QuerySet.annotate() may introduce fields that aren't
1661.                     # attached to a model.
1662.                     model = None
1663.             else:
1664.                 # We didn't find the current field, so move position back
1665.                 # one step.
1666.                 pos -= 1
1667.                 if pos == -1 or fail_on_missing:
1668.                     available = sorted(
1669.                         [
1670.                             *get_field_names_from_opts(opts),
1671.                             *self.annotation_select,
1672.                             *self._filtered_relations,
1673.                         ]
1674.                     )
1675.                     raise FieldError(
1676.                         "Cannot resolve keyword '%s' into field. "
1677.                         "Choices are: %s" % (name, ", ".join(available))
1678.                     )
1679.                 break
1680.             # Check if we need any joins for concrete inheritance cases (the
1681.             # field lives in parent, but we are currently in one of its
1682.             # children)
1683.             if opts is not None and model is not opts.model:
1684.                 path_to_parent = opts.get_path_to_parent(model)
1685.                 if path_to_parent:
1686.                     path.extend(path_to_parent)
1687.                     cur_names_with_path[1].extend(path_to_parent)
1688.                     opts = path_to_parent[-1].to_opts
1689.             if hasattr(field, "path_infos"):
1690.                 if filtered_relation:
1691.                     pathinfos = field.get_path_info(filtered_relation)
1692.                 else:
1693.                     pathinfos = field.path_infos
1694.                 if not allow_many:
1695.                     for inner_pos, p in enumerate(pathinfos):
1696.                         if p.m2m:
1697.                             cur_names_with_path[1].extend(pathinfos[0 : inner_pos + 1])
1698.                             names_with_path.append(cur_names_with_path)
1699.                             raise MultiJoin(pos + 1, names_with_path)
1700.                 last = pathinfos[-1]
1701.                 path.extend(pathinfos)
1702.                 final_field = last.join_field
1703.                 opts = last.to_opts
1704.                 targets = last.target_fields
1705.                 cur_names_with_path[1].extend(pathinfos)
1706.                 names_with_path.append(cur_names_with_path)
1707.             else:
1708.                 # Local non-relational field.
1709.                 final_field = field
1710.                 targets = (field,)
1711.                 if fail_on_missing and pos + 1 != len(names):
1712.                     raise FieldError(
1713.                         "Cannot resolve keyword %r into field. Join on '%s'"
1714.                         " not permitted." % (names[pos + 1], name)
1715.                     )
1716.                 break
1717.         return path, final_field, targets, names[pos + 1 :]
1718. 
1719.     def setup_joins(self, names, opts, alias, can_reuse=None, allow_many=True):
1720.         """
1721.         Compute the necessary table joins for the passage through the fields
1722.         given in 'names'. 'opts' is the Options class for the current model
1723.         (which gives the table we are starting from), 'alias' is the alias for
1724.         the table to start the joining from.
1725. 
1726.         The 'can_reuse' defines the reverse foreign key joins we can reuse. It
1727.         can be None in which case all joins are reusable or a set of aliases
1728.         that can be reused. Note that non-reverse foreign keys are always
1729.         reusable when using setup_joins().
1730. 
1731.         If 'allow_many' is False, then any reverse foreign key seen will
1732.         generate a MultiJoin exception.
1733. 
1734.         Return the final field involved in the joins, the target field (used
1735.         for any 'where' constraint), the final 'opts' value, the joins, the
1736.         field path traveled to generate the joins, and a transform function
1737.         that takes a field and alias and is equivalent to `field.get_col(alias)`
1738.         in the simple case but wraps field transforms if they were included in
1739.         names.
1740. 
1741.         The target field is the field containing the concrete value. Final
1742.         field can be something different, for example foreign key pointing to
1743.         that value. Final field is needed for example in some value
1744.         conversions (convert 'obj' in fk__id=obj to pk val using the foreign
1745.         key field for example).
1746.         """
1747.         joins = [alias]
1748.         # The transform can't be applied yet, as joins must be trimmed later.
1749.         # To avoid making every caller of this method look up transforms
1750.         # directly, compute transforms here and create a partial that converts
1751.         # fields to the appropriate wrapped version.
1752. 
1753.         def final_transformer(field, alias):
1754.             if not self.alias_cols:
1755.                 alias = None
1756.             return field.get_col(alias)
1757. 
1758.         # Try resolving all the names as fields first. If there's an error,
1759.         # treat trailing names as lookups until a field can be resolved.
1760.         last_field_exception = None
1761.         for pivot in range(len(names), 0, -1):
1762.             try:
1763.                 path, final_field, targets, rest = self.names_to_path(
1764.                     names[:pivot],
1765.                     opts,
1766.                     allow_many,
1767.                     fail_on_missing=True,
1768.                 )
1769.             except FieldError as exc:
1770.                 if pivot == 1:
1771.                     # The first item cannot be a lookup, so it's safe
1772.                     # to raise the field error here.
1773.                     raise
1774.                 else:
1775.                     last_field_exception = exc
1776.             else:
1777.                 # The transforms are the remaining items that couldn't be
1778.                 # resolved into fields.
1779.                 transforms = names[pivot:]
1780.                 break
1781.         for name in transforms:
1782. 
1783.             def transform(field, alias, *, name, previous):
1784.                 try:
1785.                     wrapped = previous(field, alias)
1786.                     return self.try_transform(wrapped, name)
1787.                 except FieldError:
1788.                     # FieldError is raised if the transform doesn't exist.
1789.                     if isinstance(final_field, Field) and last_field_exception:
1790.                         raise last_field_exception
1791.                     else:
1792.                         raise
1793. 
1794.             final_transformer = functools.partial(
1795.                 transform, name=name, previous=final_transformer
1796.             )
1797.         # Then, add the path to the query's joins. Note that we can't trim
1798.         # joins at this stage - we will need the information about join type
1799.         # of the trimmed joins.
1800.         for join in path:
1801.             if join.filtered_relation:
1802.                 filtered_relation = join.filtered_relation.clone()
1803.                 table_alias = filtered_relation.alias
1804.             else:
1805.                 filtered_relation = None
1806.                 table_alias = None
1807.             opts = join.to_opts
1808.             if join.direct:
1809.                 nullable = self.is_nullable(join.join_field)
1810.             else:
1811.                 nullable = True
1812.             connection = self.join_class(
1813.                 opts.db_table,
1814.                 alias,
1815.                 table_alias,
1816.                 INNER,
1817.                 join.join_field,
1818.                 nullable,
1819.                 filtered_relation=filtered_relation,
1820.             )
1821.             reuse = can_reuse if join.m2m else None
1822.             alias = self.join(connection, reuse=reuse)
1823.             joins.append(alias)
1824.             if filtered_relation:
1825.                 filtered_relation.path = joins[:]
1826.         return JoinInfo(final_field, targets, opts, joins, path, final_transformer)
1827. 
1828.     def trim_joins(self, targets, joins, path):
1829.         """
1830.         The 'target' parameter is the final field being joined to, 'joins'
1831.         is the full list of join aliases. The 'path' contain the PathInfos
1832.         used to create the joins.
1833. 
1834.         Return the final target field and table alias and the new active
1835.         joins.
1836. 
1837.         Always trim any direct join if the target column is already in the
1838.         previous table. Can't trim reverse joins as it's unknown if there's
1839.         anything on the other side of the join.
1840.         """
1841.         joins = joins[:]
1842.         for pos, info in enumerate(reversed(path)):
1843.             if len(joins) == 1 or not info.direct:
1844.                 break
1845.             if info.filtered_relation:
1846.                 break
1847.             join_targets = {t.column for t in info.join_field.foreign_related_fields}
1848.             cur_targets = {t.column for t in targets}
1849.             if not cur_targets.issubset(join_targets):
1850.                 break
1851.             targets_dict = {
1852.                 r[1].column: r[0]
1853.                 for r in info.join_field.related_fields
1854.                 if r[1].column in cur_targets
1855.             }
1856.             targets = tuple(targets_dict[t.column] for t in targets)
1857.             self.unref_alias(joins.pop())
1858.         return targets, joins[-1], joins
1859. 
1860.     @classmethod
1861.     def _gen_cols(cls, exprs, include_external=False):
1862.         for expr in exprs:
1863.             if isinstance(expr, Col):
1864.                 yield expr
1865.             elif include_external and callable(
1866.                 getattr(expr, "get_external_cols", None)
1867.             ):
1868.                 yield from expr.get_external_cols()
1869.             elif hasattr(expr, "get_source_expressions"):
1870.                 yield from cls._gen_cols(
1871.                     expr.get_source_expressions(),
1872.                     include_external=include_external,
1873.                 )
1874. 
1875.     @classmethod
1876.     def _gen_col_aliases(cls, exprs):
1877.         yield from (expr.alias for expr in cls._gen_cols(exprs))
1878. 
1879.     def resolve_ref(self, name, allow_joins=True, reuse=None, summarize=False):
1880.         annotation = self.annotations.get(name)
1881.         if annotation is not None:
1882.             if not allow_joins:
1883.                 for alias in self._gen_col_aliases([annotation]):
1884.                     if isinstance(self.alias_map[alias], Join):
1885.                         raise FieldError(
1886.                             "Joined field references are not permitted in this query"
1887.                         )
1888.             if summarize:
1889.                 # Summarize currently means we are doing an aggregate() query
1890.                 # which is executed as a wrapped subquery if any of the
1891.                 # aggregate() elements reference an existing annotation. In
1892.                 # that case we need to return a Ref to the subquery's annotation.
1893.                 if name not in self.annotation_select:
1894.                     raise FieldError(
1895.                         "Cannot aggregate over the '%s' alias. Use annotate() "
1896.                         "to promote it." % name
1897.                     )
1898.                 return Ref(name, self.annotation_select[name])
1899.             else:
1900.                 return annotation
1901.         else:
1902.             field_list = name.split(LOOKUP_SEP)
1903.             annotation = self.annotations.get(field_list[0])
1904.             if annotation is not None:
1905.                 for transform in field_list[1:]:
1906.                     annotation = self.try_transform(annotation, transform)
1907.                 return annotation
1908.             join_info = self.setup_joins(
1909.                 field_list, self.get_meta(), self.get_initial_alias(), can_reuse=reuse
1910.             )
1911.             targets, final_alias, join_list = self.trim_joins(
1912.                 join_info.targets, join_info.joins, join_info.path
1913.             )
1914.             if not allow_joins and len(join_list) > 1:
1915.                 raise FieldError(
1916.                     "Joined field references are not permitted in this query"
1917.                 )
1918.             if len(targets) > 1:
1919.                 raise FieldError(
1920.                     "Referencing multicolumn fields with F() objects isn't supported"
1921.                 )
1922.             # Verify that the last lookup in name is a field or a transform:
1923.             # transform_function() raises FieldError if not.
1924.             transform = join_info.transform_function(targets[0], final_alias)
1925.             if reuse is not None:
1926.                 reuse.update(join_list)
1927.             return transform
1928. 
1929.     def split_exclude(self, filter_expr, can_reuse, names_with_path):
1930.         """
1931.         When doing an exclude against any kind of N-to-many relation, we need
1932.         to use a subquery. This method constructs the nested query, given the
1933.         original exclude filter (filter_expr) and the portion up to the first
1934.         N-to-many relation field.
1935. 
1936.         For example, if the origin filter is ~Q(child__name='foo'), filter_expr
1937.         is ('child__name', 'foo') and can_reuse is a set of joins usable for
1938.         filters in the original query.
1939. 
1940.         We will turn this into equivalent of:
1941.             WHERE NOT EXISTS(
1942.                 SELECT 1
1943.                 FROM child
1944.                 WHERE name = 'foo' AND child.parent_id = parent.id
1945.                 LIMIT 1
1946.             )
1947.         """
1948.         # Generate the inner query.
1949.         query = self.__class__(self.model)
1950.         query._filtered_relations = self._filtered_relations
1951.         filter_lhs, filter_rhs = filter_expr
1952.         if isinstance(filter_rhs, OuterRef):
1953.             filter_rhs = OuterRef(filter_rhs)
1954.         elif isinstance(filter_rhs, F):
1955.             filter_rhs = OuterRef(filter_rhs.name)
1956.         query.add_filter(filter_lhs, filter_rhs)
1957.         query.clear_ordering(force=True)
1958.         # Try to have as simple as possible subquery -> trim leading joins from
1959.         # the subquery.
1960.         trimmed_prefix, contains_louter = query.trim_start(names_with_path)
1961. 
1962.         col = query.select[0]
1963.         select_field = col.target
1964.         alias = col.alias
1965.         if alias in can_reuse:
1966.             pk = select_field.model._meta.pk
1967.             # Need to add a restriction so that outer query's filters are in effect for
1968.             # the subquery, too.
1969.             query.bump_prefix(self)
1970.             lookup_class = select_field.get_lookup("exact")
1971.             # Note that the query.select[0].alias is different from alias
1972.             # due to bump_prefix above.
1973.             lookup = lookup_class(pk.get_col(query.select[0].alias), pk.get_col(alias))
1974.             query.where.add(lookup, AND)
1975.             query.external_aliases[alias] = True
1976. 
1977.         lookup_class = select_field.get_lookup("exact")
1978.         lookup = lookup_class(col, ResolvedOuterRef(trimmed_prefix))
1979.         query.where.add(lookup, AND)
1980.         condition, needed_inner = self.build_filter(Exists(query))
1981. 
1982.         if contains_louter:
1983.             or_null_condition, _ = self.build_filter(
1984.                 ("%s__isnull" % trimmed_prefix, True),
1985.                 current_negated=True,
1986.                 branch_negated=True,
1987.                 can_reuse=can_reuse,
1988.             )
1989.             condition.add(or_null_condition, OR)
1990.             # Note that the end result will be:
1991.             # (outercol NOT IN innerq AND outercol IS NOT NULL) OR outercol IS NULL.
1992.             # This might look crazy but due to how IN works, this seems to be
1993.             # correct. If the IS NOT NULL check is removed then outercol NOT
1994.             # IN will return UNKNOWN. If the IS NULL check is removed, then if
1995.             # outercol IS NULL we will not match the row.
1996.         return condition, needed_inner
1997. 
1998.     def set_empty(self):
1999.         self.where.add(NothingNode(), AND)
2000.         for query in self.combined_queries:
2001.             query.set_empty()
2002. 
2003.     def is_empty(self):
2004.         return any(isinstance(c, NothingNode) for c in self.where.children)
2005. 
2006.     def set_limits(self, low=None, high=None):
2007.         """
2008.         Adjust the limits on the rows retrieved. Use low/high to set these,
2009.         as it makes it more Pythonic to read and write. When the SQL query is
2010.         created, convert them to the appropriate offset and limit values.
2011. 
2012.         Apply any limits passed in here to the existing constraints. Add low
2013.         to the current low value and clamp both to any existing high value.
2014.         """
2015.         if high is not None:
2016.             if self.high_mark is not None:
2017.                 self.high_mark = min(self.high_mark, self.low_mark + high)
2018.             else:
2019.                 self.high_mark = self.low_mark + high
2020.         if low is not None:
2021.             if self.high_mark is not None:
2022.                 self.low_mark = min(self.high_mark, self.low_mark + low)
2023.             else:
2024.                 self.low_mark = self.low_mark + low
2025. 
2026.         if self.low_mark == self.high_mark:
2027.             self.set_empty()
2028. 
2029.     def clear_limits(self):
2030.         """Clear any existing limits."""
2031.         self.low_mark, self.high_mark = 0, None
2032. 
2033.     @property
2034.     def is_sliced(self):
2035.         return self.low_mark != 0 or self.high_mark is not None
2036. 
2037.     def has_limit_one(self):
2038.         return self.high_mark is not None and (self.high_mark - self.low_mark) == 1
2039. 
2040.     def can_filter(self):
2041.         """
2042.         Return True if adding filters to this instance is still possible.
2043. 
2044.         Typically, this means no limits or offsets have been put on the results.
2045.         """
2046.         return not self.is_sliced
2047. 
2048.     def clear_select_clause(self):
2049.         """Remove all fields from SELECT clause."""
2050.         self.select = ()
2051.         self.default_cols = False
2052.         self.select_related = False
2053.         self.set_extra_mask(())
2054.         self.set_annotation_mask(())
2055. 
2056.     def clear_select_fields(self):
2057.         """
2058.         Clear the list of fields to select (but not extra_select columns).
2059.         Some queryset types completely replace any existing list of select
2060.         columns.
2061.         """
2062.         self.select = ()
2063.         self.values_select = ()
2064. 
2065.     def add_select_col(self, col, name):
2066.         self.select += (col,)
2067.         self.values_select += (name,)
2068. 
2069.     def set_select(self, cols):
2070.         self.default_cols = False
2071.         self.select = tuple(cols)
2072. 
2073.     def add_distinct_fields(self, *field_names):
2074.         """
2075.         Add and resolve the given fields to the query's "distinct on" clause.
2076.         """
2077.         self.distinct_fields = field_names
2078.         self.distinct = True
2079. 
2080.     def add_fields(self, field_names, allow_m2m=True):
2081.         """
2082.         Add the given (model) fields to the select set. Add the field names in
2083.         the order specified.
2084.         """
2085.         alias = self.get_initial_alias()
2086.         opts = self.get_meta()
2087. 
2088.         try:
2089.             cols = []
2090.             for name in field_names:
2091.                 # Join promotion note - we must not remove any rows here, so
2092.                 # if there is no existing joins, use outer join.
2093.                 join_info = self.setup_joins(
2094.                     name.split(LOOKUP_SEP), opts, alias, allow_many=allow_m2m
2095.                 )
2096.                 targets, final_alias, joins = self.trim_joins(
2097.                     join_info.targets,
2098.                     join_info.joins,
2099.                     join_info.path,
2100.                 )
2101.                 for target in targets:
2102.                     cols.append(join_info.transform_function(target, final_alias))
2103.             if cols:
2104.                 self.set_select(cols)
2105.         except MultiJoin:
2106.             raise FieldError("Invalid field name: '%s'" % name)
2107.         except FieldError:
2108.             if LOOKUP_SEP in name:
2109.                 # For lookups spanning over relationships, show the error
2110.                 # from the model on which the lookup failed.
2111.                 raise
2112.             elif name in self.annotations:
2113.                 raise FieldError(
2114.                     "Cannot select the '%s' alias. Use annotate() to promote "
2115.                     "it." % name
2116.                 )
2117.             else:
2118.                 names = sorted(
2119.                     [
2120.                         *get_field_names_from_opts(opts),
2121.                         *self.extra,
2122.                         *self.annotation_select,
2123.                         *self._filtered_relations,
2124.                     ]
2125.                 )
2126.                 raise FieldError(
2127.                     "Cannot resolve keyword %r into field. "
2128.                     "Choices are: %s" % (name, ", ".join(names))
2129.                 )
2130. 
2131.     def add_ordering(self, *ordering):
2132.         """
2133.         Add items from the 'ordering' sequence to the query's "order by"
2134.         clause. These items are either field names (not column names) --
2135.         possibly with a direction prefix ('-' or '?') -- or OrderBy
2136.         expressions.
2137. 
2138.         If 'ordering' is empty, clear all ordering from the query.
2139.         """
2140.         errors = []
2141.         for item in ordering:
2142.             if isinstance(item, str):
2143.                 if item == "?":
2144.                     continue
2145.                 if item.startswith("-"):
2146.                     item = item[1:]
2147.                 if item in self.annotations:
2148.                     continue
2149.                 if self.extra and item in self.extra:
2150.                     continue
2151.                 # names_to_path() validates the lookup. A descriptive
2152.                 # FieldError will be raise if it's not.
2153.                 self.names_to_path(item.split(LOOKUP_SEP), self.model._meta)
2154.             elif not hasattr(item, "resolve_expression"):
2155.                 errors.append(item)
2156.             if getattr(item, "contains_aggregate", False):
2157.                 raise FieldError(
2158.                     "Using an aggregate in order_by() without also including "
2159.                     "it in annotate() is not allowed: %s" % item
2160.                 )
2161.         if errors:
2162.             raise FieldError("Invalid order_by arguments: %s" % errors)
2163.         if ordering:
2164.             self.order_by += ordering
2165.         else:
2166.             self.default_ordering = False
2167. 
2168.     def clear_ordering(self, force=False, clear_default=True):
2169.         """
2170.         Remove any ordering settings if the current query allows it without
2171.         side effects, set 'force' to True to clear the ordering regardless.
2172.         If 'clear_default' is True, there will be no ordering in the resulting
2173.         query (not even the model's default).
2174.         """
2175.         if not force and (
2176.             self.is_sliced or self.distinct_fields or self.select_for_update
2177.         ):
2178.             return
2179.         self.order_by = ()
2180.         self.extra_order_by = ()
2181.         if clear_default:
2182.             self.default_ordering = False
2183. 
2184.     def set_group_by(self, allow_aliases=True):
2185.         """
2186.         Expand the GROUP BY clause required by the query.
2187. 
2188.         This will usually be the set of all non-aggregate fields in the
2189.         return data. If the database backend supports grouping by the
2190.         primary key, and the query would be equivalent, the optimization
2191.         will be made automatically.
2192.         """
2193.         # Column names from JOINs to check collisions with aliases.
2194.         if allow_aliases:
2195.             column_names = set()
2196.             seen_models = set()
2197.             for join in list(self.alias_map.values())[1:]:  # Skip base table.
2198.                 model = join.join_field.related_model
2199.                 if model not in seen_models:
2200.                     column_names.update(
2201.                         {field.column for field in model._meta.local_concrete_fields}
2202.                     )
2203.                     seen_models.add(model)
2204. 
2205.         group_by = list(self.select)
2206.         if self.annotation_select:
2207.             for alias, annotation in self.annotation_select.items():
2208.                 if not allow_aliases or alias in column_names:
2209.                     alias = None
2210.                 group_by_cols = annotation.get_group_by_cols(alias=alias)
2211.                 group_by.extend(group_by_cols)
2212.         self.group_by = tuple(group_by)
2213. 
2214.     def add_select_related(self, fields):
2215.         """
2216.         Set up the select_related data structure so that we only select
2217.         certain related models (as opposed to all models, when
2218.         self.select_related=True).
2219.         """
2220.         if isinstance(self.select_related, bool):
2221.             field_dict = {}
2222.         else:
2223.             field_dict = self.select_related
2224.         for field in fields:
2225.             d = field_dict
2226.             for part in field.split(LOOKUP_SEP):
2227.                 d = d.setdefault(part, {})
2228.         self.select_related = field_dict
2229. 
2230.     def add_extra(self, select, select_params, where, params, tables, order_by):
2231.         """
2232.         Add data to the various extra_* attributes for user-created additions
2233.         to the query.
2234.         """
2235.         if select:
2236.             # We need to pair any placeholder markers in the 'select'
2237.             # dictionary with their parameters in 'select_params' so that
2238.             # subsequent updates to the select dictionary also adjust the
2239.             # parameters appropriately.
2240.             select_pairs = {}
2241.             if select_params:
2242.                 param_iter = iter(select_params)
2243.             else:
2244.                 param_iter = iter([])
2245.             for name, entry in select.items():
2246.                 entry = str(entry)
2247.                 entry_params = []
2248.                 pos = entry.find("%s")
2249.                 while pos != -1:
2250.                     if pos == 0 or entry[pos - 1] != "%":
2251.                         entry_params.append(next(param_iter))
2252.                     pos = entry.find("%s", pos + 2)
2253.                 select_pairs[name] = (entry, entry_params)
2254.             self.extra.update(select_pairs)
2255.         if where or params:
2256.             self.where.add(ExtraWhere(where, params), AND)
2257.         if tables:
2258.             self.extra_tables += tuple(tables)
2259.         if order_by:
2260.             self.extra_order_by = order_by
2261. 
2262.     def clear_deferred_loading(self):
2263.         """Remove any fields from the deferred loading set."""
2264.         self.deferred_loading = (frozenset(), True)
2265. 
2266.     def add_deferred_loading(self, field_names):
2267.         """
2268.         Add the given list of model field names to the set of fields to
2269.         exclude from loading from the database when automatic column selection
2270.         is done. Add the new field names to any existing field names that
2271.         are deferred (or removed from any existing field names that are marked
2272.         as the only ones for immediate loading).
2273.         """
2274.         # Fields on related models are stored in the literal double-underscore
2275.         # format, so that we can use a set datastructure. We do the foo__bar
2276.         # splitting and handling when computing the SQL column names (as part of
2277.         # get_columns()).
2278.         existing, defer = self.deferred_loading
2279.         if defer:
2280.             # Add to existing deferred names.
2281.             self.deferred_loading = existing.union(field_names), True
2282.         else:
2283.             # Remove names from the set of any existing "immediate load" names.
2284.             if new_existing := existing.difference(field_names):
2285.                 self.deferred_loading = new_existing, False
2286.             else:
2287.                 self.clear_deferred_loading()
2288.                 if new_only := set(field_names).difference(existing):
2289.                     self.deferred_loading = new_only, True
2290. 
2291.     def add_immediate_loading(self, field_names):
2292.         """
2293.         Add the given list of model field names to the set of fields to
2294.         retrieve when the SQL is executed ("immediate loading" fields). The
2295.         field names replace any existing immediate loading field names. If
2296.         there are field names already specified for deferred loading, remove
2297.         those names from the new field_names before storing the new names
2298.         for immediate loading. (That is, immediate loading overrides any
2299.         existing immediate values, but respects existing deferrals.)
2300.         """
2301.         existing, defer = self.deferred_loading
2302.         field_names = set(field_names)
2303.         if "pk" in field_names:
2304.             field_names.remove("pk")
2305.             field_names.add(self.get_meta().pk.name)
2306. 
2307.         if defer:
2308.             # Remove any existing deferred names from the current set before
2309.             # setting the new names.
2310.             self.deferred_loading = field_names.difference(existing), False
2311.         else:
2312.             # Replace any existing "immediate load" field names.
2313.             self.deferred_loading = frozenset(field_names), False
2314. 
2315.     def get_loaded_field_names(self):
2316.         """
2317.         If any fields are marked to be deferred, return a dictionary mapping
2318.         models to a set of names in those fields that will be loaded. If a
2319.         model is not in the returned dictionary, none of its fields are
2320.         deferred.
2321. 
2322.         If no fields are marked for deferral, return an empty dictionary.
2323.         """
2324.         # We cache this because we call this function multiple times
2325.         # (compiler.fill_related_selections, query.iterator)
2326.         try:
2327.             return self._loaded_field_names_cache
2328.         except AttributeError:
2329.             collection = {}
2330.             self.deferred_to_data(collection, self.get_loaded_field_names_cb)
2331.             self._loaded_field_names_cache = collection
2332.             return collection
2333. 
2334.     def get_loaded_field_names_cb(self, target, model, fields):
2335.         """Callback used by get_deferred_field_names()."""
2336.         target[model] = {f.attname for f in fields}
2337. 
2338.     def set_annotation_mask(self, names):
2339.         """Set the mask of annotations that will be returned by the SELECT."""
2340.         if names is None:
2341.             self.annotation_select_mask = None
2342.         else:
2343.             self.annotation_select_mask = set(names)
2344.         self._annotation_select_cache = None
2345. 
2346.     def append_annotation_mask(self, names):
2347.         if self.annotation_select_mask is not None:
2348.             self.set_annotation_mask(self.annotation_select_mask.union(names))
2349. 
2350.     def set_extra_mask(self, names):
2351.         """
2352.         Set the mask of extra select items that will be returned by SELECT.
2353.         Don't remove them from the Query since they might be used later.
2354.         """
2355.         if names is None:
2356.             self.extra_select_mask = None
2357.         else:
2358.             self.extra_select_mask = set(names)
2359.         self._extra_select_cache = None
2360. 
2361.     def set_values(self, fields):
2362.         self.select_related = False
2363.         self.clear_deferred_loading()
2364.         self.clear_select_fields()
2365. 
2366.         if fields:
2367.             field_names = []
2368.             extra_names = []
2369.             annotation_names = []
2370.             if not self.extra and not self.annotations:
2371.                 # Shortcut - if there are no extra or annotations, then
2372.                 # the values() clause must be just field names.
2373.                 field_names = list(fields)
2374.             else:
2375.                 self.default_cols = False
2376.                 for f in fields:
2377.                     if f in self.extra_select:
2378.                         extra_names.append(f)
2379.                     elif f in self.annotation_select:
2380.                         annotation_names.append(f)
2381.                     else:
2382.                         field_names.append(f)
2383.             self.set_extra_mask(extra_names)
2384.             self.set_annotation_mask(annotation_names)
2385.             selected = frozenset(field_names + extra_names + annotation_names)
2386.         else:
2387.             field_names = [f.attname for f in self.model._meta.concrete_fields]
2388.             selected = frozenset(field_names)
2389.         # Selected annotations must be known before setting the GROUP BY
2390.         # clause.
2391.         if self.group_by is True:
2392.             self.add_fields(
2393.                 (f.attname for f in self.model._meta.concrete_fields), False
2394.             )
2395.             # Disable GROUP BY aliases to avoid orphaning references to the
2396.             # SELECT clause which is about to be cleared.
2397.             self.set_group_by(allow_aliases=False)
2398.             self.clear_select_fields()
2399.         elif self.group_by:
2400.             # Resolve GROUP BY annotation references if they are not part of
2401.             # the selected fields anymore.
2402.             group_by = []
2403.             for expr in self.group_by:
2404.                 if isinstance(expr, Ref) and expr.refs not in selected:
2405.                     expr = self.annotations[expr.refs]
2406.                 group_by.append(expr)
2407.             self.group_by = tuple(group_by)
2408. 
2409.         self.values_select = tuple(field_names)
2410.         self.add_fields(field_names, True)
2411. 
2412.     @property
2413.     def annotation_select(self):
2414.         """
2415.         Return the dictionary of aggregate columns that are not masked and
2416.         should be used in the SELECT clause. Cache this result for performance.
2417.         """
2418.         if self._annotation_select_cache is not None:
2419.             return self._annotation_select_cache
2420.         elif not self.annotations:
2421.             return {}
2422.         elif self.annotation_select_mask is not None:
2423.             self._annotation_select_cache = {
2424.                 k: v
2425.                 for k, v in self.annotations.items()
2426.                 if k in self.annotation_select_mask
2427.             }
2428.             return self._annotation_select_cache
2429.         else:
2430.             return self.annotations
2431. 
2432.     @property
2433.     def extra_select(self):
2434.         if self._extra_select_cache is not None:
2435.             return self._extra_select_cache
2436.         if not self.extra:
2437.             return {}
2438.         elif self.extra_select_mask is not None:
2439.             self._extra_select_cache = {
2440.                 k: v for k, v in self.extra.items() if k in self.extra_select_mask
2441.             }
2442.             return self._extra_select_cache
2443.         else:
2444.             return self.extra
2445. 
2446.     def trim_start(self, names_with_path):
2447.         """
2448.         Trim joins from the start of the join path. The candidates for trim
2449.         are the PathInfos in names_with_path structure that are m2m joins.
2450. 
2451.         Also set the select column so the start matches the join.
2452. 
2453.         This method is meant to be used for generating the subquery joins &
2454.         cols in split_exclude().
2455. 
2456.         Return a lookup usable for doing outerq.filter(lookup=self) and a
2457.         boolean indicating if the joins in the prefix contain a LEFT OUTER join.
2458.         _"""
2459.         all_paths = []
2460.         for _, paths in names_with_path:
2461.             all_paths.extend(paths)
2462.         contains_louter = False
2463.         # Trim and operate only on tables that were generated for
2464.         # the lookup part of the query. That is, avoid trimming
2465.         # joins generated for F() expressions.
2466.         lookup_tables = [
2467.             t for t in self.alias_map if t in self._lookup_joins or t == self.base_table
2468.         ]
2469.         for trimmed_paths, path in enumerate(all_paths):
2470.             if path.m2m:
2471.                 break
2472.             if self.alias_map[lookup_tables[trimmed_paths + 1]].join_type == LOUTER:
2473.                 contains_louter = True
2474.             alias = lookup_tables[trimmed_paths]
2475.             self.unref_alias(alias)
2476.         # The path.join_field is a Rel, lets get the other side's field
2477.         join_field = path.join_field.field
2478.         # Build the filter prefix.
2479.         paths_in_prefix = trimmed_paths
2480.         trimmed_prefix = []
2481.         for name, path in names_with_path:
2482.             if paths_in_prefix - len(path) < 0:
2483.                 break
2484.             trimmed_prefix.append(name)
2485.             paths_in_prefix -= len(path)
2486.         trimmed_prefix.append(join_field.foreign_related_fields[0].name)
2487.         trimmed_prefix = LOOKUP_SEP.join(trimmed_prefix)
2488.         # Lets still see if we can trim the first join from the inner query
2489.         # (that is, self). We can't do this for:
2490.         # - LEFT JOINs because we would miss those rows that have nothing on
2491.         #   the outer side,
2492.         # - INNER JOINs from filtered relations because we would miss their
2493.         #   filters.
2494.         first_join = self.alias_map[lookup_tables[trimmed_paths + 1]]
2495.         if first_join.join_type != LOUTER and not first_join.filtered_relation:
2496.             select_fields = [r[0] for r in join_field.related_fields]
2497.             select_alias = lookup_tables[trimmed_paths + 1]
2498.             self.unref_alias(lookup_tables[trimmed_paths])
2499.             extra_restriction = join_field.get_extra_restriction(
2500.                 None, lookup_tables[trimmed_paths + 1]
2501.             )
2502.             if extra_restriction:
2503.                 self.where.add(extra_restriction, AND)
2504.         else:
2505.             # TODO: It might be possible to trim more joins from the start of the
2506.             # inner query if it happens to have a longer join chain containing the
2507.             # values in select_fields. Lets punt this one for now.
2508.             select_fields = [r[1] for r in join_field.related_fields]
2509.             select_alias = lookup_tables[trimmed_paths]
2510.         # The found starting point is likely a join_class instead of a
2511.         # base_table_class reference. But the first entry in the query's FROM
2512.         # clause must not be a JOIN.
2513.         for table in self.alias_map:
2514.             if self.alias_refcount[table] > 0:
2515.                 self.alias_map[table] = self.base_table_class(
2516.                     self.alias_map[table].table_name,
2517.                     table,
2518.                 )
2519.                 break
2520.         self.set_select([f.get_col(select_alias) for f in select_fields])
2521.         return trimmed_prefix, contains_louter
2522. 
2523.     def is_nullable(self, field):
2524.         """
2525.         Check if the given field should be treated as nullable.
2526. 
2527.         Some backends treat '' as null and Django treats such fields as
2528.         nullable for those backends. In such situations field.null can be
2529.         False even if we should treat the field as nullable.
2530.         """
2531.         # We need to use DEFAULT_DB_ALIAS here, as QuerySet does not have
2532.         # (nor should it have) knowledge of which connection is going to be
2533.         # used. The proper fix would be to defer all decisions where
2534.         # is_nullable() is needed to the compiler stage, but that is not easy
2535.         # to do currently.
2536.         return field.null or (
2537.             field.empty_strings_allowed
2538.             and connections[DEFAULT_DB_ALIAS].features.interprets_empty_strings_as_nulls
2539.         )
2540. 
2541. 
2542. def get_order_dir(field, default="ASC"):
2543.     """
2544.     Return the field name and direction for an order specification. For
2545.     example, '-foo' is returned as ('foo', 'DESC').
2546. 
2547.     The 'default' param is used to indicate which way no prefix (or a '+'
2548.     prefix) should sort. The '-' prefix always sorts the opposite way.
2549.     """
2550.     dirn = ORDER_DIR[default]
2551.     if field[0] == "-":
2552.         return field[1:], dirn[1]
2553.     return field, dirn[0]
2554. 
2555. 
2556. def add_to_dict(data, key, value):
2557.     """
2558.     Add "value" to the set of values for "key", whether or not "key" already
2559.     exists.
2560.     """
2561.     if key in data:
2562.         data[key].add(value)
2563.     else:
2564.         data[key] = {value}
2565. 
2566. 
2567. def is_reverse_o2o(field):
2568.     """
2569.     Check if the given field is reverse-o2o. The field is expected to be some
2570.     sort of relation field or related object.
2571.     """
2572.     return field.is_relation and field.one_to_one and not field.concrete
2573. 
2574. 
2575. class JoinPromoter:
2576.     """
2577.     A class to abstract away join promotion problems for complex filter
2578.     conditions.
2579.     """
2580. 
2581.     def __init__(self, connector, num_children, negated):
2582.         self.connector = connector
2583.         self.negated = negated
2584.         if self.negated:
2585.             if connector == AND:
2586.                 self.effective_connector = OR
2587.             else:
2588.                 self.effective_connector = AND
2589.         else:
2590.             self.effective_connector = self.connector
2591.         self.num_children = num_children
2592.         # Maps of table alias to how many times it is seen as required for
2593.         # inner and/or outer joins.
2594.         self.votes = Counter()
2595. 
2596.     def __repr__(self):
2597.         return (
2598.             f"{self.__class__.__qualname__}(connector={self.connector!r}, "
2599.             f"num_children={self.num_children!r}, negated={self.negated!r})"
2600.         )
2601. 
2602.     def add_votes(self, votes):
2603.         """
2604.         Add single vote per item to self.votes. Parameter can be any
2605.         iterable.
2606.         """
2607.         self.votes.update(votes)
2608. 
2609.     def update_join_types(self, query):
2610.         """
2611.         Change join types so that the generated query is as efficient as
2612.         possible, but still correct. So, change as many joins as possible
2613.         to INNER, but don't make OUTER joins INNER if that could remove
2614.         results from the query.
2615.         """
2616.         to_promote = set()
2617.         to_demote = set()
2618.         # The effective_connector is used so that NOT (a AND b) is treated
2619.         # similarly to (a OR b) for join promotion.
2620.         for table, votes in self.votes.items():
2621.             # We must use outer joins in OR case when the join isn't contained
2622.             # in all of the joins. Otherwise the INNER JOIN itself could remove
2623.             # valid results. Consider the case where a model with rel_a and
2624.             # rel_b relations is queried with rel_a__col=1 | rel_b__col=2. Now,
2625.             # if rel_a join doesn't produce any results is null (for example
2626.             # reverse foreign key or null value in direct foreign key), and
2627.             # there is a matching row in rel_b with col=2, then an INNER join
2628.             # to rel_a would remove a valid match from the query. So, we need
2629.             # to promote any existing INNER to LOUTER (it is possible this
2630.             # promotion in turn will be demoted later on).
2631.             if self.effective_connector == "OR" and votes < self.num_children:
2632.                 to_promote.add(table)
2633.             # If connector is AND and there is a filter that can match only
2634.             # when there is a joinable row, then use INNER. For example, in
2635.             # rel_a__col=1 & rel_b__col=2, if either of the rels produce NULL
2636.             # as join output, then the col=1 or col=2 can't match (as
2637.             # NULL=anything is always false).
2638.             # For the OR case, if all children voted for a join to be inner,
2639.             # then we can use INNER for the join. For example:
2640.             #     (rel_a__col__icontains=Alex | rel_a__col__icontains=Russell)
2641.             # then if rel_a doesn't produce any rows, the whole condition
2642.             # can't match. Hence we can safely use INNER join.
2643.             if self.effective_connector == "AND" or (
2644.                 self.effective_connector == "OR" and votes == self.num_children
2645.             ):
2646.                 to_demote.add(table)
2647.             # Finally, what happens in cases where we have:
2648.             #    (rel_a__col=1|rel_b__col=2) & rel_a__col__gte=0
2649.             # Now, we first generate the OR clause, and promote joins for it
2650.             # in the first if branch above. Both rel_a and rel_b are promoted
2651.             # to LOUTER joins. After that we do the AND case. The OR case
2652.             # voted no inner joins but the rel_a__col__gte=0 votes inner join
2653.             # for rel_a. We demote it back to INNER join (in AND case a single
2654.             # vote is enough). The demotion is OK, if rel_a doesn't produce
2655.             # rows, then the rel_a__col__gte=0 clause can't be true, and thus
2656.             # the whole clause must be false. So, it is safe to use INNER
2657.             # join.
2658.             # Note that in this example we could just as well have the __gte
2659.             # clause and the OR clause swapped. Or we could replace the __gte
2660.             # clause with an OR clause containing rel_a__col=1|rel_a__col=2,
2661.             # and again we could safely demote to INNER.
2662.         query.promote_joins(to_promote)
2663.         query.demote_joins(to_demote)
2664.         return to_demote

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 23:02:16,080 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's issue is centered around the usage of `FilteredRelation`. To fully understand the problem, I need the definition of the `FilteredRelation` class and its related expression classes (`F`, `Case`, `When`) which are present in the user's code example. This will clarify how `FilteredRelation` objects are constructed and what data they contain, which is crucial for understanding why they were not being distinguished correctly in the original `Join.equals` implementation." query='Please provide the full content of django/db/models/expressions.py.' extra_requirements='' purpose="I need to inspect the `FilteredRelation` class definition to understand its attributes and how it's handled as an expression within the ORM."
2025-12-24 23:02:16,081 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of django/db/models/expressions.py.
2025-12-24 23:02:16,081 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 23:02:16,081 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 23:02:16,082 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 23:02:16,082 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of django/db/models/expressions.py.
Purpose: I need to inspect the `FilteredRelation` class definition to understand its attributes and how it's handled as an expression within the ORM.
2025-12-24 23:02:19,191 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the `django/db/models/expressions.py` file. This will allow you to examine the `FilteredRelation` class and understand its implementation within the Django ORM.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/expressions.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2101, 'candidates_token_count': 66, 'total_token_count': 2394, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2101}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 66}], 'thoughts_token_count': 227, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2482713641542377, 'model_name': 'gemini-2.5-pro'} id='run--3eef1dbb-8ff0-452d-b240-942687ce0ee8-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/expressions.py'}, 'id': '2e7ad972-b330-437d-b21f-a611b9a8e570', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2101, 'output_tokens': 66, 'total_tokens': 2394, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 227}}
2025-12-24 23:02:23,019 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I was able to retrieve the first 500 lines of `django/db/models/expressions.py`. Since this did not contain the full file, I am now retrieving the file's metadata to determine its total length. This will allow me to subsequently fetch the entire file content for your inspection." additional_kwargs={'function_call': {'name': 'find_file_node_with_relative_path', 'arguments': '{"relative_path": "django/db/models/expressions.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8627, 'candidates_token_count': 86, 'total_token_count': 8910, 'cached_content_token_count': 1821, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8627}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1821}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 86}], 'thoughts_token_count': 197}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3059244821237963, 'model_name': 'gemini-2.5-pro'} id='run--9d7a17a4-6649-4dd6-8ecb-38320a8a7dc8-0' tool_calls=[{'name': 'find_file_node_with_relative_path', 'args': {'relative_path': 'django/db/models/expressions.py'}, 'id': '417b0642-6dda-4dd2-bdef-2ec3eb0fd31a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8627, 'output_tokens': 86, 'total_tokens': 8910, 'input_token_details': {'cache_read': 1821}, 'output_token_details': {'reasoning': 197}}
2025-12-24 23:02:33,681 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content="I have confirmed the file's existence and will now read its entire content in one go. This will provide you with the full source code of `django/db/models/expressions.py`, including the `FilteredRelation` class definition." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1.0, "relative_path": "django/db/models/expressions.py", "end_line": 1116.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8771, 'candidates_token_count': 78, 'total_token_count': 9832, 'cached_content_token_count': 7271, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8771}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7271}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 983}, 'finish_reason': 'STOP', 'avg_logprobs': -1.4640309260441706, 'model_name': 'gemini-2.5-pro'} id='run--79b90fb1-a75e-4195-8a51-895631c4d9f9-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1.0, 'relative_path': 'django/db/models/expressions.py', 'end_line': 1116.0}, 'id': '4ce415c0-7fb3-460a-b591-e79b574114bd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8771, 'output_tokens': 78, 'total_tokens': 9832, 'input_token_details': {'cache_read': 7271}, 'output_token_details': {'reasoning': 983}}
2025-12-24 23:02:42,909 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the entire content of `django/db/models/expressions.py` and located the `FilteredRelation` class definition. I will now provide the definition of the `FilteredRelation` class as requested.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1117.0, "end_line": 1189.0, "relative_path": "django/db/models/expressions.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 23818, 'candidates_token_count': 74, 'total_token_count': 24778, 'cached_content_token_count': 7678, 'prompt_tokens_details': [{'modality': 1, 'token_count': 23818}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7678}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 74}], 'thoughts_token_count': 886}, 'finish_reason': 'STOP', 'avg_logprobs': -1.2408744193412162, 'model_name': 'gemini-2.5-pro'} id='run--2456963a-05ca-493b-bf78-baa6fb404c27-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 1117.0, 'end_line': 1189.0, 'relative_path': 'django/db/models/expressions.py'}, 'id': 'f3810cf7-c3fa-4cca-a54d-39640dd547cb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 23818, 'output_tokens': 74, 'total_tokens': 24778, 'input_token_details': {'cache_read': 7678}, 'output_token_details': {'reasoning': 886}}
2025-12-24 23:02:48,665 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now retrieved the full content of `django/db/models/expressions.py`. After a thorough review, I can confirm that the `FilteredRelation` class is not defined within this file. To locate the correct file containing the class definition, I will now search the entire codebase for the `FilteredRelation` class.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_basename', 'arguments': '{"basename": "expressions.py", "type": "class_definition"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 25063, 'candidates_token_count': 91, 'total_token_count': 25581, 'cached_content_token_count': 23034, 'prompt_tokens_details': [{'modality': 1, 'token_count': 25063}], 'cache_tokens_details': [{'modality': 1, 'token_count': 23034}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 91}], 'thoughts_token_count': 427}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7930479783278245, 'model_name': 'gemini-2.5-pro'} id='run--3b00f4e3-74c0-4386-957a-a34fae03bb50-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_basename', 'args': {'basename': 'expressions.py', 'type': 'class_definition'}, 'id': 'db080431-1941-4acf-8022-3320dae5fcd3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 25063, 'output_tokens': 91, 'total_tokens': 25581, 'input_token_details': {'cache_read': 23034}, 'output_token_details': {'reasoning': 427}}
2025-12-24 23:02:51,334 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have now confirmed that `FilteredRelation` is not in `django/db/models/expressions.py` and broadened my search to other `expressions.py` files, which also did not contain the class. To locate the `FilteredRelation` class, I will now search for the text "class FilteredRelation" across the entire codebase. This will ensure I find the correct file and can then provide you with the class definition.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "class FilteredRelation"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 25982, 'candidates_token_count': 111, 'total_token_count': 26183, 'cached_content_token_count': 24881, 'prompt_tokens_details': [{'modality': 1, 'token_count': 25982}], 'cache_tokens_details': [{'modality': 1, 'token_count': 24881}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 111}], 'thoughts_token_count': 90}, 'finish_reason': 'STOP', 'avg_logprobs': -0.20870732831525374, 'model_name': 'gemini-2.5-pro'} id='run--fc0e9141-3f3b-4f23-a6f4-83c9419cd932-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'class FilteredRelation'}, 'id': '56e2bcc6-7ba4-48ce-b066-e3836d9596db', 'type': 'tool_call'}] usage_metadata={'input_tokens': 25982, 'output_tokens': 111, 'total_tokens': 26183, 'input_token_details': {'cache_read': 24881}, 'output_token_details': {'reasoning': 90}}
2025-12-24 23:02:55,121 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I apologize for the error in my previous attempt. I have now corrected my approach and am searching the entire codebase for the text "FilteredRelation" to locate the file containing the class definition. This will allow me to provide you with the correct and complete definition of the `FilteredRelation` class as you requested.' additional_kwargs={'function_call': {'name': 'find_text_node_with_text', 'arguments': '{"text": "FilteredRelation"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 26153, 'candidates_token_count': 74, 'total_token_count': 26459, 'cached_content_token_count': 24860, 'prompt_tokens_details': [{'modality': 1, 'token_count': 26153}], 'cache_tokens_details': [{'modality': 1, 'token_count': 24860}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 74}], 'thoughts_token_count': 232}, 'finish_reason': 'STOP', 'avg_logprobs': -0.41343168310216954, 'model_name': 'gemini-2.5-pro'} id='run--84fe9dd8-eb9a-4cbc-80ad-c24f0cda1bb3-0' tool_calls=[{'name': 'find_text_node_with_text', 'args': {'text': 'FilteredRelation'}, 'id': '1dee1e46-dd52-48e3-9ed9-e0b54c62f38b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 26153, 'output_tokens': 74, 'total_tokens': 26459, 'input_token_details': {'cache_read': 24860}, 'output_token_details': {'reasoning': 232}}
2025-12-24 23:03:06,375 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully located the `FilteredRelation` class definition. It is not in `django/db/models/expressions.py`, but rather in a file I have now identified. I will now retrieve the full content of the correct file to provide you with the complete definition of the `FilteredRelation` class.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"basename": "query.py", "text": "class FilteredRelation"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 30036, 'candidates_token_count': 89, 'total_token_count': 31116, 'cached_content_token_count': 24996, 'prompt_tokens_details': [{'modality': 1, 'token_count': 30036}], 'cache_tokens_details': [{'modality': 1, 'token_count': 24996}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 89}], 'thoughts_token_count': 991}, 'finish_reason': 'STOP', 'avg_logprobs': -2.1185878796523876, 'model_name': 'gemini-2.5-pro'} id='run--f783b92f-066a-4e48-8e75-55392e378ca5-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'basename': 'query.py', 'text': 'class FilteredRelation'}, 'id': 'f7067f4c-f724-4031-8cdd-86301b7aaf0f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 30036, 'output_tokens': 89, 'total_tokens': 31116, 'input_token_details': {'cache_read': 24996}, 'output_token_details': {'reasoning': 991}}
2025-12-24 23:03:14,266 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I apologize for the continued difficulty in locating the `FilteredRelation` class. My previous searches were not as efficient as they should have been. I have now located the class definition within the `django/db/models/query.py` file and will provide you with its full content.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 125.0, "relative_path": "django/db/models/query.py", "end_line": 137.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 30155, 'candidates_token_count': 87, 'total_token_count': 30919, 'cached_content_token_count': 28817, 'prompt_tokens_details': [{'modality': 1, 'token_count': 30155}], 'cache_tokens_details': [{'modality': 1, 'token_count': 28817}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 87}], 'thoughts_token_count': 677}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1755214998091774, 'model_name': 'gemini-2.5-pro'} id='run--5105bb94-bd4e-4450-9b06-245c104d0b60-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 125.0, 'relative_path': 'django/db/models/query.py', 'end_line': 137.0}, 'id': 'ff694a72-228f-4537-9abc-76957034b190', 'type': 'tool_call'}] usage_metadata={'input_tokens': 30155, 'output_tokens': 87, 'total_tokens': 30919, 'input_token_details': {'cache_read': 28817}, 'output_token_details': {'reasoning': 677}}
2025-12-24 23:03:18,642 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I apologize for the continued difficulties. It appears I have been searching in the incorrect locations. I will now retrieve the full content of `django/db/models/query.py` to finally locate and provide you with the definition of the `FilteredRelation` class.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/query.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 30491, 'candidates_token_count': 77, 'total_token_count': 30837, 'cached_content_token_count': 28788, 'prompt_tokens_details': [{'modality': 1, 'token_count': 30491}], 'cache_tokens_details': [{'modality': 1, 'token_count': 28788}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 77}], 'thoughts_token_count': 269}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7183172052556818, 'model_name': 'gemini-2.5-pro'} id='run--c9f89a7d-c3c0-49d0-8fb5-9d8c2047d22f-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/query.py'}, 'id': '71aff11a-cbda-445a-a470-8540d005c1b7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 30491, 'output_tokens': 77, 'total_tokens': 30837, 'input_token_details': {'cache_read': 28788}, 'output_token_details': {'reasoning': 269}}
2025-12-24 23:03:22,030 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I apologize for the repeated errors in my attempts to locate the `FilteredRelation` class. I have now identified the correct file, `django/db/models/query_utils.py`, and will retrieve its contents to provide you with the class definition.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "django/db/models/query_utils.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 37308, 'candidates_token_count': 77, 'total_token_count': 37591, 'cached_content_token_count': 28964, 'prompt_tokens_details': [{'modality': 1, 'token_count': 37308}], 'cache_tokens_details': [{'modality': 1, 'token_count': 28964}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 77}], 'thoughts_token_count': 206}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3761747038209593, 'model_name': 'gemini-2.5-pro'} id='run--1a144a35-fbae-456d-80f6-f3b25a853a4e-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'django/db/models/query_utils.py'}, 'id': '6acd8ff4-2f2c-47d2-baad-9a508b02ee9c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 37308, 'output_tokens': 77, 'total_tokens': 37591, 'input_token_details': {'cache_read': 28964}, 'output_token_details': {'reasoning': 206}}
2025-12-24 23:03:30,984 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='After a few incorrect attempts, I have located the `FilteredRelation` class in `django/db/models/query_utils.py`. I apologize for the incorrect path provided in the initial query. Below is the full definition of the class, which is used to specify custom filtering in the `ON` clause of SQL joins.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 301.0, "end_line": 341.0, "relative_path": "django/db/models/query_utils.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 42060, 'candidates_token_count': 98, 'total_token_count': 43037, 'cached_content_token_count': 36782, 'prompt_tokens_details': [{'modality': 1, 'token_count': 42060}], 'cache_tokens_details': [{'modality': 1, 'token_count': 36782}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 98}], 'thoughts_token_count': 879}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7867935336365992, 'model_name': 'gemini-2.5-pro'} id='run--a9565585-b530-4239-8ac8-9b1f354de770-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 301.0, 'end_line': 341.0, 'relative_path': 'django/db/models/query_utils.py'}, 'id': 'e24ec223-9584-49e2-aee4-01b918c5d03d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 42060, 'output_tokens': 98, 'total_tokens': 43037, 'input_token_details': {'cache_read': 36782}, 'output_token_details': {'reasoning': 879}}
2025-12-24 23:03:45,492 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I am sorry for the series of incorrect assumptions that led to the prolonged search. After correcting my search path, I have successfully located the `FilteredRelation` class definition in the `django/db/models/query_utils.py` file.\n\nHere is the complete definition of the `FilteredRelation` class:\n\n```python\nclass FilteredRelation:\n    """Specify custom filtering in the ON clause of SQL joins."""\n\n    def __init__(self, relation_name, *, condition=Q()):\n        if not relation_name:\n            raise ValueError("relation_name cannot be empty.")\n        self.relation_name = relation_name\n        self.alias = None\n        if not isinstance(condition, Q):\n            raise ValueError("condition argument must be a Q() instance.")\n        self.condition = condition\n        self.path = []\n\n    def __eq__(self, other):\n        if not isinstance(other, self.__class__):\n            return NotImplemented\n        return (\n            self.relation_name == other.relation_name\n            and self.alias == other.alias\n            and self.condition == other.condition\n        )\n\n    def clone(self):\n        clone = FilteredRelation(self.relation_name, condition=self.condition)\n        clone.alias = self.alias\n        clone.path = self.path[:]\n        return clone\n\n    def resolve_expression(self, *args, **kwargs):\n        """\n        QuerySet.annotate() only accepts expression-like arguments\n        (with a resolve_expression() method).\n        """\n        raise NotImplementedError("FilteredRelation.resolve_expression() is unused.")\n\n    def as_sql(self, compiler, connection):\n        # Resolve the condition in Join.filtered_relation.\n        query = compiler.query\n        where = query.build_filtered_relation_q(self.condition, reuse=set(self.path))\n        return compiler.compile(where)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 5037, 'end_index': 6527, 'uri': 'https://github.com/django/django', 'license_': 'BSD-3-Clause', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 42794, 'candidates_token_count': 428, 'total_token_count': 44577, 'cached_content_token_count': 40625, 'prompt_tokens_details': [{'modality': 1, 'token_count': 42794}], 'cache_tokens_details': [{'modality': 1, 'token_count': 40625}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 428}], 'thoughts_token_count': 1355}, 'finish_reason': 'STOP', 'avg_logprobs': -0.27129342622846087, 'model_name': 'gemini-2.5-pro'} id='run--d7af1432-d21d-4515-a5a7-09518b942440-0' usage_metadata={'input_tokens': 42794, 'output_tokens': 428, 'total_tokens': 44577, 'input_token_details': {'cache_read': 40625}, 'output_token_details': {'reasoning': 1355}}
2025-12-24 23:03:45,494 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of django/db/models/expressions.py.
--- END QUERY ---



--- BEGIN PURPOSE ---
I need to inspect the `FilteredRelation` class definition to understand its attributes and how it's handled as an expression within the ORM.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: django/contrib/postgres/expressions.py
Line number range: 6 - 14
Content:
class ArraySubquery(Subquery):
    template = "ARRAY(%(subquery)s)"

    def __init__(self, queryset, **kwargs):
        super().__init__(queryset, **kwargs)

    @cached_property
    def output_field(self):
        return ArrayField(self.query.output_field)


File: django/db/models/expressions.py
Line number range: 1 - 1116
Content:
1. import copy
2. import datetime
3. import functools
4. import inspect
5. from decimal import Decimal
6. from uuid import UUID
7. 
8. from django.core.exceptions import EmptyResultSet, FieldError
9. from django.db import DatabaseError, NotSupportedError, connection
10. from django.db.models import fields
11. from django.db.models.constants import LOOKUP_SEP
12. from django.db.models.query_utils import Q
13. from django.utils.deconstruct import deconstructible
14. from django.utils.functional import cached_property
15. from django.utils.hashable import make_hashable
16. 
17. 
18. class SQLiteNumericMixin:
19.     """
20.     Some expressions with output_field=DecimalField() must be cast to
21.     numeric to be properly filtered.
22.     """
23. 
24.     def as_sqlite(self, compiler, connection, **extra_context):
25.         sql, params = self.as_sql(compiler, connection, **extra_context)
26.         try:
27.             if self.output_field.get_internal_type() == "DecimalField":
28.                 sql = "CAST(%s AS NUMERIC)" % sql
29.         except FieldError:
30.             pass
31.         return sql, params
32. 
33. 
34. class Combinable:
35.     """
36.     Provide the ability to combine one or two objects with
37.     some connector. For example F('foo') + F('bar').
38.     """
39. 
40.     # Arithmetic connectors
41.     ADD = "+"
42.     SUB = "-"
43.     MUL = "*"
44.     DIV = "/"
45.     POW = "^"
46.     # The following is a quoted % operator - it is quoted because it can be
47.     # used in strings that also have parameter substitution.
48.     MOD = "%%"
49. 
50.     # Bitwise operators - note that these are generated by .bitand()
51.     # and .bitor(), the '&' and '|' are reserved for boolean operator
52.     # usage.
53.     BITAND = "&"
54.     BITOR = "|"
55.     BITLEFTSHIFT = "<<"
56.     BITRIGHTSHIFT = ">>"
57.     BITXOR = "#"
58. 
59.     def _combine(self, other, connector, reversed):
60.         if not hasattr(other, "resolve_expression"):
61.             # everything must be resolvable to an expression
62.             other = Value(other)
63. 
64.         if reversed:
65.             return CombinedExpression(other, connector, self)
66.         return CombinedExpression(self, connector, other)
67. 
68.     #############
69.     # OPERATORS #
70.     #############
71. 
72.     def __neg__(self):
73.         return self._combine(-1, self.MUL, False)
74. 
75.     def __add__(self, other):
76.         return self._combine(other, self.ADD, False)
77. 
78.     def __sub__(self, other):
79.         return self._combine(other, self.SUB, False)
80. 
81.     def __mul__(self, other):
82.         return self._combine(other, self.MUL, False)
83. 
84.     def __truediv__(self, other):
85.         return self._combine(other, self.DIV, False)
86. 
87.     def __mod__(self, other):
88.         return self._combine(other, self.MOD, False)
89. 
90.     def __pow__(self, other):
91.         return self._combine(other, self.POW, False)
92. 
93.     def __and__(self, other):
94.         if getattr(self, "conditional", False) and getattr(other, "conditional", False):
95.             return Q(self) & Q(other)
96.         raise NotImplementedError(
97.             "Use .bitand(), .bitor(), and .bitxor() for bitwise logical operations."
98.         )
99. 
100.     def bitand(self, other):
101.         return self._combine(other, self.BITAND, False)
102. 
103.     def bitleftshift(self, other):
104.         return self._combine(other, self.BITLEFTSHIFT, False)
105. 
106.     def bitrightshift(self, other):
107.         return self._combine(other, self.BITRIGHTSHIFT, False)
108. 
109.     def __xor__(self, other):
110.         if getattr(self, "conditional", False) and getattr(other, "conditional", False):
111.             return Q(self) ^ Q(other)
112.         raise NotImplementedError(
113.             "Use .bitand(), .bitor(), and .bitxor() for bitwise logical operations."
114.         )
115. 
116.     def bitxor(self, other):
117.         return self._combine(other, self.BITXOR, False)
118. 
119.     def __or__(self, other):
120.         if getattr(self, "conditional", False) and getattr(other, "conditional", False):
121.             return Q(self) | Q(other)
122.         raise NotImplementedError(
123.             "Use .bitand(), .bitor(), and .bitxor() for bitwise logical operations."
124.         )
125. 
126.     def bitor(self, other):
127.         return self._combine(other, self.BITOR, False)
128. 
129.     def __radd__(self, other):
130.         return self._combine(other, self.ADD, True)
131. 
132.     def __rsub__(self, other):
133.         return self._combine(other, self.SUB, True)
134. 
135.     def __rmul__(self, other):
136.         return self._combine(other, self.MUL, True)
137. 
138.     def __rtruediv__(self, other):
139.         return self._combine(other, self.DIV, True)
140. 
141.     def __rmod__(self, other):
142.         return self._combine(other, self.MOD, True)
143. 
144.     def __rpow__(self, other):
145.         return self._combine(other, self.POW, True)
146. 
147.     def __rand__(self, other):
148.         raise NotImplementedError(
149.             "Use .bitand(), .bitor(), and .bitxor() for bitwise logical operations."
150.         )
151. 
152.     def __ror__(self, other):
153.         raise NotImplementedError(
154.             "Use .bitand(), .bitor(), and .bitxor() for bitwise logical operations."
155.         )
156. 
157.     def __rxor__(self, other):
158.         raise NotImplementedError(
159.             "Use .bitand(), .bitor(), and .bitxor() for bitwise logical operations."
160.         )
161. 
162. 
163. class BaseExpression:
164.     """Base class for all query expressions."""
165. 
166.     empty_result_set_value = NotImplemented
167.     # aggregate specific fields
168.     is_summary = False
169.     _output_field_resolved_to_none = False
170.     # Can the expression be used in a WHERE clause?
171.     filterable = True
172.     # Can the expression can be used as a source expression in Window?
173.     window_compatible = False
174. 
175.     def __init__(self, output_field=None):
176.         if output_field is not None:
177.             self.output_field = output_field
178. 
179.     def __getstate__(self):
180.         state = self.__dict__.copy()
181.         state.pop("convert_value", None)
182.         return state
183. 
184.     def get_db_converters(self, connection):
185.         return (
186.             []
187.             if self.convert_value is self._convert_value_noop
188.             else [self.convert_value]
189.         ) + self.output_field.get_db_converters(connection)
190. 
191.     def get_source_expressions(self):
192.         return []
193. 
194.     def set_source_expressions(self, exprs):
195.         assert not exprs
196. 
197.     def _parse_expressions(self, *expressions):
198.         return [
199.             arg
200.             if hasattr(arg, "resolve_expression")
201.             else (F(arg) if isinstance(arg, str) else Value(arg))
202.             for arg in expressions
203.         ]
204. 
205.     def as_sql(self, compiler, connection):
206.         """
207.         Responsible for returning a (sql, [params]) tuple to be included
208.         in the current query.
209. 
210.         Different backends can provide their own implementation, by
211.         providing an `as_{vendor}` method and patching the Expression:
212. 
213.         ```
214.         def override_as_sql(self, compiler, connection):
215.             # custom logic
216.             return super().as_sql(compiler, connection)
217.         setattr(Expression, 'as_' + connection.vendor, override_as_sql)
218.         ```
219. 
220.         Arguments:
221.          * compiler: the query compiler responsible for generating the query.
222.            Must have a compile method, returning a (sql, [params]) tuple.
223.            Calling compiler(value) will return a quoted `value`.
224. 
225.          * connection: the database connection used for the current query.
226. 
227.         Return: (sql, params)
228.           Where `sql` is a string containing ordered sql parameters to be
229.           replaced with the elements of the list `params`.
230.         """
231.         raise NotImplementedError("Subclasses must implement as_sql()")
232. 
233.     @cached_property
234.     def contains_aggregate(self):
235.         return any(
236.             expr and expr.contains_aggregate for expr in self.get_source_expressions()
237.         )
238. 
239.     @cached_property
240.     def contains_over_clause(self):
241.         return any(
242.             expr and expr.contains_over_clause for expr in self.get_source_expressions()
243.         )
244. 
245.     @cached_property
246.     def contains_column_references(self):
247.         return any(
248.             expr and expr.contains_column_references
249.             for expr in self.get_source_expressions()
250.         )
251. 
252.     def resolve_expression(
253.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
254.     ):
255.         """
256.         Provide the chance to do any preprocessing or validation before being
257.         added to the query.
258. 
259.         Arguments:
260.          * query: the backend query implementation
261.          * allow_joins: boolean allowing or denying use of joins
262.            in this query
263.          * reuse: a set of reusable joins for multijoins
264.          * summarize: a terminal aggregate clause
265.          * for_save: whether this expression about to be used in a save or update
266. 
267.         Return: an Expression to be added to the query.
268.         """
269.         c = self.copy()
270.         c.is_summary = summarize
271.         c.set_source_expressions(
272.             [
273.                 expr.resolve_expression(query, allow_joins, reuse, summarize)
274.                 if expr
275.                 else None
276.                 for expr in c.get_source_expressions()
277.             ]
278.         )
279.         return c
280. 
281.     @property
282.     def conditional(self):
283.         return isinstance(self.output_field, fields.BooleanField)
284. 
285.     @property
286.     def field(self):
287.         return self.output_field
288. 
289.     @cached_property
290.     def output_field(self):
291.         """Return the output type of this expressions."""
292.         output_field = self._resolve_output_field()
293.         if output_field is None:
294.             self._output_field_resolved_to_none = True
295.             raise FieldError("Cannot resolve expression type, unknown output_field")
296.         return output_field
297. 
298.     @cached_property
299.     def _output_field_or_none(self):
300.         """
301.         Return the output field of this expression, or None if
302.         _resolve_output_field() didn't return an output type.
303.         """
304.         try:
305.             return self.output_field
306.         except FieldError:
307.             if not self._output_field_resolved_to_none:
308.                 raise
309. 
310.     def _resolve_output_field(self):
311.         """
312.         Attempt to infer the output type of the expression. If the output
313.         fields of all source fields match then, simply infer the same type
314.         here. This isn't always correct, but it makes sense most of the time.
315. 
316.         Consider the difference between `2 + 2` and `2 / 3`. Inferring
317.         the type here is a convenience for the common case. The user should
318.         supply their own output_field with more complex computations.
319. 
320.         If a source's output field resolves to None, exclude it from this check.
321.         If all sources are None, then an error is raised higher up the stack in
322.         the output_field property.
323.         """
324.         sources_iter = (
325.             source for source in self.get_source_fields() if source is not None
326.         )
327.         for output_field in sources_iter:
328.             for source in sources_iter:
329.                 if not isinstance(output_field, source.__class__):
330.                     raise FieldError(
331.                         "Expression contains mixed types: %s, %s. You must "
332.                         "set output_field."
333.                         % (
334.                             output_field.__class__.__name__,
335.                             source.__class__.__name__,
336.                         )
337.                     )
338.             return output_field
339. 
340.     @staticmethod
341.     def _convert_value_noop(value, expression, connection):
342.         return value
343. 
344.     @cached_property
345.     def convert_value(self):
346.         """
347.         Expressions provide their own converters because users have the option
348.         of manually specifying the output_field which may be a different type
349.         from the one the database returns.
350.         """
351.         field = self.output_field
352.         internal_type = field.get_internal_type()
353.         if internal_type == "FloatField":
354.             return (
355.                 lambda value, expression, connection: None
356.                 if value is None
357.                 else float(value)
358.             )
359.         elif internal_type.endswith("IntegerField"):
360.             return (
361.                 lambda value, expression, connection: None
362.                 if value is None
363.                 else int(value)
364.             )
365.         elif internal_type == "DecimalField":
366.             return (
367.                 lambda value, expression, connection: None
368.                 if value is None
369.                 else Decimal(value)
370.             )
371.         return self._convert_value_noop
372. 
373.     def get_lookup(self, lookup):
374.         return self.output_field.get_lookup(lookup)
375. 
376.     def get_transform(self, name):
377.         return self.output_field.get_transform(name)
378. 
379.     def relabeled_clone(self, change_map):
380.         clone = self.copy()
381.         clone.set_source_expressions(
382.             [
383.                 e.relabeled_clone(change_map) if e is not None else None
384.                 for e in self.get_source_expressions()
385.             ]
386.         )
387.         return clone
388. 
389.     def copy(self):
390.         return copy.copy(self)
391. 
392.     def get_group_by_cols(self, alias=None):
393.         if not self.contains_aggregate:
394.             return [self]
395.         cols = []
396.         for source in self.get_source_expressions():
397.             cols.extend(source.get_group_by_cols())
398.         return cols
399. 
400.     def get_source_fields(self):
401.         """Return the underlying field types used by this aggregate."""
402.         return [e._output_field_or_none for e in self.get_source_expressions()]
403. 
404.     def asc(self, **kwargs):
405.         return OrderBy(self, **kwargs)
406. 
407.     def desc(self, **kwargs):
408.         return OrderBy(self, descending=True, **kwargs)
409. 
410.     def reverse_ordering(self):
411.         return self
412. 
413.     def flatten(self):
414.         """
415.         Recursively yield this expression and all subexpressions, in
416.         depth-first order.
417.         """
418.         yield self
419.         for expr in self.get_source_expressions():
420.             if expr:
421.                 if hasattr(expr, "flatten"):
422.                     yield from expr.flatten()
423.                 else:
424.                     yield expr
425. 
426.     def select_format(self, compiler, sql, params):
427.         """
428.         Custom format for select clauses. For example, EXISTS expressions need
429.         to be wrapped in CASE WHEN on Oracle.
430.         """
431.         if hasattr(self.output_field, "select_format"):
432.             return self.output_field.select_format(compiler, sql, params)
433.         return sql, params
434. 
435. 
436. @deconstructible
437. class Expression(BaseExpression, Combinable):
438.     """An expression that can be combined with other expressions."""
439. 
440.     @cached_property
441.     def identity(self):
442.         constructor_signature = inspect.signature(self.__init__)
443.         args, kwargs = self._constructor_args
444.         signature = constructor_signature.bind_partial(*args, **kwargs)
445.         signature.apply_defaults()
446.         arguments = signature.arguments.items()
447.         identity = [self.__class__]
448.         for arg, value in arguments:
449.             if isinstance(value, fields.Field):
450.                 if value.name and value.model:
451.                     value = (value.model._meta.label, value.name)
452.                 else:
453.                     value = type(value)
454.             else:
455.                 value = make_hashable(value)
456.             identity.append((arg, value))
457.         return tuple(identity)
458. 
459.     def __eq__(self, other):
460.         if not isinstance(other, Expression):
461.             return NotImplemented
462.         return other.identity == self.identity
463. 
464.     def __hash__(self):
465.         return hash(self.identity)
466. 
467. 
468. _connector_combinators = {
469.     connector: [
470.         (fields.IntegerField, fields.IntegerField, fields.IntegerField),
471.         (fields.IntegerField, fields.DecimalField, fields.DecimalField),
472.         (fields.DecimalField, fields.IntegerField, fields.DecimalField),
473.         (fields.IntegerField, fields.FloatField, fields.FloatField),
474.         (fields.FloatField, fields.IntegerField, fields.FloatField),
475.     ]
476.     for connector in (Combinable.ADD, Combinable.SUB, Combinable.MUL, Combinable.DIV)
477. }
478. 
479. 
480. @functools.lru_cache(maxsize=128)
481. def _resolve_combined_type(connector, lhs_type, rhs_type):
482.     combinators = _connector_combinators.get(connector, ())
483.     for combinator_lhs_type, combinator_rhs_type, combined_type in combinators:
484.         if issubclass(lhs_type, combinator_lhs_type) and issubclass(
485.             rhs_type, combinator_rhs_type
486.         ):
487.             return combined_type
488. 
489. 
490. class CombinedExpression(SQLiteNumericMixin, Expression):
491.     def __init__(self, lhs, connector, rhs, output_field=None):
492.         super().__init__(output_field=output_field)
493.         self.connector = connector
494.         self.lhs = lhs
495.         self.rhs = rhs
496. 
497.     def __repr__(self):
498.         return "<{}: {}>".format(self.__class__.__name__, self)
499. 
500.     def __str__(self):
501.         return "{} {} {}".format(self.lhs, self.connector, self.rhs)
502. 
503.     def get_source_expressions(self):
504.         return [self.lhs, self.rhs]
505. 
506.     def set_source_expressions(self, exprs):
507.         self.lhs, self.rhs = exprs
508. 
509.     def _resolve_output_field(self):
510.         try:
511.             return super()._resolve_output_field()
512.         except FieldError:
513.             combined_type = _resolve_combined_type(
514.                 self.connector,
515.                 type(self.lhs.output_field),
516.                 type(self.rhs.output_field),
517.             )
518.             if combined_type is None:
519.                 raise
520.             return combined_type()
521. 
522.     def as_sql(self, compiler, connection):
523.         expressions = []
524.         expression_params = []
525.         sql, params = compiler.compile(self.lhs)
526.         expressions.append(sql)
527.         expression_params.extend(params)
528.         sql, params = compiler.compile(self.rhs)
529.         expressions.append(sql)
530.         expression_params.extend(params)
531.         # order of precedence
532.         expression_wrapper = "(%s)"
533.         sql = connection.ops.combine_expression(self.connector, expressions)
534.         return expression_wrapper % sql, expression_params
535. 
536.     def resolve_expression(
537.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
538.     ):
539.         lhs = self.lhs.resolve_expression(
540.             query, allow_joins, reuse, summarize, for_save
541.         )
542.         rhs = self.rhs.resolve_expression(
543.             query, allow_joins, reuse, summarize, for_save
544.         )
545.         if not isinstance(self, (DurationExpression, TemporalSubtraction)):
546.             try:
547.                 lhs_type = lhs.output_field.get_internal_type()
548.             except (AttributeError, FieldError):
549.                 lhs_type = None
550.             try:
551.                 rhs_type = rhs.output_field.get_internal_type()
552.             except (AttributeError, FieldError):
553.                 rhs_type = None
554.             if "DurationField" in {lhs_type, rhs_type} and lhs_type != rhs_type:
555.                 return DurationExpression(
556.                     self.lhs, self.connector, self.rhs
557.                 ).resolve_expression(
558.                     query,
559.                     allow_joins,
560.                     reuse,
561.                     summarize,
562.                     for_save,
563.                 )
564.             datetime_fields = {"DateField", "DateTimeField", "TimeField"}
565.             if (
566.                 self.connector == self.SUB
567.                 and lhs_type in datetime_fields
568.                 and lhs_type == rhs_type
569.             ):
570.                 return TemporalSubtraction(self.lhs, self.rhs).resolve_expression(
571.                     query,
572.                     allow_joins,
573.                     reuse,
574.                     summarize,
575.                     for_save,
576.                 )
577.         c = self.copy()
578.         c.is_summary = summarize
579.         c.lhs = lhs
580.         c.rhs = rhs
581.         return c
582. 
583. 
584. class DurationExpression(CombinedExpression):
585.     def compile(self, side, compiler, connection):
586.         try:
587.             output = side.output_field
588.         except FieldError:
589.             pass
590.         else:
591.             if output.get_internal_type() == "DurationField":
592.                 sql, params = compiler.compile(side)
593.                 return connection.ops.format_for_duration_arithmetic(sql), params
594.         return compiler.compile(side)
595. 
596.     def as_sql(self, compiler, connection):
597.         if connection.features.has_native_duration_field:
598.             return super().as_sql(compiler, connection)
599.         connection.ops.check_expression_support(self)
600.         expressions = []
601.         expression_params = []
602.         sql, params = self.compile(self.lhs, compiler, connection)
603.         expressions.append(sql)
604.         expression_params.extend(params)
605.         sql, params = self.compile(self.rhs, compiler, connection)
606.         expressions.append(sql)
607.         expression_params.extend(params)
608.         # order of precedence
609.         expression_wrapper = "(%s)"
610.         sql = connection.ops.combine_duration_expression(self.connector, expressions)
611.         return expression_wrapper % sql, expression_params
612. 
613.     def as_sqlite(self, compiler, connection, **extra_context):
614.         sql, params = self.as_sql(compiler, connection, **extra_context)
615.         if self.connector in {Combinable.MUL, Combinable.DIV}:
616.             try:
617.                 lhs_type = self.lhs.output_field.get_internal_type()
618.                 rhs_type = self.rhs.output_field.get_internal_type()
619.             except (AttributeError, FieldError):
620.                 pass
621.             else:
622.                 allowed_fields = {
623.                     "DecimalField",
624.                     "DurationField",
625.                     "FloatField",
626.                     "IntegerField",
627.                 }
628.                 if lhs_type not in allowed_fields or rhs_type not in allowed_fields:
629.                     raise DatabaseError(
630.                         f"Invalid arguments for operator {self.connector}."
631.                     )
632.         return sql, params
633. 
634. 
635. class TemporalSubtraction(CombinedExpression):
636.     output_field = fields.DurationField()
637. 
638.     def __init__(self, lhs, rhs):
639.         super().__init__(lhs, self.SUB, rhs)
640. 
641.     def as_sql(self, compiler, connection):
642.         connection.ops.check_expression_support(self)
643.         lhs = compiler.compile(self.lhs)
644.         rhs = compiler.compile(self.rhs)
645.         return connection.ops.subtract_temporals(
646.             self.lhs.output_field.get_internal_type(), lhs, rhs
647.         )
648. 
649. 
650. @deconstructible(path="django.db.models.F")
651. class F(Combinable):
652.     """An object capable of resolving references to existing query objects."""
653. 
654.     def __init__(self, name):
655.         """
656.         Arguments:
657.          * name: the name of the field this expression references
658.         """
659.         self.name = name
660. 
661.     def __repr__(self):
662.         return "{}({})".format(self.__class__.__name__, self.name)
663. 
664.     def resolve_expression(
665.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
666.     ):
667.         return query.resolve_ref(self.name, allow_joins, reuse, summarize)
668. 
669.     def asc(self, **kwargs):
670.         return OrderBy(self, **kwargs)
671. 
672.     def desc(self, **kwargs):
673.         return OrderBy(self, descending=True, **kwargs)
674. 
675.     def __eq__(self, other):
676.         return self.__class__ == other.__class__ and self.name == other.name
677. 
678.     def __hash__(self):
679.         return hash(self.name)
680. 
681. 
682. class ResolvedOuterRef(F):
683.     """
684.     An object that contains a reference to an outer query.
685. 
686.     In this case, the reference to the outer query has been resolved because
687.     the inner query has been used as a subquery.
688.     """
689. 
690.     contains_aggregate = False
691. 
692.     def as_sql(self, *args, **kwargs):
693.         raise ValueError(
694.             "This queryset contains a reference to an outer query and may "
695.             "only be used in a subquery."
696.         )
697. 
698.     def resolve_expression(self, *args, **kwargs):
699.         col = super().resolve_expression(*args, **kwargs)
700.         # FIXME: Rename possibly_multivalued to multivalued and fix detection
701.         # for non-multivalued JOINs (e.g. foreign key fields). This should take
702.         # into account only many-to-many and one-to-many relationships.
703.         col.possibly_multivalued = LOOKUP_SEP in self.name
704.         return col
705. 
706.     def relabeled_clone(self, relabels):
707.         return self
708. 
709.     def get_group_by_cols(self, alias=None):
710.         return []
711. 
712. 
713. class OuterRef(F):
714.     contains_aggregate = False
715. 
716.     def resolve_expression(self, *args, **kwargs):
717.         if isinstance(self.name, self.__class__):
718.             return self.name
719.         return ResolvedOuterRef(self.name)
720. 
721.     def relabeled_clone(self, relabels):
722.         return self
723. 
724. 
725. @deconstructible(path="django.db.models.Func")
726. class Func(SQLiteNumericMixin, Expression):
727.     """An SQL function call."""
728. 
729.     function = None
730.     template = "%(function)s(%(expressions)s)"
731.     arg_joiner = ", "
732.     arity = None  # The number of arguments the function accepts.
733. 
734.     def __init__(self, *expressions, output_field=None, **extra):
735.         if self.arity is not None and len(expressions) != self.arity:
736.             raise TypeError(
737.                 "'%s' takes exactly %s %s (%s given)"
738.                 % (
739.                     self.__class__.__name__,
740.                     self.arity,
741.                     "argument" if self.arity == 1 else "arguments",
742.                     len(expressions),
743.                 )
744.             )
745.         super().__init__(output_field=output_field)
746.         self.source_expressions = self._parse_expressions(*expressions)
747.         self.extra = extra
748. 
749.     def __repr__(self):
750.         args = self.arg_joiner.join(str(arg) for arg in self.source_expressions)
751.         extra = {**self.extra, **self._get_repr_options()}
752.         if extra:
753.             extra = ", ".join(
754.                 str(key) + "=" + str(val) for key, val in sorted(extra.items())
755.             )
756.             return "{}({}, {})".format(self.__class__.__name__, args, extra)
757.         return "{}({})".format(self.__class__.__name__, args)
758. 
759.     def _get_repr_options(self):
760.         """Return a dict of extra __init__() options to include in the repr."""
761.         return {}
762. 
763.     def get_source_expressions(self):
764.         return self.source_expressions
765. 
766.     def set_source_expressions(self, exprs):
767.         self.source_expressions = exprs
768. 
769.     def resolve_expression(
770.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
771.     ):
772.         c = self.copy()
773.         c.is_summary = summarize
774.         for pos, arg in enumerate(c.source_expressions):
775.             c.source_expressions[pos] = arg.resolve_expression(
776.                 query, allow_joins, reuse, summarize, for_save
777.             )
778.         return c
779. 
780.     def as_sql(
781.         self,
782.         compiler,
783.         connection,
784.         function=None,
785.         template=None,
786.         arg_joiner=None,
787.         **extra_context,
788.     ):
789.         connection.ops.check_expression_support(self)
790.         sql_parts = []
791.         params = []
792.         for arg in self.source_expressions:
793.             try:
794.                 arg_sql, arg_params = compiler.compile(arg)
795.             except EmptyResultSet:
796.                 empty_result_set_value = getattr(
797.                     arg, "empty_result_set_value", NotImplemented
798.                 )
799.                 if empty_result_set_value is NotImplemented:
800.                     raise
801.                 arg_sql, arg_params = compiler.compile(Value(empty_result_set_value))
802.             sql_parts.append(arg_sql)
803.             params.extend(arg_params)
804.         data = {**self.extra, **extra_context}
805.         # Use the first supplied value in this order: the parameter to this
806.         # method, a value supplied in __init__()'s **extra (the value in
807.         # `data`), or the value defined on the class.
808.         if function is not None:
809.             data["function"] = function
810.         else:
811.             data.setdefault("function", self.function)
812.         template = template or data.get("template", self.template)
813.         arg_joiner = arg_joiner or data.get("arg_joiner", self.arg_joiner)
814.         data["expressions"] = data["field"] = arg_joiner.join(sql_parts)
815.         return template % data, params
816. 
817.     def copy(self):
818.         copy = super().copy()
819.         copy.source_expressions = self.source_expressions[:]
820.         copy.extra = self.extra.copy()
821.         return copy
822. 
823. 
824. @deconstructible(path="django.db.models.Value")
825. class Value(SQLiteNumericMixin, Expression):
826.     """Represent a wrapped value as a node within an expression."""
827. 
828.     # Provide a default value for `for_save` in order to allow unresolved
829.     # instances to be compiled until a decision is taken in #25425.
830.     for_save = False
831. 
832.     def __init__(self, value, output_field=None):
833.         """
834.         Arguments:
835.          * value: the value this expression represents. The value will be
836.            added into the sql parameter list and properly quoted.
837. 
838.          * output_field: an instance of the model field type that this
839.            expression will return, such as IntegerField() or CharField().
840.         """
841.         super().__init__(output_field=output_field)
842.         self.value = value
843. 
844.     def __repr__(self):
845.         return f"{self.__class__.__name__}({self.value!r})"
846. 
847.     def as_sql(self, compiler, connection):
848.         connection.ops.check_expression_support(self)
849.         val = self.value
850.         output_field = self._output_field_or_none
851.         if output_field is not None:
852.             if self.for_save:
853.                 val = output_field.get_db_prep_save(val, connection=connection)
854.             else:
855.                 val = output_field.get_db_prep_value(val, connection=connection)
856.             if hasattr(output_field, "get_placeholder"):
857.                 return output_field.get_placeholder(val, compiler, connection), [val]
858.         if val is None:
859.             # cx_Oracle does not always convert None to the appropriate
860.             # NULL type (like in case expressions using numbers), so we
861.             # use a literal SQL NULL
862.             return "NULL", []
863.         return "%s", [val]
864. 
865.     def resolve_expression(
866.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
867.     ):
868.         c = super().resolve_expression(query, allow_joins, reuse, summarize, for_save)
869.         c.for_save = for_save
870.         return c
871. 
872.     def get_group_by_cols(self, alias=None):
873.         return []
874. 
875.     def _resolve_output_field(self):
876.         if isinstance(self.value, str):
877.             return fields.CharField()
878.         if isinstance(self.value, bool):
879.             return fields.BooleanField()
880.         if isinstance(self.value, int):
881.             return fields.IntegerField()
882.         if isinstance(self.value, float):
883.             return fields.FloatField()
884.         if isinstance(self.value, datetime.datetime):
885.             return fields.DateTimeField()
886.         if isinstance(self.value, datetime.date):
887.             return fields.DateField()
888.         if isinstance(self.value, datetime.time):
889.             return fields.TimeField()
890.         if isinstance(self.value, datetime.timedelta):
891.             return fields.DurationField()
892.         if isinstance(self.value, Decimal):
893.             return fields.DecimalField()
894.         if isinstance(self.value, bytes):
895.             return fields.BinaryField()
896.         if isinstance(self.value, UUID):
897.             return fields.UUIDField()
898. 
899.     @property
900.     def empty_result_set_value(self):
901.         return self.value
902. 
903. 
904. class RawSQL(Expression):
905.     def __init__(self, sql, params, output_field=None):
906.         if output_field is None:
907.             output_field = fields.Field()
908.         self.sql, self.params = sql, params
909.         super().__init__(output_field=output_field)
910. 
911.     def __repr__(self):
912.         return "{}({}, {})".format(self.__class__.__name__, self.sql, self.params)
913. 
914.     def as_sql(self, compiler, connection):
915.         return "(%s)" % self.sql, self.params
916. 
917.     def get_group_by_cols(self, alias=None):
918.         return [self]
919. 
920.     def resolve_expression(
921.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
922.     ):
923.         # Resolve parents fields used in raw SQL.
924.         if query.model:
925.             for parent in query.model._meta.get_parent_list():
926.                 for parent_field in parent._meta.local_fields:
927.                     _, column_name = parent_field.get_attname_column()
928.                     if column_name.lower() in self.sql.lower():
929.                         query.resolve_ref(
930.                             parent_field.name, allow_joins, reuse, summarize
931.                         )
932.                         break
933.         return super().resolve_expression(
934.             query, allow_joins, reuse, summarize, for_save
935.         )
936. 
937. 
938. class Star(Expression):
939.     def __repr__(self):
940.         return "'*'"
941. 
942.     def as_sql(self, compiler, connection):
943.         return "*", []
944. 
945. 
946. class Col(Expression):
947. 
948.     contains_column_references = True
949.     possibly_multivalued = False
950. 
951.     def __init__(self, alias, target, output_field=None):
952.         if output_field is None:
953.             output_field = target
954.         super().__init__(output_field=output_field)
955.         self.alias, self.target = alias, target
956. 
957.     def __repr__(self):
958.         alias, target = self.alias, self.target
959.         identifiers = (alias, str(target)) if alias else (str(target),)
960.         return "{}({})".format(self.__class__.__name__, ", ".join(identifiers))
961. 
962.     def as_sql(self, compiler, connection):
963.         alias, column = self.alias, self.target.column
964.         identifiers = (alias, column) if alias else (column,)
965.         sql = ".".join(map(compiler.quote_name_unless_alias, identifiers))
966.         return sql, []
967. 
968.     def relabeled_clone(self, relabels):
969.         if self.alias is None:
970.             return self
971.         return self.__class__(
972.             relabels.get(self.alias, self.alias), self.target, self.output_field
973.         )
974. 
975.     def get_group_by_cols(self, alias=None):
976.         return [self]
977. 
978.     def get_db_converters(self, connection):
979.         if self.target == self.output_field:
980.             return self.output_field.get_db_converters(connection)
981.         return self.output_field.get_db_converters(
982.             connection
983.         ) + self.target.get_db_converters(connection)
984. 
985. 
986. class Ref(Expression):
987.     """
988.     Reference to column alias of the query. For example, Ref('sum_cost') in
989.     qs.annotate(sum_cost=Sum('cost')) query.
990.     """
991. 
992.     def __init__(self, refs, source):
993.         super().__init__()
994.         self.refs, self.source = refs, source
995. 
996.     def __repr__(self):
997.         return "{}({}, {})".format(self.__class__.__name__, self.refs, self.source)
998. 
999.     def get_source_expressions(self):
1000.         return [self.source]
1001. 
1002.     def set_source_expressions(self, exprs):
1003.         (self.source,) = exprs
1004. 
1005.     def resolve_expression(
1006.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
1007.     ):
1008.         # The sub-expression `source` has already been resolved, as this is
1009.         # just a reference to the name of `source`.
1010.         return self
1011. 
1012.     def relabeled_clone(self, relabels):
1013.         return self
1014. 
1015.     def as_sql(self, compiler, connection):
1016.         return connection.ops.quote_name(self.refs), []
1017. 
1018.     def get_group_by_cols(self, alias=None):
1019.         return [self]
1020. 
1021. 
1022. class ExpressionList(Func):
1023.     """
1024.     An expression containing multiple expressions. Can be used to provide a
1025.     list of expressions as an argument to another expression, like a partition
1026.     clause.
1027.     """
1028. 
1029.     template = "%(expressions)s"
1030. 
1031.     def __init__(self, *expressions, **extra):
1032.         if not expressions:
1033.             raise ValueError(
1034.                 "%s requires at least one expression." % self.__class__.__name__
1035.             )
1036.         super().__init__(*expressions, **extra)
1037. 
1038.     def __str__(self):
1039.         return self.arg_joiner.join(str(arg) for arg in self.source_expressions)
1040. 
1041.     def as_sqlite(self, compiler, connection, **extra_context):
1042.         # Casting to numeric is unnecessary.
1043.         return self.as_sql(compiler, connection, **extra_context)
1044. 
1045. 
1046. class OrderByList(Func):
1047.     template = "ORDER BY %(expressions)s"
1048. 
1049.     def __init__(self, *expressions, **extra):
1050.         expressions = (
1051.             (
1052.                 OrderBy(F(expr[1:]), descending=True)
1053.                 if isinstance(expr, str) and expr[0] == "-"
1054.                 else expr
1055.             )
1056.             for expr in expressions
1057.         )
1058.         super().__init__(*expressions, **extra)
1059. 
1060.     def as_sql(self, *args, **kwargs):
1061.         if not self.source_expressions:
1062.             return "", ()
1063.         return super().as_sql(*args, **kwargs)
1064. 
1065. 
1066. @deconstructible(path="django.db.models.ExpressionWrapper")
1067. class ExpressionWrapper(SQLiteNumericMixin, Expression):
1068.     """
1069.     An expression that can wrap another expression so that it can provide
1070.     extra context to the inner expression, such as the output_field.
1071.     """
1072. 
1073.     def __init__(self, expression, output_field):
1074.         super().__init__(output_field=output_field)
1075.         self.expression = expression
1076. 
1077.     def set_source_expressions(self, exprs):
1078.         self.expression = exprs[0]
1079. 
1080.     def get_source_expressions(self):
1081.         return [self.expression]
1082. 
1083.     def get_group_by_cols(self, alias=None):
1084.         if isinstance(self.expression, Expression):
1085.             expression = self.expression.copy()
1086.             expression.output_field = self.output_field
1087.             return expression.get_group_by_cols(alias=alias)
1088.         # For non-expressions e.g. an SQL WHERE clause, the entire
1089.         # `expression` must be included in the GROUP BY clause.
1090.         return super().get_group_by_cols()
1091. 
1092.     def as_sql(self, compiler, connection):
1093.         return compiler.compile(self.expression)
1094. 
1095.     def __repr__(self):
1096.         return "{}({})".format(self.__class__.__name__, self.expression)
1097. 
1098. 
1099. @deconstructible(path="django.db.models.When")
1100. class When(Expression):
1101.     template = "WHEN %(condition)s THEN %(result)s"
1102.     # This isn't a complete conditional expression, must be used in Case().
1103.     conditional = False
1104. 
1105.     def __init__(self, condition=None, then=None, **lookups):
1106.         if lookups:
1107.             if condition is None:
1108.                 condition, lookups = Q(**lookups), None
1109.             elif getattr(condition, "conditional", False):
1110.                 condition, lookups = Q(condition, **lookups), None
1111.         if condition is None or not getattr(condition, "conditional", False) or lookups:
1112.             raise TypeError(
1113.                 "When() supports a Q object, a boolean expression, or lookups "
1114.                 "as a condition."
1115.             )
1116.         if isinstance(condition, Q) and not condition:


File: django/db/models/expressions.py
Line number range: 1117 - 1189
Content:
1117.             raise ValueError("An empty Q() can't be used as a When() condition.")
1118.         super().__init__(output_field=None)
1119.         self.condition = condition
1120.         self.result = self._parse_expressions(then)[0]
1121. 
1122.     def __str__(self):
1123.         return "WHEN %r THEN %r" % (self.condition, self.result)
1124. 
1125.     def __repr__(self):
1126.         return "<%s: %s>" % (self.__class__.__name__, self)
1127. 
1128.     def get_source_expressions(self):
1129.         return [self.condition, self.result]
1130. 
1131.     def set_source_expressions(self, exprs):
1132.         self.condition, self.result = exprs
1133. 
1134.     def get_source_fields(self):
1135.         # We're only interested in the fields of the result expressions.
1136.         return [self.result._output_field_or_none]
1137. 
1138.     def resolve_expression(
1139.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
1140.     ):
1141.         c = self.copy()
1142.         c.is_summary = summarize
1143.         if hasattr(c.condition, "resolve_expression"):
1144.             c.condition = c.condition.resolve_expression(
1145.                 query, allow_joins, reuse, summarize, False
1146.             )
1147.         c.result = c.result.resolve_expression(
1148.             query, allow_joins, reuse, summarize, for_save
1149.         )
1150.         return c
1151. 
1152.     def as_sql(self, compiler, connection, template=None, **extra_context):
1153.         connection.ops.check_expression_support(self)
1154.         template_params = extra_context
1155.         sql_params = []
1156.         condition_sql, condition_params = compiler.compile(self.condition)
1157.         template_params["condition"] = condition_sql
1158.         sql_params.extend(condition_params)
1159.         result_sql, result_params = compiler.compile(self.result)
1160.         template_params["result"] = result_sql
1161.         sql_params.extend(result_params)
1162.         template = template or self.template
1163.         return template % template_params, sql_params
1164. 
1165.     def get_group_by_cols(self, alias=None):
1166.         # This is not a complete expression and cannot be used in GROUP BY.
1167.         cols = []
1168.         for source in self.get_source_expressions():
1169.             cols.extend(source.get_group_by_cols())
1170.         return cols
1171. 
1172. 
1173. @deconstructible(path="django.db.models.Case")
1174. class Case(SQLiteNumericMixin, Expression):
1175.     """
1176.     An SQL searched CASE expression:
1177. 
1178.         CASE
1179.             WHEN n > 0
1180.                 THEN 'positive'
1181.             WHEN n < 0
1182.                 THEN 'negative'
1183.             ELSE 'zero'
1184.         END
1185.     """
1186. 
1187.     template = "CASE %(cases)s ELSE %(default)s END"
1188.     case_joiner = " "


File: django/db/models/expressions.py
Line number range: 1636 - 1640
Content:
class RowRange(WindowFrame):
    frame_type = "ROWS"

    def window_frame_start_end(self, connection, start, end):
        return connection.ops.window_frame_rows_start_end(start, end)


File: django/db/models/expressions.py
Line number range: 1643 - 1647
Content:
class ValueRange(WindowFrame):
    frame_type = "RANGE"

    def window_frame_start_end(self, connection, start, end):
        return connection.ops.window_frame_range_start_end(start, end)


File: django/db/models/query.py
Line number range: 1 - 500
Content:
1. """
2. The main QuerySet implementation. This provides the public API for the ORM.
3. """
4. 
5. import copy
6. import operator
7. import warnings
8. from itertools import chain, islice
9. 
10. import django
11. from django.conf import settings
12. from django.core import exceptions
13. from django.db import (
14.     DJANGO_VERSION_PICKLE_KEY,
15.     IntegrityError,
16.     NotSupportedError,
17.     connections,
18.     router,
19.     transaction,
20. )
21. from django.db.models import AutoField, DateField, DateTimeField, sql
22. from django.db.models.constants import LOOKUP_SEP, OnConflict
23. from django.db.models.deletion import Collector
24. from django.db.models.expressions import Case, F, Ref, Value, When
25. from django.db.models.functions import Cast, Trunc
26. from django.db.models.query_utils import FilteredRelation, Q
27. from django.db.models.sql.constants import CURSOR, GET_ITERATOR_CHUNK_SIZE
28. from django.db.models.utils import create_namedtuple_class, resolve_callables
29. from django.utils import timezone
30. from django.utils.deprecation import RemovedInDjango50Warning
31. from django.utils.functional import cached_property, partition
32. 
33. # The maximum number of results to fetch in a get() query.
34. MAX_GET_RESULTS = 21
35. 
36. # The maximum number of items to display in a QuerySet.__repr__
37. REPR_OUTPUT_SIZE = 20
38. 
39. 
40. class BaseIterable:
41.     def __init__(
42.         self, queryset, chunked_fetch=False, chunk_size=GET_ITERATOR_CHUNK_SIZE
43.     ):
44.         self.queryset = queryset
45.         self.chunked_fetch = chunked_fetch
46.         self.chunk_size = chunk_size
47. 
48. 
49. class ModelIterable(BaseIterable):
50.     """Iterable that yields a model instance for each row."""
51. 
52.     def __iter__(self):
53.         queryset = self.queryset
54.         db = queryset.db
55.         compiler = queryset.query.get_compiler(using=db)
56.         # Execute the query. This will also fill compiler.select, klass_info,
57.         # and annotations.
58.         results = compiler.execute_sql(
59.             chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size
60.         )
61.         select, klass_info, annotation_col_map = (
62.             compiler.select,
63.             compiler.klass_info,
64.             compiler.annotation_col_map,
65.         )
66.         model_cls = klass_info["model"]
67.         select_fields = klass_info["select_fields"]
68.         model_fields_start, model_fields_end = select_fields[0], select_fields[-1] + 1
69.         init_list = [
70.             f[0].target.attname for f in select[model_fields_start:model_fields_end]
71.         ]
72.         related_populators = get_related_populators(klass_info, select, db)
73.         known_related_objects = [
74.             (
75.                 field,
76.                 related_objs,
77.                 operator.attrgetter(
78.                     *[
79.                         field.attname
80.                         if from_field == "self"
81.                         else queryset.model._meta.get_field(from_field).attname
82.                         for from_field in field.from_fields
83.                     ]
84.                 ),
85.             )
86.             for field, related_objs in queryset._known_related_objects.items()
87.         ]
88.         for row in compiler.results_iter(results):
89.             obj = model_cls.from_db(
90.                 db, init_list, row[model_fields_start:model_fields_end]
91.             )
92.             for rel_populator in related_populators:
93.                 rel_populator.populate(row, obj)
94.             if annotation_col_map:
95.                 for attr_name, col_pos in annotation_col_map.items():
96.                     setattr(obj, attr_name, row[col_pos])
97. 
98.             # Add the known related objects to the model.
99.             for field, rel_objs, rel_getter in known_related_objects:
100.                 # Avoid overwriting objects loaded by, e.g., select_related().
101.                 if field.is_cached(obj):
102.                     continue
103.                 rel_obj_id = rel_getter(obj)
104.                 try:
105.                     rel_obj = rel_objs[rel_obj_id]
106.                 except KeyError:
107.                     pass  # May happen in qs1 | qs2 scenarios.
108.                 else:
109.                     setattr(obj, field.name, rel_obj)
110. 
111.             yield obj
112. 
113. 
114. class ValuesIterable(BaseIterable):
115.     """
116.     Iterable returned by QuerySet.values() that yields a dict for each row.
117.     """
118. 
119.     def __iter__(self):
120.         queryset = self.queryset
121.         query = queryset.query
122.         compiler = query.get_compiler(queryset.db)
123. 
124.         # extra(select=...) cols are always at the start of the row.
125.         names = [
126.             *query.extra_select,
127.             *query.values_select,
128.             *query.annotation_select,
129.         ]
130.         indexes = range(len(names))
131.         for row in compiler.results_iter(
132.             chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size
133.         ):
134.             yield {names[i]: row[i] for i in indexes}
135. 
136. 
137. class ValuesListIterable(BaseIterable):
138.     """
139.     Iterable returned by QuerySet.values_list(flat=False) that yields a tuple
140.     for each row.
141.     """
142. 
143.     def __iter__(self):
144.         queryset = self.queryset
145.         query = queryset.query
146.         compiler = query.get_compiler(queryset.db)
147. 
148.         if queryset._fields:
149.             # extra(select=...) cols are always at the start of the row.
150.             names = [
151.                 *query.extra_select,
152.                 *query.values_select,
153.                 *query.annotation_select,
154.             ]
155.             fields = [
156.                 *queryset._fields,
157.                 *(f for f in query.annotation_select if f not in queryset._fields),
158.             ]
159.             if fields != names:
160.                 # Reorder according to fields.
161.                 index_map = {name: idx for idx, name in enumerate(names)}
162.                 rowfactory = operator.itemgetter(*[index_map[f] for f in fields])
163.                 return map(
164.                     rowfactory,
165.                     compiler.results_iter(
166.                         chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size
167.                     ),
168.                 )
169.         return compiler.results_iter(
170.             tuple_expected=True,
171.             chunked_fetch=self.chunked_fetch,
172.             chunk_size=self.chunk_size,
173.         )
174. 
175. 
176. class NamedValuesListIterable(ValuesListIterable):
177.     """
178.     Iterable returned by QuerySet.values_list(named=True) that yields a
179.     namedtuple for each row.
180.     """
181. 
182.     def __iter__(self):
183.         queryset = self.queryset
184.         if queryset._fields:
185.             names = queryset._fields
186.         else:
187.             query = queryset.query
188.             names = [
189.                 *query.extra_select,
190.                 *query.values_select,
191.                 *query.annotation_select,
192.             ]
193.         tuple_class = create_namedtuple_class(*names)
194.         new = tuple.__new__
195.         for row in super().__iter__():
196.             yield new(tuple_class, row)
197. 
198. 
199. class FlatValuesListIterable(BaseIterable):
200.     """
201.     Iterable returned by QuerySet.values_list(flat=True) that yields single
202.     values.
203.     """
204. 
205.     def __iter__(self):
206.         queryset = self.queryset
207.         compiler = queryset.query.get_compiler(queryset.db)
208.         for row in compiler.results_iter(
209.             chunked_fetch=self.chunked_fetch, chunk_size=self.chunk_size
210.         ):
211.             yield row[0]
212. 
213. 
214. class QuerySet:
215.     """Represent a lazy database lookup for a set of objects."""
216. 
217.     def __init__(self, model=None, query=None, using=None, hints=None):
218.         self.model = model
219.         self._db = using
220.         self._hints = hints or {}
221.         self._query = query or sql.Query(self.model)
222.         self._result_cache = None
223.         self._sticky_filter = False
224.         self._for_write = False
225.         self._prefetch_related_lookups = ()
226.         self._prefetch_done = False
227.         self._known_related_objects = {}  # {rel_field: {pk: rel_obj}}
228.         self._iterable_class = ModelIterable
229.         self._fields = None
230.         self._defer_next_filter = False
231.         self._deferred_filter = None
232. 
233.     @property
234.     def query(self):
235.         if self._deferred_filter:
236.             negate, args, kwargs = self._deferred_filter
237.             self._filter_or_exclude_inplace(negate, args, kwargs)
238.             self._deferred_filter = None
239.         return self._query
240. 
241.     @query.setter
242.     def query(self, value):
243.         if value.values_select:
244.             self._iterable_class = ValuesIterable
245.         self._query = value
246. 
247.     def as_manager(cls):
248.         # Address the circular dependency between `Queryset` and `Manager`.
249.         from django.db.models.manager import Manager
250. 
251.         manager = Manager.from_queryset(cls)()
252.         manager._built_with_as_manager = True
253.         return manager
254. 
255.     as_manager.queryset_only = True
256.     as_manager = classmethod(as_manager)
257. 
258.     ########################
259.     # PYTHON MAGIC METHODS #
260.     ########################
261. 
262.     def __deepcopy__(self, memo):
263.         """Don't populate the QuerySet's cache."""
264.         obj = self.__class__()
265.         for k, v in self.__dict__.items():
266.             if k == "_result_cache":
267.                 obj.__dict__[k] = None
268.             else:
269.                 obj.__dict__[k] = copy.deepcopy(v, memo)
270.         return obj
271. 
272.     def __getstate__(self):
273.         # Force the cache to be fully populated.
274.         self._fetch_all()
275.         return {**self.__dict__, DJANGO_VERSION_PICKLE_KEY: django.__version__}
276. 
277.     def __setstate__(self, state):
278.         pickled_version = state.get(DJANGO_VERSION_PICKLE_KEY)
279.         if pickled_version:
280.             if pickled_version != django.__version__:
281.                 warnings.warn(
282.                     "Pickled queryset instance's Django version %s does not "
283.                     "match the current version %s."
284.                     % (pickled_version, django.__version__),
285.                     RuntimeWarning,
286.                     stacklevel=2,
287.                 )
288.         else:
289.             warnings.warn(
290.                 "Pickled queryset instance's Django version is not specified.",
291.                 RuntimeWarning,
292.                 stacklevel=2,
293.             )
294.         self.__dict__.update(state)
295. 
296.     def __repr__(self):
297.         data = list(self[: REPR_OUTPUT_SIZE + 1])
298.         if len(data) > REPR_OUTPUT_SIZE:
299.             data[-1] = "...(remaining elements truncated)..."
300.         return "<%s %r>" % (self.__class__.__name__, data)
301. 
302.     def __len__(self):
303.         self._fetch_all()
304.         return len(self._result_cache)
305. 
306.     def __iter__(self):
307.         """
308.         The queryset iterator protocol uses three nested iterators in the
309.         default case:
310.             1. sql.compiler.execute_sql()
311.                - Returns 100 rows at time (constants.GET_ITERATOR_CHUNK_SIZE)
312.                  using cursor.fetchmany(). This part is responsible for
313.                  doing some column masking, and returning the rows in chunks.
314.             2. sql.compiler.results_iter()
315.                - Returns one row at time. At this point the rows are still just
316.                  tuples. In some cases the return values are converted to
317.                  Python values at this location.
318.             3. self.iterator()
319.                - Responsible for turning the rows into model objects.
320.         """
321.         self._fetch_all()
322.         return iter(self._result_cache)
323. 
324.     def __bool__(self):
325.         self._fetch_all()
326.         return bool(self._result_cache)
327. 
328.     def __getitem__(self, k):
329.         """Retrieve an item or slice from the set of results."""
330.         if not isinstance(k, (int, slice)):
331.             raise TypeError(
332.                 "QuerySet indices must be integers or slices, not %s."
333.                 % type(k).__name__
334.             )
335.         if (isinstance(k, int) and k < 0) or (
336.             isinstance(k, slice)
337.             and (
338.                 (k.start is not None and k.start < 0)
339.                 or (k.stop is not None and k.stop < 0)
340.             )
341.         ):
342.             raise ValueError("Negative indexing is not supported.")
343. 
344.         if self._result_cache is not None:
345.             return self._result_cache[k]
346. 
347.         if isinstance(k, slice):
348.             qs = self._chain()
349.             if k.start is not None:
350.                 start = int(k.start)
351.             else:
352.                 start = None
353.             if k.stop is not None:
354.                 stop = int(k.stop)
355.             else:
356.                 stop = None
357.             qs.query.set_limits(start, stop)
358.             return list(qs)[:: k.step] if k.step else qs
359. 
360.         qs = self._chain()
361.         qs.query.set_limits(k, k + 1)
362.         qs._fetch_all()
363.         return qs._result_cache[0]
364. 
365.     def __class_getitem__(cls, *args, **kwargs):
366.         return cls
367. 
368.     def __and__(self, other):
369.         self._check_operator_queryset(other, "&")
370.         self._merge_sanity_check(other)
371.         if isinstance(other, EmptyQuerySet):
372.             return other
373.         if isinstance(self, EmptyQuerySet):
374.             return self
375.         combined = self._chain()
376.         combined._merge_known_related_objects(other)
377.         combined.query.combine(other.query, sql.AND)
378.         return combined
379. 
380.     def __or__(self, other):
381.         self._check_operator_queryset(other, "|")
382.         self._merge_sanity_check(other)
383.         if isinstance(self, EmptyQuerySet):
384.             return other
385.         if isinstance(other, EmptyQuerySet):
386.             return self
387.         query = (
388.             self
389.             if self.query.can_filter()
390.             else self.model._base_manager.filter(pk__in=self.values("pk"))
391.         )
392.         combined = query._chain()
393.         combined._merge_known_related_objects(other)
394.         if not other.query.can_filter():
395.             other = other.model._base_manager.filter(pk__in=other.values("pk"))
396.         combined.query.combine(other.query, sql.OR)
397.         return combined
398. 
399.     def __xor__(self, other):
400.         self._check_operator_queryset(other, "^")
401.         self._merge_sanity_check(other)
402.         if isinstance(self, EmptyQuerySet):
403.             return other
404.         if isinstance(other, EmptyQuerySet):
405.             return self
406.         query = (
407.             self
408.             if self.query.can_filter()
409.             else self.model._base_manager.filter(pk__in=self.values("pk"))
410.         )
411.         combined = query._chain()
412.         combined._merge_known_related_objects(other)
413.         if not other.query.can_filter():
414.             other = other.model._base_manager.filter(pk__in=other.values("pk"))
415.         combined.query.combine(other.query, sql.XOR)
416.         return combined
417. 
418.     ####################################
419.     # METHODS THAT DO DATABASE QUERIES #
420.     ####################################
421. 
422.     def _iterator(self, use_chunked_fetch, chunk_size):
423.         iterable = self._iterable_class(
424.             self,
425.             chunked_fetch=use_chunked_fetch,
426.             chunk_size=chunk_size or 2000,
427.         )
428.         if not self._prefetch_related_lookups or chunk_size is None:
429.             yield from iterable
430.             return
431. 
432.         iterator = iter(iterable)
433.         while results := list(islice(iterator, chunk_size)):
434.             prefetch_related_objects(results, *self._prefetch_related_lookups)
435.             yield from results
436. 
437.     def iterator(self, chunk_size=None):
438.         """
439.         An iterator over the results from applying this QuerySet to the
440.         database. chunk_size must be provided for QuerySets that prefetch
441.         related objects. Otherwise, a default chunk_size of 2000 is supplied.
442.         """
443.         if chunk_size is None:
444.             if self._prefetch_related_lookups:
445.                 # When the deprecation ends, replace with:
446.                 # raise ValueError(
447.                 #     'chunk_size must be provided when using '
448.                 #     'QuerySet.iterator() after prefetch_related().'
449.                 # )
450.                 warnings.warn(
451.                     "Using QuerySet.iterator() after prefetch_related() "
452.                     "without specifying chunk_size is deprecated.",
453.                     category=RemovedInDjango50Warning,
454.                     stacklevel=2,
455.                 )
456.         elif chunk_size <= 0:
457.             raise ValueError("Chunk size must be strictly positive.")
458.         use_chunked_fetch = not connections[self.db].settings_dict.get(
459.             "DISABLE_SERVER_SIDE_CURSORS"
460.         )
461.         return self._iterator(use_chunked_fetch, chunk_size)
462. 
463.     def aggregate(self, *args, **kwargs):
464.         """
465.         Return a dictionary containing the calculations (aggregation)
466.         over the current queryset.
467. 
468.         If args is present the expression is passed as a kwarg using
469.         the Aggregate object's default alias.
470.         """
471.         if self.query.distinct_fields:
472.             raise NotImplementedError("aggregate() + distinct(fields) not implemented.")
473.         self._validate_values_are_expressions(
474.             (*args, *kwargs.values()), method_name="aggregate"
475.         )
476.         for arg in args:
477.             # The default_alias property raises TypeError if default_alias
478.             # can't be set automatically or AttributeError if it isn't an
479.             # attribute.
480.             try:
481.                 arg.default_alias
482.             except (AttributeError, TypeError):
483.                 raise TypeError("Complex aggregates require an alias")
484.             kwargs[arg.default_alias] = arg
485. 
486.         query = self.query.chain()
487.         for (alias, aggregate_expr) in kwargs.items():
488.             query.add_annotation(aggregate_expr, alias, is_summary=True)
489.             annotation = query.annotations[alias]
490.             if not annotation.contains_aggregate:
491.                 raise TypeError("%s is not an aggregate expression" % alias)
492.             for expr in annotation.get_source_expressions():
493.                 if (
494.                     expr.contains_aggregate
495.                     and isinstance(expr, Ref)
496.                     and expr.refs in kwargs
497.                 ):
498.                     name = expr.refs
499.                     raise exceptions.FieldError(
500.                         "Cannot compute %s('%s'): '%s' is an aggregate"


File: django/db/models/query_utils.py
Line number range: 1 - 340
Content:
1. """
2. Various data structures used in query construction.
3. 
4. Factored out from django.db.models.query to avoid making the main module very
5. large and/or so that they can be used by other modules without getting into
6. circular import difficulties.
7. """
8. import copy
9. import functools
10. import inspect
11. from collections import namedtuple
12. 
13. from django.core.exceptions import FieldError
14. from django.db.models.constants import LOOKUP_SEP
15. from django.utils import tree
16. 
17. # PathInfo is used when converting lookups (fk__somecol). The contents
18. # describe the relation in Model terms (model Options and Fields for both
19. # sides of the relation. The join_field is the field backing the relation.
20. PathInfo = namedtuple(
21.     "PathInfo",
22.     "from_opts to_opts target_fields join_field m2m direct filtered_relation",
23. )
24. 
25. 
26. def subclasses(cls):
27.     yield cls
28.     for subclass in cls.__subclasses__():
29.         yield from subclasses(subclass)
30. 
31. 
32. class Q(tree.Node):
33.     """
34.     Encapsulate filters as objects that can then be combined logically (using
35.     `&` and `|`).
36.     """
37. 
38.     # Connection types
39.     AND = "AND"
40.     OR = "OR"
41.     XOR = "XOR"
42.     default = AND
43.     conditional = True
44. 
45.     def __init__(self, *args, _connector=None, _negated=False, **kwargs):
46.         super().__init__(
47.             children=[*args, *sorted(kwargs.items())],
48.             connector=_connector,
49.             negated=_negated,
50.         )
51. 
52.     def _combine(self, other, conn):
53.         if not (isinstance(other, Q) or getattr(other, "conditional", False) is True):
54.             raise TypeError(other)
55. 
56.         if not self:
57.             return other.copy() if hasattr(other, "copy") else copy.copy(other)
58.         elif isinstance(other, Q) and not other:
59.             _, args, kwargs = self.deconstruct()
60.             return type(self)(*args, **kwargs)
61. 
62.         obj = type(self)()
63.         obj.connector = conn
64.         obj.add(self, conn)
65.         obj.add(other, conn)
66.         return obj
67. 
68.     def __or__(self, other):
69.         return self._combine(other, self.OR)
70. 
71.     def __and__(self, other):
72.         return self._combine(other, self.AND)
73. 
74.     def __xor__(self, other):
75.         return self._combine(other, self.XOR)
76. 
77.     def __invert__(self):
78.         obj = type(self)()
79.         obj.add(self, self.AND)
80.         obj.negate()
81.         return obj
82. 
83.     def resolve_expression(
84.         self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
85.     ):
86.         # We must promote any new joins to left outer joins so that when Q is
87.         # used as an expression, rows aren't filtered due to joins.
88.         clause, joins = query._add_q(
89.             self,
90.             reuse,
91.             allow_joins=allow_joins,
92.             split_subq=False,
93.             check_filterable=False,
94.         )
95.         query.promote_joins(joins)
96.         return clause
97. 
98.     def deconstruct(self):
99.         path = "%s.%s" % (self.__class__.__module__, self.__class__.__name__)
100.         if path.startswith("django.db.models.query_utils"):
101.             path = path.replace("django.db.models.query_utils", "django.db.models")
102.         args = tuple(self.children)
103.         kwargs = {}
104.         if self.connector != self.default:
105.             kwargs["_connector"] = self.connector
106.         if self.negated:
107.             kwargs["_negated"] = True
108.         return path, args, kwargs
109. 
110. 
111. class DeferredAttribute:
112.     """
113.     A wrapper for a deferred-loading field. When the value is read from this
114.     object the first time, the query is executed.
115.     """
116. 
117.     def __init__(self, field):
118.         self.field = field
119. 
120.     def __get__(self, instance, cls=None):
121.         """
122.         Retrieve and caches the value from the datastore on the first lookup.
123.         Return the cached value.
124.         """
125.         if instance is None:
126.             return self
127.         data = instance.__dict__
128.         field_name = self.field.attname
129.         if field_name not in data:
130.             # Let's see if the field is part of the parent chain. If so we
131.             # might be able to reuse the already loaded value. Refs #18343.
132.             val = self._check_parent_chain(instance)
133.             if val is None:
134.                 instance.refresh_from_db(fields=[field_name])
135.             else:
136.                 data[field_name] = val
137.         return data[field_name]
138. 
139.     def _check_parent_chain(self, instance):
140.         """
141.         Check if the field value can be fetched from a parent field already
142.         loaded in the instance. This can be done if the to-be fetched
143.         field is a primary key field.
144.         """
145.         opts = instance._meta
146.         link_field = opts.get_ancestor_link(self.field.model)
147.         if self.field.primary_key and self.field != link_field:
148.             return getattr(instance, link_field.attname)
149.         return None
150. 
151. 
152. class RegisterLookupMixin:
153.     @classmethod
154.     def _get_lookup(cls, lookup_name):
155.         return cls.get_lookups().get(lookup_name, None)
156. 
157.     @classmethod
158.     @functools.lru_cache(maxsize=None)
159.     def get_lookups(cls):
160.         class_lookups = [
161.             parent.__dict__.get("class_lookups", {}) for parent in inspect.getmro(cls)
162.         ]
163.         return cls.merge_dicts(class_lookups)
164. 
165.     def get_lookup(self, lookup_name):
166.         from django.db.models.lookups import Lookup
167. 
168.         found = self._get_lookup(lookup_name)
169.         if found is None and hasattr(self, "output_field"):
170.             return self.output_field.get_lookup(lookup_name)
171.         if found is not None and not issubclass(found, Lookup):
172.             return None
173.         return found
174. 
175.     def get_transform(self, lookup_name):
176.         from django.db.models.lookups import Transform
177. 
178.         found = self._get_lookup(lookup_name)
179.         if found is None and hasattr(self, "output_field"):
180.             return self.output_field.get_transform(lookup_name)
181.         if found is not None and not issubclass(found, Transform):
182.             return None
183.         return found
184. 
185.     @staticmethod
186.     def merge_dicts(dicts):
187.         """
188.         Merge dicts in reverse to preference the order of the original list. e.g.,
189.         merge_dicts([a, b]) will preference the keys in 'a' over those in 'b'.
190.         """
191.         merged = {}
192.         for d in reversed(dicts):
193.             merged.update(d)
194.         return merged
195. 
196.     @classmethod
197.     def _clear_cached_lookups(cls):
198.         for subclass in subclasses(cls):
199.             subclass.get_lookups.cache_clear()
200. 
201.     @classmethod
202.     def register_lookup(cls, lookup, lookup_name=None):
203.         if lookup_name is None:
204.             lookup_name = lookup.lookup_name
205.         if "class_lookups" not in cls.__dict__:
206.             cls.class_lookups = {}
207.         cls.class_lookups[lookup_name] = lookup
208.         cls._clear_cached_lookups()
209.         return lookup
210. 
211.     @classmethod
212.     def _unregister_lookup(cls, lookup, lookup_name=None):
213.         """
214.         Remove given lookup from cls lookups. For use in tests only as it's
215.         not thread-safe.
216.         """
217.         if lookup_name is None:
218.             lookup_name = lookup.lookup_name
219.         del cls.class_lookups[lookup_name]
220. 
221. 
222. def select_related_descend(field, restricted, requested, load_fields, reverse=False):
223.     """
224.     Return True if this field should be used to descend deeper for
225.     select_related() purposes. Used by both the query construction code
226.     (sql.query.fill_related_selections()) and the model instance creation code
227.     (query.get_klass_info()).
228. 
229.     Arguments:
230.      * field - the field to be checked
231.      * restricted - a boolean field, indicating if the field list has been
232.        manually restricted using a requested clause)
233.      * requested - The select_related() dictionary.
234.      * load_fields - the set of fields to be loaded on this model
235.      * reverse - boolean, True if we are checking a reverse select related
236.     """
237.     if not field.remote_field:
238.         return False
239.     if field.remote_field.parent_link and not reverse:
240.         return False
241.     if restricted:
242.         if reverse and field.related_query_name() not in requested:
243.             return False
244.         if not reverse and field.name not in requested:
245.             return False
246.     if not restricted and field.null:
247.         return False
248.     if load_fields:
249.         if field.attname not in load_fields:
250.             if restricted and field.name in requested:
251.                 msg = (
252.                     "Field %s.%s cannot be both deferred and traversed using "
253.                     "select_related at the same time."
254.                 ) % (field.model._meta.object_name, field.name)
255.                 raise FieldError(msg)
256.     return True
257. 
258. 
259. def refs_expression(lookup_parts, annotations):
260.     """
261.     Check if the lookup_parts contains references to the given annotations set.
262.     Because the LOOKUP_SEP is contained in the default annotation names, check
263.     each prefix of the lookup_parts for a match.
264.     """
265.     for n in range(1, len(lookup_parts) + 1):
266.         level_n_lookup = LOOKUP_SEP.join(lookup_parts[0:n])
267.         if level_n_lookup in annotations and annotations[level_n_lookup]:
268.             return annotations[level_n_lookup], lookup_parts[n:]
269.     return False, ()
270. 
271. 
272. def check_rel_lookup_compatibility(model, target_opts, field):
273.     """
274.     Check that self.model is compatible with target_opts. Compatibility
275.     is OK if:
276.       1) model and opts match (where proxy inheritance is removed)
277.       2) model is parent of opts' model or the other way around
278.     """
279. 
280.     def check(opts):
281.         return (
282.             model._meta.concrete_model == opts.concrete_model
283.             or opts.concrete_model in model._meta.get_parent_list()
284.             or model in opts.get_parent_list()
285.         )
286. 
287.     # If the field is a primary key, then doing a query against the field's
288.     # model is ok, too. Consider the case:
289.     # class Restaurant(models.Model):
290.     #     place = OneToOneField(Place, primary_key=True):
291.     # Restaurant.objects.filter(pk__in=Restaurant.objects.all()).
292.     # If we didn't have the primary key check, then pk__in (== place__in) would
293.     # give Place's opts as the target opts, but Restaurant isn't compatible
294.     # with that. This logic applies only to primary keys, as when doing __in=qs,
295.     # we are going to turn this into __in=qs.values('pk') later on.
296.     return check(target_opts) or (
297.         getattr(field, "primary_key", False) and check(field.model._meta)
298.     )
299. 
300. 
301. class FilteredRelation:
302.     """Specify custom filtering in the ON clause of SQL joins."""
303. 
304.     def __init__(self, relation_name, *, condition=Q()):
305.         if not relation_name:
306.             raise ValueError("relation_name cannot be empty.")
307.         self.relation_name = relation_name
308.         self.alias = None
309.         if not isinstance(condition, Q):
310.             raise ValueError("condition argument must be a Q() instance.")
311.         self.condition = condition
312.         self.path = []
313. 
314.     def __eq__(self, other):
315.         if not isinstance(other, self.__class__):
316.             return NotImplemented
317.         return (
318.             self.relation_name == other.relation_name
319.             and self.alias == other.alias
320.             and self.condition == other.condition
321.         )
322. 
323.     def clone(self):
324.         clone = FilteredRelation(self.relation_name, condition=self.condition)
325.         clone.alias = self.alias
326.         clone.path = self.path[:]
327.         return clone
328. 
329.     def resolve_expression(self, *args, **kwargs):
330.         """
331.         QuerySet.annotate() only accepts expression-like arguments
332.         (with a resolve_expression() method).
333.         """
334.         raise NotImplementedError("FilteredRelation.resolve_expression() is unused.")
335. 
336.     def as_sql(self, compiler, connection):
337.         # Resolve the condition in Join.filtered_relation.
338.         query = compiler.query
339.         where = query.build_filtered_relation_q(self.condition, reuse=set(self.path))
340.         return compiler.compile(where)


File: docs/ref/models/querysets.txt
Line number range: 3836 - 3905
Content:
.. note::

    When using ``to_attr`` the prefetched result is stored in a list. This can
    provide a significant speed improvement over traditional
    ``prefetch_related`` calls which store the cached result within a
    ``QuerySet`` instance.

``prefetch_related_objects()``
------------------------------

.. function:: prefetch_related_objects(model_instances, *related_lookups)

Prefetches the given lookups on an iterable of model instances. This is useful
in code that receives a list of model instances as opposed to a ``QuerySet``;
for example, when fetching models from a cache or instantiating them manually.

Pass an iterable of model instances (must all be of the same class) and the
lookups or :class:`Prefetch` objects you want to prefetch for. For example::

    >>> from django.db.models import prefetch_related_objects
    >>> restaurants = fetch_top_restaurants_from_cache()  # A list of Restaurants
    >>> prefetch_related_objects(restaurants, 'pizzas__toppings')

When using multiple databases with ``prefetch_related_objects``, the prefetch
query will use the database associated with the model instance. This can be
overridden by using a custom queryset in a related lookup.

``FilteredRelation()`` objects
------------------------------

.. class:: FilteredRelation(relation_name, *, condition=Q())

    .. attribute:: FilteredRelation.relation_name

        The name of the field on which you'd like to filter the relation.

    .. attribute:: FilteredRelation.condition

        A :class:`~django.db.models.Q` object to control the filtering.

``FilteredRelation`` is used with :meth:`~.QuerySet.annotate()` to create an
``ON`` clause when a ``JOIN`` is performed. It doesn't act on the default
relationship but on the annotation name (``pizzas_vegetarian`` in example
below).

For example, to find restaurants that have vegetarian pizzas with
``'mozzarella'`` in the name::

    >>> from django.db.models import FilteredRelation, Q
    >>> Restaurant.objects.annotate(
    ...    pizzas_vegetarian=FilteredRelation(
    ...        'pizzas', condition=Q(pizzas__vegetarian=True),
    ...    ),
    ... ).filter(pizzas_vegetarian__name__icontains='mozzarella')

If there are a large number of pizzas, this queryset performs better than::

    >>> Restaurant.objects.filter(
    ...     pizzas__vegetarian=True,
    ...     pizzas__name__icontains='mozzarella',
    ... )

because the filtering in the ``WHERE`` clause of the first queryset will only
operate on vegetarian pizzas.

``FilteredRelation`` doesn't support:

* :meth:`.QuerySet.only` and :meth:`~.QuerySet.prefetch_related`.
* A :class:`~django.contrib.contenttypes.fields.GenericForeignKey`
  inherited from a parent model.


File: docs/releases/2.0.txt
Line number range: 244 - 362
Content:
* The new ``chunk_size`` parameter of :meth:`.QuerySet.iterator` controls the
  number of rows fetched by the Python database client when streaming results
  from the database. For databases that don't support server-side cursors, it
  controls the number of results Django fetches from the database adapter.

* :meth:`.QuerySet.earliest`, :meth:`.QuerySet.latest`, and
  :attr:`Meta.get_latest_by <django.db.models.Options.get_latest_by>` now
  allow ordering by several fields.

* Added the :class:`~django.db.models.functions.ExtractQuarter` function to
  extract the quarter from :class:`~django.db.models.DateField` and
  :class:`~django.db.models.DateTimeField`, and exposed it through the
  :lookup:`quarter` lookup.

* Added the :class:`~django.db.models.functions.TruncQuarter` function to
  truncate :class:`~django.db.models.DateField` and
  :class:`~django.db.models.DateTimeField` to the first day of a quarter.

* Added the :attr:`~django.db.models.Index.db_tablespace` parameter to
  class-based indexes.

* If the database supports a native duration field (Oracle and PostgreSQL),
  :class:`~django.db.models.functions.Extract` now works with
  :class:`~django.db.models.DurationField`.

* Added the ``of`` argument to :meth:`.QuerySet.select_for_update()`, supported
  on PostgreSQL and Oracle, to lock only rows from specific tables rather than
  all selected tables. It may be helpful particularly when
  :meth:`~.QuerySet.select_for_update()` is used in conjunction with
  :meth:`~.QuerySet.select_related()`.

* The new ``field_name`` parameter of :meth:`.QuerySet.in_bulk` allows fetching
  results based on any unique model field.

* :meth:`.CursorWrapper.callproc()` now takes an optional dictionary of keyword
  parameters, if the backend supports this feature. Of Django's built-in
  backends, only Oracle supports it.

* The new :meth:`connection.execute_wrapper()
  <django.db.backends.base.DatabaseWrapper.execute_wrapper>` method allows
  :doc:`installing wrappers around execution of database queries
  </topics/db/instrumentation>`.

* The new ``filter`` argument for built-in aggregates allows :ref:`adding
  different conditionals <conditional-aggregation>` to multiple aggregations
  over the same fields or relations.

* Added support for expressions in :attr:`Meta.ordering
  <django.db.models.Options.ordering>`.

* The new ``named`` parameter of :meth:`.QuerySet.values_list` allows fetching
  results as named tuples.

* The new :class:`.FilteredRelation` class allows adding an ``ON`` clause to
  querysets.

Pagination
~~~~~~~~~~

* Added :meth:`Paginator.get_page() <django.core.paginator.Paginator.get_page>`
  to provide the documented pattern of handling invalid page numbers.

Requests and Responses
~~~~~~~~~~~~~~~~~~~~~~

* The :djadmin:`runserver` web server supports HTTP 1.1.

Templates
~~~~~~~~~

* To increase the usefulness of :meth:`.Engine.get_default` in third-party
  apps, it now returns the first engine if multiple ``DjangoTemplates`` engines
  are configured in ``TEMPLATES`` rather than raising ``ImproperlyConfigured``.

* Custom template tags may now accept keyword-only arguments.

Tests
~~~~~

* Added threading support to :class:`~django.test.LiveServerTestCase`.

* Added settings that allow customizing the test tablespace parameters for
  Oracle: :setting:`DATAFILE_SIZE`, :setting:`DATAFILE_TMP_SIZE`,
  :setting:`DATAFILE_EXTSIZE`, and :setting:`DATAFILE_TMP_EXTSIZE`.

Validators
~~~~~~~~~~

* The new :class:`.ProhibitNullCharactersValidator` disallows the null
  character in the input of the :class:`~django.forms.CharField` form field
  and its subclasses. Null character input was observed from vulnerability
  scanning tools. Most databases silently discard null characters, but
  psycopg2 2.7+ raises an exception when trying to save a null character to
  a char/text field with PostgreSQL.

.. _backwards-incompatible-2.0:

Backwards incompatible changes in 2.0
=====================================

Removed support for bytestrings in some places
----------------------------------------------

To support native Python 2 strings, older Django versions had to accept both
bytestrings and Unicode strings. Now that Python 2 support is dropped,
bytestrings should only be encountered around input/output boundaries (handling
of binary fields or HTTP streams, for example). You might have to update your
code to limit bytestring usage to a minimum, as Django no longer accepts
bytestrings in certain code paths. Python's :option:`-b` option may help detect
that mistake in your code.

For example, ``reverse()`` now uses ``str()`` instead of ``force_text()`` to
coerce the ``args`` and ``kwargs`` it receives, prior to their placement in
the URL. For bytestrings, this creates a string with an undesired ``b`` prefix
as well as additional quotes (``str(b'foo')`` is ``"b'foo'"``). To adapt, call
``decode()`` on the bytestring before passing it to ``reverse()``.

Database backend API
--------------------


File: docs/releases/3.2.txt
Line number range: 356 - 467
Content:
* :djadmin:`makemigrations` can now be called without an active database
  connection. In that case, check for a consistent migration history is
  skipped.

* :attr:`.BaseCommand.requires_system_checks` now supports specifying a list of
  tags. System checks registered in the chosen tags will be checked for errors
  prior to executing the command. In previous versions, either all or none
  of the system checks were performed.

* Support for colored terminal output on Windows is updated. Various modern
  terminal environments are automatically detected, and the options for
  enabling support in other cases are improved. See :ref:`syntax-coloring` for
  more details.

Migrations
~~~~~~~~~~

* The new ``Operation.migration_name_fragment`` property allows providing a
  filename fragment that will be used to name a migration containing only that
  operation.

* Migrations now support serialization of pure and concrete path objects from
  :mod:`pathlib`, and :class:`os.PathLike` instances.

Models
~~~~~~

* The new ``no_key`` parameter for :meth:`.QuerySet.select_for_update()`,
  supported on PostgreSQL, allows acquiring weaker locks that don't block the
  creation of rows that reference locked rows through a foreign key.

* :class:`When() <django.db.models.expressions.When>` expression now allows
  using the ``condition`` argument with ``lookups``.

* The new :attr:`.Index.include` and :attr:`.UniqueConstraint.include`
  attributes allow creating covering indexes and covering unique constraints on
  PostgreSQL 11+.

* The new :attr:`.UniqueConstraint.opclasses` attribute allows setting
  PostgreSQL operator classes.

* The :meth:`.QuerySet.update` method now respects the ``order_by()`` clause on
  MySQL and MariaDB.

* :class:`FilteredRelation() <django.db.models.FilteredRelation>` now supports
  nested relations.

* The ``of`` argument of :meth:`.QuerySet.select_for_update()` is now allowed
  on MySQL 8.0.1+.

* :class:`Value() <django.db.models.Value>` expression now
  automatically resolves its ``output_field`` to the appropriate
  :class:`Field <django.db.models.Field>` subclass based on the type of
  its provided ``value`` for :py:class:`bool`, :py:class:`bytes`,
  :py:class:`float`, :py:class:`int`, :py:class:`str`,
  :py:class:`datetime.date`, :py:class:`datetime.datetime`,
  :py:class:`datetime.time`, :py:class:`datetime.timedelta`,
  :py:class:`decimal.Decimal`, and :py:class:`uuid.UUID` instances. As a
  consequence, resolving an ``output_field`` for database functions and
  combined expressions may now crash with mixed types when using ``Value()``.
  You will need to explicitly set the ``output_field`` in such cases.

* The new :meth:`.QuerySet.alias` method allows creating reusable aliases for
  expressions that don't need to be selected but are used for filtering,
  ordering, or as a part of complex expressions.

* The new :class:`~django.db.models.functions.Collate` function allows
  filtering and ordering by specified database collations.

* The ``field_name`` argument of :meth:`.QuerySet.in_bulk()` now accepts
  distinct fields if there's only one field specified in
  :meth:`.QuerySet.distinct`.

* The new ``tzinfo`` parameter of the
  :class:`~django.db.models.functions.TruncDate` and
  :class:`~django.db.models.functions.TruncTime` database functions allows
  truncating datetimes in a specific timezone.

* The new ``db_collation`` argument for
  :attr:`CharField <django.db.models.CharField.db_collation>` and
  :attr:`TextField <django.db.models.TextField.db_collation>` allows setting a
  database collation for the field.

* Added the :class:`~django.db.models.functions.Random` database function.

* :ref:`aggregation-functions`, :class:`F() <django.db.models.F>`,
  :class:`OuterRef() <django.db.models.OuterRef>`, and other expressions now
  allow using transforms. See :ref:`using-transforms-in-expressions` for
  details.

* The new ``durable`` argument for :func:`~django.db.transaction.atomic`
  guarantees that changes made in the atomic block will be committed if the
  block exits without errors. A nested atomic block marked as durable will
  raise a ``RuntimeError``.

* Added the :class:`~django.db.models.functions.JSONObject` database function.

Pagination
~~~~~~~~~~

* The new :meth:`django.core.paginator.Paginator.get_elided_page_range` method
  allows generating a page range with some of the values elided. If there are a
  large number of pages, this can be helpful for generating a reasonable number
  of page links in a template.

Requests and Responses
~~~~~~~~~~~~~~~~~~~~~~

* Response headers are now stored in :attr:`.HttpResponse.headers`. This can be
  used instead of the original dict-like interface of ``HttpResponse`` objects.
  Both interfaces will continue to be supported. See
  :ref:`setting-header-fields` for details.

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 23:04:19,510 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of 'django/db/models/expressions.py'.\n   - This context contains the first and largest part of the file.\n2. Extended relevance:\n   - This is the main body of the file requested by the user, containing the majority of the expression classes.", relative_path='django/db/models/expressions.py', start_line=1, end_line=1116), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of 'django/db/models/expressions.py'.\n   - This context is a continuation of the file's content, immediately following the previous chunk.\n2. Extended relevance:\n   - This context provides the definition for the `When` and `Case` expression classes, which are important parts of the expressions framework.", relative_path='django/db/models/expressions.py', start_line=1117, end_line=1189), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of 'django/db/models/expressions.py'.\n   - This context contains another fragment of the requested file.\n2. Extended relevance:\n   - This context defines the `RowRange` class, which is part of the window functions expressions.", relative_path='django/db/models/expressions.py', start_line=1636, end_line=1640), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user explicitly requested the full content of 'django/db/models/expressions.py'.\n   - This context contains another fragment of the requested file.\n2. Extended relevance:\n   - This context defines the `ValueRange` class, which is part of the window functions expressions.", relative_path='django/db/models/expressions.py', start_line=1643, end_line=1647), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's stated purpose is to inspect the `FilteredRelation` class definition.\n   - This context contains the complete definition of the `FilteredRelation` class.\n2. Extended relevance:\n   - While the user asked for `django/db/models/expressions.py`, their actual goal was to understand `FilteredRelation`. This class is defined in `django/db/models/query_utils.py`. Providing this context directly fulfills the user's underlying need.", relative_path='django/db/models/query_utils.py', start_line=301, end_line=340)]
2025-12-24 23:04:19,515 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 5 contexts to memory for query: Please provide the full content of django/db/models/expressions.py.
2025-12-24 23:04:19,516 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 23:04:19,516 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 23:04:19,516 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 5 new contexts to 3 existing contexts
2025-12-24 23:04:19,517 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 8 total contexts (removed 0 duplicates)
2025-12-24 23:04:19,518 - thread-128178306672320.prometheus_context_collector.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-12-24 23:04:19,519 - thread-128178306672320.prometheus_context_collector - INFO - Successfully retrieved 8 context snippets
