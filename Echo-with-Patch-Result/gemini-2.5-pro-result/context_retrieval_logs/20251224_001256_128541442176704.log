2025-12-24 00:12:56,299 - thread-128541442176704.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: Unexpected exception when multiplying geometry.Point and number

Description: ```python
from sympy import geometry as ge
import sympy

point1 = ge.Point(0,0)
point2 = ge.Point(1,1)
```

This line works fine
```python
point1 + point2 * sympy.sympify(2.0)
```

But when I write the same this way it raises an exception
```python
point1 + sympy.sympify(2.0) * point2
```

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __add__(self, other)
    219         try:
--> 220             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
    221         except TypeError:

~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __new__(cls, *args, **kwargs)
    128                 Expecting sequence of coordinates, not `{}`'''
--> 129                                        .format(func_name(coords))))
    130         # A point where only `dim` is specified is initialized

TypeError: 
Expecting sequence of coordinates, not `Mul`

During handling of the above exception, another exception occurred:

GeometryError                             Traceback (most recent call last)
<ipython-input-20-6dcbddac1ee2> in <module>
----> 1 point1 + sympy.sympify(2.0)* point2

~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __add__(self, other)
    220             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
    221         except TypeError:
--> 222             raise GeometryError("Don't know how to add {} and a Point object".format(other))
    223 
    224         coords = [simplify(a + b) for a, b in zip(s, o)]

GeometryError: Don't know how to add 2.0*Point2D(1, 1) and a Point object
```

The expected behaviour is, that both lines give the same result

Patch information:
diff --git a/sympy/geometry/entity.py b/sympy/geometry/entity.py
index ee5c910268..c882fb5a30 100644
--- a/sympy/geometry/entity.py
+++ b/sympy/geometry/entity.py
@@ -139,7 +139,7 @@ def __repr__(self):
 
     def __rmul__(self, a):
         """Implementation of reverse multiplication method."""
-        return a.__mul__(self)
+        return self.__mul__(a)
 
     def __rsub__(self, a):
         """Implementation of reverse subtraction method."""
diff --git a/sympy/geometry/point.py b/sympy/geometry/point.py
index 7c978c47be..da785798e3 100644
--- a/sympy/geometry/point.py
+++ b/sympy/geometry/point.py
@@ -213,6 +213,17 @@ def __add__(self, other):
         sympy.geometry.point.Point.translate
 
         """
+        from sympy.core.mul import Mul
+        if isinstance(other, Mul) and any(isinstance(arg, Point) for arg in other.args):
+            # Handle case like point1 + sympy.sympify(2.0) * point2
+            # Find the Point in the Mul args
+            point_arg = next(arg for arg in other.args if isinstance(arg, Point))
+            # Get the remaining factor
+            factor = Mul(*[arg for arg in other.args if arg != point_arg])
+            # Multiply the point by the factor
+            scaled_point = point_arg * factor
+            # Add the scaled point to self
+            return self + scaled_point
         try:
             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
         except TypeError:


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

2025-12-24 00:12:56,375 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .github
|   └── FUNDING.yml
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_pyutils.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Unexpected exception when multiplying geometry.Point and number

Description: ```python
from sympy import geometry as ge
import sympy

point1 = ge.Point(0,0)
point2 = ge.Point(1,1)
```

This line works fine
```python
point1 + point2 * sympy.sympify(2.0)
```

But when I write the same this way it raises an exception
```python
point1 + sympy.sympify(2.0) * point2
```

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __add__(self, other)
    219         try:
--> 220             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
    221         except TypeError:

~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __new__(cls, *args, **kwargs)
    128                 Expecting sequence of coordinates, not `{}`'''
--> 129                                        .format(func_name(coords))))
    130         # A point where only `dim` is specified is initialized

TypeError: 
Expecting sequence of coordinates, not `Mul`

During handling of the above exception, another exception occurred:

GeometryError                             Traceback (most recent call last)
<ipython-input-20-6dcbddac1ee2> in <module>
----> 1 point1 + sympy.sympify(2.0)* point2

~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __add__(self, other)
    220             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
    221         except TypeError:
--> 222             raise GeometryError("Don't know how to add {} and a Point object".format(other))
    223 
    224         coords = [simplify(a + b) for a, b in zip(s, o)]

GeometryError: Don't know how to add 2.0*Point2D(1, 1) and a Point object
```

The expected behaviour is, that both lines give the same result

Patch information:
diff --git a/sympy/geometry/entity.py b/sympy/geometry/entity.py
index ee5c910268..c882fb5a30 100644
--- a/sympy/geometry/entity.py
+++ b/sympy/geometry/entity.py
@@ -139,7 +139,7 @@ def __repr__(self):
 
     def __rmul__(self, a):
         """Implementation of reverse multiplication method."""
-        return a.__mul__(self)
+        return self.__mul__(a)
 
     def __rsub__(self, a):
         """Implementation of reverse subtraction method."""
diff --git a/sympy/geometry/point.py b/sympy/geometry/point.py
index 7c978c47be..da785798e3 100644
--- a/sympy/geometry/point.py
+++ b/sympy/geometry/point.py
@@ -213,6 +213,17 @@ def __add__(self, other):
         sympy.geometry.point.Point.translate
 
         """
+        from sympy.core.mul import Mul
+        if isinstance(other, Mul) and any(isinstance(arg, Point) for arg in other.args):
+            # Handle case like point1 + sympy.sympify(2.0) * point2
+            # Find the Point in the Mul args
+            point_arg = next(arg for arg in other.args if isinstance(arg, Point))
+            # Get the remaining factor
+            factor = Mul(*[arg for arg in other.args if arg != point_arg])
+            # Multiply the point by the factor
+            scaled_point = point_arg * factor
+            # Add the scaled point to self
+            return self + scaled_point
         try:
             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
         except TypeError:


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 00:13:37,038 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user's query is about an unexpected exception when multiplying a `sympy.geometry.Point` object with a number. The provided traceback and patch indicate that the relevant logic is within the `Point` class and its parent class, `Entity`. To fully understand the issue and the proposed solution, I need to examine the implementation of these classes, specifically the arithmetic-related methods. The `Point` class is defined in `sympy/geometry/point.py`, which includes the `__add__` method where the error occurs. The `Entity` class, defined in `sympy/geometry/entity.py`, contains the `__rmul__` method that is modified in the patch." query='Please provide the full content of `sympy/geometry/point.py` and `sympy/geometry/entity.py`.' extra_requirements='' purpose='This will allow me to analyze the implementation of `Point` and `Entity` classes, understand how they handle arithmetic operations, and determine why the reverse multiplication fails, and determine why the reverse multiplication fails.'
2025-12-24 00:13:37,039 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of `sympy/geometry/point.py` and `sympy/geometry/entity.py`.
2025-12-24 00:13:37,039 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-24 00:13:37,040 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-24 00:13:37,041 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-24 00:13:37,041 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of `sympy/geometry/point.py` and `sympy/geometry/entity.py`.
Purpose: This will allow me to analyze the implementation of `Point` and `Entity` classes, understand how they handle arithmetic operations, and determine why the reverse multiplication fails, and determine why the reverse multiplication fails.
2025-12-24 00:13:39,986 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of both `sympy/geometry/point.py` and `sympy/geometry/entity.py`. This will enable a complete analysis of the `Point` and `Entity` classes, including their arithmetic operations, to understand the failure in reverse multiplication.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sympy/geometry/entity.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2128, 'candidates_token_count': 99, 'total_token_count': 2359, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2128}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 99}], 'thoughts_token_count': 132, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11513791903100833, 'model_name': 'gemini-2.5-pro'} id='run--3dea654a-eab2-4297-92fc-516b631f5840-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/geometry/point.py'}, 'id': '5f7a0ee7-b9bf-4f7d-9f3e-b352c8bb2711', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sympy/geometry/entity.py'}, 'id': '7f928f30-c62c-4b04-bf0d-990f76c83263', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2128, 'output_tokens': 99, 'total_tokens': 2359, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 132}}
2025-12-24 00:13:57,415 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed the code for `sympy/geometry/point.py` and `sympy/geometry/entity.py`. The `Point` class in `point.py` defines arithmetic operations like addition and multiplication. The `GeometryEntity` class in `entity.py` provides base implementations for reverse arithmetic operations, including `__rmul__`.\n\nThe problem is in `entity.py`, where the reverse multiplication method `__rmul__` is incorrectly implemented as `a.__mul__(self)` instead of `self.__mul__(a)`. This causes a `TypeError` when trying to perform a reverse multiplication like `2 * Point(1, 2)` because the integer `2` does not know how to multiply with a `Point` object. A similar issue exists for other reverse arithmetic methods in the same file.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 15839, 'candidates_token_count': 170, 'total_token_count': 17638, 'cached_content_token_count': 1893, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15839}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1893}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 170}], 'thoughts_token_count': 1629}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9217381196863511, 'model_name': 'gemini-2.5-pro'} id='run--11a64a60-7f43-4898-9cd9-5aaa30fc157a-0' usage_metadata={'input_tokens': 15839, 'output_tokens': 170, 'total_tokens': 17638, 'input_token_details': {'cache_read': 1893}, 'output_token_details': {'reasoning': 1629}}
2025-12-24 00:13:57,417 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of `sympy/geometry/point.py` and `sympy/geometry/entity.py`.
--- END QUERY ---



--- BEGIN PURPOSE ---
This will allow me to analyze the implementation of `Point` and `Entity` classes, understand how they handle arithmetic operations, and determine why the reverse multiplication fails, and determine why the reverse multiplication fails.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sympy/geometry/entity.py
Line number range: 1 - 500
Content:
1. """The definition of the base geometrical entity with attributes common to
2. all derived geometrical entities.
3. 
4. Contains
5. ========
6. 
7. GeometryEntity
8. GeometricSet
9. 
10. Notes
11. =====
12. 
13. A GeometryEntity is any object that has special geometric properties.
14. A GeometrySet is a superclass of any GeometryEntity that can also
15. be viewed as a sympy.sets.Set.  In particular, points are the only
16. GeometryEntity not considered a Set.
17. 
18. Rn is a GeometrySet representing n-dimensional Euclidean space. R2 and
19. R3 are currently the only ambient spaces implemented.
20. 
21. """
22. 
23. from __future__ import division, print_function
24. 
25. from sympy.core.basic import Basic
26. from sympy.core.compatibility import is_sequence
27. from sympy.core.containers import Tuple
28. from sympy.core.sympify import sympify
29. from sympy.functions import cos, sin
30. from sympy.matrices import eye
31. from sympy.multipledispatch import dispatch
32. from sympy.sets import Set
33. from sympy.sets.handlers.intersection import intersection_sets
34. from sympy.sets.handlers.union import union_sets
35. from sympy.utilities.misc import func_name
36. 
37. 
38. # How entities are ordered; used by __cmp__ in GeometryEntity
39. ordering_of_classes = [
40.     "Point2D",
41.     "Point3D",
42.     "Point",
43.     "Segment2D",
44.     "Ray2D",
45.     "Line2D",
46.     "Segment3D",
47.     "Line3D",
48.     "Ray3D",
49.     "Segment",
50.     "Ray",
51.     "Line",
52.     "Plane",
53.     "Triangle",
54.     "RegularPolygon",
55.     "Polygon",
56.     "Circle",
57.     "Ellipse",
58.     "Curve",
59.     "Parabola"
60. ]
61. 
62. 
63. class GeometryEntity(Basic):
64.     """The base class for all geometrical entities.
65. 
66.     This class doesn't represent any particular geometric entity, it only
67.     provides the implementation of some methods common to all subclasses.
68. 
69.     """
70. 
71.     def __cmp__(self, other):
72.         """Comparison of two GeometryEntities."""
73.         n1 = self.__class__.__name__
74.         n2 = other.__class__.__name__
75.         c = (n1 > n2) - (n1 < n2)
76.         if not c:
77.             return 0
78. 
79.         i1 = -1
80.         for cls in self.__class__.__mro__:
81.             try:
82.                 i1 = ordering_of_classes.index(cls.__name__)
83.                 break
84.             except ValueError:
85.                 i1 = -1
86.         if i1 == -1:
87.             return c
88. 
89.         i2 = -1
90.         for cls in other.__class__.__mro__:
91.             try:
92.                 i2 = ordering_of_classes.index(cls.__name__)
93.                 break
94.             except ValueError:
95.                 i2 = -1
96.         if i2 == -1:
97.             return c
98. 
99.         return (i1 > i2) - (i1 < i2)
100. 
101.     def __contains__(self, other):
102.         """Subclasses should implement this method for anything more complex than equality."""
103.         if type(self) == type(other):
104.             return self == other
105.         raise NotImplementedError()
106. 
107.     def __getnewargs__(self):
108.         """Returns a tuple that will be passed to __new__ on unpickling."""
109.         return tuple(self.args)
110. 
111.     def __ne__(self, o):
112.         """Test inequality of two geometrical entities."""
113.         return not self == o
114. 
115.     def __new__(cls, *args, **kwargs):
116.         # Points are sequences, but they should not
117.         # be converted to Tuples, so use this detection function instead.
118.         def is_seq_and_not_point(a):
119.             # we cannot use isinstance(a, Point) since we cannot import Point
120.             if hasattr(a, 'is_Point') and a.is_Point:
121.                 return False
122.             return is_sequence(a)
123. 
124.         args = [Tuple(*a) if is_seq_and_not_point(a) else sympify(a) for a in args]
125.         return Basic.__new__(cls, *args)
126. 
127.     def __radd__(self, a):
128.         """Implementation of reverse add method."""
129.         return a.__add__(self)
130. 
131.     def __rdiv__(self, a):
132.         """Implementation of reverse division method."""
133.         return a.__div__(self)
134. 
135.     def __repr__(self):
136.         """String representation of a GeometryEntity that can be evaluated
137.         by sympy."""
138.         return type(self).__name__ + repr(self.args)
139. 
140.     def __rmul__(self, a):
141.         """Implementation of reverse multiplication method."""
142.         return a.__mul__(self)
143. 
144.     def __rsub__(self, a):
145.         """Implementation of reverse subtraction method."""
146.         return a.__sub__(self)
147. 
148.     def __str__(self):
149.         """String representation of a GeometryEntity."""
150.         from sympy.printing import sstr
151.         return type(self).__name__ + sstr(self.args)
152. 
153.     def _eval_subs(self, old, new):
154.         from sympy.geometry.point import Point, Point3D
155.         if is_sequence(old) or is_sequence(new):
156.             if isinstance(self, Point3D):
157.                 old = Point3D(old)
158.                 new = Point3D(new)
159.             else:
160.                 old = Point(old)
161.                 new = Point(new)
162.             return  self._subs(old, new)
163. 
164.     def _repr_svg_(self):
165.         """SVG representation of a GeometryEntity suitable for IPython"""
166. 
167.         from sympy.core.evalf import N
168. 
169.         try:
170.             bounds = self.bounds
171.         except (NotImplementedError, TypeError):
172.             # if we have no SVG representation, return None so IPython
173.             # will fall back to the next representation
174.             return None
175. 
176.         svg_top = '''<svg xmlns="http://www.w3.org/2000/svg"
177.             xmlns:xlink="http://www.w3.org/1999/xlink"
178.             width="{1}" height="{2}" viewBox="{0}"
179.             preserveAspectRatio="xMinYMin meet">
180.             <defs>
181.                 <marker id="markerCircle" markerWidth="8" markerHeight="8"
182.                     refx="5" refy="5" markerUnits="strokeWidth">
183.                     <circle cx="5" cy="5" r="1.5" style="stroke: none; fill:#000000;"/>
184.                 </marker>
185.                 <marker id="markerArrow" markerWidth="13" markerHeight="13" refx="2" refy="4"
186.                        orient="auto" markerUnits="strokeWidth">
187.                     <path d="M2,2 L2,6 L6,4" style="fill: #000000;" />
188.                 </marker>
189.                 <marker id="markerReverseArrow" markerWidth="13" markerHeight="13" refx="6" refy="4"
190.                        orient="auto" markerUnits="strokeWidth">
191.                     <path d="M6,2 L6,6 L2,4" style="fill: #000000;" />
192.                 </marker>
193.             </defs>'''
194. 
195.         # Establish SVG canvas that will fit all the data + small space
196.         xmin, ymin, xmax, ymax = map(N, bounds)
197.         if xmin == xmax and ymin == ymax:
198.             # This is a point; buffer using an arbitrary size
199.             xmin, ymin, xmax, ymax = xmin - .5, ymin -.5, xmax + .5, ymax + .5
200.         else:
201.             # Expand bounds by a fraction of the data ranges
202.             expand = 0.1  # or 10%; this keeps arrowheads in view (R plots use 4%)
203.             widest_part = max([xmax - xmin, ymax - ymin])
204.             expand_amount = widest_part * expand
205.             xmin -= expand_amount
206.             ymin -= expand_amount
207.             xmax += expand_amount
208.             ymax += expand_amount
209.         dx = xmax - xmin
210.         dy = ymax - ymin
211.         width = min([max([100., dx]), 300])
212.         height = min([max([100., dy]), 300])
213. 
214.         scale_factor = 1. if max(width, height) == 0 else max(dx, dy) / max(width, height)
215.         try:
216.             svg = self._svg(scale_factor)
217.         except (NotImplementedError, TypeError):
218.             # if we have no SVG representation, return None so IPython
219.             # will fall back to the next representation
220.             return None
221. 
222.         view_box = "{0} {1} {2} {3}".format(xmin, ymin, dx, dy)
223.         transform = "matrix(1,0,0,-1,0,{0})".format(ymax + ymin)
224.         svg_top = svg_top.format(view_box, width, height)
225. 
226.         return svg_top + (
227.             '<g transform="{0}">{1}</g></svg>'
228.             ).format(transform, svg)
229. 
230.     def _svg(self, scale_factor=1., fill_color="#66cc99"):
231.         """Returns SVG path element for the GeometryEntity.
232. 
233.         Parameters
234.         ==========
235. 
236.         scale_factor : float
237.             Multiplication factor for the SVG stroke-width.  Default is 1.
238.         fill_color : str, optional
239.             Hex string for fill color. Default is "#66cc99".
240.         """
241.         raise NotImplementedError()
242. 
243.     def _sympy_(self):
244.         return self
245. 
246.     @property
247.     def ambient_dimension(self):
248.         """What is the dimension of the space that the object is contained in?"""
249.         raise NotImplementedError()
250. 
251.     @property
252.     def bounds(self):
253.         """Return a tuple (xmin, ymin, xmax, ymax) representing the bounding
254.         rectangle for the geometric figure.
255. 
256.         """
257. 
258.         raise NotImplementedError()
259. 
260.     def encloses(self, o):
261.         """
262.         Return True if o is inside (not on or outside) the boundaries of self.
263. 
264.         The object will be decomposed into Points and individual Entities need
265.         only define an encloses_point method for their class.
266. 
267.         See Also
268.         ========
269. 
270.         sympy.geometry.ellipse.Ellipse.encloses_point
271.         sympy.geometry.polygon.Polygon.encloses_point
272. 
273.         Examples
274.         ========
275. 
276.         >>> from sympy import RegularPolygon, Point, Polygon
277.         >>> t  = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
278.         >>> t2 = Polygon(*RegularPolygon(Point(0, 0), 2, 3).vertices)
279.         >>> t2.encloses(t)
280.         True
281.         >>> t.encloses(t2)
282.         False
283. 
284.         """
285. 
286.         from sympy.geometry.point import Point
287.         from sympy.geometry.line import Segment, Ray, Line
288.         from sympy.geometry.ellipse import Ellipse
289.         from sympy.geometry.polygon import Polygon, RegularPolygon
290. 
291.         if isinstance(o, Point):
292.             return self.encloses_point(o)
293.         elif isinstance(o, Segment):
294.             return all(self.encloses_point(x) for x in o.points)
295.         elif isinstance(o, Ray) or isinstance(o, Line):
296.             return False
297.         elif isinstance(o, Ellipse):
298.             return self.encloses_point(o.center) and \
299.                 self.encloses_point(
300.                 Point(o.center.x + o.hradius, o.center.y)) and \
301.                 not self.intersection(o)
302.         elif isinstance(o, Polygon):
303.             if isinstance(o, RegularPolygon):
304.                 if not self.encloses_point(o.center):
305.                     return False
306.             return all(self.encloses_point(v) for v in o.vertices)
307.         raise NotImplementedError()
308. 
309.     def equals(self, o):
310.         return self == o
311. 
312.     def intersection(self, o):
313.         """
314.         Returns a list of all of the intersections of self with o.
315. 
316.         Notes
317.         =====
318. 
319.         An entity is not required to implement this method.
320. 
321.         If two different types of entities can intersect, the item with
322.         higher index in ordering_of_classes should implement
323.         intersections with anything having a lower index.
324. 
325.         See Also
326.         ========
327. 
328.         sympy.geometry.util.intersection
329. 
330.         """
331.         raise NotImplementedError()
332. 
333.     def is_similar(self, other):
334.         """Is this geometrical entity similar to another geometrical entity?
335. 
336.         Two entities are similar if a uniform scaling (enlarging or
337.         shrinking) of one of the entities will allow one to obtain the other.
338. 
339.         Notes
340.         =====
341. 
342.         This method is not intended to be used directly but rather
343.         through the `are_similar` function found in util.py.
344.         An entity is not required to implement this method.
345.         If two different types of entities can be similar, it is only
346.         required that one of them be able to determine this.
347. 
348.         See Also
349.         ========
350. 
351.         scale
352. 
353.         """
354.         raise NotImplementedError()
355. 
356.     def reflect(self, line):
357.         """
358.         Reflects an object across a line.
359. 
360.         Parameters
361.         ==========
362. 
363.         line: Line
364. 
365.         Examples
366.         ========
367. 
368.         >>> from sympy import pi, sqrt, Line, RegularPolygon
369.         >>> l = Line((0, pi), slope=sqrt(2))
370.         >>> pent = RegularPolygon((1, 2), 1, 5)
371.         >>> rpent = pent.reflect(l)
372.         >>> rpent
373.         RegularPolygon(Point2D(-2*sqrt(2)*pi/3 - 1/3 + 4*sqrt(2)/3, 2/3 + 2*sqrt(2)/3 + 2*pi/3), -1, 5, -atan(2*sqrt(2)) + 3*pi/5)
374. 
375.         >>> from sympy import pi, Line, Circle, Point
376.         >>> l = Line((0, pi), slope=1)
377.         >>> circ = Circle(Point(0, 0), 5)
378.         >>> rcirc = circ.reflect(l)
379.         >>> rcirc
380.         Circle(Point2D(-pi, pi), -5)
381. 
382.         """
383.         from sympy import atan, Point, Dummy, oo
384. 
385.         g = self
386.         l = line
387.         o = Point(0, 0)
388.         if l.slope.is_zero:
389.             y = l.args[0].y
390.             if not y:  # x-axis
391.                 return g.scale(y=-1)
392.             reps = [(p, p.translate(y=2*(y - p.y))) for p in g.atoms(Point)]
393.         elif l.slope is oo:
394.             x = l.args[0].x
395.             if not x:  # y-axis
396.                 return g.scale(x=-1)
397.             reps = [(p, p.translate(x=2*(x - p.x))) for p in g.atoms(Point)]
398.         else:
399.             if not hasattr(g, 'reflect') and not all(
400.                     isinstance(arg, Point) for arg in g.args):
401.                 raise NotImplementedError(
402.                     'reflect undefined or non-Point args in %s' % g)
403.             a = atan(l.slope)
404.             c = l.coefficients
405.             d = -c[-1]/c[1]  # y-intercept
406.             # apply the transform to a single point
407.             x, y = Dummy(), Dummy()
408.             xf = Point(x, y)
409.             xf = xf.translate(y=-d).rotate(-a, o).scale(y=-1
410.                 ).rotate(a, o).translate(y=d)
411.             # replace every point using that transform
412.             reps = [(p, xf.xreplace({x: p.x, y: p.y})) for p in g.atoms(Point)]
413.         return g.xreplace(dict(reps))
414. 
415.     def rotate(self, angle, pt=None):
416.         """Rotate ``angle`` radians counterclockwise about Point ``pt``.
417. 
418.         The default pt is the origin, Point(0, 0)
419. 
420.         See Also
421.         ========
422. 
423.         scale, translate
424. 
425.         Examples
426.         ========
427. 
428.         >>> from sympy import Point, RegularPolygon, Polygon, pi
429.         >>> t = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
430.         >>> t # vertex on x axis
431.         Triangle(Point2D(1, 0), Point2D(-1/2, sqrt(3)/2), Point2D(-1/2, -sqrt(3)/2))
432.         >>> t.rotate(pi/2) # vertex on y axis now
433.         Triangle(Point2D(0, 1), Point2D(-sqrt(3)/2, -1/2), Point2D(sqrt(3)/2, -1/2))
434. 
435.         """
436.         newargs = []
437.         for a in self.args:
438.             if isinstance(a, GeometryEntity):
439.                 newargs.append(a.rotate(angle, pt))
440.             else:
441.                 newargs.append(a)
442.         return type(self)(*newargs)
443. 
444.     def scale(self, x=1, y=1, pt=None):
445.         """Scale the object by multiplying the x,y-coordinates by x and y.
446. 
447.         If pt is given, the scaling is done relative to that point; the
448.         object is shifted by -pt, scaled, and shifted by pt.
449. 
450.         See Also
451.         ========
452. 
453.         rotate, translate
454. 
455.         Examples
456.         ========
457. 
458.         >>> from sympy import RegularPolygon, Point, Polygon
459.         >>> t = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
460.         >>> t
461.         Triangle(Point2D(1, 0), Point2D(-1/2, sqrt(3)/2), Point2D(-1/2, -sqrt(3)/2))
462.         >>> t.scale(2)
463.         Triangle(Point2D(2, 0), Point2D(-1, sqrt(3)/2), Point2D(-1, -sqrt(3)/2))
464.         >>> t.scale(2, 2)
465.         Triangle(Point2D(2, 0), Point2D(-1, sqrt(3)), Point2D(-1, -sqrt(3)))
466. 
467.         """
468.         from sympy.geometry.point import Point
469.         if pt:
470.             pt = Point(pt, dim=2)
471.             return self.translate(*(-pt).args).scale(x, y).translate(*pt.args)
472.         return type(self)(*[a.scale(x, y) for a in self.args])  # if this fails, override this class
473. 
474.     def translate(self, x=0, y=0):
475.         """Shift the object by adding to the x,y-coordinates the values x and y.
476. 
477.         See Also
478.         ========
479. 
480.         rotate, scale
481. 
482.         Examples
483.         ========
484. 
485.         >>> from sympy import RegularPolygon, Point, Polygon
486.         >>> t = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
487.         >>> t
488.         Triangle(Point2D(1, 0), Point2D(-1/2, sqrt(3)/2), Point2D(-1/2, -sqrt(3)/2))
489.         >>> t.translate(2)
490.         Triangle(Point2D(3, 0), Point2D(3/2, sqrt(3)/2), Point2D(3/2, -sqrt(3)/2))
491.         >>> t.translate(2, 2)
492.         Triangle(Point2D(3, 2), Point2D(3/2, sqrt(3)/2 + 2), Point2D(3/2, 2 - sqrt(3)/2))
493. 
494.         """
495.         newargs = []
496.         for a in self.args:
497.             if isinstance(a, GeometryEntity):
498.                 newargs.append(a.translate(x, y))
499.             else:
500.                 newargs.append(a)


File: sympy/geometry/point.py
Line number range: 1 - 500
Content:
1. """Geometrical Points.
2. 
3. Contains
4. ========
5. Point
6. Point2D
7. Point3D
8. 
9. When methods of Point require 1 or more points as arguments, they
10. can be passed as a sequence of coordinates or Points:
11. 
12. >>> from sympy.geometry.point import Point
13. >>> Point(1, 1).is_collinear((2, 2), (3, 4))
14. False
15. >>> Point(1, 1).is_collinear(Point(2, 2), Point(3, 4))
16. False
17. 
18. """
19. 
20. from __future__ import division, print_function
21. 
22. import warnings
23. 
24. from sympy.core import S, sympify, Expr
25. from sympy.core.compatibility import is_sequence
26. from sympy.core.containers import Tuple
27. from sympy.simplify import nsimplify, simplify
28. from sympy.geometry.exceptions import GeometryError
29. from sympy.functions.elementary.miscellaneous import sqrt
30. from sympy.functions.elementary.complexes import im
31. from sympy.matrices import Matrix
32. from sympy.core.numbers import Float
33. from sympy.core.evaluate import global_evaluate
34. from sympy.core.add import Add
35. from sympy.utilities.iterables import uniq
36. from sympy.utilities.misc import filldedent, func_name, Undecidable
37. 
38. from .entity import GeometryEntity
39. 
40. 
41. class Point(GeometryEntity):
42.     """A point in a n-dimensional Euclidean space.
43. 
44.     Parameters
45.     ==========
46. 
47.     coords : sequence of n-coordinate values. In the special
48.         case where n=2 or 3, a Point2D or Point3D will be created
49.         as appropriate.
50.     evaluate : if `True` (default), all floats are turn into
51.         exact types.
52.     dim : number of coordinates the point should have.  If coordinates
53.         are unspecified, they are padded with zeros.
54.     on_morph : indicates what should happen when the number of
55.         coordinates of a point need to be changed by adding or
56.         removing zeros.  Possible values are `'warn'`, `'error'`, or
57.         `ignore` (default).  No warning or error is given when `*args`
58.         is empty and `dim` is given. An error is always raised when
59.         trying to remove nonzero coordinates.
60. 
61. 
62.     Attributes
63.     ==========
64. 
65.     length
66.     origin: A `Point` representing the origin of the
67.         appropriately-dimensioned space.
68. 
69.     Raises
70.     ======
71. 
72.     TypeError : When instantiating with anything but a Point or sequence
73.     ValueError : when instantiating with a sequence with length < 2 or
74.         when trying to reduce dimensions if keyword `on_morph='error'` is
75.         set.
76. 
77.     See Also
78.     ========
79. 
80.     sympy.geometry.line.Segment : Connects two Points
81. 
82.     Examples
83.     ========
84. 
85.     >>> from sympy.geometry import Point
86.     >>> from sympy.abc import x
87.     >>> Point(1, 2, 3)
88.     Point3D(1, 2, 3)
89.     >>> Point([1, 2])
90.     Point2D(1, 2)
91.     >>> Point(0, x)
92.     Point2D(0, x)
93.     >>> Point(dim=4)
94.     Point(0, 0, 0, 0)
95. 
96.     Floats are automatically converted to Rational unless the
97.     evaluate flag is False:
98. 
99.     >>> Point(0.5, 0.25)
100.     Point2D(1/2, 1/4)
101.     >>> Point(0.5, 0.25, evaluate=False)
102.     Point2D(0.5, 0.25)
103. 
104.     """
105. 
106.     is_Point = True
107. 
108.     def __new__(cls, *args, **kwargs):
109.         evaluate = kwargs.get('evaluate', global_evaluate[0])
110.         on_morph = kwargs.get('on_morph', 'ignore')
111. 
112.         # unpack into coords
113.         coords = args[0] if len(args) == 1 else args
114. 
115.         # check args and handle quickly handle Point instances
116.         if isinstance(coords, Point):
117.             # even if we're mutating the dimension of a point, we
118.             # don't reevaluate its coordinates
119.             evaluate = False
120.             if len(coords) == kwargs.get('dim', len(coords)):
121.                 return coords
122. 
123.         if not is_sequence(coords):
124.             raise TypeError(filldedent('''
125.                 Expecting sequence of coordinates, not `{}`'''
126.                                        .format(func_name(coords))))
127.         # A point where only `dim` is specified is initialized
128.         # to zeros.
129.         if len(coords) == 0 and kwargs.get('dim', None):
130.             coords = (S.Zero,)*kwargs.get('dim')
131. 
132.         coords = Tuple(*coords)
133.         dim = kwargs.get('dim', len(coords))
134. 
135.         if len(coords) < 2:
136.             raise ValueError(filldedent('''
137.                 Point requires 2 or more coordinates or
138.                 keyword `dim` > 1.'''))
139.         if len(coords) != dim:
140.             message = ("Dimension of {} needs to be changed "
141.                        "from {} to {}.").format(coords, len(coords), dim)
142.             if on_morph == 'ignore':
143.                 pass
144.             elif on_morph == "error":
145.                 raise ValueError(message)
146.             elif on_morph == 'warn':
147.                 warnings.warn(message)
148.             else:
149.                 raise ValueError(filldedent('''
150.                         on_morph value should be 'error',
151.                         'warn' or 'ignore'.'''))
152.         if any(coords[dim:]):
153.             raise ValueError('Nonzero coordinates cannot be removed.')
154.         if any(a.is_number and im(a) for a in coords):
155.             raise ValueError('Imaginary coordinates are not permitted.')
156.         if not all(isinstance(a, Expr) for a in coords):
157.             raise TypeError('Coordinates must be valid SymPy expressions.')
158. 
159.         # pad with zeros appropriately
160.         coords = coords[:dim] + (S.Zero,)*(dim - len(coords))
161. 
162.         # Turn any Floats into rationals and simplify
163.         # any expressions before we instantiate
164.         if evaluate:
165.             coords = coords.xreplace(dict(
166.                 [(f, simplify(nsimplify(f, rational=True)))
167.                  for f in coords.atoms(Float)]))
168. 
169.         # return 2D or 3D instances
170.         if len(coords) == 2:
171.             kwargs['_nocheck'] = True
172.             return Point2D(*coords, **kwargs)
173.         elif len(coords) == 3:
174.             kwargs['_nocheck'] = True
175.             return Point3D(*coords, **kwargs)
176. 
177.         # the general Point
178.         return GeometryEntity.__new__(cls, *coords)
179. 
180.     def __abs__(self):
181.         """Returns the distance between this point and the origin."""
182.         origin = Point([0]*len(self))
183.         return Point.distance(origin, self)
184. 
185.     def __add__(self, other):
186.         """Add other to self by incrementing self's coordinates by
187.         those of other.
188. 
189.         Notes
190.         =====
191. 
192.         >>> from sympy.geometry.point import Point
193. 
194.         When sequences of coordinates are passed to Point methods, they
195.         are converted to a Point internally. This __add__ method does
196.         not do that so if floating point values are used, a floating
197.         point result (in terms of SymPy Floats) will be returned.
198. 
199.         >>> Point(1, 2) + (.1, .2)
200.         Point2D(1.1, 2.2)
201. 
202.         If this is not desired, the `translate` method can be used or
203.         another Point can be added:
204. 
205.         >>> Point(1, 2).translate(.1, .2)
206.         Point2D(11/10, 11/5)
207.         >>> Point(1, 2) + Point(.1, .2)
208.         Point2D(11/10, 11/5)
209. 
210.         See Also
211.         ========
212. 
213.         sympy.geometry.point.Point.translate
214. 
215.         """
216.         try:
217.             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
218.         except TypeError:
219.             raise GeometryError("Don't know how to add {} and a Point object".format(other))
220. 
221.         coords = [simplify(a + b) for a, b in zip(s, o)]
222.         return Point(coords, evaluate=False)
223. 
224.     def __contains__(self, item):
225.         return item in self.args
226. 
227.     def __div__(self, divisor):
228.         """Divide point's coordinates by a factor."""
229.         divisor = sympify(divisor)
230.         coords = [simplify(x/divisor) for x in self.args]
231.         return Point(coords, evaluate=False)
232. 
233.     def __eq__(self, other):
234.         if not isinstance(other, Point) or len(self.args) != len(other.args):
235.             return False
236.         return self.args == other.args
237. 
238.     def __getitem__(self, key):
239.         return self.args[key]
240. 
241.     def __hash__(self):
242.         return hash(self.args)
243. 
244.     def __iter__(self):
245.         return self.args.__iter__()
246. 
247.     def __len__(self):
248.         return len(self.args)
249. 
250.     def __mul__(self, factor):
251.         """Multiply point's coordinates by a factor.
252. 
253.         Notes
254.         =====
255. 
256.         >>> from sympy.geometry.point import Point
257. 
258.         When multiplying a Point by a floating point number,
259.         the coordinates of the Point will be changed to Floats:
260. 
261.         >>> Point(1, 2)*0.1
262.         Point2D(0.1, 0.2)
263. 
264.         If this is not desired, the `scale` method can be used or
265.         else only multiply or divide by integers:
266. 
267.         >>> Point(1, 2).scale(1.1, 1.1)
268.         Point2D(11/10, 11/5)
269.         >>> Point(1, 2)*11/10
270.         Point2D(11/10, 11/5)
271. 
272.         See Also
273.         ========
274. 
275.         sympy.geometry.point.Point.scale
276.         """
277.         factor = sympify(factor)
278.         coords = [simplify(x*factor) for x in self.args]
279.         return Point(coords, evaluate=False)
280. 
281.     def __neg__(self):
282.         """Negate the point."""
283.         coords = [-x for x in self.args]
284.         return Point(coords, evaluate=False)
285. 
286.     def __sub__(self, other):
287.         """Subtract two points, or subtract a factor from this point's
288.         coordinates."""
289.         return self + [-x for x in other]
290. 
291.     @classmethod
292.     def _normalize_dimension(cls, *points, **kwargs):
293.         """Ensure that points have the same dimension.
294.         By default `on_morph='warn'` is passed to the
295.         `Point` constructor."""
296.         # if we have a built-in ambient dimension, use it
297.         dim = getattr(cls, '_ambient_dimension', None)
298.         # override if we specified it
299.         dim = kwargs.get('dim', dim)
300.         # if no dim was given, use the highest dimensional point
301.         if dim is None:
302.             dim = max(i.ambient_dimension for i in points)
303.         if all(i.ambient_dimension == dim for i in points):
304.             return list(points)
305.         kwargs['dim'] = dim
306.         kwargs['on_morph'] = kwargs.get('on_morph', 'warn')
307.         return [Point(i, **kwargs) for i in points]
308. 
309.     @staticmethod
310.     def affine_rank(*args):
311.         """The affine rank of a set of points is the dimension
312.         of the smallest affine space containing all the points.
313.         For example, if the points lie on a line (and are not all
314.         the same) their affine rank is 1.  If the points lie on a plane
315.         but not a line, their affine rank is 2.  By convention, the empty
316.         set has affine rank -1."""
317. 
318.         if len(args) == 0:
319.             return -1
320.         # make sure we're genuinely points
321.         # and translate every point to the origin
322.         points = Point._normalize_dimension(*[Point(i) for i in args])
323.         origin = points[0]
324.         points = [i - origin for i in points[1:]]
325. 
326.         m = Matrix([i.args for i in points])
327.         # XXX fragile -- what is a better way?
328.         return m.rank(iszerofunc = lambda x:
329.             abs(x.n(2)) < 1e-12 if x.is_number else x.is_zero)
330. 
331.     @property
332.     def ambient_dimension(self):
333.         """Number of components this point has."""
334.         return getattr(self, '_ambient_dimension', len(self))
335. 
336.     @classmethod
337.     def are_coplanar(cls, *points):
338.         """Return True if there exists a plane in which all the points
339.         lie.  A trivial True value is returned if `len(points) < 3` or
340.         all Points are 2-dimensional.
341. 
342.         Parameters
343.         ==========
344. 
345.         A set of points
346. 
347.         Raises
348.         ======
349. 
350.         ValueError : if less than 3 unique points are given
351. 
352.         Returns
353.         =======
354. 
355.         boolean
356. 
357.         Examples
358.         ========
359. 
360.         >>> from sympy import Point3D
361.         >>> p1 = Point3D(1, 2, 2)
362.         >>> p2 = Point3D(2, 7, 2)
363.         >>> p3 = Point3D(0, 0, 2)
364.         >>> p4 = Point3D(1, 1, 2)
365.         >>> Point3D.are_coplanar(p1, p2, p3, p4)
366.         True
367.         >>> p5 = Point3D(0, 1, 3)
368.         >>> Point3D.are_coplanar(p1, p2, p3, p5)
369.         False
370. 
371.         """
372.         if len(points) <= 1:
373.             return True
374. 
375.         points = cls._normalize_dimension(*[Point(i) for i in points])
376.         # quick exit if we are in 2D
377.         if points[0].ambient_dimension == 2:
378.             return True
379.         points = list(uniq(points))
380.         return Point.affine_rank(*points) <= 2
381. 
382.     def distance(self, other):
383.         """The Euclidean distance between self and another GeometricEntity.
384. 
385.         Returns
386.         =======
387. 
388.         distance : number or symbolic expression.
389. 
390.         Raises
391.         ======
392. 
393.         TypeError : if other is not recognized as a GeometricEntity or is a
394.                     GeometricEntity for which distance is not defined.
395. 
396.         See Also
397.         ========
398. 
399.         sympy.geometry.line.Segment.length
400.         sympy.geometry.point.Point.taxicab_distance
401. 
402.         Examples
403.         ========
404. 
405.         >>> from sympy.geometry import Point, Line
406.         >>> p1, p2 = Point(1, 1), Point(4, 5)
407.         >>> l = Line((3, 1), (2, 2))
408.         >>> p1.distance(p2)
409.         5
410.         >>> p1.distance(l)
411.         sqrt(2)
412. 
413.         The computed distance may be symbolic, too:
414. 
415.         >>> from sympy.abc import x, y
416.         >>> p3 = Point(x, y)
417.         >>> p3.distance((0, 0))
418.         sqrt(x**2 + y**2)
419. 
420.         """
421.         if not isinstance(other, GeometryEntity):
422.             try:
423.                 other = Point(other, dim=self.ambient_dimension)
424.             except TypeError:
425.                 raise TypeError("not recognized as a GeometricEntity: %s" % type(other))
426.         if isinstance(other, Point):
427.             s, p = Point._normalize_dimension(self, Point(other))
428.             return sqrt(Add(*((a - b)**2 for a, b in zip(s, p))))
429.         distance = getattr(other, 'distance', None)
430.         if distance is None:
431.             raise TypeError("distance between Point and %s is not defined" % type(other))
432.         return distance(self)
433. 
434.     def dot(self, p):
435.         """Return dot product of self with another Point."""
436.         if not is_sequence(p):
437.             p = Point(p)  # raise the error via Point
438.         return Add(*(a*b for a, b in zip(self, p)))
439. 
440.     def equals(self, other):
441.         """Returns whether the coordinates of self and other agree."""
442.         # a point is equal to another point if all its components are equal
443.         if not isinstance(other, Point) or len(self) != len(other):
444.             return False
445.         return all(a.equals(b) for a, b in zip(self, other))
446. 
447.     def evalf(self, prec=None, **options):
448.         """Evaluate the coordinates of the point.
449. 
450.         This method will, where possible, create and return a new Point
451.         where the coordinates are evaluated as floating point numbers to
452.         the precision indicated (default=15).
453. 
454.         Parameters
455.         ==========
456. 
457.         prec : int
458. 
459.         Returns
460.         =======
461. 
462.         point : Point
463. 
464.         Examples
465.         ========
466. 
467.         >>> from sympy import Point, Rational
468.         >>> p1 = Point(Rational(1, 2), Rational(3, 2))
469.         >>> p1
470.         Point2D(1/2, 3/2)
471.         >>> p1.evalf()
472.         Point2D(0.5, 1.5)
473. 
474.         """
475.         coords = [x.evalf(prec, **options) for x in self.args]
476.         return Point(*coords, evaluate=False)
477. 
478.     def intersection(self, other):
479.         """The intersection between this point and another GeometryEntity.
480. 
481.         Parameters
482.         ==========
483. 
484.         other : GeometryEntity or sequence of coordinates
485. 
486.         Returns
487.         =======
488. 
489.         intersection : list of Points
490. 
491.         Notes
492.         =====
493. 
494.         The return value will either be an empty list if there is no
495.         intersection, otherwise it will contain this point.
496. 
497.         Examples
498.         ========
499. 
500.         >>> from sympy import Point

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-24 00:14:02,255 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user requested the full content of `sympy/geometry/entity.py`. This context provides the complete file content as requested.', relative_path='sympy/geometry/entity.py', start_line=1, end_line=500), ContextOutput(reasoning='The user requested the full content of `sympy/geometry/point.py`. This context provides the complete file content as requested.', relative_path='sympy/geometry/point.py', start_line=1, end_line=500)]
2025-12-24 00:14:02,257 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 2 contexts to memory for query: Please provide the full content of `sympy/geometry/point.py` and `sympy/geometry/entity.py`.
2025-12-24 00:14:02,257 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-24 00:14:02,258 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-24 00:14:02,258 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 2 new contexts to 0 existing contexts
2025-12-24 00:14:02,258 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 2 total contexts (removed 0 duplicates)
2025-12-24 00:14:02,259 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
sympy
├── .ci
|   ├── README.rst
|   ├── generate_durations_log.sh
|   └── parse_durations_log.py
├── .github
|   └── FUNDING.yml
├── .travis.yml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── PULL_REQUEST_TEMPLATE.md
├── README.rst
├── bin
|   ├── ask_update.py
|   ├── authors_update.py
|   ├── coverage_doctest.py
|   ├── coverage_report.py
|   ├── generate_module_list.py
|   ├── generate_test_list.py
|   ├── get_sympy.py
|   ├── mailmap_update.py
|   ├── sympy_time.py
|   ├── sympy_time_cache.py
|   ├── test_executable.py
|   ├── test_external_imports.py
|   ├── test_import.py
|   ├── test_setup.py
|   └── test_travis.sh
├── codecov.yml
├── conftest.py
├── data
|   └── TeXmacs
|       ├── bin
|       └── progs
├── doc
|   ├── README.rst
|   ├── api
|   |   ├── conf.py
|   |   └── index.rst
|   ├── cheatsheet
|   ├── ext
|   |   ├── docscrape.py
|   |   ├── docscrape_sphinx.py
|   |   ├── numpydoc.py
|   |   └── sympylive.py
|   ├── generate_logos.py
|   ├── man
|   |   └── isympy.xml
|   └── src
|       ├── _static
|       ├── _templates
|       |   └── layout.html
|       ├── aboutus.rst
|       ├── citing.rst
|       ├── conf.py
|       ├── gotchas.rst
|       ├── guide.rst
|       ├── index.rst
|       ├── install.rst
|       ├── logo
|       |   └── info.txt
|       ├── modules
|       |   ├── algebras.rst
|       |   ├── assumptions
|       |   |   ├── ask.rst
|       |   |   ├── assume.rst
|       |   |   ├── handlers
|       |   |   ├── index.rst
|       |   |   └── refine.rst
|       |   ├── calculus
|       |   |   └── index.rst
|       |   ├── categories.rst
|       |   ├── codegen.rst
|       |   ├── combinatorics
|       |   |   ├── fp_groups.rst
|       |   |   ├── graycode.rst
|       |   |   ├── group_constructs.rst
|       |   |   ├── index.rst
|       |   |   ├── named_groups.rst
|       |   |   ├── partitions.rst
|       |   |   ├── pc_groups.rst
|       |   |   ├── perm_groups.rst
|       |   |   ├── permutations.rst
|       |   |   ├── polyhedron.rst
|       |   |   ├── prufer.rst
|       |   |   ├── subsets.rst
|       |   |   ├── tensor_can.rst
|       |   |   ├── testutil.rst
|       |   |   └── util.rst
|       |   ├── concrete.rst
|       |   ├── core.rst
|       |   ├── crypto.rst
|       |   ├── diffgeom.rst
|       |   ├── discrete.rst
|       |   ├── evalf.rst
|       |   ├── functions
|       |   |   ├── combinatorial.rst
|       |   |   ├── elementary.rst
|       |   |   ├── index.rst
|       |   |   └── special.rst
|       |   ├── geometry
|       |   |   ├── curves.rst
|       |   |   ├── ellipses.rst
|       |   |   ├── entities.rst
|       |   |   ├── index.rst
|       |   |   ├── lines.rst
|       |   |   ├── plane.rst
|       |   |   ├── points.rst
|       |   |   ├── polygons.rst
|       |   |   └── utils.rst
|       |   ├── holonomic
|       |   |   ├── about.rst
|       |   |   ├── convert.rst
|       |   |   ├── index.rst
|       |   |   ├── operations.rst
|       |   |   ├── represent.rst
|       |   |   └── uses.rst
|       |   ├── index.rst
|       |   ├── integrals
|       |   |   ├── g-functions.rst
|       |   |   └── integrals.rst
|       |   ├── liealgebras
|       |   |   └── index.rst
|       |   ├── logic.rst
|       |   ├── matrices
|       |   |   ├── common.rst
|       |   |   ├── dense.rst
|       |   |   ├── expressions.rst
|       |   |   ├── immutablematrices.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   └── sparse.rst
|       |   ├── ntheory.rst
|       |   ├── numeric-computation.rst
|       |   ├── parsing.rst
|       |   ├── physics
|       |   |   ├── continuum_mechanics
|       |   |   ├── hep
|       |   |   ├── hydrogen.rst
|       |   |   ├── index.rst
|       |   |   ├── matrices.rst
|       |   |   ├── mechanics
|       |   |   ├── optics
|       |   |   ├── paulialgebra.rst
|       |   |   ├── qho_1d.rst
|       |   |   ├── quantum
|       |   |   ├── secondquant.rst
|       |   |   ├── sho.rst
|       |   |   ├── units
|       |   |   ├── vector
|       |   |   └── wigner.rst
|       |   ├── plotting.rst
|       |   ├── polys
|       |   |   ├── agca.rst
|       |   |   ├── basics.rst
|       |   |   ├── index.rst
|       |   |   ├── internals.rst
|       |   |   ├── literature.rst
|       |   |   ├── reference.rst
|       |   |   ├── ringseries.rst
|       |   |   └── wester.rst
|       |   ├── printing.rst
|       |   ├── rewriting.rst
|       |   ├── series
|       |   |   ├── formal.rst
|       |   |   ├── fourier.rst
|       |   |   ├── index.rst
|       |   |   ├── limitseq.rst
|       |   |   ├── sequences.rst
|       |   |   └── series.rst
|       |   ├── sets.rst
|       |   ├── simplify
|       |   |   ├── hyperexpand.rst
|       |   |   └── simplify.rst
|       |   ├── solvers
|       |   |   ├── diophantine.rst
|       |   |   ├── inequalities.rst
|       |   |   ├── ode.rst
|       |   |   ├── pde.rst
|       |   |   ├── solvers.rst
|       |   |   └── solveset.rst
|       |   ├── stats.rst
|       |   ├── tensor
|       |   |   ├── array.rst
|       |   |   ├── index.rst
|       |   |   ├── index_methods.rst
|       |   |   ├── indexed.rst
|       |   |   └── tensor.rst
|       |   ├── utilities
|       |   |   ├── autowrap.rst
|       |   |   ├── codegen.rst
|       |   |   ├── decorator.rst
|       |   |   ├── enumerative.rst
|       |   |   ├── index.rst
|       |   |   ├── iterables.rst
|       |   |   ├── lambdify.rst
|       |   |   ├── memoization.rst
|       |   |   ├── misc.rst
|       |   |   ├── pkgdata.rst
|       |   |   ├── pytest.rst
|       |   |   ├── randtest.rst
|       |   |   ├── runtests.rst
|       |   |   ├── source.rst
|       |   |   └── timeutils.rst
|       |   └── vector
|       |       ├── api
|       |       ├── basics.rst
|       |       ├── coordsys.rst
|       |       ├── examples.rst
|       |       ├── fields.rst
|       |       ├── index.rst
|       |       └── intro.rst
|       ├── outreach.rst
|       ├── pics
|       ├── special_topics
|       |   ├── finite_diff_derivatives.rst
|       |   ├── index.rst
|       |   └── intro.rst
|       ├── tutorial
|       |   ├── basic_operations.rst
|       |   ├── calculus.rst
|       |   ├── gotchas.rst
|       |   ├── index.rst
|       |   ├── intro.rst
|       |   ├── manipulation.rst
|       |   ├── matrices.rst
|       |   ├── preliminaries.rst
|       |   ├── printing.rst
|       |   ├── simplification.rst
|       |   └── solvers.rst
|       └── wiki.rst
├── examples
|   ├── advanced
|   |   ├── autowrap_integrators.py
|   |   ├── autowrap_ufuncify.py
|   |   ├── curvilinear_coordinates.py
|   |   ├── dense_coding_example.py
|   |   ├── fem.py
|   |   ├── gibbs_phenomenon.py
|   |   ├── grover_example.py
|   |   ├── hydrogen.py
|   |   ├── pidigits.py
|   |   ├── pyglet_plotting.py
|   |   ├── qft.py
|   |   └── relativity.py
|   ├── all.py
|   ├── beginner
|   |   ├── basic.py
|   |   ├── differentiation.py
|   |   ├── expansion.py
|   |   ├── functions.py
|   |   ├── limits_examples.py
|   |   ├── plot_examples.py
|   |   ├── plotting_nice_plot.py
|   |   ├── precision.py
|   |   ├── print_pretty.py
|   |   ├── series.py
|   |   └── substitution.py
|   ├── intermediate
|   |   ├── coupled_cluster.py
|   |   ├── differential_equations.py
|   |   ├── infinite_1d_box.py
|   |   ├── mplot2d.py
|   |   ├── mplot3d.py
|   |   ├── partial_differential_eqs.py
|   |   ├── print_gtk.py
|   |   ├── sample.py
|   |   ├── trees.py
|   |   └── vandermonde.py
|   └── notebooks
|       └── README.txt
├── isympy.py
├── release
|   ├── Dockerfile
|   ├── README.md
|   ├── fabfile.py
|   ├── pull_and_run_rever.sh
|   └── release.sh
├── setup.py
├── setupegg.py
└── sympy
    ├── __init__.py
    ├── abc.py
    ├── algebras
    |   ├── __init__.py
    |   ├── quaternion.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_quaternion.py
    ├── assumptions
    |   ├── __init__.py
    |   ├── ask.py
    |   ├── ask_generated.py
    |   ├── assume.py
    |   ├── cnf.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── calculus.py
    |   |   ├── common.py
    |   |   ├── matrices.py
    |   |   ├── ntheory.py
    |   |   ├── order.py
    |   |   └── sets.py
    |   ├── refine.py
    |   ├── satask.py
    |   ├── sathandlers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_assumptions_2.py
    |       ├── test_context.py
    |       ├── test_matrices.py
    |       ├── test_query.py
    |       ├── test_refine.py
    |       ├── test_satask.py
    |       └── test_sathandlers.py
    ├── benchmarks
    |   ├── __init__.py
    |   ├── bench_discrete_log.py
    |   ├── bench_meijerint.py
    |   └── bench_symbench.py
    ├── calculus
    |   ├── __init__.py
    |   ├── euler.py
    |   ├── finite_diff.py
    |   ├── singularities.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_euler.py
    |   |   ├── test_finite_diff.py
    |   |   ├── test_singularities.py
    |   |   └── test_util.py
    |   └── util.py
    ├── categories
    |   ├── __init__.py
    |   ├── baseclasses.py
    |   ├── diagram_drawing.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_baseclasses.py
    |       └── test_drawing.py
    ├── codegen
    |   ├── __init__.py
    |   ├── algorithms.py
    |   ├── approximations.py
    |   ├── array_utils.py
    |   ├── ast.py
    |   ├── cfunctions.py
    |   ├── cnodes.py
    |   ├── cutils.py
    |   ├── cxxnodes.py
    |   ├── fnodes.py
    |   ├── futils.py
    |   ├── matrix_nodes.py
    |   ├── pyutils.py
    |   ├── rewriting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_algorithms.py
    |       ├── test_applications.py
    |       ├── test_approximations.py
    |       ├── test_array_utils.py
    |       ├── test_ast.py
    |       ├── test_cfunctions.py
    |       ├── test_cnodes.py
    |       ├── test_cxxnodes.py
    |       ├── test_fnodes.py
    |       ├── test_pyutils.py
    |       └── test_rewriting.py
    ├── combinatorics
    |   ├── __init__.py
    |   ├── coset_table.py
    |   ├── fp_groups.py
    |   ├── free_groups.py
    |   ├── generators.py
    |   ├── graycode.py
    |   ├── group_constructs.py
    |   ├── homomorphisms.py
    |   ├── named_groups.py
    |   ├── partitions.py
    |   ├── pc_groups.py
    |   ├── perm_groups.py
    |   ├── permutations.py
    |   ├── polyhedron.py
    |   ├── prufer.py
    |   ├── rewritingsystem.py
    |   ├── rewritingsystem_fsm.py
    |   ├── subsets.py
    |   ├── tensor_can.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_coset_table.py
    |   |   ├── test_fp_groups.py
    |   |   ├── test_free_groups.py
    |   |   ├── test_generators.py
    |   |   ├── test_graycode.py
    |   |   ├── test_group_constructs.py
    |   |   ├── test_homomorphisms.py
    |   |   ├── test_named_groups.py
    |   |   ├── test_partitions.py
    |   |   ├── test_pc_groups.py
    |   |   ├── test_perm_groups.py
    |   |   ├── test_permutations.py
    |   |   ├── test_polyhedron.py
    |   |   ├── test_prufer.py
    |   |   ├── test_rewriting.py
    |   |   ├── test_subsets.py
    |   |   ├── test_tensor_can.py
    |   |   ├── test_testutil.py
    |   |   └── test_util.py
    |   ├── testutil.py
    |   └── util.py
    ├── concrete
    |   ├── __init__.py
    |   ├── delta.py
    |   ├── expr_with_intlimits.py
    |   ├── expr_with_limits.py
    |   ├── gosper.py
    |   ├── guess.py
    |   ├── products.py
    |   ├── summations.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_delta.py
    |       ├── test_gosper.py
    |       ├── test_guess.py
    |       ├── test_products.py
    |       └── test_sums_products.py
    ├── conftest.py
    ├── core
    |   ├── __init__.py
    |   ├── add.py
    |   ├── alphabets.py
    |   ├── assumptions.py
    |   ├── backend.py
    |   ├── basic.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_arit.py
    |   |   ├── bench_assumptions.py
    |   |   ├── bench_basic.py
    |   |   ├── bench_expand.py
    |   |   ├── bench_numbers.py
    |   |   └── bench_sympify.py
    |   ├── cache.py
    |   ├── compatibility.py
    |   ├── containers.py
    |   ├── core.py
    |   ├── coreerrors.py
    |   ├── decorators.py
    |   ├── evalf.py
    |   ├── evaluate.py
    |   ├── expr.py
    |   ├── exprtools.py
    |   ├── facts.py
    |   ├── function.py
    |   ├── logic.py
    |   ├── mod.py
    |   ├── mul.py
    |   ├── multidimensional.py
    |   ├── numbers.py
    |   ├── operations.py
    |   ├── power.py
    |   ├── relational.py
    |   ├── rules.py
    |   ├── singleton.py
    |   ├── symbol.py
    |   ├── sympify.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_args.py
    |   |   ├── test_arit.py
    |   |   ├── test_assumptions.py
    |   |   ├── test_basic.py
    |   |   ├── test_cache.py
    |   |   ├── test_compatibility.py
    |   |   ├── test_complex.py
    |   |   ├── test_constructor_postprocessor.py
    |   |   ├── test_containers.py
    |   |   ├── test_count_ops.py
    |   |   ├── test_diff.py
    |   |   ├── test_equal.py
    |   |   ├── test_eval.py
    |   |   ├── test_evalf.py
    |   |   ├── test_evaluate.py
    |   |   ├── test_expand.py
    |   |   ├── test_expr.py
    |   |   ├── test_exprtools.py
    |   |   ├── test_facts.py
    |   |   ├── test_function.py
    |   |   ├── test_logic.py
    |   |   ├── test_match.py
    |   |   ├── test_multidimensional.py
    |   |   ├── test_noncommutative.py
    |   |   ├── test_numbers.py
    |   |   ├── test_operations.py
    |   |   ├── test_power.py
    |   |   ├── test_priority.py
    |   |   ├── test_relational.py
    |   |   ├── test_rules.py
    |   |   ├── test_singleton.py
    |   |   ├── test_subs.py
    |   |   ├── test_symbol.py
    |   |   ├── test_sympify.py
    |   |   ├── test_trace.py
    |   |   ├── test_truediv.py
    |   |   └── test_var.py
    |   └── trace.py
    ├── crypto
    |   ├── __init__.py
    |   ├── crypto.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_crypto.py
    ├── deprecated
    |   ├── __init__.py
    |   ├── class_registry.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_class_registry.py
    ├── diffgeom
    |   ├── __init__.py
    |   ├── diffgeom.py
    |   ├── rn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_class_structure.py
    |       ├── test_diffgeom.py
    |       ├── test_function_diffgeom_book.py
    |       └── test_hyperbolic_space.py
    ├── discrete
    |   ├── __init__.py
    |   ├── convolutions.py
    |   ├── recurrences.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_convolutions.py
    |   |   ├── test_recurrences.py
    |   |   └── test_transforms.py
    |   └── transforms.py
    ├── external
    |   ├── __init__.py
    |   ├── importtools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autowrap.py
    |       ├── test_codegen.py
    |       ├── test_importtools.py
    |       ├── test_numpy.py
    |       ├── test_sage.py
    |       └── test_scipy.py
    ├── functions
    |   ├── __init__.py
    |   ├── combinatorial
    |   |   ├── __init__.py
    |   |   ├── factorials.py
    |   |   ├── numbers.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_comb_factorials.py
    |   |       └── test_comb_numbers.py
    |   ├── elementary
    |   |   ├── __init__.py
    |   |   ├── benchmarks
    |   |   |   ├── __init__.py
    |   |   |   └── bench_exp.py
    |   |   ├── complexes.py
    |   |   ├── exponential.py
    |   |   ├── hyperbolic.py
    |   |   ├── integers.py
    |   |   ├── miscellaneous.py
    |   |   ├── piecewise.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_complexes.py
    |   |   |   ├── test_exponential.py
    |   |   |   ├── test_hyperbolic.py
    |   |   |   ├── test_integers.py
    |   |   |   ├── test_interface.py
    |   |   |   ├── test_miscellaneous.py
    |   |   |   ├── test_piecewise.py
    |   |   |   └── test_trigonometric.py
    |   |   └── trigonometric.py
    |   └── special
    |       ├── __init__.py
    |       ├── benchmarks
    |       |   ├── __init__.py
    |       |   └── bench_special.py
    |       ├── bessel.py
    |       ├── beta_functions.py
    |       ├── bsplines.py
    |       ├── delta_functions.py
    |       ├── elliptic_integrals.py
    |       ├── error_functions.py
    |       ├── gamma_functions.py
    |       ├── hyper.py
    |       ├── mathieu_functions.py
    |       ├── polynomials.py
    |       ├── singularity_functions.py
    |       ├── spherical_harmonics.py
    |       ├── tensor_functions.py
    |       ├── tests
    |       |   ├── __init__.py
    |       |   ├── test_bessel.py
    |       |   ├── test_beta_functions.py
    |       |   ├── test_bsplines.py
    |       |   ├── test_delta_functions.py
    |       |   ├── test_elliptic_integrals.py
    |       |   ├── test_error_functions.py
    |       |   ├── test_gamma_functions.py
    |       |   ├── test_hyper.py
    |       |   ├── test_mathieu.py
    |       |   ├── test_singularity_functions.py
    |       |   ├── test_spec_polynomials.py
    |       |   ├── test_spherical_harmonics.py
    |       |   ├── test_tensor_functions.py
    |       |   └── test_zeta_functions.py
    |       └── zeta_functions.py
    ├── galgebra.py
    ├── geometry
    |   ├── __init__.py
    |   ├── curve.py
    |   ├── ellipse.py
    |   ├── entity.py
    |   ├── exceptions.py
    |   ├── line.py
    |   ├── parabola.py
    |   ├── plane.py
    |   ├── point.py
    |   ├── polygon.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_curve.py
    |   |   ├── test_ellipse.py
    |   |   ├── test_entity.py
    |   |   ├── test_geometrysets.py
    |   |   ├── test_line.py
    |   |   ├── test_parabola.py
    |   |   ├── test_plane.py
    |   |   ├── test_point.py
    |   |   ├── test_polygon.py
    |   |   └── test_util.py
    |   └── util.py
    ├── holonomic
    |   ├── __init__.py
    |   ├── holonomic.py
    |   ├── holonomicerrors.py
    |   ├── linearsolver.py
    |   ├── numerical.py
    |   ├── recurrence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_holonomic.py
    |       └── test_recurrence.py
    ├── integrals
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_integrate.py
    |   |   └── bench_trigintegrate.py
    |   ├── deltafunctions.py
    |   ├── heurisch.py
    |   ├── integrals.py
    |   ├── intpoly.py
    |   ├── manualintegrate.py
    |   ├── meijerint.py
    |   ├── meijerint_doc.py
    |   ├── prde.py
    |   ├── quadrature.py
    |   ├── rationaltools.py
    |   ├── rde.py
    |   ├── risch.py
    |   ├── rubi
    |   |   ├── __init__.py
    |   |   ├── constraints.py
    |   |   ├── parsetools
    |   |   |   ├── __init__.py
    |   |   |   ├── generate_rules.py
    |   |   |   ├── generate_tests.py
    |   |   |   ├── header.py.txt
    |   |   |   ├── parse.py
    |   |   |   └── tests
    |   |   ├── rubi_tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests
    |   |   ├── rubimain.py
    |   |   ├── rules
    |   |   |   ├── __init__.py
    |   |   |   ├── binomial_products.py
    |   |   |   ├── exponential.py
    |   |   |   ├── hyperbolic.py
    |   |   |   ├── integrand_simplification.py
    |   |   |   ├── inverse_hyperbolic.py
    |   |   |   ├── inverse_trig.py
    |   |   |   ├── linear_products.py
    |   |   |   ├── logarithms.py
    |   |   |   ├── miscellaneous_algebraic.py
    |   |   |   ├── miscellaneous_integration.py
    |   |   |   ├── miscellaneous_trig.py
    |   |   |   ├── piecewise_linear.py
    |   |   |   ├── quadratic_products.py
    |   |   |   ├── secant.py
    |   |   |   ├── sine.py
    |   |   |   ├── special_functions.py
    |   |   |   ├── tangent.py
    |   |   |   └── trinomial_products.py
    |   |   ├── symbol.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_rubi_integrate.py
    |   |   |   └── test_utility_function.py
    |   |   └── utility_function.py
    |   ├── singularityfunctions.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_deltafunctions.py
    |   |   ├── test_failing_integrals.py
    |   |   ├── test_heurisch.py
    |   |   ├── test_integrals.py
    |   |   ├── test_intpoly.py
    |   |   ├── test_lineintegrals.py
    |   |   ├── test_manual.py
    |   |   ├── test_meijerint.py
    |   |   ├── test_prde.py
    |   |   ├── test_quadrature.py
    |   |   ├── test_rationaltools.py
    |   |   ├── test_rde.py
    |   |   ├── test_risch.py
    |   |   ├── test_singularityfunctions.py
    |   |   ├── test_transforms.py
    |   |   └── test_trigonometry.py
    |   ├── transforms.py
    |   └── trigonometry.py
    ├── interactive
    |   ├── __init__.py
    |   ├── ipythonprinting.py
    |   ├── printing.py
    |   ├── session.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_interactive.py
    |       ├── test_ipython.py
    |       └── test_ipythonprinting.py
    ├── liealgebras
    |   ├── __init__.py
    |   ├── cartan_matrix.py
    |   ├── cartan_type.py
    |   ├── dynkin_diagram.py
    |   ├── root_system.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_cartan_matrix.py
    |   |   ├── test_cartan_type.py
    |   |   ├── test_dynkin_diagram.py
    |   |   ├── test_root_system.py
    |   |   ├── test_type_A.py
    |   |   ├── test_type_B.py
    |   |   ├── test_type_C.py
    |   |   ├── test_type_D.py
    |   |   ├── test_type_E.py
    |   |   ├── test_type_F.py
    |   |   ├── test_type_G.py
    |   |   └── test_weyl_group.py
    |   ├── type_a.py
    |   ├── type_b.py
    |   ├── type_c.py
    |   ├── type_d.py
    |   ├── type_e.py
    |   ├── type_f.py
    |   ├── type_g.py
    |   └── weyl_group.py
    ├── logic
    |   ├── __init__.py
    |   ├── algorithms
    |   |   ├── __init__.py
    |   |   ├── dpll.py
    |   |   ├── dpll2.py
    |   |   └── pycosat_wrapper.py
    |   ├── boolalg.py
    |   ├── inference.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_boolalg.py
    |   |   ├── test_dimacs.py
    |   |   └── test_inference.py
    |   └── utilities
    |       ├── __init__.py
    |       └── dimacs.py
    ├── matrices
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_matrix.py
    |   ├── common.py
    |   ├── dense.py
    |   ├── densearith.py
    |   ├── densesolve.py
    |   ├── densetools.py
    |   ├── expressions
    |   |   ├── __init__.py
    |   |   ├── adjoint.py
    |   |   ├── applyfunc.py
    |   |   ├── blockmatrix.py
    |   |   ├── determinant.py
    |   |   ├── diagonal.py
    |   |   ├── dotproduct.py
    |   |   ├── factorizations.py
    |   |   ├── fourier.py
    |   |   ├── funcmatrix.py
    |   |   ├── hadamard.py
    |   |   ├── inverse.py
    |   |   ├── kronecker.py
    |   |   ├── matadd.py
    |   |   ├── matexpr.py
    |   |   ├── matmul.py
    |   |   ├── matpow.py
    |   |   ├── slice.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_adjoint.py
    |   |   |   ├── test_applyfunc.py
    |   |   |   ├── test_blockmatrix.py
    |   |   |   ├── test_derivatives.py
    |   |   |   ├── test_determinant.py
    |   |   |   ├── test_diagonal.py
    |   |   |   ├── test_dotproduct.py
    |   |   |   ├── test_factorizations.py
    |   |   |   ├── test_fourier.py
    |   |   |   ├── test_funcmatrix.py
    |   |   |   ├── test_hadamard.py
    |   |   |   ├── test_indexing.py
    |   |   |   ├── test_inverse.py
    |   |   |   ├── test_kronecker.py
    |   |   |   ├── test_matadd.py
    |   |   |   ├── test_matexpr.py
    |   |   |   ├── test_matmul.py
    |   |   |   ├── test_matpow.py
    |   |   |   ├── test_slice.py
    |   |   |   ├── test_trace.py
    |   |   |   └── test_transpose.py
    |   |   ├── trace.py
    |   |   └── transpose.py
    |   ├── immutable.py
    |   ├── matrices.py
    |   ├── normalforms.py
    |   ├── sparse.py
    |   ├── sparsetools.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_commonmatrix.py
    |       ├── test_densearith.py
    |       ├── test_densesolve.py
    |       ├── test_densetools.py
    |       ├── test_immutable.py
    |       ├── test_interactions.py
    |       ├── test_matrices.py
    |       ├── test_normalforms.py
    |       ├── test_sparse.py
    |       └── test_sparsetools.py
    ├── multipledispatch
    |   ├── __init__.py
    |   ├── conflict.py
    |   ├── core.py
    |   ├── dispatcher.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_conflict.py
    |   |   ├── test_core.py
    |   |   └── test_dispatcher.py
    |   └── utils.py
    ├── ntheory
    |   ├── __init__.py
    |   ├── bbp_pi.py
    |   ├── continued_fraction.py
    |   ├── egyptian_fraction.py
    |   ├── factor_.py
    |   ├── generate.py
    |   ├── modular.py
    |   ├── multinomial.py
    |   ├── partitions_.py
    |   ├── primetest.py
    |   ├── residue_ntheory.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bbp_pi.py
    |       ├── test_continued_fraction.py
    |       ├── test_egyptian_fraction.py
    |       ├── test_factor_.py
    |       ├── test_generate.py
    |       ├── test_modular.py
    |       ├── test_multinomial.py
    |       ├── test_partitions.py
    |       ├── test_primetest.py
    |       └── test_residue.py
    ├── parsing
    |   ├── __init__.py
    |   ├── ast_parser.py
    |   ├── autolev
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── autolevlexer.py
    |   |   |   ├── autolevlistener.py
    |   |   |   └── autolevparser.py
    |   |   ├── _listener_autolev_antlr.py
    |   |   ├── _parse_autolev_antlr.py
    |   |   └── test-examples
    |   |       ├── __init__.py
    |   |       ├── pydy-example-repo
    |   |       ├── ruletest1.py
    |   |       ├── ruletest10.py
    |   |       ├── ruletest11.py
    |   |       ├── ruletest12.py
    |   |       ├── ruletest2.py
    |   |       ├── ruletest3.py
    |   |       ├── ruletest4.py
    |   |       ├── ruletest5.py
    |   |       ├── ruletest6.py
    |   |       ├── ruletest7.py
    |   |       ├── ruletest8.py
    |   |       └── ruletest9.py
    |   ├── c
    |   |   ├── __init__.py
    |   |   └── c_parser.py
    |   ├── fortran
    |   |   ├── __init__.py
    |   |   └── fortran_parser.py
    |   ├── latex
    |   |   ├── LICENSE.txt
    |   |   ├── __init__.py
    |   |   ├── _antlr
    |   |   |   ├── __init__.py
    |   |   |   ├── latexlexer.py
    |   |   |   └── latexparser.py
    |   |   ├── _build_latex_antlr.py
    |   |   ├── _parse_latex_antlr.py
    |   |   └── errors.py
    |   ├── mathematica.py
    |   ├── maxima.py
    |   ├── sym_expr.py
    |   ├── sympy_parser.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_autolev.py
    |       ├── test_c_parser.py
    |       ├── test_fortran_parser.py
    |       ├── test_implicit_multiplication_application.py
    |       ├── test_latex.py
    |       ├── test_latex_deps.py
    |       ├── test_mathematica.py
    |       ├── test_maxima.py
    |       ├── test_sym_expr.py
    |       └── test_sympy_parser.py
    ├── physics
    |   ├── __init__.py
    |   ├── continuum_mechanics
    |   |   ├── __init__.py
    |   |   ├── beam.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_beam.py
    |   ├── gaussopt.py
    |   ├── hep
    |   |   ├── __init__.py
    |   |   ├── gamma_matrices.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_gamma_matrices.py
    |   ├── hydrogen.py
    |   ├── matrices.py
    |   ├── mechanics
    |   |   ├── __init__.py
    |   |   ├── body.py
    |   |   ├── functions.py
    |   |   ├── kane.py
    |   |   ├── lagrange.py
    |   |   ├── linearize.py
    |   |   ├── models.py
    |   |   ├── particle.py
    |   |   ├── rigidbody.py
    |   |   ├── system.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_body.py
    |   |       ├── test_functions.py
    |   |       ├── test_kane.py
    |   |       ├── test_kane2.py
    |   |       ├── test_kane3.py
    |   |       ├── test_kane4.py
    |   |       ├── test_lagrange.py
    |   |       ├── test_lagrange2.py
    |   |       ├── test_linearize.py
    |   |       ├── test_models.py
    |   |       ├── test_particle.py
    |   |       ├── test_rigidbody.py
    |   |       └── test_system.py
    |   ├── optics
    |   |   ├── __init__.py
    |   |   ├── gaussopt.py
    |   |   ├── medium.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_gaussopt.py
    |   |   |   ├── test_medium.py
    |   |   |   ├── test_utils.py
    |   |   |   └── test_waves.py
    |   |   ├── utils.py
    |   |   └── waves.py
    |   ├── paulialgebra.py
    |   ├── pring.py
    |   ├── qho_1d.py
    |   ├── quantum
    |   |   ├── __init__.py
    |   |   ├── anticommutator.py
    |   |   ├── boson.py
    |   |   ├── cartesian.py
    |   |   ├── cg.py
    |   |   ├── circuitplot.py
    |   |   ├── circuitutils.py
    |   |   ├── commutator.py
    |   |   ├── constants.py
    |   |   ├── dagger.py
    |   |   ├── density.py
    |   |   ├── fermion.py
    |   |   ├── gate.py
    |   |   ├── grover.py
    |   |   ├── hilbert.py
    |   |   ├── identitysearch.py
    |   |   ├── innerproduct.py
    |   |   ├── matrixcache.py
    |   |   ├── matrixutils.py
    |   |   ├── operator.py
    |   |   ├── operatorordering.py
    |   |   ├── operatorset.py
    |   |   ├── pauli.py
    |   |   ├── piab.py
    |   |   ├── qapply.py
    |   |   ├── qasm.py
    |   |   ├── qexpr.py
    |   |   ├── qft.py
    |   |   ├── qubit.py
    |   |   ├── represent.py
    |   |   ├── sho1d.py
    |   |   ├── shor.py
    |   |   ├── spin.py
    |   |   ├── state.py
    |   |   ├── tensorproduct.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_anticommutator.py
    |   |       ├── test_boson.py
    |   |       ├── test_cartesian.py
    |   |       ├── test_cg.py
    |   |       ├── test_circuitplot.py
    |   |       ├── test_circuitutils.py
    |   |       ├── test_commutator.py
    |   |       ├── test_constants.py
    |   |       ├── test_dagger.py
    |   |       ├── test_density.py
    |   |       ├── test_fermion.py
    |   |       ├── test_gate.py
    |   |       ├── test_grover.py
    |   |       ├── test_hilbert.py
    |   |       ├── test_identitysearch.py
    |   |       ├── test_innerproduct.py
    |   |       ├── test_matrixutils.py
    |   |       ├── test_operator.py
    |   |       ├── test_operatorordering.py
    |   |       ├── test_operatorset.py
    |   |       ├── test_pauli.py
    |   |       ├── test_piab.py
    |   |       ├── test_printing.py
    |   |       ├── test_qapply.py
    |   |       ├── test_qasm.py
    |   |       ├── test_qexpr.py
    |   |       ├── test_qft.py
    |   |       ├── test_qubit.py
    |   |       ├── test_represent.py
    |   |       ├── test_sho1d.py
    |   |       ├── test_shor.py
    |   |       ├── test_spin.py
    |   |       ├── test_state.py
    |   |       └── test_tensorproduct.py
    |   ├── secondquant.py
    |   ├── sho.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_clebsch_gordan.py
    |   |   ├── test_hydrogen.py
    |   |   ├── test_paulialgebra.py
    |   |   ├── test_physics_matrices.py
    |   |   ├── test_pring.py
    |   |   ├── test_qho_1d.py
    |   |   ├── test_secondquant.py
    |   |   └── test_sho.py
    |   ├── units
    |   |   ├── __init__.py
    |   |   ├── definitions.py
    |   |   ├── dimensions.py
    |   |   ├── prefixes.py
    |   |   ├── quantities.py
    |   |   ├── systems
    |   |   |   ├── __init__.py
    |   |   |   ├── mks.py
    |   |   |   ├── mksa.py
    |   |   |   ├── natural.py
    |   |   |   └── si.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dimensions.py
    |   |   |   ├── test_dimensionsystem.py
    |   |   |   ├── test_prefixes.py
    |   |   |   ├── test_quantities.py
    |   |   |   ├── test_unitsystem.py
    |   |   |   └── test_util.py
    |   |   ├── unitsystem.py
    |   |   └── util.py
    |   ├── vector
    |   |   ├── __init__.py
    |   |   ├── dyadic.py
    |   |   ├── fieldfunctions.py
    |   |   ├── frame.py
    |   |   ├── functions.py
    |   |   ├── point.py
    |   |   ├── printing.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_dyadic.py
    |   |   |   ├── test_fieldfunctions.py
    |   |   |   ├── test_frame.py
    |   |   |   ├── test_functions.py
    |   |   |   ├── test_output.py
    |   |   |   ├── test_point.py
    |   |   |   ├── test_printing.py
    |   |   |   └── test_vector.py
    |   |   └── vector.py
    |   └── wigner.py
    ├── plotting
    |   ├── __init__.py
    |   ├── experimental_lambdify.py
    |   ├── intervalmath
    |   |   ├── __init__.py
    |   |   ├── interval_arithmetic.py
    |   |   ├── lib_interval.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_interval_functions.py
    |   |       └── test_intervalmath.py
    |   ├── plot.py
    |   ├── plot_implicit.py
    |   ├── pygletplot
    |   |   ├── __init__.py
    |   |   ├── color_scheme.py
    |   |   ├── managed_window.py
    |   |   ├── plot.py
    |   |   ├── plot_axes.py
    |   |   ├── plot_camera.py
    |   |   ├── plot_controller.py
    |   |   ├── plot_curve.py
    |   |   ├── plot_interval.py
    |   |   ├── plot_mode.py
    |   |   ├── plot_mode_base.py
    |   |   ├── plot_modes.py
    |   |   ├── plot_object.py
    |   |   ├── plot_rotation.py
    |   |   ├── plot_surface.py
    |   |   ├── plot_window.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_plotting.py
    |   |   └── util.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_plot.py
    |   |   └── test_plot_implicit.py
    |   └── textplot.py
    ├── polys
    |   ├── __init__.py
    |   ├── agca
    |   |   ├── __init__.py
    |   |   ├── extensions.py
    |   |   ├── homomorphisms.py
    |   |   ├── ideals.py
    |   |   ├── modules.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_extensions.py
    |   |       ├── test_homomorphisms.py
    |   |       ├── test_ideals.py
    |   |       └── test_modules.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_galoispolys.py
    |   |   ├── bench_groebnertools.py
    |   |   └── bench_solvers.py
    |   ├── compatibility.py
    |   ├── constructor.py
    |   ├── densearith.py
    |   ├── densebasic.py
    |   ├── densetools.py
    |   ├── dispersion.py
    |   ├── distributedmodules.py
    |   ├── domains
    |   |   ├── __init__.py
    |   |   ├── algebraicfield.py
    |   |   ├── characteristiczero.py
    |   |   ├── complexfield.py
    |   |   ├── compositedomain.py
    |   |   ├── domain.py
    |   |   ├── domainelement.py
    |   |   ├── expressiondomain.py
    |   |   ├── field.py
    |   |   ├── finitefield.py
    |   |   ├── fractionfield.py
    |   |   ├── gmpyfinitefield.py
    |   |   ├── gmpyintegerring.py
    |   |   ├── gmpyrationalfield.py
    |   |   ├── groundtypes.py
    |   |   ├── integerring.py
    |   |   ├── modularinteger.py
    |   |   ├── mpelements.py
    |   |   ├── old_fractionfield.py
    |   |   ├── old_polynomialring.py
    |   |   ├── polynomialring.py
    |   |   ├── pythonfinitefield.py
    |   |   ├── pythonintegerring.py
    |   |   ├── pythonrational.py
    |   |   ├── pythonrationalfield.py
    |   |   ├── quotientring.py
    |   |   ├── rationalfield.py
    |   |   ├── realfield.py
    |   |   ├── ring.py
    |   |   ├── simpledomain.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_domains.py
    |   |       ├── test_polynomialring.py
    |   |       └── test_quotientring.py
    |   ├── euclidtools.py
    |   ├── factortools.py
    |   ├── fglmtools.py
    |   ├── fields.py
    |   ├── galoistools.py
    |   ├── groebnertools.py
    |   ├── heuristicgcd.py
    |   ├── modulargcd.py
    |   ├── monomials.py
    |   ├── multivariate_resultants.py
    |   ├── numberfields.py
    |   ├── orderings.py
    |   ├── orthopolys.py
    |   ├── partfrac.py
    |   ├── polyclasses.py
    |   ├── polyconfig.py
    |   ├── polyerrors.py
    |   ├── polyfuncs.py
    |   ├── polymatrix.py
    |   ├── polyoptions.py
    |   ├── polyquinticconst.py
    |   ├── polyroots.py
    |   ├── polytools.py
    |   ├── polyutils.py
    |   ├── rationaltools.py
    |   ├── ring_series.py
    |   ├── rings.py
    |   ├── rootisolation.py
    |   ├── rootoftools.py
    |   ├── solvers.py
    |   ├── specialpolys.py
    |   ├── sqfreetools.py
    |   ├── subresultants_qq_zz.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constructor.py
    |       ├── test_densearith.py
    |       ├── test_densebasic.py
    |       ├── test_densetools.py
    |       ├── test_dispersion.py
    |       ├── test_distributedmodules.py
    |       ├── test_euclidtools.py
    |       ├── test_factortools.py
    |       ├── test_fields.py
    |       ├── test_galoistools.py
    |       ├── test_groebnertools.py
    |       ├── test_heuristicgcd.py
    |       ├── test_injections.py
    |       ├── test_modulargcd.py
    |       ├── test_monomials.py
    |       ├── test_multivariate_resultants.py
    |       ├── test_numberfields.py
    |       ├── test_orderings.py
    |       ├── test_orthopolys.py
    |       ├── test_partfrac.py
    |       ├── test_polyclasses.py
    |       ├── test_polyfuncs.py
    |       ├── test_polymatrix.py
    |       ├── test_polyoptions.py
    |       ├── test_polyroots.py
    |       ├── test_polytools.py
    |       ├── test_polyutils.py
    |       ├── test_pythonrational.py
    |       ├── test_rationaltools.py
    |       ├── test_ring_series.py
    |       ├── test_rings.py
    |       ├── test_rootisolation.py
    |       ├── test_rootoftools.py
    |       ├── test_solvers.py
    |       ├── test_specialpolys.py
    |       ├── test_sqfreetools.py
    |       └── test_subresultants_qq_zz.py
    ├── printing
    |   ├── __init__.py
    |   ├── ccode.py
    |   ├── codeprinter.py
    |   ├── conventions.py
    |   ├── cxxcode.py
    |   ├── defaults.py
    |   ├── dot.py
    |   ├── fcode.py
    |   ├── glsl.py
    |   ├── gtk.py
    |   ├── jscode.py
    |   ├── julia.py
    |   ├── lambdarepr.py
    |   ├── latex.py
    |   ├── llvmjitcode.py
    |   ├── maple.py
    |   ├── mathematica.py
    |   ├── mathml.py
    |   ├── octave.py
    |   ├── precedence.py
    |   ├── pretty
    |   |   ├── __init__.py
    |   |   ├── pretty.py
    |   |   ├── pretty_symbology.py
    |   |   ├── stringpict.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_pretty.py
    |   ├── preview.py
    |   ├── printer.py
    |   ├── pycode.py
    |   ├── python.py
    |   ├── rcode.py
    |   ├── repr.py
    |   ├── rust.py
    |   ├── str.py
    |   ├── tableform.py
    |   ├── tensorflow.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_ccode.py
    |   |   ├── test_codeprinter.py
    |   |   ├── test_conventions.py
    |   |   ├── test_cxxcode.py
    |   |   ├── test_dot.py
    |   |   ├── test_fcode.py
    |   |   ├── test_glsl.py
    |   |   ├── test_gtk.py
    |   |   ├── test_jscode.py
    |   |   ├── test_julia.py
    |   |   ├── test_lambdarepr.py
    |   |   ├── test_latex.py
    |   |   ├── test_llvmjit.py
    |   |   ├── test_maple.py
    |   |   ├── test_mathematica.py
    |   |   ├── test_mathml.py
    |   |   ├── test_numpy.py
    |   |   ├── test_octave.py
    |   |   ├── test_precedence.py
    |   |   ├── test_preview.py
    |   |   ├── test_pycode.py
    |   |   ├── test_python.py
    |   |   ├── test_rcode.py
    |   |   ├── test_repr.py
    |   |   ├── test_rust.py
    |   |   ├── test_str.py
    |   |   ├── test_tableform.py
    |   |   ├── test_tensorflow.py
    |   |   ├── test_theanocode.py
    |   |   └── test_tree.py
    |   ├── theanocode.py
    |   └── tree.py
    ├── release.py
    ├── sandbox
    |   ├── __init__.py
    |   ├── indexed_integrals.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_indexed_integrals.py
    ├── series
    |   ├── __init__.py
    |   ├── acceleration.py
    |   ├── approximants.py
    |   ├── aseries.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   ├── bench_limit.py
    |   |   └── bench_order.py
    |   ├── formal.py
    |   ├── fourier.py
    |   ├── gruntz.py
    |   ├── kauers.py
    |   ├── limits.py
    |   ├── limitseq.py
    |   ├── order.py
    |   ├── residues.py
    |   ├── sequences.py
    |   ├── series.py
    |   ├── series_class.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_approximants.py
    |       ├── test_aseries.py
    |       ├── test_demidovich.py
    |       ├── test_formal.py
    |       ├── test_fourier.py
    |       ├── test_gruntz.py
    |       ├── test_kauers.py
    |       ├── test_limits.py
    |       ├── test_limitseq.py
    |       ├── test_lseries.py
    |       ├── test_nseries.py
    |       ├── test_order.py
    |       ├── test_residues.py
    |       ├── test_sequences.py
    |       └── test_series.py
    ├── sets
    |   ├── __init__.py
    |   ├── conditionset.py
    |   ├── contains.py
    |   ├── fancysets.py
    |   ├── handlers
    |   |   ├── __init__.py
    |   |   ├── add.py
    |   |   ├── functions.py
    |   |   ├── intersection.py
    |   |   ├── mul.py
    |   |   ├── power.py
    |   |   └── union.py
    |   ├── ordinals.py
    |   ├── setexpr.py
    |   ├── sets.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_conditionset.py
    |       ├── test_contains.py
    |       ├── test_fancysets.py
    |       ├── test_ordinals.py
    |       ├── test_setexpr.py
    |       └── test_sets.py
    ├── simplify
    |   ├── __init__.py
    |   ├── combsimp.py
    |   ├── cse_main.py
    |   ├── cse_opts.py
    |   ├── epathtools.py
    |   ├── fu.py
    |   ├── gammasimp.py
    |   ├── hyperexpand.py
    |   ├── hyperexpand_doc.py
    |   ├── powsimp.py
    |   ├── radsimp.py
    |   ├── ratsimp.py
    |   ├── simplify.py
    |   ├── sqrtdenest.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_combsimp.py
    |   |   ├── test_cse.py
    |   |   ├── test_epathtools.py
    |   |   ├── test_fu.py
    |   |   ├── test_function.py
    |   |   ├── test_gammasimp.py
    |   |   ├── test_hyperexpand.py
    |   |   ├── test_powsimp.py
    |   |   ├── test_radsimp.py
    |   |   ├── test_ratsimp.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_simplify.py
    |   |   ├── test_sqrtdenest.py
    |   |   ├── test_traversaltools.py
    |   |   └── test_trigsimp.py
    |   ├── traversaltools.py
    |   └── trigsimp.py
    ├── solvers
    |   ├── __init__.py
    |   ├── benchmarks
    |   |   ├── __init__.py
    |   |   └── bench_solvers.py
    |   ├── bivariate.py
    |   ├── decompogen.py
    |   ├── deutils.py
    |   ├── diophantine.py
    |   ├── inequalities.py
    |   ├── ode.py
    |   ├── pde.py
    |   ├── polysys.py
    |   ├── recurr.py
    |   ├── solvers.py
    |   ├── solveset.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_constantsimp.py
    |       ├── test_decompogen.py
    |       ├── test_diophantine.py
    |       ├── test_inequalities.py
    |       ├── test_numeric.py
    |       ├── test_ode.py
    |       ├── test_pde.py
    |       ├── test_polysys.py
    |       ├── test_recurr.py
    |       ├── test_solvers.py
    |       └── test_solveset.py
    ├── stats
    |   ├── __init__.py
    |   ├── crv.py
    |   ├── crv_types.py
    |   ├── drv.py
    |   ├── drv_types.py
    |   ├── error_prop.py
    |   ├── frv.py
    |   ├── frv_types.py
    |   ├── joint_rv.py
    |   ├── joint_rv_types.py
    |   ├── random_matrix.py
    |   ├── random_matrix_models.py
    |   ├── rv.py
    |   ├── rv_interface.py
    |   ├── stochastic_process.py
    |   ├── stochastic_process_types.py
    |   ├── symbolic_probability.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_continuous_rv.py
    |       ├── test_discrete_rv.py
    |       ├── test_error_prop.py
    |       ├── test_finite_rv.py
    |       ├── test_joint_rv.py
    |       ├── test_mix.py
    |       ├── test_random_matrix.py
    |       ├── test_rv.py
    |       ├── test_stochastic_process.py
    |       └── test_symbolic_probability.py
    ├── strategies
    |   ├── __init__.py
    |   ├── branch
    |   |   ├── __init__.py
    |   |   ├── core.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   ├── test_core.py
    |   |   |   ├── test_tools.py
    |   |   |   └── test_traverse.py
    |   |   ├── tools.py
    |   |   └── traverse.py
    |   ├── core.py
    |   ├── rl.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_core.py
    |   |   ├── test_rl.py
    |   |   ├── test_strat.py
    |   |   ├── test_tools.py
    |   |   ├── test_traverse.py
    |   |   └── test_tree.py
    |   ├── tools.py
    |   ├── traverse.py
    |   ├── tree.py
    |   └── util.py
    ├── tensor
    |   ├── __init__.py
    |   ├── array
    |   |   ├── __init__.py
    |   |   ├── array_comprehension.py
    |   |   ├── arrayop.py
    |   |   ├── dense_ndim_array.py
    |   |   ├── mutable_ndim_array.py
    |   |   ├── ndim_array.py
    |   |   ├── sparse_ndim_array.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_array_comprehension.py
    |   |       ├── test_arrayop.py
    |   |       ├── test_immutable_ndim_array.py
    |   |       ├── test_mutable_ndim_array.py
    |   |       └── test_ndim_array_conversions.py
    |   ├── functions.py
    |   ├── index_methods.py
    |   ├── indexed.py
    |   ├── tensor.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_functions.py
    |   |   ├── test_index_methods.py
    |   |   ├── test_indexed.py
    |   |   ├── test_tensor.py
    |   |   ├── test_tensor_element.py
    |   |   └── test_tensor_operators.py
    |   └── toperators.py
    ├── this.py
    ├── unify
    |   ├── __init__.py
    |   ├── core.py
    |   ├── rewrite.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_rewrite.py
    |   |   ├── test_sympy.py
    |   |   └── test_unify.py
    |   └── usympy.py
    ├── utilities
    |   ├── __init__.py
    |   ├── _compilation
    |   |   ├── __init__.py
    |   |   ├── availability.py
    |   |   ├── compilation.py
    |   |   ├── runners.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── test_compilation.py
    |   |   └── util.py
    |   ├── autowrap.py
    |   ├── benchmarking.py
    |   ├── codegen.py
    |   ├── decorator.py
    |   ├── enumerative.py
    |   ├── exceptions.py
    |   ├── iterables.py
    |   ├── lambdify.py
    |   ├── magic.py
    |   ├── matchpy_connector.py
    |   ├── mathml
    |   |   ├── __init__.py
    |   |   └── data
    |   ├── memoization.py
    |   ├── misc.py
    |   ├── pkgdata.py
    |   ├── pytest.py
    |   ├── randtest.py
    |   ├── runtests.py
    |   ├── source.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── diagnose_imports.py
    |   |   ├── test_autowrap.py
    |   |   ├── test_code_quality.py
    |   |   ├── test_codegen.py
    |   |   ├── test_codegen_julia.py
    |   |   ├── test_codegen_octave.py
    |   |   ├── test_codegen_rust.py
    |   |   ├── test_decorator.py
    |   |   ├── test_enumerative.py
    |   |   ├── test_iterables.py
    |   |   ├── test_lambdify.py
    |   |   ├── test_misc.py
    |   |   ├── test_module_imports.py
    |   |   ├── test_pickling.py
    |   |   ├── test_pytest.py
    |   |   ├── test_source.py
    |   |   ├── test_timeutils.py
    |   |   └── test_wester.py
    |   ├── timeutils.py
    |   └── tmpfiles.py
    └── vector
        ├── __init__.py
        ├── basisdependent.py
        ├── coordsysrect.py
        ├── deloperator.py
        ├── dyadic.py
        ├── functions.py
        ├── operators.py
        ├── orienters.py
        ├── point.py
        ├── scalar.py
        ├── tests
        |   ├── __init__.py
        |   ├── test_coordsysrect.py
        |   ├── test_dyadic.py
        |   ├── test_field_functions.py
        |   ├── test_functions.py
        |   ├── test_operators.py
        |   ├── test_printing.py
        |   └── test_vector.py
        └── vector.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: Unexpected exception when multiplying geometry.Point and number

Description: ```python
from sympy import geometry as ge
import sympy

point1 = ge.Point(0,0)
point2 = ge.Point(1,1)
```

This line works fine
```python
point1 + point2 * sympy.sympify(2.0)
```

But when I write the same this way it raises an exception
```python
point1 + sympy.sympify(2.0) * point2
```

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __add__(self, other)
    219         try:
--> 220             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
    221         except TypeError:

~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __new__(cls, *args, **kwargs)
    128                 Expecting sequence of coordinates, not `{}`'''
--> 129                                        .format(func_name(coords))))
    130         # A point where only `dim` is specified is initialized

TypeError: 
Expecting sequence of coordinates, not `Mul`

During handling of the above exception, another exception occurred:

GeometryError                             Traceback (most recent call last)
<ipython-input-20-6dcbddac1ee2> in <module>
----> 1 point1 + sympy.sympify(2.0)* point2

~/.virtualenvs/test/lib/python3.6/site-packages/sympy/geometry/point.py in __add__(self, other)
    220             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
    221         except TypeError:
--> 222             raise GeometryError("Don't know how to add {} and a Point object".format(other))
    223 
    224         coords = [simplify(a + b) for a, b in zip(s, o)]

GeometryError: Don't know how to add 2.0*Point2D(1, 1) and a Point object
```

The expected behaviour is, that both lines give the same result

Patch information:
diff --git a/sympy/geometry/entity.py b/sympy/geometry/entity.py
index ee5c910268..c882fb5a30 100644
--- a/sympy/geometry/entity.py
+++ b/sympy/geometry/entity.py
@@ -139,7 +139,7 @@ def __repr__(self):
 
     def __rmul__(self, a):
         """Implementation of reverse multiplication method."""
-        return a.__mul__(self)
+        return self.__mul__(a)
 
     def __rsub__(self, a):
         """Implementation of reverse subtraction method."""
diff --git a/sympy/geometry/point.py b/sympy/geometry/point.py
index 7c978c47be..da785798e3 100644
--- a/sympy/geometry/point.py
+++ b/sympy/geometry/point.py
@@ -213,6 +213,17 @@ def __add__(self, other):
         sympy.geometry.point.Point.translate
 
         """
+        from sympy.core.mul import Mul
+        if isinstance(other, Mul) and any(isinstance(arg, Point) for arg in other.args):
+            # Handle case like point1 + sympy.sympify(2.0) * point2
+            # Find the Point in the Mul args
+            point_arg = next(arg for arg in other.args if isinstance(arg, Point))
+            # Get the remaining factor
+            factor = Mul(*[arg for arg in other.args if arg != point_arg])
+            # Multiply the point by the factor
+            scaled_point = point_arg * factor
+            # Add the scaled point to self
+            return self + scaled_point
         try:
             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
         except TypeError:


Find all relevant source code context needed to understand and fix this issue.
Focus on production code (ignore test files) and follow these steps:
1. Identify key components mentioned in the issue, especially from the error message(functions, classes, types, etc.)
2. Find their complete implementations and class definitions
3. Include related code from the same module that affects the behavior
4. Follow imports to find dependent code that directly impacts the issue

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of `sympy/geometry/point.py` and `sympy/geometry/entity.py`.
Extra Requirements: 
Purpose: This will allow me to analyze the implementation of `Point` and `Entity` classes, understand how they handle arithmetic operations, and determine why the reverse multiplication fails, and determine why the reverse multiplication fails.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sympy/geometry/entity.py
Line number range: 1 - 500
Content:
1. """The definition of the base geometrical entity with attributes common to
2. all derived geometrical entities.
3. 
4. Contains
5. ========
6. 
7. GeometryEntity
8. GeometricSet
9. 
10. Notes
11. =====
12. 
13. A GeometryEntity is any object that has special geometric properties.
14. A GeometrySet is a superclass of any GeometryEntity that can also
15. be viewed as a sympy.sets.Set.  In particular, points are the only
16. GeometryEntity not considered a Set.
17. 
18. Rn is a GeometrySet representing n-dimensional Euclidean space. R2 and
19. R3 are currently the only ambient spaces implemented.
20. 
21. """
22. 
23. from __future__ import division, print_function
24. 
25. from sympy.core.basic import Basic
26. from sympy.core.compatibility import is_sequence
27. from sympy.core.containers import Tuple
28. from sympy.core.sympify import sympify
29. from sympy.functions import cos, sin
30. from sympy.matrices import eye
31. from sympy.multipledispatch import dispatch
32. from sympy.sets import Set
33. from sympy.sets.handlers.intersection import intersection_sets
34. from sympy.sets.handlers.union import union_sets
35. from sympy.utilities.misc import func_name
36. 
37. 
38. # How entities are ordered; used by __cmp__ in GeometryEntity
39. ordering_of_classes = [
40.     "Point2D",
41.     "Point3D",
42.     "Point",
43.     "Segment2D",
44.     "Ray2D",
45.     "Line2D",
46.     "Segment3D",
47.     "Line3D",
48.     "Ray3D",
49.     "Segment",
50.     "Ray",
51.     "Line",
52.     "Plane",
53.     "Triangle",
54.     "RegularPolygon",
55.     "Polygon",
56.     "Circle",
57.     "Ellipse",
58.     "Curve",
59.     "Parabola"
60. ]
61. 
62. 
63. class GeometryEntity(Basic):
64.     """The base class for all geometrical entities.
65. 
66.     This class doesn't represent any particular geometric entity, it only
67.     provides the implementation of some methods common to all subclasses.
68. 
69.     """
70. 
71.     def __cmp__(self, other):
72.         """Comparison of two GeometryEntities."""
73.         n1 = self.__class__.__name__
74.         n2 = other.__class__.__name__
75.         c = (n1 > n2) - (n1 < n2)
76.         if not c:
77.             return 0
78. 
79.         i1 = -1
80.         for cls in self.__class__.__mro__:
81.             try:
82.                 i1 = ordering_of_classes.index(cls.__name__)
83.                 break
84.             except ValueError:
85.                 i1 = -1
86.         if i1 == -1:
87.             return c
88. 
89.         i2 = -1
90.         for cls in other.__class__.__mro__:
91.             try:
92.                 i2 = ordering_of_classes.index(cls.__name__)
93.                 break
94.             except ValueError:
95.                 i2 = -1
96.         if i2 == -1:
97.             return c
98. 
99.         return (i1 > i2) - (i1 < i2)
100. 
101.     def __contains__(self, other):
102.         """Subclasses should implement this method for anything more complex than equality."""
103.         if type(self) == type(other):
104.             return self == other
105.         raise NotImplementedError()
106. 
107.     def __getnewargs__(self):
108.         """Returns a tuple that will be passed to __new__ on unpickling."""
109.         return tuple(self.args)
110. 
111.     def __ne__(self, o):
112.         """Test inequality of two geometrical entities."""
113.         return not self == o
114. 
115.     def __new__(cls, *args, **kwargs):
116.         # Points are sequences, but they should not
117.         # be converted to Tuples, so use this detection function instead.
118.         def is_seq_and_not_point(a):
119.             # we cannot use isinstance(a, Point) since we cannot import Point
120.             if hasattr(a, 'is_Point') and a.is_Point:
121.                 return False
122.             return is_sequence(a)
123. 
124.         args = [Tuple(*a) if is_seq_and_not_point(a) else sympify(a) for a in args]
125.         return Basic.__new__(cls, *args)
126. 
127.     def __radd__(self, a):
128.         """Implementation of reverse add method."""
129.         return a.__add__(self)
130. 
131.     def __rdiv__(self, a):
132.         """Implementation of reverse division method."""
133.         return a.__div__(self)
134. 
135.     def __repr__(self):
136.         """String representation of a GeometryEntity that can be evaluated
137.         by sympy."""
138.         return type(self).__name__ + repr(self.args)
139. 
140.     def __rmul__(self, a):
141.         """Implementation of reverse multiplication method."""
142.         return a.__mul__(self)
143. 
144.     def __rsub__(self, a):
145.         """Implementation of reverse subtraction method."""
146.         return a.__sub__(self)
147. 
148.     def __str__(self):
149.         """String representation of a GeometryEntity."""
150.         from sympy.printing import sstr
151.         return type(self).__name__ + sstr(self.args)
152. 
153.     def _eval_subs(self, old, new):
154.         from sympy.geometry.point import Point, Point3D
155.         if is_sequence(old) or is_sequence(new):
156.             if isinstance(self, Point3D):
157.                 old = Point3D(old)
158.                 new = Point3D(new)
159.             else:
160.                 old = Point(old)
161.                 new = Point(new)
162.             return  self._subs(old, new)
163. 
164.     def _repr_svg_(self):
165.         """SVG representation of a GeometryEntity suitable for IPython"""
166. 
167.         from sympy.core.evalf import N
168. 
169.         try:
170.             bounds = self.bounds
171.         except (NotImplementedError, TypeError):
172.             # if we have no SVG representation, return None so IPython
173.             # will fall back to the next representation
174.             return None
175. 
176.         svg_top = '''<svg xmlns="http://www.w3.org/2000/svg"
177.             xmlns:xlink="http://www.w3.org/1999/xlink"
178.             width="{1}" height="{2}" viewBox="{0}"
179.             preserveAspectRatio="xMinYMin meet">
180.             <defs>
181.                 <marker id="markerCircle" markerWidth="8" markerHeight="8"
182.                     refx="5" refy="5" markerUnits="strokeWidth">
183.                     <circle cx="5" cy="5" r="1.5" style="stroke: none; fill:#000000;"/>
184.                 </marker>
185.                 <marker id="markerArrow" markerWidth="13" markerHeight="13" refx="2" refy="4"
186.                        orient="auto" markerUnits="strokeWidth">
187.                     <path d="M2,2 L2,6 L6,4" style="fill: #000000;" />
188.                 </marker>
189.                 <marker id="markerReverseArrow" markerWidth="13" markerHeight="13" refx="6" refy="4"
190.                        orient="auto" markerUnits="strokeWidth">
191.                     <path d="M6,2 L6,6 L2,4" style="fill: #000000;" />
192.                 </marker>
193.             </defs>'''
194. 
195.         # Establish SVG canvas that will fit all the data + small space
196.         xmin, ymin, xmax, ymax = map(N, bounds)
197.         if xmin == xmax and ymin == ymax:
198.             # This is a point; buffer using an arbitrary size
199.             xmin, ymin, xmax, ymax = xmin - .5, ymin -.5, xmax + .5, ymax + .5
200.         else:
201.             # Expand bounds by a fraction of the data ranges
202.             expand = 0.1  # or 10%; this keeps arrowheads in view (R plots use 4%)
203.             widest_part = max([xmax - xmin, ymax - ymin])
204.             expand_amount = widest_part * expand
205.             xmin -= expand_amount
206.             ymin -= expand_amount
207.             xmax += expand_amount
208.             ymax += expand_amount
209.         dx = xmax - xmin
210.         dy = ymax - ymin
211.         width = min([max([100., dx]), 300])
212.         height = min([max([100., dy]), 300])
213. 
214.         scale_factor = 1. if max(width, height) == 0 else max(dx, dy) / max(width, height)
215.         try:
216.             svg = self._svg(scale_factor)
217.         except (NotImplementedError, TypeError):
218.             # if we have no SVG representation, return None so IPython
219.             # will fall back to the next representation
220.             return None
221. 
222.         view_box = "{0} {1} {2} {3}".format(xmin, ymin, dx, dy)
223.         transform = "matrix(1,0,0,-1,0,{0})".format(ymax + ymin)
224.         svg_top = svg_top.format(view_box, width, height)
225. 
226.         return svg_top + (
227.             '<g transform="{0}">{1}</g></svg>'
228.             ).format(transform, svg)
229. 
230.     def _svg(self, scale_factor=1., fill_color="#66cc99"):
231.         """Returns SVG path element for the GeometryEntity.
232. 
233.         Parameters
234.         ==========
235. 
236.         scale_factor : float
237.             Multiplication factor for the SVG stroke-width.  Default is 1.
238.         fill_color : str, optional
239.             Hex string for fill color. Default is "#66cc99".
240.         """
241.         raise NotImplementedError()
242. 
243.     def _sympy_(self):
244.         return self
245. 
246.     @property
247.     def ambient_dimension(self):
248.         """What is the dimension of the space that the object is contained in?"""
249.         raise NotImplementedError()
250. 
251.     @property
252.     def bounds(self):
253.         """Return a tuple (xmin, ymin, xmax, ymax) representing the bounding
254.         rectangle for the geometric figure.
255. 
256.         """
257. 
258.         raise NotImplementedError()
259. 
260.     def encloses(self, o):
261.         """
262.         Return True if o is inside (not on or outside) the boundaries of self.
263. 
264.         The object will be decomposed into Points and individual Entities need
265.         only define an encloses_point method for their class.
266. 
267.         See Also
268.         ========
269. 
270.         sympy.geometry.ellipse.Ellipse.encloses_point
271.         sympy.geometry.polygon.Polygon.encloses_point
272. 
273.         Examples
274.         ========
275. 
276.         >>> from sympy import RegularPolygon, Point, Polygon
277.         >>> t  = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
278.         >>> t2 = Polygon(*RegularPolygon(Point(0, 0), 2, 3).vertices)
279.         >>> t2.encloses(t)
280.         True
281.         >>> t.encloses(t2)
282.         False
283. 
284.         """
285. 
286.         from sympy.geometry.point import Point
287.         from sympy.geometry.line import Segment, Ray, Line
288.         from sympy.geometry.ellipse import Ellipse
289.         from sympy.geometry.polygon import Polygon, RegularPolygon
290. 
291.         if isinstance(o, Point):
292.             return self.encloses_point(o)
293.         elif isinstance(o, Segment):
294.             return all(self.encloses_point(x) for x in o.points)
295.         elif isinstance(o, Ray) or isinstance(o, Line):
296.             return False
297.         elif isinstance(o, Ellipse):
298.             return self.encloses_point(o.center) and \
299.                 self.encloses_point(
300.                 Point(o.center.x + o.hradius, o.center.y)) and \
301.                 not self.intersection(o)
302.         elif isinstance(o, Polygon):
303.             if isinstance(o, RegularPolygon):
304.                 if not self.encloses_point(o.center):
305.                     return False
306.             return all(self.encloses_point(v) for v in o.vertices)
307.         raise NotImplementedError()
308. 
309.     def equals(self, o):
310.         return self == o
311. 
312.     def intersection(self, o):
313.         """
314.         Returns a list of all of the intersections of self with o.
315. 
316.         Notes
317.         =====
318. 
319.         An entity is not required to implement this method.
320. 
321.         If two different types of entities can intersect, the item with
322.         higher index in ordering_of_classes should implement
323.         intersections with anything having a lower index.
324. 
325.         See Also
326.         ========
327. 
328.         sympy.geometry.util.intersection
329. 
330.         """
331.         raise NotImplementedError()
332. 
333.     def is_similar(self, other):
334.         """Is this geometrical entity similar to another geometrical entity?
335. 
336.         Two entities are similar if a uniform scaling (enlarging or
337.         shrinking) of one of the entities will allow one to obtain the other.
338. 
339.         Notes
340.         =====
341. 
342.         This method is not intended to be used directly but rather
343.         through the `are_similar` function found in util.py.
344.         An entity is not required to implement this method.
345.         If two different types of entities can be similar, it is only
346.         required that one of them be able to determine this.
347. 
348.         See Also
349.         ========
350. 
351.         scale
352. 
353.         """
354.         raise NotImplementedError()
355. 
356.     def reflect(self, line):
357.         """
358.         Reflects an object across a line.
359. 
360.         Parameters
361.         ==========
362. 
363.         line: Line
364. 
365.         Examples
366.         ========
367. 
368.         >>> from sympy import pi, sqrt, Line, RegularPolygon
369.         >>> l = Line((0, pi), slope=sqrt(2))
370.         >>> pent = RegularPolygon((1, 2), 1, 5)
371.         >>> rpent = pent.reflect(l)
372.         >>> rpent
373.         RegularPolygon(Point2D(-2*sqrt(2)*pi/3 - 1/3 + 4*sqrt(2)/3, 2/3 + 2*sqrt(2)/3 + 2*pi/3), -1, 5, -atan(2*sqrt(2)) + 3*pi/5)
374. 
375.         >>> from sympy import pi, Line, Circle, Point
376.         >>> l = Line((0, pi), slope=1)
377.         >>> circ = Circle(Point(0, 0), 5)
378.         >>> rcirc = circ.reflect(l)
379.         >>> rcirc
380.         Circle(Point2D(-pi, pi), -5)
381. 
382.         """
383.         from sympy import atan, Point, Dummy, oo
384. 
385.         g = self
386.         l = line
387.         o = Point(0, 0)
388.         if l.slope.is_zero:
389.             y = l.args[0].y
390.             if not y:  # x-axis
391.                 return g.scale(y=-1)
392.             reps = [(p, p.translate(y=2*(y - p.y))) for p in g.atoms(Point)]
393.         elif l.slope is oo:
394.             x = l.args[0].x
395.             if not x:  # y-axis
396.                 return g.scale(x=-1)
397.             reps = [(p, p.translate(x=2*(x - p.x))) for p in g.atoms(Point)]
398.         else:
399.             if not hasattr(g, 'reflect') and not all(
400.                     isinstance(arg, Point) for arg in g.args):
401.                 raise NotImplementedError(
402.                     'reflect undefined or non-Point args in %s' % g)
403.             a = atan(l.slope)
404.             c = l.coefficients
405.             d = -c[-1]/c[1]  # y-intercept
406.             # apply the transform to a single point
407.             x, y = Dummy(), Dummy()
408.             xf = Point(x, y)
409.             xf = xf.translate(y=-d).rotate(-a, o).scale(y=-1
410.                 ).rotate(a, o).translate(y=d)
411.             # replace every point using that transform
412.             reps = [(p, xf.xreplace({x: p.x, y: p.y})) for p in g.atoms(Point)]
413.         return g.xreplace(dict(reps))
414. 
415.     def rotate(self, angle, pt=None):
416.         """Rotate ``angle`` radians counterclockwise about Point ``pt``.
417. 
418.         The default pt is the origin, Point(0, 0)
419. 
420.         See Also
421.         ========
422. 
423.         scale, translate
424. 
425.         Examples
426.         ========
427. 
428.         >>> from sympy import Point, RegularPolygon, Polygon, pi
429.         >>> t = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
430.         >>> t # vertex on x axis
431.         Triangle(Point2D(1, 0), Point2D(-1/2, sqrt(3)/2), Point2D(-1/2, -sqrt(3)/2))
432.         >>> t.rotate(pi/2) # vertex on y axis now
433.         Triangle(Point2D(0, 1), Point2D(-sqrt(3)/2, -1/2), Point2D(sqrt(3)/2, -1/2))
434. 
435.         """
436.         newargs = []
437.         for a in self.args:
438.             if isinstance(a, GeometryEntity):
439.                 newargs.append(a.rotate(angle, pt))
440.             else:
441.                 newargs.append(a)
442.         return type(self)(*newargs)
443. 
444.     def scale(self, x=1, y=1, pt=None):
445.         """Scale the object by multiplying the x,y-coordinates by x and y.
446. 
447.         If pt is given, the scaling is done relative to that point; the
448.         object is shifted by -pt, scaled, and shifted by pt.
449. 
450.         See Also
451.         ========
452. 
453.         rotate, translate
454. 
455.         Examples
456.         ========
457. 
458.         >>> from sympy import RegularPolygon, Point, Polygon
459.         >>> t = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
460.         >>> t
461.         Triangle(Point2D(1, 0), Point2D(-1/2, sqrt(3)/2), Point2D(-1/2, -sqrt(3)/2))
462.         >>> t.scale(2)
463.         Triangle(Point2D(2, 0), Point2D(-1, sqrt(3)/2), Point2D(-1, -sqrt(3)/2))
464.         >>> t.scale(2, 2)
465.         Triangle(Point2D(2, 0), Point2D(-1, sqrt(3)), Point2D(-1, -sqrt(3)))
466. 
467.         """
468.         from sympy.geometry.point import Point
469.         if pt:
470.             pt = Point(pt, dim=2)
471.             return self.translate(*(-pt).args).scale(x, y).translate(*pt.args)
472.         return type(self)(*[a.scale(x, y) for a in self.args])  # if this fails, override this class
473. 
474.     def translate(self, x=0, y=0):
475.         """Shift the object by adding to the x,y-coordinates the values x and y.
476. 
477.         See Also
478.         ========
479. 
480.         rotate, scale
481. 
482.         Examples
483.         ========
484. 
485.         >>> from sympy import RegularPolygon, Point, Polygon
486.         >>> t = Polygon(*RegularPolygon(Point(0, 0), 1, 3).vertices)
487.         >>> t
488.         Triangle(Point2D(1, 0), Point2D(-1/2, sqrt(3)/2), Point2D(-1/2, -sqrt(3)/2))
489.         >>> t.translate(2)
490.         Triangle(Point2D(3, 0), Point2D(3/2, sqrt(3)/2), Point2D(3/2, -sqrt(3)/2))
491.         >>> t.translate(2, 2)
492.         Triangle(Point2D(3, 2), Point2D(3/2, sqrt(3)/2 + 2), Point2D(3/2, 2 - sqrt(3)/2))
493. 
494.         """
495.         newargs = []
496.         for a in self.args:
497.             if isinstance(a, GeometryEntity):
498.                 newargs.append(a.translate(x, y))
499.             else:
500.                 newargs.append(a)


File: sympy/geometry/point.py
Line number range: 1 - 500
Content:
1. """Geometrical Points.
2. 
3. Contains
4. ========
5. Point
6. Point2D
7. Point3D
8. 
9. When methods of Point require 1 or more points as arguments, they
10. can be passed as a sequence of coordinates or Points:
11. 
12. >>> from sympy.geometry.point import Point
13. >>> Point(1, 1).is_collinear((2, 2), (3, 4))
14. False
15. >>> Point(1, 1).is_collinear(Point(2, 2), Point(3, 4))
16. False
17. 
18. """
19. 
20. from __future__ import division, print_function
21. 
22. import warnings
23. 
24. from sympy.core import S, sympify, Expr
25. from sympy.core.compatibility import is_sequence
26. from sympy.core.containers import Tuple
27. from sympy.simplify import nsimplify, simplify
28. from sympy.geometry.exceptions import GeometryError
29. from sympy.functions.elementary.miscellaneous import sqrt
30. from sympy.functions.elementary.complexes import im
31. from sympy.matrices import Matrix
32. from sympy.core.numbers import Float
33. from sympy.core.evaluate import global_evaluate
34. from sympy.core.add import Add
35. from sympy.utilities.iterables import uniq
36. from sympy.utilities.misc import filldedent, func_name, Undecidable
37. 
38. from .entity import GeometryEntity
39. 
40. 
41. class Point(GeometryEntity):
42.     """A point in a n-dimensional Euclidean space.
43. 
44.     Parameters
45.     ==========
46. 
47.     coords : sequence of n-coordinate values. In the special
48.         case where n=2 or 3, a Point2D or Point3D will be created
49.         as appropriate.
50.     evaluate : if `True` (default), all floats are turn into
51.         exact types.
52.     dim : number of coordinates the point should have.  If coordinates
53.         are unspecified, they are padded with zeros.
54.     on_morph : indicates what should happen when the number of
55.         coordinates of a point need to be changed by adding or
56.         removing zeros.  Possible values are `'warn'`, `'error'`, or
57.         `ignore` (default).  No warning or error is given when `*args`
58.         is empty and `dim` is given. An error is always raised when
59.         trying to remove nonzero coordinates.
60. 
61. 
62.     Attributes
63.     ==========
64. 
65.     length
66.     origin: A `Point` representing the origin of the
67.         appropriately-dimensioned space.
68. 
69.     Raises
70.     ======
71. 
72.     TypeError : When instantiating with anything but a Point or sequence
73.     ValueError : when instantiating with a sequence with length < 2 or
74.         when trying to reduce dimensions if keyword `on_morph='error'` is
75.         set.
76. 
77.     See Also
78.     ========
79. 
80.     sympy.geometry.line.Segment : Connects two Points
81. 
82.     Examples
83.     ========
84. 
85.     >>> from sympy.geometry import Point
86.     >>> from sympy.abc import x
87.     >>> Point(1, 2, 3)
88.     Point3D(1, 2, 3)
89.     >>> Point([1, 2])
90.     Point2D(1, 2)
91.     >>> Point(0, x)
92.     Point2D(0, x)
93.     >>> Point(dim=4)
94.     Point(0, 0, 0, 0)
95. 
96.     Floats are automatically converted to Rational unless the
97.     evaluate flag is False:
98. 
99.     >>> Point(0.5, 0.25)
100.     Point2D(1/2, 1/4)
101.     >>> Point(0.5, 0.25, evaluate=False)
102.     Point2D(0.5, 0.25)
103. 
104.     """
105. 
106.     is_Point = True
107. 
108.     def __new__(cls, *args, **kwargs):
109.         evaluate = kwargs.get('evaluate', global_evaluate[0])
110.         on_morph = kwargs.get('on_morph', 'ignore')
111. 
112.         # unpack into coords
113.         coords = args[0] if len(args) == 1 else args
114. 
115.         # check args and handle quickly handle Point instances
116.         if isinstance(coords, Point):
117.             # even if we're mutating the dimension of a point, we
118.             # don't reevaluate its coordinates
119.             evaluate = False
120.             if len(coords) == kwargs.get('dim', len(coords)):
121.                 return coords
122. 
123.         if not is_sequence(coords):
124.             raise TypeError(filldedent('''
125.                 Expecting sequence of coordinates, not `{}`'''
126.                                        .format(func_name(coords))))
127.         # A point where only `dim` is specified is initialized
128.         # to zeros.
129.         if len(coords) == 0 and kwargs.get('dim', None):
130.             coords = (S.Zero,)*kwargs.get('dim')
131. 
132.         coords = Tuple(*coords)
133.         dim = kwargs.get('dim', len(coords))
134. 
135.         if len(coords) < 2:
136.             raise ValueError(filldedent('''
137.                 Point requires 2 or more coordinates or
138.                 keyword `dim` > 1.'''))
139.         if len(coords) != dim:
140.             message = ("Dimension of {} needs to be changed "
141.                        "from {} to {}.").format(coords, len(coords), dim)
142.             if on_morph == 'ignore':
143.                 pass
144.             elif on_morph == "error":
145.                 raise ValueError(message)
146.             elif on_morph == 'warn':
147.                 warnings.warn(message)
148.             else:
149.                 raise ValueError(filldedent('''
150.                         on_morph value should be 'error',
151.                         'warn' or 'ignore'.'''))
152.         if any(coords[dim:]):
153.             raise ValueError('Nonzero coordinates cannot be removed.')
154.         if any(a.is_number and im(a) for a in coords):
155.             raise ValueError('Imaginary coordinates are not permitted.')
156.         if not all(isinstance(a, Expr) for a in coords):
157.             raise TypeError('Coordinates must be valid SymPy expressions.')
158. 
159.         # pad with zeros appropriately
160.         coords = coords[:dim] + (S.Zero,)*(dim - len(coords))
161. 
162.         # Turn any Floats into rationals and simplify
163.         # any expressions before we instantiate
164.         if evaluate:
165.             coords = coords.xreplace(dict(
166.                 [(f, simplify(nsimplify(f, rational=True)))
167.                  for f in coords.atoms(Float)]))
168. 
169.         # return 2D or 3D instances
170.         if len(coords) == 2:
171.             kwargs['_nocheck'] = True
172.             return Point2D(*coords, **kwargs)
173.         elif len(coords) == 3:
174.             kwargs['_nocheck'] = True
175.             return Point3D(*coords, **kwargs)
176. 
177.         # the general Point
178.         return GeometryEntity.__new__(cls, *coords)
179. 
180.     def __abs__(self):
181.         """Returns the distance between this point and the origin."""
182.         origin = Point([0]*len(self))
183.         return Point.distance(origin, self)
184. 
185.     def __add__(self, other):
186.         """Add other to self by incrementing self's coordinates by
187.         those of other.
188. 
189.         Notes
190.         =====
191. 
192.         >>> from sympy.geometry.point import Point
193. 
194.         When sequences of coordinates are passed to Point methods, they
195.         are converted to a Point internally. This __add__ method does
196.         not do that so if floating point values are used, a floating
197.         point result (in terms of SymPy Floats) will be returned.
198. 
199.         >>> Point(1, 2) + (.1, .2)
200.         Point2D(1.1, 2.2)
201. 
202.         If this is not desired, the `translate` method can be used or
203.         another Point can be added:
204. 
205.         >>> Point(1, 2).translate(.1, .2)
206.         Point2D(11/10, 11/5)
207.         >>> Point(1, 2) + Point(.1, .2)
208.         Point2D(11/10, 11/5)
209. 
210.         See Also
211.         ========
212. 
213.         sympy.geometry.point.Point.translate
214. 
215.         """
216.         try:
217.             s, o = Point._normalize_dimension(self, Point(other, evaluate=False))
218.         except TypeError:
219.             raise GeometryError("Don't know how to add {} and a Point object".format(other))
220. 
221.         coords = [simplify(a + b) for a, b in zip(s, o)]
222.         return Point(coords, evaluate=False)
223. 
224.     def __contains__(self, item):
225.         return item in self.args
226. 
227.     def __div__(self, divisor):
228.         """Divide point's coordinates by a factor."""
229.         divisor = sympify(divisor)
230.         coords = [simplify(x/divisor) for x in self.args]
231.         return Point(coords, evaluate=False)
232. 
233.     def __eq__(self, other):
234.         if not isinstance(other, Point) or len(self.args) != len(other.args):
235.             return False
236.         return self.args == other.args
237. 
238.     def __getitem__(self, key):
239.         return self.args[key]
240. 
241.     def __hash__(self):
242.         return hash(self.args)
243. 
244.     def __iter__(self):
245.         return self.args.__iter__()
246. 
247.     def __len__(self):
248.         return len(self.args)
249. 
250.     def __mul__(self, factor):
251.         """Multiply point's coordinates by a factor.
252. 
253.         Notes
254.         =====
255. 
256.         >>> from sympy.geometry.point import Point
257. 
258.         When multiplying a Point by a floating point number,
259.         the coordinates of the Point will be changed to Floats:
260. 
261.         >>> Point(1, 2)*0.1
262.         Point2D(0.1, 0.2)
263. 
264.         If this is not desired, the `scale` method can be used or
265.         else only multiply or divide by integers:
266. 
267.         >>> Point(1, 2).scale(1.1, 1.1)
268.         Point2D(11/10, 11/5)
269.         >>> Point(1, 2)*11/10
270.         Point2D(11/10, 11/5)
271. 
272.         See Also
273.         ========
274. 
275.         sympy.geometry.point.Point.scale
276.         """
277.         factor = sympify(factor)
278.         coords = [simplify(x*factor) for x in self.args]
279.         return Point(coords, evaluate=False)
280. 
281.     def __neg__(self):
282.         """Negate the point."""
283.         coords = [-x for x in self.args]
284.         return Point(coords, evaluate=False)
285. 
286.     def __sub__(self, other):
287.         """Subtract two points, or subtract a factor from this point's
288.         coordinates."""
289.         return self + [-x for x in other]
290. 
291.     @classmethod
292.     def _normalize_dimension(cls, *points, **kwargs):
293.         """Ensure that points have the same dimension.
294.         By default `on_morph='warn'` is passed to the
295.         `Point` constructor."""
296.         # if we have a built-in ambient dimension, use it
297.         dim = getattr(cls, '_ambient_dimension', None)
298.         # override if we specified it
299.         dim = kwargs.get('dim', dim)
300.         # if no dim was given, use the highest dimensional point
301.         if dim is None:
302.             dim = max(i.ambient_dimension for i in points)
303.         if all(i.ambient_dimension == dim for i in points):
304.             return list(points)
305.         kwargs['dim'] = dim
306.         kwargs['on_morph'] = kwargs.get('on_morph', 'warn')
307.         return [Point(i, **kwargs) for i in points]
308. 
309.     @staticmethod
310.     def affine_rank(*args):
311.         """The affine rank of a set of points is the dimension
312.         of the smallest affine space containing all the points.
313.         For example, if the points lie on a line (and are not all
314.         the same) their affine rank is 1.  If the points lie on a plane
315.         but not a line, their affine rank is 2.  By convention, the empty
316.         set has affine rank -1."""
317. 
318.         if len(args) == 0:
319.             return -1
320.         # make sure we're genuinely points
321.         # and translate every point to the origin
322.         points = Point._normalize_dimension(*[Point(i) for i in args])
323.         origin = points[0]
324.         points = [i - origin for i in points[1:]]
325. 
326.         m = Matrix([i.args for i in points])
327.         # XXX fragile -- what is a better way?
328.         return m.rank(iszerofunc = lambda x:
329.             abs(x.n(2)) < 1e-12 if x.is_number else x.is_zero)
330. 
331.     @property
332.     def ambient_dimension(self):
333.         """Number of components this point has."""
334.         return getattr(self, '_ambient_dimension', len(self))
335. 
336.     @classmethod
337.     def are_coplanar(cls, *points):
338.         """Return True if there exists a plane in which all the points
339.         lie.  A trivial True value is returned if `len(points) < 3` or
340.         all Points are 2-dimensional.
341. 
342.         Parameters
343.         ==========
344. 
345.         A set of points
346. 
347.         Raises
348.         ======
349. 
350.         ValueError : if less than 3 unique points are given
351. 
352.         Returns
353.         =======
354. 
355.         boolean
356. 
357.         Examples
358.         ========
359. 
360.         >>> from sympy import Point3D
361.         >>> p1 = Point3D(1, 2, 2)
362.         >>> p2 = Point3D(2, 7, 2)
363.         >>> p3 = Point3D(0, 0, 2)
364.         >>> p4 = Point3D(1, 1, 2)
365.         >>> Point3D.are_coplanar(p1, p2, p3, p4)
366.         True
367.         >>> p5 = Point3D(0, 1, 3)
368.         >>> Point3D.are_coplanar(p1, p2, p3, p5)
369.         False
370. 
371.         """
372.         if len(points) <= 1:
373.             return True
374. 
375.         points = cls._normalize_dimension(*[Point(i) for i in points])
376.         # quick exit if we are in 2D
377.         if points[0].ambient_dimension == 2:
378.             return True
379.         points = list(uniq(points))
380.         return Point.affine_rank(*points) <= 2
381. 
382.     def distance(self, other):
383.         """The Euclidean distance between self and another GeometricEntity.
384. 
385.         Returns
386.         =======
387. 
388.         distance : number or symbolic expression.
389. 
390.         Raises
391.         ======
392. 
393.         TypeError : if other is not recognized as a GeometricEntity or is a
394.                     GeometricEntity for which distance is not defined.
395. 
396.         See Also
397.         ========
398. 
399.         sympy.geometry.line.Segment.length
400.         sympy.geometry.point.Point.taxicab_distance
401. 
402.         Examples
403.         ========
404. 
405.         >>> from sympy.geometry import Point, Line
406.         >>> p1, p2 = Point(1, 1), Point(4, 5)
407.         >>> l = Line((3, 1), (2, 2))
408.         >>> p1.distance(p2)
409.         5
410.         >>> p1.distance(l)
411.         sqrt(2)
412. 
413.         The computed distance may be symbolic, too:
414. 
415.         >>> from sympy.abc import x, y
416.         >>> p3 = Point(x, y)
417.         >>> p3.distance((0, 0))
418.         sqrt(x**2 + y**2)
419. 
420.         """
421.         if not isinstance(other, GeometryEntity):
422.             try:
423.                 other = Point(other, dim=self.ambient_dimension)
424.             except TypeError:
425.                 raise TypeError("not recognized as a GeometricEntity: %s" % type(other))
426.         if isinstance(other, Point):
427.             s, p = Point._normalize_dimension(self, Point(other))
428.             return sqrt(Add(*((a - b)**2 for a, b in zip(s, p))))
429.         distance = getattr(other, 'distance', None)
430.         if distance is None:
431.             raise TypeError("distance between Point and %s is not defined" % type(other))
432.         return distance(self)
433. 
434.     def dot(self, p):
435.         """Return dot product of self with another Point."""
436.         if not is_sequence(p):
437.             p = Point(p)  # raise the error via Point
438.         return Add(*(a*b for a, b in zip(self, p)))
439. 
440.     def equals(self, other):
441.         """Returns whether the coordinates of self and other agree."""
442.         # a point is equal to another point if all its components are equal
443.         if not isinstance(other, Point) or len(self) != len(other):
444.             return False
445.         return all(a.equals(b) for a, b in zip(self, other))
446. 
447.     def evalf(self, prec=None, **options):
448.         """Evaluate the coordinates of the point.
449. 
450.         This method will, where possible, create and return a new Point
451.         where the coordinates are evaluated as floating point numbers to
452.         the precision indicated (default=15).
453. 
454.         Parameters
455.         ==========
456. 
457.         prec : int
458. 
459.         Returns
460.         =======
461. 
462.         point : Point
463. 
464.         Examples
465.         ========
466. 
467.         >>> from sympy import Point, Rational
468.         >>> p1 = Point(Rational(1, 2), Rational(3, 2))
469.         >>> p1
470.         Point2D(1/2, 3/2)
471.         >>> p1.evalf()
472.         Point2D(0.5, 1.5)
473. 
474.         """
475.         coords = [x.evalf(prec, **options) for x in self.args]
476.         return Point(*coords, evaluate=False)
477. 
478.     def intersection(self, other):
479.         """The intersection between this point and another GeometryEntity.
480. 
481.         Parameters
482.         ==========
483. 
484.         other : GeometryEntity or sequence of coordinates
485. 
486.         Returns
487.         =======
488. 
489.         intersection : list of Points
490. 
491.         Notes
492.         =====
493. 
494.         The return value will either be an empty list if there is no
495.         intersection, otherwise it will contain this point.
496. 
497.         Examples
498.         ========
499. 
500.         >>> from sympy import Point

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-24 00:15:10,233 - thread-128541442176704.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to understand why `number * Point` fails. The provided context, which includes `sympy/geometry/point.py` and `sympy/geometry/entity.py`, is sufficient. The traceback clearly shows that `number * Point` incorrectly produces a `Mul` object instead of a `Point` object. The `__add__` method in `point.py` then fails because it doesn't know how to handle this `Mul` object. The provided patch for `point.py` addresses this by explicitly handling the `Mul` object. The patch for `entity.py` fixes a related, but not directly causal, issue in `__rmul__`. The behavior of core components like `Mul` and `Float` can be inferred from the traceback, so their source code is not strictly necessary to understand the fix." query='' extra_requirements='' purpose=''
2025-12-24 00:15:10,234 - thread-128541442176704.prometheus_context_collector - INFO - Successfully retrieved 2 context snippets
