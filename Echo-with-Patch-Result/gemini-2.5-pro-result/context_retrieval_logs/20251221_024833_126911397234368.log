2025-12-21 02:48:33,687 - thread-126911397234368.prometheus_context_collector - INFO - Starting context retrieval for query: 
Issue: [Bug]: NumPy 1.24 deprecation warnings

Description: ### Bug summary

Starting NumPy 1.24 I observe several deprecation warnings.


### Code for reproduction

```python
import matplotlib.pyplot as plt
import numpy as np

plt.get_cmap()(np.empty((0, ), dtype=np.uint8))
```


### Actual outcome

```
/usr/lib/python3.10/site-packages/matplotlib/colors.py:730: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 257 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[xa > self.N - 1] = self._i_over
/usr/lib/python3.10/site-packages/matplotlib/colors.py:731: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 256 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[xa < 0] = self._i_under
/usr/lib/python3.10/site-packages/matplotlib/colors.py:732: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 258 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[mask_bad] = self._i_bad
```

### Expected outcome

No warnings.

### Additional information

_No response_

### Operating system

ArchLinux

### Matplotlib Version

3.6.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.9

### Jupyter version

_No response_

### Installation

Linux package manager

Patch information:
diff --git a/lib/matplotlib/colors.py b/lib/matplotlib/colors.py
index 2d3072da04..2d1196ab24 100644
--- a/lib/matplotlib/colors.py
+++ b/lib/matplotlib/colors.py
@@ -711,7 +711,11 @@ class Colormap:
         mask_bad = X.mask if np.ma.is_masked(X) else None
         xa = np.array(X, copy=True)
         if mask_bad is None:
-            mask_bad = np.isnan(xa)
+            if xa.dtype.kind == "f":
+                mask_bad = np.isnan(xa)
+            else:
+                # Integer and other non-floating dtypes cannot represent NaN.
+                mask_bad = np.zeros_like(xa, dtype=bool)
         if not xa.dtype.isnative:
             xa = xa.byteswap().newbyteorder()  # Native byteorder is faster.
         if xa.dtype.kind == "f":
@@ -725,6 +729,10 @@ class Colormap:
                 # Avoid converting large positive values to negative integers.
                 np.clip(xa, -1, self.N, out=xa)
                 xa = xa.astype(int)
+        elif xa.dtype.kind in "ui":
+            # Upcast integer arrays to a signed integer dtype that can
+            # represent sentinel indices (N, N+1, N+2) without overflow.
+            xa = xa.astype(np.intp, copy=False)
         # Set the over-range indices before the under-range;
         # otherwise the under-range values get converted to over-range.
         xa[xa > self.N - 1] = self._i_over


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-12-21 02:48:33,766 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24131-OG.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   ├── 24189-JB.rst
|   |   |   |   ├── 24570-GL.rst
|   |   |   |   ├── 24655-AK.rst
|   |   |   |   ├── 24829-AL.rst
|   |   |   |   ├── 24870-AL.rst
|   |   |   |   ├── 24889-AL.rst
|   |   |   |   ├── 24912-AL.rst
|   |   |   |   └── 9598-AFV.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19763-ES.rst
|   |   |   |   ├── 22314-AL.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24071-OG.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24131-OG.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24254-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   ├── 24455-AL.rst
|   |   |   |   ├── 24465-AL.rst
|   |   |   |   ├── 24474_CM.rst
|   |   |   |   ├── 24538-OG.rst
|   |   |   |   ├── 24577-AL.rst
|   |   |   |   ├── 24664-OG.rst
|   |   |   |   ├── 24688-OG.rst
|   |   |   |   ├── 24730-TH.rst
|   |   |   |   ├── 24806-KS.rst
|   |   |   |   ├── 24846-ES.rst
|   |   |   |   ├── 24864-AL.rst
|   |   |   |   ├── 24904-AL.rst
|   |   |   |   └── 24913-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   ├── 24257-AL.rst
|   |   |   |   ├── 24710-AL.rst
|   |   |   |   ├── 24724-ES.rst
|   |   |   |   ├── 24887-OG.rst
|   |   |   |   └── 24919-KS.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 21661-TAC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24254-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       ├── 24356-OG.rst
|   |   |       ├── 24624-AL.rst
|   |   |       ├── 24923-ES.rst
|   |   |       ├── 24948-ES.rst
|   |   |       ├── 24965-ES.rst
|   |   |       └── 24XXX-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── documentation.rst
|       |   ├── ellipse_annotation.rst
|       |   ├── figure_hooks.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── legend-figure-outside.rst
|       |   ├── per_subplot_mosaic.rst
|       |   ├── pie_hatch.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── reverse_legend.rst
|       |   ├── rgba_pcolormesh.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   ├── view_current_axis_format.rst
|       |   └── widget_blitting.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bullseye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── mosaic.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── images
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── mplcvd.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   └── README.txt
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: NumPy 1.24 deprecation warnings

Description: ### Bug summary

Starting NumPy 1.24 I observe several deprecation warnings.


### Code for reproduction

```python
import matplotlib.pyplot as plt
import numpy as np

plt.get_cmap()(np.empty((0, ), dtype=np.uint8))
```


### Actual outcome

```
/usr/lib/python3.10/site-packages/matplotlib/colors.py:730: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 257 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[xa > self.N - 1] = self._i_over
/usr/lib/python3.10/site-packages/matplotlib/colors.py:731: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 256 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[xa < 0] = self._i_under
/usr/lib/python3.10/site-packages/matplotlib/colors.py:732: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 258 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[mask_bad] = self._i_bad
```

### Expected outcome

No warnings.

### Additional information

_No response_

### Operating system

ArchLinux

### Matplotlib Version

3.6.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.9

### Jupyter version

_No response_

### Installation

Linux package manager

Patch information:
diff --git a/lib/matplotlib/colors.py b/lib/matplotlib/colors.py
index 2d3072da04..2d1196ab24 100644
--- a/lib/matplotlib/colors.py
+++ b/lib/matplotlib/colors.py
@@ -711,7 +711,11 @@ class Colormap:
         mask_bad = X.mask if np.ma.is_masked(X) else None
         xa = np.array(X, copy=True)
         if mask_bad is None:
-            mask_bad = np.isnan(xa)
+            if xa.dtype.kind == "f":
+                mask_bad = np.isnan(xa)
+            else:
+                # Integer and other non-floating dtypes cannot represent NaN.
+                mask_bad = np.zeros_like(xa, dtype=bool)
         if not xa.dtype.isnative:
             xa = xa.byteswap().newbyteorder()  # Native byteorder is faster.
         if xa.dtype.kind == "f":
@@ -725,6 +729,10 @@ class Colormap:
                 # Avoid converting large positive values to negative integers.
                 np.clip(xa, -1, self.N, out=xa)
                 xa = xa.astype(int)
+        elif xa.dtype.kind in "ui":
+            # Upcast integer arrays to a signed integer dtype that can
+            # represent sentinel indices (N, N+1, N+2) without overflow.
+            xa = xa.astype(np.intp, copy=False)
         # Set the over-range indices before the under-range;
         # otherwise the under-range values get converted to over-range.
         xa[xa > self.N - 1] = self._i_over


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---



All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 02:48:45,469 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning='The user wants to find relevant test cases for a bug in the `matplotlib.colors.Colormap` class. The tests for this functionality are most likely located in `lib/matplotlib/tests/test_colors.py`. To identify the most relevant tests, I need to examine the content of this file. The current context is empty, so I need to retrieve this file.' query='Please provide the full content of lib/matplotlib/tests/test_colors.py' extra_requirements='' purpose='I need the content of this test file to find existing test cases that are relevant to the bug report concerning `Colormap` and NumPy deprecation warnings.'
2025-12-21 02:48:45,470 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - INFO - Retrieving contexts from memory for query: Please provide the full content of lib/matplotlib/tests/test_colors.py
2025-12-21 02:48:45,470 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.memory_retrieval_node - ERROR - Failed to retrieve from memory: Athena memory client is not configured.
2025-12-21 02:48:45,471 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-12-21 02:48:45,471 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - INFO - Creating context provider message from refined query
2025-12-21 02:48:45,471 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.add_context_refined_query_message_node - DEBUG - Query message: Essential query: Please provide the full content of lib/matplotlib/tests/test_colors.py
Purpose: I need the content of this test file to find existing test cases that are relevant to the bug report concerning `Colormap` and NumPy deprecation warnings.
2025-12-21 02:48:49,019 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `lib/matplotlib/tests/test_colors.py`. This will allow you to examine the existing test cases and identify those that are relevant to the bug report regarding `Colormap` and NumPy deprecation warnings.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_colors.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2136, 'candidates_token_count': 78, 'total_token_count': 2407, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2136}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 193, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11458945885682717, 'model_name': 'gemini-2.5-pro'} id='run--5a2a87f9-e518-4cd9-ad01-d4432d901f25-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_colors.py'}, 'id': '3f65c7db-83ec-4502-90bc-f2b67855a69a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2136, 'output_tokens': 78, 'total_tokens': 2407, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 193}}
2025-12-21 02:48:52,714 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of the file `lib/matplotlib/tests/test_colors.py`. This will allow you to examine the existing test cases and identify those that are relevant to the bug report regarding `Colormap` and NumPy deprecation warnings.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"end_line": 1001.0, "start_line": 501.0, "relative_path": "lib/matplotlib/tests/test_colors.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 10789, 'candidates_token_count': 84, 'total_token_count': 11044, 'cached_content_token_count': 1870, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10789}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1870}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 84}], 'thoughts_token_count': 171}, 'finish_reason': 'STOP', 'avg_logprobs': -0.198896362667992, 'model_name': 'gemini-2.5-pro'} id='run--1a661649-dfb0-4865-80db-fe5aa7c9c9d6-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'end_line': 1001.0, 'start_line': 501.0, 'relative_path': 'lib/matplotlib/tests/test_colors.py'}, 'id': '9a3e5f84-20c5-4331-9df1-f6c99208879d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 10789, 'output_tokens': 84, 'total_tokens': 11044, 'input_token_details': {'cache_read': 1870}, 'output_token_details': {'reasoning': 171}}
2025-12-21 02:49:00,448 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_provider_node - DEBUG - content='I have provided the complete content of the test file `lib/matplotlib/tests/test_colors.py`. You can now use this to find test cases related to the bug report on `Colormap` and NumPy deprecation warnings. Several tests within this file, such as `test_register_cmap`, `test_colormaps_get_cmap`, and others, deal with colormap functionalities and might be relevant to your investigation.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20250, 'candidates_token_count': 90, 'total_token_count': 20914, 'cached_content_token_count': 9656, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20250}], 'cache_tokens_details': [{'modality': 1, 'token_count': 9656}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 90}], 'thoughts_token_count': 574}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5785511016845704, 'model_name': 'gemini-2.5-pro'} id='run--8cf9b15e-29c5-4f34-bef3-59d45c42cc69-0' usage_metadata={'input_tokens': 20250, 'output_tokens': 90, 'total_tokens': 20914, 'input_token_details': {'cache_read': 9656}, 'output_token_details': {'reasoning': 574}}
2025-12-21 02:49:00,449 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - This is the query you need to answer:

--- BEGIN QUERY ---
Please provide the full content of lib/matplotlib/tests/test_colors.py
--- END QUERY ---



--- BEGIN PURPOSE ---
I need the content of this test file to find existing test cases that are relevant to the bug report concerning `Colormap` and NumPy deprecation warnings.
--- END PURPOSE ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_colors.py
Line number range: 1 - 500
Content:
1. import copy
2. import itertools
3. import unittest.mock
4. 
5. from io import BytesIO
6. import numpy as np
7. from PIL import Image
8. import pytest
9. import base64
10. 
11. from numpy.testing import assert_array_equal, assert_array_almost_equal
12. 
13. from matplotlib import cbook, cm, cycler
14. import matplotlib
15. import matplotlib as mpl
16. import matplotlib.colors as mcolors
17. import matplotlib.colorbar as mcolorbar
18. import matplotlib.pyplot as plt
19. import matplotlib.scale as mscale
20. from matplotlib.testing.decorators import image_comparison, check_figures_equal
21. 
22. 
23. @pytest.mark.parametrize('N, result', [
24.     (5, [1, .6, .2, .1, 0]),
25.     (2, [1, 0]),
26.     (1, [0]),
27. ])
28. def test_create_lookup_table(N, result):
29.     data = [(0.0, 1.0, 1.0), (0.5, 0.2, 0.2), (1.0, 0.0, 0.0)]
30.     assert_array_almost_equal(mcolors._create_lookup_table(N, data), result)
31. 
32. 
33. def test_resampled():
34.     """
35.     GitHub issue #6025 pointed to incorrect ListedColormap.resampled;
36.     here we test the method for LinearSegmentedColormap as well.
37.     """
38.     n = 101
39.     colorlist = np.empty((n, 4), float)
40.     colorlist[:, 0] = np.linspace(0, 1, n)
41.     colorlist[:, 1] = 0.2
42.     colorlist[:, 2] = np.linspace(1, 0, n)
43.     colorlist[:, 3] = 0.7
44.     lsc = mcolors.LinearSegmentedColormap.from_list('lsc', colorlist)
45.     lc = mcolors.ListedColormap(colorlist)
46.     # Set some bad values for testing too
47.     for cmap in [lsc, lc]:
48.         cmap.set_under('r')
49.         cmap.set_over('g')
50.         cmap.set_bad('b')
51.     lsc3 = lsc.resampled(3)
52.     lc3 = lc.resampled(3)
53.     expected = np.array([[0.0, 0.2, 1.0, 0.7],
54.                          [0.5, 0.2, 0.5, 0.7],
55.                          [1.0, 0.2, 0.0, 0.7]], float)
56.     assert_array_almost_equal(lsc3([0, 0.5, 1]), expected)
57.     assert_array_almost_equal(lc3([0, 0.5, 1]), expected)
58.     # Test over/under was copied properly
59.     assert_array_almost_equal(lsc(np.inf), lsc3(np.inf))
60.     assert_array_almost_equal(lsc(-np.inf), lsc3(-np.inf))
61.     assert_array_almost_equal(lsc(np.nan), lsc3(np.nan))
62.     assert_array_almost_equal(lc(np.inf), lc3(np.inf))
63.     assert_array_almost_equal(lc(-np.inf), lc3(-np.inf))
64.     assert_array_almost_equal(lc(np.nan), lc3(np.nan))
65. 
66. 
67. def test_register_cmap():
68.     new_cm = mpl.colormaps["viridis"]
69.     target = "viridis2"
70.     with pytest.warns(
71.             mpl.MatplotlibDeprecationWarning,
72.             match=r"matplotlib\.colormaps\.register\(name\)"
73.     ):
74.         cm.register_cmap(target, new_cm)
75.     assert mpl.colormaps[target] == new_cm
76. 
77.     with pytest.raises(ValueError,
78.                        match="Arguments must include a name or a Colormap"):
79.         with pytest.warns(
80.             mpl.MatplotlibDeprecationWarning,
81.             match=r"matplotlib\.colormaps\.register\(name\)"
82.         ):
83.             cm.register_cmap()
84. 
85.     with pytest.warns(
86.             mpl.MatplotlibDeprecationWarning,
87.             match=r"matplotlib\.colormaps\.unregister\(name\)"
88.     ):
89.         cm.unregister_cmap(target)
90.     with pytest.raises(ValueError,
91.                        match=f'{target!r} is not a valid value for name;'):
92.         with pytest.warns(
93.                 mpl.MatplotlibDeprecationWarning,
94.                 match=r"matplotlib\.colormaps\[name\]"
95.         ):
96.             cm.get_cmap(target)
97.     with pytest.warns(
98.             mpl.MatplotlibDeprecationWarning,
99.             match=r"matplotlib\.colormaps\.unregister\(name\)"
100.     ):
101.         # test that second time is error free
102.         cm.unregister_cmap(target)
103. 
104.     with pytest.raises(TypeError, match="'cmap' must be"):
105.         with pytest.warns(
106.             mpl.MatplotlibDeprecationWarning,
107.             match=r"matplotlib\.colormaps\.register\(name\)"
108.         ):
109.             cm.register_cmap('nome', cmap='not a cmap')
110. 
111. 
112. def test_colormaps_get_cmap():
113.     cr = mpl.colormaps
114. 
115.     # check str, and Colormap pass
116.     assert cr.get_cmap('plasma') == cr["plasma"]
117.     assert cr.get_cmap(cr["magma"]) == cr["magma"]
118. 
119.     # check default
120.     assert cr.get_cmap(None) == cr[mpl.rcParams['image.cmap']]
121. 
122.     # check ValueError on bad name
123.     bad_cmap = 'AardvarksAreAwkward'
124.     with pytest.raises(ValueError, match=bad_cmap):
125.         cr.get_cmap(bad_cmap)
126. 
127.     # check TypeError on bad type
128.     with pytest.raises(TypeError, match='object'):
129.         cr.get_cmap(object())
130. 
131. 
132. def test_double_register_builtin_cmap():
133.     name = "viridis"
134.     match = f"Re-registering the builtin cmap {name!r}."
135.     with pytest.raises(ValueError, match=match):
136.         matplotlib.colormaps.register(
137.             mpl.colormaps[name], name=name, force=True
138.         )
139.     with pytest.raises(ValueError, match='A colormap named "viridis"'):
140.         with pytest.warns(mpl.MatplotlibDeprecationWarning):
141.             cm.register_cmap(name, mpl.colormaps[name])
142.     with pytest.warns(UserWarning):
143.         # TODO is warning more than once!
144.         cm.register_cmap(name, mpl.colormaps[name], override_builtin=True)
145. 
146. 
147. def test_unregister_builtin_cmap():
148.     name = "viridis"
149.     match = f'cannot unregister {name!r} which is a builtin colormap.'
150.     with pytest.raises(ValueError, match=match):
151.         with pytest.warns(mpl.MatplotlibDeprecationWarning):
152.             cm.unregister_cmap(name)
153. 
154. 
155. def test_colormap_copy():
156.     cmap = plt.cm.Reds
157.     copied_cmap = copy.copy(cmap)
158.     with np.errstate(invalid='ignore'):
159.         ret1 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
160.     cmap2 = copy.copy(copied_cmap)
161.     cmap2.set_bad('g')
162.     with np.errstate(invalid='ignore'):
163.         ret2 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
164.     assert_array_equal(ret1, ret2)
165.     # again with the .copy method:
166.     cmap = plt.cm.Reds
167.     copied_cmap = cmap.copy()
168.     with np.errstate(invalid='ignore'):
169.         ret1 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
170.     cmap2 = copy.copy(copied_cmap)
171.     cmap2.set_bad('g')
172.     with np.errstate(invalid='ignore'):
173.         ret2 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
174.     assert_array_equal(ret1, ret2)
175. 
176. 
177. def test_colormap_equals():
178.     cmap = mpl.colormaps["plasma"]
179.     cm_copy = cmap.copy()
180.     # different object id's
181.     assert cm_copy is not cmap
182.     # But the same data should be equal
183.     assert cm_copy == cmap
184.     # Change the copy
185.     cm_copy.set_bad('y')
186.     assert cm_copy != cmap
187.     # Make sure we can compare different sizes without failure
188.     cm_copy._lut = cm_copy._lut[:10, :]
189.     assert cm_copy != cmap
190.     # Test different names are not equal
191.     cm_copy = cmap.copy()
192.     cm_copy.name = "Test"
193.     assert cm_copy != cmap
194.     # Test colorbar extends
195.     cm_copy = cmap.copy()
196.     cm_copy.colorbar_extend = not cmap.colorbar_extend
197.     assert cm_copy != cmap
198. 
199. 
200. def test_colormap_endian():
201.     """
202.     GitHub issue #1005: a bug in putmask caused erroneous
203.     mapping of 1.0 when input from a non-native-byteorder
204.     array.
205.     """
206.     cmap = mpl.colormaps["jet"]
207.     # Test under, over, and invalid along with values 0 and 1.
208.     a = [-0.5, 0, 0.5, 1, 1.5, np.nan]
209.     for dt in ["f2", "f4", "f8"]:
210.         anative = np.ma.masked_invalid(np.array(a, dtype=dt))
211.         aforeign = anative.byteswap().newbyteorder()
212.         assert_array_equal(cmap(anative), cmap(aforeign))
213. 
214. 
215. def test_colormap_invalid():
216.     """
217.     GitHub issue #9892: Handling of nan's were getting mapped to under
218.     rather than bad. This tests to make sure all invalid values
219.     (-inf, nan, inf) are mapped respectively to (under, bad, over).
220.     """
221.     cmap = mpl.colormaps["plasma"]
222.     x = np.array([-np.inf, -1, 0, np.nan, .7, 2, np.inf])
223. 
224.     expected = np.array([[0.050383, 0.029803, 0.527975, 1.],
225.                          [0.050383, 0.029803, 0.527975, 1.],
226.                          [0.050383, 0.029803, 0.527975, 1.],
227.                          [0.,       0.,       0.,       0.],
228.                          [0.949217, 0.517763, 0.295662, 1.],
229.                          [0.940015, 0.975158, 0.131326, 1.],
230.                          [0.940015, 0.975158, 0.131326, 1.]])
231.     assert_array_equal(cmap(x), expected)
232. 
233.     # Test masked representation (-inf, inf) are now masked
234.     expected = np.array([[0.,       0.,       0.,       0.],
235.                          [0.050383, 0.029803, 0.527975, 1.],
236.                          [0.050383, 0.029803, 0.527975, 1.],
237.                          [0.,       0.,       0.,       0.],
238.                          [0.949217, 0.517763, 0.295662, 1.],
239.                          [0.940015, 0.975158, 0.131326, 1.],
240.                          [0.,       0.,       0.,       0.]])
241.     assert_array_equal(cmap(np.ma.masked_invalid(x)), expected)
242. 
243.     # Test scalar representations
244.     assert_array_equal(cmap(-np.inf), cmap(0))
245.     assert_array_equal(cmap(np.inf), cmap(1.0))
246.     assert_array_equal(cmap(np.nan), [0., 0., 0., 0.])
247. 
248. 
249. def test_colormap_return_types():
250.     """
251.     Make sure that tuples are returned for scalar input and
252.     that the proper shapes are returned for ndarrays.
253.     """
254.     cmap = mpl.colormaps["plasma"]
255.     # Test return types and shapes
256.     # scalar input needs to return a tuple of length 4
257.     assert isinstance(cmap(0.5), tuple)
258.     assert len(cmap(0.5)) == 4
259. 
260.     # input array returns an ndarray of shape x.shape + (4,)
261.     x = np.ones(4)
262.     assert cmap(x).shape == x.shape + (4,)
263. 
264.     # multi-dimensional array input
265.     x2d = np.zeros((2, 2))
266.     assert cmap(x2d).shape == x2d.shape + (4,)
267. 
268. 
269. def test_BoundaryNorm():
270.     """
271.     GitHub issue #1258: interpolation was failing with numpy
272.     1.7 pre-release.
273.     """
274. 
275.     boundaries = [0, 1.1, 2.2]
276.     vals = [-1, 0, 1, 2, 2.2, 4]
277. 
278.     # Without interpolation
279.     expected = [-1, 0, 0, 1, 2, 2]
280.     ncolors = len(boundaries) - 1
281.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
282.     assert_array_equal(bn(vals), expected)
283. 
284.     # ncolors != len(boundaries) - 1 triggers interpolation
285.     expected = [-1, 0, 0, 2, 3, 3]
286.     ncolors = len(boundaries)
287.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
288.     assert_array_equal(bn(vals), expected)
289. 
290.     # with a single region and interpolation
291.     expected = [-1, 1, 1, 1, 3, 3]
292.     bn = mcolors.BoundaryNorm([0, 2.2], ncolors)
293.     assert_array_equal(bn(vals), expected)
294. 
295.     # more boundaries for a third color
296.     boundaries = [0, 1, 2, 3]
297.     vals = [-1, 0.1, 1.1, 2.2, 4]
298.     ncolors = 5
299.     expected = [-1, 0, 2, 4, 5]
300.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
301.     assert_array_equal(bn(vals), expected)
302. 
303.     # a scalar as input should not trigger an error and should return a scalar
304.     boundaries = [0, 1, 2]
305.     vals = [-1, 0.1, 1.1, 2.2]
306.     bn = mcolors.BoundaryNorm(boundaries, 2)
307.     expected = [-1, 0, 1, 2]
308.     for v, ex in zip(vals, expected):
309.         ret = bn(v)
310.         assert isinstance(ret, int)
311.         assert_array_equal(ret, ex)
312.         assert_array_equal(bn([v]), ex)
313. 
314.     # same with interp
315.     bn = mcolors.BoundaryNorm(boundaries, 3)
316.     expected = [-1, 0, 2, 3]
317.     for v, ex in zip(vals, expected):
318.         ret = bn(v)
319.         assert isinstance(ret, int)
320.         assert_array_equal(ret, ex)
321.         assert_array_equal(bn([v]), ex)
322. 
323.     # Clipping
324.     bn = mcolors.BoundaryNorm(boundaries, 3, clip=True)
325.     expected = [0, 0, 2, 2]
326.     for v, ex in zip(vals, expected):
327.         ret = bn(v)
328.         assert isinstance(ret, int)
329.         assert_array_equal(ret, ex)
330.         assert_array_equal(bn([v]), ex)
331. 
332.     # Masked arrays
333.     boundaries = [0, 1.1, 2.2]
334.     vals = np.ma.masked_invalid([-1., np.NaN, 0, 1.4, 9])
335. 
336.     # Without interpolation
337.     ncolors = len(boundaries) - 1
338.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
339.     expected = np.ma.masked_array([-1, -99, 0, 1, 2], mask=[0, 1, 0, 0, 0])
340.     assert_array_equal(bn(vals), expected)
341. 
342.     # With interpolation
343.     bn = mcolors.BoundaryNorm(boundaries, len(boundaries))
344.     expected = np.ma.masked_array([-1, -99, 0, 2, 3], mask=[0, 1, 0, 0, 0])
345.     assert_array_equal(bn(vals), expected)
346. 
347.     # Non-trivial masked arrays
348.     vals = np.ma.masked_invalid([np.Inf, np.NaN])
349.     assert np.all(bn(vals).mask)
350.     vals = np.ma.masked_invalid([np.Inf])
351.     assert np.all(bn(vals).mask)
352. 
353.     # Incompatible extend and clip
354.     with pytest.raises(ValueError, match="not compatible"):
355.         mcolors.BoundaryNorm(np.arange(4), 5, extend='both', clip=True)
356. 
357.     # Too small ncolors argument
358.     with pytest.raises(ValueError, match="ncolors must equal or exceed"):
359.         mcolors.BoundaryNorm(np.arange(4), 2)
360. 
361.     with pytest.raises(ValueError, match="ncolors must equal or exceed"):
362.         mcolors.BoundaryNorm(np.arange(4), 3, extend='min')
363. 
364.     with pytest.raises(ValueError, match="ncolors must equal or exceed"):
365.         mcolors.BoundaryNorm(np.arange(4), 4, extend='both')
366. 
367.     # Testing extend keyword, with interpolation (large cmap)
368.     bounds = [1, 2, 3]
369.     cmap = mpl.colormaps['viridis']
370.     mynorm = mcolors.BoundaryNorm(bounds, cmap.N, extend='both')
371.     refnorm = mcolors.BoundaryNorm([0] + bounds + [4], cmap.N)
372.     x = np.random.randn(100) * 10 + 2
373.     ref = refnorm(x)
374.     ref[ref == 0] = -1
375.     ref[ref == cmap.N - 1] = cmap.N
376.     assert_array_equal(mynorm(x), ref)
377. 
378.     # Without interpolation
379.     cmref = mcolors.ListedColormap(['blue', 'red'])
380.     cmref.set_over('black')
381.     cmref.set_under('white')
382.     cmshould = mcolors.ListedColormap(['white', 'blue', 'red', 'black'])
383. 
384.     assert mcolors.same_color(cmref.get_over(), 'black')
385.     assert mcolors.same_color(cmref.get_under(), 'white')
386. 
387.     refnorm = mcolors.BoundaryNorm(bounds, cmref.N)
388.     mynorm = mcolors.BoundaryNorm(bounds, cmshould.N, extend='both')
389.     assert mynorm.vmin == refnorm.vmin
390.     assert mynorm.vmax == refnorm.vmax
391. 
392.     assert mynorm(bounds[0] - 0.1) == -1  # under
393.     assert mynorm(bounds[0] + 0.1) == 1   # first bin -> second color
394.     assert mynorm(bounds[-1] - 0.1) == cmshould.N - 2  # next-to-last color
395.     assert mynorm(bounds[-1] + 0.1) == cmshould.N  # over
396. 
397.     x = [-1, 1.2, 2.3, 9.6]
398.     assert_array_equal(cmshould(mynorm(x)), cmshould([0, 1, 2, 3]))
399.     x = np.random.randn(100) * 10 + 2
400.     assert_array_equal(cmshould(mynorm(x)), cmref(refnorm(x)))
401. 
402.     # Just min
403.     cmref = mcolors.ListedColormap(['blue', 'red'])
404.     cmref.set_under('white')
405.     cmshould = mcolors.ListedColormap(['white', 'blue', 'red'])
406. 
407.     assert mcolors.same_color(cmref.get_under(), 'white')
408. 
409.     assert cmref.N == 2
410.     assert cmshould.N == 3
411.     refnorm = mcolors.BoundaryNorm(bounds, cmref.N)
412.     mynorm = mcolors.BoundaryNorm(bounds, cmshould.N, extend='min')
413.     assert mynorm.vmin == refnorm.vmin
414.     assert mynorm.vmax == refnorm.vmax
415.     x = [-1, 1.2, 2.3]
416.     assert_array_equal(cmshould(mynorm(x)), cmshould([0, 1, 2]))
417.     x = np.random.randn(100) * 10 + 2
418.     assert_array_equal(cmshould(mynorm(x)), cmref(refnorm(x)))
419. 
420.     # Just max
421.     cmref = mcolors.ListedColormap(['blue', 'red'])
422.     cmref.set_over('black')
423.     cmshould = mcolors.ListedColormap(['blue', 'red', 'black'])
424. 
425.     assert mcolors.same_color(cmref.get_over(), 'black')
426. 
427.     assert cmref.N == 2
428.     assert cmshould.N == 3
429.     refnorm = mcolors.BoundaryNorm(bounds, cmref.N)
430.     mynorm = mcolors.BoundaryNorm(bounds, cmshould.N, extend='max')
431.     assert mynorm.vmin == refnorm.vmin
432.     assert mynorm.vmax == refnorm.vmax
433.     x = [1.2, 2.3, 4]
434.     assert_array_equal(cmshould(mynorm(x)), cmshould([0, 1, 2]))
435.     x = np.random.randn(100) * 10 + 2
436.     assert_array_equal(cmshould(mynorm(x)), cmref(refnorm(x)))
437. 
438. 
439. def test_CenteredNorm():
440.     np.random.seed(0)
441. 
442.     # Assert equivalence to symmetrical Normalize.
443.     x = np.random.normal(size=100)
444.     x_maxabs = np.max(np.abs(x))
445.     norm_ref = mcolors.Normalize(vmin=-x_maxabs, vmax=x_maxabs)
446.     norm = mcolors.CenteredNorm()
447.     assert_array_almost_equal(norm_ref(x), norm(x))
448. 
449.     # Check that vcenter is in the center of vmin and vmax
450.     # when vcenter is set.
451.     vcenter = int(np.random.normal(scale=50))
452.     norm = mcolors.CenteredNorm(vcenter=vcenter)
453.     norm.autoscale_None([1, 2])
454.     assert norm.vmax + norm.vmin == 2 * vcenter
455. 
456.     # Check that halfrange can be set without setting vcenter and that it is
457.     # not reset through autoscale_None.
458.     norm = mcolors.CenteredNorm(halfrange=1.0)
459.     norm.autoscale_None([1, 3000])
460.     assert norm.halfrange == 1.0
461. 
462.     # Check that halfrange input works correctly.
463.     x = np.random.normal(size=10)
464.     norm = mcolors.CenteredNorm(vcenter=0.5, halfrange=0.5)
465.     assert_array_almost_equal(x, norm(x))
466.     norm = mcolors.CenteredNorm(vcenter=1, halfrange=1)
467.     assert_array_almost_equal(x, 2 * norm(x))
468. 
469.     # Check that halfrange input works correctly and use setters.
470.     norm = mcolors.CenteredNorm()
471.     norm.vcenter = 2
472.     norm.halfrange = 2
473.     assert_array_almost_equal(x, 4 * norm(x))
474. 
475.     # Check that prior to adding data, setting halfrange first has same effect.
476.     norm = mcolors.CenteredNorm()
477.     norm.halfrange = 2
478.     norm.vcenter = 2
479.     assert_array_almost_equal(x, 4 * norm(x))
480. 
481.     # Check that manual change of vcenter adjusts halfrange accordingly.
482.     norm = mcolors.CenteredNorm()
483.     assert norm.vcenter == 0
484.     # add data
485.     norm(np.linspace(-1.0, 0.0, 10))
486.     assert norm.vmax == 1.0
487.     assert norm.halfrange == 1.0
488.     # set vcenter to 1, which should move the center but leave the
489.     # halfrange unchanged
490.     norm.vcenter = 1
491.     assert norm.vmin == 0
492.     assert norm.vmax == 2
493.     assert norm.halfrange == 1
494. 
495.     # Check setting vmin directly updates the halfrange and vmax, but
496.     # leaves vcenter alone
497.     norm.vmin = -1
498.     assert norm.halfrange == 2
499.     assert norm.vmax == 3
500.     assert norm.vcenter == 1


File: lib/matplotlib/tests/test_colors.py
Line number range: 501 - 1001
Content:
501. 
502.     # also check vmax updates
503.     norm.vmax = 2
504.     assert norm.halfrange == 1
505.     assert norm.vmin == 0
506.     assert norm.vcenter == 1
507. 
508. 
509. @pytest.mark.parametrize("vmin,vmax", [[-1, 2], [3, 1]])
510. def test_lognorm_invalid(vmin, vmax):
511.     # Check that invalid limits in LogNorm error
512.     norm = mcolors.LogNorm(vmin=vmin, vmax=vmax)
513.     with pytest.raises(ValueError):
514.         norm(1)
515.     with pytest.raises(ValueError):
516.         norm.inverse(1)
517. 
518. 
519. def test_LogNorm():
520.     """
521.     LogNorm ignored clip, now it has the same
522.     behavior as Normalize, e.g., values > vmax are bigger than 1
523.     without clip, with clip they are 1.
524.     """
525.     ln = mcolors.LogNorm(clip=True, vmax=5)
526.     assert_array_equal(ln([1, 6]), [0, 1.0])
527. 
528. 
529. def test_LogNorm_inverse():
530.     """
531.     Test that lists work, and that the inverse works
532.     """
533.     norm = mcolors.LogNorm(vmin=0.1, vmax=10)
534.     assert_array_almost_equal(norm([0.5, 0.4]), [0.349485, 0.30103])
535.     assert_array_almost_equal([0.5, 0.4], norm.inverse([0.349485, 0.30103]))
536.     assert_array_almost_equal(norm(0.4), [0.30103])
537.     assert_array_almost_equal([0.4], norm.inverse([0.30103]))
538. 
539. 
540. def test_PowerNorm():
541.     a = np.array([0, 0.5, 1, 1.5], dtype=float)
542.     pnorm = mcolors.PowerNorm(1)
543.     norm = mcolors.Normalize()
544.     assert_array_almost_equal(norm(a), pnorm(a))
545. 
546.     a = np.array([-0.5, 0, 2, 4, 8], dtype=float)
547.     expected = [0, 0, 1/16, 1/4, 1]
548.     pnorm = mcolors.PowerNorm(2, vmin=0, vmax=8)
549.     assert_array_almost_equal(pnorm(a), expected)
550.     assert pnorm(a[0]) == expected[0]
551.     assert pnorm(a[2]) == expected[2]
552.     assert_array_almost_equal(a[1:], pnorm.inverse(pnorm(a))[1:])
553. 
554.     # Clip = True
555.     a = np.array([-0.5, 0, 1, 8, 16], dtype=float)
556.     expected = [0, 0, 0, 1, 1]
557.     pnorm = mcolors.PowerNorm(2, vmin=2, vmax=8, clip=True)
558.     assert_array_almost_equal(pnorm(a), expected)
559.     assert pnorm(a[0]) == expected[0]
560.     assert pnorm(a[-1]) == expected[-1]
561. 
562.     # Clip = True at call time
563.     a = np.array([-0.5, 0, 1, 8, 16], dtype=float)
564.     expected = [0, 0, 0, 1, 1]
565.     pnorm = mcolors.PowerNorm(2, vmin=2, vmax=8, clip=False)
566.     assert_array_almost_equal(pnorm(a, clip=True), expected)
567.     assert pnorm(a[0], clip=True) == expected[0]
568.     assert pnorm(a[-1], clip=True) == expected[-1]
569. 
570. 
571. def test_PowerNorm_translation_invariance():
572.     a = np.array([0, 1/2, 1], dtype=float)
573.     expected = [0, 1/8, 1]
574.     pnorm = mcolors.PowerNorm(vmin=0, vmax=1, gamma=3)
575.     assert_array_almost_equal(pnorm(a), expected)
576.     pnorm = mcolors.PowerNorm(vmin=-2, vmax=-1, gamma=3)
577.     assert_array_almost_equal(pnorm(a - 2), expected)
578. 
579. 
580. def test_Normalize():
581.     norm = mcolors.Normalize()
582.     vals = np.arange(-10, 10, 1, dtype=float)
583.     _inverse_tester(norm, vals)
584.     _scalar_tester(norm, vals)
585.     _mask_tester(norm, vals)
586. 
587.     # Handle integer input correctly (don't overflow when computing max-min,
588.     # i.e. 127-(-128) here).
589.     vals = np.array([-128, 127], dtype=np.int8)
590.     norm = mcolors.Normalize(vals.min(), vals.max())
591.     assert_array_equal(norm(vals), [0, 1])
592. 
593.     # Don't lose precision on longdoubles (float128 on Linux):
594.     # for array inputs...
595.     vals = np.array([1.2345678901, 9.8765432109], dtype=np.longdouble)
596.     norm = mcolors.Normalize(vals[0], vals[1])
597.     assert norm(vals).dtype == np.longdouble
598.     assert_array_equal(norm(vals), [0, 1])
599.     # and for scalar ones.
600.     eps = np.finfo(np.longdouble).resolution
601.     norm = plt.Normalize(1, 1 + 100 * eps)
602.     # This returns exactly 0.5 when longdouble is extended precision (80-bit),
603.     # but only a value close to it when it is quadruple precision (128-bit).
604.     assert_array_almost_equal(norm(1 + 50 * eps), 0.5, decimal=3)
605. 
606. 
607. def test_FuncNorm():
608.     def forward(x):
609.         return (x**2)
610.     def inverse(x):
611.         return np.sqrt(x)
612. 
613.     norm = mcolors.FuncNorm((forward, inverse), vmin=0, vmax=10)
614.     expected = np.array([0, 0.25, 1])
615.     input = np.array([0, 5, 10])
616.     assert_array_almost_equal(norm(input), expected)
617.     assert_array_almost_equal(norm.inverse(expected), input)
618. 
619.     def forward(x):
620.         return np.log10(x)
621.     def inverse(x):
622.         return 10**x
623.     norm = mcolors.FuncNorm((forward, inverse), vmin=0.1, vmax=10)
624.     lognorm = mcolors.LogNorm(vmin=0.1, vmax=10)
625.     assert_array_almost_equal(norm([0.2, 5, 10]), lognorm([0.2, 5, 10]))
626.     assert_array_almost_equal(norm.inverse([0.2, 5, 10]),
627.                               lognorm.inverse([0.2, 5, 10]))
628. 
629. 
630. def test_TwoSlopeNorm_autoscale():
631.     norm = mcolors.TwoSlopeNorm(vcenter=20)
632.     norm.autoscale([10, 20, 30, 40])
633.     assert norm.vmin == 10.
634.     assert norm.vmax == 40.
635. 
636. 
637. def test_TwoSlopeNorm_autoscale_None_vmin():
638.     norm = mcolors.TwoSlopeNorm(2, vmin=0, vmax=None)
639.     norm.autoscale_None([1, 2, 3, 4, 5])
640.     assert norm(5) == 1
641.     assert norm.vmax == 5
642. 
643. 
644. def test_TwoSlopeNorm_autoscale_None_vmax():
645.     norm = mcolors.TwoSlopeNorm(2, vmin=None, vmax=10)
646.     norm.autoscale_None([1, 2, 3, 4, 5])
647.     assert norm(1) == 0
648.     assert norm.vmin == 1
649. 
650. 
651. def test_TwoSlopeNorm_scale():
652.     norm = mcolors.TwoSlopeNorm(2)
653.     assert norm.scaled() is False
654.     norm([1, 2, 3, 4])
655.     assert norm.scaled() is True
656. 
657. 
658. def test_TwoSlopeNorm_scaleout_center():
659.     # test the vmin never goes above vcenter
660.     norm = mcolors.TwoSlopeNorm(vcenter=0)
661.     norm([1, 2, 3, 5])
662.     assert norm.vmin == 0
663.     assert norm.vmax == 5
664. 
665. 
666. def test_TwoSlopeNorm_scaleout_center_max():
667.     # test the vmax never goes below vcenter
668.     norm = mcolors.TwoSlopeNorm(vcenter=0)
669.     norm([-1, -2, -3, -5])
670.     assert norm.vmax == 0
671.     assert norm.vmin == -5
672. 
673. 
674. def test_TwoSlopeNorm_Even():
675.     norm = mcolors.TwoSlopeNorm(vmin=-1, vcenter=0, vmax=4)
676.     vals = np.array([-1.0, -0.5, 0.0, 1.0, 2.0, 3.0, 4.0])
677.     expected = np.array([0.0, 0.25, 0.5, 0.625, 0.75, 0.875, 1.0])
678.     assert_array_equal(norm(vals), expected)
679. 
680. 
681. def test_TwoSlopeNorm_Odd():
682.     norm = mcolors.TwoSlopeNorm(vmin=-2, vcenter=0, vmax=5)
683.     vals = np.array([-2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0])
684.     expected = np.array([0.0, 0.25, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0])
685.     assert_array_equal(norm(vals), expected)
686. 
687. 
688. def test_TwoSlopeNorm_VminEqualsVcenter():
689.     with pytest.raises(ValueError):
690.         mcolors.TwoSlopeNorm(vmin=-2, vcenter=-2, vmax=2)
691. 
692. 
693. def test_TwoSlopeNorm_VmaxEqualsVcenter():
694.     with pytest.raises(ValueError):
695.         mcolors.TwoSlopeNorm(vmin=-2, vcenter=2, vmax=2)
696. 
697. 
698. def test_TwoSlopeNorm_VminGTVcenter():
699.     with pytest.raises(ValueError):
700.         mcolors.TwoSlopeNorm(vmin=10, vcenter=0, vmax=20)
701. 
702. 
703. def test_TwoSlopeNorm_TwoSlopeNorm_VminGTVmax():
704.     with pytest.raises(ValueError):
705.         mcolors.TwoSlopeNorm(vmin=10, vcenter=0, vmax=5)
706. 
707. 
708. def test_TwoSlopeNorm_VcenterGTVmax():
709.     with pytest.raises(ValueError):
710.         mcolors.TwoSlopeNorm(vmin=10, vcenter=25, vmax=20)
711. 
712. 
713. def test_TwoSlopeNorm_premature_scaling():
714.     norm = mcolors.TwoSlopeNorm(vcenter=2)
715.     with pytest.raises(ValueError):
716.         norm.inverse(np.array([0.1, 0.5, 0.9]))
717. 
718. 
719. def test_SymLogNorm():
720.     """
721.     Test SymLogNorm behavior
722.     """
723.     norm = mcolors.SymLogNorm(3, vmax=5, linscale=1.2, base=np.e)
724.     vals = np.array([-30, -1, 2, 6], dtype=float)
725.     normed_vals = norm(vals)
726.     expected = [0., 0.53980074, 0.826991, 1.02758204]
727.     assert_array_almost_equal(normed_vals, expected)
728.     _inverse_tester(norm, vals)
729.     _scalar_tester(norm, vals)
730.     _mask_tester(norm, vals)
731. 
732.     # Ensure that specifying vmin returns the same result as above
733.     norm = mcolors.SymLogNorm(3, vmin=-30, vmax=5, linscale=1.2, base=np.e)
734.     normed_vals = norm(vals)
735.     assert_array_almost_equal(normed_vals, expected)
736. 
737.     # test something more easily checked.
738.     norm = mcolors.SymLogNorm(1, vmin=-np.e**3, vmax=np.e**3, base=np.e)
739.     nn = norm([-np.e**3, -np.e**2, -np.e**1, -1,
740.               0, 1, np.e**1, np.e**2, np.e**3])
741.     xx = np.array([0., 0.109123, 0.218246, 0.32737, 0.5, 0.67263,
742.                    0.781754, 0.890877, 1.])
743.     assert_array_almost_equal(nn, xx)
744.     norm = mcolors.SymLogNorm(1, vmin=-10**3, vmax=10**3, base=10)
745.     nn = norm([-10**3, -10**2, -10**1, -1,
746.               0, 1, 10**1, 10**2, 10**3])
747.     xx = np.array([0., 0.121622, 0.243243, 0.364865, 0.5, 0.635135,
748.                    0.756757, 0.878378, 1.])
749.     assert_array_almost_equal(nn, xx)
750. 
751. 
752. def test_SymLogNorm_colorbar():
753.     """
754.     Test un-called SymLogNorm in a colorbar.
755.     """
756.     norm = mcolors.SymLogNorm(0.1, vmin=-1, vmax=1, linscale=1, base=np.e)
757.     fig = plt.figure()
758.     mcolorbar.ColorbarBase(fig.add_subplot(), norm=norm)
759.     plt.close(fig)
760. 
761. 
762. def test_SymLogNorm_single_zero():
763.     """
764.     Test SymLogNorm to ensure it is not adding sub-ticks to zero label
765.     """
766.     fig = plt.figure()
767.     norm = mcolors.SymLogNorm(1e-5, vmin=-1, vmax=1, base=np.e)
768.     cbar = mcolorbar.ColorbarBase(fig.add_subplot(), norm=norm)
769.     ticks = cbar.get_ticks()
770.     assert np.count_nonzero(ticks == 0) <= 1
771.     plt.close(fig)
772. 
773. 
774. class TestAsinhNorm:
775.     """
776.     Tests for `~.colors.AsinhNorm`
777.     """
778. 
779.     def test_init(self):
780.         norm0 = mcolors.AsinhNorm()
781.         assert norm0.linear_width == 1
782. 
783.         norm5 = mcolors.AsinhNorm(linear_width=5)
784.         assert norm5.linear_width == 5
785. 
786.     def test_norm(self):
787.         norm = mcolors.AsinhNorm(2, vmin=-4, vmax=4)
788.         vals = np.arange(-3.5, 3.5, 10)
789.         normed_vals = norm(vals)
790.         asinh2 = np.arcsinh(2)
791. 
792.         expected = (2 * np.arcsinh(vals / 2) + 2 * asinh2) / (4 * asinh2)
793.         assert_array_almost_equal(normed_vals, expected)
794. 
795. 
796. def _inverse_tester(norm_instance, vals):
797.     """
798.     Checks if the inverse of the given normalization is working.
799.     """
800.     assert_array_almost_equal(norm_instance.inverse(norm_instance(vals)), vals)
801. 
802. 
803. def _scalar_tester(norm_instance, vals):
804.     """
805.     Checks if scalars and arrays are handled the same way.
806.     Tests only for float.
807.     """
808.     scalar_result = [norm_instance(float(v)) for v in vals]
809.     assert_array_almost_equal(scalar_result, norm_instance(vals))
810. 
811. 
812. def _mask_tester(norm_instance, vals):
813.     """
814.     Checks mask handling
815.     """
816.     masked_array = np.ma.array(vals)
817.     masked_array[0] = np.ma.masked
818.     assert_array_equal(masked_array.mask, norm_instance(masked_array).mask)
819. 
820. 
821. @image_comparison(['levels_and_colors.png'])
822. def test_cmap_and_norm_from_levels_and_colors():
823.     # Remove this line when this test image is regenerated.
824.     plt.rcParams['pcolormesh.snap'] = False
825. 
826.     data = np.linspace(-2, 4, 49).reshape(7, 7)
827.     levels = [-1, 2, 2.5, 3]
828.     colors = ['red', 'green', 'blue', 'yellow', 'black']
829.     extend = 'both'
830.     cmap, norm = mcolors.from_levels_and_colors(levels, colors, extend=extend)
831. 
832.     ax = plt.axes()
833.     m = plt.pcolormesh(data, cmap=cmap, norm=norm)
834.     plt.colorbar(m)
835. 
836.     # Hide the axes labels (but not the colorbar ones, as they are useful)
837.     ax.tick_params(labelleft=False, labelbottom=False)
838. 
839. 
840. @image_comparison(baseline_images=['boundarynorm_and_colorbar'],
841.                   extensions=['png'], tol=1.0)
842. def test_boundarynorm_and_colorbarbase():
843.     # Remove this line when this test image is regenerated.
844.     plt.rcParams['pcolormesh.snap'] = False
845. 
846.     # Make a figure and axes with dimensions as desired.
847.     fig = plt.figure()
848.     ax1 = fig.add_axes([0.05, 0.80, 0.9, 0.15])
849.     ax2 = fig.add_axes([0.05, 0.475, 0.9, 0.15])
850.     ax3 = fig.add_axes([0.05, 0.15, 0.9, 0.15])
851. 
852.     # Set the colormap and bounds
853.     bounds = [-1, 2, 5, 7, 12, 15]
854.     cmap = mpl.colormaps['viridis']
855. 
856.     # Default behavior
857.     norm = mcolors.BoundaryNorm(bounds, cmap.N)
858.     cb1 = mcolorbar.ColorbarBase(ax1, cmap=cmap, norm=norm, extend='both',
859.                                  orientation='horizontal', spacing='uniform')
860.     # New behavior
861.     norm = mcolors.BoundaryNorm(bounds, cmap.N, extend='both')
862.     cb2 = mcolorbar.ColorbarBase(ax2, cmap=cmap, norm=norm,
863.                                  orientation='horizontal')
864. 
865.     # User can still force to any extend='' if really needed
866.     norm = mcolors.BoundaryNorm(bounds, cmap.N, extend='both')
867.     cb3 = mcolorbar.ColorbarBase(ax3, cmap=cmap, norm=norm,
868.                                  extend='neither', orientation='horizontal')
869. 
870. 
871. def test_cmap_and_norm_from_levels_and_colors2():
872.     levels = [-1, 2, 2.5, 3]
873.     colors = ['red', (0, 1, 0), 'blue', (0.5, 0.5, 0.5), (0.0, 0.0, 0.0, 1.0)]
874.     clr = mcolors.to_rgba_array(colors)
875.     bad = (0.1, 0.1, 0.1, 0.1)
876.     no_color = (0.0, 0.0, 0.0, 0.0)
877.     masked_value = 'masked_value'
878. 
879.     # Define the test values which are of interest.
880.     # Note: levels are lev[i] <= v < lev[i+1]
881.     tests = [('both', None, {-2: clr[0],
882.                              -1: clr[1],
883.                              2: clr[2],
884.                              2.25: clr[2],
885.                              3: clr[4],
886.                              3.5: clr[4],
887.                              masked_value: bad}),
888. 
889.              ('min', -1, {-2: clr[0],
890.                           -1: clr[1],
891.                           2: clr[2],
892.                           2.25: clr[2],
893.                           3: no_color,
894.                           3.5: no_color,
895.                           masked_value: bad}),
896. 
897.              ('max', -1, {-2: no_color,
898.                           -1: clr[0],
899.                           2: clr[1],
900.                           2.25: clr[1],
901.                           3: clr[3],
902.                           3.5: clr[3],
903.                           masked_value: bad}),
904. 
905.              ('neither', -2, {-2: no_color,
906.                               -1: clr[0],
907.                               2: clr[1],
908.                               2.25: clr[1],
909.                               3: no_color,
910.                               3.5: no_color,
911.                               masked_value: bad}),
912.              ]
913. 
914.     for extend, i1, cases in tests:
915.         cmap, norm = mcolors.from_levels_and_colors(levels, colors[0:i1],
916.                                                     extend=extend)
917.         cmap.set_bad(bad)
918.         for d_val, expected_color in cases.items():
919.             if d_val == masked_value:
920.                 d_val = np.ma.array([1], mask=True)
921.             else:
922.                 d_val = [d_val]
923.             assert_array_equal(expected_color, cmap(norm(d_val))[0],
924.                                'Wih extend={0!r} and data '
925.                                'value={1!r}'.format(extend, d_val))
926. 
927.     with pytest.raises(ValueError):
928.         mcolors.from_levels_and_colors(levels, colors)
929. 
930. 
931. def test_rgb_hsv_round_trip():
932.     for a_shape in [(500, 500, 3), (500, 3), (1, 3), (3,)]:
933.         np.random.seed(0)
934.         tt = np.random.random(a_shape)
935.         assert_array_almost_equal(
936.             tt, mcolors.hsv_to_rgb(mcolors.rgb_to_hsv(tt)))
937.         assert_array_almost_equal(
938.             tt, mcolors.rgb_to_hsv(mcolors.hsv_to_rgb(tt)))
939. 
940. 
941. def test_autoscale_masked():
942.     # Test for #2336. Previously fully masked data would trigger a ValueError.
943.     data = np.ma.masked_all((12, 20))
944.     plt.pcolor(data)
945.     plt.draw()
946. 
947. 
948. @image_comparison(['light_source_shading_topo.png'])
949. def test_light_source_topo_surface():
950.     """Shades a DEM using different v.e.'s and blend modes."""
951.     dem = cbook.get_sample_data('jacksboro_fault_dem.npz', np_load=True)
952.     elev = dem['elevation']
953.     dx, dy = dem['dx'], dem['dy']
954.     # Get the true cellsize in meters for accurate vertical exaggeration
955.     # Convert from decimal degrees to meters
956.     dx = 111320.0 * dx * np.cos(dem['ymin'])
957.     dy = 111320.0 * dy
958. 
959.     ls = mcolors.LightSource(315, 45)
960.     cmap = cm.gist_earth
961. 
962.     fig, axs = plt.subplots(nrows=3, ncols=3)
963.     for row, mode in zip(axs, ['hsv', 'overlay', 'soft']):
964.         for ax, ve in zip(row, [0.1, 1, 10]):
965.             rgb = ls.shade(elev, cmap, vert_exag=ve, dx=dx, dy=dy,
966.                            blend_mode=mode)
967.             ax.imshow(rgb)
968.             ax.set(xticks=[], yticks=[])
969. 
970. 
971. def test_light_source_shading_default():
972.     """
973.     Array comparison test for the default "hsv" blend mode. Ensure the
974.     default result doesn't change without warning.
975.     """
976.     y, x = np.mgrid[-1.2:1.2:8j, -1.2:1.2:8j]
977.     z = 10 * np.cos(x**2 + y**2)
978. 
979.     cmap = plt.cm.copper
980.     ls = mcolors.LightSource(315, 45)
981.     rgb = ls.shade(z, cmap)
982. 
983.     # Result stored transposed and rounded for more compact display...
984.     expect = np.array(
985.         [[[0.00, 0.45, 0.90, 0.90, 0.82, 0.62, 0.28, 0.00],
986.           [0.45, 0.94, 0.99, 1.00, 1.00, 0.96, 0.65, 0.17],
987.           [0.90, 0.99, 1.00, 1.00, 1.00, 1.00, 0.94, 0.35],
988.           [0.90, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 0.49],
989.           [0.82, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 0.41],
990.           [0.62, 0.96, 1.00, 1.00, 1.00, 1.00, 0.90, 0.07],
991.           [0.28, 0.65, 0.94, 1.00, 1.00, 0.90, 0.35, 0.01],
992.           [0.00, 0.17, 0.35, 0.49, 0.41, 0.07, 0.01, 0.00]],
993. 
994.          [[0.00, 0.28, 0.59, 0.72, 0.62, 0.40, 0.18, 0.00],
995.           [0.28, 0.78, 0.93, 0.92, 0.83, 0.66, 0.39, 0.11],
996.           [0.59, 0.93, 0.99, 1.00, 0.92, 0.75, 0.50, 0.21],
997.           [0.72, 0.92, 1.00, 0.99, 0.93, 0.76, 0.51, 0.18],
998.           [0.62, 0.83, 0.92, 0.93, 0.87, 0.68, 0.42, 0.08],
999.           [0.40, 0.66, 0.75, 0.76, 0.68, 0.52, 0.23, 0.02],
1000.           [0.18, 0.39, 0.50, 0.51, 0.42, 0.23, 0.00, 0.00],
1001.           [0.00, 0.11, 0.21, 0.18, 0.08, 0.02, 0.00, 0.00]],

--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to the given query and return it in the specified format!

2025-12-21 02:49:13,567 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested the full content of the file 'lib/matplotlib/tests/test_colors.py'.\n2. Extended relevance:\n   - The provided context contains the entire content of the requested file, which is necessary to fulfill the user's request.\n   - The user intends to find test cases related to `Colormap` and NumPy deprecation warnings. This file is a test file for colors and colormaps, making its full content relevant to the user's goal.", relative_path='lib/matplotlib/tests/test_colors.py', start_line=1, end_line=1001)]
2025-12-21 02:49:13,569 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Storing 1 contexts to memory for query: Please provide the full content of lib/matplotlib/tests/test_colors.py
2025-12-21 02:49:13,569 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.memory_storage_node - ERROR - Failed to store to memory: Athena memory client is not configured.
2025-12-21 02:49:13,569 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.memory_storage_node - INFO - Successfully stored contexts to memory
2025-12-21 02:49:13,570 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - Adding 1 new contexts to 0 existing contexts
2025-12-21 02:49:13,570 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.add_result_context_node - INFO - After deduplication: 1 total contexts (removed 0 duplicates)
2025-12-21 02:49:13,570 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   ├── mpl.css
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   ├── cheatsheet_sidebar.html
|   |   ├── donate_sidebar.html
|   |   ├── function.rst
|   |   ├── pagesource.html
|   |   ├── search.html
|   |   ├── sidebar_announcement.html
|   |   └── sidebar_versions.html
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23573-AL.rst
|   |   |   |   ├── 23579-AL.rst
|   |   |   |   ├── 23710-ES.rst
|   |   |   |   ├── 24062-tb.rst
|   |   |   |   ├── 24131-OG.rst
|   |   |   |   ├── 24132-GL.rst
|   |   |   |   ├── 24189-JB.rst
|   |   |   |   ├── 24570-GL.rst
|   |   |   |   ├── 24655-AK.rst
|   |   |   |   ├── 24829-AL.rst
|   |   |   |   ├── 24870-AL.rst
|   |   |   |   ├── 24889-AL.rst
|   |   |   |   ├── 24912-AL.rst
|   |   |   |   └── 9598-AFV.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 19763-ES.rst
|   |   |   |   ├── 22314-AL.rst
|   |   |   |   ├── 23449-SS.rst
|   |   |   |   ├── 23720-RS.rst
|   |   |   |   ├── 23735-ES.rst
|   |   |   |   ├── 23824-OG.rst
|   |   |   |   ├── 24000-TH.rst
|   |   |   |   ├── 24013-TH.rst
|   |   |   |   ├── 24071-OG.rst
|   |   |   |   ├── 24088-JMK.rst
|   |   |   |   ├── 24131-OG.rst
|   |   |   |   ├── 24140-AL.rst
|   |   |   |   ├── 24144-AL.rst
|   |   |   |   ├── 24198-AL.rst
|   |   |   |   ├── 24208-AL.rst
|   |   |   |   ├── 24220-AL.rst
|   |   |   |   ├── 24221-AL.rst
|   |   |   |   ├── 24224-OG.rst
|   |   |   |   ├── 24240-OG.rst
|   |   |   |   ├── 24254-OG.rst
|   |   |   |   ├── 24305-AL.rst
|   |   |   |   ├── 24455-AL.rst
|   |   |   |   ├── 24465-AL.rst
|   |   |   |   ├── 24474_CM.rst
|   |   |   |   ├── 24538-OG.rst
|   |   |   |   ├── 24577-AL.rst
|   |   |   |   ├── 24664-OG.rst
|   |   |   |   ├── 24688-OG.rst
|   |   |   |   ├── 24730-TH.rst
|   |   |   |   ├── 24806-KS.rst
|   |   |   |   ├── 24846-ES.rst
|   |   |   |   ├── 24864-AL.rst
|   |   |   |   ├── 24904-AL.rst
|   |   |   |   └── 24913-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 23683-AL.rst
|   |   |   |   ├── 24257-AL.rst
|   |   |   |   ├── 24710-AL.rst
|   |   |   |   ├── 24724-ES.rst
|   |   |   |   ├── 24887-OG.rst
|   |   |   |   └── 24919-KS.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 21661-TAC.rst
|   |   |       ├── 24125-OG.rst
|   |   |       ├── 24128-OG.rst
|   |   |       ├── 24129-OG.rst
|   |   |       ├── 24251-OG.rst
|   |   |       ├── 24253-OG.rst
|   |   |       ├── 24254-OG.rst
|   |   |       ├── 24257-AL.rst
|   |   |       ├── 24355-OG.rst
|   |   |       ├── 24356-OG.rst
|   |   |       ├── 24624-AL.rst
|   |   |       ├── 24923-ES.rst
|   |   |       ├── 24948-ES.rst
|   |   |       ├── 24965-ES.rst
|   |   |       └── 24XXX-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.6.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── 3d_pane_color_rcparams.rst
|       |   ├── 3d_plot_aspects_adjustable_keyword.rst
|       |   ├── 3d_plot_pan_zoom.rst
|       |   ├── README.rst
|       |   ├── bar_label_formatting.rst
|       |   ├── colorbar_has_location_argument.rst
|       |   ├── documentation.rst
|       |   ├── ellipse_annotation.rst
|       |   ├── figure_hooks.rst
|       |   ├── imshow_extent_units.rst
|       |   ├── legend-figure-outside.rst
|       |   ├── per_subplot_mosaic.rst
|       |   ├── pie_hatch.rst
|       |   ├── polar_errorbar_caps.rst
|       |   ├── reverse_legend.rst
|       |   ├── rgba_pcolormesh.rst
|       |   ├── shade_poly3dcollection.rst
|       |   ├── show_source_links_directive_option.rst
|       |   ├── styles_from_packages.rst
|       |   ├── view_current_axis_format.rst
|       |   └── widget_blitting.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   └── whats_new_3.6.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── examples
|   ├── README.txt
|   ├── animation
|   |   ├── README.txt
|   |   ├── animate_decay.py
|   |   ├── animated_histogram.py
|   |   ├── animation_demo.py
|   |   ├── bayes_update.py
|   |   ├── double_pendulum.py
|   |   ├── dynamic_image.py
|   |   ├── frame_grabbing_sgskip.py
|   |   ├── multiple_axes.py
|   |   ├── pause_resume.py
|   |   ├── rain.py
|   |   ├── random_walk.py
|   |   ├── simple_anim.py
|   |   ├── simple_scatter.py
|   |   ├── strip_chart.py
|   |   └── unchained.py
|   ├── axes_grid1
|   |   ├── README.txt
|   |   ├── demo_anchored_direction_arrows.py
|   |   ├── demo_axes_divider.py
|   |   ├── demo_axes_grid.py
|   |   ├── demo_axes_grid2.py
|   |   ├── demo_axes_hbox_divider.py
|   |   ├── demo_axes_rgb.py
|   |   ├── demo_colorbar_of_inset_axes.py
|   |   ├── demo_colorbar_with_axes_divider.py
|   |   ├── demo_colorbar_with_inset_locator.py
|   |   ├── demo_edge_colorbar.py
|   |   ├── demo_fixed_size_axes.py
|   |   ├── demo_imagegrid_aspect.py
|   |   ├── inset_locator_demo.py
|   |   ├── inset_locator_demo2.py
|   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   ├── parasite_simple.py
|   |   ├── parasite_simple2.py
|   |   ├── scatter_hist_locatable_axes.py
|   |   ├── simple_anchored_artists.py
|   |   ├── simple_axes_divider1.py
|   |   ├── simple_axes_divider3.py
|   |   ├── simple_axesgrid.py
|   |   ├── simple_axesgrid2.py
|   |   ├── simple_axisline4.py
|   |   └── simple_colorbar.py
|   ├── axisartist
|   |   ├── README.txt
|   |   ├── axis_direction.py
|   |   ├── demo_axis_direction.py
|   |   ├── demo_axisline_style.py
|   |   ├── demo_curvelinear_grid.py
|   |   ├── demo_curvelinear_grid2.py
|   |   ├── demo_floating_axes.py
|   |   ├── demo_floating_axis.py
|   |   ├── demo_parasite_axes.py
|   |   ├── demo_parasite_axes2.py
|   |   ├── demo_ticklabel_alignment.py
|   |   ├── demo_ticklabel_direction.py
|   |   ├── simple_axis_direction01.py
|   |   ├── simple_axis_direction03.py
|   |   ├── simple_axis_pad.py
|   |   ├── simple_axisartist1.py
|   |   ├── simple_axisline.py
|   |   └── simple_axisline3.py
|   ├── color
|   |   ├── README.txt
|   |   ├── color_by_yvalue.py
|   |   ├── color_cycle_default.py
|   |   ├── color_demo.py
|   |   ├── colorbar_basics.py
|   |   ├── colormap_reference.py
|   |   ├── custom_cmap.py
|   |   └── named_colors.py
|   ├── event_handling
|   |   ├── README.txt
|   |   ├── close_event.py
|   |   ├── coords_demo.py
|   |   ├── cursor_demo.py
|   |   ├── data_browser.py
|   |   ├── figure_axes_enter_leave.py
|   |   ├── ginput_manual_clabel_sgskip.py
|   |   ├── image_slices_viewer.py
|   |   ├── keypress_demo.py
|   |   ├── lasso_demo.py
|   |   ├── legend_picking.py
|   |   ├── looking_glass.py
|   |   ├── path_editor.py
|   |   ├── pick_event_demo.py
|   |   ├── pick_event_demo2.py
|   |   ├── poly_editor.py
|   |   ├── pong_sgskip.py
|   |   ├── resample.py
|   |   ├── timers.py
|   |   ├── trifinder_event_demo.py
|   |   ├── viewlims.py
|   |   └── zoom_window.py
|   ├── images_contours_and_fields
|   |   ├── README.txt
|   |   ├── affine_image.py
|   |   ├── barb_demo.py
|   |   ├── barcode_demo.py
|   |   ├── colormap_interactive_adjustment.py
|   |   ├── colormap_normalizations.py
|   |   ├── colormap_normalizations_symlognorm.py
|   |   ├── contour_corner_mask.py
|   |   ├── contour_demo.py
|   |   ├── contour_image.py
|   |   ├── contour_label_demo.py
|   |   ├── contourf_demo.py
|   |   ├── contourf_hatching.py
|   |   ├── contourf_log.py
|   |   ├── contours_in_optimization_demo.py
|   |   ├── demo_bboximage.py
|   |   ├── figimage_demo.py
|   |   ├── image_annotated_heatmap.py
|   |   ├── image_antialiasing.py
|   |   ├── image_clip_path.py
|   |   ├── image_demo.py
|   |   ├── image_masked.py
|   |   ├── image_nonuniform.py
|   |   ├── image_transparency_blend.py
|   |   ├── image_zcoord.py
|   |   ├── interpolation_methods.py
|   |   ├── irregulardatagrid.py
|   |   ├── layer_images.py
|   |   ├── matshow.py
|   |   ├── multi_image.py
|   |   ├── pcolor_demo.py
|   |   ├── pcolormesh_grids.py
|   |   ├── pcolormesh_levels.py
|   |   ├── plot_streamplot.py
|   |   ├── quadmesh_demo.py
|   |   ├── quiver_demo.py
|   |   ├── quiver_simple_demo.py
|   |   ├── shading_example.py
|   |   ├── specgram_demo.py
|   |   ├── spy_demos.py
|   |   ├── tricontour_demo.py
|   |   ├── tricontour_smooth_delaunay.py
|   |   ├── tricontour_smooth_user.py
|   |   ├── trigradient_demo.py
|   |   ├── triinterp_demo.py
|   |   ├── tripcolor_demo.py
|   |   ├── triplot_demo.py
|   |   └── watermark_image.py
|   ├── lines_bars_and_markers
|   |   ├── README.txt
|   |   ├── bar_colors.py
|   |   ├── bar_label_demo.py
|   |   ├── bar_stacked.py
|   |   ├── barchart.py
|   |   ├── barh.py
|   |   ├── broken_barh.py
|   |   ├── capstyle.py
|   |   ├── categorical_variables.py
|   |   ├── cohere.py
|   |   ├── csd_demo.py
|   |   ├── curve_error_band.py
|   |   ├── errorbar_limits_simple.py
|   |   ├── errorbar_subsample.py
|   |   ├── eventcollection_demo.py
|   |   ├── eventplot_demo.py
|   |   ├── fill.py
|   |   ├── fill_between_alpha.py
|   |   ├── fill_between_demo.py
|   |   ├── fill_betweenx_demo.py
|   |   ├── filled_step.py
|   |   ├── gradient_bar.py
|   |   ├── hat_graph.py
|   |   ├── horizontal_barchart_distribution.py
|   |   ├── joinstyle.py
|   |   ├── line_demo_dash_control.py
|   |   ├── lines_with_ticks_demo.py
|   |   ├── linestyles.py
|   |   ├── marker_reference.py
|   |   ├── markevery_demo.py
|   |   ├── masked_demo.py
|   |   ├── multicolored_line.py
|   |   ├── multivariate_marker_plot.py
|   |   ├── psd_demo.py
|   |   ├── scatter_custom_symbol.py
|   |   ├── scatter_demo2.py
|   |   ├── scatter_hist.py
|   |   ├── scatter_masked.py
|   |   ├── scatter_star_poly.py
|   |   ├── scatter_with_legend.py
|   |   ├── simple_plot.py
|   |   ├── span_regions.py
|   |   ├── spectrum_demo.py
|   |   ├── stackplot_demo.py
|   |   ├── stairs_demo.py
|   |   ├── stem_plot.py
|   |   ├── step_demo.py
|   |   ├── timeline.py
|   |   ├── vline_hline_demo.py
|   |   └── xcorr_acorr_demo.py
|   ├── misc
|   |   ├── README.txt
|   |   ├── anchored_artists.py
|   |   ├── bbox_intersect.py
|   |   ├── contour_manual.py
|   |   ├── coords_report.py
|   |   ├── custom_projection.py
|   |   ├── customize_rc.py
|   |   ├── demo_agg_filter.py
|   |   ├── demo_ribbon_box.py
|   |   ├── fig_x.py
|   |   ├── fill_spiral.py
|   |   ├── findobj_demo.py
|   |   ├── font_indexing.py
|   |   ├── ftface_props.py
|   |   ├── histogram_path.py
|   |   ├── hyperlinks_sgskip.py
|   |   ├── image_thumbnail_sgskip.py
|   |   ├── keyword_plotting.py
|   |   ├── logos2.py
|   |   ├── multipage_pdf.py
|   |   ├── multiprocess_sgskip.py
|   |   ├── packed_bubbles.py
|   |   ├── patheffect_demo.py
|   |   ├── print_stdout_sgskip.py
|   |   ├── rasterization_demo.py
|   |   ├── set_and_get.py
|   |   ├── svg_filter_line.py
|   |   ├── svg_filter_pie.py
|   |   ├── table_demo.py
|   |   ├── tickedstroke_demo.py
|   |   ├── transoffset.py
|   |   └── zorder_demo.py
|   ├── mplot3d
|   |   ├── 2dcollections3d.py
|   |   ├── 3d_bars.py
|   |   ├── README.txt
|   |   ├── bars3d.py
|   |   ├── box3d.py
|   |   ├── contour3d.py
|   |   ├── contour3d_2.py
|   |   ├── contour3d_3.py
|   |   ├── contourf3d.py
|   |   ├── contourf3d_2.py
|   |   ├── custom_shaded_3d_surface.py
|   |   ├── errorbar3d.py
|   |   ├── hist3d.py
|   |   ├── lines3d.py
|   |   ├── lorenz_attractor.py
|   |   ├── mixed_subplots.py
|   |   ├── offset.py
|   |   ├── pathpatch3d.py
|   |   ├── polys3d.py
|   |   ├── projections.py
|   |   ├── quiver3d.py
|   |   ├── rotate_axes3d_sgskip.py
|   |   ├── scatter3d.py
|   |   ├── stem3d_demo.py
|   |   ├── subplot3d.py
|   |   ├── surface3d.py
|   |   ├── surface3d_2.py
|   |   ├── surface3d_3.py
|   |   ├── surface3d_radial.py
|   |   ├── text3d.py
|   |   ├── tricontour3d.py
|   |   ├── tricontourf3d.py
|   |   ├── trisurf3d.py
|   |   ├── trisurf3d_2.py
|   |   ├── view_planes_3d.py
|   |   ├── voxels.py
|   |   ├── voxels_numpy_logo.py
|   |   ├── voxels_rgb.py
|   |   ├── voxels_torus.py
|   |   ├── wire3d.py
|   |   ├── wire3d_animation_sgskip.py
|   |   └── wire3d_zero_stride.py
|   ├── pie_and_polar_charts
|   |   ├── README.txt
|   |   ├── bar_of_pie.py
|   |   ├── nested_pie.py
|   |   ├── pie_and_donut_labels.py
|   |   ├── pie_demo2.py
|   |   ├── pie_features.py
|   |   ├── polar_bar.py
|   |   ├── polar_demo.py
|   |   ├── polar_error_caps.py
|   |   ├── polar_legend.py
|   |   └── polar_scatter.py
|   ├── pyplots
|   |   ├── README.txt
|   |   ├── axline.py
|   |   ├── pyplot_mathtext.py
|   |   ├── pyplot_simple.py
|   |   ├── pyplot_text.py
|   |   ├── pyplot_three.py
|   |   └── pyplot_two_subplots.py
|   ├── scales
|   |   ├── README.txt
|   |   ├── asinh_demo.py
|   |   ├── aspect_loglog.py
|   |   ├── custom_scale.py
|   |   ├── log_bar.py
|   |   ├── log_demo.py
|   |   ├── logit_demo.py
|   |   ├── power_norm.py
|   |   ├── scales.py
|   |   ├── semilogx_demo.py
|   |   └── symlog_demo.py
|   ├── shapes_and_collections
|   |   ├── README.txt
|   |   ├── arrow_guide.py
|   |   ├── artist_reference.py
|   |   ├── collections.py
|   |   ├── compound_path.py
|   |   ├── dolphin.py
|   |   ├── donut.py
|   |   ├── ellipse_collection.py
|   |   ├── ellipse_demo.py
|   |   ├── fancybox_demo.py
|   |   ├── hatch_demo.py
|   |   ├── hatch_style_reference.py
|   |   ├── line_collection.py
|   |   ├── patch_collection.py
|   |   ├── path_patch.py
|   |   ├── quad_bezier.py
|   |   └── scatter.py
|   ├── showcase
|   |   ├── README.txt
|   |   ├── anatomy.py
|   |   ├── firefox.py
|   |   ├── integral.py
|   |   ├── mandelbrot.py
|   |   ├── stock_prices.py
|   |   └── xkcd.py
|   ├── specialty_plots
|   |   ├── README.txt
|   |   ├── advanced_hillshading.py
|   |   ├── anscombe.py
|   |   ├── hinton_demo.py
|   |   ├── leftventricle_bullseye.py
|   |   ├── mri_demo.py
|   |   ├── mri_with_eeg.py
|   |   ├── radar_chart.py
|   |   ├── sankey_basics.py
|   |   ├── sankey_links.py
|   |   ├── sankey_rankine.py
|   |   ├── skewt.py
|   |   └── topographic_hillshading.py
|   ├── spines
|   |   ├── README.txt
|   |   ├── centered_spines_with_arrows.py
|   |   ├── multiple_yaxis_with_spines.py
|   |   ├── spine_placement_demo.py
|   |   ├── spines.py
|   |   └── spines_dropped.py
|   ├── statistics
|   |   ├── README.txt
|   |   ├── barchart_demo.py
|   |   ├── boxplot.py
|   |   ├── boxplot_color.py
|   |   ├── boxplot_demo.py
|   |   ├── boxplot_vs_violin.py
|   |   ├── bxp.py
|   |   ├── confidence_ellipse.py
|   |   ├── customized_violin.py
|   |   ├── errorbar.py
|   |   ├── errorbar_features.py
|   |   ├── errorbar_limits.py
|   |   ├── errorbars_and_boxes.py
|   |   ├── hexbin_demo.py
|   |   ├── hist.py
|   |   ├── histogram_cumulative.py
|   |   ├── histogram_features.py
|   |   ├── histogram_histtypes.py
|   |   ├── histogram_multihist.py
|   |   ├── multiple_histograms_side_by_side.py
|   |   ├── time_series_histogram.py
|   |   └── violinplot.py
|   ├── style_sheets
|   |   ├── README.txt
|   |   ├── bmh.py
|   |   ├── dark_background.py
|   |   ├── fivethirtyeight.py
|   |   ├── ggplot.py
|   |   ├── grayscale.py
|   |   ├── plot_solarizedlight2.py
|   |   └── style_sheets_reference.py
|   ├── subplots_axes_and_figures
|   |   ├── README.txt
|   |   ├── align_labels_demo.py
|   |   ├── auto_subplots_adjust.py
|   |   ├── axes_box_aspect.py
|   |   ├── axes_demo.py
|   |   ├── axes_margins.py
|   |   ├── axes_props.py
|   |   ├── axes_zoom_effect.py
|   |   ├── axhspan_demo.py
|   |   ├── axis_equal_demo.py
|   |   ├── axis_labels_demo.py
|   |   ├── broken_axis.py
|   |   ├── colorbar_placement.py
|   |   ├── custom_figure_class.py
|   |   ├── demo_constrained_layout.py
|   |   ├── demo_tight_layout.py
|   |   ├── fahrenheit_celsius_scales.py
|   |   ├── figure_size_units.py
|   |   ├── figure_title.py
|   |   ├── ganged_plots.py
|   |   ├── geo_demo.py
|   |   ├── gridspec_and_subplots.py
|   |   ├── gridspec_multicolumn.py
|   |   ├── gridspec_nested.py
|   |   ├── invert_axes.py
|   |   ├── mosaic.py
|   |   ├── multiple_figs_demo.py
|   |   ├── secondary_axis.py
|   |   ├── share_axis_lims_views.py
|   |   ├── shared_axis_demo.py
|   |   ├── subfigures.py
|   |   ├── subplot.py
|   |   ├── subplots_adjust.py
|   |   ├── subplots_demo.py
|   |   ├── two_scales.py
|   |   └── zoom_inset_axes.py
|   ├── text_labels_and_annotations
|   |   ├── README.txt
|   |   ├── accented_text.py
|   |   ├── align_ylabels.py
|   |   ├── angle_annotation.py
|   |   ├── angles_on_bracket_arrows.py
|   |   ├── annotate_transform.py
|   |   ├── annotation_basic.py
|   |   ├── annotation_demo.py
|   |   ├── annotation_polar.py
|   |   ├── arrow_demo.py
|   |   ├── autowrap.py
|   |   ├── custom_legends.py
|   |   ├── date.py
|   |   ├── demo_annotation_box.py
|   |   ├── demo_text_path.py
|   |   ├── demo_text_rotation_mode.py
|   |   ├── dfrac_demo.py
|   |   ├── engineering_formatter.py
|   |   ├── fancyarrow_demo.py
|   |   ├── fancytextbox_demo.py
|   |   ├── figlegend_demo.py
|   |   ├── font_family_rc.py
|   |   ├── font_file.py
|   |   ├── font_table.py
|   |   ├── fonts_demo.py
|   |   ├── fonts_demo_kw.py
|   |   ├── label_subplots.py
|   |   ├── legend.py
|   |   ├── legend_demo.py
|   |   ├── line_with_text.py
|   |   ├── mathtext_asarray.py
|   |   ├── mathtext_demo.py
|   |   ├── mathtext_examples.py
|   |   ├── mathtext_fontfamily_example.py
|   |   ├── multiline.py
|   |   ├── placing_text_boxes.py
|   |   ├── rainbow_text.py
|   |   ├── stix_fonts_demo.py
|   |   ├── tex_demo.py
|   |   ├── text_alignment.py
|   |   ├── text_commands.py
|   |   ├── text_fontdict.py
|   |   ├── text_rotation_relative_to_line.py
|   |   ├── titles_demo.py
|   |   ├── unicode_minus.py
|   |   ├── usetex_baseline_test.py
|   |   ├── usetex_fonteffects.py
|   |   └── watermark_text.py
|   ├── ticks
|   |   ├── README.txt
|   |   ├── auto_ticks.py
|   |   ├── centered_ticklabels.py
|   |   ├── colorbar_tick_labelling_demo.py
|   |   ├── custom_ticker1.py
|   |   ├── date_concise_formatter.py
|   |   ├── date_demo_convert.py
|   |   ├── date_demo_rrule.py
|   |   ├── date_formatters_locators.py
|   |   ├── date_index_formatter.py
|   |   ├── date_precision_and_epochs.py
|   |   ├── dollar_ticks.py
|   |   ├── fig_axes_customize_simple.py
|   |   ├── major_minor_demo.py
|   |   ├── scalarformatter.py
|   |   ├── tick-formatters.py
|   |   ├── tick-locators.py
|   |   ├── tick_label_right.py
|   |   ├── tick_labels_from_values.py
|   |   ├── tick_xlabel_top.py
|   |   ├── ticklabels_rotation.py
|   |   └── ticks_too_many.py
|   ├── units
|   |   ├── README.txt
|   |   ├── annotate_with_units.py
|   |   ├── artist_tests.py
|   |   ├── bar_demo2.py
|   |   ├── bar_unit_demo.py
|   |   ├── basic_units.py
|   |   ├── ellipse_with_units.py
|   |   ├── evans_test.py
|   |   ├── radian_demo.py
|   |   ├── units_sample.py
|   |   └── units_scatter.py
|   ├── user_interfaces
|   |   ├── README.txt
|   |   ├── canvasagg.py
|   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   ├── embedding_in_gtk3_sgskip.py
|   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   ├── embedding_in_gtk4_sgskip.py
|   |   ├── embedding_in_qt_sgskip.py
|   |   ├── embedding_in_tk_sgskip.py
|   |   ├── embedding_in_wx2_sgskip.py
|   |   ├── embedding_in_wx3_sgskip.py
|   |   ├── embedding_in_wx4_sgskip.py
|   |   ├── embedding_in_wx5_sgskip.py
|   |   ├── embedding_webagg_sgskip.py
|   |   ├── fourier_demo_wx_sgskip.py
|   |   ├── gtk3_spreadsheet_sgskip.py
|   |   ├── gtk4_spreadsheet_sgskip.py
|   |   ├── images
|   |   ├── mathtext_wx_sgskip.py
|   |   ├── mpl_with_glade3_sgskip.py
|   |   ├── mplcvd.py
|   |   ├── pylab_with_gtk3_sgskip.py
|   |   ├── pylab_with_gtk4_sgskip.py
|   |   ├── svg_histogram_sgskip.py
|   |   ├── svg_tooltip_sgskip.py
|   |   ├── toolmanager_sgskip.py
|   |   ├── web_application_server_sgskip.py
|   |   └── wxcursor_demo_sgskip.py
|   ├── userdemo
|   |   ├── README.txt
|   |   ├── anchored_box04.py
|   |   ├── annotate_explain.py
|   |   ├── annotate_simple01.py
|   |   ├── annotate_simple02.py
|   |   ├── annotate_simple03.py
|   |   ├── annotate_simple04.py
|   |   ├── annotate_simple_coord01.py
|   |   ├── annotate_simple_coord02.py
|   |   ├── annotate_simple_coord03.py
|   |   ├── annotate_text_arrow.py
|   |   ├── connect_simple01.py
|   |   ├── connectionstyle_demo.py
|   |   ├── custom_boxstyle01.py
|   |   ├── demo_gridspec01.py
|   |   ├── demo_gridspec03.py
|   |   ├── demo_gridspec06.py
|   |   ├── pgf_fonts.py
|   |   ├── pgf_preamble_sgskip.py
|   |   ├── pgf_texsystem.py
|   |   ├── simple_annotate01.py
|   |   ├── simple_legend01.py
|   |   └── simple_legend02.py
|   └── widgets
|       ├── README.txt
|       ├── annotated_cursor.py
|       ├── buttons.py
|       ├── check_buttons.py
|       ├── cursor.py
|       ├── lasso_selector_demo_sgskip.py
|       ├── menu.py
|       ├── mouse_cursor.py
|       ├── multicursor.py
|       ├── polygon_selector_demo.py
|       ├── polygon_selector_simple.py
|       ├── radio_buttons.py
|       ├── range_slider.py
|       ├── rectangle_selector.py
|       ├── slider_demo.py
|       ├── slider_snap_demo.py
|       ├── span_selector.py
|       └── textbox.py
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── all_figures.html
|   |   |       ├── css
|   |   |       ├── ipython_inline_figure.html
|   |   |       ├── js
|   |   |       └── single_figure.html
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   |   └── plot_directive.css
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── plot_types
|   ├── 3D
|   |   ├── README.rst
|   |   ├── scatter3d_simple.py
|   |   ├── surface3d_simple.py
|   |   ├── trisurf3d_simple.py
|   |   ├── voxels_simple.py
|   |   └── wire3d_simple.py
|   ├── README.rst
|   ├── arrays
|   |   ├── README.rst
|   |   ├── barbs.py
|   |   ├── contour.py
|   |   ├── contourf.py
|   |   ├── imshow.py
|   |   ├── pcolormesh.py
|   |   ├── quiver.py
|   |   └── streamplot.py
|   ├── basic
|   |   ├── README.rst
|   |   ├── bar.py
|   |   ├── fill_between.py
|   |   ├── plot.py
|   |   ├── scatter_plot.py
|   |   ├── stackplot.py
|   |   ├── stem.py
|   |   └── step.py
|   ├── stats
|   |   ├── README.rst
|   |   ├── boxplot_plot.py
|   |   ├── errorbar_plot.py
|   |   ├── eventplot.py
|   |   ├── hexbin.py
|   |   ├── hist2d.py
|   |   ├── hist_plot.py
|   |   ├── pie.py
|   |   └── violin.py
|   └── unstructured
|       ├── README.rst
|       ├── tricontour.py
|       ├── tricontourf.py
|       ├── tripcolor.py
|       └── triplot.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
├── tests.py
├── tools
|   ├── README.txt
|   ├── boilerplate.py
|   ├── cache_zenodo_svg.py
|   ├── create_DejaVuDisplay.sh
|   ├── embed_js.py
|   ├── gh_api.py
|   ├── github_stats.py
|   ├── make_icons.py
|   ├── memleak.py
|   ├── run_examples.py
|   ├── subset.py
|   ├── triage_tests.py
|   └── visualize_tests.py
└── tutorials
    ├── README.txt
    ├── advanced
    |   ├── README.txt
    |   ├── blitting.py
    |   ├── path_tutorial.py
    |   ├── patheffects_guide.py
    |   └── transforms_tutorial.py
    ├── colors
    |   ├── README.txt
    |   ├── colorbar_only.py
    |   ├── colormap-manipulation.py
    |   ├── colormapnorms.py
    |   ├── colormaps.py
    |   └── colors.py
    ├── intermediate
    |   ├── README.txt
    |   ├── arranging_axes.py
    |   ├── artists.py
    |   ├── autoscale.py
    |   ├── color_cycle.py
    |   ├── constrainedlayout_guide.py
    |   ├── imshow_extent.py
    |   ├── legend_guide.py
    |   └── tight_layout_guide.py
    ├── introductory
    |   ├── README.txt
    |   ├── animation_tutorial.py
    |   ├── customizing.py
    |   ├── images.py
    |   ├── lifecycle.py
    |   ├── pyplot.py
    |   └── quick_start.py
    ├── provisional
    |   └── README.txt
    ├── text
    |   ├── README.txt
    |   ├── annotations.py
    |   ├── mathtext.py
    |   ├── pgf.py
    |   ├── text_intro.py
    |   ├── text_props.py
    |   └── usetex.py
    └── toolkits
        ├── README.txt
        ├── axes_grid.py
        ├── axisartist.py
        └── mplot3d.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---

Issue: [Bug]: NumPy 1.24 deprecation warnings

Description: ### Bug summary

Starting NumPy 1.24 I observe several deprecation warnings.


### Code for reproduction

```python
import matplotlib.pyplot as plt
import numpy as np

plt.get_cmap()(np.empty((0, ), dtype=np.uint8))
```


### Actual outcome

```
/usr/lib/python3.10/site-packages/matplotlib/colors.py:730: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 257 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[xa > self.N - 1] = self._i_over
/usr/lib/python3.10/site-packages/matplotlib/colors.py:731: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 256 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[xa < 0] = self._i_under
/usr/lib/python3.10/site-packages/matplotlib/colors.py:732: DeprecationWarning: NumPy will stop allowing conversion of out-of-bound Python integers to integer arrays.  The conversion of 258 to uint8 will fail in the future.
For the old behavior, usually:
    np.array(value).astype(dtype)`
will give the desired result (the cast overflows).
  xa[mask_bad] = self._i_bad
```

### Expected outcome

No warnings.

### Additional information

_No response_

### Operating system

ArchLinux

### Matplotlib Version

3.6.2

### Matplotlib Backend

QtAgg

### Python version

Python 3.10.9

### Jupyter version

_No response_

### Installation

Linux package manager

Patch information:
diff --git a/lib/matplotlib/colors.py b/lib/matplotlib/colors.py
index 2d3072da04..2d1196ab24 100644
--- a/lib/matplotlib/colors.py
+++ b/lib/matplotlib/colors.py
@@ -711,7 +711,11 @@ class Colormap:
         mask_bad = X.mask if np.ma.is_masked(X) else None
         xa = np.array(X, copy=True)
         if mask_bad is None:
-            mask_bad = np.isnan(xa)
+            if xa.dtype.kind == "f":
+                mask_bad = np.isnan(xa)
+            else:
+                # Integer and other non-floating dtypes cannot represent NaN.
+                mask_bad = np.zeros_like(xa, dtype=bool)
         if not xa.dtype.isnative:
             xa = xa.byteswap().newbyteorder()  # Native byteorder is faster.
         if xa.dtype.kind == "f":
@@ -725,6 +729,10 @@ class Colormap:
                 # Avoid converting large positive values to negative integers.
                 np.clip(xa, -1, self.N, out=xa)
                 xa = xa.astype(int)
+        elif xa.dtype.kind in "ui":
+            # Upcast integer arrays to a signed integer dtype that can
+            # represent sentinel indices (N, N+1, N+2) without overflow.
+            xa = xa.astype(np.intp, copy=False)
         # Set the over-range indices before the under-range;
         # otherwise the under-range values get converted to over-range.
         xa[xa > self.N - 1] = self._i_over


OBJECTIVE: Find 3 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 3 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 3 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

These are the previously asked refined queries:
--- BEGIN PREVIOUS QUERY ---
Previous refined query 1:
Essential Query: Please provide the full content of lib/matplotlib/tests/test_colors.py
Extra Requirements: 
Purpose: I need the content of this test file to find existing test cases that are relevant to the bug report concerning `Colormap` and NumPy deprecation warnings.
--- END PREVIOUS QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_colors.py
Line number range: 1 - 1001
Content:
1. import copy
2. import itertools
3. import unittest.mock
4. 
5. from io import BytesIO
6. import numpy as np
7. from PIL import Image
8. import pytest
9. import base64
10. 
11. from numpy.testing import assert_array_equal, assert_array_almost_equal
12. 
13. from matplotlib import cbook, cm, cycler
14. import matplotlib
15. import matplotlib as mpl
16. import matplotlib.colors as mcolors
17. import matplotlib.colorbar as mcolorbar
18. import matplotlib.pyplot as plt
19. import matplotlib.scale as mscale
20. from matplotlib.testing.decorators import image_comparison, check_figures_equal
21. 
22. 
23. @pytest.mark.parametrize('N, result', [
24.     (5, [1, .6, .2, .1, 0]),
25.     (2, [1, 0]),
26.     (1, [0]),
27. ])
28. def test_create_lookup_table(N, result):
29.     data = [(0.0, 1.0, 1.0), (0.5, 0.2, 0.2), (1.0, 0.0, 0.0)]
30.     assert_array_almost_equal(mcolors._create_lookup_table(N, data), result)
31. 
32. 
33. def test_resampled():
34.     """
35.     GitHub issue #6025 pointed to incorrect ListedColormap.resampled;
36.     here we test the method for LinearSegmentedColormap as well.
37.     """
38.     n = 101
39.     colorlist = np.empty((n, 4), float)
40.     colorlist[:, 0] = np.linspace(0, 1, n)
41.     colorlist[:, 1] = 0.2
42.     colorlist[:, 2] = np.linspace(1, 0, n)
43.     colorlist[:, 3] = 0.7
44.     lsc = mcolors.LinearSegmentedColormap.from_list('lsc', colorlist)
45.     lc = mcolors.ListedColormap(colorlist)
46.     # Set some bad values for testing too
47.     for cmap in [lsc, lc]:
48.         cmap.set_under('r')
49.         cmap.set_over('g')
50.         cmap.set_bad('b')
51.     lsc3 = lsc.resampled(3)
52.     lc3 = lc.resampled(3)
53.     expected = np.array([[0.0, 0.2, 1.0, 0.7],
54.                          [0.5, 0.2, 0.5, 0.7],
55.                          [1.0, 0.2, 0.0, 0.7]], float)
56.     assert_array_almost_equal(lsc3([0, 0.5, 1]), expected)
57.     assert_array_almost_equal(lc3([0, 0.5, 1]), expected)
58.     # Test over/under was copied properly
59.     assert_array_almost_equal(lsc(np.inf), lsc3(np.inf))
60.     assert_array_almost_equal(lsc(-np.inf), lsc3(-np.inf))
61.     assert_array_almost_equal(lsc(np.nan), lsc3(np.nan))
62.     assert_array_almost_equal(lc(np.inf), lc3(np.inf))
63.     assert_array_almost_equal(lc(-np.inf), lc3(-np.inf))
64.     assert_array_almost_equal(lc(np.nan), lc3(np.nan))
65. 
66. 
67. def test_register_cmap():
68.     new_cm = mpl.colormaps["viridis"]
69.     target = "viridis2"
70.     with pytest.warns(
71.             mpl.MatplotlibDeprecationWarning,
72.             match=r"matplotlib\.colormaps\.register\(name\)"
73.     ):
74.         cm.register_cmap(target, new_cm)
75.     assert mpl.colormaps[target] == new_cm
76. 
77.     with pytest.raises(ValueError,
78.                        match="Arguments must include a name or a Colormap"):
79.         with pytest.warns(
80.             mpl.MatplotlibDeprecationWarning,
81.             match=r"matplotlib\.colormaps\.register\(name\)"
82.         ):
83.             cm.register_cmap()
84. 
85.     with pytest.warns(
86.             mpl.MatplotlibDeprecationWarning,
87.             match=r"matplotlib\.colormaps\.unregister\(name\)"
88.     ):
89.         cm.unregister_cmap(target)
90.     with pytest.raises(ValueError,
91.                        match=f'{target!r} is not a valid value for name;'):
92.         with pytest.warns(
93.                 mpl.MatplotlibDeprecationWarning,
94.                 match=r"matplotlib\.colormaps\[name\]"
95.         ):
96.             cm.get_cmap(target)
97.     with pytest.warns(
98.             mpl.MatplotlibDeprecationWarning,
99.             match=r"matplotlib\.colormaps\.unregister\(name\)"
100.     ):
101.         # test that second time is error free
102.         cm.unregister_cmap(target)
103. 
104.     with pytest.raises(TypeError, match="'cmap' must be"):
105.         with pytest.warns(
106.             mpl.MatplotlibDeprecationWarning,
107.             match=r"matplotlib\.colormaps\.register\(name\)"
108.         ):
109.             cm.register_cmap('nome', cmap='not a cmap')
110. 
111. 
112. def test_colormaps_get_cmap():
113.     cr = mpl.colormaps
114. 
115.     # check str, and Colormap pass
116.     assert cr.get_cmap('plasma') == cr["plasma"]
117.     assert cr.get_cmap(cr["magma"]) == cr["magma"]
118. 
119.     # check default
120.     assert cr.get_cmap(None) == cr[mpl.rcParams['image.cmap']]
121. 
122.     # check ValueError on bad name
123.     bad_cmap = 'AardvarksAreAwkward'
124.     with pytest.raises(ValueError, match=bad_cmap):
125.         cr.get_cmap(bad_cmap)
126. 
127.     # check TypeError on bad type
128.     with pytest.raises(TypeError, match='object'):
129.         cr.get_cmap(object())
130. 
131. 
132. def test_double_register_builtin_cmap():
133.     name = "viridis"
134.     match = f"Re-registering the builtin cmap {name!r}."
135.     with pytest.raises(ValueError, match=match):
136.         matplotlib.colormaps.register(
137.             mpl.colormaps[name], name=name, force=True
138.         )
139.     with pytest.raises(ValueError, match='A colormap named "viridis"'):
140.         with pytest.warns(mpl.MatplotlibDeprecationWarning):
141.             cm.register_cmap(name, mpl.colormaps[name])
142.     with pytest.warns(UserWarning):
143.         # TODO is warning more than once!
144.         cm.register_cmap(name, mpl.colormaps[name], override_builtin=True)
145. 
146. 
147. def test_unregister_builtin_cmap():
148.     name = "viridis"
149.     match = f'cannot unregister {name!r} which is a builtin colormap.'
150.     with pytest.raises(ValueError, match=match):
151.         with pytest.warns(mpl.MatplotlibDeprecationWarning):
152.             cm.unregister_cmap(name)
153. 
154. 
155. def test_colormap_copy():
156.     cmap = plt.cm.Reds
157.     copied_cmap = copy.copy(cmap)
158.     with np.errstate(invalid='ignore'):
159.         ret1 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
160.     cmap2 = copy.copy(copied_cmap)
161.     cmap2.set_bad('g')
162.     with np.errstate(invalid='ignore'):
163.         ret2 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
164.     assert_array_equal(ret1, ret2)
165.     # again with the .copy method:
166.     cmap = plt.cm.Reds
167.     copied_cmap = cmap.copy()
168.     with np.errstate(invalid='ignore'):
169.         ret1 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
170.     cmap2 = copy.copy(copied_cmap)
171.     cmap2.set_bad('g')
172.     with np.errstate(invalid='ignore'):
173.         ret2 = copied_cmap([-1, 0, .5, 1, np.nan, np.inf])
174.     assert_array_equal(ret1, ret2)
175. 
176. 
177. def test_colormap_equals():
178.     cmap = mpl.colormaps["plasma"]
179.     cm_copy = cmap.copy()
180.     # different object id's
181.     assert cm_copy is not cmap
182.     # But the same data should be equal
183.     assert cm_copy == cmap
184.     # Change the copy
185.     cm_copy.set_bad('y')
186.     assert cm_copy != cmap
187.     # Make sure we can compare different sizes without failure
188.     cm_copy._lut = cm_copy._lut[:10, :]
189.     assert cm_copy != cmap
190.     # Test different names are not equal
191.     cm_copy = cmap.copy()
192.     cm_copy.name = "Test"
193.     assert cm_copy != cmap
194.     # Test colorbar extends
195.     cm_copy = cmap.copy()
196.     cm_copy.colorbar_extend = not cmap.colorbar_extend
197.     assert cm_copy != cmap
198. 
199. 
200. def test_colormap_endian():
201.     """
202.     GitHub issue #1005: a bug in putmask caused erroneous
203.     mapping of 1.0 when input from a non-native-byteorder
204.     array.
205.     """
206.     cmap = mpl.colormaps["jet"]
207.     # Test under, over, and invalid along with values 0 and 1.
208.     a = [-0.5, 0, 0.5, 1, 1.5, np.nan]
209.     for dt in ["f2", "f4", "f8"]:
210.         anative = np.ma.masked_invalid(np.array(a, dtype=dt))
211.         aforeign = anative.byteswap().newbyteorder()
212.         assert_array_equal(cmap(anative), cmap(aforeign))
213. 
214. 
215. def test_colormap_invalid():
216.     """
217.     GitHub issue #9892: Handling of nan's were getting mapped to under
218.     rather than bad. This tests to make sure all invalid values
219.     (-inf, nan, inf) are mapped respectively to (under, bad, over).
220.     """
221.     cmap = mpl.colormaps["plasma"]
222.     x = np.array([-np.inf, -1, 0, np.nan, .7, 2, np.inf])
223. 
224.     expected = np.array([[0.050383, 0.029803, 0.527975, 1.],
225.                          [0.050383, 0.029803, 0.527975, 1.],
226.                          [0.050383, 0.029803, 0.527975, 1.],
227.                          [0.,       0.,       0.,       0.],
228.                          [0.949217, 0.517763, 0.295662, 1.],
229.                          [0.940015, 0.975158, 0.131326, 1.],
230.                          [0.940015, 0.975158, 0.131326, 1.]])
231.     assert_array_equal(cmap(x), expected)
232. 
233.     # Test masked representation (-inf, inf) are now masked
234.     expected = np.array([[0.,       0.,       0.,       0.],
235.                          [0.050383, 0.029803, 0.527975, 1.],
236.                          [0.050383, 0.029803, 0.527975, 1.],
237.                          [0.,       0.,       0.,       0.],
238.                          [0.949217, 0.517763, 0.295662, 1.],
239.                          [0.940015, 0.975158, 0.131326, 1.],
240.                          [0.,       0.,       0.,       0.]])
241.     assert_array_equal(cmap(np.ma.masked_invalid(x)), expected)
242. 
243.     # Test scalar representations
244.     assert_array_equal(cmap(-np.inf), cmap(0))
245.     assert_array_equal(cmap(np.inf), cmap(1.0))
246.     assert_array_equal(cmap(np.nan), [0., 0., 0., 0.])
247. 
248. 
249. def test_colormap_return_types():
250.     """
251.     Make sure that tuples are returned for scalar input and
252.     that the proper shapes are returned for ndarrays.
253.     """
254.     cmap = mpl.colormaps["plasma"]
255.     # Test return types and shapes
256.     # scalar input needs to return a tuple of length 4
257.     assert isinstance(cmap(0.5), tuple)
258.     assert len(cmap(0.5)) == 4
259. 
260.     # input array returns an ndarray of shape x.shape + (4,)
261.     x = np.ones(4)
262.     assert cmap(x).shape == x.shape + (4,)
263. 
264.     # multi-dimensional array input
265.     x2d = np.zeros((2, 2))
266.     assert cmap(x2d).shape == x2d.shape + (4,)
267. 
268. 
269. def test_BoundaryNorm():
270.     """
271.     GitHub issue #1258: interpolation was failing with numpy
272.     1.7 pre-release.
273.     """
274. 
275.     boundaries = [0, 1.1, 2.2]
276.     vals = [-1, 0, 1, 2, 2.2, 4]
277. 
278.     # Without interpolation
279.     expected = [-1, 0, 0, 1, 2, 2]
280.     ncolors = len(boundaries) - 1
281.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
282.     assert_array_equal(bn(vals), expected)
283. 
284.     # ncolors != len(boundaries) - 1 triggers interpolation
285.     expected = [-1, 0, 0, 2, 3, 3]
286.     ncolors = len(boundaries)
287.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
288.     assert_array_equal(bn(vals), expected)
289. 
290.     # with a single region and interpolation
291.     expected = [-1, 1, 1, 1, 3, 3]
292.     bn = mcolors.BoundaryNorm([0, 2.2], ncolors)
293.     assert_array_equal(bn(vals), expected)
294. 
295.     # more boundaries for a third color
296.     boundaries = [0, 1, 2, 3]
297.     vals = [-1, 0.1, 1.1, 2.2, 4]
298.     ncolors = 5
299.     expected = [-1, 0, 2, 4, 5]
300.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
301.     assert_array_equal(bn(vals), expected)
302. 
303.     # a scalar as input should not trigger an error and should return a scalar
304.     boundaries = [0, 1, 2]
305.     vals = [-1, 0.1, 1.1, 2.2]
306.     bn = mcolors.BoundaryNorm(boundaries, 2)
307.     expected = [-1, 0, 1, 2]
308.     for v, ex in zip(vals, expected):
309.         ret = bn(v)
310.         assert isinstance(ret, int)
311.         assert_array_equal(ret, ex)
312.         assert_array_equal(bn([v]), ex)
313. 
314.     # same with interp
315.     bn = mcolors.BoundaryNorm(boundaries, 3)
316.     expected = [-1, 0, 2, 3]
317.     for v, ex in zip(vals, expected):
318.         ret = bn(v)
319.         assert isinstance(ret, int)
320.         assert_array_equal(ret, ex)
321.         assert_array_equal(bn([v]), ex)
322. 
323.     # Clipping
324.     bn = mcolors.BoundaryNorm(boundaries, 3, clip=True)
325.     expected = [0, 0, 2, 2]
326.     for v, ex in zip(vals, expected):
327.         ret = bn(v)
328.         assert isinstance(ret, int)
329.         assert_array_equal(ret, ex)
330.         assert_array_equal(bn([v]), ex)
331. 
332.     # Masked arrays
333.     boundaries = [0, 1.1, 2.2]
334.     vals = np.ma.masked_invalid([-1., np.NaN, 0, 1.4, 9])
335. 
336.     # Without interpolation
337.     ncolors = len(boundaries) - 1
338.     bn = mcolors.BoundaryNorm(boundaries, ncolors)
339.     expected = np.ma.masked_array([-1, -99, 0, 1, 2], mask=[0, 1, 0, 0, 0])
340.     assert_array_equal(bn(vals), expected)
341. 
342.     # With interpolation
343.     bn = mcolors.BoundaryNorm(boundaries, len(boundaries))
344.     expected = np.ma.masked_array([-1, -99, 0, 2, 3], mask=[0, 1, 0, 0, 0])
345.     assert_array_equal(bn(vals), expected)
346. 
347.     # Non-trivial masked arrays
348.     vals = np.ma.masked_invalid([np.Inf, np.NaN])
349.     assert np.all(bn(vals).mask)
350.     vals = np.ma.masked_invalid([np.Inf])
351.     assert np.all(bn(vals).mask)
352. 
353.     # Incompatible extend and clip
354.     with pytest.raises(ValueError, match="not compatible"):
355.         mcolors.BoundaryNorm(np.arange(4), 5, extend='both', clip=True)
356. 
357.     # Too small ncolors argument
358.     with pytest.raises(ValueError, match="ncolors must equal or exceed"):
359.         mcolors.BoundaryNorm(np.arange(4), 2)
360. 
361.     with pytest.raises(ValueError, match="ncolors must equal or exceed"):
362.         mcolors.BoundaryNorm(np.arange(4), 3, extend='min')
363. 
364.     with pytest.raises(ValueError, match="ncolors must equal or exceed"):
365.         mcolors.BoundaryNorm(np.arange(4), 4, extend='both')
366. 
367.     # Testing extend keyword, with interpolation (large cmap)
368.     bounds = [1, 2, 3]
369.     cmap = mpl.colormaps['viridis']
370.     mynorm = mcolors.BoundaryNorm(bounds, cmap.N, extend='both')
371.     refnorm = mcolors.BoundaryNorm([0] + bounds + [4], cmap.N)
372.     x = np.random.randn(100) * 10 + 2
373.     ref = refnorm(x)
374.     ref[ref == 0] = -1
375.     ref[ref == cmap.N - 1] = cmap.N
376.     assert_array_equal(mynorm(x), ref)
377. 
378.     # Without interpolation
379.     cmref = mcolors.ListedColormap(['blue', 'red'])
380.     cmref.set_over('black')
381.     cmref.set_under('white')
382.     cmshould = mcolors.ListedColormap(['white', 'blue', 'red', 'black'])
383. 
384.     assert mcolors.same_color(cmref.get_over(), 'black')
385.     assert mcolors.same_color(cmref.get_under(), 'white')
386. 
387.     refnorm = mcolors.BoundaryNorm(bounds, cmref.N)
388.     mynorm = mcolors.BoundaryNorm(bounds, cmshould.N, extend='both')
389.     assert mynorm.vmin == refnorm.vmin
390.     assert mynorm.vmax == refnorm.vmax
391. 
392.     assert mynorm(bounds[0] - 0.1) == -1  # under
393.     assert mynorm(bounds[0] + 0.1) == 1   # first bin -> second color
394.     assert mynorm(bounds[-1] - 0.1) == cmshould.N - 2  # next-to-last color
395.     assert mynorm(bounds[-1] + 0.1) == cmshould.N  # over
396. 
397.     x = [-1, 1.2, 2.3, 9.6]
398.     assert_array_equal(cmshould(mynorm(x)), cmshould([0, 1, 2, 3]))
399.     x = np.random.randn(100) * 10 + 2
400.     assert_array_equal(cmshould(mynorm(x)), cmref(refnorm(x)))
401. 
402.     # Just min
403.     cmref = mcolors.ListedColormap(['blue', 'red'])
404.     cmref.set_under('white')
405.     cmshould = mcolors.ListedColormap(['white', 'blue', 'red'])
406. 
407.     assert mcolors.same_color(cmref.get_under(), 'white')
408. 
409.     assert cmref.N == 2
410.     assert cmshould.N == 3
411.     refnorm = mcolors.BoundaryNorm(bounds, cmref.N)
412.     mynorm = mcolors.BoundaryNorm(bounds, cmshould.N, extend='min')
413.     assert mynorm.vmin == refnorm.vmin
414.     assert mynorm.vmax == refnorm.vmax
415.     x = [-1, 1.2, 2.3]
416.     assert_array_equal(cmshould(mynorm(x)), cmshould([0, 1, 2]))
417.     x = np.random.randn(100) * 10 + 2
418.     assert_array_equal(cmshould(mynorm(x)), cmref(refnorm(x)))
419. 
420.     # Just max
421.     cmref = mcolors.ListedColormap(['blue', 'red'])
422.     cmref.set_over('black')
423.     cmshould = mcolors.ListedColormap(['blue', 'red', 'black'])
424. 
425.     assert mcolors.same_color(cmref.get_over(), 'black')
426. 
427.     assert cmref.N == 2
428.     assert cmshould.N == 3
429.     refnorm = mcolors.BoundaryNorm(bounds, cmref.N)
430.     mynorm = mcolors.BoundaryNorm(bounds, cmshould.N, extend='max')
431.     assert mynorm.vmin == refnorm.vmin
432.     assert mynorm.vmax == refnorm.vmax
433.     x = [1.2, 2.3, 4]
434.     assert_array_equal(cmshould(mynorm(x)), cmshould([0, 1, 2]))
435.     x = np.random.randn(100) * 10 + 2
436.     assert_array_equal(cmshould(mynorm(x)), cmref(refnorm(x)))
437. 
438. 
439. def test_CenteredNorm():
440.     np.random.seed(0)
441. 
442.     # Assert equivalence to symmetrical Normalize.
443.     x = np.random.normal(size=100)
444.     x_maxabs = np.max(np.abs(x))
445.     norm_ref = mcolors.Normalize(vmin=-x_maxabs, vmax=x_maxabs)
446.     norm = mcolors.CenteredNorm()
447.     assert_array_almost_equal(norm_ref(x), norm(x))
448. 
449.     # Check that vcenter is in the center of vmin and vmax
450.     # when vcenter is set.
451.     vcenter = int(np.random.normal(scale=50))
452.     norm = mcolors.CenteredNorm(vcenter=vcenter)
453.     norm.autoscale_None([1, 2])
454.     assert norm.vmax + norm.vmin == 2 * vcenter
455. 
456.     # Check that halfrange can be set without setting vcenter and that it is
457.     # not reset through autoscale_None.
458.     norm = mcolors.CenteredNorm(halfrange=1.0)
459.     norm.autoscale_None([1, 3000])
460.     assert norm.halfrange == 1.0
461. 
462.     # Check that halfrange input works correctly.
463.     x = np.random.normal(size=10)
464.     norm = mcolors.CenteredNorm(vcenter=0.5, halfrange=0.5)
465.     assert_array_almost_equal(x, norm(x))
466.     norm = mcolors.CenteredNorm(vcenter=1, halfrange=1)
467.     assert_array_almost_equal(x, 2 * norm(x))
468. 
469.     # Check that halfrange input works correctly and use setters.
470.     norm = mcolors.CenteredNorm()
471.     norm.vcenter = 2
472.     norm.halfrange = 2
473.     assert_array_almost_equal(x, 4 * norm(x))
474. 
475.     # Check that prior to adding data, setting halfrange first has same effect.
476.     norm = mcolors.CenteredNorm()
477.     norm.halfrange = 2
478.     norm.vcenter = 2
479.     assert_array_almost_equal(x, 4 * norm(x))
480. 
481.     # Check that manual change of vcenter adjusts halfrange accordingly.
482.     norm = mcolors.CenteredNorm()
483.     assert norm.vcenter == 0
484.     # add data
485.     norm(np.linspace(-1.0, 0.0, 10))
486.     assert norm.vmax == 1.0
487.     assert norm.halfrange == 1.0
488.     # set vcenter to 1, which should move the center but leave the
489.     # halfrange unchanged
490.     norm.vcenter = 1
491.     assert norm.vmin == 0
492.     assert norm.vmax == 2
493.     assert norm.halfrange == 1
494. 
495.     # Check setting vmin directly updates the halfrange and vmax, but
496.     # leaves vcenter alone
497.     norm.vmin = -1
498.     assert norm.halfrange == 2
499.     assert norm.vmax == 3
500.     assert norm.vcenter == 1
501. 
502.     # also check vmax updates
503.     norm.vmax = 2
504.     assert norm.halfrange == 1
505.     assert norm.vmin == 0
506.     assert norm.vcenter == 1
507. 
508. 
509. @pytest.mark.parametrize("vmin,vmax", [[-1, 2], [3, 1]])
510. def test_lognorm_invalid(vmin, vmax):
511.     # Check that invalid limits in LogNorm error
512.     norm = mcolors.LogNorm(vmin=vmin, vmax=vmax)
513.     with pytest.raises(ValueError):
514.         norm(1)
515.     with pytest.raises(ValueError):
516.         norm.inverse(1)
517. 
518. 
519. def test_LogNorm():
520.     """
521.     LogNorm ignored clip, now it has the same
522.     behavior as Normalize, e.g., values > vmax are bigger than 1
523.     without clip, with clip they are 1.
524.     """
525.     ln = mcolors.LogNorm(clip=True, vmax=5)
526.     assert_array_equal(ln([1, 6]), [0, 1.0])
527. 
528. 
529. def test_LogNorm_inverse():
530.     """
531.     Test that lists work, and that the inverse works
532.     """
533.     norm = mcolors.LogNorm(vmin=0.1, vmax=10)
534.     assert_array_almost_equal(norm([0.5, 0.4]), [0.349485, 0.30103])
535.     assert_array_almost_equal([0.5, 0.4], norm.inverse([0.349485, 0.30103]))
536.     assert_array_almost_equal(norm(0.4), [0.30103])
537.     assert_array_almost_equal([0.4], norm.inverse([0.30103]))
538. 
539. 
540. def test_PowerNorm():
541.     a = np.array([0, 0.5, 1, 1.5], dtype=float)
542.     pnorm = mcolors.PowerNorm(1)
543.     norm = mcolors.Normalize()
544.     assert_array_almost_equal(norm(a), pnorm(a))
545. 
546.     a = np.array([-0.5, 0, 2, 4, 8], dtype=float)
547.     expected = [0, 0, 1/16, 1/4, 1]
548.     pnorm = mcolors.PowerNorm(2, vmin=0, vmax=8)
549.     assert_array_almost_equal(pnorm(a), expected)
550.     assert pnorm(a[0]) == expected[0]
551.     assert pnorm(a[2]) == expected[2]
552.     assert_array_almost_equal(a[1:], pnorm.inverse(pnorm(a))[1:])
553. 
554.     # Clip = True
555.     a = np.array([-0.5, 0, 1, 8, 16], dtype=float)
556.     expected = [0, 0, 0, 1, 1]
557.     pnorm = mcolors.PowerNorm(2, vmin=2, vmax=8, clip=True)
558.     assert_array_almost_equal(pnorm(a), expected)
559.     assert pnorm(a[0]) == expected[0]
560.     assert pnorm(a[-1]) == expected[-1]
561. 
562.     # Clip = True at call time
563.     a = np.array([-0.5, 0, 1, 8, 16], dtype=float)
564.     expected = [0, 0, 0, 1, 1]
565.     pnorm = mcolors.PowerNorm(2, vmin=2, vmax=8, clip=False)
566.     assert_array_almost_equal(pnorm(a, clip=True), expected)
567.     assert pnorm(a[0], clip=True) == expected[0]
568.     assert pnorm(a[-1], clip=True) == expected[-1]
569. 
570. 
571. def test_PowerNorm_translation_invariance():
572.     a = np.array([0, 1/2, 1], dtype=float)
573.     expected = [0, 1/8, 1]
574.     pnorm = mcolors.PowerNorm(vmin=0, vmax=1, gamma=3)
575.     assert_array_almost_equal(pnorm(a), expected)
576.     pnorm = mcolors.PowerNorm(vmin=-2, vmax=-1, gamma=3)
577.     assert_array_almost_equal(pnorm(a - 2), expected)
578. 
579. 
580. def test_Normalize():
581.     norm = mcolors.Normalize()
582.     vals = np.arange(-10, 10, 1, dtype=float)
583.     _inverse_tester(norm, vals)
584.     _scalar_tester(norm, vals)
585.     _mask_tester(norm, vals)
586. 
587.     # Handle integer input correctly (don't overflow when computing max-min,
588.     # i.e. 127-(-128) here).
589.     vals = np.array([-128, 127], dtype=np.int8)
590.     norm = mcolors.Normalize(vals.min(), vals.max())
591.     assert_array_equal(norm(vals), [0, 1])
592. 
593.     # Don't lose precision on longdoubles (float128 on Linux):
594.     # for array inputs...
595.     vals = np.array([1.2345678901, 9.8765432109], dtype=np.longdouble)
596.     norm = mcolors.Normalize(vals[0], vals[1])
597.     assert norm(vals).dtype == np.longdouble
598.     assert_array_equal(norm(vals), [0, 1])
599.     # and for scalar ones.
600.     eps = np.finfo(np.longdouble).resolution
601.     norm = plt.Normalize(1, 1 + 100 * eps)
602.     # This returns exactly 0.5 when longdouble is extended precision (80-bit),
603.     # but only a value close to it when it is quadruple precision (128-bit).
604.     assert_array_almost_equal(norm(1 + 50 * eps), 0.5, decimal=3)
605. 
606. 
607. def test_FuncNorm():
608.     def forward(x):
609.         return (x**2)
610.     def inverse(x):
611.         return np.sqrt(x)
612. 
613.     norm = mcolors.FuncNorm((forward, inverse), vmin=0, vmax=10)
614.     expected = np.array([0, 0.25, 1])
615.     input = np.array([0, 5, 10])
616.     assert_array_almost_equal(norm(input), expected)
617.     assert_array_almost_equal(norm.inverse(expected), input)
618. 
619.     def forward(x):
620.         return np.log10(x)
621.     def inverse(x):
622.         return 10**x
623.     norm = mcolors.FuncNorm((forward, inverse), vmin=0.1, vmax=10)
624.     lognorm = mcolors.LogNorm(vmin=0.1, vmax=10)
625.     assert_array_almost_equal(norm([0.2, 5, 10]), lognorm([0.2, 5, 10]))
626.     assert_array_almost_equal(norm.inverse([0.2, 5, 10]),
627.                               lognorm.inverse([0.2, 5, 10]))
628. 
629. 
630. def test_TwoSlopeNorm_autoscale():
631.     norm = mcolors.TwoSlopeNorm(vcenter=20)
632.     norm.autoscale([10, 20, 30, 40])
633.     assert norm.vmin == 10.
634.     assert norm.vmax == 40.
635. 
636. 
637. def test_TwoSlopeNorm_autoscale_None_vmin():
638.     norm = mcolors.TwoSlopeNorm(2, vmin=0, vmax=None)
639.     norm.autoscale_None([1, 2, 3, 4, 5])
640.     assert norm(5) == 1
641.     assert norm.vmax == 5
642. 
643. 
644. def test_TwoSlopeNorm_autoscale_None_vmax():
645.     norm = mcolors.TwoSlopeNorm(2, vmin=None, vmax=10)
646.     norm.autoscale_None([1, 2, 3, 4, 5])
647.     assert norm(1) == 0
648.     assert norm.vmin == 1
649. 
650. 
651. def test_TwoSlopeNorm_scale():
652.     norm = mcolors.TwoSlopeNorm(2)
653.     assert norm.scaled() is False
654.     norm([1, 2, 3, 4])
655.     assert norm.scaled() is True
656. 
657. 
658. def test_TwoSlopeNorm_scaleout_center():
659.     # test the vmin never goes above vcenter
660.     norm = mcolors.TwoSlopeNorm(vcenter=0)
661.     norm([1, 2, 3, 5])
662.     assert norm.vmin == 0
663.     assert norm.vmax == 5
664. 
665. 
666. def test_TwoSlopeNorm_scaleout_center_max():
667.     # test the vmax never goes below vcenter
668.     norm = mcolors.TwoSlopeNorm(vcenter=0)
669.     norm([-1, -2, -3, -5])
670.     assert norm.vmax == 0
671.     assert norm.vmin == -5
672. 
673. 
674. def test_TwoSlopeNorm_Even():
675.     norm = mcolors.TwoSlopeNorm(vmin=-1, vcenter=0, vmax=4)
676.     vals = np.array([-1.0, -0.5, 0.0, 1.0, 2.0, 3.0, 4.0])
677.     expected = np.array([0.0, 0.25, 0.5, 0.625, 0.75, 0.875, 1.0])
678.     assert_array_equal(norm(vals), expected)
679. 
680. 
681. def test_TwoSlopeNorm_Odd():
682.     norm = mcolors.TwoSlopeNorm(vmin=-2, vcenter=0, vmax=5)
683.     vals = np.array([-2.0, -1.0, 0.0, 1.0, 2.0, 3.0, 4.0, 5.0])
684.     expected = np.array([0.0, 0.25, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0])
685.     assert_array_equal(norm(vals), expected)
686. 
687. 
688. def test_TwoSlopeNorm_VminEqualsVcenter():
689.     with pytest.raises(ValueError):
690.         mcolors.TwoSlopeNorm(vmin=-2, vcenter=-2, vmax=2)
691. 
692. 
693. def test_TwoSlopeNorm_VmaxEqualsVcenter():
694.     with pytest.raises(ValueError):
695.         mcolors.TwoSlopeNorm(vmin=-2, vcenter=2, vmax=2)
696. 
697. 
698. def test_TwoSlopeNorm_VminGTVcenter():
699.     with pytest.raises(ValueError):
700.         mcolors.TwoSlopeNorm(vmin=10, vcenter=0, vmax=20)
701. 
702. 
703. def test_TwoSlopeNorm_TwoSlopeNorm_VminGTVmax():
704.     with pytest.raises(ValueError):
705.         mcolors.TwoSlopeNorm(vmin=10, vcenter=0, vmax=5)
706. 
707. 
708. def test_TwoSlopeNorm_VcenterGTVmax():
709.     with pytest.raises(ValueError):
710.         mcolors.TwoSlopeNorm(vmin=10, vcenter=25, vmax=20)
711. 
712. 
713. def test_TwoSlopeNorm_premature_scaling():
714.     norm = mcolors.TwoSlopeNorm(vcenter=2)
715.     with pytest.raises(ValueError):
716.         norm.inverse(np.array([0.1, 0.5, 0.9]))
717. 
718. 
719. def test_SymLogNorm():
720.     """
721.     Test SymLogNorm behavior
722.     """
723.     norm = mcolors.SymLogNorm(3, vmax=5, linscale=1.2, base=np.e)
724.     vals = np.array([-30, -1, 2, 6], dtype=float)
725.     normed_vals = norm(vals)
726.     expected = [0., 0.53980074, 0.826991, 1.02758204]
727.     assert_array_almost_equal(normed_vals, expected)
728.     _inverse_tester(norm, vals)
729.     _scalar_tester(norm, vals)
730.     _mask_tester(norm, vals)
731. 
732.     # Ensure that specifying vmin returns the same result as above
733.     norm = mcolors.SymLogNorm(3, vmin=-30, vmax=5, linscale=1.2, base=np.e)
734.     normed_vals = norm(vals)
735.     assert_array_almost_equal(normed_vals, expected)
736. 
737.     # test something more easily checked.
738.     norm = mcolors.SymLogNorm(1, vmin=-np.e**3, vmax=np.e**3, base=np.e)
739.     nn = norm([-np.e**3, -np.e**2, -np.e**1, -1,
740.               0, 1, np.e**1, np.e**2, np.e**3])
741.     xx = np.array([0., 0.109123, 0.218246, 0.32737, 0.5, 0.67263,
742.                    0.781754, 0.890877, 1.])
743.     assert_array_almost_equal(nn, xx)
744.     norm = mcolors.SymLogNorm(1, vmin=-10**3, vmax=10**3, base=10)
745.     nn = norm([-10**3, -10**2, -10**1, -1,
746.               0, 1, 10**1, 10**2, 10**3])
747.     xx = np.array([0., 0.121622, 0.243243, 0.364865, 0.5, 0.635135,
748.                    0.756757, 0.878378, 1.])
749.     assert_array_almost_equal(nn, xx)
750. 
751. 
752. def test_SymLogNorm_colorbar():
753.     """
754.     Test un-called SymLogNorm in a colorbar.
755.     """
756.     norm = mcolors.SymLogNorm(0.1, vmin=-1, vmax=1, linscale=1, base=np.e)
757.     fig = plt.figure()
758.     mcolorbar.ColorbarBase(fig.add_subplot(), norm=norm)
759.     plt.close(fig)
760. 
761. 
762. def test_SymLogNorm_single_zero():
763.     """
764.     Test SymLogNorm to ensure it is not adding sub-ticks to zero label
765.     """
766.     fig = plt.figure()
767.     norm = mcolors.SymLogNorm(1e-5, vmin=-1, vmax=1, base=np.e)
768.     cbar = mcolorbar.ColorbarBase(fig.add_subplot(), norm=norm)
769.     ticks = cbar.get_ticks()
770.     assert np.count_nonzero(ticks == 0) <= 1
771.     plt.close(fig)
772. 
773. 
774. class TestAsinhNorm:
775.     """
776.     Tests for `~.colors.AsinhNorm`
777.     """
778. 
779.     def test_init(self):
780.         norm0 = mcolors.AsinhNorm()
781.         assert norm0.linear_width == 1
782. 
783.         norm5 = mcolors.AsinhNorm(linear_width=5)
784.         assert norm5.linear_width == 5
785. 
786.     def test_norm(self):
787.         norm = mcolors.AsinhNorm(2, vmin=-4, vmax=4)
788.         vals = np.arange(-3.5, 3.5, 10)
789.         normed_vals = norm(vals)
790.         asinh2 = np.arcsinh(2)
791. 
792.         expected = (2 * np.arcsinh(vals / 2) + 2 * asinh2) / (4 * asinh2)
793.         assert_array_almost_equal(normed_vals, expected)
794. 
795. 
796. def _inverse_tester(norm_instance, vals):
797.     """
798.     Checks if the inverse of the given normalization is working.
799.     """
800.     assert_array_almost_equal(norm_instance.inverse(norm_instance(vals)), vals)
801. 
802. 
803. def _scalar_tester(norm_instance, vals):
804.     """
805.     Checks if scalars and arrays are handled the same way.
806.     Tests only for float.
807.     """
808.     scalar_result = [norm_instance(float(v)) for v in vals]
809.     assert_array_almost_equal(scalar_result, norm_instance(vals))
810. 
811. 
812. def _mask_tester(norm_instance, vals):
813.     """
814.     Checks mask handling
815.     """
816.     masked_array = np.ma.array(vals)
817.     masked_array[0] = np.ma.masked
818.     assert_array_equal(masked_array.mask, norm_instance(masked_array).mask)
819. 
820. 
821. @image_comparison(['levels_and_colors.png'])
822. def test_cmap_and_norm_from_levels_and_colors():
823.     # Remove this line when this test image is regenerated.
824.     plt.rcParams['pcolormesh.snap'] = False
825. 
826.     data = np.linspace(-2, 4, 49).reshape(7, 7)
827.     levels = [-1, 2, 2.5, 3]
828.     colors = ['red', 'green', 'blue', 'yellow', 'black']
829.     extend = 'both'
830.     cmap, norm = mcolors.from_levels_and_colors(levels, colors, extend=extend)
831. 
832.     ax = plt.axes()
833.     m = plt.pcolormesh(data, cmap=cmap, norm=norm)
834.     plt.colorbar(m)
835. 
836.     # Hide the axes labels (but not the colorbar ones, as they are useful)
837.     ax.tick_params(labelleft=False, labelbottom=False)
838. 
839. 
840. @image_comparison(baseline_images=['boundarynorm_and_colorbar'],
841.                   extensions=['png'], tol=1.0)
842. def test_boundarynorm_and_colorbarbase():
843.     # Remove this line when this test image is regenerated.
844.     plt.rcParams['pcolormesh.snap'] = False
845. 
846.     # Make a figure and axes with dimensions as desired.
847.     fig = plt.figure()
848.     ax1 = fig.add_axes([0.05, 0.80, 0.9, 0.15])
849.     ax2 = fig.add_axes([0.05, 0.475, 0.9, 0.15])
850.     ax3 = fig.add_axes([0.05, 0.15, 0.9, 0.15])
851. 
852.     # Set the colormap and bounds
853.     bounds = [-1, 2, 5, 7, 12, 15]
854.     cmap = mpl.colormaps['viridis']
855. 
856.     # Default behavior
857.     norm = mcolors.BoundaryNorm(bounds, cmap.N)
858.     cb1 = mcolorbar.ColorbarBase(ax1, cmap=cmap, norm=norm, extend='both',
859.                                  orientation='horizontal', spacing='uniform')
860.     # New behavior
861.     norm = mcolors.BoundaryNorm(bounds, cmap.N, extend='both')
862.     cb2 = mcolorbar.ColorbarBase(ax2, cmap=cmap, norm=norm,
863.                                  orientation='horizontal')
864. 
865.     # User can still force to any extend='' if really needed
866.     norm = mcolors.BoundaryNorm(bounds, cmap.N, extend='both')
867.     cb3 = mcolorbar.ColorbarBase(ax3, cmap=cmap, norm=norm,
868.                                  extend='neither', orientation='horizontal')
869. 
870. 
871. def test_cmap_and_norm_from_levels_and_colors2():
872.     levels = [-1, 2, 2.5, 3]
873.     colors = ['red', (0, 1, 0), 'blue', (0.5, 0.5, 0.5), (0.0, 0.0, 0.0, 1.0)]
874.     clr = mcolors.to_rgba_array(colors)
875.     bad = (0.1, 0.1, 0.1, 0.1)
876.     no_color = (0.0, 0.0, 0.0, 0.0)
877.     masked_value = 'masked_value'
878. 
879.     # Define the test values which are of interest.
880.     # Note: levels are lev[i] <= v < lev[i+1]
881.     tests = [('both', None, {-2: clr[0],
882.                              -1: clr[1],
883.                              2: clr[2],
884.                              2.25: clr[2],
885.                              3: clr[4],
886.                              3.5: clr[4],
887.                              masked_value: bad}),
888. 
889.              ('min', -1, {-2: clr[0],
890.                           -1: clr[1],
891.                           2: clr[2],
892.                           2.25: clr[2],
893.                           3: no_color,
894.                           3.5: no_color,
895.                           masked_value: bad}),
896. 
897.              ('max', -1, {-2: no_color,
898.                           -1: clr[0],
899.                           2: clr[1],
900.                           2.25: clr[1],
901.                           3: clr[3],
902.                           3.5: clr[3],
903.                           masked_value: bad}),
904. 
905.              ('neither', -2, {-2: no_color,
906.                               -1: clr[0],
907.                               2: clr[1],
908.                               2.25: clr[1],
909.                               3: no_color,
910.                               3.5: no_color,
911.                               masked_value: bad}),
912.              ]
913. 
914.     for extend, i1, cases in tests:
915.         cmap, norm = mcolors.from_levels_and_colors(levels, colors[0:i1],
916.                                                     extend=extend)
917.         cmap.set_bad(bad)
918.         for d_val, expected_color in cases.items():
919.             if d_val == masked_value:
920.                 d_val = np.ma.array([1], mask=True)
921.             else:
922.                 d_val = [d_val]
923.             assert_array_equal(expected_color, cmap(norm(d_val))[0],
924.                                'Wih extend={0!r} and data '
925.                                'value={1!r}'.format(extend, d_val))
926. 
927.     with pytest.raises(ValueError):
928.         mcolors.from_levels_and_colors(levels, colors)
929. 
930. 
931. def test_rgb_hsv_round_trip():
932.     for a_shape in [(500, 500, 3), (500, 3), (1, 3), (3,)]:
933.         np.random.seed(0)
934.         tt = np.random.random(a_shape)
935.         assert_array_almost_equal(
936.             tt, mcolors.hsv_to_rgb(mcolors.rgb_to_hsv(tt)))
937.         assert_array_almost_equal(
938.             tt, mcolors.rgb_to_hsv(mcolors.hsv_to_rgb(tt)))
939. 
940. 
941. def test_autoscale_masked():
942.     # Test for #2336. Previously fully masked data would trigger a ValueError.
943.     data = np.ma.masked_all((12, 20))
944.     plt.pcolor(data)
945.     plt.draw()
946. 
947. 
948. @image_comparison(['light_source_shading_topo.png'])
949. def test_light_source_topo_surface():
950.     """Shades a DEM using different v.e.'s and blend modes."""
951.     dem = cbook.get_sample_data('jacksboro_fault_dem.npz', np_load=True)
952.     elev = dem['elevation']
953.     dx, dy = dem['dx'], dem['dy']
954.     # Get the true cellsize in meters for accurate vertical exaggeration
955.     # Convert from decimal degrees to meters
956.     dx = 111320.0 * dx * np.cos(dem['ymin'])
957.     dy = 111320.0 * dy
958. 
959.     ls = mcolors.LightSource(315, 45)
960.     cmap = cm.gist_earth
961. 
962.     fig, axs = plt.subplots(nrows=3, ncols=3)
963.     for row, mode in zip(axs, ['hsv', 'overlay', 'soft']):
964.         for ax, ve in zip(row, [0.1, 1, 10]):
965.             rgb = ls.shade(elev, cmap, vert_exag=ve, dx=dx, dy=dy,
966.                            blend_mode=mode)
967.             ax.imshow(rgb)
968.             ax.set(xticks=[], yticks=[])
969. 
970. 
971. def test_light_source_shading_default():
972.     """
973.     Array comparison test for the default "hsv" blend mode. Ensure the
974.     default result doesn't change without warning.
975.     """
976.     y, x = np.mgrid[-1.2:1.2:8j, -1.2:1.2:8j]
977.     z = 10 * np.cos(x**2 + y**2)
978. 
979.     cmap = plt.cm.copper
980.     ls = mcolors.LightSource(315, 45)
981.     rgb = ls.shade(z, cmap)
982. 
983.     # Result stored transposed and rounded for more compact display...
984.     expect = np.array(
985.         [[[0.00, 0.45, 0.90, 0.90, 0.82, 0.62, 0.28, 0.00],
986.           [0.45, 0.94, 0.99, 1.00, 1.00, 0.96, 0.65, 0.17],
987.           [0.90, 0.99, 1.00, 1.00, 1.00, 1.00, 0.94, 0.35],
988.           [0.90, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 0.49],
989.           [0.82, 1.00, 1.00, 1.00, 1.00, 1.00, 1.00, 0.41],
990.           [0.62, 0.96, 1.00, 1.00, 1.00, 1.00, 0.90, 0.07],
991.           [0.28, 0.65, 0.94, 1.00, 1.00, 0.90, 0.35, 0.01],
992.           [0.00, 0.17, 0.35, 0.49, 0.41, 0.07, 0.01, 0.00]],
993. 
994.          [[0.00, 0.28, 0.59, 0.72, 0.62, 0.40, 0.18, 0.00],
995.           [0.28, 0.78, 0.93, 0.92, 0.83, 0.66, 0.39, 0.11],
996.           [0.59, 0.93, 0.99, 1.00, 0.92, 0.75, 0.50, 0.21],
997.           [0.72, 0.92, 1.00, 0.99, 0.93, 0.76, 0.51, 0.18],
998.           [0.62, 0.83, 0.92, 0.93, 0.87, 0.68, 0.42, 0.08],
999.           [0.40, 0.66, 0.75, 0.76, 0.68, 0.52, 0.23, 0.02],
1000.           [0.18, 0.39, 0.50, 0.51, 0.42, 0.23, 0.00, 0.00],
1001.           [0.00, 0.11, 0.21, 0.18, 0.08, 0.02, 0.00, 0.00]],

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

IMPORTANT:
- Try to avoid asking for the SAME or very similar information as previous queries, because these queries have already been asked and satisfied.

2025-12-21 02:51:04,000 - thread-126911397234368.prometheus_context_collector.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user wants to find 3 relevant test cases for a bug in `matplotlib.colors.Colormap` related to a NumPy deprecation warning. I have been provided with the full content of `lib/matplotlib/tests/test_colors.py`. After analyzing this file, I have identified three relevant test cases (`test_BoundaryNorm`, `test_colormap_invalid`, and `test_Normalize`) that test similar functionality, such as handling integer data, out-of-bounds values, and integer overflows. This is sufficient to fulfill the user's request, so no additional context is needed." query='' extra_requirements='' purpose=''
2025-12-21 02:51:04,001 - thread-126911397234368.prometheus_context_collector - INFO - Successfully retrieved 1 context snippets
