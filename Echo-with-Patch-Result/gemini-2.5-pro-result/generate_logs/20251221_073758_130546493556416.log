2025-12-21 07:37:59,044 - thread-130546493556416.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpeaqt1s0f/astropy
2025-12-21 07:37:59,044 - thread-130546493556416.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-12-21 07:37:59,045 - thread-130546493556416.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-12907:v1
2025-12-21 08:01:54,112 - thread-130546493556416.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_441633c72a
2025-12-21 08:01:54,125 - thread-130546493556416.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_441633c72a
2025-12-21 08:02:00,217 - thread-130546493556416.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-12-21 08:02:01,137 - thread-130546493556416.app.docker.base_container - INFO - Persistent shell is ready
2025-12-21 08:02:01,137 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-12-21 08:02:01,372 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:02:01,372 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:


2025-12-21 08:02:01,372 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-12-21 08:02:01,609 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:02:01,609 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:


2025-12-21 08:02:01,610 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-12-21 08:04:03,733 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:04:03,733 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:
[A(testbed) root@ucl-research:/testbed# python -m pip install -e .[test] --verbos[Ke

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command pip subprocess to install build dependencies
  Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
  Collecting setuptools==68.0.0
    Obtaining dependency information for setuptools==68.0.0 from https://files.pythonhosted.org/packages/c7/42/be1c7bbdd83e1bfb160c94b9cafd8e25efc7400346cf7ccdbdb452c467fa/setuptools-68.0.0-py3-none-any.whl.metadata
    Using cached setuptools-68.0.0-py3-none-any.whl.metadata (6.4 kB)
  Collecting setuptools_scm>=6.2
    Obtaining dependency information for setuptools_scm>=6.2 from https://files.pythonhosted.org/packages/3d/ea/ac2bf868899d0d2e82ef72d350d97a846110c709bacf2d968431576ca915/setuptools_scm-9.2.2-py3-none-any.whl.metadata
    Downloading setuptools_scm-9.2.2-py3-none-any.whl.metadata (7.7 kB)
  Collecting wheel
    Obtaining dependency information for wheel from https://files.pythonhosted.org/packages/0b/2c/87f3254fd8ffd29e4c02732eee68a83a1d3c346ae39bc6822dcbcb697f2b/wheel-0.45.1-py3-none-any.whl.metadata
    Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
  Collecting cython==0.29.22
    Obtaining dependency information for cython==0.29.22 from https://files.pythonhosted.org/packages/08/3b/7697d21e325f27946ee41ef1c78648b6009b609ff22d8614270a758706a1/Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl.metadata
    Using cached Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl.metadata (2.6 kB)
  Collecting oldest-supported-numpy
    Obtaining dependency information for oldest-supported-numpy from https://files.pythonhosted.org/packages/dc/5c/e3c84cfdd488701aa074b22cf5bd227fb15d26e1d55a66d9088c39afa123/oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata
    Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata (9.8 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/88/ff/5a7cd8c9698628b3c04215ee3a96c69865477f451b4f096682e78d085bfc/extension_helpers-1.3.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/8e/b1/73ce2924fe46281faf31567e96fb9eee4eca02fd1cb852562bb2971e9df1/extension_helpers-1.3.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f8/fb/f9a88ccea5377736d5d1e53c8a6c70207178cdc1ebbf305a50a610cbb751/extension_helpers-1.4.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/24/51/d03359b683ed288b34d713dea97d2aee87a9bd866af1652554d9f643b47d/extension_helpers-1.4.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
  Collecting extension-helpers
    Obtaining dependency information for extension-helpers from https://files.pythonhosted.org/packages/b3/0e/22599eac9e50f4274e78e47cef7e760d7a1bb2f0d0fdfb0bb5b0d2da263a/extension_helpers-1.2.0-py3-none-any.whl.metadata
    Using cached extension_helpers-1.2.0-py3-none-any.whl.metadata (2.2 kB)
  Collecting packaging>=20 (from setuptools_scm>=6.2)
    Obtaining dependency information for packaging>=20 from https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl.metadata
    Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
  Collecting tomli>=1 (from setuptools_scm>=6.2)
    Obtaining dependency information for tomli>=1 from https://files.pythonhosted.org/packages/77/b8/0135fadc89e73be292b473cb820b4f5a08197779206b33191e801feeae40/tomli-2.3.0-py3-none-any.whl.metadata
    Downloading tomli-2.3.0-py3-none-any.whl.metadata (10 kB)
  Collecting typing-extensions (from setuptools_scm>=6.2)
    Obtaining dependency information for typing-extensions from https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
    Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/54/a4/f8188c4f3e07f7737683588210c073478abcb542048cf4ab6fedad0b458a/numpy-2.1.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/59/5f/9003bb3e632f2b58f5e3a3378902dcc73c5518070736c6740fe52454e8e1/numpy-2.1.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/4b/d1/8a730ea07f4a37d94f9172f4ce1d81064b7a64766b460378be278952de75/numpy-2.1.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/25/ca/1166b75c21abd1da445b97bf1fa2f14f423c6cfb4fc7c4ef31dccf9f6a94/numpy-2.1.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/47/1b/1d565e0f6e156e1522ab564176b8b29d71e13d8caf003a08768df3d5cec5/numpy-2.2.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f2/a5/fdbf6a7871703df6160b5cf3dd774074b086d278172285c52c2758b76305/numpy-2.2.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/ec/d0/c12ddfd3a02274be06ffc71f3efc6d0e457b0409c4481596881e748cb264/numpy-2.2.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/fb/90/8956572f5c4ae52201fdec7ba2044b2c882832dcec7d5d0922c9e9acf2de/numpy-2.2.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/e1/78/31103410a57bc2c2b93a3597340a8119588571f6a4539067546cb9a0bfac/numpy-2.2.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/dc/b2/ce4b867d8cd9c0ee84938ae1e6a6f7926ebf928c9090d036fc3c6a04f946/numpy-2.2.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/f3/db/8e12381333aea300890829a0a36bfa738cac95475d88982d538725143fd9/numpy-2.3.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/2e/19/d7c972dfe90a353dbd3efbbe1d14a5951de80c99c9dc1b93cd998d51dc0f/numpy-2.3.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/37/7d/3fec4199c5ffb892bed55cff901e4f39a58c81df9c44c280499e92cad264/numpy-2.3.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/b5/f4/098d2270d52b41f1bd7db9fc288aaa0400cb48c2a3e2af6fa365d9720947/numpy-2.3.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/76/65/21b3bc86aac7b8f2862db1e808f1ea22b028e30a225a34a5ede9bf8678f2/numpy-2.3.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/12/02/7111f298e24a44d6fa4b75b47d93eccf444e5afbcee5b04aac760ee48935/numpy-2.4.0rc1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/a4/7a/6a3d14e205d292b738db449d0de649b373a59edb0d0b4493821d0a3e8718/numpy-2.4.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
  Collecting numpy==1.19.3 (from oldest-supported-numpy)
    Obtaining dependency information for numpy==1.19.3 from https://files.pythonhosted.org/packages/c3/8d/2ae53d96a92a66b8daa3dfb2dd6cf4bfcb8e3d4148bdd713c8fc7de83141/numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata
    Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata (2.0 kB)
  Using cached setuptools-68.0.0-py3-none-any.whl (804 kB)
  Using cached Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl (1.9 MB)
  Downloading setuptools_scm-9.2.2-py3-none-any.whl (62 kB)
  Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
  Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl (4.9 kB)
  Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl (14.9 MB)
  Using cached extension_helpers-1.2.0-py3-none-any.whl (23 kB)
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
  Downloading tomli-2.3.0-py3-none-any.whl (14 kB)
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
  Installing collected packages: wheel, typing-extensions, tomli, setuptools, packaging, numpy, cython, setuptools_scm, oldest-supported-numpy, extension-helpers
    Creating /tmp/pip-build-env-4liwoghd/overlay/bin
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/wheel to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/f2py to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/f2py3 to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/f2py3.9 to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/cygdb to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/cython to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/cythonize to 755
    changing mode of /tmp/pip-build-env-4liwoghd/overlay/bin/setuptools-scm to 755
  Successfully installed cython-0.29.22 extension-helpers-1.2.0 numpy-1.19.3 oldest-supported-numpy-2023.12.21 packaging-25.0 setuptools-68.0.0 setuptools_scm-9.2.2 tomli-2.3.0 typing-extensions-4.15.0 wheel-0.45.1
  WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  Installing build dependencies ... [?25l[?25hdone
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable ... [?25l[?25hdone
  Running command Getting requirements to build editable
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running egg_info
  writing astropy.egg-info/PKG-INFO
  writing dependency_links to astropy.egg-info/dependency_links.txt
  writing entry points to astropy.egg-info/entry_points.txt
  writing requirements to astropy.egg-info/requires.txt
  writing top-level names to astropy.egg-info/top_level.txt
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file 'astropy.egg-info/SOURCES.txt'
  Getting requirements to build editable ... [?25l[?25hdone
  Running command Preparing editable metadata (pyproject.toml)
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running dist_info
  creating /tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info
  writing /tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-modern-metadata-2cb4n1qq/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-2cb4n1qq/astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info'
  Preparing editable metadata (pyproject.toml) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.18 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (6.0.1)
Requirement already satisfied: packaging>=19.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (23.1)
Requirement already satisfied: pytest-astropy>=0.9 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (0.10.0)
Requirement already satisfied: pytest-astropy-header!=0.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (0.2.2)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev623+gd16bfe05a.d20251221) (3.3.1)
Requirement already satisfied: pytest>=4.6 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (7.4.0)
Requirement already satisfied: pytest-doctestplus>=0.11.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (1.0.0)
Requirement already satisfied: pytest-remotedata>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (0.4.0)
Requirement already satisfied: pytest-openfiles>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (0.5.0)
Requirement already satisfied: pytest-arraydiff>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (0.5.0)
Requirement already satisfied: pytest-filter-subpackage>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (0.1.2)
Requirement already satisfied: pytest-cov>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (4.1.0)
Requirement already satisfied: pytest-mock>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (3.11.1)
Requirement already satisfied: attrs>=19.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (23.1.0)
Requirement already satisfied: hypothesis>=5.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (6.82.6)
Requirement already satisfied: execnet>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-xdist->astropy==5.1.dev623+gd16bfe05a.d20251221) (2.0.2)
Requirement already satisfied: sortedcontainers<3.0.0,>=2.1.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis>=5.1->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (2.4.0)
Requirement already satisfied: exceptiongroup>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis>=5.1->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (1.1.3)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=4.6->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=4.6->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (1.3.0)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=4.6->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (2.0.1)
Requirement already satisfied: coverage>=5.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from coverage[toml]>=5.2.1->pytest-cov>=2.3.1->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (7.6.2)
Requirement already satisfied: setuptools>=30.3.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-doctestplus>=0.11.0->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (68.0.0)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-openfiles>=0.3.1->pytest-astropy>=0.9->astropy==5.1.dev623+gd16bfe05a.d20251221) (5.9.5)
Building wheels for collected packages: astropy
  Running command Building editable for astropy (pyproject.toml)
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running editable_wheel
  creating /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info
  writing /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info'
  creating /tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/WHEEL
  running build_py
  running build_ext
  skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
  skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
  skipping 'astropy/timeseries/periodograms/bls/_impl.c' Cython extension (up-to-date)
  skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
  skipping './astropy/stats/_stats.c' Cython extension (up-to-date)
  skipping './astropy/cosmology/scalar_inv_efuncs.c' Cython extension (up-to-date)
  skipping './astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
  skipping './astropy/io/fits/_utils.c' Cython extension (up-to-date)
  building 'astropy.table._np_utils' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_np_utils.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/table/_np_utils.o
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_np_utils.c:610:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmpujfsnppr.build-lib/astropy
  creating /tmp/tmpujfsnppr.build-lib/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/table/_np_utils.o -o /tmp/tmpujfsnppr.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._column_mixins' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_column_mixins.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/table/_column_mixins.o
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:608:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:21,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:608:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/__multiarray_api.h:1463:1: warning: â€˜_import_arrayâ€™ defined but not used [-Wunused-function]
   1463 | _import_array(void)
        | ^~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/table/_column_mixins.o -o /tmp/tmpujfsnppr.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils._compiler' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/utils
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/utils/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/src/compiler.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/utils/src/compiler.o
  creating /tmp/tmpujfsnppr.build-lib/astropy/utils
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/utils/src/compiler.o -o /tmp/tmpujfsnppr.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._fast_sigma_clip' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/stats
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/compute_bounds.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src/compute_bounds.o
  astropy/stats/src/compute_bounds.c: In function â€˜compute_sigma_clipped_boundsâ€™:
  astropy/stats/src/compute_bounds.c:53:24: warning: â€˜cenâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     53 |     *upper_bound = cen + sigma_upper * std;
        |                    ~~~~^~~~~~~~~~~~~~~~~~~
  astropy/stats/src/compute_bounds.c:38:45: warning: â€˜medianâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     38 |         mad_buffer[i] = fabs(data_buffer[i] - median);
        |                              ~~~~~~~~~~~~~~~^~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/fast_sigma_clip.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src/fast_sigma_clip.o
  astropy/stats/src/fast_sigma_clip.c: In function â€˜PyInit__fast_sigma_clipâ€™:
  astropy/stats/src/fast_sigma_clip.c:44:48: warning: initialization of â€˜void (*)(char **, const npy_intp *, const npy_intp *, void *)â€™ {aka â€˜void (*)(char **, const long int *, const long int *, void *)â€™} from incompatible pointer type â€˜void (*)(char **, npy_intp *, npy_intp *, void *)â€™ {aka â€˜void (*)(char **, long int *, long int *, void *)â€™} [-Wincompatible-pointer-types]
     44 |     static PyUFuncGenericFunction funcs[1] = { &_sigma_clip_fast };
        |                                                ^
  astropy/stats/src/fast_sigma_clip.c:44:48: note: (near initialization for â€˜funcs[0]â€™)
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/pytime.h:6,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:81,
                   from astropy/stats/src/fast_sigma_clip.c:3:
  /opt/miniconda3/envs/testbed/include/python3.9/object.h:496:8: warning: â€˜dâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    496 |     if (op != NULL) {
        |        ^
  astropy/stats/src/fast_sigma_clip.c:30:19: note: â€˜dâ€™ was declared here
     30 |     PyObject *m, *d;
        |                   ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/wirth_select.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src/wirth_select.o
  creating /tmp/tmpujfsnppr.build-lib/astropy/stats
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src/compute_bounds.o /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src/fast_sigma_clip.o /tmp/tmpuxfbxzc5.build-temp/astropy/stats/src/wirth_select.o -o /tmp/tmpujfsnppr.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so
  building 'astropy.convolution._convolve' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/convolution
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/convolution/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/src/convolve.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/convolution/src/convolve.o -UNDEBUG -fPIC
  creating /tmp/tmpujfsnppr.build-lib/astropy/convolution
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/convolution/src/convolve.o -o /tmp/tmpujfsnppr.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so
  building 'astropy.time._parse_times' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/time
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/time/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/time/src/parse_times.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/time/src/parse_times.o
  creating /tmp/tmpujfsnppr.build-lib/astropy/time
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/time/src/parse_times.o -o /tmp/tmpujfsnppr.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so
  building 'astropy.wcs._wcs' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/wcs
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src
  creating /tmp/tmpuxfbxzc5.build-temp/cextern
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/astropy_wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs_api.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/astropy_wcs_api.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/distortion.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/distortion_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/docstrings.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/docstrings.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pipeline.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/pipeline.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pyutil.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/pyutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/src/pyutil.c:9:
  In function â€˜strncpyâ€™,
      inlined from â€˜set_pscardsâ€™ at astropy/wcs/src/pyutil.c:807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 72 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/sip.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/sip_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/str_list_proxy.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/str_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/unit_list_proxy.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/unit_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/util.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/util.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_auxprm_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_celprm_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:167:22: warning: initialization of â€˜PyCelprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    167 |     PyCelprm* copy = PyCelprm_new(&PyCelprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_set_refâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_celprm_wrap.c:348:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    348 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_prjprm_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:149:22: warning: initialization of â€˜PyPrjprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    149 |     PyPrjprm* copy = PyPrjprm_new(&PyPrjprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:517:14: warning: assignment to â€˜PyObject *â€™ {aka â€˜struct _object *â€™} from incompatible pointer type â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} [-Wincompatible-pointer-types]
    517 |     pv_array = (PyArrayObject*) PyArray_SimpleNew(1, &size, NPY_DOUBLE);
        |              ^
  astropy/wcs/src/wcslib_prjprm_wrap.c:519:33: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    519 |     pv = (double*) PyArray_DATA(pv_array);
        |                                 ^~~~~~~~
        |                                 |
        |                                 PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c:583:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    583 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:615:15: warning: unused variable â€˜valueâ€™ [-Wunused-variable]
    615 |     PyObject* value = NULL;
        |               ^~~~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:48: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                ^~~~~~~~~~~
        |                                                |
        |                                                PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:24: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                        ^~~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:62: warning: passing argument 1 of â€˜PyArray_DESCRâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                              ^~~~~~~~~~~
        |                                                              |
        |                                                              PyObject * {aka struct _object *}
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:44: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                                            ^~~
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1517:30: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1517 | PyArray_DESCR(PyArrayObject *arr)
        |               ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_wâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:780:32: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    780 |     w = (double*) PyArray_DATA(w_array);
        |                                ^~~~~~~
        |                                |
        |                                PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_tabprm_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜PyWcsprm_sptrâ€™ at astropy/wcs/src/wcslib_wrap.c:1789:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 9 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wrap.c: In function â€˜PyWcsprm_copyâ€™:
  astropy/wcs/src/wcslib_wrap.c:672:32: warning: argument 1 range [18446744071562067968, 18446744073709551615] exceeds maximum object size 9223372036854775807 [-Walloc-size-larger-than=]
    672 |         if (!((*wtb->arrayp) = calloc((size_t)nelem, sizeof(double)))) {
        |                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:34,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  /usr/include/stdlib.h:543:14: note: in a call to allocation function â€˜callocâ€™ declared here
    543 | extern void *calloc (size_t __nmemb, size_t __size)
        |              ^~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wtbarr_wrap.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: warning: initialization of â€˜int (*)(PyObject *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(struct _object *, int (*)(struct _object *, void *), void *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(PyWtbarr *, int (*)(struct _object *, void *), void *)â€™} [-Wincompatible-pointer-types]
    208 |   PyWtbarr_traverse,            /* tp_traverse */
        |   ^~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: note: (near initialization for â€˜PyWtbarrType.tp_traverseâ€™)
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: warning: initialization of â€˜int (*)(PyObject *)â€™ {aka â€˜int (*)(struct _object *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *)â€™ [-Wincompatible-pointer-types]
    209 |   PyWtbarr_clear,               /* tp_clear */
        |   ^~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: note: (near initialization for â€˜PyWtbarrType.tp_clearâ€™)
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/cel.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/cel.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/dis.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/dis.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsbth.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcsbth.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcspih.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcspih.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsulex.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcsulex.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsutrn.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcsutrn.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/lin.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/lin.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/log.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/log.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/prj.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/prj.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spc.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/spc.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/sph.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/sph.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spx.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/spx.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/tab.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/tab.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcs.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcserr.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcserr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsfix.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsfix.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcshdr.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcshdr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsprintf.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsprintf.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsunits.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsunits.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsutil.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  creating /tmp/tmpujfsnppr.build-lib/astropy/wcs
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/astropy_wcs.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/astropy_wcs_api.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/distortion.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/distortion_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/docstrings.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/pipeline.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/pyutil.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/sip.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/sip_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/str_list_proxy.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/unit_list_proxy.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/util.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_wrap.o /tmp/tmpuxfbxzc5.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/cel.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/dis.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcsbth.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcspih.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcsulex.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/flexed/wcsutrn.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/lin.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/log.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/prj.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/spc.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/sph.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/spx.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/tab.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcs.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcserr.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsfix.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcshdr.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsprintf.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsunits.o /tmp/tmpuxfbxzc5.build-temp/cextern/wcslib/C/wcsutil.o -o /tmp/tmpujfsnppr.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils.xml._iterparser' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/utils/xml
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/utils/xml/src
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/expat
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/xml/src/iterparse.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/utils/xml/src/iterparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlparse.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmlparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlrole.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmlrole.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmltok.o
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingNSâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1657:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1646:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok_impl.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmltok_impl.o
  creating /tmp/tmpujfsnppr.build-lib/astropy/utils/xml
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/utils/xml/src/iterparse.o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmlparse.o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmlrole.o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmltok.o /tmp/tmpuxfbxzc5.build-temp/cextern/expat/lib/xmltok_impl.o -o /tmp/tmpujfsnppr.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -Wl,--version-script=astropy/utils/xml/src/iterparse.map
  building 'astropy.timeseries.periodograms.bls._impl' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/_impl.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/bls/_impl.o
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/timeseries/periodograms/bls/_impl.c:610:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/bls.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/bls/bls.o
  astropy/timeseries/periodograms/bls/bls.c: In function â€˜run_blsâ€™:
  astropy/timeseries/periodograms/bls/bls.c:92: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
     92 | #pragma omp parallel
        |
  astropy/timeseries/periodograms/bls/bls.c:116: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    116 |     #pragma omp parallel for reduction(+:sum_y), reduction(+:sum_ivar)
        |
  astropy/timeseries/periodograms/bls/bls.c:125: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    125 |     #pragma omp parallel for
        |
  creating /tmp/tmpujfsnppr.build-lib/astropy/timeseries
  creating /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms
  creating /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/bls/_impl.o /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/bls/bls.o -o /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.votable.tablewriter' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io/votable
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io/votable/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/votable/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/votable/src/tablewriter.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/io/votable/src/tablewriter.o
  astropy/io/votable/src/tablewriter.c: In function â€˜write_tabledataâ€™:
  astropy/io/votable/src/tablewriter.c:270:30: warning: assignment discards â€˜constâ€™ qualifier from pointer target type [-Wdiscarded-qualifiers]
    270 |                 if ((str_tmp = PyUnicode_AsUTF8AndSize(str_val, &str_len)) == NULL) {
        |                              ^
  creating /tmp/tmpujfsnppr.build-lib/astropy/io
  creating /tmp/tmpujfsnppr.build-lib/astropy/io/votable
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/io/votable/src/tablewriter.o -o /tmp/tmpujfsnppr.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits.compression' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io/fits
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io/fits/src
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib
  creating /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/src/compressionmodule.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/io/fits/src/compressionmodule.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  astropy/io/fits/src/compressionmodule.c: In function â€˜compression_compress_hduâ€™:
  astropy/io/fits/src/compressionmodule.c:1042:16: warning: comparison of integer expressions of different signedness: â€˜npy_intpâ€™ {aka â€˜long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1042 |     if (znaxis < outbufsize) {
        |                ^
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:446:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:446:26: note: directive argument in the range [1, 2147483647]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:450:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 69 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:453:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:453:26: note: directive argument in the range [1, 2147483647]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:457:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 9 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:469:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:469:26: note: directive argument in the range [1, 2147483647]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:474:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:474:26: note: directive argument in the range [1, 2147483647]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:479:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:479:26: note: directive argument in the range [1, 2147483647]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜configure_compressionâ€™ at astropy/io/fits/src/compressionmodule.c:600:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 11 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜configure_compressionâ€™:
  astropy/io/fits/src/compressionmodule.c:643:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:643:30: note: directive argument in the range [1, 2147483647]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:654:35: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 5 [-Wformat-truncation=]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                                   ^~
  astropy/io/fits/src/compressionmodule.c:654:30: note: directive argument in the range [1, 2147483647]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                              ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 6 and 15 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜init_output_bufferâ€™:
  astropy/io/fits/src/compressionmodule.c:776:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:776:30: note: directive argument in the range [1, 2147483647]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/buffers.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/buffers.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/cfileio.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/cfileio.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/cfileio.c:7:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffoptpltâ€™ at cextern/cfitsio/lib/cfileio.c:7788:7:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 30 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1711:13,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1693:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 5 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffomemâ€™:
  cextern/cfitsio/lib/cfileio.c:339:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    339 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffopenâ€™:
  cextern/cfitsio/lib/cfileio.c:971:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    971 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/checksum.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/checksum.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrfile.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrfile.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrmem.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/drvrmem.c: In function â€˜mem_truncateâ€™:
  cextern/cfitsio/lib/drvrmem.c:273:23: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    273 |         if ( filesize > *(memTable[handle].memsizeptr) )
        |                       ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrnet.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrnet.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrsmem.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrsmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/editcol.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/editcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/editcol.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2807:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 8 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2767:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 4 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2802:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 4 and 5 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2809:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/editcol.c: In function â€˜ffkshfâ€™:
  cextern/cfitsio/lib/editcol.c:2808:24: note: length computed here
   2808 |                   i1 = strlen(newkey);
        |                        ^~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/edithdu.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/edithdu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_f.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/eval_f.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_l.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/eval_l.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_y.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/eval_y.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hcompress.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/fits_hcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hdecompress.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/fits_hdecompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fitscore.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/fitscore.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkkyâ€™:
  cextern/cfitsio/lib/fitscore.c:1114:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1114 |             if (strlen(cptr) > maxlen) maxlen = strlen(cptr); /* find longest token */
        |                              ^
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkeyâ€™:
  cextern/cfitsio/lib/fitscore.c:1291:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1291 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/fitscore.c:37:
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1111:8:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1155:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffbinit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:5094:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   5094 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffbinit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffainit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:4897:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4897 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                                    ^~
   4898 |             name, (long) tbcoln);
        |             ~~~~
  cextern/cfitsio/lib/fitscore.c:4897:42: note: using the range [-9223372036854775808, 9223372036854775807] for directive argument
   4897 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 45 and 138 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4888:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4888 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4880:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4880 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜fftheapâ€™:
  cextern/cfitsio/lib/fitscore.c:6079:75: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   6079 |                 "Descriptor in row %ld, column %d has invalid heap address",
        |                                                                           ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 55 and 82 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffcmphâ€™:
  cextern/cfitsio/lib/fitscore.c:6217:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   6217 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffgcprllâ€™:
  cextern/cfitsio/lib/fitscore.c:5955:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   5955 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:5757:76: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   5757 |         "First element to write is too large: %ld; max allowed value is %ld",
        |                                                                            ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 63 and 101 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcol.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolb.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcold.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcole.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoli.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolj.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolk.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoll.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcols.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getcols.c:9:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:442:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:423:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:384:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:365:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:587:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolsb.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolui.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluj.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getcoluj.c: In function â€˜fffi8u4â€™:
  cextern/cfitsio/lib/getcoluj.c:1331:36: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1331 |                 else if (input[ii] > ULONG_MAX)
        |                                    ^
  cextern/cfitsio/lib/getcoluj.c:1414:40: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1414 |                     else if (input[ii] > ULONG_MAX)
        |                                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluk.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getkey.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgskyâ€™:
  cextern/cfitsio/lib/getkey.c:1080:23: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1080 |         if (firstchar <= len)
        |                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffgcntâ€™ at cextern/cfitsio/lib/getkey.c:1134:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 10 bytes from a string of length 11 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgphd.part.0â€™:
  cextern/cfitsio/lib/getkey.c:2855:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2855 |             "First keyword of the extension is not XTENSION: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2847:53: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 49 [-Wformat-truncation=]
   2847 |                    "This is not an IMAGE extension: %s", value);
        |                                                     ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 33 and 103 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2821:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 40 [-Wformat-truncation=]
   2821 |                    "First keyword of the file is not SIMPLE: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 42 and 116 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2930:48: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2930 |             "Illegal value for BITPIX keyword: %s", value);
        |                                                ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2921:57: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 38 [-Wformat-truncation=]
   2921 |             "Value of BITPIX keyword is not an integer: %s", value);
        |                                                         ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 44 and 114 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2913:61: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 34 [-Wformat-truncation=]
   2913 |             "Second keyword of the extension is not BITPIX: %s", name);
        |                                                             ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3021:70: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size between 19 and 28 [-Wformat-truncation=]
   3021 |               "Name of keyword no. %d contains illegal character(s): %s",
        |                                                                      ^~
   3022 |               nextkey, name);
        |                        ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 54 and 137 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3118:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3118 |                 "Error reading EXTEND keyword value as a logical: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3101:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3101 |                 "Error reading GCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3088:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3088 |                 "Error reading PCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3075:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3075 |                 "Error reading BLANK keyword value as an integer: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3058:65: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 34 [-Wformat-truncation=]
   3058 |                 "Error reading BZERO keyword value as a double: %s", value);
        |                                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 118 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3041:66: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 33 [-Wformat-truncation=]
   3041 |                 "Error reading BSCALE keyword value as a double: %s", value);
        |                                                                  ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 119 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbâ€™:
  cextern/cfitsio/lib/getkey.c:2282:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2282 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2273:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2273 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbllâ€™:
  cextern/cfitsio/lib/getkey.c:2425:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2425 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2416:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2416 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnâ€™:
  cextern/cfitsio/lib/getkey.c:2570:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2570 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2561:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2561 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnllâ€™:
  cextern/cfitsio/lib/getkey.c:2693:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2693 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2684:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2684 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/group.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/group.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/group.c: In function â€˜ffgmopâ€™:
  cextern/cfitsio/lib/group.c:2290:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 39 [-Wformat-truncation=]
   2290 |                   "Cannot open member HDU file with URI type %s (ffgmop)",
        |                                                              ^~
   2291 |                           uri);
        |                           ~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:62,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/group.c:17:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 52 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/grparser.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/grparser.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/histo.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/histo.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/imcompress.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/imcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/imcompress.c: In function â€˜imcomp_decompress_tileâ€™:
  cextern/cfitsio/lib/imcompress.c:6064:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6064 |             if (tilebytesize == 4 * tilelen) {  /* float pixels */
        |                              ^~
  cextern/cfitsio/lib/imcompress.c:6095:37: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6095 |             } else if (tilebytesize == 8 * tilelen) { /* double pixels */
        |                                     ^~
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_compress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:8509:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} [-Wsign-compare]
   8509 |                     if (dlen < vlamemlen) {
        |                              ^
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_uncompress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:9250:39: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   9250 |                         if (cvlalen   == vlamemlen ) {
        |                                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/imcompress.c:3:
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8162:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8166:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8170:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8795:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8799:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8803:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜imcomp_get_compressed_image_parâ€™ at cextern/cfitsio/lib/imcompress.c:5263:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 11 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8663:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8536:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/iraffits.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/iraffits.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:576:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcomâ€™ at cextern/cfitsio/lib/iraffits.c:2088:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 2 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1930:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1992:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1908:16: note: length computed here
   1908 |     lkeyword = strlen (keyword);
        |                ^~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2009:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2001:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2020:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying between 0 and 49 bytes from a string of length 49 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputsâ€™ at cextern/cfitsio/lib/iraffits.c:1875:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ specified bound depends on the length of the source argument [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputsâ€™:
  cextern/cfitsio/lib/iraffits.c:1869:13: note: length computed here
   1869 |     lcval = strlen (cval);
        |             ^~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:624:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:864:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:853:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:823:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:811:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:880:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/modkey.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/modkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/modkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffiklsâ€™ at cextern/cfitsio/lib/modkey.c:1282:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffmklsâ€™ at cextern/cfitsio/lib/modkey.c:783:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:567:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:562:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/pliocomp.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/pliocomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcol.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolb.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcold.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcole.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoli.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolj.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolk.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoll.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcols.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolsb.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolu.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolui.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluj.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluk.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putkey.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/putkey.c: In function â€˜ffprecâ€™:
  cextern/cfitsio/lib/putkey.c:326:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    326 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/putkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffpklsâ€™ at cextern/cfitsio/lib/putkey.c:483:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/quantize.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/quantize.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/region.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/region.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/region.c:988:1: warning: "/*" within comment [-Wcomment]
    988 | /*---------------------------------------------------------------------------*/
        |
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/ricecomp.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/ricecomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/scalnull.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/scalnull.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/simplerng.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/simplerng.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/swapproc.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/swapproc.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/swapproc.c: In function â€˜ffswap2â€™:
  cextern/cfitsio/lib/swapproc.c:87:24: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
     87 |     for (ii = peel; ii < (nvals - peel - (nvals - peel) % 8); ii+=8) {
        |                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcssub.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/wcssub.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/wcssub.c:3:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:847:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:852:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:858:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:898:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:907:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:916:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:925:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:934:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:945:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:1040:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 77 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcsutil.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/wcsutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zcompress.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/zcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zcompress.c: In function â€˜uncompress2fileâ€™:
  cextern/cfitsio/lib/zcompress.c:345:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    345 |             != (d_stream.total_out - bytes_out)) {
        |             ^~
  cextern/cfitsio/lib/zcompress.c: In function â€˜compress2file_from_memâ€™:
  cextern/cfitsio/lib/zcompress.c:513:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    513 |             != (c_stream.total_out - bytes_out)) {
        |             ^~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zuncompress.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/zuncompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zuncompress.c: In function â€˜write_bufâ€™:
  cextern/cfitsio/lib/zuncompress.c:581:27: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    581 |       if (bytes_out + cnt > *memsize)
        |                           ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/adler32.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/adler32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/crc32.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/crc32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/deflate.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/deflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/infback.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/infback.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inffast.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/inffast.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inflate.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/inflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inftrees.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/inftrees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/trees.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/trees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/uncompr.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/uncompr.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/zutil.c -o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/zutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  creating /tmp/tmpujfsnppr.build-lib/astropy/io/fits
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/io/fits/src/compressionmodule.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/buffers.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/cfileio.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/checksum.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrfile.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrmem.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrnet.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/drvrsmem.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/editcol.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/edithdu.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/eval_f.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/eval_l.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/eval_y.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/fits_hcompress.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/fits_hdecompress.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/fitscore.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcol.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolb.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcold.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcole.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoli.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolj.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolk.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoll.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcols.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolsb.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcolui.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoluj.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getcoluk.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/getkey.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/group.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/grparser.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/histo.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/imcompress.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/iraffits.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/modkey.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/pliocomp.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcol.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolb.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcold.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcole.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoli.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolj.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolk.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoll.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcols.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolsb.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolu.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcolui.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoluj.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putcoluk.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/putkey.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/quantize.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/region.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/ricecomp.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/scalnull.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/simplerng.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/swapproc.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/wcssub.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/wcsutil.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/zcompress.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/lib/zuncompress.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/adler32.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/crc32.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/deflate.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/infback.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/inffast.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/inflate.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/inftrees.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/trees.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/uncompr.o /tmp/tmpuxfbxzc5.build-temp/cextern/cfitsio/zlib/zutil.o -o /tmp/tmpujfsnppr.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.ascii.cparser' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io/ascii
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/io/ascii/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/cparser.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/io/ascii/cparser.o
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/io/ascii/cparser.c:610:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/src/tokenizer.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/io/ascii/src/tokenizer.o
  astropy/io/ascii/src/tokenizer.c: In function â€˜pushâ€™:
  astropy/io/ascii/src/tokenizer.c:124:54: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    124 |     if (self->col_ptrs[col] - self->output_cols[col] >=
        |                                                      ^~
  astropy/io/ascii/src/tokenizer.c: In function â€˜tokenizeâ€™:
  astropy/io/ascii/src/tokenizer.c:424:42: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    424 |                     if (self->source_pos == -1
        |                                          ^~
  astropy/io/ascii/src/tokenizer.c:360:9: warning: enumeration value â€˜QUOTED_FIELD_NEWLINEâ€™ not handled in switch [-Wswitch]
    360 |         switch (self->state)
        |         ^~~~~~
  creating /tmp/tmpujfsnppr.build-lib/astropy/io/ascii
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/io/ascii/cparser.o /tmp/tmpuxfbxzc5.build-temp/astropy/io/ascii/src/tokenizer.o -o /tmp/tmpujfsnppr.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._stats' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/stats/_stats.c -o /tmp/tmpuxfbxzc5.build-temp/./astropy/stats/_stats.o
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/stats/_stats.c:611:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/./astropy/stats/_stats.o -o /tmp/tmpujfsnppr.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so
  building 'astropy.cosmology.scalar_inv_efuncs' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/cosmology
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/cosmology/scalar_inv_efuncs.c -o /tmp/tmpuxfbxzc5.build-temp/./astropy/cosmology/scalar_inv_efuncs.o
  ./astropy/cosmology/scalar_inv_efuncs.c: In function â€˜__pyx_f_7astropy_9cosmology_17scalar_inv_efuncs_nufuncâ€™:
  ./astropy/cosmology/scalar_inv_efuncs.c:6281:33: warning: comparison of integer expressions of different signedness: â€˜unsigned intâ€™ and â€˜intâ€™ [-Wsign-compare]
   6281 |   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
        |                                 ^
  creating /tmp/tmpujfsnppr.build-lib/astropy/cosmology
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/./astropy/cosmology/scalar_inv_efuncs.o -o /tmp/tmpujfsnppr.build-lib/astropy/cosmology/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.lombscargle.implementations.cython_impl' extension
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpuxfbxzc5.build-temp/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c -o /tmp/tmpuxfbxzc5.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o
  In file included from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c:610:
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o -o /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._utils' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/io/fits/_utils.c -o /tmp/tmpuxfbxzc5.build-temp/./astropy/io/fits/_utils.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/./astropy/io/fits/_utils.o -o /tmp/tmpujfsnppr.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.compiler_version' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/_compiler.c -o /tmp/tmpuxfbxzc5.build-temp/astropy/_compiler.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpuxfbxzc5.build-temp/astropy/_compiler.o -o /tmp/tmpujfsnppr.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so
  copying /tmp/tmpujfsnppr.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmpujfsnppr.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmpujfsnppr.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so -> astropy/utils
  copying /tmp/tmpujfsnppr.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmpujfsnppr.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so -> astropy/convolution
  copying /tmp/tmpujfsnppr.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so -> astropy/time
  copying /tmp/tmpujfsnppr.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so -> astropy/wcs
  copying /tmp/tmpujfsnppr.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -> astropy/utils/xml
  copying /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/bls
  copying /tmp/tmpujfsnppr.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so -> astropy/io/votable
  copying /tmp/tmpujfsnppr.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmpujfsnppr.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so -> astropy/io/ascii
  copying /tmp/tmpujfsnppr.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmpujfsnppr.build-lib/astropy/cosmology/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so -> astropy/cosmology
  copying /tmp/tmpujfsnppr.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/lombscargle/implementations
  copying /tmp/tmpujfsnppr.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmpujfsnppr.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so -> astropy
  Editable install will be performed using a meta path finder.

  Options like `package-data`, `include/exclude-package-data` or
  `packages.find.exclude/include` may have no effect.

  adding '__editable___astropy_5_1_dev623_gd16bfe05a_d20251221_finder.py'
  adding '__editable__.astropy-5.1.dev623+gd16bfe05a.d20251221.pth'
  creating '/tmp/pip-wheel-5l7jn4sp/.tmp-9hwpu739/astropy-5.1.dev623+gd16bfe05a.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' and adding '/tmp/tmp9achwwllastropy-5.1.dev623+gd16bfe05a.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' to it
  adding 'astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/LICENSE.rst'
  adding 'astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/METADATA'
  adding 'astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/WHEEL'
  adding 'astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/entry_points.txt'
  adding 'astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/top_level.txt'
  adding 'astropy-5.1.dev623+gd16bfe05a.d20251221.dist-info/RECORD'
  /tmp/pip-build-env-4liwoghd/overlay/lib/python3.9/site-packages/setuptools/command/editable_wheel.py:348: InformationOnly: Editable installation.
  !!

          ********************************************************************************
          Please be careful with folders in your working directory with the same
          name as your package as they may take precedence during imports.
          ********************************************************************************

  !!
    wheel_obj.write_files(unpacked)
  Building editable for astropy (pyproject.toml) ... [?25l[?25hdone
  Created wheel for astropy: filename=astropy-5.1.dev623+gd16bfe05a.d20251221-0.editable-cp39-cp39-linux_x86_64.whl size=6759 sha256=d57d9481bbcc6ba66f6e6e0d7a55b061abd0f30a9fee5d7a7c72479dbe416861
  Stored in directory: /tmp/pip-ephem-wheel-cache-pm37ipcl/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built astropy
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 5.1.dev623+gd16bfe05a7.d20241024
    Uninstalling astropy-5.1.dev623+gd16bfe05a7.d20241024:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Successfully uninstalled astropy-5.1.dev623+gd16bfe05a7.d20241024
  changing mode of /opt/miniconda3/envs/testbed/bin/fits2bitmap to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitscheck to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsdiff to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsheader to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsinfo to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/samp_hub to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/showtable to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/volint to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/wcslint to 755
Successfully installed astropy-5.1.dev623+gd16bfe05a.d20251221
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-12-21 08:04:03,759 - thread-130546493556416.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Retrieving focal code context via external CRA
2025-12-21 08:09:18,620 - thread-130546493556416.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Focal code context retrieved: 8 items
2025-12-21 08:09:18,622 - thread-130546493556416.app.lang_graph.nodes.test_case_retrieval_node - INFO - Retrieving test case context via external CRA
2025-12-21 08:12:05,847 - thread-130546493556416.app.lang_graph.nodes.test_case_retrieval_node - INFO - Test case context retrieved: 2 items
2025-12-21 08:12:05,856 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nModeling\'s `separability_matrix` does not compute separability correctly for nested CompoundModels\n\nIssue description: \nConsider the following model:\n\n```python\nfrom astropy.modeling import models as m\nfrom astropy.modeling.separable import separability_matrix\n\ncm = m.Linear1D(10) & m.Linear1D(5)\n```\n\nIt\'s separability matrix as you might expect is a diagonal:\n\n```python\n>>> separability_matrix(cm)\narray([[ True, False],\n       [False,  True]])\n```\n\nIf I make the model more complex:\n```python\n>>> separability_matrix(m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5))\narray([[ True,  True, False, False],\n       [ True,  True, False, False],\n       [False, False,  True, False],\n       [False, False, False,  True]])\n```\n\nThe output matrix is again, as expected, the outputs and inputs to the linear models are separable and independent of each other.\n\nIf however, I nest these compound models:\n```python\n>>> separability_matrix(m.Pix2Sky_TAN() & cm)\narray([[ True,  True, False, False],\n       [ True,  True, False, False],\n       [False, False,  True,  True],\n       [False, False,  True,  True]])\n```\nSuddenly the inputs and outputs are no longer separable?\n\nThis feels like a bug to me, but I might be missing something?\n\nIssue comments:\n\n\nPatch Information:\n```diff\ndiff --git a/astropy/modeling/separable.py b/astropy/modeling/separable.py\nindex a308e27297..45bea36085 100644\n--- a/astropy/modeling/separable.py\n+++ b/astropy/modeling/separable.py\n@@ -242,7 +242,7 @@ def _cstack(left, right):\n         cright = _coord_matrix(right, \'right\', noutp)\n     else:\n         cright = np.zeros((noutp, right.shape[1]))\n-        cright[-right.shape[0]:, -right.shape[1]:] = 1\n+        cright[-right.shape[0]:, -right.shape[1]:] = right\n \n     return np.hstack([cleft, cright])\n \n\n```\n\nFocal Code Context (relevant code that may need fixing):\n{\'relative_path\': \'astropy/modeling/core.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. This module defines base classes for all models.  The base class of all\\n5. models is `~astropy.modeling.Model`. `~astropy.modeling.FittableModel` is\\n6. the base class for all fittable models. Fittable models can be linear or\\n7. nonlinear in a regression analysis sense.\\n8. \\n9. All models provide a `__call__` method which performs the transformation in\\n10. a purely mathematical way, i.e. the models are unitless.  Model instances can\\n11. represent either a single model, or a "model set" representing multiple copies\\n12. of the same type of model, but with potentially different values of the\\n13. parameters in each model making up the set.\\n14. """\\n15. # pylint: disable=invalid-name, protected-access, redefined-outer-name\\n16. import abc\\n17. import copy\\n18. import inspect\\n19. import itertools\\n20. import functools\\n21. import operator\\n22. import types\\n23. \\n24. from collections import defaultdict, deque\\n25. from inspect import signature\\n26. from itertools import chain\\n27. \\n28. import numpy as np\\n29. \\n30. from astropy.utils import indent, metadata\\n31. from astropy.table import Table\\n32. from astropy.units import Quantity, UnitsError, dimensionless_unscaled\\n33. from astropy.units.utils import quantity_asanyarray\\n34. from astropy.utils import (sharedmethod, find_current_module,\\n35.                            check_broadcast, IncompatibleShapeError, isiterable)\\n36. from astropy.utils.codegen import make_function_with_signature\\n37. from astropy.nddata.utils import add_array, extract_array\\n38. from .utils import (combine_labels, make_binary_operator_eval,\\n39.                     get_inputs_and_params, _combine_equivalency_dict,\\n40.                     _ConstraintsDict, _SpecialOperatorsDict)\\n41. from .bounding_box import ModelBoundingBox, CompoundBoundingBox\\n42. from .parameters import (Parameter, InputParameterError,\\n43.                          param_repr_oneline, _tofloat)\\n44. \\n45. \\n46. __all__ = [\\\'Model\\\', \\\'FittableModel\\\', \\\'Fittable1DModel\\\', \\\'Fittable2DModel\\\',\\n47.            \\\'CompoundModel\\\', \\\'fix_inputs\\\', \\\'custom_model\\\', \\\'ModelDefinitionError\\\',\\n48.            \\\'bind_bounding_box\\\', \\\'bind_compound_bounding_box\\\']\\n49. \\n50. \\n51. def _model_oper(oper, **kwargs):\\n52.     """\\n53.     Returns a function that evaluates a given Python arithmetic operator\\n54.     between two models.  The operator should be given as a string, like ``\\\'+\\\'``\\n55.     or ``\\\'**\\\'``.\\n56.     """\\n57.     return lambda left, right: CompoundModel(oper, left, right, **kwargs)\\n58. \\n59. \\n60. class ModelDefinitionError(TypeError):\\n61.     """Used for incorrect models definitions."""\\n62. \\n63. \\n64. class _ModelMeta(abc.ABCMeta):\\n65.     """\\n66.     Metaclass for Model.\\n67. \\n68.     Currently just handles auto-generating the param_names list based on\\n69.     Parameter descriptors declared at the class-level of Model subclasses.\\n70.     """\\n71. \\n72.     _is_dynamic = False\\n73.     """\\n74.     This flag signifies whether this class was created in the "normal" way,\\n75.     with a class statement in the body of a module, as opposed to a call to\\n76.     `type` or some other metaclass constructor, such that the resulting class\\n77.     does not belong to a specific module.  This is important for pickling of\\n78.     dynamic classes.\\n79. \\n80.     This flag is always forced to False for new classes, so code that creates\\n81.     dynamic classes should manually set it to True on those classes when\\n82.     creating them.\\n83.     """\\n84. \\n85.     # Default empty dict for _parameters_, which will be empty on model\\n86.     # classes that don\\\'t have any Parameters\\n87. \\n88.     def __new__(mcls, name, bases, members, **kwds):\\n89.         # See the docstring for _is_dynamic above\\n90.         if \\\'_is_dynamic\\\' not in members:\\n91.             members[\\\'_is_dynamic\\\'] = mcls._is_dynamic\\n92.         opermethods = [\\n93.             (\\\'__add__\\\', _model_oper(\\\'+\\\')),\\n94.             (\\\'__sub__\\\', _model_oper(\\\'-\\\')),\\n95.             (\\\'__mul__\\\', _model_oper(\\\'*\\\')),\\n96.             (\\\'__truediv__\\\', _model_oper(\\\'/\\\')),\\n97.             (\\\'__pow__\\\', _model_oper(\\\'**\\\')),\\n98.             (\\\'__or__\\\', _model_oper(\\\'|\\\')),\\n99.             (\\\'__and__\\\', _model_oper(\\\'&\\\')),\\n100.             (\\\'_fix_inputs\\\', _model_oper(\\\'fix_inputs\\\'))\\n101.         ]\\n102. \\n103.         members[\\\'_parameters_\\\'] = {k: v for k, v in members.items()\\n104.                                    if isinstance(v, Parameter)}\\n105. \\n106.         for opermethod, opercall in opermethods:\\n107.             members[opermethod] = opercall\\n108.         cls = super().__new__(mcls, name, bases, members, **kwds)\\n109. \\n110.         param_names = list(members[\\\'_parameters_\\\'])\\n111. \\n112.         # Need to walk each base MRO to collect all parameter names\\n113.         for base in bases:\\n114.             for tbase in base.__mro__:\\n115.                 if issubclass(tbase, Model):\\n116.                     # Preserve order of definitions\\n117.                     param_names = list(tbase._parameters_) + param_names\\n118.         # Remove duplicates (arising from redefinition in subclass).\\n119.         param_names = list(dict.fromkeys(param_names))\\n120.         if cls._parameters_:\\n121.             if hasattr(cls, \\\'_param_names\\\'):\\n122.                 # Slight kludge to support compound models, where\\n123.                 # cls.param_names is a property; could be improved with a\\n124.                 # little refactoring but fine for now\\n125.                 cls._param_names = tuple(param_names)\\n126.             else:\\n127.                 cls.param_names = tuple(param_names)\\n128. \\n129.         return cls\\n130. \\n131.     def __init__(cls, name, bases, members, **kwds):\\n132.         super(_ModelMeta, cls).__init__(name, bases, members, **kwds)\\n133.         cls._create_inverse_property(members)\\n134.         cls._create_bounding_box_property(members)\\n135.         pdict = {}\\n136.         for base in bases:\\n137.             for tbase in base.__mro__:\\n138.                 if issubclass(tbase, Model):\\n139.                     for parname, val in cls._parameters_.items():\\n140.                         pdict[parname] = val\\n141.         cls._handle_special_methods(members, pdict)\\n142. \\n143.     def __repr__(cls):\\n144.         """\\n145.         Custom repr for Model subclasses.\\n146.         """\\n147. \\n148.         return cls._format_cls_repr()\\n149. \\n150.     def _repr_pretty_(cls, p, cycle):\\n151.         """\\n152.         Repr for IPython\\\'s pretty printer.\\n153. \\n154.         By default IPython "pretty prints" classes, so we need to implement\\n155.         this so that IPython displays the custom repr for Models.\\n156.         """\\n157. \\n158.         p.text(repr(cls))\\n159. \\n160.     def __reduce__(cls):\\n161.         if not cls._is_dynamic:\\n162.             # Just return a string specifying where the class can be imported\\n163.             # from\\n164.             return cls.__name__\\n165.         members = dict(cls.__dict__)\\n166.         # Delete any ABC-related attributes--these will be restored when\\n167.         # the class is reconstructed:\\n168.         for key in list(members):\\n169.             if key.startswith(\\\'_abc_\\\'):\\n170.                 del members[key]\\n171. \\n172.         # Delete custom __init__ and __call__ if they exist:\\n173.         for key in (\\\'__init__\\\', \\\'__call__\\\'):\\n174.             if key in members:\\n175.                 del members[key]\\n176. \\n177.         return (type(cls), (cls.__name__, cls.__bases__, members))\\n178. \\n179.     @property\\n180.     def name(cls):\\n181.         """\\n182.         The name of this model class--equivalent to ``cls.__name__``.\\n183. \\n184.         This attribute is provided for symmetry with the `Model.name` attribute\\n185.         of model instances.\\n186.         """\\n187. \\n188.         return cls.__name__\\n189. \\n190.     @property\\n191.     def _is_concrete(cls):\\n192.         """\\n193.         A class-level property that determines whether the class is a concrete\\n194.         implementation of a Model--i.e. it is not some abstract base class or\\n195.         internal implementation detail (i.e. begins with \\\'_\\\').\\n196.         """\\n197.         return not (cls.__name__.startswith(\\\'_\\\') or inspect.isabstract(cls))\\n198. \\n199.     def rename(cls, name=None, inputs=None, outputs=None):\\n200.         """\\n201.         Creates a copy of this model class with a new name, inputs or outputs.\\n202. \\n203.         The new class is technically a subclass of the original class, so that\\n204.         instance and type checks will still work.  For example::\\n205. \\n206.             >>> from astropy.modeling.models import Rotation2D\\n207.             >>> SkyRotation = Rotation2D.rename(\\\'SkyRotation\\\')\\n208.             >>> SkyRotation\\n209.             <class \\\'astropy.modeling.core.SkyRotation\\\'>\\n210.             Name: SkyRotation (Rotation2D)\\n211.             N_inputs: 2\\n212.             N_outputs: 2\\n213.             Fittable parameters: (\\\'angle\\\',)\\n214.             >>> issubclass(SkyRotation, Rotation2D)\\n215.             True\\n216.             >>> r = SkyRotation(90)\\n217.             >>> isinstance(r, Rotation2D)\\n218.             True\\n219.         """\\n220. \\n221.         mod = find_current_module(2)\\n222.         if mod:\\n223.             modname = mod.__name__\\n224.         else:\\n225.             modname = \\\'__main__\\\'\\n226. \\n227.         if name is None:\\n228.             name = cls.name\\n229.         if inputs is None:\\n230.             inputs = cls.inputs\\n231.         else:\\n232.             if not isinstance(inputs, tuple):\\n233.                 raise TypeError("Expected \\\'inputs\\\' to be a tuple of strings.")\\n234.             elif len(inputs) != len(cls.inputs):\\n235.                 raise ValueError(f\\\'{cls.name} expects {len(cls.inputs)} inputs\\\')\\n236.         if outputs is None:\\n237.             outputs = cls.outputs\\n238.         else:\\n239.             if not isinstance(outputs, tuple):\\n240.                 raise TypeError("Expected \\\'outputs\\\' to be a tuple of strings.")\\n241.             elif len(outputs) != len(cls.outputs):\\n242.                 raise ValueError(f\\\'{cls.name} expects {len(cls.outputs)} outputs\\\')\\n243.         new_cls = type(name, (cls,), {"inputs": inputs, "outputs": outputs})\\n244.         new_cls.__module__ = modname\\n245.         new_cls.__qualname__ = name\\n246. \\n247.         return new_cls\\n248. \\n249.     def _create_inverse_property(cls, members):\\n250.         inverse = members.get(\\\'inverse\\\')\\n251.         if inverse is None or cls.__bases__[0] is object:\\n252.             # The latter clause is the prevent the below code from running on\\n253.             # the Model base class, which implements the default getter and\\n254.             # setter for .inverse\\n255.             return\\n256. \\n257.         if isinstance(inverse, property):\\n258.             # We allow the @property decorator to be omitted entirely from\\n259.             # the class definition, though its use should be encouraged for\\n260.             # clarity\\n261.             inverse = inverse.fget\\n262. \\n263.         # Store the inverse getter internally, then delete the given .inverse\\n264.         # attribute so that cls.inverse resolves to Model.inverse instead\\n265.         cls._inverse = inverse\\n266.         del cls.inverse\\n267. \\n268.     def _create_bounding_box_property(cls, members):\\n269.         """\\n270.         Takes any bounding_box defined on a concrete Model subclass (either\\n271.         as a fixed tuple or a property or method) and wraps it in the generic\\n272.         getter/setter interface for the bounding_box attribute.\\n273.         """\\n274. \\n275.         # TODO: Much of this is verbatim from _create_inverse_property--I feel\\n276.         # like there could be a way to generify properties that work this way,\\n277.         # but for the time being that would probably only confuse things more.\\n278.         bounding_box = members.get(\\\'bounding_box\\\')\\n279.         if bounding_box is None or cls.__bases__[0] is object:\\n280.             return\\n281. \\n282.         if isinstance(bounding_box, property):\\n283.             bounding_box = bounding_box.fget\\n284. \\n285.         if not callable(bounding_box):\\n286.             # See if it\\\'s a hard-coded bounding_box (as a sequence) and\\n287.             # normalize it\\n288.             try:\\n289.                 bounding_box = ModelBoundingBox.validate(cls, bounding_box, _preserve_ignore=True)\\n290.             except ValueError as exc:\\n291.                 raise ModelDefinitionError(exc.args[0])\\n292.         else:\\n293.             sig = signature(bounding_box)\\n294.             # May be a method that only takes \\\'self\\\' as an argument (like a\\n295.             # property, but the @property decorator was forgotten)\\n296.             #\\n297.             # However, if the method takes additional arguments then this is a\\n298.             # parameterized bounding box and should be callable\\n299.             if len(sig.parameters) > 1:\\n300.                 bounding_box = \\\\\\n301.                         cls._create_bounding_box_subclass(bounding_box, sig)\\n302. \\n303.         # See the Model.bounding_box getter definition for how this attribute\\n304.         # is used\\n305.         cls._bounding_box = bounding_box\\n306.         del cls.bounding_box\\n307. \\n308.     def _create_bounding_box_subclass(cls, func, sig):\\n309.         """\\n310.         For Models that take optional arguments for defining their bounding\\n311.         box, we create a subclass of ModelBoundingBox with a ``__call__`` method\\n312.         that supports those additional arguments.\\n313. \\n314.         Takes the function\\\'s Signature as an argument since that is already\\n315.         computed in _create_bounding_box_property, so no need to duplicate that\\n316.         effort.\\n317.         """\\n318. \\n319.         # TODO: Might be convenient if calling the bounding box also\\n320.         # automatically sets the _user_bounding_box.  So that\\n321.         #\\n322.         #    >>> model.bounding_box(arg=1)\\n323.         #\\n324.         # in addition to returning the computed bbox, also sets it, so that\\n325.         # it\\\'s a shortcut for\\n326.         #\\n327.         #    >>> model.bounding_box = model.bounding_box(arg=1)\\n328.         #\\n329.         # Not sure if that would be non-obvious / confusing though...\\n330. \\n331.         def __call__(self, **kwargs):\\n332.             return func(self._model, **kwargs)\\n333. \\n334.         kwargs = []\\n335.         for idx, param in enumerate(sig.parameters.values()):\\n336.             if idx == 0:\\n337.                 # Presumed to be a \\\'self\\\' argument\\n338.                 continue\\n339. \\n340.             if param.default is param.empty:\\n341.                 raise ModelDefinitionError(\\n342.                     \\\'The bounding_box method for {0} is not correctly \\\'\\n343.                     \\\'defined: If defined as a method all arguments to that \\\'\\n344.                     \\\'method (besides self) must be keyword arguments with \\\'\\n345.                     \\\'default values that can be used to compute a default \\\'\\n346.                     \\\'bounding box.\\\'.format(cls.name))\\n347. \\n348.             kwargs.append((param.name, param.default))\\n349. \\n350.         __call__.__signature__ = sig\\n351. \\n352.         return type(f\\\'{cls.name}ModelBoundingBox\\\', (ModelBoundingBox,),\\n353.                     {\\\'__call__\\\': __call__})\\n354. \\n355.     def _handle_special_methods(cls, members, pdict):\\n356. \\n357.         # Handle init creation from inputs\\n358.         def update_wrapper(wrapper, cls):\\n359.             # Set up the new __call__\\\'s metadata attributes as though it were\\n360.             # manually defined in the class definition\\n361.             # A bit like functools.update_wrapper but uses the class instead of\\n362.             # the wrapped function\\n363.             wrapper.__module__ = cls.__module__\\n364.             wrapper.__doc__ = getattr(cls, wrapper.__name__).__doc__\\n365.             if hasattr(cls, \\\'__qualname__\\\'):\\n366.                 wrapper.__qualname__ = f\\\'{cls.__qualname__}.{wrapper.__name__}\\\'\\n367. \\n368.         if (\\\'__call__\\\' not in members and \\\'n_inputs\\\' in members and\\n369.                 isinstance(members[\\\'n_inputs\\\'], int) and members[\\\'n_inputs\\\'] > 0):\\n370. \\n371.             # Don\\\'t create a custom __call__ for classes that already have one\\n372.             # explicitly defined (this includes the Model base class, and any\\n373.             # other classes that manually override __call__\\n374. \\n375.             def __call__(self, *inputs, **kwargs):\\n376.                 """Evaluate this model on the supplied inputs."""\\n377.                 return super(cls, self).__call__(*inputs, **kwargs)\\n378. \\n379.             # When called, models can take two optional keyword arguments:\\n380.             #\\n381.             # * model_set_axis, which indicates (for multi-dimensional input)\\n382.             #   which axis is used to indicate different models\\n383.             #\\n384.             # * equivalencies, a dictionary of equivalencies to be applied to\\n385.             #   the input values, where each key should correspond to one of\\n386.             #   the inputs.\\n387.             #\\n388.             # The following code creates the __call__ function with these\\n389.             # two keyword arguments.\\n390. \\n391.             args = (\\\'self\\\',)\\n392.             kwargs = dict([(\\\'model_set_axis\\\', None),\\n393.                            (\\\'with_bounding_box\\\', False),\\n394.                            (\\\'fill_value\\\', np.nan),\\n395.                            (\\\'equivalencies\\\', None),\\n396.                            (\\\'inputs_map\\\', None)])\\n397. \\n398.             new_call = make_function_with_signature(\\n399.                 __call__, args, kwargs, varargs=\\\'inputs\\\', varkwargs=\\\'new_inputs\\\')\\n400. \\n401.             # The following makes it look like __call__\\n402.             # was defined in the class\\n403.             update_wrapper(new_call, cls)\\n404. \\n405.             cls.__call__ = new_call\\n406. \\n407.         if (\\\'__init__\\\' not in members and not inspect.isabstract(cls) and\\n408.                 cls._parameters_):\\n409.             # Build list of all parameters including inherited ones\\n410. \\n411.             # If *all* the parameters have default values we can make them\\n412.             # keyword arguments; otherwise they must all be positional\\n413.             # arguments\\n414.             if all(p.default is not None for p in pdict.values()):\\n415.                 args = (\\\'self\\\',)\\n416.                 kwargs = []\\n417.                 for param_name, param_val in pdict.items():\\n418.                     default = param_val.default\\n419.                     unit = param_val.unit\\n420.                     # If the unit was specified in the parameter but the\\n421.                     # default is not a Quantity, attach the unit to the\\n422.                     # default.\\n423.                     if unit is not None:\\n424.                         default = Quantity(default, unit, copy=False)\\n425.                     kwargs.append((param_name, default))\\n426.             else:\\n427.                 args = (\\\'self\\\',) + tuple(pdict.keys())\\n428.                 kwargs = {}\\n429. \\n430.             def __init__(self, *params, **kwargs):\\n431.                 return super(cls, self).__init__(*params, **kwargs)\\n432. \\n433.             new_init = make_function_with_signature(\\n434.                 __init__, args, kwargs, varkwargs=\\\'kwargs\\\')\\n435.             update_wrapper(new_init, cls)\\n436.             cls.__init__ = new_init\\n437. \\n438.     # *** Arithmetic operators for creating compound models ***\\n439.     __add__ = _model_oper(\\\'+\\\')\\n440.     __sub__ = _model_oper(\\\'-\\\')\\n441.     __mul__ = _model_oper(\\\'*\\\')\\n442.     __truediv__ = _model_oper(\\\'/\\\')\\n443.     __pow__ = _model_oper(\\\'**\\\')\\n444.     __or__ = _model_oper(\\\'|\\\')\\n445.     __and__ = _model_oper(\\\'&\\\')\\n446.     _fix_inputs = _model_oper(\\\'fix_inputs\\\')\\n447. \\n448.     # *** Other utilities ***\\n449. \\n450.     def _format_cls_repr(cls, keywords=[]):\\n451.         """\\n452.         Internal implementation of ``__repr__``.\\n453. \\n454.         This is separated out for ease of use by subclasses that wish to\\n455.         override the default ``__repr__`` while keeping the same basic\\n456.         formatting.\\n457.         """\\n458. \\n459.         # For the sake of familiarity start the output with the standard class\\n460.         # __repr__\\n461.         parts = [super().__repr__()]\\n462. \\n463.         if not cls._is_concrete:\\n464.             return parts[0]\\n465. \\n466.         def format_inheritance(cls):\\n467.             bases = []\\n468.             for base in cls.mro()[1:]:\\n469.                 if not issubclass(base, Model):\\n470.                     continue\\n471.                 elif (inspect.isabstract(base) or\\n472.                       base.__name__.startswith(\\\'_\\\')):\\n473.                     break\\n474.                 bases.append(base.name)\\n475.             if bases:\\n476.                 return f"{cls.name} ({\\\' -> \\\'.join(bases)})"\\n477.             return cls.name\\n478. \\n479.         try:\\n480.             default_keywords = [\\n481.                 (\\\'Name\\\', format_inheritance(cls)),\\n482.                 (\\\'N_inputs\\\', cls.n_inputs),\\n483.                 (\\\'N_outputs\\\', cls.n_outputs),\\n484.             ]\\n485. \\n486.             if cls.param_names:\\n487.                 default_keywords.append((\\\'Fittable parameters\\\',\\n488.                                          cls.param_names))\\n489. \\n490.             for keyword, value in default_keywords + keywords:\\n491.                 if value is not None:\\n492.                     parts.append(f\\\'{keyword}: {value}\\\')\\n493. \\n494.             return \\\'\\\\n\\\'.join(parts)\\n495.         except Exception:\\n496.             # If any of the above formatting fails fall back on the basic repr\\n497.             # (this is particularly useful in debugging)\\n498.             return parts[0]\\n499. \\n500. \', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/modeling/core.py\', \'content\': \'501. class Model(metaclass=_ModelMeta):\\n502.     """\\n503.     Base class for all models.\\n504. \\n505.     This is an abstract class and should not be instantiated directly.\\n506. \\n507.     The following initialization arguments apply to the majority of Model\\n508.     subclasses by default (exceptions include specialized utility models\\n509.     like `~astropy.modeling.mappings.Mapping`).  Parametric models take all\\n510.     their parameters as arguments, followed by any of the following optional\\n511.     keyword arguments:\\n512. \\n513.     Parameters\\n514.     ----------\\n515.     name : str, optional\\n516.         A human-friendly name associated with this model instance\\n517.         (particularly useful for identifying the individual components of a\\n518.         compound model).\\n519. \\n520.     meta : dict, optional\\n521.         An optional dict of user-defined metadata to attach to this model.\\n522.         How this is used and interpreted is up to the user or individual use\\n523.         case.\\n524. \\n525.     n_models : int, optional\\n526.         If given an integer greater than 1, a *model set* is instantiated\\n527.         instead of a single model.  This affects how the parameter arguments\\n528.         are interpreted.  In this case each parameter must be given as a list\\n529.         or array--elements of this array are taken along the first axis (or\\n530.         ``model_set_axis`` if specified), such that the Nth element is the\\n531.         value of that parameter for the Nth model in the set.\\n532. \\n533.         See the section on model sets in the documentation for more details.\\n534. \\n535.     model_set_axis : int, optional\\n536.         This argument only applies when creating a model set (i.e. ``n_models >\\n537.         1``).  It changes how parameter values are interpreted.  Normally the\\n538.         first axis of each input parameter array (properly the 0th axis) is\\n539.         taken as the axis corresponding to the model sets.  However, any axis\\n540.         of an input array may be taken as this "model set axis".  This accepts\\n541.         negative integers as well--for example use ``model_set_axis=-1`` if the\\n542.         last (most rapidly changing) axis should be associated with the model\\n543.         sets. Also, ``model_set_axis=False`` can be used to tell that a given\\n544.         input should be used to evaluate all the models in the model set.\\n545. \\n546.     fixed : dict, optional\\n547.         Dictionary ``{parameter_name: bool}`` setting the fixed constraint\\n548.         for one or more parameters.  `True` means the parameter is held fixed\\n549.         during fitting and is prevented from updates once an instance of the\\n550.         model has been created.\\n551. \\n552.         Alternatively the `~astropy.modeling.Parameter.fixed` property of a\\n553.         parameter may be used to lock or unlock individual parameters.\\n554. \\n555.     tied : dict, optional\\n556.         Dictionary ``{parameter_name: callable}`` of parameters which are\\n557.         linked to some other parameter. The dictionary values are callables\\n558.         providing the linking relationship.\\n559. \\n560.         Alternatively the `~astropy.modeling.Parameter.tied` property of a\\n561.         parameter may be used to set the ``tied`` constraint on individual\\n562.         parameters.\\n563. \\n564.     bounds : dict, optional\\n565.         A dictionary ``{parameter_name: value}`` of lower and upper bounds of\\n566.         parameters. Keys are parameter names. Values are a list or a tuple\\n567.         of length 2 giving the desired range for the parameter.\\n568. \\n569.         Alternatively the `~astropy.modeling.Parameter.min` and\\n570.         `~astropy.modeling.Parameter.max` or\\n571.         ~astropy.modeling.Parameter.bounds` properties of a parameter may be\\n572.         used to set bounds on individual parameters.\\n573. \\n574.     eqcons : list, optional\\n575.         List of functions of length n such that ``eqcons[j](x0, *args) == 0.0``\\n576.         in a successfully optimized problem.\\n577. \\n578.     ineqcons : list, optional\\n579.         List of functions of length n such that ``ieqcons[j](x0, *args) >=\\n580.         0.0`` is a successfully optimized problem.\\n581. \\n582.     Examples\\n583.     --------\\n584.     >>> from astropy.modeling import models\\n585.     >>> def tie_center(model):\\n586.     ...         mean = 50 * model.stddev\\n587.     ...         return mean\\n588.     >>> tied_parameters = {\\\'mean\\\': tie_center}\\n589. \\n590.     Specify that ``\\\'mean\\\'`` is a tied parameter in one of two ways:\\n591. \\n592.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3,\\n593.     ...                        tied=tied_parameters)\\n594. \\n595.     or\\n596. \\n597.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3)\\n598.     >>> g1.mean.tied\\n599.     False\\n600.     >>> g1.mean.tied = tie_center\\n601.     >>> g1.mean.tied\\n602.     <function tie_center at 0x...>\\n603. \\n604.     Fixed parameters:\\n605. \\n606.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3,\\n607.     ...                        fixed={\\\'stddev\\\': True})\\n608.     >>> g1.stddev.fixed\\n609.     True\\n610. \\n611.     or\\n612. \\n613.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3)\\n614.     >>> g1.stddev.fixed\\n615.     False\\n616.     >>> g1.stddev.fixed = True\\n617.     >>> g1.stddev.fixed\\n618.     True\\n619.     """\\n620. \\n621.     parameter_constraints = Parameter.constraints\\n622.     """\\n623.     Primarily for informational purposes, these are the types of constraints\\n624.     that can be set on a model\\\'s parameters.\\n625.     """\\n626. \\n627.     model_constraints = (\\\'eqcons\\\', \\\'ineqcons\\\')\\n628.     """\\n629.     Primarily for informational purposes, these are the types of constraints\\n630.     that constrain model evaluation.\\n631.     """\\n632. \\n633.     param_names = ()\\n634.     """\\n635.     Names of the parameters that describe models of this type.\\n636. \\n637.     The parameters in this tuple are in the same order they should be passed in\\n638.     when initializing a model of a specific type.  Some types of models, such\\n639.     as polynomial models, have a different number of parameters depending on\\n640.     some other property of the model, such as the degree.\\n641. \\n642.     When defining a custom model class the value of this attribute is\\n643.     automatically set by the `~astropy.modeling.Parameter` attributes defined\\n644.     in the class body.\\n645.     """\\n646. \\n647.     n_inputs = 0\\n648.     """The number of inputs."""\\n649.     n_outputs = 0\\n650.     """ The number of outputs."""\\n651. \\n652.     standard_broadcasting = True\\n653.     fittable = False\\n654.     linear = True\\n655.     _separable = None\\n656.     """ A boolean flag to indicate whether a model is separable."""\\n657.     meta = metadata.MetaData()\\n658.     """A dict-like object to store optional information."""\\n659. \\n660.     # By default models either use their own inverse property or have no\\n661.     # inverse at all, but users may also assign a custom inverse to a model,\\n662.     # optionally; in that case it is of course up to the user to determine\\n663.     # whether their inverse is *actually* an inverse to the model they assign\\n664.     # it to.\\n665.     _inverse = None\\n666.     _user_inverse = None\\n667. \\n668.     _bounding_box = None\\n669.     _user_bounding_box = None\\n670. \\n671.     _has_inverse_bounding_box = False\\n672. \\n673.     # Default n_models attribute, so that __len__ is still defined even when a\\n674.     # model hasn\\\'t completed initialization yet\\n675.     _n_models = 1\\n676. \\n677.     # New classes can set this as a boolean value.\\n678.     # It is converted to a dictionary mapping input name to a boolean value.\\n679.     _input_units_strict = False\\n680. \\n681.     # Allow dimensionless input (and corresponding output). If this is True,\\n682.     # input values to evaluate will gain the units specified in input_units. If\\n683.     # this is a dictionary then it should map input name to a bool to allow\\n684.     # dimensionless numbers for that input.\\n685.     # Only has an effect if input_units is defined.\\n686.     _input_units_allow_dimensionless = False\\n687. \\n688.     # Default equivalencies to apply to input values. If set, this should be a\\n689.     # dictionary where each key is a string that corresponds to one of the\\n690.     # model inputs. Only has an effect if input_units is defined.\\n691.     input_units_equivalencies = None\\n692. \\n693.     # Covariance matrix can be set by fitter if available.\\n694.     # If cov_matrix is available, then std will set as well\\n695.     _cov_matrix = None\\n696.     _stds = None\\n697. \\n698.     def __init_subclass__(cls, **kwargs):\\n699.         super().__init_subclass__()\\n700. \\n701.     def __init__(self, *args, meta=None, name=None, **kwargs):\\n702.         super().__init__()\\n703.         self._default_inputs_outputs()\\n704.         if meta is not None:\\n705.             self.meta = meta\\n706.         self._name = name\\n707.         # add parameters to instance level by walking MRO list\\n708.         mro = self.__class__.__mro__\\n709.         for cls in mro:\\n710.             if issubclass(cls, Model):\\n711.                 for parname, val in cls._parameters_.items():\\n712.                     newpar = copy.deepcopy(val)\\n713.                     newpar.model = self\\n714.                     if parname not in self.__dict__:\\n715.                         self.__dict__[parname] = newpar\\n716. \\n717.         self._initialize_constraints(kwargs)\\n718.         kwargs = self._initialize_setters(kwargs)\\n719.         # Remaining keyword args are either parameter values or invalid\\n720.         # Parameter values must be passed in as keyword arguments in order to\\n721.         # distinguish them\\n722.         self._initialize_parameters(args, kwargs)\\n723.         self._initialize_slices()\\n724.         self._initialize_unit_support()\\n725. \\n726.     def _default_inputs_outputs(self):\\n727.         if self.n_inputs == 1 and self.n_outputs == 1:\\n728.             self._inputs = ("x",)\\n729.             self._outputs = ("y",)\\n730.         elif self.n_inputs == 2 and self.n_outputs == 1:\\n731.             self._inputs = ("x", "y")\\n732.             self._outputs = ("z",)\\n733.         else:\\n734.             try:\\n735.                 self._inputs = tuple("x" + str(idx) for idx in range(self.n_inputs))\\n736.                 self._outputs = tuple("x" + str(idx) for idx in range(self.n_outputs))\\n737.             except TypeError:\\n738.                 # self.n_inputs and self.n_outputs are properties\\n739.                 # This is the case when subclasses of Model do not define\\n740.                 # ``n_inputs``, ``n_outputs``, ``inputs`` or ``outputs``.\\n741.                 self._inputs = ()\\n742.                 self._outputs = ()\\n743. \\n744.     def _initialize_setters(self, kwargs):\\n745.         """\\n746.         This exists to inject defaults for settable properties for models\\n747.         originating from `custom_model`.\\n748.         """\\n749.         if hasattr(self, \\\'_settable_properties\\\'):\\n750.             setters = {name: kwargs.pop(name, default)\\n751.                        for name, default in self._settable_properties.items()}\\n752.             for name, value in setters.items():\\n753.                 setattr(self, name, value)\\n754. \\n755.         return kwargs\\n756. \\n757.     @property\\n758.     def inputs(self):\\n759.         return self._inputs\\n760. \\n761.     @inputs.setter\\n762.     def inputs(self, val):\\n763.         if len(val) != self.n_inputs:\\n764.             raise ValueError(f"Expected {self.n_inputs} number of inputs, got {len(val)}.")\\n765.         self._inputs = val\\n766.         self._initialize_unit_support()\\n767. \\n768.     @property\\n769.     def outputs(self):\\n770.         return self._outputs\\n771. \\n772.     @outputs.setter\\n773.     def outputs(self, val):\\n774.         if len(val) != self.n_outputs:\\n775.             raise ValueError(f"Expected {self.n_outputs} number of outputs, got {len(val)}.")\\n776.         self._outputs = val\\n777. \\n778.     @property\\n779.     def n_inputs(self):\\n780.         # TODO: remove the code in the ``if`` block when support\\n781.         # for models with ``inputs`` as class variables is removed.\\n782.         if hasattr(self.__class__, \\\'n_inputs\\\') and isinstance(self.__class__.n_inputs, property):\\n783.             try:\\n784.                 return len(self.__class__.inputs)\\n785.             except TypeError:\\n786.                 try:\\n787.                     return len(self.inputs)\\n788.                 except AttributeError:\\n789.                     return 0\\n790. \\n791.         return self.__class__.n_inputs\\n792. \\n793.     @property\\n794.     def n_outputs(self):\\n795.         # TODO: remove the code in the ``if`` block when support\\n796.         # for models with ``outputs`` as class variables is removed.\\n797.         if hasattr(self.__class__, \\\'n_outputs\\\') and isinstance(self.__class__.n_outputs, property):\\n798.             try:\\n799.                 return len(self.__class__.outputs)\\n800.             except TypeError:\\n801.                 try:\\n802.                     return len(self.outputs)\\n803.                 except AttributeError:\\n804.                     return 0\\n805. \\n806.         return self.__class__.n_outputs\\n807. \\n808.     def _calculate_separability_matrix(self):\\n809.         """\\n810.         This is a hook which customises the behavior of modeling.separable.\\n811. \\n812.         This allows complex subclasses to customise the separability matrix.\\n813.         If it returns `NotImplemented` the default behavior is used.\\n814.         """\\n815.         return NotImplemented\\n816. \\n817.     def _initialize_unit_support(self):\\n818.         """\\n819.         Convert self._input_units_strict and\\n820.         self.input_units_allow_dimensionless to dictionaries\\n821.         mapping input name to a boolean value.\\n822.         """\\n823.         if isinstance(self._input_units_strict, bool):\\n824.             self._input_units_strict = {key: self._input_units_strict for\\n825.                                         key in self.inputs}\\n826. \\n827.         if isinstance(self._input_units_allow_dimensionless, bool):\\n828.             self._input_units_allow_dimensionless = {key: self._input_units_allow_dimensionless\\n829.                                                      for key in self.inputs}\\n830. \\n831.     @property\\n832.     def input_units_strict(self):\\n833.         """\\n834.         Enforce strict units on inputs to evaluate. If this is set to True,\\n835.         input values to evaluate will be in the exact units specified by\\n836.         input_units. If the input quantities are convertible to input_units,\\n837.         they are converted. If this is a dictionary then it should map input\\n838.         name to a bool to set strict input units for that parameter.\\n839.         """\\n840.         val = self._input_units_strict\\n841.         if isinstance(val, bool):\\n842.             return {key: val for key in self.inputs}\\n843.         return dict(zip(self.inputs, val.values()))\\n844. \\n845.     @property\\n846.     def input_units_allow_dimensionless(self):\\n847.         """\\n848.         Allow dimensionless input (and corresponding output). If this is True,\\n849.         input values to evaluate will gain the units specified in input_units. If\\n850.         this is a dictionary then it should map input name to a bool to allow\\n851.         dimensionless numbers for that input.\\n852.         Only has an effect if input_units is defined.\\n853.         """\\n854. \\n855.         val = self._input_units_allow_dimensionless\\n856.         if isinstance(val, bool):\\n857.             return {key: val for key in self.inputs}\\n858.         return dict(zip(self.inputs, val.values()))\\n859. \\n860.     @property\\n861.     def uses_quantity(self):\\n862.         """\\n863.         True if this model has been created with `~astropy.units.Quantity`\\n864.         objects or if there are no parameters.\\n865. \\n866.         This can be used to determine if this model should be evaluated with\\n867.         `~astropy.units.Quantity` or regular floats.\\n868.         """\\n869.         pisq = [isinstance(p, Quantity) for p in self._param_sets(units=True)]\\n870.         return (len(pisq) == 0) or any(pisq)\\n871. \\n872.     def __repr__(self):\\n873.         return self._format_repr()\\n874. \\n875.     def __str__(self):\\n876.         return self._format_str()\\n877. \\n878.     def __len__(self):\\n879.         return self._n_models\\n880. \\n881.     @staticmethod\\n882.     def _strip_ones(intup):\\n883.         return tuple(item for item in intup if item != 1)\\n884. \\n885.     def __setattr__(self, attr, value):\\n886.         if isinstance(self, CompoundModel):\\n887.             param_names = self._param_names\\n888.         param_names = self.param_names\\n889. \\n890.         if param_names is not None and attr in self.param_names:\\n891.             param = self.__dict__[attr]\\n892.             value = _tofloat(value)\\n893.             if param._validator is not None:\\n894.                 param._validator(self, value)\\n895.             # check consistency with previous shape and size\\n896.             eshape = self._param_metrics[attr][\\\'shape\\\']\\n897.             if eshape == ():\\n898.                 eshape = (1,)\\n899.             vshape = np.array(value).shape\\n900.             if vshape == ():\\n901.                 vshape = (1,)\\n902.             esize = self._param_metrics[attr][\\\'size\\\']\\n903.             if (np.size(value) != esize or\\n904.                     self._strip_ones(vshape) != self._strip_ones(eshape)):\\n905.                 raise InputParameterError(\\n906.                     "Value for parameter {0} does not match shape or size\\\\n"\\n907.                     "expected by model ({1}, {2}) vs ({3}, {4})".format(\\n908.                         attr, vshape, np.size(value), eshape, esize))\\n909.             if param.unit is None:\\n910.                 if isinstance(value, Quantity):\\n911.                     param._unit = value.unit\\n912.                     param.value = value.value\\n913.                 else:\\n914.                     param.value = value\\n915.             else:\\n916.                 if not isinstance(value, Quantity):\\n917.                     raise UnitsError(f"The \\\'{param.name}\\\' parameter should be given as a"\\n918.                                      " Quantity because it was originally "\\n919.                                      "initialized as a Quantity")\\n920.                 param._unit = value.unit\\n921.                 param.value = value.value\\n922.         else:\\n923.             if attr in [\\\'fittable\\\', \\\'linear\\\']:\\n924.                 self.__dict__[attr] = value\\n925.             else:\\n926.                 super().__setattr__(attr, value)\\n927. \\n928.     def _pre_evaluate(self, *args, **kwargs):\\n929.         """\\n930.         Model specific input setup that needs to occur prior to model evaluation\\n931.         """\\n932. \\n933.         # Broadcast inputs into common size\\n934.         inputs, broadcasted_shapes = self.prepare_inputs(*args, **kwargs)\\n935. \\n936.         # Setup actual model evaluation method\\n937.         parameters = self._param_sets(raw=True, units=True)\\n938. \\n939.         def evaluate(_inputs):\\n940.             return self.evaluate(*chain(_inputs, parameters))\\n941. \\n942.         return evaluate, inputs, broadcasted_shapes, kwargs\\n943. \\n944.     def get_bounding_box(self, with_bbox=True):\\n945.         """\\n946.         Return the ``bounding_box`` of a model if it exists or ``None``\\n947.         otherwise.\\n948. \\n949.         Parameters\\n950.         ----------\\n951.         with_bbox :\\n952.             The value of the ``with_bounding_box`` keyword argument\\n953.             when calling the model. Default is `True` for usage when\\n954.             looking up the model\\\'s ``bounding_box`` without risk of error.\\n955.         """\\n956.         bbox = None\\n957. \\n958.         if not isinstance(with_bbox, bool) or with_bbox:\\n959.             try:\\n960.                 bbox = self.bounding_box\\n961.             except NotImplementedError:\\n962.                 pass\\n963. \\n964.             if isinstance(bbox, CompoundBoundingBox) and not isinstance(with_bbox, bool):\\n965.                 bbox = bbox[with_bbox]\\n966. \\n967.         return bbox\\n968. \\n969.     @property\\n970.     def _argnames(self):\\n971.         """The inputs used to determine input_shape for bounding_box evaluation"""\\n972.         return self.inputs\\n973. \\n974.     def _validate_input_shape(self, _input, idx, argnames, model_set_axis, check_model_set_axis):\\n975.         """\\n976.         Perform basic validation of a single model input\\\'s shape\\n977.             -- it has the minimum dimensions for the given model_set_axis\\n978. \\n979.         Returns the shape of the input if validation succeeds.\\n980.         """\\n981.         input_shape = np.shape(_input)\\n982.         # Ensure that the input\\\'s model_set_axis matches the model\\\'s\\n983.         # n_models\\n984.         if input_shape and check_model_set_axis:\\n985.             # Note: Scalar inputs *only* get a pass on this\\n986.             if len(input_shape) < model_set_axis + 1:\\n987.                 raise ValueError(\\n988.                     f"For model_set_axis={model_set_axis}, all inputs must be at "\\n989.                     f"least {model_set_axis + 1}-dimensional.")\\n990.             if input_shape[model_set_axis] != self._n_models:\\n991.                 try:\\n992.                     argname = argnames[idx]\\n993.                 except IndexError:\\n994.                     # the case of model.inputs = ()\\n995.                     argname = str(idx)\\n996. \\n997.                 raise ValueError(\\n998.                     f"Input argument \\\'{argname}\\\' does not have the correct "\\n999.                     f"dimensions in model_set_axis={model_set_axis} for a model set with "\\n1000.                     f"n_models={self._n_models}.")\\n1001. \\n1002.         return input_shape\\n1003. \\n1004.     def _validate_input_shapes(self, inputs, argnames, model_set_axis):\\n1005.         """\\n1006.         Perform basic validation of model inputs\\n1007.             --that they are mutually broadcastable and that they have\\n1008.             the minimum dimensions for the given model_set_axis.\\n1009. \\n1010.         If validation succeeds, returns the total shape that will result from\\n1011.         broadcasting the input arrays with each other.\\n1012.         """\\n1013. \\n1014.         check_model_set_axis = self._n_models > 1 and model_set_axis is not False\\n1015. \\n1016.         all_shapes = []\\n1017.         for idx, _input in enumerate(inputs):\\n1018.             all_shapes.append(self._validate_input_shape(_input, idx, argnames,\\n1019.                                                          model_set_axis, check_model_set_axis))\\n1020. \\n1021.         input_shape = check_broadcast(*all_shapes)\\n1022.         if input_shape is None:\\n1023.             raise ValueError(\\n1024.                 "All inputs must have identical shapes or must be scalars.")\\n1025. \\n1026.         return input_shape\\n1027. \\n1028.     def input_shape(self, inputs):\\n1029.         """Get input shape for bounding_box evaluation"""\\n1030.         return self._validate_input_shapes(inputs, self._argnames, self.model_set_axis)\\n1031. \\n1032.     def _generic_evaluate(self, evaluate, _inputs, fill_value, with_bbox):\\n1033.         """\\n1034.         Generic model evaluation routine\\n1035.             Selects and evaluates model with or without bounding_box enforcement\\n1036.         """\\n1037. \\n1038.         # Evaluate the model using the prepared evaluation method either\\n1039.         #   enforcing the bounding_box or not.\\n1040.         bbox = self.get_bounding_box(with_bbox)\\n1041.         if (not isinstance(with_bbox, bool) or with_bbox) and bbox is not None:\\n1042.             outputs = bbox.evaluate(evaluate, _inputs, fill_value)\\n1043.         else:\\n1044.             outputs = evaluate(_inputs)\\n1045.         return outputs\\n1046. \\n1047.     def _post_evaluate(self, inputs, outputs, broadcasted_shapes, with_bbox, **kwargs):\\n1048.         """\\n1049.         Model specific post evaluation processing of outputs\\n1050.         """\\n1051.         if self.get_bounding_box(with_bbox) is None and self.n_outputs == 1:\\n1052.             outputs = (outputs,)\\n1053. \\n1054.         outputs = self.prepare_outputs(broadcasted_shapes, *outputs, **kwargs)\\n1055.         outputs = self._process_output_units(inputs, outputs)\\n1056. \\n1057.         if self.n_outputs == 1:\\n1058.             return outputs[0]\\n1059.         return outputs\\n1060. \\n1061.     @property\\n1062.     def bbox_with_units(self):\\n1063.         return (not isinstance(self, CompoundModel))\\n1064. \\n1065.     def __call__(self, *args, **kwargs):\\n1066.         """\\n1067.         Evaluate this model using the given input(s) and the parameter values\\n1068.         that were specified when the model was instantiated.\\n1069.         """\\n1070.         # Turn any keyword arguments into positional arguments.\\n1071.         args, kwargs = self._get_renamed_inputs_as_positional(*args, **kwargs)\\n1072. \\n1073.         # Read model evaluation related parameters\\n1074.         with_bbox = kwargs.pop(\\\'with_bounding_box\\\', False)\\n1075.         fill_value = kwargs.pop(\\\'fill_value\\\', np.nan)\\n1076. \\n1077.         # prepare for model evaluation (overridden in CompoundModel)\\n1078.         evaluate, inputs, broadcasted_shapes, kwargs = self._pre_evaluate(*args, **kwargs)\\n1079. \\n1080.         outputs = self._generic_evaluate(evaluate, inputs,\\n1081.                                          fill_value, with_bbox)\\n1082. \\n1083.         # post-process evaluation results (overridden in CompoundModel)\\n1084.         return self._post_evaluate(inputs, outputs, broadcasted_shapes, with_bbox, **kwargs)\\n1085. \\n1086.     def _get_renamed_inputs_as_positional(self, *args, **kwargs):\\n1087.         def _keyword2positional(kwargs):\\n1088.             # Inputs were passed as keyword (not positional) arguments.\\n1089.             # Because the signature of the ``__call__`` is defined at\\n1090.             # the class level, the name of the inputs cannot be changed at\\n1091.             # the instance level and the old names are always present in the\\n1092.             # signature of the method. In order to use the new names of the\\n1093.             # inputs, the old names are taken out of ``kwargs``, the input\\n1094.             # values are sorted in the order of self.inputs and passed as\\n1095.             # positional arguments to ``__call__``.\\n1096. \\n1097.             # These are the keys that are always present as keyword arguments.\\n1098.             keys = [\\\'model_set_axis\\\', \\\'with_bounding_box\\\', \\\'fill_value\\\',\\n1099.                     \\\'equivalencies\\\', \\\'inputs_map\\\']\\n1100. \\n1101.             new_inputs = {}\\n1102.             # kwargs contain the names of the new inputs + ``keys``\\n1103.             allkeys = list(kwargs.keys())\\n1104.             # Remove the names of the new inputs from kwargs and save them\\n1105.             # to a dict ``new_inputs``.\\n1106.             for key in allkeys:\\n1107.                 if key not in keys:\\n1108.                     new_inputs[key] = kwargs[key]\\n1109.                     del kwargs[key]\\n1110.             return new_inputs, kwargs\\n1111.         n_args = len(args)\\n1112. \\n1113.         new_inputs, kwargs = _keyword2positional(kwargs)\\n1114.         n_all_args = n_args + len(new_inputs)\\n1115. \\n1116.         if n_all_args < self.n_inputs:\\n1117.             raise ValueError(f"Missing input arguments - expected {self.n_inputs}, got {n_all_args}")\\n1118.         elif n_all_args > self.n_inputs:\\n1119.             raise ValueError(f"Too many input arguments - expected {self.n_inputs}, got {n_all_args}")\\n1120.         if n_args == 0:\\n1121.             # Create positional arguments from the keyword arguments in ``new_inputs``.\\n1122.             new_args = []\\n1123.             for k in self.inputs:\\n1124.                 new_args.append(new_inputs[k])\\n1125.         elif n_args != self.n_inputs:\\n1126.             # Some inputs are passed as positional, others as keyword arguments.\\n1127.             args = list(args)\\n1128. \\n1129.             # Create positional arguments from the keyword arguments in ``new_inputs``.\\n1130.             new_args = []\\n1131.             for k in self.inputs:\\n1132.                 if k in new_inputs:\\n1133.                     new_args.append(new_inputs[k])\\n1134.                 else:\\n1135.                     new_args.append(args[0])\\n1136.                     del args[0]\\n1137.         else:\\n1138.             new_args = args\\n1139.         return new_args, kwargs\\n1140. \\n1141.     # *** Properties ***\\n1142.     @property\\n1143.     def name(self):\\n1144.         """User-provided name for this model instance."""\\n1145. \\n1146.         return self._name\\n1147. \\n1148.     @name.setter\\n1149.     def name(self, val):\\n1150.         """Assign a (new) name to this model."""\\n1151. \\n1152.         self._name = val\\n1153. \\n1154.     @property\\n1155.     def model_set_axis(self):\\n1156.         """\\n1157.         The index of the model set axis--that is the axis of a parameter array\\n1158.         that pertains to which model a parameter value pertains to--as\\n1159.         specified when the model was initialized.\\n1160. \\n1161.         See the documentation on :ref:`astropy:modeling-model-sets`\\n1162.         for more details.\\n1163.         """\\n1164. \\n1165.         return self._model_set_axis\\n1166. \\n1167.     @property\\n1168.     def param_sets(self):\\n1169.         """\\n1170.         Return parameters as a pset.\\n1171. \\n1172.         This is a list with one item per parameter set, which is an array of\\n1173.         that parameter\\\'s values across all parameter sets, with the last axis\\n1174.         associated with the parameter set.\\n1175.         """\\n1176. \\n1177.         return self._param_sets()\\n1178. \\n1179.     @property\\n1180.     def parameters(self):\\n1181.         """\\n1182.         A flattened array of all parameter values in all parameter sets.\\n1183. \\n1184.         Fittable parameters maintain this list and fitters modify it.\\n1185.         """\\n1186. \\n1187.         # Currently the sequence of a model\\\'s parameters must be contiguous\\n1188.         # within the _parameters array (which may be a view of a larger array,\\n1189.         # for example when taking a sub-expression of a compound model), so\\n1190.         # the assumption here is reliable:\\n1191.         if not self.param_names:\\n1192.             # Trivial, but not unheard of\\n1193.             return self._parameters\\n1194. \\n1195.         self._parameters_to_array()\\n1196.         start = self._param_metrics[self.param_names[0]][\\\'slice\\\'].start\\n1197.         stop = self._param_metrics[self.param_names[-1]][\\\'slice\\\'].stop\\n1198. \\n1199.         return self._parameters[start:stop]\\n1200. \\n1201.     @parameters.setter\\n1202.     def parameters(self, value):\\n1203.         """\\n1204.         Assigning to this attribute updates the parameters array rather than\\n1205.         replacing it.\\n1206.         """\\n1207. \\n1208.         if not self.param_names:\\n1209.             return\\n1210. \\n1211.         start = self._param_metrics[self.param_names[0]][\\\'slice\\\'].start\\n1212.         stop = self._param_metrics[self.param_names[-1]][\\\'slice\\\'].stop\\n1213. \\n1214.         try:\\n1215.             value = np.array(value).flatten()\\n1216.             self._parameters[start:stop] = value\\n1217.         except ValueError as e:\\n1218.             raise InputParameterError(\\n1219.                 "Input parameter values not compatible with the model "\\n1220.                 "parameters array: {0}".format(e))\\n1221.         self._array_to_parameters()\\n1222. \\n1223.     @property\\n1224.     def sync_constraints(self):\\n1225.         \\\'\\\'\\\'\\n1226.         This is a boolean property that indicates whether or not accessing constraints\\n1227.         automatically check the constituent models current values. It defaults to True\\n1228.         on creation of a model, but for fitting purposes it should be set to False\\n1229.         for performance reasons.\\n1230.         \\\'\\\'\\\'\\n1231.         if not hasattr(self, \\\'_sync_constraints\\\'):\\n1232.             self._sync_constraints = True\\n1233.         return self._sync_constraints\\n1234. \\n1235.     @sync_constraints.setter\\n1236.     def sync_constraints(self, value):\\n1237.         if not isinstance(value, bool):\\n1238.             raise ValueError(\\\'sync_constraints only accepts True or False as values\\\')\\n1239.         self._sync_constraints = value\\n1240. \\n1241.     @property\\n1242.     def fixed(self):\\n1243.         """\\n1244.         A ``dict`` mapping parameter names to their fixed constraint.\\n1245.         """\\n1246.         if not hasattr(self, \\\'_fixed\\\') or self.sync_constraints:\\n1247.             self._fixed = _ConstraintsDict(self, \\\'fixed\\\')\\n1248.         return self._fixed\\n1249. \\n1250.     @property\\n1251.     def bounds(self):\\n1252.         """\\n1253.         A ``dict`` mapping parameter names to their upper and lower bounds as\\n1254.         ``(min, max)`` tuples or ``[min, max]`` lists.\\n1255.         """\\n1256.         if not hasattr(self, \\\'_bounds\\\') or self.sync_constraints:\\n1257.             self._bounds = _ConstraintsDict(self, \\\'bounds\\\')\\n1258.         return self._bounds\\n1259. \\n1260.     @property\\n1261.     def tied(self):\\n1262.         """\\n1263.         A ``dict`` mapping parameter names to their tied constraint.\\n1264.         """\\n1265.         if not hasattr(self, \\\'_tied\\\') or self.sync_constraints:\\n1266.             self._tied = _ConstraintsDict(self, \\\'tied\\\')\\n1267.         return self._tied\\n1268. \\n1269.     @property\\n1270.     def eqcons(self):\\n1271.         """List of parameter equality constraints."""\\n1272. \\n1273.         return self._mconstraints[\\\'eqcons\\\']\\n1274. \\n1275.     @property\\n1276.     def ineqcons(self):\\n1277.         """List of parameter inequality constraints."""\\n1278. \\n1279.         return self._mconstraints[\\\'ineqcons\\\']\\n1280. \\n1281.     def has_inverse(self):\\n1282.         """\\n1283.         Returns True if the model has an analytic or user\\n1284.         inverse defined.\\n1285.         """\\n1286.         try:\\n1287.             self.inverse\\n1288.         except NotImplementedError:\\n1289.             return False\\n1290. \\n1291.         return True\\n1292. \\n1293.     @property\\n1294.     def inverse(self):\\n1295.         """\\n1296.         Returns a new `~astropy.modeling.Model` instance which performs the\\n1297.         inverse transform, if an analytic inverse is defined for this model.\\n1298. \\n1299.         Even on models that don\\\'t have an inverse defined, this property can be\\n1300.         set with a manually-defined inverse, such a pre-computed or\\n1301.         experimentally determined inverse (often given as a\\n1302.         `~astropy.modeling.polynomial.PolynomialModel`, but not by\\n1303.         requirement).\\n1304. \\n1305.         A custom inverse can be deleted with ``del model.inverse``.  In this\\n1306.         case the model\\\'s inverse is reset to its default, if a default exists\\n1307.         (otherwise the default is to raise `NotImplementedError`).\\n1308. \\n1309.         Note to authors of `~astropy.modeling.Model` subclasses:  To define an\\n1310.         inverse for a model simply override this property to return the\\n1311.         appropriate model representing the inverse.  The machinery that will\\n1312.         make the inverse manually-overridable is added automatically by the\\n1313.         base class.\\n1314.         """\\n1315.         if self._user_inverse is not None:\\n1316.             return self._user_inverse\\n1317.         elif self._inverse is not None:\\n1318.             result = self._inverse()\\n1319.             if result is not NotImplemented:\\n1320.                 if not self._has_inverse_bounding_box:\\n1321.                     result.bounding_box = None\\n1322.                 return result\\n1323. \\n1324.         raise NotImplementedError("No analytical or user-supplied inverse transform "\\n1325.                                   "has been implemented for this model.")\\n1326. \\n1327.     @inverse.setter\\n1328.     def inverse(self, value):\\n1329.         if not isinstance(value, (Model, type(None))):\\n1330.             raise ValueError(\\n1331.                 "The ``inverse`` attribute may be assigned a `Model` "\\n1332.                 "instance or `None` (where `None` explicitly forces the "\\n1333.                 "model to have no inverse.")\\n1334. \\n1335.         self._user_inverse = value\\n1336. \\n1337.     @inverse.deleter\\n1338.     def inverse(self):\\n1339.         """\\n1340.         Resets the model\\\'s inverse to its default (if one exists, otherwise\\n1341.         the model will have no inverse).\\n1342.         """\\n1343. \\n1344.         try:\\n1345.             del self._user_inverse\\n1346.         except AttributeError:\\n1347.             pass\\n1348. \\n1349.     @property\\n1350.     def has_user_inverse(self):\\n1351.         """\\n1352.         A flag indicating whether or not a custom inverse model has been\\n1353.         assigned to this model by a user, via assignment to ``model.inverse``.\\n1354.         """\\n1355.         return self._user_inverse is not None\\n1356. \\n1357.     @property\\n1358.     def bounding_box(self):\\n1359.         r"""\\n1360.         A `tuple` of length `n_inputs` defining the bounding box limits, or\\n1361.         raise `NotImplementedError` for no bounding_box.\\n1362. \\n1363.         The default limits are given by a ``bounding_box`` property or method\\n1364.         defined in the class body of a specific model.  If not defined then\\n1365.         this property just raises `NotImplementedError` by default (but may be\\n1366.         assigned a custom value by a user).  ``bounding_box`` can be set\\n1367.         manually to an array-like object of shape ``(model.n_inputs, 2)``. For\\n1368.         further usage, see :ref:`astropy:bounding-boxes`\\n1369. \\n1370.         The limits are ordered according to the `numpy` ``\\\'C\\\'`` indexing\\n1371.         convention, and are the reverse of the model input order,\\n1372.         e.g. for inputs ``(\\\'x\\\', \\\'y\\\', \\\'z\\\')``, ``bounding_box`` is defined:\\n1373. \\n1374.         * for 1D: ``(x_low, x_high)``\\n1375.         * for 2D: ``((y_low, y_high), (x_low, x_high))``\\n1376.         * for 3D: ``((z_low, z_high), (y_low, y_high), (x_low, x_high))``\\n1377. \\n1378.         Examples\\n1379.         --------\\n1380. \\n1381.         Setting the ``bounding_box`` limits for a 1D and 2D model:\\n1382. \\n1383.         >>> from astropy.modeling.models import Gaussian1D, Gaussian2D\\n1384.         >>> model_1d = Gaussian1D()\\n1385.         >>> model_2d = Gaussian2D(x_stddev=1, y_stddev=1)\\n1386.         >>> model_1d.bounding_box = (-5, 5)\\n1387.         >>> model_2d.bounding_box = ((-6, 6), (-5, 5))\\n1388. \\n1389.         Setting the bounding_box limits for a user-defined 3D `custom_model`:\\n1390. \\n1391.         >>> from astropy.modeling.models import custom_model\\n1392.         >>> def const3d(x, y, z, amp=1):\\n1393.         ...    return amp\\n1394.         ...\\n1395.         >>> Const3D = custom_model(const3d)\\n1396.         >>> model_3d = Const3D()\\n1397.         >>> model_3d.bounding_box = ((-6, 6), (-5, 5), (-4, 4))\\n1398. \\n1399.         To reset ``bounding_box`` to its default limits just delete the\\n1400.         user-defined value--this will reset it back to the default defined\\n1401.         on the class:\\n1402. \\n1403.         >>> del model_1d.bounding_box\\n1404. \\n1405.         To disable the bounding box entirely (including the default),\\n1406.         set ``bounding_box`` to `None`:\\n1407. \\n1408.         >>> model_1d.bounding_box = None\\n1409.         >>> model_1d.bounding_box  # doctest: +IGNORE_EXCEPTION_DETAIL\\n1410.         Traceback (most recent call last):\\n1411.         NotImplementedError: No bounding box is defined for this model\\n1412.         (note: the bounding box was explicitly disabled for this model;\\n1413.         use `del model.bounding_box` to restore the default bounding box,\\n1414.         if one is defined for this model).\\n1415.         """\\n1416. \\n1417.         if self._user_bounding_box is not None:\\n1418.             if self._user_bounding_box is NotImplemented:\\n1419.                 raise NotImplementedError(\\n1420.                     "No bounding box is defined for this model (note: the "\\n1421.                     "bounding box was explicitly disabled for this model; "\\n1422.                     "use `del model.bounding_box` to restore the default "\\n1423.                     "bounding box, if one is defined for this model).")\\n1424.             return self._user_bounding_box\\n1425.         elif self._bounding_box is None:\\n1426.             raise NotImplementedError(\\n1427.                 "No bounding box is defined for this model.")\\n1428.         elif isinstance(self._bounding_box, ModelBoundingBox):\\n1429.             # This typically implies a hard-coded bounding box.  This will\\n1430.             # probably be rare, but it is an option\\n1431.             return self._bounding_box\\n1432.         elif isinstance(self._bounding_box, types.MethodType):\\n1433.             return ModelBoundingBox.validate(self, self._bounding_box())\\n1434.         else:\\n1435.             # The only other allowed possibility is that it\\\'s a ModelBoundingBox\\n1436.             # subclass, so we call it with its default arguments and return an\\n1437.             # instance of it (that can be called to recompute the bounding box\\n1438.             # with any optional parameters)\\n1439.             # (In other words, in this case self._bounding_box is a *class*)\\n1440.             bounding_box = self._bounding_box((), model=self)()\\n1441.             return self._bounding_box(bounding_box, model=self)\\n1442. \\n1443.     @bounding_box.setter\\n1444.     def bounding_box(self, bounding_box):\\n1445.         """\\n1446.         Assigns the bounding box limits.\\n1447.         """\\n1448. \\n1449.         if bounding_box is None:\\n1450.             cls = None\\n1451.             # We use this to explicitly set an unimplemented bounding box (as\\n1452.             # opposed to no user bounding box defined)\\n1453.             bounding_box = NotImplemented\\n1454.         elif (isinstance(bounding_box, CompoundBoundingBox) or\\n1455.               isinstance(bounding_box, dict)):\\n1456.             cls = CompoundBoundingBox\\n1457.         elif (isinstance(self._bounding_box, type) and\\n1458.               issubclass(self._bounding_box, ModelBoundingBox)):\\n1459.             cls = self._bounding_box\\n1460.         else:\\n1461.             cls = ModelBoundingBox\\n1462. \\n1463.         if cls is not None:\\n1464.             try:\\n1465.                 bounding_box = cls.validate(self, bounding_box, _preserve_ignore=True)\\n1466.             except ValueError as exc:\\n1467.                 raise ValueError(exc.args[0])\\n1468. \\n1469.         self._user_bounding_box = bounding_box\\n1470. \\n1471.     def set_slice_args(self, *args):\\n1472.         if isinstance(self._user_bounding_box, CompoundBoundingBox):\\n1473.             self._user_bounding_box.slice_args = args\\n1474.         else:\\n1475.             raise RuntimeError(\\\'The bounding_box for this model is not compound\\\')\\n1476. \\n1477.     @bounding_box.deleter\\n1478.     def bounding_box(self):\\n1479.         self._user_bounding_box = None\\n1480. \\n1481.     @property\\n1482.     def has_user_bounding_box(self):\\n1483.         """\\n1484.         A flag indicating whether or not a custom bounding_box has been\\n1485.         assigned to this model by a user, via assignment to\\n1486.         ``model.bounding_box``.\\n1487.         """\\n1488. \\n1489.         return self._user_bounding_box is not None\\n1490. \\n1491.     @property\\n1492.     def cov_matrix(self):\\n1493.         """\\n1494.         Fitter should set covariance matrix, if available.\\n1495.         """\\n1496.         return self._cov_matrix\\n1497. \\n1498.     @cov_matrix.setter\\n1499.     def cov_matrix(self, cov):\\n1500. \\n1501.         self._cov_matrix = cov\\n1502. \\n1503.         unfix_untied_params = [p for p in self.param_names if (self.fixed[p] is False)\\n1504.                                and (self.tied[p] is False)]\\n1505.         if type(cov) == list:  # model set\\n1506.             param_stds = []\\n1507.             for c in cov:\\n1508.                 param_stds.append([np.sqrt(x) if x > 0 else None for x in np.diag(c.cov_matrix)])\\n1509.             for p, param_name in enumerate(unfix_untied_params):\\n1510.                 par = getattr(self, param_name)\\n1511.                 par.std = [item[p] for item in param_stds]\\n1512.                 setattr(self, param_name, par)\\n1513.         else:\\n1514.             param_stds = [np.sqrt(x) if x > 0 else None for x in np.diag(cov.cov_matrix)]\\n1515.             for param_name in unfix_untied_params:\\n1516.                 par = getattr(self, param_name)\\n1517.                 par.std = param_stds.pop(0)\\n1518.                 setattr(self, param_name, par)\\n1519. \\n1520.     @property\\n1521.     def stds(self):\\n1522.         """\\n1523.         Standard deviation of parameters, if covariance matrix is available.\\n1524.         """\\n1525.         return self._stds\\n1526. \\n1527.     @stds.setter\\n1528.     def stds(self, stds):\\n1529.         self._stds = stds\\n1530. \\n1531.     @property\\n1532.     def separable(self):\\n1533.         """ A flag indicating whether a model is separable."""\\n1534. \\n1535.         if self._separable is not None:\\n1536.             return self._separable\\n1537.         raise NotImplementedError(\\n1538.             \\\'The "separable" property is not defined for \\\'\\n1539.             \\\'model {}\\\'.format(self.__class__.__name__))\\n1540. \\n1541.     # *** Public methods ***\\n1542. \\n1543.     def without_units_for_data(self, **kwargs):\\n1544.         """\\n1545.         Return an instance of the model for which the parameter values have\\n1546.         been converted to the right units for the data, then the units have\\n1547.         been stripped away.\\n1548. \\n1549.         The input and output Quantity objects should be given as keyword\\n1550.         arguments.\\n1551. \\n1552.         Notes\\n1553.         -----\\n1554. \\n1555.         This method is needed in order to be able to fit models with units in\\n1556.         the parameters, since we need to temporarily strip away the units from\\n1557.         the model during the fitting (which might be done by e.g. scipy\\n1558.         functions).\\n1559. \\n1560.         The units that the parameters should be converted to are not\\n1561.         necessarily the units of the input data, but are derived from them.\\n1562.         Model subclasses that want fitting to work in the presence of\\n1563.         quantities need to define a ``_parameter_units_for_data_units`` method\\n1564.         that takes the input and output units (as two dictionaries) and\\n1565.         returns a dictionary giving the target units for each parameter.\\n1566. \\n1567.         """\\n1568.         model = self.copy()\\n1569. \\n1570.         inputs_unit = {inp: getattr(kwargs[inp], \\\'unit\\\', dimensionless_unscaled)\\n1571.                        for inp in self.inputs if kwargs[inp] is not None}\\n1572. \\n1573.         outputs_unit = {out: getattr(kwargs[out], \\\'unit\\\', dimensionless_unscaled)\\n1574.                         for out in self.outputs if kwargs[out] is not None}\\n1575.         parameter_units = self._parameter_units_for_data_units(inputs_unit,\\n1576.                                                                outputs_unit)\\n1577.         for name, unit in parameter_units.items():\\n1578.             parameter = getattr(model, name)\\n1579.             if parameter.unit is not None:\\n1580.                 parameter.value = parameter.quantity.to(unit).value\\n1581.                 parameter._set_unit(None, force=True)\\n1582. \\n1583.         if isinstance(model, CompoundModel):\\n1584.             model.strip_units_from_tree()\\n1585. \\n1586.         return model\\n1587. \\n1588.     def output_units(self, **kwargs):\\n1589.         """\\n1590.         Return a dictionary of output units for this model given a dictionary\\n1591.         of fitting inputs and outputs\\n1592. \\n1593.         The input and output Quantity objects should be given as keyword\\n1594.         arguments.\\n1595. \\n1596.         Notes\\n1597.         -----\\n1598. \\n1599.         This method is needed in order to be able to fit models with units in\\n1600.         the parameters, since we need to temporarily strip away the units from\\n1601.         the model during the fitting (which might be done by e.g. scipy\\n1602.         functions).\\n1603. \\n1604.         This method will force extra model evaluations, which maybe computationally\\n1605.         expensive. To avoid this, one can add a return_units property to the model,\\n1606.         see :ref:`astropy:models_return_units`.\\n1607.         """\\n1608.         units = self.return_units\\n1609. \\n1610.         if units is None or units == {}:\\n1611.             inputs = {inp: kwargs[inp] for inp in self.inputs}\\n1612. \\n1613.             values = self(**inputs)\\n1614.             if self.n_outputs == 1:\\n1615.                 values = (values,)\\n1616. \\n1617.             units = {out: getattr(values[index], \\\'unit\\\', dimensionless_unscaled)\\n1618.                      for index, out in enumerate(self.outputs)}\\n1619. \\n1620.         return units\\n1621. \\n1622.     def strip_units_from_tree(self):\\n1623.         for item in self._leaflist:\\n1624.             for parname in item.param_names:\\n1625.                 par = getattr(item, parname)\\n1626.                 par._set_unit(None, force=True)\\n1627. \\n1628.     def with_units_from_data(self, **kwargs):\\n1629.         """\\n1630.         Return an instance of the model which has units for which the parameter\\n1631.         values are compatible with the data units specified.\\n1632. \\n1633.         The input and output Quantity objects should be given as keyword\\n1634.         arguments.\\n1635. \\n1636.         Notes\\n1637.         -----\\n1638. \\n1639.         This method is needed in order to be able to fit models with units in\\n1640.         the parameters, since we need to temporarily strip away the units from\\n1641.         the model during the fitting (which might be done by e.g. scipy\\n1642.         functions).\\n1643. \\n1644.         The units that the parameters will gain are not necessarily the units\\n1645.         of the input data, but are derived from them. Model subclasses that\\n1646.         want fitting to work in the presence of quantities need to define a\\n1647.         ``_parameter_units_for_data_units`` method that takes the input and output\\n1648.         units (as two dictionaries) and returns a dictionary giving the target\\n1649.         units for each parameter.\\n1650.         """\\n1651.         model = self.copy()\\n1652.         inputs_unit = {inp: getattr(kwargs[inp], \\\'unit\\\', dimensionless_unscaled)\\n1653.                        for inp in self.inputs if kwargs[inp] is not None}\\n1654. \\n1655.         outputs_unit = {out: getattr(kwargs[out], \\\'unit\\\', dimensionless_unscaled)\\n1656.                         for out in self.outputs if kwargs[out] is not None}\\n1657. \\n1658.         parameter_units = self._parameter_units_for_data_units(inputs_unit,\\n1659.                                                                outputs_unit)\\n1660. \\n1661.         # We are adding units to parameters that already have a value, but we\\n1662.         # don\\\'t want to convert the parameter, just add the unit directly,\\n1663.         # hence the call to ``_set_unit``.\\n1664.         for name, unit in parameter_units.items():\\n1665.             parameter = getattr(model, name)\\n1666.             parameter._set_unit(unit, force=True)\\n1667. \\n1668.         return model\\n1669. \\n1670.     @property\\n1671.     def _has_units(self):\\n1672.         # Returns True if any of the parameters have units\\n1673.         for param in self.param_names:\\n1674.             if getattr(self, param).unit is not None:\\n1675.                 return True\\n1676.         else:\\n1677.             return False\\n1678. \\n1679.     @property\\n1680.     def _supports_unit_fitting(self):\\n1681.         # If the model has a ``_parameter_units_for_data_units`` method, this\\n1682.         # indicates that we have enough information to strip the units away\\n1683.         # and add them back after fitting, when fitting quantities\\n1684.         return hasattr(self, \\\'_parameter_units_for_data_units\\\')\\n1685. \\n1686.     @abc.abstractmethod\\n1687.     def evaluate(self, *args, **kwargs):\\n1688.         """Evaluate the model on some input variables."""\\n1689. \\n1690.     def sum_of_implicit_terms(self, *args, **kwargs):\\n1691.         """\\n1692.         Evaluate the sum of any implicit model terms on some input variables.\\n1693.         This includes any fixed terms used in evaluating a linear model that\\n1694.         do not have corresponding parameters exposed to the user. The\\n1695.         prototypical case is `astropy.modeling.functional_models.Shift`, which\\n1696.         corresponds to a function y = a + bx, where b=1 is intrinsically fixed\\n1697.         by the type of model, such that sum_of_implicit_terms(x) == x. This\\n1698.         method is needed by linear fitters to correct the dependent variable\\n1699.         for the implicit term(s) when solving for the remaining terms\\n1700.         (ie. a = y - bx).\\n1701.         """\\n1702. \\n1703.     def render(self, out=None, coords=None):\\n1704.         """\\n1705.         Evaluate a model at fixed positions, respecting the ``bounding_box``.\\n1706. \\n1707.         The key difference relative to evaluating the model directly is that\\n1708.         this method is limited to a bounding box if the `Model.bounding_box`\\n1709.         attribute is set.\\n1710. \\n1711.         Parameters\\n1712.         ----------\\n1713.         out : `numpy.ndarray`, optional\\n1714.             An array that the evaluated model will be added to.  If this is not\\n1715.             given (or given as ``None``), a new array will be created.\\n1716.         coords : array-like, optional\\n1717.             An array to be used to translate from the model\\\'s input coordinates\\n1718.             to the ``out`` array. It should have the property that\\n1719.             ``self(coords)`` yields the same shape as ``out``.  If ``out`` is\\n1720.             not specified, ``coords`` will be used to determine the shape of\\n1721.             the returned array. If this is not provided (or None), the model\\n1722.             will be evaluated on a grid determined by `Model.bounding_box`.\\n1723. \\n1724.         Returns\\n1725.         -------\\n1726.         out : `numpy.ndarray`\\n1727.             The model added to ``out`` if  ``out`` is not ``None``, or else a\\n1728.             new array from evaluating the model over ``coords``.\\n1729.             If ``out`` and ``coords`` are both `None`, the returned array is\\n1730.             limited to the `Model.bounding_box` limits. If\\n1731.             `Model.bounding_box` is `None`, ``arr`` or ``coords`` must be\\n1732.             passed.\\n1733. \\n1734.         Raises\\n1735.         ------\\n1736.         ValueError\\n1737.             If ``coords`` are not given and the the `Model.bounding_box` of\\n1738.             this model is not set.\\n1739. \\n1740.         Examples\\n1741.         --------\\n1742.         :ref:`astropy:bounding-boxes`\\n1743.         """\\n1744. \\n1745.         try:\\n1746.             bbox = self.bounding_box\\n1747.         except NotImplementedError:\\n1748.             bbox = None\\n1749. \\n1750.         if isinstance(bbox, ModelBoundingBox):\\n1751.             bbox = bbox.bounding_box()\\n1752. \\n1753.         ndim = self.n_inputs\\n1754. \\n1755.         if (coords is None) and (out is None) and (bbox is None):\\n1756.             raise ValueError(\\\'If no bounding_box is set, \\\'\\n1757.                              \\\'coords or out must be input.\\\')\\n1758. \\n1759.         # for consistent indexing\\n1760.         if ndim == 1:\\n1761.             if coords is not None:\\n1762.                 coords = [coords]\\n1763.             if bbox is not None:\\n1764.                 bbox = [bbox]\\n1765. \\n1766.         if coords is not None:\\n1767.             coords = np.asanyarray(coords, dtype=float)\\n1768.             # Check dimensions match out and model\\n1769.             assert len(coords) == ndim\\n1770.             if out is not None:\\n1771.                 if coords[0].shape != out.shape:\\n1772.                     raise ValueError(\\\'inconsistent shape of the output.\\\')\\n1773.             else:\\n1774.                 out = np.zeros(coords[0].shape)\\n1775. \\n1776.         if out is not None:\\n1777.             out = np.asanyarray(out)\\n1778.             if out.ndim != ndim:\\n1779.                 raise ValueError(\\\'the array and model must have the same \\\'\\n1780.                                  \\\'number of dimensions.\\\')\\n1781. \\n1782.         if bbox is not None:\\n1783.             # Assures position is at center pixel,\\n1784.             # important when using add_array.\\n1785.             pd = np.array([(np.mean(bb), np.ceil((bb[1] - bb[0]) / 2))\\n1786.                            for bb in bbox]).astype(int).T\\n1787.             pos, delta = pd\\n1788. \\n1789.             if coords is not None:\\n1790.                 sub_shape = tuple(delta * 2 + 1)\\n1791.                 sub_coords = np.array([extract_array(c, sub_shape, pos)\\n1792.                                        for c in coords])\\n1793.             else:\\n1794.                 limits = [slice(p - d, p + d + 1, 1) for p, d in pd.T]\\n1795.                 sub_coords = np.mgrid[limits]\\n1796. \\n1797.             sub_coords = sub_coords[::-1]\\n1798. \\n1799.             if out is None:\\n1800.                 out = self(*sub_coords)\\n1801.             else:\\n1802.                 try:\\n1803.                     out = add_array(out, self(*sub_coords), pos)\\n1804.                 except ValueError:\\n1805.                     raise ValueError(\\n1806.                         \\\'The `bounding_box` is larger than the input out in \\\'\\n1807.                         \\\'one or more dimensions. Set \\\'\\n1808.                         \\\'`model.bounding_box = None`.\\\')\\n1809.         else:\\n1810.             if coords is None:\\n1811.                 im_shape = out.shape\\n1812.                 limits = [slice(i) for i in im_shape]\\n1813.                 coords = np.mgrid[limits]\\n1814. \\n1815.             coords = coords[::-1]\\n1816. \\n1817.             out += self(*coords)\\n1818. \\n1819.         return out\\n1820. \\n1821.     @property\\n1822.     def input_units(self):\\n1823.         """\\n1824.         This property is used to indicate what units or sets of units the\\n1825.         evaluate method expects, and returns a dictionary mapping inputs to\\n1826.         units (or `None` if any units are accepted).\\n1827. \\n1828.         Model sub-classes can also use function annotations in evaluate to\\n1829.         indicate valid input units, in which case this property should\\n1830.         not be overridden since it will return the input units based on the\\n1831.         annotations.\\n1832.         """\\n1833.         if hasattr(self, \\\'_input_units\\\'):\\n1834.             return self._input_units\\n1835.         elif hasattr(self.evaluate, \\\'__annotations__\\\'):\\n1836.             annotations = self.evaluate.__annotations__.copy()\\n1837.             annotations.pop(\\\'return\\\', None)\\n1838.             if annotations:\\n1839.                 # If there are not annotations for all inputs this will error.\\n1840.                 return dict((name, annotations[name]) for name in self.inputs)\\n1841.         else:\\n1842.             # None means any unit is accepted\\n1843.             return None\\n1844. \\n1845.     @property\\n1846.     def return_units(self):\\n1847.         """\\n1848.         This property is used to indicate what units or sets of units the\\n1849.         output of evaluate should be in, and returns a dictionary mapping\\n1850.         outputs to units (or `None` if any units are accepted).\\n1851. \\n1852.         Model sub-classes can also use function annotations in evaluate to\\n1853.         indicate valid output units, in which case this property should not be\\n1854.         overridden since it will return the return units based on the\\n1855.         annotations.\\n1856.         """\\n1857.         if hasattr(self, \\\'_return_units\\\'):\\n1858.             return self._return_units\\n1859.         elif hasattr(self.evaluate, \\\'__annotations__\\\'):\\n1860.             return self.evaluate.__annotations__.get(\\\'return\\\', None)\\n1861.         else:\\n1862.             # None means any unit is accepted\\n1863.             return None\\n1864. \\n1865.     def _prepare_inputs_single_model(self, params, inputs, **kwargs):\\n1866.         broadcasts = []\\n1867.         for idx, _input in enumerate(inputs):\\n1868.             input_shape = _input.shape\\n1869. \\n1870.             # Ensure that array scalars are always upgrade to 1-D arrays for the\\n1871.             # sake of consistency with how parameters work.  They will be cast back\\n1872.             # to scalars at the end\\n1873.             if not input_shape:\\n1874.                 inputs[idx] = _input.reshape((1,))\\n1875. \\n1876.             if not params:\\n1877.                 max_broadcast = input_shape\\n1878.             else:\\n1879.                 max_broadcast = ()\\n1880. \\n1881.             for param in params:\\n1882.                 try:\\n1883.                     if self.standard_broadcasting:\\n1884.                         broadcast = check_broadcast(input_shape, param.shape)\\n1885.                     else:\\n1886.                         broadcast = input_shape\\n1887.                 except IncompatibleShapeError:\\n1888.                     raise ValueError(\\n1889.                         "self input argument {0!r} of shape {1!r} cannot be "\\n1890.                         "broadcast with parameter {2!r} of shape "\\n1891.                         "{3!r}.".format(self.inputs[idx], input_shape,\\n1892.                                         param.name, param.shape))\\n1893. \\n1894.                 if len(broadcast) > len(max_broadcast):\\n1895.                     max_broadcast = broadcast\\n1896.                 elif len(broadcast) == len(max_broadcast):\\n1897.                     max_broadcast = max(max_broadcast, broadcast)\\n1898. \\n1899.             broadcasts.append(max_broadcast)\\n1900. \\n1901.         if self.n_outputs > self.n_inputs:\\n1902.             extra_outputs = self.n_outputs - self.n_inputs\\n1903.             if not broadcasts:\\n1904.                 # If there were no inputs then the broadcasts list is empty\\n1905.                 # just add a None since there is no broadcasting of outputs and\\n1906.                 # inputs necessary (see _prepare_outputs_single_self)\\n1907.                 broadcasts.append(None)\\n1908.             broadcasts.extend([broadcasts[0]] * extra_outputs)\\n1909. \\n1910.         return inputs, (broadcasts,)\\n1911. \\n1912.     @staticmethod\\n1913.     def _remove_axes_from_shape(shape, axis):\\n1914.         """\\n1915.         Given a shape tuple as the first input, construct a new one by  removing\\n1916.         that particular axis from the shape and all preceeding axes. Negative axis\\n1917.         numbers are permittted, where the axis is relative to the last axis.\\n1918.         """\\n1919.         if len(shape) == 0:\\n1920.             return shape\\n1921.         if axis < 0:\\n1922.             axis = len(shape) + axis\\n1923.             return shape[:axis] + shape[axis+1:]\\n1924.         if axis >= len(shape):\\n1925.             axis = len(shape)-1\\n1926.         shape = shape[axis+1:]\\n1927.         return shape\\n1928. \\n1929.     def _prepare_inputs_model_set(self, params, inputs, model_set_axis_input,\\n1930.                                   **kwargs):\\n1931.         reshaped = []\\n1932.         pivots = []\\n1933. \\n1934.         model_set_axis_param = self.model_set_axis  # needed to reshape param\\n1935.         for idx, _input in enumerate(inputs):\\n1936.             max_param_shape = ()\\n1937.             if self._n_models > 1 and model_set_axis_input is not False:\\n1938.                 # Use the shape of the input *excluding* the model axis\\n1939.                 input_shape = (_input.shape[:model_set_axis_input] +\\n1940.                                _input.shape[model_set_axis_input + 1:])\\n1941.             else:\\n1942.                 input_shape = _input.shape\\n1943. \\n1944.             for param in params:\\n1945.                 try:\\n1946.                     check_broadcast(input_shape,\\n1947.                                     self._remove_axes_from_shape(param.shape,\\n1948.                                                                  model_set_axis_param))\\n1949.                 except IncompatibleShapeError:\\n1950.                     raise ValueError(\\n1951.                         "Model input argument {0!r} of shape {1!r} cannot be "\\n1952.                         "broadcast with parameter {2!r} of shape "\\n1953.                         "{3!r}.".format(self.inputs[idx], input_shape,\\n1954.                                         param.name,\\n1955.                                         self._remove_axes_from_shape(param.shape,\\n1956.                                                                      model_set_axis_param)))\\n1957. \\n1958.                 if len(param.shape) - 1 > len(max_param_shape):\\n1959.                     max_param_shape = self._remove_axes_from_shape(param.shape,\\n1960.                                                                    model_set_axis_param)\\n1961. \\n1962.             # We\\\'ve now determined that, excluding the model_set_axis, the\\n1963.             # input can broadcast with all the parameters\\n1964.             input_ndim = len(input_shape)\\n1965.             if model_set_axis_input is False:\\n1966.                 if len(max_param_shape) > input_ndim:\\n1967.                     # Just needs to prepend new axes to the input\\n1968.                     n_new_axes = 1 + len(max_param_shape) - input_ndim\\n1969.                     new_axes = (1,) * n_new_axes\\n1970.                     new_shape = new_axes + _input.shape\\n1971.                     pivot = model_set_axis_param\\n1972.                 else:\\n1973.                     pivot = input_ndim - len(max_param_shape)\\n1974.                     new_shape = (_input.shape[:pivot] + (1,) +\\n1975.                                  _input.shape[pivot:])\\n1976.                 new_input = _input.reshape(new_shape)\\n1977.             else:\\n1978.                 if len(max_param_shape) >= input_ndim:\\n1979.                     n_new_axes = len(max_param_shape) - input_ndim\\n1980.                     pivot = self.model_set_axis\\n1981.                     new_axes = (1,) * n_new_axes\\n1982.                     new_shape = (_input.shape[:pivot + 1] + new_axes +\\n1983.                                  _input.shape[pivot + 1:])\\n1984.                     new_input = _input.reshape(new_shape)\\n1985.                 else:\\n1986.                     pivot = _input.ndim - len(max_param_shape) - 1\\n1987.                     new_input = np.rollaxis(_input, model_set_axis_input,\\n1988.                                             pivot + 1)\\n1989.             pivots.append(pivot)\\n1990.             reshaped.append(new_input)\\n1991. \\n1992.         if self.n_inputs < self.n_outputs:\\n1993.             pivots.extend([model_set_axis_input] * (self.n_outputs - self.n_inputs))\\n1994. \\n1995.         return reshaped, (pivots,)\\n1996. \\n1997.     def prepare_inputs(self, *inputs, model_set_axis=None, equivalencies=None,\\n1998.                        **kwargs):\\n1999.         """\\n2000.         This method is used in `~astropy.modeling.Model.__call__` to ensure\\n2001.         that all the inputs to the model can be broadcast into compatible\\n2002.         shapes (if one or both of them are input as arrays), particularly if\\n2003.         there are more than one parameter sets. This also makes sure that (if\\n2004.         applicable) the units of the input will be compatible with the evaluate\\n2005.         method.\\n2006.         """\\n2007.         # When we instantiate the model class, we make sure that __call__ can\\n2008.         # take the following two keyword arguments: model_set_axis and\\n2009.         # equivalencies.\\n2010.         if model_set_axis is None:\\n2011.             # By default the model_set_axis for the input is assumed to be the\\n2012.             # same as that for the parameters the model was defined with\\n2013.             # TODO: Ensure that negative model_set_axis arguments are respected\\n2014.             model_set_axis = self.model_set_axis\\n2015. \\n2016.         params = [getattr(self, name) for name in self.param_names]\\n2017.         inputs = [np.asanyarray(_input, dtype=float) for _input in inputs]\\n2018. \\n2019.         self._validate_input_shapes(inputs, self.inputs, model_set_axis)\\n2020. \\n2021.         inputs_map = kwargs.get(\\\'inputs_map\\\', None)\\n2022. \\n2023.         inputs = self._validate_input_units(inputs, equivalencies, inputs_map)\\n2024. \\n2025.         # The input formatting required for single models versus a multiple\\n2026.         # model set are different enough that they\\\'ve been split into separate\\n2027.         # subroutines\\n2028.         if self._n_models == 1:\\n2029.             return self._prepare_inputs_single_model(params, inputs, **kwargs)\\n2030.         else:\\n2031.             return self._prepare_inputs_model_set(params, inputs,\\n2032.                                                   model_set_axis, **kwargs)\\n2033. \\n2034.     def _validate_input_units(self, inputs, equivalencies=None, inputs_map=None):\\n2035.         inputs = list(inputs)\\n2036.         name = self.name or self.__class__.__name__\\n2037.         # Check that the units are correct, if applicable\\n2038. \\n2039.         if self.input_units is not None:\\n2040.             # If a leaflist is provided that means this is in the context of\\n2041.             # a compound model and it is necessary to create the appropriate\\n2042.             # alias for the input coordinate name for the equivalencies dict\\n2043.             if inputs_map:\\n2044.                 edict = {}\\n2045.                 for mod, mapping in inputs_map:\\n2046.                     if self is mod:\\n2047.                         edict[mapping[0]] = equivalencies[mapping[1]]\\n2048.             else:\\n2049.                 edict = equivalencies\\n2050.             # We combine any instance-level input equivalencies with user\\n2051.             # specified ones at call-time.\\n2052.             input_units_equivalencies = _combine_equivalency_dict(self.inputs,\\n2053.                                                                   edict,\\n2054.                                                                   self.input_units_equivalencies)\\n2055. \\n2056.             # We now iterate over the different inputs and make sure that their\\n2057.             # units are consistent with those specified in input_units.\\n2058.             for i in range(len(inputs)):\\n2059. \\n2060.                 input_name = self.inputs[i]\\n2061.                 input_unit = self.input_units.get(input_name, None)\\n2062. \\n2063.                 if input_unit is None:\\n2064.                     continue\\n2065. \\n2066.                 if isinstance(inputs[i], Quantity):\\n2067. \\n2068.                     # We check for consistency of the units with input_units,\\n2069.                     # taking into account any equivalencies\\n2070. \\n2071.                     if inputs[i].unit.is_equivalent(\\n2072.                             input_unit,\\n2073.                             equivalencies=input_units_equivalencies[input_name]):\\n2074. \\n2075.                         # If equivalencies have been specified, we need to\\n2076.                         # convert the input to the input units - this is\\n2077.                         # because some equivalencies are non-linear, and\\n2078.                         # we need to be sure that we evaluate the model in\\n2079.                         # its own frame of reference. If input_units_strict\\n2080.                         # is set, we also need to convert to the input units.\\n2081.                         if len(input_units_equivalencies) > 0 or self.input_units_strict[input_name]:\\n2082.                             inputs[i] = inputs[i].to(input_unit,\\n2083.                                                      equivalencies=input_units_equivalencies[input_name])\\n2084. \\n2085.                     else:\\n2086. \\n2087.                         # We consider the following two cases separately so as\\n2088.                         # to be able to raise more appropriate/nicer exceptions\\n2089. \\n2090.                         if input_unit is dimensionless_unscaled:\\n2091.                             raise UnitsError("{0}: Units of input \\\'{1}\\\', {2} ({3}),"\\n2092.                                              "could not be converted to "\\n2093.                                              "required dimensionless "\\n2094.                                              "input".format(name,\\n2095.                                                             self.inputs[i],\\n2096.                                                             inputs[i].unit,\\n2097.                                                             inputs[i].unit.physical_type))\\n2098.                         else:\\n2099.                             raise UnitsError("{0}: Units of input \\\'{1}\\\', {2} ({3}),"\\n2100.                                              " could not be "\\n2101.                                              "converted to required input"\\n2102.                                              " units of {4} ({5})".format(\\n2103.                                                  name,\\n2104.                                                  self.inputs[i],\\n2105.                                                  inputs[i].unit,\\n2106.                                                  inputs[i].unit.physical_type,\\n2107.                                                  input_unit,\\n2108.                                                  input_unit.physical_type))\\n2109.                 else:\\n2110. \\n2111.                     # If we allow dimensionless input, we add the units to the\\n2112.                     # input values without conversion, otherwise we raise an\\n2113.                     # exception.\\n2114. \\n2115.                     if (not self.input_units_allow_dimensionless[input_name] and\\n2116.                         input_unit is not dimensionless_unscaled and\\n2117.                         input_unit is not None):\\n2118.                         if np.any(inputs[i] != 0):\\n2119.                             raise UnitsError("{0}: Units of input \\\'{1}\\\', (dimensionless), could not be "\\n2120.                                              "converted to required input units of "\\n2121.                                              "{2} ({3})".format(name, self.inputs[i], input_unit,\\n2122.                                                                 input_unit.physical_type))\\n2123.         return inputs\\n2124. \\n2125.     def _process_output_units(self, inputs, outputs):\\n2126.         inputs_are_quantity = any([isinstance(i, Quantity) for i in inputs])\\n2127.         if self.return_units and inputs_are_quantity:\\n2128.             # We allow a non-iterable unit only if there is one output\\n2129.             if self.n_outputs == 1 and not isiterable(self.return_units):\\n2130.                 return_units = {self.outputs[0]: self.return_units}\\n2131.             else:\\n2132.                 return_units = self.return_units\\n2133. \\n2134.             outputs = tuple([Quantity(out, return_units.get(out_name, None), subok=True)\\n2135.                              for out, out_name in zip(outputs, self.outputs)])\\n2136.         return outputs\\n2137. \\n2138.     @staticmethod\\n2139.     def _prepare_output_single_model(output, broadcast_shape):\\n2140.         if broadcast_shape is not None:\\n2141.             if not broadcast_shape:\\n2142.                 return output.item()\\n2143.             else:\\n2144.                 try:\\n2145.                     return output.reshape(broadcast_shape)\\n2146.                 except ValueError:\\n2147.                     try:\\n2148.                         return output.item()\\n2149.                     except ValueError:\\n2150.                         return output\\n2151. \\n2152.         return output\\n2153. \\n2154.     def _prepare_outputs_single_model(self, outputs, broadcasted_shapes):\\n2155.         outputs = list(outputs)\\n2156.         for idx, output in enumerate(outputs):\\n2157.             try:\\n2158.                 broadcast_shape = check_broadcast(*broadcasted_shapes[0])\\n2159.             except (IndexError, TypeError):\\n2160.                 broadcast_shape = broadcasted_shapes[0][idx]\\n2161. \\n2162.             outputs[idx] = self._prepare_output_single_model(output, broadcast_shape)\\n2163. \\n2164.         return tuple(outputs)\\n2165. \\n2166.     def _prepare_outputs_model_set(self, outputs, broadcasted_shapes, model_set_axis):\\n2167.         pivots = broadcasted_shapes[0]\\n2168.         # If model_set_axis = False was passed then use\\n2169.         # self._model_set_axis to format the output.\\n2170.         if model_set_axis is None or model_set_axis is False:\\n2171.             model_set_axis = self.model_set_axis\\n2172.         outputs = list(outputs)\\n2173.         for idx, output in enumerate(outputs):\\n2174.             pivot = pivots[idx]\\n2175.             if pivot < output.ndim and pivot != model_set_axis:\\n2176.                 outputs[idx] = np.rollaxis(output, pivot,\\n2177.                                            model_set_axis)\\n2178.         return tuple(outputs)\\n2179. \\n2180.     def prepare_outputs(self, broadcasted_shapes, *outputs, **kwargs):\\n2181.         model_set_axis = kwargs.get(\\\'model_set_axis\\\', None)\\n2182. \\n2183.         if len(self) == 1:\\n2184.             return self._prepare_outputs_single_model(outputs, broadcasted_shapes)\\n2185.         else:\\n2186.             return self._prepare_outputs_model_set(outputs, broadcasted_shapes, model_set_axis)\\n2187. \\n2188.     def copy(self):\\n2189.         """\\n2190.         Return a copy of this model.\\n2191. \\n2192.         Uses a deep copy so that all model attributes, including parameter\\n2193.         values, are copied as well.\\n2194.         """\\n2195. \\n2196.         return copy.deepcopy(self)\\n2197. \\n2198.     def deepcopy(self):\\n2199.         """\\n2200.         Return a deep copy of this model.\\n2201. \\n2202.         """\\n2203. \\n2204.         return self.copy()\\n2205. \\n2206.     @sharedmethod\\n2207.     def rename(self, name):\\n2208.         """\\n2209.         Return a copy of this model with a new name.\\n2210.         """\\n2211.         new_model = self.copy()\\n2212.         new_model._name = name\\n2213.         return new_model\\n2214. \\n2215.     def coerce_units(\\n2216.         self,\\n2217.         input_units=None,\\n2218.         return_units=None,\\n2219.         input_units_equivalencies=None,\\n2220.         input_units_allow_dimensionless=False\\n2221.     ):\\n2222.         """\\n2223.         Attach units to this (unitless) model.\\n2224. \\n2225.         Parameters\\n2226.         ----------\\n2227.         input_units : dict or tuple, optional\\n2228.             Input units to attach.  If dict, each key is the name of a model input,\\n2229.             and the value is the unit to attach.  If tuple, the elements are units\\n2230.             to attach in order corresponding to `Model.inputs`.\\n2231.         return_units : dict or tuple, optional\\n2232.             Output units to attach.  If dict, each key is the name of a model output,\\n2233.             and the value is the unit to attach.  If tuple, the elements are units\\n2234.             to attach in order corresponding to `Model.outputs`.\\n2235.         input_units_equivalencies : dict, optional\\n2236.             Default equivalencies to apply to input values.  If set, this should be a\\n2237.             dictionary where each key is a string that corresponds to one of the\\n2238.             model inputs.\\n2239.         input_units_allow_dimensionless : bool or dict, optional\\n2240.             Allow dimensionless input. If this is True, input values to evaluate will\\n2241.             gain the units specified in input_units. If this is a dictionary then it\\n2242.             should map input name to a bool to allow dimensionless numbers for that\\n2243.             input.\\n2244. \\n2245.         Returns\\n2246.         -------\\n2247.         `CompoundModel`\\n2248.             A `CompoundModel` composed of the current model plus\\n2249.             `~astropy.modeling.mappings.UnitsMapping` model(s) that attach the units.\\n2250. \\n2251.         Raises\\n2252.         ------\\n2253.         ValueError\\n2254.             If the current model already has units.\\n2255. \\n2256.         Examples\\n2257.         --------\\n2258. \\n2259.         Wrapping a unitless model to require and convert units:\\n2260. \\n2261.         >>> from astropy.modeling.models import Polynomial1D\\n2262.         >>> from astropy import units as u\\n2263.         >>> poly = Polynomial1D(1, c0=1, c1=2)\\n2264.         >>> model = poly.coerce_units((u.m,), (u.s,))\\n2265.         >>> model(u.Quantity(10, u.m))  # doctest: +FLOAT_CMP\\n2266.         <Quantity 21. s>\\n2267.         >>> model(u.Quantity(1000, u.cm))  # doctest: +FLOAT_CMP\\n2268.         <Quantity 21. s>\\n2269.         >>> model(u.Quantity(10, u.cm))  # doctest: +FLOAT_CMP\\n2270.         <Quantity 1.2 s>\\n2271. \\n2272.         Wrapping a unitless model but still permitting unitless input:\\n2273. \\n2274.         >>> from astropy.modeling.models import Polynomial1D\\n2275.         >>> from astropy import units as u\\n2276.         >>> poly = Polynomial1D(1, c0=1, c1=2)\\n2277.         >>> model = poly.coerce_units((u.m,), (u.s,), input_units_allow_dimensionless=True)\\n2278.         >>> model(u.Quantity(10, u.m))  # doctest: +FLOAT_CMP\\n2279.         <Quantity 21. s>\\n2280.         >>> model(10)  # doctest: +FLOAT_CMP\\n2281.         <Quantity 21. s>\\n2282.         """\\n2283.         from .mappings import UnitsMapping\\n2284. \\n2285.         result = self\\n2286. \\n2287.         if input_units is not None:\\n2288.             if self.input_units is not None:\\n2289.                 model_units = self.input_units\\n2290.             else:\\n2291.                 model_units = {}\\n2292. \\n2293.             for unit in [model_units.get(i) for i in self.inputs]:\\n2294.                 if unit is not None and unit != dimensionless_unscaled:\\n2295.                     raise ValueError("Cannot specify input_units for model with existing input units")\\n2296. \\n2297.             if isinstance(input_units, dict):\\n2298.                 if input_units.keys() != set(self.inputs):\\n2299.                     message = (\\n2300.                         f"""input_units keys ({", ".join(input_units.keys())}) """\\n2301.                         f"""do not match model inputs ({", ".join(self.inputs)})"""\\n2302.                     )\\n2303.                     raise ValueError(message)\\n2304.                 input_units = [input_units[i] for i in self.inputs]\\n2305. \\n2306.             if len(input_units) != self.n_inputs:\\n2307.                 message = (\\n2308.                     "input_units length does not match n_inputs: "\\n2309.                     f"expected {self.n_inputs}, received {len(input_units)}"\\n2310.                 )\\n2311.                 raise ValueError(message)\\n2312. \\n2313.             mapping = tuple((unit, model_units.get(i)) for i, unit in zip(self.inputs, input_units))\\n2314.             input_mapping = UnitsMapping(\\n2315.                 mapping,\\n2316.                 input_units_equivalencies=input_units_equivalencies,\\n2317.                 input_units_allow_dimensionless=input_units_allow_dimensionless\\n2318.             )\\n2319.             input_mapping.inputs = self.inputs\\n2320.             input_mapping.outputs = self.inputs\\n2321.             result = input_mapping | result\\n2322. \\n2323.         if return_units is not None:\\n2324.             if self.return_units is not None:\\n2325.                 model_units = self.return_units\\n2326.             else:\\n2327.                 model_units = {}\\n2328. \\n2329.             for unit in [model_units.get(i) for i in self.outputs]:\\n2330.                 if unit is not None and unit != dimensionless_unscaled:\\n2331.                     raise ValueError("Cannot specify return_units for model with existing output units")\\n2332. \\n2333.             if isinstance(return_units, dict):\\n2334.                 if return_units.keys() != set(self.outputs):\\n2335.                     message = (\\n2336.                         f"""return_units keys ({", ".join(return_units.keys())}) """\\n2337.                         f"""do not match model outputs ({", ".join(self.outputs)})"""\\n2338.                     )\\n2339.                     raise ValueError(message)\\n2340.                 return_units = [return_units[i] for i in self.outputs]\\n2341. \\n2342.             if len(return_units) != self.n_outputs:\\n2343.                 message = (\\n2344.                     "return_units length does not match n_outputs: "\\n2345.                     f"expected {self.n_outputs}, received {len(return_units)}"\\n2346.                 )\\n2347.                 raise ValueError(message)\\n2348. \\n2349.             mapping = tuple((model_units.get(i), unit) for i, unit in zip(self.outputs, return_units))\\n2350.             return_mapping = UnitsMapping(mapping)\\n2351.             return_mapping.inputs = self.outputs\\n2352.             return_mapping.outputs = self.outputs\\n2353.             result = result | return_mapping\\n2354. \\n2355.         return result\\n2356. \\n2357.     @property\\n2358.     def n_submodels(self):\\n2359.         """\\n2360.         Return the number of components in a single model, which is\\n2361.         obviously 1.\\n2362.         """\\n2363.         return 1\\n2364. \\n2365.     def _initialize_constraints(self, kwargs):\\n2366.         """\\n2367.         Pop parameter constraint values off the keyword arguments passed to\\n2368.         `Model.__init__` and store them in private instance attributes.\\n2369.         """\\n2370. \\n2371.         # Pop any constraints off the keyword arguments\\n2372.         for constraint in self.parameter_constraints:\\n2373.             values = kwargs.pop(constraint, {})\\n2374.             for ckey, cvalue in values.items():\\n2375.                 param = getattr(self, ckey)\\n2376.                 setattr(param, constraint, cvalue)\\n2377.         self._mconstraints = {}\\n2378.         for constraint in self.model_constraints:\\n2379.             values = kwargs.pop(constraint, [])\\n2380.             self._mconstraints[constraint] = values\\n2381. \\n2382.     def _initialize_parameters(self, args, kwargs):\\n2383.         """\\n2384.         Initialize the _parameters array that stores raw parameter values for\\n2385.         all parameter sets for use with vectorized fitting algorithms; on\\n2386.         FittableModels the _param_name attributes actually just reference\\n2387.         slices of this array.\\n2388.         """\\n2389.         n_models = kwargs.pop(\\\'n_models\\\', None)\\n2390. \\n2391.         if not (n_models is None or\\n2392.                 (isinstance(n_models, (int, np.integer)) and n_models >= 1)):\\n2393.             raise ValueError(\\n2394.                 "n_models must be either None (in which case it is "\\n2395.                 "determined from the model_set_axis of the parameter initial "\\n2396.                 "values) or it must be a positive integer "\\n2397.                 "(got {0!r})".format(n_models))\\n2398. \\n2399.         model_set_axis = kwargs.pop(\\\'model_set_axis\\\', None)\\n2400.         if model_set_axis is None:\\n2401.             if n_models is not None and n_models > 1:\\n2402.                 # Default to zero\\n2403.                 model_set_axis = 0\\n2404.             else:\\n2405.                 # Otherwise disable\\n2406.                 model_set_axis = False\\n2407.         else:\\n2408.             if not (model_set_axis is False or\\n2409.                     np.issubdtype(type(model_set_axis), np.integer)):\\n2410.                 raise ValueError(\\n2411.                     "model_set_axis must be either False or an integer "\\n2412.                     "specifying the parameter array axis to map to each "\\n2413.                     "model in a set of models (got {0!r}).".format(\\n2414.                         model_set_axis))\\n2415. \\n2416.         # Process positional arguments by matching them up with the\\n2417.         # corresponding parameters in self.param_names--if any also appear as\\n2418.         # keyword arguments this presents a conflict\\n2419.         params = set()\\n2420.         if len(args) > len(self.param_names):\\n2421.             raise TypeError(\\n2422.                 "{0}.__init__() takes at most {1} positional arguments ({2} "\\n2423.                 "given)".format(self.__class__.__name__, len(self.param_names),\\n2424.                                 len(args)))\\n2425. \\n2426.         self._model_set_axis = model_set_axis\\n2427.         self._param_metrics = defaultdict(dict)\\n2428. \\n2429.         for idx, arg in enumerate(args):\\n2430.             if arg is None:\\n2431.                 # A value of None implies using the default value, if exists\\n2432.                 continue\\n2433.             # We use quantity_asanyarray here instead of np.asanyarray because\\n2434.             # if any of the arguments are quantities, we need to return a\\n2435.             # Quantity object not a plain Numpy array.\\n2436.             param_name = self.param_names[idx]\\n2437.             params.add(param_name)\\n2438.             if not isinstance(arg, Parameter):\\n2439.                 value = quantity_asanyarray(arg, dtype=float)\\n2440.             else:\\n2441.                 value = arg\\n2442.             self._initialize_parameter_value(param_name, value)\\n2443. \\n2444.         # At this point the only remaining keyword arguments should be\\n2445.         # parameter names; any others are in error.\\n2446.         for param_name in self.param_names:\\n2447.             if param_name in kwargs:\\n2448.                 if param_name in params:\\n2449.                     raise TypeError(\\n2450.                         "{0}.__init__() got multiple values for parameter "\\n2451.                         "{1!r}".format(self.__class__.__name__, param_name))\\n2452.                 value = kwargs.pop(param_name)\\n2453.                 if value is None:\\n2454.                     continue\\n2455.                 # We use quantity_asanyarray here instead of np.asanyarray\\n2456.                 # because if any of the arguments are quantities, we need\\n2457.                 # to return a Quantity object not a plain Numpy array.\\n2458.                 value = quantity_asanyarray(value, dtype=float)\\n2459.                 params.add(param_name)\\n2460.                 self._initialize_parameter_value(param_name, value)\\n2461.         # Now deal with case where param_name is not supplied by args or kwargs\\n2462.         for param_name in self.param_names:\\n2463.             if param_name not in params:\\n2464.                 self._initialize_parameter_value(param_name, None)\\n2465. \\n2466.         if kwargs:\\n2467.             # If any keyword arguments were left over at this point they are\\n2468.             # invalid--the base class should only be passed the parameter\\n2469.             # values, constraints, and param_dim\\n2470.             for kwarg in kwargs:\\n2471.                 # Just raise an error on the first unrecognized argument\\n2472.                 raise TypeError(\\n2473.                     \\\'{0}.__init__() got an unrecognized parameter \\\'\\n2474.                     \\\'{1!r}\\\'.format(self.__class__.__name__, kwarg))\\n2475. \\n2476.         # Determine the number of model sets: If the model_set_axis is\\n2477.         # None then there is just one parameter set; otherwise it is determined\\n2478.         # by the size of that axis on the first parameter--if the other\\n2479.         # parameters don\\\'t have the right number of axes or the sizes of their\\n2480.         # model_set_axis don\\\'t match an error is raised\\n2481.         if model_set_axis is not False and n_models != 1 and params:\\n2482.             max_ndim = 0\\n2483.             if model_set_axis < 0:\\n2484.                 min_ndim = abs(model_set_axis)\\n2485.             else:\\n2486.                 min_ndim = model_set_axis + 1\\n2487. \\n2488.             for name in self.param_names:\\n2489.                 value = getattr(self, name)\\n2490.                 param_ndim = np.ndim(value)\\n2491.                 if param_ndim < min_ndim:\\n2492.                     raise InputParameterError(\\n2493.                         "All parameter values must be arrays of dimension "\\n2494.                         "at least {0} for model_set_axis={1} (the value "\\n2495.                         "given for {2!r} is only {3}-dimensional)".format(\\n2496.                             min_ndim, model_set_axis, name, param_ndim))\\n2497. \\n2498.                 max_ndim = max(max_ndim, param_ndim)\\n2499. \\n2500.                 if n_models is None:\\n2501.                     # Use the dimensions of the first parameter to determine\\n2502.                     # the number of model sets\\n2503.                     n_models = value.shape[model_set_axis]\\n2504.                 elif value.shape[model_set_axis] != n_models:\\n2505.                     raise InputParameterError(\\n2506.                         "Inconsistent dimensions for parameter {0!r} for "\\n2507.                         "{1} model sets.  The length of axis {2} must be the "\\n2508.                         "same for all input parameter values".format(\\n2509.                             name, n_models, model_set_axis))\\n2510. \\n2511.             self._check_param_broadcast(max_ndim)\\n2512.         else:\\n2513.             if n_models is None:\\n2514.                 n_models = 1\\n2515. \\n2516.             self._check_param_broadcast(None)\\n2517. \\n2518.         self._n_models = n_models\\n2519.         # now validate parameters\\n2520.         for name in params:\\n2521.             param = getattr(self, name)\\n2522.             if param._validator is not None:\\n2523.                 param._validator(self, param.value)\\n2524. \\n2525.     def _initialize_parameter_value(self, param_name, value):\\n2526.         """Mostly deals with consistency checks and determining unit issues."""\\n2527.         if isinstance(value, Parameter):\\n2528.             self.__dict__[param_name] = value\\n2529.             return\\n2530.         param = getattr(self, param_name)\\n2531.         # Use default if value is not provided\\n2532.         if value is None:\\n2533.             default = param.default\\n2534.             if default is None:\\n2535.                 # No value was supplied for the parameter and the\\n2536.                 # parameter does not have a default, therefore the model\\n2537.                 # is underspecified\\n2538.                 raise TypeError("{0}.__init__() requires a value for parameter "\\n2539.                                 "{1!r}".format(self.__class__.__name__, param_name))\\n2540.             value = default\\n2541.             unit = param.unit\\n2542.         else:\\n2543.             if isinstance(value, Quantity):\\n2544.                 unit = value.unit\\n2545.                 value = value.value\\n2546.             else:\\n2547.                 unit = None\\n2548.         if unit is None and param.unit is not None:\\n2549.             raise InputParameterError(\\n2550.                 "{0}.__init__() requires a Quantity for parameter "\\n2551.                 "{1!r}".format(self.__class__.__name__, param_name))\\n2552.         param._unit = unit\\n2553.         param.internal_unit = None\\n2554.         if param._setter is not None:\\n2555.             if unit is not None:\\n2556.                 _val = param._setter(value * unit)\\n2557.             else:\\n2558.                 _val = param._setter(value)\\n2559.             if isinstance(_val, Quantity):\\n2560.                 param.internal_unit = _val.unit\\n2561.                 param._internal_value = np.array(_val.value)\\n2562.             else:\\n2563.                 param.internal_unit = None\\n2564.                 param._internal_value = np.array(_val)\\n2565.         else:\\n2566.             param._value = np.array(value)\\n2567. \\n2568.     def _initialize_slices(self):\\n2569. \\n2570.         param_metrics = self._param_metrics\\n2571.         total_size = 0\\n2572. \\n2573.         for name in self.param_names:\\n2574.             param = getattr(self, name)\\n2575.             value = param.value\\n2576.             param_size = np.size(value)\\n2577.             param_shape = np.shape(value)\\n2578.             param_slice = slice(total_size, total_size + param_size)\\n2579.             param_metrics[name][\\\'slice\\\'] = param_slice\\n2580.             param_metrics[name][\\\'shape\\\'] = param_shape\\n2581.             param_metrics[name][\\\'size\\\'] = param_size\\n2582.             total_size += param_size\\n2583.         self._parameters = np.empty(total_size, dtype=np.float64)\\n2584. \\n2585.     def _parameters_to_array(self):\\n2586.         # Now set the parameter values (this will also fill\\n2587.         # self._parameters)\\n2588.         param_metrics = self._param_metrics\\n2589.         for name in self.param_names:\\n2590.             param = getattr(self, name)\\n2591.             value = param.value\\n2592.             if not isinstance(value, np.ndarray):\\n2593.                 value = np.array([value])\\n2594.             self._parameters[param_metrics[name][\\\'slice\\\']] = value.ravel()\\n2595. \\n2596.         # Finally validate all the parameters; we do this last so that\\n2597.         # validators that depend on one of the other parameters\\\' values will\\n2598.         # work\\n2599. \\n2600.     def _array_to_parameters(self):\\n2601.         param_metrics = self._param_metrics\\n2602.         for name in self.param_names:\\n2603.             param = getattr(self, name)\\n2604.             value = self._parameters[param_metrics[name][\\\'slice\\\']]\\n2605.             value.shape = param_metrics[name][\\\'shape\\\']\\n2606.             param.value = value\\n2607. \\n2608.     def _check_param_broadcast(self, max_ndim):\\n2609.         """\\n2610.         This subroutine checks that all parameter arrays can be broadcast\\n2611.         against each other, and determines the shapes parameters must have in\\n2612.         order to broadcast correctly.\\n2613. \\n2614.         If model_set_axis is None this merely checks that the parameters\\n2615.         broadcast and returns an empty dict if so.  This mode is only used for\\n2616.         single model sets.\\n2617.         """\\n2618.         all_shapes = []\\n2619.         model_set_axis = self._model_set_axis\\n2620. \\n2621.         for name in self.param_names:\\n2622.             param = getattr(self, name)\\n2623.             value = param.value\\n2624.             param_shape = np.shape(value)\\n2625.             param_ndim = len(param_shape)\\n2626.             if max_ndim is not None and param_ndim < max_ndim:\\n2627.                 # All arrays have the same number of dimensions up to the\\n2628.                 # model_set_axis dimension, but after that they may have a\\n2629.                 # different number of trailing axes.  The number of trailing\\n2630.                 # axes must be extended for mutual compatibility.  For example\\n2631.                 # if max_ndim = 3 and model_set_axis = 0, an array with the\\n2632.                 # shape (2, 2) must be extended to (2, 1, 2).  However, an\\n2633.                 # array with shape (2,) is extended to (2, 1).\\n2634.                 new_axes = (1,) * (max_ndim - param_ndim)\\n2635. \\n2636.                 if model_set_axis < 0:\\n2637.                     # Just need to prepend axes to make up the difference\\n2638.                     broadcast_shape = new_axes + param_shape\\n2639.                 else:\\n2640.                     broadcast_shape = (param_shape[:model_set_axis + 1] +\\n2641.                                        new_axes +\\n2642.                                        param_shape[model_set_axis + 1:])\\n2643.                 self._param_metrics[name][\\\'broadcast_shape\\\'] = broadcast_shape\\n2644.                 all_shapes.append(broadcast_shape)\\n2645.             else:\\n2646.                 all_shapes.append(param_shape)\\n2647. \\n2648.         # Now check mutual broadcastability of all shapes\\n2649.         try:\\n2650.             check_broadcast(*all_shapes)\\n2651.         except IncompatibleShapeError as exc:\\n2652.             shape_a, shape_a_idx, shape_b, shape_b_idx = exc.args\\n2653.             param_a = self.param_names[shape_a_idx]\\n2654.             param_b = self.param_names[shape_b_idx]\\n2655. \\n2656.             raise InputParameterError(\\n2657.                 "Parameter {0!r} of shape {1!r} cannot be broadcast with "\\n2658.                 "parameter {2!r} of shape {3!r}.  All parameter arrays "\\n2659.                 "must have shapes that are mutually compatible according "\\n2660.                 "to the broadcasting rules.".format(param_a, shape_a,\\n2661.                                                     param_b, shape_b))\\n2662. \\n2663.     def _param_sets(self, raw=False, units=False):\\n2664.         """\\n2665.         Implementation of the Model.param_sets property.\\n2666. \\n2667.         This internal implementation has a ``raw`` argument which controls\\n2668.         whether or not to return the raw parameter values (i.e. the values that\\n2669.         are actually stored in the ._parameters array, as opposed to the values\\n2670.         displayed to users.  In most cases these are one in the same but there\\n2671.         are currently a few exceptions.\\n2672. \\n2673.         Note: This is notably an overcomplicated device and may be removed\\n2674.         entirely in the near future.\\n2675.         """\\n2676. \\n2677.         values = []\\n2678.         shapes = []\\n2679.         for name in self.param_names:\\n2680.             param = getattr(self, name)\\n2681. \\n2682.             if raw and param._setter:\\n2683.                 value = param._internal_value\\n2684.             else:\\n2685.                 value = param.value\\n2686. \\n2687.             broadcast_shape = self._param_metrics[name].get(\\\'broadcast_shape\\\')\\n2688.             if broadcast_shape is not None:\\n2689.                 value = value.reshape(broadcast_shape)\\n2690. \\n2691.             shapes.append(np.shape(value))\\n2692. \\n2693.             if len(self) == 1:\\n2694.                 # Add a single param set axis to the parameter\\\'s value (thus\\n2695.                 # converting scalars to shape (1,) array values) for\\n2696.                 # consistency\\n2697.                 value = np.array([value])\\n2698. \\n2699.             if units:\\n2700.                 if raw and param.internal_unit is not None:\\n2701.                     unit = param.internal_unit\\n2702.                 else:\\n2703.                     unit = param.unit\\n2704.                 if unit is not None:\\n2705.                     value = Quantity(value, unit)\\n2706. \\n2707.             values.append(value)\\n2708. \\n2709.         if len(set(shapes)) != 1 or units:\\n2710.             # If the parameters are not all the same shape, converting to an\\n2711.             # array is going to produce an object array\\n2712.             # However the way Numpy creates object arrays is tricky in that it\\n2713.             # will recurse into array objects in the list and break them up\\n2714.             # into separate objects.  Doing things this way ensures a 1-D\\n2715.             # object array the elements of which are the individual parameter\\n2716.             # arrays.  There\\\'s not much reason to do this over returning a list\\n2717.             # except for consistency\\n2718.             psets = np.empty(len(values), dtype=object)\\n2719.             psets[:] = values\\n2720.             return psets\\n2721. \\n2722.         return np.array(values)\\n2723. \\n2724.     def _format_repr(self, args=[], kwargs={}, defaults={}):\\n2725.         """\\n2726.         Internal implementation of ``__repr__``.\\n2727. \\n2728.         This is separated out for ease of use by subclasses that wish to\\n2729.         override the default ``__repr__`` while keeping the same basic\\n2730.         formatting.\\n2731.         """\\n2732. \\n2733.         parts = [repr(a) for a in args]\\n2734. \\n2735.         parts.extend(\\n2736.             f"{name}={param_repr_oneline(getattr(self, name))}"\\n2737.             for name in self.param_names)\\n2738. \\n2739.         if self.name is not None:\\n2740.             parts.append(f\\\'name={self.name!r}\\\')\\n2741. \\n2742.         for kwarg, value in kwargs.items():\\n2743.             if kwarg in defaults and defaults[kwarg] == value:\\n2744.                 continue\\n2745.             parts.append(f\\\'{kwarg}={value!r}\\\')\\n2746. \\n2747.         if len(self) > 1:\\n2748.             parts.append(f"n_models={len(self)}")\\n2749. \\n2750.         return f"<{self.__class__.__name__}({\\\', \\\'.join(parts)})>"\\n2751. \\n2752.     def _format_str(self, keywords=[], defaults={}):\\n2753.         """\\n2754.         Internal implementation of ``__str__``.\\n2755. \\n2756.         This is separated out for ease of use by subclasses that wish to\\n2757.         override the default ``__str__`` while keeping the same basic\\n2758.         formatting.\\n2759.         """\\n2760. \\n2761.         default_keywords = [\\n2762.             (\\\'Model\\\', self.__class__.__name__),\\n2763.             (\\\'Name\\\', self.name),\\n2764.             (\\\'Inputs\\\', self.inputs),\\n2765.             (\\\'Outputs\\\', self.outputs),\\n2766.             (\\\'Model set size\\\', len(self))\\n2767.         ]\\n2768. \\n2769.         parts = [f\\\'{keyword}: {value}\\\'\\n2770.                  for keyword, value in default_keywords\\n2771.                  if value is not None]\\n2772. \\n2773.         for keyword, value in keywords:\\n2774.             if keyword.lower() in defaults and defaults[keyword.lower()] == value:\\n2775.                 continue\\n2776.             parts.append(f\\\'{keyword}: {value}\\\')\\n2777.         parts.append(\\\'Parameters:\\\')\\n2778. \\n2779.         if len(self) == 1:\\n2780.             columns = [[getattr(self, name).value]\\n2781.                        for name in self.param_names]\\n2782.         else:\\n2783.             columns = [getattr(self, name).value\\n2784.                        for name in self.param_names]\\n2785. \\n2786.         if columns:\\n2787.             param_table = Table(columns, names=self.param_names)\\n2788.             # Set units on the columns\\n2789.             for name in self.param_names:\\n2790.                 param_table[name].unit = getattr(self, name).unit\\n2791.             parts.append(indent(str(param_table), width=4))\\n2792. \\n2793.         return \\\'\\\\n\\\'.join(parts)\\n2794. \\n2795. \\n2796. class FittableModel(Model):\\n2797.     """\\n2798.     Base class for models that can be fitted using the built-in fitting\\n2799.     algorithms.\\n2800.     """\\n2801. \\n2802.     linear = False\\n2803.     # derivative with respect to parameters\\n2804.     fit_deriv = None\\n2805.     """\\n2806.     Function (similar to the model\\\'s `~Model.evaluate`) to compute the\\n2807.     derivatives of the model with respect to its parameters, for use by fitting\\n2808.     algorithms.  In other words, this computes the Jacobian matrix with respect\\n2809.     to the model\\\'s parameters.\\n2810.     """\\n2811.     # Flag that indicates if the model derivatives with respect to parameters\\n2812.     # are given in columns or rows\\n2813.     col_fit_deriv = True\\n2814.     fittable = True\\n2815. \\n2816. \\n2817. class Fittable1DModel(FittableModel):\\n2818.     """\\n2819.     Base class for one-dimensional fittable models.\\n2820. \\n2821.     This class provides an easier interface to defining new models.\\n2822.     Examples can be found in `astropy.modeling.functional_models`.\\n2823.     """\\n2824.     n_inputs = 1\\n2825.     n_outputs = 1\\n2826.     _separable = True\\n2827. \\n2828. \\n2829. class Fittable2DModel(FittableModel):\\n2830.     """\\n2831.     Base class for two-dimensional fittable models.\\n2832. \\n2833.     This class provides an easier interface to defining new models.\\n2834.     Examples can be found in `astropy.modeling.functional_models`.\\n2835.     """\\n2836. \\n2837.     n_inputs = 2\\n2838.     n_outputs = 1\\n2839. \\n2840. \\n2841. def _make_arithmetic_operator(oper):\\n2842.     # We don\\\'t bother with tuple unpacking here for efficiency\\\'s sake, but for\\n2843.     # documentation purposes:\\n2844.     #\\n2845.     #     f_eval, f_n_inputs, f_n_outputs = f\\n2846.     #\\n2847.     # and similarly for g\\n2848.     def op(f, g):\\n2849.         return (make_binary_operator_eval(oper, f[0], g[0]), f[1], f[2])\\n2850. \\n2851.     return op\\n2852. \\n2853. \\n2854. def _composition_operator(f, g):\\n2855.     # We don\\\'t bother with tuple unpacking here for efficiency\\\'s sake, but for\\n2856.     # documentation purposes:\\n2857.     #\\n2858.     #     f_eval, f_n_inputs, f_n_outputs = f\\n2859.     #\\n2860.     # and similarly for g\\n2861.     return (lambda inputs, params: g[0](f[0](inputs, params), params),\\n2862.             f[1], g[2])\\n2863. \\n2864. \\n2865. def _join_operator(f, g):\\n2866.     # We don\\\'t bother with tuple unpacking here for efficiency\\\'s sake, but for\\n2867.     # documentation purposes:\\n2868.     #\\n2869.     #     f_eval, f_n_inputs, f_n_outputs = f\\n2870.     #\\n2871.     # and similarly for g\\n2872.     return (lambda inputs, params: (f[0](inputs[:f[1]], params) +\\n2873.                                     g[0](inputs[f[1]:], params)),\\n2874.             f[1] + g[1], f[2] + g[2])\\n2875. \\n2876. \\n2877. BINARY_OPERATORS = {\\n2878.     \\\'+\\\': _make_arithmetic_operator(operator.add),\\n2879.     \\\'-\\\': _make_arithmetic_operator(operator.sub),\\n2880.     \\\'*\\\': _make_arithmetic_operator(operator.mul),\\n2881.     \\\'/\\\': _make_arithmetic_operator(operator.truediv),\\n2882.     \\\'**\\\': _make_arithmetic_operator(operator.pow),\\n2883.     \\\'|\\\': _composition_operator,\\n2884.     \\\'&\\\': _join_operator\\n2885. }\\n2886. \\n2887. SPECIAL_OPERATORS = _SpecialOperatorsDict()\\n2888. \\n2889. \\n2890. def _add_special_operator(sop_name, sop):\\n2891.     return SPECIAL_OPERATORS.add(sop_name, sop)\\n2892. \\n2893. \\n2894. class CompoundModel(Model):\\n2895.     \\\'\\\'\\\'\\n2896.     Base class for compound models.\\n2897. \\n2898.     While it can be used directly, the recommended way\\n2899.     to combine models is through the model operators.\\n2900.     \\\'\\\'\\\'\\n2901. \', \'start_line_number\': 501, \'end_line_number\': 2901}\n\n{\'relative_path\': \'astropy/modeling/core.py\', \'content\': \'2901. \\n2902.     def __init__(self, op, left, right, name=None):\\n2903.         self.__dict__[\\\'_param_names\\\'] = None\\n2904.         self._n_submodels = None\\n2905.         self.op = op\\n2906.         self.left = left\\n2907.         self.right = right\\n2908.         self._bounding_box = None\\n2909.         self._user_bounding_box = None\\n2910.         self._leaflist = None\\n2911.         self._tdict = None\\n2912.         self._parameters = None\\n2913.         self._parameters_ = None\\n2914.         self._param_metrics = None\\n2915. \\n2916.         if op != \\\'fix_inputs\\\' and len(left) != len(right):\\n2917.             raise ValueError(\\n2918.                 \\\'Both operands must have equal values for n_models\\\')\\n2919.         self._n_models = len(left)\\n2920. \\n2921.         if op != \\\'fix_inputs\\\' and ((left.model_set_axis != right.model_set_axis)\\n2922.                                    or left.model_set_axis):  # not False and not 0\\n2923.             raise ValueError("model_set_axis must be False or 0 and consistent for operands")\\n2924.         self._model_set_axis = left.model_set_axis\\n2925. \\n2926.         if op in [\\\'+\\\', \\\'-\\\', \\\'*\\\', \\\'/\\\', \\\'**\\\'] or op in SPECIAL_OPERATORS:\\n2927.             if (left.n_inputs != right.n_inputs) or \\\\\\n2928.                (left.n_outputs != right.n_outputs):\\n2929.                 raise ModelDefinitionError(\\n2930.                     \\\'Both operands must match numbers of inputs and outputs\\\')\\n2931.             self.n_inputs = left.n_inputs\\n2932.             self.n_outputs = left.n_outputs\\n2933.             self.inputs = left.inputs\\n2934.             self.outputs = left.outputs\\n2935.         elif op == \\\'&\\\':\\n2936.             self.n_inputs = left.n_inputs + right.n_inputs\\n2937.             self.n_outputs = left.n_outputs + right.n_outputs\\n2938.             self.inputs = combine_labels(left.inputs, right.inputs)\\n2939.             self.outputs = combine_labels(left.outputs, right.outputs)\\n2940.         elif op == \\\'|\\\':\\n2941.             if left.n_outputs != right.n_inputs:\\n2942.                 raise ModelDefinitionError(\\n2943.                     "Unsupported operands for |: {0} (n_inputs={1}, "\\n2944.                     "n_outputs={2}) and {3} (n_inputs={4}, n_outputs={5}); "\\n2945.                     "n_outputs for the left-hand model must match n_inputs "\\n2946.                     "for the right-hand model.".format(\\n2947.                         left.name, left.n_inputs, left.n_outputs, right.name,\\n2948.                         right.n_inputs, right.n_outputs))\\n2949. \\n2950.             self.n_inputs = left.n_inputs\\n2951.             self.n_outputs = right.n_outputs\\n2952.             self.inputs = left.inputs\\n2953.             self.outputs = right.outputs\\n2954.         elif op == \\\'fix_inputs\\\':\\n2955.             if not isinstance(left, Model):\\n2956.                 raise ValueError(\\\'First argument to "fix_inputs" must be an instance of an astropy Model.\\\')\\n2957.             if not isinstance(right, dict):\\n2958.                 raise ValueError(\\\'Expected a dictionary for second argument of "fix_inputs".\\\')\\n2959. \\n2960.             # Dict keys must match either possible indices\\n2961.             # for model on left side, or names for inputs.\\n2962.             self.n_inputs = left.n_inputs - len(right)\\n2963.             # Assign directly to the private attribute (instead of using the setter)\\n2964.             # to avoid asserting the new number of outputs matches the old one.\\n2965.             self._outputs = left.outputs\\n2966.             self.n_outputs = left.n_outputs\\n2967.             newinputs = list(left.inputs)\\n2968.             keys = right.keys()\\n2969.             input_ind = []\\n2970.             for key in keys:\\n2971.                 if np.issubdtype(type(key), np.integer):\\n2972.                     if key >= left.n_inputs or key < 0:\\n2973.                         raise ValueError(\\n2974.                             \\\'Substitution key integer value \\\'\\n2975.                             \\\'not among possible input choices.\\\')\\n2976.                     if key in input_ind:\\n2977.                         raise ValueError("Duplicate specification of "\\n2978.                                          "same input (index/name).")\\n2979.                     input_ind.append(key)\\n2980.                 elif isinstance(key, str):\\n2981.                     if key not in left.inputs:\\n2982.                         raise ValueError(\\n2983.                             \\\'Substitution key string not among possible \\\'\\n2984.                             \\\'input choices.\\\')\\n2985.                     # Check to see it doesn\\\'t match positional\\n2986.                     # specification.\\n2987.                     ind = left.inputs.index(key)\\n2988.                     if ind in input_ind:\\n2989.                         raise ValueError("Duplicate specification of "\\n2990.                                          "same input (index/name).")\\n2991.                     input_ind.append(ind)\\n2992.             # Remove substituted inputs\\n2993.             input_ind.sort()\\n2994.             input_ind.reverse()\\n2995.             for ind in input_ind:\\n2996.                 del newinputs[ind]\\n2997.             self.inputs = tuple(newinputs)\\n2998.             # Now check to see if the input model has bounding_box defined.\\n2999.             # If so, remove the appropriate dimensions and set it for this\\n3000.             # instance.\\n3001.             try:\\n3002.                 self.bounding_box = \\\\\\n3003.                     self.left.bounding_box.fix_inputs(self, right)\\n3004.             except NotImplementedError:\\n3005.                 pass\\n3006. \\n3007.         else:\\n3008.             raise ModelDefinitionError(\\\'Illegal operator: \\\', self.op)\\n3009.         self.name = name\\n3010.         self._fittable = None\\n3011.         self.fit_deriv = None\\n3012.         self.col_fit_deriv = None\\n3013.         if op in (\\\'|\\\', \\\'+\\\', \\\'-\\\'):\\n3014.             self.linear = left.linear and right.linear\\n3015.         else:\\n3016.             self.linear = False\\n3017.         self.eqcons = []\\n3018.         self.ineqcons = []\\n3019.         self.n_left_params = len(self.left.parameters)\\n3020.         self._map_parameters()\\n3021. \\n3022.     def _get_left_inputs_from_args(self, args):\\n3023.         return args[:self.left.n_inputs]\\n3024. \\n3025.     def _get_right_inputs_from_args(self, args):\\n3026.         op = self.op\\n3027.         if op == \\\'&\\\':\\n3028.             # Args expected to look like (*left inputs, *right inputs, *left params, *right params)\\n3029.             return args[self.left.n_inputs: self.left.n_inputs + self.right.n_inputs]\\n3030.         elif op == \\\'|\\\' or  op == \\\'fix_inputs\\\':\\n3031.             return None\\n3032.         else:\\n3033.             return args[:self.left.n_inputs]\\n3034. \\n3035.     def _get_left_params_from_args(self, args):\\n3036.         op = self.op\\n3037.         if op == \\\'&\\\':\\n3038.             # Args expected to look like (*left inputs, *right inputs, *left params, *right params)\\n3039.             n_inputs = self.left.n_inputs + self.right.n_inputs\\n3040.             return args[n_inputs: n_inputs + self.n_left_params]\\n3041.         else:\\n3042.             return args[self.left.n_inputs: self.left.n_inputs + self.n_left_params]\\n3043. \\n3044.     def _get_right_params_from_args(self, args):\\n3045.         op = self.op\\n3046.         if op == \\\'fix_inputs\\\':\\n3047.             return None\\n3048.         if op == \\\'&\\\':\\n3049.             # Args expected to look like (*left inputs, *right inputs, *left params, *right params)\\n3050.             return args[self.left.n_inputs + self.right.n_inputs + self.n_left_params:]\\n3051.         else:\\n3052.             return args[self.left.n_inputs + self.n_left_params:]\\n3053. \\n3054.     def _get_kwarg_model_parameters_as_positional(self, args, kwargs):\\n3055.         # could do it with inserts but rebuilding seems like simpilist way\\n3056. \\n3057.         #TODO: Check if any param names are in kwargs maybe as an intersection of sets?\\n3058.         if self.op == "&":\\n3059.             new_args = list(args[:self.left.n_inputs + self.right.n_inputs])\\n3060.             args_pos = self.left.n_inputs + self.right.n_inputs\\n3061.         else:\\n3062.             new_args = list(args[:self.left.n_inputs])\\n3063.             args_pos = self.left.n_inputs\\n3064. \\n3065.         for param_name in self.param_names:\\n3066.             kw_value = kwargs.pop(param_name, None)\\n3067.             if kw_value is not None:\\n3068.                 value = kw_value\\n3069.             else:\\n3070.                 try:\\n3071.                     value = args[args_pos]\\n3072.                 except IndexError:\\n3073.                     raise IndexError("Missing parameter or input")\\n3074. \\n3075.                 args_pos += 1\\n3076.             new_args.append(value)\\n3077. \\n3078.         return new_args, kwargs\\n3079. \\n3080.     def _apply_operators_to_value_lists(self, leftval, rightval, **kw):\\n3081.         op = self.op\\n3082.         if op == \\\'+\\\':\\n3083.             return binary_operation(operator.add, leftval, rightval)\\n3084.         elif op == \\\'-\\\':\\n3085.             return binary_operation(operator.sub, leftval, rightval)\\n3086.         elif op == \\\'*\\\':\\n3087.             return binary_operation(operator.mul, leftval, rightval)\\n3088.         elif op == \\\'/\\\':\\n3089.             return binary_operation(operator.truediv, leftval, rightval)\\n3090.         elif op == \\\'**\\\':\\n3091.             return binary_operation(operator.pow, leftval, rightval)\\n3092.         elif op == \\\'&\\\':\\n3093.             if not isinstance(leftval, tuple):\\n3094.                 leftval = (leftval,)\\n3095.             if not isinstance(rightval, tuple):\\n3096.                 rightval = (rightval,)\\n3097.             return leftval + rightval\\n3098.         elif op in SPECIAL_OPERATORS:\\n3099.             return binary_operation(SPECIAL_OPERATORS[op], leftval, rightval)\\n3100.         else:\\n3101.             raise ModelDefinitionError(\\\'Unrecognized operator {op}\\\')\\n3102. \\n3103.     def evaluate(self, *args, **kw):\\n3104.         op = self.op\\n3105.         args, kw = self._get_kwarg_model_parameters_as_positional(args, kw)\\n3106.         left_inputs = self._get_left_inputs_from_args(args)\\n3107.         left_params = self._get_left_params_from_args(args)\\n3108. \\n3109.         if op == \\\'fix_inputs\\\':\\n3110.             pos_index = dict(zip(self.left.inputs, range(self.left.n_inputs)))\\n3111.             fixed_inputs = {\\n3112.                 key if np.issubdtype(type(key), np.integer) else pos_index[key]: value\\n3113.                 for key, value in self.right.items()\\n3114.             }\\n3115.             left_inputs = [\\n3116.                 fixed_inputs[ind] if ind in fixed_inputs.keys() else inp\\n3117.                 for ind, inp in enumerate(left_inputs)\\n3118.             ]\\n3119. \\n3120.         leftval = self.left.evaluate(*itertools.chain(left_inputs, left_params))\\n3121. \\n3122.         if op == \\\'fix_inputs\\\':\\n3123.             return leftval\\n3124. \\n3125.         right_inputs = self._get_right_inputs_from_args(args)\\n3126.         right_params = self._get_right_params_from_args(args)\\n3127. \\n3128.         if op == "|":\\n3129.             if isinstance(leftval, tuple):\\n3130.                 return self.right.evaluate(*itertools.chain(leftval, right_params))\\n3131.             else:\\n3132.                 return self.right.evaluate(leftval, *right_params)\\n3133.         else:\\n3134.             rightval = self.right.evaluate(*itertools.chain(right_inputs, right_params))\\n3135. \\n3136.         return self._apply_operators_to_value_lists(leftval, rightval, **kw)\\n3137. \\n3138.     @property\\n3139.     def n_submodels(self):\\n3140.         if self._leaflist is None:\\n3141.             self._make_leaflist()\\n3142.         return len(self._leaflist)\\n3143. \\n3144.     @property\\n3145.     def submodel_names(self):\\n3146.         """ Return the names of submodels in a ``CompoundModel``."""\\n3147.         if self._leaflist is None:\\n3148.             self._make_leaflist()\\n3149.         names = [item.name for item in self._leaflist]\\n3150.         nonecount = 0\\n3151.         newnames = []\\n3152.         for item in names:\\n3153.             if item is None:\\n3154.                 newnames.append(f\\\'None_{nonecount}\\\')\\n3155.                 nonecount += 1\\n3156.             else:\\n3157.                 newnames.append(item)\\n3158.         return tuple(newnames)\\n3159. \\n3160.     def both_inverses_exist(self):\\n3161.         \\\'\\\'\\\'\\n3162.         if both members of this compound model have inverses return True\\n3163.         \\\'\\\'\\\'\\n3164.         warnings.warn(\\n3165.             "CompoundModel.both_inverses_exist is deprecated. "\\n3166.             "Use has_inverse instead.",\\n3167.             AstropyDeprecationWarning\\n3168.         )\\n3169. \\n3170.         try:\\n3171.             linv = self.left.inverse\\n3172.             rinv = self.right.inverse\\n3173.         except NotImplementedError:\\n3174.             return False\\n3175. \\n3176.         return True\\n3177. \\n3178.     def _pre_evaluate(self, *args, **kwargs):\\n3179.         """\\n3180.         CompoundModel specific input setup that needs to occur prior to\\n3181.             model evaluation.\\n3182. \\n3183.         Note\\n3184.         ----\\n3185.             All of the _pre_evaluate for each component model will be\\n3186.             performed at the time that the individual model is evaluated.\\n3187.         """\\n3188. \\n3189.         # If equivalencies are provided, necessary to map parameters and pass\\n3190.         # the leaflist as a keyword input for use by model evaluation so that\\n3191.         # the compound model input names can be matched to the model input\\n3192.         # names.\\n3193.         if \\\'equivalencies\\\' in kwargs:\\n3194.             # Restructure to be useful for the individual model lookup\\n3195.             kwargs[\\\'inputs_map\\\'] = [(value[0], (value[1], key)) for\\n3196.                                     key, value in self.inputs_map().items()]\\n3197. \\n3198.         # Setup actual model evaluation method\\n3199.         def evaluate(_inputs):\\n3200.             return self._evaluate(*_inputs, **kwargs)\\n3201. \\n3202.         return evaluate, args, None, kwargs\\n3203. \\n3204.     @property\\n3205.     def _argnames(self):\\n3206.         """No inputs should be used to determine input_shape when handling compound models"""\\n3207.         return ()\\n3208. \\n3209.     def _post_evaluate(self, inputs, outputs, broadcasted_shapes, with_bbox, **kwargs):\\n3210.         """\\n3211.         CompoundModel specific post evaluation processing of outputs\\n3212. \\n3213.         Note\\n3214.         ----\\n3215.             All of the _post_evaluate for each component model will be\\n3216.             performed at the time that the individual model is evaluated.\\n3217.         """\\n3218.         if self.get_bounding_box(with_bbox) is not None and self.n_outputs == 1:\\n3219.             return outputs[0]\\n3220.         return outputs\\n3221. \\n3222.     def _evaluate(self, *args, **kw):\\n3223.         op = self.op\\n3224.         if op != \\\'fix_inputs\\\':\\n3225.             if op != \\\'&\\\':\\n3226.                 leftval = self.left(*args, **kw)\\n3227.                 if op != \\\'|\\\':\\n3228.                     rightval = self.right(*args, **kw)\\n3229.                 else:\\n3230.                     rightval = None\\n3231. \\n3232.             else:\\n3233.                 leftval = self.left(*(args[:self.left.n_inputs]), **kw)\\n3234.                 rightval = self.right(*(args[self.left.n_inputs:]), **kw)\\n3235. \\n3236.             if op != "|":\\n3237.                 return self._apply_operators_to_value_lists(leftval, rightval, **kw)\\n3238. \\n3239.             elif op == \\\'|\\\':\\n3240.                 if isinstance(leftval, tuple):\\n3241.                     return self.right(*leftval, **kw)\\n3242.                 else:\\n3243.                     return self.right(leftval, **kw)\\n3244. \\n3245.         else:\\n3246.             subs = self.right\\n3247.             newargs = list(args)\\n3248.             subinds = []\\n3249.             subvals = []\\n3250.             for key in subs.keys():\\n3251.                 if np.issubdtype(type(key), np.integer):\\n3252.                     subinds.append(key)\\n3253.                 elif isinstance(key, str):\\n3254.                     ind = self.left.inputs.index(key)\\n3255.                     subinds.append(ind)\\n3256.                 subvals.append(subs[key])\\n3257.             # Turn inputs specified in kw into positional indices.\\n3258.             # Names for compound inputs do not propagate to sub models.\\n3259.             kwind = []\\n3260.             kwval = []\\n3261.             for kwkey in list(kw.keys()):\\n3262.                 if kwkey in self.inputs:\\n3263.                     ind = self.inputs.index(kwkey)\\n3264.                     if ind < len(args):\\n3265.                         raise ValueError("Keyword argument duplicates "\\n3266.                                          "positional value supplied.")\\n3267.                     kwind.append(ind)\\n3268.                     kwval.append(kw[kwkey])\\n3269.                     del kw[kwkey]\\n3270.             # Build new argument list\\n3271.             # Append keyword specified args first\\n3272.             if kwind:\\n3273.                 kwargs = list(zip(kwind, kwval))\\n3274.                 kwargs.sort()\\n3275.                 kwindsorted, kwvalsorted = list(zip(*kwargs))\\n3276.                 newargs = newargs + list(kwvalsorted)\\n3277.             if subinds:\\n3278.                 subargs = list(zip(subinds, subvals))\\n3279.                 subargs.sort()\\n3280.                 # subindsorted, subvalsorted = list(zip(*subargs))\', \'start_line_number\': 2901, \'end_line_number\': 3280}\n\n{\'relative_path\': \'astropy/modeling/core.py\', \'content\': \'3280.                 # subindsorted, subvalsorted = list(zip(*subargs))\\n3281.                 # The substitutions must be inserted in order\\n3282.                 for ind, val in subargs:\\n3283.                     newargs.insert(ind, val)\\n3284.             return self.left(*newargs, **kw)\\n3285. \\n3286.     @property\\n3287.     def param_names(self):\\n3288.         """ An ordered list of parameter names."""\\n3289.         return self._param_names\\n3290. \\n3291.     def _make_leaflist(self):\\n3292.         tdict = {}\\n3293.         leaflist = []\\n3294.         make_subtree_dict(self, \\\'\\\', tdict, leaflist)\\n3295.         self._leaflist = leaflist\\n3296.         self._tdict = tdict\\n3297. \\n3298.     def __getattr__(self, name):\\n3299.         """\\n3300.         If someone accesses an attribute not already defined, map the\\n3301.         parameters, and then see if the requested attribute is one of\\n3302.         the parameters\\n3303.         """\\n3304.         # The following test is needed to avoid infinite recursion\\n3305.         # caused by deepcopy. There may be other such cases discovered.\\n3306.         if name == \\\'__setstate__\\\':\\n3307.             raise AttributeError\\n3308.         if name in self._param_names:\\n3309.             return self.__dict__[name]\\n3310.         else:\\n3311.             raise AttributeError(f\\\'Attribute "{name}" not found\\\')\\n3312. \\n3313.     def __getitem__(self, index):\\n3314.         if self._leaflist is None:\\n3315.             self._make_leaflist()\\n3316.         leaflist = self._leaflist\\n3317.         tdict = self._tdict\\n3318.         if isinstance(index, slice):\\n3319.             if index.step:\\n3320.                 raise ValueError(\\\'Steps in slices not supported \\\'\\n3321.                                  \\\'for compound models\\\')\\n3322.             if index.start is not None:\\n3323.                 if isinstance(index.start, str):\\n3324.                     start = self._str_index_to_int(index.start)\\n3325.                 else:\\n3326.                     start = index.start\\n3327.             else:\\n3328.                 start = 0\\n3329.             if index.stop is not None:\\n3330.                 if isinstance(index.stop, str):\\n3331.                     stop = self._str_index_to_int(index.stop)\\n3332.                 else:\\n3333.                     stop = index.stop - 1\\n3334.             else:\\n3335.                 stop = len(leaflist) - 1\\n3336.             if index.stop == 0:\\n3337.                 raise ValueError("Slice endpoint cannot be 0")\\n3338.             if start < 0:\\n3339.                 start = len(leaflist) + start\\n3340.             if stop < 0:\\n3341.                 stop = len(leaflist) + stop\\n3342.             # now search for matching node:\\n3343.             if stop == start:  # only single value, get leaf instead in code below\\n3344.                 index = start\\n3345.             else:\\n3346.                 for key in tdict:\\n3347.                     node, leftind, rightind = tdict[key]\\n3348.                     if leftind == start and rightind == stop:\\n3349.                         return node\\n3350.                 raise IndexError("No appropriate subtree matches slice")\\n3351.         if isinstance(index, type(0)):\\n3352.             return leaflist[index]\\n3353.         elif isinstance(index, type(\\\'\\\')):\\n3354.             return leaflist[self._str_index_to_int(index)]\\n3355.         else:\\n3356.             raise TypeError(\\\'index must be integer, slice, or model name string\\\')\\n3357. \\n3358.     def _str_index_to_int(self, str_index):\\n3359.         # Search through leaflist for item with that name\\n3360.         found = []\\n3361.         for nleaf, leaf in enumerate(self._leaflist):\\n3362.             if getattr(leaf, \\\'name\\\', None) == str_index:\\n3363.                 found.append(nleaf)\\n3364.         if len(found) == 0:\\n3365.             raise IndexError(f"No component with name \\\'{str_index}\\\' found")\\n3366.         if len(found) > 1:\\n3367.             raise IndexError("Multiple components found using \\\'{}\\\' as name\\\\n"\\n3368.                              "at indices {}".format(str_index, found))\\n3369.         return found[0]\\n3370. \\n3371.     @property\\n3372.     def n_inputs(self):\\n3373.         """ The number of inputs of a model."""\\n3374.         return self._n_inputs\\n3375. \\n3376.     @n_inputs.setter\\n3377.     def n_inputs(self, value):\\n3378.         self._n_inputs = value\\n3379. \\n3380.     @property\\n3381.     def n_outputs(self):\\n3382.         """ The number of outputs of a model."""\\n3383.         return self._n_outputs\\n3384. \\n3385.     @n_outputs.setter\\n3386.     def n_outputs(self, value):\\n3387.         self._n_outputs = value\\n3388. \\n3389.     @property\\n3390.     def eqcons(self):\\n3391.         return self._eqcons\\n3392. \\n3393.     @eqcons.setter\\n3394.     def eqcons(self, value):\\n3395.         self._eqcons = value\\n3396. \\n3397.     @property\\n3398.     def ineqcons(self):\\n3399.         return self._eqcons\\n3400. \\n3401.     @ineqcons.setter\\n3402.     def ineqcons(self, value):\\n3403.         self._eqcons = value\\n3404. \\n3405.     def traverse_postorder(self, include_operator=False):\\n3406.         """ Postorder traversal of the CompoundModel tree."""\\n3407.         res = []\\n3408.         if isinstance(self.left, CompoundModel):\\n3409.             res = res + self.left.traverse_postorder(include_operator)\\n3410.         else:\\n3411.             res = res + [self.left]\\n3412.         if isinstance(self.right, CompoundModel):\\n3413.             res = res + self.right.traverse_postorder(include_operator)\\n3414.         else:\\n3415.             res = res + [self.right]\\n3416.         if include_operator:\\n3417.             res.append(self.op)\\n3418.         else:\\n3419.             res.append(self)\\n3420.         return res\\n3421. \\n3422.     def _format_expression(self, format_leaf=None):\\n3423.         leaf_idx = 0\\n3424.         operands = deque()\\n3425. \\n3426.         if format_leaf is None:\\n3427.             format_leaf = lambda i, l: f\\\'[{i}]\\\'\\n3428. \\n3429.         for node in self.traverse_postorder():\\n3430.             if not isinstance(node, CompoundModel):\\n3431.                 operands.append(format_leaf(leaf_idx, node))\\n3432.                 leaf_idx += 1\\n3433.                 continue\\n3434. \\n3435.             right = operands.pop()\\n3436.             left = operands.pop()\\n3437.             if node.op in OPERATOR_PRECEDENCE:\\n3438.                 oper_order = OPERATOR_PRECEDENCE[node.op]\\n3439. \\n3440.                 if isinstance(node, CompoundModel):\\n3441.                     if (isinstance(node.left, CompoundModel) and\\n3442.                             OPERATOR_PRECEDENCE[node.left.op] < oper_order):\\n3443.                         left = f\\\'({left})\\\'\\n3444.                     if (isinstance(node.right, CompoundModel) and\\n3445.                             OPERATOR_PRECEDENCE[node.right.op] < oper_order):\\n3446.                         right = f\\\'({right})\\\'\\n3447. \\n3448.                 operands.append(\\\' \\\'.join((left, node.op, right)))\\n3449.             else:\\n3450.                 left = f\\\'(({left}),\\\'\\n3451.                 right = f\\\'({right}))\\\'\\n3452.                 operands.append(\\\' \\\'.join((node.op[0], left, right)))\\n3453. \\n3454.         return \\\'\\\'.join(operands)\\n3455. \\n3456.     def _format_components(self):\\n3457.         if self._parameters_ is None:\\n3458.             self._map_parameters()\\n3459.         return \\\'\\\\n\\\\n\\\'.join(\\\'[{0}]: {1!r}\\\'.format(idx, m)\\n3460.                            for idx, m in enumerate(self._leaflist))\\n3461. \\n3462.     def __str__(self):\\n3463.         expression = self._format_expression()\\n3464.         components = self._format_components()\\n3465.         keywords = [\\n3466.             (\\\'Expression\\\', expression),\\n3467.             (\\\'Components\\\', \\\'\\\\n\\\' + indent(components))\\n3468.         ]\\n3469.         return super()._format_str(keywords=keywords)\\n3470. \\n3471.     def rename(self, name):\\n3472.         self.name = name\\n3473.         return self\\n3474. \\n3475.     @property\\n3476.     def isleaf(self):\\n3477.         return False\\n3478. \\n3479.     @property\\n3480.     def inverse(self):\\n3481.         if self.op == \\\'|\\\':\\n3482.             return self.right.inverse | self.left.inverse\\n3483.         elif self.op == \\\'&\\\':\\n3484.             return self.left.inverse & self.right.inverse\\n3485.         else:\\n3486.             return NotImplemented\\n3487. \\n3488.     @property\\n3489.     def fittable(self):\\n3490.         """ Set the fittable attribute on a compound model."""\\n3491.         if self._fittable is None:\\n3492.             if self._leaflist is None:\\n3493.                 self._map_parameters()\\n3494.             self._fittable = all(m.fittable for m in self._leaflist)\\n3495.         return self._fittable\\n3496. \\n3497.     __add__ = _model_oper(\\\'+\\\')\\n3498.     __sub__ = _model_oper(\\\'-\\\')\\n3499.     __mul__ = _model_oper(\\\'*\\\')\\n3500.     __truediv__ = _model_oper(\\\'/\\\')\\n3501.     __pow__ = _model_oper(\\\'**\\\')\\n3502.     __or__ = _model_oper(\\\'|\\\')\\n3503.     __and__ = _model_oper(\\\'&\\\')\\n3504. \\n3505.     def _map_parameters(self):\\n3506.         """\\n3507.         Map all the constituent model parameters to the compound object,\\n3508.         renaming as necessary by appending a suffix number.\\n3509. \\n3510.         This can be an expensive operation, particularly for a complex\\n3511.         expression tree.\\n3512. \\n3513.         All the corresponding parameter attributes are created that one\\n3514.         expects for the Model class.\\n3515. \\n3516.         The parameter objects that the attributes point to are the same\\n3517.         objects as in the constiutent models. Changes made to parameter\\n3518.         values to either are seen by both.\\n3519. \\n3520.         Prior to calling this, none of the associated attributes will\\n3521.         exist. This method must be called to make the model usable by\\n3522.         fitting engines.\\n3523. \\n3524.         If oldnames=True, then parameters are named as in the original\\n3525.         implementation of compound models.\\n3526.         """\\n3527.         if self._parameters is not None:\\n3528.             # do nothing\\n3529.             return\\n3530.         if self._leaflist is None:\\n3531.             self._make_leaflist()\\n3532.         self._parameters_ = {}\\n3533.         param_map = {}\\n3534.         self._param_names = []\\n3535.         for lindex, leaf in enumerate(self._leaflist):\\n3536.             if not isinstance(leaf, dict):\\n3537.                 for param_name in leaf.param_names:\\n3538.                     param = getattr(leaf, param_name)\\n3539.                     new_param_name = f"{param_name}_{lindex}"\\n3540.                     self.__dict__[new_param_name] = param\\n3541.                     self._parameters_[new_param_name] = param\\n3542.                     self._param_names.append(new_param_name)\\n3543.                     param_map[new_param_name] = (lindex, param_name)\\n3544.         self._param_metrics = {}\\n3545.         self._param_map = param_map\\n3546.         self._param_map_inverse = dict((v, k) for k, v in param_map.items())\\n3547.         self._initialize_slices()\\n3548.         self._param_names = tuple(self._param_names)\\n3549. \\n3550.     def _initialize_slices(self):\\n3551.         param_metrics = self._param_metrics\\n3552.         total_size = 0\\n3553. \\n3554.         for name in self.param_names:\\n3555.             param = getattr(self, name)\\n3556.             value = param.value\\n3557.             param_size = np.size(value)\\n3558.             param_shape = np.shape(value)\\n3559.             param_slice = slice(total_size, total_size + param_size)\\n3560.             param_metrics[name] = {}\\n3561.             param_metrics[name][\\\'slice\\\'] = param_slice\\n3562.             param_metrics[name][\\\'shape\\\'] = param_shape\\n3563.             param_metrics[name][\\\'size\\\'] = param_size\\n3564.             total_size += param_size\\n3565.         self._parameters = np.empty(total_size, dtype=np.float64)\\n3566. \\n3567.     @staticmethod\\n3568.     def _recursive_lookup(branch, adict, key):\\n3569.         if isinstance(branch, CompoundModel):\\n3570.             return adict[key]\\n3571.         return branch, key\\n3572. \\n3573.     def inputs_map(self):\\n3574.         """\\n3575.         Map the names of the inputs to this ExpressionTree to the inputs to the leaf models.\\n3576.         """\\n3577.         inputs_map = {}\\n3578.         if not isinstance(self.op, str):  # If we don\\\'t have an operator the mapping is trivial\\n3579.             return {inp: (self, inp) for inp in self.inputs}\\n3580. \\n3581.         elif self.op == \\\'|\\\':\\n3582.             if isinstance(self.left, CompoundModel):\\n3583.                 l_inputs_map = self.left.inputs_map()\\n3584.             for inp in self.inputs:\\n3585.                 if isinstance(self.left, CompoundModel):\\n3586.                     inputs_map[inp] = l_inputs_map[inp]\\n3587.                 else:\\n3588.                     inputs_map[inp] = self.left, inp\\n3589.         elif self.op == \\\'&\\\':\\n3590.             if isinstance(self.left, CompoundModel):\\n3591.                 l_inputs_map = self.left.inputs_map()\\n3592.             if isinstance(self.right, CompoundModel):\\n3593.                 r_inputs_map = self.right.inputs_map()\\n3594.             for i, inp in enumerate(self.inputs):\\n3595.                 if i < len(self.left.inputs):  # Get from left\\n3596.                     if isinstance(self.left, CompoundModel):\\n3597.                         inputs_map[inp] = l_inputs_map[self.left.inputs[i]]\\n3598.                     else:\\n3599.                         inputs_map[inp] = self.left, self.left.inputs[i]\\n3600.                 else:  # Get from right\\n3601.                     if isinstance(self.right, CompoundModel):\\n3602.                         inputs_map[inp] = r_inputs_map[self.right.inputs[i - len(self.left.inputs)]]\\n3603.                     else:\\n3604.                         inputs_map[inp] = self.right, self.right.inputs[i - len(self.left.inputs)]\\n3605.         elif self.op == \\\'fix_inputs\\\':\\n3606.             fixed_ind = list(self.right.keys())\\n3607.             ind = [list(self.left.inputs).index(i) if isinstance(i, str) else i for i in fixed_ind]\\n3608.             inp_ind = list(range(self.left.n_inputs))\\n3609.             for i in ind:\\n3610.                 inp_ind.remove(i)\\n3611.             for i in inp_ind:\\n3612.                 inputs_map[self.left.inputs[i]] = self.left, self.left.inputs[i]\\n3613.         else:\\n3614.             if isinstance(self.left, CompoundModel):\\n3615.                 l_inputs_map = self.left.inputs_map()\\n3616.             for inp in self.left.inputs:\\n3617.                 if isinstance(self.left, CompoundModel):\\n3618.                     inputs_map[inp] = l_inputs_map[inp]\\n3619.                 else:\\n3620.                     inputs_map[inp] = self.left, inp\\n3621.         return inputs_map\\n3622. \\n3623.     def _parameter_units_for_data_units(self, input_units, output_units):\\n3624.         if self._leaflist is None:\\n3625.             self._map_parameters()\\n3626.         units_for_data = {}\\n3627.         for imodel, model in enumerate(self._leaflist):\\n3628.             units_for_data_leaf = model._parameter_units_for_data_units(input_units, output_units)\\n3629.             for param_leaf in units_for_data_leaf:\\n3630.                 param = self._param_map_inverse[(imodel, param_leaf)]\\n3631.                 units_for_data[param] = units_for_data_leaf[param_leaf]\\n3632.         return units_for_data\\n3633. \\n3634.     @property\\n3635.     def input_units(self):\\n3636.         inputs_map = self.inputs_map()\\n3637.         input_units_dict = {key: inputs_map[key][0].input_units[orig_key]\\n3638.                             for key, (mod, orig_key) in inputs_map.items()\\n3639.                             if inputs_map[key][0].input_units is not None}\\n3640.         if input_units_dict:\\n3641.             return input_units_dict\\n3642.         return None\\n3643. \\n3644.     @property\\n3645.     def input_units_equivalencies(self):\\n3646.         inputs_map = self.inputs_map()\\n3647.         input_units_equivalencies_dict = {\\n3648.             key: inputs_map[key][0].input_units_equivalencies[orig_key]\\n3649.             for key, (mod, orig_key) in inputs_map.items()\\n3650.             if inputs_map[key][0].input_units_equivalencies is not None\\n3651.         }\\n3652.         if not input_units_equivalencies_dict:\\n3653.             return None\\n3654. \\n3655.         return input_units_equivalencies_dict\\n3656. \\n3657.     @property\\n3658.     def input_units_allow_dimensionless(self):\\n3659.         inputs_map = self.inputs_map()\\n3660.         return {key: inputs_map[key][0].input_units_allow_dimensionless[orig_key]\\n3661.                 for key, (mod, orig_key) in inputs_map.items()}\\n3662. \\n3663.     @property\\n3664.     def input_units_strict(self):\\n3665.         inputs_map = self.inputs_map()\\n3666.         return {key: inputs_map[key][0].input_units_strict[orig_key]\\n3667.                 for key, (mod, orig_key) in inputs_map.items()}\\n3668. \\n3669.     @property\\n3670.     def return_units(self):\\n3671.         outputs_map = self.outputs_map()\\n3672.         return {key: outputs_map[key][0].return_units[orig_key]\\n3673.                 for key, (mod, orig_key) in outputs_map.items()\\n3674.                 if outputs_map[key][0].return_units is not None}\\n3675. \\n3676.     def outputs_map(self):\\n3677.         """\\n3678.         Map the names of the outputs to this ExpressionTree to the outputs to the leaf models.\\n3679.         """\\n3680.         outputs_map = {}\\n3681.         if not isinstance(self.op, str):  # If we don\\\'t have an operator the mapping is trivial\\n3682.             return {out: (self, out) for out in self.outputs}\\n3683. \\n3684.         elif self.op == \\\'|\\\':\\n3685.             if isinstance(self.right, CompoundModel):\\n3686.                 r_outputs_map = self.right.outputs_map()\\n3687.             for out in self.outputs:\\n3688.                 if isinstance(self.right, CompoundModel):\\n3689.                     outputs_map[out] = r_outputs_map[out]\\n3690.                 else:\\n3691.                     outputs_map[out] = self.right, out\\n3692. \\n3693.         elif self.op == \\\'&\\\':\\n3694.             if isinstance(self.left, CompoundModel):\\n3695.                 l_outputs_map = self.left.outputs_map()\\n3696.             if isinstance(self.right, CompoundModel):\\n3697.                 r_outputs_map = self.right.outputs_map()\\n3698.             for i, out in enumerate(self.outputs):\\n3699.                 if i < len(self.left.outputs):  # Get from left\\n3700.                     if isinstance(self.left, CompoundModel):\\n3701.                         outputs_map[out] = l_outputs_map[self.left.outputs[i]]\\n3702.                     else:\\n3703.                         outputs_map[out] = self.left, self.left.outputs[i]\\n3704.                 else:  # Get from right\\n3705.                     if isinstance(self.right, CompoundModel):\\n3706.                         outputs_map[out] = r_outputs_map[self.right.outputs[i - len(self.left.outputs)]]\\n3707.                     else:\\n3708.                         outputs_map[out] = self.right, self.right.outputs[i - len(self.left.outputs)]\\n3709.         elif self.op == \\\'fix_inputs\\\':\\n3710.             return self.left.outputs_map()\\n3711.         else:\\n3712.             if isinstance(self.left, CompoundModel):\\n3713.                 l_outputs_map = self.left.outputs_map()\\n3714.             for out in self.left.outputs:\\n3715.                 if isinstance(self.left, CompoundModel):\\n3716.                     outputs_map[out] = l_outputs_map()[out]\\n3717.                 else:\\n3718.                     outputs_map[out] = self.left, out\\n3719.         return outputs_map\\n3720. \\n3721.     @property\\n3722.     def has_user_bounding_box(self):\\n3723.         """\\n3724.         A flag indicating whether or not a custom bounding_box has been\\n3725.         assigned to this model by a user, via assignment to\\n3726.         ``model.bounding_box``.\\n3727.         """\\n3728. \\n3729.         return self._user_bounding_box is not None\\n3730. \\n3731.     def render(self, out=None, coords=None):\\n3732.         """\\n3733.         Evaluate a model at fixed positions, respecting the ``bounding_box``.\\n3734. \\n3735.         The key difference relative to evaluating the model directly is that\\n3736.         this method is limited to a bounding box if the `Model.bounding_box`\\n3737.         attribute is set.\\n3738. \\n3739.         Parameters\\n3740.         ----------\\n3741.         out : `numpy.ndarray`, optional\\n3742.             An array that the evaluated model will be added to.  If this is not\\n3743.             given (or given as ``None``), a new array will be created.\\n3744.         coords : array-like, optional\\n3745.             An array to be used to translate from the model\\\'s input coordinates\\n3746.             to the ``out`` array. It should have the property that\\n3747.             ``self(coords)`` yields the same shape as ``out``.  If ``out`` is\\n3748.             not specified, ``coords`` will be used to determine the shape of\\n3749.             the returned array. If this is not provided (or None), the model\\n3750.             will be evaluated on a grid determined by `Model.bounding_box`.\\n3751. \\n3752.         Returns\\n3753.         -------\\n3754.         out : `numpy.ndarray`\\n3755.             The model added to ``out`` if  ``out`` is not ``None``, or else a\\n3756.             new array from evaluating the model over ``coords``.\\n3757.             If ``out`` and ``coords`` are both `None`, the returned array is\\n3758.             limited to the `Model.bounding_box` limits. If\\n3759.             `Model.bounding_box` is `None`, ``arr`` or ``coords`` must be\\n3760.             passed.\\n3761. \\n3762.         Raises\\n3763.         ------\\n3764.         ValueError\\n3765.             If ``coords`` are not given and the the `Model.bounding_box` of\\n3766.             this model is not set.\\n3767. \\n3768.         Examples\\n3769.         --------\\n3770.         :ref:`astropy:bounding-boxes`\\n3771.         """\\n3772. \\n3773.         bbox = self.get_bounding_box()\\n3774. \\n3775.         ndim = self.n_inputs\\n3776. \\n3777.         if (coords is None) and (out is None) and (bbox is None):\\n3778.             raise ValueError(\\\'If no bounding_box is set, \\\'\\n3779.                              \\\'coords or out must be input.\\\')\\n3780. \\n3781.         # for consistent indexing\\n3782.         if ndim == 1:\\n3783.             if coords is not None:\\n3784.                 coords = [coords]\\n3785.             if bbox is not None:\\n3786.                 bbox = [bbox]\\n3787. \\n3788.         if coords is not None:\\n3789.             coords = np.asanyarray(coords, dtype=float)\\n3790.             # Check dimensions match out and model\\n3791.             assert len(coords) == ndim\\n3792.             if out is not None:\\n3793.                 if coords[0].shape != out.shape:\\n3794.                     raise ValueError(\\\'inconsistent shape of the output.\\\')\\n3795.             else:\\n3796.                 out = np.zeros(coords[0].shape)\\n3797. \\n3798.         if out is not None:\\n3799.             out = np.asanyarray(out)\\n3800.             if out.ndim != ndim:\\n3801.                 raise ValueError(\\\'the array and model must have the same \\\'\\n3802.                                  \\\'number of dimensions.\\\')\\n3803. \\n3804.         if bbox is not None:\\n3805.             # Assures position is at center pixel, important when using\\n3806.             # add_array.\\n3807.             pd = np.array([(np.mean(bb), np.ceil((bb[1] - bb[0]) / 2))\\n3808.                            for bb in bbox]).astype(int).T\\n3809.             pos, delta = pd\\n3810. \\n3811.             if coords is not None:\\n3812.                 sub_shape = tuple(delta * 2 + 1)\\n3813.                 sub_coords = np.array([extract_array(c, sub_shape, pos)\\n3814.                                        for c in coords])\\n3815.             else:\\n3816.                 limits = [slice(p - d, p + d + 1, 1) for p, d in pd.T]\\n3817.                 sub_coords = np.mgrid[limits]\\n3818. \\n3819.             sub_coords = sub_coords[::-1]\\n3820. \\n3821.             if out is None:\\n3822.                 out = self(*sub_coords)\\n3823.             else:\\n3824.                 try:\\n3825.                     out = add_array(out, self(*sub_coords), pos)\\n3826.                 except ValueError:\\n3827.                     raise ValueError(\\n3828.                         \\\'The `bounding_box` is larger than the input out in \\\'\\n3829.                         \\\'one or more dimensions. Set \\\'\\n3830.                         \\\'`model.bounding_box = None`.\\\')\\n3831.         else:\\n3832.             if coords is None:\\n3833.                 im_shape = out.shape\\n3834.                 limits = [slice(i) for i in im_shape]\\n3835.                 coords = np.mgrid[limits]\\n3836. \\n3837.             coords = coords[::-1]\\n3838. \\n3839.             out += self(*coords)\\n3840. \\n3841.         return out\\n3842. \\n3843.     def replace_submodel(self, name, model):\\n3844.         """\\n3845.         Construct a new `~astropy.modeling.CompoundModel` instance from an\\n3846.         existing CompoundModel, replacing the named submodel with a new model.\\n3847. \\n3848.         In order to ensure that inverses and names are kept/reconstructed, it\\\'s\\n3849.         necessary to rebuild the CompoundModel from the replaced node all the\\n3850.         way back to the base. The original CompoundModel is left untouched.\\n3851. \\n3852.         Parameters\\n3853.         ----------\\n3854.         name : str\\n3855.             name of submodel to be replaced\\n3856.         model : `~astropy.modeling.Model`\\n3857.             replacement model\\n3858.         """\\n3859.         submodels = [m for m in self.traverse_postorder()\\n3860.                      if getattr(m, \\\'name\\\', None) == name]\\n3861.         if submodels:\\n3862.             if len(submodels) > 1:\\n3863.                 raise ValueError(f"More than one submodel named {name}")\\n3864. \\n3865.             old_model = submodels.pop()\\n3866.             if len(old_model) != len(model):\\n3867.                 raise ValueError("New and old models must have equal values "\\n3868.                                  "for n_models")\\n3869. \\n3870.             # Do this check first in order to raise a more helpful Exception,\\n3871.             # although it would fail trying to construct the new CompoundModel\\n3872.             if (old_model.n_inputs != model.n_inputs or\\n3873.                         old_model.n_outputs != model.n_outputs):\\n3874.                 raise ValueError("New model must match numbers of inputs and "\\n3875.                                  "outputs of existing model")\\n3876. \\n3877.             tree = _get_submodel_path(self, name)\\n3878.             while tree:\\n3879.                 branch = self.copy()\\n3880.                 for node in tree[:-1]:\\n3881.                     branch = getattr(branch, node)\\n3882.                 setattr(branch, tree[-1], model)\\n3883.                 model = CompoundModel(branch.op, branch.left, branch.right,\\n3884.                                       name=branch.name)\\n3885.                 tree = tree[:-1]\\n3886.             return model\\n3887. \\n3888.         else:\\n3889.             raise ValueError(f"No submodels found named {name}")\\n3890. \\n3891.     def _set_sub_models_and_parameter_units(self, left, right):\\n3892.         """\\n3893.         Provides a work-around to properly set the sub models and respective\\n3894.         parameters\\\'s units/values when using ``without_units_for_data``\\n3895.         or ``without_units_for_data`` methods.\\n3896.         """\\n3897.         model = CompoundModel(self.op, left, right)\\n3898. \\n3899.         self.left = left\\n3900.         self.right = right\\n3901. \\n3902.         for name in model.param_names:\\n3903.             model_parameter = getattr(model, name)\\n3904.             parameter = getattr(self, name)\\n3905. \\n3906.             parameter.value = model_parameter.value\\n3907.             parameter._set_unit(model_parameter.unit, force=True)\\n3908. \\n3909.     def without_units_for_data(self, **kwargs):\\n3910.         """\\n3911.         See `~astropy.modeling.Model.without_units_for_data` for overview\\n3912.         of this method.\\n3913. \\n3914.         Notes\\n3915.         -----\\n3916.         This modifies the behavior of the base method to account for the\\n3917.         case where the sub-models of a compound model have different output\\n3918.         units. This is only valid for compound * and / compound models as\\n3919.         in that case it is reasonable to mix the output units. It does this\\n3920.         by modifying the output units of each sub model by using the output\\n3921.         units of the other sub model so that we can apply the original function\\n3922.         and get the desired result.\\n3923. \\n3924.         Additional data has to be output in the mixed output unit case\\n3925.         so that the units can be properly rebuilt by\\n3926.         `~astropy.modeling.CompoundModel.with_units_from_data`.\\n3927. \\n3928.         Outside the mixed output units, this method is identical to the\\n3929.         base method.\\n3930.         """\\n3931.         if self.op in [\\\'*\\\', \\\'/\\\']:\\n3932.             model = self.copy()\\n3933.             inputs = {inp: kwargs[inp] for inp in self.inputs}\\n3934. \\n3935.             left_units = self.left.output_units(**kwargs)\\n3936.             right_units = self.right.output_units(**kwargs)\\n3937. \\n3938.             if self.op == \\\'*\\\':\\n3939.                 left_kwargs = {out: kwargs[out] / right_units[out]\\n3940.                                for out in self.left.outputs if kwargs[out] is not None}\\n3941.                 right_kwargs = {out: kwargs[out] / left_units[out]\\n3942.                                 for out in self.right.outputs if kwargs[out] is not None}\\n3943.             else:\\n3944.                 left_kwargs = {out: kwargs[out] * right_units[out]\\n3945.                                for out in self.left.outputs if kwargs[out] is not None}\\n3946.                 right_kwargs = {out: 1 / kwargs[out] * left_units[out]\\n3947.                                 for out in self.right.outputs if kwargs[out] is not None}\\n3948. \\n3949.             left_kwargs.update(inputs.copy())\\n3950.             right_kwargs.update(inputs.copy())\\n3951. \\n3952.             left = self.left.without_units_for_data(**left_kwargs)\\n3953.             if isinstance(left, tuple):\\n3954.                 left_kwargs[\\\'_left_kwargs\\\'] = left[1]\\n3955.                 left_kwargs[\\\'_right_kwargs\\\'] = left[2]\\n3956.                 left = left[0]\\n3957. \\n3958.             right = self.right.without_units_for_data(**right_kwargs)\\n3959.             if isinstance(right, tuple):\\n3960.                 right_kwargs[\\\'_left_kwargs\\\'] = right[1]\\n3961.                 right_kwargs[\\\'_right_kwargs\\\'] = right[2]\\n3962.                 right = right[0]\\n3963. \\n3964.             model._set_sub_models_and_parameter_units(left, right)\\n3965. \\n3966.             return model, left_kwargs, right_kwargs\\n3967.         else:\\n3968.             return super().without_units_for_data(**kwargs)\\n3969. \\n3970.     def with_units_from_data(self, **kwargs):\\n3971.         """\\n3972.         See `~astropy.modeling.Model.with_units_from_data` for overview\\n3973.         of this method.\\n3974. \\n3975.         Notes\\n3976.         -----\\n3977.         This modifies the behavior of the base method to account for the\\n3978.         case where the sub-models of a compound model have different output\\n3979.         units. This is only valid for compound * and / compound models as\\n3980.         in that case it is reasonable to mix the output units. In order to\\n3981.         do this it requires some additional information output by\\n3982.         `~astropy.modeling.CompoundModel.without_units_for_data` passed as\\n3983.         keyword arguments under the keywords ``_left_kwargs`` and ``_right_kwargs``.\\n3984. \\n3985.         Outside the mixed output units, this method is identical to the\\n3986.         base method.\\n3987.         """\\n3988. \\n3989.         if self.op in [\\\'*\\\', \\\'/\\\']:\\n3990.             left_kwargs = kwargs.pop(\\\'_left_kwargs\\\')\\n3991.             right_kwargs = kwargs.pop(\\\'_right_kwargs\\\')\\n3992. \\n3993.             left = self.left.with_units_from_data(**left_kwargs)\\n3994.             right = self.right.with_units_from_data(**right_kwargs)\\n3995. \\n3996.             model = self.copy()\\n3997.             model._set_sub_models_and_parameter_units(left, right)\\n3998. \\n3999.             return model\\n4000.         else:\\n4001.             return super().with_units_from_data(**kwargs)\\n4002. \\n4003. \\n4004. def _get_submodel_path(model, name):\\n4005.     """Find the route down a CompoundModel\\\'s tree to the model with the\\n4006.     specified name (whether it\\\'s a leaf or not)"""\\n4007.     if getattr(model, \\\'name\\\', None) == name:\\n4008.         return []\\n4009.     try:\\n4010.         return [\\\'left\\\'] + _get_submodel_path(model.left, name)\\n4011.     except (AttributeError, TypeError):\\n4012.         pass\\n4013.     try:\\n4014.         return [\\\'right\\\'] + _get_submodel_path(model.right, name)\\n4015.     except (AttributeError, TypeError):\\n4016.         pass\\n4017. \\n4018. \\n4019. def binary_operation(binoperator, left, right):\\n4020.     \\\'\\\'\\\'\\n4021.     Perform binary operation. Operands may be matching tuples of operands.\\n4022.     \\\'\\\'\\\'\\n4023.     if isinstance(left, tuple) and isinstance(right, tuple):\\n4024.         return tuple([binoperator(item[0], item[1])\\n4025.                       for item in zip(left, right)])\\n4026.     return binoperator(left, right)\\n4027. \\n4028. \\n4029. def get_ops(tree, opset):\\n4030.     """\\n4031.     Recursive function to collect operators used.\\n4032.     """\\n4033.     if isinstance(tree, CompoundModel):\\n4034.         opset.add(tree.op)\\n4035.         get_ops(tree.left, opset)\\n4036.         get_ops(tree.right, opset)\\n4037.     else:\\n4038.         return\\n4039. \\n4040. \\n4041. def make_subtree_dict(tree, nodepath, tdict, leaflist):\\n4042.     \\\'\\\'\\\'\\n4043.     Traverse a tree noting each node by a key that indicates all the\\n4044.     left/right choices necessary to reach that node. Each key will\\n4045.     reference a tuple that contains:\\n4046. \\n4047.     - reference to the compound model for that node.\\n4048.     - left most index contained within that subtree\\n4049.        (relative to all indices for the whole tree)\\n4050.     - right most index contained within that subtree\\n4051.     \\\'\\\'\\\'\\n4052.     # if this is a leaf, just append it to the leaflist\\n4053.     if not hasattr(tree, \\\'isleaf\\\'):\\n4054.         leaflist.append(tree)\\n4055.     else:\\n4056.         leftmostind = len(leaflist)\\n4057.         make_subtree_dict(tree.left, nodepath+\\\'l\\\', tdict, leaflist)\\n4058.         make_subtree_dict(tree.right, nodepath+\\\'r\\\', tdict, leaflist)\\n4059.         rightmostind = len(leaflist)-1\\n4060.         tdict[nodepath] = (tree, leftmostind, rightmostind)\\n4061. \\n4062. \\n4063. _ORDER_OF_OPERATORS = [(\\\'fix_inputs\\\',), (\\\'|\\\',), (\\\'&\\\',), (\\\'+\\\', \\\'-\\\'), (\\\'*\\\', \\\'/\\\'), (\\\'**\\\',)]\\n4064. OPERATOR_PRECEDENCE = {}\\n4065. for idx, ops in enumerate(_ORDER_OF_OPERATORS):\\n4066.     for op in ops:\\n4067.         OPERATOR_PRECEDENCE[op] = idx\\n4068. del idx, op, ops\\n4069. \\n4070. \\n4071. def fix_inputs(modelinstance, values, bounding_boxes=None, selector_args=None):\\n4072.     """\\n4073.     This function creates a compound model with one or more of the input\\n4074.     values of the input model assigned fixed values (scalar or array).\\n4075. \\n4076.     Parameters\\n4077.     ----------\\n4078.     modelinstance : `~astropy.modeling.Model` instance\\n4079.         This is the model that one or more of the\\n4080.         model input values will be fixed to some constant value.\\n4081.     values : dict\\n4082.         A dictionary where the key identifies which input to fix\\n4083.         and its value is the value to fix it at. The key may either be the\\n4084.         name of the input or a number reflecting its order in the inputs.\\n4085. \\n4086.     Examples\\n4087.     --------\\n4088. \\n4089.     >>> from astropy.modeling.models import Gaussian2D\\n4090.     >>> g = Gaussian2D(1, 2, 3, 4, 5)\\n4091.     >>> gv = fix_inputs(g, {0: 2.5})\\n4092. \\n4093.     Results in a 1D function equivalent to Gaussian2D(1, 2, 3, 4, 5)(x=2.5, y)\\n4094.     """\\n4095.     model = CompoundModel(\\\'fix_inputs\\\', modelinstance, values)\\n4096.     if bounding_boxes is not None:\\n4097.         if selector_args is None:\\n4098.             selector_args = tuple([(key, True) for key in values.keys()])\\n4099.         bbox = CompoundBoundingBox.validate(modelinstance, bounding_boxes, selector_args)\\n4100.         _selector = bbox.selector_args.get_fixed_values(modelinstance, values)\\n4101. \\n4102.         new_bbox = bbox[_selector]\\n4103.         new_bbox = new_bbox.__class__.validate(model, new_bbox)\\n4104. \\n4105.         model.bounding_box = new_bbox\\n4106.     return model\\n4107. \\n4108. \\n4109. def bind_bounding_box(modelinstance, bounding_box, ignored=None, order=\\\'C\\\'):\\n4110.     """\\n4111.     Set a validated bounding box to a model instance.\\n4112. \\n4113.     Parameters\\n4114.     ----------\\n4115.     modelinstance : `~astropy.modeling.Model` instance\\n4116.         This is the model that the validated bounding box will be set on.\\n4117.     bounding_box : tuple\\n4118.         A bounding box tuple, see :ref:`astropy:bounding-boxes` for details\\n4119.     ignored : list\\n4120.         List of the inputs to be ignored by the bounding box.\\n4121.     order : str, optional\\n4122.         The ordering of the bounding box tuple, can be either ``\\\'C\\\'`` or\\n4123.         ``\\\'F\\\'``.\\n4124.     """\\n4125.     modelinstance.bounding_box = ModelBoundingBox.validate(modelinstance,\\n4126.                                                            bounding_box,\\n4127.                                                            ignored=ignored,\\n4128.                                                            order=order)\\n4129. \\n4130. \\n4131. def bind_compound_bounding_box(modelinstance, bounding_boxes, selector_args,\\n4132.                                create_selector=None, ignored=None, order=\\\'C\\\'):\\n4133.     """\\n4134.     Add a validated compound bounding box to a model instance.\\n4135. \\n4136.     Parameters\\n4137.     ----------\\n4138.     modelinstance : `~astropy.modeling.Model` instance\\n4139.         This is the model that the validated compound bounding box will be set on.\\n4140.     bounding_boxes : dict\\n4141.         A dictionary of bounding box tuples, see :ref:`astropy:bounding-boxes`\\n4142.         for details.\\n4143.     selector_args : list\\n4144.         List of selector argument tuples to define selection for compound\\n4145.         bounding box, see :ref:`astropy:bounding-boxes` for details.\\n4146.     create_selector : callable, optional\\n4147.         An optional callable with interface (selector_value, model) which\\n4148.         can generate a bounding box based on a selector value and model if\\n4149.         there is no bounding box in the compound bounding box listed under\\n4150.         that selector value. Default is ``None``, meaning new bounding\\n4151.         box entries will not be automatically generated.\\n4152.     ignored : list\\n4153.         List of the inputs to be ignored by the bounding box.\\n4154.     order : str, optional\\n4155.         The ordering of the bounding box tuple, can be either ``\\\'C\\\'`` or\\n4156.         ``\\\'F\\\'``.\\n4157.     """\\n4158.     modelinstance.bounding_box = CompoundBoundingBox.validate(modelinstance,\\n4159.                                                               bounding_boxes, selector_args,\\n4160.                                                               create_selector=create_selector,\\n4161.                                                               ignored=ignored,\\n4162.                                                               order=order)\\n4163. \\n4164. \\n4165. def custom_model(*args, fit_deriv=None):\\n4166.     """\\n4167.     Create a model from a user defined function. The inputs and parameters of\\n4168.     the model will be inferred from the arguments of the function.\\n4169. \\n4170.     This can be used either as a function or as a decorator.  See below for\\n4171.     examples of both usages.\\n4172. \\n4173.     The model is separable only if there is a single input.\\n4174. \\n4175.     .. note::\\n4176. \\n4177.         All model parameters have to be defined as keyword arguments with\\n4178.         default values in the model function.  Use `None` as a default argument\\n4179.         value if you do not want to have a default value for that parameter.\\n4180. \\n4181.         The standard settable model properties can be configured by default\\n4182.         using keyword arguments matching the name of the property; however,\\n4183.         these values are not set as model "parameters". Moreover, users\\n4184.         cannot use keyword arguments matching non-settable model properties,\\n4185.         with the exception of ``n_outputs`` which should be set to the number of\\n4186.         outputs of your function.\\n4187. \\n4188.     Parameters\\n4189.     ----------\\n4190.     func : function\\n4191.         Function which defines the model.  It should take N positional\\n4192.         arguments where ``N`` is dimensions of the model (the number of\\n4193.         independent variable in the model), and any number of keyword arguments\\n4194.         (the parameters).  It must return the value of the model (typically as\\n4195.         an array, but can also be a scalar for scalar inputs).  This\\n4196.         corresponds to the `~astropy.modeling.Model.evaluate` method.\\n4197.     fit_deriv : function, optional\\n4198.         Function which defines the Jacobian derivative of the model. I.e., the\\n4199.         derivative with respect to the *parameters* of the model.  It should\\n4200.         have the same argument signature as ``func``, but should return a\\n4201.         sequence where each element of the sequence is the derivative\\n4202.         with respect to the corresponding argument. This corresponds to the\\n4203.         :meth:`~astropy.modeling.FittableModel.fit_deriv` method.\\n4204. \\n4205.     Examples\\n4206.     --------\\n4207.     Define a sinusoidal model function as a custom 1D model::\\n4208. \\n4209.         >>> from astropy.modeling.models import custom_model\\n4210.         >>> import numpy as np\\n4211.         >>> def sine_model(x, amplitude=1., frequency=1.):\\n4212.         ...     return amplitude * np.sin(2 * np.pi * frequency * x)\\n4213.         >>> def sine_deriv(x, amplitude=1., frequency=1.):\\n4214.         ...     return 2 * np.pi * amplitude * np.cos(2 * np.pi * frequency * x)\\n4215.         >>> SineModel = custom_model(sine_model, fit_deriv=sine_deriv)\\n4216. \\n4217.     Create an instance of the custom model and evaluate it::\\n4218. \\n4219.         >>> model = SineModel()\\n4220.         >>> model(0.25)\\n4221.         1.0\\n4222. \\n4223.     This model instance can now be used like a usual astropy model.\\n4224. \\n4225.     The next example demonstrates a 2D Moffat function model, and also\\n4226.     demonstrates the support for docstrings (this example could also include\\n4227.     a derivative, but it has been omitted for simplicity)::\\n4228. \\n4229.         >>> @custom_model\\n4230.         ... def Moffat2D(x, y, amplitude=1.0, x_0=0.0, y_0=0.0, gamma=1.0,\\n4231.         ...            alpha=1.0):\\n4232.         ...     \\\\"\\\\"\\\\"Two dimensional Moffat function.\\\\"\\\\"\\\\"\\n4233.         ...     rr_gg = ((x - x_0) ** 2 + (y - y_0) ** 2) / gamma ** 2\\n4234.         ...     return amplitude * (1 + rr_gg) ** (-alpha)\\n4235.         ...\\n4236.         >>> print(Moffat2D.__doc__)\\n4237.         Two dimensional Moffat function.\\n4238.         >>> model = Moffat2D()\\n4239.         >>> model(1, 1)  # doctest: +FLOAT_CMP\\n4240.         0.3333333333333333\\n4241.     """\\n4242. \\n4243.     if len(args) == 1 and callable(args[0]):\\n4244.         return _custom_model_wrapper(args[0], fit_deriv=fit_deriv)\\n4245.     elif not args:\\n4246.         return functools.partial(_custom_model_wrapper, fit_deriv=fit_deriv)\\n4247.     else:\\n4248.         raise TypeError(\\n4249.             "{0} takes at most one positional argument (the callable/"\\n4250.             "function to be turned into a model.  When used as a decorator "\\n4251.             "it should be passed keyword arguments only (if "\\n4252.             "any).".format(__name__))\\n4253. \\n4254. \\n4255. def _custom_model_inputs(func):\\n4256.     """\\n4257.     Processes the inputs to the `custom_model`\\\'s function into the appropriate\\n4258.     categories.\\n4259. \\n4260.     Parameters\\n4261.     ----------\\n4262.     func : callable\\n4263. \\n4264.     Returns\\n4265.     -------\\n4266.     inputs : list\\n4267.         list of evaluation inputs\\n4268.     special_params : dict\\n4269.         dictionary of model properties which require special treatment\\n4270.     settable_params : dict\\n4271.         dictionary of defaults for settable model properties\\n4272.     params : dict\\n4273.         dictionary of model parameters set by `custom_model`\\\'s function\\n4274.     """\\n4275.     inputs, parameters = get_inputs_and_params(func)\\n4276. \\n4277.     special = [\\\'n_outputs\\\']\\n4278.     settable = [attr for attr, value in vars(Model).items()\\n4279.                 if isinstance(value, property) and value.fset is not None]\\n4280.     properties = [attr for attr, value in vars(Model).items()\\n4281.                   if isinstance(value, property) and value.fset is None and attr not in special]\\n4282. \\n4283.     special_params = {}\\n4284.     settable_params = {}\\n4285.     params = {}\\n4286.     for param in parameters:\\n4287.         if param.name in special:\\n4288.             special_params[param.name] = param.default\\n4289.         elif param.name in settable:\\n4290.             settable_params[param.name] = param.default\\n4291.         elif param.name in properties:\\n4292.             raise ValueError(f"Parameter \\\'{param.name}\\\' cannot be a model property: {properties}.")\\n4293.         else:\\n4294.             params[param.name] = param.default\\n4295. \\n4296.     return inputs, special_params, settable_params, params\\n4297. \\n4298. \\n4299. def _custom_model_wrapper(func, fit_deriv=None):\\n4300.     """\\n4301.     Internal implementation `custom_model`.\\n4302. \\n4303.     When `custom_model` is called as a function its arguments are passed to\\n4304.     this function, and the result of this function is returned.\\n4305. \\n4306.     When `custom_model` is used as a decorator a partial evaluation of this\\n4307.     function is returned by `custom_model`.\\n4308.     """\\n4309. \\n4310.     if not callable(func):\\n4311.         raise ModelDefinitionError(\\n4312.             "func is not callable; it must be a function or other callable "\\n4313.             "object")\\n4314. \\n4315.     if fit_deriv is not None and not callable(fit_deriv):\\n4316.         raise ModelDefinitionError(\\n4317.             "fit_deriv not callable; it must be a function or other "\\n4318.             "callable object")\\n4319. \\n4320.     model_name = func.__name__\\n4321. \\n4322.     inputs, special_params, settable_params, params = _custom_model_inputs(func)\\n4323. \\n4324.     if (fit_deriv is not None and\\n4325.             len(fit_deriv.__defaults__) != len(params)):\\n4326.         raise ModelDefinitionError("derivative function should accept "\\n4327.                                    "same number of parameters as func.")\\n4328. \\n4329.     params = {param: Parameter(param, default=default)\\n4330.               for param, default in params.items()}\\n4331. \\n4332.     mod = find_current_module(2)\\n4333.     if mod:\\n4334.         modname = mod.__name__\\n4335.     else:\\n4336.         modname = \\\'__main__\\\'\\n4337. \\n4338.     members = {\\n4339.         \\\'__module__\\\': str(modname),\\n4340.         \\\'__doc__\\\': func.__doc__,\\n4341.         \\\'n_inputs\\\': len(inputs),\\n4342.         \\\'n_outputs\\\': special_params.pop(\\\'n_outputs\\\', 1),\\n4343.         \\\'evaluate\\\': staticmethod(func),\\n4344.         \\\'_settable_properties\\\': settable_params\\n4345.     }\\n4346. \\n4347.     if fit_deriv is not None:\\n4348.         members[\\\'fit_deriv\\\'] = staticmethod(fit_deriv)\\n4349. \\n4350.     members.update(params)\\n4351. \\n4352.     cls = type(model_name, (FittableModel,), members)\\n4353.     cls._separable = True if (len(inputs) == 1) else False\\n4354.     return cls\\n4355. \\n4356. \\n4357. def render_model(model, arr=None, coords=None):\\n4358.     """\\n4359.     Evaluates a model on an input array. Evaluation is limited to\\n4360.     a bounding box if the `Model.bounding_box` attribute is set.\\n4361. \\n4362.     Parameters\\n4363.     ----------\\n4364.     model : `Model`\\n4365.         Model to be evaluated.\\n4366.     arr : `numpy.ndarray`, optional\\n4367.         Array on which the model is evaluated.\\n4368.     coords : array-like, optional\\n4369.         Coordinate arrays mapping to ``arr``, such that\\n4370.         ``arr[coords] == arr``.\\n4371. \\n4372.     Returns\\n4373.     -------\\n4374.     array : `numpy.ndarray`\\n4375.         The model evaluated on the input ``arr`` or a new array from\\n4376.         ``coords``.\\n4377.         If ``arr`` and ``coords`` are both `None`, the returned array is\\n4378.         limited to the `Model.bounding_box` limits. If\\n4379.         `Model.bounding_box` is `None`, ``arr`` or ``coords`` must be passed.\\n4380. \\n4381.     Examples\\n4382.     --------\\n4383.     :ref:`astropy:bounding-boxes`\\n4384.     """\\n4385. \\n4386.     bbox = model.bounding_box\\n4387. \\n4388.     if (coords is None) & (arr is None) & (bbox is None):\\n4389.         raise ValueError(\\\'If no bounding_box is set,\\\'\\n4390.                          \\\'coords or arr must be input.\\\')\\n4391. \\n4392.     # for consistent indexing\\n4393.     if model.n_inputs == 1:\\n4394.         if coords is not None:\\n4395.             coords = [coords]\\n4396.         if bbox is not None:\\n4397.             bbox = [bbox]\\n4398. \\n4399.     if arr is not None:\\n4400.         arr = arr.copy()\\n4401.         # Check dimensions match model\\n4402.         if arr.ndim != model.n_inputs:\\n4403.             raise ValueError(\\\'number of array dimensions inconsistent with \\\'\\n4404.                              \\\'number of model inputs.\\\')\\n4405.     if coords is not None:\\n4406.         # Check dimensions match arr and model\\n4407.         coords = np.array(coords)\\n4408.         if len(coords) != model.n_inputs:\\n4409.             raise ValueError(\\\'coordinate length inconsistent with the number \\\'\\n4410.                              \\\'of model inputs.\\\')\\n4411.         if arr is not None:\\n4412.             if coords[0].shape != arr.shape:\\n4413.                 raise ValueError(\\\'coordinate shape inconsistent with the \\\'\\n4414.                                  \\\'array shape.\\\')\\n4415.         else:\\n4416.             arr = np.zeros(coords[0].shape)\\n4417. \\n4418.     if bbox is not None:\\n4419.         # assures position is at center pixel, important when using add_array\\n4420.         pd = pos, delta = np.array([(np.mean(bb), np.ceil((bb[1] - bb[0]) / 2))\\n4421.                                     for bb in bbox]).astype(int).T\\n4422. \\n4423.         if coords is not None:\\n4424.             sub_shape = tuple(delta * 2 + 1)\\n4425.             sub_coords = np.array([extract_array(c, sub_shape, pos)\\n4426.                                    for c in coords])\\n4427.         else:\\n4428.             limits = [slice(p - d, p + d + 1, 1) for p, d in pd.T]\\n4429.             sub_coords = np.mgrid[limits]\\n4430. \\n4431.         sub_coords = sub_coords[::-1]\\n4432. \\n4433.         if arr is None:\\n4434.             arr = model(*sub_coords)\\n4435.         else:\\n4436.             try:\\n4437.                 arr = add_array(arr, model(*sub_coords), pos)\\n4438.             except ValueError:\\n4439.                 raise ValueError(\\\'The `bounding_box` is larger than the input\\\'\\n4440.                                  \\\' arr in one or more dimensions. Set \\\'\\n4441.                                  \\\'`model.bounding_box = None`.\\\')\\n4442.     else:\\n4443. \\n4444.         if coords is None:\\n4445.             im_shape = arr.shape\\n4446.             limits = [slice(i) for i in im_shape]\\n4447.             coords = np.mgrid[limits]\\n4448. \\n4449.         arr += model(*coords[::-1])\\n4450. \\n4451.     return arr\\n4452. \\n4453. \\n4454. def hide_inverse(model):\\n4455.     """\\n4456.     This is a convenience function intended to disable automatic generation\\n4457.     of the inverse in compound models by disabling one of the constituent\\n4458.     model\\\'s inverse. This is to handle cases where user provided inverse\\n4459.     functions are not compatible within an expression.\\n4460. \\n4461.     Example:\\n4462.         compound_model.inverse = hide_inverse(m1) + m2 + m3\\n4463. \\n4464.     This will insure that the defined inverse itself won\\\'t attempt to\\n4465.     build its own inverse, which would otherwise fail in this example\\n4466.     (e.g., m = m1 + m2 + m3 happens to raises an exception for this\\n4467.     reason.)\\n4468. \\n4469.     Note that this permanently disables it. To prevent that either copy\\n4470.     the model or restore the inverse later.\\n4471.     """\\n4472.     del model.inverse\\n4473.     return model\', \'start_line_number\': 3280, \'end_line_number\': 5000}\n\n{\'relative_path\': \'astropy/modeling/functional_models.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """Mathematical models."""\\n4. # pylint: disable=line-too-long, too-many-lines, too-many-arguments, invalid-name\\n5. import numpy as np\\n6. \\n7. from astropy import units as u\\n8. from astropy.units import Quantity, UnitsError\\n9. from .core import (Fittable1DModel, Fittable2DModel)\\n10. \\n11. from .parameters import Parameter, InputParameterError\\n12. from .utils import ellipse_extent\\n13. \\n14. \\n15. __all__ = [\\\'AiryDisk2D\\\', \\\'Moffat1D\\\', \\\'Moffat2D\\\', \\\'Box1D\\\', \\\'Box2D\\\', \\\'Const1D\\\',\\n16.            \\\'Const2D\\\', \\\'Ellipse2D\\\', \\\'Disk2D\\\', \\\'Gaussian1D\\\', \\\'Gaussian2D\\\',\\n17.            \\\'Linear1D\\\', \\\'Lorentz1D\\\', \\\'RickerWavelet1D\\\', \\\'RickerWavelet2D\\\',\\n18.            \\\'RedshiftScaleFactor\\\', \\\'Multiply\\\', \\\'Planar2D\\\', \\\'Scale\\\',\\n19.            \\\'Sersic1D\\\', \\\'Sersic2D\\\', \\\'Shift\\\',\\n20.            \\\'Sine1D\\\', \\\'Cosine1D\\\', \\\'Tangent1D\\\',\\n21.            \\\'ArcSine1D\\\', \\\'ArcCosine1D\\\', \\\'ArcTangent1D\\\',\\n22.            \\\'Trapezoid1D\\\', \\\'TrapezoidDisk2D\\\', \\\'Ring2D\\\', \\\'Voigt1D\\\',\\n23.            \\\'KingProjectedAnalytic1D\\\', \\\'Exponential1D\\\', \\\'Logarithmic1D\\\']\\n24. \\n25. TWOPI = 2 * np.pi\\n26. FLOAT_EPSILON = float(np.finfo(np.float32).tiny)\\n27. \\n28. # Note that we define this here rather than using the value defined in\\n29. # astropy.stats to avoid importing astropy.stats every time astropy.modeling\\n30. # is loaded.\\n31. GAUSSIAN_SIGMA_TO_FWHM = 2.0 * np.sqrt(2.0 * np.log(2.0))\\n32. \\n33. \\n34. class Gaussian1D(Fittable1DModel):\\n35.     """\\n36.     One dimensional Gaussian model.\\n37. \\n38.     Parameters\\n39.     ----------\\n40.     amplitude : float or `~astropy.units.Quantity`.\\n41.         Amplitude (peak value) of the Gaussian - for a normalized profile\\n42.         (integrating to 1), set amplitude = 1 / (stddev * np.sqrt(2 * np.pi))\\n43.     mean : float or `~astropy.units.Quantity`.\\n44.         Mean of the Gaussian.\\n45.     stddev : float or `~astropy.units.Quantity`.\\n46.         Standard deviation of the Gaussian with FWHM = 2 * stddev * np.sqrt(2 * np.log(2)).\\n47. \\n48.     Notes\\n49.     -----\\n50.     Either all or none of input ``x``, ``mean`` and ``stddev`` must be provided\\n51.     consistently with compatible units or as unitless numbers.\\n52. \\n53.     Model formula:\\n54. \\n55.         .. math:: f(x) = A e^{- \\\\\\\\frac{\\\\\\\\left(x - x_{0}\\\\\\\\right)^{2}}{2 \\\\\\\\sigma^{2}}}\\n56. \\n57.     Examples\\n58.     --------\\n59.     >>> from astropy.modeling import models\\n60.     >>> def tie_center(model):\\n61.     ...         mean = 50 * model.stddev\\n62.     ...         return mean\\n63.     >>> tied_parameters = {\\\'mean\\\': tie_center}\\n64. \\n65.     Specify that \\\'mean\\\' is a tied parameter in one of two ways:\\n66. \\n67.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3,\\n68.     ...                             tied=tied_parameters)\\n69. \\n70.     or\\n71. \\n72.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3)\\n73.     >>> g1.mean.tied\\n74.     False\\n75.     >>> g1.mean.tied = tie_center\\n76.     >>> g1.mean.tied\\n77.     <function tie_center at 0x...>\\n78. \\n79.     Fixed parameters:\\n80. \\n81.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3,\\n82.     ...                        fixed={\\\'stddev\\\': True})\\n83.     >>> g1.stddev.fixed\\n84.     True\\n85. \\n86.     or\\n87. \\n88.     >>> g1 = models.Gaussian1D(amplitude=10, mean=5, stddev=.3)\\n89.     >>> g1.stddev.fixed\\n90.     False\\n91.     >>> g1.stddev.fixed = True\\n92.     >>> g1.stddev.fixed\\n93.     True\\n94. \\n95.     .. plot::\\n96.         :include-source:\\n97. \\n98.         import numpy as np\\n99.         import matplotlib.pyplot as plt\\n100. \\n101.         from astropy.modeling.models import Gaussian1D\\n102. \\n103.         plt.figure()\\n104.         s1 = Gaussian1D()\\n105.         r = np.arange(-5, 5, .01)\\n106. \\n107.         for factor in range(1, 4):\\n108.             s1.amplitude = factor\\n109.             plt.plot(r, s1(r), color=str(0.25 * factor), lw=2)\\n110. \\n111.         plt.axis([-5, 5, -1, 4])\\n112.         plt.show()\\n113. \\n114.     See Also\\n115.     --------\\n116.     Gaussian2D, Box1D, Moffat1D, Lorentz1D\\n117.     """\\n118. \\n119.     amplitude = Parameter(default=1, description="Amplitude (peak value) of the Gaussian")\\n120.     mean = Parameter(default=0, description="Position of peak (Gaussian)")\\n121. \\n122.     # Ensure stddev makes sense if its bounds are not explicitly set.\\n123.     # stddev must be non-zero and positive.\\n124.     stddev = Parameter(default=1, bounds=(FLOAT_EPSILON, None), description="Standard deviation of the Gaussian")\\n125. \\n126.     def bounding_box(self, factor=5.5):\\n127.         """\\n128.         Tuple defining the default ``bounding_box`` limits,\\n129.         ``(x_low, x_high)``\\n130. \\n131.         Parameters\\n132.         ----------\\n133.         factor : float\\n134.             The multiple of `stddev` used to define the limits.\\n135.             The default is 5.5, corresponding to a relative error < 1e-7.\\n136. \\n137.         Examples\\n138.         --------\\n139.         >>> from astropy.modeling.models import Gaussian1D\\n140.         >>> model = Gaussian1D(mean=0, stddev=2)\\n141.         >>> model.bounding_box\\n142.         (-11.0, 11.0)\\n143. \\n144.         This range can be set directly (see: `Model.bounding_box\\n145.         <astropy.modeling.Model.bounding_box>`) or by using a different factor,\\n146.         like:\\n147. \\n148.         >>> model.bounding_box = model.bounding_box(factor=2)\\n149.         >>> model.bounding_box\\n150.         (-4.0, 4.0)\\n151.         """\\n152. \\n153.         x0 = self.mean\\n154.         dx = factor * self.stddev\\n155. \\n156.         return (x0 - dx, x0 + dx)\\n157. \\n158.     @property\\n159.     def fwhm(self):\\n160.         """Gaussian full width at half maximum."""\\n161.         return self.stddev * GAUSSIAN_SIGMA_TO_FWHM\\n162. \\n163.     @staticmethod\\n164.     def evaluate(x, amplitude, mean, stddev):\\n165.         """\\n166.         Gaussian1D model function.\\n167.         """\\n168.         return amplitude * np.exp(- 0.5 * (x - mean) ** 2 / stddev ** 2)\\n169. \\n170.     @staticmethod\\n171.     def fit_deriv(x, amplitude, mean, stddev):\\n172.         """\\n173.         Gaussian1D model function derivatives.\\n174.         """\\n175. \\n176.         d_amplitude = np.exp(-0.5 / stddev ** 2 * (x - mean) ** 2)\\n177.         d_mean = amplitude * d_amplitude * (x - mean) / stddev ** 2\\n178.         d_stddev = amplitude * d_amplitude * (x - mean) ** 2 / stddev ** 3\\n179.         return [d_amplitude, d_mean, d_stddev]\\n180. \\n181.     @property\\n182.     def input_units(self):\\n183.         if self.mean.unit is None:\\n184.             return None\\n185.         return {self.inputs[0]: self.mean.unit}\\n186. \\n187.     def _parameter_units_for_data_units(self, inputs_unit, outputs_unit):\\n188.         return {\\\'mean\\\': inputs_unit[self.inputs[0]],\\n189.                 \\\'stddev\\\': inputs_unit[self.inputs[0]],\\n190.                 \\\'amplitude\\\': outputs_unit[self.outputs[0]]}\\n191. \\n192. \\n193. class Gaussian2D(Fittable2DModel):\\n194.     r"""\\n195.     Two dimensional Gaussian model.\\n196. \\n197.     Parameters\\n198.     ----------\\n199.     amplitude : float or `~astropy.units.Quantity`.\\n200.         Amplitude (peak value) of the Gaussian.\\n201.     x_mean : float or `~astropy.units.Quantity`.\\n202.         Mean of the Gaussian in x.\\n203.     y_mean : float or `~astropy.units.Quantity`.\\n204.         Mean of the Gaussian in y.\\n205.     x_stddev : float or `~astropy.units.Quantity` or None.\\n206.         Standard deviation of the Gaussian in x before rotating by theta. Must\\n207.         be None if a covariance matrix (``cov_matrix``) is provided. If no\\n208.         ``cov_matrix`` is given, ``None`` means the default value (1).\\n209.     y_stddev : float or `~astropy.units.Quantity` or None.\\n210.         Standard deviation of the Gaussian in y before rotating by theta. Must\\n211.         be None if a covariance matrix (``cov_matrix``) is provided. If no\\n212.         ``cov_matrix`` is given, ``None`` means the default value (1).\\n213.     theta : float or `~astropy.units.Quantity`, optional.\\n214.         Rotation angle (value in radians). The rotation angle increases\\n215.         counterclockwise.  Must be None if a covariance matrix (``cov_matrix``)\\n216.         is provided. If no ``cov_matrix`` is given, ``None`` means the default\\n217.         value (0).\\n218.     cov_matrix : ndarray, optional\\n219.         A 2x2 covariance matrix. If specified, overrides the ``x_stddev``,\\n220.         ``y_stddev``, and ``theta`` defaults.\\n221. \\n222.     Notes\\n223.     -----\\n224.     Either all or none of input ``x, y``, ``[x,y]_mean`` and ``[x,y]_stddev``\\n225.     must be provided consistently with compatible units or as unitless numbers.\\n226. \\n227.     Model formula:\\n228. \\n229.         .. math::\\n230. \\n231.             f(x, y) = A e^{-a\\\\left(x - x_{0}\\\\right)^{2}  -b\\\\left(x - x_{0}\\\\right)\\n232.             \\\\left(y - y_{0}\\\\right)  -c\\\\left(y - y_{0}\\\\right)^{2}}\\n233. \\n234.     Using the following definitions:\\n235. \\n236.         .. math::\\n237.             a = \\\\left(\\\\frac{\\\\cos^{2}{\\\\left (\\\\theta \\\\right )}}{2 \\\\sigma_{x}^{2}} +\\n238.             \\\\frac{\\\\sin^{2}{\\\\left (\\\\theta \\\\right )}}{2 \\\\sigma_{y}^{2}}\\\\right)\\n239. \\n240.             b = \\\\left(\\\\frac{\\\\sin{\\\\left (2 \\\\theta \\\\right )}}{2 \\\\sigma_{x}^{2}} -\\n241.             \\\\frac{\\\\sin{\\\\left (2 \\\\theta \\\\right )}}{2 \\\\sigma_{y}^{2}}\\\\right)\\n242. \\n243.             c = \\\\left(\\\\frac{\\\\sin^{2}{\\\\left (\\\\theta \\\\right )}}{2 \\\\sigma_{x}^{2}} +\\n244.             \\\\frac{\\\\cos^{2}{\\\\left (\\\\theta \\\\right )}}{2 \\\\sigma_{y}^{2}}\\\\right)\\n245. \\n246.     If using a ``cov_matrix``, the model is of the form:\\n247.         .. math::\\n248.             f(x, y) = A e^{-0.5 \\\\left(\\\\vec{x} - \\\\vec{x}_{0}\\\\right)^{T} \\\\Sigma^{-1} \\\\left(\\\\vec{x} - \\\\vec{x}_{0}\\\\right)}\\n249. \\n250.     where :math:`\\\\vec{x} = [x, y]`, :math:`\\\\vec{x}_{0} = [x_{0}, y_{0}]`,\\n251.     and :math:`\\\\Sigma` is the covariance matrix:\\n252. \\n253.         .. math::\\n254.             \\\\Sigma = \\\\left(\\\\begin{array}{ccc}\\n255.             \\\\sigma_x^2               & \\\\rho \\\\sigma_x \\\\sigma_y \\\\\\\\\\n256.             \\\\rho \\\\sigma_x \\\\sigma_y   & \\\\sigma_y^2\\n257.             \\\\end{array}\\\\right)\\n258. \\n259.     :math:`\\\\rho` is the correlation between ``x`` and ``y``, which should\\n260.     be between -1 and +1.  Positive correlation corresponds to a\\n261.     ``theta`` in the range 0 to 90 degrees.  Negative correlation\\n262.     corresponds to a ``theta`` in the range of 0 to -90 degrees.\\n263. \\n264.     See [1]_ for more details about the 2D Gaussian function.\\n265. \\n266.     See Also\\n267.     --------\\n268.     Gaussian1D, Box2D, Moffat2D\\n269. \\n270.     References\\n271.     ----------\\n272.     .. [1] https://en.wikipedia.org/wiki/Gaussian_function\\n273.     """\\n274. \\n275.     amplitude = Parameter(default=1, description="Amplitude of the Gaussian")\\n276.     x_mean = Parameter(default=0, description="Peak position (along x axis) of Gaussian")\\n277.     y_mean = Parameter(default=0, description="Peak position (along y axis) of Gaussian")\\n278.     x_stddev = Parameter(default=1, description="Standard deviation of the Gaussian (along x axis)")\\n279.     y_stddev = Parameter(default=1, description="Standard deviation of the Gaussian (along y axis)")\\n280.     theta = Parameter(default=0.0, description="Rotation angle [in radians] (Optional parameter)")\\n281. \\n282.     def __init__(self, amplitude=amplitude.default, x_mean=x_mean.default,\\n283.                  y_mean=y_mean.default, x_stddev=None, y_stddev=None,\\n284.                  theta=None, cov_matrix=None, **kwargs):\\n285.         if cov_matrix is None:\\n286.             if x_stddev is None:\\n287.                 x_stddev = self.__class__.x_stddev.default\\n288.             if y_stddev is None:\\n289.                 y_stddev = self.__class__.y_stddev.default\\n290.             if theta is None:\\n291.                 theta = self.__class__.theta.default\\n292.         else:\\n293.             if x_stddev is not None or y_stddev is not None or theta is not None:\\n294.                 raise InputParameterError("Cannot specify both cov_matrix and "\\n295.                                           "x/y_stddev/theta")\\n296.             # Compute principle coordinate system transformation\\n297.             cov_matrix = np.array(cov_matrix)\\n298. \\n299.             if cov_matrix.shape != (2, 2):\\n300.                 raise ValueError("Covariance matrix must be 2x2")\\n301. \\n302.             eig_vals, eig_vecs = np.linalg.eig(cov_matrix)\\n303.             x_stddev, y_stddev = np.sqrt(eig_vals)\\n304.             y_vec = eig_vecs[:, 0]\\n305.             theta = np.arctan2(y_vec[1], y_vec[0])\\n306. \\n307.         # Ensure stddev makes sense if its bounds are not explicitly set.\\n308.         # stddev must be non-zero and positive.\\n309.         # TODO: Investigate why setting this in Parameter above causes\\n310.         #       convolution tests to hang.\\n311.         kwargs.setdefault(\\\'bounds\\\', {})\\n312.         kwargs[\\\'bounds\\\'].setdefault(\\\'x_stddev\\\', (FLOAT_EPSILON, None))\\n313.         kwargs[\\\'bounds\\\'].setdefault(\\\'y_stddev\\\', (FLOAT_EPSILON, None))\\n314. \\n315.         super().__init__(\\n316.             amplitude=amplitude, x_mean=x_mean, y_mean=y_mean,\\n317.             x_stddev=x_stddev, y_stddev=y_stddev, theta=theta, **kwargs)\\n318. \\n319.     @property\\n320.     def x_fwhm(self):\\n321.         """Gaussian full width at half maximum in X."""\\n322.         return self.x_stddev * GAUSSIAN_SIGMA_TO_FWHM\\n323. \\n324.     @property\\n325.     def y_fwhm(self):\\n326.         """Gaussian full width at half maximum in Y."""\\n327.         return self.y_stddev * GAUSSIAN_SIGMA_TO_FWHM\\n328. \\n329.     def bounding_box(self, factor=5.5):\\n330.         """\\n331.         Tuple defining the default ``bounding_box`` limits in each dimension,\\n332.         ``((y_low, y_high), (x_low, x_high))``\\n333. \\n334.         The default offset from the mean is 5.5-sigma, corresponding\\n335.         to a relative error < 1e-7. The limits are adjusted for rotation.\\n336. \\n337.         Parameters\\n338.         ----------\\n339.         factor : float, optional\\n340.             The multiple of `x_stddev` and `y_stddev` used to define the limits.\\n341.             The default is 5.5.\\n342. \\n343.         Examples\\n344.         --------\\n345.         >>> from astropy.modeling.models import Gaussian2D\\n346.         >>> model = Gaussian2D(x_mean=0, y_mean=0, x_stddev=1, y_stddev=2)\\n347.         >>> model.bounding_box\\n348.         ((-11.0, 11.0), (-5.5, 5.5))\\n349. \\n350.         This range can be set directly (see: `Model.bounding_box\\n351.         <astropy.modeling.Model.bounding_box>`) or by using a different factor\\n352.         like:\\n353. \\n354.         >>> model.bounding_box = model.bounding_box(factor=2)\\n355.         >>> model.bounding_box\\n356.         ((-4.0, 4.0), (-2.0, 2.0))\\n357.         """\\n358. \\n359.         a = factor * self.x_stddev\\n360.         b = factor * self.y_stddev\\n361.         theta = self.theta.value\\n362.         dx, dy = ellipse_extent(a, b, theta)\\n363. \\n364.         return ((self.y_mean - dy, self.y_mean + dy),\\n365.                 (self.x_mean - dx, self.x_mean + dx))\\n366. \\n367.     @staticmethod\\n368.     def evaluate(x, y, amplitude, x_mean, y_mean, x_stddev, y_stddev, theta):\\n369.         """Two dimensional Gaussian function"""\\n370. \\n371.         cost2 = np.cos(theta) ** 2\\n372.         sint2 = np.sin(theta) ** 2\\n373.         sin2t = np.sin(2. * theta)\\n374.         xstd2 = x_stddev ** 2\\n375.         ystd2 = y_stddev ** 2\\n376.         xdiff = x - x_mean\\n377.         ydiff = y - y_mean\\n378.         a = 0.5 * ((cost2 / xstd2) + (sint2 / ystd2))\\n379.         b = 0.5 * ((sin2t / xstd2) - (sin2t / ystd2))\\n380.         c = 0.5 * ((sint2 / xstd2) + (cost2 / ystd2))\\n381.         return amplitude * np.exp(-((a * xdiff ** 2) + (b * xdiff * ydiff) +\\n382.                                     (c * ydiff ** 2)))\\n383. \\n384.     @staticmethod\\n385.     def fit_deriv(x, y, amplitude, x_mean, y_mean, x_stddev, y_stddev, theta):\\n386.         """Two dimensional Gaussian function derivative with respect to parameters"""\\n387. \\n388.         cost = np.cos(theta)\\n389.         sint = np.sin(theta)\\n390.         cost2 = np.cos(theta) ** 2\\n391.         sint2 = np.sin(theta) ** 2\\n392.         cos2t = np.cos(2. * theta)\\n393.         sin2t = np.sin(2. * theta)\\n394.         xstd2 = x_stddev ** 2\\n395.         ystd2 = y_stddev ** 2\\n396.         xstd3 = x_stddev ** 3\\n397.         ystd3 = y_stddev ** 3\\n398.         xdiff = x - x_mean\\n399.         ydiff = y - y_mean\\n400.         xdiff2 = xdiff ** 2\\n401.         ydiff2 = ydiff ** 2\\n402.         a = 0.5 * ((cost2 / xstd2) + (sint2 / ystd2))\\n403.         b = 0.5 * ((sin2t / xstd2) - (sin2t / ystd2))\\n404.         c = 0.5 * ((sint2 / xstd2) + (cost2 / ystd2))\\n405.         g = amplitude * np.exp(-((a * xdiff2) + (b * xdiff * ydiff) +\\n406.                                  (c * ydiff2)))\\n407.         da_dtheta = (sint * cost * ((1. / ystd2) - (1. / xstd2)))\\n408.         da_dx_stddev = -cost2 / xstd3\\n409.         da_dy_stddev = -sint2 / ystd3\\n410.         db_dtheta = (cos2t / xstd2) - (cos2t / ystd2)\\n411.         db_dx_stddev = -sin2t / xstd3\\n412.         db_dy_stddev = sin2t / ystd3\\n413.         dc_dtheta = -da_dtheta\\n414.         dc_dx_stddev = -sint2 / xstd3\\n415.         dc_dy_stddev = -cost2 / ystd3\\n416.         dg_dA = g / amplitude\\n417.         dg_dx_mean = g * ((2. * a * xdiff) + (b * ydiff))\\n418.         dg_dy_mean = g * ((b * xdiff) + (2. * c * ydiff))\\n419.         dg_dx_stddev = g * (-(da_dx_stddev * xdiff2 +\\n420.                               db_dx_stddev * xdiff * ydiff +\\n421.                               dc_dx_stddev * ydiff2))\\n422.         dg_dy_stddev = g * (-(da_dy_stddev * xdiff2 +\\n423.                               db_dy_stddev * xdiff * ydiff +\\n424.                               dc_dy_stddev * ydiff2))\\n425.         dg_dtheta = g * (-(da_dtheta * xdiff2 +\\n426.                            db_dtheta * xdiff * ydiff +\\n427.                            dc_dtheta * ydiff2))\\n428.         return [dg_dA, dg_dx_mean, dg_dy_mean, dg_dx_stddev, dg_dy_stddev,\\n429.                 dg_dtheta]\\n430. \\n431.     @property\\n432.     def input_units(self):\\n433.         if self.x_mean.unit is None and self.y_mean.unit is None:\\n434.             return None\\n435.         return {self.inputs[0]: self.x_mean.unit,\\n436.                 self.inputs[1]: self.y_mean.unit}\\n437. \\n438.     def _parameter_units_for_data_units(self, inputs_unit, outputs_unit):\\n439.         # Note that here we need to make sure that x and y are in the same\\n440.         # units otherwise this can lead to issues since rotation is not well\\n441.         # defined.\\n442.         if inputs_unit[self.inputs[0]] != inputs_unit[self.inputs[1]]:\\n443.             raise UnitsError("Units of \\\'x\\\' and \\\'y\\\' inputs should match")\\n444.         return {\\\'x_mean\\\': inputs_unit[self.inputs[0]],\\n445.                 \\\'y_mean\\\': inputs_unit[self.inputs[0]],\\n446.                 \\\'x_stddev\\\': inputs_unit[self.inputs[0]],\\n447.                 \\\'y_stddev\\\': inputs_unit[self.inputs[0]],\\n448.                 \\\'theta\\\': u.rad,\\n449.                 \\\'amplitude\\\': outputs_unit[self.outputs[0]]}\\n450. \\n451. \\n452. class Shift(Fittable1DModel):\\n453.     """\\n454.     Shift a coordinate.\\n455. \\n456.     Parameters\\n457.     ----------\\n458.     offset : float\\n459.         Offset to add to a coordinate.\\n460.     """\\n461. \\n462.     offset = Parameter(default=0, description="Offset to add to a model")\\n463.     linear = True\\n464. \\n465.     _has_inverse_bounding_box = True\\n466. \\n467.     @property\\n468.     def input_units(self):\\n469.         if self.offset.unit is None:\\n470.             return None\\n471.         return {self.inputs[0]: self.offset.unit}\\n472. \\n473.     @property\\n474.     def inverse(self):\\n475.         """One dimensional inverse Shift model function"""\\n476. \\n477.         inv = self.copy()\\n478.         inv.offset *= -1\\n479. \\n480.         try:\\n481.             self.bounding_box\\n482.         except NotImplementedError:\\n483.             pass\\n484.         else:\\n485.             inv.bounding_box = tuple(self.evaluate(x, self.offset) for x in self.bounding_box)\\n486. \\n487.         return inv\\n488. \\n489.     @staticmethod\\n490.     def evaluate(x, offset):\\n491.         """One dimensional Shift model function"""\\n492.         return x + offset\\n493. \\n494.     @staticmethod\\n495.     def sum_of_implicit_terms(x):\\n496.         """Evaluate the implicit term (x) of one dimensional Shift model"""\\n497.         return x\\n498. \\n499.     @staticmethod\\n500.     def fit_deriv(x, *params):\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/modeling/models.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. Creates a common namespace for all pre-defined models.\\n5. """\\n6. \\n7. # pylint: disable=unused-wildcard-import, unused-import, wildcard-import\\n8. \\n9. from .core import custom_model, hide_inverse, fix_inputs # pylint: disable=W0611\\n10. from .mappings import *\\n11. from .projections import *\\n12. from .rotations import *\\n13. from .polynomial import *\\n14. from .functional_models import *\\n15. from .physical_models import *\\n16. from .powerlaws import *\\n17. from .spline import *\\n18. from .tabular import *\\n19. from . import math_functions as math\\n20. \\n21. \\n22. # Attach a docstring explaining constraints to all models which support them.\\n23. # Note: add new models to this list\\n24. \\n25. CONSTRAINTS_DOC = """\\n26.     Other Parameters\\n27.     ----------------\\n28.     fixed : a dict, optional\\n29.         A dictionary ``{parameter_name: boolean}`` of parameters to not be\\n30.         varied during fitting. True means the parameter is held fixed.\\n31.         Alternatively the `~astropy.modeling.Parameter.fixed`\\n32.         property of a parameter may be used.\\n33.     tied : dict, optional\\n34.         A dictionary ``{parameter_name: callable}`` of parameters which are\\n35.         linked to some other parameter. The dictionary values are callables\\n36.         providing the linking relationship.  Alternatively the\\n37.         `~astropy.modeling.Parameter.tied` property of a parameter\\n38.         may be used.\\n39.     bounds : dict, optional\\n40.         A dictionary ``{parameter_name: value}`` of lower and upper bounds of\\n41.         parameters. Keys are parameter names. Values are a list or a tuple\\n42.         of length 2 giving the desired range for the parameter.\\n43.         Alternatively, the\\n44.         `~astropy.modeling.Parameter.min` and\\n45.         `~astropy.modeling.Parameter.max` properties of a parameter\\n46.         may be used.\\n47.     eqcons : list, optional\\n48.         A list of functions of length ``n`` such that ``eqcons[j](x0,*args) ==\\n49.         0.0`` in a successfully optimized problem.\\n50.     ineqcons : list, optional\\n51.         A list of functions of length ``n`` such that ``ieqcons[j](x0,*args) >=\\n52.         0.0`` is a successfully optimized problem.\\n53. """\\n54. \\n55. \\n56. MODELS_WITH_CONSTRAINTS = [\\n57.     AiryDisk2D, Moffat1D, Moffat2D, Box1D, Box2D,\\n58.     Const1D, Const2D, Ellipse2D, Disk2D,\\n59.     Gaussian1D, Gaussian2D,\\n60.     Linear1D, Lorentz1D, RickerWavelet1D, RickerWavelet2D,\\n61.     PowerLaw1D, Sersic1D, Sersic2D,\\n62.     Sine1D, Cosine1D, Tangent1D, ArcSine1D, ArcCosine1D, ArcTangent1D,\\n63.     Trapezoid1D, TrapezoidDisk2D,\\n64.     Chebyshev1D, Chebyshev2D, Hermite1D, Hermite2D, Legendre2D, Legendre1D,\\n65.     Polynomial1D, Polynomial2D, Voigt1D, KingProjectedAnalytic1D,\\n66.     NFW\\n67. ]\\n68. \\n69. \\n70. for item in MODELS_WITH_CONSTRAINTS:\\n71.     if isinstance(item.__doc__, str):\\n72.         item.__doc__ += CONSTRAINTS_DOC\', \'start_line_number\': 1, \'end_line_number\': 72}\n\n{\'relative_path\': \'astropy/modeling/projections.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. # -*- coding: utf-8 -*-\\n3. # pylint: disable=invalid-name\\n4. """\\n5. Implements projections--particularly sky projections defined in WCS Paper II\\n6. [1]_.\\n7. \\n8. All angles are set and and displayed in degrees but internally computations are\\n9. performed in radians. All functions expect inputs and outputs degrees.\\n10. \\n11. References\\n12. ----------\\n13. .. [1] Calabretta, M.R., Greisen, E.W., 2002, A&A, 395, 1077 (Paper II)\\n14. """\\n15. \\n16. \\n17. import abc\\n18. from itertools import chain, product\\n19. \\n20. import numpy as np\\n21. \\n22. from astropy import units as u\\n23. from astropy import wcs\\n24. \\n25. from .core import Model\\n26. from .parameters import Parameter, InputParameterError\\n27. from .utils import _to_radian, _to_orig_unit\\n28. \\n29. \\n30. # List of tuples of the form\\n31. # (long class name without suffix, short WCSLIB projection code):\\n32. _PROJ_NAME_CODE = [\\n33.     (\\\'ZenithalPerspective\\\', \\\'AZP\\\'),\\n34.     (\\\'SlantZenithalPerspective\\\', \\\'SZP\\\'),\\n35.     (\\\'Gnomonic\\\', \\\'TAN\\\'),\\n36.     (\\\'Stereographic\\\', \\\'STG\\\'),\\n37.     (\\\'SlantOrthographic\\\', \\\'SIN\\\'),\\n38.     (\\\'ZenithalEquidistant\\\', \\\'ARC\\\'),\\n39.     (\\\'ZenithalEqualArea\\\', \\\'ZEA\\\'),\\n40.     (\\\'Airy\\\', \\\'AIR\\\'),\\n41.     (\\\'CylindricalPerspective\\\', \\\'CYP\\\'),\\n42.     (\\\'CylindricalEqualArea\\\', \\\'CEA\\\'),\\n43.     (\\\'PlateCarree\\\', \\\'CAR\\\'),\\n44.     (\\\'Mercator\\\', \\\'MER\\\'),\\n45.     (\\\'SansonFlamsteed\\\', \\\'SFL\\\'),\\n46.     (\\\'Parabolic\\\', \\\'PAR\\\'),\\n47.     (\\\'Molleweide\\\', \\\'MOL\\\'),\\n48.     (\\\'HammerAitoff\\\', \\\'AIT\\\'),\\n49.     (\\\'ConicPerspective\\\', \\\'COP\\\'),\\n50.     (\\\'ConicEqualArea\\\', \\\'COE\\\'),\\n51.     (\\\'ConicEquidistant\\\', \\\'COD\\\'),\\n52.     (\\\'ConicOrthomorphic\\\', \\\'COO\\\'),\\n53.     (\\\'BonneEqualArea\\\', \\\'BON\\\'),\\n54.     (\\\'Polyconic\\\', \\\'PCO\\\'),\\n55.     (\\\'TangentialSphericalCube\\\', \\\'TSC\\\'),\\n56.     (\\\'COBEQuadSphericalCube\\\', \\\'CSC\\\'),\\n57.     (\\\'QuadSphericalCube\\\', \\\'QSC\\\'),\\n58.     (\\\'HEALPix\\\', \\\'HPX\\\'),\\n59.     (\\\'HEALPixPolar\\\', \\\'XPH\\\'),\\n60. ]\\n61. \\n62. _NOT_SUPPORTED_PROJ_CODES = [\\\'ZPN\\\']\\n63. \\n64. _PROJ_NAME_CODE_MAP = dict(_PROJ_NAME_CODE)\\n65. \\n66. projcodes = [code for _, code in _PROJ_NAME_CODE]\\n67. \\n68. \\n69. __all__ = [\\n70.     \\\'Projection\\\', \\\'Pix2SkyProjection\\\', \\\'Sky2PixProjection\\\', \\\'Zenithal\\\',\\n71.     \\\'Cylindrical\\\', \\\'PseudoCylindrical\\\', \\\'Conic\\\', \\\'PseudoConic\\\', \\\'QuadCube\\\',\\n72.     \\\'HEALPix\\\', \\\'AffineTransformation2D\\\', \\\'projcodes\\\'\\n73. ] + list(map(\\\'_\\\'.join, product([\\\'Pix2Sky\\\', \\\'Sky2Pix\\\'], chain(*_PROJ_NAME_CODE))))\\n74. \\n75. \\n76. class _ParameterDS(Parameter):\\n77.     """\\n78.     Same as `Parameter` but can indicate its modified status via the ``dirty``\\n79.     property. This flag also gets set automatically when a parameter is\\n80.     modified.\\n81. \\n82.     This ability to track parameter\\\'s modified status is needed for automatic\\n83.     update of WCSLIB\\\'s prjprm structure (which may be a more-time intensive\\n84.     operation) *only as required*.\\n85. \\n86.     """\\n87.     def __init__(self, *args, **kwargs):\\n88.         super().__init__(*args, **kwargs)\\n89.         self.dirty = True\\n90. \\n91.     def validate(self, value):\\n92.         super().validate(value)\\n93.         self.dirty = True\\n94. \\n95. \\n96. class Projection(Model):\\n97.     """Base class for all sky projections."""\\n98. \\n99.     # Radius of the generating sphere.\\n100.     # This sets the circumference to 360 deg so that arc length is measured in deg.\\n101.     r0 = 180 * u.deg / np.pi\\n102. \\n103.     _separable = False\\n104. \\n105.     def __init__(self, *args, **kwargs):\\n106.         super().__init__(*args, **kwargs)\\n107.         self._prj = wcs.Prjprm()\\n108. \\n109.     @property\\n110.     @abc.abstractmethod\\n111.     def inverse(self):\\n112.         """\\n113.         Inverse projection--all projection models must provide an inverse.\\n114.         """\\n115. \\n116.     @property\\n117.     def prjprm(self):\\n118.         """ WCSLIB ``prjprm`` structure. """\\n119.         self._update_prj()\\n120.         return self._prj\\n121. \\n122.     def _update_prj(self):\\n123.         """\\n124.         A default updater for projection\\\'s pv.\\n125. \\n126.         .. warning::\\n127.             This method assumes that PV0 is never modified. If a projection\\n128.             that uses PV0 is ever implemented in this module, that projection\\n129.             class should override this method.\\n130. \\n131.         .. warning::\\n132.             This method assumes that the order in which PVi values (i>0)\\n133.             are to be asigned is identical to the order of model parameters\\n134.             in ``param_names``. That is, pv[1] = model.parameters[0], ...\\n135. \\n136.         """\\n137.         if not self.param_names:\\n138.             return\\n139. \\n140.         pv = []\\n141.         dirty = False\\n142. \\n143.         for p in self.param_names:\\n144.             param = getattr(self, p)\\n145.             pv.append(float(param.value))\\n146.             dirty |= param.dirty\\n147.             param.dirty = False\\n148. \\n149.         if dirty:\\n150.             self._prj.pv = None, *pv\\n151.             self._prj.set()\\n152. \\n153. \\n154. class Pix2SkyProjection(Projection):\\n155.     """Base class for all Pix2Sky projections."""\\n156. \\n157.     n_inputs = 2\\n158.     n_outputs = 2\\n159. \\n160.     _input_units_strict = True\\n161.     _input_units_allow_dimensionless = True\\n162. \\n163.     def __new__(cls, *args, **kwargs):\\n164.         long_name = cls.name.split(\\\'_\\\')[1]\\n165.         cls.prj_code = _PROJ_NAME_CODE_MAP[long_name]\\n166.         return super(Pix2SkyProjection, cls).__new__(cls)\\n167. \\n168.     def __init__(self, *args, **kwargs):\\n169.         super().__init__(*args, **kwargs)\\n170. \\n171.         self._prj.code = self.prj_code\\n172.         self._update_prj()\\n173.         if not self.param_names:\\n174.             # force initial call to Prjprm.set() for projections\\n175.             # with no parameters:\\n176.             self._prj.set()\\n177. \\n178.         self.inputs = (\\\'x\\\', \\\'y\\\')\\n179.         self.outputs = (\\\'phi\\\', \\\'theta\\\')\\n180. \\n181.     @property\\n182.     def input_units(self):\\n183.         return {self.inputs[0]: u.deg,\\n184.                 self.inputs[1]: u.deg}\\n185. \\n186.     @property\\n187.     def return_units(self):\\n188.         return {self.outputs[0]: u.deg,\\n189.                 self.outputs[1]: u.deg}\\n190. \\n191.     def evaluate(self, x, y, *args, **kwargs):\\n192.         self._update_prj()\\n193.         return self._prj.prjx2s(x, y)\\n194. \\n195.     @property\\n196.     def inverse(self):\\n197.         pv = [getattr(self, param).value for param in self.param_names]\\n198.         return self._inv_cls(*pv)\\n199. \\n200. \\n201. class Sky2PixProjection(Projection):\\n202.     """Base class for all Sky2Pix projections."""\\n203. \\n204.     n_inputs = 2\\n205.     n_outputs = 2\\n206. \\n207.     _input_units_strict = True\\n208.     _input_units_allow_dimensionless = True\\n209. \\n210.     def __new__(cls, *args, **kwargs):\\n211.         long_name = cls.name.split(\\\'_\\\')[1]\\n212.         cls.prj_code = _PROJ_NAME_CODE_MAP[long_name]\\n213.         return super(Sky2PixProjection, cls).__new__(cls)\\n214. \\n215.     def __init__(self, *args, **kwargs):\\n216.         super().__init__(*args, **kwargs)\\n217. \\n218.         self._prj.code = self.prj_code\\n219.         self._update_prj()\\n220.         if not self.param_names:\\n221.             # force initial call to Prjprm.set() for projections\\n222.             # without parameters:\\n223.             self._prj.set()\\n224. \\n225.         self.inputs = (\\\'phi\\\', \\\'theta\\\')\\n226.         self.outputs = (\\\'x\\\', \\\'y\\\')\\n227. \\n228.     @property\\n229.     def input_units(self):\\n230.         return {self.inputs[0]: u.deg,\\n231.                 self.inputs[1]: u.deg}\\n232. \\n233.     @property\\n234.     def return_units(self):\\n235.         return {self.outputs[0]: u.deg,\\n236.                 self.outputs[1]: u.deg}\\n237. \\n238.     def evaluate(self, phi, theta, *args, **kwargs):\\n239.         self._update_prj()\\n240.         return self._prj.prjs2x(phi, theta)\\n241. \\n242.     @property\\n243.     def inverse(self):\\n244.         pv = [getattr(self, param).value for param in self.param_names]\\n245.         return self._inv_cls(*pv)\\n246. \\n247. \\n248. class Zenithal(Projection):\\n249.     r"""Base class for all Zenithal projections.\\n250. \\n251.     Zenithal (or azimuthal) projections map the sphere directly onto a\\n252.     plane.  All zenithal projections are specified by defining the\\n253.     radius as a function of native latitude, :math:`R_\\\\theta`.\\n254. \\n255.     The pixel-to-sky transformation is defined as:\\n256. \\n257.     .. math::\\n258.         \\\\phi &= \\\\arg(-y, x) \\\\\\\\\\n259.         R_\\\\theta &= \\\\sqrt{x^2 + y^2}\\n260. \\n261.     and the inverse (sky-to-pixel) is defined as:\\n262. \\n263.     .. math::\\n264.         x &= R_\\\\theta \\\\sin \\\\phi \\\\\\\\\\n265.         y &= R_\\\\theta \\\\cos \\\\phi\\n266.     """\\n267. \\n268. \\n269. class Pix2Sky_ZenithalPerspective(Pix2SkyProjection, Zenithal):\\n270.     r"""\\n271.     Zenithal perspective projection - pixel to sky.\\n272. \\n273.     Corresponds to the ``AZP`` projection in FITS WCS.\\n274. \\n275.     .. math::\\n276.         \\\\phi &= \\\\arg(-y \\\\cos \\\\gamma, x) \\\\\\\\\\n277.         \\\\theta &= \\\\left\\\\{\\\\genfrac{}{}{0pt}{}{\\\\psi - \\\\omega}{\\\\psi + \\\\omega + 180^{\\\\circ}}\\\\right.\\n278. \\n279.     where:\\n280. \\n281.     .. math::\\n282.         \\\\psi &= \\\\arg(\\\\rho, 1) \\\\\\\\\\n283.         \\\\omega &= \\\\sin^{-1}\\\\left(\\\\frac{\\\\rho \\\\mu}{\\\\sqrt{\\\\rho^2 + 1}}\\\\right) \\\\\\\\\\n284.         \\\\rho &= \\\\frac{R}{\\\\frac{180^{\\\\circ}}{\\\\pi}(\\\\mu + 1) + y \\\\sin \\\\gamma} \\\\\\\\\\n285.         R &= \\\\sqrt{x^2 + y^2 \\\\cos^2 \\\\gamma}\\n286. \\n287.     Parameters\\n288.     ----------\\n289.     mu : float\\n290.         Distance from point of projection to center of sphere\\n291.         in spherical radii, Î¼.  Default is 0.\\n292. \\n293.     gamma : float\\n294.         Look angle Î³ in degrees.  Default is 0Â°.\\n295. \\n296.     """\\n297.     mu = _ParameterDS(\\n298.         default=0.0, description="Distance from point of projection to center of sphere"\\n299.     )\\n300.     gamma = _ParameterDS(default=0.0, getter=_to_orig_unit, setter=_to_radian,\\n301.                          description="Look angle Î³ in degrees (Default = 0Â°)")\\n302. \\n303.     @mu.validator\\n304.     def mu(self, value):\\n305.         if np.any(np.equal(value, -1.0)):\\n306.             raise InputParameterError(\\n307.                 "Zenithal perspective projection is not defined for mu = -1")\\n308. \\n309. \\n310. class Sky2Pix_ZenithalPerspective(Sky2PixProjection, Zenithal):\\n311.     r"""\\n312.     Zenithal perspective projection - sky to pixel.\\n313. \\n314.     Corresponds to the ``AZP`` projection in FITS WCS.\\n315. \\n316.     .. math::\\n317.         x &= R \\\\sin \\\\phi \\\\\\\\\\n318.         y &= -R \\\\sec \\\\gamma \\\\cos \\\\theta\\n319. \\n320.     where:\\n321. \\n322.     .. math::\\n323.         R = \\\\frac{180^{\\\\circ}}{\\\\pi} \\\\frac{(\\\\mu + 1) \\\\cos \\\\theta}{(\\\\mu + \\\\sin \\\\theta) + \\\\cos \\\\theta \\\\cos \\\\phi \\\\tan \\\\gamma}\\n324. \\n325.     Parameters\\n326.     ----------\\n327.     mu : float\\n328.         Distance from point of projection to center of sphere\\n329.         in spherical radii, Î¼. Default is 0.\\n330. \\n331.     gamma : float\\n332.         Look angle Î³ in degrees. Default is 0Â°.\\n333. \\n334.     """\\n335.     mu = _ParameterDS(\\n336.         default=0.0,\\n337.         description="Distance from point of projection to center of sphere"\\n338.     )\\n339.     gamma = _ParameterDS(default=0.0, getter=_to_orig_unit, setter=_to_radian,\\n340.                          description="Look angle Î³ in degrees (Default=0Â°)")\\n341. \\n342.     @mu.validator\\n343.     def mu(self, value):\\n344.         if np.any(np.equal(value, -1.0)):\\n345.             raise InputParameterError(\\n346.                 "Zenithal perspective projection is not defined for mu = -1")\\n347. \\n348. \\n349. class Pix2Sky_SlantZenithalPerspective(Pix2SkyProjection, Zenithal):\\n350.     r"""\\n351.     Slant zenithal perspective projection - pixel to sky.\\n352. \\n353.     Corresponds to the ``SZP`` projection in FITS WCS.\\n354. \\n355.     Parameters\\n356.     ----------\\n357.     mu : float\\n358.         Distance from point of projection to center of sphere\\n359.         in spherical radii, Î¼.  Default is 0.\\n360. \\n361.     phi0 : float\\n362.         The longitude Ï†â‚€ of the reference point, in degrees.  Default\\n363.         is 0Â°.\\n364. \\n365.     theta0 : float\\n366.         The latitude Î¸â‚€ of the reference point, in degrees.  Default\\n367.         is 90Â°.\\n368. \\n369.     """\\n370.     mu = _ParameterDS(\\n371.         default=0.0,\\n372.         description="Distance from point of projection to center of sphere"\\n373.     )\\n374.     phi0 = _ParameterDS(\\n375.         default=0.0, getter=_to_orig_unit, setter=_to_radian,\\n376.         description="The longitude Ï†â‚€ of the reference point in degrees (Default=0Â°)"\\n377.     )\\n378.     theta0 = _ParameterDS(\\n379.         default=90.0, getter=_to_orig_unit, setter=_to_radian,\\n380.         description="The latitude Î¸â‚€ of the reference point, in degrees (Default=0Â°)"\\n381.     )\\n382. \\n383.     @mu.validator\\n384.     def mu(self, value):\\n385.         if np.any(np.equal(value, -1.0)):\\n386.             raise InputParameterError(\\n387.                 "Zenithal perspective projection is not defined for mu = -1")\\n388. \\n389. \\n390. class Sky2Pix_SlantZenithalPerspective(Sky2PixProjection, Zenithal):\\n391.     r"""\\n392.     Zenithal perspective projection - sky to pixel.\\n393. \\n394.     Corresponds to the ``SZP`` projection in FITS WCS.\\n395. \\n396.     Parameters\\n397.     ----------\\n398.     mu : float\\n399.         distance from point of projection to center of sphere\\n400.         in spherical radii, Î¼.  Default is 0.\\n401. \\n402.     phi0 : float\\n403.         The longitude Ï†â‚€ of the reference point, in degrees.  Default\\n404.         is 0Â°.\\n405. \\n406.     theta0 : float\\n407.         The latitude Î¸â‚€ of the reference point, in degrees.  Default\\n408.         is 90Â°.\\n409. \\n410.     """\\n411.     mu = _ParameterDS(\\n412.         default=0.0, description="Distance from point of projection to center of sphere"\\n413.     )\\n414.     phi0 = _ParameterDS(\\n415.         default=0.0, getter=_to_orig_unit, setter=_to_radian,\\n416.         description="The longitude Ï†â‚€ of the reference point in degrees"\\n417.     )\\n418.     theta0 = _ParameterDS(\\n419.         default=0.0, getter=_to_orig_unit, setter=_to_radian,\\n420.         description="The latitude Î¸â‚€ of the reference point, in degrees"\\n421.     )\\n422. \\n423.     @mu.validator\\n424.     def mu(self, value):\\n425.         if np.any(np.equal(value, -1.0)):\\n426.             raise InputParameterError(\\n427.                 "Zenithal perspective projection is not defined for mu = -1")\\n428. \\n429. \\n430. class Pix2Sky_Gnomonic(Pix2SkyProjection, Zenithal):\\n431.     r"""\\n432.     Gnomonic projection - pixel to sky.\\n433. \\n434.     Corresponds to the ``TAN`` projection in FITS WCS.\\n435. \\n436.     See `Zenithal` for a definition of the full transformation.\\n437. \\n438.     .. math::\\n439.         \\\\theta = \\\\tan^{-1}\\\\left(\\\\frac{180^{\\\\circ}}{\\\\pi R_\\\\theta}\\\\right)\\n440.     """\\n441. \\n442. \\n443. class Sky2Pix_Gnomonic(Sky2PixProjection, Zenithal):\\n444.     r"""\\n445.     Gnomonic Projection - sky to pixel.\\n446. \\n447.     Corresponds to the ``TAN`` projection in FITS WCS.\\n448. \\n449.     See `Zenithal` for a definition of the full transformation.\\n450. \\n451.     .. math::\\n452.         R_\\\\theta = \\\\frac{180^{\\\\circ}}{\\\\pi}\\\\cot \\\\theta\\n453.     """\\n454. \\n455. \\n456. class Pix2Sky_Stereographic(Pix2SkyProjection, Zenithal):\\n457.     r"""\\n458.     Stereographic Projection - pixel to sky.\\n459. \\n460.     Corresponds to the ``STG`` projection in FITS WCS.\\n461. \\n462.     See `Zenithal` for a definition of the full transformation.\\n463. \\n464.     .. math::\\n465.         \\\\theta = 90^{\\\\circ} - 2 \\\\tan^{-1}\\\\left(\\\\frac{\\\\pi R_\\\\theta}{360^{\\\\circ}}\\\\right)\\n466.     """\\n467. \\n468. \\n469. class Sky2Pix_Stereographic(Sky2PixProjection, Zenithal):\\n470.     r"""\\n471.     Stereographic Projection - sky to pixel.\\n472. \\n473.     Corresponds to the ``STG`` projection in FITS WCS.\\n474. \\n475.     See `Zenithal` for a definition of the full transformation.\\n476. \\n477.     .. math::\\n478.         R_\\\\theta = \\\\frac{180^{\\\\circ}}{\\\\pi}\\\\frac{2 \\\\cos \\\\theta}{1 + \\\\sin \\\\theta}\\n479.     """\\n480. \\n481. \\n482. class Pix2Sky_SlantOrthographic(Pix2SkyProjection, Zenithal):\\n483.     r"""\\n484.     Slant orthographic projection - pixel to sky.\\n485. \\n486.     Corresponds to the ``SIN`` projection in FITS WCS.\\n487. \\n488.     See `Zenithal` for a definition of the full transformation.\\n489. \\n490.     The following transformation applies when :math:`\\\\xi` and\\n491.     :math:`\\\\eta` are both zero.\\n492. \\n493.     .. math::\\n494.         \\\\theta = \\\\cos^{-1}\\\\left(\\\\frac{\\\\pi}{180^{\\\\circ}}R_\\\\theta\\\\right)\\n495. \\n496.     The parameters :math:`\\\\xi` and :math:`\\\\eta` are defined from the\\n497.     reference point :math:`(\\\\phi_c, \\\\theta_c)` as:\\n498. \\n499.     .. math::\\n500.         \\\\xi &= \\\\cot \\\\theta_c \\\\sin \\\\phi_c \\\\\\\\\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/modeling/separable.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. Functions to determine if a model is separable, i.e.\\n5. if the model outputs are independent.\\n6. \\n7. It analyzes ``n_inputs``, ``n_outputs`` and the operators\\n8. in a compound model by stepping through the transforms\\n9. and creating a ``coord_matrix`` of shape (``n_outputs``, ``n_inputs``).\\n10. \\n11. \\n12. Each modeling operator is represented by a function which\\n13. takes two simple models (or two ``coord_matrix`` arrays) and\\n14. returns an array of shape (``n_outputs``, ``n_inputs``).\\n15. \\n16. """\\n17. \\n18. import numpy as np\\n19. \\n20. from .core import Model, ModelDefinitionError, CompoundModel\\n21. from .mappings import Mapping\\n22. \\n23. \\n24. __all__ = ["is_separable", "separability_matrix"]\\n25. \\n26. \\n27. def is_separable(transform):\\n28.     """\\n29.     A separability test for the outputs of a transform.\\n30. \\n31.     Parameters\\n32.     ----------\\n33.     transform : `~astropy.modeling.core.Model`\\n34.         A (compound) model.\\n35. \\n36.     Returns\\n37.     -------\\n38.     is_separable : ndarray\\n39.         A boolean array with size ``transform.n_outputs`` where\\n40.         each element indicates whether the output is independent\\n41.         and the result of a separable transform.\\n42. \\n43.     Examples\\n44.     --------\\n45.     >>> from astropy.modeling.models import Shift, Scale, Rotation2D, Polynomial2D\\n46.     >>> is_separable(Shift(1) & Shift(2) | Scale(1) & Scale(2))\\n47.         array([ True,  True]...)\\n48.     >>> is_separable(Shift(1) & Shift(2) | Rotation2D(2))\\n49.         array([False, False]...)\\n50.     >>> is_separable(Shift(1) & Shift(2) | Mapping([0, 1, 0, 1]) | \\\\\\n51.         Polynomial2D(1) & Polynomial2D(2))\\n52.         array([False, False]...)\\n53.     >>> is_separable(Shift(1) & Shift(2) | Mapping([0, 1, 0, 1]))\\n54.         array([ True,  True,  True,  True]...)\\n55. \\n56.     """\\n57.     if transform.n_inputs == 1 and transform.n_outputs > 1:\\n58.         is_separable = np.array([False] * transform.n_outputs).T\\n59.         return is_separable\\n60.     separable_matrix = _separable(transform)\\n61.     is_separable = separable_matrix.sum(1)\\n62.     is_separable = np.where(is_separable != 1, False, True)\\n63.     return is_separable\\n64. \\n65. \\n66. def separability_matrix(transform):\\n67.     """\\n68.     Compute the correlation between outputs and inputs.\\n69. \\n70.     Parameters\\n71.     ----------\\n72.     transform : `~astropy.modeling.core.Model`\\n73.         A (compound) model.\\n74. \\n75.     Returns\\n76.     -------\\n77.     separable_matrix : ndarray\\n78.         A boolean correlation matrix of shape (n_outputs, n_inputs).\\n79.         Indicates the dependence of outputs on inputs. For completely\\n80.         independent outputs, the diagonal elements are True and\\n81.         off-diagonal elements are False.\\n82. \\n83.     Examples\\n84.     --------\\n85.     >>> from astropy.modeling.models import Shift, Scale, Rotation2D, Polynomial2D\\n86.     >>> separability_matrix(Shift(1) & Shift(2) | Scale(1) & Scale(2))\\n87.         array([[ True, False], [False,  True]]...)\\n88.     >>> separability_matrix(Shift(1) & Shift(2) | Rotation2D(2))\\n89.         array([[ True,  True], [ True,  True]]...)\\n90.     >>> separability_matrix(Shift(1) & Shift(2) | Mapping([0, 1, 0, 1]) | \\\\\\n91.         Polynomial2D(1) & Polynomial2D(2))\\n92.         array([[ True,  True], [ True,  True]]...)\\n93.     >>> separability_matrix(Shift(1) & Shift(2) | Mapping([0, 1, 0, 1]))\\n94.         array([[ True, False], [False,  True], [ True, False], [False,  True]]...)\\n95. \\n96.     """\\n97.     if transform.n_inputs == 1 and transform.n_outputs > 1:\\n98.         return np.ones((transform.n_outputs, transform.n_inputs),\\n99.                        dtype=np.bool_)\\n100.     separable_matrix = _separable(transform)\\n101.     separable_matrix = np.where(separable_matrix != 0, True, False)\\n102.     return separable_matrix\\n103. \\n104. \\n105. def _compute_n_outputs(left, right):\\n106.     """\\n107.     Compute the number of outputs of two models.\\n108. \\n109.     The two models are the left and right model to an operation in\\n110.     the expression tree of a compound model.\\n111. \\n112.     Parameters\\n113.     ----------\\n114.     left, right : `astropy.modeling.Model` or ndarray\\n115.         If input is of an array, it is the output of `coord_matrix`.\\n116. \\n117.     """\\n118.     if isinstance(left, Model):\\n119.         lnout = left.n_outputs\\n120.     else:\\n121.         lnout = left.shape[0]\\n122.     if isinstance(right, Model):\\n123.         rnout = right.n_outputs\\n124.     else:\\n125.         rnout = right.shape[0]\\n126.     noutp = lnout + rnout\\n127.     return noutp\\n128. \\n129. \\n130. def _arith_oper(left, right):\\n131.     """\\n132.     Function corresponding to one of the arithmetic operators\\n133.     [\\\'+\\\', \\\'-\\\'. \\\'*\\\', \\\'/\\\', \\\'**\\\'].\\n134. \\n135.     This always returns a nonseparable output.\\n136. \\n137. \\n138.     Parameters\\n139.     ----------\\n140.     left, right : `astropy.modeling.Model` or ndarray\\n141.         If input is of an array, it is the output of `coord_matrix`.\\n142. \\n143.     Returns\\n144.     -------\\n145.     result : ndarray\\n146.         Result from this operation.\\n147.     """\\n148.     # models have the same number of inputs and outputs\\n149.     def _n_inputs_outputs(input):\\n150.         if isinstance(input, Model):\\n151.             n_outputs, n_inputs = input.n_outputs, input.n_inputs\\n152.         else:\\n153.             n_outputs, n_inputs = input.shape\\n154.         return n_inputs, n_outputs\\n155. \\n156.     left_inputs, left_outputs = _n_inputs_outputs(left)\\n157.     right_inputs, right_outputs = _n_inputs_outputs(right)\\n158. \\n159.     if left_inputs != right_inputs or left_outputs != right_outputs:\\n160.         raise ModelDefinitionError(\\n161.             "Unsupported operands for arithmetic operator: left (n_inputs={}, "\\n162.             "n_outputs={}) and right (n_inputs={}, n_outputs={}); "\\n163.             "models must have the same n_inputs and the same "\\n164.             "n_outputs for this operator.".format(\\n165.                 left_inputs, left_outputs, right_inputs, right_outputs))\\n166. \\n167.     result = np.ones((left_outputs, left_inputs))\\n168.     return result\\n169. \\n170. \\n171. def _coord_matrix(model, pos, noutp):\\n172.     """\\n173.     Create an array representing inputs and outputs of a simple model.\\n174. \\n175.     The array has a shape (noutp, model.n_inputs).\\n176. \\n177.     Parameters\\n178.     ----------\\n179.     model : `astropy.modeling.Model`\\n180.         model\\n181.     pos : str\\n182.         Position of this model in the expression tree.\\n183.         One of [\\\'left\\\', \\\'right\\\'].\\n184.     noutp : int\\n185.         Number of outputs of the compound model of which the input model\\n186.         is a left or right child.\\n187. \\n188.     """\\n189.     if isinstance(model, Mapping):\\n190.         axes = []\\n191.         for i in model.mapping:\\n192.             axis = np.zeros((model.n_inputs,))\\n193.             axis[i] = 1\\n194.             axes.append(axis)\\n195.         m = np.vstack(axes)\\n196.         mat = np.zeros((noutp, model.n_inputs))\\n197.         if pos == \\\'left\\\':\\n198.             mat[: model.n_outputs, :model.n_inputs] = m\\n199.         else:\\n200.             mat[-model.n_outputs:, -model.n_inputs:] = m\\n201.         return mat\\n202.     if not model.separable:\\n203.         # this does not work for more than 2 coordinates\\n204.         mat = np.zeros((noutp, model.n_inputs))\\n205.         if pos == \\\'left\\\':\\n206.             mat[:model.n_outputs, : model.n_inputs] = 1\\n207.         else:\\n208.             mat[-model.n_outputs:, -model.n_inputs:] = 1\\n209.     else:\\n210.         mat = np.zeros((noutp, model.n_inputs))\\n211. \\n212.         for i in range(model.n_inputs):\\n213.             mat[i, i] = 1\\n214.         if pos == \\\'right\\\':\\n215.             mat = np.roll(mat, (noutp - model.n_outputs))\\n216.     return mat\\n217. \\n218. \\n219. def _cstack(left, right):\\n220.     """\\n221.     Function corresponding to \\\'&\\\' operation.\\n222. \\n223.     Parameters\\n224.     ----------\\n225.     left, right : `astropy.modeling.Model` or ndarray\\n226.         If input is of an array, it is the output of `coord_matrix`.\\n227. \\n228.     Returns\\n229.     -------\\n230.     result : ndarray\\n231.         Result from this operation.\\n232. \\n233.     """\\n234.     noutp = _compute_n_outputs(left, right)\\n235. \\n236.     if isinstance(left, Model):\\n237.         cleft = _coord_matrix(left, \\\'left\\\', noutp)\\n238.     else:\\n239.         cleft = np.zeros((noutp, left.shape[1]))\\n240.         cleft[: left.shape[0], : left.shape[1]] = left\\n241.     if isinstance(right, Model):\\n242.         cright = _coord_matrix(right, \\\'right\\\', noutp)\\n243.     else:\\n244.         cright = np.zeros((noutp, right.shape[1]))\\n245.         cright[-right.shape[0]:, -right.shape[1]:] = 1\\n246. \\n247.     return np.hstack([cleft, cright])\\n248. \\n249. \\n250. def _cdot(left, right):\\n251.     """\\n252.     Function corresponding to "|" operation.\\n253. \\n254.     Parameters\\n255.     ----------\\n256.     left, right : `astropy.modeling.Model` or ndarray\\n257.         If input is of an array, it is the output of `coord_matrix`.\\n258. \\n259.     Returns\\n260.     -------\\n261.     result : ndarray\\n262.         Result from this operation.\\n263.     """\\n264. \\n265.     left, right = right, left\\n266. \\n267.     def _n_inputs_outputs(input, position):\\n268.         """\\n269.         Return ``n_inputs``, ``n_outputs`` for a model or coord_matrix.\\n270.         """\\n271.         if isinstance(input, Model):\\n272.             coords = _coord_matrix(input, position, input.n_outputs)\\n273.         else:\\n274.             coords = input\\n275.         return coords\\n276. \\n277.     cleft = _n_inputs_outputs(left, \\\'left\\\')\\n278.     cright = _n_inputs_outputs(right, \\\'right\\\')\\n279. \\n280.     try:\\n281.         result = np.dot(cleft, cright)\\n282.     except ValueError:\\n283.         raise ModelDefinitionError(\\n284.             \\\'Models cannot be combined with the "|" operator; \\\'\\n285.             \\\'left coord_matrix is {}, right coord_matrix is {}\\\'.format(\\n286.                 cright, cleft))\\n287.     return result\\n288. \\n289. \\n290. def _separable(transform):\\n291.     """\\n292.     Calculate the separability of outputs.\\n293. \\n294.     Parameters\\n295.     ----------\\n296.     transform : `astropy.modeling.Model`\\n297.         A transform (usually a compound model).\\n298. \\n299.     Returns :\\n300.     is_separable : ndarray of dtype np.bool\\n301.         An array of shape (transform.n_outputs,) of boolean type\\n302.         Each element represents the separablity of the corresponding output.\\n303.     """\\n304.     if (transform_matrix := transform._calculate_separability_matrix()) is not NotImplemented:\\n305.         return transform_matrix\\n306.     elif isinstance(transform, CompoundModel):\\n307.         sepleft = _separable(transform.left)\\n308.         sepright = _separable(transform.right)\\n309.         return _operators[transform.op](sepleft, sepright)\\n310.     elif isinstance(transform, Model):\\n311.         return _coord_matrix(transform, \\\'left\\\', transform.n_outputs)\\n312. \\n313. \\n314. # Maps modeling operators to a function computing and represents the\\n315. # relationship of axes as an array of 0-es and 1-s\\n316. _operators = {\\\'&\\\': _cstack, \\\'|\\\': _cdot, \\\'+\\\': _arith_oper, \\\'-\\\': _arith_oper,\\n317.               \\\'*\\\': _arith_oper, \\\'/\\\': _arith_oper, \\\'**\\\': _arith_oper}\', \'start_line_number\': 1, \'end_line_number\': 317}\n\nTest Case Context (similar existing tests for reference):\n{\'relative_path\': \'astropy/modeling/tests/test_compound.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. # pylint: disable=invalid-name, pointless-statement\\n3. \\n4. import pickle\\n5. import pytest\\n6. \\n7. import numpy as np\\n8. \\n9. from numpy.testing import assert_allclose, assert_array_equal\\n10. \\n11. from astropy.utils import minversion\\n12. from astropy.modeling.core import Model, ModelDefinitionError, CompoundModel\\n13. from astropy.modeling.parameters import Parameter\\n14. from astropy.modeling.models import (Const1D, Shift, Scale, Rotation2D, Gaussian1D,\\n15.                                      Gaussian2D, Polynomial1D, Polynomial2D,\\n16.                                      Chebyshev2D, Legendre2D, Chebyshev1D, Legendre1D,\\n17.                                      Identity, Mapping, Linear1D,\\n18.                                      Tabular1D, fix_inputs,)\\n19. from astropy.modeling.fitting import LevMarLSQFitter\\n20. import astropy.units as u\\n21. from astropy.utils.compat.optional_deps import HAS_SCIPY  # noqa\\n22. \\n23. \\n24. @pytest.mark.parametrize((\\\'expr\\\', \\\'result\\\'),\\n25.                          [(lambda x, y: x + y, [5.0, 5.0]),\\n26.                           (lambda x, y: x - y, [-1.0, -1.0]),\\n27.                           (lambda x, y: x * y, [6.0, 6.0]),\\n28.                           (lambda x, y: x / y, [2.0 / 3.0, 2.0 / 3.0]),\\n29.                           (lambda x, y: x ** y, [8.0, 8.0])])\\n30. def test_model_set(expr, result):\\n31.     s = expr(Const1D((2, 2), n_models=2), Const1D((3, 3), n_models=2))\\n32.     out = s(0, model_set_axis=False)\\n33.     assert_array_equal(out, result)\\n34. \\n35. \\n36. @pytest.mark.parametrize((\\\'expr\\\', \\\'result\\\'),\\n37.                          [(lambda x, y: x + y, [5.0, 5.0]),\\n38.                           (lambda x, y: x - y, [-1.0, -1.0]),\\n39.                           (lambda x, y: x * y, [6.0, 6.0]),\\n40.                           (lambda x, y: x / y, [2.0 / 3.0, 2.0 / 3.0]),\\n41.                           (lambda x, y: x ** y, [8.0, 8.0])])\\n42. def test_model_set_raises_value_error(expr, result):\\n43.     """Check that creating model sets with components whose _n_models are\\n44.        different raise a value error\\n45.     """\\n46.     with pytest.raises(ValueError):\\n47.         expr(Const1D((2, 2), n_models=2), Const1D(3, n_models=1))\\n48. \\n49. \\n50. @pytest.mark.parametrize((\\\'expr\\\', \\\'result\\\'),\\n51.                          [(lambda x, y: x + y, 5.0),\\n52.                           (lambda x, y: x - y, -1.0),\\n53.                           (lambda x, y: x * y, 6.0),\\n54.                           (lambda x, y: x / y, 2.0 / 3.0),\\n55.                           (lambda x, y: x ** y, 8.0)])\\n56. def test_two_model_instance_arithmetic_1d(expr, result):\\n57.     """\\n58.     Like test_two_model_class_arithmetic_1d, but creates a new model from two\\n59.     model *instances* with fixed parameters.\\n60.     """\\n61. \\n62.     s = expr(Const1D(2), Const1D(3))\\n63. \\n64.     assert isinstance(s, CompoundModel)\\n65.     assert s.n_inputs == 1\\n66.     assert s.n_outputs == 1\\n67. \\n68.     out = s(0)\\n69.     assert out == result\\n70. \\n71.     assert isinstance(out, float)\\n72. \\n73. \\n74. def test_simple_two_model_compose_1d():\\n75.     """\\n76.     Shift and Scale are two of the simplest models to test model composition\\n77.     with.\\n78.     """\\n79. \\n80.     S1 = Shift(2) | Scale(3)  # First shift then scale\\n81.     assert isinstance(S1, CompoundModel)\\n82.     assert S1.n_inputs == 1\\n83.     assert S1.n_outputs == 1\\n84.     assert S1(1) == 9.0\\n85. \\n86.     S2 = Scale(2) | Shift(3)  # First scale then shift\\n87.     assert isinstance(S2, CompoundModel)\\n88.     assert S2.n_inputs == 1\\n89.     assert S2.n_outputs == 1\\n90.     assert S2(1) == 5.0\\n91. \\n92.     # Test with array inputs\\n93.     assert_array_equal(S2([1, 2, 3]), [5.0, 7.0, 9.0])\\n94. \\n95. \\n96. def test_simple_two_model_compose_2d():\\n97.     """\\n98.     A simple example consisting of two rotations.\\n99.     """\\n100. \\n101.     r1 = Rotation2D(45) | Rotation2D(45)\\n102. \\n103.     assert isinstance(r1, CompoundModel)\\n104.     assert r1.n_inputs == 2\\n105.     assert r1.n_outputs == 2\\n106.     assert_allclose(r1(0, 1), (-1, 0), atol=1e-10)\\n107. \\n108.     r2 = Rotation2D(90) | Rotation2D(90)  # Rotate twice by 90 degrees\\n109.     assert_allclose(r2(0, 1), (0, -1), atol=1e-10)\\n110. \\n111.     # Compose R with itself to produce 4 rotations\\n112.     r3 = r1 | r1\\n113. \\n114.     assert_allclose(r3(0, 1), (0, -1), atol=1e-10)\\n115. \\n116. \\n117. def test_n_submodels():\\n118.     """\\n119.     Test that CompoundModel.n_submodels properly returns the number\\n120.     of components.\\n121.     """\\n122. \\n123.     g2 = Gaussian1D() + Gaussian1D()\\n124.     assert g2.n_submodels == 2\\n125. \\n126.     g3 = g2 + Gaussian1D()\\n127.     assert g3.n_submodels == 3\\n128. \\n129.     g5 = g3 | g2\\n130.     assert g5.n_submodels == 5\\n131. \\n132.     g7 = g5 / g2\\n133.     assert g7.n_submodels == 7\\n134. \\n135. \\n136. def test_expression_formatting():\\n137.     """\\n138.     Test that the expression strings from compound models are formatted\\n139.     correctly.\\n140.     """\\n141. \\n142.     # For the purposes of this test it doesn\\\'t matter a great deal what\\n143.     # model(s) are used in the expression, I don\\\'t think\\n144.     G = Gaussian1D(1, 1, 1)\\n145.     G2 = Gaussian2D(1, 2, 3, 4, 5, 6)\\n146. \\n147.     M = G + G\\n148.     assert M._format_expression() == \\\'[0] + [1]\\\'\\n149. \\n150.     M = G + G + G\\n151.     assert M._format_expression() == \\\'[0] + [1] + [2]\\\'\\n152. \\n153.     M = G + G * G\\n154.     assert M._format_expression() == \\\'[0] + [1] * [2]\\\'\\n155. \\n156.     M = G * G + G\\n157.     assert M._format_expression() == \\\'[0] * [1] + [2]\\\'\\n158. \\n159.     M = G + G * G + G\\n160.     assert M._format_expression() == \\\'[0] + [1] * [2] + [3]\\\'\\n161. \\n162.     M = (G + G) * (G + G)\\n163.     assert M._format_expression() == \\\'([0] + [1]) * ([2] + [3])\\\'\\n164. \\n165.     # This example uses parentheses in the expression, but those won\\\'t be\\n166.     # preserved in the expression formatting since they technically aren\\\'t\\n167.     # necessary, and there\\\'s no way to know that they were originally\\n168.     # parenthesized (short of some deep, and probably not worthwhile\\n169.     # introspection)\\n170.     M = (G * G) + (G * G)\\n171.     assert M._format_expression() == \\\'[0] * [1] + [2] * [3]\\\'\\n172. \\n173.     M = G ** G\\n174.     assert M._format_expression() == \\\'[0] ** [1]\\\'\\n175. \\n176.     M = G + G ** G\\n177.     assert M._format_expression() == \\\'[0] + [1] ** [2]\\\'\\n178. \\n179.     M = (G + G) ** G\\n180.     assert M._format_expression() == \\\'([0] + [1]) ** [2]\\\'\\n181. \\n182.     M = G + G | G\\n183.     assert M._format_expression() == \\\'[0] + [1] | [2]\\\'\\n184. \\n185.     M = G + (G | G)\\n186.     assert M._format_expression() == \\\'[0] + ([1] | [2])\\\'\\n187. \\n188.     M = G & G | G2\\n189.     assert M._format_expression() == \\\'[0] & [1] | [2]\\\'\\n190. \\n191.     M = G & (G | G)\\n192.     assert M._format_expression() == \\\'[0] & ([1] | [2])\\\'\\n193. \\n194. \\n195. def test_basic_compound_inverse():\\n196.     """\\n197.     Test basic inversion of compound models in the limited sense supported for\\n198.     models made from compositions and joins only.\\n199.     """\\n200. \\n201.     t = (Shift(2) & Shift(3)) | (Scale(2) & Scale(3)) | Rotation2D(90)\\n202.     assert_allclose(t.inverse(*t(0, 1)), (0, 1))\\n203. \\n204. \\n205. @pytest.mark.parametrize(\\\'model\\\', [\\n206.     Shift(0) + Shift(0) | Shift(0),\\n207.     Shift(0) - Shift(0) | Shift(0),\\n208.     Shift(0) * Shift(0) | Shift(0),\\n209.     Shift(0) / Shift(0) | Shift(0),\\n210.     Shift(0) ** Shift(0) | Shift(0),\\n211.     Gaussian1D(1, 2, 3) | Gaussian1D(4, 5, 6)])\\n212. def test_compound_unsupported_inverse(model):\\n213.     """\\n214.     Ensure inverses aren\\\'t supported in cases where it shouldn\\\'t be.\\n215.     """\\n216. \\n217.     with pytest.raises(NotImplementedError):\\n218.         model.inverse\\n219. \\n220. \\n221. def test_mapping_basic_permutations():\\n222.     """\\n223.     Tests a couple basic examples of the Mapping model--specifically examples\\n224.     that merely permute the outputs.\\n225.     """\\n226. \\n227.     x, y = Rotation2D(90)(1, 2)\\n228. \\n229.     rs = Rotation2D(90) | Mapping((1, 0))\\n230.     x_prime, y_prime = rs(1, 2)\\n231.     assert_allclose((x, y), (y_prime, x_prime))\\n232. \\n233.     # A more complicated permutation\\n234.     m = Rotation2D(90) & Scale(2)\\n235.     x, y, z = m(1, 2, 3)\\n236. \\n237.     ms = m | Mapping((2, 0, 1))\\n238.     x_prime, y_prime, z_prime = ms(1, 2, 3)\\n239.     assert_allclose((x, y, z), (y_prime, z_prime, x_prime))\\n240. \\n241. \\n242. def test_mapping_inverse():\\n243.     """Tests inverting a compound model that includes a `Mapping`."""\\n244. \\n245.     rs1 = Rotation2D(12.1) & Scale(13.2)\\n246.     rs2 = Rotation2D(14.3) & Scale(15.4)\\n247. \\n248.     # Rotates 2 of the coordinates and scales the third--then rotates on a\\n249.     # different axis and scales on the axis of rotation.  No physical meaning\\n250.     # here just a simple test\\n251.     m = rs1 | Mapping([2, 0, 1]) | rs2\\n252. \\n253.     assert_allclose((0, 1, 2), m.inverse(*m(0, 1, 2)), atol=1e-08)\\n254. \\n255. \\n256. def test_identity_input():\\n257.     """\\n258.     Test a case where an Identity (or Mapping) model is the first in a chain\\n259.     of composite models and thus is responsible for handling input broadcasting\\n260.     properly.\\n261. \\n262.     Regression test for https://github.com/astropy/astropy/pull/3362\\n263.     """\\n264. \\n265.     ident1 = Identity(1)\\n266.     shift = Shift(1)\\n267.     rotation = Rotation2D(angle=90)\\n268.     model = ident1 & shift | rotation\\n269.     assert_allclose(model(1, 2), [-3.0, 1.0])\\n270. \\n271. \\n272. def test_invalid_operands():\\n273.     """\\n274.     Test that certain operators do not work with models whose inputs/outputs do\\n275.     not match up correctly.\\n276.     """\\n277. \\n278.     with pytest.raises(ModelDefinitionError):\\n279.         Rotation2D(90) | Gaussian1D(1, 0, 0.1)\\n280. \\n281.     with pytest.raises(ModelDefinitionError):\\n282.         Rotation2D(90) + Gaussian1D(1, 0, 0.1)\\n283. \\n284. \\n285. @pytest.mark.parametrize(\\\'poly\\\', [Chebyshev2D(1, 2), Polynomial2D(2), Legendre2D(1, 2)])\\n286. def test_compound_with_polynomials_2d(poly):\\n287.     """\\n288.     Tests that polynomials are scaled when used in compound models.\\n289.     Issue #3699\\n290.     """\\n291.     poly.parameters = [1, 2, 3, 4, 1, 2]\\n292.     shift = Shift(3)\\n293.     model = poly | shift\\n294.     x, y = np.mgrid[:20, :37]\\n295.     result_compound = model(x, y)\\n296.     result = shift(poly(x, y))\\n297.     assert_allclose(result, result_compound)\\n298. \\n299. \\n300. def test_fix_inputs():\\n301.     g1 = Gaussian2D(1, 0, 0, 1, 2)\\n302.     g2 = Gaussian2D(1.5, .5, -.2, .5, .3)\\n303.     sg1_1 = fix_inputs(g1, {1: 0})\\n304.     assert_allclose(sg1_1(0), g1(0, 0))\\n305.     assert_allclose(sg1_1([0, 1, 3]), g1([0, 1, 3], [0, 0, 0]))\\n306.     sg1_2 = fix_inputs(g1, {\\\'x\\\': 1})\\n307.     assert_allclose(sg1_2(1.5), g1(1, 1.5))\\n308.     gg1 = g1 & g2\\n309.     sgg1_1 = fix_inputs(gg1, {1: 0.1, 3: 0.2})\\n310.     assert_allclose(sgg1_1(0, 0), gg1(0, 0.1, 0, 0.2))\\n311.     sgg1_2 = fix_inputs(gg1, {\\\'x0\\\': -.1, 2: .1})\\n312.     assert_allclose(sgg1_2(1, 1), gg1(-0.1, 1, 0.1, 1))\\n313.     assert_allclose(sgg1_2(y0=1, y1=1), gg1(-0.1, 1, 0.1, 1))\\n314. \\n315. \\n316. def test_fix_inputs_invalid():\\n317.     g1 = Gaussian2D(1, 0, 0, 1, 2)\\n318.     with pytest.raises(ValueError):\\n319.         fix_inputs(g1, {\\\'x0\\\': 0, 0: 0})\\n320. \\n321.     with pytest.raises(ValueError):\\n322.         fix_inputs(g1, (0, 1))\\n323. \\n324.     with pytest.raises(ValueError):\\n325.         fix_inputs(g1, {3: 2})\\n326. \\n327.     with pytest.raises(ValueError):\\n328.         fix_inputs(g1, {np.int32(3): 2})\\n329. \\n330.     with pytest.raises(ValueError):\\n331.         fix_inputs(g1, {np.int64(3): 2})\\n332. \\n333.     with pytest.raises(ValueError):\\n334.         fix_inputs(g1, {\\\'w\\\': 2})\\n335. \\n336.     with pytest.raises(ModelDefinitionError):\\n337.         CompoundModel(\\\'#\\\', g1, g1)\\n338. \\n339.     with pytest.raises(ValueError):\\n340.         gg1 = fix_inputs(g1, {0: 1})\\n341.         gg1(2, y=2)\\n342. \\n343.     with pytest.raises(ValueError):\\n344.         gg1 = fix_inputs(g1, {np.int32(0): 1})\\n345.         gg1(2, y=2)\\n346. \\n347.     with pytest.raises(ValueError):\\n348.         gg1 = fix_inputs(g1, {np.int64(0): 1})\\n349.         gg1(2, y=2)\\n350. \\n351. \\n352. def test_fix_inputs_with_bounding_box():\\n353.     g1 = Gaussian2D(1, 0, 0, 1, 1)\\n354.     g2 = Gaussian2D(1, 0, 0, 1, 1)\\n355.     assert g1.bounding_box == ((-5.5, 5.5), (-5.5, 5.5))\\n356. \\n357.     gg1 = g1 & g2\\n358.     gg1.bounding_box = ((-5.5, 5.5), (-5.4, 5.4), (-5.3, 5.3), (-5.2, 5.2))\\n359.     assert gg1.bounding_box == ((-5.5, 5.5), (-5.4, 5.4), (-5.3, 5.3), (-5.2, 5.2))\\n360. \\n361.     sg = fix_inputs(gg1, {0: 0, 2: 0})\\n362.     assert sg.bounding_box == ((-5.5, 5.5), (-5.3, 5.3))\\n363. \\n364.     g1 = Gaussian1D(10, 3, 1)\\n365.     g = g1 & g1\\n366.     g.bounding_box = ((1, 4), (6, 8))\\n367.     gf = fix_inputs(g, {0: 1})\\n368.     assert gf.bounding_box == (1, 4)\\n369. \\n370. \\n371. def test_indexing_on_instance():\\n372.     """Test indexing on compound model instances."""\\n373. \\n374.     m = Gaussian1D(1, 0, 0.1) + Const1D(2)\\n375.     assert isinstance(m[0], Gaussian1D)\\n376.     assert isinstance(m[1], Const1D)\\n377.     assert m.param_names == (\\\'amplitude_0\\\', \\\'mean_0\\\', \\\'stddev_0\\\', \\\'amplitude_1\\\')\\n378. \\n379.     # Test parameter equivalence\\n380.     assert m[0].amplitude == 1 == m.amplitude_0\\n381.     assert m[0].mean == 0 == m.mean_0\\n382.     assert m[0].stddev == 0.1 == m.stddev_0\\n383.     assert m[1].amplitude == 2 == m.amplitude_1\\n384. \\n385.     # Test that parameter value updates are symmetric between the compound\\n386.     # model and the submodel returned by indexing\\n387.     const = m[1]\\n388.     m.amplitude_1 = 42\\n389.     assert const.amplitude == 42\\n390.     const.amplitude = 137\\n391.     assert m.amplitude_1 == 137\\n392. \\n393.     # Similar couple of tests, but now where the compound model was created\\n394.     # from model instances\\n395.     g = Gaussian1D(1, 2, 3, name=\\\'g\\\')\\n396.     p = Polynomial1D(2, name=\\\'p\\\')\\n397.     m = g + p\\n398.     assert m[0].name == \\\'g\\\'\\n399.     assert m[1].name == \\\'p\\\'\\n400.     assert m[\\\'g\\\'].name == \\\'g\\\'\\n401.     assert m[\\\'p\\\'].name == \\\'p\\\'\\n402. \\n403.     poly = m[1]\\n404.     m.c0_1 = 12345\\n405.     assert poly.c0 == 12345\\n406.     poly.c1 = 6789\\n407.     assert m.c1_1 == 6789\\n408. \\n409.     # Test negative indexing\\n410.     assert isinstance(m[-1], Polynomial1D)\\n411.     assert isinstance(m[-2], Gaussian1D)\\n412. \\n413.     with pytest.raises(IndexError):\\n414.         m[42]\\n415. \\n416.     with pytest.raises(IndexError):\\n417.         m[\\\'foobar\\\']\\n418. \\n419.     # Confirm index-by-name works with fix_inputs\\n420.     g = Gaussian2D(1, 2, 3, 4, 5, name=\\\'g\\\')\\n421.     m = fix_inputs(g, {0: 1})\\n422.     assert m[\\\'g\\\'].name == \\\'g\\\'\\n423. \\n424.     # Test string slicing\\n425.     A = Const1D(1.1, name=\\\'A\\\')\\n426.     B = Const1D(2.1, name=\\\'B\\\')\\n427.     C = Const1D(3.1, name=\\\'C\\\')\\n428.     M = A + B * C\\n429.     assert_allclose(M[\\\'B\\\':\\\'C\\\'](1), 6.510000000000001)\\n430. \\n431. \\n432. class _ConstraintsTestA(Model):\\n433.     stddev = Parameter(default=0, min=0, max=0.3)\\n434.     mean = Parameter(default=0, fixed=True)\\n435. \\n436.     @staticmethod\\n437.     def evaluate(stddev, mean):\\n438.         return stddev, mean\\n439. \\n440. \\n441. class _ConstraintsTestB(Model):\\n442.     mean = Parameter(default=0, fixed=True)\\n443. \\n444.     @staticmethod\\n445.     def evaluate(mean):\\n446.         return mean\\n447. \\n448. \\n449. def test_inherit_constraints():\\n450.     """\\n451.     Various tests for copying of constraint values between compound models and\\n452.     their members.\\n453. \\n454.     Regression test for https://github.com/astropy/astropy/issues/3481\\n455.     """\\n456.     model = (Gaussian1D(bounds={\\\'stddev\\\': (0, 0.3)}, fixed={\\\'mean\\\': True}) +\\n457.              Gaussian1D(fixed={\\\'mean\\\': True}))\\n458. \\n459.     # Lots of assertions in this test as there are multiple interfaces to\\n460.     # parameter constraints\\n461. \\n462.     assert \\\'stddev_0\\\' in model.bounds\\n463.     assert model.bounds[\\\'stddev_0\\\'] == (0, 0.3)\\n464.     assert model.stddev_0.bounds == (0, 0.3)\\n465.     assert \\\'mean_0\\\' in model.fixed\\n466.     assert model.fixed[\\\'mean_0\\\'] is True\\n467.     assert model.mean_0.fixed is True\\n468.     assert \\\'mean_1\\\' in model.fixed\\n469.     assert model.fixed[\\\'mean_1\\\'] is True\\n470.     assert model.mean_1.fixed is True\\n471. \\n472.     assert model.stddev_0 is model[0].stddev\\n473.     # Great, all the constraints were inherited properly\\n474.     # Now what about if we update them through the sub-models?\\n475.     model.stddev_0.bounds = (0, 0.4)\\n476.     assert model[0].stddev.bounds == (0, 0.4)\\n477.     assert model[0].bounds[\\\'stddev\\\'] == (0, 0.4)\\n478. \\n479.     model.stddev_0.bounds = (0.1, 0.5)\\n480.     assert model[0].stddev.bounds == (0.1, 0.5)\\n481.     assert model[0].bounds[\\\'stddev\\\'] == (0.1, 0.5)\\n482. \\n483.     model[1].mean.fixed = False\\n484.     assert model.mean_1.fixed is False\\n485.     assert model[1].mean.fixed is False\\n486. \\n487.     # Now turn off syncing of constraints\\n488.     assert model.bounds[\\\'stddev_0\\\']  == (0.1, 0.5)\\n489.     model.sync_constraints = False\\n490.     model[0].stddev.bounds = (0, 0.2)\\n491.     assert model.bounds[\\\'stddev_0\\\'] == (0.1, 0.5)\\n492.     model.sync_constraints = True\\n493.     assert model.bounds[\\\'stddev_0\\\'] == (0, 0.2)\\n494. \\n495. \\n496. def test_compound_custom_inverse():\\n497.     """\\n498.     Test that a compound model with a custom inverse has that inverse applied\\n499.     when the inverse of another model, of which it is a component, is computed.\\n500.     Regression test for https://github.com/astropy/astropy/issues/3542\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/modeling/tests/test_separable.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """\\n3. Test separability of models.\\n4. \\n5. """\\n6. # pylint: disable=invalid-name\\n7. import pytest\\n8. import numpy as np\\n9. from numpy.testing import assert_allclose\\n10. \\n11. from astropy.modeling import custom_model, models\\n12. from astropy.modeling.models import Mapping\\n13. from astropy.modeling.separable import (_coord_matrix, is_separable, _cdot,\\n14.                                         _cstack, _arith_oper, separability_matrix)\\n15. from astropy.modeling.core import ModelDefinitionError\\n16. \\n17. \\n18. sh1 = models.Shift(1, name=\\\'shift1\\\')\\n19. sh2 = models.Shift(2, name=\\\'sh2\\\')\\n20. scl1 = models.Scale(1, name=\\\'scl1\\\')\\n21. scl2 = models.Scale(2, name=\\\'scl2\\\')\\n22. map1 = Mapping((0, 1, 0, 1), name=\\\'map1\\\')\\n23. map2 = Mapping((0, 0, 1), name=\\\'map2\\\')\\n24. map3 = Mapping((0, 0), name=\\\'map3\\\')\\n25. rot = models.Rotation2D(2, name=\\\'rotation\\\')\\n26. p2 = models.Polynomial2D(1, name=\\\'p2\\\')\\n27. p22 = models.Polynomial2D(2, name=\\\'p22\\\')\\n28. p1 = models.Polynomial1D(1, name=\\\'p1\\\')\\n29. \\n30. \\n31. compound_models = {\\n32.     \\\'cm1\\\': (map3 & sh1 | rot & sh1 | sh1 & sh2 & sh1,\\n33.             (np.array([False, False, True]),\\n34.              np.array([[True, False], [True, False], [False, True]]))\\n35.             ),\\n36.     \\\'cm2\\\': (sh1 & sh2 | rot | map1 | p2 & p22,\\n37.             (np.array([False, False]),\\n38.              np.array([[True, True], [True, True]]))\\n39.             ),\\n40.     \\\'cm3\\\': (map2 | rot & scl1,\\n41.             (np.array([False, False, True]),\\n42.              np.array([[True, False], [True, False], [False, True]]))\\n43.             ),\\n44.     \\\'cm4\\\': (sh1 & sh2 | map2 | rot & scl1,\\n45.             (np.array([False, False, True]),\\n46.              np.array([[True, False], [True, False], [False, True]]))\\n47.             ),\\n48.     \\\'cm5\\\': (map3 | sh1 & sh2 | scl1 & scl2,\\n49.             (np.array([False, False]),\\n50.              np.array([[True], [True]]))\\n51.             ),\\n52.     \\\'cm7\\\': (map2 | p2 & sh1,\\n53.             (np.array([False, True]),\\n54.              np.array([[True, False], [False, True]]))\\n55.             )\\n56. }\\n57. \\n58. \\n59. def test_coord_matrix():\\n60.     c = _coord_matrix(p2, \\\'left\\\', 2)\\n61.     assert_allclose(np.array([[1, 1], [0, 0]]), c)\\n62.     c = _coord_matrix(p2, \\\'right\\\', 2)\\n63.     assert_allclose(np.array([[0, 0], [1, 1]]), c)\\n64.     c = _coord_matrix(p1, \\\'left\\\', 2)\\n65.     assert_allclose(np.array([[1], [0]]), c)\\n66.     c = _coord_matrix(p1, \\\'left\\\', 1)\\n67.     assert_allclose(np.array([[1]]), c)\\n68.     c = _coord_matrix(sh1, \\\'left\\\', 2)\\n69.     assert_allclose(np.array([[1], [0]]), c)\\n70.     c = _coord_matrix(sh1, \\\'right\\\', 2)\\n71.     assert_allclose(np.array([[0], [1]]), c)\\n72.     c = _coord_matrix(sh1, \\\'right\\\', 3)\\n73.     assert_allclose(np.array([[0], [0], [1]]), c)\\n74.     c = _coord_matrix(map3, \\\'left\\\', 2)\\n75.     assert_allclose(np.array([[1], [1]]), c)\\n76.     c = _coord_matrix(map3, \\\'left\\\', 3)\\n77.     assert_allclose(np.array([[1], [1], [0]]), c)\\n78. \\n79. \\n80. def test_cdot():\\n81.     result = _cdot(sh1, scl1)\\n82.     assert_allclose(result, np.array([[1]]))\\n83. \\n84.     result = _cdot(rot, p2)\\n85.     assert_allclose(result, np.array([[2, 2]]))\\n86. \\n87.     result = _cdot(rot, rot)\\n88.     assert_allclose(result, np.array([[2, 2], [2, 2]]))\\n89. \\n90.     result = _cdot(Mapping((0, 0)), rot)\\n91.     assert_allclose(result, np.array([[2], [2]]))\\n92. \\n93.     with pytest.raises(ModelDefinitionError,\\n94.                        match=r"Models cannot be combined with the \\\\"|\\\\" operator; .*"):\\n95.         _cdot(sh1, map1)\\n96. \\n97. \\n98. def test_cstack():\\n99.     result = _cstack(sh1, scl1)\\n100.     assert_allclose(result, np.array([[1, 0], [0, 1]]))\\n101. \\n102.     result = _cstack(sh1, rot)\\n103.     assert_allclose(result,\\n104.                     np.array([[1, 0, 0],\\n105.                               [0, 1, 1],\\n106.                               [0, 1, 1]])\\n107.                     )\\n108.     result = _cstack(rot, sh1)\\n109.     assert_allclose(result,\\n110.                     np.array([[1, 1, 0],\\n111.                               [1, 1, 0],\\n112.                               [0, 0, 1]])\\n113.                     )\\n114. \\n115. \\n116. def test_arith_oper():\\n117.     # Models as inputs\\n118.     result = _arith_oper(sh1, scl1)\\n119.     assert_allclose(result, np.array([[1]]))\\n120.     result = _arith_oper(rot, rot)\\n121.     assert_allclose(result, np.array([[1, 1], [1, 1]]))\\n122. \\n123.     # ndarray\\n124.     result = _arith_oper(np.array([[1, 2], [3, 4]]), np.array([[1, 2], [3, 4]]))\\n125.     assert_allclose(result, np.array([[1, 1], [1, 1]]))\\n126. \\n127.     # Error\\n128.     with pytest.raises(ModelDefinitionError, match=r"Unsupported operands for arithmetic operator: .*"):\\n129.         _arith_oper(sh1, map1)\\n130. \\n131. \\n132. @pytest.mark.parametrize((\\\'compound_model\\\', \\\'result\\\'), compound_models.values())\\n133. def test_separable(compound_model, result):\\n134.     assert_allclose(is_separable(compound_model), result[0])\\n135.     assert_allclose(separability_matrix(compound_model), result[1])\\n136. \\n137. \\n138. def test_custom_model_separable():\\n139.     @custom_model\\n140.     def model_a(x):\\n141.         return x\\n142. \\n143.     assert model_a().separable\\n144. \\n145.     @custom_model\\n146.     def model_c(x, y):\\n147.         return x + y\\n148. \\n149.     assert not model_c().separable\\n150.     assert np.all(separability_matrix(model_c()) == [True, True])\', \'start_line_number\': 1, \'end_line_number\': 150}\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-12-21 08:12:36,673 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport numpy as np\nfrom numpy.testing import assert_array_equal\n\nfrom astropy.modeling import models as m\nfrom astropy.modeling.separable import separability_matrix\n\n\ndef test_separability_of_nested_compound_model():\n    """\n    Test separability_matrix for nested compound models.\n\n    Regression test for a bug where the separability of a nested\n    CompoundModel was not computed correctly.\n    """\n    cm = m.Linear1D(10) & m.Linear1D(5)\n    model = m.Pix2Sky_TAN() & cm\n\n    # The separability of the nested model should be the same as\n    # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)\n    expected = np.array([\n        [True,  True, False, False],\n        [True,  True, False, False],\n        [False, False,  True, False],\n        [False, False, False,  True]\n    ])\n\n    result = separability_matrix(model)\n    assert_array_equal(result, expected)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1688, 'end_index': 2073, 'uri': 'https://huggingface.co/datasets/exploiter345/SWE-bench_Verified_Lite_Annt', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 100658, 'candidates_token_count': 268, 'total_token_count': 103186, 'prompt_tokens_details': [{'modality': 1, 'token_count': 100658}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 268}], 'thoughts_token_count': 2260, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9703312204844916, 'model_name': 'gemini-2.5-pro'} id='run--4b9f84e9-520d-4f41-94f8-987f835a5e48-0' usage_metadata={'input_tokens': 100658, 'output_tokens': 268, 'total_tokens': 103186, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2260}}
2025-12-21 08:12:42,005 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nfrom numpy.testing import assert_array_equal\\n\\nfrom astropy.modeling import models as m\\nfrom astropy.modeling.separable import separability_matrix\\n\\n\\ndef test_separability_of_nested_compound_model():\\n    \\"\\"\\"\\n    Test separability_matrix for nested compound models.\\n\\n    Regression test for a bug where the separability of a nested\\n    CompoundModel was not computed correctly.\\n    \\"\\"\\"\\n    cm = m.Linear1D(10) & m.Linear1D(5)\\n    model = m.Pix2Sky_TAN() & cm\\n\\n    # The separability of the nested model should be the same as\\n    # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)\\n    expected = np.array([\\n        [True,  True, False, False],\\n        [True,  True, False, False],\\n        [False, False,  True, False],\\n        [False, False, False,  True]\\n    ])\\n\\n    result = separability_matrix(model)\\n    assert_array_equal(result, expected)\\n", "relative_path": "astropy/modeling/tests/test_separable_regression.py"}'}, '__gemini_function_call_thought_signatures__': {'f6c72f36-13eb-4af8-80a7-8786a0e4b922': 'Ct4IAY89a184aU1VQXmlpNMzQ+Up843R4jEn0No9XgXAzwQ6v8sNv29DbbzFl8/KalWiDhPpcGqlXr45NDrAK2Gt81aE2mvFjHZ6YhSLGIouEnNaV49BEmXUfWACqbBn8+J0RFNnZ52muii4JI4S4VrXjRgWENqGUin08+DH4OQnlGzWdR8h6tDo6AuyJXy9WND3FuT05cH1fSbmiCH/c/ovcieGu67J6djokldTpueG1gwqX4Uv4XHo8c/OTtXLOxClx03gNykeR9bTsBfHe5S+llT7OYrY0Ea4vIjUsdyy+MXYFyrzaItrwxcRLi6p1dwRJbLkq90TTfz2M1fxsqrEKCgnpKYN5HZW2gZxCvDweEf2ZtAUXk+2gUn+LWy0xueGCS3+sdif6mNgFAccNtHJbD1186Uo7yRHuI0HZ5gjBmD/54FWwydBzoaFbwmvis0EaUToIZsUDrhCUDbypRfpS0IhQwsz3aTGAJjPZbsdLDoAQf6N1Qz52+umvNzYLZ+4+nVRnCN3GHa8amUILAEBz27ClUygVCpCWT7aubqzfUzBtjci3qlRai3zFkbBNu+fLLlnTJuuAIXtoq3RpFft0ZUWAZm9KGffgx6x/a2wOqVRiuS14A76GlnKyaZkkSKKp7sKOMfIxCGh1CBASI5PZbmtqUayDQcR0Q8MgHkbQN9WRN8VYgt4gKWNPzdUu+ihFXuMx7oAwkn9wUaKNC+qusb/cYkc6WKKmPpYshq5gEgpvxcgCPmrN504Kl3da8SW0oWDsnJOt1bdM5DYaoDVyq0zUKnBlYQRxh4v7fCN82zHHXchuWmGDYl/P2A4IwDeUd/G1EJ138tsDGFApGBSwla8jobybssBtdKCDRrLHngi3hsDFKI1TOi8b0sANgZUO3EUKbmu49WxsUTaEC1Mk74tLAY0jVkRLlttA9/pyXB9ATkOpQnGv4sDT6ugI3eQCJ8U7OXVbuglMRkAxtYzHDb962DS4CjDtrQVPVirdUOPRB83UM04hhWm2jvoVXgcrLEO6OQXMtKnYAEQCETDzJC2NT7MDXS6tFfS6ZBySQTQi/7PLaTEfewg8u6jVvDCDl3xfb+ZSGEN/WQ6saEBDnVJV3cefvyAMowi9Z3zZRE6HYYeB3ADdKT+GtO7W6psnMg0tlBs+f5UXZQUUhYUxuOThiAfJLhVvoX7a0O6ix8UjfAnCSGBM31+0RKrjhaCmkch0XBsgaYLAnMd3FP9ABCeb7zfpcYmX0Zf6MQhZzgxfAQqE6ZWzSs7uunyd+EZN4Kz+VA9Mmv7OnxYW0N0cDwHP7mBiCwt87qnIO7IdOOETDbalwm0CKk75xpwgnRSNE2n+F0fL+tJ2uhyu1wjSwWy1cCUEBu0bjL4ids2/t806kMGpXg8NVYHb7IZqyIjo6k48SOAN158yzLLJK0VOS4m7xEWGdq2XjOpAshtJTLs2Eisj33c8B47qjeEw5Gwww3DBFEVw3lK3t677bY='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 586, 'candidates_token_count': 285, 'total_token_count': 1127, 'prompt_tokens_details': [{'modality': 1, 'token_count': 586}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 285}], 'thoughts_token_count': 256, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11311652200263843, 'model_name': 'gemini-2.5-pro'} id='run--4c413825-ba43-46e8-980e-f62d31ae6de0-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nfrom numpy.testing import assert_array_equal\n\nfrom astropy.modeling import models as m\nfrom astropy.modeling.separable import separability_matrix\n\n\ndef test_separability_of_nested_compound_model():\n    """\n    Test separability_matrix for nested compound models.\n\n    Regression test for a bug where the separability of a nested\n    CompoundModel was not computed correctly.\n    """\n    cm = m.Linear1D(10) & m.Linear1D(5)\n    model = m.Pix2Sky_TAN() & cm\n\n    # The separability of the nested model should be the same as\n    # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)\n    expected = np.array([\n        [True,  True, False, False],\n        [True,  True, False, False],\n        [False, False,  True, False],\n        [False, False, False,  True]\n    ])\n\n    result = separability_matrix(model)\n    assert_array_equal(result, expected)\n', 'relative_path': 'astropy/modeling/tests/test_separable_regression.py'}, 'id': 'f6c72f36-13eb-4af8-80a7-8786a0e4b922', 'type': 'tool_call'}] usage_metadata={'input_tokens': 586, 'output_tokens': 285, 'total_tokens': 1127, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 256}}
2025-12-21 08:12:43,269 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/modeling/tests/test_separable_regression.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 895, 'candidates_token_count': 14, 'total_token_count': 909, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1151}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 14}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -3.5992948271866355e-05, 'model_name': 'gemini-2.5-pro'} id='run--b88348c0-eef0-41da-ac0b-383f0fb484d8-0' usage_metadata={'input_tokens': 895, 'output_tokens': 14, 'total_tokens': 909, 'input_token_details': {'cache_read': 0}}
2025-12-21 08:12:43,533 - thread-130546493556416.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/modeling/tests/test_separable_regression.py b/astropy/modeling/tests/test_separable_regression.py
new file mode 100644
index 0000000000..5e0aa5c575
--- /dev/null
+++ b/astropy/modeling/tests/test_separable_regression.py
@@ -0,0 +1,28 @@
+import numpy as np
+from numpy.testing import assert_array_equal
+
+from astropy.modeling import models as m
+from astropy.modeling.separable import separability_matrix
+
+
+def test_separability_of_nested_compound_model():
+    """
+    Test separability_matrix for nested compound models.
+
+    Regression test for a bug where the separability of a nested
+    CompoundModel was not computed correctly.
+    """
+    cm = m.Linear1D(10) & m.Linear1D(5)
+    model = m.Pix2Sky_TAN() & cm
+
+    # The separability of the nested model should be the same as
+    # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)
+    expected = np.array([
+        [True,  True, False, False],
+        [True,  True, False, False],
+        [False, False,  True, False],
+        [False, False, False,  True]
+    ])
+
+    result = separability_matrix(model)
+    assert_array_equal(result, expected)

2025-12-21 08:12:43,534 - thread-130546493556416.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 08:12:43,572 - thread-130546493556416.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 08:12:43,572 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 08:12:43,673 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:12:43,673 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:

HEAD is now at d16bfe05a7 Merge pull request #12900 from Cadair/custom_compound_model

2025-12-21 08:12:43,673 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 08:12:43,775 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:12:43,775 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:


2025-12-21 08:12:43,775 - thread-130546493556416.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 08:12:43,775 - thread-130546493556416.app.docker.base_container - INFO - Creating directory astropy/modeling/tests in the container
2025-12-21 08:12:43,775 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/modeling/tests
2025-12-21 08:12:43,877 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:12:43,877 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:


2025-12-21 08:12:43,877 - thread-130546493556416.app.docker.base_container - INFO - Updating astropy/modeling/tests/test_separable_regression.py in the container
2025-12-21 08:12:43,884 - thread-130546493556416.app.docker.base_container - INFO - Files updated successfully
2025-12-21 08:12:46,323 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pip install pytest astropy"}'}, '__gemini_function_call_thought_signatures__': {'ded6fadc-0a8f-48d3-b2bf-3957f9d87739': 'CtwFAY89a19pWRs7M9O4p4AM+zvtEcTirN63CtV/F5Cd2LKvIZnavkPHBeyvqF7K3jKTpUOBQ6mOURjGgCszF6Al6TtIyLO0/ooKi+YaAa+sdW6/PGy4lyCoW2c4yR02P4GDAm0iFoMynhgrp4hqcRT1M7KxK7KDmgrGc1+rWT4ioNQz/x4gbbiLO67ZeDzOD+KwuRN9h7+9fjKnTMFEV7grQQqhxHxB3NGbu5fBnlZ7OfZHMRIJfzaG7rYRZf4HSwlOjFNRAZeLpYH6g3hjVNv8aYpgbblF1PHQM0DMvUgXOKa59jH/DtpaaH7otNSBnig/NvKVSkcm9zZ353MDW4Eflx1JYPri2AHGmTKJ6q+EWdyJbjhEbjqXUHshz+nZ/zdnPGfOiOs/iUWg3/dsCCkkiuIt+ZDFlnQwRgHCJnfLofcbcEebLzI7kNGnp0Ex/Gv0Gm4VvNpUWpP6xoWfCSyurDdFvPrL/HvUtdUMLgMw0MprkgZPySHVfSVETheQ9KHNebckF62TuVm7VuD6Auib0OpX0LW7+97eoMr7s1Ahx+Cc7kKRpeUxTlnlhzGilRjwGUd9s8YfcV9XncnQjE11viU6mdo7L2ZHPW4PSbRsuWrKnHjEyT6ha5O8E/uyU5IRegm/vaODVm6uoiS3n2c5BYQ4imlC7+gsT4+Kkj1oOi6+XVKeOJ1yGGzwSgcCQ9vWkeSw+gMDDcw5R98mEpye3mZwOsOYkaSKB3pqiZqQ8KjGbPMqAdWsxKoNDa5M7KL4ttR6+Rjh4gwsyNvtPwGANiPi59fQJOVDe3hd5Wmbr1xSFQtmu4QLCRP/bY+2U2jsRLR6QhrqyydkbFs42fm0r9oX9BBwffTfIl61bf2rT/ow7upEwh0IgSUX7yG41Mz/tKiKp2BTHhbO09gphHQ/IzbO5AH5fSEz6VbNIhslJxKPdtUY3ceSQh0Ppj9qym43dCKKGLOM0BJTjmph'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 578, 'candidates_token_count': 9, 'total_token_count': 770, 'prompt_tokens_details': [{'modality': 1, 'token_count': 578}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 9}], 'thoughts_token_count': 183, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.312263700697157, 'model_name': 'gemini-2.5-pro'} id='run--560e118f-06a0-463e-a5e8-69b219fa20b3-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pip install pytest astropy'}, 'id': 'ded6fadc-0a8f-48d3-b2bf-3957f9d87739', 'type': 'tool_call'}] usage_metadata={'input_tokens': 578, 'output_tokens': 9, 'total_tokens': 770, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 183}}
2025-12-21 08:12:46,326 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: pip install pytest astropy
2025-12-21 08:12:47,217 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:12:47,218 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:

Requirement already satisfied: pytest in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (7.4.0)
Requirement already satisfied: astropy in /testbed (5.1.dev623+gd16bfe05a.d20251221)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest) (2.0.0)
Requirement already satisfied: packaging in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest) (23.1)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest) (2.0.1)
Requirement already satisfied: numpy>=1.18 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy) (6.0.1)
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-12-21 08:12:48,747 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/modeling/tests/test_separable_regression.py"}'}, '__gemini_function_call_thought_signatures__': {'3b30b73f-6d51-4234-96b6-95b012d11e80': 'CuEBAY89a19V8eB2latoYSwOl27k2N9Qq1xotRT7zn1YwKy2vo0yo6B99grEqHzEL60I8paZn1t7RXpbGpRC7xCveG3+bKnld5ctxjFwLVyh45+dfbvZGRzXZQ54D6A9wu3udEZ2gETEhq4c65+1yZDlgSM/sq97KJsR/A1C6XH4l8QgJBgwJ7zDd/YcKX4WBIBFQbyhx5F8HYhZo8xREbNjW38QuTaXizC5OgPpRag52XEJHCDKQKUi9DRWKqtEhAEzk90gbUhV2SI3dkanOvlY5uu/ueF67N9hFHzTrrpRt5Kx'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1129, 'candidates_token_count': 19, 'total_token_count': 1193, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1312}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 19}], 'thoughts_token_count': 45, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08439941155283075, 'model_name': 'gemini-2.5-pro'} id='run--8aaedcb0-5834-4cd5-b1e5-e117d5c98e61-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/modeling/tests/test_separable_regression.py'}, 'id': '3b30b73f-6d51-4234-96b6-95b012d11e80', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1129, 'output_tokens': 19, 'total_tokens': 1193, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 45}}
2025-12-21 08:12:48,750 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: pytest astropy/modeling/tests/test_separable_regression.py
2025-12-21 08:12:52,653 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 08:12:52,653 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:
pytest astropy/modeling/tests/test_separabl
le_regression.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev623+gd16bfe05a.d20251221.
Running tests in astropy/modeling/tests/test_separable_regression.py.

Date: 2025-12-21T08:12:51

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collecting 0 items                                                             [0m[1m
collected 1 item                                                               [0m

astropy/modeling/tests/test_separable_regression.py [31mF[0m[31m                    [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________ test_separability_of_nested_compound_model __________________[0m

    def test_separability_of_nested_compound_model():
        """
        Test separability_matrix for nested compound models.
    
        Regression test for a bug where the separability of a nested
        CompoundModel was not computed correctly.
        """
        cm = m.Linear1D(10) & m.Linear1D(5)
        model = m.Pix2Sky_TAN() & cm
    
        # The separability of the nested model should be the same as
        # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)
        expected = np.array([
            [True,  True, False, False],
            [True,  True, False, False],
            [False, False,  True, False],
            [False, False, False,  True]
        ])
    
        result = separability_matrix(model)
>       assert_array_equal(result, expected)

[1m[31mastropy/modeling/tests/test_separable_regression.py[0m:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<built-in function eq>, array([[ True,  True, False, False],
       [ True,  True, False, False],
       [False, Fals...alse],
       [ True,  True, False, False],
       [False, False,  True, False],
       [False, False, False,  True]]))
kwds = {'err_msg': '', 'header': 'Arrays are not equal', 'strict': False, 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
[1m[31mE           AssertionError: [0m
[1m[31mE           Arrays are not equal[0m
[1m[31mE           [0m
[1m[31mE           Mismatched elements: 2 / 16 (12.5%)[0m
[1m[31mE            x: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True,  True],[0m
[1m[31mE                  [False, False,  True,  True]])[0m
[1m[31mE            y: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True, False],[0m
[1m[31mE                  [False, False, False,  True]])[0m

[1m[31m/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py[0m:79: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/modeling/tests/test_separable_regression.py::[1mtest_separability_of_nested_compound_model[0m - AssertionError: 
[31m============================== [31m[1m1 failed[0m[31m in 0.63s[0m[31m ===============================[0m

2025-12-21 08:12:54,547 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/modeling/tests/test_separable_regression.py"}'}, '__gemini_function_call_thought_signatures__': {'23364e57-a10c-4895-ae54-e016f7102cab': 'CocDAY89a19kcbQlrSYGLCJcNMWJmQOJjnEhK23olc0qE0j9NpcGH+6n97InbbSStrvBevK+4lbHq+crWNUm7UegFK/KSX8pGVwDpTy0YneSbggHB+j4ZsAc4KBQx0E9192eDn4HYislhx96GPD0j7AUC08T1zoUlJUaeXkVHFk0+wfFAkl5Js0GbGjo9ml47elJqUWbigFG9cuFmYtk88zGexB5qjmhCAdIcxx6VTuLwWbSR83LOcdqDfshFCEU5c1zAIWrVYochlJfxcdV0CbMxmnlj3NXJZfQJ9hBgWa/8i80pYfuuqIKrU6dqlnGHdN0KM77RL/K65gamjGp8+VHusOsRnGxgKWTnC1qRj6nmgA2nc+3g5psd0fvI8WeCQCwhIn0iqAcK6BGBazMyoyIRabHbpEzZO1G419SoR5eac9IpNhZHPTK/Jos3CSDvZAxk2Gib/W+1uae8UftFmCg1LS+JhxEZqwBpkA3jEQc4WJGFK1eE7ZSs52UW+flU3b6zu1uw5fAeQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2686, 'candidates_token_count': 19, 'total_token_count': 2782, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2914}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 19}], 'thoughts_token_count': 77, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7764188364932412, 'model_name': 'gemini-2.5-pro'} id='run--9d278cbc-fbdd-4c99-8eb6-96f1608fadf8-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/modeling/tests/test_separable_regression.py'}, 'id': '23364e57-a10c-4895-ae54-e016f7102cab', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2686, 'output_tokens': 19, 'total_tokens': 2782, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 77}}
2025-12-21 08:12:54,550 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: pytest astropy/modeling/tests/test_separable_regression.py
2025-12-21 08:12:56,575 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 08:12:56,575 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:
pytest astropy/modeling/tests/test_separabl
le_regression.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev623+gd16bfe05a.d20251221.
Running tests in astropy/modeling/tests/test_separable_regression.py.

Date: 2025-12-21T08:12:55

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/modeling/tests/test_separable_regression.py [31mF[0m[31m                    [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________ test_separability_of_nested_compound_model __________________[0m

    def test_separability_of_nested_compound_model():
        """
        Test separability_matrix for nested compound models.
    
        Regression test for a bug where the separability of a nested
        CompoundModel was not computed correctly.
        """
        cm = m.Linear1D(10) & m.Linear1D(5)
        model = m.Pix2Sky_TAN() & cm
    
        # The separability of the nested model should be the same as
        # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)
        expected = np.array([
            [True,  True, False, False],
            [True,  True, False, False],
            [False, False,  True, False],
            [False, False, False,  True]
        ])
    
        result = separability_matrix(model)
>       assert_array_equal(result, expected)

[1m[31mastropy/modeling/tests/test_separable_regression.py[0m:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<built-in function eq>, array([[ True,  True, False, False],
       [ True,  True, False, False],
       [False, Fals...alse],
       [ True,  True, False, False],
       [False, False,  True, False],
       [False, False, False,  True]]))
kwds = {'err_msg': '', 'header': 'Arrays are not equal', 'strict': False, 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
[1m[31mE           AssertionError: [0m
[1m[31mE           Arrays are not equal[0m
[1m[31mE           [0m
[1m[31mE           Mismatched elements: 2 / 16 (12.5%)[0m
[1m[31mE            x: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True,  True],[0m
[1m[31mE                  [False, False,  True,  True]])[0m
[1m[31mE            y: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True, False],[0m
[1m[31mE                  [False, False, False,  True]])[0m

[1m[31m/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py[0m:79: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/modeling/tests/test_separable_regression.py::[1mtest_separability_of_nested_compound_model[0m - AssertionError: 
[31m============================== [31m[1m1 failed[0m[31m in 0.34s[0m[31m ===============================[0m

2025-12-21 08:12:58,213 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/modeling/tests/test_separable_regression.py"}'}, '__gemini_function_call_thought_signatures__': {'82ae58aa-f3a4-4184-af93-7052bbbd21d5': 'Cu4BAY89a19KZCdC6Xsw8fyVfFuKOnikok4fEMF736OKlt74JCa8+Qjn3fkv3ADUwcDNBk4FJyUXwpdAivvXYJt8Fx3ulVBGG6fXNhHTfiRgn4KHPPu8wkP4XhnnudgDLUN1DEYfW4wTGO+CNB1zFos7Nu+K+FDW6+C4n+ErcGUfKLkEikQHP/rGxBdtHsxol1mmSN8mwBXbtD9sstRiByE/jHC6p2UBmgRjMX3rc0yW0e7iux9TJ5oViZG4m0gLqfWTBZtmkMn1Hu2/xtcRqNgTTPMK6jJlaET7L7Y4AcT4uDC5DV47utnpsXqTb9E/CQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4229, 'candidates_token_count': 19, 'total_token_count': 4294, 'cached_content_token_count': 1587, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4534}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1587}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 19}], 'thoughts_token_count': 46}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4585345920763518, 'model_name': 'gemini-2.5-pro'} id='run--9d946aa1-5f2d-460a-b805-d820c0fbf450-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/modeling/tests/test_separable_regression.py'}, 'id': '82ae58aa-f3a4-4184-af93-7052bbbd21d5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4229, 'output_tokens': 19, 'total_tokens': 4294, 'input_token_details': {'cache_read': 1587}, 'output_token_details': {'reasoning': 46}}
2025-12-21 08:12:58,215 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: pytest astropy/modeling/tests/test_separable_regression.py
2025-12-21 08:13:00,274 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 08:13:00,274 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:
pytest astropy/modeling/tests/test_separabl
le_regression.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev623+gd16bfe05a.d20251221.
Running tests in astropy/modeling/tests/test_separable_regression.py.

Date: 2025-12-21T08:12:59

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/modeling/tests/test_separable_regression.py [31mF[0m[31m                    [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________ test_separability_of_nested_compound_model __________________[0m

    def test_separability_of_nested_compound_model():
        """
        Test separability_matrix for nested compound models.
    
        Regression test for a bug where the separability of a nested
        CompoundModel was not computed correctly.
        """
        cm = m.Linear1D(10) & m.Linear1D(5)
        model = m.Pix2Sky_TAN() & cm
    
        # The separability of the nested model should be the same as
        # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)
        expected = np.array([
            [True,  True, False, False],
            [True,  True, False, False],
            [False, False,  True, False],
            [False, False, False,  True]
        ])
    
        result = separability_matrix(model)
>       assert_array_equal(result, expected)

[1m[31mastropy/modeling/tests/test_separable_regression.py[0m:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<built-in function eq>, array([[ True,  True, False, False],
       [ True,  True, False, False],
       [False, Fals...alse],
       [ True,  True, False, False],
       [False, False,  True, False],
       [False, False, False,  True]]))
kwds = {'err_msg': '', 'header': 'Arrays are not equal', 'strict': False, 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
[1m[31mE           AssertionError: [0m
[1m[31mE           Arrays are not equal[0m
[1m[31mE           [0m
[1m[31mE           Mismatched elements: 2 / 16 (12.5%)[0m
[1m[31mE            x: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True,  True],[0m
[1m[31mE                  [False, False,  True,  True]])[0m
[1m[31mE            y: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True, False],[0m
[1m[31mE                  [False, False, False,  True]])[0m

[1m[31m/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py[0m:79: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/modeling/tests/test_separable_regression.py::[1mtest_separability_of_nested_compound_model[0m - AssertionError: 
[31m============================== [31m[1m1 failed[0m[31m in 0.36s[0m[31m ===============================[0m

2025-12-21 08:13:11,144 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='pytest astropy/modeling/tests/test_separable_regression.py\n\n<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.1.dev623+gd16bfe05a.d20251221.\nRunning tests in astropy/modeling/tests/test_separable_regression.py.\n\nDate: 2025-12-21T08:12:59\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/modeling/tests/test_separable_regression.py F                    [100%]\n\n=================================== FAILURES ===================================\n__________________ test_separability_of_nested_compound_model __________________\n\n    def test_separability_of_nested_compound_model():\n        """\n        Test separability_matrix for nested compound models.\n    \n        Regression test for a bug where the separability of a nested\n        CompoundModel was not computed correctly.\n        """\n        cm = m.Linear1D(10) & m.Linear1D(5)\n        model = m.Pix2Sky_TAN() & cm\n    \n        # The separability of the nested model should be the same as\n        # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)\n        expected = np.array([\n            [True,  True, False, False],\n            [True,  True, False, False],\n            [False, False,  True, False],\n            [False, False, False,  True]\n        ])\n    \n        result = separability_matrix(model)\n>       assert_array_equal(result, expected)\n\nastropy/modeling/tests/test_separable_regression.py:28: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = (<built-in function eq>, array([[ True,  True, False, False],\n       [ True,  True, False, False],\n       [False, Fals...alse],\n       [ True,  True, False, False],\n       [False, False,  True, False],\n       [False, False, False,  True]]))\nkwds = {\'err_msg\': \'\', \'header\': \'Arrays are not equal\', \'strict\': False, \'verbose\': True}\n\n    @wraps(func)\n    def inner(*args, **kwds):\n        with self._recreate_cm():\n>           return func(*args, **kwds)\nE           AssertionError: \nE           Arrays are not equal\nE           \nE           Mismatched elements: 2 / 16 (12.5%)\nE            x: array([[ True,  True, False, False],\nE                  [ True,  True, False, False],\nE                  [False, False,  True,  True],\nE                  [False, False,  True,  True]])\nE            y: array([[ True,  True, False, False],\nE                  [ True,  True, False, False],\nE                  [False, False,  True, False],\nE                  [False, False, False,  True]])\n\n/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py:79: AssertionError\n=========================== short test summary info ============================\nFAILED astropy/modeling/tests/test_separable_regression.py::test_separability_of_nested_compound_model - AssertionError: \n============================== 1 failed in 0.36s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5772, 'candidates_token_count': 1283, 'total_token_count': 7096, 'cached_content_token_count': 3198, 'prompt_tokens_details': [{'modality': 1, 'token_count': 6123}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3198}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1283}], 'thoughts_token_count': 41}, 'finish_reason': 'STOP', 'avg_logprobs': -0.009009677176352877, 'model_name': 'gemini-2.5-pro'} id='run--b8192bad-3d6c-4b15-b4c0-406fbce8b658-0' usage_metadata={'input_tokens': 5772, 'output_tokens': 1283, 'total_tokens': 7096, 'input_token_details': {'cache_read': 3198}, 'output_token_details': {'reasoning': 41}}
2025-12-21 08:13:21,753 - thread-130546493556416.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='FAILED astropy/modeling/tests/test_separable_regression.py::test_separability_of_nested_compound_model - AssertionError: \nArrays are not equal\n\nMismatched elements: 2 / 16 (12.5%)\n x: array([[ True,  True, False, False],\n       [ True,  True, False, False],\n       [False, False,  True,  True],\n       [False, False,  True,  True]])\n y: array([[ True,  True, False, False],\n       [ True,  True, False, False],\n       [False, False,  True, False],\n       [False, False, False,  True]])' reproduced_bug_commands=['pytest astropy/modeling/tests/test_separable_regression.py']
2025-12-21 08:13:21,755 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-21 08:13:21,755 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-21 08:13:21,755 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: pytest astropy/modeling/tests/test_separable_regression.py
2025-12-21 08:13:23,791 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 08:13:23,791 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:
pytest astropy/modeling/tests/test_separabl
le_regression.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev623+gd16bfe05a.d20251221.
Running tests in astropy/modeling/tests/test_separable_regression.py.

Date: 2025-12-21T08:13:23

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/modeling/tests/test_separable_regression.py [31mF[0m[31m                    [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________ test_separability_of_nested_compound_model __________________[0m

    def test_separability_of_nested_compound_model():
        """
        Test separability_matrix for nested compound models.
    
        Regression test for a bug where the separability of a nested
        CompoundModel was not computed correctly.
        """
        cm = m.Linear1D(10) & m.Linear1D(5)
        model = m.Pix2Sky_TAN() & cm
    
        # The separability of the nested model should be the same as
        # the non-nested version: m.Pix2Sky_TAN() & m.Linear1D(10) & m.Linear1D(5)
        expected = np.array([
            [True,  True, False, False],
            [True,  True, False, False],
            [False, False,  True, False],
            [False, False, False,  True]
        ])
    
        result = separability_matrix(model)
>       assert_array_equal(result, expected)

[1m[31mastropy/modeling/tests/test_separable_regression.py[0m:28: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<built-in function eq>, array([[ True,  True, False, False],
       [ True,  True, False, False],
       [False, Fals...alse],
       [ True,  True, False, False],
       [False, False,  True, False],
       [False, False, False,  True]]))
kwds = {'err_msg': '', 'header': 'Arrays are not equal', 'strict': False, 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
[1m[31mE           AssertionError: [0m
[1m[31mE           Arrays are not equal[0m
[1m[31mE           [0m
[1m[31mE           Mismatched elements: 2 / 16 (12.5%)[0m
[1m[31mE            x: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True,  True],[0m
[1m[31mE                  [False, False,  True,  True]])[0m
[1m[31mE            y: array([[ True,  True, False, False],[0m
[1m[31mE                  [ True,  True, False, False],[0m
[1m[31mE                  [False, False,  True, False],[0m
[1m[31mE                  [False, False, False,  True]])[0m

[1m[31m/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py[0m:79: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/modeling/tests/test_separable_regression.py::[1mtest_separability_of_nested_compound_model[0m - AssertionError: 
[31m============================== [31m[1m1 failed[0m[31m in 0.36s[0m[31m ===============================[0m

2025-12-21 08:13:23,792 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-21 08:13:23,792 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-21 08:13:23,796 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-21 08:13:23,796 - thread-130546493556416.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 08:13:23,796 - thread-130546493556416.app.docker.base_container - INFO - Creating directory astropy/modeling in the container
2025-12-21 08:13:23,796 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/modeling
2025-12-21 08:13:23,897 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:13:23,898 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:


2025-12-21 08:13:23,898 - thread-130546493556416.app.docker.base_container - INFO - Updating astropy/modeling/separable.py in the container
2025-12-21 08:13:23,904 - thread-130546493556416.app.docker.base_container - INFO - Files updated successfully
2025-12-21 08:13:23,904 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-21 08:13:23,904 - thread-130546493556416.app.docker.base_container - DEBUG - Executing command: pytest astropy/modeling/tests/test_separable_regression.py
2025-12-21 08:13:25,927 - thread-130546493556416.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 08:13:25,927 - thread-130546493556416.app.docker.base_container - DEBUG - Command output:
pytest astropy/modeling/tests/test_separabl
le_regression.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev623+gd16bfe05a.d20251221.
Running tests in astropy/modeling/tests/test_separable_regression.py.

Date: 2025-12-21T08:13:25

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/modeling/tests/test_separable_regression.py [32m.[0m[32m                    [100%][0m

[32m============================== [32m[1m1 passed[0m[32m in 0.32s[0m[32m ===============================[0m

2025-12-21 08:13:25,927 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-21 08:13:25,956 - thread-130546493556416.app.lang_graph.nodes.dual_version_validation_node - INFO - Validation PASSED: Test fails on old, passes on new
2025-12-21 08:13:25,958 - thread-130546493556416.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-12-21 08:13:25,958 - thread-130546493556416.app.docker.base_container - INFO - Closing persistent shell...
2025-12-21 08:13:26,058 - thread-130546493556416.app.docker.base_container - INFO - Cleaning up container and temporary files
