2025-12-21 16:46:21,896 - thread-130546535499456.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpp3te3783/astropy
2025-12-21 16:46:21,896 - thread-130546535499456.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-12-21 16:46:21,896 - thread-130546535499456.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-14539:v1
2025-12-21 17:03:25,669 - thread-130546535499456.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_584a011557
2025-12-21 17:03:25,683 - thread-130546535499456.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_584a011557
2025-12-21 17:03:25,958 - thread-130546535499456.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-12-21 17:03:26,863 - thread-130546535499456.app.docker.base_container - INFO - Persistent shell is ready
2025-12-21 17:03:26,864 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-12-21 17:03:27,098 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:03:27,098 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 17:03:27,098 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-12-21 17:03:27,328 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:03:27,328 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 17:03:27,328 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-12-21 17:04:49,134 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:04:49,134 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
[A(testbed) root@ucl-research:/testbed# python -m pip install -e .[test] --verbos[Ke

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command pip subprocess to install build dependencies
  Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
  Collecting setuptools==68.0.0
    Obtaining dependency information for setuptools==68.0.0 from https://files.pythonhosted.org/packages/c7/42/be1c7bbdd83e1bfb160c94b9cafd8e25efc7400346cf7ccdbdb452c467fa/setuptools-68.0.0-py3-none-any.whl.metadata
    Using cached setuptools-68.0.0-py3-none-any.whl.metadata (6.4 kB)
  Collecting setuptools_scm>=6.2
    Obtaining dependency information for setuptools_scm>=6.2 from https://files.pythonhosted.org/packages/3d/ea/ac2bf868899d0d2e82ef72d350d97a846110c709bacf2d968431576ca915/setuptools_scm-9.2.2-py3-none-any.whl.metadata
    Downloading setuptools_scm-9.2.2-py3-none-any.whl.metadata (7.7 kB)
  Collecting wheel
    Obtaining dependency information for wheel from https://files.pythonhosted.org/packages/0b/2c/87f3254fd8ffd29e4c02732eee68a83a1d3c346ae39bc6822dcbcb697f2b/wheel-0.45.1-py3-none-any.whl.metadata
    Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
  Collecting cython==0.29.30
    Obtaining dependency information for cython==0.29.30 from https://files.pythonhosted.org/packages/a7/c6/3af0df983ba8500831fdae19a515be6e532da7683ab98e031d803e6a8d03/Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata
    Using cached Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata (2.8 kB)
  Collecting oldest-supported-numpy
    Obtaining dependency information for oldest-supported-numpy from https://files.pythonhosted.org/packages/dc/5c/e3c84cfdd488701aa074b22cf5bd227fb15d26e1d55a66d9088c39afa123/oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata
    Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata (9.8 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/88/ff/5a7cd8c9698628b3c04215ee3a96c69865477f451b4f096682e78d085bfc/extension_helpers-1.3.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/8e/b1/73ce2924fe46281faf31567e96fb9eee4eca02fd1cb852562bb2971e9df1/extension_helpers-1.3.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f8/fb/f9a88ccea5377736d5d1e53c8a6c70207178cdc1ebbf305a50a610cbb751/extension_helpers-1.4.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/24/51/d03359b683ed288b34d713dea97d2aee87a9bd866af1652554d9f643b47d/extension_helpers-1.4.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
  Collecting extension-helpers
    Obtaining dependency information for extension-helpers from https://files.pythonhosted.org/packages/b3/0e/22599eac9e50f4274e78e47cef7e760d7a1bb2f0d0fdfb0bb5b0d2da263a/extension_helpers-1.2.0-py3-none-any.whl.metadata
    Using cached extension_helpers-1.2.0-py3-none-any.whl.metadata (2.2 kB)
  Collecting packaging>=20 (from setuptools_scm>=6.2)
    Obtaining dependency information for packaging>=20 from https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl.metadata
    Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
  Collecting tomli>=1 (from setuptools_scm>=6.2)
    Obtaining dependency information for tomli>=1 from https://files.pythonhosted.org/packages/77/b8/0135fadc89e73be292b473cb820b4f5a08197779206b33191e801feeae40/tomli-2.3.0-py3-none-any.whl.metadata
    Downloading tomli-2.3.0-py3-none-any.whl.metadata (10 kB)
  Collecting typing-extensions (from setuptools_scm>=6.2)
    Obtaining dependency information for typing-extensions from https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
    Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/54/a4/f8188c4f3e07f7737683588210c073478abcb542048cf4ab6fedad0b458a/numpy-2.1.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/59/5f/9003bb3e632f2b58f5e3a3378902dcc73c5518070736c6740fe52454e8e1/numpy-2.1.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/4b/d1/8a730ea07f4a37d94f9172f4ce1d81064b7a64766b460378be278952de75/numpy-2.1.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/25/ca/1166b75c21abd1da445b97bf1fa2f14f423c6cfb4fc7c4ef31dccf9f6a94/numpy-2.1.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/47/1b/1d565e0f6e156e1522ab564176b8b29d71e13d8caf003a08768df3d5cec5/numpy-2.2.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f2/a5/fdbf6a7871703df6160b5cf3dd774074b086d278172285c52c2758b76305/numpy-2.2.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/ec/d0/c12ddfd3a02274be06ffc71f3efc6d0e457b0409c4481596881e748cb264/numpy-2.2.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/fb/90/8956572f5c4ae52201fdec7ba2044b2c882832dcec7d5d0922c9e9acf2de/numpy-2.2.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/e1/78/31103410a57bc2c2b93a3597340a8119588571f6a4539067546cb9a0bfac/numpy-2.2.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/dc/b2/ce4b867d8cd9c0ee84938ae1e6a6f7926ebf928c9090d036fc3c6a04f946/numpy-2.2.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/f3/db/8e12381333aea300890829a0a36bfa738cac95475d88982d538725143fd9/numpy-2.3.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/2e/19/d7c972dfe90a353dbd3efbbe1d14a5951de80c99c9dc1b93cd998d51dc0f/numpy-2.3.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/37/7d/3fec4199c5ffb892bed55cff901e4f39a58c81df9c44c280499e92cad264/numpy-2.3.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/b5/f4/098d2270d52b41f1bd7db9fc288aaa0400cb48c2a3e2af6fa365d9720947/numpy-2.3.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/76/65/21b3bc86aac7b8f2862db1e808f1ea22b028e30a225a34a5ede9bf8678f2/numpy-2.3.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/12/02/7111f298e24a44d6fa4b75b47d93eccf444e5afbcee5b04aac760ee48935/numpy-2.4.0rc1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/a4/7a/6a3d14e205d292b738db449d0de649b373a59edb0d0b4493821d0a3e8718/numpy-2.4.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
  Collecting numpy==1.19.3 (from oldest-supported-numpy)
    Obtaining dependency information for numpy==1.19.3 from https://files.pythonhosted.org/packages/c3/8d/2ae53d96a92a66b8daa3dfb2dd6cf4bfcb8e3d4148bdd713c8fc7de83141/numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata
    Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata (2.0 kB)
  Using cached setuptools-68.0.0-py3-none-any.whl (804 kB)
  Using cached Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (2.0 MB)
  Downloading setuptools_scm-9.2.2-py3-none-any.whl (62 kB)
  Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
  Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl (4.9 kB)
  Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl (14.9 MB)
  Using cached extension_helpers-1.2.0-py3-none-any.whl (23 kB)
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
  Downloading tomli-2.3.0-py3-none-any.whl (14 kB)
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
  Installing collected packages: wheel, typing-extensions, tomli, setuptools, packaging, numpy, cython, setuptools_scm, oldest-supported-numpy, extension-helpers
    Creating /tmp/pip-build-env-a6se2r0w/overlay/bin
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/wheel to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/f2py to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/f2py3 to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/f2py3.9 to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/cygdb to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/cython to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/cythonize to 755
    changing mode of /tmp/pip-build-env-a6se2r0w/overlay/bin/setuptools-scm to 755
  ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
  astropy 5.3.dev756+gc0a24c1dc9.d20241024 requires numpy>=1.21, but you have numpy 1.19.3 which is incompatible.
  Successfully installed cython-0.29.30 extension-helpers-1.2.0 numpy-1.19.3 oldest-supported-numpy-2023.12.21 packaging-25.0 setuptools-68.0.0 setuptools_scm-9.2.2 tomli-2.3.0 typing-extensions-4.15.0 wheel-0.45.1
  WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  Installing build dependencies ... [?25l[?25hdone
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable ... [?25l[?25hdone
  Running command Getting requirements to build editable
  running egg_info
  writing astropy.egg-info/PKG-INFO
  writing dependency_links to astropy.egg-info/dependency_links.txt
  writing entry points to astropy.egg-info/entry_points.txt
  writing requirements to astropy.egg-info/requires.txt
  writing top-level names to astropy.egg-info/top_level.txt
  reading manifest template 'MANIFEST.in'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file 'astropy.egg-info/SOURCES.txt'
  Getting requirements to build editable ... [?25l[?25hdone
  Running command Preparing editable metadata (pyproject.toml)
  running dist_info
  creating /tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info
  writing /tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-modern-metadata-l_sx1xe4/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-l_sx1xe4/astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info'
  Preparing editable metadata (pyproject.toml) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.21 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (6.0.1)
Requirement already satisfied: packaging>=19.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (23.1)
Requirement already satisfied: pytest>=7.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (7.4.0)
Requirement already satisfied: pytest-doctestplus>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (1.0.0)
Requirement already satisfied: pytest-astropy-header>=0.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (0.2.2)
Requirement already satisfied: pytest-astropy>=0.10 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (0.10.0)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.3.dev756+gc0a24c1dc.d20251221) (3.3.1)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.3.dev756+gc0a24c1dc.d20251221) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.3.dev756+gc0a24c1dc.d20251221) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.3.dev756+gc0a24c1dc.d20251221) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.3.dev756+gc0a24c1dc.d20251221) (2.0.1)
Requirement already satisfied: pytest-remotedata>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (0.4.0)
Requirement already satisfied: pytest-openfiles>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (0.5.0)
Requirement already satisfied: pytest-arraydiff>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (0.5.0)
Requirement already satisfied: pytest-filter-subpackage>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (0.1.2)
Requirement already satisfied: pytest-cov>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (4.1.0)
Requirement already satisfied: pytest-mock>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (3.11.1)
Requirement already satisfied: attrs>=19.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (23.1.0)
Requirement already satisfied: hypothesis>=5.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (6.82.6)
Requirement already satisfied: setuptools>=30.3.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-doctestplus>=0.12->astropy==5.3.dev756+gc0a24c1dc.d20251221) (68.0.0)
Requirement already satisfied: execnet>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-xdist->astropy==5.3.dev756+gc0a24c1dc.d20251221) (2.0.2)
Requirement already satisfied: sortedcontainers<3.0.0,>=2.1.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis>=5.1->pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (2.4.0)
Requirement already satisfied: coverage>=5.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from coverage[toml]>=5.2.1->pytest-cov>=2.3.1->pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (7.6.2)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-openfiles>=0.3.1->pytest-astropy>=0.10->astropy==5.3.dev756+gc0a24c1dc.d20251221) (5.9.5)
Building wheels for collected packages: astropy
  Running command Building editable for astropy (pyproject.toml)
  running editable_wheel
  creating /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info
  writing /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info'
  creating /tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/WHEEL
  running build_py
  running build_ext
  skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
  skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
  skipping 'astropy/convolution/_convolve.c' Cython extension (up-to-date)
  skipping 'astropy/timeseries/periodograms/bls/_impl.c' Cython extension (up-to-date)
  skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
  skipping './astropy/stats/_stats.c' Cython extension (up-to-date)
  skipping './astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
  skipping './astropy/cosmology/flrw/scalar_inv_efuncs.c' Cython extension (up-to-date)
  skipping './astropy/io/fits/_utils.c' Cython extension (up-to-date)
  building 'astropy.table._np_utils' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy
  creating /tmp/tmpwlp04iw8.build-temp/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_np_utils.c -o /tmp/tmpwlp04iw8.build-temp/astropy/table/_np_utils.o
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_np_utils.c:698:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmppyjz7tsr.build-lib/astropy
  creating /tmp/tmppyjz7tsr.build-lib/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/table/_np_utils.o -o /tmp/tmppyjz7tsr.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._column_mixins' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_column_mixins.c -o /tmp/tmpwlp04iw8.build-temp/astropy/table/_column_mixins.o
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:696:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:21,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:696:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/__multiarray_api.h:1463:1: warning: â€˜_import_arrayâ€™ defined but not used [-Wunused-function]
   1463 | _import_array(void)
        | ^~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/table/_column_mixins.o -o /tmp/tmppyjz7tsr.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils._compiler' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/utils
  creating /tmp/tmpwlp04iw8.build-temp/astropy/utils/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/src/compiler.c -o /tmp/tmpwlp04iw8.build-temp/astropy/utils/src/compiler.o
  creating /tmp/tmppyjz7tsr.build-lib/astropy/utils
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/utils/src/compiler.o -o /tmp/tmppyjz7tsr.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._fast_sigma_clip' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/stats
  creating /tmp/tmpwlp04iw8.build-temp/astropy/stats/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/compute_bounds.c -o /tmp/tmpwlp04iw8.build-temp/astropy/stats/src/compute_bounds.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/fast_sigma_clip.c -o /tmp/tmpwlp04iw8.build-temp/astropy/stats/src/fast_sigma_clip.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/wirth_select.c -o /tmp/tmpwlp04iw8.build-temp/astropy/stats/src/wirth_select.o
  creating /tmp/tmppyjz7tsr.build-lib/astropy/stats
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/stats/src/compute_bounds.o /tmp/tmpwlp04iw8.build-temp/astropy/stats/src/fast_sigma_clip.o /tmp/tmpwlp04iw8.build-temp/astropy/stats/src/wirth_select.o -o /tmp/tmppyjz7tsr.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so
  building 'astropy.convolution._convolve' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/convolution
  creating /tmp/tmpwlp04iw8.build-temp/astropy/convolution/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/_convolve.c -o /tmp/tmpwlp04iw8.build-temp/astropy/convolution/_convolve.o -UNDEBUG -fPIC
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/convolution/_convolve.c:698:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from astropy/convolution/_convolve.c:703:
  astropy/convolution/src/convolve.h:88:19: warning: inline function â€˜convolve3dâ€™ declared but never defined
     88 | FORCE_INLINE void convolve3d(DTYPE * const result,
        |                   ^~~~~~~~~~
  astropy/convolution/src/convolve.h:74:19: warning: inline function â€˜convolve2dâ€™ declared but never defined
     74 | FORCE_INLINE void convolve2d(DTYPE * const result,
        |                   ^~~~~~~~~~
  astropy/convolution/src/convolve.h:60:19: warning: inline function â€˜convolve1dâ€™ declared but never defined
     60 | FORCE_INLINE void convolve1d(DTYPE * const result,
        |                   ^~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/src/convolve.c -o /tmp/tmpwlp04iw8.build-temp/astropy/convolution/src/convolve.o -UNDEBUG -fPIC
  creating /tmp/tmppyjz7tsr.build-lib/astropy/convolution
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/convolution/_convolve.o /tmp/tmpwlp04iw8.build-temp/astropy/convolution/src/convolve.o -o /tmp/tmppyjz7tsr.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so
  building 'astropy.time._parse_times' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/time
  creating /tmp/tmpwlp04iw8.build-temp/astropy/time/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/time/src/parse_times.c -o /tmp/tmpwlp04iw8.build-temp/astropy/time/src/parse_times.o
  creating /tmp/tmppyjz7tsr.build-lib/astropy/time
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/time/src/parse_times.o -o /tmp/tmppyjz7tsr.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so
  building 'astropy.wcs._wcs' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/wcs
  creating /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src
  creating /tmp/tmpwlp04iw8.build-temp/cextern
  creating /tmp/tmpwlp04iw8.build-temp/cextern/wcslib
  creating /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C
  creating /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/astropy_wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs_api.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/astropy_wcs_api.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/distortion.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/distortion_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/docstrings.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/docstrings.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pipeline.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/pipeline.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pyutil.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/pyutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/src/pyutil.c:9:
  In function â€˜strncpyâ€™,
      inlined from â€˜set_pscardsâ€™ at astropy/wcs/src/pyutil.c:807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 72 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/sip.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/sip_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/str_list_proxy.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/str_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/unit_list_proxy.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/unit_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/util.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/util.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_auxprm_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_celprm_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:167:22: warning: initialization of â€˜PyCelprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    167 |     PyCelprm* copy = PyCelprm_new(&PyCelprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_set_refâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_celprm_wrap.c:348:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    348 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_prjprm_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:149:22: warning: initialization of â€˜PyPrjprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    149 |     PyPrjprm* copy = PyPrjprm_new(&PyPrjprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:517:14: warning: assignment to â€˜PyObject *â€™ {aka â€˜struct _object *â€™} from incompatible pointer type â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} [-Wincompatible-pointer-types]
    517 |     pv_array = (PyArrayObject*) PyArray_SimpleNew(1, &size, NPY_DOUBLE);
        |              ^
  astropy/wcs/src/wcslib_prjprm_wrap.c:519:33: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    519 |     pv = (double*) PyArray_DATA(pv_array);
        |                                 ^~~~~~~~
        |                                 |
        |                                 PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c:583:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    583 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:615:15: warning: unused variable â€˜valueâ€™ [-Wunused-variable]
    615 |     PyObject* value = NULL;
        |               ^~~~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:48: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                ^~~~~~~~~~~
        |                                                |
        |                                                PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:24: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                        ^~~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:62: warning: passing argument 1 of â€˜PyArray_DESCRâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                              ^~~~~~~~~~~
        |                                                              |
        |                                                              PyObject * {aka struct _object *}
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:44: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                                            ^~~
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1517:30: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1517 | PyArray_DESCR(PyArrayObject *arr)
        |               ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_wâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:780:32: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    780 |     w = (double*) PyArray_DATA(w_array);
        |                                ^~~~~~~
        |                                |
        |                                PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_tabprm_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜PyWcsprm_sptrâ€™ at astropy/wcs/src/wcslib_wrap.c:1756:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 9 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wtbarr_wrap.c -o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/cel.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/cel.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/dis.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/dis.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsbth.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcsbth.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcspih.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcspih.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsulex.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcsulex.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsutrn.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcsutrn.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/lin.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/lin.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/log.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/log.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/prj.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/prj.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spc.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/spc.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/sph.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/sph.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spx.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/spx.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/tab.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/tab.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcs.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcserr.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcserr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsfix.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsfix.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcshdr.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcshdr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsprintf.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsprintf.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsunits.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsunits.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsutil.c -o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  creating /tmp/tmppyjz7tsr.build-lib/astropy/wcs
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/astropy_wcs.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/astropy_wcs_api.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/distortion.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/distortion_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/docstrings.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/pipeline.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/pyutil.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/sip.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/sip_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/str_list_proxy.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/unit_list_proxy.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/util.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_wrap.o /tmp/tmpwlp04iw8.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/cel.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/dis.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcsbth.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcspih.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcsulex.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/flexed/wcsutrn.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/lin.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/log.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/prj.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/spc.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/sph.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/spx.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/tab.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcs.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcserr.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsfix.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcshdr.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsprintf.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsunits.o /tmp/tmpwlp04iw8.build-temp/cextern/wcslib/C/wcsutil.o -o /tmp/tmppyjz7tsr.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils.xml._iterparser' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/utils/xml
  creating /tmp/tmpwlp04iw8.build-temp/astropy/utils/xml/src
  creating /tmp/tmpwlp04iw8.build-temp/cextern/expat
  creating /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/xml/src/iterparse.c -o /tmp/tmpwlp04iw8.build-temp/astropy/utils/xml/src/iterparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlparse.c -o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmlparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlrole.c -o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmlrole.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok.c -o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmltok.o
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingNSâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1657:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1646:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok_impl.c -o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmltok_impl.o
  creating /tmp/tmppyjz7tsr.build-lib/astropy/utils/xml
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/utils/xml/src/iterparse.o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmlparse.o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmlrole.o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmltok.o /tmp/tmpwlp04iw8.build-temp/cextern/expat/lib/xmltok_impl.o -o /tmp/tmppyjz7tsr.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -Wl,--version-script=astropy/utils/xml/src/iterparse.map
  building 'astropy.timeseries.periodograms.bls._impl' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/timeseries
  creating /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms
  creating /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/_impl.c -o /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/bls/_impl.o
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/timeseries/periodograms/bls/_impl.c:698:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/bls.c -o /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/bls/bls.o
  astropy/timeseries/periodograms/bls/bls.c: In function â€˜run_blsâ€™:
  astropy/timeseries/periodograms/bls/bls.c:92: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
     92 | #pragma omp parallel
        |
  astropy/timeseries/periodograms/bls/bls.c:116: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    116 |     #pragma omp parallel for reduction(+:sum_y), reduction(+:sum_ivar)
        |
  astropy/timeseries/periodograms/bls/bls.c:125: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    125 |     #pragma omp parallel for
        |
  creating /tmp/tmppyjz7tsr.build-lib/astropy/timeseries
  creating /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms
  creating /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/bls/_impl.o /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/bls/bls.o -o /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.votable.tablewriter' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/votable
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/votable/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/votable/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/votable/src/tablewriter.c -o /tmp/tmpwlp04iw8.build-temp/astropy/io/votable/src/tablewriter.o
  astropy/io/votable/src/tablewriter.c: In function â€˜write_tabledataâ€™:
  astropy/io/votable/src/tablewriter.c:270:30: warning: assignment discards â€˜constâ€™ qualifier from pointer target type [-Wdiscarded-qualifiers]
    270 |                 if ((str_tmp = PyUnicode_AsUTF8AndSize(str_val, &str_len)) == NULL) {
        |                              ^
  creating /tmp/tmppyjz7tsr.build-lib/astropy/io
  creating /tmp/tmppyjz7tsr.build-lib/astropy/io/votable
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/io/votable/src/tablewriter.o -o /tmp/tmppyjz7tsr.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.ascii.cparser' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/ascii
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/ascii/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/cparser.c -o /tmp/tmpwlp04iw8.build-temp/astropy/io/ascii/cparser.o
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/io/ascii/cparser.c:698:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/src/tokenizer.c -o /tmp/tmpwlp04iw8.build-temp/astropy/io/ascii/src/tokenizer.o
  astropy/io/ascii/src/tokenizer.c: In function â€˜pushâ€™:
  astropy/io/ascii/src/tokenizer.c:124:54: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    124 |     if (self->col_ptrs[col] - self->output_cols[col] >=
        |                                                      ^~
  astropy/io/ascii/src/tokenizer.c: In function â€˜tokenizeâ€™:
  astropy/io/ascii/src/tokenizer.c:424:42: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    424 |                     if (self->source_pos == -1
        |                                          ^~
  creating /tmp/tmppyjz7tsr.build-lib/astropy/io/ascii
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/io/ascii/cparser.o /tmp/tmpwlp04iw8.build-temp/astropy/io/ascii/src/tokenizer.o -o /tmp/tmppyjz7tsr.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._tiled_compression._compression' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/fits
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/fits/_tiled_compression
  creating /tmp/tmpwlp04iw8.build-temp/astropy/io/fits/_tiled_compression/src
  creating /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio
  creating /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/_tiled_compression/src/compression.c -o /tmp/tmpwlp04iw8.build-temp/astropy/io/fits/_tiled_compression/src/compression.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/_tiled_compression/src/unquantize.c -o /tmp/tmpwlp04iw8.build-temp/astropy/io/fits/_tiled_compression/src/unquantize.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hcompress.c -o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/fits_hcompress.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hdecompress.c -o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/fits_hdecompress.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/pliocomp.c -o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/pliocomp.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/quantize.c -o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/quantize.o
  cextern/cfitsio/lib/quantize.c: In function â€˜quick_select_floatâ€™:
  cextern/cfitsio/lib/quantize.c:3722:5: warning: this â€˜ifâ€™ clause does not guard... [-Wmisleading-indentation]
   3722 |     if (hh <= median)
        |     ^~
  cextern/cfitsio/lib/quantize.c:3724:9: note: ...this statement, but the latter is misleadingly indented as if it were guarded by the â€˜ifâ€™
   3724 |         if (hh >= median)
        |         ^~
  cextern/cfitsio/lib/quantize.c: In function â€˜quick_select_shortâ€™:
  cextern/cfitsio/lib/quantize.c:3778:5: warning: this â€˜ifâ€™ clause does not guard... [-Wmisleading-indentation]
   3778 |     if (hh <= median)
        |     ^~
  cextern/cfitsio/lib/quantize.c:3780:9: note: ...this statement, but the latter is misleadingly indented as if it were guarded by the â€˜ifâ€™
   3780 |         if (hh >= median)
        |         ^~
  cextern/cfitsio/lib/quantize.c: In function â€˜quick_select_intâ€™:
  cextern/cfitsio/lib/quantize.c:3834:5: warning: this â€˜ifâ€™ clause does not guard... [-Wmisleading-indentation]
   3834 |     if (hh <= median)
        |     ^~
  cextern/cfitsio/lib/quantize.c:3836:9: note: ...this statement, but the latter is misleadingly indented as if it were guarded by the â€˜ifâ€™
   3836 |         if (hh >= median)
        |         ^~
  cextern/cfitsio/lib/quantize.c: In function â€˜quick_select_longlongâ€™:
  cextern/cfitsio/lib/quantize.c:3890:5: warning: this â€˜ifâ€™ clause does not guard... [-Wmisleading-indentation]
   3890 |     if (hh <= median)
        |     ^~
  cextern/cfitsio/lib/quantize.c:3892:9: note: ...this statement, but the latter is misleadingly indented as if it were guarded by the â€˜ifâ€™
   3892 |         if (hh >= median)
        |         ^~
  cextern/cfitsio/lib/quantize.c: In function â€˜quick_select_doubleâ€™:
  cextern/cfitsio/lib/quantize.c:3946:5: warning: this â€˜ifâ€™ clause does not guard... [-Wmisleading-indentation]
   3946 |     if (hh <= median)
        |     ^~
  cextern/cfitsio/lib/quantize.c:3948:9: note: ...this statement, but the latter is misleadingly indented as if it were guarded by the â€˜ifâ€™
   3948 |         if (hh >= median)
        |         ^~
  At top level:
  cextern/cfitsio/lib/quantize.c:3641:12: warning: â€˜FnCompare_floatâ€™ defined but not used [-Wunused-function]
   3641 | static int FnCompare_float(const void *v1, const void *v2)
        |            ^~~~~~~~~~~~~~~
  cextern/cfitsio/lib/quantize.c:3628:12: warning: â€˜FnCompare_intâ€™ defined but not used [-Wunused-function]
   3628 | static int FnCompare_int(const void *v1, const void *v2)
        |            ^~~~~~~~~~~~~
  cextern/cfitsio/lib/quantize.c:3615:12: warning: â€˜FnCompare_shortâ€™ defined but not used [-Wunused-function]
   3615 | static int FnCompare_short(const void *v1, const void *v2)
        |            ^~~~~~~~~~~~~~~
  cextern/cfitsio/lib/quantize.c:3494:12: warning: â€˜FnNoise1_doubleâ€™ defined but not used [-Wunused-function]
   3494 | static int FnNoise1_double
        |            ^~~~~~~~~~~~~~~
  cextern/cfitsio/lib/quantize.c:2487:12: warning: â€˜FnNoise3_intâ€™ defined but not used [-Wunused-function]
   2487 | static int FnNoise3_int
        |            ^~~~~~~~~~~~
  cextern/cfitsio/lib/quantize.c:2269:12: warning: â€˜FnNoise3_shortâ€™ defined but not used [-Wunused-function]
   2269 | static int FnNoise3_short
        |            ^~~~~~~~~~~~~~
  cextern/cfitsio/lib/quantize.c: In function â€˜fits_img_stats_shortâ€™:
  cextern/cfitsio/lib/quantize.c:510:41: warning: â€˜ngoodâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
    510 |                 if (ngoodpix) *ngoodpix = ngood;
        |                               ~~~~~~~~~~^~~~~~~
  cextern/cfitsio/lib/quantize.c: In function â€˜fits_img_stats_intâ€™:
  cextern/cfitsio/lib/quantize.c:569:41: warning: â€˜ngoodâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
    569 |                 if (ngoodpix) *ngoodpix = ngood;
        |                               ~~~~~~~~~~^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/fits/_tiled_compression/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/ricecomp.c -o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/ricecomp.o
  cextern/cfitsio/lib/ricecomp.c: In function â€˜fits_rcompâ€™:
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:267:21: note: in expansion of macro â€˜putcbufâ€™
    267 |                     putcbuf(lbitbuffer & 0xff,buffer);
        |                     ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:270:25: note: in expansion of macro â€˜putcbufâ€™
    270 |                         putcbuf(0, buffer);
        |                         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:286:25: note: in expansion of macro â€˜putcbufâ€™
    286 |                         putcbuf((lbitbuffer>>(-lbits_to_go)) & 0xff,buffer);
        |                         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c: In function â€˜fits_rcomp_shortâ€™:
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:498:21: note: in expansion of macro â€˜putcbufâ€™
    498 |                     putcbuf(lbitbuffer & 0xff,buffer);
        |                     ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:500:25: note: in expansion of macro â€˜putcbufâ€™
    500 |                         putcbuf(0, buffer);
        |                         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:516:25: note: in expansion of macro â€˜putcbufâ€™
    516 |                         putcbuf((lbitbuffer>>(-lbits_to_go)) & 0xff,buffer);
        |                         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c: In function â€˜fits_rcomp_byteâ€™:
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:723:21: note: in expansion of macro â€˜putcbufâ€™
    723 |                     putcbuf(lbitbuffer & 0xff,buffer);
        |                     ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:725:25: note: in expansion of macro â€˜putcbufâ€™
    725 |                         putcbuf(0, buffer);
        |                         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:741:25: note: in expansion of macro â€˜putcbufâ€™
    741 |                         putcbuf((lbitbuffer>>(-lbits_to_go)) & 0xff,buffer);
        |                         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c: In function â€˜output_nbitsâ€™:
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:812:9: note: in expansion of macro â€˜putcbufâ€™
    812 |         putcbuf(lbitbuffer & 0xff,buffer);
        |         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:824:9: note: in expansion of macro â€˜putcbufâ€™
    824 |         putcbuf((lbitbuffer>>(-lbits_to_go)) & 0xff,buffer);
        |         ^~~~~~~
  cextern/cfitsio/lib/ricecomp.c: In function â€˜done_outputing_bitsâ€™:
  cextern/cfitsio/lib/ricecomp.c:70:48: warning: right-hand operand of comma expression has no effect [-Wunused-value]
     70 | #define putcbuf(c,mf)   ((*(mf->current)++ = c), 0)
        |                         ~~~~~~~~~~~~~~~~~~~~~~~^~~~
  cextern/cfitsio/lib/ricecomp.c:837:9: note: in expansion of macro â€˜putcbufâ€™
    837 |         putcbuf(buffer->bitbuffer<<buffer->bits_to_go,buffer);
        |         ^~~~~~~
  creating /tmp/tmppyjz7tsr.build-lib/astropy/io/fits
  creating /tmp/tmppyjz7tsr.build-lib/astropy/io/fits/_tiled_compression
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/io/fits/_tiled_compression/src/compression.o /tmp/tmpwlp04iw8.build-temp/astropy/io/fits/_tiled_compression/src/unquantize.o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/fits_hcompress.o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/fits_hdecompress.o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/pliocomp.o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/quantize.o /tmp/tmpwlp04iw8.build-temp/cextern/cfitsio/lib/ricecomp.o -o /tmp/tmppyjz7tsr.build-lib/astropy/io/fits/_tiled_compression/_compression.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._stats' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/stats/_stats.c -o /tmp/tmpwlp04iw8.build-temp/./astropy/stats/_stats.o
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/stats/_stats.c:698:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/./astropy/stats/_stats.o -o /tmp/tmppyjz7tsr.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.lombscargle.implementations.cython_impl' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpwlp04iw8.build-temp/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c -o /tmp/tmpwlp04iw8.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o
  In file included from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c:698:
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o -o /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.cosmology.flrw.scalar_inv_efuncs' extension
  creating /tmp/tmpwlp04iw8.build-temp/astropy/cosmology
  creating /tmp/tmpwlp04iw8.build-temp/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/cosmology/flrw/scalar_inv_efuncs.c -o /tmp/tmpwlp04iw8.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o
  creating /tmp/tmppyjz7tsr.build-lib/astropy/cosmology
  creating /tmp/tmppyjz7tsr.build-lib/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o -o /tmp/tmppyjz7tsr.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._utils' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/io/fits/_utils.c -o /tmp/tmpwlp04iw8.build-temp/./astropy/io/fits/_utils.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/./astropy/io/fits/_utils.o -o /tmp/tmppyjz7tsr.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.compiler_version' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/_compiler.c -o /tmp/tmpwlp04iw8.build-temp/astropy/_compiler.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpwlp04iw8.build-temp/astropy/_compiler.o -o /tmp/tmppyjz7tsr.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so
  copying /tmp/tmppyjz7tsr.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmppyjz7tsr.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmppyjz7tsr.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so -> astropy/utils
  copying /tmp/tmppyjz7tsr.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmppyjz7tsr.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so -> astropy/convolution
  copying /tmp/tmppyjz7tsr.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so -> astropy/time
  copying /tmp/tmppyjz7tsr.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so -> astropy/wcs
  copying /tmp/tmppyjz7tsr.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -> astropy/utils/xml
  copying /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/bls
  copying /tmp/tmppyjz7tsr.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so -> astropy/io/votable
  copying /tmp/tmppyjz7tsr.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so -> astropy/io/ascii
  copying /tmp/tmppyjz7tsr.build-lib/astropy/io/fits/_tiled_compression/_compression.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits/_tiled_compression
  copying /tmp/tmppyjz7tsr.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmppyjz7tsr.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/lombscargle/implementations
  copying /tmp/tmppyjz7tsr.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so -> astropy/cosmology/flrw
  copying /tmp/tmppyjz7tsr.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmppyjz7tsr.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so -> astropy
  Editable install will be performed using a meta path finder.

  Options like `package-data`, `include/exclude-package-data` or
  `packages.find.exclude/include` may have no effect.

  adding '__editable___astropy_5_3_dev756_gc0a24c1dc_d20251221_finder.py'
  adding '__editable__.astropy-5.3.dev756+gc0a24c1dc.d20251221.pth'
  creating '/tmp/pip-wheel-x321y3bw/.tmp-y6dt3ze8/astropy-5.3.dev756+gc0a24c1dc.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' and adding '/tmp/tmprpmwahwgastropy-5.3.dev756+gc0a24c1dc.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' to it
  adding 'astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/LICENSE.rst'
  adding 'astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/METADATA'
  adding 'astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/WHEEL'
  adding 'astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/entry_points.txt'
  adding 'astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/top_level.txt'
  adding 'astropy-5.3.dev756+gc0a24c1dc.d20251221.dist-info/RECORD'
  /tmp/pip-build-env-a6se2r0w/overlay/lib/python3.9/site-packages/setuptools/command/editable_wheel.py:348: InformationOnly: Editable installation.
  !!

          ********************************************************************************
          Please be careful with folders in your working directory with the same
          name as your package as they may take precedence during imports.
          ********************************************************************************

  !!
    wheel_obj.write_files(unpacked)
  Building editable for astropy (pyproject.toml) ... [?25l[?25hdone
  Created wheel for astropy: filename=astropy-5.3.dev756+gc0a24c1dc.d20251221-0.editable-cp39-cp39-linux_x86_64.whl size=7327 sha256=d7d16d4c27fa9b5b055d327c4e2980ac962dd8d76148f0f9bfc605d5625e03f6
  Stored in directory: /tmp/pip-ephem-wheel-cache-6nu98cj2/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built astropy
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 5.3.dev756+gc0a24c1dc9.d20241024
    Uninstalling astropy-5.3.dev756+gc0a24c1dc9.d20241024:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Successfully uninstalled astropy-5.3.dev756+gc0a24c1dc9.d20241024
  changing mode of /opt/miniconda3/envs/testbed/bin/fits2bitmap to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitscheck to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsdiff to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsheader to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsinfo to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/samp_hub to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/showtable to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/volint to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/wcslint to 755
Successfully installed astropy-5.3.dev756+gc0a24c1dc.d20251221
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-12-21 17:04:49,159 - thread-130546535499456.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Retrieving focal code context via external CRA
2025-12-21 17:07:33,011 - thread-130546535499456.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Focal code context retrieved: 3 items
2025-12-21 17:07:33,012 - thread-130546535499456.app.lang_graph.nodes.test_case_retrieval_node - INFO - Retrieving test case context via external CRA
2025-12-21 17:09:39,777 - thread-130546535499456.app.lang_graph.nodes.test_case_retrieval_node - INFO - Test case context retrieved: 1 items
2025-12-21 17:09:39,781 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\n`io.fits.FITSDiff` may sometimes report differences between identical files\n\nIssue description: \n### Description\n\nIn some scenarios, `io.fits.FITSDiff` may report differences between identical files, even when comparing the same file to itself. This may be caused by improper handling of VLAs (variable-length arrays).\n\n### Expected behavior\n\n`io.fits.FITSDiff` only reports differences in files if they exist. Comparing a file to itself should never yield a difference.\n\n### How to Reproduce\n\n```python\nfrom astropy.io import fits\ncol = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\nhdu = fits.BinTableHDU.from_columns([col])\nhdu.writeto(\'diffbug.fits\', overwrite=True)\n\nprint(fits.FITSDiff(\'diffbug.fits\', \'diffbug.fits\').identical)\nfits.printdiff(\'diffbug.fits\', \'diffbug.fits\')\n\n```\nPrints out:\n```\nFalse\n fitsdiff: 5.2.1\n a: diffbug.fits\n b: diffbug.fits\n Maximum number of different data values to be reported: 10\n Relative tolerance: 0.0, Absolute tolerance: 0.0\nExtension HDU 1:\n   Data contains differences:\n     Column a data differs in row 0:\n     1 different table data element(s) found (50.00% different).\n```\n\nI suspect the handling of VLAs is the culprit here as I couldn\'t reproduce the bug without using at least one VLA column.\n\n### Versions\n\nWindows-10-10.0.19044-SP0\nPython 3.10.10 (tags/v3.10.10:aad5f6a, Feb  7 2023, 17:20:36) [MSC v.1929 64 bit (AMD64)]\nastropy 5.2.1\nNumpy 1.24.2\npyerfa 2.0.0.1\nScipy 1.10.0\nMatplotlib 3.6.3\n\nIssue comments:\n\n\nPatch Information:\n```diff\ndiff --git a/astropy/io/fits/diff.py b/astropy/io/fits/diff.py\nindex 100cdf1b8c..d3608ef01d 100644\n--- a/astropy/io/fits/diff.py\n+++ b/astropy/io/fits/diff.py\n@@ -1449,7 +1449,7 @@ class TableDataDiff(_BaseDiff):\n                 arrb.dtype, np.floating\n             ):\n                 diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)\n-            elif "P" in col.format:\n+            elif "P" in col.format or "Q" in col.format:\n                 diffs = (\n                     [\n                         idx\n\n```\n\nFocal Code Context (relevant code that may need fixing):\n{\'relative_path\': \'astropy/io/fits/column.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see PYFITS.rst\\n2. \\n3. import copy\\n4. import numbers\\n5. import operator\\n6. import re\\n7. import sys\\n8. import warnings\\n9. import weakref\\n10. from collections import OrderedDict\\n11. from contextlib import suppress\\n12. from functools import reduce\\n13. \\n14. import numpy as np\\n15. from numpy import char as chararray\\n16. \\n17. from astropy.utils import indent, isiterable, lazyproperty\\n18. from astropy.utils.exceptions import AstropyUserWarning\\n19. \\n20. from .card import CARD_LENGTH, Card\\n21. from .util import NotifierMixin, _convert_array, _is_int, cmp, encode_ascii, pairwise\\n22. from .verify import VerifyError, VerifyWarning\\n23. \\n24. __all__ = ["Column", "ColDefs", "Delayed"]\\n25. \\n26. \\n27. # mapping from TFORM data type to numpy data type (code)\\n28. # L: Logical (Boolean)\\n29. # B: Unsigned Byte\\n30. # I: 16-bit Integer\\n31. # J: 32-bit Integer\\n32. # K: 64-bit Integer\\n33. # E: Single-precision Floating Point\\n34. # D: Double-precision Floating Point\\n35. # C: Single-precision Complex\\n36. # M: Double-precision Complex\\n37. # A: Character\\n38. FITS2NUMPY = {\\n39.     "L": "i1",\\n40.     "B": "u1",\\n41.     "I": "i2",\\n42.     "J": "i4",\\n43.     "K": "i8",\\n44.     "E": "f4",\\n45.     "D": "f8",\\n46.     "C": "c8",\\n47.     "M": "c16",\\n48.     "A": "a",\\n49. }\\n50. \\n51. # the inverse dictionary of the above\\n52. NUMPY2FITS = {val: key for key, val in FITS2NUMPY.items()}\\n53. # Normally booleans are represented as ints in Astropy, but if passed in a numpy\\n54. # boolean array, that should be supported\\n55. NUMPY2FITS["b1"] = "L"\\n56. # Add unsigned types, which will be stored as signed ints with a TZERO card.\\n57. NUMPY2FITS["u2"] = "I"\\n58. NUMPY2FITS["u4"] = "J"\\n59. NUMPY2FITS["u8"] = "K"\\n60. # Add half precision floating point numbers which will be up-converted to\\n61. # single precision.\\n62. NUMPY2FITS["f2"] = "E"\\n63. \\n64. # This is the order in which values are converted to FITS types\\n65. # Note that only double precision floating point/complex are supported\\n66. FORMATORDER = ["L", "B", "I", "J", "K", "D", "M", "A"]\\n67. \\n68. # Convert single precision floating point/complex to double precision.\\n69. FITSUPCONVERTERS = {"E": "D", "C": "M"}\\n70. \\n71. # mapping from ASCII table TFORM data type to numpy data type\\n72. # A: Character\\n73. # I: Integer (32-bit)\\n74. # J: Integer (64-bit; non-standard)\\n75. # F: Float (64-bit; fixed decimal notation)\\n76. # E: Float (64-bit; exponential notation)\\n77. # D: Float (64-bit; exponential notation, always 64-bit by convention)\\n78. ASCII2NUMPY = {"A": "a", "I": "i4", "J": "i8", "F": "f8", "E": "f8", "D": "f8"}\\n79. \\n80. # Maps FITS ASCII column format codes to the appropriate Python string\\n81. # formatting codes for that type.\\n82. ASCII2STR = {"A": "", "I": "d", "J": "d", "F": "f", "E": "E", "D": "E"}\\n83. \\n84. # For each ASCII table format code, provides a default width (and decimal\\n85. # precision) for when one isn\\\'t given explicitly in the column format\\n86. ASCII_DEFAULT_WIDTHS = {\\n87.     "A": (1, 0),\\n88.     "I": (10, 0),\\n89.     "J": (15, 0),\\n90.     "E": (15, 7),\\n91.     "F": (16, 7),\\n92.     "D": (25, 17),\\n93. }\\n94. \\n95. # TDISPn for both ASCII and Binary tables\\n96. TDISP_RE_DICT = {}\\n97. TDISP_RE_DICT["F"] = re.compile(\\n98.     r"(?:(?P<formatc>[F])(?:(?P<width>[0-9]+)\\\\.{1}(?P<precision>[0-9])+)+)|"\\n99. )\\n100. TDISP_RE_DICT["A"] = TDISP_RE_DICT["L"] = re.compile(\\n101.     r"(?:(?P<formatc>[AL])(?P<width>[0-9]+)+)|"\\n102. )\\n103. TDISP_RE_DICT["I"] = TDISP_RE_DICT["B"] = TDISP_RE_DICT["O"] = TDISP_RE_DICT[\\n104.     "Z"\\n105. ] = re.compile(\\n106.     r"(?:(?P<formatc>[IBOZ])(?:(?P<width>[0-9]+)"\\n107.     r"(?:\\\\.{0,1}(?P<precision>[0-9]+))?))|"\\n108. )\\n109. TDISP_RE_DICT["E"] = TDISP_RE_DICT["G"] = TDISP_RE_DICT["D"] = re.compile(\\n110.     r"(?:(?P<formatc>[EGD])(?:(?P<width>[0-9]+)\\\\."\\n111.     r"(?P<precision>[0-9]+))+)"\\n112.     r"(?:E{0,1}(?P<exponential>[0-9]+)?)|"\\n113. )\\n114. TDISP_RE_DICT["EN"] = TDISP_RE_DICT["ES"] = re.compile(\\n115.     r"(?:(?P<formatc>E[NS])(?:(?P<width>[0-9]+)\\\\.{1}(?P<precision>[0-9])+)+)"\\n116. )\\n117. \\n118. # mapping from TDISP format to python format\\n119. # A: Character\\n120. # L: Logical (Boolean)\\n121. # I: 16-bit Integer\\n122. #    Can\\\'t predefine zero padding and space padding before hand without\\n123. #    knowing the value being formatted, so grabbing precision and using that\\n124. #    to zero pad, ignoring width. Same with B, O, and Z\\n125. # B: Binary Integer\\n126. # O: Octal Integer\\n127. # Z: Hexadecimal Integer\\n128. # F: Float (64-bit; fixed decimal notation)\\n129. # EN: Float (engineering fortran format, exponential multiple of thee\\n130. # ES: Float (scientific, same as EN but non-zero leading digit\\n131. # E: Float, exponential notation\\n132. #    Can\\\'t get exponential restriction to work without knowing value\\n133. #    before hand, so just using width and precision, same with D, G, EN, and\\n134. #    ES formats\\n135. # D: Double-precision Floating Point with exponential\\n136. #    (E but for double precision)\\n137. # G: Double-precision Floating Point, may or may not show exponent\\n138. TDISP_FMT_DICT = {\\n139.     "I": "{{:{width}d}}",\\n140.     "B": "{{:{width}b}}",\\n141.     "O": "{{:{width}o}}",\\n142.     "Z": "{{:{width}x}}",\\n143.     "F": "{{:{width}.{precision}f}}",\\n144.     "G": "{{:{width}.{precision}g}}",\\n145. }\\n146. TDISP_FMT_DICT["A"] = TDISP_FMT_DICT["L"] = "{{:>{width}}}"\\n147. TDISP_FMT_DICT["E"] = TDISP_FMT_DICT["D"] = TDISP_FMT_DICT["EN"] = TDISP_FMT_DICT[\\n148.     "ES"\\n149. ] = "{{:{width}.{precision}e}}"\\n150. \\n151. # tuple of column/field definition common names and keyword names, make\\n152. # sure to preserve the one-to-one correspondence when updating the list(s).\\n153. # Use lists, instead of dictionaries so the names can be displayed in a\\n154. # preferred order.\\n155. KEYWORD_NAMES = (\\n156.     "TTYPE",\\n157.     "TFORM",\\n158.     "TUNIT",\\n159.     "TNULL",\\n160.     "TSCAL",\\n161.     "TZERO",\\n162.     "TDISP",\\n163.     "TBCOL",\\n164.     "TDIM",\\n165.     "TCTYP",\\n166.     "TCUNI",\\n167.     "TCRPX",\\n168.     "TCRVL",\\n169.     "TCDLT",\\n170.     "TRPOS",\\n171. )\\n172. KEYWORD_ATTRIBUTES = (\\n173.     "name",\\n174.     "format",\\n175.     "unit",\\n176.     "null",\\n177.     "bscale",\\n178.     "bzero",\\n179.     "disp",\\n180.     "start",\\n181.     "dim",\\n182.     "coord_type",\\n183.     "coord_unit",\\n184.     "coord_ref_point",\\n185.     "coord_ref_value",\\n186.     "coord_inc",\\n187.     "time_ref_pos",\\n188. )\\n189. """This is a list of the attributes that can be set on `Column` objects."""\\n190. \\n191. \\n192. KEYWORD_TO_ATTRIBUTE = OrderedDict(zip(KEYWORD_NAMES, KEYWORD_ATTRIBUTES))\\n193. \\n194. ATTRIBUTE_TO_KEYWORD = OrderedDict(zip(KEYWORD_ATTRIBUTES, KEYWORD_NAMES))\\n195. \\n196. \\n197. # TODO: Define a list of default comments to associate with each table keyword\\n198. \\n199. # TFORMn regular expression\\n200. TFORMAT_RE = re.compile(\\n201.     r"(?P<repeat>^[0-9]*)(?P<format>[LXBIJKAEDCMPQ])(?P<option>[!-~]*)", re.I\\n202. )\\n203. \\n204. # TFORMn for ASCII tables; two different versions depending on whether\\n205. # the format is floating-point or not; allows empty values for width\\n206. # in which case defaults are used\\n207. TFORMAT_ASCII_RE = re.compile(\\n208.     r"(?:(?P<format>[AIJ])(?P<width>[0-9]+)?)|"\\n209.     r"(?:(?P<formatf>[FED])"\\n210.     r"(?:(?P<widthf>[0-9]+)(?:\\\\."\\n211.     r"(?P<precision>[0-9]+))?)?)"\\n212. )\\n213. \\n214. TTYPE_RE = re.compile(r"[0-9a-zA-Z_]+")\\n215. """\\n216. Regular expression for valid table column names.  See FITS Standard v3.0 section 7.2.2.\\n217. """\\n218. \\n219. # table definition keyword regular expression\\n220. TDEF_RE = re.compile(r"(?P<label>^T[A-Z]*)(?P<num>[1-9][0-9 ]*$)")\\n221. \\n222. # table dimension keyword regular expression (fairly flexible with whitespace)\\n223. TDIM_RE = re.compile(r"\\\\(\\\\s*(?P<dims>(?:\\\\d+\\\\s*)(?:,\\\\s*\\\\d+\\\\s*)*\\\\s*)\\\\)\\\\s*")\\n224. \\n225. # value for ASCII table cell with value = TNULL\\n226. # this can be reset by user.\\n227. ASCIITNULL = 0\\n228. \\n229. # The default placeholder to use for NULL values in ASCII tables when\\n230. # converting from binary to ASCII tables\\n231. DEFAULT_ASCII_TNULL = "---"\\n232. \\n233. \\n234. class Delayed:\\n235.     """Delayed file-reading data."""\\n236. \\n237.     def __init__(self, hdu=None, field=None):\\n238.         self.hdu = weakref.proxy(hdu)\\n239.         self.field = field\\n240. \\n241.     def __getitem__(self, key):\\n242.         # This forces the data for the HDU to be read, which will replace\\n243.         # the corresponding Delayed objects in the Tables Columns to be\\n244.         # transformed into ndarrays.  It will also return the value of the\\n245.         # requested data element.\\n246.         return self.hdu.data[key][self.field]\\n247. \\n248. \\n249. class _BaseColumnFormat(str):\\n250.     """\\n251.     Base class for binary table column formats (just called _ColumnFormat)\\n252.     and ASCII table column formats (_AsciiColumnFormat).\\n253.     """\\n254. \\n255.     def __eq__(self, other):\\n256.         if not other:\\n257.             return False\\n258. \\n259.         if isinstance(other, str):\\n260.             if not isinstance(other, self.__class__):\\n261.                 try:\\n262.                     other = self.__class__(other)\\n263.                 except ValueError:\\n264.                     return False\\n265.         else:\\n266.             return False\\n267. \\n268.         return self.canonical == other.canonical\\n269. \\n270.     def __hash__(self):\\n271.         return hash(self.canonical)\\n272. \\n273.     @lazyproperty\\n274.     def dtype(self):\\n275.         """\\n276.         The Numpy dtype object created from the format\\\'s associated recformat.\\n277.         """\\n278.         return np.dtype(self.recformat)\\n279. \\n280.     @classmethod\\n281.     def from_column_format(cls, format):\\n282.         """Creates a column format object from another column format object\\n283.         regardless of their type.\\n284. \\n285.         That is, this can convert a _ColumnFormat to an _AsciiColumnFormat\\n286.         or vice versa at least in cases where a direct translation is possible.\\n287.         """\\n288.         return cls.from_recformat(format.recformat)\\n289. \\n290. \\n291. class _ColumnFormat(_BaseColumnFormat):\\n292.     """\\n293.     Represents a FITS binary table column format.\\n294. \\n295.     This is an enhancement over using a normal string for the format, since the\\n296.     repeat count, format code, and option are available as separate attributes,\\n297.     and smart comparison is used.  For example 1J == J.\\n298.     """\\n299. \\n300.     def __new__(cls, format):\\n301.         self = super().__new__(cls, format)\\n302.         self.repeat, self.format, self.option = _parse_tformat(format)\\n303.         self.format = self.format.upper()\\n304.         if self.format in ("P", "Q"):\\n305.             # TODO: There should be a generic factory that returns either\\n306.             # _FormatP or _FormatQ as appropriate for a given TFORMn\\n307.             if self.format == "P":\\n308.                 recformat = _FormatP.from_tform(format)\\n309.             else:\\n310.                 recformat = _FormatQ.from_tform(format)\\n311.             # Format of variable length arrays\\n312.             self.p_format = recformat.format\\n313.         else:\\n314.             self.p_format = None\\n315.         return self\\n316. \\n317.     @classmethod\\n318.     def from_recformat(cls, recformat):\\n319.         """Creates a column format from a Numpy record dtype format."""\\n320.         return cls(_convert_format(recformat, reverse=True))\\n321. \\n322.     @lazyproperty\\n323.     def recformat(self):\\n324.         """Returns the equivalent Numpy record format string."""\\n325.         return _convert_format(self)\\n326. \\n327.     @lazyproperty\\n328.     def canonical(self):\\n329.         """\\n330.         Returns a \\\'canonical\\\' string representation of this format.\\n331. \\n332.         This is in the proper form of rTa where T is the single character data\\n333.         type code, a is the optional part, and r is the repeat.  If repeat == 1\\n334.         (the default) it is left out of this representation.\\n335.         """\\n336.         if self.repeat == 1:\\n337.             repeat = ""\\n338.         else:\\n339.             repeat = str(self.repeat)\\n340. \\n341.         return f"{repeat}{self.format}{self.option}"\\n342. \\n343. \\n344. class _AsciiColumnFormat(_BaseColumnFormat):\\n345.     """Similar to _ColumnFormat but specifically for columns in ASCII tables.\\n346. \\n347.     The formats of ASCII table columns and binary table columns are inherently\\n348.     incompatible in FITS.  They don\\\'t support the same ranges and types of\\n349.     values, and even reuse format codes in subtly different ways.  For example\\n350.     the format code \\\'Iw\\\' in ASCII columns refers to any integer whose string\\n351.     representation is at most w characters wide, so \\\'I\\\' can represent\\n352.     effectively any integer that will fit in a FITS columns.  Whereas for\\n353.     binary tables \\\'I\\\' very explicitly refers to a 16-bit signed integer.\\n354. \\n355.     Conversions between the two column formats can be performed using the\\n356.     ``to/from_binary`` methods on this class, or the ``to/from_ascii``\\n357.     methods on the `_ColumnFormat` class.  But again, not all conversions are\\n358.     possible and may result in a `ValueError`.\\n359.     """\\n360. \\n361.     def __new__(cls, format, strict=False):\\n362.         self = super().__new__(cls, format)\\n363.         self.format, self.width, self.precision = _parse_ascii_tformat(format, strict)\\n364. \\n365.         # If no width has been specified, set the dtype here to default as well\\n366.         if format == self.format:\\n367.             self.recformat = ASCII2NUMPY[format]\\n368. \\n369.         # This is to support handling logical (boolean) data from binary tables\\n370.         # in an ASCII table\\n371.         self._pseudo_logical = False\\n372.         return self\\n373. \\n374.     @classmethod\\n375.     def from_column_format(cls, format):\\n376.         inst = cls.from_recformat(format.recformat)\\n377.         # Hack\\n378.         if format.format == "L":\\n379.             inst._pseudo_logical = True\\n380.         return inst\\n381. \\n382.     @classmethod\\n383.     def from_recformat(cls, recformat):\\n384.         """Creates a column format from a Numpy record dtype format."""\\n385.         return cls(_convert_ascii_format(recformat, reverse=True))\\n386. \\n387.     @lazyproperty\\n388.     def recformat(self):\\n389.         """Returns the equivalent Numpy record format string."""\\n390.         return _convert_ascii_format(self)\\n391. \\n392.     @lazyproperty\\n393.     def canonical(self):\\n394.         """\\n395.         Returns a \\\'canonical\\\' string representation of this format.\\n396. \\n397.         This is in the proper form of Tw.d where T is the single character data\\n398.         type code, w is the width in characters for this field, and d is the\\n399.         number of digits after the decimal place (for format codes \\\'E\\\', \\\'F\\\',\\n400.         and \\\'D\\\' only).\\n401.         """\\n402.         if self.format in ("E", "F", "D"):\\n403.             return f"{self.format}{self.width}.{self.precision}"\\n404. \\n405.         return f"{self.format}{self.width}"\\n406. \\n407. \\n408. class _FormatX(str):\\n409.     """For X format in binary tables."""\\n410. \\n411.     def __new__(cls, repeat=1):\\n412.         nbytes = ((repeat - 1) // 8) + 1\\n413.         # use an array, even if it is only ONE u1 (i.e. use tuple always)\\n414.         obj = super().__new__(cls, repr((nbytes,)) + "u1")\\n415.         obj.repeat = repeat\\n416.         return obj\\n417. \\n418.     def __getnewargs__(self):\\n419.         return (self.repeat,)\\n420. \\n421.     @property\\n422.     def tform(self):\\n423.         return f"{self.repeat}X"\\n424. \\n425. \\n426. # TODO: Table column formats need to be verified upon first reading the file;\\n427. # as it is, an invalid P format will raise a VerifyError from some deep,\\n428. # unexpected place\\n429. class _FormatP(str):\\n430.     """For P format in variable length table."""\\n431. \\n432.     # As far as I can tell from my reading of the FITS standard, a type code is\\n433.     # *required* for P and Q formats; there is no default\\n434.     _format_re_template = (\\n435.         r"(?P<repeat>\\\\d+)?{}(?P<dtype>[LXBIJKAEDCM])(?:\\\\((?P<max>\\\\d*)\\\\))?"\\n436.     )\\n437.     _format_code = "P"\\n438.     _format_re = re.compile(_format_re_template.format(_format_code))\\n439.     _descriptor_format = "2i4"\\n440. \\n441.     def __new__(cls, dtype, repeat=None, max=None):\\n442.         obj = super().__new__(cls, cls._descriptor_format)\\n443.         obj.format = NUMPY2FITS[dtype]\\n444.         obj.dtype = dtype\\n445.         obj.repeat = repeat\\n446.         obj.max = max\\n447.         return obj\\n448. \\n449.     def __getnewargs__(self):\\n450.         return (self.dtype, self.repeat, self.max)\\n451. \\n452.     @classmethod\\n453.     def from_tform(cls, format):\\n454.         m = cls._format_re.match(format)\\n455.         if not m or m.group("dtype") not in FITS2NUMPY:\\n456.             raise VerifyError(f"Invalid column format: {format}")\\n457.         repeat = m.group("repeat")\\n458.         array_dtype = m.group("dtype")\\n459.         max = m.group("max")\\n460.         if not max:\\n461.             max = None\\n462.         return cls(FITS2NUMPY[array_dtype], repeat=repeat, max=max)\\n463. \\n464.     @property\\n465.     def tform(self):\\n466.         repeat = "" if self.repeat is None else self.repeat\\n467.         max = "" if self.max is None else self.max\\n468.         return f"{repeat}{self._format_code}{self.format}({max})"\\n469. \\n470. \\n471. class _FormatQ(_FormatP):\\n472.     """Carries type description of the Q format for variable length arrays.\\n473. \\n474.     The Q format is like the P format but uses 64-bit integers in the array\\n475.     descriptors, allowing for heaps stored beyond 2GB into a file.\\n476.     """\\n477. \\n478.     _format_code = "Q"\\n479.     _format_re = re.compile(_FormatP._format_re_template.format(_format_code))\\n480.     _descriptor_format = "2i8"\\n481. \\n482. \\n483. class ColumnAttribute:\\n484.     """\\n485.     Descriptor for attributes of `Column` that are associated with keywords\\n486.     in the FITS header and describe properties of the column as specified in\\n487.     the FITS standard.\\n488. \\n489.     Each `ColumnAttribute` may have a ``validator`` method defined on it.\\n490.     This validates values set on this attribute to ensure that they meet the\\n491.     FITS standard.  Invalid values will raise a warning and will not be used in\\n492.     formatting the column.  The validator should take two arguments--the\\n493.     `Column` it is being assigned to, and the new value for the attribute, and\\n494.     it must raise an `AssertionError` if the value is invalid.\\n495. \\n496.     The `ColumnAttribute` itself is a decorator that can be used to define the\\n497.     ``validator`` for each column attribute.  For example::\\n498. \\n499.         @ColumnAttribute(\\\'TTYPE\\\')\\n500.         def name(col, name):\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/io/fits/diff.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """\\n3. Facilities for diffing two FITS files.  Includes objects for diffing entire\\n4. FITS files, individual HDUs, FITS headers, or just FITS data.\\n5. \\n6. Used to implement the fitsdiff program.\\n7. """\\n8. import fnmatch\\n9. import glob\\n10. import io\\n11. import operator\\n12. import os\\n13. import os.path\\n14. import textwrap\\n15. from collections import defaultdict\\n16. from inspect import signature\\n17. from itertools import islice\\n18. \\n19. import numpy as np\\n20. \\n21. from astropy import __version__\\n22. from astropy.utils.diff import (\\n23.     diff_values,\\n24.     fixed_width_indent,\\n25.     report_diff_values,\\n26.     where_not_allclose,\\n27. )\\n28. from astropy.utils.misc import NOT_OVERWRITING_MSG\\n29. \\n30. from .card import BLANK_CARD, Card\\n31. \\n32. # HDUList is used in one of the doctests\\n33. from .hdu.hdulist import HDUList, fitsopen  # pylint: disable=W0611\\n34. from .hdu.table import _TableLikeHDU\\n35. from .header import Header\\n36. from .util import path_like\\n37. \\n38. __all__ = [\\n39.     "FITSDiff",\\n40.     "HDUDiff",\\n41.     "HeaderDiff",\\n42.     "ImageDataDiff",\\n43.     "RawDataDiff",\\n44.     "TableDataDiff",\\n45. ]\\n46. \\n47. # Column attributes of interest for comparison\\n48. _COL_ATTRS = [\\n49.     ("unit", "units"),\\n50.     ("null", "null values"),\\n51.     ("bscale", "bscales"),\\n52.     ("bzero", "bzeros"),\\n53.     ("disp", "display formats"),\\n54.     ("dim", "dimensions"),\\n55. ]\\n56. \\n57. \\n58. class _BaseDiff:\\n59.     """\\n60.     Base class for all FITS diff objects.\\n61. \\n62.     When instantiating a FITS diff object, the first two arguments are always\\n63.     the two objects to diff (two FITS files, two FITS headers, etc.).\\n64.     Instantiating a ``_BaseDiff`` also causes the diff itself to be executed.\\n65.     The returned ``_BaseDiff`` instance has a number of attribute that describe\\n66.     the results of the diff operation.\\n67. \\n68.     The most basic attribute, present on all ``_BaseDiff`` instances, is\\n69.     ``.identical`` which is `True` if the two objects being compared are\\n70.     identical according to the diff method for objects of that type.\\n71.     """\\n72. \\n73.     def __init__(self, a, b):\\n74.         """\\n75.         The ``_BaseDiff`` class does not implement a ``_diff`` method and\\n76.         should not be instantiated directly. Instead instantiate the\\n77.         appropriate subclass of ``_BaseDiff`` for the objects being compared\\n78.         (for example, use `HeaderDiff` to compare two `Header` objects.\\n79.         """\\n80.         self.a = a\\n81.         self.b = b\\n82. \\n83.         # For internal use in report output\\n84.         self._fileobj = None\\n85.         self._indent = 0\\n86. \\n87.         self._diff()\\n88. \\n89.     def __bool__(self):\\n90.         """\\n91.         A ``_BaseDiff`` object acts as `True` in a boolean context if the two\\n92.         objects compared are different.  Otherwise it acts as `False`.\\n93.         """\\n94.         return not self.identical\\n95. \\n96.     @classmethod\\n97.     def fromdiff(cls, other, a, b):\\n98.         """\\n99.         Returns a new Diff object of a specific subclass from an existing diff\\n100.         object, passing on the values for any arguments they share in common\\n101.         (such as ignore_keywords).\\n102. \\n103.         For example::\\n104. \\n105.             >>> from astropy.io import fits\\n106.             >>> hdul1, hdul2 = fits.HDUList(), fits.HDUList()\\n107.             >>> headera, headerb = fits.Header(), fits.Header()\\n108.             >>> fd = fits.FITSDiff(hdul1, hdul2, ignore_keywords=[\\\'*\\\'])\\n109.             >>> hd = fits.HeaderDiff.fromdiff(fd, headera, headerb)\\n110.             >>> list(hd.ignore_keywords)\\n111.             [\\\'*\\\']\\n112.         """\\n113.         sig = signature(cls.__init__)\\n114.         # The first 3 arguments of any Diff initializer are self, a, and b.\\n115.         kwargs = {}\\n116.         for arg in list(sig.parameters.keys())[3:]:\\n117.             if hasattr(other, arg):\\n118.                 kwargs[arg] = getattr(other, arg)\\n119. \\n120.         return cls(a, b, **kwargs)\\n121. \\n122.     @property\\n123.     def identical(self):\\n124.         """\\n125.         `True` if all the ``.diff_*`` attributes on this diff instance are\\n126.         empty, implying that no differences were found.\\n127. \\n128.         Any subclass of ``_BaseDiff`` must have at least one ``.diff_*``\\n129.         attribute, which contains a non-empty value if and only if some\\n130.         difference was found between the two objects being compared.\\n131.         """\\n132.         return not any(\\n133.             getattr(self, attr) for attr in self.__dict__ if attr.startswith("diff_")\\n134.         )\\n135. \\n136.     def report(self, fileobj=None, indent=0, overwrite=False):\\n137.         """\\n138.         Generates a text report on the differences (if any) between two\\n139.         objects, and either returns it as a string or writes it to a file-like\\n140.         object.\\n141. \\n142.         Parameters\\n143.         ----------\\n144.         fileobj : file-like, string, or None, optional\\n145.             If `None`, this method returns the report as a string. Otherwise it\\n146.             returns `None` and writes the report to the given file-like object\\n147.             (which must have a ``.write()`` method at a minimum), or to a new\\n148.             file at the path specified.\\n149. \\n150.         indent : int\\n151.             The number of 4 space tabs to indent the report.\\n152. \\n153.         overwrite : bool, optional\\n154.             If ``True``, overwrite the output file if it exists. Raises an\\n155.             ``OSError`` if ``False`` and the output file exists. Default is\\n156.             ``False``.\\n157. \\n158.         Returns\\n159.         -------\\n160.         report : str or None\\n161.         """\\n162.         return_string = False\\n163.         filepath = None\\n164. \\n165.         if isinstance(fileobj, path_like):\\n166.             fileobj = os.path.expanduser(fileobj)\\n167.             if os.path.exists(fileobj) and not overwrite:\\n168.                 raise OSError(NOT_OVERWRITING_MSG.format(fileobj))\\n169.             else:\\n170.                 filepath = fileobj\\n171.                 fileobj = open(filepath, "w")\\n172.         elif fileobj is None:\\n173.             fileobj = io.StringIO()\\n174.             return_string = True\\n175. \\n176.         self._fileobj = fileobj\\n177.         self._indent = indent  # This is used internally by _writeln\\n178. \\n179.         try:\\n180.             self._report()\\n181.         finally:\\n182.             if filepath:\\n183.                 fileobj.close()\\n184. \\n185.         if return_string:\\n186.             return fileobj.getvalue()\\n187. \\n188.     def _writeln(self, text):\\n189.         self._fileobj.write(fixed_width_indent(text, self._indent) + "\\\\n")\\n190. \\n191.     def _diff(self):\\n192.         raise NotImplementedError\\n193. \\n194.     def _report(self):\\n195.         raise NotImplementedError\\n196. \\n197. \\n198. class FITSDiff(_BaseDiff):\\n199.     """Diff two FITS files by filename, or two `HDUList` objects.\\n200. \\n201.     `FITSDiff` objects have the following diff attributes:\\n202. \\n203.     - ``diff_hdu_count``: If the FITS files being compared have different\\n204.       numbers of HDUs, this contains a 2-tuple of the number of HDUs in each\\n205.       file.\\n206. \\n207.     - ``diff_hdus``: If any HDUs with the same index are different, this\\n208.       contains a list of 2-tuples of the HDU index and the `HDUDiff` object\\n209.       representing the differences between the two HDUs.\\n210.     """\\n211. \\n212.     def __init__(\\n213.         self,\\n214.         a,\\n215.         b,\\n216.         ignore_hdus=[],\\n217.         ignore_keywords=[],\\n218.         ignore_comments=[],\\n219.         ignore_fields=[],\\n220.         numdiffs=10,\\n221.         rtol=0.0,\\n222.         atol=0.0,\\n223.         ignore_blanks=True,\\n224.         ignore_blank_cards=True,\\n225.     ):\\n226.         """\\n227.         Parameters\\n228.         ----------\\n229.         a : str or `HDUList`\\n230.             The filename of a FITS file on disk, or an `HDUList` object.\\n231. \\n232.         b : str or `HDUList`\\n233.             The filename of a FITS file on disk, or an `HDUList` object to\\n234.             compare to the first file.\\n235. \\n236.         ignore_hdus : sequence, optional\\n237.             HDU names to ignore when comparing two FITS files or HDU lists; the\\n238.             presence of these HDUs and their contents are ignored.  Wildcard\\n239.             strings may also be included in the list.\\n240. \\n241.         ignore_keywords : sequence, optional\\n242.             Header keywords to ignore when comparing two headers; the presence\\n243.             of these keywords and their values are ignored.  Wildcard strings\\n244.             may also be included in the list.\\n245. \\n246.         ignore_comments : sequence, optional\\n247.             A list of header keywords whose comments should be ignored in the\\n248.             comparison.  May contain wildcard strings as with ignore_keywords.\\n249. \\n250.         ignore_fields : sequence, optional\\n251.             The (case-insensitive) names of any table columns to ignore if any\\n252.             table data is to be compared.\\n253. \\n254.         numdiffs : int, optional\\n255.             The number of pixel/table values to output when reporting HDU data\\n256.             differences.  Though the count of differences is the same either\\n257.             way, this allows controlling the number of different values that\\n258.             are kept in memory or output.  If a negative value is given, then\\n259.             numdiffs is treated as unlimited (default: 10).\\n260. \\n261.         rtol : float, optional\\n262.             The relative difference to allow when comparing two float values\\n263.             either in header values, image arrays, or table columns\\n264.             (default: 0.0). Values which satisfy the expression\\n265. \\n266.             .. math::\\n267. \\n268.                 \\\\\\\\left| a - b \\\\\\\\right| > \\\\\\\\text{atol} + \\\\\\\\text{rtol} \\\\\\\\cdot \\\\\\\\left| b \\\\\\\\right|\\n269. \\n270.             are considered to be different.\\n271.             The underlying function used for comparison is `numpy.allclose`.\\n272. \\n273.             .. versionadded:: 2.0\\n274. \\n275.         atol : float, optional\\n276.             The allowed absolute difference. See also ``rtol`` parameter.\\n277. \\n278.             .. versionadded:: 2.0\\n279. \\n280.         ignore_blanks : bool, optional\\n281.             Ignore extra whitespace at the end of string values either in\\n282.             headers or data. Extra leading whitespace is not ignored\\n283.             (default: True).\\n284. \\n285.         ignore_blank_cards : bool, optional\\n286.             Ignore all cards that are blank, i.e. they only contain\\n287.             whitespace (default: True).\\n288.         """\\n289.         if isinstance(a, (str, os.PathLike)):\\n290.             try:\\n291.                 a = fitsopen(a)\\n292.             except Exception as exc:\\n293.                 raise OSError(f"error opening file a ({a})") from exc\\n294.             close_a = True\\n295.         else:\\n296.             close_a = False\\n297. \\n298.         if isinstance(b, (str, os.PathLike)):\\n299.             try:\\n300.                 b = fitsopen(b)\\n301.             except Exception as exc:\\n302.                 raise OSError(f"error opening file b ({b})") from exc\\n303.             close_b = True\\n304.         else:\\n305.             close_b = False\\n306. \\n307.         # Normalize keywords/fields to ignore to upper case\\n308.         self.ignore_hdus = {k.upper() for k in ignore_hdus}\\n309.         self.ignore_keywords = {k.upper() for k in ignore_keywords}\\n310.         self.ignore_comments = {k.upper() for k in ignore_comments}\\n311.         self.ignore_fields = {k.upper() for k in ignore_fields}\\n312. \\n313.         self.numdiffs = numdiffs\\n314.         self.rtol = rtol\\n315.         self.atol = atol\\n316. \\n317.         self.ignore_blanks = ignore_blanks\\n318.         self.ignore_blank_cards = ignore_blank_cards\\n319. \\n320.         # Some hdu names may be pattern wildcards.  Find them.\\n321.         self.ignore_hdu_patterns = set()\\n322.         for name in list(self.ignore_hdus):\\n323.             if name != "*" and glob.has_magic(name):\\n324.                 self.ignore_hdus.remove(name)\\n325.                 self.ignore_hdu_patterns.add(name)\\n326. \\n327.         self.diff_hdu_count = ()\\n328.         self.diff_hdus = []\\n329. \\n330.         try:\\n331.             super().__init__(a, b)\\n332.         finally:\\n333.             if close_a:\\n334.                 a.close()\\n335.             if close_b:\\n336.                 b.close()\\n337. \\n338.     def _diff(self):\\n339.         if len(self.a) != len(self.b):\\n340.             self.diff_hdu_count = (len(self.a), len(self.b))\\n341. \\n342.         # Record filenames for use later in _report\\n343.         self.filenamea = self.a.filename()\\n344.         if not self.filenamea:\\n345.             self.filenamea = f"<{self.a.__class__.__name__} object at {id(self.a):#x}>"\\n346. \\n347.         self.filenameb = self.b.filename()\\n348.         if not self.filenameb:\\n349.             self.filenameb = f"<{self.b.__class__.__name__} object at {id(self.b):#x}>"\\n350. \\n351.         if self.ignore_hdus:\\n352.             self.a = HDUList([h for h in self.a if h.name not in self.ignore_hdus])\\n353.             self.b = HDUList([h for h in self.b if h.name not in self.ignore_hdus])\\n354.         if self.ignore_hdu_patterns:\\n355.             a_names = [hdu.name for hdu in self.a]\\n356.             b_names = [hdu.name for hdu in self.b]\\n357.             for pattern in self.ignore_hdu_patterns:\\n358.                 a_ignored = fnmatch.filter(a_names, pattern)\\n359.                 self.a = HDUList([h for h in self.a if h.name not in a_ignored])\\n360.                 b_ignored = fnmatch.filter(b_names, pattern)\\n361.                 self.b = HDUList([h for h in self.b if h.name not in b_ignored])\\n362. \\n363.         # For now, just compare the extensions one by one in order.\\n364.         # Might allow some more sophisticated types of diffing later.\\n365. \\n366.         # TODO: Somehow or another simplify the passing around of diff\\n367.         # options--this will become important as the number of options grows\\n368.         for idx in range(min(len(self.a), len(self.b))):\\n369.             hdu_diff = HDUDiff.fromdiff(self, self.a[idx], self.b[idx])\\n370. \\n371.             if not hdu_diff.identical:\\n372.                 if (\\n373.                     self.a[idx].name == self.b[idx].name\\n374.                     and self.a[idx].ver == self.b[idx].ver\\n375.                 ):\\n376.                     self.diff_hdus.append(\\n377.                         (idx, hdu_diff, self.a[idx].name, self.a[idx].ver)\\n378.                     )\\n379.                 else:\\n380.                     self.diff_hdus.append((idx, hdu_diff, "", self.a[idx].ver))\\n381. \\n382.     def _report(self):\\n383.         wrapper = textwrap.TextWrapper(initial_indent="  ", subsequent_indent="  ")\\n384. \\n385.         self._fileobj.write("\\\\n")\\n386.         self._writeln(f" fitsdiff: {__version__}")\\n387.         self._writeln(f" a: {self.filenamea}\\\\n b: {self.filenameb}")\\n388. \\n389.         if self.ignore_hdus:\\n390.             ignore_hdus = " ".join(sorted(self.ignore_hdus))\\n391.             self._writeln(" HDU(s) not to be compared:\\\\n" + wrapper.fill(ignore_hdus))\\n392. \\n393.         if self.ignore_hdu_patterns:\\n394.             ignore_hdu_patterns = " ".join(sorted(self.ignore_hdu_patterns))\\n395.             self._writeln(\\n396.                 " HDU(s) not to be compared:\\\\n" + wrapper.fill(ignore_hdu_patterns)\\n397.             )\\n398. \\n399.         if self.ignore_keywords:\\n400.             ignore_keywords = " ".join(sorted(self.ignore_keywords))\\n401.             self._writeln(\\n402.                 " Keyword(s) not to be compared:\\\\n" + wrapper.fill(ignore_keywords)\\n403.             )\\n404. \\n405.         if self.ignore_comments:\\n406.             ignore_comments = " ".join(sorted(self.ignore_comments))\\n407.             self._writeln(\\n408.                 " Keyword(s) whose comments are not to be compared:\\\\n"\\n409.                 + wrapper.fill(ignore_comments)\\n410.             )\\n411. \\n412.         if self.ignore_fields:\\n413.             ignore_fields = " ".join(sorted(self.ignore_fields))\\n414.             self._writeln(\\n415.                 " Table column(s) not to be compared:\\\\n" + wrapper.fill(ignore_fields)\\n416.             )\\n417. \\n418.         self._writeln(\\n419.             f" Maximum number of different data values to be reported: {self.numdiffs}"\\n420.         )\\n421.         self._writeln(\\n422.             f" Relative tolerance: {self.rtol}, Absolute tolerance: {self.atol}"\\n423.         )\\n424. \\n425.         if self.diff_hdu_count:\\n426.             self._fileobj.write("\\\\n")\\n427.             self._writeln("Files contain different numbers of HDUs:")\\n428.             self._writeln(f" a: {self.diff_hdu_count[0]}")\\n429.             self._writeln(f" b: {self.diff_hdu_count[1]}")\\n430. \\n431.             if not self.diff_hdus:\\n432.                 self._writeln("No differences found between common HDUs.")\\n433.                 return\\n434.         elif not self.diff_hdus:\\n435.             self._fileobj.write("\\\\n")\\n436.             self._writeln("No differences found.")\\n437.             return\\n438. \\n439.         for idx, hdu_diff, extname, extver in self.diff_hdus:\\n440.             # print out the extension heading\\n441.             if idx == 0:\\n442.                 self._fileobj.write("\\\\n")\\n443.                 self._writeln("Primary HDU:")\\n444.             else:\\n445.                 self._fileobj.write("\\\\n")\\n446.                 if extname:\\n447.                     self._writeln(f"Extension HDU {idx} ({extname}, {extver}):")\\n448.                 else:\\n449.                     self._writeln(f"Extension HDU {idx}:")\\n450.             hdu_diff.report(self._fileobj, indent=self._indent + 1)\\n451. \\n452. \\n453. class HDUDiff(_BaseDiff):\\n454.     """\\n455.     Diff two HDU objects, including their headers and their data (but only if\\n456.     both HDUs contain the same type of data (image, table, or unknown).\\n457. \\n458.     `HDUDiff` objects have the following diff attributes:\\n459. \\n460.     - ``diff_extnames``: If the two HDUs have different EXTNAME values, this\\n461.       contains a 2-tuple of the different extension names.\\n462. \\n463.     - ``diff_extvers``: If the two HDUS have different EXTVER values, this\\n464.       contains a 2-tuple of the different extension versions.\\n465. \\n466.     - ``diff_extlevels``: If the two HDUs have different EXTLEVEL values, this\\n467.       contains a 2-tuple of the different extension levels.\\n468. \\n469.     - ``diff_extension_types``: If the two HDUs have different XTENSION values,\\n470.       this contains a 2-tuple of the different extension types.\\n471. \\n472.     - ``diff_headers``: Contains a `HeaderDiff` object for the headers of the\\n473.       two HDUs. This will always contain an object--it may be determined\\n474.       whether the headers are different through ``diff_headers.identical``.\\n475. \\n476.     - ``diff_data``: Contains either a `ImageDataDiff`, `TableDataDiff`, or\\n477.       `RawDataDiff` as appropriate for the data in the HDUs, and only if the\\n478.       two HDUs have non-empty data of the same type (`RawDataDiff` is used for\\n479.       HDUs containing non-empty data of an indeterminate type).\\n480.     """\\n481. \\n482.     def __init__(\\n483.         self,\\n484.         a,\\n485.         b,\\n486.         ignore_keywords=[],\\n487.         ignore_comments=[],\\n488.         ignore_fields=[],\\n489.         numdiffs=10,\\n490.         rtol=0.0,\\n491.         atol=0.0,\\n492.         ignore_blanks=True,\\n493.         ignore_blank_cards=True,\\n494.     ):\\n495.         """\\n496.         Parameters\\n497.         ----------\\n498.         a : BaseHDU\\n499.             An HDU object.\\n500. \\n501.         b : BaseHDU\\n502.             An HDU object to compare to the first HDU object.\\n503. \\n504.         ignore_keywords : sequence, optional\\n505.             Header keywords to ignore when comparing two headers; the presence\\n506.             of these keywords and their values are ignored.  Wildcard strings\\n507.             may also be included in the list.\\n508. \\n509.         ignore_comments : sequence, optional\\n510.             A list of header keywords whose comments should be ignored in the\\n511.             comparison.  May contain wildcard strings as with ignore_keywords.\\n512. \\n513.         ignore_fields : sequence, optional\\n514.             The (case-insensitive) names of any table columns to ignore if any\\n515.             table data is to be compared.\\n516. \\n517.         numdiffs : int, optional\\n518.             The number of pixel/table values to output when reporting HDU data\\n519.             differences.  Though the count of differences is the same either\\n520.             way, this allows controlling the number of different values that\\n521.             are kept in memory or output.  If a negative value is given, then\\n522.             numdiffs is treated as unlimited (default: 10).\\n523. \\n524.         rtol : float, optional\\n525.             The relative difference to allow when comparing two float values\\n526.             either in header values, image arrays, or table columns\\n527.             (default: 0.0). Values which satisfy the expression\\n528. \\n529.             .. math::\\n530. \\n531.                 \\\\\\\\left| a - b \\\\\\\\right| > \\\\\\\\text{atol} + \\\\\\\\text{rtol} \\\\\\\\cdot \\\\\\\\left| b \\\\\\\\right|\\n532. \\n533.             are considered to be different.\\n534.             The underlying function used for comparison is `numpy.allclose`.\\n535. \\n536.             .. versionadded:: 2.0\\n537. \\n538.         atol : float, optional\\n539.             The allowed absolute difference. See also ``rtol`` parameter.\\n540. \\n541.             .. versionadded:: 2.0\\n542. \\n543.         ignore_blanks : bool, optional\\n544.             Ignore extra whitespace at the end of string values either in\\n545.             headers or data. Extra leading whitespace is not ignored\\n546.             (default: True).\\n547. \\n548.         ignore_blank_cards : bool, optional\\n549.             Ignore all cards that are blank, i.e. they only contain\\n550.             whitespace (default: True).\\n551.         """\\n552.         self.ignore_keywords = {k.upper() for k in ignore_keywords}\\n553.         self.ignore_comments = {k.upper() for k in ignore_comments}\\n554.         self.ignore_fields = {k.upper() for k in ignore_fields}\\n555. \\n556.         self.rtol = rtol\\n557.         self.atol = atol\\n558. \\n559.         self.numdiffs = numdiffs\\n560.         self.ignore_blanks = ignore_blanks\\n561.         self.ignore_blank_cards = ignore_blank_cards\\n562. \\n563.         self.diff_extnames = ()\\n564.         self.diff_extvers = ()\\n565.         self.diff_extlevels = ()\\n566.         self.diff_extension_types = ()\\n567.         self.diff_headers = None\\n568.         self.diff_data = None\\n569. \\n570.         super().__init__(a, b)\\n571. \\n572.     def _diff(self):\\n573.         if self.a.name != self.b.name:\\n574.             self.diff_extnames = (self.a.name, self.b.name)\\n575. \\n576.         if self.a.ver != self.b.ver:\\n577.             self.diff_extvers = (self.a.ver, self.b.ver)\\n578. \\n579.         if self.a.level != self.b.level:\\n580.             self.diff_extlevels = (self.a.level, self.b.level)\\n581. \\n582.         if self.a.header.get("XTENSION") != self.b.header.get("XTENSION"):\\n583.             self.diff_extension_types = (\\n584.                 self.a.header.get("XTENSION"),\\n585.                 self.b.header.get("XTENSION"),\\n586.             )\\n587. \\n588.         self.diff_headers = HeaderDiff.fromdiff(\\n589.             self, self.a.header.copy(), self.b.header.copy()\\n590.         )\\n591. \\n592.         if self.a.data is None or self.b.data is None:\\n593.             # TODO: Perhaps have some means of marking this case\\n594.             pass\\n595.         elif self.a.is_image and self.b.is_image:\\n596.             self.diff_data = ImageDataDiff.fromdiff(self, self.a.data, self.b.data)\\n597.             # Clean up references to (possibly) memmapped arrays so they can\\n598.             # be closed by .close()\\n599.             self.diff_data.a = None\\n600.             self.diff_data.b = None\\n601.         elif isinstance(self.a, _TableLikeHDU) and isinstance(self.b, _TableLikeHDU):\\n602.             # TODO: Replace this if/when _BaseHDU grows a .is_table property\\n603.             self.diff_data = TableDataDiff.fromdiff(self, self.a.data, self.b.data)\\n604.             # Clean up references to (possibly) memmapped arrays so they can\\n605.             # be closed by .close()\\n606.             self.diff_data.a = None\\n607.             self.diff_data.b = None\\n608.         elif not self.diff_extension_types:\\n609.             # Don\\\'t diff the data for unequal extension types that are not\\n610.             # recognized image or table types\\n611.             self.diff_data = RawDataDiff.fromdiff(self, self.a.data, self.b.data)\\n612.             # Clean up references to (possibly) memmapped arrays so they can\\n613.             # be closed by .close()\\n614.             self.diff_data.a = None\\n615.             self.diff_data.b = None\\n616. \\n617.     def _report(self):\\n618.         if self.identical:\\n619.             self._writeln(" No differences found.")\\n620.         if self.diff_extension_types:\\n621.             self._writeln(\\n622.                 " Extension types differ:\\\\n  a: {}\\\\n  b: {}".format(\\n623.                     *self.diff_extension_types\\n624.                 )\\n625.             )\\n626.         if self.diff_extnames:\\n627.             self._writeln(\\n628.                 " Extension names differ:\\\\n  a: {}\\\\n  b: {}".format(*self.diff_extnames)\\n629.             )\\n630.         if self.diff_extvers:\\n631.             self._writeln(\\n632.                 " Extension versions differ:\\\\n  a: {}\\\\n  b: {}".format(\\n633.                     *self.diff_extvers\\n634.                 )\\n635.             )\\n636. \\n637.         if self.diff_extlevels:\\n638.             self._writeln(\\n639.                 " Extension levels differ:\\\\n  a: {}\\\\n  b: {}".format(\\n640.                     *self.diff_extlevels\\n641.                 )\\n642.             )\\n643. \\n644.         if not self.diff_headers.identical:\\n645.             self._fileobj.write("\\\\n")\\n646.             self._writeln(" Headers contain differences:")\\n647.             self.diff_headers.report(self._fileobj, indent=self._indent + 1)\\n648. \\n649.         if self.diff_data is not None and not self.diff_data.identical:\\n650.             self._fileobj.write("\\\\n")\\n651.             self._writeln(" Data contains differences:")\\n652.             self.diff_data.report(self._fileobj, indent=self._indent + 1)\\n653. \\n654. \\n655. class HeaderDiff(_BaseDiff):\\n656.     """\\n657.     Diff two `Header` objects.\\n658. \\n659.     `HeaderDiff` objects have the following diff attributes:\\n660. \\n661.     - ``diff_keyword_count``: If the two headers contain a different number of\\n662.       keywords, this contains a 2-tuple of the keyword count for each header.\\n663. \\n664.     - ``diff_keywords``: If either header contains one or more keywords that\\n665.       don\\\'t appear at all in the other header, this contains a 2-tuple\\n666.       consisting of a list of the keywords only appearing in header a, and a\\n667.       list of the keywords only appearing in header b.\\n668. \\n669.     - ``diff_duplicate_keywords``: If a keyword appears in both headers at\\n670.       least once, but contains a different number of duplicates (for example, a\\n671.       different number of HISTORY cards in each header), an item is added to\\n672.       this dict with the keyword as the key, and a 2-tuple of the different\\n673.       counts of that keyword as the value.  For example::\\n674. \\n675.           {\\\'HISTORY\\\': (20, 19)}\\n676. \\n677.       means that header a contains 20 HISTORY cards, while header b contains\\n678.       only 19 HISTORY cards.\\n679. \\n680.     - ``diff_keyword_values``: If any of the common keyword between the two\\n681.       headers have different values, they appear in this dict.  It has a\\n682.       structure similar to ``diff_duplicate_keywords``, with the keyword as the\\n683.       key, and a 2-tuple of the different values as the value.  For example::\\n684. \\n685.           {\\\'NAXIS\\\': (2, 3)}\\n686. \\n687.       means that the NAXIS keyword has a value of 2 in header a, and a value of\\n688.       3 in header b.  This excludes any keywords matched by the\\n689.       ``ignore_keywords`` list.\\n690. \\n691.     - ``diff_keyword_comments``: Like ``diff_keyword_values``, but contains\\n692.       differences between keyword comments.\\n693. \\n694.     `HeaderDiff` objects also have a ``common_keywords`` attribute that lists\\n695.     all keywords that appear in both headers.\\n696.     """\\n697. \\n698.     def __init__(\\n699.         self,\\n700.         a,\\n701.         b,\\n702.         ignore_keywords=[],\\n703.         ignore_comments=[],\\n704.         rtol=0.0,\\n705.         atol=0.0,\\n706.         ignore_blanks=True,\\n707.         ignore_blank_cards=True,\\n708.     ):\\n709.         """\\n710.         Parameters\\n711.         ----------\\n712.         a : `~astropy.io.fits.Header` or string or bytes\\n713.             A header.\\n714. \\n715.         b : `~astropy.io.fits.Header` or string or bytes\\n716.             A header to compare to the first header.\\n717. \\n718.         ignore_keywords : sequence, optional\\n719.             Header keywords to ignore when comparing two headers; the presence\\n720.             of these keywords and their values are ignored.  Wildcard strings\\n721.             may also be included in the list.\\n722. \\n723.         ignore_comments : sequence, optional\\n724.             A list of header keywords whose comments should be ignored in the\\n725.             comparison.  May contain wildcard strings as with ignore_keywords.\\n726. \\n727.         numdiffs : int, optional\\n728.             The number of pixel/table values to output when reporting HDU data\\n729.             differences.  Though the count of differences is the same either\\n730.             way, this allows controlling the number of different values that\\n731.             are kept in memory or output.  If a negative value is given, then\\n732.             numdiffs is treated as unlimited (default: 10).\\n733. \\n734.         rtol : float, optional\\n735.             The relative difference to allow when comparing two float values\\n736.             either in header values, image arrays, or table columns\\n737.             (default: 0.0). Values which satisfy the expression\\n738. \\n739.             .. math::\\n740. \\n741.                 \\\\\\\\left| a - b \\\\\\\\right| > \\\\\\\\text{atol} + \\\\\\\\text{rtol} \\\\\\\\cdot \\\\\\\\left| b \\\\\\\\right|\\n742. \\n743.             are considered to be different.\\n744.             The underlying function used for comparison is `numpy.allclose`.\\n745. \\n746.             .. versionadded:: 2.0\\n747. \\n748.         atol : float, optional\\n749.             The allowed absolute difference. See also ``rtol`` parameter.\\n750. \\n751.             .. versionadded:: 2.0\\n752. \\n753.         ignore_blanks : bool, optional\\n754.             Ignore extra whitespace at the end of string values either in\\n755.             headers or data. Extra leading whitespace is not ignored\\n756.             (default: True).\\n757. \\n758.         ignore_blank_cards : bool, optional\\n759.             Ignore all cards that are blank, i.e. they only contain\\n760.             whitespace (default: True).\\n761.         """\\n762.         self.ignore_keywords = {k.upper() for k in ignore_keywords}\\n763.         self.ignore_comments = {k.upper() for k in ignore_comments}\\n764. \\n765.         self.rtol = rtol\\n766.         self.atol = atol\\n767. \\n768.         self.ignore_blanks = ignore_blanks\\n769.         self.ignore_blank_cards = ignore_blank_cards\\n770. \\n771.         self.ignore_keyword_patterns = set()\\n772.         self.ignore_comment_patterns = set()\\n773.         for keyword in list(self.ignore_keywords):\\n774.             keyword = keyword.upper()\\n775.             if keyword != "*" and glob.has_magic(keyword):\\n776.                 self.ignore_keywords.remove(keyword)\\n777.                 self.ignore_keyword_patterns.add(keyword)\\n778.         for keyword in list(self.ignore_comments):\\n779.             keyword = keyword.upper()\\n780.             if keyword != "*" and glob.has_magic(keyword):\\n781.                 self.ignore_comments.remove(keyword)\\n782.                 self.ignore_comment_patterns.add(keyword)\\n783. \\n784.         # Keywords appearing in each header\\n785.         self.common_keywords = []\\n786. \\n787.         # Set to the number of keywords in each header if the counts differ\\n788.         self.diff_keyword_count = ()\\n789. \\n790.         # Set if the keywords common to each header (excluding ignore_keywords)\\n791.         # appear in different positions within the header\\n792.         # TODO: Implement this\\n793.         self.diff_keyword_positions = ()\\n794. \\n795.         # Keywords unique to each header (excluding keywords in\\n796.         # ignore_keywords)\\n797.         self.diff_keywords = ()\\n798. \\n799.         # Keywords that have different numbers of duplicates in each header\\n800.         # (excluding keywords in ignore_keywords)\\n801.         self.diff_duplicate_keywords = {}\\n802. \\n803.         # Keywords common to each header but having different values (excluding\\n804.         # keywords in ignore_keywords)\\n805.         self.diff_keyword_values = defaultdict(list)\\n806. \\n807.         # Keywords common to each header but having different comments\\n808.         # (excluding keywords in ignore_keywords or in ignore_comments)\\n809.         self.diff_keyword_comments = defaultdict(list)\\n810. \\n811.         if isinstance(a, str):\\n812.             a = Header.fromstring(a)\\n813.         if isinstance(b, str):\\n814.             b = Header.fromstring(b)\\n815. \\n816.         if not (isinstance(a, Header) and isinstance(b, Header)):\\n817.             raise TypeError(\\n818.                 "HeaderDiff can only diff astropy.io.fits.Header "\\n819.                 "objects or strings containing FITS headers."\\n820.             )\\n821. \\n822.         super().__init__(a, b)\\n823. \\n824.     # TODO: This doesn\\\'t pay much attention to the *order* of the keywords,\\n825.     # except in the case of duplicate keywords.  The order should be checked\\n826.     # too, or at least it should be an option.\\n827.     def _diff(self):\\n828.         if self.ignore_blank_cards:\\n829.             cardsa = [c for c in self.a.cards if str(c) != BLANK_CARD]\\n830.             cardsb = [c for c in self.b.cards if str(c) != BLANK_CARD]\\n831.         else:\\n832.             cardsa = list(self.a.cards)\\n833.             cardsb = list(self.b.cards)\\n834. \\n835.         # build dictionaries of keyword values and comments\\n836.         def get_header_values_comments(cards):\\n837.             values = {}\\n838.             comments = {}\\n839.             for card in cards:\\n840.                 value = card.value\\n841.                 if self.ignore_blanks and isinstance(value, str):\\n842.                     value = value.rstrip()\\n843.                 values.setdefault(card.keyword, []).append(value)\\n844.                 comments.setdefault(card.keyword, []).append(card.comment)\\n845.             return values, comments\\n846. \\n847.         valuesa, commentsa = get_header_values_comments(cardsa)\\n848.         valuesb, commentsb = get_header_values_comments(cardsb)\\n849. \\n850.         # Normalize all keyword to upper-case for comparison\\\'s sake;\\n851.         # TODO: HIERARCH keywords should be handled case-sensitively I think\\n852.         keywordsa = {k.upper() for k in valuesa}\\n853.         keywordsb = {k.upper() for k in valuesb}\\n854. \\n855.         self.common_keywords = sorted(keywordsa.intersection(keywordsb))\\n856.         if len(cardsa) != len(cardsb):\\n857.             self.diff_keyword_count = (len(cardsa), len(cardsb))\\n858. \\n859.         # Any other diff attributes should exclude ignored keywords\\n860.         keywordsa = keywordsa.difference(self.ignore_keywords)\\n861.         keywordsb = keywordsb.difference(self.ignore_keywords)\\n862.         if self.ignore_keyword_patterns:\\n863.             for pattern in self.ignore_keyword_patterns:\\n864.                 keywordsa = keywordsa.difference(fnmatch.filter(keywordsa, pattern))\\n865.                 keywordsb = keywordsb.difference(fnmatch.filter(keywordsb, pattern))\\n866. \\n867.         if "*" in self.ignore_keywords:\\n868.             # Any other differences between keywords are to be ignored\\n869.             return\\n870. \\n871.         left_only_keywords = sorted(keywordsa.difference(keywordsb))\\n872.         right_only_keywords = sorted(keywordsb.difference(keywordsa))\\n873. \\n874.         if left_only_keywords or right_only_keywords:\\n875.             self.diff_keywords = (left_only_keywords, right_only_keywords)\\n876. \\n877.         # Compare count of each common keyword\\n878.         for keyword in self.common_keywords:\\n879.             if keyword in self.ignore_keywords:\\n880.                 continue\\n881.             if self.ignore_keyword_patterns:\\n882.                 skip = False\\n883.                 for pattern in self.ignore_keyword_patterns:\\n884.                     if fnmatch.fnmatch(keyword, pattern):\\n885.                         skip = True\\n886.                         break\\n887.                 if skip:\\n888.                     continue\\n889. \\n890.             counta = len(valuesa[keyword])\\n891.             countb = len(valuesb[keyword])\\n892.             if counta != countb:\\n893.                 self.diff_duplicate_keywords[keyword] = (counta, countb)\\n894. \\n895.             # Compare keywords\\\' values and comments\\n896.             for a, b in zip(valuesa[keyword], valuesb[keyword]):\\n897.                 if diff_values(a, b, rtol=self.rtol, atol=self.atol):\\n898.                     self.diff_keyword_values[keyword].append((a, b))\\n899.                 else:\\n900.                     # If there are duplicate keywords we need to be able to\\n901.                     # index each duplicate; if the values of a duplicate\\n902.                     # are identical use None here\\n903.                     self.diff_keyword_values[keyword].append(None)\\n904. \\n905.             if not any(self.diff_keyword_values[keyword]):\\n906.                 # No differences found; delete the array of Nones\\n907.                 del self.diff_keyword_values[keyword]\\n908. \\n909.             if "*" in self.ignore_comments or keyword in self.ignore_comments:\\n910.                 continue\\n911.             if self.ignore_comment_patterns:\\n912.                 skip = False\\n913.                 for pattern in self.ignore_comment_patterns:\\n914.                     if fnmatch.fnmatch(keyword, pattern):\\n915.                         skip = True\\n916.                         break\\n917.                 if skip:\\n918.                     continue\\n919. \\n920.             for a, b in zip(commentsa[keyword], commentsb[keyword]):\\n921.                 if diff_values(a, b):\\n922.                     self.diff_keyword_comments[keyword].append((a, b))\\n923.                 else:\\n924.                     self.diff_keyword_comments[keyword].append(None)\\n925. \\n926.             if not any(self.diff_keyword_comments[keyword]):\\n927.                 del self.diff_keyword_comments[keyword]\\n928. \\n929.     def _report(self):\\n930.         if self.diff_keyword_count:\\n931.             self._writeln(" Headers have different number of cards:")\\n932.             self._writeln(f"  a: {self.diff_keyword_count[0]}")\\n933.             self._writeln(f"  b: {self.diff_keyword_count[1]}")\\n934.         if self.diff_keywords:\\n935.             for keyword in self.diff_keywords[0]:\\n936.                 if keyword in Card._commentary_keywords:\\n937.                     val = self.a[keyword][0]\\n938.                 else:\\n939.                     val = self.a[keyword]\\n940.                 self._writeln(f" Extra keyword {keyword!r:8} in a: {val!r}")\\n941.             for keyword in self.diff_keywords[1]:\\n942.                 if keyword in Card._commentary_keywords:\\n943.                     val = self.b[keyword][0]\\n944.                 else:\\n945.                     val = self.b[keyword]\\n946.                 self._writeln(f" Extra keyword {keyword!r:8} in b: {val!r}")\\n947. \\n948.         if self.diff_duplicate_keywords:\\n949.             for keyword, count in sorted(self.diff_duplicate_keywords.items()):\\n950.                 self._writeln(f" Inconsistent duplicates of keyword {keyword!r:8}:")\\n951.                 self._writeln(\\n952.                     "  Occurs {} time(s) in a, {} times in (b)".format(*count)\\n953.                 )\\n954. \\n955.         if self.diff_keyword_values or self.diff_keyword_comments:\\n956.             for keyword in self.common_keywords:\\n957.                 report_diff_keyword_attr(\\n958.                     self._fileobj,\\n959.                     "values",\\n960.                     self.diff_keyword_values,\\n961.                     keyword,\\n962.                     ind=self._indent,\\n963.                 )\\n964.                 report_diff_keyword_attr(\\n965.                     self._fileobj,\\n966.                     "comments",\\n967.                     self.diff_keyword_comments,\\n968.                     keyword,\\n969.                     ind=self._indent,\\n970.                 )\\n971. \\n972. \\n973. # TODO: It might be good if there was also a threshold option for percentage of\\n974. # different pixels: For example ignore if only 1% of the pixels are different\\n975. # within some threshold.  There are lots of possibilities here, but hold off\\n976. # for now until specific cases come up.\\n977. \\n978. \\n979. class ImageDataDiff(_BaseDiff):\\n980.     """\\n981.     Diff two image data arrays (really any array from a PRIMARY HDU or an IMAGE\\n982.     extension HDU, though the data unit is assumed to be "pixels").\\n983. \\n984.     `ImageDataDiff` objects have the following diff attributes:\\n985. \\n986.     - ``diff_dimensions``: If the two arrays contain either a different number\\n987.       of dimensions or different sizes in any dimension, this contains a\\n988.       2-tuple of the shapes of each array.  Currently no further comparison is\\n989.       performed on images that don\\\'t have the exact same dimensions.\\n990. \\n991.     - ``diff_pixels``: If the two images contain any different pixels, this\\n992.       contains a list of 2-tuples of the array index where the difference was\\n993.       found, and another 2-tuple containing the different values.  For example,\\n994.       if the pixel at (0, 0) contains different values this would look like::\\n995. \\n996.           [(0, 0), (1.1, 2.2)]\\n997. \\n998.       where 1.1 and 2.2 are the values of that pixel in each array.  This\\n999.       array only contains up to ``self.numdiffs`` differences, for storage\\n1000.       efficiency.\\n1001. \\n1002.     - ``diff_total``: The total number of different pixels found between the\\n1003.       arrays.  Although ``diff_pixels`` does not necessarily contain all the\\n1004.       different pixel values, this can be used to get a count of the total\\n1005.       number of differences found.\\n1006. \\n1007.     - ``diff_ratio``: Contains the ratio of ``diff_total`` to the total number\\n1008.       of pixels in the arrays.\\n1009.     """\\n1010. \\n1011.     def __init__(self, a, b, numdiffs=10, rtol=0.0, atol=0.0):\\n1012.         """\\n1013.         Parameters\\n1014.         ----------\\n1015.         a : BaseHDU\\n1016.             An HDU object.\\n1017. \\n1018.         b : BaseHDU\\n1019.             An HDU object to compare to the first HDU object.\\n1020. \\n1021.         numdiffs : int, optional\\n1022.             The number of pixel/table values to output when reporting HDU data\\n1023.             differences.  Though the count of differences is the same either\\n1024.             way, this allows controlling the number of different values that\\n1025.             are kept in memory or output.  If a negative value is given, then\\n1026.             numdiffs is treated as unlimited (default: 10).\\n1027. \\n1028.         rtol : float, optional\\n1029.             The relative difference to allow when comparing two float values\\n1030.             either in header values, image arrays, or table columns\\n1031.             (default: 0.0). Values which satisfy the expression\\n1032. \\n1033.             .. math::\\n1034. \\n1035.                 \\\\\\\\left| a - b \\\\\\\\right| > \\\\\\\\text{atol} + \\\\\\\\text{rtol} \\\\\\\\cdot \\\\\\\\left| b \\\\\\\\right|\\n1036. \\n1037.             are considered to be different.\\n1038.             The underlying function used for comparison is `numpy.allclose`.\\n1039. \\n1040.             .. versionadded:: 2.0\\n1041. \\n1042.         atol : float, optional\\n1043.             The allowed absolute difference. See also ``rtol`` parameter.\\n1044. \\n1045.             .. versionadded:: 2.0\\n1046.         """\\n1047.         self.numdiffs = numdiffs\\n1048.         self.rtol = rtol\\n1049.         self.atol = atol\\n1050. \\n1051.         self.diff_dimensions = ()\\n1052.         self.diff_pixels = []\\n1053.         self.diff_ratio = 0\\n1054. \\n1055.         # self.diff_pixels only holds up to numdiffs differing pixels, but this\\n1056.         # self.diff_total stores the total count of differences between\\n1057.         # the images, but not the different values\\n1058.         self.diff_total = 0\\n1059. \\n1060.         super().__init__(a, b)\\n1061. \\n1062.     def _diff(self):\\n1063.         if self.a.shape != self.b.shape:\\n1064.             self.diff_dimensions = (self.a.shape, self.b.shape)\\n1065.             # Don\\\'t do any further comparison if the dimensions differ\\n1066.             # TODO: Perhaps we could, however, diff just the intersection\\n1067.             # between the two images\\n1068.             return\\n1069. \\n1070.         # Find the indices where the values are not equal\\n1071.         # If neither a nor b are floating point (or complex), ignore rtol and\\n1072.         # atol\\n1073.         if not (\\n1074.             np.issubdtype(self.a.dtype, np.inexact)\\n1075.             or np.issubdtype(self.b.dtype, np.inexact)\\n1076.         ):\\n1077.             rtol = 0\\n1078.             atol = 0\\n1079.         else:\\n1080.             rtol = self.rtol\\n1081.             atol = self.atol\\n1082. \\n1083.         diffs = where_not_allclose(self.a, self.b, atol=atol, rtol=rtol)\\n1084. \\n1085.         self.diff_total = len(diffs[0])\\n1086. \\n1087.         if self.diff_total == 0:\\n1088.             # Then we\\\'re done\\n1089.             return\\n1090. \\n1091.         if self.numdiffs < 0:\\n1092.             numdiffs = self.diff_total\\n1093.         else:\\n1094.             numdiffs = self.numdiffs\\n1095. \\n1096.         self.diff_pixels = [\\n1097.             (idx, (self.a[idx], self.b[idx]))\\n1098.             for idx in islice(zip(*diffs), 0, numdiffs)\\n1099.         ]\\n1100.         self.diff_ratio = float(self.diff_total) / float(len(self.a.flat))\\n1101. \\n1102.     def _report(self):\\n1103.         if self.diff_dimensions:\\n1104.             dimsa = " x ".join(str(d) for d in reversed(self.diff_dimensions[0]))\\n1105.             dimsb = " x ".join(str(d) for d in reversed(self.diff_dimensions[1]))\\n1106.             self._writeln(" Data dimensions differ:")\\n1107.             self._writeln(f"  a: {dimsa}")\\n1108.             self._writeln(f"  b: {dimsb}")\\n1109.             # For now we don\\\'t do any further comparison if the dimensions\\n1110.             # differ; though in the future it might be nice to be able to\\n1111.             # compare at least where the images intersect\\n1112.             self._writeln(" No further data comparison performed.")\\n1113.             return\\n1114. \\n1115.         if not self.diff_pixels:\\n1116.             return\\n1117. \\n1118.         for index, values in self.diff_pixels:\\n1119.             index = [x + 1 for x in reversed(index)]\\n1120.             self._writeln(f" Data differs at {index}:")\\n1121.             report_diff_values(\\n1122.                 values[0],\\n1123.                 values[1],\\n1124.                 fileobj=self._fileobj,\\n1125.                 indent_width=self._indent + 1,\\n1126.                 rtol=self.rtol,\\n1127.                 atol=self.atol,\\n1128.             )\\n1129. \\n1130.         if self.diff_total > self.numdiffs:\\n1131.             self._writeln(" ...")\\n1132.         self._writeln(\\n1133.             " {} different pixels found ({:.2%} different).".format(\\n1134.                 self.diff_total, self.diff_ratio\\n1135.             )\\n1136.         )\\n1137. \\n1138. \\n1139. class RawDataDiff(ImageDataDiff):\\n1140.     """\\n1141.     `RawDataDiff` is just a special case of `ImageDataDiff` where the images\\n1142.     are one-dimensional, and the data is treated as a 1-dimensional array of\\n1143.     bytes instead of pixel values.  This is used to compare the data of two\\n1144.     non-standard extension HDUs that were not recognized as containing image or\\n1145.     table data.\\n1146. \\n1147.     `ImageDataDiff` objects have the following diff attributes:\\n1148. \\n1149.     - ``diff_dimensions``: Same as the ``diff_dimensions`` attribute of\\n1150.       `ImageDataDiff` objects. Though the "dimension" of each array is just an\\n1151.       integer representing the number of bytes in the data.\\n1152. \\n1153.     - ``diff_bytes``: Like the ``diff_pixels`` attribute of `ImageDataDiff`\\n1154.       objects, but renamed to reflect the minor semantic difference that these\\n1155.       are raw bytes and not pixel values.  Also the indices are integers\\n1156.       instead of tuples.\\n1157. \\n1158.     - ``diff_total`` and ``diff_ratio``: Same as `ImageDataDiff`.\\n1159.     """\\n1160. \\n1161.     def __init__(self, a, b, numdiffs=10):\\n1162.         """\\n1163.         Parameters\\n1164.         ----------\\n1165.         a : BaseHDU\\n1166.             An HDU object.\\n1167. \\n1168.         b : BaseHDU\\n1169.             An HDU object to compare to the first HDU object.\\n1170. \\n1171.         numdiffs : int, optional\\n1172.             The number of pixel/table values to output when reporting HDU data\\n1173.             differences.  Though the count of differences is the same either\\n1174.             way, this allows controlling the number of different values that\\n1175.             are kept in memory or output.  If a negative value is given, then\\n1176.             numdiffs is treated as unlimited (default: 10).\\n1177.         """\\n1178.         self.diff_dimensions = ()\\n1179.         self.diff_bytes = []\\n1180. \\n1181.         super().__init__(a, b, numdiffs=numdiffs)\\n1182. \\n1183.     def _diff(self):\\n1184.         super()._diff()\\n1185.         if self.diff_dimensions:\\n1186.             self.diff_dimensions = (\\n1187.                 self.diff_dimensions[0][0],\\n1188.                 self.diff_dimensions[1][0],\\n1189.             )\\n1190. \\n1191.         self.diff_bytes = [(x[0], y) for x, y in self.diff_pixels]\\n1192.         del self.diff_pixels\\n1193. \\n1194.     def _report(self):\\n1195.         if self.diff_dimensions:\\n1196.             self._writeln(" Data sizes differ:")\\n1197.             self._writeln(f"  a: {self.diff_dimensions[0]} bytes")\\n1198.             self._writeln(f"  b: {self.diff_dimensions[1]} bytes")\\n1199.             # For now we don\\\'t do any further comparison if the dimensions\\n1200.             # differ; though in the future it might be nice to be able to\\n1201.             # compare at least where the images intersect\\n1202.             self._writeln(" No further data comparison performed.")\\n1203.             return\\n1204. \\n1205.         if not self.diff_bytes:\\n1206.             return\\n1207. \\n1208.         for index, values in self.diff_bytes:\\n1209.             self._writeln(f" Data differs at byte {index}:")\\n1210.             report_diff_values(\\n1211.                 values[0],\\n1212.                 values[1],\\n1213.                 fileobj=self._fileobj,\\n1214.                 indent_width=self._indent + 1,\\n1215.                 rtol=self.rtol,\\n1216.                 atol=self.atol,\\n1217.             )\\n1218. \\n1219.         self._writeln(" ...")\\n1220.         self._writeln(\\n1221.             " {} different bytes found ({:.2%} different).".format(\\n1222.                 self.diff_total, self.diff_ratio\\n1223.             )\\n1224.         )\\n1225. \\n1226. \\n1227. class TableDataDiff(_BaseDiff):\\n1228.     """\\n1229.     Diff two table data arrays. It doesn\\\'t matter whether the data originally\\n1230.     came from a binary or ASCII table--the data should be passed in as a\\n1231.     recarray.\\n1232. \\n1233.     `TableDataDiff` objects have the following diff attributes:\\n1234. \\n1235.     - ``diff_column_count``: If the tables being compared have different\\n1236.       numbers of columns, this contains a 2-tuple of the column count in each\\n1237.       table.  Even if the tables have different column counts, an attempt is\\n1238.       still made to compare any columns they have in common.\\n1239. \\n1240.     - ``diff_columns``: If either table contains columns unique to that table,\\n1241.       either in name or format, this contains a 2-tuple of lists. The first\\n1242.       element is a list of columns (these are full `Column` objects) that\\n1243.       appear only in table a.  The second element is a list of tables that\\n1244.       appear only in table b.  This only lists columns with different column\\n1245.       definitions, and has nothing to do with the data in those columns.\\n1246. \\n1247.     - ``diff_column_names``: This is like ``diff_columns``, but lists only the\\n1248.       names of columns unique to either table, rather than the full `Column`\\n1249.       objects.\\n1250. \\n1251.     - ``diff_column_attributes``: Lists columns that are in both tables but\\n1252.       have different secondary attributes, such as TUNIT or TDISP.  The format\\n1253.       is a list of 2-tuples: The first a tuple of the column name and the\\n1254.       attribute, the second a tuple of the different values.\\n1255. \\n1256.     - ``diff_values``: `TableDataDiff` compares the data in each table on a\\n1257.       column-by-column basis.  If any different data is found, it is added to\\n1258.       this list.  The format of this list is similar to the ``diff_pixels``\\n1259.       attribute on `ImageDataDiff` objects, though the "index" consists of a\\n1260.       (column_name, row) tuple.  For example::\\n1261. \\n1262.           [(\\\'TARGET\\\', 0), (\\\'NGC1001\\\', \\\'NGC1002\\\')]\\n1263. \\n1264.       shows that the tables contain different values in the 0-th row of the\\n1265.       \\\'TARGET\\\' column.\\n1266. \\n1267.     - ``diff_total`` and ``diff_ratio``: Same as `ImageDataDiff`.\\n1268. \\n1269.     `TableDataDiff` objects also have a ``common_columns`` attribute that lists\\n1270.     the `Column` objects for columns that are identical in both tables, and a\\n1271.     ``common_column_names`` attribute which contains a set of the names of\\n1272.     those columns.\\n1273.     """\\n1274. \\n1275.     def __init__(self, a, b, ignore_fields=[], numdiffs=10, rtol=0.0, atol=0.0):\\n1276.         """\\n1277.         Parameters\\n1278.         ----------\\n1279.         a : BaseHDU\\n1280.             An HDU object.\\n1281. \\n1282.         b : BaseHDU\\n1283.             An HDU object to compare to the first HDU object.\\n1284. \\n1285.         ignore_fields : sequence, optional\\n1286.             The (case-insensitive) names of any table columns to ignore if any\\n1287.             table data is to be compared.\\n1288. \\n1289.         numdiffs : int, optional\\n1290.             The number of pixel/table values to output when reporting HDU data\\n1291.             differences.  Though the count of differences is the same either\\n1292.             way, this allows controlling the number of different values that\\n1293.             are kept in memory or output.  If a negative value is given, then\\n1294.             numdiffs is treated as unlimited (default: 10).\\n1295. \\n1296.         rtol : float, optional\\n1297.             The relative difference to allow when comparing two float values\\n1298.             either in header values, image arrays, or table columns\\n1299.             (default: 0.0). Values which satisfy the expression\\n1300. \\n1301.             .. math::\\n1302. \\n1303.                 \\\\\\\\left| a - b \\\\\\\\right| > \\\\\\\\text{atol} + \\\\\\\\text{rtol} \\\\\\\\cdot \\\\\\\\left| b \\\\\\\\right|\\n1304. \\n1305.             are considered to be different.\\n1306.             The underlying function used for comparison is `numpy.allclose`.\\n1307. \\n1308.             .. versionadded:: 2.0\\n1309. \\n1310.         atol : float, optional\\n1311.             The allowed absolute difference. See also ``rtol`` parameter.\\n1312. \\n1313.             .. versionadded:: 2.0\\n1314.         """\\n1315.         self.ignore_fields = set(ignore_fields)\\n1316.         self.numdiffs = numdiffs\\n1317.         self.rtol = rtol\\n1318.         self.atol = atol\\n1319. \\n1320.         self.common_columns = []\\n1321.         self.common_column_names = set()\\n1322. \\n1323.         # self.diff_columns contains columns with different column definitions,\\n1324.         # but not different column data. Column data is only compared in\\n1325.         # columns that have the same definitions\\n1326.         self.diff_rows = ()\\n1327.         self.diff_column_count = ()\\n1328.         self.diff_columns = ()\\n1329. \\n1330.         # If two columns have the same name+format, but other attributes are\\n1331.         # different (such as TUNIT or such) they are listed here\\n1332.         self.diff_column_attributes = []\\n1333. \\n1334.         # Like self.diff_columns, but just contains a list of the column names\\n1335.         # unique to each table, and in the order they appear in the tables\\n1336.         self.diff_column_names = ()\\n1337.         self.diff_values = []\\n1338. \\n1339.         self.diff_ratio = 0\\n1340.         self.diff_total = 0\\n1341. \\n1342.         super().__init__(a, b)\\n1343. \\n1344.     def _diff(self):\\n1345.         # Much of the code for comparing columns is similar to the code for\\n1346.         # comparing headers--consider refactoring\\n1347.         colsa = self.a.columns\\n1348.         colsb = self.b.columns\\n1349. \\n1350.         if len(colsa) != len(colsb):\\n1351.             self.diff_column_count = (len(colsa), len(colsb))\\n1352. \\n1353.         # Even if the number of columns are unequal, we still do comparison of\\n1354.         # any common columns\\n1355.         colsa = {c.name.lower(): c for c in colsa}\\n1356.         colsb = {c.name.lower(): c for c in colsb}\\n1357. \\n1358.         if "*" in self.ignore_fields:\\n1359.             # If all columns are to be ignored, ignore any further differences\\n1360.             # between the columns\\n1361.             return\\n1362. \\n1363.         # Keep the user\\\'s original ignore_fields list for reporting purposes,\\n1364.         # but internally use a case-insensitive version\\n1365.         ignore_fields = {f.lower() for f in self.ignore_fields}\\n1366. \\n1367.         # It might be nice if there were a cleaner way to do this, but for now\\n1368.         # it\\\'ll do\\n1369.         for fieldname in ignore_fields:\\n1370.             fieldname = fieldname.lower()\\n1371.             if fieldname in colsa:\\n1372.                 del colsa[fieldname]\\n1373.             if fieldname in colsb:\\n1374.                 del colsb[fieldname]\\n1375. \\n1376.         colsa_set = set(colsa.values())\\n1377.         colsb_set = set(colsb.values())\\n1378.         self.common_columns = sorted(\\n1379.             colsa_set.intersection(colsb_set), key=operator.attrgetter("name")\\n1380.         )\\n1381. \\n1382.         self.common_column_names = {col.name.lower() for col in self.common_columns}\\n1383. \\n1384.         left_only_columns = {\\n1385.             col.name.lower(): col for col in colsa_set.difference(colsb_set)\\n1386.         }\\n1387.         right_only_columns = {\\n1388.             col.name.lower(): col for col in colsb_set.difference(colsa_set)\\n1389.         }\\n1390. \\n1391.         if left_only_columns or right_only_columns:\\n1392.             self.diff_columns = (left_only_columns, right_only_columns)\\n1393.             self.diff_column_names = ([], [])\\n1394. \\n1395.         if left_only_columns:\\n1396.             for col in self.a.columns:\\n1397.                 if col.name.lower() in left_only_columns:\\n1398.                     self.diff_column_names[0].append(col.name)\\n1399. \\n1400.         if right_only_columns:\\n1401.             for col in self.b.columns:\\n1402.                 if col.name.lower() in right_only_columns:\\n1403.                     self.diff_column_names[1].append(col.name)\\n1404. \\n1405.         # If the tables have a different number of rows, we don\\\'t compare the\\n1406.         # columns right now.\\n1407.         # TODO: It might be nice to optionally compare the first n rows where n\\n1408.         # is the minimum of the row counts between the two tables.\\n1409.         if len(self.a) != len(self.b):\\n1410.             self.diff_rows = (len(self.a), len(self.b))\\n1411.             return\\n1412. \\n1413.         # If the tables contain no rows there\\\'s no data to compare, so we\\\'re\\n1414.         # done at this point. (See ticket #178)\\n1415.         if len(self.a) == len(self.b) == 0:\\n1416.             return\\n1417. \\n1418.         # Like in the old fitsdiff, compare tables on a column by column basis\\n1419.         # The difficulty here is that, while FITS column names are meant to be\\n1420.         # case-insensitive, Astropy still allows, for the sake of flexibility,\\n1421.         # two columns with the same name but different case.  When columns are\\n1422.         # accessed in FITS tables, a case-sensitive is tried first, and failing\\n1423.         # that a case-insensitive match is made.\\n1424.         # It\\\'s conceivable that the same column could appear in both tables\\n1425.         # being compared, but with different case.\\n1426.         # Though it *may* lead to inconsistencies in these rare cases, this\\n1427.         # just assumes that there are no duplicated column names in either\\n1428.         # table, and that the column names can be treated case-insensitively.\\n1429.         for col in self.common_columns:\\n1430.             name_lower = col.name.lower()\\n1431.             if name_lower in ignore_fields:\\n1432.                 continue\\n1433. \\n1434.             cola = colsa[name_lower]\\n1435.             colb = colsb[name_lower]\\n1436. \\n1437.             for attr, _ in _COL_ATTRS:\\n1438.                 vala = getattr(cola, attr, None)\\n1439.                 valb = getattr(colb, attr, None)\\n1440.                 if diff_values(vala, valb):\\n1441.                     self.diff_column_attributes.append(\\n1442.                         ((col.name.upper(), attr), (vala, valb))\\n1443.                     )\\n1444. \\n1445.             arra = self.a[col.name]\\n1446.             arrb = self.b[col.name]\\n1447. \\n1448.             if np.issubdtype(arra.dtype, np.floating) and np.issubdtype(\\n1449.                 arrb.dtype, np.floating\\n1450.             ):\\n1451.                 diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)\\n1452.             elif "P" in col.format:\\n1453.                 diffs = (\\n1454.                     [\\n1455.                         idx\\n1456.                         for idx in range(len(arra))\\n1457.                         if not np.allclose(\\n1458.                             arra[idx], arrb[idx], rtol=self.rtol, atol=self.atol\\n1459.                         )\\n1460.                     ],\\n1461.                 )\\n1462.             else:\\n1463.                 diffs = np.where(arra != arrb)\\n1464. \\n1465.             self.diff_total += len(set(diffs[0]))\\n1466. \\n1467.             if self.numdiffs >= 0:\\n1468.                 if len(self.diff_values) >= self.numdiffs:\\n1469.                     # Don\\\'t save any more diff values\\n1470.                     continue\\n1471. \\n1472.                 # Add no more diff\\\'d values than this\\n1473.                 max_diffs = self.numdiffs - len(self.diff_values)\\n1474.             else:\\n1475.                 max_diffs = len(diffs[0])\\n1476. \\n1477.             last_seen_idx = None\\n1478.             for idx in islice(diffs[0], 0, max_diffs):\\n1479.                 if idx == last_seen_idx:\\n1480.                     # Skip duplicate indices, which my occur when the column\\n1481.                     # data contains multi-dimensional values; we\\\'re only\\n1482.                     # interested in storing row-by-row differences\\n1483.                     continue\\n1484.                 last_seen_idx = idx\\n1485.                 self.diff_values.append(((col.name, idx), (arra[idx], arrb[idx])))\\n1486. \\n1487.         total_values = len(self.a) * len(self.a.dtype.fields)\\n1488.         self.diff_ratio = float(self.diff_total) / float(total_values)\\n1489. \\n1490.     def _report(self):\\n1491.         if self.diff_column_count:\\n1492.             self._writeln(" Tables have different number of columns:")\\n1493.             self._writeln(f"  a: {self.diff_column_count[0]}")\\n1494.             self._writeln(f"  b: {self.diff_column_count[1]}")\\n1495. \\n1496.         if self.diff_column_names:\\n1497.             # Show columns with names unique to either table\\n1498.             for name in self.diff_column_names[0]:\\n1499.                 format = self.diff_columns[0][name.lower()].format\\n1500.                 self._writeln(f" Extra column {name} of format {format} in a")\\n1501.             for name in self.diff_column_names[1]:\\n1502.                 format = self.diff_columns[1][name.lower()].format\\n1503.                 self._writeln(f" Extra column {name} of format {format} in b")\\n1504. \\n1505.         col_attrs = dict(_COL_ATTRS)\\n1506.         # Now go through each table again and show columns with common\\n1507.         # names but other property differences...\\n1508.         for col_attr, vals in self.diff_column_attributes:\\n1509.             name, attr = col_attr\\n1510.             self._writeln(f" Column {name} has different {col_attrs[attr]}:")\\n1511.             report_diff_values(\\n1512.                 vals[0],\\n1513.                 vals[1],\\n1514.                 fileobj=self._fileobj,\\n1515.                 indent_width=self._indent + 1,\\n1516.                 rtol=self.rtol,\\n1517.                 atol=self.atol,\\n1518.             )\\n1519. \\n1520.         if self.diff_rows:\\n1521.             self._writeln(" Table rows differ:")\\n1522.             self._writeln(f"  a: {self.diff_rows[0]}")\\n1523.             self._writeln(f"  b: {self.diff_rows[1]}")\\n1524.             self._writeln(" No further data comparison performed.")\\n1525.             return\\n1526. \\n1527.         if not self.diff_values:\\n1528.             return\\n1529. \\n1530.         # Finally, let\\\'s go through and report column data differences:\\n1531.         for indx, values in self.diff_values:\\n1532.             self._writeln(" Column {} data differs in row {}:".format(*indx))\\n1533.             report_diff_values(\\n1534.                 values[0],\\n1535.                 values[1],\\n1536.                 fileobj=self._fileobj,\\n1537.                 indent_width=self._indent + 1,\\n1538.                 rtol=self.rtol,\\n1539.                 atol=self.atol,\\n1540.             )\\n1541. \\n1542.         if self.diff_values and self.numdiffs < self.diff_total:\\n1543.             self._writeln(\\n1544.                 f" ...{self.diff_total - self.numdiffs} additional difference(s) found."\\n1545.             )\\n1546. \\n1547.         if self.diff_total > self.numdiffs:\\n1548.             self._writeln(" ...")\\n1549. \\n1550.         self._writeln(\\n1551.             " {} different table data element(s) found ({:.2%} different).".format(\\n1552.                 self.diff_total, self.diff_ratio\\n1553.             )\\n1554.         )\\n1555. \\n1556. \\n1557. def report_diff_keyword_attr(fileobj, attr, diffs, keyword, ind=0):\\n1558.     """\\n1559.     Write a diff between two header keyword values or comments to the specified\\n1560.     file-like object.\\n1561.     """\\n1562.     if keyword in diffs:\\n1563.         vals = diffs[keyword]\\n1564.         for idx, val in enumerate(vals):\\n1565.             if val is None:\\n1566.                 continue\\n1567.             if idx == 0:\\n1568.                 dup = ""\\n1569.             else:\\n1570.                 dup = f"[{idx + 1}]"\\n1571.             fileobj.write(\\n1572.                 fixed_width_indent(\\n1573.                     f" Keyword {keyword:8}{dup} has different {attr}:\\\\n",\\n1574.                     ind,\\n1575.                 )\\n1576.             )\\n1577.             report_diff_values(val[0], val[1], fileobj=fileobj, indent_width=ind + 1)\', \'start_line_number\': 1, \'end_line_number\': 1577}\n\n{\'relative_path\': \'astropy/io/fits/fitsrec.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see PYFITS.rst\\n2. \\n3. import copy\\n4. import operator\\n5. import warnings\\n6. import weakref\\n7. from contextlib import suppress\\n8. from functools import reduce\\n9. \\n10. import numpy as np\\n11. from numpy import char as chararray\\n12. \\n13. from astropy.utils import lazyproperty\\n14. \\n15. from .column import (\\n16.     _VLF,\\n17.     ASCII2NUMPY,\\n18.     ASCII2STR,\\n19.     ASCIITNULL,\\n20.     FITS2NUMPY,\\n21.     ColDefs,\\n22.     Delayed,\\n23.     _AsciiColDefs,\\n24.     _FormatP,\\n25.     _FormatX,\\n26.     _get_index,\\n27.     _makep,\\n28.     _unwrapx,\\n29.     _wrapx,\\n30. )\\n31. from .util import _rstrip_inplace, decode_ascii, encode_ascii\\n32. \\n33. \\n34. class FITS_record:\\n35.     """\\n36.     FITS record class.\\n37. \\n38.     `FITS_record` is used to access records of the `FITS_rec` object.\\n39.     This will allow us to deal with scaled columns.  It also handles\\n40.     conversion/scaling of columns in ASCII tables.  The `FITS_record`\\n41.     class expects a `FITS_rec` object as input.\\n42.     """\\n43. \\n44.     def __init__(\\n45.         self, input, row=0, start=None, end=None, step=None, base=None, **kwargs\\n46.     ):\\n47.         """\\n48.         Parameters\\n49.         ----------\\n50.         input : array\\n51.             The array to wrap.\\n52.         row : int, optional\\n53.             The starting logical row of the array.\\n54.         start : int, optional\\n55.             The starting column in the row associated with this object.\\n56.             Used for subsetting the columns of the `FITS_rec` object.\\n57.         end : int, optional\\n58.             The ending column in the row associated with this object.\\n59.             Used for subsetting the columns of the `FITS_rec` object.\\n60.         """\\n61.         self.array = input\\n62.         self.row = row\\n63.         if base:\\n64.             width = len(base)\\n65.         else:\\n66.             width = self.array._nfields\\n67. \\n68.         s = slice(start, end, step).indices(width)\\n69.         self.start, self.end, self.step = s\\n70.         self.base = base\\n71. \\n72.     def __getitem__(self, key):\\n73.         if isinstance(key, str):\\n74.             indx = _get_index(self.array.names, key)\\n75. \\n76.             if indx < self.start or indx > self.end - 1:\\n77.                 raise KeyError(f"Key \\\'{key}\\\' does not exist.")\\n78.         elif isinstance(key, slice):\\n79.             return type(self)(self.array, self.row, key.start, key.stop, key.step, self)\\n80.         else:\\n81.             indx = self._get_index(key)\\n82. \\n83.             if indx > self.array._nfields - 1:\\n84.                 raise IndexError("Index out of bounds")\\n85. \\n86.         return self.array.field(indx)[self.row]\\n87. \\n88.     def __setitem__(self, key, value):\\n89.         if isinstance(key, str):\\n90.             indx = _get_index(self.array.names, key)\\n91. \\n92.             if indx < self.start or indx > self.end - 1:\\n93.                 raise KeyError(f"Key \\\'{key}\\\' does not exist.")\\n94.         elif isinstance(key, slice):\\n95.             for indx in range(slice.start, slice.stop, slice.step):\\n96.                 indx = self._get_indx(indx)\\n97.                 self.array.field(indx)[self.row] = value\\n98.         else:\\n99.             indx = self._get_index(key)\\n100.             if indx > self.array._nfields - 1:\\n101.                 raise IndexError("Index out of bounds")\\n102. \\n103.         self.array.field(indx)[self.row] = value\\n104. \\n105.     def __len__(self):\\n106.         return len(range(self.start, self.end, self.step))\\n107. \\n108.     def __repr__(self):\\n109.         """\\n110.         Display a single row.\\n111.         """\\n112.         outlist = []\\n113.         for idx in range(len(self)):\\n114.             outlist.append(repr(self[idx]))\\n115.         return f"({\\\', \\\'.join(outlist)})"\\n116. \\n117.     def field(self, field):\\n118.         """\\n119.         Get the field data of the record.\\n120.         """\\n121.         return self.__getitem__(field)\\n122. \\n123.     def setfield(self, field, value):\\n124.         """\\n125.         Set the field data of the record.\\n126.         """\\n127.         self.__setitem__(field, value)\\n128. \\n129.     @lazyproperty\\n130.     def _bases(self):\\n131.         bases = [weakref.proxy(self)]\\n132.         base = self.base\\n133.         while base:\\n134.             bases.append(base)\\n135.             base = base.base\\n136.         return bases\\n137. \\n138.     def _get_index(self, indx):\\n139.         indices = np.ogrid[: self.array._nfields]\\n140.         for base in reversed(self._bases):\\n141.             if base.step < 1:\\n142.                 s = slice(base.start, None, base.step)\\n143.             else:\\n144.                 s = slice(base.start, base.end, base.step)\\n145.             indices = indices[s]\\n146.         return indices[indx]\\n147. \\n148. \\n149. class FITS_rec(np.recarray):\\n150.     """\\n151.     FITS record array class.\\n152. \\n153.     `FITS_rec` is the data part of a table HDU\\\'s data part.  This is a layer\\n154.     over the `~numpy.recarray`, so we can deal with scaled columns.\\n155. \\n156.     It inherits all of the standard methods from `numpy.ndarray`.\\n157.     """\\n158. \\n159.     _record_type = FITS_record\\n160.     _character_as_bytes = False\\n161.     _load_variable_length_data = True\\n162. \\n163.     def __new__(subtype, input):\\n164.         """\\n165.         Construct a FITS record array from a recarray.\\n166.         """\\n167.         # input should be a record array\\n168.         if input.dtype.subdtype is None:\\n169.             self = np.recarray.__new__(\\n170.                 subtype, input.shape, input.dtype, buf=input.data\\n171.             )\\n172.         else:\\n173.             self = np.recarray.__new__(\\n174.                 subtype, input.shape, input.dtype, buf=input.data, strides=input.strides\\n175.             )\\n176. \\n177.         self._init()\\n178.         if self.dtype.fields:\\n179.             self._nfields = len(self.dtype.fields)\\n180. \\n181.         return self\\n182. \\n183.     def __setstate__(self, state):\\n184.         meta = state[-1]\\n185.         column_state = state[-2]\\n186.         state = state[:-2]\\n187. \\n188.         super().__setstate__(state)\\n189. \\n190.         self._col_weakrefs = weakref.WeakSet()\\n191. \\n192.         for attr, value in zip(meta, column_state):\\n193.             setattr(self, attr, value)\\n194. \\n195.     def __reduce__(self):\\n196.         """\\n197.         Return a 3-tuple for pickling a FITS_rec. Use the super-class\\n198.         functionality but then add in a tuple of FITS_rec-specific\\n199.         values that get used in __setstate__.\\n200.         """\\n201.         reconst_func, reconst_func_args, state = super().__reduce__()\\n202. \\n203.         # Define FITS_rec-specific attrs that get added to state\\n204.         column_state = []\\n205.         meta = []\\n206. \\n207.         for attrs in [\\n208.             "_converted",\\n209.             "_heapoffset",\\n210.             "_heapsize",\\n211.             "_nfields",\\n212.             "_gap",\\n213.             "_uint",\\n214.             "parnames",\\n215.             "_coldefs",\\n216.         ]:\\n217.             with suppress(AttributeError):\\n218.                 # _coldefs can be Delayed, and file objects cannot be\\n219.                 # picked, it needs to be deepcopied first\\n220.                 if attrs == "_coldefs":\\n221.                     column_state.append(self._coldefs.__deepcopy__(None))\\n222.                 else:\\n223.                     column_state.append(getattr(self, attrs))\\n224.                 meta.append(attrs)\\n225. \\n226.         state = state + (column_state, meta)\\n227. \\n228.         return reconst_func, reconst_func_args, state\\n229. \\n230.     def __array_finalize__(self, obj):\\n231.         if obj is None:\\n232.             return\\n233. \\n234.         if isinstance(obj, FITS_rec):\\n235.             self._character_as_bytes = obj._character_as_bytes\\n236. \\n237.         if isinstance(obj, FITS_rec) and obj.dtype == self.dtype:\\n238.             self._converted = obj._converted\\n239.             self._heapoffset = obj._heapoffset\\n240.             self._heapsize = obj._heapsize\\n241.             self._col_weakrefs = obj._col_weakrefs\\n242.             self._coldefs = obj._coldefs\\n243.             self._nfields = obj._nfields\\n244.             self._gap = obj._gap\\n245.             self._uint = obj._uint\\n246.         elif self.dtype.fields is not None:\\n247.             # This will allow regular ndarrays with fields, rather than\\n248.             # just other FITS_rec objects\\n249.             self._nfields = len(self.dtype.fields)\\n250.             self._converted = {}\\n251. \\n252.             self._heapoffset = getattr(obj, "_heapoffset", 0)\\n253.             self._heapsize = getattr(obj, "_heapsize", 0)\\n254. \\n255.             self._gap = getattr(obj, "_gap", 0)\\n256.             self._uint = getattr(obj, "_uint", False)\\n257.             self._col_weakrefs = weakref.WeakSet()\\n258.             self._coldefs = ColDefs(self)\\n259. \\n260.             # Work around chicken-egg problem.  Column.array relies on the\\n261.             # _coldefs attribute to set up ref back to parent FITS_rec; however\\n262.             # in the above line the self._coldefs has not been assigned yet so\\n263.             # this fails.  This patches that up...\\n264.             for col in self._coldefs:\\n265.                 del col.array\\n266.                 col._parent_fits_rec = weakref.ref(self)\\n267.         else:\\n268.             self._init()\\n269. \\n270.     def _init(self):\\n271.         """Initializes internal attributes specific to FITS-isms."""\\n272.         self._nfields = 0\\n273.         self._converted = {}\\n274.         self._heapoffset = 0\\n275.         self._heapsize = 0\\n276.         self._col_weakrefs = weakref.WeakSet()\\n277.         self._coldefs = None\\n278.         self._gap = 0\\n279.         self._uint = False\\n280. \\n281.     @classmethod\\n282.     def from_columns(cls, columns, nrows=0, fill=False, character_as_bytes=False):\\n283.         """\\n284.         Given a `ColDefs` object of unknown origin, initialize a new `FITS_rec`\\n285.         object.\\n286. \\n287.         .. note::\\n288. \\n289.             This was originally part of the ``new_table`` function in the table\\n290.             module but was moved into a class method since most of its\\n291.             functionality always had more to do with initializing a `FITS_rec`\\n292.             object than anything else, and much of it also overlapped with\\n293.             ``FITS_rec._scale_back``.\\n294. \\n295.         Parameters\\n296.         ----------\\n297.         columns : sequence of `Column` or a `ColDefs`\\n298.             The columns from which to create the table data.  If these\\n299.             columns have data arrays attached that data may be used in\\n300.             initializing the new table.  Otherwise the input columns\\n301.             will be used as a template for a new table with the requested\\n302.             number of rows.\\n303. \\n304.         nrows : int\\n305.             Number of rows in the new table.  If the input columns have data\\n306.             associated with them, the size of the largest input column is used.\\n307.             Otherwise the default is 0.\\n308. \\n309.         fill : bool\\n310.             If `True`, will fill all cells with zeros or blanks.  If\\n311.             `False`, copy the data from input, undefined cells will still\\n312.             be filled with zeros/blanks.\\n313.         """\\n314.         if not isinstance(columns, ColDefs):\\n315.             columns = ColDefs(columns)\\n316. \\n317.         # read the delayed data\\n318.         for column in columns:\\n319.             arr = column.array\\n320.             if isinstance(arr, Delayed):\\n321.                 if arr.hdu.data is None:\\n322.                     column.array = None\\n323.                 else:\\n324.                     column.array = _get_recarray_field(arr.hdu.data, arr.field)\\n325.         # Reset columns._arrays (which we may want to just do away with\\n326.         # altogether\\n327.         del columns._arrays\\n328. \\n329.         # use the largest column shape as the shape of the record\\n330.         if nrows == 0:\\n331.             for arr in columns._arrays:\\n332.                 if arr is not None:\\n333.                     dim = arr.shape[0]\\n334.                 else:\\n335.                     dim = 0\\n336.                 if dim > nrows:\\n337.                     nrows = dim\\n338. \\n339.         raw_data = np.empty(columns.dtype.itemsize * nrows, dtype=np.uint8)\\n340.         raw_data.fill(ord(columns._padding_byte))\\n341.         data = np.recarray(nrows, dtype=columns.dtype, buf=raw_data).view(cls)\\n342.         data._character_as_bytes = character_as_bytes\\n343. \\n344.         # Previously this assignment was made from hdu.columns, but that\\\'s a\\n345.         # bug since if a _TableBaseHDU has a FITS_rec in its .data attribute\\n346.         # the _TableBaseHDU.columns property is actually returned from\\n347.         # .data._coldefs, so this assignment was circular!  Don\\\'t make that\\n348.         # mistake again.\\n349.         # All of this is an artifact of the fragility of the FITS_rec class,\\n350.         # and that it can\\\'t just be initialized by columns...\\n351.         data._coldefs = columns\\n352. \\n353.         # If fill is True we don\\\'t copy anything from the column arrays.  We\\\'re\\n354.         # just using them as a template, and returning a table filled with\\n355.         # zeros/blanks\\n356.         if fill:\\n357.             return data\\n358. \\n359.         # Otherwise we have to fill the recarray with data from the input\\n360.         # columns\\n361.         for idx, column in enumerate(columns):\\n362.             # For each column in the ColDef object, determine the number of\\n363.             # rows in that column.  This will be either the number of rows in\\n364.             # the ndarray associated with the column, or the number of rows\\n365.             # given in the call to this function, which ever is smaller.  If\\n366.             # the input FILL argument is true, the number of rows is set to\\n367.             # zero so that no data is copied from the original input data.\\n368.             arr = column.array\\n369. \\n370.             if arr is None:\\n371.                 array_size = 0\\n372.             else:\\n373.                 array_size = len(arr)\\n374. \\n375.             n = min(array_size, nrows)\\n376. \\n377.             # TODO: At least *some* of this logic is mostly redundant with the\\n378.             # _convert_foo methods in this class; see if we can eliminate some\\n379.             # of that duplication.\\n380. \\n381.             if not n:\\n382.                 # The input column had an empty array, so just use the fill\\n383.                 # value\\n384.                 continue\\n385. \\n386.             field = _get_recarray_field(data, idx)\\n387.             name = column.name\\n388.             fitsformat = column.format\\n389.             recformat = fitsformat.recformat\\n390. \\n391.             outarr = field[:n]\\n392.             inarr = arr[:n]\\n393. \\n394.             if isinstance(recformat, _FormatX):\\n395.                 # Data is a bit array\\n396.                 if inarr.shape[-1] == recformat.repeat:\\n397.                     _wrapx(inarr, outarr, recformat.repeat)\\n398.                     continue\\n399.             elif isinstance(recformat, _FormatP):\\n400.                 data._cache_field(name, _makep(inarr, field, recformat, nrows=nrows))\\n401.                 continue\\n402.             # TODO: Find a better way of determining that the column is meant\\n403.             # to be FITS L formatted\\n404.             elif recformat[-2:] == FITS2NUMPY["L"] and inarr.dtype == bool:\\n405.                 # column is boolean\\n406.                 # The raw data field should be filled with either \\\'T\\\' or \\\'F\\\'\\n407.                 # (not 0).  Use \\\'F\\\' as a default\\n408.                 field[:] = ord("F")\\n409.                 # Also save the original boolean array in data._converted so\\n410.                 # that it doesn\\\'t have to be re-converted\\n411.                 converted = np.zeros(field.shape, dtype=bool)\\n412.                 converted[:n] = inarr\\n413.                 data._cache_field(name, converted)\\n414.                 # TODO: Maybe this step isn\\\'t necessary at all if _scale_back\\n415.                 # will handle it?\\n416.                 inarr = np.where(inarr == np.False_, ord("F"), ord("T"))\\n417.             elif columns[idx]._physical_values and columns[idx]._pseudo_unsigned_ints:\\n418.                 # Temporary hack...\\n419.                 bzero = column.bzero\\n420.                 converted = np.zeros(field.shape, dtype=inarr.dtype)\\n421.                 converted[:n] = inarr\\n422.                 data._cache_field(name, converted)\\n423.                 if n < nrows:\\n424.                     # Pre-scale rows below the input data\\n425.                     field[n:] = -bzero\\n426. \\n427.                 inarr = inarr - bzero\\n428.             elif isinstance(columns, _AsciiColDefs):\\n429.                 # Regardless whether the format is character or numeric, if the\\n430.                 # input array contains characters then it\\\'s already in the raw\\n431.                 # format for ASCII tables\\n432.                 if fitsformat._pseudo_logical:\\n433.                     # Hack to support converting from 8-bit T/F characters\\n434.                     # Normally the column array is a chararray of 1 character\\n435.                     # strings, but we need to view it as a normal ndarray of\\n436.                     # 8-bit ints to fill it with ASCII codes for \\\'T\\\' and \\\'F\\\'\\n437.                     outarr = field.view(np.uint8, np.ndarray)[:n]\\n438.                 elif arr.dtype.kind not in ("S", "U"):\\n439.                     # Set up views of numeric columns with the appropriate\\n440.                     # numeric dtype\\n441.                     # Fill with the appropriate blanks for the column format\\n442.                     data._cache_field(name, np.zeros(nrows, dtype=arr.dtype))\\n443.                     outarr = data._converted[name][:n]\\n444. \\n445.                 outarr[:] = inarr\\n446.                 continue\\n447. \\n448.             if inarr.shape != outarr.shape:\\n449.                 if (\\n450.                     inarr.dtype.kind == outarr.dtype.kind\\n451.                     and inarr.dtype.kind in ("U", "S")\\n452.                     and inarr.dtype != outarr.dtype\\n453.                 ):\\n454.                     inarr_rowsize = inarr[0].size\\n455.                     inarr = inarr.flatten().view(outarr.dtype)\\n456. \\n457.                 # This is a special case to handle input arrays with\\n458.                 # non-trivial TDIMn.\\n459.                 # By design each row of the outarray is 1-D, while each row of\\n460.                 # the input array may be n-D\\n461.                 if outarr.ndim > 1:\\n462.                     # The normal case where the first dimension is the rows\\n463.                     inarr_rowsize = inarr[0].size\\n464.                     inarr = inarr.reshape(n, inarr_rowsize)\\n465.                     outarr[:, :inarr_rowsize] = inarr\\n466.                 else:\\n467.                     # Special case for strings where the out array only has one\\n468.                     # dimension (the second dimension is rolled up into the\\n469.                     # strings\\n470.                     outarr[:n] = inarr.ravel()\\n471.             else:\\n472.                 outarr[:] = inarr\\n473. \\n474.         # Now replace the original column array references with the new\\n475.         # fields\\n476.         # This is required to prevent the issue reported in\\n477.         # https://github.com/spacetelescope/PyFITS/issues/99\\n478.         for idx in range(len(columns)):\\n479.             columns._arrays[idx] = data.field(idx)\\n480. \\n481.         return data\\n482. \\n483.     def __repr__(self):\\n484.         # Force use of the normal ndarray repr (rather than the new\\n485.         # one added for recarray in Numpy 1.10) for backwards compat\\n486.         return np.ndarray.__repr__(self)\\n487. \\n488.     def __getattribute__(self, attr):\\n489.         # First, see if ndarray has this attr, and return it if so. Note that\\n490.         # this means a field with the same name as an ndarray attr cannot be\\n491.         # accessed by attribute, this is Numpy\\\'s default behavior.\\n492.         # We avoid using np.recarray.__getattribute__ here because after doing\\n493.         # this check it would access the columns without doing the conversions\\n494.         # that we need (with .field, see below).\\n495.         try:\\n496.             return object.__getattribute__(self, attr)\\n497.         except AttributeError:\\n498.             pass\\n499. \\n500.         # attr might still be a fieldname.  If we have column definitions,\', \'start_line_number\': 1, \'end_line_number\': 500}\n\nTest Case Context (similar existing tests for reference):\n{\'relative_path\': \'astropy/io/fits/tests/test_diff.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. import numpy as np\\n3. import pytest\\n4. \\n5. from astropy.io import fits\\n6. from astropy.io.fits.column import Column\\n7. from astropy.io.fits.diff import (\\n8.     FITSDiff,\\n9.     HDUDiff,\\n10.     HeaderDiff,\\n11.     ImageDataDiff,\\n12.     TableDataDiff,\\n13. )\\n14. from astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU\\n15. from astropy.io.fits.hdu.base import NonstandardExtHDU\\n16. from astropy.io.fits.hdu.table import BinTableHDU\\n17. from astropy.io.fits.header import Header\\n18. from astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH\\n19. \\n20. from .conftest import FitsTestCase\\n21. \\n22. \\n23. class DummyNonstandardExtHDU(NonstandardExtHDU):\\n24.     def __init__(self, data=None, *args, **kwargs):\\n25.         super().__init__(self, *args, **kwargs)\\n26.         self._buffer = np.asarray(data).tobytes()\\n27.         self._data_offset = 0\\n28. \\n29.     @property\\n30.     def size(self):\\n31.         return len(self._buffer)\\n32. \\n33. \\n34. class TestDiff(FitsTestCase):\\n35.     def test_identical_headers(self):\\n36.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n37.         hb = ha.copy()\\n38.         assert HeaderDiff(ha, hb).identical\\n39.         assert HeaderDiff(ha.tostring(), hb.tostring()).identical\\n40. \\n41.         with pytest.raises(TypeError):\\n42.             HeaderDiff(1, 2)\\n43. \\n44.     def test_slightly_different_headers(self):\\n45.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n46.         hb = ha.copy()\\n47.         hb["C"] = 4\\n48.         assert not HeaderDiff(ha, hb).identical\\n49. \\n50.     def test_common_keywords(self):\\n51.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n52.         hb = ha.copy()\\n53.         hb["C"] = 4\\n54.         hb["D"] = (5, "Comment")\\n55.         assert HeaderDiff(ha, hb).common_keywords == ["A", "B", "C"]\\n56. \\n57.     def test_different_keyword_count(self):\\n58.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n59.         hb = ha.copy()\\n60.         del hb["B"]\\n61.         diff = HeaderDiff(ha, hb)\\n62.         assert not diff.identical\\n63.         assert diff.diff_keyword_count == (3, 2)\\n64. \\n65.         # But make sure the common keywords are at least correct\\n66.         assert diff.common_keywords == ["A", "C"]\\n67. \\n68.     def test_different_keywords(self):\\n69.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n70.         hb = ha.copy()\\n71.         hb["C"] = 4\\n72.         hb["D"] = (5, "Comment")\\n73.         ha["E"] = (6, "Comment")\\n74.         ha["F"] = (7, "Comment")\\n75.         diff = HeaderDiff(ha, hb)\\n76.         assert not diff.identical\\n77.         assert diff.diff_keywords == (["E", "F"], ["D"])\\n78. \\n79.     def test_different_keyword_values(self):\\n80.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n81.         hb = ha.copy()\\n82.         hb["C"] = 4\\n83.         diff = HeaderDiff(ha, hb)\\n84.         assert not diff.identical\\n85.         assert diff.diff_keyword_values == {"C": [(3, 4)]}\\n86. \\n87.     def test_different_keyword_comments(self):\\n88.         ha = Header([("A", 1), ("B", 2), ("C", 3, "comment 1")])\\n89.         hb = ha.copy()\\n90.         hb.comments["C"] = "comment 2"\\n91.         diff = HeaderDiff(ha, hb)\\n92.         assert not diff.identical\\n93.         assert diff.diff_keyword_comments == {"C": [("comment 1", "comment 2")]}\\n94. \\n95.     def test_different_keyword_values_with_duplicate(self):\\n96.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n97.         hb = ha.copy()\\n98.         ha.append(("C", 4))\\n99.         hb.append(("C", 5))\\n100.         diff = HeaderDiff(ha, hb)\\n101.         assert not diff.identical\\n102.         assert diff.diff_keyword_values == {"C": [None, (4, 5)]}\\n103. \\n104.     def test_asymmetric_duplicate_keywords(self):\\n105.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n106.         hb = ha.copy()\\n107.         ha.append(("A", 2, "comment 1"))\\n108.         ha.append(("A", 3, "comment 2"))\\n109.         hb.append(("B", 4, "comment 3"))\\n110.         hb.append(("C", 5, "comment 4"))\\n111.         diff = HeaderDiff(ha, hb)\\n112.         assert not diff.identical\\n113.         assert diff.diff_keyword_values == {}\\n114.         assert diff.diff_duplicate_keywords == {"A": (3, 1), "B": (1, 2), "C": (1, 2)}\\n115. \\n116.         report = diff.report()\\n117.         assert (\\n118.             "Inconsistent duplicates of keyword \\\'A\\\'     :\\\\n"\\n119.             "  Occurs 3 time(s) in a, 1 times in (b)" in report\\n120.         )\\n121. \\n122.     def test_floating_point_rtol(self):\\n123.         ha = Header([("A", 1), ("B", 2.00001), ("C", 3.000001)])\\n124.         hb = ha.copy()\\n125.         hb["B"] = 2.00002\\n126.         hb["C"] = 3.000002\\n127.         diff = HeaderDiff(ha, hb)\\n128.         assert not diff.identical\\n129.         assert diff.diff_keyword_values == {\\n130.             "B": [(2.00001, 2.00002)],\\n131.             "C": [(3.000001, 3.000002)],\\n132.         }\\n133.         diff = HeaderDiff(ha, hb, rtol=1e-6)\\n134.         assert not diff.identical\\n135.         assert diff.diff_keyword_values == {"B": [(2.00001, 2.00002)]}\\n136.         diff = HeaderDiff(ha, hb, rtol=1e-5)\\n137.         assert diff.identical\\n138. \\n139.     def test_floating_point_atol(self):\\n140.         ha = Header([("A", 1), ("B", 1.0), ("C", 0.0)])\\n141.         hb = ha.copy()\\n142.         hb["B"] = 1.00001\\n143.         hb["C"] = 0.000001\\n144.         diff = HeaderDiff(ha, hb, rtol=1e-6)\\n145.         assert not diff.identical\\n146.         assert diff.diff_keyword_values == {\\n147.             "B": [(1.0, 1.00001)],\\n148.             "C": [(0.0, 0.000001)],\\n149.         }\\n150.         diff = HeaderDiff(ha, hb, rtol=1e-5)\\n151.         assert not diff.identical\\n152.         assert diff.diff_keyword_values == {"C": [(0.0, 0.000001)]}\\n153.         diff = HeaderDiff(ha, hb, atol=1e-6)\\n154.         assert not diff.identical\\n155.         assert diff.diff_keyword_values == {"B": [(1.0, 1.00001)]}\\n156.         diff = HeaderDiff(ha, hb, atol=1e-5)  # strict inequality\\n157.         assert not diff.identical\\n158.         assert diff.diff_keyword_values == {"B": [(1.0, 1.00001)]}\\n159.         diff = HeaderDiff(ha, hb, rtol=1e-5, atol=1e-5)\\n160.         assert diff.identical\\n161.         diff = HeaderDiff(ha, hb, atol=1.1e-5)\\n162.         assert diff.identical\\n163.         diff = HeaderDiff(ha, hb, rtol=1e-6, atol=1e-6)\\n164.         assert not diff.identical\\n165. \\n166.     def test_ignore_blanks(self):\\n167.         with fits.conf.set_temp("strip_header_whitespace", False):\\n168.             ha = Header([("A", 1), ("B", 2), ("C", "A       ")])\\n169.             hb = ha.copy()\\n170.             hb["C"] = "A"\\n171.             assert ha["C"] != hb["C"]\\n172. \\n173.             diff = HeaderDiff(ha, hb)\\n174.             # Trailing blanks are ignored by default\\n175.             assert diff.identical\\n176.             assert diff.diff_keyword_values == {}\\n177. \\n178.             # Don\\\'t ignore blanks\\n179.             diff = HeaderDiff(ha, hb, ignore_blanks=False)\\n180.             assert not diff.identical\\n181.             assert diff.diff_keyword_values == {"C": [("A       ", "A")]}\\n182. \\n183.     @pytest.mark.parametrize("differ", [HeaderDiff, HDUDiff, FITSDiff])\\n184.     def test_ignore_blank_cards(self, differ):\\n185.         """Test for https://aeon.stsci.edu/ssb/trac/pyfits/ticket/152\\n186. \\n187.         Ignore blank cards.\\n188.         """\\n189. \\n190.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n191.         hb = Header([("A", 1), ("", ""), ("B", 2), ("", ""), ("C", 3)])\\n192.         hc = ha.copy()\\n193.         if differ is HeaderDiff:\\n194.             hc.append()\\n195.             hc.append()\\n196.         else:  # Ensure blanks are not at the end as they are stripped by HDUs\\n197.             hc.add_blank(after=-2)\\n198.             hc.add_blank(after=-2)\\n199. \\n200.         if differ in (HDUDiff, FITSDiff):  # wrap it in a PrimaryHDU\\n201.             ha, hb, hc = (PrimaryHDU(np.arange(10), h) for h in (ha, hb, hc))\\n202.             hc_header = hc.header\\n203.         if differ is FITSDiff:  # wrap it in a HDUList\\n204.             ha, hb, hc = (HDUList([h]) for h in (ha, hb, hc))\\n205.             hc_header = hc[0].header\\n206. \\n207.         # We now have a header with interleaved blanks, and a header with end\\n208.         # blanks, both of which should ignore the blanks\\n209.         assert differ(ha, hb).identical\\n210.         assert differ(ha, hc).identical\\n211.         assert differ(hb, hc).identical\\n212. \\n213.         assert not differ(ha, hb, ignore_blank_cards=False).identical\\n214.         assert not differ(ha, hc, ignore_blank_cards=False).identical\\n215. \\n216.         # Both hb and hc have the same number of blank cards; since order is\\n217.         # currently ignored, these should still be identical even if blank\\n218.         # cards are not ignored\\n219.         assert differ(hb, hc, ignore_blank_cards=False).identical\\n220. \\n221.         if differ is HeaderDiff:\\n222.             hc.append()\\n223.         else:  # Ensure blanks are not at the end as they are stripped by HDUs\\n224.             hc_header.add_blank(after=-2)\\n225.         # But now there are different numbers of blanks, so they should not be\\n226.         # ignored:\\n227.         assert not differ(hb, hc, ignore_blank_cards=False).identical\\n228. \\n229.     def test_ignore_hdus(self):\\n230.         a = np.arange(100).reshape(10, 10)\\n231.         b = a.copy()\\n232.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n233.         xa = np.array([(1.0, 1), (3.0, 4)], dtype=[("x", float), ("y", int)])\\n234.         xb = np.array([(1.0, 2), (3.0, 5)], dtype=[("x", float), ("y", int)])\\n235.         phdu = PrimaryHDU(header=ha)\\n236.         ihdua = ImageHDU(data=a, name="SCI")\\n237.         ihdub = ImageHDU(data=b, name="SCI")\\n238.         bhdu1 = BinTableHDU(data=xa, name="ASDF")\\n239.         bhdu2 = BinTableHDU(data=xb, name="ASDF")\\n240.         hdula = HDUList([phdu, ihdua, bhdu1])\\n241.         hdulb = HDUList([phdu, ihdub, bhdu2])\\n242. \\n243.         # ASDF extension should be different\\n244.         diff = FITSDiff(hdula, hdulb)\\n245.         assert not diff.identical\\n246.         assert diff.diff_hdus[0][0] == 2\\n247. \\n248.         # ASDF extension should be ignored\\n249.         diff = FITSDiff(hdula, hdulb, ignore_hdus=["ASDF"])\\n250.         assert diff.identical, diff.report()\\n251. \\n252.         diff = FITSDiff(hdula, hdulb, ignore_hdus=["ASD*"])\\n253.         assert diff.identical, diff.report()\\n254. \\n255.         # SCI extension should be different\\n256.         hdulb["SCI"].data += 1\\n257.         diff = FITSDiff(hdula, hdulb, ignore_hdus=["ASDF"])\\n258.         assert not diff.identical\\n259. \\n260.         # SCI and ASDF extensions should be ignored\\n261.         diff = FITSDiff(hdula, hdulb, ignore_hdus=["SCI", "ASDF"])\\n262.         assert diff.identical, diff.report()\\n263. \\n264.         # All EXTVER of SCI should be ignored\\n265.         ihduc = ImageHDU(data=a, name="SCI", ver=2)\\n266.         hdulb.append(ihduc)\\n267.         diff = FITSDiff(hdula, hdulb, ignore_hdus=["SCI", "ASDF"])\\n268.         assert not any(diff.diff_hdus), diff.report()\\n269.         assert any(diff.diff_hdu_count), diff.report()\\n270. \\n271.     def test_ignore_keyword_values(self):\\n272.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n273.         hb = ha.copy()\\n274.         hb["B"] = 4\\n275.         hb["C"] = 5\\n276.         diff = HeaderDiff(ha, hb, ignore_keywords=["*"])\\n277.         assert diff.identical\\n278.         diff = HeaderDiff(ha, hb, ignore_keywords=["B"])\\n279.         assert not diff.identical\\n280.         assert diff.diff_keyword_values == {"C": [(3, 5)]}\\n281. \\n282.         report = diff.report()\\n283.         assert "Keyword B        has different values" not in report\\n284.         assert "Keyword C        has different values" in report\\n285. \\n286.         # Test case-insensitivity\\n287.         diff = HeaderDiff(ha, hb, ignore_keywords=["b"])\\n288.         assert not diff.identical\\n289.         assert diff.diff_keyword_values == {"C": [(3, 5)]}\\n290. \\n291.     def test_ignore_keyword_comments(self):\\n292.         ha = Header([("A", 1, "A"), ("B", 2, "B"), ("C", 3, "C")])\\n293.         hb = ha.copy()\\n294.         hb.comments["B"] = "D"\\n295.         hb.comments["C"] = "E"\\n296.         diff = HeaderDiff(ha, hb, ignore_comments=["*"])\\n297.         assert diff.identical\\n298.         diff = HeaderDiff(ha, hb, ignore_comments=["B"])\\n299.         assert not diff.identical\\n300.         assert diff.diff_keyword_comments == {"C": [("C", "E")]}\\n301. \\n302.         report = diff.report()\\n303.         assert "Keyword B        has different comments" not in report\\n304.         assert "Keyword C        has different comments" in report\\n305. \\n306.         # Test case-insensitivity\\n307.         diff = HeaderDiff(ha, hb, ignore_comments=["b"])\\n308.         assert not diff.identical\\n309.         assert diff.diff_keyword_comments == {"C": [("C", "E")]}\\n310. \\n311.     def test_trivial_identical_images(self):\\n312.         ia = np.arange(100).reshape(10, 10)\\n313.         ib = np.arange(100).reshape(10, 10)\\n314.         diff = ImageDataDiff(ia, ib)\\n315.         assert diff.identical\\n316.         assert diff.diff_total == 0\\n317. \\n318.     def test_identical_within_relative_tolerance(self):\\n319.         ia = np.ones((10, 10)) - 0.00001\\n320.         ib = np.ones((10, 10)) - 0.00002\\n321.         diff = ImageDataDiff(ia, ib, rtol=1.0e-4)\\n322.         assert diff.identical\\n323.         assert diff.diff_total == 0\\n324. \\n325.     def test_identical_within_absolute_tolerance(self):\\n326.         ia = np.zeros((10, 10)) - 0.00001\\n327.         ib = np.zeros((10, 10)) - 0.00002\\n328.         diff = ImageDataDiff(ia, ib, rtol=1.0e-4)\\n329.         assert not diff.identical\\n330.         assert diff.diff_total == 100\\n331.         diff = ImageDataDiff(ia, ib, atol=1.0e-4)\\n332.         assert diff.identical\\n333.         assert diff.diff_total == 0\\n334. \\n335.     def test_identical_within_rtol_and_atol(self):\\n336.         ia = np.zeros((10, 10)) - 0.00001\\n337.         ib = np.zeros((10, 10)) - 0.00002\\n338.         diff = ImageDataDiff(ia, ib, rtol=1.0e-5, atol=1.0e-5)\\n339.         assert diff.identical\\n340.         assert diff.diff_total == 0\\n341. \\n342.     def test_not_identical_within_rtol_and_atol(self):\\n343.         ia = np.zeros((10, 10)) - 0.00001\\n344.         ib = np.zeros((10, 10)) - 0.00002\\n345.         diff = ImageDataDiff(ia, ib, rtol=1.0e-5, atol=1.0e-6)\\n346.         assert not diff.identical\\n347.         assert diff.diff_total == 100\\n348. \\n349.     def test_identical_comp_image_hdus(self):\\n350.         """Regression test for https://aeon.stsci.edu/ssb/trac/pyfits/ticket/189\\n351. \\n352.         For this test we mostly just care that comparing to compressed images\\n353.         does not crash, and returns the correct results.  Two compressed images\\n354.         will be considered identical if the decompressed data is the same.\\n355.         Obviously we test whether or not the same compression was used by\\n356.         looking for (or ignoring) header differences.\\n357.         """\\n358. \\n359.         data = np.arange(100.0).reshape(10, 10)\\n360.         hdu = fits.CompImageHDU(data=data)\\n361.         hdu.writeto(self.temp("test.fits"))\\n362. \\n363.         with fits.open(self.temp("test.fits")) as hdula, fits.open(\\n364.             self.temp("test.fits")\\n365.         ) as hdulb:\\n366.             diff = FITSDiff(hdula, hdulb)\\n367.             assert diff.identical\\n368. \\n369.     def test_different_dimensions(self):\\n370.         ia = np.arange(100).reshape(10, 10)\\n371.         ib = np.arange(100) - 1\\n372. \\n373.         # Although ib could be reshaped into the same dimensions, for now the\\n374.         # data is not compared anyways\\n375.         diff = ImageDataDiff(ia, ib)\\n376.         assert not diff.identical\\n377.         assert diff.diff_dimensions == ((10, 10), (100,))\\n378.         assert diff.diff_total == 0\\n379. \\n380.         report = diff.report()\\n381.         assert "Data dimensions differ" in report\\n382.         assert "a: 10 x 10" in report\\n383.         assert "b: 100" in report\\n384.         assert "No further data comparison performed."\\n385. \\n386.     def test_different_pixels(self):\\n387.         ia = np.arange(100).reshape(10, 10)\\n388.         ib = np.arange(100).reshape(10, 10)\\n389.         ib[0, 0] = 10\\n390.         ib[5, 5] = 20\\n391.         diff = ImageDataDiff(ia, ib)\\n392.         assert not diff.identical\\n393.         assert diff.diff_dimensions == ()\\n394.         assert diff.diff_total == 2\\n395.         assert diff.diff_ratio == 0.02\\n396.         assert diff.diff_pixels == [((0, 0), (0, 10)), ((5, 5), (55, 20))]\\n397. \\n398.     def test_identical_tables(self):\\n399.         c1 = Column("A", format="L", array=[True, False])\\n400.         c2 = Column("B", format="X", array=[[0], [1]])\\n401.         c3 = Column("C", format="4I", dim="(2, 2)", array=[[0, 1, 2, 3], [4, 5, 6, 7]])\\n402.         c4 = Column("D", format="J", bscale=2.0, array=[0, 1])\\n403.         c5 = Column("E", format="A3", array=["abc", "def"])\\n404.         c6 = Column("F", format="E", unit="m", array=[0.0, 1.0])\\n405.         c7 = Column("G", format="D", bzero=-0.1, array=[0.0, 1.0])\\n406.         c8 = Column("H", format="C", array=[0.0 + 1.0j, 2.0 + 3.0j])\\n407.         c9 = Column("I", format="M", array=[4.0 + 5.0j, 6.0 + 7.0j])\\n408.         c10 = Column("J", format="PI(2)", array=[[0, 1], [2, 3]])\\n409. \\n410.         columns = [c1, c2, c3, c4, c5, c6, c7, c8, c9, c10]\\n411. \\n412.         ta = BinTableHDU.from_columns(columns)\\n413.         tb = BinTableHDU.from_columns([c.copy() for c in columns])\\n414. \\n415.         diff = TableDataDiff(ta.data, tb.data)\\n416.         assert diff.identical\\n417.         assert len(diff.common_columns) == 10\\n418.         assert diff.common_column_names == set("abcdefghij")\\n419.         assert diff.diff_ratio == 0\\n420.         assert diff.diff_total == 0\\n421. \\n422.     def test_diff_empty_tables(self):\\n423.         """\\n424.         Regression test for https://aeon.stsci.edu/ssb/trac/pyfits/ticket/178\\n425. \\n426.         Ensure that diffing tables containing empty data doesn\\\'t crash.\\n427.         """\\n428. \\n429.         c1 = Column("D", format="J")\\n430.         c2 = Column("E", format="J")\\n431.         thdu = BinTableHDU.from_columns([c1, c2], nrows=0)\\n432. \\n433.         hdula = fits.HDUList([thdu])\\n434.         hdulb = fits.HDUList([thdu])\\n435. \\n436.         diff = FITSDiff(hdula, hdulb)\\n437.         assert diff.identical\\n438. \\n439.     def test_ignore_table_fields(self):\\n440.         c1 = Column("A", format="L", array=[True, False])\\n441.         c2 = Column("B", format="X", array=[[0], [1]])\\n442.         c3 = Column("C", format="4I", dim="(2, 2)", array=[[0, 1, 2, 3], [4, 5, 6, 7]])\\n443. \\n444.         c4 = Column("B", format="X", array=[[1], [0]])\\n445.         c5 = Column("C", format="4I", dim="(2, 2)", array=[[1, 2, 3, 4], [5, 6, 7, 8]])\\n446. \\n447.         ta = BinTableHDU.from_columns([c1, c2, c3])\\n448.         tb = BinTableHDU.from_columns([c1, c4, c5])\\n449. \\n450.         diff = TableDataDiff(ta.data, tb.data, ignore_fields=["B", "C"])\\n451.         assert diff.identical\\n452. \\n453.         # The only common column should be c1\\n454.         assert len(diff.common_columns) == 1\\n455.         assert diff.common_column_names == {"a"}\\n456.         assert diff.diff_ratio == 0\\n457.         assert diff.diff_total == 0\\n458. \\n459.     def test_different_table_field_names(self):\\n460.         ca = Column("A", format="L", array=[True, False])\\n461.         cb = Column("B", format="L", array=[True, False])\\n462.         cc = Column("C", format="L", array=[True, False])\\n463. \\n464.         ta = BinTableHDU.from_columns([ca, cb])\\n465.         tb = BinTableHDU.from_columns([ca, cc])\\n466. \\n467.         diff = TableDataDiff(ta.data, tb.data)\\n468. \\n469.         assert not diff.identical\\n470.         assert len(diff.common_columns) == 1\\n471.         assert diff.common_column_names == {"a"}\\n472.         assert diff.diff_column_names == (["B"], ["C"])\\n473.         assert diff.diff_ratio == 0\\n474.         assert diff.diff_total == 0\\n475. \\n476.         report = diff.report()\\n477.         assert "Extra column B of format L in a" in report\\n478.         assert "Extra column C of format L in b" in report\\n479. \\n480.     def test_different_table_field_counts(self):\\n481.         """\\n482.         Test tables with some common columns, but different number of columns\\n483.         overall.\\n484.         """\\n485. \\n486.         ca = Column("A", format="L", array=[True, False])\\n487.         cb = Column("B", format="L", array=[True, False])\\n488.         cc = Column("C", format="L", array=[True, False])\\n489. \\n490.         ta = BinTableHDU.from_columns([cb])\\n491.         tb = BinTableHDU.from_columns([ca, cb, cc])\\n492. \\n493.         diff = TableDataDiff(ta.data, tb.data)\\n494. \\n495.         assert not diff.identical\\n496.         assert diff.diff_column_count == (1, 3)\\n497.         assert len(diff.common_columns) == 1\\n498.         assert diff.common_column_names == {"b"}\\n499.         assert diff.diff_column_names == ([], ["A", "C"])\\n500.         assert diff.diff_ratio == 0\\n501.         assert diff.diff_total == 0\\n502. \\n503.         report = diff.report()\\n504.         assert " Tables have different number of columns:" in report\\n505.         assert "  a: 1\\\\n  b: 3" in report\\n506. \\n507.     def test_different_table_rows(self):\\n508.         """\\n509.         Test tables that are otherwise identical but one has more rows than the\\n510.         other.\\n511.         """\\n512. \\n513.         ca1 = Column("A", format="L", array=[True, False])\\n514.         cb1 = Column("B", format="L", array=[True, False])\\n515.         ca2 = Column("A", format="L", array=[True, False, True])\\n516.         cb2 = Column("B", format="L", array=[True, False, True])\\n517. \\n518.         ta = BinTableHDU.from_columns([ca1, cb1])\\n519.         tb = BinTableHDU.from_columns([ca2, cb2])\\n520. \\n521.         diff = TableDataDiff(ta.data, tb.data)\\n522. \\n523.         assert not diff.identical\\n524.         assert diff.diff_column_count == ()\\n525.         assert len(diff.common_columns) == 2\\n526.         assert diff.diff_rows == (2, 3)\\n527.         assert diff.diff_values == []\\n528. \\n529.         report = diff.report()\\n530. \\n531.         assert "Table rows differ" in report\\n532.         assert "a: 2" in report\\n533.         assert "b: 3" in report\\n534.         assert "No further data comparison performed."\\n535. \\n536.     def test_different_table_data(self):\\n537.         """\\n538.         Test diffing table data on columns of several different data formats\\n539.         and dimensions.\\n540.         """\\n541. \\n542.         ca1 = Column("A", format="L", array=[True, False])\\n543.         ca2 = Column("B", format="X", array=[[0], [1]])\\n544.         ca3 = Column("C", format="4I", dim="(2, 2)", array=[[0, 1, 2, 3], [4, 5, 6, 7]])\\n545.         ca4 = Column("D", format="J", bscale=2.0, array=[0.0, 2.0])\\n546.         ca5 = Column("E", format="A3", array=["abc", "def"])\\n547.         ca6 = Column("F", format="E", unit="m", array=[0.0, 1.0])\\n548.         ca7 = Column("G", format="D", bzero=-0.1, array=[0.0, 1.0])\\n549.         ca8 = Column("H", format="C", array=[0.0 + 1.0j, 2.0 + 3.0j])\\n550.         ca9 = Column("I", format="M", array=[4.0 + 5.0j, 6.0 + 7.0j])\\n551.         ca10 = Column("J", format="PI(2)", array=[[0, 1], [2, 3]])\\n552. \\n553.         cb1 = Column("A", format="L", array=[False, False])\\n554.         cb2 = Column("B", format="X", array=[[0], [0]])\\n555.         cb3 = Column("C", format="4I", dim="(2, 2)", array=[[0, 1, 2, 3], [5, 6, 7, 8]])\\n556.         cb4 = Column("D", format="J", bscale=2.0, array=[2.0, 2.0])\\n557.         cb5 = Column("E", format="A3", array=["abc", "ghi"])\\n558.         cb6 = Column("F", format="E", unit="m", array=[1.0, 2.0])\\n559.         cb7 = Column("G", format="D", bzero=-0.1, array=[2.0, 3.0])\\n560.         cb8 = Column("H", format="C", array=[1.0 + 1.0j, 2.0 + 3.0j])\\n561.         cb9 = Column("I", format="M", array=[5.0 + 5.0j, 6.0 + 7.0j])\\n562.         cb10 = Column("J", format="PI(2)", array=[[1, 2], [3, 4]])\\n563. \\n564.         ta = BinTableHDU.from_columns(\\n565.             [ca1, ca2, ca3, ca4, ca5, ca6, ca7, ca8, ca9, ca10]\\n566.         )\\n567.         tb = BinTableHDU.from_columns(\\n568.             [cb1, cb2, cb3, cb4, cb5, cb6, cb7, cb8, cb9, cb10]\\n569.         )\\n570. \\n571.         diff = TableDataDiff(ta.data, tb.data, numdiffs=20)\\n572.         assert not diff.identical\\n573.         # The column definitions are the same, but not the column values\\n574.         assert diff.diff_columns == ()\\n575.         assert diff.diff_values[0] == (("A", 0), (True, False))\\n576.         assert diff.diff_values[1] == (("B", 1), ([1], [0]))\\n577.         assert diff.diff_values[2][0] == ("C", 1)\\n578.         assert (diff.diff_values[2][1][0] == [[4, 5], [6, 7]]).all()\\n579.         assert (diff.diff_values[2][1][1] == [[5, 6], [7, 8]]).all()\\n580.         assert diff.diff_values[3] == (("D", 0), (0, 2.0))\\n581.         assert diff.diff_values[4] == (("E", 1), ("def", "ghi"))\\n582.         assert diff.diff_values[5] == (("F", 0), (0.0, 1.0))\\n583.         assert diff.diff_values[6] == (("F", 1), (1.0, 2.0))\\n584.         assert diff.diff_values[7] == (("G", 0), (0.0, 2.0))\\n585.         assert diff.diff_values[8] == (("G", 1), (1.0, 3.0))\\n586.         assert diff.diff_values[9] == (("H", 0), (0.0 + 1.0j, 1.0 + 1.0j))\\n587.         assert diff.diff_values[10] == (("I", 0), (4.0 + 5.0j, 5.0 + 5.0j))\\n588.         assert diff.diff_values[11][0] == ("J", 0)\\n589.         assert (diff.diff_values[11][1][0] == [0, 1]).all()\\n590.         assert (diff.diff_values[11][1][1] == [1, 2]).all()\\n591.         assert diff.diff_values[12][0] == ("J", 1)\\n592.         assert (diff.diff_values[12][1][0] == [2, 3]).all()\\n593.         assert (diff.diff_values[12][1][1] == [3, 4]).all()\\n594. \\n595.         assert diff.diff_total == 13\\n596.         assert diff.diff_ratio == 0.65\\n597. \\n598.         report = diff.report()\\n599.         assert "Column A data differs in row 0:\\\\n    a> True\\\\n    b> False" in report\\n600.         assert "...and at 1 more indices.\\\\n Column D data differs in row 0:" in report\\n601.         assert "13 different table data element(s) found (65.00% different)" in report\\n602.         assert report.count("more indices") == 1\\n603. \\n604.     def test_identical_files_basic(self):\\n605.         """Test identicality of two simple, extensionless files."""\\n606. \\n607.         a = np.arange(100).reshape(10, 10)\\n608.         hdu = PrimaryHDU(data=a)\\n609.         hdu.writeto(self.temp("testa.fits"))\\n610.         hdu.writeto(self.temp("testb.fits"))\\n611.         diff = FITSDiff(self.temp("testa.fits"), self.temp("testb.fits"))\\n612.         assert diff.identical\\n613. \\n614.         report = diff.report()\\n615.         # Primary HDUs should contain no differences\\n616.         assert "Primary HDU" not in report\\n617.         assert "Extension HDU" not in report\\n618.         assert "No differences found." in report\\n619. \\n620.         a = np.arange(10)\\n621.         ehdu = ImageHDU(data=a)\\n622.         diff = HDUDiff(ehdu, ehdu)\\n623.         assert diff.identical\\n624.         report = diff.report()\\n625.         assert "No differences found." in report\\n626. \\n627.     def test_partially_identical_files1(self):\\n628.         """\\n629.         Test files that have some identical HDUs but a different extension\\n630.         count.\\n631.         """\\n632. \\n633.         a = np.arange(100).reshape(10, 10)\\n634.         phdu = PrimaryHDU(data=a)\\n635.         ehdu = ImageHDU(data=a)\\n636.         hdula = HDUList([phdu, ehdu])\\n637.         hdulb = HDUList([phdu, ehdu, ehdu])\\n638.         diff = FITSDiff(hdula, hdulb)\\n639.         assert not diff.identical\\n640.         assert diff.diff_hdu_count == (2, 3)\\n641. \\n642.         # diff_hdus should be empty, since the third extension in hdulb\\n643.         # has nothing to compare against\\n644.         assert diff.diff_hdus == []\\n645. \\n646.         report = diff.report()\\n647.         assert "Files contain different numbers of HDUs" in report\\n648.         assert "a: 2\\\\n b: 3" in report\\n649.         assert "No differences found between common HDUs" in report\\n650. \\n651.     def test_partially_identical_files2(self):\\n652.         """\\n653.         Test files that have some identical HDUs but one different HDU.\\n654.         """\\n655. \\n656.         a = np.arange(100).reshape(10, 10)\\n657.         phdu = PrimaryHDU(data=a)\\n658.         ehdu = ImageHDU(data=a)\\n659.         ehdu2 = ImageHDU(data=(a + 1))\\n660.         hdula = HDUList([phdu, ehdu, ehdu])\\n661.         hdulb = HDUList([phdu, ehdu2, ehdu])\\n662.         diff = FITSDiff(hdula, hdulb)\\n663. \\n664.         assert not diff.identical\\n665.         assert diff.diff_hdu_count == ()\\n666.         assert len(diff.diff_hdus) == 1\\n667.         assert diff.diff_hdus[0][0] == 1\\n668. \\n669.         hdudiff = diff.diff_hdus[0][1]\\n670.         assert not hdudiff.identical\\n671.         assert hdudiff.diff_extnames == ()\\n672.         assert hdudiff.diff_extvers == ()\\n673.         assert hdudiff.diff_extension_types == ()\\n674.         assert hdudiff.diff_headers.identical\\n675.         assert hdudiff.diff_data is not None\\n676. \\n677.         datadiff = hdudiff.diff_data\\n678.         assert isinstance(datadiff, ImageDataDiff)\\n679.         assert not datadiff.identical\\n680.         assert datadiff.diff_dimensions == ()\\n681.         assert datadiff.diff_pixels == [((0, y), (y, y + 1)) for y in range(10)]\\n682.         assert datadiff.diff_ratio == 1.0\\n683.         assert datadiff.diff_total == 100\\n684. \\n685.         report = diff.report()\\n686.         # Primary HDU and 2nd extension HDU should have no differences\\n687.         assert "Primary HDU" not in report\\n688.         assert "Extension HDU 2" not in report\\n689.         assert "Extension HDU 1" in report\\n690. \\n691.         assert "Headers contain differences" not in report\\n692.         assert "Data contains differences" in report\\n693.         for y in range(10):\\n694.             assert f"Data differs at [{y + 1}, 1]" in report\\n695.         assert "100 different pixels found (100.00% different)." in report\\n696. \\n697.     def test_partially_identical_files3(self):\\n698.         """\\n699.         Test files that have some identical HDUs but a different extension\\n700.         name.\\n701.         """\\n702. \\n703.         phdu = PrimaryHDU()\\n704.         ehdu = ImageHDU(name="FOO")\\n705.         hdula = HDUList([phdu, ehdu])\\n706.         ehdu = BinTableHDU(name="BAR")\\n707.         ehdu.header["EXTVER"] = 2\\n708.         ehdu.header["EXTLEVEL"] = 3\\n709.         hdulb = HDUList([phdu, ehdu])\\n710.         diff = FITSDiff(hdula, hdulb)\\n711.         assert not diff.identical\\n712. \\n713.         assert diff.diff_hdus[0][0] == 1\\n714. \\n715.         hdu_diff = diff.diff_hdus[0][1]\\n716.         assert hdu_diff.diff_extension_types == ("IMAGE", "BINTABLE")\\n717.         assert hdu_diff.diff_extnames == ("FOO", "BAR")\\n718.         assert hdu_diff.diff_extvers == (1, 2)\\n719.         assert hdu_diff.diff_extlevels == (1, 3)\\n720. \\n721.         report = diff.report()\\n722.         assert "Extension types differ" in report\\n723.         assert "a: IMAGE\\\\n    b: BINTABLE" in report\\n724.         assert "Extension names differ" in report\\n725.         assert "a: FOO\\\\n    b: BAR" in report\\n726.         assert "Extension versions differ" in report\\n727.         assert "a: 1\\\\n    b: 2" in report\\n728.         assert "Extension levels differ" in report\\n729.         assert "a: 1\\\\n    b: 2" in report\\n730. \\n731.     def test_diff_nans(self):\\n732.         """\\n733.         Regression test for https://aeon.stsci.edu/ssb/trac/pyfits/ticket/204\\n734.         """\\n735. \\n736.         # First test some arrays that should be equivalent....\\n737.         arr = np.empty((10, 10), dtype=np.float64)\\n738.         arr[:5] = 1.0\\n739.         arr[5:] = np.nan\\n740.         arr2 = arr.copy()\\n741. \\n742.         table = np.rec.array(\\n743.             [(1.0, 2.0), (3.0, np.nan), (np.nan, np.nan)], names=["cola", "colb"]\\n744.         ).view(fits.FITS_rec)\\n745.         table2 = table.copy()\\n746. \\n747.         assert ImageDataDiff(arr, arr2).identical\\n748.         assert TableDataDiff(table, table2).identical\\n749. \\n750.         # Now let\\\'s introduce some differences, where there are nans and where\\n751.         # there are not nans\\n752.         arr2[0][0] = 2.0\\n753.         arr2[5][0] = 2.0\\n754.         table2[0][0] = 2.0\\n755.         table2[1][1] = 2.0\\n756. \\n757.         diff = ImageDataDiff(arr, arr2)\\n758.         assert not diff.identical\\n759.         assert diff.diff_pixels[0] == ((0, 0), (1.0, 2.0))\\n760.         assert diff.diff_pixels[1][0] == (5, 0)\\n761.         assert np.isnan(diff.diff_pixels[1][1][0])\\n762.         assert diff.diff_pixels[1][1][1] == 2.0\\n763. \\n764.         diff = TableDataDiff(table, table2)\\n765.         assert not diff.identical\\n766.         assert diff.diff_values[0] == (("cola", 0), (1.0, 2.0))\\n767.         assert diff.diff_values[1][0] == ("colb", 1)\\n768.         assert np.isnan(diff.diff_values[1][1][0])\\n769.         assert diff.diff_values[1][1][1] == 2.0\\n770. \\n771.     def test_file_output_from_path_string(self):\\n772.         outpath = self.temp("diff_output.txt")\\n773.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n774.         hb = ha.copy()\\n775.         hb["C"] = 4\\n776.         diffobj = HeaderDiff(ha, hb)\\n777.         diffobj.report(fileobj=outpath)\\n778.         report_as_string = diffobj.report()\\n779.         with open(outpath) as fout:\\n780.             assert fout.read() == report_as_string\\n781. \\n782.     def test_file_output_overwrite_safety(self):\\n783.         outpath = self.temp("diff_output.txt")\\n784.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n785.         hb = ha.copy()\\n786.         hb["C"] = 4\\n787.         diffobj = HeaderDiff(ha, hb)\\n788.         diffobj.report(fileobj=outpath)\\n789. \\n790.         with pytest.raises(OSError, match=_NOT_OVERWRITING_MSG_MATCH):\\n791.             diffobj.report(fileobj=outpath)\\n792. \\n793.     def test_file_output_overwrite_success(self):\\n794.         outpath = self.temp("diff_output.txt")\\n795.         ha = Header([("A", 1), ("B", 2), ("C", 3)])\\n796.         hb = ha.copy()\\n797.         hb["C"] = 4\\n798.         diffobj = HeaderDiff(ha, hb)\\n799.         diffobj.report(fileobj=outpath)\\n800.         report_as_string = diffobj.report()\\n801.         diffobj.report(fileobj=outpath, overwrite=True)\\n802.         with open(outpath) as fout:\\n803.             assert (\\n804.                 fout.read() == report_as_string\\n805.             ), "overwritten output file is not identical to report string"\\n806. \\n807.     def test_rawdatadiff_nodiff(self):\\n808.         a = np.arange(100, dtype="uint8").reshape(10, 10)\\n809.         b = a.copy()\\n810.         hdu_a = DummyNonstandardExtHDU(data=a)\\n811.         hdu_b = DummyNonstandardExtHDU(data=b)\\n812.         diff = HDUDiff(hdu_a, hdu_b)\\n813.         assert diff.identical\\n814.         report = diff.report()\\n815.         assert "No differences found." in report\\n816. \\n817.     def test_rawdatadiff_dimsdiff(self):\\n818.         a = np.arange(100, dtype="uint8") + 10\\n819.         b = a[:80].copy()\\n820.         hdu_a = DummyNonstandardExtHDU(data=a)\\n821.         hdu_b = DummyNonstandardExtHDU(data=b)\\n822.         diff = HDUDiff(hdu_a, hdu_b)\\n823.         assert not diff.identical\\n824.         report = diff.report()\\n825.         assert "Data sizes differ:" in report\\n826.         assert "a: 100 bytes" in report\\n827.         assert "b: 80 bytes" in report\\n828.         assert "No further data comparison performed." in report\\n829. \\n830.     def test_rawdatadiff_bytesdiff(self):\\n831.         a = np.arange(100, dtype="uint8") + 10\\n832.         b = a.copy()\\n833.         changes = [(30, 200), (89, 170)]\\n834.         for i, v in changes:\\n835.             b[i] = v\\n836. \\n837.         hdu_a = DummyNonstandardExtHDU(data=a)\\n838.         hdu_b = DummyNonstandardExtHDU(data=b)\\n839.         diff = HDUDiff(hdu_a, hdu_b)\\n840. \\n841.         assert not diff.identical\\n842. \\n843.         diff_bytes = diff.diff_data.diff_bytes\\n844.         assert len(changes) == len(diff_bytes)\\n845.         for j, (i, v) in enumerate(changes):\\n846.             assert diff_bytes[j] == (i, (i + 10, v))\\n847. \\n848.         report = diff.report()\\n849.         assert "Data contains differences:" in report\\n850.         for i, _ in changes:\\n851.             assert f"Data differs at byte {i}:" in report\\n852.         assert "2 different bytes found (2.00% different)." in report\\n853. \\n854. \\n855. def test_fitsdiff_hdu_name(tmp_path):\\n856.     """Make sure diff report reports HDU name and ver if same in files"""\\n857.     path1 = tmp_path / "test1.fits"\\n858.     path2 = tmp_path / "test2.fits"\\n859. \\n860.     hdulist = HDUList([PrimaryHDU(), ImageHDU(data=np.zeros(5), name="SCI")])\\n861.     hdulist.writeto(path1)\\n862.     hdulist[1].data[0] = 1\\n863.     hdulist.writeto(path2)\\n864. \\n865.     diff = FITSDiff(path1, path2)\\n866.     assert "Extension HDU 1 (SCI, 1):" in diff.report()\\n867. \\n868. \\n869. def test_fitsdiff_no_hdu_name(tmp_path):\\n870.     """Make sure diff report doesn\\\'t report HDU name if not in files"""\\n871.     path1 = tmp_path / "test1.fits"\\n872.     path2 = tmp_path / "test2.fits"\\n873. \\n874.     hdulist = HDUList([PrimaryHDU(), ImageHDU(data=np.zeros(5))])\\n875.     hdulist.writeto(path1)\\n876.     hdulist[1].data[0] = 1\\n877.     hdulist.writeto(path2)\\n878. \\n879.     diff = FITSDiff(path1, path2)\\n880.     assert "Extension HDU 1:" in diff.report()\\n881. \\n882. \\n883. def test_fitsdiff_with_names(tmp_path):\\n884.     """Make sure diff report doesn\\\'t report HDU name if not same in files"""\\n885.     path1 = tmp_path / "test1.fits"\\n886.     path2 = tmp_path / "test2.fits"\\n887. \\n888.     hdulist = HDUList([PrimaryHDU(), ImageHDU(data=np.zeros(5), name="SCI", ver=1)])\\n889.     hdulist.writeto(path1)\\n890.     hdulist[1].name = "ERR"\\n891.     hdulist.writeto(path2)\\n892. \\n893.     diff = FITSDiff(path1, path2)\\n894.     assert "Extension HDU 1:" in diff.report()\\n895. \\n896. \\n897. def test_rawdatadiff_diff_with_rtol(tmp_path):\\n898.     """Regression test for https://github.com/astropy/astropy/issues/13330"""\\n899.     path1 = tmp_path / "test1.fits"\\n900.     path2 = tmp_path / "test2.fits"\\n901.     a = np.zeros((10, 2), dtype="float32")\\n902.     a[:, 0] = np.arange(10, dtype="float32") + 10\\n903.     a[:, 1] = np.arange(10, dtype="float32") + 20\\n904.     b = a.copy()\\n905.     changes = [(3, 13.1, 23.1), (8, 20.5, 30.5)]\\n906.     for i, v, w in changes:\\n907.         b[i, 0] = v\\n908.         b[i, 1] = w\\n909. \\n910.     ca = Column("A", format="20E", array=[a])\\n911.     cb = Column("A", format="20E", array=[b])\\n912.     hdu_a = BinTableHDU.from_columns([ca])\\n913.     hdu_a.writeto(path1, overwrite=True)\\n914.     hdu_b = BinTableHDU.from_columns([cb])\\n915.     hdu_b.writeto(path2, overwrite=True)\\n916.     with fits.open(path1) as fits1:\\n917.         with fits.open(path2) as fits2:\\n918.             diff = FITSDiff(fits1, fits2, atol=0, rtol=0.001)\\n919.             str1 = diff.report(fileobj=None, indent=0)\\n920. \\n921.             diff = FITSDiff(fits1, fits2, atol=0, rtol=0.01)\\n922.             str2 = diff.report(fileobj=None, indent=0)\\n923. \\n924.     assert "...and at 1 more indices." in str1\\n925.     assert "...and at 1 more indices." not in str2\', \'start_line_number\': 1, \'end_line_number\': 925}\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-12-21 17:10:07,973 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport numpy as np\nimport pytest\n\nfrom astropy.io import fits\nfrom astropy.io.fits.column import Column\nfrom astropy.io.fits.diff import (\n    FITSDiff,\n    HDUDiff,\n    HeaderDiff,\n    ImageDataDiff,\n    TableDataDiff,\n)\nfrom astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU\nfrom astropy.io.fits.hdu.base import NonstandardExtHDU\nfrom astropy.io.fits.hdu.table import BinTableHDU\nfrom astropy.io.fits.header import Header\nfrom astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH\n\nfrom .conftest import FitsTestCase\n\n\nclass TestDiff(FitsTestCase):\n    def test_vla_diff_identical_files(self):\n        """\n        Regression test for a bug where FITSDiff would report differences\n        between identical files containing variable-length array columns with\n        the \'Q\' format descriptor.\n        """\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\n        hdu = fits.BinTableHDU.from_columns([col])\n        filename = self.temp(\'diffbug.fits\')\n        hdu.writeto(filename, overwrite=True)\n\n        diff = fits.FITSDiff(filename, filename)\n        assert diff.identical\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 6740, 'end_index': 7270, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 8882, 'end_index': 9412, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 10270, 'end_index': 10800, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 55734, 'candidates_token_count': 323, 'total_token_count': 58956, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55734}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 323}], 'thoughts_token_count': 2899, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.2183168015612906, 'model_name': 'gemini-2.5-pro'} id='run--4d5a0c85-eca7-4ef5-8df6-05e4488cad55-0' usage_metadata={'input_tokens': 55734, 'output_tokens': 323, 'total_tokens': 58956, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2899}}
2025-12-21 17:10:22,769 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nimport pytest\\n\\nfrom astropy.io import fits\\nfrom astropy.io.fits.column import Column\\nfrom astropy.io.fits.diff import (\\n    FITSDiff,\\n    HDUDiff,\\n    HeaderDiff,\\n    ImageDataDiff,\\n    TableDataDiff,\\n)\\nfrom astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU\\nfrom astropy.io.fits.hdu.base import NonstandardExtHDU\\nfrom astropy.io.fits.hdu.table import BinTableHDU\\nfrom astropy.io.fits.header import Header\\nfrom astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH\\n\\nfrom .conftest import FitsTestCase\\n\\n\\nclass TestDiff(FitsTestCase):\\n    def test_vla_diff_identical_files(self):\\n        \\"\\"\\"\\n        Regression test for a bug where FITSDiff would report differences\\n        between identical files containing variable-length array columns with\\n        the \'Q\' format descriptor.\\n        \\"\\"\\"\\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\\n        hdu = fits.BinTableHDU.from_columns([col])\\n        filename = self.temp(\'diffbug.fits\')\\n        hdu.writeto(filename, overwrite=True)\\n\\n        diff = fits.FITSDiff(filename, filename)\\n        assert diff.identical\\n", "relative_path": "astropy/io/fits/tests/test_diff.py"}'}, '__gemini_function_call_thought_signatures__': {'f44c6391-25db-4397-9bb1-ccb1e2615c33': 'CpEmAY89a1/ryVwnFmZ42MNNKzkcZhamzoFHE+v5exMsVWldhZvK8A6hotyulg7hoBQ8e274+c59DLc2cwcAs2u52py/I+O/qNLSiLdF21yyvhemAafkLlVxVL2K5ymwXyDgqoXBZQrJP6CDXzM0mE/h5kxu9NslK8qKYPOFhIIHNwvZJkfitl8/B6fGQ4AbeLVYV03pgp13yJRJfDTaTSFGDQWcVxyJ+m38cJQCXodCGlczg0YNyDRfllr0iE8hB+RLbJOaDpuTxWjWuYk1gdLXsJOQoLRhQVjPHIjVX6QQhe0rJTB7cLWqDi+ypmmfRflzjEx9DC6auZh9nXraLegdK9Ci0CIogkhEAxrLldQR0Y5IgjnrbqRgzLETs2V7wwUdnAjhZWTvQVoYq2qeDBKTp4JLJrQGN7dAkFqj/DUkbfcJ3YHTPoCd68Mxe52qhgx9NiznaUoB/O1P4sFjpB/X9TFZjN91cN18OSMpkHkRcou7NQAYd0wFOGnY+evicU0D/WJqOI5iebxbv5dxC3O2bsPH3ujZD7n3bSnjiOVxnB3J0i7o5nUvleR293JDUNzu+IvPx07O1USA2xYSC3ZEq7cSK37Fjw5nopw1lkXBM/rKP4P/6S24IETfIBxxcREQnzWKEqatH+4T8CjRvX17EZGjeU5WnHcBkZsC8YBJnk27pBYB4TjRVnPEs9ocTzTYimqhj9wBTH/AKc0JPvMklc1IxjOBmw4+dABvR7995d4KzHF9ZLnkBtpQDNFkhEi7TwV/Tjxqn8zo2peb7sA/1wy8/yIGNv1zWCHhy857ooRRW5n6b6I0+HEcOrb5z3hpayadvR0LlL51VSYJLKLKPOddtTHV2XFnZFEMctn3/ZLiForIB/ETGbFAuvSKtzsuBdJCp25T+q6pcr5BZhq2WlWn8M21kRhvYYbIhnNZh382IHPRN17dbLxMaUSG15a5MdqOxC2L8ca98orBS8KbDTNP7TNYUj50aAq5nHXchK49+REX8TO9sA1xb3juN83yVe4bWEXB+zoVCKv7trJgwfYrRqEg31efBDRvbqy6ybt7mUeNvJCouRAK8lyR0oPUdtrGUmBcQgNf5kDH4c6UoMqnbtIgPklC6oWTL2w5xWozRi8GNWrhxJnwMcRQXwhS7pWgnl8Iz9xeSHuIXg1tp9HZxNru2GX+e+6T7edUcxVMf9E1FHuiJqKk/SmMUMFhO4f+7ZHjR43CislqkQ5TrXsru8/dEv50VBXgDVxrSVD9wEuZcP6pvJsjpwuwWmshJvogCFTUycEYR5MjscD5c4OOrEMh7qtOxS+RxxWz0G4XwOf9hyU8Kna1hEjAuuVQPNWYxl38ydr40qa03iZVLd98CKvqAKriKiljRJvi577tN6grKOoWMToMQNd3BaopXY/T2FNQ3TUUEw4JteiZKhyLx27MRI4jA5mS9MvRxrIMi/2jrit8ih+HZDgBygekDk9xV16X6LXq7yp8ozOQWEs/Z+6BMauk2EbkgJ41+lFTcoL4EAozA+xpckrYOH/S7W0fATjwR7uGkhc6PDCRRAWIlrgVERnyFS6WNYACGN9s9s8M7bc7QRwkbRLHDmWfX/6DzkyYnTfLLwXBO/9f7saOvvESaRtemA3Uao4QgrNLRZwaVmIeJxnFsTEDx0VHCcJXfVkYhVtbULbJjMgn3ruD/Pwh/Df6h+tdaIKf5Ac/BGzpsUZsrUI0+xCFnLr9Xxq7N0Ho0bOYb8t0jSb96fjbNC3067P6KDQ2jgANyYgOs1wbWqTxW84zcFy4WKkCmWSNf/8FUiLsvvb5vA9iwy8feAzPxq5eG1YNMg79GKAGQ4suNqbQqK47DFkaWBTbgJDmX3DLoypvOPbAKnB5gZgBmraoea/Wii9XlNJLWHRbKa/0OwguXO4MKkALUchQ1jjala3BsbHV/kn6hwtjLYM7iymTqGRQGcHSCdKB4/IJ+UpJUykg6mj0FXJWkGkizZHlA/kmld6kL2Khy3QYqaR4YXO17PkLoqJ2GSjgIRBbTVDmd8itrW3O9SkN2j9raLwvY5+UDrELMhcCfTc6uhGl4O4v2s2akNWkaSJWSDqMq6SQAKpLnW96nMKTDz7+ypju5LHh/qDMZCdVmflXaqQyXv91LCGj/9eig5nTPobccwWWNSLPr+DMRl97NBfS6DVppClgxczHcXUv+W+FR2oNSowmtvn5/hcMUH0TQefD4j0ekNvU/6liNcum9laZiryux/HWaaGFh3IuUjhC9KJKwxT4T4xc/TVIpzg8U8mBuJiwXRrhfA4bIxMb7uPwuzdT1M+wtFW4Jc+QeJynxGhFijp/R0RoZECle+m++AT0MDyOe7nsRtf0i0/NXBIiFdSTlio1LPV8XkmiGWKw9armMsMgFT2upAEaQLUqCblJkiSUBs92Q8Tu1V5Nqe0TYSLqdjYav46Im4rfQjqtqhbJUrzE4FsQj2LmkSoWCk6S/PkfzS9Gq5Ca+1fqSybuHCc31wT6qeJZrqu7yiHyAMMddYhpxsq3BRpoB0M6QFsFwu+0a0swgsXli1A3QC4CZay9OEOLNt5fmJyrYfsULEDDJshUyeSo1V62v/LCzBUwuVIEvZ37NzhpyDKu6EO153M3Nkomg0hMwWvJk5B2Dz7C8hI+HTwAuVL3APpAC5pWrVfDAoD/Q22DkFlZJxNpjPSVb2ZOiM/Rhv5iEIroNSPTMSQAKFLKwYWPC3sHnT48N9Z0R91UMJcES0ZZXqGCQtTmkBeW7TwSCpDFI9tYQJqi7bE+dRPOxOA6NwimBZJdQDTPJ7FwCgHcJaAqGuW3qJl6BTH7Vri71CU73lslJAyJ9wzqLvt6awasns0r2CswY+BoaHM9DQMbjMMpAPjUTGstW4WauQxc8c/WNE8j5xxXgevzcyExStrt7qa3u801kqkebtsOrw+Itg46ObtFtk61BXO1dPIzAMYeSppKUWVg1dIaY6LgasxrL4lM8JJF9BUq/92pEiMOM1bdYhkagxpHCf5cJGaj6Mg791uJagX6HqBMSNolsrznpOab3VdfqjcGXQXg5/x20jGdluHfKGAHDi9bCEDcebLQmU23AVxmnEs+V58O8oYlLZiYNGc9nXnmX1AzhLNE2sYBiQJS3N8f93Dk/N7OXrTN/LB47h99LYvv526XfQzQKF/QJS96j4IyReiGq16azRQQxS05juFOmBJ4kqnLxQaRZ5ii7D34//5syMFuT4BV5YLYUiLNcFvri6K1Nb9vaB9E0RjQq+5UODnqHEAii1/r+G7ZZog1dEWvvbUb1n9m2Du/BoNgGi48rioDZkKX/KmYBjl7AW7RPv07Gx7H+hluHDtnm5I2Klw7nF/o7BOhyOtPvwMHDus+Kqe2rblaNUunseCkTMDzJmpb5epNKavY8mA0m9lJhkzEUdGzO3pkRMZHj9vqh2fx0d7gMPvsq/7thuDUCOuc19DuGFlUTWVQgWApArZwjuiQc6+WKEMS6Y/nPXDb8s95mIZYWZ1bxVJz6z0apIFbTmS+bKk2pzUbsSF54iHP+fE25jACiKaUv+dSZh8+2gBuJzdEOeA91yEtkkPdBKKDk+cdpNrB/qPcGH3SFATjkxI7P7eAiFv919BhRHsmB2IL4C6gKMqr/Z2yiAOpmNpRqzcMYapPfMibrc4kFZwCILeV5onWQYMS6t/qBDANN5KiuC5aSK/VB6ga7ECisM2YtRcSdDHaFzV3gXxPzz4KXe3z1HCZhMghgBIeHXNXTPTG6jzZZHwwVmJXlJhreQkOsvcp1FB7txZIaEp0AkrGp2IsLNRoac9GWYj4HPFSZtQ26DrC/1Mals2RX6fc86mSrXVJLRW0zppPl1r/SL4GBRi/hWa7nUou5IvImfaOKzxePn67ZHHN33J7RIpXnLTYPqa4cHw0Pxg1SVJds6xb+/zVHuxf4NcbtQXLhCrMAG50vVn2bO40548ng/CP2Xy35PcH4CS8KdBU0LJybFJwtMc72bNdPe7QlWCuWARM5WpgbdjwOnT0mL+t9TFaNBc362lKOXVTIaPIBKFQLGeSpV1FV4D9L4zOunlUHgwCYJpRMsuy4I5mvqZT2vmhOuee3kBR/GxMMe+ZKD2OS0m4ZtC63uFDu4OD2y3u/RbR224neQizHPZOUUkyU73N+AaRQ57D4175EaENAYiYEeedDOPMjJKIvC/kUELPb10XQIxOkmvBtTOzd3k0dK8I/a6Kth/oozsUDJowbpSPzqXk26gWpP7yJhcRoZhbH5TZvoY12CFzc6HyPfoVdhSHCNlNMu07N5VaPFCl4ciAVAxuiBacocIONouI23ws1A7yKtHPsu/RgonqGSaomvC6X6gQVWBGP3DYip6OlZVfseyYVSfnV1LqI/hXLtMROPSSMWUjZHaCJeURhZIfxClf/6vO4exo6l2CXjdgJvpCb7DdSAhO3+lvw4D3EXj14JS/NUhaLC6l+uLi6W7E/cAz6cYv5S9uFXXkTPD79FGZNtJfTlMPe/6Y+Zhnkn6kA/Xm+RZExJO63OmGKLUiMpysLiO8BK/14H43ZPV+UMFiGrughbsbJeXaVdKwa0G0gS9GNe91+4CUTaY+0rc48hAN1ShHAUgrClqfOqe+o0HMLykIBuhNd7NeW124y6kAwkeWTXsuqEEI6Q1DeZzm3GdGR3wzktyKIwFvyxJA9/WeFRSYdVucmHHxZPAPTBrV6vFTeGJw8vX/+P6/HclvsWoeSdUBPCrNRtLpmYAI2lHFm3SopkJoc/7Gz/I9ooeSpbpoC5AOPLLOxrHHk7rvfp3nWHXI0PzAMxKt9eWkayNmO1zJ/3ymoE0Adiyh5Z50I9959Htfa2d45oYEn7gup7JucSaMKViRXdQYFqVN+DafU5mmde2A/DxLYbOodgU5JF9hBPgpjjEFECjyCPSGphn/qtI65Sf6E00mBeEK5u3l+bpHsyYeMiPfw+zCStLsyh4J/uyGsJ/hyBOuzOelNUwCOVhftzs33x+VAfkNmUJLiJGFePb0PAcdxnN0hz1AGcY66qgV36UJCBFuzkdJl+rEC5V6/LG1Rb1/o3BDNlTGgDykS/mZk+8XBwJzwTXC3YJS/9s9gcFCneKkfsLYDbCQR8tD24q7Dt1jHRdVf3j1g5Yyj+hIA3oFazofElbBf6wrpLoDmHfiGAAkfCb/wML2sW3tlmVk2Uj1SVrMnJuyOBJ3VhPiC9ifleKSo29hh+7v8V6SVJGKYM5mpejT3sn7CqsavdDlagnPkwD9ak1rirOS5TZ3HZNmMaKFX+SywKiRbp9PG/RlbThV9WLeHam+zlm/qkBE7gO5H4RteuHbK61wBOa5T8zKpJ4iN3AXboo2O8io4NegJdhuwYFHabWYb3N1T404AsutWdl5rgm8JsQ9PtNH8Q+5NraApsRxk7gBUNISJzy4uZO9+rXKNWI9JDPoYbLx3Scdwlqo3akqCLd90YJrRCVJ8vW1qQ9tQvwWIn5q6LLeEYahaoW+IZEKJX9P68CtEo47PNdL6YVumKPPIQVpnEtZQs41NiIMnhSn8BCTmLoJdQ2dbm9dAZPJhVG+Acrj8cv/6UJeijI1jlYL6MzSHAtyzne3byEXdb3qWdR2v7GZf2eXCOP70Ksf8mTdqFIjDtg5p3vf+IC+/Nw5iaArmNA7m/cz5D4zsD4sUyS+fSx8itN0Ukn4hTY9uidrDt0hsG+c8URqKZRVxdw/Gr41wKygGvsdLu4iqFE95Nc+oxWgkSQlxuMX8o9+kD5kWzuOBNOJdF629Iw6fq5KneJflWeWo3V7v37AotKNEQL2AnL56R+mEa40hMx7IL+Weg8QWRekZS7MU/BNFrJ7Iva0HCOJitMhjXGpRkfrIarduvFz0wqJDR4z8V9zb+7kKt1bCuBbeMXuvhe1cvh8kWsBGkV1bIui9UgqWCphz+h0brBTBr5wI/peUBlTrnBWcJTaTwFlc5QpZE7drk46wlLL55+YxFxTq+zLu5gtZ3Y6t+FkXIIT3PAuOkXPM8rGSPmc9ZU938y8Dk3Py0hcq68ZyjPkuQGhx0OsF78ZcGJfYlpsRee93IsgcDSK2GOOdmM81ahdZqO1ABtV5EUzQFQbKg+7X/RG0sPXW3PVMRfTTWeULtAtSlc7OKdgn0TqSzN0aAYpnhRRUuJypsvAlzXN1uEqNwZMw3YsJZKSfrBMvf5vyUaH+t/NutreAkrYWvMJMom9BNZaY1dKh4jY5D2rTjWUG8jK/nVQ7WQYtUNjSY9Qk4CMmuSj043vHzN4a4HynrBswB6ScYYBRFmV+IcmSDv19bm6g10LCIrUJxKeZ+eGSpm1RNJWHWnlmg2yNteDRpJDnY+wZjWQy8Amgcp5f/0VOe6ApoZBG4NcvS7qchvAvPN8PX0ADJP+jY3C9fC8r9XjnAtadqLvHCGh3cf7zN7TKIHQxsbmZvzaLRpWO3+0mm0OgbLqzk8lIU6mspMCvsKcjpg3/iFn7uXbXVyuYTRNnW+Xvxgcqq/1'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3704, 'end_index': 4234, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 4983, 'end_index': 5513, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 641, 'candidates_token_count': 340, 'total_token_count': 2308, 'prompt_tokens_details': [{'modality': 1, 'token_count': 641}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 340}], 'thoughts_token_count': 1327, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.29733471589929916, 'model_name': 'gemini-2.5-pro'} id='run--3a77c9c7-7fb9-42f0-adee-406273e0802b-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nimport pytest\n\nfrom astropy.io import fits\nfrom astropy.io.fits.column import Column\nfrom astropy.io.fits.diff import (\n    FITSDiff,\n    HDUDiff,\n    HeaderDiff,\n    ImageDataDiff,\n    TableDataDiff,\n)\nfrom astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU\nfrom astropy.io.fits.hdu.base import NonstandardExtHDU\nfrom astropy.io.fits.hdu.table import BinTableHDU\nfrom astropy.io.fits.header import Header\nfrom astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH\n\nfrom .conftest import FitsTestCase\n\n\nclass TestDiff(FitsTestCase):\n    def test_vla_diff_identical_files(self):\n        """\n        Regression test for a bug where FITSDiff would report differences\n        between identical files containing variable-length array columns with\n        the \'Q\' format descriptor.\n        """\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\n        hdu = fits.BinTableHDU.from_columns([col])\n        filename = self.temp(\'diffbug.fits\')\n        hdu.writeto(filename, overwrite=True)\n\n        diff = fits.FITSDiff(filename, filename)\n        assert diff.identical\n', 'relative_path': 'astropy/io/fits/tests/test_diff.py'}, 'id': 'f44c6391-25db-4397-9bb1-ccb1e2615c33', 'type': 'tool_call'}] usage_metadata={'input_tokens': 641, 'output_tokens': 340, 'total_tokens': 2308, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1327}}
2025-12-21 17:10:31,693 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nimport pytest\\n\\nfrom astropy.io import fits\\nfrom astropy.io.fits.column import Column\\nfrom astropy.io.fits.diff import (\\n    FITSDiff,\\n    HDUDiff,\\n    HeaderDiff,\\n    ImageDataDiff,\\n    TableDataDiff,\\n)\\nfrom astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU\\nfrom astropy.io.fits.hdu.base import NonstandardExtHDU\\nfrom astropy.io.fits.hdu.table import BinTableHDU\\nfrom astropy.io.fits.header import Header\\nfrom astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH\\n\\nfrom .conftest import FitsTestCase\\n\\n\\nclass TestDiff(FitsTestCase):\\n    def test_vla_diff_identical_files(self):\\n        \\"\\"\\"\\n        Regression test for a bug where FITSDiff would report differences\\n        between identical files containing variable-length array columns with\\n        the \'Q\' format descriptor.\\n        \\"\\"\\"\\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\\n        hdu = fits.BinTableHDU.from_columns([col])\\n        filename = self.temp(\'diffbug.fits\')\\n        hdu.writeto(filename, overwrite=True)\\n\\n        diff = fits.FITSDiff(filename, filename)\\n        assert diff.identical\\n", "relative_path": "astropy/io/fits/tests/test_vla_diff.py"}'}, '__gemini_function_call_thought_signatures__': {'bb66a070-5768-4da4-a9fa-0de748fe5dd8': 'CrgSAY89a1+il8fGdZcu8sRlKGLOQtrjZlWlsRuuvaihuKNLOwRwKU5Re3RwJGZdm1EwyWSjVx2kp3+MhmpkPyblRfQbEIJ5/qpSMdgGaoFTMiu6hV/pLNzmO6WDsTuKqYhqjL2WoyckJogbLNBSLgN8eQr0WpfHdXM+VvUYSsRkApTpBpDHdRoKv76xUkyISxy4vmH4josBLIggyFo5v6smuAkMXQ+ZwqApV4czvuF1De8SNE14Kz3Xn9g4Z12DoZMbvVWPnENnBJ8FpHNDgFYFb2ddOA1lB4hrxL8WtJW9TrAihA01N8cUFH5RT89L/WnM+GTfjaaQJyH7+0deu2XXm53Z4R3z0Thu7GCYMGxHlnrbkv2q0K9wQKWuBgWlUOahCeZob9PgfGhcin7TdghpoQMUucHz5XxeYhQIVBj0NVQlsOnF2L8IqMLfSY1a+0YE6fT/C2DWl4nsEYInMIDaMaYWMDVItZGURnARqwkLNOEviLrFPzFjd/EAHmkjmINJ60zC0/yxi/I558Pgey3Cc2l8JThLRhTqMDZ5foXotjsx2a777CCw8O0rmnVB3dWoPF4k05AO0I9sF61sAqQvxLA2Lf224MVmYi4Zvdtsg5K19x3galJyrm6RUyzWN+6coCBAmlzLkAw36p5mr9CIA4raitZyuab7YttvTM0P413Jmb8KJF9cwfkSuNEah3DSyHE4prsfxxN50f6omPZ+auyOwArQxZOPSsVylpLEoipU39Ljp/lVg9sFbY5Dm29u6cKMKMAuw5gRN3r30zQd5B4hsLrqa/xIINuVmsUY/YwpLQTDic82td/qQbbTqHYFl9wyfCXY5ksSAb8vNWuLXuvm2XIp4NfyxdV0qiZ5xzOL/iiFNJ6VRMguoprr8WFTcCuFMGeYkkK8xHAic64RbJqK60ukPuSKonk4G9QdWPwCBk2OlfDg5zX1SuPvbTgy6S2kBrxFsILsGGjf80VwkDgH0OtMAnB1970ujidTr1oDCFIDoKiJ2KEsjsw8aV2p9pbcgnYtiyU1r674hkhaEWbMDRHYLzd3windb40KU4SSEIT/ipaXpb3eFo7DhoYcQ1Zay0QMrlFei7zI4J5qj3URBf9w8Zp8AmF3/srGw7raVM7w+I7eHlFmLj6lHpw0vW6b7wk/mSne/X7wgyb73S+3VIwr0HJdV3V791WAmSK4jFWmX7wCsabeD2FpBEo2dHs5Ku7HKUhTOViyIT5sJVlCj3S8A+7hqQMYOvquvtzNU5NZd01wTqTE/vj62daPsDHx5BDBG+cwUJ0Tp+OLeTa2pAX/LGw0T7nBPNJ6C1EeKJE5CV8OACSJOerYBLmh669sdhA/UVVZHHAPtoJOZhKczQuiVDyCeYOBu0CBmSKv+0OuPUNL3fPTEZBb/wtZMlacQGvz7QasmLDWxkzUxGtxncVobs1jltq449xgXhwDm/uVDB9r4JGdF1ZEL22vtgop+XigvJlSn4Jtl/ubzcOJXWn4X/HRjKMECkb9ImEWRCJIn9qlxvAUbrNeCG2/uPg2KoMnGbhtRRZY6y7lOWel7kA50Cv/8UPnStfJDqb+GprpMwvEauyMiU96fj7Bey30+8T+SlkJJ7jR88x8SNq0zcoNrZ4DoCxdM8oe6mlnWioBMhRB4Fz5zVpz2fiFA3pCMNq7lzXYjMv1G8EZr9RTf/t6nZlYXs2hBjcmAYvmU67Aln8LNjKnyxZQ5zdqPPemlUjI3/WdXMhX3kTOhh1eC5yr+8FK8OWivgtoi4QvdbaA6Nor3UflEzE+2zN20m+JPc9YTSrKTA23eZ6pdSr4B73LOPV2h0vlT5cxzSX0K3R7DtzNQxxUViPScPzB8sMfvPfs1PIsQHV77eMnr7EsYiFGwSVepxI0sOkafzMph0rKTQ0At0fKhHuHtUnDImnYZLKphmV2Ko/0n+fN9Nxg/LLpfVBM8x0TCijn1zxQMEA6qhZ222R3zFeHidgEbfgkebuy0jmVCgYC2zHeCfSuhGZH4wTnSy1Ti1h135lMYDYZX08d3+DiCzwpovUTwkoU5w+n9DalcoNBLqxi1Ris+NW+ljAI97OtG6Lz6Evt22RIEgfp1xGoQW5PSRCabZeQ5wD+Uyx/3cvJoXjg+DEhFfI6LLR3Kl0bjvMig4vSOPO+3JeMstuW+2yoUORNFSALl6pDan0h+KiEaSc/82kWCZfWkZpGTLb3KMpRPQTcWwnDomDA931N2KLA16bW75cmwR0BKVHjbKdlSWLjxby//3AgGC1d/XGgHs0OUIKs6fRVhJ2Ur6zoy9Z6FqliiA/rJI+zWGF81s5b+IgiPtg1MH/3fd4+jcjGf0sLUMFNuISg95xe5G4uwrhWokKJHbjNnUqu1aUowhSDqL/8gqODU7P27CnnJscQneJqd7r1M/Ip4utIafmSRKCMUj48UOtQfzvh9oGuSnSG/FabLhVtfkJ3A8HmSEfSAbLamW3nMzkQTdCjuXuFBYUp+sZxOrS6ovZDLXKtYCwuTawqoL3QTIWCHuTAwrVf336WsAhyj5U1cjJEosmqnmo71BLavR8pzLlCmlX2uwaqmg4m34XNnxmYU14eLcE5wH3FBiNkdqIKIzoW3w0Gw2M80Q1eVmFejR58T4alq4GLk1OtdrwS96lSzRQ026m+MxZWxK66ip//FwNzfYwSOeeCYgJv9gPEVrBZC7Ct6MkFgdtP06Ezy2OF1wClN3OLCRouivJpKqj5jLlBCCjBcGE/tXLvmrnyBdkTn/3/d29hNMF9ftlq+0iQXl1T8jqeQtaQwYj6mh0BMokvAcGZCfYjIMm3va7ji5cNi3pI2aNMybTKc/NexPX15LiPjEMtNXqopXw+nc0MDdLhfAv2LOfoi5UeQi4/Xp+3rPwjSh1i+npFQuFrODXUPHOzD3vFcRfM0SDXZ53uA2MHZ3dbCUbRtKHOnCkwqBVpCrCacHQP8PSyV9mvKjZsGWPxiGj2e1iMGFpfXiyLUNFMznVgQeFWJzYYg6mL59oa6odYH2NZtc/zvYMbd3Qp9u3Q3fLduDfEnSsG6VEi4Omyh5NlmN/53zb67LnlyhDWKremcIuW7cnKEjYxKyCCn4ycqsxaWighYOpOvS5aQ4YWXHNOU3pC5S/idKtSbeQD+js='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1082, 'end_index': 1612, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 1004, 'candidates_token_count': 343, 'total_token_count': 2021, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2331}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 343}], 'thoughts_token_count': 674, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.07312197448908414, 'model_name': 'gemini-2.5-pro'} id='run--ec29b16d-afb4-40d3-bfa0-06bf6b9bf319-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nimport pytest\n\nfrom astropy.io import fits\nfrom astropy.io.fits.column import Column\nfrom astropy.io.fits.diff import (\n    FITSDiff,\n    HDUDiff,\n    HeaderDiff,\n    ImageDataDiff,\n    TableDataDiff,\n)\nfrom astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU\nfrom astropy.io.fits.hdu.base import NonstandardExtHDU\nfrom astropy.io.fits.hdu.table import BinTableHDU\nfrom astropy.io.fits.header import Header\nfrom astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH\n\nfrom .conftest import FitsTestCase\n\n\nclass TestDiff(FitsTestCase):\n    def test_vla_diff_identical_files(self):\n        """\n        Regression test for a bug where FITSDiff would report differences\n        between identical files containing variable-length array columns with\n        the \'Q\' format descriptor.\n        """\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\n        hdu = fits.BinTableHDU.from_columns([col])\n        filename = self.temp(\'diffbug.fits\')\n        hdu.writeto(filename, overwrite=True)\n\n        diff = fits.FITSDiff(filename, filename)\n        assert diff.identical\n', 'relative_path': 'astropy/io/fits/tests/test_vla_diff.py'}, 'id': 'bb66a070-5768-4da4-a9fa-0de748fe5dd8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1004, 'output_tokens': 343, 'total_tokens': 2021, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 674}}
2025-12-21 17:10:33,478 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/io/fits/tests/test_vla_diff.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1374, 'candidates_token_count': 17, 'total_token_count': 1477, 'cached_content_token_count': 1725, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3375}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1725}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 17}], 'thoughts_token_count': 86}, 'finish_reason': 'STOP', 'avg_logprobs': -0.34050854514626894, 'model_name': 'gemini-2.5-pro'} id='run--6c1f821b-010f-4402-8525-e95c331b0c12-0' usage_metadata={'input_tokens': 1374, 'output_tokens': 17, 'total_tokens': 1477, 'input_token_details': {'cache_read': 1725}, 'output_token_details': {'reasoning': 86}}
2025-12-21 17:10:33,906 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/io/fits/tests/test_vla_diff.py b/astropy/io/fits/tests/test_vla_diff.py
new file mode 100644
index 0000000000..0b6182a4a7
--- /dev/null
+++ b/astropy/io/fits/tests/test_vla_diff.py
@@ -0,0 +1,35 @@
+import numpy as np
+import pytest
+
+from astropy.io import fits
+from astropy.io.fits.column import Column
+from astropy.io.fits.diff import (
+    FITSDiff,
+    HDUDiff,
+    HeaderDiff,
+    ImageDataDiff,
+    TableDataDiff,
+)
+from astropy.io.fits.hdu import HDUList, ImageHDU, PrimaryHDU
+from astropy.io.fits.hdu.base import NonstandardExtHDU
+from astropy.io.fits.hdu.table import BinTableHDU
+from astropy.io.fits.header import Header
+from astropy.utils.misc import _NOT_OVERWRITING_MSG_MATCH
+
+from .conftest import FitsTestCase
+
+
+class TestDiff(FitsTestCase):
+    def test_vla_diff_identical_files(self):
+        """
+        Regression test for a bug where FITSDiff would report differences
+        between identical files containing variable-length array columns with
+        the 'Q' format descriptor.
+        """
+        col = fits.Column('a', format='QD', array=[[0], [0, 0]])
+        hdu = fits.BinTableHDU.from_columns([col])
+        filename = self.temp('diffbug.fits')
+        hdu.writeto(filename, overwrite=True)
+
+        diff = fits.FITSDiff(filename, filename)
+        assert diff.identical

2025-12-21 17:10:33,907 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 17:10:33,944 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 17:10:33,944 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 17:10:34,384 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:10:34,385 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at c0a24c1dc9 Merge pull request #14517 from pllim/drop-i686-wheel

2025-12-21 17:10:34,385 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 17:10:34,486 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:10:34,486 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 17:10:34,486 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 17:10:34,487 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/io/fits/tests in the container
2025-12-21 17:10:34,487 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/io/fits/tests
2025-12-21 17:10:34,588 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:10:34,588 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 17:10:34,589 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/io/fits/tests/test_vla_diff.py in the container
2025-12-21 17:10:34,597 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 17:10:37,361 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/io/fits/tests/test_vla_diff.py"}'}, '__gemini_function_call_thought_signatures__': {'e45fa7d2-7381-4a17-8565-c4bfbb09bbc0': 'CuoFAY89a19Ur/sxqMRkdUCYUMsQ8abzY1rZUOTwnX9f5Ukx6fj4zMnsMJxHeSD2rw+9uf5jkppTgSWvUQz1C9AOJH2bUjPsJ1HNHuAQvHQtbkZTDeaJdKj5suE9lou779VgUnUXAezv6P1lnKKcuqmfMq2TYmAqI48Vt/gCWCWZKj47IrmJ5pVB6xq0lCZE+7F3A7hfPA9zfPARQQYcQpJO7G6YI183Q4mRYdUge2M9892iyBpxlUwp8qwH9AFTiuZ7SmsNm7upVE151RYTVy4ubCWE/WTtzS49n2NhHddbVJof61b3ktdYTW//F9WBQxyx5Zl0xFi8ig73rRi0VwLJHr621xWDBT0KR/bxOvD9AUL9Z5hI7DiPDhHPcD0rJawwFITe0QbhyObn3atMcPblMa5c0iM+qn6YlUk3gfYdvSc7InKG4Yp6txdgWtTyc/1DB8Oy2BjTQFfAzaobVWM5nCEijnHC74QLFC7/YkWlGmjjIqhFzGlWdFasMQzTG5BYesQYOTa5Dc8E5M54H1DiTDpool0wpY4r/wocaRFrN1Qv9t+wpKB3V90goKkJ6KAxAIoOrVl4JBGveOwFu0U8sTcS1HZ3sOFtSnoR/4mFbqPiOIqTm0dZ8AqmxtoOR6WR7/WF8E6UsQDzAF2ok0E2I0PM9qFrn2RRba3mnPlryhn6olJ+UlcUkMNdkKxd7Ps17LywMueHJOZGnRJ9juxCbGm5mdAxNTqXRXwFD76hTKsfboJMbXnYLgegFcPAJzEhI3Ha4EfkTk/eZY3B8yUB2NKLF2UaVA57zE96oM/D3y+xSs9o7BNLR5ijR7oL4knkri09vJ4vF6TxTOAxx8Fn1rLIG0f1TXXc87ODRQohctUFKKYWV8dVWahyAaPZc/zd4hBxMMilxwSPCfzzml2Ey8ti97/kMnD94Jf2cVRYErqP1y5TpE5ov/cNbDANbqtqaFN22PK4P6zeWqP+IAS5FWMc5wELX/PDk2c='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 716, 'candidates_token_count': 22, 'total_token_count': 938, 'prompt_tokens_details': [{'modality': 1, 'token_count': 716}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 22}], 'thoughts_token_count': 200, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5459358908913352, 'model_name': 'gemini-2.5-pro'} id='run--22e49fd2-7261-4db5-896d-bb6b67f98f73-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/io/fits/tests/test_vla_diff.py'}, 'id': 'e45fa7d2-7381-4a17-8565-c4bfbb09bbc0', 'type': 'tool_call'}] usage_metadata={'input_tokens': 716, 'output_tokens': 22, 'total_tokens': 938, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 200}}
2025-12-21 17:10:37,364 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/io/fits/tests/test_vla_diff.py
2025-12-21 17:10:41,264 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 17:10:41,264 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/io/fits/tests/test_vla_diff.
.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.3.dev756+gc0a24c1dc.d20251221.
Running tests in astropy/io/fits/tests/test_vla_diff.py.

Date: 2025-12-21T17:10:40

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

CI: undefined
ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/io/fits/tests/test_vla_diff.py [31mF[0m[31m                                 [100%][0m

=================================== FAILURES ===================================
[31m[1m____________________ TestDiff.test_vla_diff_identical_files ____________________[0m

self = <astropy.io.fits.tests.test_vla_diff.TestDiff object at 0x78dbca1ef400>

    def test_vla_diff_identical_files(self):
        """
        Regression test for a bug where FITSDiff would report differences
        between identical files containing variable-length array columns with
        the 'Q' format descriptor.
        """
        col = fits.Column('a', format='QD', array=[[0], [0, 0]])
        hdu = fits.BinTableHDU.from_columns([col])
        filename = self.temp('diffbug.fits')
        hdu.writeto(filename, overwrite=True)
    
>       diff = fits.FITSDiff(filename, filename)

[1m[31mastropy/io/fits/tests/test_vla_diff.py[0m:34: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31mastropy/io/fits/diff.py[0m:331: in __init__
    super().__init__(a, b)
[1m[31mastropy/io/fits/diff.py[0m:87: in __init__
    self._diff()
[1m[31mastropy/io/fits/diff.py[0m:369: in _diff
    hdu_diff = HDUDiff.fromdiff(self, self.a[idx], self.b[idx])
[1m[31mastropy/io/fits/diff.py[0m:120: in fromdiff
    return cls(a, b, **kwargs)
[1m[31mastropy/io/fits/diff.py[0m:570: in __init__
    super().__init__(a, b)
[1m[31mastropy/io/fits/diff.py[0m:87: in __init__
    self._diff()
[1m[31mastropy/io/fits/diff.py[0m:603: in _diff
    self.diff_data = TableDataDiff.fromdiff(self, self.a.data, self.b.data)
[1m[31mastropy/io/fits/diff.py[0m:120: in fromdiff
    return cls(a, b, **kwargs)
[1m[31mastropy/io/fits/diff.py[0m:1342: in __init__
    super().__init__(a, b)
[1m[31mastropy/io/fits/diff.py[0m:87: in __init__
    self._diff()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <astropy.io.fits.diff.TableDataDiff object at 0x78dbca061400>

    def _diff(self):
        # Much of the code for comparing columns is similar to the code for
        # comparing headers--consider refactoring
        colsa = self.a.columns
        colsb = self.b.columns
    
        if len(colsa) != len(colsb):
            self.diff_column_count = (len(colsa), len(colsb))
    
        # Even if the number of columns are unequal, we still do comparison of
        # any common columns
        colsa = {c.name.lower(): c for c in colsa}
        colsb = {c.name.lower(): c for c in colsb}
    
        if "*" in self.ignore_fields:
            # If all columns are to be ignored, ignore any further differences
            # between the columns
            return
    
        # Keep the user's original ignore_fields list for reporting purposes,
        # but internally use a case-insensitive version
        ignore_fields = {f.lower() for f in self.ignore_fields}
    
        # It might be nice if there were a cleaner way to do this, but for now
        # it'll do
        for fieldname in ignore_fields:
            fieldname = fieldname.lower()
            if fieldname in colsa:
                del colsa[fieldname]
            if fieldname in colsb:
                del colsb[fieldname]
    
        colsa_set = set(colsa.values())
        colsb_set = set(colsb.values())
        self.common_columns = sorted(
            colsa_set.intersection(colsb_set), key=operator.attrgetter("name")
        )
    
        self.common_column_names = {col.name.lower() for col in self.common_columns}
    
        left_only_columns = {
            col.name.lower(): col for col in colsa_set.difference(colsb_set)
        }
        right_only_columns = {
            col.name.lower(): col for col in colsb_set.difference(colsa_set)
        }
    
        if left_only_columns or right_only_columns:
            self.diff_columns = (left_only_columns, right_only_columns)
            self.diff_column_names = ([], [])
    
        if left_only_columns:
            for col in self.a.columns:
                if col.name.lower() in left_only_columns:
                    self.diff_column_names[0].append(col.name)
    
        if right_only_columns:
            for col in self.b.columns:
                if col.name.lower() in right_only_columns:
                    self.diff_column_names[1].append(col.name)
    
        # If the tables have a different number of rows, we don't compare the
        # columns right now.
        # TODO: It might be nice to optionally compare the first n rows where n
        # is the minimum of the row counts between the two tables.
        if len(self.a) != len(self.b):
            self.diff_rows = (len(self.a), len(self.b))
            return
    
        # If the tables contain no rows there's no data to compare, so we're
        # done at this point. (See ticket #178)
        if len(self.a) == len(self.b) == 0:
            return
    
        # Like in the old fitsdiff, compare tables on a column by column basis
        # The difficulty here is that, while FITS column names are meant to be
        # case-insensitive, Astropy still allows, for the sake of flexibility,
        # two columns with the same name but different case.  When columns are
        # accessed in FITS tables, a case-sensitive is tried first, and failing
        # that a case-insensitive match is made.
        # It's conceivable that the same column could appear in both tables
        # being compared, but with different case.
        # Though it *may* lead to inconsistencies in these rare cases, this
        # just assumes that there are no duplicated column names in either
        # table, and that the column names can be treated case-insensitively.
        for col in self.common_columns:
            name_lower = col.name.lower()
            if name_lower in ignore_fields:
                continue
    
            cola = colsa[name_lower]
            colb = colsb[name_lower]
    
            for attr, _ in _COL_ATTRS:
                vala = getattr(cola, attr, None)
                valb = getattr(colb, attr, None)
                if diff_values(vala, valb):
                    self.diff_column_attributes.append(
                        ((col.name.upper(), attr), (vala, valb))
                    )
    
            arra = self.a[col.name]
            arrb = self.b[col.name]
    
            if np.issubdtype(arra.dtype, np.floating) and np.issubdtype(
                arrb.dtype, np.floating
            ):
                diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)
            elif "P" in col.format:
                diffs = (
                    [
                        idx
                        for idx in range(len(arra))
                        if not np.allclose(
                            arra[idx], arrb[idx], rtol=self.rtol, atol=self.atol
                        )
                    ],
                )
            else:
>               diffs = np.where(arra != arrb)
[1m[31mE               ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()[0m

[1m[31mastropy/io/fits/diff.py[0m:1463: ValueError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/io/fits/tests/test_vla_diff.py::[1mTestDiff::test_vla_diff_identical_files[0m - ValueError: The truth value of an array with more than one element is ambig...
[31m============================== [31m[1m1 failed[0m[31m in 0.30s[0m[31m ===============================[0m

2025-12-21 17:11:02,586 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='pytest astropy/io/fits/tests/test_vla_diff.py\n\n<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.3.dev756+gc0a24c1dc.d20251221.\nRunning tests in astropy/io/fits/tests/test_vla_diff.py.\n\nDate: 2025-12-21T17:10:40\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nCI: undefined\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/io/fits/tests/test_vla_diff.py F                                 [100%]\n\n=================================== FAILURES ===================================\n____________________ TestDiff.test_vla_diff_identical_files ____________________\n\nself = <astropy.io.fits.tests.test_vla_diff.TestDiff object at 0x78dbca1ef400>\n\n    def test_vla_diff_identical_files(self):\n        """\n        Regression test for a bug where FITSDiff would report differences\n        between identical files containing variable-length array columns with\n        the \'Q\' format descriptor.\n        """\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\n        hdu = fits.BinTableHDU.from_columns([col])\n        filename = self.temp(\'diffbug.fits\')\n        hdu.writeto(filename, overwrite=True)\n    \n>       diff = fits.FITSDiff(filename, filename)\n\nastropy/io/fits/tests/test_vla_diff.py:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nastropy/io/fits/diff.py:331: in __init__\n    super().__init__(a, b)\nastropy/io/fits/diff.py:87: in __init__\n    self._diff()\nastropy/io/fits/diff.py:369: in _diff\n    hdu_diff = HDUDiff.fromdiff(self, self.a[idx], self.b[idx])\nastropy/io/fits/diff.py:120: in fromdiff\n    return cls(a, b, **kwargs)\nastropy/io/fits/diff.py:570: in __init__\n    super().__init__(a, b)\nastropy/io/fits/diff.py:87: in __init__\n    self._diff()\nastropy/io/fits/diff.py:603: in _diff\n    self.diff_data = TableDataDiff.fromdiff(self, self.a.data, self.b.data)\nastropy/io/fits/diff.py:120: in fromdiff\n    return cls(a, b, **kwargs)\nastropy/io/fits/diff.py:1342: in __init__\n    super().__init__(a, b)\nastropy/io/fits/diff.py:87: in __init__\n    self._diff()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <astropy.io.fits.diff.TableDataDiff object at 0x78dbca061400>\n\n    def _diff(self):\n        # Much of the code for comparing columns is similar to the code for\n        # comparing headers--consider refactoring\n        colsa = self.a.columns\n        colsb = self.b.columns\n    \n        if len(colsa) != len(colsb):\n            self.diff_column_count = (len(colsa), len(colsb))\n    \n        # Even if the number of columns are unequal, we still do comparison of\n        # any common columns\n        colsa = {c.name.lower(): c for c in colsa}\n        colsb = {c.name.lower(): c for c in colsb}\n    \n        if "*" in self.ignore_fields:\n            # If all columns are to be ignored, ignore any further differences\n            # between the columns\n            return\n    \n        # Keep the user\'s original ignore_fields list for reporting purposes,\n        # but internally use a case-insensitive version\n        ignore_fields = {f.lower() for f in self.ignore_fields}\n    \n        # It might be nice if there were a cleaner way to do this, but for now\n        # it\'ll do\n        for fieldname in ignore_fields:\n            fieldname = fieldname.lower()\n            if fieldname in colsa:\n                del colsa[fieldname]\n            if fieldname in colsb:\n                del colsb[fieldname]\n    \n        colsa_set = set(colsa.values())\n        colsb_set = set(colsb.values())\n        self.common_columns = sorted(\n            colsa_set.intersection(colsb_set), key=operator.attrgetter("name")\n        )\n    \n        self.common_column_names = {col.name.lower() for col in self.common_columns}\n    \n        left_only_columns = {\n            col.name.lower(): col for col in colsa_set.difference(colsb_set)\n        }\n        right_only_columns = {\n            col.name.lower(): col for col in colsb_set.difference(colsa_set)\n        }\n    \n        if left_only_columns or right_only_columns:\n            self.diff_columns = (left_only_columns, right_only_columns)\n            self.diff_column_names = ([], [])\n    \n        if left_only_columns:\n            for col in self.a.columns:\n                if col.name.lower() in left_only_columns:\n                    self.diff_column_names[0].append(col.name)\n    \n        if right_only_columns:\n            for col in self.b.columns:\n                if col.name.lower() in right_only_columns:\n                    self.diff_column_names[1].append(col.name)\n    \n        # If the tables have a different number of rows, we don\'t compare the\n        # columns right now.\n        # TODO: It might be nice to optionally compare the first n rows where n\n        # is the minimum of the row counts between the two tables.\n        if len(self.a) != len(self.b):\n            self.diff_rows = (len(self.a), len(self.b))\n            return\n    \n        # If the tables contain no rows there\'s no data to compare, so we\'re\n        # done at this point. (See ticket #178)\n        if len(self.a) == len(self.b) == 0:\n            return\n    \n        # Like in the old fitsdiff, compare tables on a column by column basis\n        # The difficulty here is that, while FITS column names are meant to be\n        # case-insensitive, Astropy still allows, for the sake of flexibility,\n        # two columns with the same name but different case.  When columns are\n        # accessed in FITS tables, a case-sensitive is tried first, and failing\n        # that a case-insensitive match is made.\n        # It\'s conceivable that the same column could appear in both tables\n        # being compared, but with different case.\n        # Though it *may* lead to inconsistencies in these rare cases, this\n        # just assumes that there are no duplicated column names in either\n        # table, and that the column names can be treated case-insensitively.\n        for col in self.common_columns:\n            name_lower = col.name.lower()\n            if name_lower in ignore_fields:\n                continue\n    \n            cola = colsa[name_lower]\n            colb = colsb[name_lower]\n    \n            for attr, _ in _COL_ATTRS:\n                vala = getattr(cola, attr, None)\n                valb = getattr(colb, attr, None)\n                if diff_values(vala, valb):\n                    self.diff_column_attributes.append(\n                        ((col.name.upper(), attr), (vala, valb))\n                    )\n    \n            arra = self.a[col.name]\n            arrb = self.b[col.name]\n    \n            if np.issubdtype(arra.dtype, np.floating) and np.issubdtype(\n                arrb.dtype, np.floating\n            ):\n                diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)\n            elif "P" in col.format:\n                diffs = (\n                    [\n                        idx\n                        for idx in range(len(arra))\n                        if not np.allclose(\n                            arra[idx], arrb[idx], rtol=self.rtol, atol=self.atol\n                        )\n                    ],\n                )\n            else:\n>               diffs = np.where(arra != arrb)\nE               ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\n\nastropy/io/fits/diff.py:1463: ValueError\n=========================== short test summary info ============================\nFAILED astropy/io/fits/tests/test_vla_diff.py::TestDiff::test_vla_diff_identical_files - ValueError: The truth value of an array with more than one element is ambig...\n============================== 1 failed in 0.30s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3595, 'end_index': 4025, 'uri': 'http://docs.astropy.org/en/stable/_modules/astropy/io/fits/diff.html', 'title': '', 'license_': ''}, {'start_index': 3871, 'end_index': 4236, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 4085, 'end_index': 4453, 'uri': 'http://docs.astropy.org/en/stable/_modules/astropy/io/fits/diff.html', 'title': '', 'license_': ''}, {'start_index': 4458, 'end_index': 5075, 'uri': 'http://docs.astropy.org/en/stable/_modules/astropy/io/fits/diff.html', 'title': '', 'license_': ''}, {'start_index': 4919, 'end_index': 5445, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 5293, 'end_index': 8580, 'title': 'Your prompt', 'uri': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 3674, 'candidates_token_count': 2717, 'total_token_count': 6447, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3874}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 2717}], 'thoughts_token_count': 56, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0034584786727843496, 'model_name': 'gemini-2.5-pro'} id='run--e034eb10-ab75-4df1-8381-a7b84c14a067-0' usage_metadata={'input_tokens': 3674, 'output_tokens': 2717, 'total_tokens': 6447, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 56}}
2025-12-21 17:11:41,058 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='pytest astropy/io/fits/tests/test_vla_diff.\n.py\n\n<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.3.dev756+gc0a24c1dc.d20251221.\nRunning tests in astropy/io/fits/tests/test_vla_diff.py.\n\nDate: 2025-12-21T17:10:40\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nCI: undefined\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\n\x1b[1mcollecting ... \x1b[0m\x1b[1m\ncollected 1 item                                                               \x1b[0m\n\nastropy/io/fits/tests/test_vla_diff.py \x1b[31mF\x1b[0m\x1b[31m                                 [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m____________________ TestDiff.test_vla_diff_identical_files ____________________\x1b[0m\n\nself = <astropy.io.fits.tests.test_vla_diff.TestDiff object at 0x78dbca1ef400>\n\n    def test_vla_diff_identical_files(self):\n        """\n        Regression test for a bug where FITSDiff would report differences\n        between identical files containing variable-length array columns with\n        the \'Q\' format descriptor.\n        """\n        col = fits.Column(\'a\', format=\'QD\', array=[[0], [0, 0]])\n        hdu = fits.BinTableHDU.from_columns([col])\n        filename = self.temp(\'diffbug.fits\')\n        hdu.writeto(filename, overwrite=True)\n    \n>       diff = fits.FITSDiff(filename, filename)\n\n\x1b[1m\x1b[31mastropy/io/fits/tests/test_vla_diff.py\x1b[0m:34: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:331: in __init__\n    super().__init__(a, b)\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:87: in __init__\n    self._diff()\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:369: in _diff\n    hdu_diff = HDUDiff.fromdiff(self, self.a[idx], self.b[idx])\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:120: in fromdiff\n    return cls(a, b, **kwargs)\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:570: in __init__\n    super().__init__(a, b)\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:87: in __init__\n    self._diff()\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:603: in _diff\n    self.diff_data = TableDataDiff.fromdiff(self, self.a.data, self.b.data)\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:120: in fromdiff\n    return cls(a, b, **kwargs)\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:1342: in __init__\n    super().__init__(a, b)\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:87: in __init__\n    self._diff()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <astropy.io.fits.diff.TableDataDiff object at 0x78dbca061400>\n\n    def _diff(self):\n        # Much of the code for comparing columns is similar to the code for\n        # comparing headers--consider refactoring\n        colsa = self.a.columns\n        colsb = self.b.columns\n    \n        if len(colsa) != len(colsb):\n            self.diff_column_count = (len(colsa), len(colsb))\n    \n        # Even if the number of columns are unequal, we still do comparison of\n        # any common columns\n        colsa = {c.name.lower(): c for c in colsa}\n        colsb = {c.name.lower(): c for c in colsb}\n    \n        if "*" in self.ignore_fields:\n            # If all columns are to be ignored, ignore any further differences\n            # between the columns\n            return\n    \n        # Keep the user\'s original ignore_fields list for reporting purposes,\n        # but internally use a case-insensitive version\n        ignore_fields = {f.lower() for f in self.ignore_fields}\n    \n        # It might be nice if there were a cleaner way to do this, but for now\n        # it\'ll do\n        for fieldname in ignore_fields:\n            fieldname = fieldname.lower()\n            if fieldname in colsa:\n                del colsa[fieldname]\n            if fieldname in colsb:\n                del colsb[fieldname]\n    \n        colsa_set = set(colsa.values())\n        colsb_set = set(colsb.values())\n        self.common_columns = sorted(\n            colsa_set.intersection(colsb_set), key=operator.attrgetter("name")\n        )\n    \n        self.common_column_names = {col.name.lower() for col in self.common_columns}\n    \n        left_only_columns = {\n            col.name.lower(): col for col in colsa_set.difference(colsb_set)\n        }\n        right_only_columns = {\n            col.name.lower(): col for col in colsb_set.difference(colsa_set)\n        }\n    \n        if left_only_columns or right_only_columns:\n            self.diff_columns = (left_only_columns, right_only_columns)\n            self.diff_column_names = ([], [])\n    \n        if left_only_columns:\n            for col in self.a.columns:\n                if col.name.lower() in left_only_columns:\n                    self.diff_column_names[0].append(col.name)\n    \n        if right_only_columns:\n            for col in self.b.columns:\n                if col.name.lower() in right_only_columns:\n                    self.diff_column_names[1].append(col.name)\n    \n        # If the tables have a different number of rows, we don\'t compare the\n        # columns right now.\n        # TODO: It might be nice to optionally compare the first n rows where n\n        # is the minimum of the row counts between the two tables.\n        if len(self.a) != len(self.b):\n            self.diff_rows = (len(self.a), len(self.b))\n            return\n    \n        # If the tables contain no rows there\'s no data to compare, so we\'re\n        # done at this point. (See ticket #178)\n        if len(self.a) == len(self.b) == 0:\n            return\n    \n        # Like in the old fitsdiff, compare tables on a column by column basis\n        # The difficulty here is that, while FITS column names are meant to be\n        # case-insensitive, Astropy still allows, for the sake of flexibility,\n        # two columns with the same name but different case.  When columns are\n        # accessed in FITS tables, a case-sensitive is tried first, and failing\n        # that a case-insensitive match is made.\n        # It\'s conceivable that the same column could appear in both tables\n        # being compared, but with different case.\n        # Though it *may* lead to inconsistencies in these rare cases, this\n        # just assumes that there are no duplicated column names in either\n        # table, and that the column names can be treated case-insensitively.\n        for col in self.common_columns:\n            name_lower = col.name.lower()\n            if name_lower in ignore_fields:\n                continue\n    \n            cola = colsa[name_lower]\n            colb = colsb[name_lower]\n    \n            for attr, _ in _COL_ATTRS:\n                vala = getattr(cola, attr, None)\n                valb = getattr(colb, attr, None)\n                if diff_values(vala, valb):\n                    self.diff_column_attributes.append(\n                        ((col.name.upper(), attr), (vala, valb))\n                    )\n    \n            arra = self.a[col.name]\n            arrb = self.b[col.name]\n    \n            if np.issubdtype(arra.dtype, np.floating) and np.issubdtype(\n                arrb.dtype, np.floating\n            ):\n                diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)\n            elif "P" in col.format:\n                diffs = (\n                    [\n                        idx\n                        for idx in range(len(arra))\n                        if not np.allclose(\n                            arra[idx], arrb[idx], rtol=self.rtol, atol=self.atol\n                        )\n                    ],\n                )\n            else:\n>               diffs = np.where(arra != arrb)\n\x1b[1m\x1b[31mE               ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()\x1b[0m\n\n\x1b[1m\x1b[31mastropy/io/fits/diff.py\x1b[0m:1463: ValueError\n\x1b[36m\x1b[1m=========================== short test summary info ============================\x1b[0m\n\x1b[31mFAILED\x1b[0m astropy/io/fits/tests/test_vla_diff.py::\x1b[1mTestDiff::test_vla_diff_identical_files\x1b[0m - ValueError: The truth value of an array with more than one element is ambig...\n\x1b[31m============================== \x1b[31m\x1b[1m1 failed\x1b[0m\x1b[31m in 0.30s\x1b[0m\x1b[31m ===============================\x1b[0m' reproduced_bug_commands=['pytest astropy/io/fits/tests/test_vla_diff.py']
2025-12-21 17:11:41,059 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-21 17:11:41,059 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-21 17:11:41,059 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/io/fits/tests/test_vla_diff.py
2025-12-21 17:11:43,199 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 17:11:43,199 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/io/fits/tests/test_vla_diff.
.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.3.dev756+gc0a24c1dc.d20251221.
Running tests in astropy/io/fits/tests/test_vla_diff.py.

Date: 2025-12-21T17:11:42

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

CI: undefined
ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/io/fits/tests/test_vla_diff.py [31mF[0m[31m                                 [100%][0m

=================================== FAILURES ===================================
[31m[1m____________________ TestDiff.test_vla_diff_identical_files ____________________[0m

self = <astropy.io.fits.tests.test_vla_diff.TestDiff object at 0x74c263085a90>

    def test_vla_diff_identical_files(self):
        """
        Regression test for a bug where FITSDiff would report differences
        between identical files containing variable-length array columns with
        the 'Q' format descriptor.
        """
        col = fits.Column('a', format='QD', array=[[0], [0, 0]])
        hdu = fits.BinTableHDU.from_columns([col])
        filename = self.temp('diffbug.fits')
        hdu.writeto(filename, overwrite=True)
    
>       diff = fits.FITSDiff(filename, filename)

[1m[31mastropy/io/fits/tests/test_vla_diff.py[0m:34: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31mastropy/io/fits/diff.py[0m:331: in __init__
    super().__init__(a, b)
[1m[31mastropy/io/fits/diff.py[0m:87: in __init__
    self._diff()
[1m[31mastropy/io/fits/diff.py[0m:369: in _diff
    hdu_diff = HDUDiff.fromdiff(self, self.a[idx], self.b[idx])
[1m[31mastropy/io/fits/diff.py[0m:120: in fromdiff
    return cls(a, b, **kwargs)
[1m[31mastropy/io/fits/diff.py[0m:570: in __init__
    super().__init__(a, b)
[1m[31mastropy/io/fits/diff.py[0m:87: in __init__
    self._diff()
[1m[31mastropy/io/fits/diff.py[0m:603: in _diff
    self.diff_data = TableDataDiff.fromdiff(self, self.a.data, self.b.data)
[1m[31mastropy/io/fits/diff.py[0m:120: in fromdiff
    return cls(a, b, **kwargs)
[1m[31mastropy/io/fits/diff.py[0m:1342: in __init__
    super().__init__(a, b)
[1m[31mastropy/io/fits/diff.py[0m:87: in __init__
    self._diff()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <astropy.io.fits.diff.TableDataDiff object at 0x74c285be1820>

    def _diff(self):
        # Much of the code for comparing columns is similar to the code for
        # comparing headers--consider refactoring
        colsa = self.a.columns
        colsb = self.b.columns
    
        if len(colsa) != len(colsb):
            self.diff_column_count = (len(colsa), len(colsb))
    
        # Even if the number of columns are unequal, we still do comparison of
        # any common columns
        colsa = {c.name.lower(): c for c in colsa}
        colsb = {c.name.lower(): c for c in colsb}
    
        if "*" in self.ignore_fields:
            # If all columns are to be ignored, ignore any further differences
            # between the columns
            return
    
        # Keep the user's original ignore_fields list for reporting purposes,
        # but internally use a case-insensitive version
        ignore_fields = {f.lower() for f in self.ignore_fields}
    
        # It might be nice if there were a cleaner way to do this, but for now
        # it'll do
        for fieldname in ignore_fields:
            fieldname = fieldname.lower()
            if fieldname in colsa:
                del colsa[fieldname]
            if fieldname in colsb:
                del colsb[fieldname]
    
        colsa_set = set(colsa.values())
        colsb_set = set(colsb.values())
        self.common_columns = sorted(
            colsa_set.intersection(colsb_set), key=operator.attrgetter("name")
        )
    
        self.common_column_names = {col.name.lower() for col in self.common_columns}
    
        left_only_columns = {
            col.name.lower(): col for col in colsa_set.difference(colsb_set)
        }
        right_only_columns = {
            col.name.lower(): col for col in colsb_set.difference(colsa_set)
        }
    
        if left_only_columns or right_only_columns:
            self.diff_columns = (left_only_columns, right_only_columns)
            self.diff_column_names = ([], [])
    
        if left_only_columns:
            for col in self.a.columns:
                if col.name.lower() in left_only_columns:
                    self.diff_column_names[0].append(col.name)
    
        if right_only_columns:
            for col in self.b.columns:
                if col.name.lower() in right_only_columns:
                    self.diff_column_names[1].append(col.name)
    
        # If the tables have a different number of rows, we don't compare the
        # columns right now.
        # TODO: It might be nice to optionally compare the first n rows where n
        # is the minimum of the row counts between the two tables.
        if len(self.a) != len(self.b):
            self.diff_rows = (len(self.a), len(self.b))
            return
    
        # If the tables contain no rows there's no data to compare, so we're
        # done at this point. (See ticket #178)
        if len(self.a) == len(self.b) == 0:
            return
    
        # Like in the old fitsdiff, compare tables on a column by column basis
        # The difficulty here is that, while FITS column names are meant to be
        # case-insensitive, Astropy still allows, for the sake of flexibility,
        # two columns with the same name but different case.  When columns are
        # accessed in FITS tables, a case-sensitive is tried first, and failing
        # that a case-insensitive match is made.
        # It's conceivable that the same column could appear in both tables
        # being compared, but with different case.
        # Though it *may* lead to inconsistencies in these rare cases, this
        # just assumes that there are no duplicated column names in either
        # table, and that the column names can be treated case-insensitively.
        for col in self.common_columns:
            name_lower = col.name.lower()
            if name_lower in ignore_fields:
                continue
    
            cola = colsa[name_lower]
            colb = colsb[name_lower]
    
            for attr, _ in _COL_ATTRS:
                vala = getattr(cola, attr, None)
                valb = getattr(colb, attr, None)
                if diff_values(vala, valb):
                    self.diff_column_attributes.append(
                        ((col.name.upper(), attr), (vala, valb))
                    )
    
            arra = self.a[col.name]
            arrb = self.b[col.name]
    
            if np.issubdtype(arra.dtype, np.floating) and np.issubdtype(
                arrb.dtype, np.floating
            ):
                diffs = where_not_allclose(arra, arrb, rtol=self.rtol, atol=self.atol)
            elif "P" in col.format:
                diffs = (
                    [
                        idx
                        for idx in range(len(arra))
                        if not np.allclose(
                            arra[idx], arrb[idx], rtol=self.rtol, atol=self.atol
                        )
                    ],
                )
            else:
>               diffs = np.where(arra != arrb)
[1m[31mE               ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()[0m

[1m[31mastropy/io/fits/diff.py[0m:1463: ValueError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/io/fits/tests/test_vla_diff.py::[1mTestDiff::test_vla_diff_identical_files[0m - ValueError: The truth value of an array with more than one element is ambig...
[31m============================== [31m[1m1 failed[0m[31m in 0.48s[0m[31m ===============================[0m

2025-12-21 17:11:43,199 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-21 17:11:43,199 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-21 17:11:43,203 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-21 17:11:43,203 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 17:11:43,204 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/io/fits in the container
2025-12-21 17:11:43,204 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/io/fits
2025-12-21 17:11:43,305 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:11:43,306 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 17:11:43,306 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/io/fits/diff.py in the container
2025-12-21 17:11:43,316 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 17:11:43,317 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-21 17:11:43,317 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/io/fits/tests/test_vla_diff.py
2025-12-21 17:11:45,113 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 17:11:45,113 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/io/fits/tests/test_vla_diff.
.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.3.dev756+gc0a24c1dc.d20251221.
Running tests in astropy/io/fits/tests/test_vla_diff.py.

Date: 2025-12-21T17:11:44

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

CI: undefined
ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/io/fits/tests/test_vla_diff.py [32m.[0m[32m                                 [100%][0m

[32m============================== [32m[1m1 passed[0m[32m in 0.10s[0m[32m ===============================[0m

2025-12-21 17:11:45,113 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-21 17:11:45,143 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Validation PASSED: Test fails on old, passes on new
2025-12-21 17:11:45,144 - thread-130546535499456.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-12-21 17:11:45,144 - thread-130546535499456.app.docker.base_container - INFO - Closing persistent shell...
2025-12-21 17:11:45,245 - thread-130546535499456.app.docker.base_container - INFO - Cleaning up container and temporary files
