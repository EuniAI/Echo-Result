2025-12-23 17:43:14,704 - thread-125107859076800.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmp6u56x0rp/django
2025-12-23 17:43:14,704 - thread-125107859076800.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-12-23 17:43:14,704 - thread-125107859076800.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.django_1776_django-13512:v1
2025-12-23 17:43:15,230 - thread-125107859076800.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_b27dfa158e
2025-12-23 17:43:15,300 - thread-125107859076800.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_b27dfa158e
2025-12-23 17:43:16,558 - thread-125107859076800.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-12-23 17:43:17,478 - thread-125107859076800.app.docker.base_container - INFO - Persistent shell is ready
2025-12-23 17:43:17,478 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-12-23 17:43:17,709 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:17,709 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:43:17,709 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-12-23 17:43:17,939 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:17,939 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:43:17,939 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && locale-gen
2025-12-23 17:43:37,665 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:37,665 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:
sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.
.gen && locale-gen

Generating locales (this might take a while)...
  en_US.UTF-8... done
Generation complete.

2025-12-23 17:43:37,665 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: export LANG=en_US.UTF-8
2025-12-23 17:43:37,766 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:37,767 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:43:37,767 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: export LANGUAGE=en_US:en
2025-12-23 17:43:37,868 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:37,868 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:43:37,868 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: export LC_ALL=en_US.UTF-8
2025-12-23 17:43:37,969 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:37,970 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:43:37,970 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .
2025-12-23 17:43:42,600 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:43:42,600 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

Obtaining file:///testbed
Requirement already satisfied: asgiref>=3.2.10 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.2) (3.4.1)
Requirement already satisfied: pytz in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.2) (2024.2)
Requirement already satisfied: sqlparse>=0.2.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.2) (0.4.4)
Requirement already satisfied: typing-extensions in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from asgiref>=3.2.10->Django==3.2) (4.1.1)
Installing collected packages: Django
  Attempting uninstall: Django
    Found existing installation: Django 3.2
    Uninstalling Django-3.2:
      Successfully uninstalled Django-3.2
  Running setup.py develop for Django
Successfully installed Django-3.2
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m

2025-12-23 17:43:42,627 - thread-125107859076800.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Retrieving focal code context via external CRA
2025-12-23 17:47:39,843 - thread-125107859076800.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Focal code context retrieved: 2 items
2025-12-23 17:47:39,844 - thread-125107859076800.app.lang_graph.nodes.test_case_retrieval_node - INFO - Retrieving test case context via external CRA
2025-12-23 17:54:55,122 - thread-125107859076800.app.lang_graph.nodes.test_case_retrieval_node - INFO - Test case context retrieved: 14 items
2025-12-23 17:54:55,127 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nAdmin doesn\'t display properly unicode chars in JSONFields.\n\nIssue description: \nDescription\n\t \n\t\t(last modified by ZhaoQi99)\n\t \n>>> import json\n>>> print json.dumps(\'ä¸­å›½\')\n"\\u4e2d\\u56fd"\njson.dumps use ASCII encoding by default when serializing Chinese.\nSo when we edit a JsonField which contains Chinese character in Django admin,it will appear in ASCII characters.\nI have try to fix this this problem in \u200bhttps://github.com/adamchainz/django-mysql/pull/714.And it works prefectly.\n\nIssue comments:\n\n\nPatch Information:\n```diff\ndiff --git a/django/forms/fields.py b/django/forms/fields.py\nindex 9de2c60b35..8235aaac01 100644\n--- a/django/forms/fields.py\n+++ b/django/forms/fields.py\n@@ -1258,7 +1258,7 @@ class JSONField(CharField):\n     def prepare_value(self, value):\n         if isinstance(value, InvalidJSONInput):\n             return value\n-        return json.dumps(value, cls=self.encoder)\n+        return json.dumps(value, cls=self.encoder, ensure_ascii=False)\n \n     def has_changed(self, initial, data):\n         if super().has_changed(initial, data):\ndiff --git a/docs/ref/forms/fields.txt b/docs/ref/forms/fields.txt\nindex 9cff981022..5655abf863 100644\n--- a/docs/ref/forms/fields.txt\n+++ b/docs/ref/forms/fields.txt\n@@ -793,6 +793,8 @@ For each field, we describe the default widget used if you don\'t specify\n     * Validates that the given value is a valid JSON.\n     * Error message keys: ``required``, ``invalid``\n \n+    When preparing the value for display, non-ASCII characters are not escaped (``ensure_ascii=False``).\n+\n     Takes two optional arguments:\n \n     .. attribute:: encoder\n\n```\n\nFocal Code Context (relevant code that may need fixing):\n{\'relative_path\': \'django/db/models/fields/json.py\', \'content\': \'1. import json\\n2. \\n3. from django import forms\\n4. from django.core import checks, exceptions\\n5. from django.db import NotSupportedError, connections, router\\n6. from django.db.models import lookups\\n7. from django.db.models.lookups import PostgresOperatorLookup, Transform\\n8. from django.utils.translation import gettext_lazy as _\\n9. \\n10. from . import Field\\n11. from .mixins import CheckFieldDefaultMixin\\n12. \\n13. __all__ = [\\\'JSONField\\\']\\n14. \\n15. \\n16. class JSONField(CheckFieldDefaultMixin, Field):\\n17.     empty_strings_allowed = False\\n18.     description = _(\\\'A JSON object\\\')\\n19.     default_error_messages = {\\n20.         \\\'invalid\\\': _(\\\'Value must be valid JSON.\\\'),\\n21.     }\\n22.     _default_hint = (\\\'dict\\\', \\\'{}\\\')\\n23. \\n24.     def __init__(\\n25.         self, verbose_name=None, name=None, encoder=None, decoder=None,\\n26.         **kwargs,\\n27.     ):\\n28.         if encoder and not callable(encoder):\\n29.             raise ValueError(\\\'The encoder parameter must be a callable object.\\\')\\n30.         if decoder and not callable(decoder):\\n31.             raise ValueError(\\\'The decoder parameter must be a callable object.\\\')\\n32.         self.encoder = encoder\\n33.         self.decoder = decoder\\n34.         super().__init__(verbose_name, name, **kwargs)\\n35. \\n36.     def check(self, **kwargs):\\n37.         errors = super().check(**kwargs)\\n38.         databases = kwargs.get(\\\'databases\\\') or []\\n39.         errors.extend(self._check_supported(databases))\\n40.         return errors\\n41. \\n42.     def _check_supported(self, databases):\\n43.         errors = []\\n44.         for db in databases:\\n45.             if not router.allow_migrate_model(db, self.model):\\n46.                 continue\\n47.             connection = connections[db]\\n48.             if not (\\n49.                 \\\'supports_json_field\\\' in self.model._meta.required_db_features or\\n50.                 connection.features.supports_json_field\\n51.             ):\\n52.                 errors.append(\\n53.                     checks.Error(\\n54.                         \\\'%s does not support JSONFields.\\\'\\n55.                         % connection.display_name,\\n56.                         obj=self.model,\\n57.                         id=\\\'fields.E180\\\',\\n58.                     )\\n59.                 )\\n60.         return errors\\n61. \\n62.     def deconstruct(self):\\n63.         name, path, args, kwargs = super().deconstruct()\\n64.         if self.encoder is not None:\\n65.             kwargs[\\\'encoder\\\'] = self.encoder\\n66.         if self.decoder is not None:\\n67.             kwargs[\\\'decoder\\\'] = self.decoder\\n68.         return name, path, args, kwargs\\n69. \\n70.     def from_db_value(self, value, expression, connection):\\n71.         if value is None:\\n72.             return value\\n73.         try:\\n74.             return json.loads(value, cls=self.decoder)\\n75.         except json.JSONDecodeError:\\n76.             return value\\n77. \\n78.     def get_internal_type(self):\\n79.         return \\\'JSONField\\\'\\n80. \\n81.     def get_prep_value(self, value):\\n82.         if value is None:\\n83.             return value\\n84.         return json.dumps(value, cls=self.encoder)\\n85. \\n86.     def get_transform(self, name):\\n87.         transform = super().get_transform(name)\\n88.         if transform:\\n89.             return transform\\n90.         return KeyTransformFactory(name)\\n91. \\n92.     def validate(self, value, model_instance):\\n93.         super().validate(value, model_instance)\\n94.         try:\\n95.             json.dumps(value, cls=self.encoder)\\n96.         except TypeError:\\n97.             raise exceptions.ValidationError(\\n98.                 self.error_messages[\\\'invalid\\\'],\\n99.                 code=\\\'invalid\\\',\\n100.                 params={\\\'value\\\': value},\\n101.             )\\n102. \\n103.     def value_to_string(self, obj):\\n104.         return self.value_from_object(obj)\\n105. \\n106.     def formfield(self, **kwargs):\\n107.         return super().formfield(**{\\n108.             \\\'form_class\\\': forms.JSONField,\\n109.             \\\'encoder\\\': self.encoder,\\n110.             \\\'decoder\\\': self.decoder,\\n111.             **kwargs,\\n112.         })\\n113. \\n114. \\n115. def compile_json_path(key_transforms, include_root=True):\\n116.     path = [\\\'$\\\'] if include_root else []\\n117.     for key_transform in key_transforms:\\n118.         try:\\n119.             num = int(key_transform)\\n120.         except ValueError:  # non-integer\\n121.             path.append(\\\'.\\\')\\n122.             path.append(json.dumps(key_transform))\\n123.         else:\\n124.             path.append(\\\'[%s]\\\' % num)\\n125.     return \\\'\\\'.join(path)\\n126. \\n127. \\n128. class DataContains(PostgresOperatorLookup):\\n129.     lookup_name = \\\'contains\\\'\\n130.     postgres_operator = \\\'@>\\\'\\n131. \\n132.     def as_sql(self, compiler, connection):\\n133.         if not connection.features.supports_json_field_contains:\\n134.             raise NotSupportedError(\\n135.                 \\\'contains lookup is not supported on this database backend.\\\'\\n136.             )\\n137.         lhs, lhs_params = self.process_lhs(compiler, connection)\\n138.         rhs, rhs_params = self.process_rhs(compiler, connection)\\n139.         params = tuple(lhs_params) + tuple(rhs_params)\\n140.         return \\\'JSON_CONTAINS(%s, %s)\\\' % (lhs, rhs), params\\n141. \\n142. \\n143. class ContainedBy(PostgresOperatorLookup):\\n144.     lookup_name = \\\'contained_by\\\'\\n145.     postgres_operator = \\\'<@\\\'\\n146. \\n147.     def as_sql(self, compiler, connection):\\n148.         if not connection.features.supports_json_field_contains:\\n149.             raise NotSupportedError(\\n150.                 \\\'contained_by lookup is not supported on this database backend.\\\'\\n151.             )\\n152.         lhs, lhs_params = self.process_lhs(compiler, connection)\\n153.         rhs, rhs_params = self.process_rhs(compiler, connection)\\n154.         params = tuple(rhs_params) + tuple(lhs_params)\\n155.         return \\\'JSON_CONTAINS(%s, %s)\\\' % (rhs, lhs), params\\n156. \\n157. \\n158. class HasKeyLookup(PostgresOperatorLookup):\\n159.     logical_operator = None\\n160. \\n161.     def as_sql(self, compiler, connection, template=None):\\n162.         # Process JSON path from the left-hand side.\\n163.         if isinstance(self.lhs, KeyTransform):\\n164.             lhs, lhs_params, lhs_key_transforms = self.lhs.preprocess_lhs(compiler, connection)\\n165.             lhs_json_path = compile_json_path(lhs_key_transforms)\\n166.         else:\\n167.             lhs, lhs_params = self.process_lhs(compiler, connection)\\n168.             lhs_json_path = \\\'$\\\'\\n169.         sql = template % lhs\\n170.         # Process JSON path from the right-hand side.\\n171.         rhs = self.rhs\\n172.         rhs_params = []\\n173.         if not isinstance(rhs, (list, tuple)):\\n174.             rhs = [rhs]\\n175.         for key in rhs:\\n176.             if isinstance(key, KeyTransform):\\n177.                 *_, rhs_key_transforms = key.preprocess_lhs(compiler, connection)\\n178.             else:\\n179.                 rhs_key_transforms = [key]\\n180.             rhs_params.append(\\\'%s%s\\\' % (\\n181.                 lhs_json_path,\\n182.                 compile_json_path(rhs_key_transforms, include_root=False),\\n183.             ))\\n184.         # Add condition for each key.\\n185.         if self.logical_operator:\\n186.             sql = \\\'(%s)\\\' % self.logical_operator.join([sql] * len(rhs_params))\\n187.         return sql, tuple(lhs_params) + tuple(rhs_params)\\n188. \\n189.     def as_mysql(self, compiler, connection):\\n190.         return self.as_sql(compiler, connection, template="JSON_CONTAINS_PATH(%s, \\\'one\\\', %%s)")\\n191. \\n192.     def as_oracle(self, compiler, connection):\\n193.         sql, params = self.as_sql(compiler, connection, template="JSON_EXISTS(%s, \\\'%%s\\\')")\\n194.         # Add paths directly into SQL because path expressions cannot be passed\\n195.         # as bind variables on Oracle.\\n196.         return sql % tuple(params), []\\n197. \\n198.     def as_postgresql(self, compiler, connection):\\n199.         if isinstance(self.rhs, KeyTransform):\\n200.             *_, rhs_key_transforms = self.rhs.preprocess_lhs(compiler, connection)\\n201.             for key in rhs_key_transforms[:-1]:\\n202.                 self.lhs = KeyTransform(key, self.lhs)\\n203.             self.rhs = rhs_key_transforms[-1]\\n204.         return super().as_postgresql(compiler, connection)\\n205. \\n206.     def as_sqlite(self, compiler, connection):\\n207.         return self.as_sql(compiler, connection, template=\\\'JSON_TYPE(%s, %%s) IS NOT NULL\\\')\\n208. \\n209. \\n210. class HasKey(HasKeyLookup):\\n211.     lookup_name = \\\'has_key\\\'\\n212.     postgres_operator = \\\'?\\\'\\n213.     prepare_rhs = False\\n214. \\n215. \\n216. class HasKeys(HasKeyLookup):\\n217.     lookup_name = \\\'has_keys\\\'\\n218.     postgres_operator = \\\'?&\\\'\\n219.     logical_operator = \\\' AND \\\'\\n220. \\n221.     def get_prep_lookup(self):\\n222.         return [str(item) for item in self.rhs]\\n223. \\n224. \\n225. class HasAnyKeys(HasKeys):\\n226.     lookup_name = \\\'has_any_keys\\\'\\n227.     postgres_operator = \\\'?|\\\'\\n228.     logical_operator = \\\' OR \\\'\\n229. \\n230. \\n231. class JSONExact(lookups.Exact):\\n232.     can_use_none_as_rhs = True\\n233. \\n234.     def process_lhs(self, compiler, connection):\\n235.         lhs, lhs_params = super().process_lhs(compiler, connection)\\n236.         if connection.vendor == \\\'sqlite\\\':\\n237.             rhs, rhs_params = super().process_rhs(compiler, connection)\\n238.             if rhs == \\\'%s\\\' and rhs_params == [None]:\\n239.                 # Use JSON_TYPE instead of JSON_EXTRACT for NULLs.\\n240.                 lhs = "JSON_TYPE(%s, \\\'$\\\')" % lhs\\n241.         return lhs, lhs_params\\n242. \\n243.     def process_rhs(self, compiler, connection):\\n244.         rhs, rhs_params = super().process_rhs(compiler, connection)\\n245.         # Treat None lookup values as null.\\n246.         if rhs == \\\'%s\\\' and rhs_params == [None]:\\n247.             rhs_params = [\\\'null\\\']\\n248.         if connection.vendor == \\\'mysql\\\':\\n249.             func = ["JSON_EXTRACT(%s, \\\'$\\\')"] * len(rhs_params)\\n250.             rhs = rhs % tuple(func)\\n251.         return rhs, rhs_params\\n252. \\n253. \\n254. JSONField.register_lookup(DataContains)\\n255. JSONField.register_lookup(ContainedBy)\\n256. JSONField.register_lookup(HasKey)\\n257. JSONField.register_lookup(HasKeys)\\n258. JSONField.register_lookup(HasAnyKeys)\\n259. JSONField.register_lookup(JSONExact)\\n260. \\n261. \\n262. class KeyTransform(Transform):\\n263.     postgres_operator = \\\'->\\\'\\n264.     postgres_nested_operator = \\\'#>\\\'\\n265. \\n266.     def __init__(self, key_name, *args, **kwargs):\\n267.         super().__init__(*args, **kwargs)\\n268.         self.key_name = str(key_name)\\n269. \\n270.     def preprocess_lhs(self, compiler, connection, lhs_only=False):\\n271.         if not lhs_only:\\n272.             key_transforms = [self.key_name]\\n273.         previous = self.lhs\\n274.         while isinstance(previous, KeyTransform):\\n275.             if not lhs_only:\\n276.                 key_transforms.insert(0, previous.key_name)\\n277.             previous = previous.lhs\\n278.         lhs, params = compiler.compile(previous)\\n279.         if connection.vendor == \\\'oracle\\\':\\n280.             # Escape string-formatting.\\n281.             key_transforms = [key.replace(\\\'%\\\', \\\'%%\\\') for key in key_transforms]\\n282.         return (lhs, params, key_transforms) if not lhs_only else (lhs, params)\\n283. \\n284.     def as_mysql(self, compiler, connection):\\n285.         lhs, params, key_transforms = self.preprocess_lhs(compiler, connection)\\n286.         json_path = compile_json_path(key_transforms)\\n287.         return \\\'JSON_EXTRACT(%s, %%s)\\\' % lhs, tuple(params) + (json_path,)\\n288. \\n289.     def as_oracle(self, compiler, connection):\\n290.         lhs, params, key_transforms = self.preprocess_lhs(compiler, connection)\\n291.         json_path = compile_json_path(key_transforms)\\n292.         return (\\n293.             "COALESCE(JSON_QUERY(%s, \\\'%s\\\'), JSON_VALUE(%s, \\\'%s\\\'))" %\\n294.             ((lhs, json_path) * 2)\\n295.         ), tuple(params) * 2\\n296. \\n297.     def as_postgresql(self, compiler, connection):\\n298.         lhs, params, key_transforms = self.preprocess_lhs(compiler, connection)\\n299.         if len(key_transforms) > 1:\\n300.             return \\\'(%s %s %%s)\\\' % (lhs, self.postgres_nested_operator), params + [key_transforms]\\n301.         try:\\n302.             lookup = int(self.key_name)\\n303.         except ValueError:\\n304.             lookup = self.key_name\\n305.         return \\\'(%s %s %%s)\\\' % (lhs, self.postgres_operator), tuple(params) + (lookup,)\\n306. \\n307.     def as_sqlite(self, compiler, connection):\\n308.         lhs, params, key_transforms = self.preprocess_lhs(compiler, connection)\\n309.         json_path = compile_json_path(key_transforms)\\n310.         return \\\'JSON_EXTRACT(%s, %%s)\\\' % lhs, tuple(params) + (json_path,)\\n311. \\n312. \\n313. class KeyTextTransform(KeyTransform):\\n314.     postgres_operator = \\\'->>\\\'\\n315.     postgres_nested_operator = \\\'#>>\\\'\\n316. \\n317. \\n318. class KeyTransformTextLookupMixin:\\n319.     """\\n320.     Mixin for combining with a lookup expecting a text lhs from a JSONField\\n321.     key lookup. On PostgreSQL, make use of the ->> operator instead of casting\\n322.     key values to text and performing the lookup on the resulting\\n323.     representation.\\n324.     """\\n325.     def __init__(self, key_transform, *args, **kwargs):\\n326.         if not isinstance(key_transform, KeyTransform):\\n327.             raise TypeError(\\n328.                 \\\'Transform should be an instance of KeyTransform in order to \\\'\\n329.                 \\\'use this lookup.\\\'\\n330.             )\\n331.         key_text_transform = KeyTextTransform(\\n332.             key_transform.key_name, *key_transform.source_expressions,\\n333.             **key_transform.extra,\\n334.         )\\n335.         super().__init__(key_text_transform, *args, **kwargs)\\n336. \\n337. \\n338. class CaseInsensitiveMixin:\\n339.     """\\n340.     Mixin to allow case-insensitive comparison of JSON values on MySQL.\\n341.     MySQL handles strings used in JSON context using the utf8mb4_bin collation.\\n342.     Because utf8mb4_bin is a binary collation, comparison of JSON values is\\n343.     case-sensitive.\\n344.     """\\n345.     def process_lhs(self, compiler, connection):\\n346.         lhs, lhs_params = super().process_lhs(compiler, connection)\\n347.         if connection.vendor == \\\'mysql\\\':\\n348.             return \\\'LOWER(%s)\\\' % lhs, lhs_params\\n349.         return lhs, lhs_params\\n350. \\n351.     def process_rhs(self, compiler, connection):\\n352.         rhs, rhs_params = super().process_rhs(compiler, connection)\\n353.         if connection.vendor == \\\'mysql\\\':\\n354.             return \\\'LOWER(%s)\\\' % rhs, rhs_params\\n355.         return rhs, rhs_params\\n356. \\n357. \\n358. class KeyTransformIsNull(lookups.IsNull):\\n359.     # key__isnull=False is the same as has_key=\\\'key\\\'\\n360.     def as_oracle(self, compiler, connection):\\n361.         if not self.rhs:\\n362.             return HasKey(self.lhs.lhs, self.lhs.key_name).as_oracle(compiler, connection)\\n363.         return super().as_sql(compiler, connection)\\n364. \\n365.     def as_sqlite(self, compiler, connection):\\n366.         if not self.rhs:\\n367.             return HasKey(self.lhs.lhs, self.lhs.key_name).as_sqlite(compiler, connection)\\n368.         return super().as_sql(compiler, connection)\\n369. \\n370. \\n371. class KeyTransformIn(lookups.In):\\n372.     def process_rhs(self, compiler, connection):\\n373.         rhs, rhs_params = super().process_rhs(compiler, connection)\\n374.         if not connection.features.has_native_json_field:\\n375.             func = ()\\n376.             if connection.vendor == \\\'oracle\\\':\\n377.                 func = []\\n378.                 for value in rhs_params:\\n379.                     value = json.loads(value)\\n380.                     function = \\\'JSON_QUERY\\\' if isinstance(value, (list, dict)) else \\\'JSON_VALUE\\\'\\n381.                     func.append("%s(\\\'%s\\\', \\\'$.value\\\')" % (\\n382.                         function,\\n383.                         json.dumps({\\\'value\\\': value}),\\n384.                     ))\\n385.                 func = tuple(func)\\n386.                 rhs_params = ()\\n387.             elif connection.vendor == \\\'mysql\\\' and connection.mysql_is_mariadb:\\n388.                 func = ("JSON_UNQUOTE(JSON_EXTRACT(%s, \\\'$\\\'))",) * len(rhs_params)\\n389.             elif connection.vendor in {\\\'sqlite\\\', \\\'mysql\\\'}:\\n390.                 func = ("JSON_EXTRACT(%s, \\\'$\\\')",) * len(rhs_params)\\n391.             rhs = rhs % func\\n392.         return rhs, rhs_params\\n393. \\n394. \\n395. class KeyTransformExact(JSONExact):\\n396.     def process_lhs(self, compiler, connection):\\n397.         lhs, lhs_params = super().process_lhs(compiler, connection)\\n398.         if connection.vendor == \\\'sqlite\\\':\\n399.             rhs, rhs_params = super().process_rhs(compiler, connection)\\n400.             if rhs == \\\'%s\\\' and rhs_params == [\\\'null\\\']:\\n401.                 lhs, _ = self.lhs.preprocess_lhs(compiler, connection, lhs_only=True)\\n402.                 lhs = \\\'JSON_TYPE(%s, %%s)\\\' % lhs\\n403.         return lhs, lhs_params\\n404. \\n405.     def process_rhs(self, compiler, connection):\\n406.         if isinstance(self.rhs, KeyTransform):\\n407.             return super(lookups.Exact, self).process_rhs(compiler, connection)\\n408.         rhs, rhs_params = super().process_rhs(compiler, connection)\\n409.         if connection.vendor == \\\'oracle\\\':\\n410.             func = []\\n411.             for value in rhs_params:\\n412.                 value = json.loads(value)\\n413.                 function = \\\'JSON_QUERY\\\' if isinstance(value, (list, dict)) else \\\'JSON_VALUE\\\'\\n414.                 func.append("%s(\\\'%s\\\', \\\'$.value\\\')" % (\\n415.                     function,\\n416.                     json.dumps({\\\'value\\\': value}),\\n417.                 ))\\n418.             rhs = rhs % tuple(func)\\n419.             rhs_params = []\\n420.         elif connection.vendor == \\\'sqlite\\\':\\n421.             func = ["JSON_EXTRACT(%s, \\\'$\\\')" if value != \\\'null\\\' else \\\'%s\\\' for value in rhs_params]\\n422.             rhs = rhs % tuple(func)\\n423.         return rhs, rhs_params\\n424. \\n425.     def as_oracle(self, compiler, connection):\\n426.         rhs, rhs_params = super().process_rhs(compiler, connection)\\n427.         if rhs_params == [\\\'null\\\']:\\n428.             # Field has key and it\\\'s NULL.\\n429.             has_key_expr = HasKey(self.lhs.lhs, self.lhs.key_name)\\n430.             has_key_sql, has_key_params = has_key_expr.as_oracle(compiler, connection)\\n431.             is_null_expr = self.lhs.get_lookup(\\\'isnull\\\')(self.lhs, True)\\n432.             is_null_sql, is_null_params = is_null_expr.as_sql(compiler, connection)\\n433.             return (\\n434.                 \\\'%s AND %s\\\' % (has_key_sql, is_null_sql),\\n435.                 tuple(has_key_params) + tuple(is_null_params),\\n436.             )\\n437.         return super().as_sql(compiler, connection)\\n438. \\n439. \\n440. class KeyTransformIExact(CaseInsensitiveMixin, KeyTransformTextLookupMixin, lookups.IExact):\\n441.     pass\\n442. \\n443. \\n444. class KeyTransformIContains(CaseInsensitiveMixin, KeyTransformTextLookupMixin, lookups.IContains):\\n445.     pass\\n446. \\n447. \\n448. class KeyTransformStartsWith(KeyTransformTextLookupMixin, lookups.StartsWith):\\n449.     pass\\n450. \\n451. \\n452. class KeyTransformIStartsWith(CaseInsensitiveMixin, KeyTransformTextLookupMixin, lookups.IStartsWith):\\n453.     pass\\n454. \\n455. \\n456. class KeyTransformEndsWith(KeyTransformTextLookupMixin, lookups.EndsWith):\\n457.     pass\\n458. \\n459. \\n460. class KeyTransformIEndsWith(CaseInsensitiveMixin, KeyTransformTextLookupMixin, lookups.IEndsWith):\\n461.     pass\\n462. \\n463. \\n464. class KeyTransformRegex(KeyTransformTextLookupMixin, lookups.Regex):\\n465.     pass\\n466. \\n467. \\n468. class KeyTransformIRegex(CaseInsensitiveMixin, KeyTransformTextLookupMixin, lookups.IRegex):\\n469.     pass\\n470. \\n471. \\n472. class KeyTransformNumericLookupMixin:\\n473.     def process_rhs(self, compiler, connection):\\n474.         rhs, rhs_params = super().process_rhs(compiler, connection)\\n475.         if not connection.features.has_native_json_field:\\n476.             rhs_params = [json.loads(value) for value in rhs_params]\\n477.         return rhs, rhs_params\\n478. \\n479. \\n480. class KeyTransformLt(KeyTransformNumericLookupMixin, lookups.LessThan):\\n481.     pass\\n482. \\n483. \\n484. class KeyTransformLte(KeyTransformNumericLookupMixin, lookups.LessThanOrEqual):\\n485.     pass\\n486. \\n487. \\n488. class KeyTransformGt(KeyTransformNumericLookupMixin, lookups.GreaterThan):\\n489.     pass\\n490. \\n491. \\n492. class KeyTransformGte(KeyTransformNumericLookupMixin, lookups.GreaterThanOrEqual):\\n493.     pass\\n494. \\n495. \\n496. KeyTransform.register_lookup(KeyTransformIn)\\n497. KeyTransform.register_lookup(KeyTransformExact)\\n498. KeyTransform.register_lookup(KeyTransformIExact)\\n499. KeyTransform.register_lookup(KeyTransformIsNull)\\n500. KeyTransform.register_lookup(KeyTransformIContains)\\n501. KeyTransform.register_lookup(KeyTransformStartsWith)\\n502. KeyTransform.register_lookup(KeyTransformIStartsWith)\\n503. KeyTransform.register_lookup(KeyTransformEndsWith)\\n504. KeyTransform.register_lookup(KeyTransformIEndsWith)\\n505. KeyTransform.register_lookup(KeyTransformRegex)\\n506. KeyTransform.register_lookup(KeyTransformIRegex)\\n507. \\n508. KeyTransform.register_lookup(KeyTransformLt)\\n509. KeyTransform.register_lookup(KeyTransformLte)\\n510. KeyTransform.register_lookup(KeyTransformGt)\\n511. KeyTransform.register_lookup(KeyTransformGte)\\n512. \\n513. \\n514. class KeyTransformFactory:\\n515. \\n516.     def __init__(self, key_name):\\n517.         self.key_name = key_name\\n518. \\n519.     def __call__(self, *args, **kwargs):\\n520.         return KeyTransform(self.key_name, *args, **kwargs)\', \'start_line_number\': 1, \'end_line_number\': 520}\n\n{\'relative_path\': \'django/forms/fields.py\', \'content\': \'1. """\\n2. Field classes.\\n3. """\\n4. \\n5. import copy\\n6. import datetime\\n7. import json\\n8. import math\\n9. import operator\\n10. import os\\n11. import re\\n12. import uuid\\n13. from decimal import Decimal, DecimalException\\n14. from io import BytesIO\\n15. from urllib.parse import urlsplit, urlunsplit\\n16. \\n17. from django.core import validators\\n18. from django.core.exceptions import ValidationError\\n19. from django.forms.boundfield import BoundField\\n20. from django.forms.utils import from_current_timezone, to_current_timezone\\n21. from django.forms.widgets import (\\n22.     FILE_INPUT_CONTRADICTION, CheckboxInput, ClearableFileInput, DateInput,\\n23.     DateTimeInput, EmailInput, FileInput, HiddenInput, MultipleHiddenInput,\\n24.     NullBooleanSelect, NumberInput, Select, SelectMultiple,\\n25.     SplitDateTimeWidget, SplitHiddenDateTimeWidget, Textarea, TextInput,\\n26.     TimeInput, URLInput,\\n27. )\\n28. from django.utils import formats\\n29. from django.utils.dateparse import parse_datetime, parse_duration\\n30. from django.utils.duration import duration_string\\n31. from django.utils.ipv6 import clean_ipv6_address\\n32. from django.utils.regex_helper import _lazy_re_compile\\n33. from django.utils.translation import gettext_lazy as _, ngettext_lazy\\n34. \\n35. __all__ = (\\n36.     \\\'Field\\\', \\\'CharField\\\', \\\'IntegerField\\\',\\n37.     \\\'DateField\\\', \\\'TimeField\\\', \\\'DateTimeField\\\', \\\'DurationField\\\',\\n38.     \\\'RegexField\\\', \\\'EmailField\\\', \\\'FileField\\\', \\\'ImageField\\\', \\\'URLField\\\',\\n39.     \\\'BooleanField\\\', \\\'NullBooleanField\\\', \\\'ChoiceField\\\', \\\'MultipleChoiceField\\\',\\n40.     \\\'ComboField\\\', \\\'MultiValueField\\\', \\\'FloatField\\\', \\\'DecimalField\\\',\\n41.     \\\'SplitDateTimeField\\\', \\\'GenericIPAddressField\\\', \\\'FilePathField\\\',\\n42.     \\\'JSONField\\\', \\\'SlugField\\\', \\\'TypedChoiceField\\\', \\\'TypedMultipleChoiceField\\\',\\n43.     \\\'UUIDField\\\',\\n44. )\\n45. \\n46. \\n47. class Field:\\n48.     widget = TextInput  # Default widget to use when rendering this type of Field.\\n49.     hidden_widget = HiddenInput  # Default widget to use when rendering this as "hidden".\\n50.     default_validators = []  # Default set of validators\\n51.     # Add an \\\'invalid\\\' entry to default_error_message if you want a specific\\n52.     # field error message not raised by the field validators.\\n53.     default_error_messages = {\\n54.         \\\'required\\\': _(\\\'This field is required.\\\'),\\n55.     }\\n56.     empty_values = list(validators.EMPTY_VALUES)\\n57. \\n58.     def __init__(self, *, required=True, widget=None, label=None, initial=None,\\n59.                  help_text=\\\'\\\', error_messages=None, show_hidden_initial=False,\\n60.                  validators=(), localize=False, disabled=False, label_suffix=None):\\n61.         # required -- Boolean that specifies whether the field is required.\\n62.         #             True by default.\\n63.         # widget -- A Widget class, or instance of a Widget class, that should\\n64.         #           be used for this Field when displaying it. Each Field has a\\n65.         #           default Widget that it\\\'ll use if you don\\\'t specify this. In\\n66.         #           most cases, the default widget is TextInput.\\n67.         # label -- A verbose name for this field, for use in displaying this\\n68.         #          field in a form. By default, Django will use a "pretty"\\n69.         #          version of the form field name, if the Field is part of a\\n70.         #          Form.\\n71.         # initial -- A value to use in this Field\\\'s initial display. This value\\n72.         #            is *not* used as a fallback if data isn\\\'t given.\\n73.         # help_text -- An optional string to use as "help text" for this Field.\\n74.         # error_messages -- An optional dictionary to override the default\\n75.         #                   messages that the field will raise.\\n76.         # show_hidden_initial -- Boolean that specifies if it is needed to render a\\n77.         #                        hidden widget with initial value after widget.\\n78.         # validators -- List of additional validators to use\\n79.         # localize -- Boolean that specifies if the field should be localized.\\n80.         # disabled -- Boolean that specifies whether the field is disabled, that\\n81.         #             is its widget is shown in the form but not editable.\\n82.         # label_suffix -- Suffix to be added to the label. Overrides\\n83.         #                 form\\\'s label_suffix.\\n84.         self.required, self.label, self.initial = required, label, initial\\n85.         self.show_hidden_initial = show_hidden_initial\\n86.         self.help_text = help_text\\n87.         self.disabled = disabled\\n88.         self.label_suffix = label_suffix\\n89.         widget = widget or self.widget\\n90.         if isinstance(widget, type):\\n91.             widget = widget()\\n92.         else:\\n93.             widget = copy.deepcopy(widget)\\n94. \\n95.         # Trigger the localization machinery if needed.\\n96.         self.localize = localize\\n97.         if self.localize:\\n98.             widget.is_localized = True\\n99. \\n100.         # Let the widget know whether it should display as required.\\n101.         widget.is_required = self.required\\n102. \\n103.         # Hook into self.widget_attrs() for any Field-specific HTML attributes.\\n104.         extra_attrs = self.widget_attrs(widget)\\n105.         if extra_attrs:\\n106.             widget.attrs.update(extra_attrs)\\n107. \\n108.         self.widget = widget\\n109. \\n110.         messages = {}\\n111.         for c in reversed(self.__class__.__mro__):\\n112.             messages.update(getattr(c, \\\'default_error_messages\\\', {}))\\n113.         messages.update(error_messages or {})\\n114.         self.error_messages = messages\\n115. \\n116.         self.validators = [*self.default_validators, *validators]\\n117. \\n118.         super().__init__()\\n119. \\n120.     def prepare_value(self, value):\\n121.         return value\\n122. \\n123.     def to_python(self, value):\\n124.         return value\\n125. \\n126.     def validate(self, value):\\n127.         if value in self.empty_values and self.required:\\n128.             raise ValidationError(self.error_messages[\\\'required\\\'], code=\\\'required\\\')\\n129. \\n130.     def run_validators(self, value):\\n131.         if value in self.empty_values:\\n132.             return\\n133.         errors = []\\n134.         for v in self.validators:\\n135.             try:\\n136.                 v(value)\\n137.             except ValidationError as e:\\n138.                 if hasattr(e, \\\'code\\\') and e.code in self.error_messages:\\n139.                     e.message = self.error_messages[e.code]\\n140.                 errors.extend(e.error_list)\\n141.         if errors:\\n142.             raise ValidationError(errors)\\n143. \\n144.     def clean(self, value):\\n145.         """\\n146.         Validate the given value and return its "cleaned" value as an\\n147.         appropriate Python object. Raise ValidationError for any errors.\\n148.         """\\n149.         value = self.to_python(value)\\n150.         self.validate(value)\\n151.         self.run_validators(value)\\n152.         return value\\n153. \\n154.     def bound_data(self, data, initial):\\n155.         """\\n156.         Return the value that should be shown for this field on render of a\\n157.         bound form, given the submitted POST data for the field and the initial\\n158.         data, if any.\\n159. \\n160.         For most fields, this will simply be data; FileFields need to handle it\\n161.         a bit differently.\\n162.         """\\n163.         if self.disabled:\\n164.             return initial\\n165.         return data\\n166. \\n167.     def widget_attrs(self, widget):\\n168.         """\\n169.         Given a Widget instance (*not* a Widget class), return a dictionary of\\n170.         any HTML attributes that should be added to the Widget, based on this\\n171.         Field.\\n172.         """\\n173.         return {}\\n174. \\n175.     def has_changed(self, initial, data):\\n176.         """Return True if data differs from initial."""\\n177.         # Always return False if the field is disabled since self.bound_data\\n178.         # always uses the initial value in this case.\\n179.         if self.disabled:\\n180.             return False\\n181.         try:\\n182.             data = self.to_python(data)\\n183.             if hasattr(self, \\\'_coerce\\\'):\\n184.                 return self._coerce(data) != self._coerce(initial)\\n185.         except ValidationError:\\n186.             return True\\n187.         # For purposes of seeing whether something has changed, None is\\n188.         # the same as an empty string, if the data or initial value we get\\n189.         # is None, replace it with \\\'\\\'.\\n190.         initial_value = initial if initial is not None else \\\'\\\'\\n191.         data_value = data if data is not None else \\\'\\\'\\n192.         return initial_value != data_value\\n193. \\n194.     def get_bound_field(self, form, field_name):\\n195.         """\\n196.         Return a BoundField instance that will be used when accessing the form\\n197.         field in a template.\\n198.         """\\n199.         return BoundField(form, self, field_name)\\n200. \\n201.     def __deepcopy__(self, memo):\\n202.         result = copy.copy(self)\\n203.         memo[id(self)] = result\\n204.         result.widget = copy.deepcopy(self.widget, memo)\\n205.         result.error_messages = self.error_messages.copy()\\n206.         result.validators = self.validators[:]\\n207.         return result\\n208. \\n209. \\n210. class CharField(Field):\\n211.     def __init__(self, *, max_length=None, min_length=None, strip=True, empty_value=\\\'\\\', **kwargs):\\n212.         self.max_length = max_length\\n213.         self.min_length = min_length\\n214.         self.strip = strip\\n215.         self.empty_value = empty_value\\n216.         super().__init__(**kwargs)\\n217.         if min_length is not None:\\n218.             self.validators.append(validators.MinLengthValidator(int(min_length)))\\n219.         if max_length is not None:\\n220.             self.validators.append(validators.MaxLengthValidator(int(max_length)))\\n221.         self.validators.append(validators.ProhibitNullCharactersValidator())\\n222. \\n223.     def to_python(self, value):\\n224.         """Return a string."""\\n225.         if value not in self.empty_values:\\n226.             value = str(value)\\n227.             if self.strip:\\n228.                 value = value.strip()\\n229.         if value in self.empty_values:\\n230.             return self.empty_value\\n231.         return value\\n232. \\n233.     def widget_attrs(self, widget):\\n234.         attrs = super().widget_attrs(widget)\\n235.         if self.max_length is not None and not widget.is_hidden:\\n236.             # The HTML attribute is maxlength, not max_length.\\n237.             attrs[\\\'maxlength\\\'] = str(self.max_length)\\n238.         if self.min_length is not None and not widget.is_hidden:\\n239.             # The HTML attribute is minlength, not min_length.\\n240.             attrs[\\\'minlength\\\'] = str(self.min_length)\\n241.         return attrs\\n242. \\n243. \\n244. class IntegerField(Field):\\n245.     widget = NumberInput\\n246.     default_error_messages = {\\n247.         \\\'invalid\\\': _(\\\'Enter a whole number.\\\'),\\n248.     }\\n249.     re_decimal = _lazy_re_compile(r\\\'\\\\.0*\\\\s*$\\\')\\n250. \\n251.     def __init__(self, *, max_value=None, min_value=None, **kwargs):\\n252.         self.max_value, self.min_value = max_value, min_value\\n253.         if kwargs.get(\\\'localize\\\') and self.widget == NumberInput:\\n254.             # Localized number input is not well supported on most browsers\\n255.             kwargs.setdefault(\\\'widget\\\', super().widget)\\n256.         super().__init__(**kwargs)\\n257. \\n258.         if max_value is not None:\\n259.             self.validators.append(validators.MaxValueValidator(max_value))\\n260.         if min_value is not None:\\n261.             self.validators.append(validators.MinValueValidator(min_value))\\n262. \\n263.     def to_python(self, value):\\n264.         """\\n265.         Validate that int() can be called on the input. Return the result\\n266.         of int() or None for empty values.\\n267.         """\\n268.         value = super().to_python(value)\\n269.         if value in self.empty_values:\\n270.             return None\\n271.         if self.localize:\\n272.             value = formats.sanitize_separators(value)\\n273.         # Strip trailing decimal and zeros.\\n274.         try:\\n275.             value = int(self.re_decimal.sub(\\\'\\\', str(value)))\\n276.         except (ValueError, TypeError):\\n277.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n278.         return value\\n279. \\n280.     def widget_attrs(self, widget):\\n281.         attrs = super().widget_attrs(widget)\\n282.         if isinstance(widget, NumberInput):\\n283.             if self.min_value is not None:\\n284.                 attrs[\\\'min\\\'] = self.min_value\\n285.             if self.max_value is not None:\\n286.                 attrs[\\\'max\\\'] = self.max_value\\n287.         return attrs\\n288. \\n289. \\n290. class FloatField(IntegerField):\\n291.     default_error_messages = {\\n292.         \\\'invalid\\\': _(\\\'Enter a number.\\\'),\\n293.     }\\n294. \\n295.     def to_python(self, value):\\n296.         """\\n297.         Validate that float() can be called on the input. Return the result\\n298.         of float() or None for empty values.\\n299.         """\\n300.         value = super(IntegerField, self).to_python(value)\\n301.         if value in self.empty_values:\\n302.             return None\\n303.         if self.localize:\\n304.             value = formats.sanitize_separators(value)\\n305.         try:\\n306.             value = float(value)\\n307.         except (ValueError, TypeError):\\n308.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n309.         return value\\n310. \\n311.     def validate(self, value):\\n312.         super().validate(value)\\n313.         if value in self.empty_values:\\n314.             return\\n315.         if not math.isfinite(value):\\n316.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n317. \\n318.     def widget_attrs(self, widget):\\n319.         attrs = super().widget_attrs(widget)\\n320.         if isinstance(widget, NumberInput) and \\\'step\\\' not in widget.attrs:\\n321.             attrs.setdefault(\\\'step\\\', \\\'any\\\')\\n322.         return attrs\\n323. \\n324. \\n325. class DecimalField(IntegerField):\\n326.     default_error_messages = {\\n327.         \\\'invalid\\\': _(\\\'Enter a number.\\\'),\\n328.     }\\n329. \\n330.     def __init__(self, *, max_value=None, min_value=None, max_digits=None, decimal_places=None, **kwargs):\\n331.         self.max_digits, self.decimal_places = max_digits, decimal_places\\n332.         super().__init__(max_value=max_value, min_value=min_value, **kwargs)\\n333.         self.validators.append(validators.DecimalValidator(max_digits, decimal_places))\\n334. \\n335.     def to_python(self, value):\\n336.         """\\n337.         Validate that the input is a decimal number. Return a Decimal\\n338.         instance or None for empty values. Ensure that there are no more\\n339.         than max_digits in the number and no more than decimal_places digits\\n340.         after the decimal point.\\n341.         """\\n342.         if value in self.empty_values:\\n343.             return None\\n344.         if self.localize:\\n345.             value = formats.sanitize_separators(value)\\n346.         value = str(value).strip()\\n347.         try:\\n348.             value = Decimal(value)\\n349.         except DecimalException:\\n350.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n351.         return value\\n352. \\n353.     def widget_attrs(self, widget):\\n354.         attrs = super().widget_attrs(widget)\\n355.         if isinstance(widget, NumberInput) and \\\'step\\\' not in widget.attrs:\\n356.             if self.decimal_places is not None:\\n357.                 # Use exponential notation for small values since they might\\n358.                 # be parsed as 0 otherwise. ref #20765\\n359.                 step = str(Decimal(1).scaleb(-self.decimal_places)).lower()\\n360.             else:\\n361.                 step = \\\'any\\\'\\n362.             attrs.setdefault(\\\'step\\\', step)\\n363.         return attrs\\n364. \\n365. \\n366. class BaseTemporalField(Field):\\n367. \\n368.     def __init__(self, *, input_formats=None, **kwargs):\\n369.         super().__init__(**kwargs)\\n370.         if input_formats is not None:\\n371.             self.input_formats = input_formats\\n372. \\n373.     def to_python(self, value):\\n374.         value = value.strip()\\n375.         # Try to strptime against each input format.\\n376.         for format in self.input_formats:\\n377.             try:\\n378.                 return self.strptime(value, format)\\n379.             except (ValueError, TypeError):\\n380.                 continue\\n381.         raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n382. \\n383.     def strptime(self, value, format):\\n384.         raise NotImplementedError(\\\'Subclasses must define this method.\\\')\\n385. \\n386. \\n387. class DateField(BaseTemporalField):\\n388.     widget = DateInput\\n389.     input_formats = formats.get_format_lazy(\\\'DATE_INPUT_FORMATS\\\')\\n390.     default_error_messages = {\\n391.         \\\'invalid\\\': _(\\\'Enter a valid date.\\\'),\\n392.     }\\n393. \\n394.     def to_python(self, value):\\n395.         """\\n396.         Validate that the input can be converted to a date. Return a Python\\n397.         datetime.date object.\\n398.         """\\n399.         if value in self.empty_values:\\n400.             return None\\n401.         if isinstance(value, datetime.datetime):\\n402.             return value.date()\\n403.         if isinstance(value, datetime.date):\\n404.             return value\\n405.         return super().to_python(value)\\n406. \\n407.     def strptime(self, value, format):\\n408.         return datetime.datetime.strptime(value, format).date()\\n409. \\n410. \\n411. class TimeField(BaseTemporalField):\\n412.     widget = TimeInput\\n413.     input_formats = formats.get_format_lazy(\\\'TIME_INPUT_FORMATS\\\')\\n414.     default_error_messages = {\\n415.         \\\'invalid\\\': _(\\\'Enter a valid time.\\\')\\n416.     }\\n417. \\n418.     def to_python(self, value):\\n419.         """\\n420.         Validate that the input can be converted to a time. Return a Python\\n421.         datetime.time object.\\n422.         """\\n423.         if value in self.empty_values:\\n424.             return None\\n425.         if isinstance(value, datetime.time):\\n426.             return value\\n427.         return super().to_python(value)\\n428. \\n429.     def strptime(self, value, format):\\n430.         return datetime.datetime.strptime(value, format).time()\\n431. \\n432. \\n433. class DateTimeFormatsIterator:\\n434.     def __iter__(self):\\n435.         yield from formats.get_format(\\\'DATETIME_INPUT_FORMATS\\\')\\n436.         yield from formats.get_format(\\\'DATE_INPUT_FORMATS\\\')\\n437. \\n438. \\n439. class DateTimeField(BaseTemporalField):\\n440.     widget = DateTimeInput\\n441.     input_formats = DateTimeFormatsIterator()\\n442.     default_error_messages = {\\n443.         \\\'invalid\\\': _(\\\'Enter a valid date/time.\\\'),\\n444.     }\\n445. \\n446.     def prepare_value(self, value):\\n447.         if isinstance(value, datetime.datetime):\\n448.             value = to_current_timezone(value)\\n449.         return value\\n450. \\n451.     def to_python(self, value):\\n452.         """\\n453.         Validate that the input can be converted to a datetime. Return a\\n454.         Python datetime.datetime object.\\n455.         """\\n456.         if value in self.empty_values:\\n457.             return None\\n458.         if isinstance(value, datetime.datetime):\\n459.             return from_current_timezone(value)\\n460.         if isinstance(value, datetime.date):\\n461.             result = datetime.datetime(value.year, value.month, value.day)\\n462.             return from_current_timezone(result)\\n463.         try:\\n464.             result = parse_datetime(value.strip())\\n465.         except ValueError:\\n466.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n467.         if not result:\\n468.             result = super().to_python(value)\\n469.         return from_current_timezone(result)\\n470. \\n471.     def strptime(self, value, format):\\n472.         return datetime.datetime.strptime(value, format)\\n473. \\n474. \\n475. class DurationField(Field):\\n476.     default_error_messages = {\\n477.         \\\'invalid\\\': _(\\\'Enter a valid duration.\\\'),\\n478.         \\\'overflow\\\': _(\\\'The number of days must be between {min_days} and {max_days}.\\\')\\n479.     }\\n480. \\n481.     def prepare_value(self, value):\\n482.         if isinstance(value, datetime.timedelta):\\n483.             return duration_string(value)\\n484.         return value\\n485. \\n486.     def to_python(self, value):\\n487.         if value in self.empty_values:\\n488.             return None\\n489.         if isinstance(value, datetime.timedelta):\\n490.             return value\\n491.         try:\\n492.             value = parse_duration(str(value))\\n493.         except OverflowError:\\n494.             raise ValidationError(self.error_messages[\\\'overflow\\\'].format(\\n495.                 min_days=datetime.timedelta.min.days,\\n496.                 max_days=datetime.timedelta.max.days,\\n497.             ), code=\\\'overflow\\\')\\n498.         if value is None:\\n499.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n500.         return value\\n501. \\n502. \\n503. class RegexField(CharField):\\n504.     def __init__(self, regex, **kwargs):\\n505.         """\\n506.         regex can be either a string or a compiled regular expression object.\\n507.         """\\n508.         kwargs.setdefault(\\\'strip\\\', False)\\n509.         super().__init__(**kwargs)\\n510.         self._set_regex(regex)\\n511. \\n512.     def _get_regex(self):\\n513.         return self._regex\\n514. \\n515.     def _set_regex(self, regex):\\n516.         if isinstance(regex, str):\\n517.             regex = re.compile(regex)\\n518.         self._regex = regex\\n519.         if hasattr(self, \\\'_regex_validator\\\') and self._regex_validator in self.validators:\\n520.             self.validators.remove(self._regex_validator)\\n521.         self._regex_validator = validators.RegexValidator(regex=regex)\\n522.         self.validators.append(self._regex_validator)\\n523. \\n524.     regex = property(_get_regex, _set_regex)\\n525. \\n526. \\n527. class EmailField(CharField):\\n528.     widget = EmailInput\\n529.     default_validators = [validators.validate_email]\\n530. \\n531.     def __init__(self, **kwargs):\\n532.         super().__init__(strip=True, **kwargs)\\n533. \\n534. \\n535. class FileField(Field):\\n536.     widget = ClearableFileInput\\n537.     default_error_messages = {\\n538.         \\\'invalid\\\': _("No file was submitted. Check the encoding type on the form."),\\n539.         \\\'missing\\\': _("No file was submitted."),\\n540.         \\\'empty\\\': _("The submitted file is empty."),\\n541.         \\\'max_length\\\': ngettext_lazy(\\n542.             \\\'Ensure this filename has at most %(max)d character (it has %(length)d).\\\',\\n543.             \\\'Ensure this filename has at most %(max)d characters (it has %(length)d).\\\',\\n544.             \\\'max\\\'),\\n545.         \\\'contradiction\\\': _(\\\'Please either submit a file or check the clear checkbox, not both.\\\')\\n546.     }\\n547. \\n548.     def __init__(self, *, max_length=None, allow_empty_file=False, **kwargs):\\n549.         self.max_length = max_length\\n550.         self.allow_empty_file = allow_empty_file\\n551.         super().__init__(**kwargs)\\n552. \\n553.     def to_python(self, data):\\n554.         if data in self.empty_values:\\n555.             return None\\n556. \\n557.         # UploadedFile objects should have name and size attributes.\\n558.         try:\\n559.             file_name = data.name\\n560.             file_size = data.size\\n561.         except AttributeError:\\n562.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n563. \\n564.         if self.max_length is not None and len(file_name) > self.max_length:\\n565.             params = {\\\'max\\\': self.max_length, \\\'length\\\': len(file_name)}\\n566.             raise ValidationError(self.error_messages[\\\'max_length\\\'], code=\\\'max_length\\\', params=params)\\n567.         if not file_name:\\n568.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n569.         if not self.allow_empty_file and not file_size:\\n570.             raise ValidationError(self.error_messages[\\\'empty\\\'], code=\\\'empty\\\')\\n571. \\n572.         return data\\n573. \\n574.     def clean(self, data, initial=None):\\n575.         # If the widget got contradictory inputs, we raise a validation error\\n576.         if data is FILE_INPUT_CONTRADICTION:\\n577.             raise ValidationError(self.error_messages[\\\'contradiction\\\'], code=\\\'contradiction\\\')\\n578.         # False means the field value should be cleared; further validation is\\n579.         # not needed.\\n580.         if data is False:\\n581.             if not self.required:\\n582.                 return False\\n583.             # If the field is required, clearing is not possible (the widget\\n584.             # shouldn\\\'t return False data in that case anyway). False is not\\n585.             # in self.empty_value; if a False value makes it this far\\n586.             # it should be validated from here on out as None (so it will be\\n587.             # caught by the required check).\\n588.             data = None\\n589.         if not data and initial:\\n590.             return initial\\n591.         return super().clean(data)\\n592. \\n593.     def bound_data(self, data, initial):\\n594.         if data in (None, FILE_INPUT_CONTRADICTION):\\n595.             return initial\\n596.         return data\\n597. \\n598.     def has_changed(self, initial, data):\\n599.         return not self.disabled and data is not None\\n600. \\n601. \\n602. class ImageField(FileField):\\n603.     default_validators = [validators.validate_image_file_extension]\\n604.     default_error_messages = {\\n605.         \\\'invalid_image\\\': _(\\n606.             "Upload a valid image. The file you uploaded was either not an "\\n607.             "image or a corrupted image."\\n608.         ),\\n609.     }\\n610. \\n611.     def to_python(self, data):\\n612.         """\\n613.         Check that the file-upload field data contains a valid image (GIF, JPG,\\n614.         PNG, etc. -- whatever Pillow supports).\\n615.         """\\n616.         f = super().to_python(data)\\n617.         if f is None:\\n618.             return None\\n619. \\n620.         from PIL import Image\\n621. \\n622.         # We need to get a file object for Pillow. We might have a path or we might\\n623.         # have to read the data into memory.\\n624.         if hasattr(data, \\\'temporary_file_path\\\'):\\n625.             file = data.temporary_file_path()\\n626.         else:\\n627.             if hasattr(data, \\\'read\\\'):\\n628.                 file = BytesIO(data.read())\\n629.             else:\\n630.                 file = BytesIO(data[\\\'content\\\'])\\n631. \\n632.         try:\\n633.             # load() could spot a truncated JPEG, but it loads the entire\\n634.             # image in memory, which is a DoS vector. See #3848 and #18520.\\n635.             image = Image.open(file)\\n636.             # verify() must be called immediately after the constructor.\\n637.             image.verify()\\n638. \\n639.             # Annotating so subclasses can reuse it for their own validation\\n640.             f.image = image\\n641.             # Pillow doesn\\\'t detect the MIME type of all formats. In those\\n642.             # cases, content_type will be None.\\n643.             f.content_type = Image.MIME.get(image.format)\\n644.         except Exception as exc:\\n645.             # Pillow doesn\\\'t recognize it as an image.\\n646.             raise ValidationError(\\n647.                 self.error_messages[\\\'invalid_image\\\'],\\n648.                 code=\\\'invalid_image\\\',\\n649.             ) from exc\\n650.         if hasattr(f, \\\'seek\\\') and callable(f.seek):\\n651.             f.seek(0)\\n652.         return f\\n653. \\n654.     def widget_attrs(self, widget):\\n655.         attrs = super().widget_attrs(widget)\\n656.         if isinstance(widget, FileInput) and \\\'accept\\\' not in widget.attrs:\\n657.             attrs.setdefault(\\\'accept\\\', \\\'image/*\\\')\\n658.         return attrs\\n659. \\n660. \\n661. class URLField(CharField):\\n662.     widget = URLInput\\n663.     default_error_messages = {\\n664.         \\\'invalid\\\': _(\\\'Enter a valid URL.\\\'),\\n665.     }\\n666.     default_validators = [validators.URLValidator()]\\n667. \\n668.     def __init__(self, **kwargs):\\n669.         super().__init__(strip=True, **kwargs)\\n670. \\n671.     def to_python(self, value):\\n672. \\n673.         def split_url(url):\\n674.             """\\n675.             Return a list of url parts via urlparse.urlsplit(), or raise\\n676.             ValidationError for some malformed URLs.\\n677.             """\\n678.             try:\\n679.                 return list(urlsplit(url))\\n680.             except ValueError:\\n681.                 # urlparse.urlsplit can raise a ValueError with some\\n682.                 # misformatted URLs.\\n683.                 raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n684. \\n685.         value = super().to_python(value)\\n686.         if value:\\n687.             url_fields = split_url(value)\\n688.             if not url_fields[0]:\\n689.                 # If no URL scheme given, assume http://\\n690.                 url_fields[0] = \\\'http\\\'\\n691.             if not url_fields[1]:\\n692.                 # Assume that if no domain is provided, that the path segment\\n693.                 # contains the domain.\\n694.                 url_fields[1] = url_fields[2]\\n695.                 url_fields[2] = \\\'\\\'\\n696.                 # Rebuild the url_fields list, since the domain segment may now\\n697.                 # contain the path too.\\n698.                 url_fields = split_url(urlunsplit(url_fields))\\n699.             value = urlunsplit(url_fields)\\n700.         return value\\n701. \\n702. \\n703. class BooleanField(Field):\\n704.     widget = CheckboxInput\\n705. \\n706.     def to_python(self, value):\\n707.         """Return a Python boolean object."""\\n708.         # Explicitly check for the string \\\'False\\\', which is what a hidden field\\n709.         # will submit for False. Also check for \\\'0\\\', since this is what\\n710.         # RadioSelect will provide. Because bool("True") == bool(\\\'1\\\') == True,\\n711.         # we don\\\'t need to handle that explicitly.\\n712.         if isinstance(value, str) and value.lower() in (\\\'false\\\', \\\'0\\\'):\\n713.             value = False\\n714.         else:\\n715.             value = bool(value)\\n716.         return super().to_python(value)\\n717. \\n718.     def validate(self, value):\\n719.         if not value and self.required:\\n720.             raise ValidationError(self.error_messages[\\\'required\\\'], code=\\\'required\\\')\\n721. \\n722.     def has_changed(self, initial, data):\\n723.         if self.disabled:\\n724.             return False\\n725.         # Sometimes data or initial may be a string equivalent of a boolean\\n726.         # so we should run it through to_python first to get a boolean value\\n727.         return self.to_python(initial) != self.to_python(data)\\n728. \\n729. \\n730. class NullBooleanField(BooleanField):\\n731.     """\\n732.     A field whose valid values are None, True, and False. Clean invalid values\\n733.     to None.\\n734.     """\\n735.     widget = NullBooleanSelect\\n736. \\n737.     def to_python(self, value):\\n738.         """\\n739.         Explicitly check for the string \\\'True\\\' and \\\'False\\\', which is what a\\n740.         hidden field will submit for True and False, for \\\'true\\\' and \\\'false\\\',\\n741.         which are likely to be returned by JavaScript serializations of forms,\\n742.         and for \\\'1\\\' and \\\'0\\\', which is what a RadioField will submit. Unlike\\n743.         the Booleanfield, this field must check for True because it doesn\\\'t\\n744.         use the bool() function.\\n745.         """\\n746.         if value in (True, \\\'True\\\', \\\'true\\\', \\\'1\\\'):\\n747.             return True\\n748.         elif value in (False, \\\'False\\\', \\\'false\\\', \\\'0\\\'):\\n749.             return False\\n750.         else:\\n751.             return None\\n752. \\n753.     def validate(self, value):\\n754.         pass\\n755. \\n756. \\n757. class CallableChoiceIterator:\\n758.     def __init__(self, choices_func):\\n759.         self.choices_func = choices_func\\n760. \\n761.     def __iter__(self):\\n762.         yield from self.choices_func()\\n763. \\n764. \\n765. class ChoiceField(Field):\\n766.     widget = Select\\n767.     default_error_messages = {\\n768.         \\\'invalid_choice\\\': _(\\\'Select a valid choice. %(value)s is not one of the available choices.\\\'),\\n769.     }\\n770. \\n771.     def __init__(self, *, choices=(), **kwargs):\\n772.         super().__init__(**kwargs)\\n773.         self.choices = choices\\n774. \\n775.     def __deepcopy__(self, memo):\\n776.         result = super().__deepcopy__(memo)\\n777.         result._choices = copy.deepcopy(self._choices, memo)\\n778.         return result\\n779. \\n780.     def _get_choices(self):\\n781.         return self._choices\\n782. \\n783.     def _set_choices(self, value):\\n784.         # Setting choices also sets the choices on the widget.\\n785.         # choices can be any iterable, but we call list() on it because\\n786.         # it will be consumed more than once.\\n787.         if callable(value):\\n788.             value = CallableChoiceIterator(value)\\n789.         else:\\n790.             value = list(value)\\n791. \\n792.         self._choices = self.widget.choices = value\\n793. \\n794.     choices = property(_get_choices, _set_choices)\\n795. \\n796.     def to_python(self, value):\\n797.         """Return a string."""\\n798.         if value in self.empty_values:\\n799.             return \\\'\\\'\\n800.         return str(value)\\n801. \\n802.     def validate(self, value):\\n803.         """Validate that the input is in self.choices."""\\n804.         super().validate(value)\\n805.         if value and not self.valid_value(value):\\n806.             raise ValidationError(\\n807.                 self.error_messages[\\\'invalid_choice\\\'],\\n808.                 code=\\\'invalid_choice\\\',\\n809.                 params={\\\'value\\\': value},\\n810.             )\\n811. \\n812.     def valid_value(self, value):\\n813.         """Check to see if the provided value is a valid choice."""\\n814.         text_value = str(value)\\n815.         for k, v in self.choices:\\n816.             if isinstance(v, (list, tuple)):\\n817.                 # This is an optgroup, so look inside the group for options\\n818.                 for k2, v2 in v:\\n819.                     if value == k2 or text_value == str(k2):\\n820.                         return True\\n821.             else:\\n822.                 if value == k or text_value == str(k):\\n823.                     return True\\n824.         return False\\n825. \\n826. \\n827. class TypedChoiceField(ChoiceField):\\n828.     def __init__(self, *, coerce=lambda val: val, empty_value=\\\'\\\', **kwargs):\\n829.         self.coerce = coerce\\n830.         self.empty_value = empty_value\\n831.         super().__init__(**kwargs)\\n832. \\n833.     def _coerce(self, value):\\n834.         """\\n835.         Validate that the value can be coerced to the right type (if not empty).\\n836.         """\\n837.         if value == self.empty_value or value in self.empty_values:\\n838.             return self.empty_value\\n839.         try:\\n840.             value = self.coerce(value)\\n841.         except (ValueError, TypeError, ValidationError):\\n842.             raise ValidationError(\\n843.                 self.error_messages[\\\'invalid_choice\\\'],\\n844.                 code=\\\'invalid_choice\\\',\\n845.                 params={\\\'value\\\': value},\\n846.             )\\n847.         return value\\n848. \\n849.     def clean(self, value):\\n850.         value = super().clean(value)\\n851.         return self._coerce(value)\\n852. \\n853. \\n854. class MultipleChoiceField(ChoiceField):\\n855.     hidden_widget = MultipleHiddenInput\\n856.     widget = SelectMultiple\\n857.     default_error_messages = {\\n858.         \\\'invalid_choice\\\': _(\\\'Select a valid choice. %(value)s is not one of the available choices.\\\'),\\n859.         \\\'invalid_list\\\': _(\\\'Enter a list of values.\\\'),\\n860.     }\\n861. \\n862.     def to_python(self, value):\\n863.         if not value:\\n864.             return []\\n865.         elif not isinstance(value, (list, tuple)):\\n866.             raise ValidationError(self.error_messages[\\\'invalid_list\\\'], code=\\\'invalid_list\\\')\\n867.         return [str(val) for val in value]\\n868. \\n869.     def validate(self, value):\\n870.         """Validate that the input is a list or tuple."""\\n871.         if self.required and not value:\\n872.             raise ValidationError(self.error_messages[\\\'required\\\'], code=\\\'required\\\')\\n873.         # Validate that each value in the value list is in self.choices.\\n874.         for val in value:\\n875.             if not self.valid_value(val):\\n876.                 raise ValidationError(\\n877.                     self.error_messages[\\\'invalid_choice\\\'],\\n878.                     code=\\\'invalid_choice\\\',\\n879.                     params={\\\'value\\\': val},\\n880.                 )\\n881. \\n882.     def has_changed(self, initial, data):\\n883.         if self.disabled:\\n884.             return False\\n885.         if initial is None:\\n886.             initial = []\\n887.         if data is None:\\n888.             data = []\\n889.         if len(initial) != len(data):\\n890.             return True\\n891.         initial_set = {str(value) for value in initial}\\n892.         data_set = {str(value) for value in data}\\n893.         return data_set != initial_set\\n894. \\n895. \\n896. class TypedMultipleChoiceField(MultipleChoiceField):\\n897.     def __init__(self, *, coerce=lambda val: val, **kwargs):\\n898.         self.coerce = coerce\\n899.         self.empty_value = kwargs.pop(\\\'empty_value\\\', [])\\n900.         super().__init__(**kwargs)\\n901. \\n902.     def _coerce(self, value):\\n903.         """\\n904.         Validate that the values are in self.choices and can be coerced to the\\n905.         right type.\\n906.         """\\n907.         if value == self.empty_value or value in self.empty_values:\\n908.             return self.empty_value\\n909.         new_value = []\\n910.         for choice in value:\\n911.             try:\\n912.                 new_value.append(self.coerce(choice))\\n913.             except (ValueError, TypeError, ValidationError):\\n914.                 raise ValidationError(\\n915.                     self.error_messages[\\\'invalid_choice\\\'],\\n916.                     code=\\\'invalid_choice\\\',\\n917.                     params={\\\'value\\\': choice},\\n918.                 )\\n919.         return new_value\\n920. \\n921.     def clean(self, value):\\n922.         value = super().clean(value)\\n923.         return self._coerce(value)\\n924. \\n925.     def validate(self, value):\\n926.         if value != self.empty_value:\\n927.             super().validate(value)\\n928.         elif self.required:\\n929.             raise ValidationError(self.error_messages[\\\'required\\\'], code=\\\'required\\\')\\n930. \\n931. \\n932. class ComboField(Field):\\n933.     """\\n934.     A Field whose clean() method calls multiple Field clean() methods.\\n935.     """\\n936.     def __init__(self, fields, **kwargs):\\n937.         super().__init__(**kwargs)\\n938.         # Set \\\'required\\\' to False on the individual fields, because the\\n939.         # required validation will be handled by ComboField, not by those\\n940.         # individual fields.\\n941.         for f in fields:\\n942.             f.required = False\\n943.         self.fields = fields\\n944. \\n945.     def clean(self, value):\\n946.         """\\n947.         Validate the given value against all of self.fields, which is a\\n948.         list of Field instances.\\n949.         """\\n950.         super().clean(value)\\n951.         for field in self.fields:\\n952.             value = field.clean(value)\\n953.         return value\\n954. \\n955. \\n956. class MultiValueField(Field):\\n957.     """\\n958.     Aggregate the logic of multiple Fields.\\n959. \\n960.     Its clean() method takes a "decompressed" list of values, which are then\\n961.     cleaned into a single value according to self.fields. Each value in\\n962.     this list is cleaned by the corresponding field -- the first value is\\n963.     cleaned by the first field, the second value is cleaned by the second\\n964.     field, etc. Once all fields are cleaned, the list of clean values is\\n965.     "compressed" into a single value.\\n966. \\n967.     Subclasses should not have to implement clean(). Instead, they must\\n968.     implement compress(), which takes a list of valid values and returns a\\n969.     "compressed" version of those values -- a single value.\\n970. \\n971.     You\\\'ll probably want to use this with MultiWidget.\\n972.     """\\n973.     default_error_messages = {\\n974.         \\\'invalid\\\': _(\\\'Enter a list of values.\\\'),\\n975.         \\\'incomplete\\\': _(\\\'Enter a complete value.\\\'),\\n976.     }\\n977. \\n978.     def __init__(self, fields, *, require_all_fields=True, **kwargs):\\n979.         self.require_all_fields = require_all_fields\\n980.         super().__init__(**kwargs)\\n981.         for f in fields:\\n982.             f.error_messages.setdefault(\\\'incomplete\\\',\\n983.                                         self.error_messages[\\\'incomplete\\\'])\\n984.             if self.disabled:\\n985.                 f.disabled = True\\n986.             if self.require_all_fields:\\n987.                 # Set \\\'required\\\' to False on the individual fields, because the\\n988.                 # required validation will be handled by MultiValueField, not\\n989.                 # by those individual fields.\\n990.                 f.required = False\\n991.         self.fields = fields\\n992. \\n993.     def __deepcopy__(self, memo):\\n994.         result = super().__deepcopy__(memo)\\n995.         result.fields = tuple(x.__deepcopy__(memo) for x in self.fields)\\n996.         return result\\n997. \\n998.     def validate(self, value):\\n999.         pass\\n1000. \\n1001.     def clean(self, value):\\n1002.         """\\n1003.         Validate every value in the given list. A value is validated against\\n1004.         the corresponding Field in self.fields.\\n1005. \\n1006.         For example, if this MultiValueField was instantiated with\\n1007.         fields=(DateField(), TimeField()), clean() would call\\n1008.         DateField.clean(value[0]) and TimeField.clean(value[1]).\\n1009.         """\\n1010.         clean_data = []\\n1011.         errors = []\\n1012.         if self.disabled and not isinstance(value, list):\\n1013.             value = self.widget.decompress(value)\\n1014.         if not value or isinstance(value, (list, tuple)):\\n1015.             if not value or not [v for v in value if v not in self.empty_values]:\\n1016.                 if self.required:\\n1017.                     raise ValidationError(self.error_messages[\\\'required\\\'], code=\\\'required\\\')\\n1018.                 else:\\n1019.                     return self.compress([])\\n1020.         else:\\n1021.             raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n1022.         for i, field in enumerate(self.fields):\\n1023.             try:\\n1024.                 field_value = value[i]\\n1025.             except IndexError:\\n1026.                 field_value = None\\n1027.             if field_value in self.empty_values:\\n1028.                 if self.require_all_fields:\\n1029.                     # Raise a \\\'required\\\' error if the MultiValueField is\\n1030.                     # required and any field is empty.\\n1031.                     if self.required:\\n1032.                         raise ValidationError(self.error_messages[\\\'required\\\'], code=\\\'required\\\')\\n1033.                 elif field.required:\\n1034.                     # Otherwise, add an \\\'incomplete\\\' error to the list of\\n1035.                     # collected errors and skip field cleaning, if a required\\n1036.                     # field is empty.\\n1037.                     if field.error_messages[\\\'incomplete\\\'] not in errors:\\n1038.                         errors.append(field.error_messages[\\\'incomplete\\\'])\\n1039.                     continue\\n1040.             try:\\n1041.                 clean_data.append(field.clean(field_value))\\n1042.             except ValidationError as e:\\n1043.                 # Collect all validation errors in a single list, which we\\\'ll\\n1044.                 # raise at the end of clean(), rather than raising a single\\n1045.                 # exception for the first error we encounter. Skip duplicates.\\n1046.                 errors.extend(m for m in e.error_list if m not in errors)\\n1047.         if errors:\\n1048.             raise ValidationError(errors)\\n1049. \\n1050.         out = self.compress(clean_data)\\n1051.         self.validate(out)\\n1052.         self.run_validators(out)\\n1053.         return out\\n1054. \\n1055.     def compress(self, data_list):\\n1056.         """\\n1057.         Return a single value for the given list of values. The values can be\\n1058.         assumed to be valid.\\n1059. \\n1060.         For example, if this MultiValueField was instantiated with\\n1061.         fields=(DateField(), TimeField()), this might return a datetime\\n1062.         object created by combining the date and time in data_list.\\n1063.         """\\n1064.         raise NotImplementedError(\\\'Subclasses must implement this method.\\\')\\n1065. \\n1066.     def has_changed(self, initial, data):\\n1067.         if self.disabled:\\n1068.             return False\\n1069.         if initial is None:\\n1070.             initial = [\\\'\\\' for x in range(0, len(data))]\\n1071.         else:\\n1072.             if not isinstance(initial, list):\\n1073.                 initial = self.widget.decompress(initial)\\n1074.         for field, initial, data in zip(self.fields, initial, data):\\n1075.             try:\\n1076.                 initial = field.to_python(initial)\\n1077.             except ValidationError:\\n1078.                 return True\\n1079.             if field.has_changed(initial, data):\\n1080.                 return True\\n1081.         return False\\n1082. \\n1083. \\n1084. class FilePathField(ChoiceField):\\n1085.     def __init__(self, path, *, match=None, recursive=False, allow_files=True,\\n1086.                  allow_folders=False, **kwargs):\\n1087.         self.path, self.match, self.recursive = path, match, recursive\\n1088.         self.allow_files, self.allow_folders = allow_files, allow_folders\\n1089.         super().__init__(choices=(), **kwargs)\\n1090. \\n1091.         if self.required:\\n1092.             self.choices = []\\n1093.         else:\\n1094.             self.choices = [("", "---------")]\\n1095. \\n1096.         if self.match is not None:\\n1097.             self.match_re = re.compile(self.match)\\n1098. \\n1099.         if recursive:\\n1100.             for root, dirs, files in sorted(os.walk(self.path)):\\n1101.                 if self.allow_files:\\n1102.                     for f in sorted(files):\\n1103.                         if self.match is None or self.match_re.search(f):\\n1104.                             f = os.path.join(root, f)\\n1105.                             self.choices.append((f, f.replace(path, "", 1)))\\n1106.                 if self.allow_folders:\\n1107.                     for f in sorted(dirs):\\n1108.                         if f == \\\'__pycache__\\\':\\n1109.                             continue\\n1110.                         if self.match is None or self.match_re.search(f):\\n1111.                             f = os.path.join(root, f)\\n1112.                             self.choices.append((f, f.replace(path, "", 1)))\\n1113.         else:\\n1114.             choices = []\\n1115.             for f in os.scandir(self.path):\\n1116.                 if f.name == \\\'__pycache__\\\':\\n1117.                     continue\\n1118.                 if (((self.allow_files and f.is_file()) or\\n1119.                         (self.allow_folders and f.is_dir())) and\\n1120.                         (self.match is None or self.match_re.search(f.name))):\\n1121.                     choices.append((f.path, f.name))\\n1122.             choices.sort(key=operator.itemgetter(1))\\n1123.             self.choices.extend(choices)\\n1124. \\n1125.         self.widget.choices = self.choices\\n1126. \\n1127. \\n1128. class SplitDateTimeField(MultiValueField):\\n1129.     widget = SplitDateTimeWidget\\n1130.     hidden_widget = SplitHiddenDateTimeWidget\\n1131.     default_error_messages = {\\n1132.         \\\'invalid_date\\\': _(\\\'Enter a valid date.\\\'),\\n1133.         \\\'invalid_time\\\': _(\\\'Enter a valid time.\\\'),\\n1134.     }\\n1135. \\n1136.     def __init__(self, *, input_date_formats=None, input_time_formats=None, **kwargs):\\n1137.         errors = self.default_error_messages.copy()\\n1138.         if \\\'error_messages\\\' in kwargs:\\n1139.             errors.update(kwargs[\\\'error_messages\\\'])\\n1140.         localize = kwargs.get(\\\'localize\\\', False)\\n1141.         fields = (\\n1142.             DateField(input_formats=input_date_formats,\\n1143.                       error_messages={\\\'invalid\\\': errors[\\\'invalid_date\\\']},\\n1144.                       localize=localize),\\n1145.             TimeField(input_formats=input_time_formats,\\n1146.                       error_messages={\\\'invalid\\\': errors[\\\'invalid_time\\\']},\\n1147.                       localize=localize),\\n1148.         )\\n1149.         super().__init__(fields, **kwargs)\\n1150. \\n1151.     def compress(self, data_list):\\n1152.         if data_list:\\n1153.             # Raise a validation error if time or date is empty\\n1154.             # (possible if SplitDateTimeField has required=False).\\n1155.             if data_list[0] in self.empty_values:\\n1156.                 raise ValidationError(self.error_messages[\\\'invalid_date\\\'], code=\\\'invalid_date\\\')\\n1157.             if data_list[1] in self.empty_values:\\n1158.                 raise ValidationError(self.error_messages[\\\'invalid_time\\\'], code=\\\'invalid_time\\\')\\n1159.             result = datetime.datetime.combine(*data_list)\\n1160.             return from_current_timezone(result)\\n1161.         return None\\n1162. \\n1163. \\n1164. class GenericIPAddressField(CharField):\\n1165.     def __init__(self, *, protocol=\\\'both\\\', unpack_ipv4=False, **kwargs):\\n1166.         self.unpack_ipv4 = unpack_ipv4\\n1167.         self.default_validators = validators.ip_address_validators(protocol, unpack_ipv4)[0]\\n1168.         super().__init__(**kwargs)\\n1169. \\n1170.     def to_python(self, value):\\n1171.         if value in self.empty_values:\\n1172.             return \\\'\\\'\\n1173.         value = value.strip()\\n1174.         if value and \\\':\\\' in value:\\n1175.             return clean_ipv6_address(value, self.unpack_ipv4)\\n1176.         return value\\n1177. \\n1178. \\n1179. class SlugField(CharField):\\n1180.     default_validators = [validators.validate_slug]\\n1181. \\n1182.     def __init__(self, *, allow_unicode=False, **kwargs):\\n1183.         self.allow_unicode = allow_unicode\\n1184.         if self.allow_unicode:\\n1185.             self.default_validators = [validators.validate_unicode_slug]\\n1186.         super().__init__(**kwargs)\\n1187. \\n1188. \\n1189. class UUIDField(CharField):\\n1190.     default_error_messages = {\\n1191.         \\\'invalid\\\': _(\\\'Enter a valid UUID.\\\'),\\n1192.     }\\n1193. \\n1194.     def prepare_value(self, value):\\n1195.         if isinstance(value, uuid.UUID):\\n1196.             return str(value)\\n1197.         return value\\n1198. \\n1199.     def to_python(self, value):\\n1200.         value = super().to_python(value)\\n1201.         if value in self.empty_values:\\n1202.             return None\\n1203.         if not isinstance(value, uuid.UUID):\\n1204.             try:\\n1205.                 value = uuid.UUID(value)\\n1206.             except ValueError:\\n1207.                 raise ValidationError(self.error_messages[\\\'invalid\\\'], code=\\\'invalid\\\')\\n1208.         return value\\n1209. \\n1210. \\n1211. class InvalidJSONInput(str):\\n1212.     pass\\n1213. \\n1214. \\n1215. class JSONString(str):\\n1216.     pass\\n1217. \\n1218. \\n1219. class JSONField(CharField):\\n1220.     default_error_messages = {\\n1221.         \\\'invalid\\\': _(\\\'Enter a valid JSON.\\\'),\\n1222.     }\\n1223.     widget = Textarea\\n1224. \\n1225.     def __init__(self, encoder=None, decoder=None, **kwargs):\\n1226.         self.encoder = encoder\\n1227.         self.decoder = decoder\\n1228.         super().__init__(**kwargs)\\n1229. \\n1230.     def to_python(self, value):\\n1231.         if self.disabled:\\n1232.             return value\\n1233.         if value in self.empty_values:\\n1234.             return None\\n1235.         elif isinstance(value, (list, dict, int, float, JSONString)):\\n1236.             return value\\n1237.         try:\\n1238.             converted = json.loads(value, cls=self.decoder)\\n1239.         except json.JSONDecodeError:\\n1240.             raise ValidationError(\\n1241.                 self.error_messages[\\\'invalid\\\'],\\n1242.                 code=\\\'invalid\\\',\\n1243.                 params={\\\'value\\\': value},\\n1244.             )\\n1245.         if isinstance(converted, str):\\n1246.             return JSONString(converted)\\n1247.         else:\\n1248.             return converted\\n1249. \\n1250.     def bound_data(self, data, initial):\\n1251.         if self.disabled:\\n1252.             return initial\\n1253.         try:\\n1254.             return json.loads(data, cls=self.decoder)\\n1255.         except json.JSONDecodeError:\\n1256.             return InvalidJSONInput(data)\\n1257. \\n1258.     def prepare_value(self, value):\\n1259.         if isinstance(value, InvalidJSONInput):\\n1260.             return value\\n1261.         return json.dumps(value, cls=self.encoder)\\n1262. \\n1263.     def has_changed(self, initial, data):\\n1264.         if super().has_changed(initial, data):\\n1265.             return True\\n1266.         # For purposes of seeing whether something has changed, True isn\\\'t the\\n1267.         # same as 1 and the order of keys doesn\\\'t matter.\\n1268.         return (\\n1269.             json.dumps(initial, sort_keys=True, cls=self.encoder) !=\\n1270.             json.dumps(self.to_python(data), sort_keys=True, cls=self.encoder)\\n1271.         )\', \'start_line_number\': 1, \'end_line_number\': 1271}\n\nTest Case Context (similar existing tests for reference):\n{\'relative_path\': \'tests/admin_views/models.py\', \'content\': \'1. import datetime\\n2. import os\\n3. import tempfile\\n4. import uuid\\n5. \\n6. from django.contrib.auth.models import User\\n7. from django.contrib.contenttypes.fields import (\\n8.     GenericForeignKey, GenericRelation,\\n9. )\\n10. from django.contrib.contenttypes.models import ContentType\\n11. from django.core.exceptions import ValidationError\\n12. from django.core.files.storage import FileSystemStorage\\n13. from django.db import models\\n14. \\n15. \\n16. class Section(models.Model):\\n17.     """\\n18.     A simple section that links to articles, to test linking to related items\\n19.     in admin views.\\n20.     """\\n21.     name = models.CharField(max_length=100)\\n22. \\n23.     def __str__(self):\\n24.         return self.name\\n25. \\n26.     @property\\n27.     def name_property(self):\\n28.         """\\n29.         A property that simply returns the name. Used to test #24461\\n30.         """\\n31.         return self.name\\n32. \\n33. \\n34. class Article(models.Model):\\n35.     """\\n36.     A simple article to test admin views. Test backwards compatibility.\\n37.     """\\n38.     title = models.CharField(max_length=100)\\n39.     content = models.TextField()\\n40.     date = models.DateTimeField()\\n41.     section = models.ForeignKey(Section, models.CASCADE, null=True, blank=True)\\n42.     another_section = models.ForeignKey(Section, models.CASCADE, null=True, blank=True, related_name=\\\'+\\\')\\n43.     sub_section = models.ForeignKey(Section, models.SET_NULL, null=True, blank=True, related_name=\\\'+\\\')\\n44. \\n45.     def __str__(self):\\n46.         return self.title\\n47. \\n48.     def model_year(self):\\n49.         return self.date.year\\n50.     model_year.admin_order_field = \\\'date\\\'\\n51.     model_year.short_description = \\\'\\\'\\n52. \\n53.     def model_year_reversed(self):\\n54.         return self.date.year\\n55.     model_year_reversed.admin_order_field = \\\'-date\\\'\\n56.     model_year_reversed.short_description = \\\'\\\'\\n57. \\n58.     def property_year(self):\\n59.         return self.date.year\\n60.     property_year.admin_order_field = \\\'date\\\'\\n61.     model_property_year = property(property_year)\\n62. \\n63.     @property\\n64.     def model_month(self):\\n65.         return self.date.month\\n66. \\n67. \\n68. class Book(models.Model):\\n69.     """\\n70.     A simple book that has chapters.\\n71.     """\\n72.     name = models.CharField(max_length=100, verbose_name=\\\'Â¿Name?\\\')\\n73. \\n74.     def __str__(self):\\n75.         return self.name\\n76. \\n77. \\n78. class Promo(models.Model):\\n79.     name = models.CharField(max_length=100, verbose_name=\\\'Â¿Name?\\\')\\n80.     book = models.ForeignKey(Book, models.CASCADE)\\n81.     author = models.ForeignKey(User, models.SET_NULL, blank=True, null=True)\\n82. \\n83.     def __str__(self):\\n84.         return self.name\\n85. \\n86. \\n87. class Chapter(models.Model):\\n88.     title = models.CharField(max_length=100, verbose_name=\\\'Â¿Title?\\\')\\n89.     content = models.TextField()\\n90.     book = models.ForeignKey(Book, models.CASCADE)\\n91. \\n92.     class Meta:\\n93.         # Use a utf-8 bytestring to ensure it works (see #11710)\\n94.         verbose_name = \\\'Â¿Chapter?\\\'\\n95. \\n96.     def __str__(self):\\n97.         return self.title\\n98. \\n99. \\n100. class ChapterXtra1(models.Model):\\n101.     chap = models.OneToOneField(Chapter, models.CASCADE, verbose_name=\\\'Â¿Chap?\\\')\\n102.     xtra = models.CharField(max_length=100, verbose_name=\\\'Â¿Xtra?\\\')\\n103.     guest_author = models.ForeignKey(User, models.SET_NULL, blank=True, null=True)\\n104. \\n105.     def __str__(self):\\n106.         return \\\'Â¿Xtra1: %s\\\' % self.xtra\\n107. \\n108. \\n109. class ChapterXtra2(models.Model):\\n110.     chap = models.OneToOneField(Chapter, models.CASCADE, verbose_name=\\\'Â¿Chap?\\\')\\n111.     xtra = models.CharField(max_length=100, verbose_name=\\\'Â¿Xtra?\\\')\\n112. \\n113.     def __str__(self):\\n114.         return \\\'Â¿Xtra2: %s\\\' % self.xtra\\n115. \\n116. \\n117. class RowLevelChangePermissionModel(models.Model):\\n118.     name = models.CharField(max_length=100, blank=True)\\n119. \\n120. \\n121. class CustomArticle(models.Model):\\n122.     content = models.TextField()\\n123.     date = models.DateTimeField()\\n124. \\n125. \\n126. class ModelWithStringPrimaryKey(models.Model):\\n127.     string_pk = models.CharField(max_length=255, primary_key=True)\\n128. \\n129.     def __str__(self):\\n130.         return self.string_pk\\n131. \\n132.     def get_absolute_url(self):\\n133.         return \\\'/dummy/%s/\\\' % self.string_pk\\n134. \\n135. \\n136. class Color(models.Model):\\n137.     value = models.CharField(max_length=10)\\n138.     warm = models.BooleanField(default=False)\\n139. \\n140.     def __str__(self):\\n141.         return self.value\\n142. \\n143. \\n144. # we replicate Color to register with another ModelAdmin\\n145. class Color2(Color):\\n146.     class Meta:\\n147.         proxy = True\\n148. \\n149. \\n150. class Thing(models.Model):\\n151.     title = models.CharField(max_length=20)\\n152.     color = models.ForeignKey(Color, models.CASCADE, limit_choices_to={\\\'warm\\\': True})\\n153.     pub_date = models.DateField(blank=True, null=True)\\n154. \\n155.     def __str__(self):\\n156.         return self.title\\n157. \\n158. \\n159. class Actor(models.Model):\\n160.     name = models.CharField(max_length=50)\\n161.     age = models.IntegerField()\\n162.     title = models.CharField(max_length=50, null=True, blank=True)\\n163. \\n164.     def __str__(self):\\n165.         return self.name\\n166. \\n167. \\n168. class Inquisition(models.Model):\\n169.     expected = models.BooleanField(default=False)\\n170.     leader = models.ForeignKey(Actor, models.CASCADE)\\n171.     country = models.CharField(max_length=20)\\n172. \\n173.     def __str__(self):\\n174.         return "by %s from %s" % (self.leader, self.country)\\n175. \\n176. \\n177. class Sketch(models.Model):\\n178.     title = models.CharField(max_length=100)\\n179.     inquisition = models.ForeignKey(\\n180.         Inquisition,\\n181.         models.CASCADE,\\n182.         limit_choices_to={\\n183.             \\\'leader__name\\\': \\\'Palin\\\',\\n184.             \\\'leader__age\\\': 27,\\n185.             \\\'expected\\\': False,\\n186.         },\\n187.     )\\n188.     defendant0 = models.ForeignKey(\\n189.         Actor,\\n190.         models.CASCADE,\\n191.         limit_choices_to={\\\'title__isnull\\\': False},\\n192.         related_name=\\\'as_defendant0\\\',\\n193.     )\\n194.     defendant1 = models.ForeignKey(\\n195.         Actor,\\n196.         models.CASCADE,\\n197.         limit_choices_to={\\\'title__isnull\\\': True},\\n198.         related_name=\\\'as_defendant1\\\',\\n199.     )\\n200. \\n201.     def __str__(self):\\n202.         return self.title\\n203. \\n204. \\n205. def today_callable_dict():\\n206.     return {"last_action__gte": datetime.datetime.today()}\\n207. \\n208. \\n209. def today_callable_q():\\n210.     return models.Q(last_action__gte=datetime.datetime.today())\\n211. \\n212. \\n213. class Character(models.Model):\\n214.     username = models.CharField(max_length=100)\\n215.     last_action = models.DateTimeField()\\n216. \\n217.     def __str__(self):\\n218.         return self.username\\n219. \\n220. \\n221. class StumpJoke(models.Model):\\n222.     variation = models.CharField(max_length=100)\\n223.     most_recently_fooled = models.ForeignKey(\\n224.         Character,\\n225.         models.CASCADE,\\n226.         limit_choices_to=today_callable_dict,\\n227.         related_name="+",\\n228.     )\\n229.     has_fooled_today = models.ManyToManyField(Character, limit_choices_to=today_callable_q, related_name="+")\\n230. \\n231.     def __str__(self):\\n232.         return self.variation\\n233. \\n234. \\n235. class Fabric(models.Model):\\n236.     NG_CHOICES = (\\n237.         (\\\'Textured\\\', (\\n238.             (\\\'x\\\', \\\'Horizontal\\\'),\\n239.             (\\\'y\\\', \\\'Vertical\\\'),\\n240.         )),\\n241.         (\\\'plain\\\', \\\'Smooth\\\'),\\n242.     )\\n243.     surface = models.CharField(max_length=20, choices=NG_CHOICES)\\n244. \\n245. \\n246. class Person(models.Model):\\n247.     GENDER_CHOICES = (\\n248.         (1, "Male"),\\n249.         (2, "Female"),\\n250.     )\\n251.     name = models.CharField(max_length=100)\\n252.     gender = models.IntegerField(choices=GENDER_CHOICES)\\n253.     age = models.IntegerField(default=21)\\n254.     alive = models.BooleanField(default=True)\\n255. \\n256.     def __str__(self):\\n257.         return self.name\\n258. \\n259. \\n260. class Persona(models.Model):\\n261.     """\\n262.     A simple persona associated with accounts, to test inlining of related\\n263.     accounts which inherit from a common accounts class.\\n264.     """\\n265.     name = models.CharField(blank=False, max_length=80)\\n266. \\n267.     def __str__(self):\\n268.         return self.name\\n269. \\n270. \\n271. class Account(models.Model):\\n272.     """\\n273.     A simple, generic account encapsulating the information shared by all\\n274.     types of accounts.\\n275.     """\\n276.     username = models.CharField(blank=False, max_length=80)\\n277.     persona = models.ForeignKey(Persona, models.CASCADE, related_name="accounts")\\n278.     servicename = \\\'generic service\\\'\\n279. \\n280.     def __str__(self):\\n281.         return "%s: %s" % (self.servicename, self.username)\\n282. \\n283. \\n284. class FooAccount(Account):\\n285.     """A service-specific account of type Foo."""\\n286.     servicename = \\\'foo\\\'\\n287. \\n288. \\n289. class BarAccount(Account):\\n290.     """A service-specific account of type Bar."""\\n291.     servicename = \\\'bar\\\'\\n292. \\n293. \\n294. class Subscriber(models.Model):\\n295.     name = models.CharField(blank=False, max_length=80)\\n296.     email = models.EmailField(blank=False, max_length=175)\\n297. \\n298.     def __str__(self):\\n299.         return "%s (%s)" % (self.name, self.email)\\n300. \\n301. \\n302. class ExternalSubscriber(Subscriber):\\n303.     pass\\n304. \\n305. \\n306. class OldSubscriber(Subscriber):\\n307.     pass\\n308. \\n309. \\n310. class Media(models.Model):\\n311.     name = models.CharField(max_length=60)\\n312. \\n313. \\n314. class Podcast(Media):\\n315.     release_date = models.DateField()\\n316. \\n317.     class Meta:\\n318.         ordering = (\\\'release_date\\\',)  # overridden in PodcastAdmin\\n319. \\n320. \\n321. class Vodcast(Media):\\n322.     media = models.OneToOneField(Media, models.CASCADE, primary_key=True, parent_link=True)\\n323.     released = models.BooleanField(default=False)\\n324. \\n325. \\n326. class Parent(models.Model):\\n327.     name = models.CharField(max_length=128)\\n328. \\n329.     def clean(self):\\n330.         if self.name == \\\'_invalid\\\':\\n331.             raise ValidationError(\\\'invalid\\\')\\n332. \\n333. \\n334. class Child(models.Model):\\n335.     parent = models.ForeignKey(Parent, models.CASCADE, editable=False)\\n336.     name = models.CharField(max_length=30, blank=True)\\n337. \\n338.     def clean(self):\\n339.         if self.name == \\\'_invalid\\\':\\n340.             raise ValidationError(\\\'invalid\\\')\\n341. \\n342. \\n343. class EmptyModel(models.Model):\\n344.     def __str__(self):\\n345.         return "Primary key = %s" % self.id\\n346. \\n347. \\n348. temp_storage = FileSystemStorage(tempfile.mkdtemp())\\n349. UPLOAD_TO = os.path.join(temp_storage.location, \\\'test_upload\\\')\\n350. \\n351. \\n352. class Gallery(models.Model):\\n353.     name = models.CharField(max_length=100)\\n354. \\n355. \\n356. class Picture(models.Model):\\n357.     name = models.CharField(max_length=100)\\n358.     image = models.FileField(storage=temp_storage, upload_to=\\\'test_upload\\\')\\n359.     gallery = models.ForeignKey(Gallery, models.CASCADE, related_name="pictures")\\n360. \\n361. \\n362. class Language(models.Model):\\n363.     iso = models.CharField(max_length=5, primary_key=True)\\n364.     name = models.CharField(max_length=50)\\n365.     english_name = models.CharField(max_length=50)\\n366.     shortlist = models.BooleanField(default=False)\\n367. \\n368.     def __str__(self):\\n369.         return self.iso\\n370. \\n371.     class Meta:\\n372.         ordering = (\\\'iso\\\',)\\n373. \\n374. \\n375. # a base class for Recommender and Recommendation\\n376. class Title(models.Model):\\n377.     pass\\n378. \\n379. \\n380. class TitleTranslation(models.Model):\\n381.     title = models.ForeignKey(Title, models.CASCADE)\\n382.     text = models.CharField(max_length=100)\\n383. \\n384. \\n385. class Recommender(Title):\\n386.     pass\\n387. \\n388. \\n389. class Recommendation(Title):\\n390.     the_recommender = models.ForeignKey(Recommender, models.CASCADE)\\n391. \\n392. \\n393. class Collector(models.Model):\\n394.     name = models.CharField(max_length=100)\\n395. \\n396. \\n397. class Widget(models.Model):\\n398.     owner = models.ForeignKey(Collector, models.CASCADE)\\n399.     name = models.CharField(max_length=100)\\n400. \\n401. \\n402. class DooHickey(models.Model):\\n403.     code = models.CharField(max_length=10, primary_key=True)\\n404.     owner = models.ForeignKey(Collector, models.CASCADE)\\n405.     name = models.CharField(max_length=100)\\n406. \\n407. \\n408. class Grommet(models.Model):\\n409.     code = models.AutoField(primary_key=True)\\n410.     owner = models.ForeignKey(Collector, models.CASCADE)\\n411.     name = models.CharField(max_length=100)\\n412. \\n413. \\n414. class Whatsit(models.Model):\\n415.     index = models.IntegerField(primary_key=True)\\n416.     owner = models.ForeignKey(Collector, models.CASCADE)\\n417.     name = models.CharField(max_length=100)\\n418. \\n419. \\n420. class Doodad(models.Model):\\n421.     name = models.CharField(max_length=100)\\n422. \\n423. \\n424. class FancyDoodad(Doodad):\\n425.     owner = models.ForeignKey(Collector, models.CASCADE)\\n426.     expensive = models.BooleanField(default=True)\\n427. \\n428. \\n429. class Category(models.Model):\\n430.     collector = models.ForeignKey(Collector, models.CASCADE)\\n431.     order = models.PositiveIntegerField()\\n432. \\n433.     class Meta:\\n434.         ordering = (\\\'order\\\',)\\n435. \\n436.     def __str__(self):\\n437.         return \\\'%s:o%s\\\' % (self.id, self.order)\\n438. \\n439. \\n440. def link_posted_default():\\n441.     return datetime.date.today() - datetime.timedelta(days=7)\\n442. \\n443. \\n444. class Link(models.Model):\\n445.     posted = models.DateField(default=link_posted_default)\\n446.     url = models.URLField()\\n447.     post = models.ForeignKey("Post", models.CASCADE)\\n448.     readonly_link_content = models.TextField()\\n449. \\n450. \\n451. class PrePopulatedPost(models.Model):\\n452.     title = models.CharField(max_length=100)\\n453.     published = models.BooleanField(default=False)\\n454.     slug = models.SlugField()\\n455. \\n456. \\n457. class PrePopulatedSubPost(models.Model):\\n458.     post = models.ForeignKey(PrePopulatedPost, models.CASCADE)\\n459.     subtitle = models.CharField(max_length=100)\\n460.     subslug = models.SlugField()\\n461. \\n462. \\n463. class Post(models.Model):\\n464.     title = models.CharField(max_length=100, help_text=\\\'Some help text for the title (with Unicode Å ÄÄ†Å½Ä‡Å¾Å¡Ä‘)\\\')\\n465.     content = models.TextField(help_text=\\\'Some help text for the content (with Unicode Å ÄÄ†Å½Ä‡Å¾Å¡Ä‘)\\\')\\n466.     readonly_content = models.TextField()\\n467.     posted = models.DateField(\\n468.         default=datetime.date.today,\\n469.         help_text=\\\'Some help text for the date (with Unicode Å ÄÄ†Å½Ä‡Å¾Å¡Ä‘)\\\',\\n470.     )\\n471.     public = models.BooleanField(null=True, blank=True)\\n472. \\n473.     def awesomeness_level(self):\\n474.         return "Very awesome."\\n475. \\n476. \\n477. # Proxy model to test overridden fields attrs on Post model so as not to\\n478. # interfere with other tests.\\n479. class FieldOverridePost(Post):\\n480.     class Meta:\\n481.         proxy = True\\n482. \\n483. \\n484. class Gadget(models.Model):\\n485.     name = models.CharField(max_length=100)\\n486. \\n487.     def __str__(self):\\n488.         return self.name\\n489. \\n490. \\n491. class Villain(models.Model):\\n492.     name = models.CharField(max_length=100)\\n493. \\n494.     def __str__(self):\\n495.         return self.name\\n496. \\n497. \\n498. class SuperVillain(Villain):\\n499.     pass\\n500. \', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'tests/admin_views/test_forms.py\', \'content\': "1. from django.contrib.admin.forms import AdminAuthenticationForm\\n2. from django.contrib.auth.models import User\\n3. from django.test import TestCase, override_settings\\n4. \\n5. \\n6. # To verify that the login form rejects inactive users, use an authentication\\n7. # backend that allows them.\\n8. @override_settings(AUTHENTICATION_BACKENDS=[\'django.contrib.auth.backends.AllowAllUsersModelBackend\'])\\n9. class AdminAuthenticationFormTests(TestCase):\\n10.     @classmethod\\n11.     def setUpTestData(cls):\\n12.         User.objects.create_user(username=\'inactive\', password=\'password\', is_active=False)\\n13. \\n14.     def test_inactive_user(self):\\n15.         data = {\\n16.             \'username\': \'inactive\',\\n17.             \'password\': \'password\',\\n18.         }\\n19.         form = AdminAuthenticationForm(None, data)\\n20.         self.assertEqual(form.non_field_errors(), [\'This account is inactive.\'])", \'start_line_number\': 1, \'end_line_number\': 20}\n\n{\'relative_path\': \'tests/admin_views/tests.py\', \'content\': \'65. class AdminFieldExtractionMixin:\\n66.     """\\n67.     Helper methods for extracting data from AdminForm.\\n68.     """\\n69.     def get_admin_form_fields(self, response):\\n70.         """\\n71.         Return a list of AdminFields for the AdminForm in the response.\\n72.         """\\n73.         fields = []\\n74.         for fieldset in response.context[\\\'adminform\\\']:\\n75.             for field_line in fieldset:\\n76.                 fields.extend(field_line)\\n77.         return fields\\n78. \\n79.     def get_admin_readonly_fields(self, response):\\n80.         """\\n81.         Return the readonly fields for the response\\\'s AdminForm.\\n82.         """\\n83.         return [f for f in self.get_admin_form_fields(response) if f.is_readonly]\\n84. \\n85.     def get_admin_readonly_field(self, response, field_name):\\n86.         """\\n87.         Return the readonly field for the given field_name.\\n88.         """\\n89.         admin_readonly_fields = self.get_admin_readonly_fields(response)\\n90.         for field in admin_readonly_fields:\\n91.             if field.field[\\\'name\\\'] == field_name:\\n92.                 return field\\n93. \\n94. \', \'start_line_number\': 65, \'end_line_number\': 94}\n\n{\'relative_path\': \'tests/admin_views/tests.py\', \'content\': \'218.     def test_basic_edit_GET(self):\\n219.         """\\n220.         A smoke test to ensure GET on the change_view works.\\n221.         """\\n222.         response = self.client.get(reverse(\\\'admin:admin_views_section_change\\\', args=(self.s1.pk,)))\\n223.         self.assertIsInstance(response, TemplateResponse)\\n224.         self.assertEqual(response.status_code, 200)\\n225. \', \'start_line_number\': 218, \'end_line_number\': 225}\n\n{\'relative_path\': \'tests/admin_views/tests.py\', \'content\': \'4742.         """JavaScript-assisted auto-focus on first usable form field."""\\n4743.         # First form field has a single widget\\n4744.         self.admin_login(username=\\\'super\\\', password=\\\'secret\\\', login_url=reverse(\\\'admin:index\\\'))\\n4745.         with self.wait_page_loaded():\\n4746.             self.selenium.get(self.live_server_url + reverse(\\\'admin:admin_views_picture_add\\\'))\\n4747.         self.assertEqual(\\n4748.             self.selenium.switch_to.active_element,\\n4749.             self.selenium.find_element_by_id(\\\'id_name\\\')\\n4750.         )\', \'start_line_number\': 4742, \'end_line_number\': 4750}\n\n{\'relative_path\': \'tests/admin_widgets/tests.py\', \'content\': \'1. import gettext\\n2. import os\\n3. import re\\n4. from datetime import datetime, timedelta\\n5. from importlib import import_module\\n6. \\n7. import pytz\\n8. \\n9. from django import forms\\n10. from django.conf import settings\\n11. from django.contrib import admin\\n12. from django.contrib.admin import widgets\\n13. from django.contrib.admin.tests import AdminSeleniumTestCase\\n14. from django.contrib.auth.models import User\\n15. from django.core.files.storage import default_storage\\n16. from django.core.files.uploadedfile import SimpleUploadedFile\\n17. from django.db.models import (\\n18.     CharField, DateField, DateTimeField, ManyToManyField, UUIDField,\\n19. )\\n20. from django.test import SimpleTestCase, TestCase, override_settings\\n21. from django.urls import reverse\\n22. from django.utils import translation\\n23. \\n24. from .models import (\\n25.     Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,\\n26.     Inventory, Member, MyFileField, Profile, School, Student,\\n27.     UnsafeLimitChoicesTo,\\n28. )\\n29. from .widgetadmin import site as widget_admin_site\\n30. \\n31. \\n32. class TestDataMixin:\\n33. \\n34.     @classmethod\\n35.     def setUpTestData(cls):\\n36.         cls.superuser = User.objects.create_superuser(username=\\\'super\\\', password=\\\'secret\\\', email=None)\\n37.         cls.u2 = User.objects.create_user(username=\\\'testser\\\', password=\\\'secret\\\')\\n38.         Car.objects.create(owner=cls.superuser, make=\\\'Volkswagen\\\', model=\\\'Passat\\\')\\n39.         Car.objects.create(owner=cls.u2, make=\\\'BMW\\\', model=\\\'M3\\\')\\n40. \\n41. \\n42. class AdminFormfieldForDBFieldTests(SimpleTestCase):\\n43.     """\\n44.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield\\n45.     """\\n46. \\n47.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\\n48.         """\\n49.         Helper to call formfield_for_dbfield for a given model and field name\\n50.         and verify that the returned formfield is appropriate.\\n51.         """\\n52.         # Override any settings on the model admin\\n53.         class MyModelAdmin(admin.ModelAdmin):\\n54.             pass\\n55.         for k in admin_overrides:\\n56.             setattr(MyModelAdmin, k, admin_overrides[k])\\n57. \\n58.         # Construct the admin, and ask it for a formfield\\n59.         ma = MyModelAdmin(model, admin.site)\\n60.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\\n61. \\n62.         # "unwrap" the widget wrapper, if needed\\n63.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\\n64.             widget = ff.widget.widget\\n65.         else:\\n66.             widget = ff.widget\\n67. \\n68.         self.assertIsInstance(widget, widgetclass)\\n69. \\n70.         # Return the formfield so that other tests can continue\\n71.         return ff\\n72. \\n73.     def test_DateField(self):\\n74.         self.assertFormfield(Event, \\\'start_date\\\', widgets.AdminDateWidget)\\n75. \\n76.     def test_DateTimeField(self):\\n77.         self.assertFormfield(Member, \\\'birthdate\\\', widgets.AdminSplitDateTime)\\n78. \\n79.     def test_TimeField(self):\\n80.         self.assertFormfield(Event, \\\'start_time\\\', widgets.AdminTimeWidget)\\n81. \\n82.     def test_TextField(self):\\n83.         self.assertFormfield(Event, \\\'description\\\', widgets.AdminTextareaWidget)\\n84. \\n85.     def test_URLField(self):\\n86.         self.assertFormfield(Event, \\\'link\\\', widgets.AdminURLFieldWidget)\\n87. \\n88.     def test_IntegerField(self):\\n89.         self.assertFormfield(Event, \\\'min_age\\\', widgets.AdminIntegerFieldWidget)\\n90. \\n91.     def test_CharField(self):\\n92.         self.assertFormfield(Member, \\\'name\\\', widgets.AdminTextInputWidget)\\n93. \\n94.     def test_EmailField(self):\\n95.         self.assertFormfield(Member, \\\'email\\\', widgets.AdminEmailInputWidget)\\n96. \\n97.     def test_FileField(self):\\n98.         self.assertFormfield(Album, \\\'cover_art\\\', widgets.AdminFileWidget)\\n99. \\n100.     def test_ForeignKey(self):\\n101.         self.assertFormfield(Event, \\\'main_band\\\', forms.Select)\\n102. \\n103.     def test_raw_id_ForeignKey(self):\\n104.         self.assertFormfield(Event, \\\'main_band\\\', widgets.ForeignKeyRawIdWidget,\\n105.                              raw_id_fields=[\\\'main_band\\\'])\\n106. \\n107.     def test_radio_fields_ForeignKey(self):\\n108.         ff = self.assertFormfield(Event, \\\'main_band\\\', widgets.AdminRadioSelect,\\n109.                                   radio_fields={\\\'main_band\\\': admin.VERTICAL})\\n110.         self.assertIsNone(ff.empty_label)\\n111. \\n112.     def test_many_to_many(self):\\n113.         self.assertFormfield(Band, \\\'members\\\', forms.SelectMultiple)\\n114. \\n115.     def test_raw_id_many_to_many(self):\\n116.         self.assertFormfield(Band, \\\'members\\\', widgets.ManyToManyRawIdWidget,\\n117.                              raw_id_fields=[\\\'members\\\'])\\n118. \\n119.     def test_filtered_many_to_many(self):\\n120.         self.assertFormfield(Band, \\\'members\\\', widgets.FilteredSelectMultiple,\\n121.                              filter_vertical=[\\\'members\\\'])\\n122. \\n123.     def test_formfield_overrides(self):\\n124.         self.assertFormfield(Event, \\\'start_date\\\', forms.TextInput,\\n125.                              formfield_overrides={DateField: {\\\'widget\\\': forms.TextInput}})\\n126. \\n127.     def test_formfield_overrides_widget_instances(self):\\n128.         """\\n129.         Widget instances in formfield_overrides are not shared between\\n130.         different fields. (#19423)\\n131.         """\\n132.         class BandAdmin(admin.ModelAdmin):\\n133.             formfield_overrides = {\\n134.                 CharField: {\\\'widget\\\': forms.TextInput(attrs={\\\'size\\\': \\\'10\\\'})}\\n135.             }\\n136.         ma = BandAdmin(Band, admin.site)\\n137.         f1 = ma.formfield_for_dbfield(Band._meta.get_field(\\\'name\\\'), request=None)\\n138.         f2 = ma.formfield_for_dbfield(Band._meta.get_field(\\\'style\\\'), request=None)\\n139.         self.assertNotEqual(f1.widget, f2.widget)\\n140.         self.assertEqual(f1.widget.attrs[\\\'maxlength\\\'], \\\'100\\\')\\n141.         self.assertEqual(f2.widget.attrs[\\\'maxlength\\\'], \\\'20\\\')\\n142.         self.assertEqual(f2.widget.attrs[\\\'size\\\'], \\\'10\\\')\\n143. \\n144.     def test_formfield_overrides_m2m_filter_widget(self):\\n145.         """\\n146.         The autocomplete_fields, raw_id_fields, filter_vertical, and\\n147.         filter_horizontal widgets for ManyToManyFields may be overridden by\\n148.         specifying a widget in formfield_overrides.\\n149.         """\\n150.         class BandAdmin(admin.ModelAdmin):\\n151.             filter_vertical = [\\\'members\\\']\\n152.             formfield_overrides = {\\n153.                 ManyToManyField: {\\\'widget\\\': forms.CheckboxSelectMultiple},\\n154.             }\\n155.         ma = BandAdmin(Band, admin.site)\\n156.         field = ma.formfield_for_dbfield(Band._meta.get_field(\\\'members\\\'), request=None)\\n157.         self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\\n158. \\n159.     def test_formfield_overrides_for_datetime_field(self):\\n160.         """\\n161.         Overriding the widget for DateTimeField doesn\\\'t overrides the default\\n162.         form_class for that field (#26449).\\n163.         """\\n164.         class MemberAdmin(admin.ModelAdmin):\\n165.             formfield_overrides = {DateTimeField: {\\\'widget\\\': widgets.AdminSplitDateTime}}\\n166.         ma = MemberAdmin(Member, admin.site)\\n167.         f1 = ma.formfield_for_dbfield(Member._meta.get_field(\\\'birthdate\\\'), request=None)\\n168.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\\n169.         self.assertIsInstance(f1, forms.SplitDateTimeField)\\n170. \\n171.     def test_formfield_overrides_for_custom_field(self):\\n172.         """\\n173.         formfield_overrides works for a custom field class.\\n174.         """\\n175.         class AlbumAdmin(admin.ModelAdmin):\\n176.             formfield_overrides = {MyFileField: {\\\'widget\\\': forms.TextInput()}}\\n177.         ma = AlbumAdmin(Member, admin.site)\\n178.         f1 = ma.formfield_for_dbfield(Album._meta.get_field(\\\'backside_art\\\'), request=None)\\n179.         self.assertIsInstance(f1.widget, forms.TextInput)\\n180. \\n181.     def test_field_with_choices(self):\\n182.         self.assertFormfield(Member, \\\'gender\\\', forms.Select)\\n183. \\n184.     def test_choices_with_radio_fields(self):\\n185.         self.assertFormfield(Member, \\\'gender\\\', widgets.AdminRadioSelect,\\n186.                              radio_fields={\\\'gender\\\': admin.VERTICAL})\\n187. \\n188.     def test_inheritance(self):\\n189.         self.assertFormfield(Album, \\\'backside_art\\\', widgets.AdminFileWidget)\\n190. \\n191.     def test_m2m_widgets(self):\\n192.         """m2m fields help text as it applies to admin app (#9321)."""\\n193.         class AdvisorAdmin(admin.ModelAdmin):\\n194.             filter_vertical = [\\\'companies\\\']\\n195. \\n196.         self.assertFormfield(Advisor, \\\'companies\\\', widgets.FilteredSelectMultiple,\\n197.                              filter_vertical=[\\\'companies\\\'])\\n198.         ma = AdvisorAdmin(Advisor, admin.site)\\n199.         f = ma.formfield_for_dbfield(Advisor._meta.get_field(\\\'companies\\\'), request=None)\\n200.         self.assertEqual(\\n201.             f.help_text,\\n202.             \\\'Hold down â€œControlâ€, or â€œCommandâ€ on a Mac, to select more than one.\\\'\\n203.         )\\n204. \\n205. \\n206. @override_settings(ROOT_URLCONF=\\\'admin_widgets.urls\\\')\\n207. class AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):\\n208. \\n209.     def test_filter_choices_by_request_user(self):\\n210.         """\\n211.         Ensure the user can only see their own cars in the foreign key dropdown.\\n212.         """\\n213.         self.client.force_login(self.superuser)\\n214.         response = self.client.get(reverse(\\\'admin:admin_widgets_cartire_add\\\'))\\n215.         self.assertNotContains(response, "BMW M3")\\n216.         self.assertContains(response, "Volkswagen Passat")\\n217. \\n218. \\n219. @override_settings(ROOT_URLCONF=\\\'admin_widgets.urls\\\')\\n220. class AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):\\n221. \\n222.     def setUp(self):\\n223.         self.client.force_login(self.superuser)\\n224. \\n225.     def test_changelist_ForeignKey(self):\\n226.         response = self.client.get(reverse(\\\'admin:admin_widgets_car_changelist\\\'))\\n227.         self.assertContains(response, \\\'/auth/user/add/\\\')\\n228. \\n229. \\n230. @override_settings(ROOT_URLCONF=\\\'admin_widgets.urls\\\')\\n231. class AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):\\n232. \\n233.     def setUp(self):\\n234.         self.client.force_login(self.superuser)\\n235. \\n236.     def test_nonexistent_target_id(self):\\n237.         band = Band.objects.create(name=\\\'Bogey Blues\\\')\\n238.         pk = band.pk\\n239.         band.delete()\\n240.         post_data = {\\n241.             "main_band": str(pk),\\n242.         }\\n243.         # Try posting with a nonexistent pk in a raw id field: this\\n244.         # should result in an error message, not a server exception.\\n245.         response = self.client.post(reverse(\\\'admin:admin_widgets_event_add\\\'), post_data)\\n246.         self.assertContains(response, \\\'Select a valid choice. That choice is not one of the available choices.\\\')\\n247. \\n248.     def test_invalid_target_id(self):\\n249. \\n250.         for test_str in (\\\'IÃ±tÃ«rnÃ¢tiÃ´nÃ lizÃ¦tiÃ¸n\\\', "1234\\\'", -1234):\\n251.             # This should result in an error message, not a server exception.\\n252.             response = self.client.post(reverse(\\\'admin:admin_widgets_event_add\\\'), {"main_band": test_str})\\n253. \\n254.             self.assertContains(response, \\\'Select a valid choice. That choice is not one of the available choices.\\\')\\n255. \\n256.     def test_url_params_from_lookup_dict_any_iterable(self):\\n257.         lookup1 = widgets.url_params_from_lookup_dict({\\\'color__in\\\': (\\\'red\\\', \\\'blue\\\')})\\n258.         lookup2 = widgets.url_params_from_lookup_dict({\\\'color__in\\\': [\\\'red\\\', \\\'blue\\\']})\\n259.         self.assertEqual(lookup1, {\\\'color__in\\\': \\\'red,blue\\\'})\\n260.         self.assertEqual(lookup1, lookup2)\\n261. \\n262.     def test_url_params_from_lookup_dict_callable(self):\\n263.         def my_callable():\\n264.             return \\\'works\\\'\\n265.         lookup1 = widgets.url_params_from_lookup_dict({\\\'myfield\\\': my_callable})\\n266.         lookup2 = widgets.url_params_from_lookup_dict({\\\'myfield\\\': my_callable()})\\n267.         self.assertEqual(lookup1, lookup2)\\n268. \\n269.     def test_label_and_url_for_value_invalid_uuid(self):\\n270.         field = Bee._meta.get_field(\\\'honeycomb\\\')\\n271.         self.assertIsInstance(field.target_field, UUIDField)\\n272.         widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)\\n273.         self.assertEqual(widget.label_and_url_for_value(\\\'invalid-uuid\\\'), (\\\'\\\', \\\'\\\'))\\n274. \\n275. \\n276. class FilteredSelectMultipleWidgetTest(SimpleTestCase):\\n277.     def test_render(self):\\n278.         # Backslash in verbose_name to ensure it is JavaScript escaped.\\n279.         w = widgets.FilteredSelectMultiple(\\\'test\\\\\\\\\\\', False)\\n280.         self.assertHTMLEqual(\\n281.             w.render(\\\'test\\\', \\\'test\\\'),\\n282.             \\\'<select multiple name="test" class="selectfilter" \\\'\\n283.             \\\'data-field-name="test\\\\\\\\" data-is-stacked="0">\\\\n</select>\\\'\\n284.         )\\n285. \\n286.     def test_stacked_render(self):\\n287.         # Backslash in verbose_name to ensure it is JavaScript escaped.\\n288.         w = widgets.FilteredSelectMultiple(\\\'test\\\\\\\\\\\', True)\\n289.         self.assertHTMLEqual(\\n290.             w.render(\\\'test\\\', \\\'test\\\'),\\n291.             \\\'<select multiple name="test" class="selectfilterstacked" \\\'\\n292.             \\\'data-field-name="test\\\\\\\\" data-is-stacked="1">\\\\n</select>\\\'\\n293.         )\\n294. \\n295. \\n296. class AdminDateWidgetTest(SimpleTestCase):\\n297.     def test_attrs(self):\\n298.         w = widgets.AdminDateWidget()\\n299.         self.assertHTMLEqual(\\n300.             w.render(\\\'test\\\', datetime(2007, 12, 1, 9, 30)),\\n301.             \\\'<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">\\\',\\n302.         )\\n303.         # pass attrs to widget\\n304.         w = widgets.AdminDateWidget(attrs={\\\'size\\\': 20, \\\'class\\\': \\\'myDateField\\\'})\\n305.         self.assertHTMLEqual(\\n306.             w.render(\\\'test\\\', datetime(2007, 12, 1, 9, 30)),\\n307.             \\\'<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">\\\',\\n308.         )\\n309. \\n310. \\n311. class AdminTimeWidgetTest(SimpleTestCase):\\n312.     def test_attrs(self):\\n313.         w = widgets.AdminTimeWidget()\\n314.         self.assertHTMLEqual(\\n315.             w.render(\\\'test\\\', datetime(2007, 12, 1, 9, 30)),\\n316.             \\\'<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">\\\',\\n317.         )\\n318.         # pass attrs to widget\\n319.         w = widgets.AdminTimeWidget(attrs={\\\'size\\\': 20, \\\'class\\\': \\\'myTimeField\\\'})\\n320.         self.assertHTMLEqual(\\n321.             w.render(\\\'test\\\', datetime(2007, 12, 1, 9, 30)),\\n322.             \\\'<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">\\\',\\n323.         )\\n324. \\n325. \\n326. class AdminSplitDateTimeWidgetTest(SimpleTestCase):\\n327.     def test_render(self):\\n328.         w = widgets.AdminSplitDateTime()\\n329.         self.assertHTMLEqual(\\n330.             w.render(\\\'test\\\', datetime(2007, 12, 1, 9, 30)),\\n331.             \\\'<p class="datetime">\\\'\\n332.             \\\'Date: <input value="2007-12-01" type="text" class="vDateField" \\\'\\n333.             \\\'name="test_0" size="10"><br>\\\'\\n334.             \\\'Time: <input value="09:30:00" type="text" class="vTimeField" \\\'\\n335.             \\\'name="test_1" size="8"></p>\\\'\\n336.         )\\n337. \\n338.     def test_localization(self):\\n339.         w = widgets.AdminSplitDateTime()\\n340. \\n341.         with self.settings(USE_L10N=True), translation.override(\\\'de-at\\\'):\\n342.             w.is_localized = True\\n343.             self.assertHTMLEqual(\\n344.                 w.render(\\\'test\\\', datetime(2007, 12, 1, 9, 30)),\\n345.                 \\\'<p class="datetime">\\\'\\n346.                 \\\'Datum: <input value="01.12.2007" type="text" \\\'\\n347.                 \\\'class="vDateField" name="test_0"size="10"><br>\\\'\\n348.                 \\\'Zeit: <input value="09:30:00" type="text" class="vTimeField" \\\'\\n349.                 \\\'name="test_1" size="8"></p>\\\'\\n350.             )\\n351. \\n352. \\n353. class AdminURLWidgetTest(SimpleTestCase):\\n354.     def test_get_context_validates_url(self):\\n355.         w = widgets.AdminURLFieldWidget()\\n356.         for invalid in [\\\'\\\', \\\'/not/a/full/url/\\\', \\\'javascript:alert("Danger XSS!")\\\']:\\n357.             with self.subTest(url=invalid):\\n358.                 self.assertFalse(w.get_context(\\\'name\\\', invalid, {})[\\\'url_valid\\\'])\\n359.         self.assertTrue(w.get_context(\\\'name\\\', \\\'http://example.com\\\', {})[\\\'url_valid\\\'])\\n360. \\n361.     def test_render(self):\\n362.         w = widgets.AdminURLFieldWidget()\\n363.         self.assertHTMLEqual(\\n364.             w.render(\\\'test\\\', \\\'\\\'),\\n365.             \\\'<input class="vURLField" name="test" type="url">\\\'\\n366.         )\\n367.         self.assertHTMLEqual(\\n368.             w.render(\\\'test\\\', \\\'http://example.com\\\'),\\n369.             \\\'<p class="url">Currently:<a href="http://example.com">\\\'\\n370.             \\\'http://example.com</a><br>\\\'\\n371.             \\\'Change:<input class="vURLField" name="test" type="url" \\\'\\n372.             \\\'value="http://example.com"></p>\\\'\\n373.         )\\n374. \\n375.     def test_render_idn(self):\\n376.         w = widgets.AdminURLFieldWidget()\\n377.         self.assertHTMLEqual(\\n378.             w.render(\\\'test\\\', \\\'http://example-Ã¤Ã¼Ã¶.com\\\'),\\n379.             \\\'<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">\\\'\\n380.             \\\'http://example-Ã¤Ã¼Ã¶.com</a><br>\\\'\\n381.             \\\'Change:<input class="vURLField" name="test" type="url" \\\'\\n382.             \\\'value="http://example-Ã¤Ã¼Ã¶.com"></p>\\\'\\n383.         )\\n384. \\n385.     def test_render_quoting(self):\\n386.         """\\n387.         WARNING: This test doesn\\\'t use assertHTMLEqual since it will get rid\\n388.         of some escapes which are tested here!\\n389.         """\\n390.         HREF_RE = re.compile(\\\'href="([^"]+)"\\\')\\n391.         VALUE_RE = re.compile(\\\'value="([^"]+)"\\\')\\n392.         TEXT_RE = re.compile(\\\'<a[^>]+>([^>]+)</a>\\\')\\n393.         w = widgets.AdminURLFieldWidget()\\n394.         output = w.render(\\\'test\\\', \\\'http://example.com/<sometag>some-text</sometag>\\\')\\n395.         self.assertEqual(\\n396.             HREF_RE.search(output)[1],\\n397.             \\\'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E\\\',\\n398.         )\\n399.         self.assertEqual(\\n400.             TEXT_RE.search(output)[1],\\n401.             \\\'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\\\',\\n402.         )\\n403.         self.assertEqual(\\n404.             VALUE_RE.search(output)[1],\\n405.             \\\'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\\\',\\n406.         )\\n407.         output = w.render(\\\'test\\\', \\\'http://example-Ã¤Ã¼Ã¶.com/<sometag>some-text</sometag>\\\')\\n408.         self.assertEqual(\\n409.             HREF_RE.search(output)[1],\\n410.             \\\'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E\\\',\\n411.         )\\n412.         self.assertEqual(\\n413.             TEXT_RE.search(output)[1],\\n414.             \\\'http://example-Ã¤Ã¼Ã¶.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\\\',\\n415.         )\\n416.         self.assertEqual(\\n417.             VALUE_RE.search(output)[1],\\n418.             \\\'http://example-Ã¤Ã¼Ã¶.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\\\',\\n419.         )\\n420.         output = w.render(\\\'test\\\', \\\'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"\\\')\\n421.         self.assertEqual(\\n422.             HREF_RE.search(output)[1],\\n423.             \\\'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22\\\',\\n424.         )\\n425.         self.assertEqual(\\n426.             TEXT_RE.search(output)[1],\\n427.             \\\'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;\\\'\\n428.             \\\'alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\\\'\\n429.         )\\n430.         self.assertEqual(\\n431.             VALUE_RE.search(output)[1],\\n432.             \\\'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\\\',\\n433.         )\\n434. \\n435. \\n436. class AdminUUIDWidgetTests(SimpleTestCase):\\n437.     def test_attrs(self):\\n438.         w = widgets.AdminUUIDInputWidget()\\n439.         self.assertHTMLEqual(\\n440.             w.render(\\\'test\\\', \\\'550e8400-e29b-41d4-a716-446655440000\\\'),\\n441.             \\\'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">\\\',\\n442.         )\\n443.         w = widgets.AdminUUIDInputWidget(attrs={\\\'class\\\': \\\'myUUIDInput\\\'})\\n444.         self.assertHTMLEqual(\\n445.             w.render(\\\'test\\\', \\\'550e8400-e29b-41d4-a716-446655440000\\\'),\\n446.             \\\'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">\\\',\\n447.         )\\n448. \\n449. \\n450. @override_settings(ROOT_URLCONF=\\\'admin_widgets.urls\\\')\\n451. class AdminFileWidgetTests(TestDataMixin, TestCase):\\n452. \\n453.     @classmethod\\n454.     def setUpTestData(cls):\\n455.         super().setUpTestData()\\n456.         band = Band.objects.create(name=\\\'Linkin Park\\\')\\n457.         cls.album = band.album_set.create(\\n458.             name=\\\'Hybrid Theory\\\', cover_art=r\\\'albums\\\\hybrid_theory.jpg\\\'\\n459.         )\\n460. \\n461.     def test_render(self):\\n462.         w = widgets.AdminFileWidget()\\n463.         self.assertHTMLEqual(\\n464.             w.render(\\\'test\\\', self.album.cover_art),\\n465.             \\\'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\\\'\\n466.             r\\\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a> \\\'\\n467.             \\\'<span class="clearable-file-input">\\\'\\n468.             \\\'<input type="checkbox" name="test-clear" id="test-clear_id"> \\\'\\n469.             \\\'<label for="test-clear_id">Clear</label></span><br>\\\'\\n470.             \\\'Change: <input type="file" name="test"></p>\\\' % {\\n471.                 \\\'STORAGE_URL\\\': default_storage.url(\\\'\\\'),\\n472.             },\\n473.         )\\n474.         self.assertHTMLEqual(\\n475.             w.render(\\\'test\\\', SimpleUploadedFile(\\\'test\\\', b\\\'content\\\')),\\n476.             \\\'<input type="file" name="test">\\\',\\n477.         )\\n478. \\n479.     def test_render_required(self):\\n480.         widget = widgets.AdminFileWidget()\\n481.         widget.is_required = True\\n482.         self.assertHTMLEqual(\\n483.             widget.render(\\\'test\\\', self.album.cover_art),\\n484.             \\\'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\\\'\\n485.             r\\\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a><br>\\\'\\n486.             \\\'Change: <input type="file" name="test"></p>\\\' % {\\n487.                 \\\'STORAGE_URL\\\': default_storage.url(\\\'\\\'),\\n488.             },\\n489.         )\\n490. \\n491.     def test_render_disabled(self):\\n492.         widget = widgets.AdminFileWidget(attrs={\\\'disabled\\\': True})\\n493.         self.assertHTMLEqual(\\n494.             widget.render(\\\'test\\\', self.album.cover_art),\\n495.             \\\'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\\\'\\n496.             r\\\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a> \\\'\\n497.             \\\'<span class="clearable-file-input">\\\'\\n498.             \\\'<input type="checkbox" name="test-clear" id="test-clear_id" disabled>\\\'\\n499.             \\\'<label for="test-clear_id">Clear</label></span><br>\\\'\\n500.             \\\'Change: <input type="file" name="test" disabled></p>\\\' % {\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'tests/forms_tests/field_tests/test_jsonfield.py\', \'content\': \'1. import json\\n2. import uuid\\n3. \\n4. from django.core.serializers.json import DjangoJSONEncoder\\n5. from django.forms import (\\n6.     CharField, Form, JSONField, Textarea, TextInput, ValidationError,\\n7. )\\n8. from django.test import SimpleTestCase\\n9. \\n10. \\n11. class JSONFieldTest(SimpleTestCase):\\n12.     def test_valid(self):\\n13.         field = JSONField()\\n14.         value = field.clean(\\\'{"a": "b"}\\\')\\n15.         self.assertEqual(value, {\\\'a\\\': \\\'b\\\'})\\n16. \\n17.     def test_valid_empty(self):\\n18.         field = JSONField(required=False)\\n19.         self.assertIsNone(field.clean(\\\'\\\'))\\n20.         self.assertIsNone(field.clean(None))\\n21. \\n22.     def test_invalid(self):\\n23.         field = JSONField()\\n24.         with self.assertRaisesMessage(ValidationError, \\\'Enter a valid JSON.\\\'):\\n25.             field.clean(\\\'{some badly formed: json}\\\')\\n26. \\n27.     def test_prepare_value(self):\\n28.         field = JSONField()\\n29.         self.assertEqual(field.prepare_value({\\\'a\\\': \\\'b\\\'}), \\\'{"a": "b"}\\\')\\n30.         self.assertEqual(field.prepare_value(None), \\\'null\\\')\\n31.         self.assertEqual(field.prepare_value(\\\'foo\\\'), \\\'"foo"\\\')\\n32. \\n33.     def test_widget(self):\\n34.         field = JSONField()\\n35.         self.assertIsInstance(field.widget, Textarea)\\n36. \\n37.     def test_custom_widget_kwarg(self):\\n38.         field = JSONField(widget=TextInput)\\n39.         self.assertIsInstance(field.widget, TextInput)\\n40. \\n41.     def test_custom_widget_attribute(self):\\n42.         """The widget can be overridden with an attribute."""\\n43.         class CustomJSONField(JSONField):\\n44.             widget = TextInput\\n45. \\n46.         field = CustomJSONField()\\n47.         self.assertIsInstance(field.widget, TextInput)\\n48. \\n49.     def test_converted_value(self):\\n50.         field = JSONField(required=False)\\n51.         tests = [\\n52.             \\\'["a", "b", "c"]\\\',\\n53.             \\\'{"a": 1, "b": 2}\\\',\\n54.             \\\'1\\\',\\n55.             \\\'1.5\\\',\\n56.             \\\'"foo"\\\',\\n57.             \\\'true\\\',\\n58.             \\\'false\\\',\\n59.             \\\'null\\\',\\n60.         ]\\n61.         for json_string in tests:\\n62.             with self.subTest(json_string=json_string):\\n63.                 val = field.clean(json_string)\\n64.                 self.assertEqual(field.clean(val), val)\\n65. \\n66.     def test_has_changed(self):\\n67.         field = JSONField()\\n68.         self.assertIs(field.has_changed({\\\'a\\\': True}, \\\'{"a": 1}\\\'), True)\\n69.         self.assertIs(field.has_changed({\\\'a\\\': 1, \\\'b\\\': 2}, \\\'{"b": 2, "a": 1}\\\'), False)\\n70. \\n71.     def test_custom_encoder_decoder(self):\\n72.         class CustomDecoder(json.JSONDecoder):\\n73.             def __init__(self, object_hook=None, *args, **kwargs):\\n74.                 return super().__init__(object_hook=self.as_uuid, *args, **kwargs)\\n75. \\n76.             def as_uuid(self, dct):\\n77.                 if \\\'uuid\\\' in dct:\\n78.                     dct[\\\'uuid\\\'] = uuid.UUID(dct[\\\'uuid\\\'])\\n79.                 return dct\\n80. \\n81.         value = {\\\'uuid\\\': uuid.UUID(\\\'{c141e152-6550-4172-a784-05448d98204b}\\\')}\\n82.         encoded_value = \\\'{"uuid": "c141e152-6550-4172-a784-05448d98204b"}\\\'\\n83.         field = JSONField(encoder=DjangoJSONEncoder, decoder=CustomDecoder)\\n84.         self.assertEqual(field.prepare_value(value), encoded_value)\\n85.         self.assertEqual(field.clean(encoded_value), value)\\n86. \\n87.     def test_formfield_disabled(self):\\n88.         class JSONForm(Form):\\n89.             json_field = JSONField(disabled=True)\\n90. \\n91.         form = JSONForm({\\\'json_field\\\': \\\'["bar"]\\\'}, initial={\\\'json_field\\\': [\\\'foo\\\']})\\n92.         self.assertIn(\\\'[&quot;foo&quot;]</textarea>\\\', form.as_p())\\n93. \\n94.     def test_redisplay_wrong_input(self):\\n95.         """\\n96.         Displaying a bound form (typically due to invalid input). The form\\n97.         should not overquote JSONField inputs.\\n98.         """\\n99.         class JSONForm(Form):\\n100.             name = CharField(max_length=2)\\n101.             json_field = JSONField()\\n102. \\n103.         # JSONField input is valid, name is too long.\\n104.         form = JSONForm({\\\'name\\\': \\\'xyz\\\', \\\'json_field\\\': \\\'["foo"]\\\'})\\n105.         self.assertNotIn(\\\'json_field\\\', form.errors)\\n106.         self.assertIn(\\\'[&quot;foo&quot;]</textarea>\\\', form.as_p())\\n107.         # Invalid JSONField.\\n108.         form = JSONForm({\\\'name\\\': \\\'xy\\\', \\\'json_field\\\': \\\'{"foo"}\\\'})\\n109.         self.assertEqual(form.errors[\\\'json_field\\\'], [\\\'Enter a valid JSON.\\\'])\\n110.         self.assertIn(\\\'{&quot;foo&quot;}</textarea>\\\', form.as_p())\', \'start_line_number\': 1, \'end_line_number\': 110}\n\n{\'relative_path\': \'tests/forms_tests/tests/test_i18n.py\', \'content\': \'1. from django.forms import (\\n2.     CharField, ChoiceField, Form, IntegerField, RadioSelect, Select, TextInput,\\n3. )\\n4. from django.test import SimpleTestCase\\n5. from django.utils import translation\\n6. from django.utils.translation import gettext_lazy\\n7. \\n8. \\n9. class FormsI18nTests(SimpleTestCase):\\n10.     def test_lazy_labels(self):\\n11.         class SomeForm(Form):\\n12.             username = CharField(max_length=10, label=gettext_lazy(\\\'username\\\'))\\n13. \\n14.         f = SomeForm()\\n15.         self.assertHTMLEqual(\\n16.             f.as_p(),\\n17.             \\\'<p><label for="id_username">username:</label>\\\'\\n18.             \\\'<input id="id_username" type="text" name="username" maxlength="10" required></p>\\\'\\n19.         )\\n20. \\n21.         # Translations are done at rendering time, so multi-lingual apps can define forms)\\n22.         with translation.override(\\\'de\\\'):\\n23.             self.assertHTMLEqual(\\n24.                 f.as_p(),\\n25.                 \\\'<p><label for="id_username">Benutzername:</label>\\\'\\n26.                 \\\'<input id="id_username" type="text" name="username" maxlength="10" required></p>\\\'\\n27.             )\\n28.         with translation.override(\\\'pl\\\'):\\n29.             self.assertHTMLEqual(\\n30.                 f.as_p(),\\n31.                 \\\'<p><label for="id_username">u\\\\u017cytkownik:</label>\\\'\\n32.                 \\\'<input id="id_username" type="text" name="username" maxlength="10" required></p>\\\'\\n33.             )\\n34. \\n35.     def test_non_ascii_label(self):\\n36.         class SomeForm(Form):\\n37.             field_1 = CharField(max_length=10, label=gettext_lazy(\\\'field_1\\\'))\\n38.             field_2 = CharField(\\n39.                 max_length=10,\\n40.                 label=gettext_lazy(\\\'field_2\\\'),\\n41.                 widget=TextInput(attrs={\\\'id\\\': \\\'field_2_id\\\'}),\\n42.             )\\n43. \\n44.         f = SomeForm()\\n45.         self.assertHTMLEqual(f[\\\'field_1\\\'].label_tag(), \\\'<label for="id_field_1">field_1:</label>\\\')\\n46.         self.assertHTMLEqual(f[\\\'field_2\\\'].label_tag(), \\\'<label for="field_2_id">field_2:</label>\\\')\\n47. \\n48.     def test_non_ascii_choices(self):\\n49.         class SomeForm(Form):\\n50.             somechoice = ChoiceField(\\n51.                 choices=((\\\'\\\\xc5\\\', \\\'En tied\\\\xe4\\\'), (\\\'\\\\xf8\\\', \\\'Mies\\\'), (\\\'\\\\xdf\\\', \\\'Nainen\\\')),\\n52.                 widget=RadioSelect(),\\n53.                 label=\\\'\\\\xc5\\\\xf8\\\\xdf\\\',\\n54.             )\\n55. \\n56.         f = SomeForm()\\n57.         self.assertHTMLEqual(\\n58.             f.as_p(),\\n59.             \\\'<p><label for="id_somechoice_0">\\\\xc5\\\\xf8\\\\xdf:</label>\\\'\\n60.             \\\'<ul id="id_somechoice">\\\\n\\\'\\n61.             \\\'<li><label for="id_somechoice_0">\\\'\\n62.             \\\'<input type="radio" id="id_somechoice_0" value="\\\\xc5" name="somechoice" required> \\\'\\n63.             \\\'En tied\\\\xe4</label></li>\\\\n\\\'\\n64.             \\\'<li><label for="id_somechoice_1">\\\'\\n65.             \\\'<input type="radio" id="id_somechoice_1" value="\\\\xf8" name="somechoice" required> \\\'\\n66.             \\\'Mies</label></li>\\\\n<li><label for="id_somechoice_2">\\\'\\n67.             \\\'<input type="radio" id="id_somechoice_2" value="\\\\xdf" name="somechoice" required> \\\'\\n68.             \\\'Nainen</label></li>\\\\n</ul></p>\\\'\\n69.         )\\n70. \\n71.         # Translated error messages\\n72.         with translation.override(\\\'ru\\\'):\\n73.             f = SomeForm({})\\n74.             self.assertHTMLEqual(\\n75.                 f.as_p(),\\n76.                 \\\'<ul class="errorlist"><li>\\\'\\n77.                 \\\'\\\\u041e\\\\u0431\\\\u044f\\\\u0437\\\\u0430\\\\u0442\\\\u0435\\\\u043b\\\\u044c\\\'\\n78.                 \\\'\\\\u043d\\\\u043e\\\\u0435 \\\\u043f\\\\u043e\\\\u043b\\\\u0435.</li></ul>\\\\n\\\'\\n79.                 \\\'<p><label for="id_somechoice_0">\\\\xc5\\\\xf8\\\\xdf:</label>\\\'\\n80.                 \\\' <ul id="id_somechoice">\\\\n<li><label for="id_somechoice_0">\\\'\\n81.                 \\\'<input type="radio" id="id_somechoice_0" value="\\\\xc5" name="somechoice" required> \\\'\\n82.                 \\\'En tied\\\\xe4</label></li>\\\\n\\\'\\n83.                 \\\'<li><label for="id_somechoice_1">\\\'\\n84.                 \\\'<input type="radio" id="id_somechoice_1" value="\\\\xf8" name="somechoice" required> \\\'\\n85.                 \\\'Mies</label></li>\\\\n<li><label for="id_somechoice_2">\\\'\\n86.                 \\\'<input type="radio" id="id_somechoice_2" value="\\\\xdf" name="somechoice" required> \\\'\\n87.                 \\\'Nainen</label></li>\\\\n</ul></p>\\\'\\n88.             )\\n89. \\n90.     def test_select_translated_text(self):\\n91.         # Deep copying translated text shouldn\\\'t raise an error.\\n92.         class CopyForm(Form):\\n93.             degree = IntegerField(widget=Select(choices=((1, gettext_lazy(\\\'test\\\')),)))\\n94. \\n95.         CopyForm()\', \'start_line_number\': 1, \'end_line_number\': 95}\n\n{\'relative_path\': \'tests/model_fields/test_jsonfield.py\', \'content\': \'1. import operator\\n2. import uuid\\n3. from unittest import mock, skipIf\\n4. \\n5. from django import forms\\n6. from django.core import serializers\\n7. from django.core.exceptions import ValidationError\\n8. from django.core.serializers.json import DjangoJSONEncoder\\n9. from django.db import (\\n10.     DataError, IntegrityError, NotSupportedError, OperationalError, connection,\\n11.     models,\\n12. )\\n13. from django.db.models import Count, F, OuterRef, Q, Subquery, Transform, Value\\n14. from django.db.models.expressions import RawSQL\\n15. from django.db.models.fields.json import (\\n16.     KeyTextTransform, KeyTransform, KeyTransformFactory,\\n17.     KeyTransformTextLookupMixin,\\n18. )\\n19. from django.db.models.functions import Cast\\n20. from django.test import (\\n21.     SimpleTestCase, TestCase, skipIfDBFeature, skipUnlessDBFeature,\\n22. )\\n23. from django.test.utils import CaptureQueriesContext\\n24. \\n25. from .models import CustomJSONDecoder, JSONModel, NullableJSONModel\\n26. \\n27. \\n28. @skipUnlessDBFeature(\\\'supports_json_field\\\')\\n29. class JSONFieldTests(TestCase):\\n30.     def test_invalid_value(self):\\n31.         msg = \\\'is not JSON serializable\\\'\\n32.         with self.assertRaisesMessage(TypeError, msg):\\n33.             NullableJSONModel.objects.create(value={\\n34.                 \\\'uuid\\\': uuid.UUID(\\\'d85e2076-b67c-4ee7-8c3a-2bf5a2cc2475\\\'),\\n35.             })\\n36. \\n37.     def test_custom_encoder_decoder(self):\\n38.         value = {\\\'uuid\\\': uuid.UUID(\\\'{d85e2076-b67c-4ee7-8c3a-2bf5a2cc2475}\\\')}\\n39.         obj = NullableJSONModel(value_custom=value)\\n40.         obj.clean_fields()\\n41.         obj.save()\\n42.         obj.refresh_from_db()\\n43.         self.assertEqual(obj.value_custom, value)\\n44. \\n45.     def test_db_check_constraints(self):\\n46.         value = \\\'{@!invalid json value 123 $!@#\\\'\\n47.         with mock.patch.object(DjangoJSONEncoder, \\\'encode\\\', return_value=value):\\n48.             with self.assertRaises((IntegrityError, DataError, OperationalError)):\\n49.                 NullableJSONModel.objects.create(value_custom=value)\\n50. \\n51. \\n52. class TestMethods(SimpleTestCase):\\n53.     def test_deconstruct(self):\\n54.         field = models.JSONField()\\n55.         name, path, args, kwargs = field.deconstruct()\\n56.         self.assertEqual(path, \\\'django.db.models.JSONField\\\')\\n57.         self.assertEqual(args, [])\\n58.         self.assertEqual(kwargs, {})\\n59. \\n60.     def test_deconstruct_custom_encoder_decoder(self):\\n61.         field = models.JSONField(encoder=DjangoJSONEncoder, decoder=CustomJSONDecoder)\\n62.         name, path, args, kwargs = field.deconstruct()\\n63.         self.assertEqual(kwargs[\\\'encoder\\\'], DjangoJSONEncoder)\\n64.         self.assertEqual(kwargs[\\\'decoder\\\'], CustomJSONDecoder)\\n65. \\n66.     def test_get_transforms(self):\\n67.         @models.JSONField.register_lookup\\n68.         class MyTransform(Transform):\\n69.             lookup_name = \\\'my_transform\\\'\\n70.         field = models.JSONField()\\n71.         transform = field.get_transform(\\\'my_transform\\\')\\n72.         self.assertIs(transform, MyTransform)\\n73.         models.JSONField._unregister_lookup(MyTransform)\\n74.         models.JSONField._clear_cached_lookups()\\n75.         transform = field.get_transform(\\\'my_transform\\\')\\n76.         self.assertIsInstance(transform, KeyTransformFactory)\\n77. \\n78.     def test_key_transform_text_lookup_mixin_non_key_transform(self):\\n79.         transform = Transform(\\\'test\\\')\\n80.         msg = (\\n81.             \\\'Transform should be an instance of KeyTransform in order to use \\\'\\n82.             \\\'this lookup.\\\'\\n83.         )\\n84.         with self.assertRaisesMessage(TypeError, msg):\\n85.             KeyTransformTextLookupMixin(transform)\\n86. \\n87. \\n88. class TestValidation(SimpleTestCase):\\n89.     def test_invalid_encoder(self):\\n90.         msg = \\\'The encoder parameter must be a callable object.\\\'\\n91.         with self.assertRaisesMessage(ValueError, msg):\\n92.             models.JSONField(encoder=DjangoJSONEncoder())\\n93. \\n94.     def test_invalid_decoder(self):\\n95.         msg = \\\'The decoder parameter must be a callable object.\\\'\\n96.         with self.assertRaisesMessage(ValueError, msg):\\n97.             models.JSONField(decoder=CustomJSONDecoder())\\n98. \\n99.     def test_validation_error(self):\\n100.         field = models.JSONField()\\n101.         msg = \\\'Value must be valid JSON.\\\'\\n102.         value = uuid.UUID(\\\'{d85e2076-b67c-4ee7-8c3a-2bf5a2cc2475}\\\')\\n103.         with self.assertRaisesMessage(ValidationError, msg):\\n104.             field.clean({\\\'uuid\\\': value}, None)\\n105. \\n106.     def test_custom_encoder(self):\\n107.         field = models.JSONField(encoder=DjangoJSONEncoder)\\n108.         value = uuid.UUID(\\\'{d85e2076-b67c-4ee7-8c3a-2bf5a2cc2475}\\\')\\n109.         field.clean({\\\'uuid\\\': value}, None)\\n110. \\n111. \\n112. class TestFormField(SimpleTestCase):\\n113.     def test_formfield(self):\\n114.         model_field = models.JSONField()\\n115.         form_field = model_field.formfield()\\n116.         self.assertIsInstance(form_field, forms.JSONField)\\n117. \\n118.     def test_formfield_custom_encoder_decoder(self):\\n119.         model_field = models.JSONField(encoder=DjangoJSONEncoder, decoder=CustomJSONDecoder)\\n120.         form_field = model_field.formfield()\\n121.         self.assertIs(form_field.encoder, DjangoJSONEncoder)\\n122.         self.assertIs(form_field.decoder, CustomJSONDecoder)\\n123. \\n124. \\n125. class TestSerialization(SimpleTestCase):\\n126.     test_data = (\\n127.         \\\'[{"fields": {"value": %s}, \\\'\\n128.         \\\'"model": "model_fields.jsonmodel", "pk": null}]\\\'\\n129.     )\\n130.     test_values = (\\n131.         # (Python value, serialized value),\\n132.         ({\\\'a\\\': \\\'b\\\', \\\'c\\\': None}, \\\'{"a": "b", "c": null}\\\'),\\n133.         (\\\'abc\\\', \\\'"abc"\\\'),\\n134.         (\\\'{"a": "a"}\\\', \\\'"{\\\\\\\\"a\\\\\\\\": \\\\\\\\"a\\\\\\\\"}"\\\'),\\n135.     )\\n136. \\n137.     def test_dumping(self):\\n138.         for value, serialized in self.test_values:\\n139.             with self.subTest(value=value):\\n140.                 instance = JSONModel(value=value)\\n141.                 data = serializers.serialize(\\\'json\\\', [instance])\\n142.                 self.assertJSONEqual(data, self.test_data % serialized)\\n143. \\n144.     def test_loading(self):\\n145.         for value, serialized in self.test_values:\\n146.             with self.subTest(value=value):\\n147.                 instance = list(\\n148.                     serializers.deserialize(\\\'json\\\', self.test_data % serialized)\\n149.                 )[0].object\\n150.                 self.assertEqual(instance.value, value)\\n151. \\n152.     def test_xml_serialization(self):\\n153.         test_xml_data = (\\n154.             \\\'<django-objects version="1.0">\\\'\\n155.             \\\'<object model="model_fields.nullablejsonmodel">\\\'\\n156.             \\\'<field name="value" type="JSONField">%s\\\'\\n157.             \\\'</field></object></django-objects>\\\'\\n158.         )\\n159.         for value, serialized in self.test_values:\\n160.             with self.subTest(value=value):\\n161.                 instance = NullableJSONModel(value=value)\\n162.                 data = serializers.serialize(\\\'xml\\\', [instance], fields=[\\\'value\\\'])\\n163.                 self.assertXMLEqual(data, test_xml_data % serialized)\\n164.                 new_instance = list(serializers.deserialize(\\\'xml\\\', data))[0].object\\n165.                 self.assertEqual(new_instance.value, instance.value)\\n166. \\n167. \\n168. @skipUnlessDBFeature(\\\'supports_json_field\\\')\\n169. class TestSaveLoad(TestCase):\\n170.     def test_null(self):\\n171.         obj = NullableJSONModel(value=None)\\n172.         obj.save()\\n173.         obj.refresh_from_db()\\n174.         self.assertIsNone(obj.value)\\n175. \\n176.     @skipUnlessDBFeature(\\\'supports_primitives_in_json_field\\\')\\n177.     def test_json_null_different_from_sql_null(self):\\n178.         json_null = NullableJSONModel.objects.create(value=Value(\\\'null\\\'))\\n179.         json_null.refresh_from_db()\\n180.         sql_null = NullableJSONModel.objects.create(value=None)\\n181.         sql_null.refresh_from_db()\\n182.         # \\\'null\\\' is not equal to NULL in the database.\\n183.         self.assertSequenceEqual(\\n184.             NullableJSONModel.objects.filter(value=Value(\\\'null\\\')),\\n185.             [json_null],\\n186.         )\\n187.         self.assertSequenceEqual(\\n188.             NullableJSONModel.objects.filter(value=None),\\n189.             [json_null],\\n190.         )\\n191.         self.assertSequenceEqual(\\n192.             NullableJSONModel.objects.filter(value__isnull=True),\\n193.             [sql_null],\\n194.         )\\n195.         # \\\'null\\\' is equal to NULL in Python (None).\\n196.         self.assertEqual(json_null.value, sql_null.value)\\n197. \\n198.     @skipUnlessDBFeature(\\\'supports_primitives_in_json_field\\\')\\n199.     def test_primitives(self):\\n200.         values = [\\n201.             True,\\n202.             1,\\n203.             1.45,\\n204.             \\\'String\\\',\\n205.             \\\'\\\',\\n206.         ]\\n207.         for value in values:\\n208.             with self.subTest(value=value):\\n209.                 obj = JSONModel(value=value)\\n210.                 obj.save()\\n211.                 obj.refresh_from_db()\\n212.                 self.assertEqual(obj.value, value)\\n213. \\n214.     def test_dict(self):\\n215.         values = [\\n216.             {},\\n217.             {\\\'name\\\': \\\'John\\\', \\\'age\\\': 20, \\\'height\\\': 180.3},\\n218.             {\\\'a\\\': True, \\\'b\\\': {\\\'b1\\\': False, \\\'b2\\\': None}},\\n219.         ]\\n220.         for value in values:\\n221.             with self.subTest(value=value):\\n222.                 obj = JSONModel.objects.create(value=value)\\n223.                 obj.refresh_from_db()\\n224.                 self.assertEqual(obj.value, value)\\n225. \\n226.     def test_list(self):\\n227.         values = [\\n228.             [],\\n229.             [\\\'John\\\', 20, 180.3],\\n230.             [True, [False, None]],\\n231.         ]\\n232.         for value in values:\\n233.             with self.subTest(value=value):\\n234.                 obj = JSONModel.objects.create(value=value)\\n235.                 obj.refresh_from_db()\\n236.                 self.assertEqual(obj.value, value)\\n237. \\n238.     def test_realistic_object(self):\\n239.         value = {\\n240.             \\\'name\\\': \\\'John\\\',\\n241.             \\\'age\\\': 20,\\n242.             \\\'pets\\\': [\\n243.                 {\\\'name\\\': \\\'Kit\\\', \\\'type\\\': \\\'cat\\\', \\\'age\\\': 2},\\n244.                 {\\\'name\\\': \\\'Max\\\', \\\'type\\\': \\\'dog\\\', \\\'age\\\': 1},\\n245.             ],\\n246.             \\\'courses\\\': [\\n247.                 [\\\'A1\\\', \\\'A2\\\', \\\'A3\\\'],\\n248.                 [\\\'B1\\\', \\\'B2\\\'],\\n249.                 [\\\'C1\\\'],\\n250.             ],\\n251.         }\\n252.         obj = JSONModel.objects.create(value=value)\\n253.         obj.refresh_from_db()\\n254.         self.assertEqual(obj.value, value)\\n255. \\n256. \\n257. @skipUnlessDBFeature(\\\'supports_json_field\\\')\\n258. class TestQuerying(TestCase):\\n259.     @classmethod\\n260.     def setUpTestData(cls):\\n261.         cls.primitives = [True, False, \\\'yes\\\', 7, 9.6]\\n262.         values = [\\n263.             None,\\n264.             [],\\n265.             {},\\n266.             {\\\'a\\\': \\\'b\\\', \\\'c\\\': 14},\\n267.             {\\n268.                 \\\'a\\\': \\\'b\\\',\\n269.                 \\\'c\\\': 14,\\n270.                 \\\'d\\\': [\\\'e\\\', {\\\'f\\\': \\\'g\\\'}],\\n271.                 \\\'h\\\': True,\\n272.                 \\\'i\\\': False,\\n273.                 \\\'j\\\': None,\\n274.                 \\\'k\\\': {\\\'l\\\': \\\'m\\\'},\\n275.                 \\\'n\\\': [None],\\n276.             },\\n277.             [1, [2]],\\n278.             {\\\'k\\\': True, \\\'l\\\': False, \\\'foo\\\': \\\'bax\\\'},\\n279.             {\\n280.                 \\\'foo\\\': \\\'bar\\\',\\n281.                 \\\'baz\\\': {\\\'a\\\': \\\'b\\\', \\\'c\\\': \\\'d\\\'},\\n282.                 \\\'bar\\\': [\\\'foo\\\', \\\'bar\\\'],\\n283.                 \\\'bax\\\': {\\\'foo\\\': \\\'bar\\\'},\\n284.             },\\n285.         ]\\n286.         cls.objs = [\\n287.             NullableJSONModel.objects.create(value=value)\\n288.             for value in values\\n289.         ]\\n290.         if connection.features.supports_primitives_in_json_field:\\n291.             cls.objs.extend([\\n292.                 NullableJSONModel.objects.create(value=value)\\n293.                 for value in cls.primitives\\n294.             ])\\n295.         cls.raw_sql = \\\'%s::jsonb\\\' if connection.vendor == \\\'postgresql\\\' else \\\'%s\\\'\\n296. \\n297.     def test_exact(self):\\n298.         self.assertSequenceEqual(\\n299.             NullableJSONModel.objects.filter(value__exact={}),\\n300.             [self.objs[2]],\\n301.         )\\n302. \\n303.     def test_exact_complex(self):\\n304.         self.assertSequenceEqual(\\n305.             NullableJSONModel.objects.filter(value__exact={\\\'a\\\': \\\'b\\\', \\\'c\\\': 14}),\\n306.             [self.objs[3]],\\n307.         )\\n308. \\n309.     def test_isnull(self):\\n310.         self.assertSequenceEqual(\\n311.             NullableJSONModel.objects.filter(value__isnull=True),\\n312.             [self.objs[0]],\\n313.         )\\n314. \\n315.     def test_ordering_by_transform(self):\\n316.         mariadb = connection.vendor == \\\'mysql\\\' and connection.mysql_is_mariadb\\n317.         values = [\\n318.             {\\\'ord\\\': 93, \\\'name\\\': \\\'bar\\\'},\\n319.             {\\\'ord\\\': 22.1, \\\'name\\\': \\\'foo\\\'},\\n320.             {\\\'ord\\\': -1, \\\'name\\\': \\\'baz\\\'},\\n321.             {\\\'ord\\\': 21.931902, \\\'name\\\': \\\'spam\\\'},\\n322.             {\\\'ord\\\': -100291029, \\\'name\\\': \\\'eggs\\\'},\\n323.         ]\\n324.         for field_name in [\\\'value\\\', \\\'value_custom\\\']:\\n325.             with self.subTest(field=field_name):\\n326.                 objs = [\\n327.                     NullableJSONModel.objects.create(**{field_name: value})\\n328.                     for value in values\\n329.                 ]\\n330.                 query = NullableJSONModel.objects.filter(\\n331.                     **{\\\'%s__name__isnull\\\' % field_name: False},\\n332.                 ).order_by(\\\'%s__ord\\\' % field_name)\\n333.                 expected = [objs[4], objs[2], objs[3], objs[1], objs[0]]\\n334.                 if mariadb or connection.vendor == \\\'oracle\\\':\\n335.                     # MariaDB and Oracle return JSON values as strings.\\n336.                     expected = [objs[2], objs[4], objs[3], objs[1], objs[0]]\\n337.                 self.assertSequenceEqual(query, expected)\\n338. \\n339.     def test_ordering_grouping_by_key_transform(self):\\n340.         base_qs = NullableJSONModel.objects.filter(value__d__0__isnull=False)\\n341.         for qs in (\\n342.             base_qs.order_by(\\\'value__d__0\\\'),\\n343.             base_qs.annotate(key=KeyTransform(\\\'0\\\', KeyTransform(\\\'d\\\', \\\'value\\\'))).order_by(\\\'key\\\'),\\n344.         ):\\n345.             self.assertSequenceEqual(qs, [self.objs[4]])\\n346.         qs = NullableJSONModel.objects.filter(value__isnull=False)\\n347.         self.assertQuerysetEqual(\\n348.             qs.filter(value__isnull=False).annotate(\\n349.                 key=KeyTextTransform(\\\'f\\\', KeyTransform(\\\'1\\\', KeyTransform(\\\'d\\\', \\\'value\\\'))),\\n350.             ).values(\\\'key\\\').annotate(count=Count(\\\'key\\\')).order_by(\\\'count\\\'),\\n351.             [(None, 0), (\\\'g\\\', 1)],\\n352.             operator.itemgetter(\\\'key\\\', \\\'count\\\'),\\n353.         )\\n354. \\n355.     @skipIf(connection.vendor == \\\'oracle\\\', "Oracle doesn\\\'t support grouping by LOBs, see #24096.")\\n356.     def test_ordering_grouping_by_count(self):\\n357.         qs = NullableJSONModel.objects.filter(\\n358.             value__isnull=False,\\n359.         ).values(\\\'value__d__0\\\').annotate(count=Count(\\\'value__d__0\\\')).order_by(\\\'count\\\')\\n360.         self.assertQuerysetEqual(qs, [1, 11], operator.itemgetter(\\\'count\\\'))\\n361. \\n362.     def test_order_grouping_custom_decoder(self):\\n363.         NullableJSONModel.objects.create(value_custom={\\\'a\\\': \\\'b\\\'})\\n364.         qs = NullableJSONModel.objects.filter(value_custom__isnull=False)\\n365.         self.assertSequenceEqual(\\n366.             qs.values(\\n367.                 \\\'value_custom__a\\\',\\n368.             ).annotate(\\n369.                 count=Count(\\\'id\\\'),\\n370.             ).order_by(\\\'value_custom__a\\\'),\\n371.             [{\\\'value_custom__a\\\': \\\'b\\\', \\\'count\\\': 1}],\\n372.         )\\n373. \\n374.     def test_key_transform_raw_expression(self):\\n375.         expr = RawSQL(self.raw_sql, [\\\'{"x": "bar"}\\\'])\\n376.         self.assertSequenceEqual(\\n377.             NullableJSONModel.objects.filter(value__foo=KeyTransform(\\\'x\\\', expr)),\\n378.             [self.objs[7]],\\n379.         )\\n380. \\n381.     def test_nested_key_transform_raw_expression(self):\\n382.         expr = RawSQL(self.raw_sql, [\\\'{"x": {"y": "bar"}}\\\'])\\n383.         self.assertSequenceEqual(\\n384.             NullableJSONModel.objects.filter(value__foo=KeyTransform(\\\'y\\\', KeyTransform(\\\'x\\\', expr))),\\n385.             [self.objs[7]],\\n386.         )\\n387. \\n388.     def test_key_transform_expression(self):\\n389.         self.assertSequenceEqual(\\n390.             NullableJSONModel.objects.filter(value__d__0__isnull=False).annotate(\\n391.                 key=KeyTransform(\\\'d\\\', \\\'value\\\'),\\n392.                 chain=KeyTransform(\\\'0\\\', \\\'key\\\'),\\n393.                 expr=KeyTransform(\\\'0\\\', Cast(\\\'key\\\', models.JSONField())),\\n394.             ).filter(chain=F(\\\'expr\\\')),\\n395.             [self.objs[4]],\\n396.         )\\n397. \\n398.     def test_nested_key_transform_expression(self):\\n399.         self.assertSequenceEqual(\\n400.             NullableJSONModel.objects.filter(value__d__0__isnull=False).annotate(\\n401.                 key=KeyTransform(\\\'d\\\', \\\'value\\\'),\\n402.                 chain=KeyTransform(\\\'f\\\', KeyTransform(\\\'1\\\', \\\'key\\\')),\\n403.                 expr=KeyTransform(\\\'f\\\', KeyTransform(\\\'1\\\', Cast(\\\'key\\\', models.JSONField()))),\\n404.             ).filter(chain=F(\\\'expr\\\')),\\n405.             [self.objs[4]],\\n406.         )\\n407. \\n408.     def test_has_key(self):\\n409.         self.assertSequenceEqual(\\n410.             NullableJSONModel.objects.filter(value__has_key=\\\'a\\\'),\\n411.             [self.objs[3], self.objs[4]],\\n412.         )\\n413. \\n414.     def test_has_key_null_value(self):\\n415.         self.assertSequenceEqual(\\n416.             NullableJSONModel.objects.filter(value__has_key=\\\'j\\\'),\\n417.             [self.objs[4]],\\n418.         )\\n419. \\n420.     def test_has_key_deep(self):\\n421.         tests = [\\n422.             (Q(value__baz__has_key=\\\'a\\\'), self.objs[7]),\\n423.             (Q(value__has_key=KeyTransform(\\\'a\\\', KeyTransform(\\\'baz\\\', \\\'value\\\'))), self.objs[7]),\\n424.             (Q(value__has_key=KeyTransform(\\\'c\\\', KeyTransform(\\\'baz\\\', \\\'value\\\'))), self.objs[7]),\\n425.             (Q(value__d__1__has_key=\\\'f\\\'), self.objs[4]),\\n426.             (\\n427.                 Q(value__has_key=KeyTransform(\\\'f\\\', KeyTransform(\\\'1\\\', KeyTransform(\\\'d\\\', \\\'value\\\')))),\\n428.                 self.objs[4],\\n429.             )\\n430.         ]\\n431.         for condition, expected in tests:\\n432.             with self.subTest(condition=condition):\\n433.                 self.assertSequenceEqual(\\n434.                     NullableJSONModel.objects.filter(condition),\\n435.                     [expected],\\n436.                 )\\n437. \\n438.     def test_has_key_list(self):\\n439.         obj = NullableJSONModel.objects.create(value=[{\\\'a\\\': 1}, {\\\'b\\\': \\\'x\\\'}])\\n440.         tests = [\\n441.             Q(value__1__has_key=\\\'b\\\'),\\n442.             Q(value__has_key=KeyTransform(\\\'b\\\', KeyTransform(1, \\\'value\\\'))),\\n443.             Q(value__has_key=KeyTransform(\\\'b\\\', KeyTransform(\\\'1\\\', \\\'value\\\'))),\\n444.         ]\\n445.         for condition in tests:\\n446.             with self.subTest(condition=condition):\\n447.                 self.assertSequenceEqual(\\n448.                     NullableJSONModel.objects.filter(condition),\\n449.                     [obj],\\n450.                 )\\n451. \\n452.     def test_has_keys(self):\\n453.         self.assertSequenceEqual(\\n454.             NullableJSONModel.objects.filter(value__has_keys=[\\\'a\\\', \\\'c\\\', \\\'h\\\']),\\n455.             [self.objs[4]],\\n456.         )\\n457. \\n458.     def test_has_any_keys(self):\\n459.         self.assertSequenceEqual(\\n460.             NullableJSONModel.objects.filter(value__has_any_keys=[\\\'c\\\', \\\'l\\\']),\\n461.             [self.objs[3], self.objs[4], self.objs[6]],\\n462.         )\\n463. \\n464.     @skipUnlessDBFeature(\\\'supports_json_field_contains\\\')\\n465.     def test_contains(self):\\n466.         tests = [\\n467.             ({}, self.objs[2:5] + self.objs[6:8]),\\n468.             ({\\\'baz\\\': {\\\'a\\\': \\\'b\\\', \\\'c\\\': \\\'d\\\'}}, [self.objs[7]]),\\n469.             ({\\\'baz\\\': {\\\'a\\\': \\\'b\\\'}}, [self.objs[7]]),\\n470.             ({\\\'baz\\\': {\\\'c\\\': \\\'d\\\'}}, [self.objs[7]]),\\n471.             ({\\\'k\\\': True, \\\'l\\\': False}, [self.objs[6]]),\\n472.             ({\\\'d\\\': [\\\'e\\\', {\\\'f\\\': \\\'g\\\'}]}, [self.objs[4]]),\\n473.             ({\\\'d\\\': [\\\'e\\\']}, [self.objs[4]]),\\n474.             ({\\\'d\\\': [{\\\'f\\\': \\\'g\\\'}]}, [self.objs[4]]),\\n475.             ([1, [2]], [self.objs[5]]),\\n476.             ([1], [self.objs[5]]),\\n477.             ([[2]], [self.objs[5]]),\\n478.             ({\\\'n\\\': [None]}, [self.objs[4]]),\\n479.             ({\\\'j\\\': None}, [self.objs[4]]),\\n480.         ]\\n481.         for value, expected in tests:\\n482.             with self.subTest(value=value):\\n483.                 qs = NullableJSONModel.objects.filter(value__contains=value)\\n484.                 self.assertSequenceEqual(qs, expected)\\n485. \\n486.     @skipIfDBFeature(\\\'supports_json_field_contains\\\')\\n487.     def test_contains_unsupported(self):\\n488.         msg = \\\'contains lookup is not supported on this database backend.\\\'\\n489.         with self.assertRaisesMessage(NotSupportedError, msg):\\n490.             NullableJSONModel.objects.filter(\\n491.                 value__contains={\\\'baz\\\': {\\\'a\\\': \\\'b\\\', \\\'c\\\': \\\'d\\\'}},\\n492.             ).get()\\n493. \\n494.     @skipUnlessDBFeature(\\n495.         \\\'supports_primitives_in_json_field\\\',\\n496.         \\\'supports_json_field_contains\\\',\\n497.     )\\n498.     def test_contains_primitives(self):\\n499.         for value in self.primitives:\\n500.             with self.subTest(value=value):\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'tests/modeladmin/tests.py\', \'content\': \'53.     # form/fields/fieldsets interaction ##############################\\n54. \\n55.     def test_default_fields(self):\\n56.         ma = ModelAdmin(Band, self.site)\\n57.         self.assertEqual(list(ma.get_form(request).base_fields), [\\\'name\\\', \\\'bio\\\', \\\'sign_date\\\'])\\n58.         self.assertEqual(list(ma.get_fields(request)), [\\\'name\\\', \\\'bio\\\', \\\'sign_date\\\'])\\n59.         self.assertEqual(list(ma.get_fields(request, self.band)), [\\\'name\\\', \\\'bio\\\', \\\'sign_date\\\'])\\n60.         self.assertIsNone(ma.get_exclude(request, self.band))\\n61. \\n62.     def test_default_fieldsets(self):\\n63.         # fieldsets_add and fieldsets_change should return a special data structure that\\n64.         # is used in the templates. They should generate the "right thing" whether we\\n65.         # have specified a custom form, the fields argument, or nothing at all.\\n66.         #\\n67.         # Here\\\'s the default case. There are no custom form_add/form_change methods,\\n68.         # no fields argument, and no fieldsets argument.\\n69.         ma = ModelAdmin(Band, self.site)\\n70.         self.assertEqual(ma.get_fieldsets(request), [(None, {\\\'fields\\\': [\\\'name\\\', \\\'bio\\\', \\\'sign_date\\\']})])\\n71.         self.assertEqual(ma.get_fieldsets(request, self.band), [(None, {\\\'fields\\\': [\\\'name\\\', \\\'bio\\\', \\\'sign_date\\\']})])\\n72. \\n73.     def test_get_fieldsets(self):\\n74.         # get_fieldsets() is called when figuring out form fields (#18681).\\n75.         class BandAdmin(ModelAdmin):\\n76.             def get_fieldsets(self, request, obj=None):\\n77.                 return [(None, {\\\'fields\\\': [\\\'name\\\', \\\'bio\\\']})]\\n78. \\n79.         ma = BandAdmin(Band, self.site)\\n80.         form = ma.get_form(None)\\n81.         self.assertEqual(form._meta.fields, [\\\'name\\\', \\\'bio\\\'])\\n82. \\n83.         class InlineBandAdmin(TabularInline):\\n84.             model = Concert\\n85.             fk_name = \\\'main_band\\\'\\n86.             can_delete = False\\n87. \\n88.             def get_fieldsets(self, request, obj=None):\\n89.                 return [(None, {\\\'fields\\\': [\\\'day\\\', \\\'transport\\\']})]\\n90. \\n91.         ma = InlineBandAdmin(Band, self.site)\\n92.         form = ma.get_formset(None).form\\n93.         self.assertEqual(form._meta.fields, [\\\'day\\\', \\\'transport\\\'])\\n94. \', \'start_line_number\': 53, \'end_line_number\': 94}\n\n{\'relative_path\': \'tests/modeladmin/tests.py\', \'content\': "146.     def test_field_arguments_restricted_on_form(self):\\n147.         # If fields or fieldsets is specified, it should exclude fields on the\\n148.         # Form class to the fields specified. This may cause errors to be\\n149.         # raised in the db layer if required model fields aren\'t in fields/\\n150.         # fieldsets, but that\'s preferable to ghost errors where a field in the\\n151.         # Form class isn\'t being displayed because it\'s not in fields/fieldsets.\\n152. \\n153.         # Using `fields`.\\n154.         class BandAdmin(ModelAdmin):\\n155.             fields = [\'name\']\\n156. \\n157.         ma = BandAdmin(Band, self.site)\\n158.         self.assertEqual(list(ma.get_form(request).base_fields), [\'name\'])\\n159.         self.assertEqual(list(ma.get_form(request, self.band).base_fields), [\'name\'])\\n160. \\n161.         # Using `fieldsets`.\\n162.         class BandAdmin(ModelAdmin):\\n163.             fieldsets = [(None, {\'fields\': [\'name\']})]\\n164. \\n165.         ma = BandAdmin(Band, self.site)\\n166.         self.assertEqual(list(ma.get_form(request).base_fields), [\'name\'])\\n167.         self.assertEqual(list(ma.get_form(request, self.band).base_fields), [\'name\'])\\n168. \\n169.         # Using `exclude`.\\n170.         class BandAdmin(ModelAdmin):\\n171.             exclude = [\'bio\']\\n172. \\n173.         ma = BandAdmin(Band, self.site)\\n174.         self.assertEqual(list(ma.get_form(request).base_fields), [\'name\', \'sign_date\'])\\n175. \\n176.         # You can also pass a tuple to `exclude`.\\n177.         class BandAdmin(ModelAdmin):\\n178.             exclude = (\'bio\',)\\n179. \\n180.         ma = BandAdmin(Band, self.site)\\n181.         self.assertEqual(list(ma.get_form(request).base_fields), [\'name\', \'sign_date\'])\\n182. \\n183.         # Using `fields` and `exclude`.\\n184.         class BandAdmin(ModelAdmin):\\n185.             fields = [\'name\', \'bio\']\\n186.             exclude = [\'bio\']\\n187. \\n188.         ma = BandAdmin(Band, self.site)\\n189.         self.assertEqual(list(ma.get_form(request).base_fields), [\'name\'])\\n190. ", \'start_line_number\': 146, \'end_line_number\': 190}\n\n{\'relative_path\': \'tests/modeladmin/tests.py\', \'content\': "334.     def test_custom_form_validation(self):\\n335.         # If a form is specified, it should use it allowing custom validation\\n336.         # to work properly. This won\'t break any of the admin widgets or media.\\n337.         class AdminBandForm(forms.ModelForm):\\n338.             delete = forms.BooleanField()\\n339. \\n340.         class BandAdmin(ModelAdmin):\\n341.             form = AdminBandForm\\n342. \\n343.         ma = BandAdmin(Band, self.site)\\n344.         self.assertEqual(list(ma.get_form(request).base_fields), [\'name\', \'bio\', \'sign_date\', \'delete\'])\\n345.         self.assertEqual(type(ma.get_form(request).base_fields[\'sign_date\'].widget), AdminDateWidget)\\n346. ", \'start_line_number\': 334, \'end_line_number\': 346}\n\n{\'relative_path\': \'tests/modeladmin/tests.py\', \'content\': "582.         self.assertEqual(\\n583.             list(cmafa.base_fields[\'main_band\'].widget.choices),\\n584.             [(self.band.id, \'The Doors\')]\\n585.         )\\n586. \\n587.         self.assertEqual(type(cmafa.base_fields[\'opening_band\'].widget.widget), AdminRadioSelect)\\n588.         self.assertEqual(cmafa.base_fields[\'opening_band\'].widget.attrs, {\'class\': \'radiolist\'})\\n589.         self.assertEqual(\\n590.             list(cmafa.base_fields[\'opening_band\'].widget.choices),\\n591.             [(\'\', \'None\'), (self.band.id, \'The Doors\')]\\n592.         )\\n593.         self.assertEqual(type(cmafa.base_fields[\'day\'].widget), AdminRadioSelect)\\n594.         self.assertEqual(cmafa.base_fields[\'day\'].widget.attrs, {\'class\': \'radiolist\'})\\n595.         self.assertEqual(list(cmafa.base_fields[\'day\'].widget.choices), [(1, \'Fri\'), (2, \'Sat\')])\\n596. \\n597.         self.assertEqual(type(cmafa.base_fields[\'transport\'].widget), AdminRadioSelect)\\n598.         self.assertEqual(cmafa.base_fields[\'transport\'].widget.attrs, {\'class\': \'radiolist inline\'})\\n599.         self.assertEqual(\\n600.             list(cmafa.base_fields[\'transport\'].widget.choices),\\n601.             [(\'\', \'None\'), (1, \'Plane\'), (2, \'Train\'), (3, \'Bus\')]\\n602.         )\\n603. \\n604.         class AdminConcertForm(forms.ModelForm):\\n605.             class Meta:\\n606.                 model = Concert\\n607.                 exclude = (\'transport\',)\\n608. \\n609.         class ConcertAdmin(ModelAdmin):\\n610.             form = AdminConcertForm\\n611. \\n612.         ma = ConcertAdmin(Concert, self.site)\\n613.         self.assertEqual(list(ma.get_form(request).base_fields), [\'main_band\', \'opening_band\', \'day\'])\\n614. \\n615.         class AdminConcertForm(forms.ModelForm):\\n616.             extra = forms.CharField()\\n617. \\n618.             class Meta:\\n619.                 model = Concert\\n620.                 fields = [\'extra\', \'transport\']\\n621. \\n622.         class ConcertAdmin(ModelAdmin):\\n623.             form = AdminConcertForm\\n624. ", \'start_line_number\': 582, \'end_line_number\': 624}\n\n{\'relative_path\': \'tests/modeladmin/tests.py\', \'content\': \'689.             form = model_admin.get_form(request)()\\n690.             self.assertIsInstance(form.fields[\\\'band\\\'].widget.widget, AutocompleteSelect)\\n691.         finally:\\n692.             self.site.unregister(Band)\\n693. \\n694.     def test_get_deleted_objects(self):\\n695.         mock_request = MockRequest()\\n696.         mock_request.user = User.objects.create_superuser(username=\\\'bob\\\', email=\\\'bob@test.com\\\', password=\\\'test\\\')\\n697.         self.site.register(Band, ModelAdmin)\\n698.         ma = self.site._registry[Band]\\n699.         deletable_objects, model_count, perms_needed, protected = ma.get_deleted_objects([self.band], request)\\n700.         self.assertEqual(deletable_objects, [\\\'Band: The Doors\\\'])\\n701.         self.assertEqual(model_count, {\\\'bands\\\': 1})\\n702.         self.assertEqual(perms_needed, set())\\n703.         self.assertEqual(protected, [])\\n704. \\n705.     def test_get_deleted_objects_with_custom_has_delete_permission(self):\\n706.         """\\n707.         ModelAdmin.get_deleted_objects() uses ModelAdmin.has_delete_permission()\\n708.         for permissions checking.\\n709.         """\\n710.         mock_request = MockRequest()\', \'start_line_number\': 689, \'end_line_number\': 710}\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-12-23 17:55:39,584 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file', 'arguments': '{"relative_path": "tests/forms_tests/field_tests/test_jsonfield.py"}'}, '__gemini_function_call_thought_signatures__': {'7ef46e49-39bd-46d0-877e-13cbb04d1ef3': 'CvODAQGPPWtfqp1MNsfyk7aTJ92hnsoauo+JkMdJzG+qpmOjBjfDOOpYKxQTfAfZgmejQx/KO3FPkKD/0ihkc0Tk/eiW6VLo3QD1Bw0jw08oALGywioR6A7wq5fIfkg69YlO1o2oHpUoJA0LUgpAGTidWUhC+R8xeRHuIMLyIJkiiItnKG0RK/E2PGXiKiK3MbbbuTggs76ItGqxMKmfXYHsdE109tpAr/ubMD7iku6uF1QPYbzuPO3BzCmP1T66/pmRnWmtJePyzxrAFN4PSxZIp84Q3rRqN8efxmC6n9tKfMGLBWjSVk6kVKr9205pSvn9gyB00aWDlVGd+kSHwxk7XD5O4r8FRECbMeHrms7Zs/UTRYJm8hIy0prsyutQFszySrsFeWhY4V3kF5giABRI9VM3IpyyPe24xAi8OuU6IZ+f54ozHbqox7q/XUZ3akZCumMD4X4eu4DTQJs/fVRbGHQ/vAz0GNChvImH1x5zDuiS42S6ONFF2JsyXKdRLuzQ96W8LAf6jXTdC+4SyN+VbIqyGsVvW67JFlBDmwmQFkW6JJGOUxTF0c9WEbKJJrVQB2gmHV66mZLfX16CnbRv3R98glX80jU0Py5r3DUh+k3cGuchV3kql0Lh3IfJJ6SZkvC9UH/FmfukCRnExawGntP800U0SPeE3B+CP1dwl0wSVmesJAY1GGvMWtvSNlbeTT5ZG2DjTcYiKvQnfzK83OFRX09wM6uH0KSZr+DK4IIwtZYFsRC/lraMXtZd4wSDetEV7MPTAT1M0FKMpqvP2Nv7cyOvarew3ccyovxGHTjB6dZkdC5LLR1mNa9fPC3TK8sEBahPvVtlVaoVRuzW2E68OAI7ziqkkAjfUs4t5SHrdyKjXnFQ/7RbivVlaSIjXW2ApXpX0AEhIOwlPME3JnfYun1IwYeVDthuNh5nMSzhjgy2jGN7aCz6r16ocS6pHU+jmG/ZQVLjrxTR/ghOIfNswhgeU19N1uIUEgfGK2Z57EjW7wMoLc164gyTFaE4sCFbAn1UNB3xLMXkyhwODQDPP1otHQAD/LglOQM5zeohGMNMihBFjaFpfkmKJOipwlPtrbOXy4OqYlPy+S296qTqxz+FHkuoe3eM8QJW64j2SKG0z2+LawzQkJeUxII/mmDsews62doJKX5RrrWZYdsrl5XUcssU2Fx0uGGXFBxA2AgwPS3acIzma7NjyVYvI7p4JLXwHMqPu86L4R8E2Tn6lWMWKVwh869IzlrUOOCK4rIsTXi2B9YfOM1BjIvUUgLPjEgaN98Yvs1MYF3nqeh2s4/92itZpxUimOSVzWzgiBcigBMr2/6JAtGfSV0Rj0KcpuETSdKTiax6pgbikgxmWMkiB+UTf55kIJufV7JzOXOLoPGkyjGWMkzDs/lXfmvp8EA65nTwQpef9tVlB4gyiCiCmqy0BLU3/Tp7VSxt1GSOdlGCchSSCdCXgnOeDnY6AV4RxSYVuZuZ6GaRAPPiDueFJpaaA1JHOdm+96obdZXVlgcvU7C8Hg2HlhxdfOf/I8jlfuc+i+hq9TzOosNfDwQ+gHc3W3WR3Z+OtqMowv4QJsbNvYxj7FCUPrbb0H5mX/6r7hpp91lA433BoIZbltfgqoTvtx4soaEUtF/xX8nEnWrdi1wJVJv9Aq+2Cb4NYLRNRagMdmyTOtUMjlRnRO2GmKyqtkPAgD99t1h2THJbOFOvtCYXkDqEBDxrdAxxfjXOqvAKoLKYjJk9BRQ7dNBzwRvB+zXgPPyMo8a3juCF4H5Jmss1JjthEEOkmsRhRqFSqPNJ+pOJFyeBFxVg5uktaljT5jFhiMnw6uqiLH/1he+xLOsuOXZerL6l/XKgzGJDmUwI+uLsMj+jzOXcZdgha4wwmp88QEITnLQiEE1hsJJDQBz+cQT8dpb9X0cvabvxXgob2KdHZauUhitxgHg6e91a4FG2JbphuW5v92cbkTCWi935Cet8uAeBcUjmEGLT5RH4a0jQTuzyQgHV1jMWM0SPOoODqQIpdwUxJmR8VgNIbO4/yQOJB4FKWMX8Zq6E3JCa6C+N6cRf7XwsbheR50/5MNsnCu21wwKqKny8btE0ce3GCrlwtZ+zOyT1oimPL6t1CRs+7UASI0jD4zZX7FKjsfAGxpPEyl1ltaIG3QscksoeM9P79cGALhli+++IKTYz5JZ0BIKlOmprlEAjvMAIazI5qvjddhQLxIAwz5C1uuiLqdbbO3nkIyeNKVZyx2tGRFqMCbdqqunGpoxOTrthoG2vDFp6iEAPwe0rLxdP//fNxsMfg7n4ffTRhmZtn1/8R1Tr3L2P+rWrZM34NS759ikbUXV/wy1Q6eWdXKFFAMvMXcG/gL0TpDgKhLn/r1uGjJOgEiQovZHLJ0mD8DCcu1QThDZOIZQhDhnALQL57YNy4AkhKKAfFbxuRVw1ZF25lSeH05JtdZklk0eWjYnHkAxE9MTIJod8vzRbKkTBXnf77O26JepH5yoiR4FcTziZ9jqGMwsK/cXeVWytQlrvvH6ZnZ1KzxRE9/fopxAzIMBHWIKl5Er4BR30+Mo0C0BcCwHMXRk1LqlZCBlWPyc+40Aeq3F5usOLclscyA8izu+Bq2rLBB2sCqNOXwth8U3OumNTZ8VKSbqtJs22gg9DwnOFmt0lzdaolgXkUqev4qyZ8fvm6QcJJCDhipiC0kpL+VXh2/Mv/pCj6uV0RAHKbb/QmUQcKLUsZZdGAgxXMtS8NWQB2BuOBgBU2z7i2ea/hl+h2hORXwAwnc4DjS64kjnRLdoa4jR584OOiWWuLzN6Y2AHZAyE+qLTLeotmuSRvBpxJwaiW7xH5GPkqYvZe8hgmTWw2OPrIyC/MCraqhSGFyQ3hv/OPaSckUQYDI4bn+LH320hCAcELiyuXOZLhBvqzcyvngnFnx0mxsmbDcSKR3+abOcAG5h/r3M6DKPt3+9xHDwUnabL+MkyQYnmZGUk5oLdeqHSk1oTp7vlHfMD4nnGoQP3pPfoHNZ251HZXk1BeaLEis/1mLyPCjTvfjYYBz7hX4Uck8CztJMzGurOf6l4SlcS17ladn81VRCo6gwTyjRUuVqFoKC3D3UOOqbn7U39JMGZ1WJb9D2vAnwIFTwkmEegVjoh3Rl6G3TYe7V9C5U/5uAnKzyQz/ffugIqjCm2HQqKY3Taz2xNVmdtJCgAso71QL4Meao/fyrrLBNADyd7CqhfGghMOXys/kb618+yPipi96MvAuNkf31XgRxgt+FfTTCl0xDdhLjRSRxSf9BCmwvgV1IvscMHs6JWFHeLMNnfxb9UIzxucc/EGFHRnfNPU9MjQroRslX27B1/FrHJD+nQEi8+GG9QgZjrXB4FSnTE26XkQP1xgTur7pF3L/wODWEQpYXY2flPL+I5Fp2KtHPZx0nLotLs7AezPdu8myxrNA8V+exmbZuVPzPTnMEhpI7p5QawgOZoJCVkOCx0gfxXfKrjWQuFo5P6LY8CLEoKNqcNwH2iTBwNFrCvICDHsjijgGDwEKkI5b+5wYlmY9W5/rzfp3kyea6zDuZIh9ugYZfOVietpW8epfFAijepnkJhoZ87ZYKG3G6KbP4+j6T+CWzgmK6/zH9M00rlAscBw0BSKHiEX67ucVChonkd6su5RP7YQ539JeQi6lrV2oi3CN8ow8HdTPbQMIAhPiz76nCmdpywMEM9jQQVFglzqfJ/t1LQf2+BWIWfnmUKkmtq6J3lWknV2/Ucv4gP1iDSBZk/K1knNamUTSuLEFV7zdBeEwOMVf3hzDo/btdvNEOIRxROCkofX16GjRH2HTf061vNXAPbamh/vEq+KNgLCfLGJjR54kKgColqM1HwBFO0NTlrPR69LLVVHTYC17svwD2i+DYf+JTHljfTIvybsfA9HPvUOqvYizZu5tSvc1vkov2oHxQPuiXub5+fJGdlT9AuBlQGzsm+svVnztAW0eyKValK3UfgOnA1IMLXYGD3o58Uc9vzFgJ/MdUyE1VjEtfJs+GwMYG9VaE64XCocufMwet9gTXbOzvACfUhj7Fo1ZogUtbIrEHvbOOsmmL+vvaSLOYsZLPaZ/n9XxC9CgMw/QoHVMpsoyTonvQbc+xSR1CZXNNPc58zfDKtz2/0D559XLv4ePEO6B0SkvfQj9UiYafOCVmvodH+hQOoLiQoDqwFK++VgQ+I3qs+CEtBnWPIctwHPWVkF+V8HrMH1k2P7ENJ2AncpKJR+t/k6mzSu5NL/HPdHGYGbIJcloTsIJKdNoAYIsJq3YkW56fKQEzVLobnaHeynmY1+NunnZezWsMmp0noRDuB32E4YZ2S2X+Qew4W+j4ZAj/IB8CkHmhEm/OT/lDGOafdalIRrc1j90HxqwxZ4Y4O6JfqQNQ6bBLeCM8a0c2f/vawj3KA3sTgH8uZNw363Zskfvz2J7N3lQW9Ip1Zy8Q+9+vkbHuAcYgDkrNoj8g5k4Kmx29PJ/FyGkQRJ3tPJ8SUSMWYZIz4vvbuQVSL+mTugzCUEYbKaxa9pSRxcqhJghk8z5+lPal9YsxiSyoYn+cHfS7QRzUcy0IbaSDu1/M0fCOspYd9fuOvq806R1lirObpmtm0+XJWqYCxk8Zgl0fxcfLz/TQiLxOc5czX3u0zF2N/xjWXnrkpKUfQOXy0ESBLg71JX/A1jUUKtK6Mu0vKsBKq/tsCl1nSy5uFr0qs0MHYEQepAHcjGxE3PbIujpVsZn3RYKcUnYAwsoZlo3MyzgCTyTsV2OghnMhrquin+S8FS802nB4GMiqMuwZ6tqOA8/agO9r8zmdxmmmNexVfgotKDAZvxhmVVc+KQhNtIwTa5A0jEoL/rsX1HEnsMZTGTIKE55Pl2ujvjNuh5EuDB1QEt3a5mUtqgLE4n+a7vl+g4XMpc9+tOrdji6TPOQuJhAwa8kqW0woGPRg01RxbMRr5ia0d0V2uVvWbFrD4uuRmJ8olPUyMB2qGBQ45HRZZykxErvltLP9QgL8GtYeAdtvg9FhAHUGPvRBMNgWDNTB8lYDCOZCYJOt/rP2lLso083NjkO9VFj+RbVQkOOwYZiELtwmRXBdajkJ0FwANY4NU+Y1ZRHB+3ljCg0jprIyyBW6diF1Egk91TkpcD9V+27PJM688bqyO0/c/U+9NXtREP2J1z794IjN7sfEdbDV3i7ERpsozxdBYpL6STQfxpsMuzj6YJf7Vc4YmFyoiCD5b2qFFAwewdE+L3l87hCc9jkm1ImL97Lxfttau7H2EFmvd7Zn6mD/w5e7ilQbpcyF+wjeIvq/NdgtACcY8KKszDnxjsgqIFPf1gRJ1cBMcAggVtahTwOaVmzjVyeZHQHIpImCjcbptwy5YcEI81XoDIvEqdSp/Hb4k9N6QtmXopUCpzB8hZGRkqgImyX88uLmfzSzKMAocCCAHN0t33fxpQhdzENvreR2cZKtj3i+cqQ0e/l0cypq55CrLw4cKuOePBGbydcTBE2LM4YgZCLyO8C94aZz3uJg1N38sqJuAm3ioCGfEQu2iYDZN0qXLDU1JKK1IJ50OVelnUIMHtsJ9QIjuoVY4TtjWGyjfs4Y9HAmhR3ZqSBiMPaFgjYJ0OSXhoxAr7OSd8H0GTL4tgstzl6p6bqcBLf/3GVlhtg/1XPR0EcBScHP7w219uOkuUkmls+bkPinBp4PI7+zwahdpBy0s5XiYDveMMWCqUY5qMNWQ3d1f+VvQyZWRuz43CfKnMbf7Cz+0hnWed1/9pQq1E9OK9mL/0zDqfsHYl0wx3R/h5C3NfhR/XdWcnVtaxKz3d/YxykIYhzrRUqHY3LKFJgoKjvQ5P/b96T86OyHoTweljyJE//Yo9CK3fea/OrPIsiSHSlKdZkdF2spWG+lsSIJMJMqcUhfDJvELWsWmViywvR/T0oFx10xbekFGFUHrvmRSDysTt+DLcTyMvFs/huzcCwfg2o26KSu9JsGUQkSWILznGxrdzuyqhxtSbdNNzpHUcwToPqm75EypsNzZsu8uF2YgIoG4rrs9JF0LARl50qKAFftZ/ZeqcC1yY9DD7Isp4Fu3r97aC6+nVlvQYQ74KijNPrdRfyae6HcNlm5wKLuf/9Jr5qLB4SxG955yliQrGad3uvDCAMvJ90NOGKXofw3bKZbET6MQUAN71SAp1A2NH6HBpqgVaLh6VoCA5izrzcrad0WxUM1quj+IKfD5bPBROmDNknBt0MzzdXqG3Ssg+m9GVEkVMD3/cqok8YzN0NfkEnCWalBM+xaraY6WIzcM9oweAQrosrC2g11OtjcwqcgOaJhRWQb5Kbc0hDvAPEvmSZ+XCTHGxkanBteoX3bhtzRv3yZIoOLYyTnXK+PDqyWCu792mkAT/LT9gnhLK6spoYScCEyqO32ICWGaURl7wgzXhSoEqtwTaeRq5QprcgfyVfpCj+cv82R3BAZgI5Bzkk9KKZN1VU5eXU2gGfL7ow+NnEpJfj3OrCZ6MkBcVtGTCiboFWPOIlPrdYaJ/7dz4LMlKMVqJYpII61pI95Ce+J3KNFziNjFVWNfLn1rnpPJ6RrQsNM2kyVSC2L+4PhpvMAv0ktmXv+bAiQNaprXZhbEvBKLqwNOVp5ksdlcyfeVqsFHcNFZyImJCU3NND/tDFj63cO5/86WUG2/mSyu37HAZbZztDW1/1u/vZcoZvTgp6J8Y+bojn38qJg25fvTg2Mh9DNL5U5wWD5HQAeQsC/YjN6CHJvmoTZexvB2FblJEW1mIGO9eyN3C+aglQebNaHc7zL2BkTsoiCJNJcc3SHEpd/xfgaavQiDEqvfyKVkO0lcXGuF26L/xR5d+jVyaTIcgM8hbSiAhForyEGbUDUpH98jK+QP/rbMbrQSSnfEmTXq+V0Fm/gyjsYyGXfsB3BvQFPrW2bhlqTfz93pZ1/mFUHxRZ271vfDLsCkFj0xl64OtFoUVz0xyzsL5ZIYXTz8c6ZvWf0Kaf4hIg0l7Av/+9A0QujVmiqx7pGWm2LC6xDti4YlWyP97otIdqUWf6s2C7uQsXlDNKfFxunxTNzmGUzhoms+2B16IPkuIsF3p+SBpNNYAs9u/haT5euuk31+xDQLoirndhGvVLDEXdcgAhW/mhUb85rTZ05ucur6495cZ8JRvx3kYcDDzb4k3mzPdBgXylY0q35F7bHGcTDgSTJpP2vdLBoyNq9d0u42aPW/YMGiaP59WjwdmpMMlQ5chXrauko8NH36e5Ln8fJwPNI9ngIlxlNI8wRbfGhZO+ttVce1FVfWiwzp7HeI2/upL6bacX7ADJLRsST1qd2WVr2rJfvvfFlWcyYbFmPIg19/ROpUOr8wZaaI8oxOd0vqoy2kaGeEoJvWTKRxF75pHdBMDsXcB98IqLzRWtNYnDijp5SMkJ4d9eSarc3J1okpjXtdN7LrTw7EJtEE6d8t9biRpfyvyP1CGm6l58Ch7a9Zu7fXbHac4C799k2qyghHujgzA96vmJLcW2lVV0ftU5RpDK9kcji+mExT/Y8IZpZPbV1vrYzwmuNouInp8x2KLqJtWWLWCDgSmLSBOxYFvWP57Wib9syL4M/2JKgRKR1biUQobJzC0VbCBs0zeZnUYsDT+zWuoAQbru+Z33C6eesl/QiNPsFuXyKc0uqbfLTJ/FuPJ7R8Aj4Cv+MTYiT7Z1NVmZz75elol9MMvg9hjAoBLg2ddzVRNJWVDaBCQBggnCXBUxdMyQR/pSPkCj5RIoThsXTK+jqiOcs011DUf6AReoaFIb9+rouhvmPbK92OG2YvhBWpGw1xMUI4X1cYv8dO0JGlQYXI9uw+bDufDPWCtQz7dd3llnNuiVHdu1ly2cXdNIBxIDgfgHkL7mvCzcRPegkm8HVyRrzaHO/l0Q/KA3krcfDeRkNzYRF9vBvwSVApDDQUmfCkJ+wGkbaGG0dWZia+6YKJoXHD9u4Bnbt5KXaDnY/1InCwpbvax3EKxzZxXtYXKJtAGzL4BGd07x8piTMloQX6RE4TRAPBieoBLcEJMrfiihAcTzHKoXkRG9MgjxhsE0Z1H4blUAT+0MFZ9p86TTImfliQEzd6ocZWM7DdE3nxozzGxqhn7KA2LbdBd7Bvnqfo1+VCdJ2uNst/olHR6FvHrooReXvqBPMScNW/2L7knrW3HJfLRwVKF4/yenT0PWGfCZFHdeIm8BIu4uorEehNKK8QZZ7ZzlWwGdrbX2vPpiSP2pK3wcm7UzU4BjD4Ooqq554yv2fD23r2TM2SBi982p2ti4o0z6tU6zA1altNnetL8QGJscNjcRP6EMTEj7So/0Dl7b/foK0Jj6wPf9StVPYvSHwyI5N9WM2Oc2aVkP3HVfzNb2muyUlkbRtGPy1EVQCwNbyPOxHOjkN/LNDtdPtcQduQkXm09QdsDV466ika6hRQrZQ8UJbg+BlqV9gQbJIS444Yc4p+izHoIeksyH8hBfmB96u8Cx385BEzf4LDn6RwJJD3hE3XXjHXrBqCK4+/LnzWpmqJkzEZTc3o7ofKaOGBbL+O86SsdMae62E5p9roAOyoI9tq7iGdCKrY19ShTwKuoXU9r3ztM6G8gSghRB+cGXPCls6L6hSi6c3ImaM2DwOTpUx3bYKZAE10H6GGz4jRGimTaxe3WjZMFo/jtX97Aaq5PysRFZ+gjnKo/wg1G7kVeVrahNtPNtYm1jrYjrB0+8jX7azMgxGQinbT6Ojg1tOQFkJ7PXqvdsQOmBhUNuemltiW/a6R1UTgEdZL7vRyYwif6VIJhTIu7rqJId27k0m9qs7IY9bK7z8VGbE/TkaB7dKTSFsUZnDA4PTv7XkRIAcYDiv+21ex/1wtaXL02aa85zP/7WJGGXW5eQqYezaVgUNJDft53eEotZT4r2DyhsIhkCZgcAmIGbFe+rSvyscwClTZFN+t98MDmEWhjt2k8+dsJhBlfnFuCXciKoUwks+rhAPqcJ+OxC3z7gehDCmaJ/c3zUf5inQbF7MjlWLpNkYk7EzaMkI7LoXRHGc69Y3lBf5rQC7HicfmEUX7TjK+FYKql7j4Eqv2XMMgVW6u1tCJw1sGFZtdIt53RKlXRI0dpYQwV4oKKf/IuWhWzoLBzKjAKY7MpapIP6vASs1huJoo0c9bHi7vgd7Fg/T8DSgF1CL3gL0JIbOCXpLEIfn+wM1PXVgmwUxM0AB5JZEuSRMhOVk37xUzfiu1z/kC2HtQQkfCX2CFPPlgIIpGcbJxyGOgERR/MxGTvzNllcAM4p8fUb8SMPs9R5Zj4DQ2eJLG3gYFeWVZD62/cIFmG4blISNFMge3kElU/ju1uLGljKI3onAsYDtOXYqcx+l2Sfe0MIpoY7R2F3fIZkXj1pcPAGIS7rg+G2nYhzwBcCih8cnzyfm6D3EoYWfVI+JFcQ65v8OfJSdiW4qL7vtZtic5Bb480EW3UqKxRqUlRfDyVSlUJsHTHCTFhDwmCrtMIh8mZ/JKeIB3ZqlWL6uZb0cXHqUtNqWL/Wh0Rk+ggF6yBD316mps0FZn9v1MqIFQZbXA75m05xGkjGqnEcz+OtTl03Y3v8rUlDloVoT0WMk5o9ETAEunJlQmabFoXCiW+kZbecmv17amSXxHV3PvRW1FsLKazbcskc5VEEiXMX6qM/WlJY25UzS8BUzNjM50ezuBQoS4/uaIFpU9W/DXY5bxmkmaJJHZGHAcwT/dT3LwwUCziBLrrsJ7EvhMnRhLaBUOHcOi3vHKxkCUHZln9X9QDyiOawS+eJFWI1fLwCLNah68gc9qXIeVFSabUmtXmvJMVJfkl3aKmGOLkcQJb10yR62xFGdGBxml9640j3Y5Ro0l/KWuoyrAGxOXJA2kf1plI0WGzQYDHhIUgVtSA/iI5Q5tyLB25FDkpP38+CEzhrPb0iNYkvjxEbCib2lS6nzxApo3AqC0EN9ykL62jpmd7v0h4xDhsBFm6VOhcbvBIA5uRwG7YqSusuDQuBykhZYsfaSfhSKcDvExVAhuX1Qw2qfsOn2Zr4lHqQJhdsgjp4Ms6OZ1TJaWHo5Y7hnhScWjIeN94FlD253zwqyYF1XSriOJTb5zkpNNlknzmUnt+pKwa6DUBqszKcBRYdf6pa1+cPUPiOgcAbjzuBuAdQwEY+d46bBv7tjPEeeOqcucgbCY8rhZLYtssHLm3j6tyiABynvEvvFUiyZbeAD33Je6wwypaSQdX6HhSk63mJrN5+Mjxvf1xzFoLJDc+SpNR4Txz4EqCbJC8aehSXdPx+xZOgadvEw+eSa8p8T4f92WwHli6m78rg82mLKb6e9Edjc/CEX9x8Gve0z2969YQDLIuRkKh/v2l6ZcJGu4BaGJFvbB+u9MduI7j3TvBvsw7DDKeqCXLaPXliDO/1hptgNPAgtWon/0lqU2gmf6MUBZX11BlGORV7kUczvEkegGolh2oXPy+2YDSyw7FYEAOHYajJJQVHjzN/HEGrM/EcSKyOeZuvx+BBSSn1z4tR+JCSm6BofoTgXDOdJBUVzZg3ctHn9FPZafKnFlpy1KHcx2Dffz1W85Bbbjf7AiAhcw34NIFU79j65RMiKRvV6ppSIg9adL1a65fO1LR/AdboW5DOJa03h8hySf/reS2q8tUSMpFKyWZ4WlMu0TTJ0iOGYigUUQboIQYISFe1u4pyA6u36USAURYdoEQdzExxSgCvEiKPgD9cejiicAXS2UO71pg28Py3OKNGO3qus+AYXzLUh+TSO3UK9D8nKJTe8AIggNMnHtLRcA5Gw0ssr6OoX5ZAQPAfiEsTrSmwrulHcYjiZXGxOTeA5epI4xg/B6/2pFbmepWCtrSkC1hI5NBgnvr9lk3I9rjwzuhdP38jEMCT27E/WCdy5lzg/CWxGw3VLAjMIHvsk87f1lv4/FX661QPUMaL+OiPTK6fz6Vjwt31aD606R7RpYVItDiz39aHvj6wy6danWe9aR53lTvNanHP8YB7wgiN4ZoP5BaBQzKStW+wIZRfcAGm527OIkifsDQNvND+I6KrivMqfBR00A3wHoq0e1bzdFZdKRC1b+X7Y4n2wMpWZXfiqkVbIY3uqcE6XZHHqSUVtH0ZxJBUmXxP7y89ZapSs/IuXiF2fk5m7MYcsiH9im5jdD6RRR7hH9F1MCOU2QSSKEzU1jPjEFU7J1HrkDxPPeriGbZBciB8d9OYcuonfN3Fkw+jbAH46KGutS/qx83zmpr77ZeDqyROkkWKJixrUVBqqpEmrvY417PUPwm7ukYparljJjMNF/rZFf1Uk9LcJETzP6G3IkibzUG1Ykih+0BQlzMc/r3U31/XvFJLXla3RWcfoAV6ZGKtOI+Bab+X/CnkFbLkandjx4shJhnbcbvlL1p3DnSNpwh0RYEuCpPSJbknLwSsc6eK+bfEg2BLQ8kDwj8pIZV6d+V70M60oAaOS7fSdGLf/09+4l3tSBb1NFpMozbXa7FQUWr4C6wwNV3j7aoWVoYB2hWk0WDhag+zqIo8GXS8m0lZZwTflnuEjzLrz5NDtXVqfJb22pMj9QgTOp4x3c2Jbm6Q+cGAqOvEkiaCM1TNdap8lFvz/VmhuK3En2sB7BzGXwq5ZvSAG8k0FLp5cXkT1hU0FjRwEVc7yCGARBNCFHqpNll8L/j3ny/MkXTDTcmdJbljMbLVkBlWfMl+osGofzt0p3f+1vkNpkB7F3vQOls32/HAs5FzwJRzV0UOc2ZIun/199ez7vYXrukoqrI9XN9kMnB+XUu+aP6Q0RZXsC3LYbykcO07+4flyNQ8XlhN7jwGGhXly/+EUyBNQGUO+88k3F+giMvkCXUBlxiX4p+iiglkyn/23jmfHezbAe6friOIO6ZxGMKb2xQvOEzAQH7E8NOafV3rP7aR7F1gGU/Up/suAQlMXjcoe7Bpgl9I6ZrLzwfjLUACi3Y14ULn54g2hzS2t+B7+HCZc63sKIkwFPyPjQbA+VaKRGUx8HDT9l0/G7Y9VrIBw7VVqlTB+nn5zZr92CsqXMzVqDhuSVIe78CiApq0sUnuz5s5JLG5Rihg0Uc3u+8Up+Qr11XVrr7RG2rbJuF+dOl/cPmGrM0JrMJqMhSSc3rc4uwYnRjCvCyw4fJFmaELgPTuXxWbJx02QphgHzgLMLVLyG0Gmb7hxQwxD5VKI2nM0ahkV0PPRUR9OZZ0YRZSOid6sm/ZoktKLFojFR38rxoScM76eISjRnajXapNoO5gC37e19MRs1LJ1ToxDYm3HvEjqNKedUI7/+J2Z6Pp2n5l3kfhrzEa8sJD8Dy7PrOuQOKujTS6Wtj/zMMF8YGF6q1M600Oq11RIg0VwR6nt0nmoLhQ7U7HvrMAe1YCqKdgd0hLBQmc42GgBYWAO3WVFcZdM0jbiYDU+MtBZs+5LyqsmNyvW7k0Pu2tZr6NMUvIlKmap/WBwrYi4NpaSC+WoKEC5Vn2zCRZ93psU4GzPZtMcWd94qBN1g+AAJg+Qh3eZAEa8Bzbv1KD0auRrQREWujVD4rUqzrwfGAUkgNYuqKsgorcSojEHHTELGAtIKXROyKRxQ7qXfdOkjW0L8N947ekgfwlMLZCFmiEW8xuWm1hc2LOXglkEBWC8y3nIYh6d46qH4UhiUVqydjJ3t168vgqMluBgAgxeEB0/MbKGFR+MKWC0iGHBOhElXpo/eVuzx/K4oOxHLrlzaLFTu0QdfDiINQgQBYJw2pnb9YiXnLgu7DtMCma+pOOLhW6QlVEpz2G82HxrHGaDo+BWW8PUgEvQe1QNPThfpWKnDziyza2kt2mARmaBR5xin/3MLoeQtMaBwQCtjQvvSo728y1BSY/JNNWHmobAY9XBTtGEIAN1InqdvqqVyYxQ+BK0FqYpLqFkXvmwT3rPZxst2K/aMEHT6yllGD6y1nVgkGa4spPyy3PTptTWfabaSLuE8zEcmzQCAb5GItnIJoVnH5VQ3hGLoZVAldkRbwZBfwYlbQp8qqlnoWIDz3dFxwUT+ObAxJgC2xRRpfK/yNfpe34FIuR/Y+4fyuINgaC5GwFdSyO+SUpU3r4wfcIUrRKQHn+lI51FEsUXFalD4cYmdwc99MXjon7bRcHIFOk/Z9H3QvijVLqcCxaCAUc/SARH8JDZpiOPnjllvL/LJsK6UsHjffpycDWsxQiY9KEtjA4xZT/qF5u69ACHJEXlzVPOuTm9O7IwP/71nfZkQF9GBLgOdg5kQSBvDxh0LtXDk3EYdTRjQVVA5RGguh6fIGRaK3dxH1GlJ0DGc8cSk+NUgYdDZC1jZ3eaAXFor299GQToDXEW9/qOYmE9N36/3GdK35+27GA5zYuj4lAZY1SJ9lvYufskNoNzSIo8Danuxo/C6j7bwQ96MU9R+678R+IWFG4m875wx7n9tAvst5E6P39gQ/cUbQsT3vMtUDvLQz3LWpzzmRP0sXDl5J6rGb8WYpGkk2DoS5bKLfc+2tZI7pGbxrRdBhKWxmmnHURW6gBzF0sDmQvkm5+R2INAFA3q35UGzH7B6LKtIMjEyAAJbAkH/AjabBxWuH5vpgNK1kqica1PZBNvkx1J4uz/aWrck4IPFk3H/VaFxpKjxzQkKOyck+f3IQC/MbVcQm22DHBq3Rn2Fdwa8/0f+wlTElbCMVbi3JSUYNlmm7J/XB7bTAh5/7IKctXiiiPyfsnpDck1BjmAQhkdN1dcSUdFRu2SXh7Qsb5Lk5mk9SFVNfqBIqqNL7lwUmYEY3g3uPUU79HQIPXKfW5yN1a3lOFItFTqEIXlptES2qi8q7LDgLpfAnstvBezyf51ZancySnvor3b1CLYAxIt4Xhg25dGH+0Sc3Hxj014xB9djcTdrYzI0pP+oQc8xn4VX7aeTgAoWMPBmfVRuOWO2U4eE0iKGPP9WbKW9Qk0LihQmKF1DvCSquvvmScVR+RT5sjYHIFu1dja9v9t+oVH89uHEB6qH9H79D7QqHxFR2ED9sMO6dnBvYxfIoJThwgtziMG5siKwB6uVndD/Oo8v4JMoGrT+3YJFnh0RAKGQo7d3GnHofU9BIBDlkhvDPgsnFCvg9optkqqlQiq0k8mRksuEvd8R0Vun/sN3jy1TwR4EDHVkNy9KZFRwRpsaGgvLsWTzjxyfCxfDo1s+pPFu5q+HmNsGJgJRlXkIDWNvDK/yXgQib3aku2f8Ppv8jGTpY+0ZUvNIuwwZQfOXvicC2qW0Hr24DuOMTd0ll98kCpFaErSBfI5OIC96dP04+zhVdy3aEzA6vCvFIkRuZQqcWr+CudjilmMJp/albLDXbhtLKW4XelyWfoBg5Fw0l3DNQ0J4Hbizg+tFM2ROL5JfflhhSq/4GGDmgioFPTmscrj/Kr9Eu6+16dMx+ntkEAq2J/mwEEBPrjVacmeYVUycHMACe4XHb4AWBko6kxnRZnI5loKTVbqytUt2k4a7nlQ99FzuP1ARX9cpQ3VihDoacV2fyoP+LyoJTrqCeU/vJ3fc2q6dCUrbm+9gOiYccJe3E8qklMa4TcQf3bF5ON18Bi8K+vM65ZNMjwkOX/M8VYKJ0YNi/6JHS8LGvvvGqJ7GFs1IkP/mJ6NEAXDnjkt9jM/SNfX/kAtMllNImzl5UHGjTEiGj5X7SMxm4kQyo4Tt4OO9equaRU3CM6JC3MgsbgFD8pGRYBb038f8BWpqwHYSWfXUzuDG+hrnVhAOt/en0Qr9tZC5Q8RjeiyjrFsdKa1LacPDYWXXvDwQb17HjNk8xo2/lDEhPr0ZFMfaXqEEgbB/JtkBxJ1VEXOSohSWRU+7ZuXLBzRpL7sm+BXXNPNG6Sf75EfydQ7ceTgYRjnzFvNcBVb6QsJgwA6wuW6kxN6ioHY9NTuLHAqw/ofgOSeLWJUWbDpquVy0IrGV9FTg0qV4mMYpRct2pme/slxU4C/pNaXK4O4uDOzDScqjreqtCbVFBJW8ao4bOojBKYEs53w/12L+z5n82DMefgROONp2YI7qWCBcwdLmpsAyilQQ40iZOtdaJthOiC3LMCC4LhOf+nmhck+Ia3WMN8d40JfpitHqwQOj7U1xWC0gmfb7TE0lBBnzmKT9J3+NAaFfNr6P8Fi8bsbIAeKnPnc6ydCqsLR5ZZiGz6Aji59pkHpnfgDcgFQKIqwYeQYNyPU1H0QWDaS5UPKW8rSlw+g/kgShFo+DoRiq7ZRO3zUfbljCymwrVzznmdoGYURHwIFxrnkIUrVcohoQiC2idXOh/fNAdGV/MkgQcEq+hvr+WnwZ+Txm4NfR8e1h5H0LUa4e+oXBs8oEpG38t+Nzm8gE9q3m+jUym+npifbVOckn9064NXyQ77Qo0RsErJlgrEwYgH5oF0IAtfZn4jV1EnVLzBEcJ2TWdreA2ezLtxDZMWuG8zJqCd+EQ0/sTUvkqwwHgU7fqICfCg31dMFpQKs1cKtI5cgRzW01SnbNyjZfBhnZBj6Cq0P3PLk7kpuGMmZgyMphpHR5mw9rwi5o50X90Ghcw3d0m20W9HejwyzwyUQs+JABJpO0K2PM/uyKKwnd7Ll/7mqcxYMCVL2w5xcCf3U7+UJGd7oCFEup/gVaWxxWMYb2s2zUUmKXAAE8AuoGa3mWn9rrVhf+XQbsJoItykb6GGzR7MB+euQk6/0Sy9b3R6pwcqHYuMR+qJXDSwbi4BgIGuiEULzZfL5TMXHDW9MXdhXgGJhvQU63fVxIV9PV6cAlw6aF9iDdoEmvH0MuQrXvY+CZKQvf2Adq4v1Swul/I2aw/RUjJ3mCovAxV42wNCfk5BQVgx7N/l2wlahCaN8bBVhMZNMTcdl/7b2ursELoncw2G3TCV87sZDVKs6o/EcbsnqRxA0JmwjPT2HDewF12BTr1XhPJrf0m4p1heBf5G8j/TRpUwgrKxRzYt+BXaLXVqEft54KWemXjPnHZjBVIMOcsTemZVhcWbLbf85IUNVI56Laads9pHY3RN+rfObYmeXr60v7IYDj9J1vjIxF8dKOjQhEaoyjtuZLDHaONLjisYtwsgPq7eULTcO/CBaUARZuVVLct9xq9ypKx3elaZ5/UEanNBGW7ng4aN0NMkoo72LJAsYrQv8NGlpeDTqX+sC6/TXvmPyMdSIuycbC3X8Kl9enKV44wr1gSQA8QNeBA8DWdvXBqg7pL5wKVRB9Y4RetHNAdKJ9xehpG/Ergw4x2pO1e+Sp2VT3sf174nrkP2BtIFKOYf3wwG5sX7tdvhNCJg0iKIT4Zwx1X5Y1/S/B7EO8c/4Ez9pdXgyH2WeItedIahaFF/RdN7vzZj73651CnZ9oQOTbXDdW7hTwNNWT+RcQGwbghvwOyt7BEovcn9QVrfUidzkjbeHcHXmxvHV7Ts2dNP+PhVWeO4tdRUQ+JQXyeaRSfRnz/FhynwYN/fBdmomiac1IKuOX6j2yovX28Ono3VWceaAL6oLVE3d5ftE4kr9QHCSuxN1XXxi1AdicXJZExvHOeIKGDzGOPtKlcMgF1TqOeIdps60tNQtl4FEAusIcPwHPgSS1wQGnwU5WZuO/KsVPXsQYsLmDH96muxtr+cV7omdxo17J7yP+hPscdaV8eL79yw4U+vpIyj1UziUOfYW2YhN2sL7AO5drzSl8cYw2qULzCIOi410zhHhbb4Uh5/odJSH/WADNsfK/OVg3ZsF+iw5vmx/eoklPbCygdh95OrzidqgUYR4C3RA6h+uEe6BIKUFW8R/xU1UjraXrm+vTHTWdH6HqW4GldCSv63sb9jQtKjSuFsfyx/j1IcOnfnzlxdUkfxdn6alF11xHW+a3ukkalA7GM5+Hyg6EtTrhsDZJNksHJMExk+1ke+NyI3DlFZ2lAva2tBvfPeQjiVYPaQC4Vm26r1F5jMztm7Bwv5f+n5P2LxUzlLiLvWsJ0RxzbGGdwELBhI23JePcdA+cr841tDtus1DOzDUFt0YVEaC5lfOAv9MrunhmqhIkS0l0D0QLycSDqi7LJAR3RxUSB+L25OdJABc1ZtTsAoQfNXKelY1hXziFOk721r78XPEIbe4UzQcSoBwtfLQVyw+0rRRmYLDKt9dhJVZDyuR24hQq4CPeWIXjhhvPq6El6OXQQYX9g2GuEKksMoYFNuEkvHchAj4d89xm8SKy7rw4y0uG/s/8lonFZr20Mg/jIkcLcCGI/asRW3jM2ZsF2vRxoVt15wsp/w/XseMW0krrR64BRszW9Vz1tM9vKOS9GOoLE5EumWdHdC7WDBnWaOv2bc+AZ/QxuIBUdetyssZk2RmqkqMHVPdAmURsTVpCWpvsZVnEnum5cs0kyw+EcVkiSEphLM/H+tf/gWa+rSWWd6rkw2Wlq5lPeg9lxs1zerxIQHcLEsynHgIBR57EuYAULMsgO6iewSwT4h+8gUg9KlhaNq38pnpAY/XtmUrvNd9L4eD++DJlsK922otJ27YuyuBFJZrcqQ3+hylDbUOcPCgBwPzpx9PbeJAeXWIoyid5F9FlKfQeTFhdyyho/s0Dar7dZsYZKaFm2qi4tzXeLBCfQFOEiG6SV3m6nv9FXJkfZw3iT5OiS6iF98ZXOCJ0rSzUaR3Ta6J1SzNt7AfQUN8qOx4kKehTOP0P3lPSdIWHhOOi4prUNdD5JTSzqQG2RqPG4iMUBEovzb/HPCtZ8BMc3nR6Q2wS5gTkyt+islSZTLv8iuR9TRDXVUYilw3xkKH7VR9FihEmcLLN9iAoIba0tH3ozGfT+ajF0S7De9J+ZfoyhOkB8icctikpAGaJE2JZ8ku1nPY9d4tTdPRDNUVoKAgyBddWuVjUNpE2Iv+e/XvbadhlFbT6GgFTmjakjim+muVzl4qVGPjabYKKUXi762+VwR1dv1y5A4q7hiCcsd/f3qPMeSfrR+UR43W9o2jl+/TEBrYjwlJ9I7d/8kLBCaXRWF+nlr7QUzgPeVVp2adOIEpU8F5RJlbwXIrqSZajyGeFgF5tVtUAn2WeoNYy278Jt1xOSUaBms9I5gpJDhfzUy1PIEuRMcvvilGsFbyjVY9eajlqGlbQVb2kYrWZUXqdFAVYT6QEbvP5Hcm9CzyxWhTyahsqavXxwdfrqQYzTb9qlu1pOiPwWINrGgGIAIunzRs1nNh8oaBEzDAjYo+bSykDks/AszVHw1WaJygCb53tzq4B3oPKSRmUplAct2LgL9vKQ5TNXqjJMI19+yR7Z2gFGaB5Ytv1GIxCWOFjX8RktQoEIEZaaK/xMw7wtLuwxXl++7kTvOF1TsBbq3Mgcec37Tsb1Ay8NuJNzz+iB0PF22zcX3v24kzcFih9YtBIPzYvHZH27a6/WPPIjJbjN6gkrnyLg4Oul1pbb9HXDR4g+IA42m25w0Q1ktTKrYZS7dQ+zJcZK6Rlgvbb4U5ggApvhvFetYmJBnEyZZY4POpGhxYXS3Pb2bKLE1v/HZ4ovMCX4+oO457CGPvtFOrp2xktf6SFOaNAZYrX8/BBjK8csMjmcc9CGabdoe4FGsGFC5+pAREkuH7WTNBcBfzLuSiywIBMOcXlz6KuGbo85MA+CtmWcn6tbpB63vveBhP48lFZ35tOxApt+uQ6D/B4WgFI/BbeBnzgBkrKe1+SE+iPGVWt/kNWn6UchbLtqTubgef8cSdAqcNORmmMk3/dyvciFbiboumVffLTTCz6C2fj/+YGvzrtsg3uRVYnw+KrNUExOWS3YMnc1n77aVQxjZGgXJJoqVZg5xgzAXMMw3qS/W6Zn4n+vsGj5mTN0kZoAowsY57IwKP7zAq88hIhW+BnWyVC+MDMa1mXGlTVwy6RH+iMqcOKPzrJMZCPI6N+WQW/qyyI3+ik8EH/6MHAFIQxhWaTvrvoFgzv72SELnPsuVv84+MD36VTEeAsQzZ1DZ/mEAFYmbQIgI4krwtWeJZWy/O0lQpId3kqbnLXQo+/SUPqD1EbGNP5KFwvy/i5Htl+f5/DNJAgo7mrgriE7/nFUBQU7GxOUl3/U6c8n/IsVM3zoVM2dFxpHfowc8MQ/79cQRcRCtuzzoF2y5/VuW3BdRcN96IeHkhi4Bxw9ITbFsKbCazJg5keWTfMP+QPlfZpbuyBUrd1phfftxVc/zuyWtp9BMIXg94RD0/dpQq6GupnxQLYeeM9n0jQ+EhqvwUBtO1kwR+RpNyoi3zFGYqQxQYwsss+WOYPFVBykxquYumSr2Hx+JM1tA0uK3U0L+99N3f/xzG8iEmG9UnnHpJxaTItjTvJp8zUoLZZpV/q5dsd5awHaUXfFFp+OnNaJ4rUWvUcOWaw9U8sebRZoIDZ7WwT0R/RPESnLLQ2vCsVEbt10skNUxvf/d8DMhk5D2zPh+zceZTKrga3R9h2tnC0R6KqOXs7fnLl4jEtBKekEcnDt3mnWaJgBN5H6n3kKbky73snq37efRI+nMh1cLj8oizkRrCy/JAhAVSVVe0VLVNtActGzRzkyCB8HvH6d79ZgsncU0BQANupnkUQmdmVPoD0DgHbK3MVDDJKvGMRq8c/yQyqgVclkIpmWU3Z+yVkiC2vnUSdT5J7UEMM/UuL6d2/aeCMREzG0wQClGIDmjbd+09lNP1CU7KpeYj9aogxKkKGoYYHvnVD430X7XTH41exmBKOvp6yVYR3WbBTRVM4n/0Vk9CB5l5KiSp/T+Y/tBvSuqHdbvvvIULzcicbFH/mPEw7ygGRYX7mrmUibCOAgnwUF4zUW7NSnuMm12YNPy5b9tJRJL6/+Ael34OGqoHz+HrE+YZ0wkdyw6o6MIr9A1mDZat/ZgYewXkfpxX3e4HkhTff2bEvXagl1Z6OolQ/YJ3gyXMLivVQgicDx/MIFBgoYlnlk2+Ez2i3hApCiEwy+FEVvQahF2oohtuvpuLL6Rdp0wI8bFGxhCukERdIYy/MMbIS2zrS4/iH1dgXADmhhQP4uCknr5nA9ubVvAK70ItPFwAvjsxSOEybQmnd7dxDtp9XTzwSN6D/rmWL/gkyLJKTAoGTIdf5WVB4O11TI7I2eBeFMU9jiza/XnQBbM/Uc3uRbVFAtA6x5txQsxV38FQF5F95xYDauaYzitVSZQhwVWZZzhKObUW0y9XiLT0QwYjC+0Zc6keh71x/pHAE1dQ2DxpvUhHcuGhLj06FYP/QsKjVeWWT8Z9bfRKfpgYzg8KeBZc6wSXa7C/OUusAa7qCaAkf17+J4vc4eei6lHFmf0SF8hqP15InuDNF123wg5dAqipWf6niphpYLlRFsIp3AJ/b6JfxD9XMlqBLJs2lYN0d7ysHJeSfr+7nEHDmsx+W3cCBM2Y4LADoTrBCTcNTrxedXXFSZ8uSU7Q0ivkHh5q7mEvbz2F4dr5D9zBbmOAWk55I5PDOY4WTQBkRcNtd0WDtMGEAWRtWjareAiPmGDyi6tPtQ/YAT0Lo8RNTZ4TDEQ9fXjryK1jMvjipden/YiE/TyGxCUzWYzjmpr8GvWAgAzcSCa/C7Ub89holzRA+LI9b4apYUgOJvMBxzb2jLtt8rGjsE5QzFznnyrQWbWreAaPceHYtCgHWyayGdbVocE5z6IVIs+sQw3c+79lH1IQyYrZBCeF/YzaOU4JTxYY6KD1YjeekeG+PDXmQsp3OFc18Zgh7fRnTxNtej9TUamUT5AA5yTJoX3F2UBZoKbaZHVMBc8FhJ/HSvTVCBpUpOwJzgROIOSc5QSPgy2laXk172IuUMEAKr9I3F7jtny6l/ceu/U5izBalcgMla6g610NPLWVY+sD1YUc2VG5FyrAf+ZmKbLWXfPjpTGnc3iohu3tkpI0SkYlbvz31GpUprlKr+lzLSRmYHpNBvZQ8muvfo2cBYQZSi45aMQv6PDcqaGCLlggLz7WIcFi/t6UYVLMs8AYh7oeUR1xvXEzkZvq3F+mCbP5c+TXCcmPYkAq0AsXXeSg/56lua7ulg5Sp46piqe0EXGU+Ic20owxsoQRG2btw2flrEYjDO28QWoZ16mstBblWyY/XlAAWq1hl6XOZvEeZm8r7f+dMzqjevmNPHML3heklwWW6BhblJFGJyEeBA+dFLasB1Bw/04d9G6dHfJByUh2dC97R+Fh2V3w/LERo6z2ld3oaUY7WC8ncmpR5YAYopIaiHOd3oWklQll5YOUR6MqP1OOS6AUb1yEVihpZaICsy3UI/W64d/MC5nMWx8Ri8NhXRNOeDfUy9Y6yhnebe1z3a17fpKMcH5Rr2xCIHNLBXhAwqIheXZgPYTi4/CnIyjpQUUGsh5yRQxidqQwzYzeE6FchOIfqBt2STkx9XRb34mxlCaI2QX4xObtS8Uts1GGfD+IvoCMxtTPpQ9cmbR5UXfr6/mck6MQ2ZkffhToP81h/xqc0tD7+pYiUCvQ+IxuwdmkZoa4B4gX4JqCTW3alY73CC9oNjTuLjtIvnv/AAUe1uyCznW59ybs5OspnbVzGqqQp7SfokPP7523H756ldQXYZMDa+nYPI3DijTgf6558hObZVN2Jn/2ew5EIDB1QRq8vPwoayDy8cjk1RpHcP5EeUBQisXjSKM6YCqHB470baKL1u8MH0lI60YrCPuJj+ONI6lFpS+paIUCzfUsp8vfbobuWVk1GNfyoodjeL8y9PwpuWKk73j4HrC41zqklVuUvEKEIh9JJh8AJQWojxaWvGlDLE0fBG8W1TK65Og25bEHzaDAdCjio0N9Ap5Uyfyb9IZLY95rwlSR97pyZU9a8yOJk8ad6453TW0iv3TFDHTQyKmodbGpDozx8FMwXlS1EHIM11yhFW65npjUdb29YZJaBJ+ZTkJKsnaP3TyaLZBTdjAfEDp0RoU+1uXlGsUyDVamhsImtq4UDHlEJDYC95QXNx36akHk6nhiKbW63jZL9I4f0oBy5L6v9GhcFGNtsfSUS3q31BpUqbUrA3lGCf+F2WO3h81/G0AitTu2GzUgfm3eM1ZhrbPVyMemjQsN4Pdq9jHYJZByKYF0ABMBH7Og4ikoXj6ZoNAUyYJNwDPXprTlSw9iW3jnUIaFa0pB+MI4wEgWzg5dhY4rudhYHiBz31lyUFwVZ9V3gz26io578FxkFDMkRDtCBLCUqgg5oYEcxr/EbD0aDAkGTVjNr5fvi8h9GFfOpxhIHiyMwyldfVHDN5pBJ/+4lvDTn7XPxqTdo6RLFUx/gaeVgEJbPPFyNtH8+k2/ACWN0umRvuABUeaXllEuHOm8tSeUzV6s41JovJ4Kem7PTZZvaN6SL20eCTeyNq9/81pmvPZBVIXSAPswxCWivAaP5eQX7SvMxKKOSgtlbZZ9pXDq9itBZTTtVt16gA49tg0z8+WZlelnYlVORkiscABCv3YxOHc+V57z/ZT8x1xIjISSvtQupa2Vpo55Cu+tGZN92POm1r4Jghyyxmm+Ym7gFmSzLENlk9ULtvjcGeeq1KBfe4lZUvRsI3pPw/lkfMO/kS0AYqaVSwGDqkKT5UhuE1DXBNRyhNs0IAHwzNUjFNZq07joxVPLFWQfoXTvzxK/qIUqQE/yzjQndplnvzeP0JXpNJ1gdkzcT7P6XuP7iZCe8OZHaSLPDjQiiJz2yZxEGimXL'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 5625, 'end_index': 6642, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}, {'start_index': 9998, 'end_index': 11019, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}, {'start_index': 11168, 'end_index': 14182, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 57161, 'candidates_token_count': 22, 'total_token_count': 62041, 'prompt_tokens_details': [{'modality': 1, 'token_count': 57161}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 22}], 'thoughts_token_count': 4858, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -24.86102294921875, 'model_name': 'gemini-2.5-pro'} id='run--0bcfd22d-6a33-4583-9182-c2bd98db10d3-0' tool_calls=[{'name': 'read_file', 'args': {'relative_path': 'tests/forms_tests/field_tests/test_jsonfield.py'}, 'id': '7ef46e49-39bd-46d0-877e-13cbb04d1ef3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 57161, 'output_tokens': 22, 'total_tokens': 62041, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 4858}}
2025-12-23 17:55:47,990 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport json\nimport uuid\n\nfrom django.core.serializers.json import DjangoJSONEncoder\nfrom django.forms import (\n    CharField,\n    Form,\n    JSONField,\n    Textarea,\n    TextInput,\n    ValidationError,\n)\nfrom django.test import SimpleTestCase\n\n\nclass JSONFieldTest(SimpleTestCase):\n    def test_valid(self):\n        field = JSONField()\n        value = field.clean(\'{"a": "b"}\')\n        self.assertEqual(value, {"a": "b"})\n\n    def test_valid_empty(self):\n        field = JSONField(required=False)\n        self.assertIsNone(field.clean(""))\n        self.assertIsNone(field.clean(None))\n\n    def test_invalid(self):\n        field = JSONField()\n        with self.assertRaisesMessage(ValidationError, "Enter a valid JSON."):\n            field.clean("{some badly formed: json}")\n\n    def test_prepare_value(self):\n        field = JSONField()\n        self.assertEqual(field.prepare_value({"a": "b"}), \'{"a": "b"}\')\n        self.assertEqual(field.prepare_value(None), "null")\n        self.assertEqual(field.prepare_value("foo"), \'"foo"\')\n\n    def test_prepare_value_non_ascii(self):\n        field = JSONField()\n        self.assertEqual(field.prepare_value("ä¸­å›½"), \'"ä¸­å›½"\')\n\n    def test_widget(self):\n        field = JSONField()\n        self.assertIsInstance(field.widget, Textarea)\n\n    def test_custom_widget_kwarg(self):\n        field = JSONField(widget=TextInput)\n        self.assertIsInstance(field.widget, TextInput)\n\n    def test_custom_widget_attribute(self):\n        """The widget can be overridden with an attribute."""\n\n        class CustomJSONField(JSONField):\n            widget = TextInput\n\n        field = CustomJSONField()\n        self.assertIsInstance(field.widget, TextInput)\n\n    def test_converted_value(self):\n        field = JSONField(required=False)\n        tests = [\n            \'["a", "b", "c"]\',\n            \'{"a": 1, "b": 2}\',\n            "1",\n            "1.5",\n            \'"foo"\',\n            "true",\n            "false",\n            "null",\n        ]\n        for json_string in tests:\n            with self.subTest(json_string=json_string):\n                val = field.clean(json_string)\n                self.assertEqual(field.clean(val), val)\n\n    def test_has_changed(self):\n        field = JSONField()\n        self.assertIs(field.has_changed({"a": True}, \'{"a": 1}\'), True)\n        self.assertIs(field.has_changed({"a": 1, "b": 2}, \'{"b": 2, "a": 1}\'), False)\n\n    def test_custom_encoder_decoder(self):\n        class CustomDecoder(json.JSONDecoder):\n            def __init__(self, object_hook=None, *args, **kwargs):\n                return super().__init__(object_hook=self.as_uuid, *args, **kwargs)\n\n            def as_uuid(self, dct):\n                if "uuid" in dct:\n                    dct["uuid"] = uuid.UUID(dct["uuid"])\n                return dct\n\n        value = {"uuid": uuid.UUID("{c141e152-6550-4172-a784-05448d98204b}")}\n        encoded_value = \'{"uuid": "c141e152-6550-4172-a784-05448d98204b"}\'\n        field = JSONField(encoder=DjangoJSONEncoder, decoder=CustomDecoder)\n        self.assertEqual(field.prepare_value(value), encoded_value)\n        self.assertEqual(field.clean(encoded_value), value)\n\n    def test_formfield_disabled(self):\n        class JSONForm(Form):\n            json_field = JSONField(disabled=True)\n\n        form = JSONForm({"json_field": \'["bar"]\'}, initial={"json_field": ["foo"]})\n        self.assertIn(\'[&quot;foo&quot;]</textarea>\', form.as_p())\n\n    def test_redisplay_wrong_input(self):\n        """\n        Displaying a bound form (typically due to invalid input). The form\n        should not overquote JSONField inputs.\n        """\n\n        class JSONForm(Form):\n            name = CharField(max_length=2)\n            json_field = JSONField()\n\n        # JSONField input is valid, name is too long.\n        form = JSONForm({"name": "xyz", "json_field": \'["foo"]\'})\n        self.assertNotIn("json_field", form.errors)\n        self.assertIn(\'[&quot;foo&quot;]</textarea>\', form.as_p())\n        # Invalid JSONField.\n        form = JSONForm({"name": "xy", "json_field": \'{"foo"}\'})\n        self.assertEqual(form.errors["json_field"], ["Enter a valid JSON."])\n        self.assertIn(\'{&quot;foo&quot;}</textarea>\', form.as_p())\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 10, 'end_index': 1051, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}, {'start_index': 1178, 'end_index': 4194, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 58752, 'candidates_token_count': 1249, 'total_token_count': 60001, 'cached_content_token_count': 56824, 'prompt_tokens_details': [{'modality': 1, 'token_count': 63610}], 'cache_tokens_details': [{'modality': 1, 'token_count': 56824}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1249}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.002138544789689173, 'model_name': 'gemini-2.5-pro'} id='run--88f7ac0d-abbf-4660-ac4c-cbf4f9eae6a9-0' usage_metadata={'input_tokens': 58752, 'output_tokens': 1249, 'total_tokens': 60001, 'input_token_details': {'cache_read': 56824}}
2025-12-23 17:56:09,296 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import json\\nimport uuid\\n\\nfrom django.core.serializers.json import DjangoJSONEncoder\\nfrom django.forms import (\\n    CharField,\\n    Form,\\n    JSONField,\\n    Textarea,\\n    TextInput,\\n    ValidationError,\\n)\\nfrom django.test import SimpleTestCase\\n\\n\\nclass JSONFieldTest(SimpleTestCase):\\n    def test_valid(self):\\n        field = JSONField()\\n        value = field.clean(\'{\\"a\\": \\"b\\"}\')\\n        self.assertEqual(value, {\\"a\\": \\"b\\"})\\n\\n    def test_valid_empty(self):\\n        field = JSONField(required=False)\\n        self.assertIsNone(field.clean(\\"\\"))\\n        self.assertIsNone(field.clean(None))\\n\\n    def test_invalid(self):\\n        field = JSONField()\\n        with self.assertRaisesMessage(ValidationError, \\"Enter a valid JSON.\\"):\\n            field.clean(\\"{some badly formed: json}\\")\\n\\n    def test_prepare_value(self):\\n        field = JSONField()\\n        self.assertEqual(field.prepare_value({\\"a\\": \\"b\\"}), \'{\\"a\\": \\"b\\"}\')\\n        self.assertEqual(field.prepare_value(None), \\"null\\")\\n        self.assertEqual(field.prepare_value(\\"foo\\"), \'\\"foo\\"\')\\n\\n    def test_prepare_value_non_ascii(self):\\n        field = JSONField()\\n        self.assertEqual(field.prepare_value(\\"\\u4e2d\\u56fd\\"), \'\\"\\u4e2d\\u56fd\\"\')\\n\\n    def test_widget(self):\\n        field = JSONField()\\n        self.assertIsInstance(field.widget, Textarea)\\n\\n    def test_custom_widget_kwarg(self):\\n        field = JSONField(widget=TextInput)\\n        self.assertIsInstance(field.widget, TextInput)\\n\\n    def test_custom_widget_attribute(self):\\n        \\"\\"\\"The widget can be overridden with an attribute.\\"\\"\\"\\n\\n        class CustomJSONField(JSONField):\\n            widget = TextInput\\n\\n        field = CustomJSONField()\\n        self.assertIsInstance(field.widget, TextInput)\\n\\n    def test_converted_value(self):\\n        field = JSONField(required=False)\\n        tests = [\\n            \'[\\"a\\", \\"b\\", \\"c\\"]\',\\n            \'{\\"a\\": 1, \\"b\\": 2}\',\\n            \\"1\\",\\n            \\"1.5\\",\\n            \'\\"foo\\"\',\\n            \\"true\\",\\n            \\"false\\",\\n            \\"null\\",\\n        ]\\n        for json_string in tests:\\n            with self.subTest(json_string=json_string):\\n                val = field.clean(json_string)\\n                self.assertEqual(field.clean(val), val)\\n\\n    def test_has_changed(self):\\n        field = JSONField()\\n        self.assertIs(field.has_changed({\\"a\\": True}, \'{\\"a\\": 1}\'), True)\\n        self.assertIs(field.has_changed({\\"a\\": 1, \\"b\\": 2}, \'{\\"b\\": 2, \\"a\\": 1}\'), False)\\n\\n    def test_custom_encoder_decoder(self):\\n        class CustomDecoder(json.JSONDecoder):\\n            def __init__(self, object_hook=None, *args, **kwargs):\\n                return super().__init__(object_hook=self.as_uuid, *args, **kwargs)\\n\\n            def as_uuid(self, dct):\\n                if \\"uuid\\" in dct:\\n                    dct[\\"uuid\\"] = uuid.UUID(dct[\\"uuid\\"])\\n                return dct\\n\\n        value = {\\"uuid\\": uuid.UUID(\\"{c141e152-6550-4172-a784-05448d98204b}\\")}\\n        encoded_value = \'{\\"uuid\\": \\"c141e152-6550-4172-a784-05448d98204b\\"}\'\\n        field = JSONField(encoder=DjangoJSONEncoder, decoder=CustomDecoder)\\n        self.assertEqual(field.prepare_value(value), encoded_value)\\n        self.assertEqual(field.clean(encoded_value), value)\\n\\n    def test_formfield_disabled(self):\\n        class JSONForm(Form):\\n            json_field = JSONField(disabled=True)\\n\\n        form = JSONForm({\\"json_field\\": \'[\\"bar\\"]\'}, initial={\\"json_field\\": [\\"foo\\"]})\\n        self.assertIn(\'[&quot;foo&quot;]</textarea>\', form.as_p())\\n\\n    def test_redisplay_wrong_input(self):\\n        \\"\\"\\"\\n        Displaying a bound form (typically due to invalid input). The form\\n        should not overquote JSONField inputs.\\n        \\"\\"\\"\\n\\n        class JSONForm(Form):\\n            name = CharField(max_length=2)\\n            json_field = JSONField()\\n\\n        # JSONField input is valid, name is too long.\\n        form = JSONForm({\\"name\\": \\"xyz\\", \\"json_field\\": \'[\\"foo\\"]\'})\\n        self.assertNotIn(\\"json_field\\", form.errors)\\n        self.assertIn(\'[&quot;foo&quot;]</textarea>\', form.as_p())\\n        # Invalid JSONField.\\n        form = JSONForm({\\"name\\": \\"xy\\", \\"json_field\\": \'{\\"foo\\"}\'})\\n        self.assertEqual(form.errors[\\"json_field\\"], [\\"Enter a valid JSON.\\"])\\n        self.assertIn(\'{&quot;foo&quot;}</textarea>\', form.as_p())", "relative_path": "tests/forms/test_jsonfield.py"}'}, '__gemini_function_call_thought_signatures__': {'76053121-b7ee-4585-8163-a1c3223b9910': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 4619, 'end_index': 5660, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}, {'start_index': 5787, 'end_index': 8803, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 1567, 'candidates_token_count': 1261, 'total_token_count': 3977, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1567}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1261}], 'thoughts_token_count': 1149, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1467159189561546, 'model_name': 'gemini-2.5-pro'} id='run--a4c92f8e-5620-43b2-ae81-3a1cc061680c-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import json\nimport uuid\n\nfrom django.core.serializers.json import DjangoJSONEncoder\nfrom django.forms import (\n    CharField,\n    Form,\n    JSONField,\n    Textarea,\n    TextInput,\n    ValidationError,\n)\nfrom django.test import SimpleTestCase\n\n\nclass JSONFieldTest(SimpleTestCase):\n    def test_valid(self):\n        field = JSONField()\n        value = field.clean(\'{"a": "b"}\')\n        self.assertEqual(value, {"a": "b"})\n\n    def test_valid_empty(self):\n        field = JSONField(required=False)\n        self.assertIsNone(field.clean(""))\n        self.assertIsNone(field.clean(None))\n\n    def test_invalid(self):\n        field = JSONField()\n        with self.assertRaisesMessage(ValidationError, "Enter a valid JSON."):\n            field.clean("{some badly formed: json}")\n\n    def test_prepare_value(self):\n        field = JSONField()\n        self.assertEqual(field.prepare_value({"a": "b"}), \'{"a": "b"}\')\n        self.assertEqual(field.prepare_value(None), "null")\n        self.assertEqual(field.prepare_value("foo"), \'"foo"\')\n\n    def test_prepare_value_non_ascii(self):\n        field = JSONField()\n        self.assertEqual(field.prepare_value("ä¸­å›½"), \'"ä¸­å›½"\')\n\n    def test_widget(self):\n        field = JSONField()\n        self.assertIsInstance(field.widget, Textarea)\n\n    def test_custom_widget_kwarg(self):\n        field = JSONField(widget=TextInput)\n        self.assertIsInstance(field.widget, TextInput)\n\n    def test_custom_widget_attribute(self):\n        """The widget can be overridden with an attribute."""\n\n        class CustomJSONField(JSONField):\n            widget = TextInput\n\n        field = CustomJSONField()\n        self.assertIsInstance(field.widget, TextInput)\n\n    def test_converted_value(self):\n        field = JSONField(required=False)\n        tests = [\n            \'["a", "b", "c"]\',\n            \'{"a": 1, "b": 2}\',\n            "1",\n            "1.5",\n            \'"foo"\',\n            "true",\n            "false",\n            "null",\n        ]\n        for json_string in tests:\n            with self.subTest(json_string=json_string):\n                val = field.clean(json_string)\n                self.assertEqual(field.clean(val), val)\n\n    def test_has_changed(self):\n        field = JSONField()\n        self.assertIs(field.has_changed({"a": True}, \'{"a": 1}\'), True)\n        self.assertIs(field.has_changed({"a": 1, "b": 2}, \'{"b": 2, "a": 1}\'), False)\n\n    def test_custom_encoder_decoder(self):\n        class CustomDecoder(json.JSONDecoder):\n            def __init__(self, object_hook=None, *args, **kwargs):\n                return super().__init__(object_hook=self.as_uuid, *args, **kwargs)\n\n            def as_uuid(self, dct):\n                if "uuid" in dct:\n                    dct["uuid"] = uuid.UUID(dct["uuid"])\n                return dct\n\n        value = {"uuid": uuid.UUID("{c141e152-6550-4172-a784-05448d98204b}")}\n        encoded_value = \'{"uuid": "c141e152-6550-4172-a784-05448d98204b"}\'\n        field = JSONField(encoder=DjangoJSONEncoder, decoder=CustomDecoder)\n        self.assertEqual(field.prepare_value(value), encoded_value)\n        self.assertEqual(field.clean(encoded_value), value)\n\n    def test_formfield_disabled(self):\n        class JSONForm(Form):\n            json_field = JSONField(disabled=True)\n\n        form = JSONForm({"json_field": \'["bar"]\'}, initial={"json_field": ["foo"]})\n        self.assertIn(\'[&quot;foo&quot;]</textarea>\', form.as_p())\n\n    def test_redisplay_wrong_input(self):\n        """\n        Displaying a bound form (typically due to invalid input). The form\n        should not overquote JSONField inputs.\n        """\n\n        class JSONForm(Form):\n            name = CharField(max_length=2)\n            json_field = JSONField()\n\n        # JSONField input is valid, name is too long.\n        form = JSONForm({"name": "xyz", "json_field": \'["foo"]\'})\n        self.assertNotIn("json_field", form.errors)\n        self.assertIn(\'[&quot;foo&quot;]</textarea>\', form.as_p())\n        # Invalid JSONField.\n        form = JSONForm({"name": "xy", "json_field": \'{"foo"}\'})\n        self.assertEqual(form.errors["json_field"], ["Enter a valid JSON."])\n        self.assertIn(\'{&quot;foo&quot;}</textarea>\', form.as_p())', 'relative_path': 'tests/forms/test_jsonfield.py'}, 'id': '76053121-b7ee-4585-8163-a1c3223b9910', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1567, 'output_tokens': 1261, 'total_tokens': 3977, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1149}}
2025-12-23 17:56:10,668 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/forms/test_jsonfield.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2848, 'candidates_token_count': 10, 'total_token_count': 2858, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3997}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 10}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -9.393005166202784e-06, 'model_name': 'gemini-2.5-pro'} id='run--1fd1453f-cce1-4ca6-ab14-230720f665de-0' usage_metadata={'input_tokens': 2848, 'output_tokens': 10, 'total_tokens': 2858, 'input_token_details': {'cache_read': 0}}
2025-12-23 17:56:11,076 - thread-125107859076800.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/forms/test_jsonfield.py b/tests/forms/test_jsonfield.py
new file mode 100644
index 0000000000..731996daab
--- /dev/null
+++ b/tests/forms/test_jsonfield.py
@@ -0,0 +1,121 @@
+import json
+import uuid
+
+from django.core.serializers.json import DjangoJSONEncoder
+from django.forms import (
+    CharField,
+    Form,
+    JSONField,
+    Textarea,
+    TextInput,
+    ValidationError,
+)
+from django.test import SimpleTestCase
+
+
+class JSONFieldTest(SimpleTestCase):
+    def test_valid(self):
+        field = JSONField()
+        value = field.clean('{"a": "b"}')
+        self.assertEqual(value, {"a": "b"})
+
+    def test_valid_empty(self):
+        field = JSONField(required=False)
+        self.assertIsNone(field.clean(""))
+        self.assertIsNone(field.clean(None))
+
+    def test_invalid(self):
+        field = JSONField()
+        with self.assertRaisesMessage(ValidationError, "Enter a valid JSON."):
+            field.clean("{some badly formed: json}")
+
+    def test_prepare_value(self):
+        field = JSONField()
+        self.assertEqual(field.prepare_value({"a": "b"}), '{"a": "b"}')
+        self.assertEqual(field.prepare_value(None), "null")
+        self.assertEqual(field.prepare_value("foo"), '"foo"')
+
+    def test_prepare_value_non_ascii(self):
+        field = JSONField()
+        self.assertEqual(field.prepare_value("ä¸­å›½"), '"ä¸­å›½"')
+
+    def test_widget(self):
+        field = JSONField()
+        self.assertIsInstance(field.widget, Textarea)
+
+    def test_custom_widget_kwarg(self):
+        field = JSONField(widget=TextInput)
+        self.assertIsInstance(field.widget, TextInput)
+
+    def test_custom_widget_attribute(self):
+        """The widget can be overridden with an attribute."""
+
+        class CustomJSONField(JSONField):
+            widget = TextInput
+
+        field = CustomJSONField()
+        self.assertIsInstance(field.widget, TextInput)
+
+    def test_converted_value(self):
+        field = JSONField(required=False)
+        tests = [
+            '["a", "b", "c"]',
+            '{"a": 1, "b": 2}',
+            "1",
+            "1.5",
+            '"foo"',
+            "true",
+            "false",
+            "null",
+        ]
+        for json_string in tests:
+            with self.subTest(json_string=json_string):
+                val = field.clean(json_string)
+                self.assertEqual(field.clean(val), val)
+
+    def test_has_changed(self):
+        field = JSONField()
+        self.assertIs(field.has_changed({"a": True}, '{"a": 1}'), True)
+        self.assertIs(field.has_changed({"a": 1, "b": 2}, '{"b": 2, "a": 1}'), False)
+
+    def test_custom_encoder_decoder(self):
+        class CustomDecoder(json.JSONDecoder):
+            def __init__(self, object_hook=None, *args, **kwargs):
+                return super().__init__(object_hook=self.as_uuid, *args, **kwargs)
+
+            def as_uuid(self, dct):
+                if "uuid" in dct:
+                    dct["uuid"] = uuid.UUID(dct["uuid"])
+                return dct
+
+        value = {"uuid": uuid.UUID("{c141e152-6550-4172-a784-05448d98204b}")}
+        encoded_value = '{"uuid": "c141e152-6550-4172-a784-05448d98204b"}'
+        field = JSONField(encoder=DjangoJSONEncoder, decoder=CustomDecoder)
+        self.assertEqual(field.prepare_value(value), encoded_value)
+        self.assertEqual(field.clean(encoded_value), value)
+
+    def test_formfield_disabled(self):
+        class JSONForm(Form):
+            json_field = JSONField(disabled=True)
+
+        form = JSONForm({"json_field": '["bar"]'}, initial={"json_field": ["foo"]})
+        self.assertIn('[&quot;foo&quot;]</textarea>', form.as_p())
+
+    def test_redisplay_wrong_input(self):
+        """
+        Displaying a bound form (typically due to invalid input). The form
+        should not overquote JSONField inputs.
+        """
+
+        class JSONForm(Form):
+            name = CharField(max_length=2)
+            json_field = JSONField()
+
+        # JSONField input is valid, name is too long.
+        form = JSONForm({"name": "xyz", "json_field": '["foo"]'})
+        self.assertNotIn("json_field", form.errors)
+        self.assertIn('[&quot;foo&quot;]</textarea>', form.as_p())
+        # Invalid JSONField.
+        form = JSONForm({"name": "xy", "json_field": '{"foo"}'})
+        self.assertEqual(form.errors["json_field"], ["Enter a valid JSON."])
+        self.assertIn('{&quot;foo&quot;}</textarea>', form.as_p())
\ No newline at end of file

2025-12-23 17:56:11,078 - thread-125107859076800.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-23 17:56:11,200 - thread-125107859076800.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-23 17:56:11,200 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-23 17:57:14,435 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:14,435 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

Updating files:   1% (75/6407)
Updating files:   2% (129/6407)
Updating files:   2% (180/6407)
Updating files:   3% (193/6407)
Updating files:   4% (257/6407)
Updating files:   4% (272/6407)
Updating files:   5% (321/6407)
Updating files:   5% (368/6407)
Updating files:   6% (385/6407)
Updating files:   6% (409/6407)
Updating files:   6% (421/6407)
Updating files:   6% (429/6407)
Updating files:   6% (441/6407)
Updating files:   7% (449/6407)
Updating files:   7% (479/6407)
Updating files:   8% (513/6407)
Updating files:   8% (561/6407)
Updating files:   9% (577/6407)
Updating files:  10% (641/6407)
Updating files:  10% (669/6407)
Updating files:  11% (705/6407)
Updating files:  12% (769/6407)
Updating files:  12% (776/6407)
Updating files:  13% (833/6407)
Updating files:  14% (897/6407)
Updating files:  15% (962/6407)
Updating files:  15% (974/6407)
Updating files:  15% (1018/6407)
Updating files:  16% (1026/6407)
Updating files:  16% (1064/6407)
Updating files:  17% (1090/6407)
Updating files:  17% (1104/6407)
Updating files:  18% (1154/6407)
Updating files:  18% (1181/6407)
Updating files:  19% (1218/6407)
Updating files:  19% (1239/6407)
Updating files:  20% (1282/6407)
Updating files:  20% (1297/6407)
Updating files:  21% (1346/6407)
Updating files:  21% (1353/6407)
Updating files:  22% (1410/6407)
Updating files:  22% (1437/6407)
Updating files:  23% (1474/6407)
Updating files:  23% (1495/6407)
Updating files:  24% (1538/6407)
Updating files:  24% (1551/6407)
Updating files:  25% (1602/6407)
Updating files:  25% (1611/6407)
Updating files:  26% (1666/6407)
Updating files:  26% (1667/6407)
Updating files:  26% (1725/6407)
Updating files:  27% (1730/6407)
Updating files:  28% (1794/6407)
Updating files:  28% (1798/6407)
Updating files:  29% (1859/6407)
Updating files:  30% (1923/6407)
Updating files:  30% (1939/6407)
Updating files:  31% (1987/6407)
Updating files:  31% (1997/6407)
Updating files:  32% (2051/6407)
Updating files:  32% (2053/6407)
Updating files:  33% (2115/6407)
Updating files:  33% (2133/6407)
Updating files:  34% (2179/6407)
Updating files:  34% (2191/6407)
Updating files:  35% (2243/6407)
Updating files:  35% (2249/6407)
Updating files:  36% (2307/6407)
Updating files:  36% (2325/6407)
Updating files:  37% (2371/6407)
Updating files:  37% (2378/6407)
Updating files:  38% (2435/6407)
Updating files:  38% (2436/6407)
Updating files:  39% (2499/6407)
Updating files:  39% (2557/6407)
Updating files:  40% (2563/6407)
Updating files:  40% (2617/6407)
Updating files:  41% (2627/6407)
Updating files:  41% (2685/6407)
Updating files:  42% (2691/6407)
Updating files:  42% (2743/6407)
Updating files:  43% (2756/6407)
Updating files:  43% (2801/6407)
Updating files:  44% (2820/6407)
Updating files:  44% (2861/6407)
Updating files:  45% (2884/6407)
Updating files:  45% (2929/6407)
Updating files:  46% (2948/6407)
Updating files:  46% (2975/6407)
Updating files:  47% (3012/6407)
Updating files:  47% (3033/6407)
Updating files:  48% (3076/6407)
Updating files:  48% (3127/6407)
Updating files:  49% (3140/6407)
Updating files:  50% (3204/6407)
Updating files:  51% (3268/6407)
Updating files:  52% (3332/6407)
Updating files:  53% (3396/6407)
Updating files:  54% (3460/6407)
Updating files:  54% (3500/6407)
Updating files:  55% (3524/6407)
Updating files:  56% (3588/6407)
Updating files:  57% (3652/6407)
Updating files:  58% (3717/6407)
Updating files:  59% (3781/6407)
Updating files:  60% (3845/6407)
Updating files:  61% (3909/6407)
Updating files:  62% (3973/6407)
Updating files:  62% (4001/6407)
Updating files:  63% (4037/6407)
Updating files:  64% (4101/6407)
Updating files:  65% (4165/6407)
Updating files:  65% (4206/6407)
Updating files:  66% (4229/6407)
Updating files:  67% (4293/6407)
Updating files:  68% (4357/6407)
Updating files:  68% (4385/6407)
Updating files:  69% (4421/6407)
Updating files:  70% (4485/6407)
Updating files:  71% (4549/6407)
Updating files:  72% (4614/6407)
Updating files:  72% (4622/6407)
Updating files:  73% (4678/6407)
Updating files:  74% (4742/6407)
Updating files:  75% (4806/6407)
Updating files:  76% (4870/6407)
Updating files:  76% (4908/6407)
Updating files:  77% (4934/6407)
Updating files:  78% (4998/6407)
Updating files:  78% (5036/6407)
Updating files:  79% (5062/6407)
Updating files:  79% (5109/6407)
Updating files:  80% (5126/6407)
Updating files:  81% (5190/6407)
Updating files:  82% (5254/6407)
Updating files:  82% (5260/6407)
Updating files:  83% (5318/6407)
Updating files:  84% (5382/6407)
Updating files:  84% (5391/6407)
Updating files:  85% (5446/6407)
Updating files:  86% (5511/6407)
Updating files:  87% (5575/6407)
Updating files:  87% (5634/6407)
Updating files:  88% (5639/6407)
Updating files:  89% (5703/6407)
Updating files:  90% (5767/6407)
Updating files:  90% (5800/6407)
Updating files:  91% (5831/6407)
Updating files:  92% (5895/6407)
Updating files:  93% (5959/6407)
Updating files:  93% (5990/6407)
Updating files:  94% (6023/6407)
Updating files:  95% (6087/6407)
Updating files:  96% (6151/6407)
Updating files:  97% (6215/6407)
Updating files:  98% (6279/6407)
Updating files:  98% (6341/6407)
Updating files:  99% (6343/6407)
Updating files: 100% (6407/6407)
Updating files: 100% (6407/6407), done.
HEAD is now at b790883065 Fixed #31181 -- Added links to related models for admin's readonly fields.

2025-12-23 17:57:14,435 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-23 17:57:14,604 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:14,604 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:57:14,605 - thread-125107859076800.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-23 17:57:14,605 - thread-125107859076800.app.docker.base_container - INFO - Creating directory tests/forms in the container
2025-12-23 17:57:14,605 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/forms
2025-12-23 17:57:14,706 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:14,706 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:57:14,707 - thread-125107859076800.app.docker.base_container - INFO - Updating tests/forms/test_jsonfield.py in the container
2025-12-23 17:57:14,716 - thread-125107859076800.app.docker.base_container - INFO - Files updated successfully
2025-12-23 17:57:17,798 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls -F"}'}, '__gemini_function_call_thought_signatures__': {'086a3dda-1d86-4b35-b2e8-33f8f8347aa8': 'CugGAY89a19hUrHDoSChLw4WONm22aFB6FyeyEX/QkpJ7qIDOMWdwq5quDmPHBPWXrr+gNHdbv3TgQc5fGbOA2eUO2amgiWmTlM4yKvVc5kh1M2UIBBMjctaA7bU/TTkj14qAsLWxgpgvM5WLQEl0Mjt+UJJfYQbpkS3dG9eMsHVFhG9PCW+BgKvsnFdO24nE7Keo4aeMiR7yl2kiWn2jnvRXkB92AkXJ3kGwQlXHrcrE7OoJgpNvDWkZoYIuyVq3/O1D6qYx7u2XScOdlujZaZovg3CWiemw56L2J6X2rwZC+6Um/xUaLoWv88MS3WlL8qpU6BhXXtUoB0P/7lGa0BwPgZL80mWRiTjPtW6QUdhtclWT8whqirrxxEZs82z/Djh3UlLx+UW48QyZpWsGH4x3dUUr/UhlNADE4rVcbroN9FDKsp/DN1HbUE6Wp2QzsAy5WhXhmnbQwoRSOeyesbezEaLT1F4x77X+MiOFfyhWFEC/5S3gzYxF/sKaj5QCxafiwF0kqY13CuUSI2x8X0vLodcAMGogDlr2kAkVVO3xyyMIphqPkewEsan5A8Y7z0cvCcTGHMHDDkpyAIVvbJiiG71OqtMiNyl85CCibyd1dd+QhiLCH2juZ8/2gd5kuzIAKZ9Ra38H2hI1YqRxgDcK/3DGhratVHuX1pDu6Ri8o+wFQclKpM+XEkU5ZOH1ILz96FdQQHV/PbBXrLDLBt2TwQQ/mNQgVn1goKnCwqt2muq6kZlxrzf8t4ayK5FfqqZbntH0ebOflDJWWwyOaHP1dXH3HEKdxsP5nxFg4y82T/+gGg40EtLtzlNUaI+/7v9+j3gB6cE78c3gWbzBOYU3wmbxhJOSVn9Tw7Y+u6rVM/I4LvNhybAMEUts/7anLbGqYmWtB/DODE6irpw/7Yb4rpmFLRijXGCi8Z5pxr64BU+MEAVuhiK+d7Bk320ne77gwvjXm43KBvjvygONRNcPRv/0FUbI+eiDl+9J8t5oJ/QR5znxI3nyMSuN6nT16kqzn6ewLMZ4BcYNSscHPuFGpbC2GmVmebxz2Q50g3jVc4jPjXz33YaaG86DWJD5/Q9f9ZfUKIC8yD+DDWs/WgXjbs0UKCC6GCoB7PmNs9pvnVom/dRg6JgtMDEDYq302A8lbJZMO11Nq4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 355, 'candidates_token_count': 7, 'total_token_count': 576, 'prompt_tokens_details': [{'modality': 1, 'token_count': 355}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 7}], 'thoughts_token_count': 214, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.5985930306570872, 'model_name': 'gemini-2.5-pro'} id='run--9b39c2aa-fb4a-41b2-98b0-366f6cc4e780-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls -F'}, 'id': '086a3dda-1d86-4b35-b2e8-33f8f8347aa8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 355, 'output_tokens': 7, 'total_tokens': 576, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 214}}
2025-12-23 17:57:17,801 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: ls -F
2025-12-23 17:57:17,902 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:17,902 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

AUTHORS		  docs/		js_tests/	package.json  setup.py
CONTRIBUTING.rst  extras/	LICENSE		README.rst    tests/
django/		  Gruntfile.js	LICENSE.python	scripts/      tox.ini
Django.egg-info/  INSTALL	MANIFEST.in	setup.cfg

2025-12-23 17:57:20,392 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest tests/forms/test_jsonfield.py"}'}, '__gemini_function_call_thought_signatures__': {'fbdc6045-04d9-4f4c-8569-949a05d8b78a': 'Cq4EAY89a1+mXewKw+eT8N8rt3ISKV25MnMU/A6Es48VcnW7A+TXPd1zvj+p32BH33lkQXcQcBIkz8u/M7+yxg/WqZJNjWWDFGTX56jEtVOpxvVnjpZbsbeSk2pmNms2znREW5Ffg7qzdH/LXgXcWgF4AE9Ud/vqnSC2bv4t11QO1FTYPinjjBXvg5uz83hvtAM51ESVMvvj1PxEQg8zbMDTb4GjzF71RoFUygZm6Q/qSKDkWm+eoKAcJgRV4VmeDi+o0UNukbVHPMmWrAG8ZHlKe4AU21KzSRAXi/G1kKFK69opG7u998V088eEG+HGXuUqJVByHJZy4hFUWEtjk5IrqgF1sy6decr+XcwcnD4ylo5KVWmuOiFiESzDQ9TTxtWgzN+p4ooxXmusT6T2QGQNOAkxTb97HQahgNSV6c/Ae7bPFGmLGxaZhb1hjwIo/wiL6ixB30nSvK/TKICHSjyUqPADPTeY/GT7FKnr2kpurqtTsv17NCUt0TdwAPnc5NNRWBpb4mBiuRRI5wSQnW3hUs9MBgm/XmK4bfngJgPDqamGz+QfN4VcOiGjPxTByq8UVTn6bpW+lcRDHMS8+5x2f70nWrbPxPdVA/NQ7HJKZXbACKyBwODDiTJigCbPdAEDbiCwoH4R2VqPbB+RyFhrBP9c+n73tesyCT5XFqSRlHCEOtLQ96sF52V/qj8G9hdlQQq30sX0bbXQprniqX81o09PihbKmEetFDceQhJT'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 441, 'candidates_token_count': 15, 'total_token_count': 607, 'prompt_tokens_details': [{'modality': 1, 'token_count': 655}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 15}], 'thoughts_token_count': 151, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.846782112121582, 'model_name': 'gemini-2.5-pro'} id='run--c475cd86-95b1-433e-97ee-ee02c706e970-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest tests/forms/test_jsonfield.py'}, 'id': 'fbdc6045-04d9-4f4c-8569-949a05d8b78a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 441, 'output_tokens': 15, 'total_tokens': 607, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 151}}
2025-12-23 17:57:20,395 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: pytest tests/forms/test_jsonfield.py
2025-12-23 17:57:20,496 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 127
2025-12-23 17:57:20,496 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

bash: pytest: command not found

2025-12-23 17:57:22,372 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tox.ini"}'}, '__gemini_function_call_thought_signatures__': {'b093b94f-4821-4bc5-9d12-e8e62b3fe08c': 'CocDAY89a1+E2Uq7WhEn8i0Z/JgN0nX9D4mJN5DubBwmAMaJKMKFXUYnkIUN16zsFPQhCV86fSX/RwhrkDMa7UgrZdNLpj8AcXDoOERwTSQpOP9N4jBZOsVQKKCW72iYr0mwDKTA0D3VvBXVnyoW7tjCRI24/5+zcxt9wn2URHBGQsmyOBuOt0OcJbqz4qR6nbg6HCS/q3iWB3KVb6U6ImcZJ6GSgszK0HQvohTEMwx+7zH2RvPGydQ9zmBTbGb1jIh13YmSM0diKKWuXpli6sOAtN7Q4nGuTvZJEVR9uz+CHMMSlseMhoXbe8H8VJZeU1eboORVC+ljIQrIAUDWhWOxrYVmHNcEmux8XDW7kGUOI4FXyRqlUFGK/oWe5PM2TTQ2UjeoW+aDa5YpPVFLr8CESfuVBXUQ9KOjyQmaYa84YTwexI9TWPJMJBGyNjHZXdGU0Y8LH+qW9HKzXehXUyaEAFMDVZWOmMSft6CxR9G4Tyj95U3tD5VBF1znw0QBbhiD+PEViVCNiQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 469, 'candidates_token_count': 8, 'total_token_count': 566, 'prompt_tokens_details': [{'modality': 1, 'token_count': 834}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 8}], 'thoughts_token_count': 89, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9370827674865723, 'model_name': 'gemini-2.5-pro'} id='run--11a00cb9-7496-4ae0-a9bb-694c3a89057b-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tox.ini'}, 'id': 'b093b94f-4821-4bc5-9d12-e8e62b3fe08c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 469, 'output_tokens': 8, 'total_tokens': 566, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 89}}
2025-12-23 17:57:22,376 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: cat tox.ini
2025-12-23 17:57:22,478 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:22,478 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

# Tox (https://tox.readthedocs.io/) is a tool for running tests in multiple
# virtualenvs. This configuration file helps to run the test suite on all
# supported Python versions. To use it, "python -m pip install tox" and
# then run "tox" from this directory.

[tox]
skipsdist = true
envlist =
    py3
    flake8
    docs
    isort >= 5.1.0

# Add environment to use the default python3 installation
[testenv:py3]
basepython = python3

[testenv]
usedevelop = true
# OBJC_DISABLE_INITIALIZE_FORK_SAFETY fixes hung tests for MacOS users. (#30806)
passenv = DJANGO_SETTINGS_MODULE PYTHONPATH HOME DISPLAY OBJC_DISABLE_INITIALIZE_FORK_SAFETY
setenv =
    PYTHONDONTWRITEBYTECODE=1
deps =
    py{3,36,37,38}: -rtests/requirements/py3.txt
    postgres: -rtests/requirements/postgres.txt
    mysql: -rtests/requirements/mysql.txt
    oracle: -rtests/requirements/oracle.txt
changedir = tests
commands =
    {envpython} runtests.py {posargs}

[testenv:flake8]
basepython = python3
usedevelop = false
deps = flake8
changedir = {toxinidir}
commands = flake8 .

[testenv:docs]
basepython = python3
usedevelop = false
whitelist_externals =
    make
deps =
    Sphinx
    pyenchant
    sphinxcontrib-spelling
changedir = docs
commands =
    make spelling

[testenv:isort]
basepython = python3
usedevelop = false
deps = isort
changedir = {toxinidir}
commands = isort --check-only --diff django tests scripts

[testenv:javascript]
usedevelop = false
deps =
changedir = {toxinidir}
whitelist_externals = npm
commands =
    npm install
    npm test

2025-12-23 17:57:24,822 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py forms.test_jsonfield"}'}, '__gemini_function_call_thought_signatures__': {'aea0019b-12cc-468b-8c95-eec1084d9f1a': 'CpIEAY89a1/gDAoImeGtNwBEIouLtsGcbOUAo5WQu1RPupc5cqZhupaA+cobbDffD8ubrvXame5VSoU846Wx/q5XSlmvbHynUmBS2QQJRL0z4IqDTmSC8r+1sYNEXD15Z6yK0WDcq5vNLFAAB3ROYMTGlbQYBjb1dtIdnkpN5jGqrDlrpjXPQitQ0+Wf2k0n+KVQ9KRW9FtQm3+sE0sdfxr7GF1MhuUMKg5hfiomIx72LPOjlVg2Dx0EbX4MG6fA4vRSFmcCjZ6C4VyCnMOHHjtzdQZ9loAFE1Wonbg7E3pzXQb0zzvCUkqxTKM+fw/VGU1eQDw61mhU5zpl5pRsL48+5P3fTZuVhJWRAhVk9amLF9yuGi6hTQtJfFKa86Y+63vnMUznOAYSt3vKoEoTmpKlbE3ddRBoaj3yyfTJgngBwYYkAwAI+qGImnUEx4a8VyyoleawK5E/cmNsvJuIWyZEuxGPM2bouMrXQv7uy4Q7m6ugihABRJX+p/ZaagmvzonbHNNFVyn6FYrAHkt+hjOAj8xCKURbjbZnjFOaHwPLIOIJijqaOqRqs8eQhiZ/xxm3o7Q6zwg5mBWN5V2L8e5+fxj7BVpmVGmNsLnkCDyBsO6eD/3vBbay4cAGKY5JJIY3bjAvr0P8th8xm9c+veqNG1gbLVFQJ/mc94dSdidr3p2FrZjkbAH+UQW2nvhVNIpwa4I='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 967, 'candidates_token_count': 17, 'total_token_count': 1134, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1421}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 17}], 'thoughts_token_count': 150, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7145784602445715, 'model_name': 'gemini-2.5-pro'} id='run--9f2d3062-f9be-4901-b40f-da06cafe2955-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py forms.test_jsonfield'}, 'id': 'aea0019b-12cc-468b-8c95-eec1084d9f1a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 967, 'output_tokens': 17, 'total_tokens': 1134, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 150}}
2025-12-23 17:57:24,825 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py forms.test_jsonfield
2025-12-23 17:57:26,216 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-23 17:57:26,216 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 32 processes
System check identified no issues (0 silenced).
........F....
======================================================================
FAIL: test_prepare_value_non_ascii (forms.test_jsonfield.JSONFieldTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/forms/test_jsonfield.py", line 40, in test_prepare_value_non_ascii
    self.assertEqual(field.prepare_value("ä¸­å›½"), '"ä¸­å›½"')
AssertionError: '"\\u4e2d\\u56fd"' != '"ä¸­å›½"'
- "\u4e2d\u56fd"
+ "ä¸­å›½"


----------------------------------------------------------------------
Ran 13 tests in 0.020s

FAILED (failures=1)

2025-12-23 17:57:29,674 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='I have successfully executed the test file `tests/forms/test_jsonfield.py`. Here is the output:\n\n```\nTesting against Django installed in \'/testbed/django\' with up to 32 processes\nSystem check identified no issues (0 silenced).\n........F....\n======================================================================\nFAIL: test_prepare_value_non_ascii (forms.test_jsonfield.JSONFieldTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/forms/test_jsonfield.py", line 40, in test_prepare_value_non_ascii\n    self.assertEqual(field.prepare_value("ä¸­å›½"), \'\\"ä¸­å›½\\"\')\nAssertionError: \'\\"\\\\\\\\u4e2d\\\\\\\\u56fd\\"\' != \'\\"ä¸­å›½\\"\'\n- \\"\\\\u4e2d\\\\u56fd\\"\n+ \\"ä¸­å›½\\"\n\n\n----------------------------------------------------------------------\nRan 13 tests in 0.020s\n\nFAILED (failures=1)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1184, 'candidates_token_count': 230, 'total_token_count': 1464, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1788}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 230}], 'thoughts_token_count': 50, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.029907906573751697, 'model_name': 'gemini-2.5-pro'} id='run--f2c7c205-c951-4582-bd79-0bd469157e39-0' usage_metadata={'input_tokens': 1184, 'output_tokens': 230, 'total_tokens': 1464, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 50}}
2025-12-23 17:57:53,994 - thread-125107859076800.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='FAIL: test_prepare_value_non_ascii (forms.test_jsonfield.JSONFieldTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/forms/test_jsonfield.py", line 40, in test_prepare_value_non_ascii\n    self.assertEqual(field.prepare_value("ä¸­å›½"), \'"ä¸­å›½"\')\nAssertionError: \'\\"\\\\u4e2d\\\\u56fd"\' != \'"ä¸­å›½"\'\n- "\\u4e2d\\u56fd"\n+ "ä¸­å›½"\n\n\n----------------------------------------------------------------------\nRan 13 tests in 0.020s\n\nFAILED (failures=1)' reproduced_bug_commands=['python tests/runtests.py forms.test_jsonfield']
2025-12-23 17:57:53,996 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-23 17:57:53,996 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-23 17:57:53,996 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py forms.test_jsonfield
2025-12-23 17:57:54,705 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-23 17:57:54,705 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 32 processes
System check identified no issues (0 silenced).
........F....
======================================================================
FAIL: test_prepare_value_non_ascii (forms.test_jsonfield.JSONFieldTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/forms/test_jsonfield.py", line 40, in test_prepare_value_non_ascii
    self.assertEqual(field.prepare_value("ä¸­å›½"), '"ä¸­å›½"')
AssertionError: '"\\u4e2d\\u56fd"' != '"ä¸­å›½"'
- "\u4e2d\u56fd"
+ "ä¸­å›½"


----------------------------------------------------------------------
Ran 13 tests in 0.018s

FAILED (failures=1)

2025-12-23 17:57:54,705 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-23 17:57:54,705 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-23 17:57:54,710 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-23 17:57:54,710 - thread-125107859076800.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-23 17:57:54,710 - thread-125107859076800.app.docker.base_container - INFO - Creating directory django/forms in the container
2025-12-23 17:57:54,711 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: mkdir -p django/forms
2025-12-23 17:57:54,812 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:54,812 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:57:54,812 - thread-125107859076800.app.docker.base_container - INFO - Creating directory docs/ref/forms in the container
2025-12-23 17:57:54,812 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: mkdir -p docs/ref/forms
2025-12-23 17:57:54,913 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:54,914 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:


2025-12-23 17:57:54,914 - thread-125107859076800.app.docker.base_container - INFO - Updating django/forms/fields.py in the container
2025-12-23 17:57:54,915 - thread-125107859076800.app.docker.base_container - INFO - Updating docs/ref/forms/fields.txt in the container
2025-12-23 17:57:54,972 - thread-125107859076800.app.docker.base_container - INFO - Files updated successfully
2025-12-23 17:57:54,972 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-23 17:57:54,972 - thread-125107859076800.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py forms.test_jsonfield
2025-12-23 17:57:55,761 - thread-125107859076800.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-23 17:57:55,762 - thread-125107859076800.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 32 processes
System check identified no issues (0 silenced).
.............
----------------------------------------------------------------------
Ran 13 tests in 0.019s

OK

2025-12-23 17:57:55,762 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-23 17:57:55,883 - thread-125107859076800.app.lang_graph.nodes.dual_version_validation_node - INFO - Validation PASSED: Test fails on old, passes on new
2025-12-23 17:57:55,884 - thread-125107859076800.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-12-23 17:57:55,884 - thread-125107859076800.app.docker.base_container - INFO - Closing persistent shell...
2025-12-23 17:57:55,985 - thread-125107859076800.app.docker.base_container - INFO - Cleaning up container and temporary files
