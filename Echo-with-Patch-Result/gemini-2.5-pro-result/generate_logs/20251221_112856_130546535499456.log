2025-12-21 11:28:56,676 - thread-130546535499456.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmppvmcsuwj/astropy
2025-12-21 11:28:56,677 - thread-130546535499456.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-12-21 11:28:56,677 - thread-130546535499456.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-13579:v1
2025-12-21 11:29:20,069 - thread-130546535499456.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_f5501d387c
2025-12-21 11:29:20,080 - thread-130546535499456.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_f5501d387c
2025-12-21 11:29:20,657 - thread-130546535499456.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-12-21 11:29:21,570 - thread-130546535499456.app.docker.base_container - INFO - Persistent shell is ready
2025-12-21 11:29:21,570 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-12-21 11:29:21,807 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:29:21,807 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:29:21,807 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-12-21 11:29:22,037 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:29:22,037 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:29:22,037 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-12-21 11:31:22,877 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:31:22,878 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
[A(testbed) root@ucl-research:/testbed# python -m pip install -e .[test] --verbos[Ke

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command pip subprocess to install build dependencies
  Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
  Collecting setuptools==68.0.0
    Obtaining dependency information for setuptools==68.0.0 from https://files.pythonhosted.org/packages/c7/42/be1c7bbdd83e1bfb160c94b9cafd8e25efc7400346cf7ccdbdb452c467fa/setuptools-68.0.0-py3-none-any.whl.metadata
    Using cached setuptools-68.0.0-py3-none-any.whl.metadata (6.4 kB)
  Collecting setuptools_scm>=6.2
    Obtaining dependency information for setuptools_scm>=6.2 from https://files.pythonhosted.org/packages/3d/ea/ac2bf868899d0d2e82ef72d350d97a846110c709bacf2d968431576ca915/setuptools_scm-9.2.2-py3-none-any.whl.metadata
    Downloading setuptools_scm-9.2.2-py3-none-any.whl.metadata (7.7 kB)
  Collecting wheel
    Obtaining dependency information for wheel from https://files.pythonhosted.org/packages/0b/2c/87f3254fd8ffd29e4c02732eee68a83a1d3c346ae39bc6822dcbcb697f2b/wheel-0.45.1-py3-none-any.whl.metadata
    Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
  Collecting cython==0.29.30
    Obtaining dependency information for cython==0.29.30 from https://files.pythonhosted.org/packages/a7/c6/3af0df983ba8500831fdae19a515be6e532da7683ab98e031d803e6a8d03/Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata
    Using cached Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata (2.8 kB)
  Collecting oldest-supported-numpy
    Obtaining dependency information for oldest-supported-numpy from https://files.pythonhosted.org/packages/dc/5c/e3c84cfdd488701aa074b22cf5bd227fb15d26e1d55a66d9088c39afa123/oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata
    Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata (9.8 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/88/ff/5a7cd8c9698628b3c04215ee3a96c69865477f451b4f096682e78d085bfc/extension_helpers-1.3.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/8e/b1/73ce2924fe46281faf31567e96fb9eee4eca02fd1cb852562bb2971e9df1/extension_helpers-1.3.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f8/fb/f9a88ccea5377736d5d1e53c8a6c70207178cdc1ebbf305a50a610cbb751/extension_helpers-1.4.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/24/51/d03359b683ed288b34d713dea97d2aee87a9bd866af1652554d9f643b47d/extension_helpers-1.4.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
  Collecting extension-helpers
    Obtaining dependency information for extension-helpers from https://files.pythonhosted.org/packages/b3/0e/22599eac9e50f4274e78e47cef7e760d7a1bb2f0d0fdfb0bb5b0d2da263a/extension_helpers-1.2.0-py3-none-any.whl.metadata
    Using cached extension_helpers-1.2.0-py3-none-any.whl.metadata (2.2 kB)
  Collecting packaging>=20 (from setuptools_scm>=6.2)
    Obtaining dependency information for packaging>=20 from https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl.metadata
    Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
  Collecting tomli>=1 (from setuptools_scm>=6.2)
    Obtaining dependency information for tomli>=1 from https://files.pythonhosted.org/packages/77/b8/0135fadc89e73be292b473cb820b4f5a08197779206b33191e801feeae40/tomli-2.3.0-py3-none-any.whl.metadata
    Downloading tomli-2.3.0-py3-none-any.whl.metadata (10 kB)
  Collecting typing-extensions (from setuptools_scm>=6.2)
    Obtaining dependency information for typing-extensions from https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
    Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/54/a4/f8188c4f3e07f7737683588210c073478abcb542048cf4ab6fedad0b458a/numpy-2.1.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/59/5f/9003bb3e632f2b58f5e3a3378902dcc73c5518070736c6740fe52454e8e1/numpy-2.1.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/4b/d1/8a730ea07f4a37d94f9172f4ce1d81064b7a64766b460378be278952de75/numpy-2.1.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/25/ca/1166b75c21abd1da445b97bf1fa2f14f423c6cfb4fc7c4ef31dccf9f6a94/numpy-2.1.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/47/1b/1d565e0f6e156e1522ab564176b8b29d71e13d8caf003a08768df3d5cec5/numpy-2.2.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f2/a5/fdbf6a7871703df6160b5cf3dd774074b086d278172285c52c2758b76305/numpy-2.2.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/ec/d0/c12ddfd3a02274be06ffc71f3efc6d0e457b0409c4481596881e748cb264/numpy-2.2.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/fb/90/8956572f5c4ae52201fdec7ba2044b2c882832dcec7d5d0922c9e9acf2de/numpy-2.2.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/e1/78/31103410a57bc2c2b93a3597340a8119588571f6a4539067546cb9a0bfac/numpy-2.2.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/dc/b2/ce4b867d8cd9c0ee84938ae1e6a6f7926ebf928c9090d036fc3c6a04f946/numpy-2.2.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/f3/db/8e12381333aea300890829a0a36bfa738cac95475d88982d538725143fd9/numpy-2.3.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/2e/19/d7c972dfe90a353dbd3efbbe1d14a5951de80c99c9dc1b93cd998d51dc0f/numpy-2.3.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/37/7d/3fec4199c5ffb892bed55cff901e4f39a58c81df9c44c280499e92cad264/numpy-2.3.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/b5/f4/098d2270d52b41f1bd7db9fc288aaa0400cb48c2a3e2af6fa365d9720947/numpy-2.3.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/76/65/21b3bc86aac7b8f2862db1e808f1ea22b028e30a225a34a5ede9bf8678f2/numpy-2.3.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/12/02/7111f298e24a44d6fa4b75b47d93eccf444e5afbcee5b04aac760ee48935/numpy-2.4.0rc1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/a4/7a/6a3d14e205d292b738db449d0de649b373a59edb0d0b4493821d0a3e8718/numpy-2.4.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
  Collecting numpy==1.19.3 (from oldest-supported-numpy)
    Obtaining dependency information for numpy==1.19.3 from https://files.pythonhosted.org/packages/c3/8d/2ae53d96a92a66b8daa3dfb2dd6cf4bfcb8e3d4148bdd713c8fc7de83141/numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata
    Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata (2.0 kB)
  Using cached setuptools-68.0.0-py3-none-any.whl (804 kB)
  Using cached Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (2.0 MB)
  Downloading setuptools_scm-9.2.2-py3-none-any.whl (62 kB)
  Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
  Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl (4.9 kB)
  Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl (14.9 MB)
  Using cached extension_helpers-1.2.0-py3-none-any.whl (23 kB)
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
  Downloading tomli-2.3.0-py3-none-any.whl (14 kB)
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
  Installing collected packages: wheel, typing-extensions, tomli, setuptools, packaging, numpy, cython, setuptools_scm, oldest-supported-numpy, extension-helpers
    Creating /tmp/pip-build-env-zlf3w5t8/overlay/bin
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/wheel to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/f2py to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/f2py3 to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/f2py3.9 to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/cygdb to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/cython to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/cythonize to 755
    changing mode of /tmp/pip-build-env-zlf3w5t8/overlay/bin/setuptools-scm to 755
  Successfully installed cython-0.29.30 extension-helpers-1.2.0 numpy-1.19.3 oldest-supported-numpy-2023.12.21 packaging-25.0 setuptools-68.0.0 setuptools_scm-9.2.2 tomli-2.3.0 typing-extensions-4.15.0 wheel-0.45.1
  WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  Installing build dependencies ... [?25l[?25hdone
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable ... [?25l[?25hdone
  Running command Getting requirements to build editable
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running egg_info
  writing astropy.egg-info/PKG-INFO
  writing dependency_links to astropy.egg-info/dependency_links.txt
  writing entry points to astropy.egg-info/entry_points.txt
  writing requirements to astropy.egg-info/requires.txt
  writing top-level names to astropy.egg-info/top_level.txt
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file 'astropy.egg-info/SOURCES.txt'
  Getting requirements to build editable ... [?25l[?25hdone
  Running command Preparing editable metadata (pyproject.toml)
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running dist_info
  creating /tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info
  writing /tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-modern-metadata-p1dlkn25/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-p1dlkn25/astropy-5.2.dev362+g0df94ff70.d20251221.dist-info'
  Preparing editable metadata (pyproject.toml) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.18 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (6.0.1)
Requirement already satisfied: packaging>=19.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (23.1)
Requirement already satisfied: pytest>=7.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (7.4.0)
Requirement already satisfied: pytest-doctestplus>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (1.0.0)
Requirement already satisfied: pytest-astropy-header>=0.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (0.2.2)
Requirement already satisfied: pytest-astropy>=0.10 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (0.10.0)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev362+g0df94ff70.d20251221) (3.3.1)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev362+g0df94ff70.d20251221) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev362+g0df94ff70.d20251221) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev362+g0df94ff70.d20251221) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev362+g0df94ff70.d20251221) (2.0.1)
Requirement already satisfied: pytest-remotedata>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (0.4.0)
Requirement already satisfied: pytest-openfiles>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (0.5.0)
Requirement already satisfied: pytest-arraydiff>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (0.5.0)
Requirement already satisfied: pytest-filter-subpackage>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (0.1.2)
Requirement already satisfied: pytest-cov>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (4.1.0)
Requirement already satisfied: pytest-mock>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (3.11.1)
Requirement already satisfied: attrs>=19.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (23.1.0)
Requirement already satisfied: hypothesis>=5.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (6.82.6)
Requirement already satisfied: setuptools>=30.3.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-doctestplus>=0.12->astropy==5.2.dev362+g0df94ff70.d20251221) (68.0.0)
Requirement already satisfied: execnet>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-xdist->astropy==5.2.dev362+g0df94ff70.d20251221) (2.0.2)
Requirement already satisfied: sortedcontainers<3.0.0,>=2.1.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis>=5.1->pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (2.4.0)
Requirement already satisfied: coverage>=5.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from coverage[toml]>=5.2.1->pytest-cov>=2.3.1->pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (7.6.2)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-openfiles>=0.3.1->pytest-astropy>=0.10->astropy==5.2.dev362+g0df94ff70.d20251221) (5.9.5)
Building wheels for collected packages: astropy
  Running command Building editable for astropy (pyproject.toml)
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running editable_wheel
  creating /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info
  writing /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy-5.2.dev362+g0df94ff70.d20251221.dist-info'
  creating /tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/WHEEL
  running build_py
  running build_ext
  skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
  skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
  skipping 'astropy/timeseries/periodograms/bls/_impl.c' Cython extension (up-to-date)
  skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
  skipping './astropy/stats/_stats.c' Cython extension (up-to-date)
  skipping './astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
  skipping './astropy/cosmology/flrw/scalar_inv_efuncs.c' Cython extension (up-to-date)
  skipping './astropy/io/fits/_utils.c' Cython extension (up-to-date)
  building 'astropy.table._np_utils' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy
  creating /tmp/tmpf7upjipw.build-temp/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_np_utils.c -o /tmp/tmpf7upjipw.build-temp/astropy/table/_np_utils.o
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_np_utils.c:698:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmpil_mqr08.build-lib/astropy
  creating /tmp/tmpil_mqr08.build-lib/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/table/_np_utils.o -o /tmp/tmpil_mqr08.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._column_mixins' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_column_mixins.c -o /tmp/tmpf7upjipw.build-temp/astropy/table/_column_mixins.o
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:696:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:21,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:696:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/__multiarray_api.h:1463:1: warning: â€˜_import_arrayâ€™ defined but not used [-Wunused-function]
   1463 | _import_array(void)
        | ^~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/table/_column_mixins.o -o /tmp/tmpil_mqr08.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils._compiler' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/utils
  creating /tmp/tmpf7upjipw.build-temp/astropy/utils/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/src/compiler.c -o /tmp/tmpf7upjipw.build-temp/astropy/utils/src/compiler.o
  creating /tmp/tmpil_mqr08.build-lib/astropy/utils
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/utils/src/compiler.o -o /tmp/tmpil_mqr08.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._fast_sigma_clip' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/stats
  creating /tmp/tmpf7upjipw.build-temp/astropy/stats/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/compute_bounds.c -o /tmp/tmpf7upjipw.build-temp/astropy/stats/src/compute_bounds.o
  astropy/stats/src/compute_bounds.c: In function â€˜compute_sigma_clipped_boundsâ€™:
  astropy/stats/src/compute_bounds.c:53:24: warning: â€˜cenâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     53 |     *upper_bound = cen + sigma_upper * std;
        |                    ~~~~^~~~~~~~~~~~~~~~~~~
  astropy/stats/src/compute_bounds.c:38:45: warning: â€˜medianâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     38 |         mad_buffer[i] = fabs(data_buffer[i] - median);
        |                              ~~~~~~~~~~~~~~~^~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/fast_sigma_clip.c -o /tmp/tmpf7upjipw.build-temp/astropy/stats/src/fast_sigma_clip.o
  astropy/stats/src/fast_sigma_clip.c: In function â€˜PyInit__fast_sigma_clipâ€™:
  astropy/stats/src/fast_sigma_clip.c:44:48: warning: initialization of â€˜void (*)(char **, const npy_intp *, const npy_intp *, void *)â€™ {aka â€˜void (*)(char **, const long int *, const long int *, void *)â€™} from incompatible pointer type â€˜void (*)(char **, npy_intp *, npy_intp *, void *)â€™ {aka â€˜void (*)(char **, long int *, long int *, void *)â€™} [-Wincompatible-pointer-types]
     44 |     static PyUFuncGenericFunction funcs[1] = { &_sigma_clip_fast };
        |                                                ^
  astropy/stats/src/fast_sigma_clip.c:44:48: note: (near initialization for â€˜funcs[0]â€™)
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/pytime.h:6,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:81,
                   from astropy/stats/src/fast_sigma_clip.c:3:
  /opt/miniconda3/envs/testbed/include/python3.9/object.h:496:8: warning: â€˜dâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    496 |     if (op != NULL) {
        |        ^
  astropy/stats/src/fast_sigma_clip.c:30:19: note: â€˜dâ€™ was declared here
     30 |     PyObject *m, *d;
        |                   ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/wirth_select.c -o /tmp/tmpf7upjipw.build-temp/astropy/stats/src/wirth_select.o
  creating /tmp/tmpil_mqr08.build-lib/astropy/stats
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/stats/src/compute_bounds.o /tmp/tmpf7upjipw.build-temp/astropy/stats/src/fast_sigma_clip.o /tmp/tmpf7upjipw.build-temp/astropy/stats/src/wirth_select.o -o /tmp/tmpil_mqr08.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so
  building 'astropy.convolution._convolve' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/convolution
  creating /tmp/tmpf7upjipw.build-temp/astropy/convolution/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/src/convolve.c -o /tmp/tmpf7upjipw.build-temp/astropy/convolution/src/convolve.o -UNDEBUG -fPIC
  creating /tmp/tmpil_mqr08.build-lib/astropy/convolution
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/convolution/src/convolve.o -o /tmp/tmpil_mqr08.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so
  building 'astropy.time._parse_times' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/time
  creating /tmp/tmpf7upjipw.build-temp/astropy/time/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/time/src/parse_times.c -o /tmp/tmpf7upjipw.build-temp/astropy/time/src/parse_times.o
  creating /tmp/tmpil_mqr08.build-lib/astropy/time
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/time/src/parse_times.o -o /tmp/tmpil_mqr08.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so
  building 'astropy.wcs._wcs' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/wcs
  creating /tmp/tmpf7upjipw.build-temp/astropy/wcs/src
  creating /tmp/tmpf7upjipw.build-temp/cextern
  creating /tmp/tmpf7upjipw.build-temp/cextern/wcslib
  creating /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C
  creating /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/astropy_wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs_api.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/astropy_wcs_api.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/distortion.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/distortion_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/docstrings.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/docstrings.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pipeline.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/pipeline.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pyutil.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/pyutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/src/pyutil.c:9:
  In function â€˜strncpyâ€™,
      inlined from â€˜set_pscardsâ€™ at astropy/wcs/src/pyutil.c:807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 72 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/sip.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/sip_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/str_list_proxy.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/str_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/unit_list_proxy.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/unit_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/util.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/util.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_auxprm_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_celprm_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:167:22: warning: initialization of â€˜PyCelprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    167 |     PyCelprm* copy = PyCelprm_new(&PyCelprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_set_refâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_celprm_wrap.c:348:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    348 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_prjprm_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:149:22: warning: initialization of â€˜PyPrjprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    149 |     PyPrjprm* copy = PyPrjprm_new(&PyPrjprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:517:14: warning: assignment to â€˜PyObject *â€™ {aka â€˜struct _object *â€™} from incompatible pointer type â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} [-Wincompatible-pointer-types]
    517 |     pv_array = (PyArrayObject*) PyArray_SimpleNew(1, &size, NPY_DOUBLE);
        |              ^
  astropy/wcs/src/wcslib_prjprm_wrap.c:519:33: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    519 |     pv = (double*) PyArray_DATA(pv_array);
        |                                 ^~~~~~~~
        |                                 |
        |                                 PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c:583:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    583 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:615:15: warning: unused variable â€˜valueâ€™ [-Wunused-variable]
    615 |     PyObject* value = NULL;
        |               ^~~~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:48: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                ^~~~~~~~~~~
        |                                                |
        |                                                PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:24: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                        ^~~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:62: warning: passing argument 1 of â€˜PyArray_DESCRâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                              ^~~~~~~~~~~
        |                                                              |
        |                                                              PyObject * {aka struct _object *}
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:44: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                                            ^~~
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1517:30: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1517 | PyArray_DESCR(PyArrayObject *arr)
        |               ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_wâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:780:32: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    780 |     w = (double*) PyArray_DATA(w_array);
        |                                ^~~~~~~
        |                                |
        |                                PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_tabprm_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wrap.c: In function â€˜PyWcsprm_copyâ€™:
  astropy/wcs/src/wcslib_wrap.c:634:24: warning: unused variable â€˜wtb0â€™ [-Wunused-variable]
    634 |   struct wtbarr *wtb, *wtb0;
        |                        ^~~~
  astropy/wcs/src/wcslib_wrap.c:634:18: warning: unused variable â€˜wtbâ€™ [-Wunused-variable]
    634 |   struct wtbarr *wtb, *wtb0;
        |                  ^~~
  astropy/wcs/src/wcslib_wrap.c:633:38: warning: unused variable â€˜ndimâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                      ^~~~
  astropy/wcs/src/wcslib_wrap.c:633:35: warning: unused variable â€˜jâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                   ^
  astropy/wcs/src/wcslib_wrap.c:633:32: warning: unused variable â€˜iâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                ^
  astropy/wcs/src/wcslib_wrap.c:633:25: warning: unused variable â€˜nelemâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                         ^~~~~
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜PyWcsprm_sptrâ€™ at astropy/wcs/src/wcslib_wrap.c:1757:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 9 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wtbarr_wrap.c -o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: warning: initialization of â€˜int (*)(PyObject *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(struct _object *, int (*)(struct _object *, void *), void *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(PyWtbarr *, int (*)(struct _object *, void *), void *)â€™} [-Wincompatible-pointer-types]
    208 |   PyWtbarr_traverse,            /* tp_traverse */
        |   ^~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: note: (near initialization for â€˜PyWtbarrType.tp_traverseâ€™)
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: warning: initialization of â€˜int (*)(PyObject *)â€™ {aka â€˜int (*)(struct _object *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *)â€™ [-Wincompatible-pointer-types]
    209 |   PyWtbarr_clear,               /* tp_clear */
        |   ^~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: note: (near initialization for â€˜PyWtbarrType.tp_clearâ€™)
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/cel.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/cel.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/dis.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/dis.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsbth.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcsbth.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcspih.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcspih.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsulex.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcsulex.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsutrn.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcsutrn.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/lin.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/lin.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/log.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/log.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/prj.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/prj.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spc.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/spc.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/sph.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/sph.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spx.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/spx.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/tab.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/tab.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcs.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcserr.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcserr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsfix.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsfix.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcshdr.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcshdr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsprintf.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsprintf.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsunits.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsunits.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsutil.c -o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  creating /tmp/tmpil_mqr08.build-lib/astropy/wcs
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/astropy_wcs.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/astropy_wcs_api.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/distortion.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/distortion_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/docstrings.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/pipeline.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/pyutil.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/sip.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/sip_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/str_list_proxy.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/unit_list_proxy.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/util.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_wrap.o /tmp/tmpf7upjipw.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/cel.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/dis.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcsbth.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcspih.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcsulex.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/flexed/wcsutrn.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/lin.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/log.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/prj.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/spc.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/sph.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/spx.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/tab.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcs.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcserr.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsfix.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcshdr.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsprintf.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsunits.o /tmp/tmpf7upjipw.build-temp/cextern/wcslib/C/wcsutil.o -o /tmp/tmpil_mqr08.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils.xml._iterparser' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/utils/xml
  creating /tmp/tmpf7upjipw.build-temp/astropy/utils/xml/src
  creating /tmp/tmpf7upjipw.build-temp/cextern/expat
  creating /tmp/tmpf7upjipw.build-temp/cextern/expat/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/xml/src/iterparse.c -o /tmp/tmpf7upjipw.build-temp/astropy/utils/xml/src/iterparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlparse.c -o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmlparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlrole.c -o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmlrole.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok.c -o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmltok.o
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingNSâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1657:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1646:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok_impl.c -o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmltok_impl.o
  creating /tmp/tmpil_mqr08.build-lib/astropy/utils/xml
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/utils/xml/src/iterparse.o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmlparse.o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmlrole.o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmltok.o /tmp/tmpf7upjipw.build-temp/cextern/expat/lib/xmltok_impl.o -o /tmp/tmpil_mqr08.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -Wl,--version-script=astropy/utils/xml/src/iterparse.map
  building 'astropy.timeseries.periodograms.bls._impl' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/timeseries
  creating /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms
  creating /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/_impl.c -o /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/bls/_impl.o
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/timeseries/periodograms/bls/_impl.c:698:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/bls.c -o /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/bls/bls.o
  astropy/timeseries/periodograms/bls/bls.c: In function â€˜run_blsâ€™:
  astropy/timeseries/periodograms/bls/bls.c:92: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
     92 | #pragma omp parallel
        |
  astropy/timeseries/periodograms/bls/bls.c:116: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    116 |     #pragma omp parallel for reduction(+:sum_y), reduction(+:sum_ivar)
        |
  astropy/timeseries/periodograms/bls/bls.c:125: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    125 |     #pragma omp parallel for
        |
  creating /tmp/tmpil_mqr08.build-lib/astropy/timeseries
  creating /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms
  creating /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/bls/_impl.o /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/bls/bls.o -o /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.votable.tablewriter' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/io
  creating /tmp/tmpf7upjipw.build-temp/astropy/io/votable
  creating /tmp/tmpf7upjipw.build-temp/astropy/io/votable/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/votable/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/votable/src/tablewriter.c -o /tmp/tmpf7upjipw.build-temp/astropy/io/votable/src/tablewriter.o
  astropy/io/votable/src/tablewriter.c: In function â€˜write_tabledataâ€™:
  astropy/io/votable/src/tablewriter.c:270:30: warning: assignment discards â€˜constâ€™ qualifier from pointer target type [-Wdiscarded-qualifiers]
    270 |                 if ((str_tmp = PyUnicode_AsUTF8AndSize(str_val, &str_len)) == NULL) {
        |                              ^
  creating /tmp/tmpil_mqr08.build-lib/astropy/io
  creating /tmp/tmpil_mqr08.build-lib/astropy/io/votable
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/io/votable/src/tablewriter.o -o /tmp/tmpil_mqr08.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits.compression' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/io/fits
  creating /tmp/tmpf7upjipw.build-temp/astropy/io/fits/src
  creating /tmp/tmpf7upjipw.build-temp/cextern/cfitsio
  creating /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib
  creating /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/src/compressionmodule.c -o /tmp/tmpf7upjipw.build-temp/astropy/io/fits/src/compressionmodule.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  astropy/io/fits/src/compressionmodule.c: In function â€˜compression_compress_hduâ€™:
  astropy/io/fits/src/compressionmodule.c:1042:16: warning: comparison of integer expressions of different signedness: â€˜npy_intpâ€™ {aka â€˜long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1042 |     if (znaxis < outbufsize) {
        |                ^
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:446:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:446:26: note: directive argument in the range [1, 2147483647]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:450:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 69 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:453:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:453:26: note: directive argument in the range [1, 2147483647]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:457:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 9 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:469:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:469:26: note: directive argument in the range [1, 2147483647]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:474:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:474:26: note: directive argument in the range [1, 2147483647]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:479:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:479:26: note: directive argument in the range [1, 2147483647]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜configure_compressionâ€™ at astropy/io/fits/src/compressionmodule.c:600:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 11 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜configure_compressionâ€™:
  astropy/io/fits/src/compressionmodule.c:643:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:643:30: note: directive argument in the range [1, 2147483647]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:654:35: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 5 [-Wformat-truncation=]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                                   ^~
  astropy/io/fits/src/compressionmodule.c:654:30: note: directive argument in the range [1, 2147483647]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                              ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 6 and 15 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜init_output_bufferâ€™:
  astropy/io/fits/src/compressionmodule.c:776:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:776:30: note: directive argument in the range [1, 2147483647]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/buffers.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/buffers.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/cfileio.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/cfileio.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/cfileio.c:7:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffoptpltâ€™ at cextern/cfitsio/lib/cfileio.c:7788:7:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 30 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1711:13,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1693:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 5 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffomemâ€™:
  cextern/cfitsio/lib/cfileio.c:339:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    339 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffopenâ€™:
  cextern/cfitsio/lib/cfileio.c:971:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    971 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/checksum.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/checksum.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrfile.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrfile.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrmem.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/drvrmem.c: In function â€˜mem_truncateâ€™:
  cextern/cfitsio/lib/drvrmem.c:273:23: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    273 |         if ( filesize > *(memTable[handle].memsizeptr) )
        |                       ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrnet.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrnet.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrsmem.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrsmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/editcol.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/editcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/editcol.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2849:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 8 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2809:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 4 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2844:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 4 and 5 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2851:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/editcol.c: In function â€˜ffkshfâ€™:
  cextern/cfitsio/lib/editcol.c:2850:24: note: length computed here
   2850 |                   i1 = strlen(newkey);
        |                        ^~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/edithdu.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/edithdu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_f.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/eval_f.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_l.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/eval_l.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_y.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/eval_y.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hcompress.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/fits_hcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hdecompress.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/fits_hdecompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fitscore.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/fitscore.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkkyâ€™:
  cextern/cfitsio/lib/fitscore.c:1118:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1118 |             if (strlen(cptr) > maxlen) maxlen = strlen(cptr); /* find longest token */
        |                              ^
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkeyâ€™:
  cextern/cfitsio/lib/fitscore.c:1295:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1295 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/fitscore.c:37:
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1115:8:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1159:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffbinit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:5098:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   5098 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffbinit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffainit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:4901:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                                    ^~
   4902 |             name, (long) tbcoln);
        |             ~~~~
  cextern/cfitsio/lib/fitscore.c:4901:42: note: using the range [-9223372036854775808, 9223372036854775807] for directive argument
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 45 and 138 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4892:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4892 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4884:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4884 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜fftheapâ€™:
  cextern/cfitsio/lib/fitscore.c:6083:75: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   6083 |                 "Descriptor in row %ld, column %d has invalid heap address",
        |                                                                           ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 55 and 82 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffcmphâ€™:
  cextern/cfitsio/lib/fitscore.c:6221:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   6221 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffgcprllâ€™:
  cextern/cfitsio/lib/fitscore.c:5959:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   5959 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:5761:76: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   5761 |         "First element to write is too large: %ld; max allowed value is %ld",
        |                                                                            ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 63 and 101 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcol.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolb.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcold.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcole.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoli.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolj.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolk.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoll.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcols.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getcols.c:9:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:442:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:423:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:384:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:365:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:587:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolsb.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolui.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluj.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getcoluj.c: In function â€˜fffi8u4â€™:
  cextern/cfitsio/lib/getcoluj.c:1331:36: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1331 |                 else if (input[ii] > ULONG_MAX)
        |                                    ^
  cextern/cfitsio/lib/getcoluj.c:1414:40: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1414 |                     else if (input[ii] > ULONG_MAX)
        |                                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluk.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getkey.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgskyâ€™:
  cextern/cfitsio/lib/getkey.c:1080:23: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1080 |         if (firstchar <= len)
        |                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffgcntâ€™ at cextern/cfitsio/lib/getkey.c:1134:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 10 bytes from a string of length 11 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgphd.part.0â€™:
  cextern/cfitsio/lib/getkey.c:2855:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2855 |             "First keyword of the extension is not XTENSION: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2847:53: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 49 [-Wformat-truncation=]
   2847 |                    "This is not an IMAGE extension: %s", value);
        |                                                     ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 33 and 103 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2821:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 40 [-Wformat-truncation=]
   2821 |                    "First keyword of the file is not SIMPLE: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 42 and 116 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2930:48: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2930 |             "Illegal value for BITPIX keyword: %s", value);
        |                                                ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2921:57: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 38 [-Wformat-truncation=]
   2921 |             "Value of BITPIX keyword is not an integer: %s", value);
        |                                                         ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 44 and 114 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2913:61: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 34 [-Wformat-truncation=]
   2913 |             "Second keyword of the extension is not BITPIX: %s", name);
        |                                                             ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3021:70: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size between 19 and 28 [-Wformat-truncation=]
   3021 |               "Name of keyword no. %d contains illegal character(s): %s",
        |                                                                      ^~
   3022 |               nextkey, name);
        |                        ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 54 and 137 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3118:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3118 |                 "Error reading EXTEND keyword value as a logical: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3101:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3101 |                 "Error reading GCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3088:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3088 |                 "Error reading PCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3075:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3075 |                 "Error reading BLANK keyword value as an integer: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3058:65: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 34 [-Wformat-truncation=]
   3058 |                 "Error reading BZERO keyword value as a double: %s", value);
        |                                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 118 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3041:66: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 33 [-Wformat-truncation=]
   3041 |                 "Error reading BSCALE keyword value as a double: %s", value);
        |                                                                  ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 119 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbâ€™:
  cextern/cfitsio/lib/getkey.c:2282:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2282 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2273:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2273 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbllâ€™:
  cextern/cfitsio/lib/getkey.c:2425:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2425 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2416:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2416 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnâ€™:
  cextern/cfitsio/lib/getkey.c:2570:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2570 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2561:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2561 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnllâ€™:
  cextern/cfitsio/lib/getkey.c:2693:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2693 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2684:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2684 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/group.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/group.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/group.c: In function â€˜ffgmopâ€™:
  cextern/cfitsio/lib/group.c:2290:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 39 [-Wformat-truncation=]
   2290 |                   "Cannot open member HDU file with URI type %s (ffgmop)",
        |                                                              ^~
   2291 |                           uri);
        |                           ~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/group.c:17:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 52 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/grparser.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/grparser.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/histo.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/histo.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/imcompress.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/imcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/imcompress.c: In function â€˜imcomp_decompress_tileâ€™:
  cextern/cfitsio/lib/imcompress.c:6072:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6072 |             if (tilebytesize == 4 * tilelen) {  /* float pixels */
        |                              ^~
  cextern/cfitsio/lib/imcompress.c:6103:37: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6103 |             } else if (tilebytesize == 8 * tilelen) { /* double pixels */
        |                                     ^~
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_compress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:8517:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} [-Wsign-compare]
   8517 |                     if (dlen < vlamemlen) {
        |                              ^
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_uncompress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:9258:39: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   9258 |                         if (cvlalen   == vlamemlen ) {
        |                                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/imcompress.c:3:
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8170:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8174:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8178:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8803:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8811:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜imcomp_get_compressed_image_parâ€™ at cextern/cfitsio/lib/imcompress.c:5271:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 11 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8671:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8544:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/iraffits.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/iraffits.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:576:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcomâ€™ at cextern/cfitsio/lib/iraffits.c:2088:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 2 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1930:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1992:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1908:16: note: length computed here
   1908 |     lkeyword = strlen (keyword);
        |                ^~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2009:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2001:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2020:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying between 0 and 49 bytes from a string of length 49 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputsâ€™ at cextern/cfitsio/lib/iraffits.c:1875:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ specified bound depends on the length of the source argument [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputsâ€™:
  cextern/cfitsio/lib/iraffits.c:1869:13: note: length computed here
   1869 |     lcval = strlen (cval);
        |             ^~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:624:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:864:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:853:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:823:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:811:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:880:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/modkey.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/modkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/modkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffiklsâ€™ at cextern/cfitsio/lib/modkey.c:1282:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffmklsâ€™ at cextern/cfitsio/lib/modkey.c:783:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:567:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:562:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/pliocomp.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/pliocomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcol.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolb.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcold.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcole.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoli.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolj.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolk.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoll.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcols.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolsb.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolu.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolui.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluj.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluk.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putkey.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/putkey.c: In function â€˜ffprecâ€™:
  cextern/cfitsio/lib/putkey.c:326:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    326 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/putkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffpklsâ€™ at cextern/cfitsio/lib/putkey.c:483:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/quantize.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/quantize.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/region.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/region.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/region.c:988:1: warning: "/*" within comment [-Wcomment]
    988 | /*---------------------------------------------------------------------------*/
        |
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/ricecomp.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/ricecomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/scalnull.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/scalnull.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/simplerng.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/simplerng.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/swapproc.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/swapproc.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/swapproc.c: In function â€˜ffswap2â€™:
  cextern/cfitsio/lib/swapproc.c:87:24: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
     87 |     for (ii = peel; ii < (nvals - peel - (nvals - peel) % 8); ii+=8) {
        |                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcssub.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/wcssub.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/wcssub.c:3:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:847:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:852:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:858:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:898:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:907:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:916:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:925:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:934:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:945:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:1040:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 77 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcsutil.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/wcsutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zcompress.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/zcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zcompress.c: In function â€˜uncompress2fileâ€™:
  cextern/cfitsio/lib/zcompress.c:347:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    347 |             != (d_stream.total_out - bytes_out)) {
        |             ^~
  cextern/cfitsio/lib/zcompress.c: In function â€˜compress2file_from_memâ€™:
  cextern/cfitsio/lib/zcompress.c:515:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    515 |             != (c_stream.total_out - bytes_out)) {
        |             ^~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zuncompress.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/zuncompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zuncompress.c: In function â€˜write_bufâ€™:
  cextern/cfitsio/lib/zuncompress.c:581:27: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    581 |       if (bytes_out + cnt > *memsize)
        |                           ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/adler32.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/adler32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/crc32.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/crc32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/deflate.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/deflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/infback.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/infback.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inffast.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/inffast.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inflate.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/inflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inftrees.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/inftrees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/trees.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/trees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/uncompr.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/uncompr.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/zutil.c -o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/zutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  creating /tmp/tmpil_mqr08.build-lib/astropy/io/fits
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/io/fits/src/compressionmodule.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/buffers.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/cfileio.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/checksum.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrfile.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrmem.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrnet.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/drvrsmem.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/editcol.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/edithdu.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/eval_f.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/eval_l.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/eval_y.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/fits_hcompress.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/fits_hdecompress.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/fitscore.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcol.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolb.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcold.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcole.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoli.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolj.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolk.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoll.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcols.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolsb.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcolui.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoluj.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getcoluk.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/getkey.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/group.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/grparser.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/histo.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/imcompress.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/iraffits.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/modkey.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/pliocomp.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcol.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolb.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcold.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcole.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoli.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolj.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolk.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoll.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcols.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolsb.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolu.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcolui.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoluj.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putcoluk.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/putkey.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/quantize.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/region.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/ricecomp.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/scalnull.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/simplerng.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/swapproc.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/wcssub.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/wcsutil.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/zcompress.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/lib/zuncompress.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/adler32.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/crc32.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/deflate.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/infback.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/inffast.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/inflate.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/inftrees.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/trees.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/uncompr.o /tmp/tmpf7upjipw.build-temp/cextern/cfitsio/zlib/zutil.o -o /tmp/tmpil_mqr08.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.ascii.cparser' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/io/ascii
  creating /tmp/tmpf7upjipw.build-temp/astropy/io/ascii/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/cparser.c -o /tmp/tmpf7upjipw.build-temp/astropy/io/ascii/cparser.o
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/io/ascii/cparser.c:698:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/src/tokenizer.c -o /tmp/tmpf7upjipw.build-temp/astropy/io/ascii/src/tokenizer.o
  astropy/io/ascii/src/tokenizer.c: In function â€˜pushâ€™:
  astropy/io/ascii/src/tokenizer.c:124:54: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    124 |     if (self->col_ptrs[col] - self->output_cols[col] >=
        |                                                      ^~
  astropy/io/ascii/src/tokenizer.c: In function â€˜tokenizeâ€™:
  astropy/io/ascii/src/tokenizer.c:424:42: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    424 |                     if (self->source_pos == -1
        |                                          ^~
  astropy/io/ascii/src/tokenizer.c:360:9: warning: enumeration value â€˜QUOTED_FIELD_NEWLINEâ€™ not handled in switch [-Wswitch]
    360 |         switch (self->state)
        |         ^~~~~~
  creating /tmp/tmpil_mqr08.build-lib/astropy/io/ascii
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/io/ascii/cparser.o /tmp/tmpf7upjipw.build-temp/astropy/io/ascii/src/tokenizer.o -o /tmp/tmpil_mqr08.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._stats' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/stats/_stats.c -o /tmp/tmpf7upjipw.build-temp/./astropy/stats/_stats.o
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/stats/_stats.c:699:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/./astropy/stats/_stats.o -o /tmp/tmpil_mqr08.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.lombscargle.implementations.cython_impl' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpf7upjipw.build-temp/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c -o /tmp/tmpf7upjipw.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o
  In file included from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c:698:
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o -o /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.cosmology.flrw.scalar_inv_efuncs' extension
  creating /tmp/tmpf7upjipw.build-temp/astropy/cosmology
  creating /tmp/tmpf7upjipw.build-temp/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/cosmology/flrw/scalar_inv_efuncs.c -o /tmp/tmpf7upjipw.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c: In function â€˜__pyx_f_7astropy_9cosmology_4flrw_17scalar_inv_efuncs_nufuncâ€™:
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c:6370:33: warning: comparison of integer expressions of different signedness: â€˜unsigned intâ€™ and â€˜intâ€™ [-Wsign-compare]
   6370 |   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
        |                                 ^
  creating /tmp/tmpil_mqr08.build-lib/astropy/cosmology
  creating /tmp/tmpil_mqr08.build-lib/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o -o /tmp/tmpil_mqr08.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._utils' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/io/fits/_utils.c -o /tmp/tmpf7upjipw.build-temp/./astropy/io/fits/_utils.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/./astropy/io/fits/_utils.o -o /tmp/tmpil_mqr08.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.compiler_version' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/_compiler.c -o /tmp/tmpf7upjipw.build-temp/astropy/_compiler.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpf7upjipw.build-temp/astropy/_compiler.o -o /tmp/tmpil_mqr08.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so
  copying /tmp/tmpil_mqr08.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmpil_mqr08.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmpil_mqr08.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so -> astropy/utils
  copying /tmp/tmpil_mqr08.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmpil_mqr08.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so -> astropy/convolution
  copying /tmp/tmpil_mqr08.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so -> astropy/time
  copying /tmp/tmpil_mqr08.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so -> astropy/wcs
  copying /tmp/tmpil_mqr08.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -> astropy/utils/xml
  copying /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/bls
  copying /tmp/tmpil_mqr08.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so -> astropy/io/votable
  copying /tmp/tmpil_mqr08.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmpil_mqr08.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so -> astropy/io/ascii
  copying /tmp/tmpil_mqr08.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmpil_mqr08.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/lombscargle/implementations
  copying /tmp/tmpil_mqr08.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so -> astropy/cosmology/flrw
  copying /tmp/tmpil_mqr08.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmpil_mqr08.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so -> astropy
  Editable install will be performed using a meta path finder.

  Options like `package-data`, `include/exclude-package-data` or
  `packages.find.exclude/include` may have no effect.

  adding '__editable___astropy_5_2_dev362_g0df94ff70_d20251221_finder.py'
  adding '__editable__.astropy-5.2.dev362+g0df94ff70.d20251221.pth'
  creating '/tmp/pip-wheel-uifil0my/.tmp-e27uv8mz/astropy-5.2.dev362+g0df94ff70.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' and adding '/tmp/tmpvgkp75biastropy-5.2.dev362+g0df94ff70.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' to it
  adding 'astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/LICENSE.rst'
  adding 'astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/METADATA'
  adding 'astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/WHEEL'
  adding 'astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/entry_points.txt'
  adding 'astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/top_level.txt'
  adding 'astropy-5.2.dev362+g0df94ff70.d20251221.dist-info/RECORD'
  /tmp/pip-build-env-zlf3w5t8/overlay/lib/python3.9/site-packages/setuptools/command/editable_wheel.py:348: InformationOnly: Editable installation.
  !!

          ********************************************************************************
          Please be careful with folders in your working directory with the same
          name as your package as they may take precedence during imports.
          ********************************************************************************

  !!
    wheel_obj.write_files(unpacked)
  Building editable for astropy (pyproject.toml) ... [?25l[?25hdone
  Created wheel for astropy: filename=astropy-5.2.dev362+g0df94ff70.d20251221-0.editable-cp39-cp39-linux_x86_64.whl size=6758 sha256=328e21d61b7d6ec15b82fb52c13e742304c57956a38c46d7d5ade3093a4b2505
  Stored in directory: /tmp/pip-ephem-wheel-cache-e2i28tvi/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built astropy
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 5.2.dev362+g0df94ff709.d20241024
    Uninstalling astropy-5.2.dev362+g0df94ff709.d20241024:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Successfully uninstalled astropy-5.2.dev362+g0df94ff709.d20241024
  changing mode of /opt/miniconda3/envs/testbed/bin/fits2bitmap to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitscheck to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsdiff to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsheader to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsinfo to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/samp_hub to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/showtable to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/volint to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/wcslint to 755
Successfully installed astropy-5.2.dev362+g0df94ff70.d20251221
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-12-21 11:31:22,904 - thread-130546535499456.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Retrieving focal code context via external CRA
2025-12-21 11:39:17,129 - thread-130546535499456.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Focal code context retrieved: 5 items
2025-12-21 11:39:17,130 - thread-130546535499456.app.lang_graph.nodes.test_case_retrieval_node - INFO - Retrieving test case context via external CRA
2025-12-21 11:43:14,522 - thread-130546535499456.app.lang_graph.nodes.test_case_retrieval_node - INFO - Test case context retrieved: 7 items
2025-12-21 11:43:14,528 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nInconsistent behavior of `world_to_pixel` in `SlicedLowLevelWCS` \n\nIssue description: \n<!-- This comments are hidden when you submit the issue,\nso you do not need to remove them! -->\n\n<!-- Please be sure to check out our contributing guidelines,\nhttps://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .\nPlease be sure to check out our code of conduct,\nhttps://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->\n\n<!-- Please have a search on our GitHub repository to see if a similar\nissue has already been posted.\nIf a similar issue is closed, have a quick look to see if you are satisfied\nby the resolution.\nIf not please go ahead and open an issue! -->\n\n<!-- Please check that the development version still produces the same bug.\nYou can install development version with\npip install git+https://github.com/astropy/astropy\ncommand. -->\n\n### Description\n<!-- Provide a general description of the bug. -->\n\nI have a 3D WCS with dimensions corresponding to space, space, and wavelength and what some might call a non-trivial PCij matrix that couples the spectral and spatial dimensions. I find that when I perform a world_to_pixel on the full (unsliced) WCS, I get back the expected result. However, when I perform that same world_to_pixel operation on a single wavelength slice (i.e. a 2D slice with dimensions corresponding to space, space), my world_to_pixel returns an erroneous result for one of the dimensions.\n\nThis issue was originally posted as sunpy/ndcube#529, but I\'ve moved it here as it seems to be an issue with `SlicedLowLevelWCS` rather than anything specific to `ndcube`.\n\n### Steps to Reproduce\n<!-- Ideally a code example could be provided so we can run it ourselves. -->\n<!-- If you are pasting code, use triple backticks (```) around\nyour code snippet. -->\n<!-- If necessary, sanitize your screen output to be pasted so you do not\nreveal secrets like tokens and passwords. -->\n\n```python\nimport numpy as np\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nimport astropy.units as u\n\nnx = 100\nny = 25\nnz = 2\nwcs_header = {\n    \'WCSAXES\': 3,\n    \'CRPIX1\': (nx + 1)/2,\n    \'CRPIX2\': (ny + 1)/2,\n    \'CRPIX3\': 1.0,\n    \'PC1_1\': 0.0,\n    \'PC1_2\': -1.0,\n    \'PC1_3\': 0.0,\n    \'PC2_1\': 1.0,\n    \'PC2_2\': 0.0,\n    \'PC2_3\': -1.0,\n    \'CDELT1\': 5,\n    \'CDELT2\': 5,\n    \'CDELT3\': 0.055,\n    \'CUNIT1\': \'arcsec\',\n    \'CUNIT2\': \'arcsec\',\n    \'CUNIT3\': \'Angstrom\',\n    \'CTYPE1\': \'HPLN-TAN\',\n    \'CTYPE2\': \'HPLT-TAN\',\n    \'CTYPE3\': \'WAVE\',\n    \'CRVAL1\': 0.0,\n    \'CRVAL2\': 0.0,\n    \'CRVAL3\': 1.05,\n\n}\nfits_wcs = astropy.wcs.WCS(header=wcs_header)\n```\n\nDoing the following `world_to_pixel` operation on the unsliced WCS works as expected by returning me the central pixel in space and first pixel in wavelength\n```python\n>>> pt = SkyCoord(Tx=0*u.arcsec, Ty=0*u.arcsec, frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))\n>>> fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)\n(array(49.5), array(12.), array(2.44249065e-15))\n```\nI would then expect that if I take the first slice (in wavelength of my cube and do a pixel_to_world on just the spatial coordinate from above, that I would get back the same first two components\n```python\n>>> ll_sliced_wcs = astropy.wcs.wcsapi.SlicedLowLevelWCS(fits_wcs, 0)\n>>> hl_sliced_wcs = astropy.wcs.wcsapi.HighLevelWCSWrapper(ll_sliced_wcs)\n>>> hl_sliced_wcs.world_to_pixel(pt)\n(array(1.81818182e+11), array(12.))\n```\nHowever, this is not the case. The first pixel entry is essentially infinite.\n\nInterestingly, performing the equivalent `pixel_to_world` operations returns the expected results for both the full WCS and the sliced WCS,\n```python\n>>> px,py,pz = fits_wcs.world_to_pixel(pt, 1.05*u.Angstrom)\n>>> fits_wcs.pixel_to_world(px, py, pz)\n[<SkyCoord (Helioprojective: obstime=None, rsun=695700.0 km, observer=None): (Tx, Ty) in arcsec\n    (1.5467383e-27, 0.)>, <SpectralCoord 1.05e-10 m>]\n>>> hl_sliced_wcs.pixel_to_world(px, py)\n<SkyCoord (Helioprojective: obstime=None, rsun=695700.0 km, observer=None): (Tx, Ty) in arcsec\n    (1.5467383e-27, 0.)>\n```\n\n### System Details\n<!-- Even if you do not think this is necessary, it is useful information for the maintainers.\nPlease run the following snippet and paste the output below:\nimport platform; print(platform.platform())\nimport sys; print("Python", sys.version)\nimport numpy; print("Numpy", numpy.__version__)\nimport erfa; print("pyerfa", erfa.__version__)\nimport astropy; print("astropy", astropy.__version__)\nimport scipy; print("Scipy", scipy.__version__)\nimport matplotlib; print("Matplotlib", matplotlib.__version__)\n-->\n```\nmacOS-10.16-x86_64-i386-64bit\nPython 3.9.7 (default, Sep 16 2021, 08:50:36)\n[Clang 10.0.0 ]\nNumpy 1.21.5\npyerfa 2.0.0.1\nastropy 5.1\nScipy 1.8.0\nMatplotlib 3.5.1\n```\n\n\nIssue comments:\n\n\nPatch Information:\n```diff\ndiff --git a/astropy/wcs/wcsapi/wrappers/sliced_wcs.py b/astropy/wcs/wcsapi/wrappers/sliced_wcs.py\nindex d7605b078c..84e8f2abeb 100644\n--- a/astropy/wcs/wcsapi/wrappers/sliced_wcs.py\n+++ b/astropy/wcs/wcsapi/wrappers/sliced_wcs.py\n@@ -246,12 +246,16 @@ class SlicedLowLevelWCS(BaseWCSWrapper):\n         world_arrays = tuple(map(np.asanyarray, world_arrays))\n         world_arrays_new = []\n         iworld_curr = -1\n+        # Get reference world values for non-kept dimensions\n+        ref_pixel = [0] * self._wcs.pixel_n_dim\n+        ref_world = self._wcs.pixel_to_world_values(*ref_pixel)\n         for iworld in range(self._wcs.world_n_dim):\n             if iworld in self._world_keep:\n                 iworld_curr += 1\n                 world_arrays_new.append(world_arrays[iworld_curr])\n             else:\n-                world_arrays_new.append(1.)\n+                # Use the reference value for this world dimension\n+                world_arrays_new.append(ref_world[iworld])\n \n         world_arrays_new = np.broadcast_arrays(*world_arrays_new)\n         pixel_arrays = list(self._wcs.world_to_pixel_values(*world_arrays_new))\n\n```\n\nFocal Code Context (relevant code that may need fixing):\n{\'relative_path\': \'astropy/wcs/wcs.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. # Under the hood, there are 3 separate classes that perform different\\n4. # parts of the transformation:\\n5. #\\n6. #    - `~astropy.wcs.Wcsprm`: Is a direct wrapper of the core WCS\\n7. #      functionality in `wcslib`_.  (This includes TPV and TPD\\n8. #      polynomial distortion, but not SIP distortion).\\n9. #\\n10. #    - `~astropy.wcs.Sip`: Handles polynomial distortion as defined in the\\n11. #      `SIP`_ convention.\\n12. #\\n13. #    - `~astropy.wcs.DistortionLookupTable`: Handles `distortion paper`_\\n14. #      lookup tables.\\n15. #\\n16. # Additionally, the class `WCS` aggregates all of these transformations\\n17. # together in a pipeline:\\n18. #\\n19. #    - Detector to image plane correction (by a pair of\\n20. #      `~astropy.wcs.DistortionLookupTable` objects).\\n21. #\\n22. #    - `SIP`_ distortion correction (by an underlying `~astropy.wcs.Sip`\\n23. #      object)\\n24. #\\n25. #    - `distortion paper`_ table-lookup correction (by a pair of\\n26. #      `~astropy.wcs.DistortionLookupTable` objects).\\n27. #\\n28. #    - `wcslib`_ WCS transformation (by a `~astropy.wcs.Wcsprm` object)\\n29. \\n30. # STDLIB\\n31. import copy\\n32. import uuid\\n33. import io\\n34. import itertools\\n35. import os\\n36. import re\\n37. import textwrap\\n38. import warnings\\n39. import builtins\\n40. \\n41. # THIRD-\\n42. from packaging.version import Version\\n43. import numpy as np\\n44. \\n45. # LOCAL\\n46. from astropy import log\\n47. from astropy.io import fits\\n48. from . import docstrings\\n49. from . import _wcs\\n50. \\n51. from astropy import units as u\\n52. from astropy.utils.compat import possible_filename\\n53. from astropy.utils.exceptions import AstropyWarning, AstropyUserWarning, AstropyDeprecationWarning\\n54. from astropy.utils.decorators import deprecated_renamed_argument\\n55. \\n56. # Mix-in class that provides the APE 14 API\\n57. from .wcsapi.fitswcs import FITSWCSAPIMixin, SlicedFITSWCS\\n58. \\n59. __all__ = [\\\'FITSFixedWarning\\\', \\\'WCS\\\', \\\'find_all_wcs\\\',\\n60.            \\\'DistortionLookupTable\\\', \\\'Sip\\\', \\\'Tabprm\\\', \\\'Wcsprm\\\', \\\'Auxprm\\\',\\n61.            \\\'Celprm\\\', \\\'Prjprm\\\', \\\'Wtbarr\\\', \\\'WCSBase\\\', \\\'validate\\\', \\\'WcsError\\\',\\n62.            \\\'SingularMatrixError\\\', \\\'InconsistentAxisTypesError\\\',\\n63.            \\\'InvalidTransformError\\\', \\\'InvalidCoordinateError\\\',\\n64.            \\\'InvalidPrjParametersError\\\', \\\'NoSolutionError\\\',\\n65.            \\\'InvalidSubimageSpecificationError\\\', \\\'NoConvergence\\\',\\n66.            \\\'NonseparableSubimageCoordinateSystemError\\\',\\n67.            \\\'NoWcsKeywordsFoundError\\\', \\\'InvalidTabularParametersError\\\']\\n68. \\n69. \\n70. __doctest_skip__ = [\\\'WCS.all_world2pix\\\']\\n71. \\n72. \\n73. if _wcs is not None:\\n74.     if Version(_wcs.__version__) < Version("5.8"):\\n75.         raise ImportError(\\n76.             "astropy.wcs is built with wcslib {0}, but only versions 5.8 and "\\n77.             "later on the 5.x series are known to work.  The version of wcslib "\\n78.             "that ships with astropy may be used.")\\n79. \\n80.     if not _wcs._sanity_check():\\n81.         raise RuntimeError(\\n82.             "astropy.wcs did not pass its sanity check for your build "\\n83.             "on your platform.")\\n84. \\n85.     _WCSSUB_TIME_SUPPORT = Version(_wcs.__version__) >= Version("7.8")\\n86.     _WCS_TPD_WARN_LT71 = Version(_wcs.__version__) < Version("7.1")\\n87.     _WCS_TPD_WARN_LT74 = Version(_wcs.__version__) < Version("7.4")\\n88. \\n89.     WCSBase = _wcs._Wcs\\n90.     DistortionLookupTable = _wcs.DistortionLookupTable\\n91.     Sip = _wcs.Sip\\n92.     Wcsprm = _wcs.Wcsprm\\n93.     Auxprm = _wcs.Auxprm\\n94.     Celprm = _wcs.Celprm\\n95.     Prjprm = _wcs.Prjprm\\n96.     Tabprm = _wcs.Tabprm\\n97.     Wtbarr = _wcs.Wtbarr\\n98.     WcsError = _wcs.WcsError\\n99.     SingularMatrixError = _wcs.SingularMatrixError\\n100.     InconsistentAxisTypesError = _wcs.InconsistentAxisTypesError\\n101.     InvalidTransformError = _wcs.InvalidTransformError\\n102.     InvalidCoordinateError = _wcs.InvalidCoordinateError\\n103.     NoSolutionError = _wcs.NoSolutionError\\n104.     InvalidSubimageSpecificationError = _wcs.InvalidSubimageSpecificationError\\n105.     NonseparableSubimageCoordinateSystemError = _wcs.NonseparableSubimageCoordinateSystemError\\n106.     NoWcsKeywordsFoundError = _wcs.NoWcsKeywordsFoundError\\n107.     InvalidTabularParametersError = _wcs.InvalidTabularParametersError\\n108.     InvalidPrjParametersError = _wcs.InvalidPrjParametersError\\n109. \\n110.     # Copy all the constants from the C extension into this module\\\'s namespace\\n111.     for key, val in _wcs.__dict__.items():\\n112.         if key.startswith((\\\'WCSSUB_\\\', \\\'WCSHDR_\\\', \\\'WCSHDO_\\\', \\\'WCSCOMPARE_\\\', \\\'PRJ_\\\')):\\n113.             locals()[key] = val\\n114.             __all__.append(key)\\n115. \\n116.     # Set coordinate extraction callback for WCS -TAB:\\n117.     def _load_tab_bintable(hdulist, extnam, extver, extlev, kind, ttype, row, ndim):\\n118.         arr = hdulist[(extnam, extver)].data[ttype][row - 1]\\n119. \\n120.         if arr.ndim != ndim:\\n121.             if kind == \\\'c\\\' and ndim == 2:\\n122.                 arr = arr.reshape((arr.size, 1))\\n123.             else:\\n124.                 raise ValueError("Bad TDIM")\\n125. \\n126.         return np.ascontiguousarray(arr, dtype=np.double)\\n127. \\n128.     _wcs.set_wtbarr_fitsio_callback(_load_tab_bintable)\\n129. \\n130. else:\\n131.     WCSBase = object\\n132.     Wcsprm = object\\n133.     DistortionLookupTable = object\\n134.     Sip = object\\n135.     Tabprm = object\\n136.     Wtbarr = object\\n137.     WcsError = None\\n138.     SingularMatrixError = None\\n139.     InconsistentAxisTypesError = None\\n140.     InvalidTransformError = None\\n141.     InvalidCoordinateError = None\\n142.     NoSolutionError = None\\n143.     InvalidSubimageSpecificationError = None\\n144.     NonseparableSubimageCoordinateSystemError = None\\n145.     NoWcsKeywordsFoundError = None\\n146.     InvalidTabularParametersError = None\\n147. \\n148.     _WCSSUB_TIME_SUPPORT = False\\n149.     _WCS_TPD_WARN_LT71 = False\\n150.     _WCS_TPD_WARN_LT74 = False\\n151. \\n152. \\n153. # Additional relax bit flags\\n154. WCSHDO_SIP = 0x80000\\n155. \\n156. # Regular expression defining SIP keyword It matches keyword that starts with A\\n157. # or B, optionally followed by P, followed by an underscore then a number in\\n158. # range of 0-19, followed by an underscore and another number in range of 0-19.\\n159. # Keyword optionally ends with a capital letter.\\n160. SIP_KW = re.compile(\\\'\\\'\\\'^[AB]P?_1?[0-9]_1?[0-9][A-Z]?$\\\'\\\'\\\')\\n161. \\n162. \\n163. def _parse_keysel(keysel):\\n164.     keysel_flags = 0\\n165.     if keysel is not None:\\n166.         for element in keysel:\\n167.             if element.lower() == \\\'image\\\':\\n168.                 keysel_flags |= _wcs.WCSHDR_IMGHEAD\\n169.             elif element.lower() == \\\'binary\\\':\\n170.                 keysel_flags |= _wcs.WCSHDR_BIMGARR\\n171.             elif element.lower() == \\\'pixel\\\':\\n172.                 keysel_flags |= _wcs.WCSHDR_PIXLIST\\n173.             else:\\n174.                 raise ValueError(\\n175.                     "keysel must be a list of \\\'image\\\', \\\'binary\\\' " +\\n176.                     "and/or \\\'pixel\\\'")\\n177.     else:\\n178.         keysel_flags = -1\\n179. \\n180.     return keysel_flags\\n181. \\n182. \\n183. class NoConvergence(Exception):\\n184.     """\\n185.     An error class used to report non-convergence and/or divergence\\n186.     of numerical methods. It is used to report errors in the\\n187.     iterative solution used by\\n188.     the :py:meth:`~astropy.wcs.WCS.all_world2pix`.\\n189. \\n190.     Attributes\\n191.     ----------\\n192. \\n193.     best_solution : `numpy.ndarray`\\n194.         Best solution achieved by the numerical method.\\n195. \\n196.     accuracy : `numpy.ndarray`\\n197.         Accuracy of the ``best_solution``.\\n198. \\n199.     niter : `int`\\n200.         Number of iterations performed by the numerical method\\n201.         to compute ``best_solution``.\\n202. \\n203.     divergent : None, `numpy.ndarray`\\n204.         Indices of the points in ``best_solution`` array\\n205.         for which the solution appears to be divergent. If the\\n206.         solution does not diverge, ``divergent`` will be set to `None`.\\n207. \\n208.     slow_conv : None, `numpy.ndarray`\\n209.         Indices of the solutions in ``best_solution`` array\\n210.         for which the solution failed to converge within the\\n211.         specified maximum number of iterations. If there are no\\n212.         non-converging solutions (i.e., if the required accuracy\\n213.         has been achieved for all input data points)\\n214.         then ``slow_conv`` will be set to `None`.\\n215. \\n216.     """\\n217. \\n218.     def __init__(self, *args, best_solution=None, accuracy=None, niter=None,\\n219.                  divergent=None, slow_conv=None, **kwargs):\\n220.         super().__init__(*args)\\n221. \\n222.         self.best_solution = best_solution\\n223.         self.accuracy = accuracy\\n224.         self.niter = niter\\n225.         self.divergent = divergent\\n226.         self.slow_conv = slow_conv\\n227. \\n228.         if kwargs:\\n229.             warnings.warn("Function received unexpected arguments ({}) these "\\n230.                           "are ignored but will raise an Exception in the "\\n231.                           "future.".format(list(kwargs)),\\n232.                           AstropyDeprecationWarning)\\n233. \\n234. \\n235. class FITSFixedWarning(AstropyWarning):\\n236.     """\\n237.     The warning raised when the contents of the FITS header have been\\n238.     modified to be standards compliant.\\n239.     """\\n240.     pass\\n241. \\n242. \\n243. class WCS(FITSWCSAPIMixin, WCSBase):\\n244.     """WCS objects perform standard WCS transformations, and correct for\\n245.     `SIP`_ and `distortion paper`_ table-lookup transformations, based\\n246.     on the WCS keywords and supplementary data read from a FITS file.\\n247. \\n248.     See also: https://docs.astropy.org/en/stable/wcs/\\n249. \\n250.     Parameters\\n251.     ----------\\n252.     header : `~astropy.io.fits.Header`, `~astropy.io.fits.hdu.image.PrimaryHDU`, `~astropy.io.fits.hdu.image.ImageHDU`, str, dict-like, or None, optional\\n253.         If *header* is not provided or None, the object will be\\n254.         initialized to default values.\\n255. \\n256.     fobj : `~astropy.io.fits.HDUList`, optional\\n257.         It is needed when header keywords point to a `distortion\\n258.         paper`_ lookup table stored in a different extension.\\n259. \\n260.     key : str, optional\\n261.         The name of a particular WCS transform to use.  This may be\\n262.         either ``\\\' \\\'`` or ``\\\'A\\\'``-``\\\'Z\\\'`` and corresponds to the\\n263.         ``\\\\"a\\\\"`` part of the ``CTYPEia`` cards.  *key* may only be\\n264.         provided if *header* is also provided.\\n265. \\n266.     minerr : float, optional\\n267.         The minimum value a distortion correction must have in order\\n268.         to be applied. If the value of ``CQERRja`` is smaller than\\n269.         *minerr*, the corresponding distortion is not applied.\\n270. \\n271.     relax : bool or int, optional\\n272.         Degree of permissiveness:\\n273. \\n274.         - `True` (default): Admit all recognized informal extensions\\n275.           of the WCS standard.\\n276. \\n277.         - `False`: Recognize only FITS keywords defined by the\\n278.           published WCS standard.\\n279. \\n280.         - `int`: a bit field selecting specific extensions to accept.\\n281.           See :ref:`astropy:relaxread` for details.\\n282. \\n283.     naxis : int or sequence, optional\\n284.         Extracts specific coordinate axes using\\n285.         :meth:`~astropy.wcs.Wcsprm.sub`.  If a header is provided, and\\n286.         *naxis* is not ``None``, *naxis* will be passed to\\n287.         :meth:`~astropy.wcs.Wcsprm.sub` in order to select specific\\n288.         axes from the header.  See :meth:`~astropy.wcs.Wcsprm.sub` for\\n289.         more details about this parameter.\\n290. \\n291.     keysel : sequence of str, optional\\n292.         A sequence of flags used to select the keyword types\\n293.         considered by wcslib.  When ``None``, only the standard image\\n294.         header keywords are considered (and the underlying wcspih() C\\n295.         function is called).  To use binary table image array or pixel\\n296.         list keywords, *keysel* must be set.\\n297. \\n298.         Each element in the list should be one of the following\\n299.         strings:\\n300. \\n301.         - \\\'image\\\': Image header keywords\\n302. \\n303.         - \\\'binary\\\': Binary table image array keywords\\n304. \\n305.         - \\\'pixel\\\': Pixel list keywords\\n306. \\n307.         Keywords such as ``EQUIna`` or ``RFRQna`` that are common to\\n308.         binary table image arrays and pixel lists (including\\n309.         ``WCSNna`` and ``TWCSna``) are selected by both \\\'binary\\\' and\\n310.         \\\'pixel\\\'.\\n311. \\n312.     colsel : sequence of int, optional\\n313.         A sequence of table column numbers used to restrict the WCS\\n314.         transformations considered to only those pertaining to the\\n315.         specified columns.  If `None`, there is no restriction.\\n316. \\n317.     fix : bool, optional\\n318.         When `True` (default), call `~astropy.wcs.Wcsprm.fix` on\\n319.         the resulting object to fix any non-standard uses in the\\n320.         header.  `FITSFixedWarning` Warnings will be emitted if any\\n321.         changes were made.\\n322. \\n323.     translate_units : str, optional\\n324.         Specify which potentially unsafe translations of non-standard\\n325.         unit strings to perform.  By default, performs none.  See\\n326.         `WCS.fix` for more information about this parameter.  Only\\n327.         effective when ``fix`` is `True`.\\n328. \\n329.     Raises\\n330.     ------\\n331.     MemoryError\\n332.          Memory allocation failed.\\n333. \\n334.     ValueError\\n335.          Invalid key.\\n336. \\n337.     KeyError\\n338.          Key not found in FITS header.\\n339. \\n340.     ValueError\\n341.          Lookup table distortion present in the header but *fobj* was\\n342.          not provided.\\n343. \\n344.     Notes\\n345.     -----\\n346. \\n347.     1. astropy.wcs supports arbitrary *n* dimensions for the core WCS\\n348.        (the transformations handled by WCSLIB).  However, the\\n349.        `distortion paper`_ lookup table and `SIP`_ distortions must be\\n350.        two dimensional.  Therefore, if you try to create a WCS object\\n351.        where the core WCS has a different number of dimensions than 2\\n352.        and that object also contains a `distortion paper`_ lookup\\n353.        table or `SIP`_ distortion, a `ValueError`\\n354.        exception will be raised.  To avoid this, consider using the\\n355.        *naxis* kwarg to select two dimensions from the core WCS.\\n356. \\n357.     2. The number of coordinate axes in the transformation is not\\n358.        determined directly from the ``NAXIS`` keyword but instead from\\n359.        the highest of:\\n360. \\n361.            - ``NAXIS`` keyword\\n362. \\n363.            - ``WCSAXESa`` keyword\\n364. \\n365.            - The highest axis number in any parameterized WCS keyword.\\n366.              The keyvalue, as well as the keyword, must be\\n367.              syntactically valid otherwise it will not be considered.\\n368. \\n369.        If none of these keyword types is present, i.e. if the header\\n370.        only contains auxiliary WCS keywords for a particular\\n371.        coordinate representation, then no coordinate description is\\n372.        constructed for it.\\n373. \\n374.        The number of axes, which is set as the ``naxis`` member, may\\n375.        differ for different coordinate representations of the same\\n376.        image.\\n377. \\n378.     3. When the header includes duplicate keywords, in most cases the\\n379.        last encountered is used.\\n380. \\n381.     4. `~astropy.wcs.Wcsprm.set` is called immediately after\\n382.        construction, so any invalid keywords or transformations will\\n383.        be raised by the constructor, not when subsequently calling a\\n384.        transformation method.\\n385. \\n386.     """  # noqa: E501\\n387. \\n388.     def __init__(self, header=None, fobj=None, key=\\\' \\\', minerr=0.0,\\n389.                  relax=True, naxis=None, keysel=None, colsel=None,\\n390.                  fix=True, translate_units=\\\'\\\', _do_set=True):\\n391.         close_fds = []\\n392. \\n393.         # these parameters are stored to be used when unpickling a WCS object:\\n394.         self._init_kwargs = {\\n395.             \\\'keysel\\\': copy.copy(keysel),\\n396.             \\\'colsel\\\': copy.copy(colsel),\\n397.         }\\n398. \\n399.         if header is None:\\n400.             if naxis is None:\\n401.                 naxis = 2\\n402.             wcsprm = _wcs.Wcsprm(header=None, key=key,\\n403.                                  relax=relax, naxis=naxis)\\n404.             self.naxis = wcsprm.naxis\\n405.             # Set some reasonable defaults.\\n406.             det2im = (None, None)\\n407.             cpdis = (None, None)\\n408.             sip = None\\n409.         else:\\n410.             keysel_flags = _parse_keysel(keysel)\\n411. \\n412.             if isinstance(header, (str, bytes)):\\n413.                 try:\\n414.                     is_path = (possible_filename(header) and\\n415.                                os.path.exists(header))\\n416.                 except (OSError, ValueError):\\n417.                     is_path = False\\n418. \\n419.                 if is_path:\\n420.                     if fobj is not None:\\n421.                         raise ValueError(\\n422.                             "Can not provide both a FITS filename to "\\n423.                             "argument 1 and a FITS file object to argument 2")\\n424.                     fobj = fits.open(header)\\n425.                     close_fds.append(fobj)\\n426.                     header = fobj[0].header\\n427.             elif isinstance(header, fits.hdu.image._ImageBaseHDU):\\n428.                 header = header.header\\n429.             elif not isinstance(header, fits.Header):\\n430.                 try:\\n431.                     # Accept any dict-like object\\n432.                     orig_header = header\\n433.                     header = fits.Header()\\n434.                     for dict_key in orig_header.keys():\\n435.                         header[dict_key] = orig_header[dict_key]\\n436.                 except TypeError:\\n437.                     raise TypeError(\\n438.                         "header must be a string, an astropy.io.fits.Header "\\n439.                         "object, or a dict-like object")\\n440. \\n441.             if isinstance(header, fits.Header):\\n442.                 header_string = header.tostring().rstrip()\\n443.             else:\\n444.                 header_string = header\\n445. \\n446.             # Importantly, header is a *copy* of the passed-in header\\n447.             # because we will be modifying it\\n448.             if isinstance(header_string, str):\\n449.                 header_bytes = header_string.encode(\\\'ascii\\\')\\n450.                 header_string = header_string\\n451.             else:\\n452.                 header_bytes = header_string\\n453.                 header_string = header_string.decode(\\\'ascii\\\')\\n454. \\n455.             if not (fobj is None or isinstance(fobj, fits.HDUList)):\\n456.                 raise AssertionError("\\\'fobj\\\' must be either None or an "\\n457.                                      "astropy.io.fits.HDUList object.")\\n458. \\n459.             est_naxis = 2\\n460.             try:\\n461.                 tmp_header = fits.Header.fromstring(header_string)\\n462.                 self._remove_sip_kw(tmp_header)\\n463.                 tmp_header_bytes = tmp_header.tostring().rstrip()\\n464.                 if isinstance(tmp_header_bytes, str):\\n465.                     tmp_header_bytes = tmp_header_bytes.encode(\\\'ascii\\\')\\n466.                 tmp_wcsprm = _wcs.Wcsprm(header=tmp_header_bytes, key=key,\\n467.                                          relax=relax, keysel=keysel_flags,\\n468.                                          colsel=colsel, warnings=False,\\n469.                                          hdulist=fobj)\\n470.                 if naxis is not None:\\n471.                     try:\\n472.                         tmp_wcsprm = tmp_wcsprm.sub(naxis)\\n473.                     except ValueError:\\n474.                         pass\\n475.                     est_naxis = tmp_wcsprm.naxis if tmp_wcsprm.naxis else 2\\n476. \\n477.             except _wcs.NoWcsKeywordsFoundError:\\n478.                 pass\\n479. \\n480.             self.naxis = est_naxis\\n481. \\n482.             header = fits.Header.fromstring(header_string)\\n483. \\n484.             det2im = self._read_det2im_kw(header, fobj, err=minerr)\\n485.             cpdis = self._read_distortion_kw(\\n486.                 header, fobj, dist=\\\'CPDIS\\\', err=minerr)\\n487.             sip = self._read_sip_kw(header, wcskey=key)\\n488.             self._remove_sip_kw(header)\\n489. \\n490.             header_string = header.tostring()\\n491.             header_string = header_string.replace(\\\'END\\\' + \\\' \\\' * 77, \\\'\\\')\\n492. \\n493.             if isinstance(header_string, str):\\n494.                 header_bytes = header_string.encode(\\\'ascii\\\')\\n495.                 header_string = header_string\\n496.             else:\\n497.                 header_bytes = header_string\\n498.                 header_string = header_string.decode(\\\'ascii\\\')\\n499. \\n500.             try:\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/wcs/wcs.py\', \'content\': \'243. class WCS(FITSWCSAPIMixin, WCSBase):\\n244.     """WCS objects perform standard WCS transformations, and correct for\\n245.     `SIP`_ and `distortion paper`_ table-lookup transformations, based\\n246.     on the WCS keywords and supplementary data read from a FITS file.\\n247. \\n248.     See also: https://docs.astropy.org/en/stable/wcs/\\n249. \\n250.     Parameters\\n251.     ----------\\n252.     header : `~astropy.io.fits.Header`, `~astropy.io.fits.hdu.image.PrimaryHDU`, `~astropy.io.fits.hdu.image.ImageHDU`, str, dict-like, or None, optional\\n253.         If *header* is not provided or None, the object will be\\n254.         initialized to default values.\\n255. \\n256.     fobj : `~astropy.io.fits.HDUList`, optional\\n257.         It is needed when header keywords point to a `distortion\\n258.         paper`_ lookup table stored in a different extension.\\n259. \\n260.     key : str, optional\\n261.         The name of a particular WCS transform to use.  This may be\\n262.         either ``\\\' \\\'`` or ``\\\'A\\\'``-``\\\'Z\\\'`` and corresponds to the\\n263.         ``\\\\"a\\\\"`` part of the ``CTYPEia`` cards.  *key* may only be\\n264.         provided if *header* is also provided.\\n265. \\n266.     minerr : float, optional\\n267.         The minimum value a distortion correction must have in order\\n268.         to be applied. If the value of ``CQERRja`` is smaller than\\n269.         *minerr*, the corresponding distortion is not applied.\\n270. \\n271.     relax : bool or int, optional\\n272.         Degree of permissiveness:\\n273. \\n274.         - `True` (default): Admit all recognized informal extensions\\n275.           of the WCS standard.\\n276. \\n277.         - `False`: Recognize only FITS keywords defined by the\\n278.           published WCS standard.\\n279. \\n280.         - `int`: a bit field selecting specific extensions to accept.\\n281.           See :ref:`astropy:relaxread` for details.\\n282. \\n283.     naxis : int or sequence, optional\\n284.         Extracts specific coordinate axes using\\n285.         :meth:`~astropy.wcs.Wcsprm.sub`.  If a header is provided, and\\n286.         *naxis* is not ``None``, *naxis* will be passed to\\n287.         :meth:`~astropy.wcs.Wcsprm.sub` in order to select specific\\n288.         axes from the header.  See :meth:`~astropy.wcs.Wcsprm.sub` for\\n289.         more details about this parameter.\\n290. \\n291.     keysel : sequence of str, optional\\n292.         A sequence of flags used to select the keyword types\\n293.         considered by wcslib.  When ``None``, only the standard image\\n294.         header keywords are considered (and the underlying wcspih() C\\n295.         function is called).  To use binary table image array or pixel\\n296.         list keywords, *keysel* must be set.\\n297. \\n298.         Each element in the list should be one of the following\\n299.         strings:\\n300. \\n301.         - \\\'image\\\': Image header keywords\\n302. \\n303.         - \\\'binary\\\': Binary table image array keywords\\n304. \\n305.         - \\\'pixel\\\': Pixel list keywords\\n306. \\n307.         Keywords such as ``EQUIna`` or ``RFRQna`` that are common to\\n308.         binary table image arrays and pixel lists (including\\n309.         ``WCSNna`` and ``TWCSna``) are selected by both \\\'binary\\\' and\\n310.         \\\'pixel\\\'.\\n311. \\n312.     colsel : sequence of int, optional\\n313.         A sequence of table column numbers used to restrict the WCS\\n314.         transformations considered to only those pertaining to the\\n315.         specified columns.  If `None`, there is no restriction.\\n316. \\n317.     fix : bool, optional\\n318.         When `True` (default), call `~astropy.wcs.Wcsprm.fix` on\\n319.         the resulting object to fix any non-standard uses in the\\n320.         header.  `FITSFixedWarning` Warnings will be emitted if any\\n321.         changes were made.\\n322. \\n323.     translate_units : str, optional\\n324.         Specify which potentially unsafe translations of non-standard\\n325.         unit strings to perform.  By default, performs none.  See\\n326.         `WCS.fix` for more information about this parameter.  Only\\n327.         effective when ``fix`` is `True`.\\n328. \\n329.     Raises\\n330.     ------\\n331.     MemoryError\\n332.          Memory allocation failed.\\n333. \\n334.     ValueError\\n335.          Invalid key.\\n336. \\n337.     KeyError\\n338.          Key not found in FITS header.\\n339. \\n340.     ValueError\\n341.          Lookup table distortion present in the header but *fobj* was\\n342.          not provided.\\n343. \\n344.     Notes\\n345.     -----\\n346. \\n347.     1. astropy.wcs supports arbitrary *n* dimensions for the core WCS\\n348.        (the transformations handled by WCSLIB).  However, the\\n349.        `distortion paper`_ lookup table and `SIP`_ distortions must be\\n350.        two dimensional.  Therefore, if you try to create a WCS object\\n351.        where the core WCS has a different number of dimensions than 2\\n352.        and that object also contains a `distortion paper`_ lookup\\n353.        table or `SIP`_ distortion, a `ValueError`\\n354.        exception will be raised.  To avoid this, consider using the\\n355.        *naxis* kwarg to select two dimensions from the core WCS.\\n356. \\n357.     2. The number of coordinate axes in the transformation is not\\n358.        determined directly from the ``NAXIS`` keyword but instead from\\n359.        the highest of:\\n360. \\n361.            - ``NAXIS`` keyword\\n362. \\n363.            - ``WCSAXESa`` keyword\\n364. \\n365.            - The highest axis number in any parameterized WCS keyword.\\n366.              The keyvalue, as well as the keyword, must be\\n367.              syntactically valid otherwise it will not be considered.\\n368. \\n369.        If none of these keyword types is present, i.e. if the header\\n370.        only contains auxiliary WCS keywords for a particular\\n371.        coordinate representation, then no coordinate description is\\n372.        constructed for it.\\n373. \\n374.        The number of axes, which is set as the ``naxis`` member, may\\n375.        differ for different coordinate representations of the same\\n376.        image.\\n377. \\n378.     3. When the header includes duplicate keywords, in most cases the\\n379.        last encountered is used.\\n380. \\n381.     4. `~astropy.wcs.Wcsprm.set` is called immediately after\\n382.        construction, so any invalid keywords or transformations will\\n383.        be raised by the constructor, not when subsequently calling a\\n384.        transformation method.\\n385. \\n386.     """  # noqa: E501\\n387. \\n388.     def __init__(self, header=None, fobj=None, key=\\\' \\\', minerr=0.0,\\n389.                  relax=True, naxis=None, keysel=None, colsel=None,\\n390.                  fix=True, translate_units=\\\'\\\', _do_set=True):\\n391.         close_fds = []\\n392. \\n393.         # these parameters are stored to be used when unpickling a WCS object:\\n394.         self._init_kwargs = {\\n395.             \\\'keysel\\\': copy.copy(keysel),\\n396.             \\\'colsel\\\': copy.copy(colsel),\\n397.         }\\n398. \\n399.         if header is None:\\n400.             if naxis is None:\\n401.                 naxis = 2\\n402.             wcsprm = _wcs.Wcsprm(header=None, key=key,\\n403.                                  relax=relax, naxis=naxis)\\n404.             self.naxis = wcsprm.naxis\\n405.             # Set some reasonable defaults.\\n406.             det2im = (None, None)\\n407.             cpdis = (None, None)\\n408.             sip = None\\n409.         else:\\n410.             keysel_flags = _parse_keysel(keysel)\\n411. \\n412.             if isinstance(header, (str, bytes)):\\n413.                 try:\\n414.                     is_path = (possible_filename(header) and\\n415.                                os.path.exists(header))\\n416.                 except (OSError, ValueError):\\n417.                     is_path = False\\n418. \\n419.                 if is_path:\\n420.                     if fobj is not None:\\n421.                         raise ValueError(\\n422.                             "Can not provide both a FITS filename to "\\n423.                             "argument 1 and a FITS file object to argument 2")\\n424.                     fobj = fits.open(header)\\n425.                     close_fds.append(fobj)\\n426.                     header = fobj[0].header\\n427.             elif isinstance(header, fits.hdu.image._ImageBaseHDU):\\n428.                 header = header.header\\n429.             elif not isinstance(header, fits.Header):\\n430.                 try:\\n431.                     # Accept any dict-like object\\n432.                     orig_header = header\\n433.                     header = fits.Header()\\n434.                     for dict_key in orig_header.keys():\\n435.                         header[dict_key] = orig_header[dict_key]\\n436.                 except TypeError:\\n437.                     raise TypeError(\\n438.                         "header must be a string, an astropy.io.fits.Header "\\n439.                         "object, or a dict-like object")\\n440. \\n441.             if isinstance(header, fits.Header):\\n442.                 header_string = header.tostring().rstrip()\\n443.             else:\\n444.                 header_string = header\\n445. \\n446.             # Importantly, header is a *copy* of the passed-in header\\n447.             # because we will be modifying it\\n448.             if isinstance(header_string, str):\\n449.                 header_bytes = header_string.encode(\\\'ascii\\\')\\n450.                 header_string = header_string\\n451.             else:\\n452.                 header_bytes = header_string\\n453.                 header_string = header_string.decode(\\\'ascii\\\')\\n454. \\n455.             if not (fobj is None or isinstance(fobj, fits.HDUList)):\\n456.                 raise AssertionError("\\\'fobj\\\' must be either None or an "\\n457.                                      "astropy.io.fits.HDUList object.")\\n458. \\n459.             est_naxis = 2\\n460.             try:\\n461.                 tmp_header = fits.Header.fromstring(header_string)\\n462.                 self._remove_sip_kw(tmp_header)\\n463.                 tmp_header_bytes = tmp_header.tostring().rstrip()\\n464.                 if isinstance(tmp_header_bytes, str):\\n465.                     tmp_header_bytes = tmp_header_bytes.encode(\\\'ascii\\\')\\n466.                 tmp_wcsprm = _wcs.Wcsprm(header=tmp_header_bytes, key=key,\\n467.                                          relax=relax, keysel=keysel_flags,\\n468.                                          colsel=colsel, warnings=False,\\n469.                                          hdulist=fobj)\\n470.                 if naxis is not None:\\n471.                     try:\\n472.                         tmp_wcsprm = tmp_wcsprm.sub(naxis)\\n473.                     except ValueError:\\n474.                         pass\\n475.                     est_naxis = tmp_wcsprm.naxis if tmp_wcsprm.naxis else 2\\n476. \\n477.             except _wcs.NoWcsKeywordsFoundError:\\n478.                 pass\\n479. \\n480.             self.naxis = est_naxis\\n481. \\n482.             header = fits.Header.fromstring(header_string)\\n483. \\n484.             det2im = self._read_det2im_kw(header, fobj, err=minerr)\\n485.             cpdis = self._read_distortion_kw(\\n486.                 header, fobj, dist=\\\'CPDIS\\\', err=minerr)\\n487.             sip = self._read_sip_kw(header, wcskey=key)\\n488.             self._remove_sip_kw(header)\\n489. \\n490.             header_string = header.tostring()\\n491.             header_string = header_string.replace(\\\'END\\\' + \\\' \\\' * 77, \\\'\\\')\\n492. \\n493.             if isinstance(header_string, str):\\n494.                 header_bytes = header_string.encode(\\\'ascii\\\')\\n495.                 header_string = header_string\\n496.             else:\\n497.                 header_bytes = header_string\\n498.                 header_string = header_string.decode(\\\'ascii\\\')\\n499. \\n500.             try:\\n501.                 wcsprm = _wcs.Wcsprm(header=header_bytes, key=key,\\n502.                                      relax=relax, keysel=keysel_flags,\\n503.                                      colsel=colsel, hdulist=fobj)\\n504.             except _wcs.NoWcsKeywordsFoundError:\\n505.                 # The header may have SIP or distortions, but no core\\n506.                 # WCS.  That isn\\\'t an error -- we want a "default"\\n507.                 # (identity) core Wcs transformation in that case.\\n508.                 if colsel is None:\\n509.                     wcsprm = _wcs.Wcsprm(header=None, key=key,\\n510.                                          relax=relax, keysel=keysel_flags,\\n511.                                          colsel=colsel, hdulist=fobj)\\n512.                 else:\\n513.                     raise\\n514. \\n515.             if naxis is not None:\\n516.                 wcsprm = wcsprm.sub(naxis)\\n517.             self.naxis = wcsprm.naxis\\n518. \\n519.             if (wcsprm.naxis != 2 and\\n520.                     (det2im[0] or det2im[1] or cpdis[0] or cpdis[1] or sip)):\\n521.                 raise ValueError(\\n522.                     """\\n523. FITS WCS distortion paper lookup tables and SIP distortions only work\\n524. in 2 dimensions.  However, WCSLIB has detected {} dimensions in the\\n525. core WCS keywords.  To use core WCS in conjunction with FITS WCS\\n526. distortion paper lookup tables or SIP distortion, you must select or\\n527. reduce these to 2 dimensions using the naxis kwarg.\\n528. """.format(wcsprm.naxis))\\n529. \\n530.             header_naxis = header.get(\\\'NAXIS\\\', None)\\n531.             if header_naxis is not None and header_naxis < wcsprm.naxis:\\n532.                 warnings.warn(\\n533.                     "The WCS transformation has more axes ({:d}) than the "\\n534.                     "image it is associated with ({:d})".format(\\n535.                         wcsprm.naxis, header_naxis), FITSFixedWarning)\\n536. \\n537.         self._get_naxis(header)\\n538.         WCSBase.__init__(self, sip, cpdis, wcsprm, det2im)\\n539. \\n540.         if fix:\\n541.             if header is None:\\n542.                 with warnings.catch_warnings():\\n543.                     warnings.simplefilter(\\\'ignore\\\', FITSFixedWarning)\\n544.                     self.fix(translate_units=translate_units)\\n545.             else:\\n546.                 self.fix(translate_units=translate_units)\\n547. \\n548.         if _do_set:\\n549.             self.wcs.set()\\n550. \\n551.         for fd in close_fds:\\n552.             fd.close()\\n553. \\n554.         self._pixel_bounds = None\\n555. \\n556.     def __copy__(self):\\n557.         new_copy = self.__class__()\\n558.         WCSBase.__init__(new_copy, self.sip,\\n559.                          (self.cpdis1, self.cpdis2),\\n560.                          self.wcs,\\n561.                          (self.det2im1, self.det2im2))\\n562.         new_copy.__dict__.update(self.__dict__)\\n563.         return new_copy\\n564. \\n565.     def __deepcopy__(self, memo):\\n566.         from copy import deepcopy\\n567. \\n568.         new_copy = self.__class__()\\n569.         new_copy.naxis = deepcopy(self.naxis, memo)\\n570.         WCSBase.__init__(new_copy, deepcopy(self.sip, memo),\\n571.                          (deepcopy(self.cpdis1, memo),\\n572.                           deepcopy(self.cpdis2, memo)),\\n573.                          deepcopy(self.wcs, memo),\\n574.                          (deepcopy(self.det2im1, memo),\\n575.                           deepcopy(self.det2im2, memo)))\\n576.         for key, val in self.__dict__.items():\\n577.             new_copy.__dict__[key] = deepcopy(val, memo)\\n578.         return new_copy\\n579. \\n580.     def copy(self):\\n581.         """\\n582.         Return a shallow copy of the object.\\n583. \\n584.         Convenience method so user doesn\\\'t have to import the\\n585.         :mod:`copy` stdlib module.\\n586. \\n587.         .. warning::\\n588.             Use `deepcopy` instead of `copy` unless you know why you need a\\n589.             shallow copy.\\n590.         """\\n591.         return copy.copy(self)\\n592. \\n593.     def deepcopy(self):\\n594.         """\\n595.         Return a deep copy of the object.\\n596. \\n597.         Convenience method so user doesn\\\'t have to import the\\n598.         :mod:`copy` stdlib module.\\n599.         """\\n600.         return copy.deepcopy(self)\\n601. \\n602.     def sub(self, axes=None):\\n603. \\n604.         copy = self.deepcopy()\\n605. \\n606.         # We need to know which axes have been dropped, but there is no easy\\n607.         # way to do this with the .sub function, so instead we assign UUIDs to\\n608.         # the CNAME parameters in copy.wcs. We can later access the original\\n609.         # CNAME properties from self.wcs.\\n610.         cname_uuid = [str(uuid.uuid4()) for i in range(copy.wcs.naxis)]\\n611.         copy.wcs.cname = cname_uuid\\n612. \\n613.         # Subset the WCS\\n614.         copy.wcs = copy.wcs.sub(axes)\\n615.         copy.naxis = copy.wcs.naxis\\n616. \\n617.         # Construct a list of dimensions from the original WCS in the order\\n618.         # in which they appear in the final WCS.\\n619.         keep = [cname_uuid.index(cname) if cname in cname_uuid else None\\n620.                 for cname in copy.wcs.cname]\\n621. \\n622.         # Restore the original CNAMEs\\n623.         copy.wcs.cname = [\\\'\\\' if i is None else self.wcs.cname[i] for i in keep]\\n624. \\n625.         # Subset pixel_shape and pixel_bounds\\n626.         if self.pixel_shape:\\n627.             copy.pixel_shape = tuple(None if i is None else self.pixel_shape[i] for i in keep)\\n628.         if self.pixel_bounds:\\n629.             copy.pixel_bounds = [None if i is None else self.pixel_bounds[i] for i in keep]\\n630. \\n631.         return copy\\n632. \\n633.     if _wcs is not None:\\n634.         sub.__doc__ = _wcs.Wcsprm.sub.__doc__\\n635. \\n636.     def _fix_scamp(self):\\n637.         """\\n638.         Remove SCAMP\\\'s PVi_m distortion parameters if SIP distortion parameters\\n639.         are also present. Some projects (e.g., Palomar Transient Factory)\\n640.         convert SCAMP\\\'s distortion parameters (which abuse the PVi_m cards) to\\n641.         SIP. However, wcslib gets confused by the presence of both SCAMP and\\n642.         SIP distortion parameters.\\n643. \\n644.         See https://github.com/astropy/astropy/issues/299.\\n645.         """\\n646.         # Nothing to be done if no WCS attached\\n647.         if self.wcs is None:\\n648.             return\\n649. \\n650.         # Nothing to be done if no PV parameters attached\\n651.         pv = self.wcs.get_pv()\\n652.         if not pv:\\n653.             return\\n654. \\n655.         # Nothing to be done if axes don\\\'t use SIP distortion parameters\\n656.         if self.sip is None:\\n657.             return\\n658. \\n659.         # Nothing to be done if any radial terms are present...\\n660.         # Loop over list to find any radial terms.\\n661.         # Certain values of the `j\\\' index are used for storing\\n662.         # radial terms; refer to Equation (1) in\\n663.         # <http://web.ipac.caltech.edu/staff/shupe/reprints/SIP_to_PV_SPIE2012.pdf>.\\n664.         pv = np.asarray(pv)\\n665.         # Loop over distinct values of `i\\\' index\\n666.         for i in set(pv[:, 0]):\\n667.             # Get all values of `j\\\' index for this value of `i\\\' index\\n668.             js = set(pv[:, 1][pv[:, 0] == i])\\n669.             # Find max value of `j\\\' index\\n670.             max_j = max(js)\\n671.             for j in (3, 11, 23, 39):\\n672.                 if j < max_j and j in js:\\n673.                     return\\n674. \\n675.         self.wcs.set_pv([])\\n676.         warnings.warn("Removed redundant SCAMP distortion parameters " +\\n677.                       "because SIP parameters are also present", FITSFixedWarning)\\n678. \\n679.     def fix(self, translate_units=\\\'\\\', naxis=None):\\n680.         """\\n681.         Perform the fix operations from wcslib, and warn about any\\n682.         changes it has made.\\n683. \\n684.         Parameters\\n685.         ----------\\n686.         translate_units : str, optional\\n687.             Specify which potentially unsafe translations of\\n688.             non-standard unit strings to perform.  By default,\\n689.             performs none.\\n690. \\n691.             Although ``"S"`` is commonly used to represent seconds,\\n692.             its translation to ``"s"`` is potentially unsafe since the\\n693.             standard recognizes ``"S"`` formally as Siemens, however\\n694.             rarely that may be used.  The same applies to ``"H"`` for\\n695.             hours (Henry), and ``"D"`` for days (Debye).\\n696. \\n697.             This string controls what to do in such cases, and is\\n698.             case-insensitive.\\n699. \\n700.             - If the string contains ``"s"``, translate ``"S"`` to\\n701.               ``"s"``.\\n702. \\n703.             - If the string contains ``"h"``, translate ``"H"`` to\\n704.               ``"h"``.\\n705. \\n706.             - If the string contains ``"d"``, translate ``"D"`` to\\n707.               ``"d"``.\\n708. \\n709.             Thus ``\\\'\\\'`` doesn\\\'t do any unsafe translations, whereas\\n710.             ``\\\'shd\\\'`` does all of them.\\n711. \\n712.         naxis : int array, optional\\n713.             Image axis lengths.  If this array is set to zero or\\n714.             ``None``, then `~astropy.wcs.Wcsprm.cylfix` will not be\\n715.             invoked.\\n716.         """\\n717.         if self.wcs is not None:\\n718.             self._fix_scamp()\\n719.             fixes = self.wcs.fix(translate_units, naxis)\\n720.             for key, val in fixes.items():\\n721.                 if val != "No change":\\n722.                     if (key == \\\'datfix\\\' and \\\'1858-11-17\\\' in val and\\n723.                             not np.count_nonzero(self.wcs.mjdref)):\\n724.                         continue\\n725.                     warnings.warn(\\n726.                         ("\\\'{0}\\\' made the change \\\'{1}\\\'.").\\n727.                         format(key, val),\\n728.                         FITSFixedWarning)\\n729. \\n730.     def calc_footprint(self, header=None, undistort=True, axes=None, center=True):\\n731.         """\\n732.         Calculates the footprint of the image on the sky.\\n733. \\n734.         A footprint is defined as the positions of the corners of the\\n735.         image on the sky after all available distortions have been\\n736.         applied.\\n737. \\n738.         Parameters\\n739.         ----------\\n740.         header : `~astropy.io.fits.Header` object, optional\\n741.             Used to get ``NAXIS1`` and ``NAXIS2``\\n742.             header and axes are mutually exclusive, alternative ways\\n743.             to provide the same information.\\n744. \\n745.         undistort : bool, optional\\n746.             If `True`, take SIP and distortion lookup table into\\n747.             account\\n748. \\n749.         axes : (int, int), optional\\n750.             If provided, use the given sequence as the shape of the\\n751.             image.  Otherwise, use the ``NAXIS1`` and ``NAXIS2``\\n752.             keywords from the header that was used to create this\\n753.             `WCS` object.\\n754. \\n755.         center : bool, optional\\n756.             If `True` use the center of the pixel, otherwise use the corner.\\n757. \\n758.         Returns\\n759.         -------\\n760.         coord : (4, 2) array of (*x*, *y*) coordinates.\\n761.             The order is clockwise starting with the bottom left corner.\\n762.         """\\n763.         if axes is not None:\\n764.             naxis1, naxis2 = axes\\n765.         else:\\n766.             if header is None:\\n767.                 try:\\n768.                     # classes that inherit from WCS and define naxis1/2\\n769.                     # do not require a header parameter\\n770.                     naxis1, naxis2 = self.pixel_shape\\n771.                 except (AttributeError, TypeError):\\n772.                     warnings.warn(\\n773.                         "Need a valid header in order to calculate footprint\\\\n", AstropyUserWarning)\\n774.                     return None\\n775.             else:\\n776.                 naxis1 = header.get(\\\'NAXIS1\\\', None)\\n777.                 naxis2 = header.get(\\\'NAXIS2\\\', None)\\n778. \\n779.         if naxis1 is None or naxis2 is None:\\n780.             raise ValueError(\\n781.                     "Image size could not be determined.")\\n782. \\n783.         if center:\\n784.             corners = np.array([[1, 1],\\n785.                                 [1, naxis2],\\n786.                                 [naxis1, naxis2],\\n787.                                 [naxis1, 1]], dtype=np.float64)\\n788.         else:\\n789.             corners = np.array([[0.5, 0.5],\\n790.                                 [0.5, naxis2 + 0.5],\\n791.                                 [naxis1 + 0.5, naxis2 + 0.5],\\n792.                                 [naxis1 + 0.5, 0.5]], dtype=np.float64)\\n793. \\n794.         if undistort:\\n795.             return self.all_pix2world(corners, 1)\\n796.         else:\\n797.             return self.wcs_pix2world(corners, 1)\\n798. \\n799.     def _read_det2im_kw(self, header, fobj, err=0.0):\\n800.         """\\n801.         Create a `distortion paper`_ type lookup table for detector to\\n802.         image plane correction.\\n803.         """\\n804.         if fobj is None:\\n805.             return (None, None)\\n806. \\n807.         if not isinstance(fobj, fits.HDUList):\\n808.             return (None, None)\\n809. \\n810.         try:\\n811.             axiscorr = header[\\\'AXISCORR\\\']\\n812.             d2imdis = self._read_d2im_old_format(header, fobj, axiscorr)\\n813.             return d2imdis\\n814.         except KeyError:\\n815.             pass\\n816. \\n817.         dist = \\\'D2IMDIS\\\'\\n818.         d_kw = \\\'D2IM\\\'\\n819.         err_kw = \\\'D2IMERR\\\'\\n820.         tables = {}\\n821.         for i in range(1, self.naxis + 1):\\n822.             d_error = header.get(err_kw + str(i), 0.0)\\n823.             if d_error < err:\\n824.                 tables[i] = None\\n825.                 continue\\n826.             distortion = dist + str(i)\\n827.             if distortion in header:\\n828.                 dis = header[distortion].lower()\\n829.                 if dis == \\\'lookup\\\':\\n830.                     del header[distortion]\\n831.                     assert isinstance(fobj, fits.HDUList), (\\n832.                         \\\'An astropy.io.fits.HDUList\\\'\\n833.                         \\\'is required for Lookup table distortion.\\\')\\n834.                     dp = (d_kw + str(i)).strip()\\n835.                     dp_extver_key = dp + \\\'.EXTVER\\\'\\n836.                     if dp_extver_key in header:\\n837.                         d_extver = header[dp_extver_key]\\n838.                         del header[dp_extver_key]\\n839.                     else:\\n840.                         d_extver = 1\\n841.                     dp_axis_key = dp + f\\\'.AXIS.{i:d}\\\'\\n842.                     if i == header[dp_axis_key]:\\n843.                         d_data = fobj[\\\'D2IMARR\\\', d_extver].data\\n844.                     else:\\n845.                         d_data = (fobj[\\\'D2IMARR\\\', d_extver].data).transpose()\\n846.                     del header[dp_axis_key]\\n847.                     d_header = fobj[\\\'D2IMARR\\\', d_extver].header\\n848.                     d_crpix = (d_header.get(\\\'CRPIX1\\\', 0.0), d_header.get(\\\'CRPIX2\\\', 0.0))\\n849.                     d_crval = (d_header.get(\\\'CRVAL1\\\', 0.0), d_header.get(\\\'CRVAL2\\\', 0.0))\\n850.                     d_cdelt = (d_header.get(\\\'CDELT1\\\', 1.0), d_header.get(\\\'CDELT2\\\', 1.0))\\n851.                     d_lookup = DistortionLookupTable(d_data, d_crpix,\\n852.                                                      d_crval, d_cdelt)\\n853.                     tables[i] = d_lookup\\n854.                 else:\\n855.                     warnings.warn(\\\'Polynomial distortion is not implemented.\\\\n\\\', AstropyUserWarning)\\n856.                 for key in set(header):\\n857.                     if key.startswith(dp + \\\'.\\\'):\\n858.                         del header[key]\\n859.             else:\\n860.                 tables[i] = None\\n861.         if not tables:\\n862.             return (None, None)\\n863.         else:\\n864.             return (tables.get(1), tables.get(2))\\n865. \\n866.     def _read_d2im_old_format(self, header, fobj, axiscorr):\\n867.         warnings.warn(\\n868.             "The use of ``AXISCORR`` for D2IM correction has been deprecated."\\n869.             "`~astropy.wcs` will read in files with ``AXISCORR`` but ``to_fits()`` will write "\\n870.             "out files without it.",\\n871.             AstropyDeprecationWarning)\\n872.         cpdis = [None, None]\\n873.         crpix = [0., 0.]\\n874.         crval = [0., 0.]\\n875.         cdelt = [1., 1.]\\n876.         try:\\n877.             d2im_data = fobj[(\\\'D2IMARR\\\', 1)].data\\n878.         except KeyError:\\n879.             return (None, None)\\n880.         except AttributeError:\\n881.             return (None, None)\\n882. \\n883.         d2im_data = np.array([d2im_data])\\n884.         d2im_hdr = fobj[(\\\'D2IMARR\\\', 1)].header\\n885.         naxis = d2im_hdr[\\\'NAXIS\\\']\\n886. \\n887.         for i in range(1, naxis + 1):\\n888.             crpix[i - 1] = d2im_hdr.get(\\\'CRPIX\\\' + str(i), 0.0)\\n889.             crval[i - 1] = d2im_hdr.get(\\\'CRVAL\\\' + str(i), 0.0)\\n890.             cdelt[i - 1] = d2im_hdr.get(\\\'CDELT\\\' + str(i), 1.0)\\n891. \\n892.         cpdis = DistortionLookupTable(d2im_data, crpix, crval, cdelt)\\n893. \\n894.         if axiscorr == 1:\\n895.             return (cpdis, None)\\n896.         elif axiscorr == 2:\\n897.             return (None, cpdis)\\n898.         else:\\n899.             warnings.warn("Expected AXISCORR to be 1 or 2", AstropyUserWarning)\\n900.             return (None, None)\\n901. \\n902.     def _write_det2im(self, hdulist):\\n903.         """\\n904.         Writes a `distortion paper`_ type lookup table to the given\\n905.         `~astropy.io.fits.HDUList`.\\n906.         """\\n907. \\n908.         if self.det2im1 is None and self.det2im2 is None:\\n909.             return\\n910.         dist = \\\'D2IMDIS\\\'\\n911.         d_kw = \\\'D2IM\\\'\\n912. \\n913.         def write_d2i(num, det2im):\\n914.             if det2im is None:\\n915.                 return\\n916. \\n917.             hdulist[0].header[f\\\'{dist}{num:d}\\\'] = (\\n918.                 \\\'LOOKUP\\\', \\\'Detector to image correction type\\\')\\n919.             hdulist[0].header[f\\\'{d_kw}{num:d}.EXTVER\\\'] = (\\n920.                 num, \\\'Version number of WCSDVARR extension\\\')\\n921.             hdulist[0].header[f\\\'{d_kw}{num:d}.NAXES\\\'] = (\\n922.                 len(det2im.data.shape), \\\'Number of independent variables in D2IM function\\\')\\n923. \\n924.             for i in range(det2im.data.ndim):\\n925.                 jth = {1: \\\'1st\\\', 2: \\\'2nd\\\', 3: \\\'3rd\\\'}.get(i + 1, f\\\'{i + 1}th\\\')\\n926.                 hdulist[0].header[f\\\'{d_kw}{num:d}.AXIS.{i + 1:d}\\\'] = (\\n927.                     i + 1, f\\\'Axis number of the {jth} variable in a D2IM function\\\')\\n928. \\n929.             image = fits.ImageHDU(det2im.data, name=\\\'D2IMARR\\\')\\n930.             header = image.header\\n931. \\n932.             header[\\\'CRPIX1\\\'] = (det2im.crpix[0],\\n933.                                 \\\'Coordinate system reference pixel\\\')\\n934.             header[\\\'CRPIX2\\\'] = (det2im.crpix[1],\\n935.                                 \\\'Coordinate system reference pixel\\\')\\n936.             header[\\\'CRVAL1\\\'] = (det2im.crval[0],\\n937.                                 \\\'Coordinate system value at reference pixel\\\')\\n938.             header[\\\'CRVAL2\\\'] = (det2im.crval[1],\\n939.                                 \\\'Coordinate system value at reference pixel\\\')\\n940.             header[\\\'CDELT1\\\'] = (det2im.cdelt[0],\\n941.                                 \\\'Coordinate increment along axis\\\')\\n942.             header[\\\'CDELT2\\\'] = (det2im.cdelt[1],\\n943.                                 \\\'Coordinate increment along axis\\\')\\n944.             image.ver = int(hdulist[0].header[f\\\'{d_kw}{num:d}.EXTVER\\\'])\\n945.             hdulist.append(image)\\n946.         write_d2i(1, self.det2im1)\\n947.         write_d2i(2, self.det2im2)\\n948. \\n949.     def _read_distortion_kw(self, header, fobj, dist=\\\'CPDIS\\\', err=0.0):\\n950.         """\\n951.         Reads `distortion paper`_ table-lookup keywords and data, and\\n952.         returns a 2-tuple of `~astropy.wcs.DistortionLookupTable`\\n953.         objects.\\n954. \\n955.         If no `distortion paper`_ keywords are found, ``(None, None)``\\n956.         is returned.\\n957.         """\\n958.         if isinstance(header, (str, bytes)):\\n959.             return (None, None)\\n960. \\n961.         if dist == \\\'CPDIS\\\':\\n962.             d_kw = \\\'DP\\\'\\n963.             err_kw = \\\'CPERR\\\'\\n964.         else:\\n965.             d_kw = \\\'DQ\\\'\\n966.             err_kw = \\\'CQERR\\\'\\n967. \\n968.         tables = {}\\n969.         for i in range(1, self.naxis + 1):\\n970.             d_error_key = err_kw + str(i)\\n971.             if d_error_key in header:\\n972.                 d_error = header[d_error_key]\\n973.                 del header[d_error_key]\\n974.             else:\\n975.                 d_error = 0.0\\n976.             if d_error < err:\\n977.                 tables[i] = None\\n978.                 continue\\n979.             distortion = dist + str(i)\\n980.             if distortion in header:\\n981.                 dis = header[distortion].lower()\\n982.                 del header[distortion]\\n983.                 if dis == \\\'lookup\\\':\\n984.                     if not isinstance(fobj, fits.HDUList):\\n985.                         raise ValueError(\\\'an astropy.io.fits.HDUList is \\\'\\n986.                                          \\\'required for Lookup table distortion.\\\')\\n987.                     dp = (d_kw + str(i)).strip()\\n988.                     dp_extver_key = dp + \\\'.EXTVER\\\'\\n989.                     if dp_extver_key in header:\\n990.                         d_extver = header[dp_extver_key]\\n991.                         del header[dp_extver_key]\\n992.                     else:\\n993.                         d_extver = 1\\n994.                     dp_axis_key = dp + f\\\'.AXIS.{i:d}\\\'\\n995.                     if i == header[dp_axis_key]:\\n996.                         d_data = fobj[\\\'WCSDVARR\\\', d_extver].data\\n997.                     else:\\n998.                         d_data = (fobj[\\\'WCSDVARR\\\', d_extver].data).transpose()\\n999.                     del header[dp_axis_key]\\n1000.                     d_header = fobj[\\\'WCSDVARR\\\', d_extver].header\\n1001.                     d_crpix = (d_header.get(\\\'CRPIX1\\\', 0.0),\\n1002.                                d_header.get(\\\'CRPIX2\\\', 0.0))\\n1003.                     d_crval = (d_header.get(\\\'CRVAL1\\\', 0.0),\\n1004.                                d_header.get(\\\'CRVAL2\\\', 0.0))\\n1005.                     d_cdelt = (d_header.get(\\\'CDELT1\\\', 1.0),\\n1006.                                d_header.get(\\\'CDELT2\\\', 1.0))\\n1007.                     d_lookup = DistortionLookupTable(d_data, d_crpix, d_crval, d_cdelt)\\n1008.                     tables[i] = d_lookup\\n1009. \\n1010.                     for key in set(header):\\n1011.                         if key.startswith(dp + \\\'.\\\'):\\n1012.                             del header[key]\\n1013.                 else:\\n1014.                     warnings.warn(\\\'Polynomial distortion is not implemented.\\\\n\\\', AstropyUserWarning)\\n1015.             else:\\n1016.                 tables[i] = None\\n1017. \\n1018.         if not tables:\\n1019.             return (None, None)\\n1020.         else:\\n1021.             return (tables.get(1), tables.get(2))\\n1022. \\n1023.     def _write_distortion_kw(self, hdulist, dist=\\\'CPDIS\\\'):\\n1024.         """\\n1025.         Write out `distortion paper`_ keywords to the given\\n1026.         `~astropy.io.fits.HDUList`.\\n1027.         """\\n1028.         if self.cpdis1 is None and self.cpdis2 is None:\\n1029.             return\\n1030. \\n1031.         if dist == \\\'CPDIS\\\':\\n1032.             d_kw = \\\'DP\\\'\\n1033.         else:\\n1034.             d_kw = \\\'DQ\\\'\\n1035. \\n1036.         def write_dist(num, cpdis):\\n1037.             if cpdis is None:\\n1038.                 return\\n1039. \\n1040.             hdulist[0].header[f\\\'{dist}{num:d}\\\'] = (\\n1041.                 \\\'LOOKUP\\\', \\\'Prior distortion function type\\\')\\n1042.             hdulist[0].header[f\\\'{d_kw}{num:d}.EXTVER\\\'] = (\\n1043.                 num, \\\'Version number of WCSDVARR extension\\\')\\n1044.             hdulist[0].header[f\\\'{d_kw}{num:d}.NAXES\\\'] = (\\n1045.                 len(cpdis.data.shape), f\\\'Number of independent variables in {dist} function\\\')\\n1046. \\n1047.             for i in range(cpdis.data.ndim):\\n1048.                 jth = {1: \\\'1st\\\', 2: \\\'2nd\\\', 3: \\\'3rd\\\'}.get(i + 1, f\\\'{i + 1}th\\\')\\n1049.                 hdulist[0].header[f\\\'{d_kw}{num:d}.AXIS.{i + 1:d}\\\'] = (\\n1050.                     i + 1,\\n1051.                     f\\\'Axis number of the {jth} variable in a {dist} function\\\')\\n1052. \\n1053.             image = fits.ImageHDU(cpdis.data, name=\\\'WCSDVARR\\\')\\n1054.             header = image.header\\n1055. \\n1056.             header[\\\'CRPIX1\\\'] = (cpdis.crpix[0], \\\'Coordinate system reference pixel\\\')\\n1057.             header[\\\'CRPIX2\\\'] = (cpdis.crpix[1], \\\'Coordinate system reference pixel\\\')\\n1058.             header[\\\'CRVAL1\\\'] = (cpdis.crval[0], \\\'Coordinate system value at reference pixel\\\')\\n1059.             header[\\\'CRVAL2\\\'] = (cpdis.crval[1], \\\'Coordinate system value at reference pixel\\\')\\n1060.             header[\\\'CDELT1\\\'] = (cpdis.cdelt[0], \\\'Coordinate increment along axis\\\')\\n1061.             header[\\\'CDELT2\\\'] = (cpdis.cdelt[1], \\\'Coordinate increment along axis\\\')\\n1062.             image.ver = int(hdulist[0].header[f\\\'{d_kw}{num:d}.EXTVER\\\'])\\n1063.             hdulist.append(image)\\n1064. \\n1065.         write_dist(1, self.cpdis1)\\n1066.         write_dist(2, self.cpdis2)\\n1067. \\n1068.     def _remove_sip_kw(self, header):\\n1069.         """\\n1070.         Remove SIP information from a header.\\n1071.         """\\n1072.         # Never pass SIP coefficients to wcslib\\n1073.         # CTYPE must be passed with -SIP to wcslib\\n1074.         for key in {m.group() for m in map(SIP_KW.match, list(header))\\n1075.                     if m is not None}:\\n1076.             del header[key]\\n1077. \\n1078.     def _read_sip_kw(self, header, wcskey=""):\\n1079.         """\\n1080.         Reads `SIP`_ header keywords and returns a `~astropy.wcs.Sip`\\n1081.         object.\\n1082. \\n1083.         If no `SIP`_ header keywords are found, ``None`` is returned.\\n1084.         """\\n1085.         if isinstance(header, (str, bytes)):\\n1086.             # TODO: Parse SIP from a string without pyfits around\\n1087.             return None\\n1088. \\n1089.         if "A_ORDER" in header and header[\\\'A_ORDER\\\'] > 1:\\n1090.             if "B_ORDER" not in header:\\n1091.                 raise ValueError(\\n1092.                     "A_ORDER provided without corresponding B_ORDER "\\n1093.                     "keyword for SIP distortion")\\n1094. \\n1095.             m = int(header["A_ORDER"])\\n1096.             a = np.zeros((m + 1, m + 1), np.double)\\n1097.             for i in range(m + 1):\\n1098.                 for j in range(m - i + 1):\\n1099.                     key = f"A_{i}_{j}"\\n1100.                     if key in header:\\n1101.                         a[i, j] = header[key]\\n1102.                         del header[key]\\n1103. \\n1104.             m = int(header["B_ORDER"])\\n1105.             if m > 1:\\n1106.                 b = np.zeros((m + 1, m + 1), np.double)\\n1107.                 for i in range(m + 1):\\n1108.                     for j in range(m - i + 1):\\n1109.                         key = f"B_{i}_{j}"\\n1110.                         if key in header:\\n1111.                             b[i, j] = header[key]\\n1112.                             del header[key]\\n1113.             else:\\n1114.                 a = None\\n1115.                 b = None\\n1116. \\n1117.             del header[\\\'A_ORDER\\\']\\n1118.             del header[\\\'B_ORDER\\\']\\n1119. \\n1120.             ctype = [header[f\\\'CTYPE{nax}{wcskey}\\\'] for nax in range(1, self.naxis + 1)]\\n1121.             if any(not ctyp.endswith(\\\'-SIP\\\') for ctyp in ctype):\\n1122.                 message = """\\n1123.                 Inconsistent SIP distortion information is present in the FITS header and the WCS object:\\n1124.                 SIP coefficients were detected, but CTYPE is missing a "-SIP" suffix.\\n1125.                 astropy.wcs is using the SIP distortion coefficients,\\n1126.                 therefore the coordinates calculated here might be incorrect.\\n1127. \\n1128.                 If you do not want to apply the SIP distortion coefficients,\\n1129.                 please remove the SIP coefficients from the FITS header or the\\n1130.                 WCS object.  As an example, if the image is already distortion-corrected\\n1131.                 (e.g., drizzled) then distortion components should not apply and the SIP\\n1132.                 coefficients should be removed.\\n1133. \\n1134.                 While the SIP distortion coefficients are being applied here, if that was indeed the intent,\\n1135.                 for consistency please append "-SIP" to the CTYPE in the FITS header or the WCS object.\\n1136. \\n1137.                 """  # noqa: E501\\n1138.                 log.info(message)\\n1139.         elif "B_ORDER" in header and header[\\\'B_ORDER\\\'] > 1:\\n1140.             raise ValueError(\\n1141.                 "B_ORDER provided without corresponding A_ORDER " +\\n1142.                 "keyword for SIP distortion")\\n1143.         else:\\n1144.             a = None\\n1145.             b = None\\n1146. \\n1147.         if "AP_ORDER" in header and header[\\\'AP_ORDER\\\'] > 1:\\n1148.             if "BP_ORDER" not in header:\\n1149.                 raise ValueError(\\n1150.                     "AP_ORDER provided without corresponding BP_ORDER "\\n1151.                     "keyword for SIP distortion")\\n1152. \\n1153.             m = int(header["AP_ORDER"])\\n1154.             ap = np.zeros((m + 1, m + 1), np.double)\\n1155.             for i in range(m + 1):\\n1156.                 for j in range(m - i + 1):\\n1157.                     key = f"AP_{i}_{j}"\\n1158.                     if key in header:\\n1159.                         ap[i, j] = header[key]\\n1160.                         del header[key]\\n1161. \\n1162.             m = int(header["BP_ORDER"])\\n1163.             if m > 1:\\n1164.                 bp = np.zeros((m + 1, m + 1), np.double)\\n1165.                 for i in range(m + 1):\\n1166.                     for j in range(m - i + 1):\\n1167.                         key = f"BP_{i}_{j}"\\n1168.                         if key in header:\\n1169.                             bp[i, j] = header[key]\\n1170.                             del header[key]\\n1171.             else:\\n1172.                 ap = None\\n1173.                 bp = None\\n1174. \\n1175.             del header[\\\'AP_ORDER\\\']\\n1176.             del header[\\\'BP_ORDER\\\']\\n1177.         elif "BP_ORDER" in header and header[\\\'BP_ORDER\\\'] > 1:\\n1178.             raise ValueError(\\n1179.                 "BP_ORDER provided without corresponding AP_ORDER "\\n1180.                 "keyword for SIP distortion")\\n1181.         else:\\n1182.             ap = None\\n1183.             bp = None\\n1184. \\n1185.         if a is None and b is None and ap is None and bp is None:\\n1186.             return None\\n1187. \\n1188.         if f"CRPIX1{wcskey}" not in header or f"CRPIX2{wcskey}" not in header:\\n1189.             raise ValueError(\\n1190.                 "Header has SIP keywords without CRPIX keywords")\\n1191. \\n1192.         crpix1 = header.get(f"CRPIX1{wcskey}")\\n1193.         crpix2 = header.get(f"CRPIX2{wcskey}")\\n1194. \\n1195.         return Sip(a, b, ap, bp, (crpix1, crpix2))\\n1196. \\n1197.     def _write_sip_kw(self):\\n1198.         """\\n1199.         Write out SIP keywords.  Returns a dictionary of key-value\\n1200.         pairs.\\n1201.         """\\n1202.         if self.sip is None:\\n1203.             return {}\\n1204. \\n1205.         keywords = {}\\n1206. \\n1207.         def write_array(name, a):\\n1208.             if a is None:\\n1209.                 return\\n1210.             size = a.shape[0]\\n1211.             trdir = \\\'sky to detector\\\' if name[-1] == \\\'P\\\' else \\\'detector to sky\\\'\\n1212.             comment = (\\\'SIP polynomial order, axis {:d}, {:s}\\\'\\n1213.                        .format(ord(name[0]) - ord(\\\'A\\\'), trdir))\\n1214.             keywords[f\\\'{name}_ORDER\\\'] = size - 1, comment\\n1215. \\n1216.             comment = \\\'SIP distortion coefficient\\\'\\n1217.             for i in range(size):\\n1218.                 for j in range(size - i):\\n1219.                     if a[i, j] != 0.0:\\n1220.                         keywords[\\n1221.                             f\\\'{name}_{i:d}_{j:d}\\\'] = a[i, j], comment\\n1222. \\n1223.         write_array(\\\'A\\\', self.sip.a)\\n1224.         write_array(\\\'B\\\', self.sip.b)\\n1225.         write_array(\\\'AP\\\', self.sip.ap)\\n1226.         write_array(\\\'BP\\\', self.sip.bp)\\n1227. \\n1228.         return keywords\\n1229. \\n1230.     def _denormalize_sky(self, sky):\\n1231.         if self.wcs.lngtyp != \\\'RA\\\':\\n1232.             raise ValueError(\\n1233.                 "WCS does not have longitude type of \\\'RA\\\', therefore " +\\n1234.                 "(ra, dec) data can not be used as input")\\n1235.         if self.wcs.lattyp != \\\'DEC\\\':\\n1236.             raise ValueError(\\n1237.                 "WCS does not have longitude type of \\\'DEC\\\', therefore " +\\n1238.                 "(ra, dec) data can not be used as input")\\n1239.         if self.wcs.naxis == 2:\\n1240.             if self.wcs.lng == 0 and self.wcs.lat == 1:\\n1241.                 return sky\\n1242.             elif self.wcs.lng == 1 and self.wcs.lat == 0:\\n1243.                 # Reverse the order of the columns\\n1244.                 return sky[:, ::-1]\\n1245.             else:\\n1246.                 raise ValueError(\\n1247.                     "WCS does not have longitude and latitude celestial " +\\n1248.                     "axes, therefore (ra, dec) data can not be used as input")\\n1249.         else:\\n1250.             if self.wcs.lng < 0 or self.wcs.lat < 0:\\n1251.                 raise ValueError(\\n1252.                     "WCS does not have both longitude and latitude "\\n1253.                     "celestial axes, therefore (ra, dec) data can not be " +\\n1254.                     "used as input")\\n1255.             out = np.zeros((sky.shape[0], self.wcs.naxis))\\n1256.             out[:, self.wcs.lng] = sky[:, 0]\\n1257.             out[:, self.wcs.lat] = sky[:, 1]\\n1258.             return out\\n1259. \\n1260.     def _normalize_sky(self, sky):\\n1261.         if self.wcs.lngtyp != \\\'RA\\\':\\n1262.             raise ValueError(\\n1263.                 "WCS does not have longitude type of \\\'RA\\\', therefore " +\\n1264.                 "(ra, dec) data can not be returned")\\n1265.         if self.wcs.lattyp != \\\'DEC\\\':\\n1266.             raise ValueError(\\n1267.                 "WCS does not have longitude type of \\\'DEC\\\', therefore " +\\n1268.                 "(ra, dec) data can not be returned")\\n1269.         if self.wcs.naxis == 2:\\n1270.             if self.wcs.lng == 0 and self.wcs.lat == 1:\\n1271.                 return sky\\n1272.             elif self.wcs.lng == 1 and self.wcs.lat == 0:\\n1273.                 # Reverse the order of the columns\\n1274.                 return sky[:, ::-1]\\n1275.             else:\\n1276.                 raise ValueError(\\n1277.                     "WCS does not have longitude and latitude celestial "\\n1278.                     "axes, therefore (ra, dec) data can not be returned")\\n1279.         else:\\n1280.             if self.wcs.lng < 0 or self.wcs.lat < 0:\\n1281.                 raise ValueError(\\n1282.                     "WCS does not have both longitude and latitude celestial "\\n1283.                     "axes, therefore (ra, dec) data can not be returned")\\n1284.             out = np.empty((sky.shape[0], 2))\\n1285.             out[:, 0] = sky[:, self.wcs.lng]\\n1286.             out[:, 1] = sky[:, self.wcs.lat]\\n1287.             return out\\n1288. \\n1289.     def _array_converter(self, func, sky, *args, ra_dec_order=False):\\n1290.         """\\n1291.         A helper function to support reading either a pair of arrays\\n1292.         or a single Nx2 array.\\n1293.         """\\n1294. \\n1295.         def _return_list_of_arrays(axes, origin):\\n1296.             if any([x.size == 0 for x in axes]):\\n1297.                 return axes\\n1298. \\n1299.             try:\\n1300.                 axes = np.broadcast_arrays(*axes)\\n1301.             except ValueError:\\n1302.                 raise ValueError(\\n1303.                     "Coordinate arrays are not broadcastable to each other")\\n1304. \\n1305.             xy = np.hstack([x.reshape((x.size, 1)) for x in axes])\\n1306. \\n1307.             if ra_dec_order and sky == \\\'input\\\':\\n1308.                 xy = self._denormalize_sky(xy)\\n1309.             output = func(xy, origin)\\n1310.             if ra_dec_order and sky == \\\'output\\\':\\n1311.                 output = self._normalize_sky(output)\\n1312.                 return (output[:, 0].reshape(axes[0].shape),\\n1313.                         output[:, 1].reshape(axes[0].shape))\\n1314.             return [output[:, i].reshape(axes[0].shape)\\n1315.                     for i in range(output.shape[1])]\\n1316. \\n1317.         def _return_single_array(xy, origin):\\n1318.             if xy.shape[-1] != self.naxis:\\n1319.                 raise ValueError(\\n1320.                     "When providing two arguments, the array must be "\\n1321.                     "of shape (N, {})".format(self.naxis))\\n1322.             if 0 in xy.shape:\\n1323.                 return xy\\n1324.             if ra_dec_order and sky == \\\'input\\\':\\n1325.                 xy = self._denormalize_sky(xy)\\n1326.             result = func(xy, origin)\\n1327.             if ra_dec_order and sky == \\\'output\\\':\\n1328.                 result = self._normalize_sky(result)\\n1329.             return result\\n1330. \\n1331.         if len(args) == 2:\\n1332.             try:\\n1333.                 xy, origin = args\\n1334.                 xy = np.asarray(xy)\\n1335.                 origin = int(origin)\\n1336.             except Exception:\\n1337.                 raise TypeError(\\n1338.                     "When providing two arguments, they must be "\\n1339.                     "(coords[N][{}], origin)".format(self.naxis))\\n1340.             if xy.shape == () or len(xy.shape) == 1:\\n1341.                 return _return_list_of_arrays([xy], origin)\\n1342.             return _return_single_array(xy, origin)\\n1343. \\n1344.         elif len(args) == self.naxis + 1:\\n1345.             axes = args[:-1]\\n1346.             origin = args[-1]\\n1347.             try:\\n1348.                 axes = [np.asarray(x) for x in axes]\\n1349.                 origin = int(origin)\\n1350.             except Exception:\\n1351.                 raise TypeError(\\n1352.                     "When providing more than two arguments, they must be " +\\n1353.                     "a 1-D array for each axis, followed by an origin.")\\n1354. \\n1355.             return _return_list_of_arrays(axes, origin)\\n1356. \\n1357.         raise TypeError(\\n1358.             "WCS projection has {0} dimensions, so expected 2 (an Nx{0} array "\\n1359.             "and the origin argument) or {1} arguments (the position in each "\\n1360.             "dimension, and the origin argument). Instead, {2} arguments were "\\n1361.             "given.".format(\\n1362.                 self.naxis, self.naxis + 1, len(args)))\\n1363. \\n1364.     def all_pix2world(self, *args, **kwargs):\\n1365.         return self._array_converter(\\n1366.             self._all_pix2world, \\\'output\\\', *args, **kwargs)\\n1367.     all_pix2world.__doc__ = """\\n1368.         Transforms pixel coordinates to world coordinates.\\n1369. \\n1370.         Performs all of the following in series:\\n1371. \\n1372.             - Detector to image plane correction (if present in the\\n1373.               FITS file)\\n1374. \\n1375.             - `SIP`_ distortion correction (if present in the FITS\\n1376.               file)\\n1377. \\n1378.             - `distortion paper`_ table-lookup correction (if present\\n1379.               in the FITS file)\\n1380. \\n1381.             - `wcslib`_ "core" WCS transformation\\n1382. \\n1383.         Parameters\\n1384.         ----------\\n1385.         {}\\n1386. \\n1387.             For a transformation that is not two-dimensional, the\\n1388.             two-argument form must be used.\\n1389. \\n1390.         {}\\n1391. \\n1392.         Returns\\n1393.         -------\\n1394. \\n1395.         {}\\n1396. \\n1397.         Notes\\n1398.         -----\\n1399.         The order of the axes for the result is determined by the\\n1400.         ``CTYPEia`` keywords in the FITS header, therefore it may not\\n1401.         always be of the form (*ra*, *dec*).  The\\n1402.         `~astropy.wcs.Wcsprm.lat`, `~astropy.wcs.Wcsprm.lng`,\\n1403.         `~astropy.wcs.Wcsprm.lattyp` and `~astropy.wcs.Wcsprm.lngtyp`\\n1404.         members can be used to determine the order of the axes.\\n1405. \\n1406.         Raises\\n1407.         ------\\n1408.         MemoryError\\n1409.             Memory allocation failed.\\n1410. \\n1411.         SingularMatrixError\\n1412.             Linear transformation matrix is singular.\\n1413. \\n1414.         InconsistentAxisTypesError\\n1415.             Inconsistent or unrecognized coordinate axis types.\\n1416. \\n1417.         ValueError\\n1418.             Invalid parameter value.\\n1419. \\n1420.         ValueError\\n1421.             Invalid coordinate transformation parameters.\\n1422. \\n1423.         ValueError\\n1424.             x- and y-coordinate arrays are not the same size.\\n1425. \\n1426.         InvalidTransformError\\n1427.             Invalid coordinate transformation parameters.\\n1428. \\n1429.         InvalidTransformError\\n1430.             Ill-conditioned coordinate transformation parameters.\\n1431.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'naxis\\\', 8),\\n1432.                    docstrings.RA_DEC_ORDER(8),\\n1433.                    docstrings.RETURNS(\\\'sky coordinates, in degrees\\\', 8))\\n1434. \\n1435.     def wcs_pix2world(self, *args, **kwargs):\\n1436.         if self.wcs is None:\\n1437.             raise ValueError("No basic WCS settings were created.")\\n1438.         return self._array_converter(\\n1439.             lambda xy, o: self.wcs.p2s(xy, o)[\\\'world\\\'],\\n1440.             \\\'output\\\', *args, **kwargs)\\n1441.     wcs_pix2world.__doc__ = """\\n1442.         Transforms pixel coordinates to world coordinates by doing\\n1443.         only the basic `wcslib`_ transformation.\\n1444. \\n1445.         No `SIP`_ or `distortion paper`_ table lookup correction is\\n1446.         applied.  To perform distortion correction, see\\n1447.         `~astropy.wcs.WCS.all_pix2world`,\\n1448.         `~astropy.wcs.WCS.sip_pix2foc`, `~astropy.wcs.WCS.p4_pix2foc`,\\n1449.         or `~astropy.wcs.WCS.pix2foc`.\\n1450. \\n1451.         Parameters\\n1452.         ----------\\n1453.         {}\\n1454. \\n1455.             For a transformation that is not two-dimensional, the\\n1456.             two-argument form must be used.\\n1457. \\n1458.         {}\\n1459. \\n1460.         Returns\\n1461.         -------\\n1462. \\n1463.         {}\\n1464. \\n1465.         Raises\\n1466.         ------\\n1467.         MemoryError\\n1468.             Memory allocation failed.\\n1469. \\n1470.         SingularMatrixError\\n1471.             Linear transformation matrix is singular.\\n1472. \\n1473.         InconsistentAxisTypesError\\n1474.             Inconsistent or unrecognized coordinate axis types.\\n1475. \\n1476.         ValueError\\n1477.             Invalid parameter value.\\n1478. \\n1479.         ValueError\\n1480.             Invalid coordinate transformation parameters.\\n1481. \\n1482.         ValueError\\n1483.             x- and y-coordinate arrays are not the same size.\\n1484. \\n1485.         InvalidTransformError\\n1486.             Invalid coordinate transformation parameters.\\n1487. \\n1488.         InvalidTransformError\\n1489.             Ill-conditioned coordinate transformation parameters.\\n1490. \\n1491.         Notes\\n1492.         -----\\n1493.         The order of the axes for the result is determined by the\\n1494.         ``CTYPEia`` keywords in the FITS header, therefore it may not\\n1495.         always be of the form (*ra*, *dec*).  The\\n1496.         `~astropy.wcs.Wcsprm.lat`, `~astropy.wcs.Wcsprm.lng`,\\n1497.         `~astropy.wcs.Wcsprm.lattyp` and `~astropy.wcs.Wcsprm.lngtyp`\\n1498.         members can be used to determine the order of the axes.\\n1499. \\n1500.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'naxis\\\', 8),\\n1501.                    docstrings.RA_DEC_ORDER(8),\\n1502.                    docstrings.RETURNS(\\\'world coordinates, in degrees\\\', 8))\\n1503. \\n1504.     def _all_world2pix(self, world, origin, tolerance, maxiter, adaptive,\\n1505.                        detect_divergence, quiet):\\n1506.         # ############################################################\\n1507.         # #          DESCRIPTION OF THE NUMERICAL METHOD            ##\\n1508.         # ############################################################\\n1509.         # In this section I will outline the method of solving\\n1510.         # the inverse problem of converting world coordinates to\\n1511.         # pixel coordinates (*inverse* of the direct transformation\\n1512.         # `all_pix2world`) and I will summarize some of the aspects\\n1513.         # of the method proposed here and some of the issues of the\\n1514.         # original `all_world2pix` (in relation to this method)\\n1515.         # discussed in https://github.com/astropy/astropy/issues/1977\\n1516.         # A more detailed discussion can be found here:\\n1517.         # https://github.com/astropy/astropy/pull/2373\\n1518.         #\\n1519.         #\\n1520.         #                  ### Background ###\\n1521.         #\\n1522.         #\\n1523.         # I will refer here to the [SIP Paper]\\n1524.         # (http://fits.gsfc.nasa.gov/registry/sip/SIP_distortion_v1_0.pdf).\\n1525.         # According to this paper, the effect of distortions as\\n1526.         # described in *their* equation (1) is:\\n1527.         #\\n1528.         # (1)   x = CD*(u+f(u)),\\n1529.         #\\n1530.         # where `x` is a *vector* of "intermediate spherical\\n1531.         # coordinates" (equivalent to (x,y) in the paper) and `u`\\n1532.         # is a *vector* of "pixel coordinates", and `f` is a vector\\n1533.         # function describing geometrical distortions\\n1534.         # (see equations 2 and 3 in SIP Paper.\\n1535.         # However, I prefer to use `w` for "intermediate world\\n1536.         # coordinates", `x` for pixel coordinates, and assume that\\n1537.         # transformation `W` performs the **linear**\\n1538.         # (CD matrix + projection onto celestial sphere) part of the\\n1539.         # conversion from pixel coordinates to world coordinates.\\n1540.         # Then we can re-write (1) as:\\n1541.         #\\n1542.         # (2)   w = W*(x+f(x)) = T(x)\\n1543.         #\\n1544.         # In `astropy.wcs.WCS` transformation `W` is represented by\\n1545.         # the `wcs_pix2world` member, while the combined ("total")\\n1546.         # transformation (linear part + distortions) is performed by\\n1547.         # `all_pix2world`. Below I summarize the notations and their\\n1548.         # equivalents in `astropy.wcs.WCS`:\\n1549.         #\\n1550.         # | Equation term | astropy.WCS/meaning          |\\n1551.         # | ------------- | ---------------------------- |\\n1552.         # | `x`           | pixel coordinates            |\\n1553.         # | `w`           | world coordinates            |\\n1554.         # | `W`           | `wcs_pix2world()`            |\\n1555.         # | `W^{-1}`      | `wcs_world2pix()`            |\\n1556.         # | `T`           | `all_pix2world()`            |\\n1557.         # | `x+f(x)`      | `pix2foc()`                  |\\n1558.         #\\n1559.         #\\n1560.         #      ### Direct Solving of Equation (2)  ###\\n1561.         #\\n1562.         #\\n1563.         # In order to find the pixel coordinates that correspond to\\n1564.         # given world coordinates `w`, it is necessary to invert\\n1565.         # equation (2): `x=T^{-1}(w)`, or solve equation `w==T(x)`\\n1566.         # for `x`. However, this approach has the following\\n1567.         # disadvantages:\\n1568.         #    1. It requires unnecessary transformations (see next\\n1569.         #       section).\\n1570.         #    2. It is prone to "RA wrapping" issues as described in\\n1571.         # https://github.com/astropy/astropy/issues/1977\\n1572.         # (essentially because `all_pix2world` may return points with\\n1573.         # a different phase than user\\\'s input `w`).\\n1574.         #\\n1575.         #\\n1576.         #      ### Description of the Method Used here ###\\n1577.         #\\n1578.         #\\n1579.         # By applying inverse linear WCS transformation (`W^{-1}`)\\n1580.         # to both sides of equation (2) and introducing notation `x\\\'`\\n1581.         # (prime) for the pixels coordinates obtained from the world\\n1582.         # coordinates by applying inverse *linear* WCS transformation\\n1583.         # ("focal plane coordinates"):\\n1584.         #\\n1585.         # (3)   x\\\' = W^{-1}(w)\\n1586.         #\\n1587.         # we obtain the following equation:\\n1588.         #\\n1589.         # (4)   x\\\' = x+f(x),\\n1590.         #\\n1591.         # or,\\n1592.         #\\n1593.         # (5)   x = x\\\'-f(x)\\n1594.         #\\n1595.         # This equation is well suited for solving using the method\\n1596.         # of fixed-point iterations\\n1597.         # (http://en.wikipedia.org/wiki/Fixed-point_iteration):\\n1598.         #\\n1599.         # (6)   x_{i+1} = x\\\'-f(x_i)\\n1600.         #\\n1601.         # As an initial value of the pixel coordinate `x_0` we take\\n1602.         # "focal plane coordinate" `x\\\'=W^{-1}(w)=wcs_world2pix(w)`.\\n1603.         # We stop iterations when `|x_{i+1}-x_i|<tolerance`. We also\\n1604.         # consider the process to be diverging if\\n1605.         # `|x_{i+1}-x_i|>|x_i-x_{i-1}|`\\n1606.         # **when** `|x_{i+1}-x_i|>=tolerance` (when current\\n1607.         # approximation is close to the true solution,\\n1608.         # `|x_{i+1}-x_i|>|x_i-x_{i-1}|` may be due to rounding errors\\n1609.         # and we ignore such "divergences" when\\n1610.         # `|x_{i+1}-x_i|<tolerance`). It may appear that checking for\\n1611.         # `|x_{i+1}-x_i|<tolerance` in order to ignore divergence is\\n1612.         # unnecessary since the iterative process should stop anyway,\\n1613.         # however, the proposed implementation of this iterative\\n1614.         # process is completely vectorized and, therefore, we may\\n1615.         # continue iterating over *some* points even though they have\\n1616.         # converged to within a specified tolerance (while iterating\\n1617.         # over other points that have not yet converged to\\n1618.         # a solution).\\n1619.         #\\n1620.         # In order to efficiently implement iterative process (6)\\n1621.         # using available methods in `astropy.wcs.WCS`, we add and\\n1622.         # subtract `x_i` from the right side of equation (6):\\n1623.         #\\n1624.         # (7)   x_{i+1} = x\\\'-(x_i+f(x_i))+x_i = x\\\'-pix2foc(x_i)+x_i,\\n1625.         #\\n1626.         # where `x\\\'=wcs_world2pix(w)` and it is computed only *once*\\n1627.         # before the beginning of the iterative process (and we also\\n1628.         # set `x_0=x\\\'`). By using `pix2foc` at each iteration instead\\n1629.         # of `all_pix2world` we get about 25% increase in performance\\n1630.         # (by not performing the linear `W` transformation at each\\n1631.         # step) and we also avoid the "RA wrapping" issue described\\n1632.         # above (by working in focal plane coordinates and avoiding\\n1633.         # pix->world transformations).\\n1634.         #\\n1635.         # As an added benefit, the process converges to the correct\\n1636.         # solution in just one iteration when distortions are not\\n1637.         # present (compare to\\n1638.         # https://github.com/astropy/astropy/issues/1977 and\\n1639.         # https://github.com/astropy/astropy/pull/2294): in this case\\n1640.         # `pix2foc` is the identical transformation\\n1641.         # `x_i=pix2foc(x_i)` and from equation (7) we get:\\n1642.         #\\n1643.         # x\\\' = x_0 = wcs_world2pix(w)\\n1644.         # x_1 = x\\\' - pix2foc(x_0) + x_0 = x\\\' - pix2foc(x\\\') + x\\\' = x\\\'\\n1645.         #     = wcs_world2pix(w) = x_0\\n1646.         # =>\\n1647.         # |x_1-x_0| = 0 < tolerance (with tolerance > 0)\\n1648.         #\\n1649.         # However, for performance reasons, it is still better to\\n1650.         # avoid iterations altogether and return the exact linear\\n1651.         # solution (`wcs_world2pix`) right-away when non-linear\\n1652.         # distortions are not present by checking that attributes\\n1653.         # `sip`, `cpdis1`, `cpdis2`, `det2im1`, and `det2im2` are\\n1654.         # *all* `None`.\\n1655.         #\\n1656.         #\\n1657.         #         ### Outline of the Algorithm ###\\n1658.         #\\n1659.         #\\n1660.         # While the proposed code is relatively long (considering\\n1661.         # the simplicity of the algorithm), this is due to: 1)\\n1662.         # checking if iterative solution is necessary at all; 2)\\n1663.         # checking for divergence; 3) re-implementation of the\\n1664.         # completely vectorized algorithm as an "adaptive" vectorized\\n1665.         # algorithm (for cases when some points diverge for which we\\n1666.         # want to stop iterations). In my tests, the adaptive version\\n1667.         # of the algorithm is about 50% slower than non-adaptive\\n1668.         # version for all HST images.\\n1669.         #\\n1670.         # The essential part of the vectorized non-adaptive algorithm\\n1671.         # (without divergence and other checks) can be described\\n1672.         # as follows:\\n1673.         #\\n1674.         #     pix0 = self.wcs_world2pix(world, origin)\\n1675.         #     pix  = pix0.copy() # 0-order solution\\n1676.         #\\n1677.         #     for k in range(maxiter):\\n1678.         #         # find correction to the previous solution:\\n1679.         #         dpix = self.pix2foc(pix, origin) - pix0\\n1680.         #\\n1681.         #         # compute norm (L2) of the correction:\\n1682.         #         dn = np.linalg.norm(dpix, axis=1)\\n1683.         #\\n1684.         #         # apply correction:\\n1685.         #         pix -= dpix\\n1686.         #\\n1687.         #         # check convergence:\\n1688.         #         if np.max(dn) < tolerance:\\n1689.         #             break\\n1690.         #\\n1691.         #    return pix\\n1692.         #\\n1693.         # Here, the input parameter `world` can be a `MxN` array\\n1694.         # where `M` is the number of coordinate axes in WCS and `N`\\n1695.         # is the number of points to be converted simultaneously to\\n1696.         # image coordinates.\\n1697.         #\\n1698.         #\\n1699.         #                ###  IMPORTANT NOTE:  ###\\n1700.         #\\n1701.         # If, in the future releases of the `~astropy.wcs`,\\n1702.         # `pix2foc` will not apply all the required distortion\\n1703.         # corrections then in the code below, calls to `pix2foc` will\\n1704.         # have to be replaced with\\n1705.         # wcs_world2pix(all_pix2world(pix_list, origin), origin)\\n1706.         #\\n1707. \\n1708.         # ############################################################\\n1709.         # #            INITIALIZE ITERATIVE PROCESS:                ##\\n1710.         # ############################################################\\n1711. \\n1712.         # initial approximation (linear WCS based only)\\n1713.         pix0 = self.wcs_world2pix(world, origin)\\n1714. \\n1715.         # Check that an iterative solution is required at all\\n1716.         # (when any of the non-CD-matrix-based corrections are\\n1717.         # present). If not required return the initial\\n1718.         # approximation (pix0).\\n1719.         if not self.has_distortion:\\n1720.             # No non-WCS corrections detected so\\n1721.             # simply return initial approximation:\\n1722.             return pix0\\n1723. \\n1724.         pix = pix0.copy()  # 0-order solution\\n1725. \\n1726.         # initial correction:\\n1727.         dpix = self.pix2foc(pix, origin) - pix0\\n1728. \\n1729.         # Update initial solution:\\n1730.         pix -= dpix\\n1731. \\n1732.         # Norm (L2) squared of the correction:\\n1733.         dn = np.sum(dpix*dpix, axis=1)\\n1734.         dnprev = dn.copy()  # if adaptive else dn\\n1735.         tol2 = tolerance**2\\n1736. \\n1737.         # Prepare for iterative process\\n1738.         k = 1\\n1739.         ind = None\\n1740.         inddiv = None\\n1741. \\n1742.         # Turn off numpy runtime warnings for \\\'invalid\\\' and \\\'over\\\':\\n1743.         old_invalid = np.geterr()[\\\'invalid\\\']\\n1744.         old_over = np.geterr()[\\\'over\\\']\\n1745.         np.seterr(invalid=\\\'ignore\\\', over=\\\'ignore\\\')\\n1746. \\n1747.         # ############################################################\\n1748.         # #                NON-ADAPTIVE ITERATIONS:                 ##\\n1749.         # ############################################################\\n1750.         if not adaptive:\\n1751.             # Fixed-point iterations:\\n1752.             while (np.nanmax(dn) >= tol2 and k < maxiter):\\n1753.                 # Find correction to the previous solution:\\n1754.                 dpix = self.pix2foc(pix, origin) - pix0\\n1755. \\n1756.                 # Compute norm (L2) squared of the correction:\\n1757.                 dn = np.sum(dpix*dpix, axis=1)\\n1758. \\n1759.                 # Check for divergence (we do this in two stages\\n1760.                 # to optimize performance for the most common\\n1761.                 # scenario when successive approximations converge):\\n1762.                 if detect_divergence:\\n1763.                     divergent = (dn >= dnprev)\\n1764.                     if np.any(divergent):\\n1765.                         # Find solutions that have not yet converged:\\n1766.                         slowconv = (dn >= tol2)\\n1767.                         inddiv, = np.where(divergent & slowconv)\\n1768. \\n1769.                         if inddiv.shape[0] > 0:\\n1770.                             # Update indices of elements that\\n1771.                             # still need correction:\\n1772.                             conv = (dn < dnprev)\\n1773.                             iconv = np.where(conv)\\n1774. \\n1775.                             # Apply correction:\\n1776.                             dpixgood = dpix[iconv]\\n1777.                             pix[iconv] -= dpixgood\\n1778.                             dpix[iconv] = dpixgood\\n1779. \\n1780.                             # For the next iteration choose\\n1781.                             # non-divergent points that have not yet\\n1782.                             # converged to the requested accuracy:\\n1783.                             ind, = np.where(slowconv & conv)\\n1784.                             pix0 = pix0[ind]\\n1785.                             dnprev[ind] = dn[ind]\\n1786.                             k += 1\\n1787. \\n1788.                             # Switch to adaptive iterations:\\n1789.                             adaptive = True\\n1790.                             break\\n1791.                     # Save current correction magnitudes for later:\\n1792.                     dnprev = dn\\n1793. \\n1794.                 # Apply correction:\\n1795.                 pix -= dpix\\n1796.                 k += 1\\n1797. \\n1798.         # ############################################################\\n1799.         # #                  ADAPTIVE ITERATIONS:                   ##\\n1800.         # ############################################################\\n1801.         if adaptive:\\n1802.             if ind is None:\\n1803.                 ind, = np.where(np.isfinite(pix).all(axis=1))\\n1804.                 pix0 = pix0[ind]\\n1805. \\n1806.             # "Adaptive" fixed-point iterations:\\n1807.             while (ind.shape[0] > 0 and k < maxiter):\\n1808.                 # Find correction to the previous solution:\\n1809.                 dpixnew = self.pix2foc(pix[ind], origin) - pix0\\n1810. \\n1811.                 # Compute norm (L2) of the correction:\\n1812.                 dnnew = np.sum(np.square(dpixnew), axis=1)\\n1813. \\n1814.                 # Bookkeeping of corrections:\\n1815.                 dnprev[ind] = dn[ind].copy()\\n1816.                 dn[ind] = dnnew\\n1817. \\n1818.                 if detect_divergence:\\n1819.                     # Find indices of pixels that are converging:\\n1820.                     conv = (dnnew < dnprev[ind])\\n1821.                     iconv = np.where(conv)\\n1822.                     iiconv = ind[iconv]\\n1823. \\n1824.                     # Apply correction:\\n1825.                     dpixgood = dpixnew[iconv]\\n1826.                     pix[iiconv] -= dpixgood\\n1827.                     dpix[iiconv] = dpixgood\\n1828. \\n1829.                     # Find indices of solutions that have not yet\\n1830.                     # converged to the requested accuracy\\n1831.                     # AND that do not diverge:\\n1832.                     subind, = np.where((dnnew >= tol2) & conv)\\n1833. \\n1834.                 else:\\n1835.                     # Apply correction:\\n1836.                     pix[ind] -= dpixnew\\n1837.                     dpix[ind] = dpixnew\\n1838. \\n1839.                     # Find indices of solutions that have not yet\\n1840.                     # converged to the requested accuracy:\\n1841.                     subind, = np.where(dnnew >= tol2)\\n1842. \\n1843.                 # Choose solutions that need more iterations:\\n1844.                 ind = ind[subind]\\n1845.                 pix0 = pix0[subind]\\n1846. \\n1847.                 k += 1\\n1848. \\n1849.         # ############################################################\\n1850.         # #         FINAL DETECTION OF INVALID, DIVERGING,          ##\\n1851.         # #         AND FAILED-TO-CONVERGE POINTS                   ##\\n1852.         # ############################################################\\n1853.         # Identify diverging and/or invalid points:\\n1854.         invalid = ((~np.all(np.isfinite(pix), axis=1)) &\\n1855.                    (np.all(np.isfinite(world), axis=1)))\\n1856. \\n1857.         # When detect_divergence==False, dnprev is outdated\\n1858.         # (it is the norm of the very first correction).\\n1859.         # Still better than nothing...\\n1860.         inddiv, = np.where(((dn >= tol2) & (dn >= dnprev)) | invalid)\\n1861.         if inddiv.shape[0] == 0:\\n1862.             inddiv = None\\n1863. \\n1864.         # Identify points that did not converge within \\\'maxiter\\\'\\n1865.         # iterations:\\n1866.         if k >= maxiter:\\n1867.             ind, = np.where((dn >= tol2) & (dn < dnprev) & (~invalid))\\n1868.             if ind.shape[0] == 0:\\n1869.                 ind = None\\n1870.         else:\\n1871.             ind = None\\n1872. \\n1873.         # Restore previous numpy error settings:\\n1874.         np.seterr(invalid=old_invalid, over=old_over)\\n1875. \\n1876.         # ############################################################\\n1877.         # #  RAISE EXCEPTION IF DIVERGING OR TOO SLOWLY CONVERGING  ##\\n1878.         # #  DATA POINTS HAVE BEEN DETECTED:                        ##\\n1879.         # ############################################################\\n1880.         if (ind is not None or inddiv is not None) and not quiet:\\n1881.             if inddiv is None:\\n1882.                 raise NoConvergence(\\n1883.                     "\\\'WCS.all_world2pix\\\' failed to "\\n1884.                     "converge to the requested accuracy after {:d} "\\n1885.                     "iterations.".format(k), best_solution=pix,\\n1886.                     accuracy=np.abs(dpix), niter=k,\\n1887.                     slow_conv=ind, divergent=None)\\n1888.             else:\\n1889.                 raise NoConvergence(\\n1890.                     "\\\'WCS.all_world2pix\\\' failed to "\\n1891.                     "converge to the requested accuracy.\\\\n"\\n1892.                     "After {:d} iterations, the solution is diverging "\\n1893.                     "at least for one input point."\\n1894.                     .format(k), best_solution=pix,\\n1895.                     accuracy=np.abs(dpix), niter=k,\\n1896.                     slow_conv=ind, divergent=inddiv)\\n1897. \\n1898.         return pix\\n1899. \\n1900.     @deprecated_renamed_argument(\\\'accuracy\\\', \\\'tolerance\\\', \\\'4.3\\\')\\n1901.     def all_world2pix(self, *args, tolerance=1e-4, maxiter=20, adaptive=False,\\n1902.                       detect_divergence=True, quiet=False, **kwargs):\\n1903.         if self.wcs is None:\\n1904.             raise ValueError("No basic WCS settings were created.")\\n1905. \\n1906.         return self._array_converter(\\n1907.             lambda *args, **kwargs:\\n1908.             self._all_world2pix(\\n1909.                 *args, tolerance=tolerance, maxiter=maxiter,\\n1910.                 adaptive=adaptive, detect_divergence=detect_divergence,\\n1911.                 quiet=quiet),\\n1912.             \\\'input\\\', *args, **kwargs\\n1913.         )\\n1914. \\n1915.     all_world2pix.__doc__ = """\\n1916.         all_world2pix(*arg, tolerance=1.0e-4, maxiter=20,\\n1917.         adaptive=False, detect_divergence=True, quiet=False)\\n1918. \\n1919.         Transforms world coordinates to pixel coordinates, using\\n1920.         numerical iteration to invert the full forward transformation\\n1921.         `~astropy.wcs.WCS.all_pix2world` with complete\\n1922.         distortion model.\\n1923. \\n1924. \\n1925.         Parameters\\n1926.         ----------\\n1927.         {0}\\n1928. \\n1929.             For a transformation that is not two-dimensional, the\\n1930.             two-argument form must be used.\\n1931. \\n1932.         {1}\\n1933. \\n1934.         tolerance : float, optional (default = 1.0e-4)\\n1935.             Tolerance of solution. Iteration terminates when the\\n1936.             iterative solver estimates that the "true solution" is\\n1937.             within this many pixels current estimate, more\\n1938.             specifically, when the correction to the solution found\\n1939.             during the previous iteration is smaller\\n1940.             (in the sense of the L2 norm) than ``tolerance``.\\n1941. \\n1942.         maxiter : int, optional (default = 20)\\n1943.             Maximum number of iterations allowed to reach a solution.\\n1944. \\n1945.         quiet : bool, optional (default = False)\\n1946.             Do not throw :py:class:`NoConvergence` exceptions when\\n1947.             the method does not converge to a solution with the\\n1948.             required accuracy within a specified number of maximum\\n1949.             iterations set by ``maxiter`` parameter. Instead,\\n1950.             simply return the found solution.\\n1951. \\n1952.         Other Parameters\\n1953.         ----------------\\n1954.         adaptive : bool, optional (default = False)\\n1955.             Specifies whether to adaptively select only points that\\n1956.             did not converge to a solution within the required\\n1957.             accuracy for the next iteration. Default is recommended\\n1958.             for HST as well as most other instruments.\\n1959. \\n1960.             .. note::\\n1961.                The :py:meth:`all_world2pix` uses a vectorized\\n1962.                implementation of the method of consecutive\\n1963.                approximations (see ``Notes`` section below) in which it\\n1964.                iterates over *all* input points *regardless* until\\n1965.                the required accuracy has been reached for *all* input\\n1966.                points. In some cases it may be possible that\\n1967.                *almost all* points have reached the required accuracy\\n1968.                but there are only a few of input data points for\\n1969.                which additional iterations may be needed (this\\n1970.                depends mostly on the characteristics of the geometric\\n1971.                distortions for a given instrument). In this situation\\n1972.                it may be advantageous to set ``adaptive`` = `True` in\\n1973.                which case :py:meth:`all_world2pix` will continue\\n1974.                iterating *only* over the points that have not yet\\n1975.                converged to the required accuracy. However, for the\\n1976.                HST\\\'s ACS/WFC detector, which has the strongest\\n1977.                distortions of all HST instruments, testing has\\n1978.                shown that enabling this option would lead to a about\\n1979.                50-100% penalty in computational time (depending on\\n1980.                specifics of the image, geometric distortions, and\\n1981.                number of input points to be converted). Therefore,\\n1982.                for HST and possibly instruments, it is recommended\\n1983.                to set ``adaptive`` = `False`. The only danger in\\n1984.                getting this setting wrong will be a performance\\n1985.                penalty.\\n1986. \\n1987.             .. note::\\n1988.                When ``detect_divergence`` is `True`,\\n1989.                :py:meth:`all_world2pix` will automatically switch\\n1990.                to the adaptive algorithm once divergence has been\\n1991.                detected.\\n1992. \\n1993.         detect_divergence : bool, optional (default = True)\\n1994.             Specifies whether to perform a more detailed analysis\\n1995.             of the convergence to a solution. Normally\\n1996.             :py:meth:`all_world2pix` may not achieve the required\\n1997.             accuracy if either the ``tolerance`` or ``maxiter`` arguments\\n1998.             are too low. However, it may happen that for some\\n1999.             geometric distortions the conditions of convergence for\\n2000.             the the method of consecutive approximations used by\\n2001.             :py:meth:`all_world2pix` may not be satisfied, in which\\n2002.             case consecutive approximations to the solution will\\n2003.             diverge regardless of the ``tolerance`` or ``maxiter``\\n2004.             settings.\\n2005. \\n2006.             When ``detect_divergence`` is `False`, these divergent\\n2007.             points will be detected as not having achieved the\\n2008.             required accuracy (without further details). In addition,\\n2009.             if ``adaptive`` is `False` then the algorithm will not\\n2010.             know that the solution (for specific points) is diverging\\n2011.             and will continue iterating and trying to "improve"\\n2012.             diverging solutions. This may result in ``NaN`` or\\n2013.             ``Inf`` values in the return results (in addition to a\\n2014.             performance penalties). Even when ``detect_divergence``\\n2015.             is `False`, :py:meth:`all_world2pix`, at the end of the\\n2016.             iterative process, will identify invalid results\\n2017.             (``NaN`` or ``Inf``) as "diverging" solutions and will\\n2018.             raise :py:class:`NoConvergence` unless the ``quiet``\\n2019.             parameter is set to `True`.\\n2020. \\n2021.             When ``detect_divergence`` is `True`,\\n2022.             :py:meth:`all_world2pix` will detect points for which\\n2023.             current correction to the coordinates is larger than\\n2024.             the correction applied during the previous iteration\\n2025.             **if** the requested accuracy **has not yet been\\n2026.             achieved**. In this case, if ``adaptive`` is `True`,\\n2027.             these points will be excluded from further iterations and\\n2028.             if ``adaptive`` is `False`, :py:meth:`all_world2pix` will\\n2029.             automatically switch to the adaptive algorithm. Thus, the\\n2030.             reported divergent solution will be the latest converging\\n2031.             solution computed immediately *before* divergence\\n2032.             has been detected.\\n2033. \\n2034.             .. note::\\n2035.                When accuracy has been achieved, small increases in\\n2036.                current corrections may be possible due to rounding\\n2037.                errors (when ``adaptive`` is `False`) and such\\n2038.                increases will be ignored.\\n2039. \\n2040.             .. note::\\n2041.                Based on our testing using HST ACS/WFC images, setting\\n2042.                ``detect_divergence`` to `True` will incur about 5-20%\\n2043.                performance penalty with the larger penalty\\n2044.                corresponding to ``adaptive`` set to `True`.\\n2045.                Because the benefits of enabling this\\n2046.                feature outweigh the small performance penalty,\\n2047.                especially when ``adaptive`` = `False`, it is\\n2048.                recommended to set ``detect_divergence`` to `True`,\\n2049.                unless extensive testing of the distortion models for\\n2050.                images from specific instruments show a good stability\\n2051.                of the numerical method for a wide range of\\n2052.                coordinates (even outside the image itself).\\n2053. \\n2054.             .. note::\\n2055.                Indices of the diverging inverse solutions will be\\n2056.                reported in the ``divergent`` attribute of the\\n2057.                raised :py:class:`NoConvergence` exception object.\\n2058. \\n2059.         Returns\\n2060.         -------\\n2061. \\n2062.         {2}\\n2063. \\n2064.         Notes\\n2065.         -----\\n2066.         The order of the axes for the input world array is determined by\\n2067.         the ``CTYPEia`` keywords in the FITS header, therefore it may\\n2068.         not always be of the form (*ra*, *dec*).  The\\n2069.         `~astropy.wcs.Wcsprm.lat`, `~astropy.wcs.Wcsprm.lng`,\\n2070.         `~astropy.wcs.Wcsprm.lattyp`, and\\n2071.         `~astropy.wcs.Wcsprm.lngtyp`\\n2072.         members can be used to determine the order of the axes.\\n2073. \\n2074.         Using the method of fixed-point iterations approximations we\\n2075.         iterate starting with the initial approximation, which is\\n2076.         computed using the non-distortion-aware\\n2077.         :py:meth:`wcs_world2pix` (or equivalent).\\n2078. \\n2079.         The :py:meth:`all_world2pix` function uses a vectorized\\n2080.         implementation of the method of consecutive approximations and\\n2081.         therefore it is highly efficient (>30x) when *all* data points\\n2082.         that need to be converted from sky coordinates to image\\n2083.         coordinates are passed at *once*. Therefore, it is advisable,\\n2084.         whenever possible, to pass as input a long array of all points\\n2085.         that need to be converted to :py:meth:`all_world2pix` instead\\n2086.         of calling :py:meth:`all_world2pix` for each data point. Also\\n2087.         see the note to the ``adaptive`` parameter.\\n2088. \\n2089.         Raises\\n2090.         ------\\n2091.         NoConvergence\\n2092.             The method did not converge to a\\n2093.             solution to the required accuracy within a specified\\n2094.             number of maximum iterations set by the ``maxiter``\\n2095.             parameter. To turn off this exception, set ``quiet`` to\\n2096.             `True`. Indices of the points for which the requested\\n2097.             accuracy was not achieved (if any) will be listed in the\\n2098.             ``slow_conv`` attribute of the\\n2099.             raised :py:class:`NoConvergence` exception object.\\n2100. \\n2101.             See :py:class:`NoConvergence` documentation for\\n2102.             more details.\\n2103. \\n2104.         MemoryError\\n2105.             Memory allocation failed.\\n2106. \\n2107.         SingularMatrixError\\n2108.             Linear transformation matrix is singular.\\n2109. \\n2110.         InconsistentAxisTypesError\\n2111.             Inconsistent or unrecognized coordinate axis types.\\n2112. \\n2113.         ValueError\\n2114.             Invalid parameter value.\\n2115. \\n2116.         ValueError\\n2117.             Invalid coordinate transformation parameters.\\n2118. \\n2119.         ValueError\\n2120.             x- and y-coordinate arrays are not the same size.\\n2121. \\n2122.         InvalidTransformError\\n2123.             Invalid coordinate transformation parameters.\\n2124. \\n2125.         InvalidTransformError\\n2126.             Ill-conditioned coordinate transformation parameters.\\n2127. \\n2128.         Examples\\n2129.         --------\\n2130.         >>> import astropy.io.fits as fits\\n2131.         >>> import astropy.wcs as wcs\\n2132.         >>> import numpy as np\\n2133.         >>> import os\\n2134. \\n2135.         >>> filename = os.path.join(wcs.__path__[0], \\\'tests/data/j94f05bgq_flt.fits\\\')\\n2136.         >>> hdulist = fits.open(filename)\\n2137.         >>> w = wcs.WCS(hdulist[(\\\'sci\\\',1)].header, hdulist)\\n2138.         >>> hdulist.close()\\n2139. \\n2140.         >>> ra, dec = w.all_pix2world([1,2,3], [1,1,1], 1)\\n2141.         >>> print(ra)  # doctest: +FLOAT_CMP\\n2142.         [ 5.52645627  5.52649663  5.52653698]\\n2143.         >>> print(dec)  # doctest: +FLOAT_CMP\\n2144.         [-72.05171757 -72.05171276 -72.05170795]\\n2145.         >>> radec = w.all_pix2world([[1,1], [2,1], [3,1]], 1)\\n2146.         >>> print(radec)  # doctest: +FLOAT_CMP\\n2147.         [[  5.52645627 -72.05171757]\\n2148.          [  5.52649663 -72.05171276]\\n2149.          [  5.52653698 -72.05170795]]\\n2150.         >>> x, y = w.all_world2pix(ra, dec, 1)\\n2151.         >>> print(x)  # doctest: +FLOAT_CMP\\n2152.         [ 1.00000238  2.00000237  3.00000236]\\n2153.         >>> print(y)  # doctest: +FLOAT_CMP\\n2154.         [ 0.99999996  0.99999997  0.99999997]\\n2155.         >>> xy = w.all_world2pix(radec, 1)\\n2156.         >>> print(xy)  # doctest: +FLOAT_CMP\\n2157.         [[ 1.00000238  0.99999996]\\n2158.          [ 2.00000237  0.99999997]\\n2159.          [ 3.00000236  0.99999997]]\\n2160.         >>> xy = w.all_world2pix(radec, 1, maxiter=3,\\n2161.         ...                      tolerance=1.0e-10, quiet=False)\\n2162.         Traceback (most recent call last):\\n2163.         ...\\n2164.         NoConvergence: \\\'WCS.all_world2pix\\\' failed to converge to the\\n2165.         requested accuracy. After 3 iterations, the solution is\\n2166.         diverging at least for one input point.\\n2167. \\n2168.         >>> # Now try to use some diverging data:\\n2169.         >>> divradec = w.all_pix2world([[1.0, 1.0],\\n2170.         ...                             [10000.0, 50000.0],\\n2171.         ...                             [3.0, 1.0]], 1)\\n2172.         >>> print(divradec)  # doctest: +FLOAT_CMP\\n2173.         [[  5.52645627 -72.05171757]\\n2174.          [  7.15976932 -70.8140779 ]\\n2175.          [  5.52653698 -72.05170795]]\\n2176. \\n2177.         >>> # First, turn detect_divergence on:\\n2178.         >>> try:  # doctest: +FLOAT_CMP\\n2179.         ...   xy = w.all_world2pix(divradec, 1, maxiter=20,\\n2180.         ...                        tolerance=1.0e-4, adaptive=False,\\n2181.         ...                        detect_divergence=True,\\n2182.         ...                        quiet=False)\\n2183.         ... except wcs.wcs.NoConvergence as e:\\n2184.         ...   print("Indices of diverging points: {{0}}"\\n2185.         ...         .format(e.divergent))\\n2186.         ...   print("Indices of poorly converging points: {{0}}"\\n2187.         ...         .format(e.slow_conv))\\n2188.         ...   print("Best solution:\\\\\\\\n{{0}}".format(e.best_solution))\\n2189.         ...   print("Achieved accuracy:\\\\\\\\n{{0}}".format(e.accuracy))\\n2190.         Indices of diverging points: [1]\\n2191.         Indices of poorly converging points: None\\n2192.         Best solution:\\n2193.         [[  1.00000238e+00   9.99999965e-01]\\n2194.          [ -1.99441636e+06   1.44309097e+06]\\n2195.          [  3.00000236e+00   9.99999966e-01]]\\n2196.         Achieved accuracy:\\n2197.         [[  6.13968380e-05   8.59638593e-07]\\n2198.          [  8.59526812e+11   6.61713548e+11]\\n2199.          [  6.09398446e-05   8.38759724e-07]]\\n2200.         >>> raise e\\n2201.         Traceback (most recent call last):\\n2202.         ...\\n2203.         NoConvergence: \\\'WCS.all_world2pix\\\' failed to converge to the\\n2204.         requested accuracy.  After 5 iterations, the solution is\\n2205.         diverging at least for one input point.\\n2206. \\n2207.         >>> # This time turn detect_divergence off:\\n2208.         >>> try:  # doctest: +FLOAT_CMP\\n2209.         ...   xy = w.all_world2pix(divradec, 1, maxiter=20,\\n2210.         ...                        tolerance=1.0e-4, adaptive=False,\\n2211.         ...                        detect_divergence=False,\\n2212.         ...                        quiet=False)\\n2213.         ... except wcs.wcs.NoConvergence as e:\\n2214.         ...   print("Indices of diverging points: {{0}}"\\n2215.         ...         .format(e.divergent))\\n2216.         ...   print("Indices of poorly converging points: {{0}}"\\n2217.         ...         .format(e.slow_conv))\\n2218.         ...   print("Best solution:\\\\\\\\n{{0}}".format(e.best_solution))\\n2219.         ...   print("Achieved accuracy:\\\\\\\\n{{0}}".format(e.accuracy))\\n2220.         Indices of diverging points: [1]\\n2221.         Indices of poorly converging points: None\\n2222.         Best solution:\\n2223.         [[ 1.00000009  1.        ]\\n2224.          [        nan         nan]\\n2225.          [ 3.00000009  1.        ]]\\n2226.         Achieved accuracy:\\n2227.         [[  2.29417358e-06   3.21222995e-08]\\n2228.          [             nan              nan]\\n2229.          [  2.27407877e-06   3.13005639e-08]]\\n2230.         >>> raise e\\n2231.         Traceback (most recent call last):\\n2232.         ...\\n2233.         NoConvergence: \\\'WCS.all_world2pix\\\' failed to converge to the\\n2234.         requested accuracy.  After 6 iterations, the solution is\\n2235.         diverging at least for one input point.\\n2236. \\n2237.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'naxis\\\', 8),\\n2238.                    docstrings.RA_DEC_ORDER(8),\\n2239.                    docstrings.RETURNS(\\\'pixel coordinates\\\', 8))\\n2240. \\n2241.     def wcs_world2pix(self, *args, **kwargs):\\n2242.         if self.wcs is None:\\n2243.             raise ValueError("No basic WCS settings were created.")\\n2244.         return self._array_converter(\\n2245.             lambda xy, o: self.wcs.s2p(xy, o)[\\\'pixcrd\\\'],\\n2246.             \\\'input\\\', *args, **kwargs)\\n2247.     wcs_world2pix.__doc__ = """\\n2248.         Transforms world coordinates to pixel coordinates, using only\\n2249.         the basic `wcslib`_ WCS transformation.  No `SIP`_ or\\n2250.         `distortion paper`_ table lookup transformation is applied.\\n2251. \\n2252.         Parameters\\n2253.         ----------\\n2254.         {}\\n2255. \\n2256.             For a transformation that is not two-dimensional, the\\n2257.             two-argument form must be used.\\n2258. \\n2259.         {}\\n2260. \\n2261.         Returns\\n2262.         -------\\n2263. \\n2264.         {}\\n2265. \\n2266.         Notes\\n2267.         -----\\n2268.         The order of the axes for the input world array is determined by\\n2269.         the ``CTYPEia`` keywords in the FITS header, therefore it may\\n2270.         not always be of the form (*ra*, *dec*).  The\\n2271.         `~astropy.wcs.Wcsprm.lat`, `~astropy.wcs.Wcsprm.lng`,\\n2272.         `~astropy.wcs.Wcsprm.lattyp` and `~astropy.wcs.Wcsprm.lngtyp`\\n2273.         members can be used to determine the order of the axes.\\n2274. \\n2275.         Raises\\n2276.         ------\\n2277.         MemoryError\\n2278.             Memory allocation failed.\\n2279. \\n2280.         SingularMatrixError\\n2281.             Linear transformation matrix is singular.\\n2282. \\n2283.         InconsistentAxisTypesError\\n2284.             Inconsistent or unrecognized coordinate axis types.\\n2285. \\n2286.         ValueError\\n2287.             Invalid parameter value.\\n2288. \\n2289.         ValueError\\n2290.             Invalid coordinate transformation parameters.\\n2291. \\n2292.         ValueError\\n2293.             x- and y-coordinate arrays are not the same size.\\n2294. \\n2295.         InvalidTransformError\\n2296.             Invalid coordinate transformation parameters.\\n2297. \\n2298.         InvalidTransformError\\n2299.             Ill-conditioned coordinate transformation parameters.\\n2300.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'naxis\\\', 8),\\n2301.                    docstrings.RA_DEC_ORDER(8),\\n2302.                    docstrings.RETURNS(\\\'pixel coordinates\\\', 8))\\n2303. \\n2304.     def pix2foc(self, *args):\\n2305.         return self._array_converter(self._pix2foc, None, *args)\\n2306.     pix2foc.__doc__ = """\\n2307.         Convert pixel coordinates to focal plane coordinates using the\\n2308.         `SIP`_ polynomial distortion convention and `distortion\\n2309.         paper`_ table-lookup correction.\\n2310. \\n2311.         The output is in absolute pixel coordinates, not relative to\\n2312.         ``CRPIX``.\\n2313. \\n2314.         Parameters\\n2315.         ----------\\n2316. \\n2317.         {}\\n2318. \\n2319.         Returns\\n2320.         -------\\n2321. \\n2322.         {}\\n2323. \\n2324.         Raises\\n2325.         ------\\n2326.         MemoryError\\n2327.             Memory allocation failed.\\n2328. \\n2329.         ValueError\\n2330.             Invalid coordinate transformation parameters.\\n2331.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'2\\\', 8),\\n2332.                    docstrings.RETURNS(\\\'focal coordinates\\\', 8))\\n2333. \\n2334.     def p4_pix2foc(self, *args):\\n2335.         return self._array_converter(self._p4_pix2foc, None, *args)\\n2336.     p4_pix2foc.__doc__ = """\\n2337.         Convert pixel coordinates to focal plane coordinates using\\n2338.         `distortion paper`_ table-lookup correction.\\n2339. \\n2340.         The output is in absolute pixel coordinates, not relative to\\n2341.         ``CRPIX``.\\n2342. \\n2343.         Parameters\\n2344.         ----------\\n2345. \\n2346.         {}\\n2347. \\n2348.         Returns\\n2349.         -------\\n2350. \\n2351.         {}\\n2352. \\n2353.         Raises\\n2354.         ------\\n2355.         MemoryError\\n2356.             Memory allocation failed.\\n2357. \\n2358.         ValueError\\n2359.             Invalid coordinate transformation parameters.\\n2360.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'2\\\', 8),\\n2361.                    docstrings.RETURNS(\\\'focal coordinates\\\', 8))\\n2362. \\n2363.     def det2im(self, *args):\\n2364.         return self._array_converter(self._det2im, None, *args)\\n2365.     det2im.__doc__ = """\\n2366.         Convert detector coordinates to image plane coordinates using\\n2367.         `distortion paper`_ table-lookup correction.\\n2368. \\n2369.         The output is in absolute pixel coordinates, not relative to\\n2370.         ``CRPIX``.\\n2371. \\n2372.         Parameters\\n2373.         ----------\\n2374. \\n2375.         {}\\n2376. \\n2377.         Returns\\n2378.         -------\\n2379. \\n2380.         {}\\n2381. \\n2382.         Raises\\n2383.         ------\\n2384.         MemoryError\\n2385.             Memory allocation failed.\\n2386. \\n2387.         ValueError\\n2388.             Invalid coordinate transformation parameters.\\n2389.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'2\\\', 8),\\n2390.                    docstrings.RETURNS(\\\'pixel coordinates\\\', 8))\\n2391. \\n2392.     def sip_pix2foc(self, *args):\\n2393.         if self.sip is None:\\n2394.             if len(args) == 2:\\n2395.                 return args[0]\\n2396.             elif len(args) == 3:\\n2397.                 return args[:2]\\n2398.             else:\\n2399.                 raise TypeError("Wrong number of arguments")\\n2400.         return self._array_converter(self.sip.pix2foc, None, *args)\\n2401.     sip_pix2foc.__doc__ = """\\n2402.         Convert pixel coordinates to focal plane coordinates using the\\n2403.         `SIP`_ polynomial distortion convention.\\n2404. \\n2405.         The output is in pixel coordinates, relative to ``CRPIX``.\\n2406. \\n2407.         FITS WCS `distortion paper`_ table lookup correction is not\\n2408.         applied, even if that information existed in the FITS file\\n2409.         that initialized this :class:`~astropy.wcs.WCS` object.  To\\n2410.         correct for that, use `~astropy.wcs.WCS.pix2foc` or\\n2411.         `~astropy.wcs.WCS.p4_pix2foc`.\\n2412. \\n2413.         Parameters\\n2414.         ----------\\n2415. \\n2416.         {}\\n2417. \\n2418.         Returns\\n2419.         -------\\n2420. \\n2421.         {}\\n2422. \\n2423.         Raises\\n2424.         ------\\n2425.         MemoryError\\n2426.             Memory allocation failed.\\n2427. \\n2428.         ValueError\\n2429.             Invalid coordinate transformation parameters.\\n2430.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'2\\\', 8),\\n2431.                    docstrings.RETURNS(\\\'focal coordinates\\\', 8))\\n2432. \\n2433.     def sip_foc2pix(self, *args):\\n2434.         if self.sip is None:\\n2435.             if len(args) == 2:\\n2436.                 return args[0]\\n2437.             elif len(args) == 3:\\n2438.                 return args[:2]\\n2439.             else:\\n2440.                 raise TypeError("Wrong number of arguments")\\n2441.         return self._array_converter(self.sip.foc2pix, None, *args)\\n2442.     sip_foc2pix.__doc__ = """\\n2443.         Convert focal plane coordinates to pixel coordinates using the\\n2444.         `SIP`_ polynomial distortion convention.\\n2445. \\n2446.         FITS WCS `distortion paper`_ table lookup distortion\\n2447.         correction is not applied, even if that information existed in\\n2448.         the FITS file that initialized this `~astropy.wcs.WCS` object.\\n2449. \\n2450.         Parameters\\n2451.         ----------\\n2452. \\n2453.         {}\\n2454. \\n2455.         Returns\\n2456.         -------\\n2457. \\n2458.         {}\\n2459. \\n2460.         Raises\\n2461.         ------\\n2462.         MemoryError\\n2463.             Memory allocation failed.\\n2464. \\n2465.         ValueError\\n2466.             Invalid coordinate transformation parameters.\\n2467.         """.format(docstrings.TWO_OR_MORE_ARGS(\\\'2\\\', 8),\\n2468.                    docstrings.RETURNS(\\\'pixel coordinates\\\', 8))\\n2469. \\n2470.     def proj_plane_pixel_scales(self):\\n2471.         """\\n2472.         Calculate pixel scales along each axis of the image pixel at\\n2473.         the ``CRPIX`` location once it is projected onto the\\n2474.         "plane of intermediate world coordinates" as defined in\\n2475.         `Greisen & Calabretta 2002, A&A, 395, 1061 <https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G>`_.\\n2476. \\n2477.         .. note::\\n2478.             This method is concerned **only** about the transformation\\n2479.             "image plane"->"projection plane" and **not** about the\\n2480.             transformation "celestial sphere"->"projection plane"->"image plane".\\n2481.             Therefore, this function ignores distortions arising due to\\n2482.             non-linear nature of most projections.\\n2483. \\n2484.         .. note::\\n2485.             This method only returns sensible answers if the WCS contains\\n2486.             celestial axes, i.e., the `~astropy.wcs.WCS.celestial` WCS object.\\n2487. \\n2488.         Returns\\n2489.         -------\\n2490.         scale : list of `~astropy.units.Quantity`\\n2491.             A vector of projection plane increments corresponding to each\\n2492.             pixel side (axis).\\n2493. \\n2494.         See Also\\n2495.         --------\\n2496.         astropy.wcs.utils.proj_plane_pixel_scales\\n2497. \\n2498.         """  # noqa: E501\\n2499.         from astropy.wcs.utils import proj_plane_pixel_scales  # Avoid circular import\\n2500.         values = proj_plane_pixel_scales(self)\\n2501.         units = [u.Unit(x) for x in self.wcs.cunit]\\n2502.         return [value * unit for (value, unit) in zip(values, units)]  # Can have different units\\n2503. \\n2504.     def proj_plane_pixel_area(self):\\n2505.         """\\n2506.         For a **celestial** WCS (see `astropy.wcs.WCS.celestial`), returns pixel\\n2507.         area of the image pixel at the ``CRPIX`` location once it is projected\\n2508.         onto the "plane of intermediate world coordinates" as defined in\\n2509.         `Greisen & Calabretta 2002, A&A, 395, 1061 <https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G>`_.\\n2510. \\n2511.         .. note::\\n2512.             This function is concerned **only** about the transformation\\n2513.             "image plane"->"projection plane" and **not** about the\\n2514.             transformation "celestial sphere"->"projection plane"->"image plane".\\n2515.             Therefore, this function ignores distortions arising due to\\n2516.             non-linear nature of most projections.\\n2517. \\n2518.         .. note::\\n2519.             This method only returns sensible answers if the WCS contains\\n2520.             celestial axes, i.e., the `~astropy.wcs.WCS.celestial` WCS object.\\n2521. \\n2522.         Returns\\n2523.         -------\\n2524.         area : `~astropy.units.Quantity`\\n2525.             Area (in the projection plane) of the pixel at ``CRPIX`` location.\\n2526. \\n2527.         Raises\\n2528.         ------\\n2529.         ValueError\\n2530.             Pixel area is defined only for 2D pixels. Most likely the\\n2531.             `~astropy.wcs.Wcsprm.cd` matrix of the `~astropy.wcs.WCS.celestial`\\n2532.             WCS is not a square matrix of second order.\\n2533. \\n2534.         Notes\\n2535.         -----\\n2536. \\n2537.         Depending on the application, square root of the pixel area can be used to\\n2538.         represent a single pixel scale of an equivalent square pixel\\n2539.         whose area is equal to the area of a generally non-square pixel.\\n2540. \\n2541.         See Also\\n2542.         --------\\n2543.         astropy.wcs.utils.proj_plane_pixel_area\\n2544. \\n2545.         """  # noqa: E501\\n2546.         from astropy.wcs.utils import proj_plane_pixel_area  # Avoid circular import\\n2547.         value = proj_plane_pixel_area(self)\\n2548.         unit = u.Unit(self.wcs.cunit[0]) * u.Unit(self.wcs.cunit[1])  # 2D only\\n2549.         return value * unit\\n2550. \\n2551.     def to_fits(self, relax=False, key=None):\\n2552.         """\\n2553.         Generate an `~astropy.io.fits.HDUList` object with all of the\\n2554.         information stored in this object.  This should be logically identical\\n2555.         to the input FITS file, but it will be normalized in a number of ways.\\n2556. \\n2557.         See `to_header` for some warnings about the output produced.\\n2558. \\n2559.         Parameters\\n2560.         ----------\\n2561. \\n2562.         relax : bool or int, optional\\n2563.             Degree of permissiveness:\\n2564. \\n2565.             - `False` (default): Write all extensions that are\\n2566.               considered to be safe and recommended.\\n2567. \\n2568.             - `True`: Write all recognized informal extensions of the\\n2569.               WCS standard.\\n2570. \\n2571.             - `int`: a bit field selecting specific extensions to\\n2572.               write.  See :ref:`astropy:relaxwrite` for details.\\n2573. \\n2574.         key : str\\n2575.             The name of a particular WCS transform to use.  This may be\\n2576.             either ``\\\' \\\'`` or ``\\\'A\\\'``-``\\\'Z\\\'`` and corresponds to the ``"a"``\\n2577.             part of the ``CTYPEia`` cards.\\n2578. \\n2579.         Returns\\n2580.         -------\\n2581.         hdulist : `~astropy.io.fits.HDUList`\\n2582.         """\\n2583. \\n2584.         header = self.to_header(relax=relax, key=key)\\n2585. \\n2586.         hdu = fits.PrimaryHDU(header=header)\\n2587.         hdulist = fits.HDUList(hdu)\\n2588. \\n2589.         self._write_det2im(hdulist)\\n2590.         self._write_distortion_kw(hdulist)\\n2591. \\n2592.         return hdulist\\n2593. \\n2594.     def to_header(self, relax=None, key=None):\\n2595.         """Generate an `astropy.io.fits.Header` object with the basic WCS\\n2596.         and SIP information stored in this object.  This should be\\n2597.         logically identical to the input FITS file, but it will be\\n2598.         normalized in a number of ways.\\n2599. \\n2600.         .. warning::\\n2601. \\n2602.           This function does not write out FITS WCS `distortion\\n2603.           paper`_ information, since that requires multiple FITS\\n2604.           header data units.  To get a full representation of\\n2605.           everything in this object, use `to_fits`.\\n2606. \\n2607.         Parameters\\n2608.         ----------\\n2609.         relax : bool or int, optional\\n2610.             Degree of permissiveness:\\n2611. \\n2612.             - `False` (default): Write all extensions that are\\n2613.               considered to be safe and recommended.\\n2614. \\n2615.             - `True`: Write all recognized informal extensions of the\\n2616.               WCS standard.\\n2617. \\n2618.             - `int`: a bit field selecting specific extensions to\\n2619.               write.  See :ref:`astropy:relaxwrite` for details.\\n2620. \\n2621.             If the ``relax`` keyword argument is not given and any\\n2622.             keywords were omitted from the output, an\\n2623.             `~astropy.utils.exceptions.AstropyWarning` is displayed.\\n2624.             To override this, explicitly pass a value to ``relax``.\\n2625. \\n2626.         key : str\\n2627.             The name of a particular WCS transform to use.  This may be\\n2628.             either ``\\\' \\\'`` or ``\\\'A\\\'``-``\\\'Z\\\'`` and corresponds to the ``"a"``\\n2629.             part of the ``CTYPEia`` cards.\\n2630. \\n2631.         Returns\\n2632.         -------\\n2633.         header : `astropy.io.fits.Header`\\n2634. \\n2635.         Notes\\n2636.         -----\\n2637.         The output header will almost certainly differ from the input in a\\n2638.         number of respects:\\n2639. \\n2640.           1. The output header only contains WCS-related keywords.  In\\n2641.              particular, it does not contain syntactically-required\\n2642.              keywords such as ``SIMPLE``, ``NAXIS``, ``BITPIX``, or\\n2643.              ``END``.\\n2644. \\n2645.           2. Deprecated (e.g. ``CROTAn``) or non-standard usage will\\n2646.              be translated to standard (this is partially dependent on\\n2647.              whether ``fix`` was applied).\\n2648. \\n2649.           3. Quantities will be converted to the units used internally,\\n2650.              basically SI with the addition of degrees.\\n2651. \\n2652.           4. Floating-point quantities may be given to a different decimal\\n2653.              precision.\\n2654. \\n2655.           5. Elements of the ``PCi_j`` matrix will be written if and\\n2656.              only if they differ from the unit matrix.  Thus, if the\\n2657.              matrix is unity then no elements will be written.\\n2658. \\n2659.           6. Additional keywords such as ``WCSAXES``, ``CUNITia``,\\n2660.              ``LONPOLEa`` and ``LATPOLEa`` may appear.\\n2661. \\n2662.           7. The original keycomments will be lost, although\\n2663.              `to_header` tries hard to write meaningful comments.\\n2664. \\n2665.           8. Keyword order may be changed.\\n2666. \\n2667.         """\\n2668.         # default precision for numerical WCS keywords\\n2669.         precision = WCSHDO_P14  # Defined by C-ext  # noqa: F821\\n2670.         display_warning = False\\n2671.         if relax is None:\\n2672.             display_warning = True\\n2673.             relax = False\\n2674. \\n2675.         if relax not in (True, False):\\n2676.             do_sip = relax & WCSHDO_SIP\\n2677.             relax &= ~WCSHDO_SIP\\n2678.         else:\\n2679.             do_sip = relax\\n2680.             relax = WCSHDO_all if relax is True else WCSHDO_safe  # Defined by C-ext  # noqa: F821\\n2681. \\n2682.         relax = precision | relax\\n2683. \\n2684.         if self.wcs is not None:\\n2685.             if key is not None:\\n2686.                 orig_key = self.wcs.alt\\n2687.                 self.wcs.alt = key\\n2688.             header_string = self.wcs.to_header(relax)\\n2689.             header = fits.Header.fromstring(header_string)\\n2690.             keys_to_remove = ["", " ", "COMMENT"]\\n2691.             for kw in keys_to_remove:\\n2692.                 if kw in header:\\n2693.                     del header[kw]\\n2694.             # Check if we can handle TPD distortion correctly\\n2695.             if _WCS_TPD_WARN_LT71:\\n2696.                 for kw, val in header.items():\\n2697.                     if kw[:5] in (\\\'CPDIS\\\', \\\'CQDIS\\\') and val == \\\'TPD\\\':\\n2698.                         warnings.warn(\\n2699.                             f"WCS contains a TPD distortion model in {kw}. WCSLIB "\\n2700.                             f"{_wcs.__version__} is writing this in a format incompatible with "\\n2701.                             f"current versions - please update to 7.4 or use the bundled WCSLIB.",\\n2702.                             AstropyWarning)\\n2703.             elif _WCS_TPD_WARN_LT74:\\n2704.                 for kw, val in header.items():\\n2705.                     if kw[:5] in (\\\'CPDIS\\\', \\\'CQDIS\\\') and val == \\\'TPD\\\':\\n2706.                         warnings.warn(\\n2707.                             f"WCS contains a TPD distortion model in {kw}, which requires WCSLIB "\\n2708.                             f"7.4 or later to store in a FITS header (having {_wcs.__version__}).",\\n2709.                             AstropyWarning)\\n2710.         else:\\n2711.             header = fits.Header()\\n2712. \\n2713.         if do_sip and self.sip is not None:\\n2714.             if self.wcs is not None and any(not ctyp.endswith(\\\'-SIP\\\') for ctyp in self.wcs.ctype):\\n2715.                 self._fix_ctype(header, add_sip=True)\\n2716. \\n2717.             for kw, val in self._write_sip_kw().items():\\n2718.                 header[kw] = val\\n2719. \\n2720.         if not do_sip and self.wcs is not None and any(self.wcs.ctype) and self.sip is not None:\\n2721.             # This is called when relax is not False or WCSHDO_SIP\\n2722.             # The default case of ``relax=None`` is handled further in the code.\\n2723.             header = self._fix_ctype(header, add_sip=False)\\n2724. \\n2725.         if display_warning:\\n2726.             full_header = self.to_header(relax=True, key=key)\\n2727.             missing_keys = []\\n2728.             for kw, val in full_header.items():\\n2729.                 if kw not in header:\\n2730.                     missing_keys.append(kw)\\n2731. \\n2732.             if len(missing_keys):\\n2733.                 warnings.warn(\\n2734.                     "Some non-standard WCS keywords were excluded: {} "\\n2735.                     "Use the ``relax`` kwarg to control this.".format(\\n2736.                         \\\', \\\'.join(missing_keys)),\\n2737.                     AstropyWarning)\\n2738.             # called when ``relax=None``\\n2739.             # This is different from the case of ``relax=False``.\\n2740.             if any(self.wcs.ctype) and self.sip is not None:\\n2741.                 header = self._fix_ctype(header, add_sip=False, log_message=False)\\n2742.         # Finally reset the key. This must be called after ``_fix_ctype``.\\n2743.         if key is not None:\\n2744.             self.wcs.alt = orig_key\\n2745.         return header\\n2746. \\n2747.     def _fix_ctype(self, header, add_sip=True, log_message=True):\\n2748.         """\\n2749.         Parameters\\n2750.         ----------\\n2751.         header : `~astropy.io.fits.Header`\\n2752.             FITS header.\\n2753.         add_sip : bool\\n2754.             Flag indicating whether "-SIP" should be added or removed from CTYPE keywords.\\n2755. \\n2756.             Remove "-SIP" from CTYPE when writing out a header with relax=False.\\n2757.             This needs to be done outside ``to_header`` because ``to_header`` runs\\n2758.             twice when ``relax=False`` and the second time ``relax`` is set to ``True``\\n2759.             to display the missing keywords.\\n2760. \\n2761.             If the user requested SIP distortion to be written out add "-SIP" to\\n2762.             CTYPE if it is missing.\\n2763.         """\\n2764. \\n2765.         _add_sip_to_ctype = """\\n2766.         Inconsistent SIP distortion information is present in the current WCS:\\n2767.         SIP coefficients were detected, but CTYPE is missing "-SIP" suffix,\\n2768.         therefore the current WCS is internally inconsistent.\\n2769. \\n2770.         Because relax has been set to True, the resulting output WCS will have\\n2771.         "-SIP" appended to CTYPE in order to make the header internally consistent.\\n2772. \\n2773.         However, this may produce incorrect astrometry in the output WCS, if\\n2774.         in fact the current WCS is already distortion-corrected.\\n2775. \\n2776.         Therefore, if current WCS is already distortion-corrected (eg, drizzled)\\n2777.         then SIP distortion components should not apply. In that case, for a WCS\\n2778.         that is already distortion-corrected, please remove the SIP coefficients\\n2779.         from the header.\\n2780. \\n2781.         """\\n2782.         if log_message:\\n2783.             if add_sip:\\n2784.                 log.info(_add_sip_to_ctype)\\n2785.         for i in range(1, self.naxis+1):\\n2786.             # strip() must be called here to cover the case of alt key= " "\\n2787.             kw = f\\\'CTYPE{i}{self.wcs.alt}\\\'.strip()\\n2788.             if kw in header:\\n2789.                 if add_sip:\\n2790.                     val = header[kw].strip("-SIP") + "-SIP"\\n2791.                 else:\\n2792.                     val = header[kw].strip("-SIP")\\n2793.                 header[kw] = val\\n2794.             else:\\n2795.                 continue\\n2796.         return header\\n2797. \\n2798.     def to_header_string(self, relax=None):\\n2799.         """\\n2800.         Identical to `to_header`, but returns a string containing the\\n2801.         header cards.\\n2802.         """\\n2803.         return str(self.to_header(relax))\\n2804. \\n2805.     def footprint_to_file(self, filename=\\\'footprint.reg\\\', color=\\\'green\\\',\\n2806.                           width=2, coordsys=None):\\n2807.         """\\n2808.         Writes out a `ds9`_ style regions file. It can be loaded\\n2809.         directly by `ds9`_.\\n2810. \\n2811.         Parameters\\n2812.         ----------\\n2813.         filename : str, optional\\n2814.             Output file name - default is ``\\\'footprint.reg\\\'``\\n2815. \\n2816.         color : str, optional\\n2817.             Color to use when plotting the line.\\n2818. \\n2819.         width : int, optional\\n2820.             Width of the region line.\\n2821. \\n2822.         coordsys : str, optional\\n2823.             Coordinate system. If not specified (default), the ``radesys``\\n2824.             value is used. For all possible values, see\\n2825.             http://ds9.si.edu/doc/ref/region.html#RegionFileFormat\\n2826. \\n2827.         """\\n2828.         comments = (\\\'# Region file format: DS9 version 4.0 \\\\n\\\'\\n2829.                     \\\'# global color=green font="helvetica 12 bold \\\'\\n2830.                     \\\'select=1 highlite=1 edit=1 move=1 delete=1 \\\'\\n2831.                     \\\'include=1 fixed=0 source\\\\n\\\')\\n2832. \\n2833.         coordsys = coordsys or self.wcs.radesys\\n2834. \\n2835.         if coordsys not in (\\\'PHYSICAL\\\', \\\'IMAGE\\\', \\\'FK4\\\', \\\'B1950\\\', \\\'FK5\\\',\\n2836.                             \\\'J2000\\\', \\\'GALACTIC\\\', \\\'ECLIPTIC\\\', \\\'ICRS\\\', \\\'LINEAR\\\',\\n2837.                             \\\'AMPLIFIER\\\', \\\'DETECTOR\\\'):\\n2838.             raise ValueError("Coordinate system \\\'{}\\\' is not supported. A valid"\\n2839.                              " one can be given with the \\\'coordsys\\\' argument."\\n2840.                              .format(coordsys))\\n2841. \\n2842.         with open(filename, mode=\\\'w\\\') as f:\\n2843.             f.write(comments)\\n2844.             f.write(f\\\'{coordsys}\\\\n\\\')\\n2845.             f.write(\\\'polygon(\\\')\\n2846.             ftpr = self.calc_footprint()\\n2847.             if ftpr is not None:\\n2848.                 ftpr.tofile(f, sep=\\\',\\\')\\n2849.                 f.write(f\\\') # color={color}, width={width:d} \\\\n\\\')\\n2850. \\n2851.     def _get_naxis(self, header=None):\\n2852.         _naxis = []\\n2853.         if (header is not None and\\n2854.                 not isinstance(header, (str, bytes))):\\n2855.             for naxis in itertools.count(1):\\n2856.                 try:\\n2857.                     _naxis.append(header[f\\\'NAXIS{naxis}\\\'])\\n2858.                 except KeyError:\\n2859.                     break\\n2860.         if len(_naxis) == 0:\\n2861.             _naxis = [0, 0]\\n2862.         elif len(_naxis) == 1:\\n2863.             _naxis.append(0)\\n2864.         self._naxis = _naxis\\n2865. \\n2866.     def printwcs(self):\\n2867.         print(repr(self))\\n2868. \\n2869.     def __repr__(self):\\n2870.         \\\'\\\'\\\'\\n2871.         Return a short description. Simply porting the behavior from\\n2872.         the `printwcs()` method.\\n2873.         \\\'\\\'\\\'\\n2874.         description = ["WCS Keywords\\\\n",\\n2875.                        f"Number of WCS axes: {self.naxis!r}"]\\n2876.         sfmt = \\\' : \\\' + "".join(["{"+f"{i}"+"!r}  " for i in range(self.naxis)])\\n2877. \\n2878.         keywords = [\\\'CTYPE\\\', \\\'CRVAL\\\', \\\'CRPIX\\\']\\n2879.         values = [self.wcs.ctype, self.wcs.crval, self.wcs.crpix]\\n2880.         for keyword, value in zip(keywords, values):\\n2881.             description.append(keyword+sfmt.format(*value))\\n2882. \\n2883.         if hasattr(self.wcs, \\\'pc\\\'):\\n2884.             for i in range(self.naxis):\\n2885.                 s = \\\'\\\'\\n2886.                 for j in range(self.naxis):\\n2887.                     s += \\\'\\\'.join([\\\'PC\\\', str(i+1), \\\'_\\\', str(j+1), \\\' \\\'])\\n2888.                 s += sfmt\\n2889.                 description.append(s.format(*self.wcs.pc[i]))\\n2890.             s = \\\'CDELT\\\' + sfmt\\n2891.             description.append(s.format(*self.wcs.cdelt))\\n2892.         elif hasattr(self.wcs, \\\'cd\\\'):\\n2893.             for i in range(self.naxis):\\n2894.                 s = \\\'\\\'\\n2895.                 for j in range(self.naxis):\\n2896.                     s += "".join([\\\'CD\\\', str(i+1), \\\'_\\\', str(j+1), \\\' \\\'])\\n2897.                 s += sfmt\\n2898.                 description.append(s.format(*self.wcs.cd[i]))\\n2899. \\n2900.         description.append(f"NAXIS : {\\\'  \\\'.join(map(str, self._naxis))}")\\n2901.         return \\\'\\\\n\\\'.join(description)\\n2902. \\n2903.     def get_axis_types(self):\\n2904.         """\\n2905.         Similar to `self.wcsprm.axis_types <astropy.wcs.Wcsprm.axis_types>`\\n2906.         but provides the information in a more Python-friendly format.\\n2907. \\n2908.         Returns\\n2909.         -------\\n2910.         result : list of dict\\n2911. \\n2912.             Returns a list of dictionaries, one for each axis, each\\n2913.             containing attributes about the type of that axis.\\n2914. \\n2915.             Each dictionary has the following keys:\\n2916. \\n2917.             - \\\'coordinate_type\\\':\\n2918. \\n2919.               - None: Non-specific coordinate type.\\n2920. \\n2921.               - \\\'stokes\\\': Stokes coordinate.\\n2922. \\n2923.               - \\\'celestial\\\': Celestial coordinate (including ``CUBEFACE``).\\n2924. \\n2925.               - \\\'spectral\\\': Spectral coordinate.\\n2926. \\n2927.             - \\\'scale\\\':\\n2928. \\n2929.               - \\\'linear\\\': Linear axis.\\n2930. \\n2931.               - \\\'quantized\\\': Quantized axis (``STOKES``, ``CUBEFACE``).\\n2932. \\n2933.               - \\\'non-linear celestial\\\': Non-linear celestial axis.\\n2934. \\n2935.               - \\\'non-linear spectral\\\': Non-linear spectral axis.\\n2936. \\n2937.               - \\\'logarithmic\\\': Logarithmic axis.\\n2938. \\n2939.               - \\\'tabular\\\': Tabular axis.\\n2940. \\n2941.             - \\\'group\\\'\\n2942. \\n2943.               - Group number, e.g. lookup table number\\n2944. \\n2945.             - \\\'number\\\'\\n2946. \\n2947.               - For celestial axes:\\n2948. \\n2949.                 - 0: Longitude coordinate.\\n2950. \\n2951.                 - 1: Latitude coordinate.\\n2952. \\n2953.                 - 2: ``CUBEFACE`` number.\\n2954. \\n2955.               - For lookup tables:\\n2956. \\n2957.                 - the axis number in a multidimensional table.\\n2958. \\n2959.             ``CTYPEia`` in ``"4-3"`` form with unrecognized algorithm code will\\n2960.             generate an error.\\n2961.         """\\n2962.         if self.wcs is None:\\n2963.             raise AttributeError(\\n2964.                 "This WCS object does not have a wcsprm object.")\\n2965. \\n2966.         coordinate_type_map = {\\n2967.             0: None,\\n2968.             1: \\\'stokes\\\',\\n2969.             2: \\\'celestial\\\',\\n2970.             3: \\\'spectral\\\'}\\n2971. \\n2972.         scale_map = {\\n2973.             0: \\\'linear\\\',\\n2974.             1: \\\'quantized\\\',\\n2975.             2: \\\'non-linear celestial\\\',\\n2976.             3: \\\'non-linear spectral\\\',\\n2977.             4: \\\'logarithmic\\\',\\n2978.             5: \\\'tabular\\\'}\\n2979. \\n2980.         result = []\\n2981.         for axis_type in self.wcs.axis_types:\\n2982.             subresult = {}\\n2983. \\n2984.             coordinate_type = (axis_type // 1000) % 10\\n2985.             subresult[\\\'coordinate_type\\\'] = coordinate_type_map[coordinate_type]\\n2986. \\n2987.             scale = (axis_type // 100) % 10\\n2988.             subresult[\\\'scale\\\'] = scale_map[scale]\\n2989. \\n2990.             group = (axis_type // 10) % 10\\n2991.             subresult[\\\'group\\\'] = group\\n2992. \\n2993.             number = axis_type % 10\\n2994.             subresult[\\\'number\\\'] = number\\n2995. \\n2996.             result.append(subresult)\\n2997. \\n2998.         return result\\n2999. \\n3000.     def __reduce__(self):\\n3001.         """\\n3002.         Support pickling of WCS objects.  This is done by serializing\\n3003.         to an in-memory FITS file and dumping that as a string.\\n3004.         """\\n3005. \\n3006.         hdulist = self.to_fits(relax=True)\\n3007. \\n3008.         buffer = io.BytesIO()\\n3009.         hdulist.writeto(buffer)\\n3010. \\n3011.         dct = self.__dict__.copy()\\n3012.         dct[\\\'_alt_wcskey\\\'] = self.wcs.alt\\n3013. \\n3014.         return (__WCS_unpickle__,\\n3015.                 (self.__class__, dct, buffer.getvalue(),))\\n3016. \\n3017.     def dropaxis(self, dropax):\\n3018.         """\\n3019.         Remove an axis from the WCS.\\n3020. \\n3021.         Parameters\\n3022.         ----------\\n3023.         wcs : `~astropy.wcs.WCS`\\n3024.             The WCS with naxis to be chopped to naxis-1\\n3025.         dropax : int\\n3026.             The index of the WCS to drop, counting from 0 (i.e., python convention,\\n3027.             not FITS convention)\\n3028. \\n3029.         Returns\\n3030.         -------\\n3031.         `~astropy.wcs.WCS`\\n3032.             A new `~astropy.wcs.WCS` instance with one axis fewer\\n3033.         """\\n3034.         inds = list(range(self.wcs.naxis))\\n3035.         inds.pop(dropax)\\n3036. \\n3037.         # axis 0 has special meaning to sub\\n3038.         # if wcs.wcs.ctype == [\\\'RA\\\',\\\'DEC\\\',\\\'VLSR\\\'], you want\\n3039.         # wcs.sub([1,2]) to get \\\'RA\\\',\\\'DEC\\\' back\\n3040.         return self.sub([i+1 for i in inds])\\n3041. \\n3042.     def swapaxes(self, ax0, ax1):\\n3043.         """\\n3044.         Swap axes in a WCS.\\n3045. \\n3046.         Parameters\\n3047.         ----------\\n3048.         wcs : `~astropy.wcs.WCS`\\n3049.             The WCS to have its axes swapped\\n3050.         ax0 : int\\n3051.         ax1 : int\\n3052.             The indices of the WCS to be swapped, counting from 0 (i.e., python\\n3053.             convention, not FITS convention)\\n3054. \\n3055.         Returns\\n3056.         -------\\n3057.         `~astropy.wcs.WCS`\\n3058.             A new `~astropy.wcs.WCS` instance with the same number of axes,\\n3059.             but two swapped\\n3060.         """\\n3061.         inds = list(range(self.wcs.naxis))\\n3062.         inds[ax0], inds[ax1] = inds[ax1], inds[ax0]\\n3063. \\n3064.         return self.sub([i+1 for i in inds])\\n3065. \\n3066.     def reorient_celestial_first(self):\\n3067.         """\\n3068.         Reorient the WCS such that the celestial axes are first, followed by\\n3069.         the spectral axis, followed by any others.\\n3070.         Assumes at least celestial axes are present.\\n3071.         """\\n3072.         return self.sub([WCSSUB_CELESTIAL, WCSSUB_SPECTRAL, WCSSUB_STOKES, WCSSUB_TIME])  # Defined by C-ext  # noqa: F821 E501\\n3073. \\n3074.     def slice(self, view, numpy_order=True):\\n3075.         """\\n3076.         Slice a WCS instance using a Numpy slice. The order of the slice should\\n3077.         be reversed (as for the data) compared to the natural WCS order.\\n3078. \\n3079.         Parameters\\n3080.         ----------\\n3081.         view : tuple\\n3082.             A tuple containing the same number of slices as the WCS system.\\n3083.             The ``step`` method, the third argument to a slice, is not\\n3084.             presently supported.\\n3085.         numpy_order : bool\\n3086.             Use numpy order, i.e. slice the WCS so that an identical slice\\n3087.             applied to a numpy array will slice the array and WCS in the same\\n3088.             way. If set to `False`, the WCS will be sliced in FITS order,\\n3089.             meaning the first slice will be applied to the *last* numpy index\\n3090.             but the *first* WCS axis.\\n3091. \\n3092.         Returns\\n3093.         -------\\n3094.         wcs_new : `~astropy.wcs.WCS`\\n3095.             A new resampled WCS axis\\n3096.         """\\n3097.         if hasattr(view, \\\'__len__\\\') and len(view) > self.wcs.naxis:\\n3098.             raise ValueError("Must have # of slices <= # of WCS axes")\\n3099.         elif not hasattr(view, \\\'__len__\\\'):  # view MUST be an iterable\\n3100.             view = [view]\\n3101. \\n3102.         if not all(isinstance(x, slice) for x in view):\\n3103.             # We need to drop some dimensions, but this may not always be\\n3104.             # possible with .sub due to correlated axes, so instead we use the\\n3105.             # generalized slicing infrastructure from astropy.wcs.wcsapi.\\n3106.             return SlicedFITSWCS(self, view)\\n3107. \\n3108.         # NOTE: we could in principle use SlicedFITSWCS as above for all slicing,\\n3109.         # but in the simple case where there are no axes dropped, we can just\\n3110.         # create a full WCS object with updated WCS parameters which is faster\\n3111.         # for this specific case and also backward-compatible.\\n3112. \\n3113.         wcs_new = self.deepcopy()\\n3114.         if wcs_new.sip is not None:\\n3115.             sip_crpix = wcs_new.sip.crpix.tolist()\\n3116. \\n3117.         for i, iview in enumerate(view):\\n3118.             if iview.step is not None and iview.step < 0:\\n3119.                 raise NotImplementedError("Reversing an axis is not "\\n3120.                                           "implemented.")\\n3121. \\n3122.             if numpy_order:\\n3123.                 wcs_index = self.wcs.naxis - 1 - i\\n3124.             else:\\n3125.                 wcs_index = i\\n3126. \\n3127.             if iview.step is not None and iview.start is None:\\n3128.                 # Slice from "None" is equivalent to slice from 0 (but one\\n3129.                 # might want to downsample, so allow slices with\\n3130.                 # None,None,step or None,stop,step)\\n3131.                 iview = slice(0, iview.stop, iview.step)\\n3132. \\n3133.             if iview.start is not None:\\n3134.                 if iview.step not in (None, 1):\\n3135.                     crpix = self.wcs.crpix[wcs_index]\\n3136.                     cdelt = self.wcs.cdelt[wcs_index]\\n3137.                     # equivalently (keep this comment so you can compare eqns):\\n3138.                     # wcs_new.wcs.crpix[wcs_index] =\\n3139.                     # (crpix - iview.start)*iview.step + 0.5 - iview.step/2.\\n3140.                     crp = ((crpix - iview.start - 1.)/iview.step\\n3141.                            + 0.5 + 1./iview.step/2.)\\n3142.                     wcs_new.wcs.crpix[wcs_index] = crp\\n3143.                     if wcs_new.sip is not None:\\n3144.                         sip_crpix[wcs_index] = crp\\n3145.                     wcs_new.wcs.cdelt[wcs_index] = cdelt * iview.step\\n3146.                 else:\\n3147.                     wcs_new.wcs.crpix[wcs_index] -= iview.start\\n3148.                     if wcs_new.sip is not None:\\n3149.                         sip_crpix[wcs_index] -= iview.start\\n3150. \\n3151.             try:\\n3152.                 # range requires integers but the other attributes can also\\n3153.                 # handle arbitrary values, so this needs to be in a try/except.\\n3154.                 nitems = len(builtins.range(self._naxis[wcs_index])[iview])\\n3155.             except TypeError as exc:\\n3156.                 if \\\'indices must be integers\\\' not in str(exc):\\n3157.                     raise\\n3158.                 warnings.warn("NAXIS{} attribute is not updated because at "\\n3159.                               "least one index (\\\'{}\\\') is no integer."\\n3160.                               "".format(wcs_index, iview), AstropyUserWarning)\\n3161.             else:\\n3162.                 wcs_new._naxis[wcs_index] = nitems\\n3163. \\n3164.         if wcs_new.sip is not None:\\n3165.             wcs_new.sip = Sip(self.sip.a, self.sip.b, self.sip.ap, self.sip.bp,\\n3166.                               sip_crpix)\\n3167. \\n3168.         return wcs_new\\n3169. \\n3170.     def __getitem__(self, item):\\n3171.         # "getitem" is a shortcut for self.slice; it is very limited\\n3172.         # there is no obvious and unambiguous interpretation of wcs[1,2,3]\\n3173.         # We COULD allow wcs[1] to link to wcs.sub([2])\\n3174.         # (wcs[i] -> wcs.sub([i+1])\\n3175.         return self.slice(item)\\n3176. \\n3177.     def __iter__(self):\\n3178.         # Having __getitem__ makes Python think WCS is iterable. However,\\n3179.         # Python first checks whether __iter__ is present, so we can raise an\\n3180.         # exception here.\\n3181.         raise TypeError(f"\\\'{self.__class__.__name__}\\\' object is not iterable")\\n3182. \\n3183.     @property\\n3184.     def axis_type_names(self):\\n3185.         """\\n3186.         World names for each coordinate axis\\n3187. \\n3188.         Returns\\n3189.         -------\\n3190.         list of str\\n3191.             A list of names along each axis.\\n3192.         """\\n3193.         names = list(self.wcs.cname)\\n3194.         types = self.wcs.ctype\\n3195.         for i in range(len(names)):\\n3196.             if len(names[i]) > 0:\\n3197.                 continue\\n3198.             names[i] = types[i].split(\\\'-\\\')[0]\\n3199.         return names\\n3200. \\n3201.     @property\\n3202.     def celestial(self):\\n3203.         """\\n3204.         A copy of the current WCS with only the celestial axes included\\n3205.         """\\n3206.         return self.sub([WCSSUB_CELESTIAL])  # Defined by C-ext  # noqa: F821\\n3207. \\n3208.     @property\\n3209.     def is_celestial(self):\\n3210.         return self.has_celestial and self.naxis == 2\\n3211. \\n3212.     @property\\n3213.     def has_celestial(self):\\n3214.         try:\\n3215.             return self.wcs.lng >= 0 and self.wcs.lat >= 0\\n3216.         except InconsistentAxisTypesError:\\n3217.             return False\\n3218. \\n3219.     @property\\n3220.     def spectral(self):\\n3221.         """\\n3222.         A copy of the current WCS with only the spectral axes included\\n3223.         """\\n3224.         return self.sub([WCSSUB_SPECTRAL])  # Defined by C-ext  # noqa: F821\\n3225. \\n3226.     @property\\n3227.     def is_spectral(self):\\n3228.         return self.has_spectral and self.naxis == 1\\n3229. \\n3230.     @property\\n3231.     def has_spectral(self):\\n3232.         try:\\n3233.             return self.wcs.spec >= 0\\n3234.         except InconsistentAxisTypesError:\\n3235.             return False\\n3236. \\n3237.     @property\\n3238.     def temporal(self):\\n3239.         """\\n3240.         A copy of the current WCS with only the time axes included\\n3241.         """\\n3242.         if not _WCSSUB_TIME_SUPPORT:\\n3243.             raise NotImplementedError(\\n3244.                 "Support for \\\'temporal\\\' axis requires WCSLIB version 7.8 or "\\n3245.                 f"greater but linked WCSLIB version is {_wcs.__version__}"\\n3246.             )\\n3247. \\n3248.         return self.sub([WCSSUB_TIME])  # Defined by C-ext  # noqa: F821\\n3249. \\n3250.     @property\\n3251.     def is_temporal(self):\\n3252.         return self.has_temporal and self.naxis == 1\\n3253. \\n3254.     @property\\n3255.     def has_temporal(self):\\n3256.         return any(t // 1000 == 4 for t in self.wcs.axis_types)\\n3257. \\n3258.     @property\\n3259.     def has_distortion(self):\\n3260.         """\\n3261.         Returns `True` if any distortion terms are present.\\n3262.         """\\n3263.         return (self.sip is not None or\\n3264.                 self.cpdis1 is not None or self.cpdis2 is not None or\\n3265.                 self.det2im1 is not None and self.det2im2 is not None)\\n3266. \\n3267.     @property\\n3268.     def pixel_scale_matrix(self):\\n3269. \\n3270.         try:\\n3271.             cdelt = np.diag(self.wcs.get_cdelt())\\n3272.             pc = self.wcs.get_pc()\\n3273.         except InconsistentAxisTypesError:\\n3274.             try:\\n3275.                 # for non-celestial axes, get_cdelt doesn\\\'t work\\n3276.                 with warnings.catch_warnings():\\n3277.                     warnings.filterwarnings(\\n3278.                         \\\'ignore\\\', \\\'cdelt will be ignored since cd is present\\\', RuntimeWarning)\\n3279.                     cdelt = np.dot(self.wcs.cd, np.diag(self.wcs.cdelt))\\n3280.             except AttributeError:\\n3281.                 cdelt = np.diag(self.wcs.cdelt)\\n3282. \\n3283.             try:\\n3284.                 pc = self.wcs.pc\\n3285.             except AttributeError:\\n3286.                 pc = 1\\n3287. \\n3288.         pccd = np.dot(cdelt, pc)\\n3289. \\n3290.         return pccd\\n3291. \\n3292.     def footprint_contains(self, coord, **kwargs):\\n3293.         """\\n3294.         Determines if a given SkyCoord is contained in the wcs footprint.\\n3295. \\n3296.         Parameters\\n3297.         ----------\\n3298.         coord : `~astropy.coordinates.SkyCoord`\\n3299.             The coordinate to check if it is within the wcs coordinate.\\n3300.         **kwargs :\\n3301.            Additional arguments to pass to `~astropy.coordinates.SkyCoord.to_pixel`\\n3302. \\n3303.         Returns\\n3304.         -------\\n3305.         response : bool\\n3306.            True means the WCS footprint contains the coordinate, False means it does not.\\n3307.         """\\n3308. \\n3309.         return coord.contained_by(self, **kwargs)\', \'start_line_number\': 243, \'end_line_number\': 3309}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/fitswcs.py\', \'content\': \'196. class FITSWCSAPIMixin(BaseLowLevelWCS, HighLevelWCSMixin):\\n197.     """\\n198.     A mix-in class that is intended to be inherited by the\\n199.     :class:`~astropy.wcs.WCS` class and provides the low- and high-level WCS API\\n200.     """\\n201. \\n202.     @property\\n203.     def pixel_n_dim(self):\\n204.         return self.naxis\\n205. \\n206.     @property\\n207.     def world_n_dim(self):\\n208.         return len(self.wcs.ctype)\\n209. \\n210.     @property\\n211.     def array_shape(self):\\n212.         if self.pixel_shape is None:\\n213.             return None\\n214.         else:\\n215.             return self.pixel_shape[::-1]\\n216. \\n217.     @array_shape.setter\\n218.     def array_shape(self, value):\\n219.         if value is None:\\n220.             self.pixel_shape = None\\n221.         else:\\n222.             self.pixel_shape = value[::-1]\\n223. \\n224.     @property\\n225.     def pixel_shape(self):\\n226.         if self._naxis == [0, 0]:\\n227.             return None\\n228.         else:\\n229.             return tuple(self._naxis)\\n230. \\n231.     @pixel_shape.setter\\n232.     def pixel_shape(self, value):\\n233.         if value is None:\\n234.             self._naxis = [0, 0]\\n235.         else:\\n236.             if len(value) != self.naxis:\\n237.                 raise ValueError("The number of data axes, "\\n238.                                  "{}, does not equal the "\\n239.                                  "shape {}.".format(self.naxis, len(value)))\\n240.             self._naxis = list(value)\\n241. \\n242.     @property\\n243.     def pixel_bounds(self):\\n244.         return self._pixel_bounds\\n245. \\n246.     @pixel_bounds.setter\\n247.     def pixel_bounds(self, value):\\n248.         if value is None:\\n249.             self._pixel_bounds = value\\n250.         else:\\n251.             if len(value) != self.naxis:\\n252.                 raise ValueError("The number of data axes, "\\n253.                                  "{}, does not equal the number of "\\n254.                                  "pixel bounds {}.".format(self.naxis, len(value)))\\n255.             self._pixel_bounds = list(value)\\n256. \\n257.     @property\\n258.     def world_axis_physical_types(self):\\n259.         types = []\\n260.         # TODO: need to support e.g. TT(TAI)\\n261.         for ctype in self.wcs.ctype:\\n262.             if ctype.upper().startswith((\\\'UT(\\\', \\\'TT(\\\')):\\n263.                 types.append(\\\'time\\\')\\n264.             else:\\n265.                 ctype_name = ctype.split(\\\'-\\\')[0]\\n266.                 for custom_mapping in CTYPE_TO_UCD1_CUSTOM:\\n267.                     if ctype_name in custom_mapping:\\n268.                         types.append(custom_mapping[ctype_name])\\n269.                         break\\n270.                 else:\\n271.                     types.append(CTYPE_TO_UCD1.get(ctype_name.upper(), None))\\n272.         return types\\n273. \\n274.     @property\\n275.     def world_axis_units(self):\\n276.         units = []\\n277.         for unit in self.wcs.cunit:\\n278.             if unit is None:\\n279.                 unit = \\\'\\\'\\n280.             elif isinstance(unit, u.Unit):\\n281.                 unit = unit.to_string(format=\\\'vounit\\\')\\n282.             else:\\n283.                 try:\\n284.                     unit = u.Unit(unit).to_string(format=\\\'vounit\\\')\\n285.                 except u.UnitsError:\\n286.                     unit = \\\'\\\'\\n287.             units.append(unit)\\n288.         return units\\n289. \\n290.     @property\\n291.     def world_axis_names(self):\\n292.         return list(self.wcs.cname)\\n293. \\n294.     @property\\n295.     def axis_correlation_matrix(self):\\n296. \\n297.         # If there are any distortions present, we assume that there may be\\n298.         # correlations between all axes. Maybe if some distortions only apply\\n299.         # to the image plane we can improve this?\\n300.         if self.has_distortion:\\n301.             return np.ones((self.world_n_dim, self.pixel_n_dim), dtype=bool)\\n302. \\n303.         # Assuming linear world coordinates along each axis, the correlation\\n304.         # matrix would be given by whether or not the PC matrix is zero\\n305.         matrix = self.wcs.get_pc() != 0\\n306. \\n307.         # We now need to check specifically for celestial coordinates since\\n308.         # these can assume correlations because of spherical distortions. For\\n309.         # each celestial coordinate we copy over the pixel dependencies from\\n310.         # the other celestial coordinates.\\n311.         celestial = (self.wcs.axis_types // 1000) % 10 == 2\\n312.         celestial_indices = np.nonzero(celestial)[0]\\n313.         for world1 in celestial_indices:\\n314.             for world2 in celestial_indices:\\n315.                 if world1 != world2:\\n316.                     matrix[world1] |= matrix[world2]\\n317.                     matrix[world2] |= matrix[world1]\\n318. \\n319.         return matrix\\n320. \\n321.     def pixel_to_world_values(self, *pixel_arrays):\\n322.         world = self.all_pix2world(*pixel_arrays, 0)\\n323.         return world[0] if self.world_n_dim == 1 else tuple(world)\\n324. \\n325.     def world_to_pixel_values(self, *world_arrays):\\n326.         # avoid circular import\\n327.         from astropy.wcs.wcs import NoConvergence\\n328.         try:\\n329.             pixel = self.all_world2pix(*world_arrays, 0)\\n330.         except NoConvergence as e:\\n331.             warnings.warn(str(e))\\n332.             # use best_solution contained in the exception and format the same\\n333.             # way as all_world2pix does (using _array_converter)\\n334.             pixel = self._array_converter(lambda *args: e.best_solution,\\n335.                                          \\\'input\\\', *world_arrays, 0)\\n336. \\n337.         return pixel[0] if self.pixel_n_dim == 1 else tuple(pixel)\\n338. \\n339.     @property\\n340.     def world_axis_object_components(self):\\n341.         return self._get_components_and_classes()[0]\\n342. \\n343.     @property\\n344.     def world_axis_object_classes(self):\\n345.         return self._get_components_and_classes()[1]\\n346. \\n347.     @property\\n348.     def serialized_classes(self):\\n349.         return False\\n350. \\n351.     def _get_components_and_classes(self):\\n352. \\n353.         # The aim of this function is to return whatever is needed for\\n354.         # world_axis_object_components and world_axis_object_classes. It\\\'s easier\\n355.         # to figure it out in one go and then return the values and let the\\n356.         # properties return part of it.\\n357. \\n358.         # Since this method might get called quite a few times, we need to cache\\n359.         # it. We start off by defining a hash based on the attributes of the\\n360.         # WCS that matter here (we can\\\'t just use the WCS object as a hash since\\n361.         # it is mutable)\\n362.         wcs_hash = (self.naxis,\\n363.                     list(self.wcs.ctype),\\n364.                     list(self.wcs.cunit),\\n365.                     self.wcs.radesys,\\n366.                     self.wcs.specsys,\\n367.                     self.wcs.equinox,\\n368.                     self.wcs.dateobs,\\n369.                     self.wcs.lng,\\n370.                     self.wcs.lat)\\n371. \\n372.         # If the cache is present, we need to check that the \\\'hash\\\' matches.\\n373.         if getattr(self, \\\'_components_and_classes_cache\\\', None) is not None:\\n374.             cache = self._components_and_classes_cache\\n375.             if cache[0] == wcs_hash:\\n376.                 return cache[1]\\n377.             else:\\n378.                 self._components_and_classes_cache = None\\n379. \\n380.         # Avoid circular imports by importing here\\n381.         from astropy.wcs.utils import wcs_to_celestial_frame\\n382.         from astropy.coordinates import SkyCoord, EarthLocation\\n383.         from astropy.time.formats import FITS_DEPRECATED_SCALES\\n384.         from astropy.time import Time, TimeDelta\\n385. \\n386.         components = [None] * self.naxis\\n387.         classes = {}\\n388. \\n389.         # Let\\\'s start off by checking whether the WCS has a pair of celestial\\n390.         # components\\n391. \\n392.         if self.has_celestial:\\n393. \\n394.             try:\\n395.                 celestial_frame = wcs_to_celestial_frame(self)\\n396.             except ValueError:\\n397.                 # Some WCSes, e.g. solar, can be recognized by WCSLIB as being\\n398.                 # celestial but we don\\\'t necessarily have frames for them.\\n399.                 celestial_frame = None\\n400.             else:\\n401. \\n402.                 kwargs = {}\\n403.                 kwargs[\\\'frame\\\'] = celestial_frame\\n404.                 kwargs[\\\'unit\\\'] = u.deg\\n405. \\n406.                 classes[\\\'celestial\\\'] = (SkyCoord, (), kwargs)\\n407. \\n408.                 components[self.wcs.lng] = (\\\'celestial\\\', 0, \\\'spherical.lon.degree\\\')\\n409.                 components[self.wcs.lat] = (\\\'celestial\\\', 1, \\\'spherical.lat.degree\\\')\\n410. \\n411.         # Next, we check for spectral components\\n412. \\n413.         if self.has_spectral:\\n414. \\n415.             # Find index of spectral coordinate\\n416.             ispec = self.wcs.spec\\n417.             ctype = self.wcs.ctype[ispec][:4]\\n418.             ctype = ctype.upper()\\n419. \\n420.             kwargs = {}\\n421. \\n422.             # Determine observer location and velocity\\n423. \\n424.             # TODO: determine how WCS standard would deal with observer on a\\n425.             # spacecraft far from earth. For now assume the obsgeo parameters,\\n426.             # if present, give the geocentric observer location.\\n427. \\n428.             if np.isnan(self.wcs.obsgeo[0]):\\n429.                 observer = None\\n430.             else:\\n431.                 earth_location = EarthLocation(*self.wcs.obsgeo[:3], unit=u.m)\\n432. \\n433.                 # Get the time scale from TIMESYS or fall back to \\\'utc\\\'\\n434.                 tscale = self.wcs.timesys or \\\'utc\\\'\\n435. \\n436.                 if np.isnan(self.wcs.mjdavg):\\n437.                     obstime = Time(self.wcs.mjdobs, format=\\\'mjd\\\', scale=tscale,\\n438.                                    location=earth_location)\\n439.                 else:\\n440.                     obstime = Time(self.wcs.mjdavg, format=\\\'mjd\\\', scale=tscale,\\n441.                                    location=earth_location)\\n442.                 observer_location = SkyCoord(earth_location.get_itrs(obstime=obstime))\\n443. \\n444.                 if self.wcs.specsys in VELOCITY_FRAMES:\\n445.                     frame = VELOCITY_FRAMES[self.wcs.specsys]\\n446.                     observer = observer_location.transform_to(frame)\\n447.                     if isinstance(frame, str):\\n448.                         observer = attach_zero_velocities(observer)\\n449.                     else:\\n450.                         observer = update_differentials_to_match(observer_location,\\n451.                                                                  VELOCITY_FRAMES[self.wcs.specsys],\\n452.                                                                  preserve_observer_frame=True)\\n453.                 elif self.wcs.specsys == \\\'TOPOCENT\\\':\\n454.                     observer = attach_zero_velocities(observer_location)\\n455.                 else:\\n456.                     raise NotImplementedError(f\\\'SPECSYS={self.wcs.specsys} not yet supported\\\')\\n457. \\n458.             # Determine target\\n459. \\n460.             # This is tricker. In principle the target for each pixel is the\\n461.             # celestial coordinates of the pixel, but we then need to be very\\n462.             # careful about SSYSOBS which is tricky. For now, we set the\\n463.             # target using the reference celestial coordinate in the WCS (if\\n464.             # any).\\n465. \\n466.             if self.has_celestial and celestial_frame is not None:\\n467. \\n468.                 # NOTE: celestial_frame was defined higher up\\n469. \\n470.                 # NOTE: we set the distance explicitly to avoid warnings in SpectralCoord\\n471. \\n472.                 target = SkyCoord(self.wcs.crval[self.wcs.lng] * self.wcs.cunit[self.wcs.lng],\\n473.                                   self.wcs.crval[self.wcs.lat] * self.wcs.cunit[self.wcs.lat],\\n474.                                   frame=celestial_frame,\\n475.                                   distance=1000 * u.kpc)\\n476. \\n477.                 target = attach_zero_velocities(target)\\n478. \\n479.             else:\\n480. \\n481.                 target = None\\n482. \\n483.             # SpectralCoord does not work properly if either observer or target\\n484.             # are not convertible to ICRS, so if this is the case, we (for now)\\n485.             # drop the observer and target from the SpectralCoord and warn the\\n486.             # user.\\n487. \\n488.             if observer is not None:\\n489.                 try:\\n490.                     observer.transform_to(ICRS())\\n491.                 except Exception:\\n492.                     warnings.warn(\\\'observer cannot be converted to ICRS, so will \\\'\\n493.                                   \\\'not be set on SpectralCoord\\\', AstropyUserWarning)\\n494.                     observer = None\\n495. \\n496.             if target is not None:\\n497.                 try:\\n498.                     target.transform_to(ICRS())\\n499.                 except Exception:\\n500.                     warnings.warn(\\\'target cannot be converted to ICRS, so will \\\'\\n501.                                   \\\'not be set on SpectralCoord\\\', AstropyUserWarning)\\n502.                     target = None\\n503. \\n504.             # NOTE: below we include Quantity in classes[\\\'spectral\\\'] instead\\n505.             # of SpectralCoord - this is because we want to also be able to\\n506.             # accept plain quantities.\\n507. \\n508.             if ctype == \\\'ZOPT\\\':\\n509. \\n510.                 def spectralcoord_from_redshift(redshift):\\n511.                     if isinstance(redshift, SpectralCoord):\\n512.                         return redshift\\n513.                     return SpectralCoord((redshift + 1) * self.wcs.restwav,\\n514.                                          unit=u.m, observer=observer, target=target)\\n515. \\n516.                 def redshift_from_spectralcoord(spectralcoord):\\n517.                     # TODO: check target is consistent between WCS and SpectralCoord,\\n518.                     # if they are not the transformation doesn\\\'t make conceptual sense.\\n519.                     if (observer is None\\n520.                             or spectralcoord.observer is None\\n521.                             or spectralcoord.target is None):\\n522.                         if observer is None:\\n523.                             msg = \\\'No observer defined on WCS\\\'\\n524.                         elif spectralcoord.observer is None:\\n525.                             msg = \\\'No observer defined on SpectralCoord\\\'\\n526.                         else:\\n527.                             msg = \\\'No target defined on SpectralCoord\\\'\\n528.                         warnings.warn(f\\\'{msg}, SpectralCoord \\\'\\n529.                                       \\\'will be converted without any velocity \\\'\\n530.                                       \\\'frame change\\\', AstropyUserWarning)\\n531.                         return spectralcoord.to_value(u.m) / self.wcs.restwav - 1.\\n532.                     else:\\n533.                         return spectralcoord.with_observer_stationary_relative_to(observer).to_value(u.m) / self.wcs.restwav - 1.\\n534. \\n535.                 classes[\\\'spectral\\\'] = (u.Quantity, (), {}, spectralcoord_from_redshift)\\n536.                 components[self.wcs.spec] = (\\\'spectral\\\', 0, redshift_from_spectralcoord)\\n537. \\n538.             elif ctype == \\\'BETA\\\':\\n539. \\n540.                 def spectralcoord_from_beta(beta):\\n541.                     if isinstance(beta, SpectralCoord):\\n542.                         return beta\\n543.                     return SpectralCoord(beta * C_SI,\\n544.                                          unit=u.m / u.s,\\n545.                                          doppler_convention=\\\'relativistic\\\',\\n546.                                          doppler_rest=self.wcs.restwav * u.m,\\n547.                                          observer=observer, target=target)\\n548. \\n549.                 def beta_from_spectralcoord(spectralcoord):\\n550.                     # TODO: check target is consistent between WCS and SpectralCoord,\\n551.                     # if they are not the transformation doesn\\\'t make conceptual sense.\\n552.                     doppler_equiv = u.doppler_relativistic(self.wcs.restwav * u.m)\\n553.                     if (observer is None\\n554.                             or spectralcoord.observer is None\\n555.                             or spectralcoord.target is None):\\n556.                         if observer is None:\\n557.                             msg = \\\'No observer defined on WCS\\\'\\n558.                         elif spectralcoord.observer is None:\\n559.                             msg = \\\'No observer defined on SpectralCoord\\\'\\n560.                         else:\\n561.                             msg = \\\'No target defined on SpectralCoord\\\'\\n562.                         warnings.warn(f\\\'{msg}, SpectralCoord \\\'\\n563.                                       \\\'will be converted without any velocity \\\'\\n564.                                       \\\'frame change\\\', AstropyUserWarning)\\n565.                         return spectralcoord.to_value(u.m / u.s, doppler_equiv) / C_SI\\n566.                     else:\\n567.                         return spectralcoord.with_observer_stationary_relative_to(observer).to_value(u.m / u.s, doppler_equiv) / C_SI\\n568. \\n569.                 classes[\\\'spectral\\\'] = (u.Quantity, (), {}, spectralcoord_from_beta)\\n570.                 components[self.wcs.spec] = (\\\'spectral\\\', 0, beta_from_spectralcoord)\\n571. \\n572.             else:\\n573. \\n574.                 kwargs[\\\'unit\\\'] = self.wcs.cunit[ispec]\\n575. \\n576.                 if self.wcs.restfrq > 0:\\n577.                     if ctype == \\\'VELO\\\':\\n578.                         kwargs[\\\'doppler_convention\\\'] = \\\'relativistic\\\'\\n579.                         kwargs[\\\'doppler_rest\\\'] = self.wcs.restfrq * u.Hz\\n580.                     elif ctype == \\\'VRAD\\\':\\n581.                         kwargs[\\\'doppler_convention\\\'] = \\\'radio\\\'\\n582.                         kwargs[\\\'doppler_rest\\\'] = self.wcs.restfrq * u.Hz\\n583.                     elif ctype == \\\'VOPT\\\':\\n584.                         kwargs[\\\'doppler_convention\\\'] = \\\'optical\\\'\\n585.                         kwargs[\\\'doppler_rest\\\'] = self.wcs.restwav * u.m\\n586. \\n587.                 def spectralcoord_from_value(value):\\n588.                     if isinstance(value, SpectralCoord):\\n589.                         return value\\n590.                     return SpectralCoord(value, observer=observer, target=target, **kwargs)\\n591. \\n592.                 def value_from_spectralcoord(spectralcoord):\\n593.                     # TODO: check target is consistent between WCS and SpectralCoord,\\n594.                     # if they are not the transformation doesn\\\'t make conceptual sense.\\n595.                     if (observer is None\\n596.                             or spectralcoord.observer is None\\n597.                             or spectralcoord.target is None):\\n598.                         if observer is None:\\n599.                             msg = \\\'No observer defined on WCS\\\'\\n600.                         elif spectralcoord.observer is None:\\n601.                             msg = \\\'No observer defined on SpectralCoord\\\'\\n602.                         else:\\n603.                             msg = \\\'No target defined on SpectralCoord\\\'\\n604.                         warnings.warn(f\\\'{msg}, SpectralCoord \\\'\\n605.                                       \\\'will be converted without any velocity \\\'\\n606.                                       \\\'frame change\\\', AstropyUserWarning)\\n607.                         return spectralcoord.to_value(**kwargs)\\n608.                     else:\\n609.                         return spectralcoord.with_observer_stationary_relative_to(observer).to_value(**kwargs)\\n610. \\n611.                 classes[\\\'spectral\\\'] = (u.Quantity, (), {}, spectralcoord_from_value)\\n612.                 components[self.wcs.spec] = (\\\'spectral\\\', 0, value_from_spectralcoord)\\n613. \\n614.         # We can then make sure we correctly return Time objects where appropriate\\n615.         # (https://www.aanda.org/articles/aa/pdf/2015/02/aa24653-14.pdf)\\n616. \\n617.         if \\\'time\\\' in self.world_axis_physical_types:\\n618. \\n619.             multiple_time = self.world_axis_physical_types.count(\\\'time\\\') > 1\\n620. \\n621.             for i in range(self.naxis):\\n622. \\n623.                 if self.world_axis_physical_types[i] == \\\'time\\\':\\n624. \\n625.                     if multiple_time:\\n626.                         name = f\\\'time.{i}\\\'\\n627.                     else:\\n628.                         name = \\\'time\\\'\\n629. \\n630.                     # Initialize delta\\n631.                     reference_time_delta = None\\n632. \\n633.                     # Extract time scale\\n634.                     scale = self.wcs.ctype[i].lower()\\n635. \\n636.                     if scale == \\\'time\\\':\\n637.                         if self.wcs.timesys:\\n638.                             scale = self.wcs.timesys.lower()\\n639.                         else:\\n640.                             scale = \\\'utc\\\'\\n641. \\n642.                     # Drop sub-scales\\n643.                     if \\\'(\\\' in scale:\\n644.                         pos = scale.index(\\\'(\\\')\\n645.                         scale, subscale = scale[:pos], scale[pos+1:-1]\\n646.                         warnings.warn(f\\\'Dropping unsupported sub-scale \\\'\\n647.                                       f\\\'{subscale.upper()} from scale {scale.upper()}\\\',\\n648.                                       UserWarning)\\n649. \\n650.                     # TODO: consider having GPS as a scale in Time\\n651.                     # For now GPS is not a scale, we approximate this by TAI - 19s\\n652.                     if scale == \\\'gps\\\':\\n653.                         reference_time_delta = TimeDelta(19, format=\\\'sec\\\')\\n654.                         scale = \\\'tai\\\'\\n655. \\n656.                     elif scale.upper() in FITS_DEPRECATED_SCALES:\\n657.                         scale = FITS_DEPRECATED_SCALES[scale.upper()]\\n658. \\n659.                     elif scale not in Time.SCALES:\\n660.                         raise ValueError(f\\\'Unrecognized time CTYPE={self.wcs.ctype[i]}\\\')\\n661. \\n662.                     # Determine location\\n663.                     trefpos = self.wcs.trefpos.lower()\\n664. \\n665.                     if trefpos.startswith(\\\'topocent\\\'):\\n666.                         # Note that some headers use TOPOCENT instead of TOPOCENTER\\n667.                         if np.any(np.isnan(self.wcs.obsgeo[:3])):\\n668.                             warnings.warn(\\\'Missing or incomplete observer location \\\'\\n669.                                           \\\'information, setting location in Time to None\\\',\\n670.                                           UserWarning)\\n671.                             location = None\\n672.                         else:\\n673.                             location = EarthLocation(*self.wcs.obsgeo[:3], unit=u.m)\\n674.                     elif trefpos == \\\'geocenter\\\':\\n675.                         location = EarthLocation(0, 0, 0, unit=u.m)\\n676.                     elif trefpos == \\\'\\\':\\n677.                         location = None\\n678.                     else:\\n679.                         # TODO: implement support for more locations when Time supports it\\n680.                         warnings.warn(f"Observation location \\\'{trefpos}\\\' is not "\\n681.                                        "supported, setting location in Time to None", UserWarning)\\n682.                         location = None\\n683. \\n684.                     reference_time = Time(np.nan_to_num(self.wcs.mjdref[0]),\\n685.                                           np.nan_to_num(self.wcs.mjdref[1]),\\n686.                                           format=\\\'mjd\\\', scale=scale,\\n687.                                           location=location)\\n688. \\n689.                     if reference_time_delta is not None:\\n690.                         reference_time = reference_time + reference_time_delta\\n691. \\n692.                     def time_from_reference_and_offset(offset):\\n693.                         if isinstance(offset, Time):\\n694.                             return offset\\n695.                         return reference_time + TimeDelta(offset, format=\\\'sec\\\')\\n696. \\n697.                     def offset_from_time_and_reference(time):\\n698.                         return (time - reference_time).sec\\n699. \\n700.                     classes[name] = (Time, (), {}, time_from_reference_and_offset)\\n701.                     components[i] = (name, 0, offset_from_time_and_reference)\\n702. \\n703.         # Fallback: for any remaining components that haven\\\'t been identified, just\\n704.         # return Quantity as the class to use\\n705. \\n706.         for i in range(self.naxis):\\n707.             if components[i] is None:\\n708.                 name = self.wcs.ctype[i].split(\\\'-\\\')[0].lower()\\n709.                 if name == \\\'\\\':\\n710.                     name = \\\'world\\\'\\n711.                 while name in classes:\\n712.                     name += "_"\\n713.                 classes[name] = (u.Quantity, (), {\\\'unit\\\': self.wcs.cunit[i]})\\n714.                 components[i] = (name, 0, \\\'value\\\')\\n715. \\n716.         # Keep a cached version of result\\n717.         self._components_and_classes_cache = wcs_hash, (components, classes)\\n718. \\n719.         return components, classes\', \'start_line_number\': 196, \'end_line_number\': 719}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/high_level_wcs_wrapper.py\', \'content\': \'1. from .high_level_api import HighLevelWCSMixin\\n2. from .low_level_api import BaseLowLevelWCS\\n3. from .utils import wcs_info_str\\n4. \\n5. __all__ = [\\\'HighLevelWCSWrapper\\\']\\n6. \\n7. \\n8. class HighLevelWCSWrapper(HighLevelWCSMixin):\\n9.     """\\n10.     Wrapper class that can take any :class:`~astropy.wcs.wcsapi.BaseLowLevelWCS`\\n11.     object and expose the high-level WCS API.\\n12.     """\\n13. \\n14.     def __init__(self, low_level_wcs):\\n15.         if not isinstance(low_level_wcs, BaseLowLevelWCS):\\n16.             raise TypeError(\\\'Input to a HighLevelWCSWrapper must be a low level WCS object\\\')\\n17. \\n18.         self._low_level_wcs = low_level_wcs\\n19. \\n20.     @property\\n21.     def low_level_wcs(self):\\n22.         return self._low_level_wcs\\n23. \\n24.     @property\\n25.     def pixel_n_dim(self):\\n26.         """\\n27.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim`\\n28.         """\\n29.         return self.low_level_wcs.pixel_n_dim\\n30. \\n31.     @property\\n32.     def world_n_dim(self):\\n33.         """\\n34.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim`\\n35.         """\\n36.         return self.low_level_wcs.world_n_dim\\n37. \\n38.     @property\\n39.     def world_axis_physical_types(self):\\n40.         """\\n41.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.world_axis_physical_types`\\n42.         """\\n43.         return self.low_level_wcs.world_axis_physical_types\\n44. \\n45.     @property\\n46.     def world_axis_units(self):\\n47.         """\\n48.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.world_axis_units`\\n49.         """\\n50.         return self.low_level_wcs.world_axis_units\\n51. \\n52.     @property\\n53.     def array_shape(self):\\n54.         """\\n55.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.array_shape`\\n56.         """\\n57.         return self.low_level_wcs.array_shape\\n58. \\n59.     @property\\n60.     def pixel_bounds(self):\\n61.         """\\n62.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_bounds`\\n63.         """\\n64.         return self.low_level_wcs.pixel_bounds\\n65. \\n66.     @property\\n67.     def axis_correlation_matrix(self):\\n68.         """\\n69.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS.axis_correlation_matrix`\\n70.         """\\n71.         return self.low_level_wcs.axis_correlation_matrix\\n72. \\n73.     def _as_mpl_axes(self):\\n74.         """\\n75.         See `~astropy.wcs.wcsapi.BaseLowLevelWCS._as_mpl_axes`\\n76.         """\\n77.         return self.low_level_wcs._as_mpl_axes()\\n78. \\n79.     def __str__(self):\\n80.         return wcs_info_str(self.low_level_wcs)\\n81. \\n82.     def __repr__(self):\\n83.         return f"{object.__repr__(self)}\\\\n{str(self)}"\', \'start_line_number\': 1, \'end_line_number\': 83}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/wrappers/sliced_wcs.py\', \'content\': \'1. import numbers\\n2. from collections import defaultdict\\n3. \\n4. import numpy as np\\n5. \\n6. from astropy.utils import isiterable\\n7. from astropy.utils.decorators import lazyproperty\\n8. \\n9. from ..low_level_api import BaseLowLevelWCS\\n10. from .base import BaseWCSWrapper\\n11. \\n12. __all__ = [\\\'sanitize_slices\\\', \\\'SlicedLowLevelWCS\\\']\\n13. \\n14. \\n15. def sanitize_slices(slices, ndim):\\n16.     """\\n17.     Given a slice as input sanitise it to an easier to parse format.format\\n18. \\n19.     This function returns a list ``ndim`` long containing slice objects (or ints).\\n20.     """\\n21. \\n22.     if not isinstance(slices, (tuple, list)):  # We just have a single int\\n23.         slices = (slices,)\\n24. \\n25.     if len(slices) > ndim:\\n26.         raise ValueError(\\n27.             f"The dimensionality of the specified slice {slices} can not be greater "\\n28.             f"than the dimensionality ({ndim}) of the wcs.")\\n29. \\n30.     if any(isiterable(s) for s in slices):\\n31.         raise IndexError("This slice is invalid, only integer or range slices are supported.")\\n32. \\n33.     slices = list(slices)\\n34. \\n35.     if Ellipsis in slices:\\n36.         if slices.count(Ellipsis) > 1:\\n37.             raise IndexError("an index can only have a single ellipsis (\\\'...\\\')")\\n38. \\n39.         # Replace the Ellipsis with the correct number of slice(None)s\\n40.         e_ind = slices.index(Ellipsis)\\n41.         slices.remove(Ellipsis)\\n42.         n_e = ndim - len(slices)\\n43.         for i in range(n_e):\\n44.             ind = e_ind + i\\n45.             slices.insert(ind, slice(None))\\n46. \\n47.     for i in range(ndim):\\n48.         if i < len(slices):\\n49.             slc = slices[i]\\n50.             if isinstance(slc, slice):\\n51.                 if slc.step and slc.step != 1:\\n52.                     raise IndexError("Slicing WCS with a step is not supported.")\\n53.             elif not isinstance(slc, numbers.Integral):\\n54.                 raise IndexError("Only integer or range slices are accepted.")\\n55.         else:\\n56.             slices.append(slice(None))\\n57. \\n58.     return slices\\n59. \\n60. \\n61. def combine_slices(slice1, slice2):\\n62.     """\\n63.     Given two slices that can be applied to a 1-d array, find the resulting\\n64.     slice that corresponds to the combination of both slices. We assume that\\n65.     slice2 can be an integer, but slice1 cannot.\\n66.     """\\n67. \\n68.     if isinstance(slice1, slice) and slice1.step is not None:\\n69.         raise ValueError(\\\'Only slices with steps of 1 are supported\\\')\\n70. \\n71.     if isinstance(slice2, slice) and slice2.step is not None:\\n72.         raise ValueError(\\\'Only slices with steps of 1 are supported\\\')\\n73. \\n74.     if isinstance(slice2, numbers.Integral):\\n75.         if slice1.start is None:\\n76.             return slice2\\n77.         else:\\n78.             return slice2 + slice1.start\\n79. \\n80.     if slice1.start is None:\\n81.         if slice1.stop is None:\\n82.             return slice2\\n83.         else:\\n84.             if slice2.stop is None:\\n85.                 return slice(slice2.start, slice1.stop)\\n86.             else:\\n87.                 return slice(slice2.start, min(slice1.stop, slice2.stop))\\n88.     else:\\n89.         if slice2.start is None:\\n90.             start = slice1.start\\n91.         else:\\n92.             start = slice1.start + slice2.start\\n93.         if slice2.stop is None:\\n94.             stop = slice1.stop\\n95.         else:\\n96.             if slice1.start is None:\\n97.                 stop = slice2.stop\\n98.             else:\\n99.                 stop = slice2.stop + slice1.start\\n100.             if slice1.stop is not None:\\n101.                 stop = min(slice1.stop, stop)\\n102.     return slice(start, stop)\\n103. \\n104. \\n105. class SlicedLowLevelWCS(BaseWCSWrapper):\\n106.     """\\n107.     A Low Level WCS wrapper which applies an array slice to a WCS.\\n108. \\n109.     This class does not modify the underlying WCS object and can therefore drop\\n110.     coupled dimensions as it stores which pixel and world dimensions have been\\n111.     sliced out (or modified) in the underlying WCS and returns the modified\\n112.     results on all the Low Level WCS methods.\\n113. \\n114.     Parameters\\n115.     ----------\\n116.     wcs : `~astropy.wcs.wcsapi.BaseLowLevelWCS`\\n117.         The WCS to slice.\\n118.     slices : `slice` or `tuple` or `int`\\n119.         A valid array slice to apply to the WCS.\\n120. \\n121.     """\\n122.     def __init__(self, wcs, slices):\\n123. \\n124.         slices = sanitize_slices(slices, wcs.pixel_n_dim)\\n125. \\n126.         if isinstance(wcs, SlicedLowLevelWCS):\\n127.             # Here we combine the current slices with the previous slices\\n128.             # to avoid ending up with many nested WCSes\\n129.             self._wcs = wcs._wcs\\n130.             slices_original = wcs._slices_array.copy()\\n131.             for ipixel in range(wcs.pixel_n_dim):\\n132.                 ipixel_orig = wcs._wcs.pixel_n_dim - 1 - wcs._pixel_keep[ipixel]\\n133.                 ipixel_new = wcs.pixel_n_dim - 1 - ipixel\\n134.                 slices_original[ipixel_orig] = combine_slices(slices_original[ipixel_orig],\\n135.                                                               slices[ipixel_new])\\n136.             self._slices_array = slices_original\\n137.         else:\\n138.             self._wcs = wcs\\n139.             self._slices_array = slices\\n140. \\n141.         self._slices_pixel = self._slices_array[::-1]\\n142. \\n143.         # figure out which pixel dimensions have been kept, then use axis correlation\\n144.         # matrix to figure out which world dims are kept\\n145.         self._pixel_keep = np.nonzero([not isinstance(self._slices_pixel[ip], numbers.Integral)\\n146.                                        for ip in range(self._wcs.pixel_n_dim)])[0]\\n147. \\n148.         # axis_correlation_matrix[world, pixel]\\n149.         self._world_keep = np.nonzero(\\n150.             self._wcs.axis_correlation_matrix[:, self._pixel_keep].any(axis=1))[0]\\n151. \\n152.         if len(self._pixel_keep) == 0 or len(self._world_keep) == 0:\\n153.             raise ValueError("Cannot slice WCS: the resulting WCS should have "\\n154.                              "at least one pixel and one world dimension.")\\n155. \\n156.     @lazyproperty\\n157.     def dropped_world_dimensions(self):\\n158.         """\\n159.         Information describing the dropped world dimensions.\\n160.         """\\n161.         world_coords = self._pixel_to_world_values_all(*[0]*len(self._pixel_keep))\\n162.         dropped_info = defaultdict(list)\\n163. \\n164.         for i in range(self._wcs.world_n_dim):\\n165. \\n166.             if i in self._world_keep:\\n167.                 continue\\n168. \\n169.             if "world_axis_object_classes" not in dropped_info:\\n170.                 dropped_info["world_axis_object_classes"] = dict()\\n171. \\n172.             wao_classes = self._wcs.world_axis_object_classes\\n173.             wao_components = self._wcs.world_axis_object_components\\n174. \\n175.             dropped_info["value"].append(world_coords[i])\\n176.             dropped_info["world_axis_names"].append(self._wcs.world_axis_names[i])\\n177.             dropped_info["world_axis_physical_types"].append(self._wcs.world_axis_physical_types[i])\\n178.             dropped_info["world_axis_units"].append(self._wcs.world_axis_units[i])\\n179.             dropped_info["world_axis_object_components"].append(wao_components[i])\\n180.             dropped_info["world_axis_object_classes"].update(dict(\\n181.                 filter(\\n182.                     lambda x: x[0] == wao_components[i][0], wao_classes.items()\\n183.                 )\\n184.             ))\\n185.             dropped_info["serialized_classes"] = self.serialized_classes\\n186.         return dict(dropped_info)\\n187. \\n188.     @property\\n189.     def pixel_n_dim(self):\\n190.         return len(self._pixel_keep)\\n191. \\n192.     @property\\n193.     def world_n_dim(self):\\n194.         return len(self._world_keep)\\n195. \\n196.     @property\\n197.     def world_axis_physical_types(self):\\n198.         return [self._wcs.world_axis_physical_types[i] for i in self._world_keep]\\n199. \\n200.     @property\\n201.     def world_axis_units(self):\\n202.         return [self._wcs.world_axis_units[i] for i in self._world_keep]\\n203. \\n204.     @property\\n205.     def pixel_axis_names(self):\\n206.         return [self._wcs.pixel_axis_names[i] for i in self._pixel_keep]\\n207. \\n208.     @property\\n209.     def world_axis_names(self):\\n210.         return [self._wcs.world_axis_names[i] for i in self._world_keep]\\n211. \\n212.     def _pixel_to_world_values_all(self, *pixel_arrays):\\n213.         pixel_arrays = tuple(map(np.asanyarray, pixel_arrays))\\n214.         pixel_arrays_new = []\\n215.         ipix_curr = -1\\n216.         for ipix in range(self._wcs.pixel_n_dim):\\n217.             if isinstance(self._slices_pixel[ipix], numbers.Integral):\\n218.                 pixel_arrays_new.append(self._slices_pixel[ipix])\\n219.             else:\\n220.                 ipix_curr += 1\\n221.                 if self._slices_pixel[ipix].start is not None:\\n222.                     pixel_arrays_new.append(pixel_arrays[ipix_curr] + self._slices_pixel[ipix].start)\\n223.                 else:\\n224.                     pixel_arrays_new.append(pixel_arrays[ipix_curr])\\n225. \\n226.         pixel_arrays_new = np.broadcast_arrays(*pixel_arrays_new)\\n227.         return self._wcs.pixel_to_world_values(*pixel_arrays_new)\\n228. \\n229.     def pixel_to_world_values(self, *pixel_arrays):\\n230.         world_arrays = self._pixel_to_world_values_all(*pixel_arrays)\\n231. \\n232.         # Detect the case of a length 0 array\\n233.         if isinstance(world_arrays, np.ndarray) and not world_arrays.shape:\\n234.             return world_arrays\\n235. \\n236.         if self._wcs.world_n_dim > 1:\\n237.             # Select the dimensions of the original WCS we are keeping.\\n238.             world_arrays = [world_arrays[iw] for iw in self._world_keep]\\n239.             # If there is only one world dimension (after slicing) we shouldn\\\'t return a tuple.\\n240.             if self.world_n_dim == 1:\\n241.                 world_arrays = world_arrays[0]\\n242. \\n243.         return world_arrays\\n244. \\n245.     def world_to_pixel_values(self, *world_arrays):\\n246.         world_arrays = tuple(map(np.asanyarray, world_arrays))\\n247.         world_arrays_new = []\\n248.         iworld_curr = -1\\n249.         for iworld in range(self._wcs.world_n_dim):\\n250.             if iworld in self._world_keep:\\n251.                 iworld_curr += 1\\n252.                 world_arrays_new.append(world_arrays[iworld_curr])\\n253.             else:\\n254.                 world_arrays_new.append(1.)\\n255. \\n256.         world_arrays_new = np.broadcast_arrays(*world_arrays_new)\\n257.         pixel_arrays = list(self._wcs.world_to_pixel_values(*world_arrays_new))\\n258. \\n259.         for ipixel in range(self._wcs.pixel_n_dim):\\n260.             if isinstance(self._slices_pixel[ipixel], slice) and self._slices_pixel[ipixel].start is not None:\\n261.                 pixel_arrays[ipixel] -= self._slices_pixel[ipixel].start\\n262. \\n263.         # Detect the case of a length 0 array\\n264.         if isinstance(pixel_arrays, np.ndarray) and not pixel_arrays.shape:\\n265.             return pixel_arrays\\n266.         pixel = tuple(pixel_arrays[ip] for ip in self._pixel_keep)\\n267.         if self.pixel_n_dim == 1 and self._wcs.pixel_n_dim > 1:\\n268.             pixel = pixel[0]\\n269.         return pixel\\n270. \\n271.     @property\\n272.     def world_axis_object_components(self):\\n273.         return [self._wcs.world_axis_object_components[idx] for idx in self._world_keep]\\n274. \\n275.     @property\\n276.     def world_axis_object_classes(self):\\n277.         keys_keep = [item[0] for item in self.world_axis_object_components]\\n278.         return dict([item for item in self._wcs.world_axis_object_classes.items() if item[0] in keys_keep])\\n279. \\n280.     @property\\n281.     def array_shape(self):\\n282.         if self._wcs.array_shape:\\n283.             return np.broadcast_to(0, self._wcs.array_shape)[tuple(self._slices_array)].shape\\n284. \\n285.     @property\\n286.     def pixel_shape(self):\\n287.         if self.array_shape:\\n288.             return tuple(self.array_shape[::-1])\\n289. \\n290.     @property\\n291.     def pixel_bounds(self):\\n292.         if self._wcs.pixel_bounds is None:\\n293.             return\\n294. \\n295.         bounds = []\\n296.         for idx in self._pixel_keep:\\n297.             if self._slices_pixel[idx].start is None:\\n298.                 bounds.append(self._wcs.pixel_bounds[idx])\\n299.             else:\\n300.                 imin, imax = self._wcs.pixel_bounds[idx]\\n301.                 start = self._slices_pixel[idx].start\\n302.                 bounds.append((imin - start, imax - start))\\n303. \\n304.         return tuple(bounds)\\n305. \\n306.     @property\\n307.     def axis_correlation_matrix(self):\\n308.         return self._wcs.axis_correlation_matrix[self._world_keep][:, self._pixel_keep]\', \'start_line_number\': 1, \'end_line_number\': 308}\n\nTest Case Context (similar existing tests for reference):\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_fitswcs.py\', \'content\': \'1. # Note that we test the main astropy.wcs.WCS class directly rather than testing\\n2. # the mix-in class on its own (since it\\\'s not functional without being used as\\n3. # a mix-in)\\n4. \\n5. import warnings\\n6. \\n7. from packaging.version import Version\\n8. import numpy as np\\n9. import pytest\\n10. from numpy.testing import assert_equal, assert_allclose\\n11. from itertools import product\\n12. \\n13. from astropy import units as u\\n14. from astropy.time import Time\\n15. from astropy.tests.helper import assert_quantity_allclose\\n16. from astropy.units import Quantity\\n17. from astropy.coordinates import ICRS, FK5, Galactic, SkyCoord, SpectralCoord, ITRS, EarthLocation\\n18. from astropy.io.fits import Header\\n19. from astropy.io.fits.verify import VerifyWarning\\n20. from astropy.units.core import UnitsWarning\\n21. from astropy.utils.data import get_pkg_data_filename\\n22. from astropy.wcs.wcs import WCS, FITSFixedWarning, Sip, NoConvergence\\n23. from astropy.wcs.wcsapi.fitswcs import custom_ctype_to_ucd_mapping, VELOCITY_FRAMES\\n24. from astropy.wcs._wcs import __version__ as wcsver\\n25. from astropy.utils import iers\\n26. from astropy.utils.exceptions import AstropyUserWarning\\n27. \\n28. ###############################################################################\\n29. # The following example is the simplest WCS with default values\\n30. ###############################################################################\\n31. \\n32. \\n33. WCS_EMPTY = WCS(naxis=1)\\n34. WCS_EMPTY.wcs.crpix = [1]\\n35. \\n36. \\n37. def test_empty():\\n38. \\n39.     wcs = WCS_EMPTY\\n40. \\n41.     # Low-level API\\n42. \\n43.     assert wcs.pixel_n_dim == 1\\n44.     assert wcs.world_n_dim == 1\\n45.     assert wcs.array_shape is None\\n46.     assert wcs.pixel_shape is None\\n47.     assert wcs.world_axis_physical_types == [None]\\n48.     assert wcs.world_axis_units == [\\\'\\\']\\n49.     assert wcs.pixel_axis_names == [\\\'\\\']\\n50.     assert wcs.world_axis_names == [\\\'\\\']\\n51. \\n52.     assert_equal(wcs.axis_correlation_matrix, True)\\n53. \\n54.     assert wcs.world_axis_object_components == [(\\\'world\\\', 0, \\\'value\\\')]\\n55. \\n56.     assert wcs.world_axis_object_classes[\\\'world\\\'][0] is Quantity\\n57.     assert wcs.world_axis_object_classes[\\\'world\\\'][1] == ()\\n58.     assert wcs.world_axis_object_classes[\\\'world\\\'][2][\\\'unit\\\'] is u.one\\n59. \\n60.     assert_allclose(wcs.pixel_to_world_values(29), 29)\\n61.     assert_allclose(wcs.array_index_to_world_values(29), 29)\\n62. \\n63.     assert np.ndim(wcs.pixel_to_world_values(29)) == 0\\n64.     assert np.ndim(wcs.array_index_to_world_values(29)) == 0\\n65. \\n66.     assert_allclose(wcs.world_to_pixel_values(29), 29)\\n67.     assert_equal(wcs.world_to_array_index_values(29), (29,))\\n68. \\n69.     assert np.ndim(wcs.world_to_pixel_values(29)) == 0\\n70.     assert np.ndim(wcs.world_to_array_index_values(29)) == 0\\n71. \\n72.     # High-level API\\n73. \\n74.     coord = wcs.pixel_to_world(29)\\n75.     assert_quantity_allclose(coord, 29 * u.one)\\n76.     assert np.ndim(coord) == 0\\n77. \\n78.     coord = wcs.array_index_to_world(29)\\n79.     assert_quantity_allclose(coord, 29 * u.one)\\n80.     assert np.ndim(coord) == 0\\n81. \\n82.     coord = 15 * u.one\\n83. \\n84.     x = wcs.world_to_pixel(coord)\\n85.     assert_allclose(x, 15.)\\n86.     assert np.ndim(x) == 0\\n87. \\n88.     i = wcs.world_to_array_index(coord)\\n89.     assert_equal(i, 15)\\n90.     assert np.ndim(i) == 0\\n91. \\n92. \\n93. ###############################################################################\\n94. # The following example is a simple 2D image with celestial coordinates\\n95. ###############################################################################\\n96. \\n97. HEADER_SIMPLE_CELESTIAL = """\\n98. WCSAXES = 2\\n99. CTYPE1  = RA---TAN\\n100. CTYPE2  = DEC--TAN\\n101. CRVAL1  = 10\\n102. CRVAL2  = 20\\n103. CRPIX1  = 30\\n104. CRPIX2  = 40\\n105. CDELT1  = -0.1\\n106. CDELT2  =  0.1\\n107. CROTA2  = 0.\\n108. CUNIT1  = deg\\n109. CUNIT2  = deg\\n110. """\\n111. \\n112. with warnings.catch_warnings():\\n113.     warnings.simplefilter(\\\'ignore\\\', VerifyWarning)\\n114.     WCS_SIMPLE_CELESTIAL = WCS(Header.fromstring(\\n115.         HEADER_SIMPLE_CELESTIAL, sep=\\\'\\\\n\\\'))\\n116. \\n117. \\n118. def test_simple_celestial():\\n119. \\n120.     wcs = WCS_SIMPLE_CELESTIAL\\n121. \\n122.     # Low-level API\\n123. \\n124.     assert wcs.pixel_n_dim == 2\\n125.     assert wcs.world_n_dim == 2\\n126.     assert wcs.array_shape is None\\n127.     assert wcs.pixel_shape is None\\n128.     assert wcs.world_axis_physical_types == [\\\'pos.eq.ra\\\', \\\'pos.eq.dec\\\']\\n129.     assert wcs.world_axis_units == [\\\'deg\\\', \\\'deg\\\']\\n130.     assert wcs.pixel_axis_names == [\\\'\\\', \\\'\\\']\\n131.     assert wcs.world_axis_names == [\\\'\\\', \\\'\\\']\\n132. \\n133.     assert_equal(wcs.axis_correlation_matrix, True)\\n134. \\n135.     assert wcs.world_axis_object_components == [(\\\'celestial\\\', 0, \\\'spherical.lon.degree\\\'),\\n136.                                                 (\\\'celestial\\\', 1, \\\'spherical.lat.degree\\\')]\\n137. \\n138.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][0] is SkyCoord\\n139.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][1] == ()\\n140.     assert isinstance(wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'frame\\\'], ICRS)\\n141.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'unit\\\'] is u.deg\\n142. \\n143.     assert_allclose(wcs.pixel_to_world_values(29, 39), (10, 20))\\n144.     assert_allclose(wcs.array_index_to_world_values(39, 29), (10, 20))\\n145. \\n146.     assert_allclose(wcs.world_to_pixel_values(10, 20), (29., 39.))\\n147.     assert_equal(wcs.world_to_array_index_values(10, 20), (39, 29))\\n148. \\n149.     # High-level API\\n150. \\n151.     coord = wcs.pixel_to_world(29, 39)\\n152.     assert isinstance(coord, SkyCoord)\\n153.     assert isinstance(coord.frame, ICRS)\\n154.     assert_allclose(coord.ra.deg, 10)\\n155.     assert_allclose(coord.dec.deg, 20)\\n156. \\n157.     coord = wcs.array_index_to_world(39, 29)\\n158.     assert isinstance(coord, SkyCoord)\\n159.     assert isinstance(coord.frame, ICRS)\\n160.     assert_allclose(coord.ra.deg, 10)\\n161.     assert_allclose(coord.dec.deg, 20)\\n162. \\n163.     coord = SkyCoord(10, 20, unit=\\\'deg\\\', frame=\\\'icrs\\\')\\n164. \\n165.     x, y = wcs.world_to_pixel(coord)\\n166.     assert_allclose(x, 29.)\\n167.     assert_allclose(y, 39.)\\n168. \\n169.     i, j = wcs.world_to_array_index(coord)\\n170.     assert_equal(i, 39)\\n171.     assert_equal(j, 29)\\n172. \\n173.     # Check that if the coordinates are passed in a different frame things still\\n174.     # work properly\\n175. \\n176.     coord_galactic = coord.galactic\\n177. \\n178.     x, y = wcs.world_to_pixel(coord_galactic)\\n179.     assert_allclose(x, 29.)\\n180.     assert_allclose(y, 39.)\\n181. \\n182.     i, j = wcs.world_to_array_index(coord_galactic)\\n183.     assert_equal(i, 39)\\n184.     assert_equal(j, 29)\\n185. \\n186.     # Check that we can actually index the array\\n187. \\n188.     data = np.arange(3600).reshape((60, 60))\\n189. \\n190.     coord = SkyCoord(10, 20, unit=\\\'deg\\\', frame=\\\'icrs\\\')\\n191.     index = wcs.world_to_array_index(coord)\\n192.     assert_equal(data[index], 2369)\\n193. \\n194.     coord = SkyCoord([10, 12], [20, 22], unit=\\\'deg\\\', frame=\\\'icrs\\\')\\n195.     index = wcs.world_to_array_index(coord)\\n196.     assert_equal(data[index], [2369, 3550])\\n197. \\n198. \\n199. ###############################################################################\\n200. # The following example is a spectral cube with axes in an unusual order\\n201. ###############################################################################\\n202. \\n203. HEADER_SPECTRAL_CUBE = """\\n204. WCSAXES = 3\\n205. CTYPE1  = GLAT-CAR\\n206. CTYPE2  = FREQ\\n207. CTYPE3  = GLON-CAR\\n208. CNAME1  = Latitude\\n209. CNAME2  = Frequency\\n210. CNAME3  = Longitude\\n211. CRVAL1  = 10\\n212. CRVAL2  = 20\\n213. CRVAL3  = 25\\n214. CRPIX1  = 30\\n215. CRPIX2  = 40\\n216. CRPIX3  = 45\\n217. CDELT1  = -0.1\\n218. CDELT2  =  0.5\\n219. CDELT3  =  0.1\\n220. CUNIT1  = deg\\n221. CUNIT2  = Hz\\n222. CUNIT3  = deg\\n223. """\\n224. \\n225. with warnings.catch_warnings():\\n226.     warnings.simplefilter(\\\'ignore\\\', VerifyWarning)\\n227.     WCS_SPECTRAL_CUBE = WCS(Header.fromstring(HEADER_SPECTRAL_CUBE, sep=\\\'\\\\n\\\'))\\n228. \\n229. \\n230. def test_spectral_cube():\\n231. \\n232.     # Spectral cube with a weird axis ordering\\n233. \\n234.     wcs = WCS_SPECTRAL_CUBE\\n235. \\n236.     # Low-level API\\n237. \\n238.     assert wcs.pixel_n_dim == 3\\n239.     assert wcs.world_n_dim == 3\\n240.     assert wcs.array_shape is None\\n241.     assert wcs.pixel_shape is None\\n242.     assert wcs.world_axis_physical_types == [\\\'pos.galactic.lat\\\', \\\'em.freq\\\', \\\'pos.galactic.lon\\\']\\n243.     assert wcs.world_axis_units == [\\\'deg\\\', \\\'Hz\\\', \\\'deg\\\']\\n244.     assert wcs.pixel_axis_names == [\\\'\\\', \\\'\\\', \\\'\\\']\\n245.     assert wcs.world_axis_names == [\\\'Latitude\\\', \\\'Frequency\\\', \\\'Longitude\\\']\\n246. \\n247.     assert_equal(wcs.axis_correlation_matrix, [[True, False, True],\\n248.                                                [False, True, False],\\n249.                                                [True, False, True]])\\n250. \\n251.     assert len(wcs.world_axis_object_components) == 3\\n252.     assert wcs.world_axis_object_components[0] == (\\\'celestial\\\', 1, \\\'spherical.lat.degree\\\')\\n253.     assert wcs.world_axis_object_components[1][:2] == (\\\'spectral\\\', 0)\\n254.     assert wcs.world_axis_object_components[2] == (\\\'celestial\\\', 0, \\\'spherical.lon.degree\\\')\\n255. \\n256.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][0] is SkyCoord\\n257.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][1] == ()\\n258.     assert isinstance(wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'frame\\\'], Galactic)\\n259.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'unit\\\'] is u.deg\\n260. \\n261.     assert wcs.world_axis_object_classes[\\\'spectral\\\'][0] is Quantity\\n262.     assert wcs.world_axis_object_classes[\\\'spectral\\\'][1] == ()\\n263.     assert wcs.world_axis_object_classes[\\\'spectral\\\'][2] == {}\\n264. \\n265.     assert_allclose(wcs.pixel_to_world_values(29, 39, 44), (10, 20, 25))\\n266.     assert_allclose(wcs.array_index_to_world_values(44, 39, 29), (10, 20, 25))\\n267. \\n268.     assert_allclose(wcs.world_to_pixel_values(10, 20, 25), (29., 39., 44.))\\n269.     assert_equal(wcs.world_to_array_index_values(10, 20, 25), (44, 39, 29))\\n270. \\n271.     # High-level API\\n272. \\n273.     coord, spec = wcs.pixel_to_world(29, 39, 44)\\n274.     assert isinstance(coord, SkyCoord)\\n275.     assert isinstance(coord.frame, Galactic)\\n276.     assert_allclose(coord.l.deg, 25)\\n277.     assert_allclose(coord.b.deg, 10)\\n278.     assert isinstance(spec, SpectralCoord)\\n279.     assert_allclose(spec.to_value(u.Hz), 20)\\n280. \\n281.     coord, spec = wcs.array_index_to_world(44, 39, 29)\\n282.     assert isinstance(coord, SkyCoord)\\n283.     assert isinstance(coord.frame, Galactic)\\n284.     assert_allclose(coord.l.deg, 25)\\n285.     assert_allclose(coord.b.deg, 10)\\n286.     assert isinstance(spec, SpectralCoord)\\n287.     assert_allclose(spec.to_value(u.Hz), 20)\\n288. \\n289.     coord = SkyCoord(25, 10, unit=\\\'deg\\\', frame=\\\'galactic\\\')\\n290.     spec = 20 * u.Hz\\n291. \\n292.     with pytest.warns(AstropyUserWarning, match=\\\'No observer defined on WCS\\\'):\\n293.         x, y, z = wcs.world_to_pixel(coord, spec)\\n294.     assert_allclose(x, 29.)\\n295.     assert_allclose(y, 39.)\\n296.     assert_allclose(z, 44.)\\n297. \\n298.     # Order of world coordinates shouldn\\\'t matter\\n299.     with pytest.warns(AstropyUserWarning, match=\\\'No observer defined on WCS\\\'):\\n300.         x, y, z = wcs.world_to_pixel(spec, coord)\\n301.     assert_allclose(x, 29.)\\n302.     assert_allclose(y, 39.)\\n303.     assert_allclose(z, 44.)\\n304. \\n305.     with pytest.warns(AstropyUserWarning, match=\\\'No observer defined on WCS\\\'):\\n306.         i, j, k = wcs.world_to_array_index(coord, spec)\\n307.     assert_equal(i, 44)\\n308.     assert_equal(j, 39)\\n309.     assert_equal(k, 29)\\n310. \\n311.     # Order of world coordinates shouldn\\\'t matter\\n312.     with pytest.warns(AstropyUserWarning, match=\\\'No observer defined on WCS\\\'):\\n313.         i, j, k = wcs.world_to_array_index(spec, coord)\\n314.     assert_equal(i, 44)\\n315.     assert_equal(j, 39)\\n316.     assert_equal(k, 29)\\n317. \\n318. \\n319. HEADER_SPECTRAL_CUBE_NONALIGNED = HEADER_SPECTRAL_CUBE.strip() + \\\'\\\\n\\\' + """\\n320. PC2_3 = -0.5\\n321. PC3_2 = +0.5\\n322. """\\n323. \\n324. with warnings.catch_warnings():\\n325.     warnings.simplefilter(\\\'ignore\\\', VerifyWarning)\\n326.     WCS_SPECTRAL_CUBE_NONALIGNED = WCS(Header.fromstring(\\n327.         HEADER_SPECTRAL_CUBE_NONALIGNED, sep=\\\'\\\\n\\\'))\\n328. \\n329. \\n330. def test_spectral_cube_nonaligned():\\n331. \\n332.     # Make sure that correlation matrix gets adjusted if there are non-identity\\n333.     # CD matrix terms.\\n334. \\n335.     wcs = WCS_SPECTRAL_CUBE_NONALIGNED\\n336. \\n337.     assert wcs.world_axis_physical_types == [\\\'pos.galactic.lat\\\', \\\'em.freq\\\', \\\'pos.galactic.lon\\\']\\n338.     assert wcs.world_axis_units == [\\\'deg\\\', \\\'Hz\\\', \\\'deg\\\']\\n339.     assert wcs.pixel_axis_names == [\\\'\\\', \\\'\\\', \\\'\\\']\\n340.     assert wcs.world_axis_names == [\\\'Latitude\\\', \\\'Frequency\\\', \\\'Longitude\\\']\\n341. \\n342.     assert_equal(wcs.axis_correlation_matrix, [[True, True, True],\\n343.                                                [False, True, True],\\n344.                                                [True, True, True]])\\n345. \\n346.     # NOTE: we check world_axis_object_components and world_axis_object_classes\\n347.     # again here because in the past this failed when non-aligned axes were\\n348.     # present, so this serves as a regression test.\\n349. \\n350.     assert len(wcs.world_axis_object_components) == 3\\n351.     assert wcs.world_axis_object_components[0] == (\\\'celestial\\\', 1, \\\'spherical.lat.degree\\\')\\n352.     assert wcs.world_axis_object_components[1][:2] == (\\\'spectral\\\', 0)\\n353.     assert wcs.world_axis_object_components[2] == (\\\'celestial\\\', 0, \\\'spherical.lon.degree\\\')\\n354. \\n355.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][0] is SkyCoord\\n356.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][1] == ()\\n357.     assert isinstance(wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'frame\\\'], Galactic)\\n358.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'unit\\\'] is u.deg\\n359. \\n360.     assert wcs.world_axis_object_classes[\\\'spectral\\\'][0] is Quantity\\n361.     assert wcs.world_axis_object_classes[\\\'spectral\\\'][1] == ()\\n362.     assert wcs.world_axis_object_classes[\\\'spectral\\\'][2] == {}\\n363. \\n364. ###############################################################################\\n365. # The following example is from Rots et al (2015), Table 5. It represents a\\n366. # cube with two spatial dimensions and one time dimension\\n367. ###############################################################################\\n368. \\n369. \\n370. HEADER_TIME_CUBE = """\\n371. SIMPLE  = T / Fits standard\\n372. BITPIX  = -32 / Bits per pixel\\n373. NAXIS   = 3 / Number of axes\\n374. NAXIS1  = 2048 / Axis length\\n375. NAXIS2  = 2048 / Axis length\\n376. NAXIS3  = 11 / Axis length\\n377. DATE    = \\\'2008-10-28T14:39:06\\\' / Date FITS file was generated\\n378. OBJECT  = \\\'2008 TC3\\\' / Name of the object observed\\n379. EXPTIME = 1.0011 / Integration time\\n380. MJD-OBS = 54746.02749237 / Obs start\\n381. DATE-OBS= \\\'2008-10-07T00:39:35.3342\\\' / Observing date\\n382. TELESCOP= \\\'VISTA\\\' / ESO Telescope Name\\n383. INSTRUME= \\\'VIRCAM\\\' / Instrument used.\\n384. TIMESYS = \\\'UTC\\\' / From Observatory Time System\\n385. TREFPOS = \\\'TOPOCENT\\\' / Topocentric\\n386. MJDREF  = 54746.0 / Time reference point in MJD\\n387. RADESYS = \\\'ICRS\\\' / Not equinoctal\\n388. CTYPE2  = \\\'RA---ZPN\\\' / Zenithal Polynomial Projection\\n389. CRVAL2  = 2.01824372640628 / RA at ref pixel\\n390. CUNIT2  = \\\'deg\\\' / Angles are degrees always\\n391. CRPIX2  = 2956.6 / Pixel coordinate at ref point\\n392. CTYPE1  = \\\'DEC--ZPN\\\' / Zenithal Polynomial Projection\\n393. CRVAL1  = 14.8289418840003 / Dec at ref pixel\\n394. CUNIT1  = \\\'deg\\\' / Angles are degrees always\\n395. CRPIX1  = -448.2 / Pixel coordinate at ref point\\n396. CTYPE3  = \\\'UTC\\\' / linear time (UTC)\\n397. CRVAL3  = 2375.341 / Relative time of first frame\\n398. CUNIT3  = \\\'s\\\' / Time unit\\n399. CRPIX3  = 1.0 / Pixel coordinate at ref point\\n400. CTYPE3A = \\\'TT\\\' / alternative linear time (TT)\\n401. CRVAL3A = 2440.525 / Relative time of first frame\\n402. CUNIT3A = \\\'s\\\' / Time unit\\n403. CRPIX3A = 1.0 / Pixel coordinate at ref point\\n404. OBSGEO-B= -24.6157 / [deg] Tel geodetic latitute (=North)+\\n405. OBSGEO-L= -70.3976 / [deg] Tel geodetic longitude (=East)+\\n406. OBSGEO-H= 2530.0000 / [m] Tel height above reference ellipsoid\\n407. CRDER3  = 0.0819 / random error in timings from fit\\n408. CSYER3  = 0.0100 / absolute time error\\n409. PC1_1   = 0.999999971570892 / WCS transform matrix element\\n410. PC1_2   = 0.000238449608932 / WCS transform matrix element\\n411. PC2_1   = -0.000621542859395 / WCS transform matrix element\\n412. PC2_2   = 0.999999806842218 / WCS transform matrix element\\n413. CDELT1  = -9.48575432499806E-5 / Axis scale at reference point\\n414. CDELT2  = 9.48683176211164E-5 / Axis scale at reference point\\n415. CDELT3  = 13.3629 / Axis scale at reference point\\n416. PV1_1   = 1. / ZPN linear term\\n417. PV1_3   = 42. / ZPN cubic term\\n418. """\\n419. \\n420. with warnings.catch_warnings():\\n421.     warnings.simplefilter(\\\'ignore\\\', (VerifyWarning, FITSFixedWarning))\\n422.     WCS_TIME_CUBE = WCS(Header.fromstring(HEADER_TIME_CUBE, sep=\\\'\\\\n\\\'))\\n423. \\n424. \\n425. def test_time_cube():\\n426. \\n427.     # Spectral cube with a weird axis ordering\\n428. \\n429.     wcs = WCS_TIME_CUBE\\n430. \\n431.     assert wcs.pixel_n_dim == 3\\n432.     assert wcs.world_n_dim == 3\\n433.     assert wcs.array_shape == (11, 2048, 2048)\\n434.     assert wcs.pixel_shape == (2048, 2048, 11)\\n435.     assert wcs.world_axis_physical_types == [\\\'pos.eq.dec\\\', \\\'pos.eq.ra\\\', \\\'time\\\']\\n436.     assert wcs.world_axis_units == [\\\'deg\\\', \\\'deg\\\', \\\'s\\\']\\n437.     assert wcs.pixel_axis_names == [\\\'\\\', \\\'\\\', \\\'\\\']\\n438.     assert wcs.world_axis_names == [\\\'\\\', \\\'\\\', \\\'\\\']\\n439. \\n440.     assert_equal(wcs.axis_correlation_matrix, [[True, True, False],\\n441.                                                [True, True, False],\\n442.                                                [False, False, True]])\\n443. \\n444.     components = wcs.world_axis_object_components\\n445.     assert components[0] == (\\\'celestial\\\', 1, \\\'spherical.lat.degree\\\')\\n446.     assert components[1] == (\\\'celestial\\\', 0, \\\'spherical.lon.degree\\\')\\n447.     assert components[2][:2] == (\\\'time\\\', 0)\\n448.     assert callable(components[2][2])\\n449. \\n450.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][0] is SkyCoord\\n451.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][1] == ()\\n452.     assert isinstance(wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'frame\\\'], ICRS)\\n453.     assert wcs.world_axis_object_classes[\\\'celestial\\\'][2][\\\'unit\\\'] is u.deg\\n454. \\n455.     assert wcs.world_axis_object_classes[\\\'time\\\'][0] is Time\\n456.     assert wcs.world_axis_object_classes[\\\'time\\\'][1] == ()\\n457.     assert wcs.world_axis_object_classes[\\\'time\\\'][2] == {}\\n458.     assert callable(wcs.world_axis_object_classes[\\\'time\\\'][3])\\n459. \\n460.     assert_allclose(wcs.pixel_to_world_values(-449.2, 2955.6, 0),\\n461.                     (14.8289418840003, 2.01824372640628, 2375.341))\\n462. \\n463.     assert_allclose(wcs.array_index_to_world_values(0, 2955.6, -449.2),\\n464.                     (14.8289418840003, 2.01824372640628, 2375.341))\\n465. \\n466.     assert_allclose(wcs.world_to_pixel_values(14.8289418840003, 2.01824372640628, 2375.341),\\n467.                     (-449.2, 2955.6, 0))\\n468.     assert_equal(wcs.world_to_array_index_values(14.8289418840003, 2.01824372640628, 2375.341),\\n469.                  (0, 2956, -449))\\n470. \\n471.     # High-level API\\n472. \\n473.     coord, time = wcs.pixel_to_world(29, 39, 44)\\n474.     assert isinstance(coord, SkyCoord)\\n475.     assert isinstance(coord.frame, ICRS)\\n476.     assert_allclose(coord.ra.deg, 1.7323356692202325)\\n477.     assert_allclose(coord.dec.deg, 14.783516054817797)\\n478.     assert isinstance(time, Time)\\n479.     assert_allclose(time.mjd, 54746.03429755324)\\n480. \\n481.     coord, time = wcs.array_index_to_world(44, 39, 29)\\n482.     assert isinstance(coord, SkyCoord)\\n483.     assert isinstance(coord.frame, ICRS)\\n484.     assert_allclose(coord.ra.deg, 1.7323356692202325)\\n485.     assert_allclose(coord.dec.deg, 14.783516054817797)\\n486.     assert isinstance(time, Time)\\n487.     assert_allclose(time.mjd, 54746.03429755324)\\n488. \\n489.     x, y, z = wcs.world_to_pixel(coord, time)\\n490.     assert_allclose(x, 29.)\\n491.     assert_allclose(y, 39.)\\n492.     assert_allclose(z, 44.)\\n493. \\n494.     # Order of world coordinates shouldn\\\'t matter\\n495.     x, y, z = wcs.world_to_pixel(time, coord)\\n496.     assert_allclose(x, 29.)\\n497.     assert_allclose(y, 39.)\\n498.     assert_allclose(z, 44.)\\n499. \\n500.     i, j, k = wcs.world_to_array_index(coord, time)\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_fitswcs.py\', \'content\': "590. @pytest.mark.remote_data\\n591. @pytest.mark.parametrize(\'scale\', (\'tai\', \'tcb\', \'tcg\', \'tdb\', \'tt\', \'ut1\', \'utc\'))\\n592. def test_time_1d_roundtrip(header_time_1d, scale):\\n593. \\n594.     # Check that coordinates round-trip\\n595. \\n596.     pixel_in = np.arange(3, 10)\\n597. \\n598.     header_time_1d[\'CTYPE1\'] = scale.upper()\\n599. \\n600.     with warnings.catch_warnings():\\n601.         warnings.simplefilter(\'ignore\', FITSFixedWarning)\\n602.         wcs = WCS(header_time_1d)\\n603. \\n604.     # Simple test\\n605.     time = wcs.pixel_to_world(pixel_in)\\n606.     pixel_out = wcs.world_to_pixel(time)\\n607.     assert_allclose(pixel_in, pixel_out)\\n608. \\n609.     # Test with an intermediate change to a different scale/format\\n610.     time = wcs.pixel_to_world(pixel_in).tdb\\n611.     time.format = \'isot\'\\n612.     pixel_out = wcs.world_to_pixel(time)\\n613.     assert_allclose(pixel_in, pixel_out)", \'start_line_number\': 590, \'end_line_number\': 613}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_fitswcs.py\', \'content\': "1033. @pytest.mark.parametrize((\'ctype3\', \'observer\'), product([\'ZOPT\', \'BETA\', \'VELO\', \'VRAD\', \'VOPT\'], [False, True]))\\n1034. def test_different_ctypes(header_spectral_frames, ctype3, observer):\\n1035. \\n1036.     header = header_spectral_frames.copy()\\n1037.     header[\'CTYPE3\'] = ctype3\\n1038.     header[\'CRVAL3\'] = 0.1\\n1039.     header[\'CDELT3\'] = 0.001\\n1040. \\n1041.     if ctype3[0] == \'V\':\\n1042.         header[\'CUNIT3\'] = \'m s-1\'\\n1043.     else:\\n1044.         header[\'CUNIT3\'] = \'\'\\n1045. \\n1046.     header[\'RESTWAV\'] = 1.420405752E+09\\n1047.     header[\'MJD-OBS\'] = 55197\\n1048. \\n1049.     if observer:\\n1050.         header[\'OBSGEO-L\'] = 144.2\\n1051.         header[\'OBSGEO-B\'] = -20.2\\n1052.         header[\'OBSGEO-H\'] = 0.\\n1053.         header[\'SPECSYS\'] = \'BARYCENT\'\\n1054. \\n1055.     with warnings.catch_warnings():\\n1056.         warnings.simplefilter(\'ignore\', FITSFixedWarning)\\n1057.         wcs = WCS(header)\\n1058. \\n1059.     skycoord, spectralcoord = wcs.pixel_to_world(0, 0, 31)\\n1060. \\n1061.     assert isinstance(spectralcoord, SpectralCoord)\\n1062. \\n1063.     if observer:\\n1064.         pix = wcs.world_to_pixel(skycoord, spectralcoord)\\n1065.     else:\\n1066.         with pytest.warns(AstropyUserWarning, match=\'No observer defined on WCS\'):\\n1067.             pix = wcs.world_to_pixel(skycoord, spectralcoord)\\n1068. \\n1069.     assert_allclose(pix, [0, 0, 31], rtol=1e-6, atol=1e-9)", \'start_line_number\': 1033, \'end_line_number\': 1069}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_fitswcs.py\', \'content\': \'1072. def test_non_convergence_warning():\\n1073.     """Test case for issue #11446\\n1074.     Since we can\\\'t define a target accuracy when plotting a WCS `all_world2pix`\\n1075.     should not error but only warn when the default accuracy can\\\'t be reached.\\n1076.     """\\n1077.     # define a minimal WCS where convergence fails for certain image positions\\n1078.     wcs = WCS(naxis=2)\\n1079.     crpix = [0, 0]\\n1080.     a = b = ap = bp = np.zeros((4, 4))\\n1081.     a[3, 0] = -1.20116753e-07\\n1082. \\n1083.     test_pos_x = [1000, 1]\\n1084.     test_pos_y = [0, 2]\\n1085. \\n1086.     wcs.sip = Sip(a, b, ap, bp, crpix)\\n1087.     # first make sure the WCS works when using a low accuracy\\n1088.     expected = wcs.all_world2pix(test_pos_x, test_pos_y, 0, tolerance=1e-3)\\n1089. \\n1090.     # then check that it fails when using the default accuracy\\n1091.     with pytest.raises(NoConvergence):\\n1092.         wcs.all_world2pix(test_pos_x, test_pos_y, 0)\\n1093. \\n1094.     # at last check that world_to_pixel_values raises a warning but returns\\n1095.     # the same \\\'low accuray\\\' result\\n1096.     with pytest.warns(UserWarning):\\n1097.         assert_allclose(wcs.world_to_pixel_values(test_pos_x, test_pos_y),\\n1098.                         expected)\', \'start_line_number\': 1072, \'end_line_number\': 1098}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_high_level_api.py\', \'content\': \'1. import numpy as np\\n2. from numpy.testing import assert_allclose\\n3. \\n4. from astropy.units import Quantity\\n5. from astropy.coordinates import SkyCoord\\n6. \\n7. from astropy.wcs.wcsapi.low_level_api import BaseLowLevelWCS\\n8. from astropy.wcs.wcsapi.high_level_api import HighLevelWCSMixin, high_level_objects_to_values, values_to_high_level_objects\\n9. \\n10. \\n11. class DoubleLowLevelWCS(BaseLowLevelWCS):\\n12.     """\\n13.     Basic dummy transformation that doubles values.\\n14.     """\\n15. \\n16.     def pixel_to_world_values(self, *pixel_arrays):\\n17.         return [np.asarray(pix) * 2 for pix in pixel_arrays]\\n18. \\n19.     def world_to_pixel_values(self, *world_arrays):\\n20.         return [np.asarray(world) / 2 for world in world_arrays]\\n21. \\n22. \\n23. class SimpleDuplicateWCS(DoubleLowLevelWCS, HighLevelWCSMixin):\\n24.     """\\n25.     This example WCS has two of the world coordinates that use the same class,\\n26.     which triggers a different path in the high level WCS code.\\n27.     """\\n28. \\n29.     @property\\n30.     def pixel_n_dim(self):\\n31.         return 2\\n32. \\n33.     @property\\n34.     def world_n_dim(self):\\n35.         return 2\\n36. \\n37.     @property\\n38.     def world_axis_physical_types(self):\\n39.         return [\\\'pos.eq.ra\\\', \\\'pos.eq.dec\\\']\\n40. \\n41.     @property\\n42.     def world_axis_units(self):\\n43.         return [\\\'deg\\\', \\\'deg\\\']\\n44. \\n45.     @property\\n46.     def world_axis_object_components(self):\\n47.         return [(\\\'test1\\\', 0, \\\'value\\\'),\\n48.                 (\\\'test2\\\', 0, \\\'value\\\')]\\n49. \\n50.     @property\\n51.     def world_axis_object_classes(self):\\n52.         return {\\\'test1\\\': (Quantity, (), {\\\'unit\\\': \\\'deg\\\'}),\\n53.                 \\\'test2\\\': (Quantity, (), {\\\'unit\\\': \\\'deg\\\'})}\\n54. \\n55. \\n56. def test_simple_duplicate():\\n57. \\n58.     # Make sure that things work properly when the low-level WCS uses the same\\n59.     # class for two of the coordinates.\\n60. \\n61.     wcs = SimpleDuplicateWCS()\\n62.     q1, q2 = wcs.pixel_to_world(1, 2)\\n63. \\n64.     assert isinstance(q1, Quantity)\\n65.     assert isinstance(q2, Quantity)\\n66. \\n67.     x, y = wcs.world_to_pixel(q1, q2)\\n68. \\n69.     assert_allclose(x, 1)\\n70.     assert_allclose(y, 2)\\n71. \\n72. \\n73. class SkyCoordDuplicateWCS(DoubleLowLevelWCS, HighLevelWCSMixin):\\n74.     """\\n75.     This example WCS returns two SkyCoord objects which, which triggers a\\n76.     different path in the high level WCS code.\\n77.     """\\n78. \\n79.     @property\\n80.     def pixel_n_dim(self):\\n81.         return 4\\n82. \\n83.     @property\\n84.     def world_n_dim(self):\\n85.         return 4\\n86. \\n87.     @property\\n88.     def world_axis_physical_types(self):\\n89.         return [\\\'pos.eq.ra\\\', \\\'pos.eq.dec\\\', \\\'pos.galactic.lon\\\', \\\'pos.galactic.lat\\\']\\n90. \\n91.     @property\\n92.     def world_axis_units(self):\\n93.         return [\\\'deg\\\', \\\'deg\\\', \\\'deg\\\', \\\'deg\\\']\\n94. \\n95.     @property\\n96.     def world_axis_object_components(self):\\n97.         # Deliberately use \\\'ra\\\'/\\\'dec\\\' here to make sure that string argument\\n98.         # names work properly.\\n99.         return [(\\\'test1\\\', \\\'ra\\\', \\\'spherical.lon.degree\\\'),\\n100.                 (\\\'test1\\\', \\\'dec\\\', \\\'spherical.lat.degree\\\'),\\n101.                 (\\\'test2\\\', 0, \\\'spherical.lon.degree\\\'),\\n102.                 (\\\'test2\\\', 1, \\\'spherical.lat.degree\\\')]\\n103. \\n104.     @property\\n105.     def world_axis_object_classes(self):\\n106.         return {\\\'test1\\\': (SkyCoord, (), {\\\'unit\\\': \\\'deg\\\'}),\\n107.                 \\\'test2\\\': (SkyCoord, (), {\\\'unit\\\': \\\'deg\\\', \\\'frame\\\': \\\'galactic\\\'})}\\n108. \\n109. \\n110. def test_skycoord_duplicate():\\n111. \\n112.     # Make sure that things work properly when the low-level WCS uses the same\\n113.     # class, and specifically a SkyCoord for two of the coordinates.\\n114. \\n115.     wcs = SkyCoordDuplicateWCS()\\n116.     c1, c2 = wcs.pixel_to_world(1, 2, 3, 4)\\n117. \\n118.     assert isinstance(c1, SkyCoord)\\n119.     assert isinstance(c2, SkyCoord)\\n120. \\n121.     x, y, z, a = wcs.world_to_pixel(c1, c2)\\n122. \\n123.     assert_allclose(x, 1)\\n124.     assert_allclose(y, 2)\\n125.     assert_allclose(z, 3)\\n126.     assert_allclose(a, 4)\\n127. \\n128. \\n129. class SerializedWCS(DoubleLowLevelWCS, HighLevelWCSMixin):\\n130.     """\\n131.     WCS with serialized classes\\n132.     """\\n133. \\n134.     @property\\n135.     def serialized_classes(self):\\n136.         return True\\n137. \\n138.     @property\\n139.     def pixel_n_dim(self):\\n140.         return 2\\n141. \\n142.     @property\\n143.     def world_n_dim(self):\\n144.         return 2\\n145. \\n146.     @property\\n147.     def world_axis_physical_types(self):\\n148.         return [\\\'pos.eq.ra\\\', \\\'pos.eq.dec\\\']\\n149. \\n150.     @property\\n151.     def world_axis_units(self):\\n152.         return [\\\'deg\\\', \\\'deg\\\']\\n153. \\n154.     @property\\n155.     def world_axis_object_components(self):\\n156.         return [(\\\'test\\\', 0, \\\'value\\\')]\\n157. \\n158.     @property\\n159.     def world_axis_object_classes(self):\\n160.         return {\\\'test\\\': (\\\'astropy.units.Quantity\\\', (),\\n161.                          {\\\'unit\\\': (\\\'astropy.units.Unit\\\', (\\\'deg\\\',), {})})}\\n162. \\n163. \\n164. def test_serialized_classes():\\n165. \\n166.     wcs = SerializedWCS()\\n167.     q = wcs.pixel_to_world(1)\\n168. \\n169.     assert isinstance(q, Quantity)\\n170. \\n171.     x = wcs.world_to_pixel(q)\\n172. \\n173.     assert_allclose(x, 1)\\n174. \\n175. \\n176. def test_objects_to_values():\\n177.     wcs = SkyCoordDuplicateWCS()\\n178.     c1, c2 = wcs.pixel_to_world(1, 2, 3, 4)\\n179. \\n180.     values = high_level_objects_to_values(c1, c2, low_level_wcs=wcs)\\n181. \\n182.     assert np.allclose(values, [2, 4, 6, 8])\\n183. \\n184. \\n185. def test_values_to_objects():\\n186.     wcs = SkyCoordDuplicateWCS()\\n187.     c1, c2 = wcs.pixel_to_world(1, 2, 3, 4)\\n188. \\n189.     c1_out, c2_out = values_to_high_level_objects(*[2,4,6,8], low_level_wcs=wcs)\\n190.     assert c1.ra == c1_out.ra\\n191.     assert c2.l == c2_out.l\\n192. \\n193.     assert c1.dec == c1_out.dec\\n194.     assert c2.b == c2_out.b\', \'start_line_number\': 1, \'end_line_number\': 194}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_high_level_wcs_wrapper.py\', \'content\': "1. import pytest\\n2. import numpy as np\\n3. from numpy.testing import assert_allclose\\n4. \\n5. from astropy.coordinates import SkyCoord\\n6. \\n7. from astropy.wcs.wcsapi.low_level_api import BaseLowLevelWCS\\n8. from astropy.wcs.wcsapi.high_level_wcs_wrapper import HighLevelWCSWrapper\\n9. \\n10. \\n11. class CustomLowLevelWCS(BaseLowLevelWCS):\\n12. \\n13.     @property\\n14.     def pixel_n_dim(self):\\n15.         return 2\\n16. \\n17.     @property\\n18.     def world_n_dim(self):\\n19.         return 2\\n20. \\n21.     @property\\n22.     def world_axis_physical_types(self):\\n23.         return [\'pos.eq.ra\', \'pos.eq.dec\']\\n24. \\n25.     @property\\n26.     def world_axis_units(self):\\n27.         return [\'deg\', \'deg\']\\n28. \\n29.     def pixel_to_world_values(self, *pixel_arrays):\\n30.         return [np.asarray(pix) * 2 for pix in pixel_arrays]\\n31. \\n32.     def world_to_pixel_values(self, *world_arrays):\\n33.         return [np.asarray(world) / 2 for world in world_arrays]\\n34. \\n35.     @property\\n36.     def world_axis_object_components(self):\\n37.         return [(\'test\', 0, \'spherical.lon.degree\'),\\n38.                 (\'test\', 1, \'spherical.lat.degree\')]\\n39. \\n40.     @property\\n41.     def world_axis_object_classes(self):\\n42.         return {\'test\': (SkyCoord, (), {\'unit\': \'deg\'})}\\n43. \\n44. \\n45. def test_wrapper():\\n46. \\n47.     wcs = CustomLowLevelWCS()\\n48. \\n49.     wrapper = HighLevelWCSWrapper(wcs)\\n50. \\n51.     coord = wrapper.pixel_to_world(1, 2)\\n52. \\n53.     assert isinstance(coord, SkyCoord)\\n54.     assert coord.isscalar\\n55. \\n56.     x, y = wrapper.world_to_pixel(coord)\\n57. \\n58.     assert_allclose(x, 1)\\n59.     assert_allclose(y, 2)\\n60. \\n61.     assert wrapper.low_level_wcs is wcs\\n62.     assert wrapper.pixel_n_dim == 2\\n63.     assert wrapper.world_n_dim == 2\\n64.     assert wrapper.world_axis_physical_types == [\'pos.eq.ra\', \'pos.eq.dec\']\\n65.     assert wrapper.world_axis_units == [\'deg\', \'deg\']\\n66.     assert wrapper.array_shape is None\\n67.     assert wrapper.pixel_bounds is None\\n68.     assert np.all(wrapper.axis_correlation_matrix)\\n69. \\n70. \\n71. def test_wrapper_invalid():\\n72. \\n73.     class InvalidCustomLowLevelWCS(CustomLowLevelWCS):\\n74.         @property\\n75.         def world_axis_object_classes(self):\\n76.             return {}\\n77. \\n78.     wcs = InvalidCustomLowLevelWCS()\\n79. \\n80.     wrapper = HighLevelWCSWrapper(wcs)\\n81. \\n82.     with pytest.raises(KeyError):\\n83.         wrapper.pixel_to_world(1, 2)", \'start_line_number\': 1, \'end_line_number\': 83}\n\n{\'relative_path\': \'astropy/wcs/wcsapi/tests/test_low_level_api.py\', \'content\': \'1. from pytest import raises\\n2. \\n3. from astropy.wcs.wcsapi.low_level_api import validate_physical_types\\n4. \\n5. \\n6. def test_validate_physical_types():\\n7. \\n8.     # Check valid cases\\n9.     validate_physical_types([\\\'pos.eq.ra\\\', \\\'pos.eq.ra\\\'])\\n10.     validate_physical_types([\\\'spect.dopplerVeloc.radio\\\', \\\'custom:spam\\\'])\\n11.     validate_physical_types([\\\'time\\\', None])\\n12. \\n13.     # Make sure validation is case sensitive\\n14.     with raises(ValueError, match=r"\\\'Pos\\\\.eq\\\\.dec\\\' is not a valid IOVA UCD1\\\\+ physical type"):\\n15.         validate_physical_types([\\\'pos.eq.ra\\\', \\\'Pos.eq.dec\\\'])\\n16. \\n17.     # Make sure nonsense types are picked up\\n18.     with raises(ValueError, match=r"\\\'spam\\\' is not a valid IOVA UCD1\\\\+ physical type"):\\n19.         validate_physical_types([\\\'spam\\\'])\', \'start_line_number\': 1, \'end_line_number\': 19}\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-12-21 11:43:53,744 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    pt = SkyCoord(Tx=0 * u.arcsec, Ty=0 * u.arcsec,\n                  frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))\n\n    # The slice is applied in numpy order, so the first slice (0) applies\n    # to the last WCS axis (wavelength).\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # This is the call that produces the bug\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\n    # The expected result is based on the unsliced WCS output\n    # fits_wcs.world_to_pixel(pt, 1.05*u.angstrom) -> (array(49.5), array(12.), ...)\n    expected_pixel = (49.5, 12.0)\n\n    assert_allclose(sliced_pixel, expected_pixel)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1153, 'end_index': 1866, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 7381, 'end_index': 8142, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 10993, 'end_index': 11741, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 87837, 'candidates_token_count': 727, 'total_token_count': 92057, 'prompt_tokens_details': [{'modality': 1, 'token_count': 87837}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 727}], 'thoughts_token_count': 3493, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5923393490881834, 'model_name': 'gemini-2.5-pro'} id='run--a7f46d0f-213d-4d97-9d5d-255c7f2c86e2-0' usage_metadata={'input_tokens': 87837, 'output_tokens': 727, 'total_tokens': 92057, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 3493}}
2025-12-21 11:44:16,555 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nfrom numpy.testing import assert_allclose\\nimport pytest\\n\\nimport astropy.units as u\\nimport astropy.wcs\\nfrom astropy.coordinates import SkyCoord\\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\\n\\n\\ndef test_sliced_world_to_pixel_coupled():\\n    \\"\\"\\"\\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\\n    with coupled axes gives an incorrect result.\\n\\n    See: https://github.com/astropy/astropy/issues/12739\\n    \\"\\"\\"\\n    nx = 100\\n    ny = 25\\n    wcs_header = {\\n        \'WCSAXES\': 3,\\n        \'CRPIX1\': (nx + 1) / 2,\\n        \'CRPIX2\': (ny + 1) / 2,\\n        \'CRPIX3\': 1.0,\\n        \'PC1_1\': 0.0,\\n        \'PC1_2\': -1.0,\\n        \'PC1_3\': 0.0,\\n        \'PC2_1\': 1.0,\\n        \'PC2_2\': 0.0,\\n        \'PC2_3\': -1.0,\\n        \'CDELT1\': 5,\\n        \'CDELT2\': 5,\\n        \'CDELT3\': 0.055,\\n        \'CUNIT1\': \'arcsec\',\\n        \'CUNIT2\': \'arcsec\',\\n        \'CUNIT3\': \'Angstrom\',\\n        \'CTYPE1\': \'HPLN-TAN\',\\n        \'CTYPE2\': \'HPLT-TAN\',\\n        \'CTYPE3\': \'WAVE\',\\n        \'CRVAL1\': 0.0,\\n        \'CRVAL2\': 0.0,\\n        \'CRVAL3\': 1.05,\\n    }\\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\\n\\n    pt = SkyCoord(Tx=0 * u.arcsec, Ty=0 * u.arcsec,\\n                  frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))\\n\\n    # The slice is applied in numpy order, so the first slice (0) applies\\n    # to the last WCS axis (wavelength).\\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\\n\\n    # This is the call that produces the bug\\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\\n\\n    # The expected result is based on the unsliced WCS output\\n    # fits_wcs.world_to_pixel(pt, 1.05*u.angstrom) -> (array(49.5), array(12.), ...)\\n    expected_pixel = (49.5, 12.0)\\n\\n    assert_allclose(sliced_pixel, expected_pixel)\\n", "relative_path": "astropy/wcs/tests/test_sliced_wcs_issue_12739.py"}'}, '__gemini_function_call_thought_signatures__': {'a09e4bff-faf6-44cb-8e52-c0c0410d21e9': 'CsMxAY89a1/8i4LRD6JmkRO7ouchy3o+t/O6esy/rz0A9uJ+7GJX+OL3TwrqSG8Gpb4Gm3+TMJ8HILcJKH9SOYwpSmGJJtVhyUP34mF2BO8NLEZfFCd0CoZ+Fw3Zr1Zg0BaFE8KehBS2mE0LaMaLeq5XMaLJ8prbFVATqmd2vJYkjPYnDAhcqrBRQkNG9R+Y+r7Ws0CT7XW88uF94D0agttq35zw8VJxM7AkWyrGUnUUeQhstWMFhD40DeKukFubZeXMGQ6piFB9f7/eMJz0ZBB6luLnCY/dWKbHb2hd7Hw1JeM0KtEUYdWii+vNpLPfzKBR1SWo/w3EOegI5sH9BTjItdYYSHs7rpkqOqtexJR4WFqoX9+JhDEsSIihqarUJu5usK/NX/oHw440xVSpqNrJzzlCF/YtvyQ7ziaQbWRXU6e/A1RACOYdhjZ1kZxhZabEAK0FEY99jGd9yIQV27txvFWLdac3c43xqIQ9EtP6fCkMHNnuXJSAXbRy++HfhcWmvzR4ApN8LEYxFpU9N/gI9wVh56+in462GRFT/Vn8/GZ9KgEaXGBvk5b40wkQEIjecaNxvoYhgqcMXjxjnvzezFnurLnObwxMt//AebJVFVbjRWSFEJPGpiftDxkkcI0y5+lNpYbPfIu6OH+oC6OOb/re50YQPMmraJ5vSy7R+9WvPvUB8J3miWsnOu2f9rJcR2UgE95glWPIymUMDcCtkW5MRDtVtxS+y+0bcLDiRQAXPtHk7Ys/Iz6p4LaGmpZ1ONOkKRP8MfdpZdaHI9gTDH7Nx1J9crHg5VRQ2kiPltxLqQl24VyaASDCBCf5Xyvc4YQNTBub3YbnTN3ZjldU4PbFxnpAElpuG/iMNt+TG1+m+Lf9CVAkFqFZ2ZsuO4/PNdEOOJTxcQ4kueaXm6QJKqMB6MvBMdy8DwDv55sg6MUxMxfyUYyenS0D0dQrzwOMn0HL5mKlTrLThdG1dKmQ2hCgvktGesXieWCmGZdBmKTMwnpWiXt8/t0aassZOWsx6uYKEznvsaG1NFb/qnZye5DHNywtCqVuh8GVMttjlMcxsgzjjcwKU3bpLLaPNKF+Pp1Bhb5/FQCeHc2tgkd2VijhQD7OZB3432qlk7Qhk42Ji3WY1RU7XaLkOIK+dQCr93AUfKtU/eHfCIvo8+aDAQTLrFER4c9qyXETmBwCa3coA53MzmMvQwklknfPGWcncq7pVBuPHOEU6e0A2Bq+WxDQqd+IxzCiA46D/urcco9ShrvGAO+JgXmJL0S6XM6gFt1IqtHdvCvy6IL41Fi9978UNloIgTZWWyT8Y8PkPgl4sF/o1YylgTPB8DLK9eKFpuFVJxB5Re7ZeWhol/ZCy3GMwKrPnNXW1pFOCZg1uHdAYI03wB3IIFaL7p+wGOvI1VYuDB/nuaHa2USZl3i7Vaime5xcXrUtQ0YTkDs1t3ttLUrEMaFC+Had1SFW6VfWZ4EwACUq41G5TSixXjPaLv2wxJpO3bMB2a0LoscOMGzZ800N+kxQmTlGneRu9FLHU59X58kcCK9Ydi2y3ifR/0sc3srzFeuFRiwV7SN/BxTk7yvAveZj7iXG/oXnl4/lKdzPyH2ATCYLM/bR13ZggX/eJwuHRUDMeIWT/8HrqzPO0r1AlVBIeVKLYufACmwSKVqdug1xhBcK4koRx0DDPVwga3GfkHv3AyfRzyDBlQPcz0SXRVxDlxeWM07bP3PDog6WWO3Um0TSvMe9JEXFesySwbj1fORUweW81t0gibFaGJoVVDk7czeM+HdV+OIdOVtzIS++lFwnZKHlGNjMVk1AWQKRakZDzgUD4CgIkEeRwgJ1HGEvAGnpoS23gBaNw6AVVm5RCliKTNztJdLCMlF8bFc3q5y6IVlqqMdEFY9OCkD7Duh6VfO3ybXgAyOS3VQ9xpFRUjY8Je5ZDTTlcYj2paFO9Ka3siU/joP7tohbTGAPF5fdIXqBbgMecWzBe5cHUw9fqq7aDTx8NZRJpQsk+AD13E+G+WlMKG8HuK5pCuAVHeKNwLOj+3r3Yh//Rr4/5LcNMJEtQzjoIjeQj3cP1f2ExAUnLydh4BUGl2VwxyHb7fxSh168IP5vayiOTbUmPZfL9Rl6Xzi/STnqQZD9Ub68f7f4bWjm6qpKyk+COIfCWAztgxsrrSSZcMrci47e6rWO29ceMWNX4gGrcI8IV1o7PIxDAyipe0/20KItmXfRhj6VEWLdGfSmdRUXkf2N/e7Pq1qnG4zIZMPf/JD6hTQ/jmLL+X2P7VQQI9ZRDdHtSYO6MYEkE1k/WChc2+WndLVVjJ9OTHt+b1Is0UrLJZ+YlcrdI+DS7ctElpona3k+BEeaQkChmR5UIJi4d7UhWwBeT2LgC0ZmNWCQRZIoYy5OCw80OiZYNMfgAW6KwhavgkUKvpPNJT21h3QBhY8SLSozJlrX3wRRBs/ivB/wMOBHd+yocwOzrcQ3vq8RYdx0FIQ4KnxBOuzcQkrIZOqvwm6vb0awNCxqaM2K5fPUVLCRnyFeYD1KEjqGlhOzgPoEC12ta2rjQZJP22sZmdz2wcep4PNifKFsiUraVcar4mtKENDDZp7FR2wYo2TlwE7IT0CWe5JmhnJKdEWu0Oi00RFhmuf3tBtTu8i5RR6xEkPKaApnWnd953+YvKSaZJwHGZrweog04bDRg3pe1eUvbmZqFr8vKSkYd2rF1qp9OdliZ2/9HS1Qhw6YqqblwDnl+NmGKkm4Eq1YolKPfUCLSAnJ5BcL7OaXcMUGTs7SYZYhamhguXfweliOI94udcpMdpbLsFzzS/LC0VFOu9ybKbgEXx1Qrucu5E5A7CgnRyDGf4gseUhySGb3YSS2TDowdIVy2NYUq6PTD6CO7HwkoDdwIPBuypgIhJ1GxftzSQ5O4a1Kxdu/Pbj00nAMhCn6Q+KDBpt62q5p2cvyWSWtkR3SeFgspnKVYdvDkYaDeziNB5snxVozQSCDB2kHWyhAmLyjgRKCrC3fHWkhEN1xS8XE42vMY6VX0kFKhdlacIrudWj+Q4YNHjvaZ05hLjGelTehLWIMQOrCf0d1kOOxPpmqMPtS5R/RneRcaGt/DTNUcqPTdvAy1hIruYPqa+PDQovmcnMHVYMjhyWC6/zU59edPOmzFtujg2VdASIIeoJDuESstz7Ehz0GbA0BwHEckhM8qPJ801ojFjJyUcCaNT6ZCP3Jda3bgAQml5+Uc4BGBS9MJrwQpebOa585z9ycXrYqi9MKHv18QoEkzueExUxaYxqqyWIWFMHK4jJkJEP+wmoKvI5W46Mv4ya3jC9HvlEJTef6V9OdKfavAbmWZnqLrEyM7WstiVJGrIiI+eLeqGElkH3ojFhLrEEqnBtC6e8EvbbpaUwBA6GEdrwfhIgm/4HtHLIf+HZu1qb2RMGuyJTZjQ1c/i1i3A9ma4FCGv1+AOosDM/rZJ79bZhbqQfDWTJPjqF+mmvdxSo+FlxB9AQi7/8LZlyMVEe20ymSUJvM901Y4V5vHDO0s7jhhbjRrzjvyjdqO+mq+xtz22QZAzYiDO77tgRwDwS72vFAfDW8dkkli1B8vR/uodTJaNDIGWMtddFB+3gBC7Mddml55AqgpDV3UFPWVSzGrtS6rqftI5Z3zEmvQVPEqSwZVHJKupFdQchJkKw+mu7qeycrC4m2Z4UjghI/thDu4jezuagx42Gp0oTrDB1khKZy/ytR5HHLuRxM/ldoev/NPW0AyjiZh1dMAh8djgDd1KYJaE9uBfea0hKGd1WerLaoah5u4fdmO93GnjiRqmTpF7tENV21Rnh8yjGT5d4Bo4vLCMVuX4bDh8utmVGup5ysvMUcbgJXMNCU0ouk2YAYAcMlhncmypUQ/HqLEJTOJD4pizqGH8/GTAaOXUP5kOuiWZdgk8DxQ2tMaZL3uqvikfKSBBoFXtNDpmWCPHS8nly1MED+XztDEyB1w6//XYTY7+t/htiGzczr/WG54L28EYUcE9ys7xOUdnrdlvAPwzDLdNyCXAly5F2YSJa3qDxjBFS6dagxnFL5Bx7cDNKVnWN5zTYCHYbHfuPe2EaT23DENVQ+mPrirE90qwLrZrjIxY8yxMdSFh7nwSUytyfOJBRvh+yQaf52QyQaWDbI1KBHeVOCygOJ3hNNFajjmurDMg6PwMyJniDzrk+jOWposlDGSC0ccfC0PJ59rJz6ZMLU3og8dCJsM1ncAmrPkVt3Zp77ofTDTbhPQbpricM7en9dwTb2e4fKI4I9EfSt1bkFf75NqHn8aoCM1uD3HC4ZgyEOLXMEQ+kCuFIjyCKzx/Q2ck1DYS34SKxN/V1CnI5kR7ziaoNZjCx1UPiIrEr1JiIzXcG1+Vv9XZel6xobsE0ZwUwEM1vEozK5NaBgPPUs2THdFwktQRZKXXmaO1ZeIpKr/rdbuPSeilcO26mXsnbD+qzGMWMHnUCmmDmmeMxDSxIj5wTAdcw4LSfCkodTC/StpUeqEsMRLY0DX8nNT/qVs6SgsiyQfv4lX5vwpcnNhKc+Iqo95Oeg/dHbggI/gKkeoZdmnBIiU+K6qNbSEHyCAIk+95p+QnypRBaxCHGDykmSrxAgIH/iTKy7rVPGSmZFm/+s5tNxDPfZyVtXAreLJTtNK/Ug+c1vtuCV4zItQgbPH7DABjAS8xK4P7Rl0cw4NGlhgHk1GAEYX2x8fwmdGYUYAGBkIbih6N2LJrx+I2mYT54hbJGIiselNpOrN9I129kwb2qu4cVhRbTDYHkkq5s405ZFkFkCgxSS3xzgC3uM48fv4o50//+qrA8szwb6cZlYeotW1V6iqSNosEIJi1ZuaEETkRLc1TIjqnbiQvwa6OvWAArwDsXGcuj9gAr1pWMgjvCqf/+OwVrOPM420LAqh6DEYLURqnE666rYENoriNb0bTZfsII/dled1Cp21H249V0ssWOzIQjDlu2vpIWWaZY71lHHs3bOEKKPHPBewNFmpERp6qL+lc2Bs5F/Q0nPezzcA/TmMCzYvn1WogVCXKL/2ebhch/1PwVcNZ5w6g2JGbGimQH/FEzCwf5p3uBUs5PTMFW/9sINsK8wzU7DFQcFBqmPZQwKJ/2CDnU+JMfvu+XPIWfxGqmPuKoZaVuF7Orcl3iJiWR4VMVS+ZijGkHtlEgjmzVq4lK9yMDT0ZUAHMd9/O5G5e2WaSyCgN1tWk7+5D7iHOa30Rr7oNl2n6NI8phj9uvvNg0JSo+lY8Zh66pKgD5ScJn6msgo8RrkA5XYnrL2S6PTzw3Sn7lPOzQnNGe/AZSd60MS9jXmXg4PDqWNAfA3k3pnpqY2FdgzZMfkoOfBiRzC/KCQeWC1sAqTe9Xzql+uijElfQdkFRszhmh+ReLscuE/9AYS2XQIRBfAn7/IhgQVn1iO/7G3W8mmxrUVEpld+im5MnwnaIX3DjeaaKhvPqs1dhovYNy3n98eah2L6/6/r2zAUmEB/p0D4Hp93XIjMYqUuAvI8FGJxGdhWydChW2qUkdMaNOhJ45rrIt02/t4CinRcPg0zGX+mFf0bz0CW8y+2ddr/rLBcZ1ENoV5hwuAapJQ+aDFPOXOAhEfCEQOnEceVNUZSbgGTfTz/3Z7zOM+KQw2rzWMqGfUWXiMlglfiy93dwvwgR+dHgqgpOqUwzjA+fUimbQMryt0gdskB5VHzbcggDEvYDUm7FWc1Aqquo/VTdo2ZwhMCjDUcAozu5j6fLvcMkrYqjfiv4JOfjWCD5Oz8lP69EYNhr1kUk0RqdmLfyY7X8GT8EjCBoJDdIJQBUnQymzNXjy610Tmq83kfIUp33GYylhUGzJkXpZJm0g3rpmTEws96FHNA3pXOfz/LYYvtBXfD5eX1RKmRow5rfzdbBNiWe5fd5S70LX1ET8rFfVb56AsDz02j3fN0jdcHNAvA4OSsCwjESMkGc2fDMtJzwmYWkdrvvpT3RBO+MLfYRVUpBnHNOi2Y2Wd65dW8VTjCIC878wcmoZzMqs2KTqkcY/qr5LdCF0PVsQvY7j6VZNirAxPnj5xA0CT7wNmKIQkGGFtg29qh/yMUq6PjSkGwxbbM1MtkHufaUBeVULdeR7ikiewQ5P/npcTxbLjGRLJnkX41wBBWpYnRLZ8PqJlv2kCtIj0ABKupvyW0Ebw6slLLll0TaOh4EP10dPP/jyNko6IUjMUttU8ujgf1KobDunJAkSR8MEpQIglSaHGPc0HPkMLmwKextC7RLzfjJyPaDNLmbk2lzAE3wbmFglAMOlcsOdYhgO0VsBYHw0XeV1hpuM7ABwC+juIE88Da8Tdy24LG0VeJuPHKO4X97069C8itJBFaAarZhUL/o0JLS/euRc0MB1KQm/6cuRkwXMJgWs3hwPmLKNvaI3t4zR875ziNKzynXxwiTjSvpaty640jdT9Qruw0nKudbfG5CFsAazv6W7P3YIZiBaAkGAT2JGHSSqwOygzkZs0sKVJSNrJBBoLmu64WNlh5kTo8/BGH5YeeNx2eZ3EZWxEdkKTFWJSLjy0wLo1ruFSn6BzR2wfladlJ5kOBSxNENHkoxYmgq6t9XY8HZlq+g8DrRQ3fnVK0NmpNhTQ7NNFO8E1PxCmkFOZD4JsAiVyEEdEBpCXh/vXQ8pk6/7J84notLRKbo96afM3PuSLeCJ2QM1SI3sbV1+muDYUJknMwJ2+EoU0Vpq7CHC6hXURYSz0da8S4jBgG+npmzCITT06uwudFbPmidN6V8QISO92mCykWMrOj++MTpCOG79XkEiGRiCuxhBcCt6IEBxfplU2s+F+/yS4ifr+I5Gp7rHJPMipxH8Sa9n4VIRX+qkaT5GBfvviEDZyjMUyYUj+te1ywIqBnJMjBeRlKm0m4eqSCwuq4hkBKu3jnGRWybOkqH1BmvgWJHcbPcGSX/gpYzx417OS+y5ZW8+P69lUurU9U3s5ZVLHi3TEvAy0HDl3yNhqyWqUHz+YiDSqbmKesfRDgeaHHi6MwFo6KtDkrNrwma27BJOpev2VB+XswFAHPNTj8F9C1kXr9H0/COe7HbW8GmAliDtwRcogIOsqVB2hCB4bpFrLLciwIIUiQ3IIvONhFiLIUA6kBtsmWFFQKQ4TdHqaPcPf+q28b/AGuxP9+d/D4y/Iq4S0tI1zH5DIFmemEWC5oY86hHP6Oub5yo8jal4+rdoMZklkDWYv6FESHbbvyc0/Tj5j1UPyJub4CfsWbLROV3yrpgHAk425MqcuC1T5SYhkuv5qmsw4BIhYUaRAE01JHcwAe4DtXKtIHAWSH/22bktm3Xzfp+MsRvDrH+ED2wB1Xd4+nK44y5hPkpBS7VxsK/4MBhlAgCPb6ueFaDDwCiIVkDcNCOSNaUxWS6ygNQFk9q70EyeZqVihGZuhsXXb453OIN7UIJ5vh3j+1D0LGPBLmixdP/06bLFWgF8InZi9SRorh3DMIPKXMJzL03sKFlXgQI7oa2r8Cye035Po8J4frF9Zx986EVOA84li2tSsnVK31Xqy6UluuIZQQaAiMX3LiKTtLRwDELqdLT1X6T9T/nU1sM9sDuHxZBRBv9jalBmlOTfjf6dJSfwZt4J30L/r14VgkHcGASfySf5iYwg1/QXb5s4xkum3140SvbuZHqXzs2raC43bOAQrx1Z2AHZ+4cBe/KXZQvEDpMizHnZD0m2PCqhm9vN2b9+WOXUvBYbDxRgprQdlxBVEXei9KdfPOMNCHqmP1QF6PnXFcIe/HkpAKaqLKWCit0egkg9d6pqdKYyLKIYouztkMMyfAZG/Zi3O0bKU6ui2lHyPp3N+O2cXnlbkQXTjr/8cgBaNtMA7ZiKbt+1OFt0UMhU9DK1FMBq9Vhqv3+ZBrnbmmH8mRZQ+4JaCO8I1ZT8ZSWzPpfS9LlosmFJ28XRI+lB58XBmsPEZYy5K8sS18zXjkmSmuUn1KoJF83s7Quqe4bIuzl2qUYiIl/P0vVyg3RzRHPR+OWUBvNpcQRJUSJtX/90LOVCCz0T4VS6EX4x/QTTwz3cQFQgjBggSqqmlKtB/btQ0c5Jnh4pGZGpVO55AFkGfP8uJ/xIHeCgjAc91ur1j8obWHYF5wEFWtIbBYaPG8/rUroGAb0G+vIM5NEjFobfWkFC2DXLqIdW25k0uM92E4jUXTG8RjfNJv9LzdgqG2p2YhPHpuiFa/8DyXar4rrTwfd3d907kVfB9i/E0pBXDmjJUfaViTDmun0mzuwDaa9phiCLgfC5INzzAetHoCuGSOoQwXLbNbKaPo+fAQXASeqNUp8su3mJq6x4kvq0a8irYxC2i9UDAMk4KvT0CcmpQ56P5fE73Gv80/0w2UKn9dhzCmqDptb6v7yELnM78oS/cZRctBXWhDoD4lajLL1reT14bVzJx4qMC2xsQfx8IlV/mj0oW8AerL/sSChyU9mo2dhk6ZvQ+qwzg5dzHYQS8ztR6tk6TW5+L'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 4787, 'end_index': 5535, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 6957, 'end_index': 7705, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 1045, 'candidates_token_count': 754, 'total_token_count': 3854, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1045}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 754}], 'thoughts_token_count': 2055, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2674299690388242, 'model_name': 'gemini-2.5-pro'} id='run--7d9ac4c1-cdc2-4165-ba36-a682c0b89cc8-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    pt = SkyCoord(Tx=0 * u.arcsec, Ty=0 * u.arcsec,\n                  frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))\n\n    # The slice is applied in numpy order, so the first slice (0) applies\n    # to the last WCS axis (wavelength).\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # This is the call that produces the bug\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\n    # The expected result is based on the unsliced WCS output\n    # fits_wcs.world_to_pixel(pt, 1.05*u.angstrom) -> (array(49.5), array(12.), ...)\n    expected_pixel = (49.5, 12.0)\n\n    assert_allclose(sliced_pixel, expected_pixel)\n', 'relative_path': 'astropy/wcs/tests/test_sliced_wcs_issue_12739.py'}, 'id': 'a09e4bff-faf6-44cb-8e52-c0c0410d21e9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1045, 'output_tokens': 754, 'total_tokens': 3854, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2055}}
2025-12-21 11:44:17,514 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/wcs/tests/test_sliced_wcs_issue_12739.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1833, 'candidates_token_count': 24, 'total_token_count': 1857, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3887}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 24}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.432699961393761e-05, 'model_name': 'gemini-2.5-pro'} id='run--f6d460b4-c37b-4c8c-8d0e-1e92fc5518a9-0' usage_metadata={'input_tokens': 1833, 'output_tokens': 24, 'total_tokens': 1857, 'input_token_details': {'cache_read': 0}}
2025-12-21 11:44:17,776 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/wcs/tests/test_sliced_wcs_issue_12739.py b/astropy/wcs/tests/test_sliced_wcs_issue_12739.py
new file mode 100644
index 0000000000..523324595b
--- /dev/null
+++ b/astropy/wcs/tests/test_sliced_wcs_issue_12739.py
@@ -0,0 +1,61 @@
+import numpy as np
+from numpy.testing import assert_allclose
+import pytest
+
+import astropy.units as u
+import astropy.wcs
+from astropy.coordinates import SkyCoord
+from astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper
+
+
+def test_sliced_world_to_pixel_coupled():
+    """
+    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
+    with coupled axes gives an incorrect result.
+
+    See: https://github.com/astropy/astropy/issues/12739
+    """
+    nx = 100
+    ny = 25
+    wcs_header = {
+        'WCSAXES': 3,
+        'CRPIX1': (nx + 1) / 2,
+        'CRPIX2': (ny + 1) / 2,
+        'CRPIX3': 1.0,
+        'PC1_1': 0.0,
+        'PC1_2': -1.0,
+        'PC1_3': 0.0,
+        'PC2_1': 1.0,
+        'PC2_2': 0.0,
+        'PC2_3': -1.0,
+        'CDELT1': 5,
+        'CDELT2': 5,
+        'CDELT3': 0.055,
+        'CUNIT1': 'arcsec',
+        'CUNIT2': 'arcsec',
+        'CUNIT3': 'Angstrom',
+        'CTYPE1': 'HPLN-TAN',
+        'CTYPE2': 'HPLT-TAN',
+        'CTYPE3': 'WAVE',
+        'CRVAL1': 0.0,
+        'CRVAL2': 0.0,
+        'CRVAL3': 1.05,
+    }
+    fits_wcs = astropy.wcs.WCS(header=wcs_header)
+
+    pt = SkyCoord(Tx=0 * u.arcsec, Ty=0 * u.arcsec,
+                  frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))
+
+    # The slice is applied in numpy order, so the first slice (0) applies
+    # to the last WCS axis (wavelength).
+    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
+    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
+
+    # This is the call that produces the bug
+    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)
+
+    # The expected result is based on the unsliced WCS output
+    # fits_wcs.world_to_pixel(pt, 1.05*u.angstrom) -> (array(49.5), array(12.), ...)
+    expected_pixel = (49.5, 12.0)
+
+    assert_allclose(sliced_pixel, expected_pixel)

2025-12-21 11:44:17,777 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 11:44:17,813 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 11:44:17,813 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 11:44:17,914 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:44:17,914 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at 0df94ff709 Merge pull request #13574 from pllim/rm-corpus-404

2025-12-21 11:44:17,914 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 11:44:18,016 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:44:18,016 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:44:18,016 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 11:44:18,016 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/wcs/tests in the container
2025-12-21 11:44:18,017 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/wcs/tests
2025-12-21 11:44:18,118 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:44:18,118 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:44:18,118 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/wcs/tests/test_sliced_wcs_issue_12739.py in the container
2025-12-21 11:44:18,130 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 11:44:24,088 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/wcs/tests/test_sliced_wcs_issue_12739.py"}'}, '__gemini_function_call_thought_signatures__': {'e74cccb4-bb00-4ceb-a8a9-ff2d0524bbdd': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1879, 'candidates_token_count': 29, 'total_token_count': 2429, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1879}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 29}], 'thoughts_token_count': 521, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.734411305394666, 'model_name': 'gemini-2.5-pro'} id='run--7b64a1cd-3391-427b-8eb5-a7de44eff6b7-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/wcs/tests/test_sliced_wcs_issue_12739.py'}, 'id': 'e74cccb4-bb00-4ceb-a8a9-ff2d0524bbdd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1879, 'output_tokens': 29, 'total_tokens': 2429, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 521}}
2025-12-21 11:44:24,091 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/wcs/tests/test_sliced_wcs_issue_12739.py
2025-12-21 11:44:27,979 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 11:44:27,980 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/wcs/tests/test_sliced_wcs_is
ssue_12739.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.
Running tests in astropy/wcs/tests/test_sliced_wcs_issue_12739.py.

Date: 2025-12-21T11:44:27

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/wcs/tests/test_sliced_wcs_issue_12739.py [31mF[0m[31m                       [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_sliced_world_to_pixel_coupled ______________________[0m

    def test_sliced_world_to_pixel_coupled():
        """
        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
        with coupled axes gives an incorrect result.
    
        See: https://github.com/astropy/astropy/issues/12739
        """
        nx = 100
        ny = 25
        wcs_header = {
            'WCSAXES': 3,
            'CRPIX1': (nx + 1) / 2,
            'CRPIX2': (ny + 1) / 2,
            'CRPIX3': 1.0,
            'PC1_1': 0.0,
            'PC1_2': -1.0,
            'PC1_3': 0.0,
            'PC2_1': 1.0,
            'PC2_2': 0.0,
            'PC2_3': -1.0,
            'CDELT1': 5,
            'CDELT2': 5,
            'CDELT3': 0.055,
            'CUNIT1': 'arcsec',
            'CUNIT2': 'arcsec',
            'CUNIT3': 'Angstrom',
            'CTYPE1': 'HPLN-TAN',
            'CTYPE2': 'HPLT-TAN',
            'CTYPE3': 'WAVE',
            'CRVAL1': 0.0,
            'CRVAL2': 0.0,
            'CRVAL3': 1.05,
        }
        fits_wcs = astropy.wcs.WCS(header=wcs_header)
    
        pt = SkyCoord(Tx=0 * u.arcsec, Ty=0 * u.arcsec,
>                     frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))

[1m[31mastropy/wcs/tests/test_sliced_wcs_issue_12739.py[0m:47: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

wcs = WCS Keywords

Number of WCS axes: 3
CTYPE : 'HPLN-TAN'  'HPLT-TAN'  'WAVE'  
CRVAL : 0.0  0.0  1.0500000000000001e-10 ... -1.0  
PC3_1 PC3_2 PC3_3  : 0.0  0.0  1.0  
CDELT : 0.001388888888888889  0.001388888888888889  5.5e-12  
NAXIS : 0  0

    def wcs_to_celestial_frame(wcs):
        """
        For a given WCS, return the coordinate frame that matches the celestial
        component of the WCS.
    
        Parameters
        ----------
        wcs : :class:`~astropy.wcs.WCS` instance
            The WCS to find the frame for
    
        Returns
        -------
        frame : :class:`~astropy.coordinates.baseframe.BaseCoordinateFrame` subclass instance
            An instance of a :class:`~astropy.coordinates.baseframe.BaseCoordinateFrame`
            subclass instance that best matches the specified WCS.
    
        Notes
        -----
    
        To extend this function to frames not defined in astropy.coordinates, you
        can write your own function which should take a :class:`~astropy.wcs.WCS`
        instance and should return either an instance of a frame, or `None` if no
        matching frame was found. You can register this function temporarily with::
    
            >>> from astropy.wcs.utils import wcs_to_celestial_frame, custom_wcs_to_frame_mappings
            >>> with custom_wcs_to_frame_mappings(my_function):
            ...     wcs_to_celestial_frame(...)
    
        """
        for mapping_set in WCS_FRAME_MAPPINGS:
            for func in mapping_set:
                frame = func(wcs)
                if frame is not None:
                    return frame
>       raise ValueError("Could not determine celestial frame corresponding to "
                         "the specified WCS object")
[1m[31mE       ValueError: Could not determine celestial frame corresponding to the specified WCS object[0m

[1m[31mastropy/wcs/utils.py[0m:219: ValueError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/wcs/tests/test_sliced_wcs_issue_12739.py::[1mtest_sliced_world_to_pixel_coupled[0m - ValueError: Could not determine celestial frame corresponding to the specif...
[31m============================== [31m[1m1 failed[0m[31m in 0.14s[0m[31m ===============================[0m

2025-12-21 11:44:41,406 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='pytest astropy/wcs/tests/test_sliced_wcs_issue_12739.py\n\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.\nRunning tests in astropy/wcs/tests/test_sliced_wcs_issue_12739.py.\n\nDate: 2025-12-21T11:44:27\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/wcs/tests/test_sliced_wcs_issue_12739.py F                       [100%]\n\n=================================== FAILURES ===================================\n______________________ test_sliced_world_to_pixel_coupled ______________________\n\n    def test_sliced_world_to_pixel_coupled():\n        """\n        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n        with coupled axes gives an incorrect result.\n    \n        See: https://github.com/astropy/astropy/issues/12739\n        """\n        nx = 100\n        ny = 25\n        wcs_header = {\n            \'WCSAXES\': 3,\n            \'CRPIX1\': (nx + 1) / 2,\n            \'CRPIX2\': (ny + 1) / 2,\n            \'CRPIX3\': 1.0,\n            \'PC1_1\': 0.0,\n            \'PC1_2\': -1.0,\n            \'PC1_3\': 0.0,\n            \'PC2_1\': 1.0,\n            \'PC2_2\': 0.0,\n            \'PC2_3\': -1.0,\n            \'CDELT1\': 5,\n            \'CDELT2\': 5,\n            \'CDELT3\': 0.055,\n            \'CUNIT1\': \'arcsec\',\n            \'CUNIT2\': \'arcsec\',\n            \'CUNIT3\': \'Angstrom\',\n            \'CTYPE1\': \'HPLN-TAN\',\n            \'CTYPE2\': \'HPLT-TAN\',\n            \'CTYPE3\': \'WAVE\',\n            \'CRVAL1\': 0.0,\n            \'CRVAL2\': 0.0,\n            \'CRVAL3\': 1.05,\n        }\n        fits_wcs = astropy.wcs.WCS(header=wcs_header)\n    \n        pt = SkyCoord(Tx=0 * u.arcsec, Ty=0 * u.arcsec,\n>                     frame=astropy.wcs.utils.wcs_to_celestial_frame(fits_wcs))\n\nastropy/wcs/tests/test_sliced_wcs_issue_12739.py:47: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nwcs = WCS Keywords\n\nNumber of WCS axes: 3\nCTYPE : \'HPLN-TAN\'  \'HPLT-TAN\'  \'WAVE\'  \nCRVAL : 0.0  0.0  1.0500000000000001e-10 ... -1.0  \nPC3_1 PC3_2 PC3_3  : 0.0  0.0  1.0  \nCDELT : 0.001388888888888889  0.001388888888888889  5.5e-12  \nNAXIS : 0  0\n\n    def wcs_to_celestial_frame(wcs):\n        """\n        For a given WCS, return the coordinate frame that matches the celestial\n        component of the WCS.\n    \n        Parameters\n        ----------\n        wcs : :class:`~astropy.wcs.WCS` instance\n            The WCS to find the frame for\n    \n        Returns\n        -------\n        frame : :class:`~astropy.coordinates.baseframe.BaseCoordinateFrame` subclass instance\n            An instance of a :class:`~astropy.coordinates.baseframe.BaseCoordinateFrame`\n            subclass instance that best matches the specified WCS.\n    \n        Notes\n        -----\n    \n        To extend this function to frames not defined in astropy.coordinates, you\n        can write your own function which should take a :class:`~astropy.wcs.WCS`\n        instance and should return either an instance of a frame, or `None` if no\n        matching frame was found. You can register this function temporarily with::\n    \n            >>> from astropy.wcs.utils import wcs_to_celestial_frame, custom_wcs_to_frame_mappings\n            >>> with custom_wcs_to_frame_mappings(my_function):\n            ...     wcs_to_celestial_frame(...)\n    \n        """\n        for mapping_set in WCS_FRAME_MAPPINGS:\n            for func in mapping_set:\n                frame = func(wcs)\n                if frame is not None:\n                    return frame\n>       raise ValueError("Could not determine celestial frame corresponding to "\n                         "the specified WCS object")\nE       ValueError: Could not determine celestial frame corresponding to the specified WCS object\n\nastropy/wcs/utils.py:219: ValueError\n=========================== short test summary info ============================\nFAILED astropy/wcs/tests/test_sliced_wcs_issue_12739.py::test_sliced_world_to_pixel_coupled - ValueError: Could not determine celestial frame corresponding to the specif...\n============================== 1 failed in 0.14s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2792, 'end_index': 3648, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 4041, 'end_index': 4416, 'uri': 'https://docs.astropy.org/en/stable/_modules/astropy/wcs/utils.html', 'title': '', 'license_': ''}, {'start_index': 4247, 'end_index': 4693, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 4666, 'end_index': 5042, 'uri': 'https://docs.astropy.org/en/stable/_modules/astropy/wcs/utils.html', 'title': '', 'license_': ''}, {'start_index': 5040, 'end_index': 5541, 'uri': 'https://docs.astropy.org/en/stable/_modules/astropy/wcs/utils.html', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 3820, 'candidates_token_count': 1782, 'total_token_count': 5851, 'cached_content_token_count': 1739, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4341}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1739}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1782}], 'thoughts_token_count': 249}, 'finish_reason': 'STOP', 'avg_logprobs': -0.01885702473547322, 'model_name': 'gemini-2.5-pro'} id='run--f4e9fe21-8dcf-4bba-87cd-8a680dc0ec4a-0' usage_metadata={'input_tokens': 3820, 'output_tokens': 1782, 'total_tokens': 5851, 'input_token_details': {'cache_read': 1739}, 'output_token_details': {'reasoning': 249}}
2025-12-21 11:44:53,090 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='FAILED astropy/wcs/tests/test_sliced_wcs_issue_12739.py::test_sliced_world_to_pixel_coupled - ValueError: Could not determine celestial frame corresponding to the specified WCS object\n\nTest fails with a ValueError when creating the SkyCoord object. The issue describes a bug where world_to_pixel returns an incorrect, very large value, not a ValueError on setup. The test does not reach the point of calling world_to_pixel on the sliced WCS, which is where the bug is supposed to manifest.' reproduced_bug_commands=['pytest astropy/wcs/tests/test_sliced_wcs_issue_12739.py']
2025-12-21 11:44:53,092 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-12-21 11:44:53,092 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-12-21 11:44:53,093 - thread-130546535499456.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-12-21 11:44:53,122 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED astropy/wcs/tests/test_sliced_wcs_issue_12739.py::test_sliced_world_to_pixel_coupled - ValueError: Could not determine celestial frame corresponding to the specified WCS object\n\nTest fails with a ValueError when creating the SkyCoord object. The issue describes a bug where world_to_pixel returns an incorrect, very large value, not a ValueError on setup. The test does not reach the point of calling world_to_pixel on the sliced WCS, which is where the bug is supposed to manifest.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-12-21 11:45:52,411 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='An analysis of the previous attempt reveals that the test failed during the setup phase, specifically when trying to create a `SkyCoord` object with a Helioprojective frame. The utility `astropy.wcs.utils.wcs_to_celestial_frame` could not automatically determine the frame from the provided WCS header, likely due to missing observer information, which is often implicitly handled by libraries like `sunpy` but not in the core `astropy` test environment. This prevented the test from reaching the actual buggy code path in `world_to_pixel`.\n\nTo rectify this, the new test case avoids the problematic frame creation. Instead, it leverages the fact that the forward transformation `pixel_to_world` is reported to work correctly. It first performs a `pixel_to_world` transformation on the unsliced WCS to obtain the correct high-level `SkyCoord` object for a known pixel. This `SkyCoord` object is then used as the input for the `world_to_pixel` call on the sliced WCS. This approach directly recreates the conditions described in the bug report and ensures the test focuses on the `world_to_pixel` method of the sliced WCS, which is where the bug lies. The assertion correctly checks if the output pixel coordinates match the original spatial pixel coordinates, which will fail with the bug present and pass once it\'s fixed.\n\n```python\nimport numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    This test works by taking a known pixel coordinate from the unsliced WCS,\n    converting it to a world coordinate, and then using that world coordinate\n    as input to the sliced WCS\'s world_to_pixel method. This avoids issues\n    with creating the celestial frame manually.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    # These pixel coordinates are known to correspond to the world coordinates of interest.\n    # From the bug report: fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)\n    # gives (array(49.5), array(12.), array(2.44249065e-15))\n    pixel_coords_unsliced = (49.5, 12.0, 0.0)\n\n    # Use the working pixel_to_world to get the high-level SkyCoord object.\n    # This avoids the ValueError from trying to create the frame manually.\n    pt, _ = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\n                                    pixel_coords_unsliced[1],\n                                    pixel_coords_unsliced[2])\n\n    # Now, slice the WCS, removing the wavelength dimension.\n    # The slice is applied in numpy order, so slicing with 0 drops the first\n    # numpy axis, which corresponds to the last WCS axis (wavelength).\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # This is the call that exhibits the bug.\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\n    # The expected result is the spatial part of the original pixel coordinates.\n    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])\n\n    # The bug produces a very large number for the first pixel coordinate,\n    # so this assertion will fail. It will pass when the bug is fixed.\n    assert_allclose(sliced_pixel, expected_pixel)\n\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 8599, 'end_index': 9312, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 16241, 'end_index': 16862, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 88730, 'candidates_token_count': 1245, 'total_token_count': 94378, 'cached_content_token_count': 85573, 'prompt_tokens_details': [{'modality': 1, 'token_count': 88730}], 'cache_tokens_details': [{'modality': 1, 'token_count': 85573}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1245}], 'thoughts_token_count': 4403}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5856816425859689, 'model_name': 'gemini-2.5-pro'} id='run--f558dc52-22f1-4b4a-befa-a61cbba81459-0' usage_metadata={'input_tokens': 88730, 'output_tokens': 1245, 'total_tokens': 94378, 'input_token_details': {'cache_read': 85573}, 'output_token_details': {'reasoning': 4403}}
2025-12-21 11:46:17,457 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nfrom numpy.testing import assert_allclose\\nimport pytest\\n\\nimport astropy.units as u\\nimport astropy.wcs\\nfrom astropy.coordinates import SkyCoord\\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\\n\\n\\ndef test_sliced_world_to_pixel_coupled():\\n    \\"\\"\\"\\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\\n    with coupled axes gives an incorrect result.\\n\\n    This test works by taking a known pixel coordinate from the unsliced WCS,\\n    converting it to a world coordinate, and then using that world coordinate\\n    as input to the sliced WCS\'s world_to_pixel method. This avoids issues\\n    with creating the celestial frame manually.\\n\\n    See: https://github.com/astropy/astropy/issues/12739\\n    \\"\\"\\"\\n    nx = 100\\n    ny = 25\\n    wcs_header = {\\n        \'WCSAXES\': 3,\\n        \'CRPIX1\': (nx + 1) / 2,\\n        \'CRPIX2\': (ny + 1) / 2,\\n        \'CRPIX3\': 1.0,\\n        \'PC1_1\': 0.0,\\n        \'PC1_2\': -1.0,\\n        \'PC1_3\': 0.0,\\n        \'PC2_1\': 1.0,\\n        \'PC2_2\': 0.0,\\n        \'PC2_3\': -1.0,\\n        \'CDELT1\': 5,\\n        \'CDELT2\': 5,\\n        \'CDELT3\': 0.055,\\n        \'CUNIT1\': \'arcsec\',\\n        \'CUNIT2\': \'arcsec\',\\n        \'CUNIT3\': \'Angstrom\',\\n        \'CTYPE1\': \'HPLN-TAN\',\\n        \'CTYPE2\': \'HPLT-TAN\',\\n        \'CTYPE3\': \'WAVE\',\\n        \'CRVAL1\': 0.0,\\n        \'CRVAL2\': 0.0,\\n        \'CRVAL3\': 1.05,\\n    }\\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\\n\\n    # These pixel coordinates are known to correspond to the world coordinates of interest.\\n    # From the bug report: fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)\\n    # gives (array(49.5), array(12.), array(2.44249065e-15))\\n    pixel_coords_unsliced = (49.5, 12.0, 0.0)\\n\\n    # Use the working pixel_to_world to get the high-level SkyCoord object.\\n    # This avoids the ValueError from trying to create the frame manually.\\n    pt, _ = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\\n                                    pixel_coords_unsliced[1],\\n                                    pixel_coords_unsliced[2])\\n\\n    # Now, slice the WCS, removing the wavelength dimension.\\n    # The slice is applied in numpy order, so slicing with 0 drops the first\\n    # numpy axis, which corresponds to the last WCS axis (wavelength).\\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\\n\\n    # This is the call that exhibits the bug.\\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\\n\\n    # The expected result is the spatial part of the original pixel coordinates.\\n    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])\\n\\n    # The bug produces a very large number for the first pixel coordinate,\\n    # so this assertion will fail. It will pass when the bug is fixed.\\n    assert_allclose(sliced_pixel, expected_pixel)\\n", "relative_path": "astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py"}'}, '__gemini_function_call_thought_signatures__': {'921cbb27-5770-4887-8a8c-ab047230d124': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 4824, 'end_index': 5445, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 7939, 'end_index': 8560, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 1563, 'candidates_token_count': 979, 'total_token_count': 4692, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1563}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 979}], 'thoughts_token_count': 2150, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.179975344041273, 'model_name': 'gemini-2.5-pro'} id='run--64424d67-9a53-40f7-9fdd-b78d6b648e24-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    This test works by taking a known pixel coordinate from the unsliced WCS,\n    converting it to a world coordinate, and then using that world coordinate\n    as input to the sliced WCS\'s world_to_pixel method. This avoids issues\n    with creating the celestial frame manually.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    # These pixel coordinates are known to correspond to the world coordinates of interest.\n    # From the bug report: fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)\n    # gives (array(49.5), array(12.), array(2.44249065e-15))\n    pixel_coords_unsliced = (49.5, 12.0, 0.0)\n\n    # Use the working pixel_to_world to get the high-level SkyCoord object.\n    # This avoids the ValueError from trying to create the frame manually.\n    pt, _ = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\n                                    pixel_coords_unsliced[1],\n                                    pixel_coords_unsliced[2])\n\n    # Now, slice the WCS, removing the wavelength dimension.\n    # The slice is applied in numpy order, so slicing with 0 drops the first\n    # numpy axis, which corresponds to the last WCS axis (wavelength).\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # This is the call that exhibits the bug.\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\n    # The expected result is the spatial part of the original pixel coordinates.\n    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])\n\n    # The bug produces a very large number for the first pixel coordinate,\n    # so this assertion will fail. It will pass when the bug is fixed.\n    assert_allclose(sliced_pixel, expected_pixel)\n', 'relative_path': 'astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py'}, 'id': '921cbb27-5770-4887-8a8c-ab047230d124', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1563, 'output_tokens': 979, 'total_tokens': 4692, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2150}}
2025-12-21 11:46:18,146 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2574, 'candidates_token_count': 22, 'total_token_count': 2596, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4723}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 22}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -3.494907683819871e-06, 'model_name': 'gemini-2.5-pro'} id='run--cc851c47-b85b-40aa-85f4-53c98ddac4ce-0' usage_metadata={'input_tokens': 2574, 'output_tokens': 22, 'total_tokens': 2596, 'input_token_details': {'cache_read': 0}}
2025-12-21 11:46:18,177 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py b/astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py
new file mode 100644
index 0000000000..b3543c159b
--- /dev/null
+++ b/astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py
@@ -0,0 +1,76 @@
+import numpy as np
+from numpy.testing import assert_allclose
+import pytest
+
+import astropy.units as u
+import astropy.wcs
+from astropy.coordinates import SkyCoord
+from astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper
+
+
+def test_sliced_world_to_pixel_coupled():
+    """
+    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
+    with coupled axes gives an incorrect result.
+
+    This test works by taking a known pixel coordinate from the unsliced WCS,
+    converting it to a world coordinate, and then using that world coordinate
+    as input to the sliced WCS's world_to_pixel method. This avoids issues
+    with creating the celestial frame manually.
+
+    See: https://github.com/astropy/astropy/issues/12739
+    """
+    nx = 100
+    ny = 25
+    wcs_header = {
+        'WCSAXES': 3,
+        'CRPIX1': (nx + 1) / 2,
+        'CRPIX2': (ny + 1) / 2,
+        'CRPIX3': 1.0,
+        'PC1_1': 0.0,
+        'PC1_2': -1.0,
+        'PC1_3': 0.0,
+        'PC2_1': 1.0,
+        'PC2_2': 0.0,
+        'PC2_3': -1.0,
+        'CDELT1': 5,
+        'CDELT2': 5,
+        'CDELT3': 0.055,
+        'CUNIT1': 'arcsec',
+        'CUNIT2': 'arcsec',
+        'CUNIT3': 'Angstrom',
+        'CTYPE1': 'HPLN-TAN',
+        'CTYPE2': 'HPLT-TAN',
+        'CTYPE3': 'WAVE',
+        'CRVAL1': 0.0,
+        'CRVAL2': 0.0,
+        'CRVAL3': 1.05,
+    }
+    fits_wcs = astropy.wcs.WCS(header=wcs_header)
+
+    # These pixel coordinates are known to correspond to the world coordinates of interest.
+    # From the bug report: fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)
+    # gives (array(49.5), array(12.), array(2.44249065e-15))
+    pixel_coords_unsliced = (49.5, 12.0, 0.0)
+
+    # Use the working pixel_to_world to get the high-level SkyCoord object.
+    # This avoids the ValueError from trying to create the frame manually.
+    pt, _ = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],
+                                    pixel_coords_unsliced[1],
+                                    pixel_coords_unsliced[2])
+
+    # Now, slice the WCS, removing the wavelength dimension.
+    # The slice is applied in numpy order, so slicing with 0 drops the first
+    # numpy axis, which corresponds to the last WCS axis (wavelength).
+    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
+    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
+
+    # This is the call that exhibits the bug.
+    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)
+
+    # The expected result is the spatial part of the original pixel coordinates.
+    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])
+
+    # The bug produces a very large number for the first pixel coordinate,
+    # so this assertion will fail. It will pass when the bug is fixed.
+    assert_allclose(sliced_pixel, expected_pixel)

2025-12-21 11:46:18,178 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 11:46:18,206 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 11:46:18,206 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 11:46:18,308 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:46:18,308 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at 0df94ff709 Merge pull request #13574 from pllim/rm-corpus-404

2025-12-21 11:46:18,308 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 11:46:18,409 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:46:18,409 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

Removing astropy/wcs/tests/test_sliced_wcs_issue_12739.py

2025-12-21 11:46:18,410 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 11:46:18,410 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/wcs/tests in the container
2025-12-21 11:46:18,410 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/wcs/tests
2025-12-21 11:46:18,511 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:46:18,511 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:46:18,512 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py in the container
2025-12-21 11:46:18,520 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 11:46:25,860 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py"}'}, '__gemini_function_call_thought_signatures__': {'3c89009f-fcc2-4360-adeb-cb02744b95d2': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1877, 'candidates_token_count': 27, 'total_token_count': 2601, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1877}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 697, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -4.455354761194299, 'model_name': 'gemini-2.5-pro'} id='run--c39af0d8-61f7-419d-90e2-4b1429bef3de-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py'}, 'id': '3c89009f-fcc2-4360-adeb-cb02744b95d2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1877, 'output_tokens': 27, 'total_tokens': 2601, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 697}}
2025-12-21 11:46:25,863 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py
2025-12-21 11:46:27,675 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 11:46:27,675 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/wcs/tests/test_sliced_wcs_wo
orld_to_pixel.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.
Running tests in astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py.

Date: 2025-12-21T11:46:27

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py [31mF[0m[31m                    [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_sliced_world_to_pixel_coupled ______________________[0m

    def test_sliced_world_to_pixel_coupled():
        """
        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
        with coupled axes gives an incorrect result.
    
        This test works by taking a known pixel coordinate from the unsliced WCS,
        converting it to a world coordinate, and then using that world coordinate
        as input to the sliced WCS's world_to_pixel method. This avoids issues
        with creating the celestial frame manually.
    
        See: https://github.com/astropy/astropy/issues/12739
        """
        nx = 100
        ny = 25
        wcs_header = {
            'WCSAXES': 3,
            'CRPIX1': (nx + 1) / 2,
            'CRPIX2': (ny + 1) / 2,
            'CRPIX3': 1.0,
            'PC1_1': 0.0,
            'PC1_2': -1.0,
            'PC1_3': 0.0,
            'PC2_1': 1.0,
            'PC2_2': 0.0,
            'PC2_3': -1.0,
            'CDELT1': 5,
            'CDELT2': 5,
            'CDELT3': 0.055,
            'CUNIT1': 'arcsec',
            'CUNIT2': 'arcsec',
            'CUNIT3': 'Angstrom',
            'CTYPE1': 'HPLN-TAN',
            'CTYPE2': 'HPLT-TAN',
            'CTYPE3': 'WAVE',
            'CRVAL1': 0.0,
            'CRVAL2': 0.0,
            'CRVAL3': 1.05,
        }
        fits_wcs = astropy.wcs.WCS(header=wcs_header)
    
        # These pixel coordinates are known to correspond to the world coordinates of interest.
        # From the bug report: fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)
        # gives (array(49.5), array(12.), array(2.44249065e-15))
        pixel_coords_unsliced = (49.5, 12.0, 0.0)
    
        # Use the working pixel_to_world to get the high-level SkyCoord object.
        # This avoids the ValueError from trying to create the frame manually.
>       pt, _ = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],
                                        pixel_coords_unsliced[1],
                                        pixel_coords_unsliced[2])
[1m[31mE       ValueError: too many values to unpack (expected 2)[0m

[1m[31mastropy/wcs/tests/test_sliced_wcs_world_to_pixel.py[0m:58: ValueError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py::[1mtest_sliced_world_to_pixel_coupled[0m - ValueError: too many values to unpack (expected 2)
[31m============================== [31m[1m1 failed[0m[31m in 0.10s[0m[31m ===============================[0m

2025-12-21 11:46:39,103 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='pytest astropy/wcs/tests/test_sliced_wcs_wo\nrld_to_pixel.py\n\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.\nRunning tests in astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py.\n\nDate: 2025-12-21T11:46:27\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/wcs/tests/test_sliced_wcs_world_to_pixel.py F                    [100%]\n\n=================================== FAILURES ===================================\n______________________ test_sliced_world_to_pixel_coupled ______________________\n\n    def test_sliced_world_to_pixel_coupled():\n        """\n        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n        with coupled axes gives an incorrect result.\n    \n        This test works by taking a known pixel coordinate from the unsliced WCS,\n        converting it to a world coordinate, and then using that world coordinate\n        as input to the sliced WCS\'s world_to_pixel method. This avoids issues\n        with creating the celestial frame manually.\n    \n        See: https://github.com/astropy/astropy/issues/12739\n        """\n        nx = 100\n        ny = 25\n        wcs_header = {\n            \'WCSAXES\': 3,\n            \'CRPIX1\': (nx + 1) / 2,\n            \'CRPIX2\': (ny + 1) / 2,\n            \'CRPIX3\': 1.0,\n            \'PC1_1\': 0.0,\n            \'PC1_2\': -1.0,\n            \'PC1_3\': 0.0,\n            \'PC2_1\': 1.0,\n            \'PC2_2\': 0.0,\n            \'PC2_3\': -1.0,\n            \'CDELT1\': 5,\n            \'CDELT2\': 5,\n            \'CDELT3\': 0.055,\n            \'CUNIT1\': \'arcsec\',\n            \'CUNIT2\': \'arcsec\',\n            \'CUNIT3\': \'Angstrom\',\n            \'CTYPE1\': \'HPLN-TAN\',\n            \'CTYPE2\': \'HPLT-TAN\',\n            \'CTYPE3\': \'WAVE\',\n            \'CRVAL1\': 0.0,\n            \'CRVAL2\': 0.0,\n            \'CRVAL3\': 1.05,\n        }\n        fits_wcs = astropy.wcs.WCS(header=wcs_header)\n    \n        # These pixel coordinates are known to correspond to the world coordinates of interest.\n        # From the bug report: fits_wcs.world_to_pixel(pt, 1.05*u.angstrom)\n        # gives (array(49.5), array(12.), array(2.44249065e-15))\n        pixel_coords_unsliced = (49.5, 12.0, 0.0)\n    \n        # Use the working pixel_to_world to get the high-level SkyCoord object.\n        # This avoids the ValueError from trying to create the frame manually.\n>       pt, _ = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\n                                        pixel_coords_unsliced[1],\n                                        pixel_coords_unsliced[2])\nE       ValueError: too many values to unpack (expected 2)\n\nastropy/wcs/tests/test_sliced_wcs_world_to_pixel.py:58: ValueError\n=========================== short test summary info ============================\nFAILED astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py::test_sliced_world_to_pixel_coupled - ValueError: too many values to unpack (expected 2)\n============================== 1 failed in 0.10s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2595, 'end_index': 3312, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 3399, 'candidates_token_count': 1379, 'total_token_count': 4885, 'cached_content_token_count': 1742, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4096}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1742}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1379}], 'thoughts_token_count': 107}, 'finish_reason': 'STOP', 'avg_logprobs': -0.007395882637626974, 'model_name': 'gemini-2.5-pro'} id='run--bd19e0e1-d29f-4e21-a267-8846279e4e5b-0' usage_metadata={'input_tokens': 3399, 'output_tokens': 1379, 'total_tokens': 4885, 'input_token_details': {'cache_read': 1742}, 'output_token_details': {'reasoning': 107}}
2025-12-21 11:47:01,656 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='FAILED astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py::test_sliced_world_to_pixel_coupled - ValueError: too many values to unpack (expected 2)\n\nThe test fails with a `ValueError` when trying to unpack the results of `fits_wcs.pixel_to_world`. This is a setup failure that occurs before the test can exercise the buggy behavior described in the issue.\n\nThe issue describes a bug in `hl_sliced_wcs.world_to_pixel(pt)`, where it returns an incorrect numeric value. The test fails to reach this call, and instead crashes with a `ValueError` while preparing the inputs for it. Therefore, the test does not reproduce the reported bug.' reproduced_bug_commands=['pytest astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py']
2025-12-21 11:47:01,657 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-12-21 11:47:01,658 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-12-21 11:47:01,659 - thread-130546535499456.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-12-21 11:47:01,686 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py::test_sliced_world_to_pixel_coupled - ValueError: too many values to unpack (expected 2)\n\nThe test fails with a `ValueError` when trying to unpack the results of `fits_wcs.pixel_to_world`. This is a setup failure that occurs before the test can exercise the buggy behavior described in the issue.\n\nThe issue describes a bug in `hl_sliced_wcs.world_to_pixel(pt)`, where it returns an incorrect numeric value. The test fails to reach this call, and instead crashes with a `ValueError` while preparing the inputs for it. Therefore, the test does not reproduce the reported bug.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-12-21 11:48:04,421 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='An analysis of the previous attempt reveals that the test failed during the setup phase with a `ValueError: too many values to unpack (expected 2)`. This occurred on the line `pt, _ = fits_wcs.pixel_to_world(...)`. While the `pixel_to_world` method for this WCS should return two high-level objects (a `SkyCoord` and a `SpectralCoord`), the unpacking failed. This could be due to subtle environment differences or an unexpected return format in some edge cases. This failure prevented the test from reaching the actual buggy code in `hl_sliced_wcs.world_to_pixel(pt)`.\n\nTo create a more robust test, the new approach avoids unpacking the return value of `pixel_to_world` directly. Instead, it assigns the entire returned list of high-level objects to a single variable and then explicitly indexes it to retrieve the `SkyCoord` object. This makes the test less brittle and ensures it can successfully prepare the necessary inputs to exercise the bug. The rest of the test logic remains the same: it uses the correctly-working `pixel_to_world` on the unsliced WCS to get a valid world coordinate, then feeds that coordinate into the `world_to_pixel` method of the sliced WCS, where the bug is triggered due to incorrect handling of coupled axes. The assertion correctly checks for the expected pixel values, which will fail with the bug present and pass when it is fixed.\n\n```python\nimport numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    This test works by taking a known pixel coordinate from the unsliced WCS,\n    converting it to a world coordinate, and then using that world coordinate\n    as input to the sliced WCS\'s world_to_pixel method. This avoids issues\n    with creating the celestial frame manually or fragile unpacking.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    # The bug report implies the central pixel is of interest.\n    # The pixel coordinates are 0-indexed.\n    pixel_coords_unsliced = (49.5, 12.0, 0.0)\n\n    # Use the working pixel_to_world to get the high-level coordinate objects.\n    # This returns a list of high-level objects, in this case [SkyCoord, SpectralCoord].\n    # We assign to a single variable to avoid unpacking errors.\n    world_objects = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\n                                            pixel_coords_unsliced[1],\n                                            pixel_coords_unsliced[2])\n    pt = world_objects[0]\n\n    # Now, slice the WCS, removing the wavelength dimension.\n    # The slice is applied in numpy order, so slicing with 0 drops the first\n    # numpy axis, which corresponds to the last WCS axis (wavelength).\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # This is the call that exhibits the bug.\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\n    # The expected result is the spatial part of the original pixel coordinates.\n    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])\n\n    # The bug produces a very large number for the first pixel coordinate,\n    # so this assertion will fail. It will pass when the bug is fixed.\n    assert_allclose(sliced_pixel, expected_pixel)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3946, 'end_index': 4184, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 17047, 'end_index': 17668, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 90182, 'candidates_token_count': 1239, 'total_token_count': 96202, 'cached_content_token_count': 85570, 'prompt_tokens_details': [{'modality': 1, 'token_count': 90182}], 'cache_tokens_details': [{'modality': 1, 'token_count': 85570}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1239}], 'thoughts_token_count': 4781}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7052699497767857, 'model_name': 'gemini-2.5-pro'} id='run--dfa0b1aa-44e8-49c4-af8d-24475295dcc6-0' usage_metadata={'input_tokens': 90182, 'output_tokens': 1239, 'total_tokens': 96202, 'input_token_details': {'cache_read': 85570}, 'output_token_details': {'reasoning': 4781}}
2025-12-21 11:48:18,285 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nfrom numpy.testing import assert_allclose\\nimport pytest\\n\\nimport astropy.units as u\\nimport astropy.wcs\\nfrom astropy.coordinates import SkyCoord\\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\\n\\n\\ndef test_sliced_world_to_pixel_coupled():\\n    \\"\\"\\"\\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\\n    with coupled axes gives an incorrect result.\\n\\n    This test works by taking a known pixel coordinate from the unsliced WCS,\\n    converting it to a world coordinate, and then using that world coordinate\\n    as input to the sliced WCS\'s world_to_pixel method. This avoids issues\\n    with creating the celestial frame manually or fragile unpacking.\\n\\n    See: https://github.com/astropy/astropy/issues/12739\\n    \\"\\"\\"\\n    nx = 100\\n    ny = 25\\n    wcs_header = {\\n        \'WCSAXES\': 3,\\n        \'CRPIX1\': (nx + 1) / 2,\\n        \'CRPIX2\': (ny + 1) / 2,\\n        \'CRPIX3\': 1.0,\\n        \'PC1_1\': 0.0,\\n        \'PC1_2\': -1.0,\\n        \'PC1_3\': 0.0,\\n        \'PC2_1\': 1.0,\\n        \'PC2_2\': 0.0,\\n        \'PC2_3\': -1.0,\\n        \'CDELT1\': 5,\\n        \'CDELT2\': 5,\\n        \'CDELT3\': 0.055,\\n        \'CUNIT1\': \'arcsec\',\\n        \'CUNIT2\': \'arcsec\',\\n        \'CUNIT3\': \'Angstrom\',\\n        \'CTYPE1\': \'HPLN-TAN\',\\n        \'CTYPE2\': \'HPLT-TAN\',\\n        \'CTYPE3\': \'WAVE\',\\n        \'CRVAL1\': 0.0,\\n        \'CRVAL2\': 0.0,\\n        \'CRVAL3\': 1.05,\\n    }\\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\\n\\n    # The bug report implies the central pixel is of interest.\\n    # The pixel coordinates are 0-indexed.\\n    pixel_coords_unsliced = (49.5, 12.0, 0.0)\\n\\n    # Use the working pixel_to_world to get the high-level coordinate objects.\\n    # This returns a list of high-level objects, in this case [SkyCoord, SpectralCoord].\\n    # We assign to a single variable to avoid unpacking errors.\\n    world_objects = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\\n                                            pixel_coords_unsliced[1],\\n                                            pixel_coords_unsliced[2])\\n    pt = world_objects[0]\\n\\n    # Now, slice the WCS, removing the wavelength dimension.\\n    # The slice is applied in numpy order, so slicing with 0 drops the first\\n    # numpy axis, which corresponds to the last WCS axis (wavelength).\\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\\n\\n    # This is the call that exhibits the bug.\\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\\n\\n    # The expected result is the spatial part of the original pixel coordinates.\\n    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])\\n\\n    # The bug produces a very large number for the first pixel coordinate,\\n    # so this assertion will fail. It will pass when the bug is fixed.\\n    assert_allclose(sliced_pixel, expected_pixel)\\n", "relative_path": "astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py"}'}, '__gemini_function_call_thought_signatures__': {'687ca2dd-3626-4c2d-96a8-c244f38ff057': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3166, 'end_index': 3787, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 1557, 'candidates_token_count': 955, 'total_token_count': 3126, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1557}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 955}], 'thoughts_token_count': 614, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09029676027947071, 'model_name': 'gemini-2.5-pro'} id='run--18b6b095-450e-4008-82f3-225ddcdefcf1-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    This test works by taking a known pixel coordinate from the unsliced WCS,\n    converting it to a world coordinate, and then using that world coordinate\n    as input to the sliced WCS\'s world_to_pixel method. This avoids issues\n    with creating the celestial frame manually or fragile unpacking.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    # The bug report implies the central pixel is of interest.\n    # The pixel coordinates are 0-indexed.\n    pixel_coords_unsliced = (49.5, 12.0, 0.0)\n\n    # Use the working pixel_to_world to get the high-level coordinate objects.\n    # This returns a list of high-level objects, in this case [SkyCoord, SpectralCoord].\n    # We assign to a single variable to avoid unpacking errors.\n    world_objects = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\n                                            pixel_coords_unsliced[1],\n                                            pixel_coords_unsliced[2])\n    pt = world_objects[0]\n\n    # Now, slice the WCS, removing the wavelength dimension.\n    # The slice is applied in numpy order, so slicing with 0 drops the first\n    # numpy axis, which corresponds to the last WCS axis (wavelength).\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # This is the call that exhibits the bug.\n    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\n    # The expected result is the spatial part of the original pixel coordinates.\n    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])\n\n    # The bug produces a very large number for the first pixel coordinate,\n    # so this assertion will fail. It will pass when the bug is fixed.\n    assert_allclose(sliced_pixel, expected_pixel)\n', 'relative_path': 'astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py'}, 'id': '687ca2dd-3626-4c2d-96a8-c244f38ff057', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1557, 'output_tokens': 955, 'total_tokens': 3126, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 614}}
2025-12-21 11:48:19,786 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2543, 'candidates_token_count': 21, 'total_token_count': 2564, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3157}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 21}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -8.269226998977719e-06, 'model_name': 'gemini-2.5-pro'} id='run--ecc5845c-cc6e-428e-90de-09298b2b3224-0' usage_metadata={'input_tokens': 2543, 'output_tokens': 21, 'total_tokens': 2564, 'input_token_details': {'cache_read': 0}}
2025-12-21 11:48:19,817 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py b/astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py
new file mode 100644
index 0000000000..55e6e5ae65
--- /dev/null
+++ b/astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py
@@ -0,0 +1,77 @@
+import numpy as np
+from numpy.testing import assert_allclose
+import pytest
+
+import astropy.units as u
+import astropy.wcs
+from astropy.coordinates import SkyCoord
+from astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper
+
+
+def test_sliced_world_to_pixel_coupled():
+    """
+    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
+    with coupled axes gives an incorrect result.
+
+    This test works by taking a known pixel coordinate from the unsliced WCS,
+    converting it to a world coordinate, and then using that world coordinate
+    as input to the sliced WCS's world_to_pixel method. This avoids issues
+    with creating the celestial frame manually or fragile unpacking.
+
+    See: https://github.com/astropy/astropy/issues/12739
+    """
+    nx = 100
+    ny = 25
+    wcs_header = {
+        'WCSAXES': 3,
+        'CRPIX1': (nx + 1) / 2,
+        'CRPIX2': (ny + 1) / 2,
+        'CRPIX3': 1.0,
+        'PC1_1': 0.0,
+        'PC1_2': -1.0,
+        'PC1_3': 0.0,
+        'PC2_1': 1.0,
+        'PC2_2': 0.0,
+        'PC2_3': -1.0,
+        'CDELT1': 5,
+        'CDELT2': 5,
+        'CDELT3': 0.055,
+        'CUNIT1': 'arcsec',
+        'CUNIT2': 'arcsec',
+        'CUNIT3': 'Angstrom',
+        'CTYPE1': 'HPLN-TAN',
+        'CTYPE2': 'HPLT-TAN',
+        'CTYPE3': 'WAVE',
+        'CRVAL1': 0.0,
+        'CRVAL2': 0.0,
+        'CRVAL3': 1.05,
+    }
+    fits_wcs = astropy.wcs.WCS(header=wcs_header)
+
+    # The bug report implies the central pixel is of interest.
+    # The pixel coordinates are 0-indexed.
+    pixel_coords_unsliced = (49.5, 12.0, 0.0)
+
+    # Use the working pixel_to_world to get the high-level coordinate objects.
+    # This returns a list of high-level objects, in this case [SkyCoord, SpectralCoord].
+    # We assign to a single variable to avoid unpacking errors.
+    world_objects = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],
+                                            pixel_coords_unsliced[1],
+                                            pixel_coords_unsliced[2])
+    pt = world_objects[0]
+
+    # Now, slice the WCS, removing the wavelength dimension.
+    # The slice is applied in numpy order, so slicing with 0 drops the first
+    # numpy axis, which corresponds to the last WCS axis (wavelength).
+    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
+    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
+
+    # This is the call that exhibits the bug.
+    sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)
+
+    # The expected result is the spatial part of the original pixel coordinates.
+    expected_pixel = (pixel_coords_unsliced[0], pixel_coords_unsliced[1])
+
+    # The bug produces a very large number for the first pixel coordinate,
+    # so this assertion will fail. It will pass when the bug is fixed.
+    assert_allclose(sliced_pixel, expected_pixel)

2025-12-21 11:48:19,818 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 11:48:19,847 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 11:48:19,847 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 11:48:19,948 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:48:19,948 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at 0df94ff709 Merge pull request #13574 from pllim/rm-corpus-404

2025-12-21 11:48:19,948 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 11:48:20,049 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:48:20,050 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

Removing astropy/wcs/tests/test_sliced_wcs_world_to_pixel.py

2025-12-21 11:48:20,050 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 11:48:20,050 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/wcs/tests in the container
2025-12-21 11:48:20,050 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/wcs/tests
2025-12-21 11:48:20,152 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:48:20,152 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:48:20,152 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py in the container
2025-12-21 11:48:20,159 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 11:48:26,185 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py"}'}, '__gemini_function_call_thought_signatures__': {'158b14ff-6d87-44ff-ab6d-a1f0730068b1': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1876, 'candidates_token_count': 26, 'total_token_count': 2434, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1876}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 532, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.7398355924166164, 'model_name': 'gemini-2.5-pro'} id='run--2654ccb1-914c-4f41-92b1-e5a8e3caa0d9-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py'}, 'id': '158b14ff-6d87-44ff-ab6d-a1f0730068b1', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1876, 'output_tokens': 26, 'total_tokens': 2434, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 532}}
2025-12-21 11:48:26,188 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py
2025-12-21 11:48:27,985 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 11:48:27,985 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/wcs/tests/test_sliced_world_
_to_pixel_coupled.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.
Running tests in astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py.

Date: 2025-12-21T11:48:27

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py [31mF[0m[31m                [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_sliced_world_to_pixel_coupled ______________________[0m

    def test_sliced_world_to_pixel_coupled():
        """
        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
        with coupled axes gives an incorrect result.
    
        This test works by taking a known pixel coordinate from the unsliced WCS,
        converting it to a world coordinate, and then using that world coordinate
        as input to the sliced WCS's world_to_pixel method. This avoids issues
        with creating the celestial frame manually or fragile unpacking.
    
        See: https://github.com/astropy/astropy/issues/12739
        """
        nx = 100
        ny = 25
        wcs_header = {
            'WCSAXES': 3,
            'CRPIX1': (nx + 1) / 2,
            'CRPIX2': (ny + 1) / 2,
            'CRPIX3': 1.0,
            'PC1_1': 0.0,
            'PC1_2': -1.0,
            'PC1_3': 0.0,
            'PC2_1': 1.0,
            'PC2_2': 0.0,
            'PC2_3': -1.0,
            'CDELT1': 5,
            'CDELT2': 5,
            'CDELT3': 0.055,
            'CUNIT1': 'arcsec',
            'CUNIT2': 'arcsec',
            'CUNIT3': 'Angstrom',
            'CTYPE1': 'HPLN-TAN',
            'CTYPE2': 'HPLT-TAN',
            'CTYPE3': 'WAVE',
            'CRVAL1': 0.0,
            'CRVAL2': 0.0,
            'CRVAL3': 1.05,
        }
        fits_wcs = astropy.wcs.WCS(header=wcs_header)
    
        # The bug report implies the central pixel is of interest.
        # The pixel coordinates are 0-indexed.
        pixel_coords_unsliced = (49.5, 12.0, 0.0)
    
        # Use the working pixel_to_world to get the high-level coordinate objects.
        # This returns a list of high-level objects, in this case [SkyCoord, SpectralCoord].
        # We assign to a single variable to avoid unpacking errors.
        world_objects = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],
                                                pixel_coords_unsliced[1],
                                                pixel_coords_unsliced[2])
        pt = world_objects[0]
    
        # Now, slice the WCS, removing the wavelength dimension.
        # The slice is applied in numpy order, so slicing with 0 drops the first
        # numpy axis, which corresponds to the last WCS axis (wavelength).
        ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
        hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
    
        # This is the call that exhibits the bug.
>       sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)

[1m[31mastropy/wcs/tests/test_sliced_world_to_pixel_coupled.py[0m:70: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31mastropy/wcs/wcsapi/high_level_api.py[0m:309: in world_to_pixel
    world_values = high_level_objects_to_values(*world_objects, low_level_wcs=self.low_level_wcs)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

low_level_wcs = <astropy.wcs.wcsapi.wrappers.sliced_wcs.SlicedLowLevelWCS object at 0x748301be5be0>
SlicedLowLevelWCS Transformation

...elation between pixel and world axes:

           Pixel Dim
World Dim    0    1
        0  yes  yes
        1  yes  yes
world_objects = (<Quantity 4.29649529e-31 deg>,)
serialized_classes = {'hpln': (<class 'astropy.units.quantity.Quantity'>, (), {'unit': Unit("deg")}), 'hplt': (<class 'astropy.units.quantity.Quantity'>, (), {'unit': Unit("deg")})}
components = [('hpln', 0, 'value'), ('hplt', 0, 'value')]

    def high_level_objects_to_values(*world_objects, low_level_wcs):
        """
        Convert the input high level object to low level values.
    
        This function uses the information in ``wcs.world_axis_object_classes`` and
        ``wcs.world_axis_object_components`` to convert the high level objects
        (such as `~.SkyCoord`) to low level "values" `~.Quantity` objects.
    
        This is used in `.HighLevelWCSMixin.world_to_pixel`, but provided as a
        separate function for use in other places where needed.
    
        Parameters
        ----------
        *world_objects: object
            High level coordinate objects.
    
        low_level_wcs: `.BaseLowLevelWCS`
            The WCS object to use to interpret the coordinates.
        """
        # Cache the classes and components since this may be expensive
        serialized_classes = low_level_wcs.world_axis_object_classes
        components = low_level_wcs.world_axis_object_components
    
        # Deserialize world_axis_object_classes using the default order
        classes = OrderedDict()
        for key in default_order(components):
            if low_level_wcs.serialized_classes:
                classes[key] = deserialize_class(serialized_classes[key],
                                                 construct=False)
            else:
                classes[key] = serialized_classes[key]
    
        # Check that the number of classes matches the number of inputs
        if len(world_objects) != len(classes):
>           raise ValueError("Number of world inputs ({}) does not match "
                             "expected ({})".format(len(world_objects), len(classes)))
[1m[31mE           ValueError: Number of world inputs (1) does not match expected (2)[0m

[1m[31mastropy/wcs/wcsapi/high_level_api.py[0m:154: ValueError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py::[1mtest_sliced_world_to_pixel_coupled[0m - ValueError: Number of world inputs (1) does not match expected (2)
[31m============================== [31m[1m1 failed[0m[31m in 0.12s[0m[31m ===============================[0m

2025-12-21 11:48:45,949 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='I have executed the test file `astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py`. Here is the output:\n```\npytest astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py\n\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.\nRunning tests in astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py.\n\nDate: 2025-12-21T11:48:27\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/wcs/tests/test_sliced_world_to_pixel_coupled.py F                [100%]\n\n=================================== FAILURES ===================================\n______________________ test_sliced_world_to_pixel_coupled ______________________\n\n    def test_sliced_world_to_pixel_coupled():\n        """\n        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n        with coupled axes gives an incorrect result.\n    \n        This test works by taking a known pixel coordinate from the unsliced WCS,\n        converting it to a world coordinate, and then using that world coordinate\n        as input to the sliced WCS\'s world_to_pixel method. This avoids issues\n        with creating the celestial frame manually or fragile unpacking.\n    \n        See: https://github.com/astropy/astropy/issues/12739\n        """\n        nx = 100\n        ny = 25\n        wcs_header = {\n            \'WCSAXES\': 3,\n            \'CRPIX1\': (nx + 1) / 2,\n            \'CRPIX2\': (ny + 1) / 2,\n            \'CRPIX3\': 1.0,\n            \'PC1_1\': 0.0,\n            \'PC1_2\': -1.0,\n            \'PC1_3\': 0.0,\n            \'PC2_1\': 1.0,\n            \'PC2_2\': 0.0,\n            \'PC2_3\': -1.0,\n            \'CDELT1\': 5,\n            \'CDELT2\': 5,\n            \'CDELT3\': 0.055,\n            \'CUNIT1\': \'arcsec\',\n            \'CUNIT2\': \'arcsec\',\n            \'CUNIT3\': \'Angstrom\',\n            \'CTYPE1\': \'HPLN-TAN\',\n            \'CTYPE2\': \'HPLT-TAN\',\n            \'CTYPE3\': \'WAVE\',\n            \'CRVAL1\': 0.0,\n            \'CRVAL2\': 0.0,\n            \'CRVAL3\': 1.05,\n        }\n        fits_wcs = astropy.wcs.WCS(header=wcs_header)\n    \n        # The bug report implies the central pixel is of interest.\n        # The pixel coordinates are 0-indexed.\n        pixel_coords_unsliced = (49.5, 12.0, 0.0)\n    \n        # Use the working pixel_to_world to get the high-level coordinate objects.\n        # This returns a list of high-level objects, in this case [SkyCoord, SpectralCoord].\n        # We assign to a single variable to avoid unpacking errors.\n        world_objects = fits_wcs.pixel_to_world(pixel_coords_unsliced[0],\n                                                pixel_coords_unsliced[1],\n                                                pixel_coords_unsliced[2])\n        pt = world_objects[0]\n    \n        # Now, slice the WCS, removing the wavelength dimension.\n        # The slice is applied in numpy order, so slicing with 0 drops the first\n        # numpy axis, which corresponds to the last WCS axis (wavelength).\n        ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n        hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n    \n        # This is the call that exhibits the bug.\n>       sliced_pixel = hl_sliced_wcs.world_to_pixel(pt)\n\nastropy/wcs/tests/test_sliced_world_to_pixel_coupled.py:70: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nastropy/wcs/wcsapi/high_level_api.py:309: in world_to_pixel\n    world_values = high_level_objects_to_values(*world_objects, low_level_wcs=self.low_level_wcs)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nlow_level_wcs = <astropy.wcs.wcsapi.wrappers.sliced_wcs.SlicedLowLevelWCS object at 0x748301be5be0>\nSlicedLowLevelWCS Transformation\n\n...elation between pixel and world axes:\n\n           Pixel Dim\nWorld Dim    0    1\n        0  yes  yes\n        1  yes  yes\nworld_objects = (<Quantity 4.29649529e-31 deg>,)\nserialized_classes = {\'hpln\': (<class \'astropy.units.quantity.Quantity\'>, (), {\'unit\': Unit("deg")}), \'hplt\': (<class \'astropy.units.quantity.Quantity\'>, (), {\'unit\': Unit("deg")})}\ncomponents = [(\'hpln\', 0, \'value\'), (\'hplt\', 0, \'value\')]\n\n    def high_level_objects_to_values(*world_objects, low_level_wcs):\n        """\n        Convert the input high level object to low level values.\n    \n        This function uses the information in ``wcs.world_axis_object_classes`` and\n        ``wcs.world_axis_object_components`` to convert the high level objects\n        (such as `~.SkyCoord`) to low level "values" `~.Quantity` objects.\n    \n        This is used in `.HighLevelWCSMixin.world_to_pixel`, but provided as a\n        separate function for use in other places where needed.\n    \n        Parameters\n        ----------\n        *world_objects: object\n            High level coordinate objects.\n    \n        low_level_wcs: `.BaseLowLevelWCS`\n            The WCS object to use to interpret the coordinates.\n        """\n        # Cache the classes and components since this may be expensive\n        serialized_classes = low_level_wcs.world_axis_object_classes\n        components = low_level_wcs.world_axis_object_components\n    \n        # Deserialize world_axis_object_classes using the default order\n        classes = OrderedDict()\n        for key in default_order(components):\n            if low_level_wcs.serialized_classes:\n                classes[key] = deserialize_class(serialized_classes[key],\n                                                 construct=False)\n            else:\n                classes[key] = serialized_classes[key]\n    \n        # Check that the number of classes matches the number of inputs\n        if len(world_objects) != len(classes):\n>           raise ValueError("Number of world inputs ({}) does not match "\n                             "expected ({})".format(len(world_objects), len(classes)))\nE           ValueError: Number of world inputs (1) does not match expected (2)\n\nastropy/wcs/wcsapi/high_level_api.py:154: ValueError\n=========================== short test summary info ============================\nFAILED astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py::test_sliced_world_to_pixel_coupled - ValueError: Number of world inputs (1) does not match expected (2)\n============================== 1 failed in 0.12s ===============================\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2680, 'end_index': 3397, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 5454, 'end_index': 6997, 'title': 'Your prompt', 'uri': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 4306, 'candidates_token_count': 2306, 'total_token_count': 6693, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4838}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 2306}], 'thoughts_token_count': 81, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.006120973324010606, 'model_name': 'gemini-2.5-pro'} id='run--47c925eb-6b01-4d1d-a69e-5102e994b838-0' usage_metadata={'input_tokens': 4306, 'output_tokens': 2306, 'total_tokens': 6693, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 81}}
2025-12-21 11:49:01,370 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='FAILED astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py::test_sliced_world_to_pixel_coupled - ValueError: Number of world inputs (1) does not match expected (2)\n\nThe test fails with a `ValueError` because the high-level WCS wrapper expects two world inputs for the sliced WCS but only receives one. The bug report, however, describes an incorrect numerical result `(array(1.81818182e+11), array(12.))` and not a `ValueError`. The test is failing before the incorrect calculation can be performed, so it does not reproduce the bug as described.' reproduced_bug_commands=['pytest astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py']
2025-12-21 11:49:01,371 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-12-21 11:49:01,372 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-12-21 11:49:01,373 - thread-130546535499456.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-12-21 11:49:01,401 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py::test_sliced_world_to_pixel_coupled - ValueError: Number of world inputs (1) does not match expected (2)\n\nThe test fails with a `ValueError` because the high-level WCS wrapper expects two world inputs for the sliced WCS but only receives one. The bug report, however, describes an incorrect numerical result `(array(1.81818182e+11), array(12.))` and not a `ValueError`. The test is failing before the incorrect calculation can be performed, so it does not reproduce the bug as described.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-12-21 11:51:39,298 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='An analysis of the previous attempt shows that the test failed with a `ValueError: Number of world inputs (1) does not match expected (2)`. This occurred because the high-level WCS wrapper, in the test environment, did not recognize the two celestial axes (`HPLN-TAN`, `HPLT-TAN`) as a single `SkyCoord` object. Instead, it treated them as two separate world objects, likely of type `astropy.units.Quantity`, and thus expected two separate inputs to the `world_to_pixel` method. Passing a single `SkyCoord` object resulted in an argument mismatch.\n\nTo resolve this and correctly reproduce the bug, the new test case will align with this expectation by passing two separate `astropy.units.Quantity` objects to `world_to_pixel`, representing the two spatial world coordinates. This satisfies the high-level API\'s argument parser, allowing the test to proceed to the underlying buggy code in `SlicedLowLevelWCS`. The bug itself lies in how the sliced WCS handles the inverse transformation for coupled axesâ€”it uses an incorrect hardcoded placeholder value for the dropped world dimension (wavelength). By providing the correct inputs to the high-level wrapper, the test now successfully triggers this incorrect calculation, leading to the erroneous large pixel value described in the bug report. The assertion checks for the correct pixel value, which will fail with the bug present and pass once the fix is implemented.\n\n```python\nimport numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    This test calls the high-level world_to_pixel wrapper with two separate\n    Quantity objects to satisfy the argument parser, which in this test\n    environment expects two world objects instead of a single SkyCoord.\n    This allows the test to reach the underlying buggy code.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    # The slice is on the wavelength axis (last WCS axis), at pixel index 0.\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # Input world coordinates for the sliced (2D) WCS.\n    # We pass them as two separate Quantities to match what the high-level\n    # API expects in this context.\n    tx = 0 * u.arcsec\n    ty = 0 * u.arcsec\n\n    # This is the call that exhibits the bug.\n    pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)\n\n    # The expected output from the bug report, which is the correct pixel\n    # coordinates for the given world coordinates.\n    expected_pixel_coords = (49.5, 12.0)\n\n    # The bug causes the first value to be ~1.8e11. This assertion will fail.\n    # It will pass when the underlying SlicedLowLevelWCS uses the correct\n    # reference world value for the dropped dimension.\n    assert_allclose(pixel_out, expected_pixel_coords)\n\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 20146, 'end_index': 20436, 'uri': 'https://docs.astropy.org/en/stable/_modules/astropy/wcs/wcsapi/wrappers/sliced_wcs.html', 'title': '', 'license_': ''}, {'start_index': 36300, 'end_index': 36715, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}, {'start_index': 42506, 'end_index': 43127, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 91613, 'candidates_token_count': 1119, 'total_token_count': 105874, 'prompt_tokens_details': [{'modality': 1, 'token_count': 91613}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1119}], 'thoughts_token_count': 13142, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.958655581504133, 'model_name': 'gemini-2.5-pro'} id='run--1d7986e4-d42f-4339-a86d-7dddf2e5e4f0-0' usage_metadata={'input_tokens': 91613, 'output_tokens': 1119, 'total_tokens': 105874, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 13142}}
2025-12-21 11:51:52,779 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nfrom numpy.testing import assert_allclose\\nimport pytest\\n\\nimport astropy.units as u\\nimport astropy.wcs\\nfrom astropy.coordinates import SkyCoord\\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\\n\\n\\ndef test_sliced_world_to_pixel_coupled():\\n    \\"\\"\\"\\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\\n    with coupled axes gives an incorrect result.\\n\\n    This test calls the high-level world_to_pixel wrapper with two separate\\n    Quantity objects to satisfy the argument parser, which in this test\\n    environment expects two world objects instead of a single SkyCoord.\\n    This allows the test to reach the underlying buggy code.\\n\\n    See: https://github.com/astropy/astropy/issues/12739\\n    \\"\\"\\"\\n    nx = 100\\n    ny = 25\\n    wcs_header = {\\n        \'WCSAXES\': 3,\\n        \'CRPIX1\': (nx + 1) / 2,\\n        \'CRPIX2\': (ny + 1) / 2,\\n        \'CRPIX3\': 1.0,\\n        \'PC1_1\': 0.0,\\n        \'PC1_2\': -1.0,\\n        \'PC1_3\': 0.0,\\n        \'PC2_1\': 1.0,\\n        \'PC2_2\': 0.0,\\n        \'PC2_3\': -1.0,\\n        \'CDELT1\': 5,\\n        \'CDELT2\': 5,\\n        \'CDELT3\': 0.055,\\n        \'CUNIT1\': \'arcsec\',\\n        \'CUNIT2\': \'arcsec\',\\n        \'CUNIT3\': \'Angstrom\',\\n        \'CTYPE1\': \'HPLN-TAN\',\\n        \'CTYPE2\': \'HPLT-TAN\',\\n        \'CTYPE3\': \'WAVE\',\\n        \'CRVAL1\': 0.0,\\n        \'CRVAL2\': 0.0,\\n        \'CRVAL3\': 1.05,\\n    }\\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\\n\\n    # The slice is on the wavelength axis (last WCS axis), at pixel index 0.\\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\\n\\n    # Input world coordinates for the sliced (2D) WCS.\\n    # We pass them as two separate Quantities to match what the high-level\\n    # API expects in this context.\\n    tx = 0 * u.arcsec\\n    ty = 0 * u.arcsec\\n\\n    # This is the call that exhibits the bug.\\n    pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)\\n\\n    # The expected output from the bug report, which is the correct pixel\\n    # coordinates for the given world coordinates.\\n    expected_pixel_coords = (49.5, 12.0)\\n\\n    # The bug causes the first value to be ~1.8e11. This assertion will fail.\\n    # It will pass when the underlying SlicedLowLevelWCS uses the correct\\n    # reference world value for the dropped dimension.\\n    assert_allclose(pixel_out, expected_pixel_coords)\\n", "relative_path": "astropy/wcs/tests/test_sliced_wcs_issue12739.py"}'}, '__gemini_function_call_thought_signatures__': {'59d54852-b43d-4c79-b832-c2fcb14be4b9': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3859, 'end_index': 4480, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 1437, 'candidates_token_count': 845, 'total_token_count': 3062, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1437}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 845}], 'thoughts_token_count': 780, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10874158870539016, 'model_name': 'gemini-2.5-pro'} id='run--b19d9c51-48a3-43c0-adff-aacd360f1eeb-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nfrom numpy.testing import assert_allclose\nimport pytest\n\nimport astropy.units as u\nimport astropy.wcs\nfrom astropy.coordinates import SkyCoord\nfrom astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper\n\n\ndef test_sliced_world_to_pixel_coupled():\n    """\n    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n    with coupled axes gives an incorrect result.\n\n    This test calls the high-level world_to_pixel wrapper with two separate\n    Quantity objects to satisfy the argument parser, which in this test\n    environment expects two world objects instead of a single SkyCoord.\n    This allows the test to reach the underlying buggy code.\n\n    See: https://github.com/astropy/astropy/issues/12739\n    """\n    nx = 100\n    ny = 25\n    wcs_header = {\n        \'WCSAXES\': 3,\n        \'CRPIX1\': (nx + 1) / 2,\n        \'CRPIX2\': (ny + 1) / 2,\n        \'CRPIX3\': 1.0,\n        \'PC1_1\': 0.0,\n        \'PC1_2\': -1.0,\n        \'PC1_3\': 0.0,\n        \'PC2_1\': 1.0,\n        \'PC2_2\': 0.0,\n        \'PC2_3\': -1.0,\n        \'CDELT1\': 5,\n        \'CDELT2\': 5,\n        \'CDELT3\': 0.055,\n        \'CUNIT1\': \'arcsec\',\n        \'CUNIT2\': \'arcsec\',\n        \'CUNIT3\': \'Angstrom\',\n        \'CTYPE1\': \'HPLN-TAN\',\n        \'CTYPE2\': \'HPLT-TAN\',\n        \'CTYPE3\': \'WAVE\',\n        \'CRVAL1\': 0.0,\n        \'CRVAL2\': 0.0,\n        \'CRVAL3\': 1.05,\n    }\n    fits_wcs = astropy.wcs.WCS(header=wcs_header)\n\n    # The slice is on the wavelength axis (last WCS axis), at pixel index 0.\n    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n\n    # Input world coordinates for the sliced (2D) WCS.\n    # We pass them as two separate Quantities to match what the high-level\n    # API expects in this context.\n    tx = 0 * u.arcsec\n    ty = 0 * u.arcsec\n\n    # This is the call that exhibits the bug.\n    pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)\n\n    # The expected output from the bug report, which is the correct pixel\n    # coordinates for the given world coordinates.\n    expected_pixel_coords = (49.5, 12.0)\n\n    # The bug causes the first value to be ~1.8e11. This assertion will fail.\n    # It will pass when the underlying SlicedLowLevelWCS uses the correct\n    # reference world value for the dropped dimension.\n    assert_allclose(pixel_out, expected_pixel_coords)\n', 'relative_path': 'astropy/wcs/tests/test_sliced_wcs_issue12739.py'}, 'id': '59d54852-b43d-4c79-b832-c2fcb14be4b9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1437, 'output_tokens': 845, 'total_tokens': 3062, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 780}}
2025-12-21 11:51:53,701 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/wcs/tests/test_sliced_wcs_issue12739.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2315, 'candidates_token_count': 23, 'total_token_count': 2338, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3095}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 23}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -7.577007636427879e-06, 'model_name': 'gemini-2.5-pro'} id='run--02dd9072-25e9-428a-a03c-9c806d312625-0' usage_metadata={'input_tokens': 2315, 'output_tokens': 23, 'total_tokens': 2338, 'input_token_details': {'cache_read': 0}}
2025-12-21 11:51:53,733 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/wcs/tests/test_sliced_wcs_issue12739.py b/astropy/wcs/tests/test_sliced_wcs_issue12739.py
new file mode 100644
index 0000000000..aa82056dc9
--- /dev/null
+++ b/astropy/wcs/tests/test_sliced_wcs_issue12739.py
@@ -0,0 +1,71 @@
+import numpy as np
+from numpy.testing import assert_allclose
+import pytest
+
+import astropy.units as u
+import astropy.wcs
+from astropy.coordinates import SkyCoord
+from astropy.wcs.wcsapi import SlicedLowLevelWCS, HighLevelWCSWrapper
+
+
+def test_sliced_world_to_pixel_coupled():
+    """
+    Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
+    with coupled axes gives an incorrect result.
+
+    This test calls the high-level world_to_pixel wrapper with two separate
+    Quantity objects to satisfy the argument parser, which in this test
+    environment expects two world objects instead of a single SkyCoord.
+    This allows the test to reach the underlying buggy code.
+
+    See: https://github.com/astropy/astropy/issues/12739
+    """
+    nx = 100
+    ny = 25
+    wcs_header = {
+        'WCSAXES': 3,
+        'CRPIX1': (nx + 1) / 2,
+        'CRPIX2': (ny + 1) / 2,
+        'CRPIX3': 1.0,
+        'PC1_1': 0.0,
+        'PC1_2': -1.0,
+        'PC1_3': 0.0,
+        'PC2_1': 1.0,
+        'PC2_2': 0.0,
+        'PC2_3': -1.0,
+        'CDELT1': 5,
+        'CDELT2': 5,
+        'CDELT3': 0.055,
+        'CUNIT1': 'arcsec',
+        'CUNIT2': 'arcsec',
+        'CUNIT3': 'Angstrom',
+        'CTYPE1': 'HPLN-TAN',
+        'CTYPE2': 'HPLT-TAN',
+        'CTYPE3': 'WAVE',
+        'CRVAL1': 0.0,
+        'CRVAL2': 0.0,
+        'CRVAL3': 1.05,
+    }
+    fits_wcs = astropy.wcs.WCS(header=wcs_header)
+
+    # The slice is on the wavelength axis (last WCS axis), at pixel index 0.
+    ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
+    hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
+
+    # Input world coordinates for the sliced (2D) WCS.
+    # We pass them as two separate Quantities to match what the high-level
+    # API expects in this context.
+    tx = 0 * u.arcsec
+    ty = 0 * u.arcsec
+
+    # This is the call that exhibits the bug.
+    pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)
+
+    # The expected output from the bug report, which is the correct pixel
+    # coordinates for the given world coordinates.
+    expected_pixel_coords = (49.5, 12.0)
+
+    # The bug causes the first value to be ~1.8e11. This assertion will fail.
+    # It will pass when the underlying SlicedLowLevelWCS uses the correct
+    # reference world value for the dropped dimension.
+    assert_allclose(pixel_out, expected_pixel_coords)

2025-12-21 11:51:53,734 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 11:51:53,762 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 11:51:53,763 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 11:51:53,864 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:51:53,864 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at 0df94ff709 Merge pull request #13574 from pllim/rm-corpus-404

2025-12-21 11:51:53,864 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 11:51:53,966 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:51:53,966 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

Removing astropy/wcs/tests/test_sliced_world_to_pixel_coupled.py

2025-12-21 11:51:53,966 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 11:51:53,966 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/wcs/tests in the container
2025-12-21 11:51:53,967 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/wcs/tests
2025-12-21 11:51:54,068 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:51:54,068 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:51:54,068 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/wcs/tests/test_sliced_wcs_issue12739.py in the container
2025-12-21 11:51:54,074 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 11:52:00,801 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/wcs/tests/test_sliced_wcs_issue12739.py"}'}, '__gemini_function_call_thought_signatures__': {'a92f0ab3-5d88-4bda-81ac-c00fdc66b239': 'CvUOAY89a18L7a9kstvTLvE1c8noaSp3bB5xsbJT7ypNCpzJFFew8usL9lZKuS0LrEqbHVTQnzvxfPnzataHan5LzRr5NbNfi2kYSw0r6oMAI6dFQSvmVR0uIhjlpvbviImRCVDJUidFPuCBYLWBjuBSB7z+oFgvs/3fR2Pp7SE7Y8ee36IKz3BDVGNRIuJ4H2GPD91fohYSGvdfxS+MvL+OceRSvckjuutFY1Y6P1jOVBjyFr/c2P1p/MliLtSBzzcEnbTA+84PbhotjbfdnXlql5IHXEFmDEl+mExCDMyfmGSqnN58q1XXczeTwd3RGrE266ByAwtpPKqIzCKBHqAckLG5PF974OvnWVzOFNGEMjWST4FASfMyciCNFrH85lLvhxd9IIFxyHe1FQ/80VWtQFsERdb9Ru3idIpI711vZNrG2ZSfGM8VNJGTIHC8OWN+PKGtmDqVnPfWNmDAoAoO1dxkGby85VrDEUmu5PpeVUQSulsBE2xYZt7LybwZHVvbTUaiYWeh/buMIS8b0DDXvg4byJTJJ3m//CAcJ7sO7kV8YQesgS/Sn5L5FrrkZ5llC6uEI660qzUcFP+R4C53z1VkXYQbr2whJkIxwWef969zPDdyN8rXMjeMSbMsIV9ySUePQIX4BxpWUeCD4+SDZ/az+oJVcKfyaHkGjqKSEWqgn6NAqvBCYS/XVn+DQ84Y1ra/Lm0peOPMakDhYr7mJuLDWkUYv0dQfsUrqkQsClXVfGrJWMn/9sdqKMyoHwaVWQP3z/cQ5DMSu/KWrsAUoXCwAD4U4B6hcVzahZDivN61QrV0Cead70j8SgP5i1DpsWLcAXq5BbUtTzZoo5pRTgq6QAfSesNOGvhL7h4uFDoYx3dx63zvM1XQjbaWeRxJs+VamPiozqQDP3T64ICjGBSreeVydhJhhS0Se4Fl7HwKL7VCD97ruv6saVgVJO43atc4h5kUHYDg2/PEDiNiPxevi01eHINQfaJ44Gsy6pKHrAzCp2Y1d4WgacnItAkgaqdIxr/PYLjJpye/1dI4KDp9T3e3NtfDEUb7DKOPGeqMqgMe1Y5skl3+QHXH7TxECeviWTvDeyRUXbnFZ5Kh+QrZfJ+F3UP5K80Gy3ghMhMQdGLiXaWcYUvYHAtpswA5RF9XlMOPWOpDRmEWF+uzm+PILAqmbAIBOzo+uKzurI9IPiHA5i2olX6fOoJOAWMQcXdSZVfmT8hkSIwisB/AZ18CRyopJKPPFY6dYJRD9wXSZeAokb7BxYX964fHXhQK9krLVn14nyeqby27wUNtA5UxOUNKs2QAyOs6bs82hXt0zCc1WXEsoT+6/sdurz4zqq6zGCBlhREXKu+y6+EzwK61k6XxncVVKPgnGqWnJ/TLkBki7YGo71qg58iTBK97+2d0ThP6cry+FfWmp7retrMg3UYudJaTFXBRwT9MPbLsMHW+oG/1lQc7T4JOoPpG7nMuAoxCULh9HKJ3G+q9B/ywKhB0PtC4josBOAFRR1XvFuR/rCZcd6b2rXyviz2icJemBKSNdR9J/AzwtQHCtFwKbdIGZ3LpQb+EFn3xMjlCbH3LCwT/VD6jj0bs+YPZ6AOMNVpO0mqryX4JqKZkeSclUvJAitZv6bd/Pu9nJ+HUVWDVKJ6/D/iEoroDvNZb4Ih8qGVtPOyZG/rTnNnIWwNrpwGwJfpLJLjrYgEaSx0GxrlRyhuX4Yex8mHQ1yGSC34KDbLypLmqPi1ctEOrp+usTpj5J3n5ujb+dHJifwrVO1rKnfX+jgcOCUGBEd0pWcvhTwbFOUPX453KgaePV7de4eNJR+m5mW2UEVTxsCDHaRPjqXWSNPC8XnBlmLvv5HlqawPXqifedLde25D3/zAwONjgKMMlLYEKV5WoE0NdOPgGbIUIOexeWQwBXl07IG6pqcCeeoBiyEfvxRuRDqRf838Da0nvsxKuymKX+T3Uv+VG2131eU0IszSYkIYN9ahIVxwv7FXd76ucdgNlhCMye3l/f6UugNqvf96dw6/bKT+hP3vRrHNBo2wNK0nYKxniKz+z5a5WVdFG7qTnJNffuPgvfYXqacezctY5cDqCVNCXE6MXSX6qLRYOcVpzknpdDSRQObXqOcpYYbFAucwmP6Fq3LrUcdjqaRfmyS41BITEHLHcVIW8DrIYf9pZA2MkydO6FFPs1fC5QVJJAVX2ZqmLR1o3VycRz6tWANwUdyt4W1cY0RKcdJnJ1oCtr8iPIOVxGlvniMNQXd7Omo8g3m+Di7RYzHtqJQ9vtcmPrGJR24F6ee3AgLkkXfnB2ILvWi7Ba80g05fHGuIm3GlsyjsCPu9UUigmMM5ruQewJxh2Sa08T7lkoKRf+ZKW3XkdS7BIweHmYPRWFDxnep0rvYI4mi+1qPZlN2gxMs4C8f1ZSKvcwiSVwDriLDpzLGYv0t2Xc7EyzJsqFjAFJuY1348TrNOM6Zwgst5I3Oo2g65OCsG/VbzFLFLv8/2HAG8rpv8B7Iul3sHXAvO2OJ03QKrewjvW+zRmyXaXmC+NWk8i9A=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1878, 'candidates_token_count': 28, 'total_token_count': 2431, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1878}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 28}], 'thoughts_token_count': 525, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.738814490182059, 'model_name': 'gemini-2.5-pro'} id='run--fafdce92-eeaf-406c-8bc0-9929f08f0c36-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/wcs/tests/test_sliced_wcs_issue12739.py'}, 'id': 'a92f0ab3-5d88-4bda-81ac-c00fdc66b239', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1878, 'output_tokens': 28, 'total_tokens': 2431, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 525}}
2025-12-21 11:52:00,804 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/wcs/tests/test_sliced_wcs_issue12739.py
2025-12-21 11:52:02,642 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 11:52:02,642 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/wcs/tests/test_sliced_wcs_is
ssue12739.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.
Running tests in astropy/wcs/tests/test_sliced_wcs_issue12739.py.

Date: 2025-12-21T11:52:02

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/wcs/tests/test_sliced_wcs_issue12739.py [31mF[0m[31m                        [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_sliced_world_to_pixel_coupled ______________________[0m

    def test_sliced_world_to_pixel_coupled():
        """
        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
        with coupled axes gives an incorrect result.
    
        This test calls the high-level world_to_pixel wrapper with two separate
        Quantity objects to satisfy the argument parser, which in this test
        environment expects two world objects instead of a single SkyCoord.
        This allows the test to reach the underlying buggy code.
    
        See: https://github.com/astropy/astropy/issues/12739
        """
        nx = 100
        ny = 25
        wcs_header = {
            'WCSAXES': 3,
            'CRPIX1': (nx + 1) / 2,
            'CRPIX2': (ny + 1) / 2,
            'CRPIX3': 1.0,
            'PC1_1': 0.0,
            'PC1_2': -1.0,
            'PC1_3': 0.0,
            'PC2_1': 1.0,
            'PC2_2': 0.0,
            'PC2_3': -1.0,
            'CDELT1': 5,
            'CDELT2': 5,
            'CDELT3': 0.055,
            'CUNIT1': 'arcsec',
            'CUNIT2': 'arcsec',
            'CUNIT3': 'Angstrom',
            'CTYPE1': 'HPLN-TAN',
            'CTYPE2': 'HPLT-TAN',
            'CTYPE3': 'WAVE',
            'CRVAL1': 0.0,
            'CRVAL2': 0.0,
            'CRVAL3': 1.05,
        }
        fits_wcs = astropy.wcs.WCS(header=wcs_header)
    
        # The slice is on the wavelength axis (last WCS axis), at pixel index 0.
        ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
        hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
    
        # Input world coordinates for the sliced (2D) WCS.
        # We pass them as two separate Quantities to match what the high-level
        # API expects in this context.
        tx = 0 * u.arcsec
        ty = 0 * u.arcsec
    
        # This is the call that exhibits the bug.
        pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)
    
        # The expected output from the bug report, which is the correct pixel
        # coordinates for the given world coordinates.
        expected_pixel_coords = (49.5, 12.0)
    
        # The bug causes the first value to be ~1.8e11. This assertion will fail.
        # It will pass when the underlying SlicedLowLevelWCS uses the correct
        # reference world value for the dropped dimension.
>       assert_allclose(pixel_out, expected_pixel_coords)

[1m[31mastropy/wcs/tests/test_sliced_wcs_issue12739.py[0m:71: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x732bc566e670>, array([1.81818182e+11, 1.20000000e+01]), array([49.5, 12. ]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
[1m[31mE           AssertionError: [0m
[1m[31mE           Not equal to tolerance rtol=1e-07, atol=0[0m
[1m[31mE           [0m
[1m[31mE           Mismatched elements: 1 / 2 (50%)[0m
[1m[31mE           Max absolute difference: 1.81818182e+11[0m
[1m[31mE           Max relative difference: 3.67309458e+09[0m
[1m[31mE            x: array([1.818182e+11, 1.200000e+01])[0m
[1m[31mE            y: array([49.5, 12. ])[0m

[1m[31m/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py[0m:79: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/wcs/tests/test_sliced_wcs_issue12739.py::[1mtest_sliced_world_to_pixel_coupled[0m - AssertionError: 
[31m============================== [31m[1m1 failed[0m[31m in 0.11s[0m[31m ===============================[0m

2025-12-21 11:52:15,132 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.\nRunning tests in astropy/wcs/tests/test_sliced_wcs_issue12739.py.\n\nDate: 2025-12-21T11:52:02\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/wcs/tests/test_sliced_wcs_issue12739.py F                        [100%]\n\n=================================== FAILURES ===================================\n______________________ test_sliced_world_to_pixel_coupled ______________________\n\n    def test_sliced_world_to_pixel_coupled():\n        """\n        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS\n        with coupled axes gives an incorrect result.\n    \n        This test calls the high-level world_to_pixel wrapper with two separate\n        Quantity objects to satisfy the argument parser, which in this test\n        environment expects two world objects instead of a single SkyCoord.\n        This allows the test to reach the underlying buggy code.\n    \n        See: https://github.com/astropy/astropy/issues/12739\n        """\n        nx = 100\n        ny = 25\n        wcs_header = {\n            \'WCSAXES\': 3,\n            \'CRPIX1\': (nx + 1) / 2,\n            \'CRPIX2\': (ny + 1) / 2,\n            \'CRPIX3\': 1.0,\n            \'PC1_1\': 0.0,\n            \'PC1_2\': -1.0,\n            \'PC1_3\': 0.0,\n            \'PC2_1\': 1.0,\n            \'PC2_2\': 0.0,\n            \'PC2_3\': -1.0,\n            \'CDELT1\': 5,\n            \'CDELT2\': 5,\n            \'CDELT3\': 0.055,\n            \'CUNIT1\': \'arcsec\',\n            \'CUNIT2\': \'arcsec\',\n            \'CUNIT3\': \'Angstrom\',\n            \'CTYPE1\': \'HPLN-TAN\',\n            \'CTYPE2\': \'HPLT-TAN\',\n            \'CTYPE3\': \'WAVE\',\n            \'CRVAL1\': 0.0,\n            \'CRVAL2\': 0.0,\n            \'CRVAL3\': 1.05,\n        }\n        fits_wcs = astropy.wcs.WCS(header=wcs_header)\n    \n        # The slice is on the wavelength axis (last WCS axis), at pixel index 0.\n        ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)\n        hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)\n    \n        # Input world coordinates for the sliced (2D) WCS.\n        # We pass them as two separate Quantities to match what the high-level\n        # API expects in this context.\n        tx = 0 * u.arcsec\n        ty = 0 * u.arcsec\n    \n        # This is the call that exhibits the bug.\n        pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)\n    \n        # The expected output from the bug report, which is the correct pixel\n        # coordinates for the given world coordinates.\n        expected_pixel_coords = (49.5, 12.0)\n    \n        # The bug causes the first value to be ~1.8e11. This assertion will fail.\n        # It will pass when the underlying SlicedLowLevelWCS uses the correct\n        # reference world value for the dropped dimension.\n>       assert_allclose(pixel_out, expected_pixel_coords)\n\nastropy/wcs/tests/test_sliced_wcs_issue12739.py:71: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nargs = (<function assert_allclose.<locals>.compare at 0x732bc566e670>, array([1.81818182e+11, 1.20000000e+01]), array([49.5, 12. ]))\nkwds = {\'equal_nan\': True, \'err_msg\': \'\', \'header\': \'Not equal to tolerance rtol=1e-07, atol=0\', \'verbose\': True}\n\n    @wraps(func)\n    def inner(*args, **kwds):\n        with self._recreate_cm():\n>           return func(*args, **kwds)\nE           AssertionError: \nE           Not equal to tolerance rtol=1e-07, atol=0\nE           \nE           Mismatched elements: 1 / 2 (50%)\nE           Max absolute difference: 1.81818182e+11\nE           Max relative difference: 3.67309458e+09\nE            x: array([1.818182e+11, 1.200000e+01])\nE            y: array([49.5, 12. ])\n\n/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py:79: AssertionError\n=========================== short test summary info ============================\nFAILED astropy/wcs/tests/test_sliced_wcs_issue12739.py::test_sliced_world_to_pixel_coupled - AssertionError: \n============================== 1 failed in 0.11s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2393, 'end_index': 3110, 'uri': 'https://github.com/astropy/astropy/issues/13488', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 3927, 'candidates_token_count': 1795, 'total_token_count': 5795, 'cached_content_token_count': 1721, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4452}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1721}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1795}], 'thoughts_token_count': 73}, 'finish_reason': 'STOP', 'avg_logprobs': -0.004476633310982111, 'model_name': 'gemini-2.5-pro'} id='run--782ab418-6f60-4bd1-9ab0-b3fc2fa7c8b4-0' usage_metadata={'input_tokens': 3927, 'output_tokens': 1795, 'total_tokens': 5795, 'input_token_details': {'cache_read': 1721}, 'output_token_details': {'reasoning': 73}}
2025-12-21 11:52:25,916 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='FAILED astropy/wcs/tests/test_sliced_wcs_issue12739.py::test_sliced_world_to_pixel_coupled - AssertionError: \nNot equal to tolerance rtol=1e-07, atol=0\n\nMismatched elements: 1 / 2 (50%)\nMax absolute difference: 1.81818182e+11\nMax relative difference: 3.67309458e+09\n x: array([1.818182e+11, 1.200000e+01])\n y: array([49.5, 12. ])' reproduced_bug_commands=['pytest astropy/wcs/tests/test_sliced_wcs_issue12739.py']
2025-12-21 11:52:25,918 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-21 11:52:25,918 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-21 11:52:25,918 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/wcs/tests/test_sliced_wcs_issue12739.py
2025-12-21 11:52:27,772 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 11:52:27,772 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/wcs/tests/test_sliced_wcs_is
ssue12739.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.
Running tests in astropy/wcs/tests/test_sliced_wcs_issue12739.py.

Date: 2025-12-21T11:52:27

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/wcs/tests/test_sliced_wcs_issue12739.py [31mF[0m[31m                        [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_sliced_world_to_pixel_coupled ______________________[0m

    def test_sliced_world_to_pixel_coupled():
        """
        Regression test for issue where world_to_pixel on a SlicedLowLevelWCS
        with coupled axes gives an incorrect result.
    
        This test calls the high-level world_to_pixel wrapper with two separate
        Quantity objects to satisfy the argument parser, which in this test
        environment expects two world objects instead of a single SkyCoord.
        This allows the test to reach the underlying buggy code.
    
        See: https://github.com/astropy/astropy/issues/12739
        """
        nx = 100
        ny = 25
        wcs_header = {
            'WCSAXES': 3,
            'CRPIX1': (nx + 1) / 2,
            'CRPIX2': (ny + 1) / 2,
            'CRPIX3': 1.0,
            'PC1_1': 0.0,
            'PC1_2': -1.0,
            'PC1_3': 0.0,
            'PC2_1': 1.0,
            'PC2_2': 0.0,
            'PC2_3': -1.0,
            'CDELT1': 5,
            'CDELT2': 5,
            'CDELT3': 0.055,
            'CUNIT1': 'arcsec',
            'CUNIT2': 'arcsec',
            'CUNIT3': 'Angstrom',
            'CTYPE1': 'HPLN-TAN',
            'CTYPE2': 'HPLT-TAN',
            'CTYPE3': 'WAVE',
            'CRVAL1': 0.0,
            'CRVAL2': 0.0,
            'CRVAL3': 1.05,
        }
        fits_wcs = astropy.wcs.WCS(header=wcs_header)
    
        # The slice is on the wavelength axis (last WCS axis), at pixel index 0.
        ll_sliced_wcs = SlicedLowLevelWCS(fits_wcs, 0)
        hl_sliced_wcs = HighLevelWCSWrapper(ll_sliced_wcs)
    
        # Input world coordinates for the sliced (2D) WCS.
        # We pass them as two separate Quantities to match what the high-level
        # API expects in this context.
        tx = 0 * u.arcsec
        ty = 0 * u.arcsec
    
        # This is the call that exhibits the bug.
        pixel_out = hl_sliced_wcs.world_to_pixel(tx, ty)
    
        # The expected output from the bug report, which is the correct pixel
        # coordinates for the given world coordinates.
        expected_pixel_coords = (49.5, 12.0)
    
        # The bug causes the first value to be ~1.8e11. This assertion will fail.
        # It will pass when the underlying SlicedLowLevelWCS uses the correct
        # reference world value for the dropped dimension.
>       assert_allclose(pixel_out, expected_pixel_coords)

[1m[31mastropy/wcs/tests/test_sliced_wcs_issue12739.py[0m:71: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

args = (<function assert_allclose.<locals>.compare at 0x74c107f2e700>, array([1.81818182e+11, 1.20000000e+01]), array([49.5, 12. ]))
kwds = {'equal_nan': True, 'err_msg': '', 'header': 'Not equal to tolerance rtol=1e-07, atol=0', 'verbose': True}

    @wraps(func)
    def inner(*args, **kwds):
        with self._recreate_cm():
>           return func(*args, **kwds)
[1m[31mE           AssertionError: [0m
[1m[31mE           Not equal to tolerance rtol=1e-07, atol=0[0m
[1m[31mE           [0m
[1m[31mE           Mismatched elements: 1 / 2 (50%)[0m
[1m[31mE           Max absolute difference: 1.81818182e+11[0m
[1m[31mE           Max relative difference: 3.67309458e+09[0m
[1m[31mE            x: array([1.818182e+11, 1.200000e+01])[0m
[1m[31mE            y: array([49.5, 12. ])[0m

[1m[31m/opt/miniconda3/envs/testbed/lib/python3.9/contextlib.py[0m:79: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/wcs/tests/test_sliced_wcs_issue12739.py::[1mtest_sliced_world_to_pixel_coupled[0m - AssertionError: 
[31m============================== [31m[1m1 failed[0m[31m in 0.11s[0m[31m ===============================[0m

2025-12-21 11:52:27,772 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-21 11:52:27,772 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-21 11:52:27,777 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-21 11:52:27,777 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 11:52:27,777 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/wcs/wcsapi/wrappers in the container
2025-12-21 11:52:27,777 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/wcs/wcsapi/wrappers
2025-12-21 11:52:27,878 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:52:27,879 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 11:52:27,879 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/wcs/wcsapi/wrappers/sliced_wcs.py in the container
2025-12-21 11:52:27,885 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 11:52:27,885 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-21 11:52:27,885 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/wcs/tests/test_sliced_wcs_issue12739.py
2025-12-21 11:52:29,635 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 11:52:29,635 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/wcs/tests/test_sliced_wcs_is
ssue12739.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev362+g0df94ff70.d20251221.
Running tests in astropy/wcs/tests/test_sliced_wcs_issue12739.py.

Date: 2025-12-21T11:52:29

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, hypothesis-6.82.6, arraydiff-0.5.0, openfiles-0.5.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/wcs/tests/test_sliced_wcs_issue12739.py [32m.[0m[32m                        [100%][0m

[32m============================== [32m[1m1 passed[0m[32m in 0.09s[0m[32m ===============================[0m

2025-12-21 11:52:29,635 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-21 11:52:29,662 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Validation PASSED: Test fails on old, passes on new
2025-12-21 11:52:29,663 - thread-130546535499456.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-12-21 11:52:29,663 - thread-130546535499456.app.docker.base_container - INFO - Closing persistent shell...
2025-12-21 11:52:29,763 - thread-130546535499456.app.docker.base_container - INFO - Cleaning up container and temporary files
