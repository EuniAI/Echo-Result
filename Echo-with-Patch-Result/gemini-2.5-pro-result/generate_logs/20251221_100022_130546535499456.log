2025-12-21 10:00:22,799 - thread-130546535499456.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmp4ntitx18/astropy
2025-12-21 10:00:22,799 - thread-130546535499456.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-12-21 10:00:22,799 - thread-130546535499456.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-13398:v1
2025-12-21 10:00:59,149 - thread-130546535499456.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_a101067e27
2025-12-21 10:00:59,158 - thread-130546535499456.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_a101067e27
2025-12-21 10:00:59,687 - thread-130546535499456.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-12-21 10:01:00,581 - thread-130546535499456.app.docker.base_container - INFO - Persistent shell is ready
2025-12-21 10:01:00,581 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-12-21 10:01:00,810 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:01:00,810 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 10:01:00,810 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-12-21 10:01:01,037 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:01:01,038 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 10:01:01,038 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-12-21 10:03:07,598 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:03:07,599 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
[A(testbed) root@ucl-research:/testbed# python -m pip install -e .[test] --verbos[Ke

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command pip subprocess to install build dependencies
  Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
  Collecting setuptools==68.0.0
    Obtaining dependency information for setuptools==68.0.0 from https://files.pythonhosted.org/packages/c7/42/be1c7bbdd83e1bfb160c94b9cafd8e25efc7400346cf7ccdbdb452c467fa/setuptools-68.0.0-py3-none-any.whl.metadata
    Using cached setuptools-68.0.0-py3-none-any.whl.metadata (6.4 kB)
  Collecting setuptools_scm>=6.2
    Obtaining dependency information for setuptools_scm>=6.2 from https://files.pythonhosted.org/packages/3d/ea/ac2bf868899d0d2e82ef72d350d97a846110c709bacf2d968431576ca915/setuptools_scm-9.2.2-py3-none-any.whl.metadata
    Downloading setuptools_scm-9.2.2-py3-none-any.whl.metadata (7.7 kB)
  Collecting wheel
    Obtaining dependency information for wheel from https://files.pythonhosted.org/packages/0b/2c/87f3254fd8ffd29e4c02732eee68a83a1d3c346ae39bc6822dcbcb697f2b/wheel-0.45.1-py3-none-any.whl.metadata
    Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
  Collecting cython==0.29.30
    Obtaining dependency information for cython==0.29.30 from https://files.pythonhosted.org/packages/a7/c6/3af0df983ba8500831fdae19a515be6e532da7683ab98e031d803e6a8d03/Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata
    Using cached Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl.metadata (2.8 kB)
  Collecting oldest-supported-numpy
    Obtaining dependency information for oldest-supported-numpy from https://files.pythonhosted.org/packages/dc/5c/e3c84cfdd488701aa074b22cf5bd227fb15d26e1d55a66d9088c39afa123/oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata
    Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata (9.8 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/88/ff/5a7cd8c9698628b3c04215ee3a96c69865477f451b4f096682e78d085bfc/extension_helpers-1.3.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/8e/b1/73ce2924fe46281faf31567e96fb9eee4eca02fd1cb852562bb2971e9df1/extension_helpers-1.3.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f8/fb/f9a88ccea5377736d5d1e53c8a6c70207178cdc1ebbf305a50a610cbb751/extension_helpers-1.4.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/24/51/d03359b683ed288b34d713dea97d2aee87a9bd866af1652554d9f643b47d/extension_helpers-1.4.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
  Collecting extension-helpers
    Obtaining dependency information for extension-helpers from https://files.pythonhosted.org/packages/b3/0e/22599eac9e50f4274e78e47cef7e760d7a1bb2f0d0fdfb0bb5b0d2da263a/extension_helpers-1.2.0-py3-none-any.whl.metadata
    Using cached extension_helpers-1.2.0-py3-none-any.whl.metadata (2.2 kB)
  Collecting packaging>=20 (from setuptools_scm>=6.2)
    Obtaining dependency information for packaging>=20 from https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl.metadata
    Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
  Collecting tomli>=1 (from setuptools_scm>=6.2)
    Obtaining dependency information for tomli>=1 from https://files.pythonhosted.org/packages/77/b8/0135fadc89e73be292b473cb820b4f5a08197779206b33191e801feeae40/tomli-2.3.0-py3-none-any.whl.metadata
    Downloading tomli-2.3.0-py3-none-any.whl.metadata (10 kB)
  Collecting typing-extensions (from setuptools_scm>=6.2)
    Obtaining dependency information for typing-extensions from https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
    Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/54/a4/f8188c4f3e07f7737683588210c073478abcb542048cf4ab6fedad0b458a/numpy-2.1.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/59/5f/9003bb3e632f2b58f5e3a3378902dcc73c5518070736c6740fe52454e8e1/numpy-2.1.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/4b/d1/8a730ea07f4a37d94f9172f4ce1d81064b7a64766b460378be278952de75/numpy-2.1.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/25/ca/1166b75c21abd1da445b97bf1fa2f14f423c6cfb4fc7c4ef31dccf9f6a94/numpy-2.1.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/47/1b/1d565e0f6e156e1522ab564176b8b29d71e13d8caf003a08768df3d5cec5/numpy-2.2.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f2/a5/fdbf6a7871703df6160b5cf3dd774074b086d278172285c52c2758b76305/numpy-2.2.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/ec/d0/c12ddfd3a02274be06ffc71f3efc6d0e457b0409c4481596881e748cb264/numpy-2.2.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/fb/90/8956572f5c4ae52201fdec7ba2044b2c882832dcec7d5d0922c9e9acf2de/numpy-2.2.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/e1/78/31103410a57bc2c2b93a3597340a8119588571f6a4539067546cb9a0bfac/numpy-2.2.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/dc/b2/ce4b867d8cd9c0ee84938ae1e6a6f7926ebf928c9090d036fc3c6a04f946/numpy-2.2.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/f3/db/8e12381333aea300890829a0a36bfa738cac95475d88982d538725143fd9/numpy-2.3.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/2e/19/d7c972dfe90a353dbd3efbbe1d14a5951de80c99c9dc1b93cd998d51dc0f/numpy-2.3.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/37/7d/3fec4199c5ffb892bed55cff901e4f39a58c81df9c44c280499e92cad264/numpy-2.3.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/b5/f4/098d2270d52b41f1bd7db9fc288aaa0400cb48c2a3e2af6fa365d9720947/numpy-2.3.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/76/65/21b3bc86aac7b8f2862db1e808f1ea22b028e30a225a34a5ede9bf8678f2/numpy-2.3.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/12/02/7111f298e24a44d6fa4b75b47d93eccf444e5afbcee5b04aac760ee48935/numpy-2.4.0rc1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/a4/7a/6a3d14e205d292b738db449d0de649b373a59edb0d0b4493821d0a3e8718/numpy-2.4.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
  Collecting numpy==1.19.3 (from oldest-supported-numpy)
    Obtaining dependency information for numpy==1.19.3 from https://files.pythonhosted.org/packages/c3/8d/2ae53d96a92a66b8daa3dfb2dd6cf4bfcb8e3d4148bdd713c8fc7de83141/numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata
    Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata (2.0 kB)
  Using cached setuptools-68.0.0-py3-none-any.whl (804 kB)
  Using cached Cython-0.29.30-cp39-cp39-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (2.0 MB)
  Downloading setuptools_scm-9.2.2-py3-none-any.whl (62 kB)
  Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
  Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl (4.9 kB)
  Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl (14.9 MB)
  Using cached extension_helpers-1.2.0-py3-none-any.whl (23 kB)
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
  Downloading tomli-2.3.0-py3-none-any.whl (14 kB)
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
  Installing collected packages: wheel, typing-extensions, tomli, setuptools, packaging, numpy, cython, setuptools_scm, oldest-supported-numpy, extension-helpers
    Creating /tmp/pip-build-env-awrv4e06/overlay/bin
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/wheel to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/f2py to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/f2py3 to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/f2py3.9 to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/cygdb to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/cython to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/cythonize to 755
    changing mode of /tmp/pip-build-env-awrv4e06/overlay/bin/setuptools-scm to 755
  Successfully installed cython-0.29.30 extension-helpers-1.2.0 numpy-1.19.3 oldest-supported-numpy-2023.12.21 packaging-25.0 setuptools-68.0.0 setuptools_scm-9.2.2 tomli-2.3.0 typing-extensions-4.15.0 wheel-0.45.1
  WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  Installing build dependencies ... [?25l[?25hdone
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable ... [?25l[?25hdone
  Running command Getting requirements to build editable
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running egg_info
  writing astropy.egg-info/PKG-INFO
  writing dependency_links to astropy.egg-info/dependency_links.txt
  writing entry points to astropy.egg-info/entry_points.txt
  writing requirements to astropy.egg-info/requires.txt
  writing top-level names to astropy.egg-info/top_level.txt
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file 'astropy.egg-info/SOURCES.txt'
  Getting requirements to build editable ... [?25l[?25hdone
  Running command Preparing editable metadata (pyproject.toml)
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running dist_info
  creating /tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info
  writing /tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-modern-metadata-y1jzswmf/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-y1jzswmf/astropy-5.2.dev287+g6500928dc.d20251221.dist-info'
  Preparing editable metadata (pyproject.toml) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.18 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (6.0.1)
Requirement already satisfied: packaging>=19.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (23.1)
Requirement already satisfied: pytest>=7.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (7.4.0)
Requirement already satisfied: hypothesis==6.46.7 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (6.46.7)
Requirement already satisfied: pytest-doctestplus>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (1.0.0)
Requirement already satisfied: pytest-astropy-header>=0.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (0.2.2)
Requirement already satisfied: pytest-astropy>=0.10 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (0.10.0)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.2.dev287+g6500928dc.d20251221) (3.3.1)
Requirement already satisfied: attrs>=19.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis==6.46.7->astropy==5.2.dev287+g6500928dc.d20251221) (23.1.0)
Requirement already satisfied: sortedcontainers<3.0.0,>=2.1.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis==6.46.7->astropy==5.2.dev287+g6500928dc.d20251221) (2.4.0)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev287+g6500928dc.d20251221) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev287+g6500928dc.d20251221) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev287+g6500928dc.d20251221) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.2.dev287+g6500928dc.d20251221) (2.0.1)
Requirement already satisfied: pytest-remotedata>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (0.4.0)
Requirement already satisfied: pytest-openfiles>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (0.5.0)
Requirement already satisfied: pytest-arraydiff>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (0.5.0)
Requirement already satisfied: pytest-filter-subpackage>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (0.1.2)
Requirement already satisfied: pytest-cov>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (4.1.0)
Requirement already satisfied: pytest-mock>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (3.11.1)
Requirement already satisfied: setuptools>=30.3.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-doctestplus>=0.12->astropy==5.2.dev287+g6500928dc.d20251221) (68.0.0)
Requirement already satisfied: execnet>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-xdist->astropy==5.2.dev287+g6500928dc.d20251221) (2.0.2)
Requirement already satisfied: coverage>=5.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from coverage[toml]>=5.2.1->pytest-cov>=2.3.1->pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (7.6.2)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-openfiles>=0.3.1->pytest-astropy>=0.10->astropy==5.2.dev287+g6500928dc.d20251221) (5.9.5)
Building wheels for collected packages: astropy
  Running command Building editable for astropy (pyproject.toml)
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running editable_wheel
  creating /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info
  writing /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy-5.2.dev287+g6500928dc.d20251221.dist-info'
  creating /tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy-5.2.dev287+g6500928dc.d20251221.dist-info/WHEEL
  running build_py
  running build_ext
  skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
  skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
  skipping 'astropy/timeseries/periodograms/bls/_impl.c' Cython extension (up-to-date)
  skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
  skipping './astropy/stats/_stats.c' Cython extension (up-to-date)
  skipping './astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
  skipping './astropy/cosmology/flrw/scalar_inv_efuncs.c' Cython extension (up-to-date)
  skipping './astropy/io/fits/_utils.c' Cython extension (up-to-date)
  building 'astropy.table._np_utils' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy
  creating /tmp/tmp5prjshcq.build-temp/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_np_utils.c -o /tmp/tmp5prjshcq.build-temp/astropy/table/_np_utils.o
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_np_utils.c:698:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmpoi5jix64.build-lib/astropy
  creating /tmp/tmpoi5jix64.build-lib/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/table/_np_utils.o -o /tmp/tmpoi5jix64.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._column_mixins' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_column_mixins.c -o /tmp/tmp5prjshcq.build-temp/astropy/table/_column_mixins.o
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:696:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:21,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:696:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/__multiarray_api.h:1463:1: warning: â€˜_import_arrayâ€™ defined but not used [-Wunused-function]
   1463 | _import_array(void)
        | ^~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/table/_column_mixins.o -o /tmp/tmpoi5jix64.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils._compiler' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/utils
  creating /tmp/tmp5prjshcq.build-temp/astropy/utils/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/src/compiler.c -o /tmp/tmp5prjshcq.build-temp/astropy/utils/src/compiler.o
  creating /tmp/tmpoi5jix64.build-lib/astropy/utils
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/utils/src/compiler.o -o /tmp/tmpoi5jix64.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._fast_sigma_clip' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/stats
  creating /tmp/tmp5prjshcq.build-temp/astropy/stats/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/compute_bounds.c -o /tmp/tmp5prjshcq.build-temp/astropy/stats/src/compute_bounds.o
  astropy/stats/src/compute_bounds.c: In function â€˜compute_sigma_clipped_boundsâ€™:
  astropy/stats/src/compute_bounds.c:53:24: warning: â€˜cenâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     53 |     *upper_bound = cen + sigma_upper * std;
        |                    ~~~~^~~~~~~~~~~~~~~~~~~
  astropy/stats/src/compute_bounds.c:38:45: warning: â€˜medianâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     38 |         mad_buffer[i] = fabs(data_buffer[i] - median);
        |                              ~~~~~~~~~~~~~~~^~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/fast_sigma_clip.c -o /tmp/tmp5prjshcq.build-temp/astropy/stats/src/fast_sigma_clip.o
  astropy/stats/src/fast_sigma_clip.c: In function â€˜PyInit__fast_sigma_clipâ€™:
  astropy/stats/src/fast_sigma_clip.c:44:48: warning: initialization of â€˜void (*)(char **, const npy_intp *, const npy_intp *, void *)â€™ {aka â€˜void (*)(char **, const long int *, const long int *, void *)â€™} from incompatible pointer type â€˜void (*)(char **, npy_intp *, npy_intp *, void *)â€™ {aka â€˜void (*)(char **, long int *, long int *, void *)â€™} [-Wincompatible-pointer-types]
     44 |     static PyUFuncGenericFunction funcs[1] = { &_sigma_clip_fast };
        |                                                ^
  astropy/stats/src/fast_sigma_clip.c:44:48: note: (near initialization for â€˜funcs[0]â€™)
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/pytime.h:6,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:81,
                   from astropy/stats/src/fast_sigma_clip.c:3:
  /opt/miniconda3/envs/testbed/include/python3.9/object.h:496:8: warning: â€˜dâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    496 |     if (op != NULL) {
        |        ^
  astropy/stats/src/fast_sigma_clip.c:30:19: note: â€˜dâ€™ was declared here
     30 |     PyObject *m, *d;
        |                   ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/wirth_select.c -o /tmp/tmp5prjshcq.build-temp/astropy/stats/src/wirth_select.o
  creating /tmp/tmpoi5jix64.build-lib/astropy/stats
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/stats/src/compute_bounds.o /tmp/tmp5prjshcq.build-temp/astropy/stats/src/fast_sigma_clip.o /tmp/tmp5prjshcq.build-temp/astropy/stats/src/wirth_select.o -o /tmp/tmpoi5jix64.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so
  building 'astropy.convolution._convolve' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/convolution
  creating /tmp/tmp5prjshcq.build-temp/astropy/convolution/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/src/convolve.c -o /tmp/tmp5prjshcq.build-temp/astropy/convolution/src/convolve.o -UNDEBUG -fPIC
  creating /tmp/tmpoi5jix64.build-lib/astropy/convolution
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/convolution/src/convolve.o -o /tmp/tmpoi5jix64.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so
  building 'astropy.time._parse_times' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/time
  creating /tmp/tmp5prjshcq.build-temp/astropy/time/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/time/src/parse_times.c -o /tmp/tmp5prjshcq.build-temp/astropy/time/src/parse_times.o
  creating /tmp/tmpoi5jix64.build-lib/astropy/time
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/time/src/parse_times.o -o /tmp/tmpoi5jix64.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so
  building 'astropy.wcs._wcs' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/wcs
  creating /tmp/tmp5prjshcq.build-temp/astropy/wcs/src
  creating /tmp/tmp5prjshcq.build-temp/cextern
  creating /tmp/tmp5prjshcq.build-temp/cextern/wcslib
  creating /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C
  creating /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/astropy_wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs_api.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/astropy_wcs_api.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/distortion.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/distortion_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/docstrings.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/docstrings.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pipeline.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/pipeline.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pyutil.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/pyutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/src/pyutil.c:9:
  In function â€˜strncpyâ€™,
      inlined from â€˜set_pscardsâ€™ at astropy/wcs/src/pyutil.c:807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 72 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/sip.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/sip_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/str_list_proxy.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/str_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/unit_list_proxy.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/unit_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/util.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/util.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_auxprm_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_celprm_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:167:22: warning: initialization of â€˜PyCelprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    167 |     PyCelprm* copy = PyCelprm_new(&PyCelprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_set_refâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_celprm_wrap.c:348:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    348 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_prjprm_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:149:22: warning: initialization of â€˜PyPrjprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    149 |     PyPrjprm* copy = PyPrjprm_new(&PyPrjprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:517:14: warning: assignment to â€˜PyObject *â€™ {aka â€˜struct _object *â€™} from incompatible pointer type â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} [-Wincompatible-pointer-types]
    517 |     pv_array = (PyArrayObject*) PyArray_SimpleNew(1, &size, NPY_DOUBLE);
        |              ^
  astropy/wcs/src/wcslib_prjprm_wrap.c:519:33: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    519 |     pv = (double*) PyArray_DATA(pv_array);
        |                                 ^~~~~~~~
        |                                 |
        |                                 PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c:583:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    583 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:615:15: warning: unused variable â€˜valueâ€™ [-Wunused-variable]
    615 |     PyObject* value = NULL;
        |               ^~~~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:48: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                ^~~~~~~~~~~
        |                                                |
        |                                                PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:24: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                        ^~~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:62: warning: passing argument 1 of â€˜PyArray_DESCRâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                              ^~~~~~~~~~~
        |                                                              |
        |                                                              PyObject * {aka struct _object *}
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:44: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                                            ^~~
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1517:30: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1517 | PyArray_DESCR(PyArrayObject *arr)
        |               ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_wâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:780:32: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    780 |     w = (double*) PyArray_DATA(w_array);
        |                                ^~~~~~~
        |                                |
        |                                PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_tabprm_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wrap.c: In function â€˜PyWcsprm_copyâ€™:
  astropy/wcs/src/wcslib_wrap.c:634:24: warning: unused variable â€˜wtb0â€™ [-Wunused-variable]
    634 |   struct wtbarr *wtb, *wtb0;
        |                        ^~~~
  astropy/wcs/src/wcslib_wrap.c:634:18: warning: unused variable â€˜wtbâ€™ [-Wunused-variable]
    634 |   struct wtbarr *wtb, *wtb0;
        |                  ^~~
  astropy/wcs/src/wcslib_wrap.c:633:38: warning: unused variable â€˜ndimâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                      ^~~~
  astropy/wcs/src/wcslib_wrap.c:633:35: warning: unused variable â€˜jâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                   ^
  astropy/wcs/src/wcslib_wrap.c:633:32: warning: unused variable â€˜iâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                                ^
  astropy/wcs/src/wcslib_wrap.c:633:25: warning: unused variable â€˜nelemâ€™ [-Wunused-variable]
    633 |   int           status, nelem, i, j, ndim;
        |                         ^~~~~
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜PyWcsprm_sptrâ€™ at astropy/wcs/src/wcslib_wrap.c:1757:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 9 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wtbarr_wrap.c -o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: warning: initialization of â€˜int (*)(PyObject *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(struct _object *, int (*)(struct _object *, void *), void *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(PyWtbarr *, int (*)(struct _object *, void *), void *)â€™} [-Wincompatible-pointer-types]
    208 |   PyWtbarr_traverse,            /* tp_traverse */
        |   ^~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: note: (near initialization for â€˜PyWtbarrType.tp_traverseâ€™)
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: warning: initialization of â€˜int (*)(PyObject *)â€™ {aka â€˜int (*)(struct _object *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *)â€™ [-Wincompatible-pointer-types]
    209 |   PyWtbarr_clear,               /* tp_clear */
        |   ^~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: note: (near initialization for â€˜PyWtbarrType.tp_clearâ€™)
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/cel.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/cel.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/dis.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/dis.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsbth.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcsbth.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcspih.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcspih.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsulex.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcsulex.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsutrn.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcsutrn.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/lin.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/lin.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/log.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/log.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/prj.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/prj.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spc.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/spc.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/sph.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/sph.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spx.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/spx.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/tab.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/tab.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcs.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcserr.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcserr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsfix.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsfix.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcshdr.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcshdr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsprintf.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsprintf.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsunits.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsunits.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsutil.c -o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  creating /tmp/tmpoi5jix64.build-lib/astropy/wcs
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/astropy_wcs.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/astropy_wcs_api.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/distortion.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/distortion_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/docstrings.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/pipeline.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/pyutil.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/sip.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/sip_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/str_list_proxy.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/unit_list_proxy.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/util.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_wrap.o /tmp/tmp5prjshcq.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/cel.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/dis.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcsbth.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcspih.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcsulex.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/flexed/wcsutrn.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/lin.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/log.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/prj.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/spc.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/sph.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/spx.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/tab.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcs.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcserr.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsfix.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcshdr.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsprintf.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsunits.o /tmp/tmp5prjshcq.build-temp/cextern/wcslib/C/wcsutil.o -o /tmp/tmpoi5jix64.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils.xml._iterparser' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/utils/xml
  creating /tmp/tmp5prjshcq.build-temp/astropy/utils/xml/src
  creating /tmp/tmp5prjshcq.build-temp/cextern/expat
  creating /tmp/tmp5prjshcq.build-temp/cextern/expat/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/xml/src/iterparse.c -o /tmp/tmp5prjshcq.build-temp/astropy/utils/xml/src/iterparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlparse.c -o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmlparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlrole.c -o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmlrole.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok.c -o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmltok.o
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingNSâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1657:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1646:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok_impl.c -o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmltok_impl.o
  creating /tmp/tmpoi5jix64.build-lib/astropy/utils/xml
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/utils/xml/src/iterparse.o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmlparse.o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmlrole.o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmltok.o /tmp/tmp5prjshcq.build-temp/cextern/expat/lib/xmltok_impl.o -o /tmp/tmpoi5jix64.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -Wl,--version-script=astropy/utils/xml/src/iterparse.map
  building 'astropy.timeseries.periodograms.bls._impl' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/timeseries
  creating /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms
  creating /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/_impl.c -o /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/bls/_impl.o
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/timeseries/periodograms/bls/_impl.c:698:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/bls.c -o /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/bls/bls.o
  astropy/timeseries/periodograms/bls/bls.c: In function â€˜run_blsâ€™:
  astropy/timeseries/periodograms/bls/bls.c:92: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
     92 | #pragma omp parallel
        |
  astropy/timeseries/periodograms/bls/bls.c:116: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    116 |     #pragma omp parallel for reduction(+:sum_y), reduction(+:sum_ivar)
        |
  astropy/timeseries/periodograms/bls/bls.c:125: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    125 |     #pragma omp parallel for
        |
  creating /tmp/tmpoi5jix64.build-lib/astropy/timeseries
  creating /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms
  creating /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/bls/_impl.o /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/bls/bls.o -o /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.votable.tablewriter' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/io
  creating /tmp/tmp5prjshcq.build-temp/astropy/io/votable
  creating /tmp/tmp5prjshcq.build-temp/astropy/io/votable/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/votable/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/votable/src/tablewriter.c -o /tmp/tmp5prjshcq.build-temp/astropy/io/votable/src/tablewriter.o
  astropy/io/votable/src/tablewriter.c: In function â€˜write_tabledataâ€™:
  astropy/io/votable/src/tablewriter.c:270:30: warning: assignment discards â€˜constâ€™ qualifier from pointer target type [-Wdiscarded-qualifiers]
    270 |                 if ((str_tmp = PyUnicode_AsUTF8AndSize(str_val, &str_len)) == NULL) {
        |                              ^
  creating /tmp/tmpoi5jix64.build-lib/astropy/io
  creating /tmp/tmpoi5jix64.build-lib/astropy/io/votable
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/io/votable/src/tablewriter.o -o /tmp/tmpoi5jix64.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits.compression' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/io/fits
  creating /tmp/tmp5prjshcq.build-temp/astropy/io/fits/src
  creating /tmp/tmp5prjshcq.build-temp/cextern/cfitsio
  creating /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib
  creating /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/src/compressionmodule.c -o /tmp/tmp5prjshcq.build-temp/astropy/io/fits/src/compressionmodule.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  astropy/io/fits/src/compressionmodule.c: In function â€˜compression_compress_hduâ€™:
  astropy/io/fits/src/compressionmodule.c:1042:16: warning: comparison of integer expressions of different signedness: â€˜npy_intpâ€™ {aka â€˜long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1042 |     if (znaxis < outbufsize) {
        |                ^
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:446:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:446:26: note: directive argument in the range [1, 2147483647]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:450:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 69 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:453:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:453:26: note: directive argument in the range [1, 2147483647]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:457:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 9 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:469:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:469:26: note: directive argument in the range [1, 2147483647]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:474:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:474:26: note: directive argument in the range [1, 2147483647]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:479:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:479:26: note: directive argument in the range [1, 2147483647]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜configure_compressionâ€™ at astropy/io/fits/src/compressionmodule.c:600:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 11 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜configure_compressionâ€™:
  astropy/io/fits/src/compressionmodule.c:643:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:643:30: note: directive argument in the range [1, 2147483647]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:654:35: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 5 [-Wformat-truncation=]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                                   ^~
  astropy/io/fits/src/compressionmodule.c:654:30: note: directive argument in the range [1, 2147483647]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                              ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 6 and 15 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜init_output_bufferâ€™:
  astropy/io/fits/src/compressionmodule.c:776:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:776:30: note: directive argument in the range [1, 2147483647]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/buffers.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/buffers.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/cfileio.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/cfileio.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/cfileio.c:7:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffoptpltâ€™ at cextern/cfitsio/lib/cfileio.c:7788:7:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 30 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1711:13,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1693:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 5 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffomemâ€™:
  cextern/cfitsio/lib/cfileio.c:339:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    339 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffopenâ€™:
  cextern/cfitsio/lib/cfileio.c:971:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    971 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/checksum.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/checksum.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrfile.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrfile.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrmem.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/drvrmem.c: In function â€˜mem_truncateâ€™:
  cextern/cfitsio/lib/drvrmem.c:273:23: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    273 |         if ( filesize > *(memTable[handle].memsizeptr) )
        |                       ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrnet.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrnet.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrsmem.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrsmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/editcol.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/editcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/editcol.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2849:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 8 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2809:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 4 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2844:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 4 and 5 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2851:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/editcol.c: In function â€˜ffkshfâ€™:
  cextern/cfitsio/lib/editcol.c:2850:24: note: length computed here
   2850 |                   i1 = strlen(newkey);
        |                        ^~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/edithdu.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/edithdu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_f.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/eval_f.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_l.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/eval_l.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_y.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/eval_y.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hcompress.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/fits_hcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hdecompress.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/fits_hdecompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fitscore.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/fitscore.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkkyâ€™:
  cextern/cfitsio/lib/fitscore.c:1118:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1118 |             if (strlen(cptr) > maxlen) maxlen = strlen(cptr); /* find longest token */
        |                              ^
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkeyâ€™:
  cextern/cfitsio/lib/fitscore.c:1295:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1295 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/fitscore.c:37:
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1115:8:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1159:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffbinit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:5098:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   5098 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffbinit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffainit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:4901:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                                    ^~
   4902 |             name, (long) tbcoln);
        |             ~~~~
  cextern/cfitsio/lib/fitscore.c:4901:42: note: using the range [-9223372036854775808, 9223372036854775807] for directive argument
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 45 and 138 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4892:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4892 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4884:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4884 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜fftheapâ€™:
  cextern/cfitsio/lib/fitscore.c:6083:75: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   6083 |                 "Descriptor in row %ld, column %d has invalid heap address",
        |                                                                           ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 55 and 82 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffcmphâ€™:
  cextern/cfitsio/lib/fitscore.c:6221:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   6221 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffgcprllâ€™:
  cextern/cfitsio/lib/fitscore.c:5959:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   5959 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:5761:76: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   5761 |         "First element to write is too large: %ld; max allowed value is %ld",
        |                                                                            ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 63 and 101 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcol.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolb.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcold.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcole.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoli.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolj.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolk.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoll.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcols.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getcols.c:9:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:442:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:423:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:384:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:365:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:587:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolsb.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolui.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluj.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getcoluj.c: In function â€˜fffi8u4â€™:
  cextern/cfitsio/lib/getcoluj.c:1331:36: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1331 |                 else if (input[ii] > ULONG_MAX)
        |                                    ^
  cextern/cfitsio/lib/getcoluj.c:1414:40: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1414 |                     else if (input[ii] > ULONG_MAX)
        |                                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluk.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getkey.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgskyâ€™:
  cextern/cfitsio/lib/getkey.c:1080:23: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1080 |         if (firstchar <= len)
        |                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffgcntâ€™ at cextern/cfitsio/lib/getkey.c:1134:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 10 bytes from a string of length 11 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgphd.part.0â€™:
  cextern/cfitsio/lib/getkey.c:2855:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2855 |             "First keyword of the extension is not XTENSION: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2847:53: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 49 [-Wformat-truncation=]
   2847 |                    "This is not an IMAGE extension: %s", value);
        |                                                     ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 33 and 103 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2821:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 40 [-Wformat-truncation=]
   2821 |                    "First keyword of the file is not SIMPLE: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 42 and 116 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2930:48: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2930 |             "Illegal value for BITPIX keyword: %s", value);
        |                                                ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2921:57: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 38 [-Wformat-truncation=]
   2921 |             "Value of BITPIX keyword is not an integer: %s", value);
        |                                                         ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 44 and 114 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2913:61: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 34 [-Wformat-truncation=]
   2913 |             "Second keyword of the extension is not BITPIX: %s", name);
        |                                                             ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3021:70: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size between 19 and 28 [-Wformat-truncation=]
   3021 |               "Name of keyword no. %d contains illegal character(s): %s",
        |                                                                      ^~
   3022 |               nextkey, name);
        |                        ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 54 and 137 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3118:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3118 |                 "Error reading EXTEND keyword value as a logical: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3101:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3101 |                 "Error reading GCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3088:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3088 |                 "Error reading PCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3075:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3075 |                 "Error reading BLANK keyword value as an integer: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3058:65: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 34 [-Wformat-truncation=]
   3058 |                 "Error reading BZERO keyword value as a double: %s", value);
        |                                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 118 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3041:66: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 33 [-Wformat-truncation=]
   3041 |                 "Error reading BSCALE keyword value as a double: %s", value);
        |                                                                  ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 119 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbâ€™:
  cextern/cfitsio/lib/getkey.c:2282:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2282 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2273:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2273 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbllâ€™:
  cextern/cfitsio/lib/getkey.c:2425:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2425 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2416:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2416 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnâ€™:
  cextern/cfitsio/lib/getkey.c:2570:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2570 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2561:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2561 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnllâ€™:
  cextern/cfitsio/lib/getkey.c:2693:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2693 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2684:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2684 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/group.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/group.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/group.c: In function â€˜ffgmopâ€™:
  cextern/cfitsio/lib/group.c:2290:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 39 [-Wformat-truncation=]
   2290 |                   "Cannot open member HDU file with URI type %s (ffgmop)",
        |                                                              ^~
   2291 |                           uri);
        |                           ~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/group.c:17:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 52 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/grparser.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/grparser.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/histo.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/histo.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/imcompress.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/imcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/imcompress.c: In function â€˜imcomp_decompress_tileâ€™:
  cextern/cfitsio/lib/imcompress.c:6072:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6072 |             if (tilebytesize == 4 * tilelen) {  /* float pixels */
        |                              ^~
  cextern/cfitsio/lib/imcompress.c:6103:37: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6103 |             } else if (tilebytesize == 8 * tilelen) { /* double pixels */
        |                                     ^~
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_compress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:8517:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} [-Wsign-compare]
   8517 |                     if (dlen < vlamemlen) {
        |                              ^
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_uncompress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:9258:39: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   9258 |                         if (cvlalen   == vlamemlen ) {
        |                                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/imcompress.c:3:
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8170:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8174:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8178:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8803:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8811:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜imcomp_get_compressed_image_parâ€™ at cextern/cfitsio/lib/imcompress.c:5271:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 11 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8671:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8544:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/iraffits.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/iraffits.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:576:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcomâ€™ at cextern/cfitsio/lib/iraffits.c:2088:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 2 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1930:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1992:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1908:16: note: length computed here
   1908 |     lkeyword = strlen (keyword);
        |                ^~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2009:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2001:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2020:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying between 0 and 49 bytes from a string of length 49 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputsâ€™ at cextern/cfitsio/lib/iraffits.c:1875:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ specified bound depends on the length of the source argument [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputsâ€™:
  cextern/cfitsio/lib/iraffits.c:1869:13: note: length computed here
   1869 |     lcval = strlen (cval);
        |             ^~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:624:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:864:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:853:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:823:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:811:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:880:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/modkey.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/modkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/modkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffiklsâ€™ at cextern/cfitsio/lib/modkey.c:1282:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffmklsâ€™ at cextern/cfitsio/lib/modkey.c:783:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:567:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:562:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/pliocomp.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/pliocomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcol.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolb.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcold.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcole.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoli.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolj.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolk.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoll.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcols.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolsb.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolu.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolui.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluj.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluk.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putkey.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/putkey.c: In function â€˜ffprecâ€™:
  cextern/cfitsio/lib/putkey.c:326:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    326 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/putkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffpklsâ€™ at cextern/cfitsio/lib/putkey.c:483:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/quantize.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/quantize.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/region.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/region.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/region.c:988:1: warning: "/*" within comment [-Wcomment]
    988 | /*---------------------------------------------------------------------------*/
        |
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/ricecomp.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/ricecomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/scalnull.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/scalnull.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/simplerng.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/simplerng.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/swapproc.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/swapproc.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/swapproc.c: In function â€˜ffswap2â€™:
  cextern/cfitsio/lib/swapproc.c:87:24: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
     87 |     for (ii = peel; ii < (nvals - peel - (nvals - peel) % 8); ii+=8) {
        |                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcssub.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/wcssub.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/wcssub.c:3:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:847:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:852:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:858:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:898:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:907:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:916:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:925:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:934:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:945:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:1040:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 77 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcsutil.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/wcsutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zcompress.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/zcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zcompress.c: In function â€˜uncompress2fileâ€™:
  cextern/cfitsio/lib/zcompress.c:347:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    347 |             != (d_stream.total_out - bytes_out)) {
        |             ^~
  cextern/cfitsio/lib/zcompress.c: In function â€˜compress2file_from_memâ€™:
  cextern/cfitsio/lib/zcompress.c:515:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    515 |             != (c_stream.total_out - bytes_out)) {
        |             ^~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zuncompress.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/zuncompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zuncompress.c: In function â€˜write_bufâ€™:
  cextern/cfitsio/lib/zuncompress.c:581:27: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    581 |       if (bytes_out + cnt > *memsize)
        |                           ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/adler32.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/adler32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/crc32.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/crc32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/deflate.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/deflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/infback.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/infback.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inffast.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/inffast.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inflate.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/inflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inftrees.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/inftrees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/trees.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/trees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/uncompr.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/uncompr.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/zutil.c -o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/zutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  creating /tmp/tmpoi5jix64.build-lib/astropy/io/fits
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/io/fits/src/compressionmodule.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/buffers.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/cfileio.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/checksum.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrfile.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrmem.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrnet.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/drvrsmem.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/editcol.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/edithdu.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/eval_f.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/eval_l.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/eval_y.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/fits_hcompress.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/fits_hdecompress.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/fitscore.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcol.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolb.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcold.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcole.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoli.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolj.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolk.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoll.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcols.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolsb.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcolui.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoluj.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getcoluk.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/getkey.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/group.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/grparser.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/histo.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/imcompress.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/iraffits.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/modkey.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/pliocomp.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcol.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolb.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcold.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcole.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoli.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolj.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolk.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoll.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcols.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolsb.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolu.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcolui.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoluj.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putcoluk.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/putkey.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/quantize.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/region.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/ricecomp.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/scalnull.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/simplerng.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/swapproc.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/wcssub.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/wcsutil.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/zcompress.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/lib/zuncompress.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/adler32.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/crc32.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/deflate.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/infback.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/inffast.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/inflate.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/inftrees.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/trees.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/uncompr.o /tmp/tmp5prjshcq.build-temp/cextern/cfitsio/zlib/zutil.o -o /tmp/tmpoi5jix64.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.ascii.cparser' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/io/ascii
  creating /tmp/tmp5prjshcq.build-temp/astropy/io/ascii/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/cparser.c -o /tmp/tmp5prjshcq.build-temp/astropy/io/ascii/cparser.o
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/io/ascii/cparser.c:698:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/src/tokenizer.c -o /tmp/tmp5prjshcq.build-temp/astropy/io/ascii/src/tokenizer.o
  astropy/io/ascii/src/tokenizer.c: In function â€˜pushâ€™:
  astropy/io/ascii/src/tokenizer.c:124:54: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    124 |     if (self->col_ptrs[col] - self->output_cols[col] >=
        |                                                      ^~
  astropy/io/ascii/src/tokenizer.c: In function â€˜tokenizeâ€™:
  astropy/io/ascii/src/tokenizer.c:424:42: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    424 |                     if (self->source_pos == -1
        |                                          ^~
  astropy/io/ascii/src/tokenizer.c:360:9: warning: enumeration value â€˜QUOTED_FIELD_NEWLINEâ€™ not handled in switch [-Wswitch]
    360 |         switch (self->state)
        |         ^~~~~~
  creating /tmp/tmpoi5jix64.build-lib/astropy/io/ascii
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/io/ascii/cparser.o /tmp/tmp5prjshcq.build-temp/astropy/io/ascii/src/tokenizer.o -o /tmp/tmpoi5jix64.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._stats' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/stats/_stats.c -o /tmp/tmp5prjshcq.build-temp/./astropy/stats/_stats.o
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/stats/_stats.c:699:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/./astropy/stats/_stats.o -o /tmp/tmpoi5jix64.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.lombscargle.implementations.cython_impl' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmp5prjshcq.build-temp/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c -o /tmp/tmp5prjshcq.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o
  In file included from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c:698:
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o -o /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.cosmology.flrw.scalar_inv_efuncs' extension
  creating /tmp/tmp5prjshcq.build-temp/astropy/cosmology
  creating /tmp/tmp5prjshcq.build-temp/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/cosmology/flrw/scalar_inv_efuncs.c -o /tmp/tmp5prjshcq.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c: In function â€˜__pyx_f_7astropy_9cosmology_4flrw_17scalar_inv_efuncs_nufuncâ€™:
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c:6370:33: warning: comparison of integer expressions of different signedness: â€˜unsigned intâ€™ and â€˜intâ€™ [-Wsign-compare]
   6370 |   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
        |                                 ^
  creating /tmp/tmpoi5jix64.build-lib/astropy/cosmology
  creating /tmp/tmpoi5jix64.build-lib/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o -o /tmp/tmpoi5jix64.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._utils' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/io/fits/_utils.c -o /tmp/tmp5prjshcq.build-temp/./astropy/io/fits/_utils.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/./astropy/io/fits/_utils.o -o /tmp/tmpoi5jix64.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.compiler_version' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/_compiler.c -o /tmp/tmp5prjshcq.build-temp/astropy/_compiler.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmp5prjshcq.build-temp/astropy/_compiler.o -o /tmp/tmpoi5jix64.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so
  copying /tmp/tmpoi5jix64.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmpoi5jix64.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmpoi5jix64.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so -> astropy/utils
  copying /tmp/tmpoi5jix64.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmpoi5jix64.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so -> astropy/convolution
  copying /tmp/tmpoi5jix64.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so -> astropy/time
  copying /tmp/tmpoi5jix64.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so -> astropy/wcs
  copying /tmp/tmpoi5jix64.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -> astropy/utils/xml
  copying /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/bls
  copying /tmp/tmpoi5jix64.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so -> astropy/io/votable
  copying /tmp/tmpoi5jix64.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmpoi5jix64.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so -> astropy/io/ascii
  copying /tmp/tmpoi5jix64.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmpoi5jix64.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/lombscargle/implementations
  copying /tmp/tmpoi5jix64.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so -> astropy/cosmology/flrw
  copying /tmp/tmpoi5jix64.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmpoi5jix64.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so -> astropy
  Editable install will be performed using a meta path finder.

  Options like `package-data`, `include/exclude-package-data` or
  `packages.find.exclude/include` may have no effect.

  adding '__editable___astropy_5_2_dev287_g6500928dc_d20251221_finder.py'
  adding '__editable__.astropy-5.2.dev287+g6500928dc.d20251221.pth'
  creating '/tmp/pip-wheel-12qt0c60/.tmp-1lrysvc4/astropy-5.2.dev287+g6500928dc.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' and adding '/tmp/tmp5gv6bcgmastropy-5.2.dev287+g6500928dc.d20251221-0.editable-cp39-cp39-linux_x86_64.whl' to it
  adding 'astropy-5.2.dev287+g6500928dc.d20251221.dist-info/LICENSE.rst'
  adding 'astropy-5.2.dev287+g6500928dc.d20251221.dist-info/METADATA'
  adding 'astropy-5.2.dev287+g6500928dc.d20251221.dist-info/WHEEL'
  adding 'astropy-5.2.dev287+g6500928dc.d20251221.dist-info/entry_points.txt'
  adding 'astropy-5.2.dev287+g6500928dc.d20251221.dist-info/top_level.txt'
  adding 'astropy-5.2.dev287+g6500928dc.d20251221.dist-info/RECORD'
  /tmp/pip-build-env-awrv4e06/overlay/lib/python3.9/site-packages/setuptools/command/editable_wheel.py:348: InformationOnly: Editable installation.
  !!

          ********************************************************************************
          Please be careful with folders in your working directory with the same
          name as your package as they may take precedence during imports.
          ********************************************************************************

  !!
    wheel_obj.write_files(unpacked)
  Building editable for astropy (pyproject.toml) ... [?25l[?25hdone
  Created wheel for astropy: filename=astropy-5.2.dev287+g6500928dc.d20251221-0.editable-cp39-cp39-linux_x86_64.whl size=6784 sha256=ec027f3e82e75647bebf5fca4e2458807477ab6c2f30ddadb0915e08dc6111aa
  Stored in directory: /tmp/pip-ephem-wheel-cache-0cr9y3lc/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built astropy
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 5.2.dev287+g6500928dc0.d20241024
    Uninstalling astropy-5.2.dev287+g6500928dc0.d20241024:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Successfully uninstalled astropy-5.2.dev287+g6500928dc0.d20241024
  changing mode of /opt/miniconda3/envs/testbed/bin/fits2bitmap to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitscheck to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsdiff to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsheader to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsinfo to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/samp_hub to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/showtable to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/volint to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/wcslint to 755
Successfully installed astropy-5.2.dev287+g6500928dc.d20251221
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-12-21 10:03:07,627 - thread-130546535499456.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Retrieving focal code context via external CRA
2025-12-21 10:05:56,764 - thread-130546535499456.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Focal code context retrieved: 11 items
2025-12-21 10:05:56,765 - thread-130546535499456.app.lang_graph.nodes.test_case_retrieval_node - INFO - Retrieving test case context via external CRA
2025-12-21 10:11:06,275 - thread-130546535499456.app.lang_graph.nodes.test_case_retrieval_node - INFO - Test case context retrieved: 3 items
2025-12-21 10:11:06,280 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nA direct approach to ITRS to Observed transformations that stays within the ITRS.\n\nIssue description: \n<!-- This comments are hidden when you submit the issue,\nso you do not need to remove them! -->\n\n<!-- Please be sure to check out our contributing guidelines,\nhttps://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .\nPlease be sure to check out our code of conduct,\nhttps://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->\n\n<!-- Please have a search on our GitHub repository to see if a similar\nissue has already been posted.\nIf a similar issue is closed, have a quick look to see if you are satisfied\nby the resolution.\nIf not please go ahead and open an issue! -->\n\n### Description\n<!-- Provide a general description of the feature you would like. -->\n<!-- If you want to, you can suggest a draft design or API. -->\n<!-- This way we have a deeper discussion on the feature. -->\nWe have experienced recurring issues raised by folks that want to observe satellites and such (airplanes?, mountains?, neighboring buildings?) regarding the apparent inaccuracy of the ITRS to AltAz transform. I tire of explaining the problem of geocentric versus topocentric aberration and proposing the entirely nonintuitive solution laid out in `test_intermediate_transformations.test_straight_overhead()`. So, for the latest such issue (#13319), I came up with a more direct approach. This approach stays entirely within the ITRS and merely converts between ITRS, AltAz, and HADec coordinates. \n\nI have put together the makings of a pull request that follows this approach for transforms between these frames (i.e. ITRS<->AltAz, ITRS<->HADec). One feature of this approach is that it treats the ITRS position as time invariant. It makes no sense to be doing an ITRS->ITRS transform for differing `obstimes` between the input and output frame, so the `obstime` of the output frame is simply adopted. Even if it ends up being `None` in the case of an `AltAz` or `HADec` output frame where that is the default. This is because the current ITRS->ITRS transform refers the ITRS coordinates to the SSB rather than the rotating ITRF. Since ITRS positions tend to be nearby, any transform from one time to another leaves the poor ITRS position lost in the wake of the Earth\'s orbit around the SSB, perhaps millions of kilometers from where it is intended to be.\n\nWould folks be receptive to this approach? If so, I will submit my pull request.\n\n### Additional context\n<!-- Add any other context or screenshots about the feature request here. -->\n<!-- This part is optional. -->\nHere is the basic concept, which is tested and working. I have yet to add refraction, but I can do so if it is deemed important to do so:\n```python\nimport numpy as np\nfrom astropy import units as u\nfrom astropy.coordinates.matrix_utilities import rotation_matrix, matrix_transpose\nfrom astropy.coordinates.baseframe import frame_transform_graph\nfrom astropy.coordinates.transformations import FunctionTransformWithFiniteDifference\nfrom .altaz import AltAz\nfrom .hadec import HADec\nfrom .itrs import ITRS\nfrom .utils import PIOVER2\n\ndef itrs_to_observed_mat(observed_frame):\n\n    lon, lat, height = observed_frame.location.to_geodetic(\'WGS84\')\n    elong = lon.to_value(u.radian)\n\n    if isinstance(observed_frame, AltAz):\n        # form ITRS to AltAz matrix\n        elat = lat.to_value(u.radian)\n        # AltAz frame is left handed\n        minus_x = np.eye(3)\n        minus_x[0][0] = -1.0\n        mat = (minus_x\n               @ rotation_matrix(PIOVER2 - elat, \'y\', unit=u.radian)\n               @ rotation_matrix(elong, \'z\', unit=u.radian))\n\n    else:\n        # form ITRS to HADec matrix\n        # HADec frame is left handed\n        minus_y = np.eye(3)\n        minus_y[1][1] = -1.0\n        mat = (minus_y\n               @ rotation_matrix(elong, \'z\', unit=u.radian))\n    return mat\n\n@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, AltAz)\n@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, HADec)\ndef itrs_to_observed(itrs_coo, observed_frame):\n    # Trying to synchronize the obstimes here makes no sense. In fact,\n    # it\'s a real gotcha as doing an ITRS->ITRS transform references \n    # ITRS coordinates, which should be tied to the Earth, to the SSB.\n    # Instead, we treat ITRS coordinates as time invariant here.\n\n    # form the Topocentric ITRS position\n    topocentric_itrs_repr = (itrs_coo.cartesian\n                             - observed_frame.location.get_itrs().cartesian)\n    rep = topocentric_itrs_repr.transform(itrs_to_observed_mat(observed_frame))\n    return observed_frame.realize_frame(rep)\n\n@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, AltAz, ITRS)\n@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, HADec, ITRS)\ndef observed_to_itrs(observed_coo, itrs_frame):\n                                              \n    # form the Topocentric ITRS position\n    topocentric_itrs_repr = observed_coo.cartesian.transform(matrix_transpose(\n                            itrs_to_observed_mat(observed_coo)))\n    # form the Geocentric ITRS position\n    rep = topocentric_itrs_repr + observed_coo.location.get_itrs().cartesian\n    return itrs_frame.realize_frame(rep)\n```\n\nIssue comments:\n\n\nPatch Information:\n```diff\ndiff --git a/astropy/coordinates/builtin_frames/__init__.py b/astropy/coordinates/builtin_frames/__init__.py\nindex 6fd688c285..1315098747 100644\n--- a/astropy/coordinates/builtin_frames/__init__.py\n+++ b/astropy/coordinates/builtin_frames/__init__.py\n@@ -50,6 +50,7 @@ from . import cirs_observed_transforms\n from . import icrs_observed_transforms\n from . import intermediate_rotation_transforms\n from . import ecliptic_transforms\n+from . import itrs_observed_transforms\n \n # Import this after importing other frames, since this requires various\n # transformtions to set up the LSR frames\ndiff --git a/astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py b/astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py\nindex a15248c38d..df9ae728e5 100644\n--- a/astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py\n+++ b/astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py\n@@ -272,8 +272,18 @@ def itrs_to_teme(itrs_coo, teme_frame):\n     return teme_frame.realize_frame(newrepr)\n \n \n+@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, ITRS)\n+def itrs_to_itrs(itrs_coo, itrs_frame):\n+    # Direct ITRS->ITRS: keep representation and any differentials unchanged,\n+    # and realize the target frame (adopting its obstime and other attrs).\n+    return itrs_frame.realize_frame(itrs_coo.data)\n+\n # Create loopback transformations\n-frame_transform_graph._add_merged_transform(ITRS, CIRS, ITRS)\n+# Guard against a pre-existing direct ITRS->ITRS transform\n+try:\n+    frame_transform_graph._add_merged_transform(ITRS, CIRS, ITRS)\n+except ValueError:\n+    pass\n frame_transform_graph._add_merged_transform(PrecessedGeocentric, GCRS, PrecessedGeocentric)\n frame_transform_graph._add_merged_transform(TEME, ITRS, TEME)\n frame_transform_graph._add_merged_transform(TETE, ICRS, TETE)\ndiff --git a/astropy/coordinates/builtin_frames/itrs_observed_transforms.py b/astropy/coordinates/builtin_frames/itrs_observed_transforms.py\nnew file mode 100644\nindex 0000000000..d89e4ae6ea\n--- /dev/null\n+++ b/astropy/coordinates/builtin_frames/itrs_observed_transforms.py\n@@ -0,0 +1,79 @@\n+# Licensed under a 3-clause BSD style license - see LICENSE.rst\n+"""\n+Direct transformations between ITRS and observed frames (AltAz, HADec) that\n+stay within ITRS and perform only topocentric translation and local rotations.\n+"""\n+\n+import numpy as np\n+\n+from astropy import units as u\n+from astropy.coordinates.baseframe import frame_transform_graph\n+from astropy.coordinates.transformations import FunctionTransformWithFiniteDifference\n+from astropy.coordinates.matrix_utilities import rotation_matrix, matrix_transpose\n+from astropy.coordinates.representation import CartesianRepresentation\n+\n+from .altaz import AltAz\n+from .hadec import HADec\n+from .itrs import ITRS\n+from .utils import PIOVER2\n+\n+\n+def itrs_to_observed_mat(observed_frame):\n+    """\n+    Form the rotation matrix from ITRS to the observed frame (AltAz or HADec)\n+    for a given observer location.\n+    """\n+    if observed_frame.location is None:\n+        raise ValueError("ITRS to observed transform requires an EarthLocation on the observed frame")\n+\n+    lon, lat, height = observed_frame.location.to_geodetic(\'WGS84\')\n+    elong = lon.to_value(u.radian)\n+\n+    if isinstance(observed_frame, AltAz):\n+        # form ITRS to AltAz matrix\n+        elat = lat.to_value(u.radian)\n+        # AltAz frame is left handed\n+        minus_x = np.eye(3)\n+        minus_x[0][0] = -1.0\n+        mat = (minus_x\n+               @ rotation_matrix(PIOVER2 - elat, \'y\', unit=u.radian)\n+               @ rotation_matrix(elong, \'z\', unit=u.radian))\n+\n+    else:\n+        # form ITRS to HADec matrix\n+        # HADec frame is left handed\n+        minus_y = np.eye(3)\n+        minus_y[1][1] = -1.0\n+        mat = (minus_y\n+               @ rotation_matrix(elong, \'z\', unit=u.radian))\n+    return mat\n+\n+\n+@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, AltAz)\n+@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, HADec)\n+def itrs_to_observed(itrs_coo, observed_frame):\n+    # Treat ITRS positions as time invariant and perform a purely topocentric\n+    # transformation using the observed frame\'s obstime for the observer location.\n+    if observed_frame.location is None:\n+        raise ValueError("ITRS to observed transform requires an EarthLocation on the observed frame")\n+\n+    # Form the Topocentric ITRS position (preserving differentials if present)\n+    observer_itrs = observed_frame.location.get_itrs(obstime=observed_frame.obstime)\n+    topocentric_itrs_repr = (itrs_coo.data - observer_itrs.data)\n+    rep = topocentric_itrs_repr.transform(itrs_to_observed_mat(observed_frame))\n+    return observed_frame.realize_frame(rep)\n+\n+\n+@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, AltAz, ITRS)\n+@frame_transform_graph.transform(FunctionTransformWithFiniteDifference, HADec, ITRS)\n+def observed_to_itrs(observed_coo, itrs_frame):\n+    # Inverse of the above: rotate back to ITRS topocentric, then add the\n+    # observer\'s geocentric ITRS position at the target ITRS obstime.\n+    if observed_coo.location is None:\n+        raise ValueError("Observed to ITRS transform requires an EarthLocation on the observed coordinate/frame")\n+\n+    topocentric_itrs_repr = observed_coo.data.transform(\n+        matrix_transpose(itrs_to_observed_mat(observed_coo)))\n+    observer_itrs = observed_coo.location.get_itrs(obstime=itrs_frame.obstime)\n+    rep = topocentric_itrs_repr + observer_itrs.data\n+    return itrs_frame.realize_frame(rep)\n\n```\n\nFocal Code Context (relevant code that may need fixing):\n{\'relative_path\': \'astropy/coordinates/attributes.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. # Dependencies\\n4. import numpy as np\\n5. \\n6. # Project\\n7. from astropy import units as u\\n8. from astropy.utils import ShapedLikeNDArray\\n9. \\n10. __all__ = [\\\'Attribute\\\', \\\'TimeAttribute\\\', \\\'QuantityAttribute\\\',\\n11.            \\\'EarthLocationAttribute\\\', \\\'CoordinateAttribute\\\',\\n12.            \\\'CartesianRepresentationAttribute\\\',\\n13.            \\\'DifferentialAttribute\\\']\\n14. \\n15. \\n16. class Attribute:\\n17.     """A non-mutable data descriptor to hold a frame attribute.\\n18. \\n19.     This class must be used to define frame attributes (e.g. ``equinox`` or\\n20.     ``obstime``) that are included in a frame class definition.\\n21. \\n22.     Examples\\n23.     --------\\n24.     The `~astropy.coordinates.FK4` class uses the following class attributes::\\n25. \\n26.       class FK4(BaseCoordinateFrame):\\n27.           equinox = TimeAttribute(default=_EQUINOX_B1950)\\n28.           obstime = TimeAttribute(default=None,\\n29.                                   secondary_attribute=\\\'equinox\\\')\\n30. \\n31.     This means that ``equinox`` and ``obstime`` are available to be set as\\n32.     keyword arguments when creating an ``FK4`` class instance and are then\\n33.     accessible as instance attributes.  The instance value for the attribute\\n34.     must be stored in ``\\\'_\\\' + <attribute_name>`` by the frame ``__init__``\\n35.     method.\\n36. \\n37.     Note in this example that ``equinox`` and ``obstime`` are time attributes\\n38.     and use the ``TimeAttributeFrame`` class.  This subclass overrides the\\n39.     ``convert_input`` method to validate and convert inputs into a ``Time``\\n40.     object.\\n41. \\n42.     Parameters\\n43.     ----------\\n44.     default : object\\n45.         Default value for the attribute if not provided\\n46.     secondary_attribute : str\\n47.         Name of a secondary instance attribute which supplies the value if\\n48.         ``default is None`` and no value was supplied during initialization.\\n49.     """\\n50. \\n51.     name = \\\'<unbound>\\\'\\n52. \\n53.     def __init__(self, default=None, secondary_attribute=\\\'\\\'):\\n54.         self.default = default\\n55.         self.secondary_attribute = secondary_attribute\\n56.         super().__init__()\\n57. \\n58.     def __set_name__(self, owner, name):\\n59.         self.name = name\\n60. \\n61.     def convert_input(self, value):\\n62.         """\\n63.         Validate the input ``value`` and convert to expected attribute class.\\n64. \\n65.         The base method here does nothing, but subclasses can implement this\\n66.         as needed.  The method should catch any internal exceptions and raise\\n67.         ValueError with an informative message.\\n68. \\n69.         The method returns the validated input along with a boolean that\\n70.         indicates whether the input value was actually converted.  If the input\\n71.         value was already the correct type then the ``converted`` return value\\n72.         should be ``False``.\\n73. \\n74.         Parameters\\n75.         ----------\\n76.         value : object\\n77.             Input value to be converted.\\n78. \\n79.         Returns\\n80.         -------\\n81.         output_value : object\\n82.             The ``value`` converted to the correct type (or just ``value`` if\\n83.             ``converted`` is False)\\n84.         converted : bool\\n85.             True if the conversion was actually performed, False otherwise.\\n86. \\n87.         Raises\\n88.         ------\\n89.         ValueError\\n90.             If the input is not valid for this attribute.\\n91. \\n92.         """\\n93.         return value, False\\n94. \\n95.     def __get__(self, instance, frame_cls=None):\\n96.         if instance is None:\\n97.             out = self.default\\n98.         else:\\n99.             out = getattr(instance, \\\'_\\\' + self.name, self.default)\\n100.             if out is None:\\n101.                 out = getattr(instance, self.secondary_attribute, self.default)\\n102. \\n103.         out, converted = self.convert_input(out)\\n104.         if instance is not None:\\n105.             instance_shape = getattr(instance, \\\'shape\\\', None)  # None if instance (frame) has no data!\\n106.             if instance_shape is not None and (getattr(out, \\\'shape\\\', ()) and\\n107.                                                out.shape != instance_shape):\\n108.                 # If the shapes do not match, try broadcasting.\\n109.                 try:\\n110.                     if isinstance(out, ShapedLikeNDArray):\\n111.                         out = out._apply(np.broadcast_to, shape=instance_shape,\\n112.                                          subok=True)\\n113.                     else:\\n114.                         out = np.broadcast_to(out, instance_shape, subok=True)\\n115.                 except ValueError:\\n116.                     # raise more informative exception.\\n117.                     raise ValueError(\\n118.                         "attribute {} should be scalar or have shape {}, "\\n119.                         "but is has shape {} and could not be broadcast."\\n120.                         .format(self.name, instance_shape, out.shape))\\n121. \\n122.                 converted = True\\n123. \\n124.             if converted:\\n125.                 setattr(instance, \\\'_\\\' + self.name, out)\\n126. \\n127.         return out\\n128. \\n129.     def __set__(self, instance, val):\\n130.         raise AttributeError(\\\'Cannot set frame attribute\\\')\\n131. \\n132. \\n133. class TimeAttribute(Attribute):\\n134.     """\\n135.     Frame attribute descriptor for quantities that are Time objects.\\n136.     See the `~astropy.coordinates.Attribute` API doc for further\\n137.     information.\\n138. \\n139.     Parameters\\n140.     ----------\\n141.     default : object\\n142.         Default value for the attribute if not provided\\n143.     secondary_attribute : str\\n144.         Name of a secondary instance attribute which supplies the value if\\n145.         ``default is None`` and no value was supplied during initialization.\\n146.     """\\n147. \\n148.     def convert_input(self, value):\\n149.         """\\n150.         Convert input value to a Time object and validate by running through\\n151.         the Time constructor.  Also check that the input was a scalar.\\n152. \\n153.         Parameters\\n154.         ----------\\n155.         value : object\\n156.             Input value to be converted.\\n157. \\n158.         Returns\\n159.         -------\\n160.         out, converted : correctly-typed object, boolean\\n161.             Tuple consisting of the correctly-typed object and a boolean which\\n162.             indicates if conversion was actually performed.\\n163. \\n164.         Raises\\n165.         ------\\n166.         ValueError\\n167.             If the input is not valid for this attribute.\\n168.         """\\n169. \\n170.         from astropy.time import Time\\n171. \\n172.         if value is None:\\n173.             return None, False\\n174. \\n175.         if isinstance(value, Time):\\n176.             out = value\\n177.             converted = False\\n178.         else:\\n179.             try:\\n180.                 out = Time(value)\\n181.             except Exception as err:\\n182.                 raise ValueError(\\n183.                     f\\\'Invalid time input {self.name}={value!r}.\\\') from err\\n184.             converted = True\\n185. \\n186.         # Set attribute as read-only for arrays (not allowed by numpy\\n187.         # for array scalars)\\n188.         if out.shape:\\n189.             out.writeable = False\\n190.         return out, converted\\n191. \\n192. \\n193. class CartesianRepresentationAttribute(Attribute):\\n194.     """\\n195.     A frame attribute that is a CartesianRepresentation with specified units.\\n196. \\n197.     Parameters\\n198.     ----------\\n199.     default : object\\n200.         Default value for the attribute if not provided\\n201.     secondary_attribute : str\\n202.         Name of a secondary instance attribute which supplies the value if\\n203.         ``default is None`` and no value was supplied during initialization.\\n204.     unit : unit-like or None\\n205.         Name of a unit that the input will be converted into. If None, no\\n206.         unit-checking or conversion is performed\\n207.     """\\n208. \\n209.     def __init__(self, default=None, secondary_attribute=\\\'\\\', unit=None):\\n210.         super().__init__(default, secondary_attribute)\\n211.         self.unit = unit\\n212. \\n213.     def convert_input(self, value):\\n214.         """\\n215.         Checks that the input is a CartesianRepresentation with the correct\\n216.         unit, or the special value ``[0, 0, 0]``.\\n217. \\n218.         Parameters\\n219.         ----------\\n220.         value : object\\n221.             Input value to be converted.\\n222. \\n223.         Returns\\n224.         -------\\n225.         out : object\\n226.             The correctly-typed object.\\n227.         converted : boolean\\n228.             A boolean which indicates if conversion was actually performed.\\n229. \\n230.         Raises\\n231.         ------\\n232.         ValueError\\n233.             If the input is not valid for this attribute.\\n234.         """\\n235. \\n236.         if (isinstance(value, list) and len(value) == 3 and\\n237.                 all(v == 0 for v in value) and self.unit is not None):\\n238.             return CartesianRepresentation(np.zeros(3) * self.unit), True\\n239.         else:\\n240.             # is it a CartesianRepresentation with correct unit?\\n241.             if hasattr(value, \\\'xyz\\\') and value.xyz.unit == self.unit:\\n242.                 return value, False\\n243. \\n244.             converted = True\\n245.             # if it\\\'s a CartesianRepresentation, get the xyz Quantity\\n246.             value = getattr(value, \\\'xyz\\\', value)\\n247.             if not hasattr(value, \\\'unit\\\'):\\n248.                 raise TypeError(\\\'tried to set a {} with something that does \\\'\\n249.                                 \\\'not have a unit.\\\'\\n250.                                 .format(self.__class__.__name__))\\n251. \\n252.             value = value.to(self.unit)\\n253. \\n254.             # now try and make a CartesianRepresentation.\\n255.             cartrep = CartesianRepresentation(value, copy=False)\\n256.             return cartrep, converted\\n257. \\n258. \\n259. class QuantityAttribute(Attribute):\\n260.     """\\n261.     A frame attribute that is a quantity with specified units and shape\\n262.     (optionally).\\n263. \\n264.     Can be `None`, which should be used for special cases in associated\\n265.     frame transformations like "this quantity should be ignored" or similar.\\n266. \\n267.     Parameters\\n268.     ----------\\n269.     default : number or `~astropy.units.Quantity` or None, optional\\n270.         Default value for the attribute if the user does not supply one. If a\\n271.         Quantity, it must be consistent with ``unit``, or if a value, ``unit``\\n272.         cannot be None.\\n273.     secondary_attribute : str, optional\\n274.         Name of a secondary instance attribute which supplies the value if\\n275.         ``default is None`` and no value was supplied during initialization.\\n276.     unit : unit-like or None, optional\\n277.         Name of a unit that the input will be converted into. If None, no\\n278.         unit-checking or conversion is performed\\n279.     shape : tuple or None, optional\\n280.         If given, specifies the shape the attribute must be\\n281.     """\\n282. \\n283.     def __init__(self, default=None, secondary_attribute=\\\'\\\', unit=None,\\n284.                  shape=None):\\n285. \\n286.         if default is None and unit is None:\\n287.             raise ValueError(\\\'Either a default quantity value must be \\\'\\n288.                              \\\'provided, or a unit must be provided to define a \\\'\\n289.                              \\\'QuantityAttribute.\\\')\\n290. \\n291.         if default is not None and unit is None:\\n292.             unit = default.unit\\n293. \\n294.         self.unit = unit\\n295.         self.shape = shape\\n296.         default = self.convert_input(default)[0]\\n297.         super().__init__(default, secondary_attribute)\\n298. \\n299.     def convert_input(self, value):\\n300.         """\\n301.         Checks that the input is a Quantity with the necessary units (or the\\n302.         special value ``0``).\\n303. \\n304.         Parameters\\n305.         ----------\\n306.         value : object\\n307.             Input value to be converted.\\n308. \\n309.         Returns\\n310.         -------\\n311.         out, converted : correctly-typed object, boolean\\n312.             Tuple consisting of the correctly-typed object and a boolean which\\n313.             indicates if conversion was actually performed.\\n314. \\n315.         Raises\\n316.         ------\\n317.         ValueError\\n318.             If the input is not valid for this attribute.\\n319.         """\\n320. \\n321.         if value is None:\\n322.             return None, False\\n323. \\n324.         if (not hasattr(value, \\\'unit\\\') and self.unit != u.dimensionless_unscaled\\n325.                 and np.any(value != 0)):\\n326.             raise TypeError(\\\'Tried to set a QuantityAttribute with \\\'\\n327.                             \\\'something that does not have a unit.\\\')\\n328. \\n329.         oldvalue = value\\n330.         value = u.Quantity(oldvalue, self.unit, copy=False)\\n331.         if self.shape is not None and value.shape != self.shape:\\n332.             if value.shape == () and oldvalue == 0:\\n333.                 # Allow a single 0 to fill whatever shape is needed.\\n334.                 value = np.broadcast_to(value, self.shape, subok=True)\\n335.             else:\\n336.                 raise ValueError(\\n337.                     f\\\'The provided value has shape "{value.shape}", but \\\'\\n338.                     f\\\'should have shape "{self.shape}"\\\')\\n339. \\n340.         converted = oldvalue is not value\\n341.         return value, converted\\n342. \\n343. \\n344. class EarthLocationAttribute(Attribute):\\n345.     """\\n346.     A frame attribute that can act as a `~astropy.coordinates.EarthLocation`.\\n347.     It can be created as anything that can be transformed to the\\n348.     `~astropy.coordinates.ITRS` frame, but always presents as an `EarthLocation`\\n349.     when accessed after creation.\\n350. \\n351.     Parameters\\n352.     ----------\\n353.     default : object\\n354.         Default value for the attribute if not provided\\n355.     secondary_attribute : str\\n356.         Name of a secondary instance attribute which supplies the value if\\n357.         ``default is None`` and no value was supplied during initialization.\\n358.     """\\n359. \\n360.     def convert_input(self, value):\\n361.         """\\n362.         Checks that the input is a Quantity with the necessary units (or the\\n363.         special value ``0``).\\n364. \\n365.         Parameters\\n366.         ----------\\n367.         value : object\\n368.             Input value to be converted.\\n369. \\n370.         Returns\\n371.         -------\\n372.         out, converted : correctly-typed object, boolean\\n373.             Tuple consisting of the correctly-typed object and a boolean which\\n374.             indicates if conversion was actually performed.\\n375. \\n376.         Raises\\n377.         ------\\n378.         ValueError\\n379.             If the input is not valid for this attribute.\\n380.         """\\n381. \\n382.         if value is None:\\n383.             return None, False\\n384.         elif isinstance(value, EarthLocation):\\n385.             return value, False\\n386.         else:\\n387.             # we have to do the import here because of some tricky circular deps\\n388.             from .builtin_frames import ITRS\\n389. \\n390.             if not hasattr(value, \\\'transform_to\\\'):\\n391.                 raise ValueError(\\\'"{}" was passed into an \\\'\\n392.                                  \\\'EarthLocationAttribute, but it does not have \\\'\\n393.                                  \\\'"transform_to" method\\\'.format(value))\\n394.             itrsobj = value.transform_to(ITRS())\\n395.             return itrsobj.earth_location, True\\n396. \\n397. \\n398. class CoordinateAttribute(Attribute):\\n399.     """\\n400.     A frame attribute which is a coordinate object.  It can be given as a\\n401.     `~astropy.coordinates.SkyCoord` or a low-level frame instance.  If a\\n402.     low-level frame instance is provided, it will always be upgraded to be a\\n403.     `~astropy.coordinates.SkyCoord` to ensure consistent transformation\\n404.     behavior.  The coordinate object will always be returned as a low-level\\n405.     frame instance when accessed.\\n406. \\n407.     Parameters\\n408.     ----------\\n409.     frame : `~astropy.coordinates.BaseCoordinateFrame` class\\n410.         The type of frame this attribute can be\\n411.     default : object\\n412.         Default value for the attribute if not provided\\n413.     secondary_attribute : str\\n414.         Name of a secondary instance attribute which supplies the value if\\n415.         ``default is None`` and no value was supplied during initialization.\\n416.     """\\n417. \\n418.     def __init__(self, frame, default=None, secondary_attribute=\\\'\\\'):\\n419.         self._frame = frame\\n420.         super().__init__(default, secondary_attribute)\\n421. \\n422.     def convert_input(self, value):\\n423.         """\\n424.         Checks that the input is a SkyCoord with the necessary units (or the\\n425.         special value ``None``).\\n426. \\n427.         Parameters\\n428.         ----------\\n429.         value : object\\n430.             Input value to be converted.\\n431. \\n432.         Returns\\n433.         -------\\n434.         out, converted : correctly-typed object, boolean\\n435.             Tuple consisting of the correctly-typed object and a boolean which\\n436.             indicates if conversion was actually performed.\\n437. \\n438.         Raises\\n439.         ------\\n440.         ValueError\\n441.             If the input is not valid for this attribute.\\n442.         """\\n443.         from astropy.coordinates import SkyCoord\\n444. \\n445.         if value is None:\\n446.             return None, False\\n447.         elif isinstance(value, self._frame):\\n448.             return value, False\\n449.         else:\\n450.             value = SkyCoord(value)  # always make the value a SkyCoord\\n451.             transformedobj = value.transform_to(self._frame)\\n452.             return transformedobj.frame, True\\n453. \\n454. \\n455. class DifferentialAttribute(Attribute):\\n456.     """A frame attribute which is a differential instance.\\n457. \\n458.     The optional ``allowed_classes`` argument allows specifying a restricted\\n459.     set of valid differential classes to check the input against. Otherwise,\\n460.     any `~astropy.coordinates.BaseDifferential` subclass instance is valid.\\n461. \\n462.     Parameters\\n463.     ----------\\n464.     default : object\\n465.         Default value for the attribute if not provided\\n466.     allowed_classes : tuple, optional\\n467.         A list of allowed differential classes for this attribute to have.\\n468.     secondary_attribute : str\\n469.         Name of a secondary instance attribute which supplies the value if\\n470.         ``default is None`` and no value was supplied during initialization.\\n471.     """\\n472. \\n473.     def __init__(self, default=None, allowed_classes=None,\\n474.                  secondary_attribute=\\\'\\\'):\\n475. \\n476.         if allowed_classes is not None:\\n477.             self.allowed_classes = tuple(allowed_classes)\\n478.         else:\\n479.             self.allowed_classes = BaseDifferential\\n480. \\n481.         super().__init__(default, secondary_attribute)\\n482. \\n483.     def convert_input(self, value):\\n484.         """\\n485.         Checks that the input is a differential object and is one of the\\n486.         allowed class types.\\n487. \\n488.         Parameters\\n489.         ----------\\n490.         value : object\\n491.             Input value.\\n492. \\n493.         Returns\\n494.         -------\\n495.         out, converted : correctly-typed object, boolean\\n496.             Tuple consisting of the correctly-typed object and a boolean which\\n497.             indicates if conversion was actually performed.\\n498. \\n499.         Raises\\n500.         ------\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/coordinates/baseframe.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """\\n3. Framework and base classes for coordinate frames/"low-level" coordinate\\n4. classes.\\n5. """\\n6. \\n7. \\n8. # Standard library\\n9. import copy\\n10. import inspect\\n11. from collections import namedtuple, defaultdict\\n12. import warnings\\n13. \\n14. # Dependencies\\n15. import numpy as np\\n16. \\n17. # Project\\n18. from astropy.utils.compat.misc import override__dir__\\n19. from astropy.utils.decorators import lazyproperty, format_doc\\n20. from astropy.utils.exceptions import AstropyWarning, AstropyDeprecationWarning\\n21. from astropy import units as u\\n22. from astropy.utils import ShapedLikeNDArray, check_broadcast\\n23. from .transformations import TransformGraph\\n24. from . import representation as r\\n25. from .angles import Angle\\n26. from .attributes import Attribute\\n27. \\n28. \\n29. __all__ = [\\\'BaseCoordinateFrame\\\', \\\'frame_transform_graph\\\',\\n30.            \\\'GenericFrame\\\', \\\'RepresentationMapping\\\']\\n31. \\n32. \\n33. # the graph used for all transformations between frames\\n34. frame_transform_graph = TransformGraph()\\n35. \\n36. \\n37. def _get_repr_cls(value):\\n38.     """\\n39.     Return a valid representation class from ``value`` or raise exception.\\n40.     """\\n41. \\n42.     if value in r.REPRESENTATION_CLASSES:\\n43.         value = r.REPRESENTATION_CLASSES[value]\\n44.     elif (not isinstance(value, type) or\\n45.           not issubclass(value, r.BaseRepresentation)):\\n46.         raise ValueError(\\n47.             \\\'Representation is {!r} but must be a BaseRepresentation class \\\'\\n48.             \\\'or one of the string aliases {}\\\'.format(\\n49.                 value, list(r.REPRESENTATION_CLASSES)))\\n50.     return value\\n51. \\n52. \\n53. def _get_diff_cls(value):\\n54.     """\\n55.     Return a valid differential class from ``value`` or raise exception.\\n56. \\n57.     As originally created, this is only used in the SkyCoord initializer, so if\\n58.     that is refactored, this function my no longer be necessary.\\n59.     """\\n60. \\n61.     if value in r.DIFFERENTIAL_CLASSES:\\n62.         value = r.DIFFERENTIAL_CLASSES[value]\\n63.     elif (not isinstance(value, type) or\\n64.           not issubclass(value, r.BaseDifferential)):\\n65.         raise ValueError(\\n66.             \\\'Differential is {!r} but must be a BaseDifferential class \\\'\\n67.             \\\'or one of the string aliases {}\\\'.format(\\n68.                 value, list(r.DIFFERENTIAL_CLASSES)))\\n69.     return value\\n70. \\n71. \\n72. def _get_repr_classes(base, **differentials):\\n73.     """Get valid representation and differential classes.\\n74. \\n75.     Parameters\\n76.     ----------\\n77.     base : str or `~astropy.coordinates.BaseRepresentation` subclass\\n78.         class for the representation of the base coordinates.  If a string,\\n79.         it is looked up among the known representation classes.\\n80.     **differentials : dict of str or `~astropy.coordinates.BaseDifferentials`\\n81.         Keys are like for normal differentials, i.e., \\\'s\\\' for a first\\n82.         derivative in time, etc.  If an item is set to `None`, it will be\\n83.         guessed from the base class.\\n84. \\n85.     Returns\\n86.     -------\\n87.     repr_classes : dict of subclasses\\n88.         The base class is keyed by \\\'base\\\'; the others by the keys of\\n89.         ``diffferentials``.\\n90.     """\\n91.     base = _get_repr_cls(base)\\n92.     repr_classes = {\\\'base\\\': base}\\n93. \\n94.     for name, differential_type in differentials.items():\\n95.         if differential_type == \\\'base\\\':\\n96.             # We don\\\'t want to fail for this case.\\n97.             differential_type = r.DIFFERENTIAL_CLASSES.get(base.get_name(), None)\\n98. \\n99.         elif differential_type in r.DIFFERENTIAL_CLASSES:\\n100.             differential_type = r.DIFFERENTIAL_CLASSES[differential_type]\\n101. \\n102.         elif (differential_type is not None\\n103.               and (not isinstance(differential_type, type)\\n104.                    or not issubclass(differential_type, r.BaseDifferential))):\\n105.             raise ValueError(\\n106.                 \\\'Differential is {!r} but must be a BaseDifferential class \\\'\\n107.                 \\\'or one of the string aliases {}\\\'.format(\\n108.                     differential_type, list(r.DIFFERENTIAL_CLASSES)))\\n109.         repr_classes[name] = differential_type\\n110.     return repr_classes\\n111. \\n112. \\n113. _RepresentationMappingBase = \\\\\\n114.     namedtuple(\\\'RepresentationMapping\\\',\\n115.                (\\\'reprname\\\', \\\'framename\\\', \\\'defaultunit\\\'))\\n116. \\n117. \\n118. class RepresentationMapping(_RepresentationMappingBase):\\n119.     """\\n120.     This `~collections.namedtuple` is used with the\\n121.     ``frame_specific_representation_info`` attribute to tell frames what\\n122.     attribute names (and default units) to use for a particular representation.\\n123.     ``reprname`` and ``framename`` should be strings, while ``defaultunit`` can\\n124.     be either an astropy unit, the string ``\\\'recommended\\\'`` (which is degrees\\n125.     for Angles, nothing otherwise), or None (to indicate that no unit mapping\\n126.     should be done).\\n127.     """\\n128. \\n129.     def __new__(cls, reprname, framename, defaultunit=\\\'recommended\\\'):\\n130.         # this trick just provides some defaults\\n131.         return super().__new__(cls, reprname, framename, defaultunit)\\n132. \\n133. \\n134. base_doc = """{__doc__}\\n135.     Parameters\\n136.     ----------\\n137.     data : `~astropy.coordinates.BaseRepresentation` subclass instance\\n138.         A representation object or ``None`` to have no data (or use the\\n139.         coordinate component arguments, see below).\\n140.     {components}\\n141.     representation_type : `~astropy.coordinates.BaseRepresentation` subclass, str, optional\\n142.         A representation class or string name of a representation class. This\\n143.         sets the expected input representation class, thereby changing the\\n144.         expected keyword arguments for the data passed in. For example, passing\\n145.         ``representation_type=\\\'cartesian\\\'`` will make the classes expect\\n146.         position data with cartesian names, i.e. ``x, y, z`` in most cases\\n147.         unless overridden via ``frame_specific_representation_info``. To see this\\n148.         frame\\\'s names, check out ``<this frame>().representation_info``.\\n149.     differential_type : `~astropy.coordinates.BaseDifferential` subclass, str, dict, optional\\n150.         A differential class or dictionary of differential classes (currently\\n151.         only a velocity differential with key \\\'s\\\' is supported). This sets the\\n152.         expected input differential class, thereby changing the expected keyword\\n153.         arguments of the data passed in. For example, passing\\n154.         ``differential_type=\\\'cartesian\\\'`` will make the classes expect velocity\\n155.         data with the argument names ``v_x, v_y, v_z`` unless overridden via\\n156.         ``frame_specific_representation_info``. To see this frame\\\'s names,\\n157.         check out ``<this frame>().representation_info``.\\n158.     copy : bool, optional\\n159.         If `True` (default), make copies of the input coordinate arrays.\\n160.         Can only be passed in as a keyword argument.\\n161.     {footer}\\n162. """\\n163. \\n164. _components = """\\n165.     *args, **kwargs\\n166.         Coordinate components, with names that depend on the subclass.\\n167. """\\n168. \\n169. \\n170. @format_doc(base_doc, components=_components, footer="")\\n171. class BaseCoordinateFrame(ShapedLikeNDArray):\\n172.     """\\n173.     The base class for coordinate frames.\\n174. \\n175.     This class is intended to be subclassed to create instances of specific\\n176.     systems.  Subclasses can implement the following attributes:\\n177. \\n178.     * `default_representation`\\n179.         A subclass of `~astropy.coordinates.BaseRepresentation` that will be\\n180.         treated as the default representation of this frame.  This is the\\n181.         representation assumed by default when the frame is created.\\n182. \\n183.     * `default_differential`\\n184.         A subclass of `~astropy.coordinates.BaseDifferential` that will be\\n185.         treated as the default differential class of this frame.  This is the\\n186.         differential class assumed by default when the frame is created.\\n187. \\n188.     * `~astropy.coordinates.Attribute` class attributes\\n189.        Frame attributes such as ``FK4.equinox`` or ``FK4.obstime`` are defined\\n190.        using a descriptor class.  See the narrative documentation or\\n191.        built-in classes code for details.\\n192. \\n193.     * `frame_specific_representation_info`\\n194.         A dictionary mapping the name or class of a representation to a list of\\n195.         `~astropy.coordinates.RepresentationMapping` objects that tell what\\n196.         names and default units should be used on this frame for the components\\n197.         of that representation.\\n198. \\n199.     Unless overridden via `frame_specific_representation_info`, velocity name\\n200.     defaults are:\\n201. \\n202.       * ``pm_{lon}_cos{lat}``, ``pm_{lat}`` for `SphericalCosLatDifferential`\\n203.         proper motion components\\n204.       * ``pm_{lon}``, ``pm_{lat}`` for `SphericalDifferential` proper motion\\n205.         components\\n206.       * ``radial_velocity`` for any ``d_distance`` component\\n207.       * ``v_{x,y,z}`` for `CartesianDifferential` velocity components\\n208. \\n209.     where ``{lon}`` and ``{lat}`` are the frame names of the angular components.\\n210.     """\\n211. \\n212.     default_representation = None\\n213.     default_differential = None\\n214. \\n215.     # Specifies special names and units for representation and differential\\n216.     # attributes.\\n217.     frame_specific_representation_info = {}\\n218. \\n219.     frame_attributes = {}\\n220.     # Default empty frame_attributes dict\\n221. \\n222.     def __init_subclass__(cls, **kwargs):\\n223. \\n224.         # We first check for explicitly set values for these:\\n225.         default_repr = getattr(cls, \\\'default_representation\\\', None)\\n226.         default_diff = getattr(cls, \\\'default_differential\\\', None)\\n227.         repr_info = getattr(cls, \\\'frame_specific_representation_info\\\', None)\\n228.         # Then, to make sure this works for subclasses-of-subclasses, we also\\n229.         # have to check for cases where the attribute names have already been\\n230.         # replaced by underscore-prefaced equivalents by the logic below:\\n231.         if default_repr is None or isinstance(default_repr, property):\\n232.             default_repr = getattr(cls, \\\'_default_representation\\\', None)\\n233. \\n234.         if default_diff is None or isinstance(default_diff, property):\\n235.             default_diff = getattr(cls, \\\'_default_differential\\\', None)\\n236. \\n237.         if repr_info is None or isinstance(repr_info, property):\\n238.             repr_info = getattr(cls, \\\'_frame_specific_representation_info\\\', None)\\n239. \\n240.         repr_info = cls._infer_repr_info(repr_info)\\n241. \\n242.         # Make read-only properties for the frame class attributes that should\\n243.         # be read-only to make them immutable after creation.\\n244.         # We copy attributes instead of linking to make sure there\\\'s no\\n245.         # accidental cross-talk between classes\\n246.         cls._create_readonly_property(\\\'default_representation\\\', default_repr,\\n247.                                       \\\'Default representation for position data\\\')\\n248.         cls._create_readonly_property(\\\'default_differential\\\', default_diff,\\n249.                                       \\\'Default representation for differential data \\\'\\n250.                                       \\\'(e.g., velocity)\\\')\\n251.         cls._create_readonly_property(\\\'frame_specific_representation_info\\\',\\n252.                                       copy.deepcopy(repr_info),\\n253.                                       \\\'Mapping for frame-specific component names\\\')\\n254. \\n255.         # Set the frame attributes. We first construct the attributes from\\n256.         # superclasses, going in reverse order to keep insertion order,\\n257.         # and then add any attributes from the frame now being defined\\n258.         # (if any old definitions are overridden, this keeps the order).\\n259.         # Note that we cannot simply start with the inherited frame_attributes\\n260.         # since we could be a mixin between multiple coordinate frames.\\n261.         # TODO: Should this be made to use readonly_prop_factory as well or\\n262.         # would it be inconvenient for getting the frame_attributes from\\n263.         # classes?\\n264.         frame_attrs = {}\\n265.         for basecls in reversed(cls.__bases__):\\n266.             if issubclass(basecls, BaseCoordinateFrame):\\n267.                 frame_attrs.update(basecls.frame_attributes)\\n268. \\n269.         for k, v in cls.__dict__.items():\\n270.             if isinstance(v, Attribute):\\n271.                 frame_attrs[k] = v\\n272. \\n273.         cls.frame_attributes = frame_attrs\\n274. \\n275.         # Deal with setting the name of the frame:\\n276.         if not hasattr(cls, \\\'name\\\'):\\n277.             cls.name = cls.__name__.lower()\\n278.         elif (BaseCoordinateFrame not in cls.__bases__ and\\n279.                 cls.name in [getattr(base, \\\'name\\\', None)\\n280.                              for base in cls.__bases__]):\\n281.             # This may be a subclass of a subclass of BaseCoordinateFrame,\\n282.             # like ICRS(BaseRADecFrame). In this case, cls.name will have been\\n283.             # set by init_subclass\\n284.             cls.name = cls.__name__.lower()\\n285. \\n286.         # A cache that *must be unique to each frame class* - it is\\n287.         # insufficient to share them with superclasses, hence the need to put\\n288.         # them in the meta\\n289.         cls._frame_class_cache = {}\\n290. \\n291.         super().__init_subclass__(**kwargs)\\n292. \\n293.     def __init__(self, *args, copy=True, representation_type=None,\\n294.                  differential_type=None, **kwargs):\\n295.         self._attr_names_with_defaults = []\\n296. \\n297.         self._representation = self._infer_representation(representation_type, differential_type)\\n298.         self._data = self._infer_data(args, copy, kwargs)  # possibly None.\\n299. \\n300.         # Set frame attributes, if any\\n301. \\n302.         values = {}\\n303.         for fnm, fdefault in self.get_frame_attr_names().items():\\n304.             # Read-only frame attributes are defined as FrameAttribute\\n305.             # descriptors which are not settable, so set \\\'real\\\' attributes as\\n306.             # the name prefaced with an underscore.\\n307. \\n308.             if fnm in kwargs:\\n309.                 value = kwargs.pop(fnm)\\n310.                 setattr(self, \\\'_\\\' + fnm, value)\\n311.                 # Validate attribute by getting it. If the instance has data,\\n312.                 # this also checks its shape is OK. If not, we do it below.\\n313.                 values[fnm] = getattr(self, fnm)\\n314.             else:\\n315.                 setattr(self, \\\'_\\\' + fnm, fdefault)\\n316.                 self._attr_names_with_defaults.append(fnm)\\n317. \\n318.         if kwargs:\\n319.             raise TypeError(\\n320.                 f\\\'Coordinate frame {self.__class__.__name__} got unexpected \\\'\\n321.                 f\\\'keywords: {list(kwargs)}\\\')\\n322. \\n323.         # We do ``is None`` because self._data might evaluate to false for\\n324.         # empty arrays or data == 0\\n325.         if self._data is None:\\n326.             # No data: we still need to check that any non-scalar attributes\\n327.             # have consistent shapes. Collect them for all attributes with\\n328.             # size > 1 (which should be array-like and thus have a shape).\\n329.             shapes = {fnm: value.shape for fnm, value in values.items()\\n330.                       if getattr(value, \\\'shape\\\', ())}\\n331.             if shapes:\\n332.                 if len(shapes) > 1:\\n333.                     try:\\n334.                         self._no_data_shape = check_broadcast(*shapes.values())\\n335.                     except ValueError as err:\\n336.                         raise ValueError(\\n337.                             f"non-scalar attributes with inconsistent shapes: {shapes}") from err\\n338. \\n339.                     # Above, we checked that it is possible to broadcast all\\n340.                     # shapes.  By getting and thus validating the attributes,\\n341.                     # we verify that the attributes can in fact be broadcast.\\n342.                     for fnm in shapes:\\n343.                         getattr(self, fnm)\\n344.                 else:\\n345.                     self._no_data_shape = shapes.popitem()[1]\\n346. \\n347.             else:\\n348.                 self._no_data_shape = ()\\n349. \\n350.         # The logic of this block is not related to the previous one\\n351.         if self._data is not None:\\n352.             # This makes the cache keys backwards-compatible, but also adds\\n353.             # support for having differentials attached to the frame data\\n354.             # representation object.\\n355.             if \\\'s\\\' in self._data.differentials:\\n356.                 # TODO: assumes a velocity unit differential\\n357.                 key = (self._data.__class__.__name__,\\n358.                        self._data.differentials[\\\'s\\\'].__class__.__name__,\\n359.                        False)\\n360.             else:\\n361.                 key = (self._data.__class__.__name__, False)\\n362. \\n363.             # Set up representation cache.\\n364.             self.cache[\\\'representation\\\'][key] = self._data\\n365. \\n366.     def _infer_representation(self, representation_type, differential_type):\\n367.         if representation_type is None and differential_type is None:\\n368.             return {\\\'base\\\': self.default_representation, \\\'s\\\': self.default_differential}\\n369. \\n370.         if representation_type is None:\\n371.             representation_type = self.default_representation\\n372. \\n373.         if (inspect.isclass(differential_type)\\n374.                 and issubclass(differential_type, r.BaseDifferential)):\\n375.             # TODO: assumes the differential class is for the velocity\\n376.             # differential\\n377.             differential_type = {\\\'s\\\': differential_type}\\n378. \\n379.         elif isinstance(differential_type, str):\\n380.             # TODO: assumes the differential class is for the velocity\\n381.             # differential\\n382.             diff_cls = r.DIFFERENTIAL_CLASSES[differential_type]\\n383.             differential_type = {\\\'s\\\': diff_cls}\\n384. \\n385.         elif differential_type is None:\\n386.             if representation_type == self.default_representation:\\n387.                 differential_type = {\\\'s\\\': self.default_differential}\\n388.             else:\\n389.                 differential_type = {\\\'s\\\': \\\'base\\\'}  # see set_representation_cls()\\n390. \\n391.         return _get_repr_classes(representation_type, **differential_type)\\n392. \\n393.     def _infer_data(self, args, copy, kwargs):\\n394.         # if not set below, this is a frame with no data\\n395.         representation_data = None\\n396.         differential_data = None\\n397. \\n398.         args = list(args)  # need to be able to pop them\\n399.         if (len(args) > 0) and (isinstance(args[0], r.BaseRepresentation) or\\n400.                                 args[0] is None):\\n401.             representation_data = args.pop(0)  # This can still be None\\n402.             if len(args) > 0:\\n403.                 raise TypeError(\\n404.                     \\\'Cannot create a frame with both a representation object \\\'\\n405.                     \\\'and other positional arguments\\\')\\n406. \\n407.             if representation_data is not None:\\n408.                 diffs = representation_data.differentials\\n409.                 differential_data = diffs.get(\\\'s\\\', None)\\n410.                 if ((differential_data is None and len(diffs) > 0) or\\n411.                         (differential_data is not None and len(diffs) > 1)):\\n412.                     raise ValueError(\\\'Multiple differentials are associated \\\'\\n413.                                      \\\'with the representation object passed in \\\'\\n414.                                      \\\'to the frame initializer. Only a single \\\'\\n415.                                      \\\'velocity differential is supported. Got: \\\'\\n416.                                      \\\'{}\\\'.format(diffs))\\n417. \\n418.         else:\\n419.             representation_cls = self.get_representation_cls()\\n420.             # Get any representation data passed in to the frame initializer\\n421.             # using keyword or positional arguments for the component names\\n422.             repr_kwargs = {}\\n423.             for nmkw, nmrep in self.representation_component_names.items():\\n424.                 if len(args) > 0:\\n425.                     # first gather up positional args\\n426.                     repr_kwargs[nmrep] = args.pop(0)\\n427.                 elif nmkw in kwargs:\\n428.                     repr_kwargs[nmrep] = kwargs.pop(nmkw)\\n429. \\n430.             # special-case the Spherical->UnitSpherical if no `distance`\\n431. \\n432.             if repr_kwargs:\\n433.                 # TODO: determine how to get rid of the part before the "try" -\\n434.                 # currently removing it has a performance regression for\\n435.                 # unitspherical because of the try-related overhead.\\n436.                 # Also frames have no way to indicate what the "distance" is\\n437.                 if repr_kwargs.get(\\\'distance\\\', True) is None:\\n438.                     del repr_kwargs[\\\'distance\\\']\\n439. \\n440.                 if (issubclass(representation_cls,\\n441.                                r.SphericalRepresentation)\\n442.                         and \\\'distance\\\' not in repr_kwargs):\\n443.                     representation_cls = representation_cls._unit_representation\\n444. \\n445.                 try:\\n446.                     representation_data = representation_cls(copy=copy,\\n447.                                                              **repr_kwargs)\\n448.                 except TypeError as e:\\n449.                     # this except clause is here to make the names of the\\n450.                     # attributes more human-readable.  Without this the names\\n451.                     # come from the representation instead of the frame\\\'s\\n452.                     # attribute names.\\n453.                     try:\\n454.                         representation_data = (\\n455.                             representation_cls._unit_representation(\\n456.                                 copy=copy, **repr_kwargs))\\n457.                     except Exception:\\n458.                         msg = str(e)\\n459.                         names = self.get_representation_component_names()\\n460.                         for frame_name, repr_name in names.items():\\n461.                             msg = msg.replace(repr_name, frame_name)\\n462.                         msg = msg.replace(\\\'__init__()\\\',\\n463.                                           f\\\'{self.__class__.__name__}()\\\')\\n464.                         e.args = (msg,)\\n465.                         raise e\\n466. \\n467.             # Now we handle the Differential data:\\n468.             # Get any differential data passed in to the frame initializer\\n469.             # using keyword or positional arguments for the component names\\n470.             differential_cls = self.get_representation_cls(\\\'s\\\')\\n471.             diff_component_names = self.get_representation_component_names(\\\'s\\\')\\n472.             diff_kwargs = {}\\n473.             for nmkw, nmrep in diff_component_names.items():\\n474.                 if len(args) > 0:\\n475.                     # first gather up positional args\\n476.                     diff_kwargs[nmrep] = args.pop(0)\\n477.                 elif nmkw in kwargs:\\n478.                     diff_kwargs[nmrep] = kwargs.pop(nmkw)\\n479. \\n480.             if diff_kwargs:\\n481.                 if (hasattr(differential_cls, \\\'_unit_differential\\\')\\n482.                         and \\\'d_distance\\\' not in diff_kwargs):\\n483.                     differential_cls = differential_cls._unit_differential\\n484. \\n485.                 elif len(diff_kwargs) == 1 and \\\'d_distance\\\' in diff_kwargs:\\n486.                     differential_cls = r.RadialDifferential\\n487. \\n488.                 try:\\n489.                     differential_data = differential_cls(copy=copy,\\n490.                                                          **diff_kwargs)\\n491.                 except TypeError as e:\\n492.                     # this except clause is here to make the names of the\\n493.                     # attributes more human-readable.  Without this the names\\n494.                     # come from the representation instead of the frame\\\'s\\n495.                     # attribute names.\\n496.                     msg = str(e)\\n497.                     names = self.get_representation_component_names(\\\'s\\\')\\n498.                     for frame_name, repr_name in names.items():\\n499.                         msg = msg.replace(repr_name, frame_name)\\n500.                     msg = msg.replace(\\\'__init__()\\\',\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/coordinates/builtin_frames/altaz.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. import numpy as np\\n4. \\n5. from astropy import units as u\\n6. from astropy.utils.decorators import format_doc\\n7. from astropy.coordinates import representation as r\\n8. from astropy.coordinates.baseframe import BaseCoordinateFrame, RepresentationMapping, base_doc\\n9. from astropy.coordinates.attributes import (TimeAttribute,\\n10.                                             QuantityAttribute,\\n11.                                             EarthLocationAttribute)\\n12. \\n13. __all__ = [\\\'AltAz\\\']\\n14. \\n15. \\n16. _90DEG = 90*u.deg\\n17. \\n18. doc_components = """\\n19.     az : `~astropy.coordinates.Angle`, optional, keyword-only\\n20.         The Azimuth for this object (``alt`` must also be given and\\n21.         ``representation`` must be None).\\n22.     alt : `~astropy.coordinates.Angle`, optional, keyword-only\\n23.         The Altitude for this object (``az`` must also be given and\\n24.         ``representation`` must be None).\\n25.     distance : `~astropy.units.Quantity` [\\\'length\\\'], optional, keyword-only\\n26.         The Distance for this object along the line-of-sight.\\n27. \\n28.     pm_az_cosalt : `~astropy.units.Quantity` [\\\'angular speed\\\'], optional, keyword-only\\n29.         The proper motion in azimuth (including the ``cos(alt)`` factor) for\\n30.         this object (``pm_alt`` must also be given).\\n31.     pm_alt : `~astropy.units.Quantity` [\\\'angular speed\\\'], optional, keyword-only\\n32.         The proper motion in altitude for this object (``pm_az_cosalt`` must\\n33.         also be given).\\n34.     radial_velocity : `~astropy.units.Quantity` [\\\'speed\\\'], optional, keyword-only\\n35.         The radial velocity of this object."""\\n36. \\n37. doc_footer = """\\n38.     Other parameters\\n39.     ----------------\\n40.     obstime : `~astropy.time.Time`\\n41.         The time at which the observation is taken.  Used for determining the\\n42.         position and orientation of the Earth.\\n43.     location : `~astropy.coordinates.EarthLocation`\\n44.         The location on the Earth.  This can be specified either as an\\n45.         `~astropy.coordinates.EarthLocation` object or as anything that can be\\n46.         transformed to an `~astropy.coordinates.ITRS` frame.\\n47.     pressure : `~astropy.units.Quantity` [\\\'pressure\\\']\\n48.         The atmospheric pressure as an `~astropy.units.Quantity` with pressure\\n49.         units.  This is necessary for performing refraction corrections.\\n50.         Setting this to 0 (the default) will disable refraction calculations\\n51.         when transforming to/from this frame.\\n52.     temperature : `~astropy.units.Quantity` [\\\'temperature\\\']\\n53.         The ground-level temperature as an `~astropy.units.Quantity` in\\n54.         deg C.  This is necessary for performing refraction corrections.\\n55.     relative_humidity : `~astropy.units.Quantity` [\\\'dimensionless\\\'] or number\\n56.         The relative humidity as a dimensionless quantity between 0 to 1.\\n57.         This is necessary for performing refraction corrections.\\n58.     obswl : `~astropy.units.Quantity` [\\\'length\\\']\\n59.         The average wavelength of observations as an `~astropy.units.Quantity`\\n60.          with length units.  This is necessary for performing refraction\\n61.          corrections.\\n62. \\n63.     Notes\\n64.     -----\\n65.     The refraction model is based on that implemented in ERFA, which is fast\\n66.     but becomes inaccurate for altitudes below about 5 degrees.  Near and below\\n67.     altitudes of 0, it can even give meaningless answers, and in this case\\n68.     transforming to AltAz and back to another frame can give highly discrepant\\n69.     results.  For much better numerical stability, leave the ``pressure`` at\\n70.     ``0`` (the default), thereby disabling the refraction correction and\\n71.     yielding "topocentric" horizontal coordinates.\\n72.     """\\n73. \\n74. \\n75. @format_doc(base_doc, components=doc_components, footer=doc_footer)\\n76. class AltAz(BaseCoordinateFrame):\\n77.     """\\n78.     A coordinate or frame in the Altitude-Azimuth system (Horizontal\\n79.     coordinates) with respect to the WGS84 ellipsoid.  Azimuth is oriented\\n80.     East of North (i.e., N=0, E=90 degrees).  Altitude is also known as\\n81.     elevation angle, so this frame is also in the Azimuth-Elevation system.\\n82. \\n83.     This frame is assumed to *include* refraction effects if the ``pressure``\\n84.     frame attribute is non-zero.\\n85. \\n86.     The frame attributes are listed under **Other Parameters**, which are\\n87.     necessary for transforming from AltAz to some other system.\\n88.     """\\n89. \\n90.     frame_specific_representation_info = {\\n91.         r.SphericalRepresentation: [\\n92.             RepresentationMapping(\\\'lon\\\', \\\'az\\\'),\\n93.             RepresentationMapping(\\\'lat\\\', \\\'alt\\\')\\n94.         ]\\n95.     }\\n96. \\n97.     default_representation = r.SphericalRepresentation\\n98.     default_differential = r.SphericalCosLatDifferential\\n99. \\n100.     obstime = TimeAttribute(default=None)\\n101.     location = EarthLocationAttribute(default=None)\\n102.     pressure = QuantityAttribute(default=0, unit=u.hPa)\\n103.     temperature = QuantityAttribute(default=0, unit=u.deg_C)\\n104.     relative_humidity = QuantityAttribute(default=0, unit=u.dimensionless_unscaled)\\n105.     obswl = QuantityAttribute(default=1*u.micron, unit=u.micron)\\n106. \\n107.     def __init__(self, *args, **kwargs):\\n108.         super().__init__(*args, **kwargs)\\n109. \\n110.     @property\\n111.     def secz(self):\\n112.         """\\n113.         Secant of the zenith angle for this coordinate, a common estimate of\\n114.         the airmass.\\n115.         """\\n116.         return 1/np.sin(self.alt)\\n117. \\n118.     @property\\n119.     def zen(self):\\n120.         """\\n121.         The zenith angle (or zenith distance / co-altitude) for this coordinate.\\n122.         """\\n123.         return _90DEG.to(self.alt.unit) - self.alt\\n124. \\n125. \\n126. # self-transform defined in icrs_observed_transforms.py\', \'start_line_number\': 1, \'end_line_number\': 126}\n\n{\'relative_path\': \'astropy/coordinates/builtin_frames/hadec.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. from astropy import units as u\\n4. from astropy.utils.decorators import format_doc\\n5. from astropy.coordinates import representation as r\\n6. from astropy.coordinates.baseframe import BaseCoordinateFrame, RepresentationMapping, base_doc\\n7. from astropy.coordinates.attributes import (TimeAttribute,\\n8.                                             QuantityAttribute,\\n9.                                             EarthLocationAttribute)\\n10. \\n11. __all__ = [\\\'HADec\\\']\\n12. \\n13. \\n14. doc_components = """\\n15.     ha : `~astropy.coordinates.Angle`, optional, keyword-only\\n16.         The Hour Angle for this object (``dec`` must also be given and\\n17.         ``representation`` must be None).\\n18.     dec : `~astropy.coordinates.Angle`, optional, keyword-only\\n19.         The Declination for this object (``ha`` must also be given and\\n20.         ``representation`` must be None).\\n21.     distance : `~astropy.units.Quantity` [\\\'length\\\'], optional, keyword-only\\n22.         The Distance for this object along the line-of-sight.\\n23. \\n24.     pm_ha_cosdec : `~astropy.units.Quantity` [\\\'angular speed\\\'], optional, keyword-only\\n25.         The proper motion in hour angle (including the ``cos(dec)`` factor) for\\n26.         this object (``pm_dec`` must also be given).\\n27.     pm_dec : `~astropy.units.Quantity` [\\\'angular speed\\\'], optional, keyword-only\\n28.         The proper motion in declination for this object (``pm_ha_cosdec`` must\\n29.         also be given).\\n30.     radial_velocity : `~astropy.units.Quantity` [\\\'speed\\\'], optional, keyword-only\\n31.         The radial velocity of this object."""\\n32. \\n33. doc_footer = """\\n34.     Other parameters\\n35.     ----------------\\n36.     obstime : `~astropy.time.Time`\\n37.         The time at which the observation is taken.  Used for determining the\\n38.         position and orientation of the Earth.\\n39.     location : `~astropy.coordinates.EarthLocation`\\n40.         The location on the Earth.  This can be specified either as an\\n41.         `~astropy.coordinates.EarthLocation` object or as anything that can be\\n42.         transformed to an `~astropy.coordinates.ITRS` frame.\\n43.     pressure : `~astropy.units.Quantity` [\\\'pressure\\\']\\n44.         The atmospheric pressure as an `~astropy.units.Quantity` with pressure\\n45.         units.  This is necessary for performing refraction corrections.\\n46.         Setting this to 0 (the default) will disable refraction calculations\\n47.         when transforming to/from this frame.\\n48.     temperature : `~astropy.units.Quantity` [\\\'temperature\\\']\\n49.         The ground-level temperature as an `~astropy.units.Quantity` in\\n50.         deg C.  This is necessary for performing refraction corrections.\\n51.     relative_humidity : `~astropy.units.Quantity` [\\\'dimensionless\\\'] or number.\\n52.         The relative humidity as a dimensionless quantity between 0 to 1.\\n53.         This is necessary for performing refraction corrections.\\n54.     obswl : `~astropy.units.Quantity` [\\\'length\\\']\\n55.         The average wavelength of observations as an `~astropy.units.Quantity`\\n56.          with length units.  This is necessary for performing refraction\\n57.          corrections.\\n58. \\n59.     Notes\\n60.     -----\\n61.     The refraction model is based on that implemented in ERFA, which is fast\\n62.     but becomes inaccurate for altitudes below about 5 degrees.  Near and below\\n63.     altitudes of 0, it can even give meaningless answers, and in this case\\n64.     transforming to HADec and back to another frame can give highly discrepant\\n65.     results.  For much better numerical stability, leave the ``pressure`` at\\n66.     ``0`` (the default), thereby disabling the refraction correction and\\n67.     yielding "topocentric" equatorial coordinates.\\n68.     """\\n69. \\n70. \\n71. @format_doc(base_doc, components=doc_components, footer=doc_footer)\\n72. class HADec(BaseCoordinateFrame):\\n73.     """\\n74.     A coordinate or frame in the Hour Angle-Declination system (Equatorial\\n75.     coordinates) with respect to the WGS84 ellipsoid.  Hour Angle is oriented\\n76.     with respect to upper culmination such that the hour angle is negative to\\n77.     the East and positive to the West.\\n78. \\n79.     This frame is assumed to *include* refraction effects if the ``pressure``\\n80.     frame attribute is non-zero.\\n81. \\n82.     The frame attributes are listed under **Other Parameters**, which are\\n83.     necessary for transforming from HADec to some other system.\\n84.     """\\n85. \\n86.     frame_specific_representation_info = {\\n87.         r.SphericalRepresentation: [\\n88.             RepresentationMapping(\\\'lon\\\', \\\'ha\\\', u.hourangle),\\n89.             RepresentationMapping(\\\'lat\\\', \\\'dec\\\')\\n90.         ]\\n91.     }\\n92. \\n93.     default_representation = r.SphericalRepresentation\\n94.     default_differential = r.SphericalCosLatDifferential\\n95. \\n96.     obstime = TimeAttribute(default=None)\\n97.     location = EarthLocationAttribute(default=None)\\n98.     pressure = QuantityAttribute(default=0, unit=u.hPa)\\n99.     temperature = QuantityAttribute(default=0, unit=u.deg_C)\\n100.     relative_humidity = QuantityAttribute(default=0, unit=u.dimensionless_unscaled)\\n101.     obswl = QuantityAttribute(default=1*u.micron, unit=u.micron)\\n102. \\n103.     def __init__(self, *args, **kwargs):\\n104.         super().__init__(*args, **kwargs)\\n105.         if self.has_data:\\n106.             self._set_data_lon_wrap_angle(self.data)\\n107. \\n108.     @staticmethod\\n109.     def _set_data_lon_wrap_angle(data):\\n110.         if hasattr(data, \\\'lon\\\'):\\n111.             data.lon.wrap_angle = 180. * u.deg\\n112.         return data\\n113. \\n114.     def represent_as(self, base, s=\\\'base\\\', in_frame_units=False):\\n115.         """\\n116.         Ensure the wrap angle for any spherical\\n117.         representations.\\n118.         """\\n119.         data = super().represent_as(base, s, in_frame_units=in_frame_units)\\n120.         self._set_data_lon_wrap_angle(data)\\n121.         return data\\n122. \\n123. \\n124. # self-transform defined in icrs_observed_transforms.py\', \'start_line_number\': 1, \'end_line_number\': 124}\n\n{\'relative_path\': \'astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """\\n3. Contains the transformation functions for getting to/from ITRS, TEME, GCRS, and CIRS.\\n4. These are distinct from the ICRS and AltAz functions because they are just\\n5. rotations without aberration corrections or offsets.\\n6. """\\n7. \\n8. import numpy as np\\n9. import erfa\\n10. \\n11. from astropy.coordinates.baseframe import frame_transform_graph\\n12. from astropy.coordinates.transformations import FunctionTransformWithFiniteDifference\\n13. from astropy.coordinates.matrix_utilities import matrix_transpose\\n14. \\n15. from .icrs import ICRS\\n16. from .gcrs import GCRS, PrecessedGeocentric\\n17. from .cirs import CIRS\\n18. from .itrs import ITRS\\n19. from .equatorial import TEME, TETE\\n20. from .utils import get_polar_motion, get_jd12, EARTH_CENTER\\n21. \\n22. # # first define helper functions\\n23. \\n24. \\n25. def teme_to_itrs_mat(time):\\n26.     # Sidereal time, rotates from ITRS to mean equinox\\n27.     # Use 1982 model for consistency with Vallado et al (2006)\\n28.     # http://www.celestrak.com/publications/aiaa/2006-6753/AIAA-2006-6753.pdf\\n29.     gst = erfa.gmst82(*get_jd12(time, \\\'ut1\\\'))\\n30. \\n31.     # Polar Motion\\n32.     # Do not include TIO locator s\\\' because it is not used in Vallado 2006\\n33.     xp, yp = get_polar_motion(time)\\n34.     pmmat = erfa.pom00(xp, yp, 0)\\n35. \\n36.     # rotation matrix\\n37.     # c2tcio expects a GCRS->CIRS matrix as it\\\'s first argument.\\n38.     # Here, we just set that to an I-matrix, because we\\\'re already\\n39.     # in TEME and the difference between TEME and CIRS is just the\\n40.     # rotation by the sidereal time rather than the Earth Rotation Angle\\n41.     return erfa.c2tcio(np.eye(3), gst, pmmat)\\n42. \\n43. \\n44. def gcrs_to_cirs_mat(time):\\n45.     # celestial-to-intermediate matrix\\n46.     return erfa.c2i06a(*get_jd12(time, \\\'tt\\\'))\\n47. \\n48. \\n49. def cirs_to_itrs_mat(time):\\n50.     # compute the polar motion p-matrix\\n51.     xp, yp = get_polar_motion(time)\\n52.     sp = erfa.sp00(*get_jd12(time, \\\'tt\\\'))\\n53.     pmmat = erfa.pom00(xp, yp, sp)\\n54. \\n55.     # now determine the Earth Rotation Angle for the input obstime\\n56.     # era00 accepts UT1, so we convert if need be\\n57.     era = erfa.era00(*get_jd12(time, \\\'ut1\\\'))\\n58. \\n59.     # c2tcio expects a GCRS->CIRS matrix, but we just set that to an I-matrix\\n60.     # because we\\\'re already in CIRS\\n61.     return erfa.c2tcio(np.eye(3), era, pmmat)\\n62. \\n63. \\n64. def tete_to_itrs_mat(time, rbpn=None):\\n65.     """Compute the polar motion p-matrix at the given time.\\n66. \\n67.     If the nutation-precession matrix is already known, it should be passed in,\\n68.     as this is by far the most expensive calculation.\\n69.     """\\n70.     xp, yp = get_polar_motion(time)\\n71.     sp = erfa.sp00(*get_jd12(time, \\\'tt\\\'))\\n72.     pmmat = erfa.pom00(xp, yp, sp)\\n73. \\n74.     # now determine the greenwich apparent siderial time for the input obstime\\n75.     # we use the 2006A model for consistency with RBPN matrix use in GCRS <-> TETE\\n76.     ujd1, ujd2 = get_jd12(time, \\\'ut1\\\')\\n77.     jd1, jd2 = get_jd12(time, \\\'tt\\\')\\n78.     if rbpn is None:\\n79.         # erfa.gst06a calls pnm06a to calculate rbpn and then gst06. Use it in\\n80.         # favour of getting rbpn with erfa.pnm06a to avoid a possibly large array.\\n81.         gast = erfa.gst06a(ujd1, ujd2, jd1, jd2)\\n82.     else:\\n83.         gast = erfa.gst06(ujd1, ujd2, jd1, jd2, rbpn)\\n84. \\n85.     # c2tcio expects a GCRS->CIRS matrix, but we just set that to an I-matrix\\n86.     # because we\\\'re already in CIRS equivalent frame\\n87.     return erfa.c2tcio(np.eye(3), gast, pmmat)\\n88. \\n89. \\n90. def gcrs_precession_mat(equinox):\\n91.     gamb, phib, psib, epsa = erfa.pfw06(*get_jd12(equinox, \\\'tt\\\'))\\n92.     return erfa.fw2m(gamb, phib, psib, epsa)\\n93. \\n94. \\n95. def get_location_gcrs(location, obstime, ref_to_itrs, gcrs_to_ref):\\n96.     """Create a GCRS frame at the location and obstime.\\n97. \\n98.     The reference frame z axis must point to the Celestial Intermediate Pole\\n99.     (as is the case for CIRS and TETE).\\n100. \\n101.     This function is here to avoid location.get_gcrs(obstime), which would\\n102.     recalculate matrices that are already available below (and return a GCRS\\n103.     coordinate, rather than a frame with obsgeoloc and obsgeovel).  Instead,\\n104.     it uses the private method that allows passing in the matrices.\\n105. \\n106.     """\\n107.     obsgeoloc, obsgeovel = location._get_gcrs_posvel(obstime,\\n108.                                                      ref_to_itrs, gcrs_to_ref)\\n109.     return GCRS(obstime=obstime, obsgeoloc=obsgeoloc, obsgeovel=obsgeovel)\\n110. \\n111. \\n112. # now the actual transforms\\n113. \\n114. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, GCRS, TETE)\\n115. def gcrs_to_tete(gcrs_coo, tete_frame):\\n116.     # Classical NPB matrix, IAU 2006/2000A\\n117.     # (same as in builtin_frames.utils.get_cip).\\n118.     rbpn = erfa.pnm06a(*get_jd12(tete_frame.obstime, \\\'tt\\\'))\\n119.     # Get GCRS coordinates for the target observer location and time.\\n120.     loc_gcrs = get_location_gcrs(tete_frame.location, tete_frame.obstime,\\n121.                                  tete_to_itrs_mat(tete_frame.obstime, rbpn=rbpn),\\n122.                                  rbpn)\\n123.     gcrs_coo2 = gcrs_coo.transform_to(loc_gcrs)\\n124.     # Now we are relative to the correct observer, do the transform to TETE.\\n125.     # These rotations are defined at the geocenter, but can be applied to\\n126.     # topocentric positions as well, assuming rigid Earth. See p57 of\\n127.     # https://www.usno.navy.mil/USNO/astronomical-applications/publications/Circular_179.pdf\\n128.     crepr = gcrs_coo2.cartesian.transform(rbpn)\\n129.     return tete_frame.realize_frame(crepr)\\n130. \\n131. \\n132. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, TETE, GCRS)\\n133. def tete_to_gcrs(tete_coo, gcrs_frame):\\n134.     # Compute the pn matrix, and then multiply by its transpose.\\n135.     rbpn = erfa.pnm06a(*get_jd12(tete_coo.obstime, \\\'tt\\\'))\\n136.     newrepr = tete_coo.cartesian.transform(matrix_transpose(rbpn))\\n137.     # We now have a GCRS vector for the input location and obstime.\\n138.     # Turn it into a GCRS frame instance.\\n139.     loc_gcrs = get_location_gcrs(tete_coo.location, tete_coo.obstime,\\n140.                                  tete_to_itrs_mat(tete_coo.obstime, rbpn=rbpn),\\n141.                                  rbpn)\\n142.     gcrs = loc_gcrs.realize_frame(newrepr)\\n143.     # Finally, do any needed offsets (no-op if same obstime and location)\\n144.     return gcrs.transform_to(gcrs_frame)\\n145. \\n146. \\n147. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, TETE, ITRS)\\n148. def tete_to_itrs(tete_coo, itrs_frame):\\n149.     # first get us to TETE at the target obstime, and geocentric position\\n150.     tete_coo2 = tete_coo.transform_to(TETE(obstime=itrs_frame.obstime,\\n151.                                            location=EARTH_CENTER))\\n152. \\n153.     # now get the pmatrix\\n154.     pmat = tete_to_itrs_mat(itrs_frame.obstime)\\n155.     crepr = tete_coo2.cartesian.transform(pmat)\\n156.     return itrs_frame.realize_frame(crepr)\\n157. \\n158. \\n159. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, TETE)\\n160. def itrs_to_tete(itrs_coo, tete_frame):\\n161.     # compute the pmatrix, and then multiply by its transpose\\n162.     pmat = tete_to_itrs_mat(itrs_coo.obstime)\\n163.     newrepr = itrs_coo.cartesian.transform(matrix_transpose(pmat))\\n164.     tete = TETE(newrepr, obstime=itrs_coo.obstime)\\n165. \\n166.     # now do any needed offsets (no-op if same obstime)\\n167.     return tete.transform_to(tete_frame)\\n168. \\n169. \\n170. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, GCRS, CIRS)\\n171. def gcrs_to_cirs(gcrs_coo, cirs_frame):\\n172.     # first get the pmatrix\\n173.     pmat = gcrs_to_cirs_mat(cirs_frame.obstime)\\n174.     # Get GCRS coordinates for the target observer location and time.\\n175.     loc_gcrs = get_location_gcrs(cirs_frame.location, cirs_frame.obstime,\\n176.                                  cirs_to_itrs_mat(cirs_frame.obstime), pmat)\\n177.     gcrs_coo2 = gcrs_coo.transform_to(loc_gcrs)\\n178.     # Now we are relative to the correct observer, do the transform to CIRS.\\n179.     crepr = gcrs_coo2.cartesian.transform(pmat)\\n180.     return cirs_frame.realize_frame(crepr)\\n181. \\n182. \\n183. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, CIRS, GCRS)\\n184. def cirs_to_gcrs(cirs_coo, gcrs_frame):\\n185.     # Compute the pmatrix, and then multiply by its transpose,\\n186.     pmat = gcrs_to_cirs_mat(cirs_coo.obstime)\\n187.     newrepr = cirs_coo.cartesian.transform(matrix_transpose(pmat))\\n188.     # We now have a GCRS vector for the input location and obstime.\\n189.     # Turn it into a GCRS frame instance.\\n190.     loc_gcrs = get_location_gcrs(cirs_coo.location, cirs_coo.obstime,\\n191.                                  cirs_to_itrs_mat(cirs_coo.obstime), pmat)\\n192.     gcrs = loc_gcrs.realize_frame(newrepr)\\n193.     # Finally, do any needed offsets (no-op if same obstime and location)\\n194.     return gcrs.transform_to(gcrs_frame)\\n195. \\n196. \\n197. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, CIRS, ITRS)\\n198. def cirs_to_itrs(cirs_coo, itrs_frame):\\n199.     # first get us to geocentric CIRS at the target obstime\\n200.     cirs_coo2 = cirs_coo.transform_to(CIRS(obstime=itrs_frame.obstime,\\n201.                                            location=EARTH_CENTER))\\n202. \\n203.     # now get the pmatrix\\n204.     pmat = cirs_to_itrs_mat(itrs_frame.obstime)\\n205.     crepr = cirs_coo2.cartesian.transform(pmat)\\n206.     return itrs_frame.realize_frame(crepr)\\n207. \\n208. \\n209. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, CIRS)\\n210. def itrs_to_cirs(itrs_coo, cirs_frame):\\n211.     # compute the pmatrix, and then multiply by its transpose\\n212.     pmat = cirs_to_itrs_mat(itrs_coo.obstime)\\n213.     newrepr = itrs_coo.cartesian.transform(matrix_transpose(pmat))\\n214.     cirs = CIRS(newrepr, obstime=itrs_coo.obstime)\\n215. \\n216.     # now do any needed offsets (no-op if same obstime)\\n217.     return cirs.transform_to(cirs_frame)\\n218. \\n219. \\n220. # TODO: implement GCRS<->CIRS if there\\\'s call for it.  The thing that\\\'s awkward\\n221. # is that they both have obstimes, so an extra set of transformations are necessary.\\n222. # so unless there\\\'s a specific need for that, better to just have it go through the above\\n223. # two steps anyway\\n224. \\n225. \\n226. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, GCRS, PrecessedGeocentric)\\n227. def gcrs_to_precessedgeo(from_coo, to_frame):\\n228.     # first get us to GCRS with the right attributes (might be a no-op)\\n229.     gcrs_coo = from_coo.transform_to(GCRS(obstime=to_frame.obstime,\\n230.                                           obsgeoloc=to_frame.obsgeoloc,\\n231.                                           obsgeovel=to_frame.obsgeovel))\\n232. \\n233.     # now precess to the requested equinox\\n234.     pmat = gcrs_precession_mat(to_frame.equinox)\\n235.     crepr = gcrs_coo.cartesian.transform(pmat)\\n236.     return to_frame.realize_frame(crepr)\\n237. \\n238. \\n239. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, PrecessedGeocentric, GCRS)\\n240. def precessedgeo_to_gcrs(from_coo, to_frame):\\n241.     # first un-precess\\n242.     pmat = gcrs_precession_mat(from_coo.equinox)\\n243.     crepr = from_coo.cartesian.transform(matrix_transpose(pmat))\\n244.     gcrs_coo = GCRS(crepr,\\n245.                     obstime=from_coo.obstime,\\n246.                     obsgeoloc=from_coo.obsgeoloc,\\n247.                     obsgeovel=from_coo.obsgeovel)\\n248. \\n249.     # then move to the GCRS that\\\'s actually desired\\n250.     return gcrs_coo.transform_to(to_frame)\\n251. \\n252. \\n253. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, TEME, ITRS)\\n254. def teme_to_itrs(teme_coo, itrs_frame):\\n255.     # use the pmatrix to transform to ITRS in the source obstime\\n256.     pmat = teme_to_itrs_mat(teme_coo.obstime)\\n257.     crepr = teme_coo.cartesian.transform(pmat)\\n258.     itrs = ITRS(crepr, obstime=teme_coo.obstime)\\n259. \\n260.     # transform the ITRS coordinate to the target obstime\\n261.     return itrs.transform_to(itrs_frame)\\n262. \\n263. \\n264. @frame_transform_graph.transform(FunctionTransformWithFiniteDifference, ITRS, TEME)\\n265. def itrs_to_teme(itrs_coo, teme_frame):\\n266.     # transform the ITRS coordinate to the target obstime\\n267.     itrs_coo2 = itrs_coo.transform_to(ITRS(obstime=teme_frame.obstime))\\n268. \\n269.     # compute the pmatrix, and then multiply by its transpose\\n270.     pmat = teme_to_itrs_mat(teme_frame.obstime)\\n271.     newrepr = itrs_coo2.cartesian.transform(matrix_transpose(pmat))\\n272.     return teme_frame.realize_frame(newrepr)\\n273. \\n274. \\n275. # Create loopback transformations\\n276. frame_transform_graph._add_merged_transform(ITRS, CIRS, ITRS)\\n277. frame_transform_graph._add_merged_transform(PrecessedGeocentric, GCRS, PrecessedGeocentric)\\n278. frame_transform_graph._add_merged_transform(TEME, ITRS, TEME)\\n279. frame_transform_graph._add_merged_transform(TETE, ICRS, TETE)\', \'start_line_number\': 1, \'end_line_number\': 279}\n\n{\'relative_path\': \'astropy/coordinates/builtin_frames/itrs.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. from astropy.utils.decorators import format_doc\\n4. from astropy.coordinates.representation import CartesianRepresentation, CartesianDifferential\\n5. from astropy.coordinates.baseframe import BaseCoordinateFrame, base_doc\\n6. from astropy.coordinates.attributes import TimeAttribute\\n7. from .utils import DEFAULT_OBSTIME\\n8. \\n9. __all__ = [\\\'ITRS\\\']\\n10. \\n11. \\n12. @format_doc(base_doc, components="", footer="")\\n13. class ITRS(BaseCoordinateFrame):\\n14.     """\\n15.     A coordinate or frame in the International Terrestrial Reference System\\n16.     (ITRS).  This is approximately a geocentric system, although strictly it is\\n17.     defined by a series of reference locations near the surface of the Earth.\\n18.     For more background on the ITRS, see the references provided in the\\n19.     :ref:`astropy:astropy-coordinates-seealso` section of the documentation.\\n20.     """\\n21. \\n22.     default_representation = CartesianRepresentation\\n23.     default_differential = CartesianDifferential\\n24. \\n25.     obstime = TimeAttribute(default=DEFAULT_OBSTIME)\\n26. \\n27.     @property\\n28.     def earth_location(self):\\n29.         """\\n30.         The data in this frame as an `~astropy.coordinates.EarthLocation` class.\\n31.         """\\n32.         from astropy.coordinates.earth import EarthLocation\\n33. \\n34.         cart = self.represent_as(CartesianRepresentation)\\n35.         return EarthLocation(x=cart.x, y=cart.y, z=cart.z)\\n36. \\n37. # Self-transform is in intermediate_rotation_transforms.py with all the other\\n38. # ITRS transforms\', \'start_line_number\': 1, \'end_line_number\': 38}\n\n{\'relative_path\': \'astropy/coordinates/builtin_frames/utils.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """\\n3. This module contains functions/values used repeatedly in different modules of\\n4. the ``builtin_frames`` package.\\n5. """\\n6. \\n7. import warnings\\n8. \\n9. import erfa\\n10. import numpy as np\\n11. \\n12. from astropy import units as u\\n13. from astropy.time import Time\\n14. from astropy.coordinates.earth import EarthLocation\\n15. from astropy.utils import iers\\n16. from astropy.utils.exceptions import AstropyWarning\\n17. from ..representation import CartesianDifferential\\n18. \\n19. \\n20. # We use tt as the time scale for this equinoxes, primarily because it is the\\n21. # convention for J2000 (it is unclear if there is any "right answer" for B1950)\\n22. # while #8600 makes this the default behavior, we show it here to ensure it\\\'s\\n23. # clear which is used here\\n24. EQUINOX_J2000 = Time(\\\'J2000\\\', scale=\\\'tt\\\')\\n25. EQUINOX_B1950 = Time(\\\'B1950\\\', scale=\\\'tt\\\')\\n26. \\n27. # This is a time object that is the default "obstime" when such an attribute is\\n28. # necessary.  Currently, we use J2000.\\n29. DEFAULT_OBSTIME = Time(\\\'J2000\\\', scale=\\\'tt\\\')\\n30. \\n31. # This is an EarthLocation that is the default "location" when such an attribute is\\n32. # necessary. It is the centre of the Earth.\\n33. EARTH_CENTER = EarthLocation(0*u.km, 0*u.km, 0*u.km)\\n34. \\n35. PIOVER2 = np.pi / 2.\\n36. \\n37. # comes from the mean of the 1962-2014 IERS B data\\n38. _DEFAULT_PM = (0.035, 0.29)*u.arcsec\\n39. \\n40. \\n41. def get_polar_motion(time):\\n42.     """\\n43.     gets the two polar motion components in radians for use with apio\\n44.     """\\n45.     # Get the polar motion from the IERS table\\n46.     iers_table = iers.earth_orientation_table.get()\\n47.     xp, yp, status = iers_table.pm_xy(time, return_status=True)\\n48. \\n49.     wmsg = (\\n50.         \\\'Tried to get polar motions for times {} IERS data is \\\'\\n51.         \\\'valid. Defaulting to polar motion from the 50-yr mean for those. \\\'\\n52.         \\\'This may affect precision at the arcsec level. Please check your \\\'\\n53.         \\\'astropy.utils.iers.conf.iers_auto_url and point it to a newer \\\'\\n54.         \\\'version if necessary.\\\'\\n55.     )\\n56.     if np.any(status == iers.TIME_BEFORE_IERS_RANGE):\\n57.         xp[status == iers.TIME_BEFORE_IERS_RANGE] = _DEFAULT_PM[0]\\n58.         yp[status == iers.TIME_BEFORE_IERS_RANGE] = _DEFAULT_PM[1]\\n59. \\n60.         warnings.warn(wmsg.format(\\\'before\\\'), AstropyWarning)\\n61. \\n62.     if np.any(status == iers.TIME_BEYOND_IERS_RANGE):\\n63. \\n64.         xp[status == iers.TIME_BEYOND_IERS_RANGE] = _DEFAULT_PM[0]\\n65.         yp[status == iers.TIME_BEYOND_IERS_RANGE] = _DEFAULT_PM[1]\\n66. \\n67.         warnings.warn(wmsg.format(\\\'after\\\'), AstropyWarning)\\n68. \\n69.     return xp.to_value(u.radian), yp.to_value(u.radian)\\n70. \\n71. \\n72. def _warn_iers(ierserr):\\n73.     """\\n74.     Generate a warning for an IERSRangeerror\\n75. \\n76.     Parameters\\n77.     ----------\\n78.     ierserr : An `~astropy.utils.iers.IERSRangeError`\\n79.     """\\n80.     msg = \\\'{0} Assuming UT1-UTC=0 for coordinate transformations.\\\'\\n81.     warnings.warn(msg.format(ierserr.args[0]), AstropyWarning)\\n82. \\n83. \\n84. def get_dut1utc(time):\\n85.     """\\n86.     This function is used to get UT1-UTC in coordinates because normally it\\n87.     gives an error outside the IERS range, but in coordinates we want to allow\\n88.     it to go through but with a warning.\\n89.     """\\n90.     try:\\n91.         return time.delta_ut1_utc\\n92.     except iers.IERSRangeError as e:\\n93.         _warn_iers(e)\\n94.         return np.zeros(time.shape)\\n95. \\n96. \\n97. def get_jd12(time, scale):\\n98.     """\\n99.     Gets ``jd1`` and ``jd2`` from a time object in a particular scale.\\n100. \\n101.     Parameters\\n102.     ----------\\n103.     time : `~astropy.time.Time`\\n104.         The time to get the jds for\\n105.     scale : str\\n106.         The time scale to get the jds for\\n107. \\n108.     Returns\\n109.     -------\\n110.     jd1 : float\\n111.     jd2 : float\\n112.     """\\n113.     if time.scale == scale:\\n114.         newtime = time\\n115.     else:\\n116.         try:\\n117.             newtime = getattr(time, scale)\\n118.         except iers.IERSRangeError as e:\\n119.             _warn_iers(e)\\n120.             newtime = time\\n121. \\n122.     return newtime.jd1, newtime.jd2\\n123. \\n124. \\n125. def norm(p):\\n126.     """\\n127.     Normalise a p-vector.\\n128.     """\\n129.     return p / np.sqrt(np.einsum(\\\'...i,...i\\\', p, p))[..., np.newaxis]\\n130. \\n131. \\n132. def pav2pv(p, v):\\n133.     """\\n134.     Combine p- and v- vectors into a pv-vector.\\n135.     """\\n136.     pv = np.empty(np.broadcast(p, v).shape[:-1], erfa.dt_pv)\\n137.     pv[\\\'p\\\'] = p\\n138.     pv[\\\'v\\\'] = v\\n139.     return pv\\n140. \\n141. \\n142. def get_cip(jd1, jd2):\\n143.     """\\n144.     Find the X, Y coordinates of the CIP and the CIO locator, s.\\n145. \\n146.     Parameters\\n147.     ----------\\n148.     jd1 : float or `np.ndarray`\\n149.         First part of two part Julian date (TDB)\\n150.     jd2 : float or `np.ndarray`\\n151.         Second part of two part Julian date (TDB)\\n152. \\n153.     Returns\\n154.     -------\\n155.     x : float or `np.ndarray`\\n156.         x coordinate of the CIP\\n157.     y : float or `np.ndarray`\\n158.         y coordinate of the CIP\\n159.     s : float or `np.ndarray`\\n160.         CIO locator, s\\n161.     """\\n162.     # classical NPB matrix, IAU 2006/2000A\\n163.     rpnb = erfa.pnm06a(jd1, jd2)\\n164.     # CIP X, Y coordinates from array\\n165.     x, y = erfa.bpn2xy(rpnb)\\n166.     # CIO locator, s\\n167.     s = erfa.s06(jd1, jd2, x, y)\\n168.     return x, y, s\\n169. \\n170. \\n171. def aticq(srepr, astrom):\\n172.     """\\n173.     A slightly modified version of the ERFA function ``eraAticq``.\\n174. \\n175.     ``eraAticq`` performs the transformations between two coordinate systems,\\n176.     with the details of the transformation being encoded into the ``astrom`` array.\\n177. \\n178.     There are two issues with the version of aticq in ERFA. Both are associated\\n179.     with the handling of light deflection.\\n180. \\n181.     The companion function ``eraAtciqz`` is meant to be its inverse. However, this\\n182.     is not true for directions close to the Solar centre, since the light deflection\\n183.     calculations are numerically unstable and therefore not reversible.\\n184. \\n185.     This version sidesteps that problem by artificially reducing the light deflection\\n186.     for directions which are within 90 arcseconds of the Sun\\\'s position. This is the\\n187.     same approach used by the ERFA functions above, except that they use a threshold of\\n188.     9 arcseconds.\\n189. \\n190.     In addition, ERFA\\\'s aticq assumes a distant source, so there is no difference between\\n191.     the object-Sun vector and the observer-Sun vector. This can lead to errors of up to a\\n192.     few arcseconds in the worst case (e.g a Venus transit).\\n193. \\n194.     Parameters\\n195.     ----------\\n196.     srepr : `~astropy.coordinates.SphericalRepresentation`\\n197.         Astrometric GCRS or CIRS position of object from observer\\n198.     astrom : eraASTROM array\\n199.         ERFA astrometry context, as produced by, e.g. ``eraApci13`` or ``eraApcs13``\\n200. \\n201.     Returns\\n202.     -------\\n203.     rc : float or `~numpy.ndarray`\\n204.         Right Ascension in radians\\n205.     dc : float or `~numpy.ndarray`\\n206.         Declination in radians\\n207.     """\\n208.     # ignore parallax effects if no distance, or far away\\n209.     srepr_distance = srepr.distance\\n210.     ignore_distance = srepr_distance.unit == u.one\\n211. \\n212.     # RA, Dec to cartesian unit vectors\\n213.     pos = erfa.s2c(srepr.lon.radian, srepr.lat.radian)\\n214. \\n215.     # Bias-precession-nutation, giving GCRS proper direction.\\n216.     ppr = erfa.trxp(astrom[\\\'bpn\\\'], pos)\\n217. \\n218.     # Aberration, giving GCRS natural direction\\n219.     d = np.zeros_like(ppr)\\n220.     for j in range(2):\\n221.         before = norm(ppr-d)\\n222.         after = erfa.ab(before, astrom[\\\'v\\\'], astrom[\\\'em\\\'], astrom[\\\'bm1\\\'])\\n223.         d = after - before\\n224.     pnat = norm(ppr-d)\\n225. \\n226.     # Light deflection by the Sun, giving BCRS coordinate direction\\n227.     d = np.zeros_like(pnat)\\n228.     for j in range(5):\\n229.         before = norm(pnat-d)\\n230.         if ignore_distance:\\n231.             # No distance to object, assume a long way away\\n232.             q = before\\n233.         else:\\n234.             # Find BCRS direction of Sun to object.\\n235.             # astrom[\\\'eh\\\'] and astrom[\\\'em\\\'] contain Sun to observer unit vector,\\n236.             # and distance, respectively.\\n237.             eh = astrom[\\\'em\\\'][..., np.newaxis] * astrom[\\\'eh\\\']\\n238.             # unit vector from Sun to object\\n239.             q = eh + srepr_distance[..., np.newaxis].to_value(u.au) * before\\n240.             sundist, q = erfa.pn(q)\\n241.             sundist = sundist[..., np.newaxis]\\n242.             # calculation above is extremely unstable very close to the sun\\n243.             # in these situations, default back to ldsun-style behaviour,\\n244.             # since this is reversible and drops to zero within stellar limb\\n245.             q = np.where(sundist > 1.0e-10, q, before)\\n246. \\n247.         after = erfa.ld(1.0, before, q, astrom[\\\'eh\\\'], astrom[\\\'em\\\'], 1e-6)\\n248.         d = after - before\\n249.     pco = norm(pnat-d)\\n250. \\n251.     # ICRS astrometric RA, Dec\\n252.     rc, dc = erfa.c2s(pco)\\n253.     return erfa.anp(rc), dc\\n254. \\n255. \\n256. def atciqz(srepr, astrom):\\n257.     """\\n258.     A slightly modified version of the ERFA function ``eraAtciqz``.\\n259. \\n260.     ``eraAtciqz`` performs the transformations between two coordinate systems,\\n261.     with the details of the transformation being encoded into the ``astrom`` array.\\n262. \\n263.     There are two issues with the version of atciqz in ERFA. Both are associated\\n264.     with the handling of light deflection.\\n265. \\n266.     The companion function ``eraAticq`` is meant to be its inverse. However, this\\n267.     is not true for directions close to the Solar centre, since the light deflection\\n268.     calculations are numerically unstable and therefore not reversible.\\n269. \\n270.     This version sidesteps that problem by artificially reducing the light deflection\\n271.     for directions which are within 90 arcseconds of the Sun\\\'s position. This is the\\n272.     same approach used by the ERFA functions above, except that they use a threshold of\\n273.     9 arcseconds.\\n274. \\n275.     In addition, ERFA\\\'s atciqz assumes a distant source, so there is no difference between\\n276.     the object-Sun vector and the observer-Sun vector. This can lead to errors of up to a\\n277.     few arcseconds in the worst case (e.g a Venus transit).\\n278. \\n279.     Parameters\\n280.     ----------\\n281.     srepr : `~astropy.coordinates.SphericalRepresentation`\\n282.         Astrometric ICRS position of object from observer\\n283.     astrom : eraASTROM array\\n284.         ERFA astrometry context, as produced by, e.g. ``eraApci13`` or ``eraApcs13``\\n285. \\n286.     Returns\\n287.     -------\\n288.     ri : float or `~numpy.ndarray`\\n289.         Right Ascension in radians\\n290.     di : float or `~numpy.ndarray`\\n291.         Declination in radians\\n292.     """\\n293.     # ignore parallax effects if no distance, or far away\\n294.     srepr_distance = srepr.distance\\n295.     ignore_distance = srepr_distance.unit == u.one\\n296. \\n297.     # BCRS coordinate direction (unit vector).\\n298.     pco = erfa.s2c(srepr.lon.radian, srepr.lat.radian)\\n299. \\n300.     # Find BCRS direction of Sun to object\\n301.     if ignore_distance:\\n302.         # No distance to object, assume a long way away\\n303.         q = pco\\n304.     else:\\n305.         # Find BCRS direction of Sun to object.\\n306.         # astrom[\\\'eh\\\'] and astrom[\\\'em\\\'] contain Sun to observer unit vector,\\n307.         # and distance, respectively.\\n308.         eh = astrom[\\\'em\\\'][..., np.newaxis] * astrom[\\\'eh\\\']\\n309.         # unit vector from Sun to object\\n310.         q = eh + srepr_distance[..., np.newaxis].to_value(u.au) * pco\\n311.         sundist, q = erfa.pn(q)\\n312.         sundist = sundist[..., np.newaxis]\\n313.         # calculation above is extremely unstable very close to the sun\\n314.         # in these situations, default back to ldsun-style behaviour,\\n315.         # since this is reversible and drops to zero within stellar limb\\n316.         q = np.where(sundist > 1.0e-10, q, pco)\\n317. \\n318.     # Light deflection by the Sun, giving BCRS natural direction.\\n319.     pnat = erfa.ld(1.0, pco, q, astrom[\\\'eh\\\'], astrom[\\\'em\\\'], 1e-6)\\n320. \\n321.     # Aberration, giving GCRS proper direction.\\n322.     ppr = erfa.ab(pnat, astrom[\\\'v\\\'], astrom[\\\'em\\\'], astrom[\\\'bm1\\\'])\\n323. \\n324.     # Bias-precession-nutation, giving CIRS proper direction.\\n325.     # Has no effect if matrix is identity matrix, in which case gives GCRS ppr.\\n326.     pi = erfa.rxp(astrom[\\\'bpn\\\'], ppr)\\n327. \\n328.     # CIRS (GCRS) RA, Dec\\n329.     ri, di = erfa.c2s(pi)\\n330.     return erfa.anp(ri), di\\n331. \\n332. \\n333. def prepare_earth_position_vel(time):\\n334.     """\\n335.     Get barycentric position and velocity, and heliocentric position of Earth\\n336. \\n337.     Parameters\\n338.     ----------\\n339.     time : `~astropy.time.Time`\\n340.         time at which to calculate position and velocity of Earth\\n341. \\n342.     Returns\\n343.     -------\\n344.     earth_pv : `np.ndarray`\\n345.         Barycentric position and velocity of Earth, in au and au/day\\n346.     earth_helio : `np.ndarray`\\n347.         Heliocentric position of Earth in au\\n348.     """\\n349.     # this goes here to avoid circular import errors\\n350.     from astropy.coordinates.solar_system import (\\n351.         get_body_barycentric,\\n352.         get_body_barycentric_posvel,\\n353.         solar_system_ephemeris,\\n354.     )\\n355.     # get barycentric position and velocity of earth\\n356. \\n357.     ephemeris = solar_system_ephemeris.get()\\n358. \\n359.     # if we are using the builtin erfa based ephemeris,\\n360.     # we can use the fact that epv00 already provides all we need.\\n361.     # This avoids calling epv00 twice, once\\n362.     # in get_body_barycentric_posvel(\\\'earth\\\') and once in\\n363.     # get_body_barycentric(\\\'sun\\\')\\n364.     if ephemeris == \\\'builtin\\\':\\n365.         jd1, jd2 = get_jd12(time, \\\'tdb\\\')\\n366.         earth_pv_heliocentric, earth_pv = erfa.epv00(jd1, jd2)\\n367.         earth_heliocentric = earth_pv_heliocentric[\\\'p\\\']\\n368. \\n369.     # all other ephemeris providers probably don\\\'t have a shortcut like this\\n370.     else:\\n371.         earth_p, earth_v = get_body_barycentric_posvel(\\\'earth\\\', time)\\n372. \\n373.         # get heliocentric position of earth, preparing it for passing to erfa.\\n374.         sun = get_body_barycentric(\\\'sun\\\', time)\\n375.         earth_heliocentric = (earth_p - sun).get_xyz(xyz_axis=-1).to_value(u.au)\\n376. \\n377.         # Also prepare earth_pv for passing to erfa, which wants it as\\n378.         # a structured dtype.\\n379.         earth_pv = pav2pv(\\n380.             earth_p.get_xyz(xyz_axis=-1).to_value(u.au),\\n381.             earth_v.get_xyz(xyz_axis=-1).to_value(u.au / u.d)\\n382.         )\\n383. \\n384.     return earth_pv, earth_heliocentric\\n385. \\n386. \\n387. def get_offset_sun_from_barycenter(time, include_velocity=False, reverse=False):\\n388.     """\\n389.     Returns the offset of the Sun center from the solar-system barycenter (SSB).\\n390. \\n391.     Parameters\\n392.     ----------\\n393.     time : `~astropy.time.Time`\\n394.         Time at which to calculate the offset\\n395.     include_velocity : `bool`\\n396.         If ``True``, attach the velocity as a differential.  Defaults to ``False``.\\n397.     reverse : `bool`\\n398.         If ``True``, return the offset of the barycenter from the Sun.  Defaults to ``False``.\\n399. \\n400.     Returns\\n401.     -------\\n402.     `~astropy.coordinates.CartesianRepresentation`\\n403.         The offset\\n404.     """\\n405.     if include_velocity:\\n406.         # Import here to avoid a circular import\\n407.         from astropy.coordinates.solar_system import get_body_barycentric_posvel\\n408.         offset_pos, offset_vel = get_body_barycentric_posvel(\\\'sun\\\', time)\\n409.         if reverse:\\n410.             offset_pos, offset_vel = -offset_pos, -offset_vel\\n411.         offset_vel = offset_vel.represent_as(CartesianDifferential)\\n412.         offset_pos = offset_pos.with_differentials(offset_vel)\\n413. \\n414.     else:\\n415.         # Import here to avoid a circular import\\n416.         from astropy.coordinates.solar_system import get_body_barycentric\\n417.         offset_pos = get_body_barycentric(\\\'sun\\\', time)\\n418.         if reverse:\\n419.             offset_pos = -offset_pos\\n420. \\n421.     return offset_pos\', \'start_line_number\': 1, \'end_line_number\': 421}\n\n{\'relative_path\': \'astropy/coordinates/earth.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. from warnings import warn\\n4. import collections\\n5. import socket\\n6. import json\\n7. import urllib.request\\n8. import urllib.error\\n9. import urllib.parse\\n10. \\n11. import numpy as np\\n12. import erfa\\n13. \\n14. from astropy import units as u\\n15. from astropy import constants as consts\\n16. from astropy.units.quantity import QuantityInfoBase\\n17. from astropy.utils import data\\n18. from astropy.utils.decorators import format_doc\\n19. from astropy.utils.exceptions import AstropyUserWarning\\n20. \\n21. from .angles import Angle, Longitude, Latitude\\n22. from .representation import (BaseRepresentation, CartesianRepresentation,\\n23.                              CartesianDifferential)\\n24. from .matrix_utilities import matrix_transpose\\n25. from .errors import UnknownSiteException\\n26. \\n27. \\n28. __all__ = [\\\'EarthLocation\\\', \\\'BaseGeodeticRepresentation\\\',\\n29.            \\\'WGS84GeodeticRepresentation\\\', \\\'WGS72GeodeticRepresentation\\\',\\n30.            \\\'GRS80GeodeticRepresentation\\\']\\n31. \\n32. GeodeticLocation = collections.namedtuple(\\\'GeodeticLocation\\\', [\\\'lon\\\', \\\'lat\\\', \\\'height\\\'])\\n33. \\n34. ELLIPSOIDS = {}\\n35. """Available ellipsoids (defined in erfam.h, with numbers exposed in erfa)."""\\n36. # Note: they get filled by the creation of the geodetic classes.\\n37. \\n38. OMEGA_EARTH = ((1.002_737_811_911_354_48 * u.cycle/u.day)\\n39.                .to(1/u.s, u.dimensionless_angles()))\\n40. """\\n41. Rotational velocity of Earth, following SOFA\\\'s pvtob.\\n42. \\n43. In UT1 seconds, this would be 2 pi / (24 * 3600), but we need the value\\n44. in SI seconds, so multiply by the ratio of stellar to solar day.\\n45. See Explanatory Supplement to the Astronomical Almanac, ed. P. Kenneth\\n46. Seidelmann (1992), University Science Books. The constant is the\\n47. conventional, exact one (IERS conventions 2003); see\\n48. http://hpiers.obspm.fr/eop-pc/index.php?index=constants.\\n49. """\\n50. \\n51. \\n52. def _check_ellipsoid(ellipsoid=None, default=\\\'WGS84\\\'):\\n53.     if ellipsoid is None:\\n54.         ellipsoid = default\\n55.     if ellipsoid not in ELLIPSOIDS:\\n56.         raise ValueError(f\\\'Ellipsoid {ellipsoid} not among known ones ({ELLIPSOIDS})\\\')\\n57.     return ellipsoid\\n58. \\n59. \\n60. def _get_json_result(url, err_str, use_google):\\n61. \\n62.     # need to do this here to prevent a series of complicated circular imports\\n63.     from .name_resolve import NameResolveError\\n64.     try:\\n65.         # Retrieve JSON response from Google maps API\\n66.         resp = urllib.request.urlopen(url, timeout=data.conf.remote_timeout)\\n67.         resp_data = json.loads(resp.read().decode(\\\'utf8\\\'))\\n68. \\n69.     except urllib.error.URLError as e:\\n70.         # This catches a timeout error, see:\\n71.         #   http://stackoverflow.com/questions/2712524/handling-urllib2s-timeout-python\\n72.         if isinstance(e.reason, socket.timeout):\\n73.             raise NameResolveError(err_str.format(msg="connection timed out")) from e\\n74.         else:\\n75.             raise NameResolveError(err_str.format(msg=e.reason)) from e\\n76. \\n77.     except socket.timeout:\\n78.         # There are some cases where urllib2 does not catch socket.timeout\\n79.         # especially while receiving response data on an already previously\\n80.         # working request\\n81.         raise NameResolveError(err_str.format(msg="connection timed out"))\\n82. \\n83.     if use_google:\\n84.         results = resp_data.get(\\\'results\\\', [])\\n85. \\n86.         if resp_data.get(\\\'status\\\', None) != \\\'OK\\\':\\n87.             raise NameResolveError(err_str.format(msg="unknown failure with "\\n88.                                                   "Google API"))\\n89. \\n90.     else:  # OpenStreetMap returns a list\\n91.         results = resp_data\\n92. \\n93.     if not results:\\n94.         raise NameResolveError(err_str.format(msg="no results returned"))\\n95. \\n96.     return results\\n97. \\n98. \\n99. class EarthLocationInfo(QuantityInfoBase):\\n100.     """\\n101.     Container for meta information like name, description, format.  This is\\n102.     required when the object is used as a mixin column within a table, but can\\n103.     be used as a general way to store meta information.\\n104.     """\\n105.     _represent_as_dict_attrs = (\\\'x\\\', \\\'y\\\', \\\'z\\\', \\\'ellipsoid\\\')\\n106. \\n107.     def _construct_from_dict(self, map):\\n108.         # Need to pop ellipsoid off and update post-instantiation.  This is\\n109.         # on the to-fix list in #4261.\\n110.         ellipsoid = map.pop(\\\'ellipsoid\\\')\\n111.         out = self._parent_cls(**map)\\n112.         out.ellipsoid = ellipsoid\\n113.         return out\\n114. \\n115.     def new_like(self, cols, length, metadata_conflicts=\\\'warn\\\', name=None):\\n116.         """\\n117.         Return a new EarthLocation instance which is consistent with the\\n118.         input ``cols`` and has ``length`` rows.\\n119. \\n120.         This is intended for creating an empty column object whose elements can\\n121.         be set in-place for table operations like join or vstack.\\n122. \\n123.         Parameters\\n124.         ----------\\n125.         cols : list\\n126.             List of input columns\\n127.         length : int\\n128.             Length of the output column object\\n129.         metadata_conflicts : str (\\\'warn\\\'|\\\'error\\\'|\\\'silent\\\')\\n130.             How to handle metadata conflicts\\n131.         name : str\\n132.             Output column name\\n133. \\n134.         Returns\\n135.         -------\\n136.         col : EarthLocation (or subclass)\\n137.             Empty instance of this class consistent with ``cols``\\n138.         """\\n139.         # Very similar to QuantityInfo.new_like, but the creation of the\\n140.         # map is different enough that this needs its own rouinte.\\n141.         # Get merged info attributes shape, dtype, format, description.\\n142.         attrs = self.merge_cols_attributes(cols, metadata_conflicts, name,\\n143.                                            (\\\'meta\\\', \\\'format\\\', \\\'description\\\'))\\n144.         # The above raises an error if the dtypes do not match, but returns\\n145.         # just the string representation, which is not useful, so remove.\\n146.         attrs.pop(\\\'dtype\\\')\\n147.         # Make empty EarthLocation using the dtype and unit of the last column.\\n148.         # Use zeros so we do not get problems for possible conversion to\\n149.         # geodetic coordinates.\\n150.         shape = (length,) + attrs.pop(\\\'shape\\\')\\n151.         data = u.Quantity(np.zeros(shape=shape, dtype=cols[0].dtype),\\n152.                           unit=cols[0].unit, copy=False)\\n153.         # Get arguments needed to reconstruct class\\n154.         map = {key: (data[key] if key in \\\'xyz\\\' else getattr(cols[-1], key))\\n155.                for key in self._represent_as_dict_attrs}\\n156.         out = self._construct_from_dict(map)\\n157.         # Set remaining info attributes\\n158.         for attr, value in attrs.items():\\n159.             setattr(out.info, attr, value)\\n160. \\n161.         return out\\n162. \\n163. \\n164. class EarthLocation(u.Quantity):\\n165.     """\\n166.     Location on the Earth.\\n167. \\n168.     Initialization is first attempted assuming geocentric (x, y, z) coordinates\\n169.     are given; if that fails, another attempt is made assuming geodetic\\n170.     coordinates (longitude, latitude, height above a reference ellipsoid).\\n171.     When using the geodetic forms, Longitudes are measured increasing to the\\n172.     east, so west longitudes are negative. Internally, the coordinates are\\n173.     stored as geocentric.\\n174. \\n175.     To ensure a specific type of coordinates is used, use the corresponding\\n176.     class methods (`from_geocentric` and `from_geodetic`) or initialize the\\n177.     arguments with names (``x``, ``y``, ``z`` for geocentric; ``lon``, ``lat``,\\n178.     ``height`` for geodetic).  See the class methods for details.\\n179. \\n180. \\n181.     Notes\\n182.     -----\\n183.     This class fits into the coordinates transformation framework in that it\\n184.     encodes a position on the `~astropy.coordinates.ITRS` frame.  To get a\\n185.     proper `~astropy.coordinates.ITRS` object from this object, use the ``itrs``\\n186.     property.\\n187.     """\\n188. \\n189.     _ellipsoid = \\\'WGS84\\\'\\n190.     _location_dtype = np.dtype({\\\'names\\\': [\\\'x\\\', \\\'y\\\', \\\'z\\\'],\\n191.                                 \\\'formats\\\': [np.float64]*3})\\n192.     _array_dtype = np.dtype((np.float64, (3,)))\\n193. \\n194.     info = EarthLocationInfo()\\n195. \\n196.     def __new__(cls, *args, **kwargs):\\n197.         # TODO: needs copy argument and better dealing with inputs.\\n198.         if (len(args) == 1 and len(kwargs) == 0 and\\n199.                 isinstance(args[0], EarthLocation)):\\n200.             return args[0].copy()\\n201.         try:\\n202.             self = cls.from_geocentric(*args, **kwargs)\\n203.         except (u.UnitsError, TypeError) as exc_geocentric:\\n204.             try:\\n205.                 self = cls.from_geodetic(*args, **kwargs)\\n206.             except Exception as exc_geodetic:\\n207.                 raise TypeError(\\\'Coordinates could not be parsed as either \\\'\\n208.                                 \\\'geocentric or geodetic, with respective \\\'\\n209.                                 \\\'exceptions "{}" and "{}"\\\'\\n210.                                 .format(exc_geocentric, exc_geodetic))\\n211.         return self\\n212. \\n213.     @classmethod\\n214.     def from_geocentric(cls, x, y, z, unit=None):\\n215.         """\\n216.         Location on Earth, initialized from geocentric coordinates.\\n217. \\n218.         Parameters\\n219.         ----------\\n220.         x, y, z : `~astropy.units.Quantity` or array-like\\n221.             Cartesian coordinates.  If not quantities, ``unit`` should be given.\\n222.         unit : unit-like or None\\n223.             Physical unit of the coordinate values.  If ``x``, ``y``, and/or\\n224.             ``z`` are quantities, they will be converted to this unit.\\n225. \\n226.         Raises\\n227.         ------\\n228.         astropy.units.UnitsError\\n229.             If the units on ``x``, ``y``, and ``z`` do not match or an invalid\\n230.             unit is given.\\n231.         ValueError\\n232.             If the shapes of ``x``, ``y``, and ``z`` do not match.\\n233.         TypeError\\n234.             If ``x`` is not a `~astropy.units.Quantity` and no unit is given.\\n235.         """\\n236.         if unit is None:\\n237.             try:\\n238.                 unit = x.unit\\n239.             except AttributeError:\\n240.                 raise TypeError("Geocentric coordinates should be Quantities "\\n241.                                 "unless an explicit unit is given.") from None\\n242.         else:\\n243.             unit = u.Unit(unit)\\n244. \\n245.         if unit.physical_type != \\\'length\\\':\\n246.             raise u.UnitsError("Geocentric coordinates should be in "\\n247.                                "units of length.")\\n248. \\n249.         try:\\n250.             x = u.Quantity(x, unit, copy=False)\\n251.             y = u.Quantity(y, unit, copy=False)\\n252.             z = u.Quantity(z, unit, copy=False)\\n253.         except u.UnitsError:\\n254.             raise u.UnitsError("Geocentric coordinate units should all be "\\n255.                                "consistent.")\\n256. \\n257.         x, y, z = np.broadcast_arrays(x, y, z)\\n258.         struc = np.empty(x.shape, cls._location_dtype)\\n259.         struc[\\\'x\\\'], struc[\\\'y\\\'], struc[\\\'z\\\'] = x, y, z\\n260.         return super().__new__(cls, struc, unit, copy=False)\\n261. \\n262.     @classmethod\\n263.     def from_geodetic(cls, lon, lat, height=0., ellipsoid=None):\\n264.         """\\n265.         Location on Earth, initialized from geodetic coordinates.\\n266. \\n267.         Parameters\\n268.         ----------\\n269.         lon : `~astropy.coordinates.Longitude` or float\\n270.             Earth East longitude.  Can be anything that initialises an\\n271.             `~astropy.coordinates.Angle` object (if float, in degrees).\\n272.         lat : `~astropy.coordinates.Latitude` or float\\n273.             Earth latitude.  Can be anything that initialises an\\n274.             `~astropy.coordinates.Latitude` object (if float, in degrees).\\n275.         height : `~astropy.units.Quantity` [\\\'length\\\'] or float, optional\\n276.             Height above reference ellipsoid (if float, in meters; default: 0).\\n277.         ellipsoid : str, optional\\n278.             Name of the reference ellipsoid to use (default: \\\'WGS84\\\').\\n279.             Available ellipsoids are:  \\\'WGS84\\\', \\\'GRS80\\\', \\\'WGS72\\\'.\\n280. \\n281.         Raises\\n282.         ------\\n283.         astropy.units.UnitsError\\n284.             If the units on ``lon`` and ``lat`` are inconsistent with angular\\n285.             ones, or that on ``height`` with a length.\\n286.         ValueError\\n287.             If ``lon``, ``lat``, and ``height`` do not have the same shape, or\\n288.             if ``ellipsoid`` is not recognized as among the ones implemented.\\n289. \\n290.         Notes\\n291.         -----\\n292.         For the conversion to geocentric coordinates, the ERFA routine\\n293.         ``gd2gc`` is used.  See https://github.com/liberfa/erfa\\n294.         """\\n295.         ellipsoid = _check_ellipsoid(ellipsoid, default=cls._ellipsoid)\\n296.         # As wrapping fails on readonly input, we do so manually\\n297.         lon = Angle(lon, u.degree, copy=False).wrap_at(180 * u.degree)\\n298.         lat = Latitude(lat, u.degree, copy=False)\\n299.         # don\\\'t convert to m by default, so we can use the height unit below.\\n300.         if not isinstance(height, u.Quantity):\\n301.             height = u.Quantity(height, u.m, copy=False)\\n302.         # get geocentric coordinates.\\n303.         geodetic = ELLIPSOIDS[ellipsoid](lon, lat, height, copy=False)\\n304.         xyz = geodetic.to_cartesian().get_xyz(xyz_axis=-1) << height.unit\\n305.         self = xyz.view(cls._location_dtype, cls).reshape(geodetic.shape)\\n306.         self._ellipsoid = ellipsoid\\n307.         return self\\n308. \\n309.     @classmethod\\n310.     def of_site(cls, site_name):\\n311.         """\\n312.         Return an object of this class for a known observatory/site by name.\\n313. \\n314.         This is intended as a quick convenience function to get basic site\\n315.         information, not a fully-featured exhaustive registry of observatories\\n316.         and all their properties.\\n317. \\n318.         Additional information about the site is stored in the ``.info.meta``\\n319.         dictionary of sites obtained using this method (see the examples below).\\n320. \\n321.         .. note::\\n322.             When this function is called, it will attempt to download site\\n323.             information from the astropy data server. If you would like a site\\n324.             to be added, issue a pull request to the\\n325.             `astropy-data repository <https://github.com/astropy/astropy-data>`_ .\\n326.             If a site cannot be found in the registry (i.e., an internet\\n327.             connection is not available), it will fall back on a built-in list,\\n328.             In the future, this bundled list might include a version-controlled\\n329.             list of canonical observatories extracted from the online version,\\n330.             but it currently only contains the Greenwich Royal Observatory as an\\n331.             example case.\\n332. \\n333.         Parameters\\n334.         ----------\\n335.         site_name : str\\n336.             Name of the observatory (case-insensitive).\\n337. \\n338.         Returns\\n339.         -------\\n340.         site : `~astropy.coordinates.EarthLocation` (or subclass) instance\\n341.             The location of the observatory. The returned class will be the same\\n342.             as this class.\\n343. \\n344.         Examples\\n345.         --------\\n346.         >>> from astropy.coordinates import EarthLocation\\n347.         >>> keck = EarthLocation.of_site(\\\'Keck Observatory\\\')  # doctest: +REMOTE_DATA\\n348.         >>> keck.geodetic  # doctest: +REMOTE_DATA +FLOAT_CMP\\n349.         GeodeticLocation(lon=<Longitude -155.47833333 deg>, lat=<Latitude 19.82833333 deg>, height=<Quantity 4160. m>)\\n350.         >>> keck.info  # doctest: +REMOTE_DATA\\n351.         name = W. M. Keck Observatory\\n352.         dtype = (float64, float64, float64)\\n353.         unit = m\\n354.         class = EarthLocation\\n355.         n_bad = 0\\n356.         >>> keck.info.meta  # doctest: +REMOTE_DATA\\n357.         {\\\'source\\\': \\\'IRAF Observatory Database\\\', \\\'timezone\\\': \\\'US/Hawaii\\\'}\\n358. \\n359.         See Also\\n360.         --------\\n361.         get_site_names : the list of sites that this function can access\\n362.         """  # noqa\\n363.         registry = cls._get_site_registry()\\n364.         try:\\n365.             el = registry[site_name]\\n366.         except UnknownSiteException as e:\\n367.             raise UnknownSiteException(e.site, \\\'EarthLocation.get_site_names\\\',\\n368.                                        close_names=e.close_names) from e\\n369. \\n370.         if cls is el.__class__:\\n371.             return el\\n372.         else:\\n373.             newel = cls.from_geodetic(*el.to_geodetic())\\n374.             newel.info.name = el.info.name\\n375.             return newel\\n376. \\n377.     @classmethod\\n378.     def of_address(cls, address, get_height=False, google_api_key=None):\\n379.         """\\n380.         Return an object of this class for a given address by querying either\\n381.         the OpenStreetMap Nominatim tool [1]_ (default) or the Google geocoding\\n382.         API [2]_, which requires a specified API key.\\n383. \\n384.         This is intended as a quick convenience function to get easy access to\\n385.         locations. If you need to specify a precise location, you should use the\\n386.         initializer directly and pass in a longitude, latitude, and elevation.\\n387. \\n388.         In the background, this just issues a web query to either of\\n389.         the APIs noted above. This is not meant to be abused! Both\\n390.         OpenStreetMap and Google use IP-based query limiting and will ban your\\n391.         IP if you send more than a few thousand queries per hour [2]_.\\n392. \\n393.         .. warning::\\n394.             If the query returns more than one location (e.g., searching on\\n395.             ``address=\\\'springfield\\\'``), this function will use the **first**\\n396.             returned location.\\n397. \\n398.         Parameters\\n399.         ----------\\n400.         address : str\\n401.             The address to get the location for. As per the Google maps API,\\n402.             this can be a fully specified street address (e.g., 123 Main St.,\\n403.             New York, NY) or a city name (e.g., Danbury, CT), or etc.\\n404.         get_height : bool, optional\\n405.             This only works when using the Google API! See the ``google_api_key``\\n406.             block below. Use the retrieved location to perform a second query to\\n407.             the Google maps elevation API to retrieve the height of the input\\n408.             address [3]_.\\n409.         google_api_key : str, optional\\n410.             A Google API key with the Geocoding API and (optionally) the\\n411.             elevation API enabled. See [4]_ for more information.\\n412. \\n413.         Returns\\n414.         -------\\n415.         location : `~astropy.coordinates.EarthLocation` (or subclass) instance\\n416.             The location of the input address.\\n417.             Will be type(this class)\\n418. \\n419.         References\\n420.         ----------\\n421.         .. [1] https://nominatim.openstreetmap.org/\\n422.         .. [2] https://developers.google.com/maps/documentation/geocoding/start\\n423.         .. [3] https://developers.google.com/maps/documentation/elevation/start\\n424.         .. [4] https://developers.google.com/maps/documentation/geocoding/get-api-key\\n425. \\n426.         """\\n427. \\n428.         use_google = google_api_key is not None\\n429. \\n430.         # Fail fast if invalid options are passed:\\n431.         if not use_google and get_height:\\n432.             raise ValueError(\\n433.                 \\\'Currently, `get_height` only works when using \\\'\\n434.                 \\\'the Google geocoding API, which requires passing \\\'\\n435.                 \\\'a Google API key with `google_api_key`. See: \\\'\\n436.                 \\\'https://developers.google.com/maps/documentation/geocoding/get-api-key \\\'\\n437.                 \\\'for information on obtaining an API key.\\\')\\n438. \\n439.         if use_google:  # Google\\n440.             pars = urllib.parse.urlencode({\\\'address\\\': address,\\n441.                                            \\\'key\\\': google_api_key})\\n442.             geo_url = f"https://maps.googleapis.com/maps/api/geocode/json?{pars}"\\n443. \\n444.         else:  # OpenStreetMap\\n445.             pars = urllib.parse.urlencode({\\\'q\\\': address,\\n446.                                            \\\'format\\\': \\\'json\\\'})\\n447.             geo_url = f"https://nominatim.openstreetmap.org/search?{pars}"\\n448. \\n449.         # get longitude and latitude location\\n450.         err_str = f"Unable to retrieve coordinates for address \\\'{address}\\\'; {{msg}}"\\n451.         geo_result = _get_json_result(geo_url, err_str=err_str,\\n452.                                       use_google=use_google)\\n453. \\n454.         if use_google:\\n455.             loc = geo_result[0][\\\'geometry\\\'][\\\'location\\\']\\n456.             lat = loc[\\\'lat\\\']\\n457.             lon = loc[\\\'lng\\\']\\n458. \\n459.         else:\\n460.             loc = geo_result[0]\\n461.             lat = float(loc[\\\'lat\\\'])  # strings are returned by OpenStreetMap\\n462.             lon = float(loc[\\\'lon\\\'])\\n463. \\n464.         if get_height:\\n465.             pars = {\\\'locations\\\': f\\\'{lat:.8f},{lon:.8f}\\\',\\n466.                     \\\'key\\\': google_api_key}\\n467.             pars = urllib.parse.urlencode(pars)\\n468.             ele_url = f"https://maps.googleapis.com/maps/api/elevation/json?{pars}"\\n469. \\n470.             err_str = f"Unable to retrieve elevation for address \\\'{address}\\\'; {{msg}}"\\n471.             ele_result = _get_json_result(ele_url, err_str=err_str,\\n472.                                           use_google=use_google)\\n473.             height = ele_result[0][\\\'elevation\\\']*u.meter\\n474. \\n475.         else:\\n476.             height = 0.\\n477. \\n478.         return cls.from_geodetic(lon=lon*u.deg, lat=lat*u.deg, height=height)\\n479. \\n480.     @classmethod\\n481.     def get_site_names(cls):\\n482.         """\\n483.         Get list of names of observatories for use with\\n484.         `~astropy.coordinates.EarthLocation.of_site`.\\n485. \\n486.         .. note::\\n487.             When this function is called, it will first attempt to\\n488.             download site information from the astropy data server.  If it\\n489.             cannot (i.e., an internet connection is not available), it will fall\\n490.             back on the list included with astropy (which is a limited and dated\\n491.             set of sites).  If you think a site should be added, issue a pull\\n492.             request to the\\n493.             `astropy-data repository <https://github.com/astropy/astropy-data>`_ .\\n494. \\n495.         Returns\\n496.         -------\\n497.         names : list of str\\n498.             List of valid observatory names\\n499. \\n500.         See Also\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/coordinates/matrix_utilities.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. Utililies used for constructing and inspecting rotation matrices.\\n5. """\\n6. from functools import reduce\\n7. import numpy as np\\n8. \\n9. from astropy import units as u\\n10. from .angles import Angle\\n11. \\n12. \\n13. def matrix_product(*matrices):\\n14.     """Matrix multiply all arguments together.\\n15. \\n16.     Arguments should have dimension 2 or larger. Larger dimensional objects\\n17.     are interpreted as stacks of matrices residing in the last two dimensions.\\n18. \\n19.     This function mostly exists for readability: using `~numpy.matmul`\\n20.     directly, one would have ``matmul(matmul(m1, m2), m3)``, etc. For even\\n21.     better readability, one might consider using `~numpy.matrix` for the\\n22.     arguments (so that one could write ``m1 * m2 * m3``), but then it is not\\n23.     possible to handle stacks of matrices. Once only python >=3.5 is supported,\\n24.     this function can be replaced by ``m1 @ m2 @ m3``.\\n25.     """\\n26.     return reduce(np.matmul, matrices)\\n27. \\n28. \\n29. def matrix_transpose(matrix):\\n30.     """Transpose a matrix or stack of matrices by swapping the last two axes.\\n31. \\n32.     This function mostly exists for readability; seeing ``.swapaxes(-2, -1)``\\n33.     it is not that obvious that one does a transpose.  Note that one cannot\\n34.     use `~numpy.ndarray.T`, as this transposes all axes and thus does not\\n35.     work for stacks of matrices.\\n36.     """\\n37.     return matrix.swapaxes(-2, -1)\\n38. \\n39. \\n40. def rotation_matrix(angle, axis=\\\'z\\\', unit=None):\\n41.     """\\n42.     Generate matrices for rotation by some angle around some axis.\\n43. \\n44.     Parameters\\n45.     ----------\\n46.     angle : angle-like\\n47.         The amount of rotation the matrices should represent.  Can be an array.\\n48.     axis : str or array-like\\n49.         Either ``\\\'x\\\'``, ``\\\'y\\\'``, ``\\\'z\\\'``, or a (x,y,z) specifying the axis to\\n50.         rotate about. If ``\\\'x\\\'``, ``\\\'y\\\'``, or ``\\\'z\\\'``, the rotation sense is\\n51.         counterclockwise looking down the + axis (e.g. positive rotations obey\\n52.         left-hand-rule).  If given as an array, the last dimension should be 3;\\n53.         it will be broadcast against ``angle``.\\n54.     unit : unit-like, optional\\n55.         If ``angle`` does not have associated units, they are in this\\n56.         unit.  If neither are provided, it is assumed to be degrees.\\n57. \\n58.     Returns\\n59.     -------\\n60.     rmat : `numpy.matrix`\\n61.         A unitary rotation matrix.\\n62.     """\\n63.     if isinstance(angle, u.Quantity):\\n64.         angle = angle.to_value(u.radian)\\n65.     else:\\n66.         if unit is None:\\n67.             angle = np.deg2rad(angle)\\n68.         else:\\n69.             angle = u.Unit(unit).to(u.rad, angle)\\n70. \\n71.     s = np.sin(angle)\\n72.     c = np.cos(angle)\\n73. \\n74.     # use optimized implementations for x/y/z\\n75.     try:\\n76.         i = \\\'xyz\\\'.index(axis)\\n77.     except TypeError:\\n78.         axis = np.asarray(axis)\\n79.         axis = axis / np.sqrt((axis * axis).sum(axis=-1, keepdims=True))\\n80.         R = (axis[..., np.newaxis] * axis[..., np.newaxis, :] *\\n81.              (1. - c)[..., np.newaxis, np.newaxis])\\n82. \\n83.         for i in range(0, 3):\\n84.             R[..., i, i] += c\\n85.             a1 = (i + 1) % 3\\n86.             a2 = (i + 2) % 3\\n87.             R[..., a1, a2] += axis[..., i] * s\\n88.             R[..., a2, a1] -= axis[..., i] * s\\n89. \\n90.     else:\\n91.         a1 = (i + 1) % 3\\n92.         a2 = (i + 2) % 3\\n93.         R = np.zeros(getattr(angle, \\\'shape\\\', ()) + (3, 3))\\n94.         R[..., i, i] = 1.\\n95.         R[..., a1, a1] = c\\n96.         R[..., a1, a2] = s\\n97.         R[..., a2, a1] = -s\\n98.         R[..., a2, a2] = c\\n99. \\n100.     return R\\n101. \\n102. \\n103. def angle_axis(matrix):\\n104.     """\\n105.     Angle of rotation and rotation axis for a given rotation matrix.\\n106. \\n107.     Parameters\\n108.     ----------\\n109.     matrix : array-like\\n110.         A 3 x 3 unitary rotation matrix (or stack of matrices).\\n111. \\n112.     Returns\\n113.     -------\\n114.     angle : `~astropy.coordinates.Angle`\\n115.         The angle of rotation.\\n116.     axis : array\\n117.         The (normalized) axis of rotation (with last dimension 3).\\n118.     """\\n119.     m = np.asanyarray(matrix)\\n120.     if m.shape[-2:] != (3, 3):\\n121.         raise ValueError(\\\'matrix is not 3x3\\\')\\n122. \\n123.     axis = np.zeros(m.shape[:-1])\\n124.     axis[..., 0] = m[..., 2, 1] - m[..., 1, 2]\\n125.     axis[..., 1] = m[..., 0, 2] - m[..., 2, 0]\\n126.     axis[..., 2] = m[..., 1, 0] - m[..., 0, 1]\\n127.     r = np.sqrt((axis * axis).sum(-1, keepdims=True))\\n128.     angle = np.arctan2(r[..., 0],\\n129.                        m[..., 0, 0] + m[..., 1, 1] + m[..., 2, 2] - 1.)\\n130.     return Angle(angle, u.radian), -axis / r\\n131. \\n132. \\n133. def is_O3(matrix):\\n134.     """Check whether a matrix is in the length-preserving group O(3).\\n135. \\n136.     Parameters\\n137.     ----------\\n138.     matrix : (..., N, N) array-like\\n139.         Must have attribute ``.shape`` and method ``.swapaxes()`` and not error\\n140.         when using `~numpy.isclose`.\\n141. \\n142.     Returns\\n143.     -------\\n144.     is_o3 : bool or array of bool\\n145.         If the matrix has more than two axes, the O(3) check is performed on\\n146.         slices along the last two axes -- (M, N, N) => (M, ) bool array.\\n147. \\n148.     Notes\\n149.     -----\\n150.     The orthogonal group O(3) preserves lengths, but is not guaranteed to keep\\n151.     orientations. Rotations and reflections are in this group.\\n152.     For more information, see https://en.wikipedia.org/wiki/Orthogonal_group\\n153.     """\\n154.     # matrix is in O(3) (rotations, proper and improper).\\n155.     I = np.identity(matrix.shape[-1])\\n156.     is_o3 = np.all(np.isclose(matrix @ matrix.swapaxes(-2, -1), I, atol=1e-15),\\n157.                    axis=(-2, -1))\\n158. \\n159.     return is_o3\\n160. \\n161. \\n162. def is_rotation(matrix, allow_improper=False):\\n163.     """Check whether a matrix is a rotation, proper or improper.\\n164. \\n165.     Parameters\\n166.     ----------\\n167.     matrix : (..., N, N) array-like\\n168.         Must have attribute ``.shape`` and method ``.swapaxes()`` and not error\\n169.         when using `~numpy.isclose` and `~numpy.linalg.det`.\\n170.     allow_improper : bool, optional\\n171.         Whether to restrict check to the SO(3), the group of proper rotations,\\n172.         or also allow improper rotations (with determinant -1).\\n173.         The default (False) is only SO(3).\\n174. \\n175.     Returns\\n176.     -------\\n177.     isrot : bool or array of bool\\n178.         If the matrix has more than two axes, the checks are performed on\\n179.         slices along the last two axes -- (M, N, N) => (M, ) bool array.\\n180. \\n181.     See Also\\n182.     --------\\n183.     astopy.coordinates.matrix_utilities.is_O3 :\\n184.         For the less restrictive check that a matrix is in the group O(3).\\n185. \\n186.     Notes\\n187.     -----\\n188.     The group SO(3) is the rotation group. It is O(3), with determinant 1.\\n189.     Rotations with determinant -1 are improper rotations, combining both a\\n190.     rotation and a reflection.\\n191.     For more information, see https://en.wikipedia.org/wiki/Orthogonal_group\\n192. \\n193.     """\\n194.     # matrix is in O(3).\\n195.     is_o3 = is_O3(matrix)\\n196. \\n197.     # determinant checks  for rotation (proper and improper)\\n198.     if allow_improper:  # determinant can be +/- 1\\n199.         is_det1 = np.isclose(np.abs(np.linalg.det(matrix)), 1.0)\\n200.     else:  # restrict to SO(3)\\n201.         is_det1 = np.isclose(np.linalg.det(matrix), 1.0)\\n202. \\n203.     return is_o3 & is_det1\', \'start_line_number\': 1, \'end_line_number\': 203}\n\n{\'relative_path\': \'astropy/coordinates/representation.py\', \'content\': \'1. """\\n2. In this module, we define the coordinate representation classes, which are\\n3. used to represent low-level cartesian, spherical, cylindrical, and other\\n4. coordinates.\\n5. """\\n6. \\n7. import abc\\n8. import functools\\n9. import operator\\n10. import inspect\\n11. import warnings\\n12. \\n13. import numpy as np\\n14. import astropy.units as u\\n15. from erfa import ufunc as erfa_ufunc\\n16. \\n17. from .angles import Angle, Longitude, Latitude\\n18. from .distances import Distance\\n19. from .matrix_utilities import is_O3\\n20. from astropy.utils import ShapedLikeNDArray, classproperty\\n21. from astropy.utils.data_info import MixinInfo\\n22. from astropy.utils.exceptions import DuplicateRepresentationWarning\\n23. \\n24. \\n25. __all__ = ["BaseRepresentationOrDifferential", "BaseRepresentation",\\n26.            "CartesianRepresentation", "SphericalRepresentation",\\n27.            "UnitSphericalRepresentation", "RadialRepresentation",\\n28.            "PhysicsSphericalRepresentation", "CylindricalRepresentation",\\n29.            "BaseDifferential", "CartesianDifferential",\\n30.            "BaseSphericalDifferential", "BaseSphericalCosLatDifferential",\\n31.            "SphericalDifferential", "SphericalCosLatDifferential",\\n32.            "UnitSphericalDifferential", "UnitSphericalCosLatDifferential",\\n33.            "RadialDifferential", "CylindricalDifferential",\\n34.            "PhysicsSphericalDifferential"]\\n35. \\n36. # Module-level dict mapping representation string alias names to classes.\\n37. # This is populated by __init_subclass__ when called by Representation or\\n38. # Differential classes so that they are all registered automatically.\\n39. REPRESENTATION_CLASSES = {}\\n40. DIFFERENTIAL_CLASSES = {}\\n41. # set for tracking duplicates\\n42. DUPLICATE_REPRESENTATIONS = set()\\n43. \\n44. # a hash for the content of the above two dicts, cached for speed.\\n45. _REPRDIFF_HASH = None\\n46. \\n47. \\n48. def _fqn_class(cls):\\n49.     \\\'\\\'\\\' Get the fully qualified name of a class \\\'\\\'\\\'\\n50.     return cls.__module__ + \\\'.\\\' + cls.__qualname__\\n51. \\n52. \\n53. def get_reprdiff_cls_hash():\\n54.     """\\n55.     Returns a hash value that should be invariable if the\\n56.     `REPRESENTATION_CLASSES` and `DIFFERENTIAL_CLASSES` dictionaries have not\\n57.     changed.\\n58.     """\\n59.     global _REPRDIFF_HASH\\n60.     if _REPRDIFF_HASH is None:\\n61.         _REPRDIFF_HASH = (hash(tuple(REPRESENTATION_CLASSES.items())) +\\n62.                           hash(tuple(DIFFERENTIAL_CLASSES.items())))\\n63.     return _REPRDIFF_HASH\\n64. \\n65. \\n66. def _invalidate_reprdiff_cls_hash():\\n67.     global _REPRDIFF_HASH\\n68.     _REPRDIFF_HASH = None\\n69. \\n70. \\n71. def _array2string(values, prefix=\\\'\\\'):\\n72.     # Work around version differences for array2string.\\n73.     kwargs = {\\\'separator\\\': \\\', \\\', \\\'prefix\\\': prefix}\\n74.     kwargs[\\\'formatter\\\'] = {}\\n75. \\n76.     return np.array2string(values, **kwargs)\\n77. \\n78. \\n79. class BaseRepresentationOrDifferentialInfo(MixinInfo):\\n80.     """\\n81.     Container for meta information like name, description, format.  This is\\n82.     required when the object is used as a mixin column within a table, but can\\n83.     be used as a general way to store meta information.\\n84.     """\\n85.     attrs_from_parent = {\\\'unit\\\'}  # Indicates unit is read-only\\n86.     _supports_indexing = False\\n87. \\n88.     @staticmethod\\n89.     def default_format(val):\\n90.         # Create numpy dtype so that numpy formatting will work.\\n91.         components = val.components\\n92.         values = tuple(getattr(val, component).value for component in components)\\n93.         a = np.empty(getattr(val, \\\'shape\\\', ()),\\n94.                      [(component, value.dtype) for component, value\\n95.                       in zip(components, values)])\\n96.         for component, value in zip(components, values):\\n97.             a[component] = value\\n98.         return str(a)\\n99. \\n100.     @property\\n101.     def _represent_as_dict_attrs(self):\\n102.         return self._parent.components\\n103. \\n104.     @property\\n105.     def unit(self):\\n106.         if self._parent is None:\\n107.             return None\\n108. \\n109.         unit = self._parent._unitstr\\n110.         return unit[1:-1] if unit.startswith(\\\'(\\\') else unit\\n111. \\n112.     def new_like(self, reps, length, metadata_conflicts=\\\'warn\\\', name=None):\\n113.         """\\n114.         Return a new instance like ``reps`` with ``length`` rows.\\n115. \\n116.         This is intended for creating an empty column object whose elements can\\n117.         be set in-place for table operations like join or vstack.\\n118. \\n119.         Parameters\\n120.         ----------\\n121.         reps : list\\n122.             List of input representations or differentials.\\n123.         length : int\\n124.             Length of the output column object\\n125.         metadata_conflicts : str (\\\'warn\\\'|\\\'error\\\'|\\\'silent\\\')\\n126.             How to handle metadata conflicts\\n127.         name : str\\n128.             Output column name\\n129. \\n130.         Returns\\n131.         -------\\n132.         col : `BaseRepresentation` or `BaseDifferential` subclass instance\\n133.             Empty instance of this class consistent with ``cols``\\n134. \\n135.         """\\n136. \\n137.         # Get merged info attributes like shape, dtype, format, description, etc.\\n138.         attrs = self.merge_cols_attributes(reps, metadata_conflicts, name,\\n139.                                            (\\\'meta\\\', \\\'description\\\'))\\n140.         # Make a new representation or differential with the desired length\\n141.         # using the _apply / __getitem__ machinery to effectively return\\n142.         # rep0[[0, 0, ..., 0, 0]]. This will have the right shape, and\\n143.         # include possible differentials.\\n144.         indexes = np.zeros(length, dtype=np.int64)\\n145.         out = reps[0][indexes]\\n146. \\n147.         # Use __setitem__ machinery to check whether all representations\\n148.         # can represent themselves as this one without loss of information.\\n149.         for rep in reps[1:]:\\n150.             try:\\n151.                 out[0] = rep[0]\\n152.             except Exception as err:\\n153.                 raise ValueError(f\\\'input representations are inconsistent.\\\') from err\\n154. \\n155.         # Set (merged) info attributes.\\n156.         for attr in (\\\'name\\\', \\\'meta\\\', \\\'description\\\'):\\n157.             if attr in attrs:\\n158.                 setattr(out.info, attr, attrs[attr])\\n159. \\n160.         return out\\n161. \\n162. \\n163. class BaseRepresentationOrDifferential(ShapedLikeNDArray):\\n164.     """3D coordinate representations and differentials.\\n165. \\n166.     Parameters\\n167.     ----------\\n168.     comp1, comp2, comp3 : `~astropy.units.Quantity` or subclass\\n169.         The components of the 3D point or differential.  The names are the\\n170.         keys and the subclasses the values of the ``attr_classes`` attribute.\\n171.     copy : bool, optional\\n172.         If `True` (default), arrays will be copied; if `False`, they will be\\n173.         broadcast together but not use new memory.\\n174.     """\\n175. \\n176.     # Ensure multiplication/division with ndarray or Quantity doesn\\\'t lead to\\n177.     # object arrays.\\n178.     __array_priority__ = 50000\\n179. \\n180.     info = BaseRepresentationOrDifferentialInfo()\\n181. \\n182.     def __init__(self, *args, **kwargs):\\n183.         # make argument a list, so we can pop them off.\\n184.         args = list(args)\\n185.         components = self.components\\n186.         if (args and isinstance(args[0], self.__class__)\\n187.                 and all(arg is None for arg in args[1:])):\\n188.             rep_or_diff = args[0]\\n189.             copy = kwargs.pop(\\\'copy\\\', True)\\n190.             attrs = [getattr(rep_or_diff, component)\\n191.                      for component in components]\\n192.             if \\\'info\\\' in rep_or_diff.__dict__:\\n193.                 self.info = rep_or_diff.info\\n194. \\n195.             if kwargs:\\n196.                 raise TypeError(f\\\'unexpected keyword arguments for case \\\'\\n197.                                 f\\\'where class instance is passed in: {kwargs}\\\')\\n198. \\n199.         else:\\n200.             attrs = []\\n201.             for component in components:\\n202.                 try:\\n203.                     attr = args.pop(0) if args else kwargs.pop(component)\\n204.                 except KeyError:\\n205.                     raise TypeError(f\\\'__init__() missing 1 required positional \\\'\\n206.                                     f\\\'argument: {component!r}\\\') from None\\n207. \\n208.                 if attr is None:\\n209.                     raise TypeError(f\\\'__init__() missing 1 required positional \\\'\\n210.                                     f\\\'argument: {component!r} (or first \\\'\\n211.                                     f\\\'argument should be an instance of \\\'\\n212.                                     f\\\'{self.__class__.__name__}).\\\')\\n213. \\n214.                 attrs.append(attr)\\n215. \\n216.             copy = args.pop(0) if args else kwargs.pop(\\\'copy\\\', True)\\n217. \\n218.             if args:\\n219.                 raise TypeError(f\\\'unexpected arguments: {args}\\\')\\n220. \\n221.             if kwargs:\\n222.                 for component in components:\\n223.                     if component in kwargs:\\n224.                         raise TypeError(f"__init__() got multiple values for "\\n225.                                         f"argument {component!r}")\\n226. \\n227.                 raise TypeError(f\\\'unexpected keyword arguments: {kwargs}\\\')\\n228. \\n229.         # Pass attributes through the required initializing classes.\\n230.         attrs = [self.attr_classes[component](attr, copy=copy, subok=True)\\n231.                  for component, attr in zip(components, attrs)]\\n232.         try:\\n233.             bc_attrs = np.broadcast_arrays(*attrs, subok=True)\\n234.         except ValueError  as err:\\n235.             if len(components) <= 2:\\n236.                 c_str = \\\' and \\\'.join(components)\\n237.             else:\\n238.                 c_str = \\\', \\\'.join(components[:2]) + \\\', and \\\' + components[2]\\n239.             raise ValueError(f"Input parameters {c_str} cannot be broadcast") from err\\n240. \\n241.         # The output of np.broadcast_arrays() has limitations on writeability, so we perform\\n242.         # additional handling to enable writeability in most situations.  This is primarily\\n243.         # relevant for allowing the changing of the wrap angle of longitude components.\\n244.         #\\n245.         # If the shape has changed for a given component, broadcasting is needed:\\n246.         #     If copy=True, we make a copy of the broadcasted array to ensure writeability.\\n247.         #         Note that array had already been copied prior to the broadcasting.\\n248.         #         TODO: Find a way to avoid the double copy.\\n249.         #     If copy=False, we use the broadcasted array, and writeability may still be\\n250.         #         limited.\\n251.         # If the shape has not changed for a given component, we can proceed with using the\\n252.         #     non-broadcasted array, which avoids writeability issues from np.broadcast_arrays().\\n253.         attrs = [(bc_attr.copy() if copy else bc_attr) if bc_attr.shape != attr.shape else attr\\n254.                  for attr, bc_attr in zip(attrs, bc_attrs)]\\n255. \\n256.         # Set private attributes for the attributes. (If not defined explicitly\\n257.         # on the class, the metaclass will define properties to access these.)\\n258.         for component, attr in zip(components, attrs):\\n259.             setattr(self, \\\'_\\\' + component, attr)\\n260. \\n261.     @classmethod\\n262.     def get_name(cls):\\n263.         """Name of the representation or differential.\\n264. \\n265.         In lower case, with any trailing \\\'representation\\\' or \\\'differential\\\'\\n266.         removed. (E.g., \\\'spherical\\\' for\\n267.         `~astropy.coordinates.SphericalRepresentation` or\\n268.         `~astropy.coordinates.SphericalDifferential`.)\\n269.         """\\n270.         name = cls.__name__.lower()\\n271. \\n272.         if name.endswith(\\\'representation\\\'):\\n273.             name = name[:-14]\\n274.         elif name.endswith(\\\'differential\\\'):\\n275.             name = name[:-12]\\n276. \\n277.         return name\\n278. \\n279.     # The two methods that any subclass has to define.\\n280.     @classmethod\\n281.     @abc.abstractmethod\\n282.     def from_cartesian(cls, other):\\n283.         """Create a representation of this class from a supplied Cartesian one.\\n284. \\n285.         Parameters\\n286.         ----------\\n287.         other : `CartesianRepresentation`\\n288.             The representation to turn into this class\\n289. \\n290.         Returns\\n291.         -------\\n292.         representation : `BaseRepresentation` subclass instance\\n293.             A new representation of this class\\\'s type.\\n294.         """\\n295.         # Note: the above docstring gets overridden for differentials.\\n296.         raise NotImplementedError()\\n297. \\n298.     @abc.abstractmethod\\n299.     def to_cartesian(self):\\n300.         """Convert the representation to its Cartesian form.\\n301. \\n302.         Note that any differentials get dropped.\\n303.         Also note that orientation information at the origin is *not* preserved by\\n304.         conversions through Cartesian coordinates. For example, transforming\\n305.         an angular position defined at distance=0 through cartesian coordinates\\n306.         and back will lose the original angular coordinates::\\n307. \\n308.             >>> import astropy.units as u\\n309.             >>> import astropy.coordinates as coord\\n310.             >>> rep = coord.SphericalRepresentation(\\n311.             ...     lon=15*u.deg,\\n312.             ...     lat=-11*u.deg,\\n313.             ...     distance=0*u.pc)\\n314.             >>> rep.to_cartesian().represent_as(coord.SphericalRepresentation)\\n315.             <SphericalRepresentation (lon, lat, distance) in (rad, rad, pc)\\n316.                 (0., 0., 0.)>\\n317. \\n318.         Returns\\n319.         -------\\n320.         cartrepr : `CartesianRepresentation`\\n321.             The representation in Cartesian form.\\n322.         """\\n323.         # Note: the above docstring gets overridden for differentials.\\n324.         raise NotImplementedError()\\n325. \\n326.     @property\\n327.     def components(self):\\n328.         """A tuple with the in-order names of the coordinate components."""\\n329.         return tuple(self.attr_classes)\\n330. \\n331.     def __eq__(self, value):\\n332.         """Equality operator\\n333. \\n334.         This implements strict equality and requires that the representation\\n335.         classes are identical and that the representation data are exactly equal.\\n336.         """\\n337.         if self.__class__ is not value.__class__:\\n338.             raise TypeError(f\\\'cannot compare: objects must have same class: \\\'\\n339.                             f\\\'{self.__class__.__name__} vs. \\\'\\n340.                             f\\\'{value.__class__.__name__}\\\')\\n341. \\n342.         try:\\n343.             np.broadcast(self, value)\\n344.         except ValueError as exc:\\n345.             raise ValueError(f\\\'cannot compare: {exc}\\\') from exc\\n346. \\n347.         out = True\\n348.         for comp in self.components:\\n349.             out &= (getattr(self, \\\'_\\\' + comp) == getattr(value, \\\'_\\\' + comp))\\n350. \\n351.         return out\\n352. \\n353.     def __ne__(self, value):\\n354.         return np.logical_not(self == value)\\n355. \\n356.     def _apply(self, method, *args, **kwargs):\\n357.         """Create a new representation or differential with ``method`` applied\\n358.         to the component data.\\n359. \\n360.         In typical usage, the method is any of the shape-changing methods for\\n361.         `~numpy.ndarray` (``reshape``, ``swapaxes``, etc.), as well as those\\n362.         picking particular elements (``__getitem__``, ``take``, etc.), which\\n363.         are all defined in `~astropy.utils.shapes.ShapedLikeNDArray`. It will be\\n364.         applied to the underlying arrays (e.g., ``x``, ``y``, and ``z`` for\\n365.         `~astropy.coordinates.CartesianRepresentation`), with the results used\\n366.         to create a new instance.\\n367. \\n368.         Internally, it is also used to apply functions to the components\\n369.         (in particular, `~numpy.broadcast_to`).\\n370. \\n371.         Parameters\\n372.         ----------\\n373.         method : str or callable\\n374.             If str, it is the name of a method that is applied to the internal\\n375.             ``components``. If callable, the function is applied.\\n376.         *args : tuple\\n377.             Any positional arguments for ``method``.\\n378.         **kwargs : dict\\n379.             Any keyword arguments for ``method``.\\n380.         """\\n381.         if callable(method):\\n382.             apply_method = lambda array: method(array, *args, **kwargs)\\n383.         else:\\n384.             apply_method = operator.methodcaller(method, *args, **kwargs)\\n385. \\n386.         new = super().__new__(self.__class__)\\n387.         for component in self.components:\\n388.             setattr(new, \\\'_\\\' + component,\\n389.                     apply_method(getattr(self, component)))\\n390. \\n391.         # Copy other \\\'info\\\' attr only if it has actually been defined.\\n392.         # See PR #3898 for further explanation and justification, along\\n393.         # with Quantity.__array_finalize__\\n394.         if \\\'info\\\' in self.__dict__:\\n395.             new.info = self.info\\n396. \\n397.         return new\\n398. \\n399.     def __setitem__(self, item, value):\\n400.         if value.__class__ is not self.__class__:\\n401.             raise TypeError(f\\\'can only set from object of same class: \\\'\\n402.                             f\\\'{self.__class__.__name__} vs. \\\'\\n403.                             f\\\'{value.__class__.__name__}\\\')\\n404. \\n405.         for component in self.components:\\n406.             getattr(self, \\\'_\\\' + component)[item] = getattr(value, \\\'_\\\' + component)\\n407. \\n408.     @property\\n409.     def shape(self):\\n410.         """The shape of the instance and underlying arrays.\\n411. \\n412.         Like `~numpy.ndarray.shape`, can be set to a new shape by assigning a\\n413.         tuple.  Note that if different instances share some but not all\\n414.         underlying data, setting the shape of one instance can make the other\\n415.         instance unusable.  Hence, it is strongly recommended to get new,\\n416.         reshaped instances with the ``reshape`` method.\\n417. \\n418.         Raises\\n419.         ------\\n420.         ValueError\\n421.             If the new shape has the wrong total number of elements.\\n422.         AttributeError\\n423.             If the shape of any of the components cannot be changed without the\\n424.             arrays being copied.  For these cases, use the ``reshape`` method\\n425.             (which copies any arrays that cannot be reshaped in-place).\\n426.         """\\n427.         return getattr(self, self.components[0]).shape\\n428. \\n429.     @shape.setter\\n430.     def shape(self, shape):\\n431.         # We keep track of arrays that were already reshaped since we may have\\n432.         # to return those to their original shape if a later shape-setting\\n433.         # fails. (This can happen since coordinates are broadcast together.)\\n434.         reshaped = []\\n435.         oldshape = self.shape\\n436.         for component in self.components:\\n437.             val = getattr(self, component)\\n438.             if val.size > 1:\\n439.                 try:\\n440.                     val.shape = shape\\n441.                 except Exception:\\n442.                     for val2 in reshaped:\\n443.                         val2.shape = oldshape\\n444.                     raise\\n445.                 else:\\n446.                     reshaped.append(val)\\n447. \\n448.     # Required to support multiplication and division, and defined by the base\\n449.     # representation and differential classes.\\n450.     @abc.abstractmethod\\n451.     def _scale_operation(self, op, *args):\\n452.         raise NotImplementedError()\\n453. \\n454.     def __mul__(self, other):\\n455.         return self._scale_operation(operator.mul, other)\\n456. \\n457.     def __rmul__(self, other):\\n458.         return self.__mul__(other)\\n459. \\n460.     def __truediv__(self, other):\\n461.         return self._scale_operation(operator.truediv, other)\\n462. \\n463.     def __neg__(self):\\n464.         return self._scale_operation(operator.neg)\\n465. \\n466.     # Follow numpy convention and make an independent copy.\\n467.     def __pos__(self):\\n468.         return self.copy()\\n469. \\n470.     # Required to support addition and subtraction, and defined by the base\\n471.     # representation and differential classes.\\n472.     @abc.abstractmethod\\n473.     def _combine_operation(self, op, other, reverse=False):\\n474.         raise NotImplementedError()\\n475. \\n476.     def __add__(self, other):\\n477.         return self._combine_operation(operator.add, other)\\n478. \\n479.     def __radd__(self, other):\\n480.         return self._combine_operation(operator.add, other, reverse=True)\\n481. \\n482.     def __sub__(self, other):\\n483.         return self._combine_operation(operator.sub, other)\\n484. \\n485.     def __rsub__(self, other):\\n486.         return self._combine_operation(operator.sub, other, reverse=True)\\n487. \\n488.     # The following are used for repr and str\\n489.     @property\\n490.     def _values(self):\\n491.         """Turn the coordinates into a record array with the coordinate values.\\n492. \\n493.         The record array fields will have the component names.\\n494.         """\\n495.         coo_items = [(c, getattr(self, c)) for c in self.components]\\n496.         result = np.empty(self.shape, [(c, coo.dtype) for c, coo in coo_items])\\n497.         for c, coo in coo_items:\\n498.             result[c] = coo.value\\n499.         return result\\n500. \', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/coordinates/transformations.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. This module contains a general framework for defining graphs of transformations\\n5. between coordinates, suitable for either spatial coordinates or more generalized\\n6. coordinate systems.\\n7. \\n8. The fundamental idea is that each class is a node in the transformation graph,\\n9. and transitions from one node to another are defined as functions (or methods)\\n10. wrapped in transformation objects.\\n11. \\n12. This module also includes more specific transformation classes for\\n13. celestial/spatial coordinate frames, generally focused around matrix-style\\n14. transformations that are typically how the algorithms are defined.\\n15. """\\n16. \\n17. \\n18. import heapq\\n19. import inspect\\n20. import subprocess\\n21. from warnings import warn\\n22. \\n23. from abc import ABCMeta, abstractmethod\\n24. from collections import defaultdict\\n25. from contextlib import suppress, contextmanager\\n26. from inspect import signature\\n27. \\n28. import numpy as np\\n29. \\n30. from astropy import units as u\\n31. from astropy.utils.exceptions import AstropyWarning\\n32. \\n33. from .matrix_utilities import matrix_product\\n34. \\n35. __all__ = [\\\'TransformGraph\\\', \\\'CoordinateTransform\\\', \\\'FunctionTransform\\\',\\n36.            \\\'BaseAffineTransform\\\', \\\'AffineTransform\\\',\\n37.            \\\'StaticMatrixTransform\\\', \\\'DynamicMatrixTransform\\\',\\n38.            \\\'FunctionTransformWithFiniteDifference\\\', \\\'CompositeTransform\\\']\\n39. \\n40. \\n41. def frame_attrs_from_set(frame_set):\\n42.     """\\n43.     A `dict` of all the attributes of all frame classes in this\\n44.     `TransformGraph`.\\n45. \\n46.     Broken out of the class so this can be called on a temporary frame set to\\n47.     validate new additions to the transform graph before actually adding them.\\n48.     """\\n49.     result = {}\\n50. \\n51.     for frame_cls in frame_set:\\n52.         result.update(frame_cls.frame_attributes)\\n53. \\n54.     return result\\n55. \\n56. \\n57. def frame_comps_from_set(frame_set):\\n58.     """\\n59.     A `set` of all component names every defined within any frame class in\\n60.     this `TransformGraph`.\\n61. \\n62.     Broken out of the class so this can be called on a temporary frame set to\\n63.     validate new additions to the transform graph before actually adding them.\\n64.     """\\n65.     result = set()\\n66. \\n67.     for frame_cls in frame_set:\\n68.         rep_info = frame_cls._frame_specific_representation_info\\n69.         for mappings in rep_info.values():\\n70.             for rep_map in mappings:\\n71.                 result.update([rep_map.framename])\\n72. \\n73.     return result\\n74. \\n75. \\n76. class TransformGraph:\\n77.     """\\n78.     A graph representing the paths between coordinate frames.\\n79.     """\\n80. \\n81.     def __init__(self):\\n82.         self._graph = defaultdict(dict)\\n83.         self.invalidate_cache()  # generates cache entries\\n84. \\n85.     @property\\n86.     def _cached_names(self):\\n87.         if self._cached_names_dct is None:\\n88.             self._cached_names_dct = dct = {}\\n89.             for c in self.frame_set:\\n90.                 nm = getattr(c, \\\'name\\\', None)\\n91.                 if nm is not None:\\n92.                     if not isinstance(nm, list):\\n93.                         nm = [nm]\\n94.                     for name in nm:\\n95.                         dct[name] = c\\n96. \\n97.         return self._cached_names_dct\\n98. \\n99.     @property\\n100.     def frame_set(self):\\n101.         """\\n102.         A `set` of all the frame classes present in this `TransformGraph`.\\n103.         """\\n104.         if self._cached_frame_set is None:\\n105.             self._cached_frame_set = set()\\n106.             for a in self._graph:\\n107.                 self._cached_frame_set.add(a)\\n108.                 for b in self._graph[a]:\\n109.                     self._cached_frame_set.add(b)\\n110. \\n111.         return self._cached_frame_set.copy()\\n112. \\n113.     @property\\n114.     def frame_attributes(self):\\n115.         """\\n116.         A `dict` of all the attributes of all frame classes in this\\n117.         `TransformGraph`.\\n118.         """\\n119.         if self._cached_frame_attributes is None:\\n120.             self._cached_frame_attributes = frame_attrs_from_set(self.frame_set)\\n121. \\n122.         return self._cached_frame_attributes\\n123. \\n124.     @property\\n125.     def frame_component_names(self):\\n126.         """\\n127.         A `set` of all component names every defined within any frame class in\\n128.         this `TransformGraph`.\\n129.         """\\n130.         if self._cached_component_names is None:\\n131.             self._cached_component_names = frame_comps_from_set(self.frame_set)\\n132. \\n133.         return self._cached_component_names\\n134. \\n135.     def invalidate_cache(self):\\n136.         """\\n137.         Invalidates the cache that stores optimizations for traversing the\\n138.         transform graph.  This is called automatically when transforms\\n139.         are added or removed, but will need to be called manually if\\n140.         weights on transforms are modified inplace.\\n141.         """\\n142.         self._cached_names_dct = None\\n143.         self._cached_frame_set = None\\n144.         self._cached_frame_attributes = None\\n145.         self._cached_component_names = None\\n146.         self._shortestpaths = {}\\n147.         self._composite_cache = {}\\n148. \\n149.     def add_transform(self, fromsys, tosys, transform):\\n150.         """\\n151.         Add a new coordinate transformation to the graph.\\n152. \\n153.         Parameters\\n154.         ----------\\n155.         fromsys : class\\n156.             The coordinate frame class to start from.\\n157.         tosys : class\\n158.             The coordinate frame class to transform into.\\n159.         transform : `CoordinateTransform`\\n160.             The transformation object. Typically a `CoordinateTransform` object,\\n161.             although it may be some other callable that is called with the same\\n162.             signature.\\n163. \\n164.         Raises\\n165.         ------\\n166.         TypeError\\n167.             If ``fromsys`` or ``tosys`` are not classes or ``transform`` is\\n168.             not callable.\\n169.         """\\n170. \\n171.         if not inspect.isclass(fromsys):\\n172.             raise TypeError(\\\'fromsys must be a class\\\')\\n173.         if not inspect.isclass(tosys):\\n174.             raise TypeError(\\\'tosys must be a class\\\')\\n175.         if not callable(transform):\\n176.             raise TypeError(\\\'transform must be callable\\\')\\n177. \\n178.         frame_set = self.frame_set.copy()\\n179.         frame_set.add(fromsys)\\n180.         frame_set.add(tosys)\\n181. \\n182.         # Now we check to see if any attributes on the proposed frames override\\n183.         # *any* component names, which we can\\\'t allow for some of the logic in\\n184.         # the SkyCoord initializer to work\\n185.         attrs = set(frame_attrs_from_set(frame_set).keys())\\n186.         comps = frame_comps_from_set(frame_set)\\n187. \\n188.         invalid_attrs = attrs.intersection(comps)\\n189.         if invalid_attrs:\\n190.             invalid_frames = set()\\n191.             for attr in invalid_attrs:\\n192.                 if attr in fromsys.frame_attributes:\\n193.                     invalid_frames.update([fromsys])\\n194. \\n195.                 if attr in tosys.frame_attributes:\\n196.                     invalid_frames.update([tosys])\\n197. \\n198.             raise ValueError("Frame(s) {} contain invalid attribute names: {}"\\n199.                              "\\\\nFrame attributes can not conflict with *any* of"\\n200.                              " the frame data component names (see"\\n201.                              " `frame_transform_graph.frame_component_names`)."\\n202.                              .format(list(invalid_frames), invalid_attrs))\\n203. \\n204.         self._graph[fromsys][tosys] = transform\\n205.         self.invalidate_cache()\\n206. \\n207.     def remove_transform(self, fromsys, tosys, transform):\\n208.         """\\n209.         Removes a coordinate transform from the graph.\\n210. \\n211.         Parameters\\n212.         ----------\\n213.         fromsys : class or None\\n214.             The coordinate frame *class* to start from. If `None`,\\n215.             ``transform`` will be searched for and removed (``tosys`` must\\n216.             also be `None`).\\n217.         tosys : class or None\\n218.             The coordinate frame *class* to transform into. If `None`,\\n219.             ``transform`` will be searched for and removed (``fromsys`` must\\n220.             also be `None`).\\n221.         transform : callable or None\\n222.             The transformation object to be removed or `None`.  If `None`\\n223.             and ``tosys`` and ``fromsys`` are supplied, there will be no\\n224.             check to ensure the correct object is removed.\\n225.         """\\n226.         if fromsys is None or tosys is None:\\n227.             if not (tosys is None and fromsys is None):\\n228.                 raise ValueError(\\\'fromsys and tosys must both be None if either are\\\')\\n229.             if transform is None:\\n230.                 raise ValueError(\\\'cannot give all Nones to remove_transform\\\')\\n231. \\n232.             # search for the requested transform by brute force and remove it\\n233.             for a in self._graph:\\n234.                 agraph = self._graph[a]\\n235.                 for b in agraph:\\n236.                     if agraph[b] is transform:\\n237.                         del agraph[b]\\n238.                         fromsys = a\\n239.                         break\\n240. \\n241.                 # If the transform was found, need to break out of the outer for loop too\\n242.                 if fromsys:\\n243.                     break\\n244.             else:\\n245.                 raise ValueError(f\\\'Could not find transform {transform} in the graph\\\')\\n246. \\n247.         else:\\n248.             if transform is None:\\n249.                 self._graph[fromsys].pop(tosys, None)\\n250.             else:\\n251.                 curr = self._graph[fromsys].get(tosys, None)\\n252.                 if curr is transform:\\n253.                     self._graph[fromsys].pop(tosys)\\n254.                 else:\\n255.                     raise ValueError(\\\'Current transform from {} to {} is not \\\'\\n256.                                      \\\'{}\\\'.format(fromsys, tosys, transform))\\n257. \\n258.         # Remove the subgraph if it is now empty\\n259.         if self._graph[fromsys] == {}:\\n260.             self._graph.pop(fromsys)\\n261. \\n262.         self.invalidate_cache()\\n263. \\n264.     def find_shortest_path(self, fromsys, tosys):\\n265.         """\\n266.         Computes the shortest distance along the transform graph from\\n267.         one system to another.\\n268. \\n269.         Parameters\\n270.         ----------\\n271.         fromsys : class\\n272.             The coordinate frame class to start from.\\n273.         tosys : class\\n274.             The coordinate frame class to transform into.\\n275. \\n276.         Returns\\n277.         -------\\n278.         path : list of class or None\\n279.             The path from ``fromsys`` to ``tosys`` as an in-order sequence\\n280.             of classes.  This list includes *both* ``fromsys`` and\\n281.             ``tosys``. Is `None` if there is no possible path.\\n282.         distance : float or int\\n283.             The total distance/priority from ``fromsys`` to ``tosys``.  If\\n284.             priorities are not set this is the number of transforms\\n285.             needed. Is ``inf`` if there is no possible path.\\n286.         """\\n287. \\n288.         inf = float(\\\'inf\\\')\\n289. \\n290.         # special-case the 0 or 1-path\\n291.         if tosys is fromsys:\\n292.             if tosys not in self._graph[fromsys]:\\n293.                 # Means there\\\'s no transform necessary to go from it to itself.\\n294.                 return [tosys], 0\\n295.         if tosys in self._graph[fromsys]:\\n296.             # this will also catch the case where tosys is fromsys, but has\\n297.             # a defined transform.\\n298.             t = self._graph[fromsys][tosys]\\n299.             return [fromsys, tosys], float(t.priority if hasattr(t, \\\'priority\\\') else 1)\\n300. \\n301.         # otherwise, need to construct the path:\\n302. \\n303.         if fromsys in self._shortestpaths:\\n304.             # already have a cached result\\n305.             fpaths = self._shortestpaths[fromsys]\\n306.             if tosys in fpaths:\\n307.                 return fpaths[tosys]\\n308.             else:\\n309.                 return None, inf\\n310. \\n311.         # use Dijkstra\\\'s algorithm to find shortest path in all other cases\\n312. \\n313.         nodes = []\\n314.         # first make the list of nodes\\n315.         for a in self._graph:\\n316.             if a not in nodes:\\n317.                 nodes.append(a)\\n318.             for b in self._graph[a]:\\n319.                 if b not in nodes:\\n320.                     nodes.append(b)\\n321. \\n322.         if fromsys not in nodes or tosys not in nodes:\\n323.             # fromsys or tosys are isolated or not registered, so there\\\'s\\n324.             # certainly no way to get from one to the other\\n325.             return None, inf\\n326. \\n327.         edgeweights = {}\\n328.         # construct another graph that is a dict of dicts of priorities\\n329.         # (used as edge weights in Dijkstra\\\'s algorithm)\\n330.         for a in self._graph:\\n331.             edgeweights[a] = aew = {}\\n332.             agraph = self._graph[a]\\n333.             for b in agraph:\\n334.                 aew[b] = float(agraph[b].priority if hasattr(agraph[b], \\\'priority\\\') else 1)\\n335. \\n336.         # entries in q are [distance, count, nodeobj, pathlist]\\n337.         # count is needed because in py 3.x, tie-breaking fails on the nodes.\\n338.         # this way, insertion order is preserved if the weights are the same\\n339.         q = [[inf, i, n, []] for i, n in enumerate(nodes) if n is not fromsys]\\n340.         q.insert(0, [0, -1, fromsys, []])\\n341. \\n342.         # this dict will store the distance to node from ``fromsys`` and the path\\n343.         result = {}\\n344. \\n345.         # definitely starts as a valid heap because of the insert line; from the\\n346.         # node to itself is always the shortest distance\\n347.         while len(q) > 0:\\n348.             d, orderi, n, path = heapq.heappop(q)\\n349. \\n350.             if d == inf:\\n351.                 # everything left is unreachable from fromsys, just copy them to\\n352.                 # the results and jump out of the loop\\n353.                 result[n] = (None, d)\\n354.                 for d, orderi, n, path in q:\\n355.                     result[n] = (None, d)\\n356.                 break\\n357.             else:\\n358.                 result[n] = (path, d)\\n359.                 path.append(n)\\n360.                 if n not in edgeweights:\\n361.                     # this is a system that can be transformed to, but not from.\\n362.                     continue\\n363.                 for n2 in edgeweights[n]:\\n364.                     if n2 not in result:  # already visited\\n365.                         # find where n2 is in the heap\\n366.                         for i in range(len(q)):\\n367.                             if q[i][2] == n2:\\n368.                                 break\\n369.                         else:\\n370.                             raise ValueError(\\\'n2 not in heap - this should be impossible!\\\')\\n371. \\n372.                         newd = d + edgeweights[n][n2]\\n373.                         if newd < q[i][0]:\\n374.                             q[i][0] = newd\\n375.                             q[i][3] = list(path)\\n376.                             heapq.heapify(q)\\n377. \\n378.         # cache for later use\\n379.         self._shortestpaths[fromsys] = result\\n380.         return result[tosys]\\n381. \\n382.     def get_transform(self, fromsys, tosys):\\n383.         """\\n384.         Generates and returns the `CompositeTransform` for a transformation\\n385.         between two coordinate systems.\\n386. \\n387.         Parameters\\n388.         ----------\\n389.         fromsys : class\\n390.             The coordinate frame class to start from.\\n391.         tosys : class\\n392.             The coordinate frame class to transform into.\\n393. \\n394.         Returns\\n395.         -------\\n396.         trans : `CompositeTransform` or None\\n397.             If there is a path from ``fromsys`` to ``tosys``, this is a\\n398.             transform object for that path.   If no path could be found, this is\\n399.             `None`.\\n400. \\n401.         Notes\\n402.         -----\\n403.         This function always returns a `CompositeTransform`, because\\n404.         `CompositeTransform` is slightly more adaptable in the way it can be\\n405.         called than other transform classes. Specifically, it takes care of\\n406.         intermediate steps of transformations in a way that is consistent with\\n407.         1-hop transformations.\\n408. \\n409.         """\\n410.         if not inspect.isclass(fromsys):\\n411.             raise TypeError(\\\'fromsys is not a class\\\')\\n412.         if not inspect.isclass(tosys):\\n413.             raise TypeError(\\\'tosys is not a class\\\')\\n414. \\n415.         path, distance = self.find_shortest_path(fromsys, tosys)\\n416. \\n417.         if path is None:\\n418.             return None\\n419. \\n420.         transforms = []\\n421.         currsys = fromsys\\n422.         for p in path[1:]:  # first element is fromsys so we skip it\\n423.             transforms.append(self._graph[currsys][p])\\n424.             currsys = p\\n425. \\n426.         fttuple = (fromsys, tosys)\\n427.         if fttuple not in self._composite_cache:\\n428.             comptrans = CompositeTransform(transforms, fromsys, tosys,\\n429.                                            register_graph=False)\\n430.             self._composite_cache[fttuple] = comptrans\\n431.         return self._composite_cache[fttuple]\\n432. \\n433.     def lookup_name(self, name):\\n434.         """\\n435.         Tries to locate the coordinate class with the provided alias.\\n436. \\n437.         Parameters\\n438.         ----------\\n439.         name : str\\n440.             The alias to look up.\\n441. \\n442.         Returns\\n443.         -------\\n444.         `BaseCoordinateFrame` subclass\\n445.             The coordinate class corresponding to the ``name`` or `None` if\\n446.             no such class exists.\\n447.         """\\n448. \\n449.         return self._cached_names.get(name, None)\\n450. \\n451.     def get_names(self):\\n452.         """\\n453.         Returns all available transform names. They will all be\\n454.         valid arguments to `lookup_name`.\\n455. \\n456.         Returns\\n457.         -------\\n458.         nms : list\\n459.             The aliases for coordinate systems.\\n460.         """\\n461.         return list(self._cached_names.keys())\\n462. \\n463.     def to_dot_graph(self, priorities=True, addnodes=[], savefn=None,\\n464.                      savelayout=\\\'plain\\\', saveformat=None, color_edges=True):\\n465.         """\\n466.         Converts this transform graph to the graphviz_ DOT format.\\n467. \\n468.         Optionally saves it (requires `graphviz`_ be installed and on your path).\\n469. \\n470.         .. _graphviz: http://www.graphviz.org/\\n471. \\n472.         Parameters\\n473.         ----------\\n474.         priorities : bool\\n475.             If `True`, show the priority values for each transform.  Otherwise,\\n476.             the will not be included in the graph.\\n477.         addnodes : sequence of str\\n478.             Additional coordinate systems to add (this can include systems\\n479.             already in the transform graph, but they will only appear once).\\n480.         savefn : None or str\\n481.             The file name to save this graph to or `None` to not save\\n482.             to a file.\\n483.         savelayout : str\\n484.             The graphviz program to use to layout the graph (see\\n485.             graphviz_ for details) or \\\'plain\\\' to just save the DOT graph\\n486.             content. Ignored if ``savefn`` is `None`.\\n487.         saveformat : str\\n488.             The graphviz output format. (e.g. the ``-Txxx`` option for\\n489.             the command line program - see graphviz docs for details).\\n490.             Ignored if ``savefn`` is `None`.\\n491.         color_edges : bool\\n492.             Color the edges between two nodes (frames) based on the type of\\n493.             transform. ``FunctionTransform``: red, ``StaticMatrixTransform``:\\n494.             blue, ``DynamicMatrixTransform``: green.\\n495. \\n496.         Returns\\n497.         -------\\n498.         dotgraph : str\\n499.             A string with the DOT format graph.\\n500.         """\', \'start_line_number\': 1, \'end_line_number\': 500}\n\nTest Case Context (similar existing tests for reference):\n{\'relative_path\': \'astropy/coordinates/tests/test_icrs_observed_transformations.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """Accuracy tests for ICRS transformations, primarily to/from AltAz.\\n3. \\n4. """\\n5. import numpy as np\\n6. \\n7. from astropy import units as u\\n8. from astropy.tests.helper import assert_quantity_allclose as assert_allclose\\n9. from astropy.time import Time\\n10. from astropy.coordinates import (\\n11.     EarthLocation, ICRS,  CIRS, AltAz, HADec, SkyCoord)\\n12. \\n13. from astropy.coordinates.angle_utilities import golden_spiral_grid\\n14. from astropy.coordinates import frame_transform_graph\\n15. \\n16. \\n17. def test_icrs_altaz_consistency():\\n18.     """\\n19.     Check ICRS<->AltAz for consistency with ICRS<->CIRS<->AltAz\\n20. \\n21.     The latter is extensively tested in test_intermediate_transformations.py\\n22.     """\\n23.     usph = golden_spiral_grid(200)\\n24.     dist = np.linspace(0.5, 1, len(usph)) * u.km * 1e5\\n25.     icoo = SkyCoord(ra=usph.lon, dec=usph.lat, distance=dist)\\n26. \\n27.     observer = EarthLocation(28*u.deg, 23*u.deg, height=2000.*u.km)\\n28.     obstime = Time(\\\'J2010\\\')\\n29.     aa_frame = AltAz(obstime=obstime, location=observer)\\n30. \\n31.     # check we are going direct!\\n32.     trans = frame_transform_graph.get_transform(ICRS, AltAz).transforms\\n33.     assert(len(trans) == 1)\\n34. \\n35.     # check that ICRS-AltAz and ICRS->CIRS->AltAz are consistent\\n36.     aa1 = icoo.transform_to(aa_frame)\\n37.     aa2 = icoo.transform_to(CIRS()).transform_to(aa_frame)\\n38.     assert_allclose(aa1.separation_3d(aa2), 0*u.mm, atol=1*u.mm)\\n39. \\n40.     # check roundtrip\\n41.     roundtrip = icoo.transform_to(aa_frame).transform_to(icoo)\\n42.     assert_allclose(roundtrip.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\\n43. \\n44.     # check there and back via CIRS mish-mash\\n45.     roundtrip = icoo.transform_to(aa_frame).transform_to(\\n46.         CIRS()).transform_to(icoo)\\n47.     assert_allclose(roundtrip.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\\n48. \\n49. \\n50. def test_icrs_hadec_consistency():\\n51.     """\\n52.     Check ICRS<->HADec for consistency with ICRS<->CIRS<->HADec\\n53.     """\\n54.     usph = golden_spiral_grid(200)\\n55.     dist = np.linspace(0.5, 1, len(usph)) * u.km * 1e5\\n56.     icoo = SkyCoord(ra=usph.lon, dec=usph.lat, distance=dist)\\n57. \\n58.     observer = EarthLocation(28*u.deg, 23*u.deg, height=2000.*u.km)\\n59.     obstime = Time(\\\'J2010\\\')\\n60.     hd_frame = HADec(obstime=obstime, location=observer)\\n61. \\n62.     # check we are going direct!\\n63.     trans = frame_transform_graph.get_transform(ICRS, HADec).transforms\\n64.     assert(len(trans) == 1)\\n65. \\n66.     # check that ICRS-HADec and ICRS->CIRS->HADec are consistent\\n67.     aa1 = icoo.transform_to(hd_frame)\\n68.     aa2 = icoo.transform_to(CIRS()).transform_to(hd_frame)\\n69.     assert_allclose(aa1.separation_3d(aa2), 0*u.mm, atol=1*u.mm)\\n70. \\n71.     # check roundtrip\\n72.     roundtrip = icoo.transform_to(hd_frame).transform_to(icoo)\\n73.     assert_allclose(roundtrip.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\\n74. \\n75.     # check there and back via CIRS mish-mash\\n76.     roundtrip = icoo.transform_to(hd_frame).transform_to(\\n77.         CIRS()).transform_to(icoo)\\n78.     assert_allclose(roundtrip.separation_3d(icoo), 0*u.mm, atol=1*u.mm)\', \'start_line_number\': 1, \'end_line_number\': 78}\n\n{\'relative_path\': \'astropy/coordinates/tests/test_intermediate_transformations.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """Accuracy tests for GCRS coordinate transformations, primarily to/from AltAz.\\n3. \\n4. """\\n5. import os\\n6. import warnings\\n7. from importlib import metadata\\n8. \\n9. import pytest\\n10. import numpy as np\\n11. import erfa\\n12. \\n13. from astropy import units as u\\n14. from astropy.tests.helper import assert_quantity_allclose as assert_allclose\\n15. from astropy.time import Time\\n16. from astropy.coordinates import (\\n17.     EarthLocation, get_sun, ICRS, GCRS, CIRS, ITRS, AltAz, HADec,\\n18.     PrecessedGeocentric, CartesianRepresentation, SkyCoord,\\n19.     CartesianDifferential, SphericalRepresentation, UnitSphericalRepresentation,\\n20.     HCRS, HeliocentricMeanEcliptic, TEME, TETE)\\n21. from astropy.coordinates.solar_system import _apparent_position_in_true_coordinates, get_body\\n22. from astropy.utils import iers\\n23. from astropy.utils.exceptions import AstropyWarning, AstropyDeprecationWarning\\n24. from astropy.utils.compat.optional_deps import HAS_JPLEPHEM\\n25. \\n26. from astropy.coordinates.angle_utilities import golden_spiral_grid\\n27. from astropy.coordinates.builtin_frames.intermediate_rotation_transforms import (\\n28.     get_location_gcrs, tete_to_itrs_mat, gcrs_to_cirs_mat, cirs_to_itrs_mat)\\n29. from astropy.coordinates.builtin_frames.utils import get_jd12\\n30. from astropy.coordinates import solar_system_ephemeris\\n31. from astropy.units import allclose\\n32. \\n33. CI = os.environ.get(\\\'CI\\\', False) == "true"\\n34. \\n35. \\n36. def test_icrs_cirs():\\n37.     """\\n38.     Check a few cases of ICRS<->CIRS for consistency.\\n39. \\n40.     Also includes the CIRS<->CIRS transforms at different times, as those go\\n41.     through ICRS\\n42.     """\\n43.     usph = golden_spiral_grid(200)\\n44.     dist = np.linspace(0., 1, len(usph)) * u.pc\\n45.     inod = ICRS(usph)\\n46.     iwd = ICRS(ra=usph.lon, dec=usph.lat, distance=dist)\\n47. \\n48.     cframe1 = CIRS()\\n49.     cirsnod = inod.transform_to(cframe1)  # uses the default time\\n50.     # first do a round-tripping test\\n51.     inod2 = cirsnod.transform_to(ICRS())\\n52.     assert_allclose(inod.ra, inod2.ra)\\n53.     assert_allclose(inod.dec, inod2.dec)\\n54. \\n55.     # now check that a different time yields different answers\\n56.     cframe2 = CIRS(obstime=Time(\\\'J2005\\\'))\\n57.     cirsnod2 = inod.transform_to(cframe2)\\n58.     assert not allclose(cirsnod.ra, cirsnod2.ra, rtol=1e-8)\\n59.     assert not allclose(cirsnod.dec, cirsnod2.dec, rtol=1e-8)\\n60. \\n61.     # parallax effects should be included, so with and w/o distance should be different\\n62.     cirswd = iwd.transform_to(cframe1)\\n63.     assert not allclose(cirswd.ra, cirsnod.ra, rtol=1e-8)\\n64.     assert not allclose(cirswd.dec, cirsnod.dec, rtol=1e-8)\\n65.     # and the distance should transform at least somehow\\n66.     assert not allclose(cirswd.distance, iwd.distance, rtol=1e-8)\\n67. \\n68.     # now check that the cirs self-transform works as expected\\n69.     cirsnod3 = cirsnod.transform_to(cframe1)  # should be a no-op\\n70.     assert_allclose(cirsnod.ra, cirsnod3.ra)\\n71.     assert_allclose(cirsnod.dec, cirsnod3.dec)\\n72. \\n73.     cirsnod4 = cirsnod.transform_to(cframe2)  # should be different\\n74.     assert not allclose(cirsnod4.ra, cirsnod.ra, rtol=1e-8)\\n75.     assert not allclose(cirsnod4.dec, cirsnod.dec, rtol=1e-8)\\n76. \\n77.     cirsnod5 = cirsnod4.transform_to(cframe1)  # should be back to the same\\n78.     assert_allclose(cirsnod.ra, cirsnod5.ra)\\n79.     assert_allclose(cirsnod.dec, cirsnod5.dec)\\n80. \\n81. \\n82. usph = golden_spiral_grid(200)\\n83. dist = np.linspace(0.5, 1, len(usph)) * u.pc\\n84. icrs_coords = [ICRS(usph), ICRS(usph.lon, usph.lat, distance=dist)]\\n85. gcrs_frames = [GCRS(), GCRS(obstime=Time(\\\'J2005\\\'))]\\n86. \\n87. \\n88. @pytest.mark.parametrize(\\\'icoo\\\', icrs_coords)\\n89. def test_icrs_gcrs(icoo):\\n90.     """\\n91.     Check ICRS<->GCRS for consistency\\n92.     """\\n93.     gcrscoo = icoo.transform_to(gcrs_frames[0])  # uses the default time\\n94.     # first do a round-tripping test\\n95.     icoo2 = gcrscoo.transform_to(ICRS())\\n96.     assert_allclose(icoo.distance, icoo2.distance)\\n97.     assert_allclose(icoo.ra, icoo2.ra)\\n98.     assert_allclose(icoo.dec, icoo2.dec)\\n99.     assert isinstance(icoo2.data, icoo.data.__class__)\\n100. \\n101.     # now check that a different time yields different answers\\n102.     gcrscoo2 = icoo.transform_to(gcrs_frames[1])\\n103.     assert not allclose(gcrscoo.ra, gcrscoo2.ra, rtol=1e-8, atol=1e-10*u.deg)\\n104.     assert not allclose(gcrscoo.dec, gcrscoo2.dec, rtol=1e-8, atol=1e-10*u.deg)\\n105. \\n106.     # now check that the cirs self-transform works as expected\\n107.     gcrscoo3 = gcrscoo.transform_to(gcrs_frames[0])  # should be a no-op\\n108.     assert_allclose(gcrscoo.ra, gcrscoo3.ra)\\n109.     assert_allclose(gcrscoo.dec, gcrscoo3.dec)\\n110. \\n111.     gcrscoo4 = gcrscoo.transform_to(gcrs_frames[1])  # should be different\\n112.     assert not allclose(gcrscoo4.ra, gcrscoo.ra, rtol=1e-8, atol=1e-10*u.deg)\\n113.     assert not allclose(gcrscoo4.dec, gcrscoo.dec, rtol=1e-8, atol=1e-10*u.deg)\\n114. \\n115.     gcrscoo5 = gcrscoo4.transform_to(gcrs_frames[0])  # should be back to the same\\n116.     assert_allclose(gcrscoo.ra, gcrscoo5.ra, rtol=1e-8, atol=1e-10*u.deg)\\n117.     assert_allclose(gcrscoo.dec, gcrscoo5.dec, rtol=1e-8, atol=1e-10*u.deg)\\n118. \\n119.     # also make sure that a GCRS with a different geoloc/geovel gets a different answer\\n120.     # roughly a moon-like frame\\n121.     gframe3 = GCRS(obsgeoloc=[385000., 0, 0]*u.km, obsgeovel=[1, 0, 0]*u.km/u.s)\\n122.     gcrscoo6 = icoo.transform_to(gframe3)  # should be different\\n123.     assert not allclose(gcrscoo.ra, gcrscoo6.ra, rtol=1e-8, atol=1e-10*u.deg)\\n124.     assert not allclose(gcrscoo.dec, gcrscoo6.dec, rtol=1e-8, atol=1e-10*u.deg)\\n125.     icooviag3 = gcrscoo6.transform_to(ICRS())  # and now back to the original\\n126.     assert_allclose(icoo.ra, icooviag3.ra)\\n127.     assert_allclose(icoo.dec, icooviag3.dec)\\n128. \\n129. \\n130. @pytest.mark.parametrize(\\\'gframe\\\', gcrs_frames)\\n131. def test_icrs_gcrs_dist_diff(gframe):\\n132.     """\\n133.     Check that with and without distance give different ICRS<->GCRS answers\\n134.     """\\n135.     gcrsnod = icrs_coords[0].transform_to(gframe)\\n136.     gcrswd = icrs_coords[1].transform_to(gframe)\\n137. \\n138.     # parallax effects should be included, so with and w/o distance should be different\\n139.     assert not allclose(gcrswd.ra, gcrsnod.ra, rtol=1e-8, atol=1e-10*u.deg)\\n140.     assert not allclose(gcrswd.dec, gcrsnod.dec, rtol=1e-8, atol=1e-10*u.deg)\\n141.     # and the distance should transform at least somehow\\n142.     assert not allclose(gcrswd.distance, icrs_coords[1].distance, rtol=1e-8,\\n143.                         atol=1e-10*u.pc)\\n144. \\n145. \\n146. def test_cirs_to_altaz():\\n147.     """\\n148.     Check the basic CIRS<->AltAz transforms.  More thorough checks implicitly\\n149.     happen in `test_iau_fullstack`\\n150.     """\\n151.     from astropy.coordinates import EarthLocation\\n152. \\n153.     usph = golden_spiral_grid(200)\\n154.     dist = np.linspace(0.5, 1, len(usph)) * u.pc\\n155.     cirs = CIRS(usph, obstime=\\\'J2000\\\')\\n156.     crepr = SphericalRepresentation(lon=usph.lon, lat=usph.lat, distance=dist)\\n157.     cirscart = CIRS(crepr, obstime=cirs.obstime, representation_type=CartesianRepresentation)\\n158. \\n159.     loc = EarthLocation(lat=0*u.deg, lon=0*u.deg, height=0*u.m)\\n160.     altazframe = AltAz(location=loc, obstime=Time(\\\'J2005\\\'))\\n161. \\n162.     cirs2 = cirs.transform_to(altazframe).transform_to(cirs)\\n163.     cirs3 = cirscart.transform_to(altazframe).transform_to(cirs)\\n164. \\n165.     # check round-tripping\\n166.     assert_allclose(cirs.ra, cirs2.ra)\\n167.     assert_allclose(cirs.dec, cirs2.dec)\\n168.     assert_allclose(cirs.ra, cirs3.ra)\\n169.     assert_allclose(cirs.dec, cirs3.dec)\\n170. \\n171. \\n172. def test_cirs_to_hadec():\\n173.     """\\n174.     Check the basic CIRS<->HADec transforms.\\n175.     """\\n176.     from astropy.coordinates import EarthLocation\\n177. \\n178.     usph = golden_spiral_grid(200)\\n179.     dist = np.linspace(0.5, 1, len(usph)) * u.pc\\n180.     cirs = CIRS(usph, obstime=\\\'J2000\\\')\\n181.     crepr = SphericalRepresentation(lon=usph.lon, lat=usph.lat, distance=dist)\\n182.     cirscart = CIRS(crepr, obstime=cirs.obstime, representation_type=CartesianRepresentation)\\n183. \\n184.     loc = EarthLocation(lat=0*u.deg, lon=0*u.deg, height=0*u.m)\\n185.     hadecframe = HADec(location=loc, obstime=Time(\\\'J2005\\\'))\\n186. \\n187.     cirs2 = cirs.transform_to(hadecframe).transform_to(cirs)\\n188.     cirs3 = cirscart.transform_to(hadecframe).transform_to(cirs)\\n189. \\n190.     # check round-tripping\\n191.     assert_allclose(cirs.ra, cirs2.ra)\\n192.     assert_allclose(cirs.dec, cirs2.dec)\\n193.     assert_allclose(cirs.ra, cirs3.ra)\\n194.     assert_allclose(cirs.dec, cirs3.dec)\\n195. \\n196. \\n197. def test_gcrs_itrs():\\n198.     """\\n199.     Check basic GCRS<->ITRS transforms for round-tripping.\\n200.     """\\n201.     usph = golden_spiral_grid(200)\\n202.     gcrs = GCRS(usph, obstime=\\\'J2000\\\')\\n203.     gcrs6 = GCRS(usph, obstime=\\\'J2006\\\')\\n204. \\n205.     gcrs2 = gcrs.transform_to(ITRS()).transform_to(gcrs)\\n206.     gcrs6_2 = gcrs6.transform_to(ITRS()).transform_to(gcrs)\\n207. \\n208.     assert_allclose(gcrs.ra, gcrs2.ra)\\n209.     assert_allclose(gcrs.dec, gcrs2.dec)\\n210.     # these should be different:\\n211.     assert not allclose(gcrs.ra, gcrs6_2.ra, rtol=1e-8)\\n212.     assert not allclose(gcrs.dec, gcrs6_2.dec, rtol=1e-8)\\n213. \\n214.     # also try with the cartesian representation\\n215.     gcrsc = gcrs.realize_frame(gcrs.data)\\n216.     gcrsc.representation_type = CartesianRepresentation\\n217.     gcrsc2 = gcrsc.transform_to(ITRS()).transform_to(gcrsc)\\n218.     assert_allclose(gcrsc.spherical.lon, gcrsc2.ra)\\n219.     assert_allclose(gcrsc.spherical.lat, gcrsc2.dec)\\n220. \\n221. \\n222. def test_cirs_itrs():\\n223.     """\\n224.     Check basic CIRS<->ITRS transforms for round-tripping.\\n225.     """\\n226.     usph = golden_spiral_grid(200)\\n227.     cirs = CIRS(usph, obstime=\\\'J2000\\\')\\n228.     cirs6 = CIRS(usph, obstime=\\\'J2006\\\')\\n229. \\n230.     cirs2 = cirs.transform_to(ITRS()).transform_to(cirs)\\n231.     cirs6_2 = cirs6.transform_to(ITRS()).transform_to(cirs)  # different obstime\\n232. \\n233.     # just check round-tripping\\n234.     assert_allclose(cirs.ra, cirs2.ra)\\n235.     assert_allclose(cirs.dec, cirs2.dec)\\n236.     assert not allclose(cirs.ra, cirs6_2.ra)\\n237.     assert not allclose(cirs.dec, cirs6_2.dec)\\n238. \\n239. \\n240. def test_gcrs_cirs():\\n241.     """\\n242.     Check GCRS<->CIRS transforms for round-tripping.  More complicated than the\\n243.     above two because it\\\'s multi-hop\\n244.     """\\n245.     usph = golden_spiral_grid(200)\\n246.     gcrs = GCRS(usph, obstime=\\\'J2000\\\')\\n247.     gcrs6 = GCRS(usph, obstime=\\\'J2006\\\')\\n248. \\n249.     gcrs2 = gcrs.transform_to(CIRS()).transform_to(gcrs)\\n250.     gcrs6_2 = gcrs6.transform_to(CIRS()).transform_to(gcrs)\\n251. \\n252.     assert_allclose(gcrs.ra, gcrs2.ra)\\n253.     assert_allclose(gcrs.dec, gcrs2.dec)\\n254.     # these should be different:\\n255.     assert not allclose(gcrs.ra, gcrs6_2.ra, rtol=1e-8)\\n256.     assert not allclose(gcrs.dec, gcrs6_2.dec, rtol=1e-8)\\n257. \\n258.     # now try explicit intermediate pathways and ensure they\\\'re all consistent\\n259.     gcrs3 = gcrs.transform_to(ITRS()).transform_to(CIRS()).transform_to(ITRS()).transform_to(gcrs)\\n260.     assert_allclose(gcrs.ra, gcrs3.ra)\\n261.     assert_allclose(gcrs.dec, gcrs3.dec)\\n262. \\n263.     gcrs4 = gcrs.transform_to(ICRS()).transform_to(CIRS()).transform_to(ICRS()).transform_to(gcrs)\\n264.     assert_allclose(gcrs.ra, gcrs4.ra)\\n265.     assert_allclose(gcrs.dec, gcrs4.dec)\\n266. \\n267. \\n268. def test_gcrs_altaz():\\n269.     """\\n270.     Check GCRS<->AltAz transforms for round-tripping.  Has multiple paths\\n271.     """\\n272.     from astropy.coordinates import EarthLocation\\n273. \\n274.     usph = golden_spiral_grid(128)\\n275.     gcrs = GCRS(usph, obstime=\\\'J2000\\\')[None]  # broadcast with times below\\n276. \\n277.     # check array times sure N-d arrays work\\n278.     times = Time(np.linspace(2456293.25, 2456657.25, 51) * u.day,\\n279.                  format=\\\'jd\\\')[:, None]\\n280. \\n281.     loc = EarthLocation(lon=10 * u.deg, lat=80. * u.deg)\\n282.     aaframe = AltAz(obstime=times, location=loc)\\n283. \\n284.     aa1 = gcrs.transform_to(aaframe)\\n285.     aa2 = gcrs.transform_to(ICRS()).transform_to(CIRS()).transform_to(aaframe)\\n286.     aa3 = gcrs.transform_to(ITRS()).transform_to(CIRS()).transform_to(aaframe)\\n287. \\n288.     # make sure they\\\'re all consistent\\n289.     assert_allclose(aa1.alt, aa2.alt)\\n290.     assert_allclose(aa1.az, aa2.az)\\n291.     assert_allclose(aa1.alt, aa3.alt)\\n292.     assert_allclose(aa1.az, aa3.az)\\n293. \\n294. \\n295. def test_gcrs_hadec():\\n296.     """\\n297.     Check GCRS<->HADec transforms for round-tripping.  Has multiple paths\\n298.     """\\n299.     from astropy.coordinates import EarthLocation\\n300. \\n301.     usph = golden_spiral_grid(128)\\n302.     gcrs = GCRS(usph, obstime=\\\'J2000\\\')  # broadcast with times below\\n303. \\n304.     # check array times sure N-d arrays work\\n305.     times = Time(np.linspace(2456293.25, 2456657.25, 51) * u.day,\\n306.                  format=\\\'jd\\\')[:, np.newaxis]\\n307. \\n308.     loc = EarthLocation(lon=10 * u.deg, lat=80. * u.deg)\\n309.     hdframe = HADec(obstime=times, location=loc)\\n310. \\n311.     hd1 = gcrs.transform_to(hdframe)\\n312.     hd2 = gcrs.transform_to(ICRS()).transform_to(CIRS()).transform_to(hdframe)\\n313.     hd3 = gcrs.transform_to(ITRS()).transform_to(CIRS()).transform_to(hdframe)\\n314. \\n315.     # make sure they\\\'re all consistent\\n316.     assert_allclose(hd1.dec, hd2.dec)\\n317.     assert_allclose(hd1.ha, hd2.ha)\\n318.     assert_allclose(hd1.dec, hd3.dec)\\n319.     assert_allclose(hd1.ha, hd3.ha)\\n320. \\n321. \\n322. def test_precessed_geocentric():\\n323.     assert PrecessedGeocentric().equinox.jd == Time(\\\'J2000\\\').jd\\n324. \\n325.     gcrs_coo = GCRS(180*u.deg, 2*u.deg, distance=10000*u.km)\\n326.     pgeo_coo = gcrs_coo.transform_to(PrecessedGeocentric())\\n327.     assert np.abs(gcrs_coo.ra - pgeo_coo.ra) > 10*u.marcsec\\n328.     assert np.abs(gcrs_coo.dec - pgeo_coo.dec) > 10*u.marcsec\\n329.     assert_allclose(gcrs_coo.distance, pgeo_coo.distance)\\n330. \\n331.     gcrs_roundtrip = pgeo_coo.transform_to(GCRS())\\n332.     assert_allclose(gcrs_coo.ra, gcrs_roundtrip.ra)\\n333.     assert_allclose(gcrs_coo.dec, gcrs_roundtrip.dec)\\n334.     assert_allclose(gcrs_coo.distance, gcrs_roundtrip.distance)\\n335. \\n336.     pgeo_coo2 = gcrs_coo.transform_to(PrecessedGeocentric(equinox=\\\'B1850\\\'))\\n337.     assert np.abs(gcrs_coo.ra - pgeo_coo2.ra) > 1.5*u.deg\\n338.     assert np.abs(gcrs_coo.dec - pgeo_coo2.dec) > 0.5*u.deg\\n339.     assert_allclose(gcrs_coo.distance, pgeo_coo2.distance)\\n340. \\n341.     gcrs2_roundtrip = pgeo_coo2.transform_to(GCRS())\\n342.     assert_allclose(gcrs_coo.ra, gcrs2_roundtrip.ra)\\n343.     assert_allclose(gcrs_coo.dec, gcrs2_roundtrip.dec)\\n344.     assert_allclose(gcrs_coo.distance, gcrs2_roundtrip.distance)\\n345. \\n346. \\n347. def test_precessed_geocentric_different_obstime():\\n348.     # Create two PrecessedGeocentric frames with different obstime\\n349.     precessedgeo1 = PrecessedGeocentric(obstime=\\\'2021-09-07\\\')\\n350.     precessedgeo2 = PrecessedGeocentric(obstime=\\\'2021-06-07\\\')\\n351. \\n352.     # GCRS->PrecessedGeocentric should give different results for the two frames\\n353.     gcrs_coord = GCRS(10*u.deg, 20*u.deg, 3*u.AU, obstime=precessedgeo1.obstime)\\n354.     pg_coord1 = gcrs_coord.transform_to(precessedgeo1)\\n355.     pg_coord2 = gcrs_coord.transform_to(precessedgeo2)\\n356.     assert not pg_coord1.is_equivalent_frame(pg_coord2)\\n357.     assert not allclose(pg_coord1.cartesian.xyz, pg_coord2.cartesian.xyz)\\n358. \\n359.     # Looping back to GCRS should return the original coordinate\\n360.     loopback1 = pg_coord1.transform_to(gcrs_coord)\\n361.     loopback2 = pg_coord2.transform_to(gcrs_coord)\\n362.     assert loopback1.is_equivalent_frame(gcrs_coord)\\n363.     assert loopback2.is_equivalent_frame(gcrs_coord)\\n364.     assert_allclose(loopback1.cartesian.xyz, gcrs_coord.cartesian.xyz)\\n365.     assert_allclose(loopback2.cartesian.xyz, gcrs_coord.cartesian.xyz)\\n366. \\n367. \\n368. # shared by parametrized tests below.  Some use the whole AltAz, others use just obstime\\n369. totest_frames = [AltAz(location=EarthLocation(-90*u.deg, 65*u.deg),\\n370.                        obstime=Time(\\\'J2000\\\')),  # J2000 is often a default so this might work when others don\\\'t\\n371.                  AltAz(location=EarthLocation(120*u.deg, -35*u.deg),\\n372.                        obstime=Time(\\\'J2000\\\')),\\n373.                  AltAz(location=EarthLocation(-90*u.deg, 65*u.deg),\\n374.                        obstime=Time(\\\'2014-01-01 00:00:00\\\')),\\n375.                  AltAz(location=EarthLocation(-90*u.deg, 65*u.deg),\\n376.                        obstime=Time(\\\'2014-08-01 08:00:00\\\')),\\n377.                  AltAz(location=EarthLocation(120*u.deg, -35*u.deg),\\n378.                        obstime=Time(\\\'2014-01-01 00:00:00\\\'))\\n379.                  ]\\n380. MOONDIST = 385000*u.km  # approximate moon semi-major orbit axis of moon\\n381. MOONDIST_CART = CartesianRepresentation(3**-0.5*MOONDIST, 3**-0.5*MOONDIST, 3**-0.5*MOONDIST)\\n382. EARTHECC = 0.017 + 0.005  # roughly earth orbital eccentricity, but with an added tolerance\\n383. \\n384. \\n385. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n386. def test_gcrs_altaz_sunish(testframe):\\n387.     """\\n388.     Sanity-check that the sun is at a reasonable distance from any altaz\\n389.     """\\n390.     sun = get_sun(testframe.obstime)\\n391. \\n392.     assert sun.frame.name == \\\'gcrs\\\'\\n393. \\n394.     # the .to(u.au) is not necessary, it just makes the asserts on failure more readable\\n395.     assert (EARTHECC - 1)*u.au < sun.distance.to(u.au) < (EARTHECC + 1)*u.au\\n396. \\n397.     sunaa = sun.transform_to(testframe)\\n398.     assert (EARTHECC - 1)*u.au < sunaa.distance.to(u.au) < (EARTHECC + 1)*u.au\\n399. \\n400. \\n401. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n402. def test_gcrs_altaz_moonish(testframe):\\n403.     """\\n404.     Sanity-check that an object resembling the moon goes to the right place with\\n405.     a GCRS->AltAz transformation\\n406.     """\\n407.     moon = GCRS(MOONDIST_CART, obstime=testframe.obstime)\\n408. \\n409.     moonaa = moon.transform_to(testframe)\\n410. \\n411.     # now check that the distance change is similar to earth radius\\n412.     assert 1000*u.km < np.abs(moonaa.distance - moon.distance).to(u.au) < 7000*u.km\\n413. \\n414.     # now check that it round-trips\\n415.     moon2 = moonaa.transform_to(moon)\\n416.     assert_allclose(moon.cartesian.xyz, moon2.cartesian.xyz)\\n417. \\n418.     # also should add checks that the alt/az are different for different earth locations\\n419. \\n420. \\n421. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n422. def test_gcrs_altaz_bothroutes(testframe):\\n423.     """\\n424.     Repeat of both the moonish and sunish tests above to make sure the two\\n425.     routes through the coordinate graph are consistent with each other\\n426.     """\\n427.     sun = get_sun(testframe.obstime)\\n428.     sunaa_viaicrs = sun.transform_to(ICRS()).transform_to(testframe)\\n429.     sunaa_viaitrs = sun.transform_to(ITRS(obstime=testframe.obstime)).transform_to(testframe)\\n430. \\n431.     moon = GCRS(MOONDIST_CART, obstime=testframe.obstime)\\n432.     moonaa_viaicrs = moon.transform_to(ICRS()).transform_to(testframe)\\n433.     moonaa_viaitrs = moon.transform_to(ITRS(obstime=testframe.obstime)).transform_to(testframe)\\n434. \\n435.     assert_allclose(sunaa_viaicrs.cartesian.xyz, sunaa_viaitrs.cartesian.xyz)\\n436.     assert_allclose(moonaa_viaicrs.cartesian.xyz, moonaa_viaitrs.cartesian.xyz)\\n437. \\n438. \\n439. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n440. def test_cirs_altaz_moonish(testframe):\\n441.     """\\n442.     Sanity-check that an object resembling the moon goes to the right place with\\n443.     a CIRS<->AltAz transformation\\n444.     """\\n445.     moon = CIRS(MOONDIST_CART, obstime=testframe.obstime)\\n446. \\n447.     moonaa = moon.transform_to(testframe)\\n448.     assert 1000*u.km < np.abs(moonaa.distance - moon.distance).to(u.km) < 7000*u.km\\n449. \\n450.     # now check that it round-trips\\n451.     moon2 = moonaa.transform_to(moon)\\n452.     assert_allclose(moon.cartesian.xyz, moon2.cartesian.xyz)\\n453. \\n454. \\n455. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n456. def test_cirs_altaz_nodist(testframe):\\n457.     """\\n458.     Check that a UnitSphericalRepresentation coordinate round-trips for the\\n459.     CIRS<->AltAz transformation.\\n460.     """\\n461.     coo0 = CIRS(UnitSphericalRepresentation(10*u.deg, 20*u.deg), obstime=testframe.obstime)\\n462. \\n463.     # check that it round-trips\\n464.     coo1 = coo0.transform_to(testframe).transform_to(coo0)\\n465.     assert_allclose(coo0.cartesian.xyz, coo1.cartesian.xyz)\\n466. \\n467. \\n468. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n469. def test_cirs_icrs_moonish(testframe):\\n470.     """\\n471.     check that something like the moon goes to about the right distance from the\\n472.     ICRS origin when starting from CIRS\\n473.     """\\n474.     moonish = CIRS(MOONDIST_CART, obstime=testframe.obstime)\\n475.     moonicrs = moonish.transform_to(ICRS())\\n476. \\n477.     assert 0.97*u.au < moonicrs.distance < 1.03*u.au\\n478. \\n479. \\n480. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n481. def test_gcrs_icrs_moonish(testframe):\\n482.     """\\n483.     check that something like the moon goes to about the right distance from the\\n484.     ICRS origin when starting from GCRS\\n485.     """\\n486.     moonish = GCRS(MOONDIST_CART, obstime=testframe.obstime)\\n487.     moonicrs = moonish.transform_to(ICRS())\\n488. \\n489.     assert 0.97*u.au < moonicrs.distance < 1.03*u.au\\n490. \\n491. \\n492. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n493. def test_icrs_gcrscirs_sunish(testframe):\\n494.     """\\n495.     check that the ICRS barycenter goes to about the right distance from various\\n496.     ~geocentric frames (other than testframe)\\n497.     """\\n498.     # slight offset to avoid divide-by-zero errors\\n499.     icrs = ICRS(0*u.deg, 0*u.deg, distance=10*u.km)\\n500. \', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/coordinates/tests/test_intermediate_transformations.py\', \'content\': \'501.     gcrs = icrs.transform_to(GCRS(obstime=testframe.obstime))\\n502.     assert (EARTHECC - 1)*u.au < gcrs.distance.to(u.au) < (EARTHECC + 1)*u.au\\n503. \\n504.     cirs = icrs.transform_to(CIRS(obstime=testframe.obstime))\\n505.     assert (EARTHECC - 1)*u.au < cirs.distance.to(u.au) < (EARTHECC + 1)*u.au\\n506. \\n507.     itrs = icrs.transform_to(ITRS(obstime=testframe.obstime))\\n508.     assert (EARTHECC - 1)*u.au < itrs.spherical.distance.to(u.au) < (EARTHECC + 1)*u.au\\n509. \\n510. \\n511. @pytest.mark.parametrize(\\\'testframe\\\', totest_frames)\\n512. def test_icrs_altaz_moonish(testframe):\\n513.     """\\n514.     Check that something expressed in *ICRS* as being moon-like goes to the\\n515.     right AltAz distance\\n516.     """\\n517.     # we use epv00 instead of get_sun because get_sun includes aberration\\n518.     earth_pv_helio, earth_pv_bary = erfa.epv00(*get_jd12(testframe.obstime, \\\'tdb\\\'))\\n519.     earth_icrs_xyz = earth_pv_bary[0]*u.au\\n520.     moonoffset = [0, 0, MOONDIST.value]*MOONDIST.unit\\n521.     moonish_icrs = ICRS(CartesianRepresentation(earth_icrs_xyz + moonoffset))\\n522.     moonaa = moonish_icrs.transform_to(testframe)\\n523. \\n524.     # now check that the distance change is similar to earth radius\\n525.     assert 1000*u.km < np.abs(moonaa.distance - MOONDIST).to(u.au) < 7000*u.km\\n526. \\n527. \\n528. def test_gcrs_self_transform_closeby():\\n529.     """\\n530.     Tests GCRS self transform for objects which are nearby and thus\\n531.     have reasonable parallax.\\n532. \\n533.     Moon positions were originally created using JPL DE432s ephemeris.\\n534. \\n535.     The two lunar positions (one geocentric, one at a defined location)\\n536.     are created via a transformation from ICRS to two different GCRS frames.\\n537. \\n538.     We test that the GCRS-GCRS self transform can correctly map one GCRS\\n539.     frame onto the other.\\n540.     """\\n541.     t = Time("2014-12-25T07:00")\\n542.     moon_geocentric = SkyCoord(GCRS(318.10579159*u.deg,\\n543.                                     -11.65281165*u.deg,\\n544.                                     365042.64880308*u.km, obstime=t))\\n545. \\n546.     # this is the location of the Moon as seen from La Palma\\n547.     obsgeoloc = [-5592982.59658935, -63054.1948592, 3059763.90102216]*u.m\\n548.     obsgeovel = [4.59798494, -407.84677071, 0.]*u.m/u.s\\n549.     moon_lapalma = SkyCoord(GCRS(318.7048445*u.deg,\\n550.                                  -11.98761996*u.deg,\\n551.                                  369722.8231031*u.km,\\n552.                                  obstime=t,\\n553.                                  obsgeoloc=obsgeoloc,\\n554.                                  obsgeovel=obsgeovel))\\n555. \\n556.     transformed = moon_geocentric.transform_to(moon_lapalma.frame)\\n557.     delta = transformed.separation_3d(moon_lapalma)\\n558.     assert_allclose(delta, 0.0*u.m, atol=1*u.m)\\n559. \\n560. \\n561. def test_teme_itrf():\\n562.     """\\n563.     Test case transform from TEME to ITRF.\\n564. \\n565.     Test case derives from example on appendix C of Vallado, Crawford, Hujsak & Kelso (2006).\\n566.     See https://celestrak.com/publications/AIAA/2006-6753/AIAA-2006-6753-Rev2.pdf\\n567.     """\\n568.     v_itrf = CartesianDifferential(-3.225636520, -2.872451450, 5.531924446,\\n569.                                    unit=u.km/u.s)\\n570.     p_itrf = CartesianRepresentation(-1033.479383, 7901.2952740, 6380.35659580,\\n571.                                      unit=u.km, differentials={\\\'s\\\': v_itrf})\\n572.     t = Time("2004-04-06T07:51:28.386")\\n573. \\n574.     teme = ITRS(p_itrf, obstime=t).transform_to(TEME(obstime=t))\\n575.     v_teme = CartesianDifferential(-4.746131487, 0.785818041, 5.531931288,\\n576.                                    unit=u.km/u.s)\\n577.     p_teme = CartesianRepresentation(5094.18016210, 6127.64465050, 6380.34453270,\\n578.                                      unit=u.km, differentials={\\\'s\\\': v_teme})\\n579. \\n580.     assert_allclose(teme.cartesian.without_differentials().xyz,\\n581.                     p_teme.without_differentials().xyz, atol=30*u.cm)\\n582. \\n583.     assert_allclose(teme.cartesian.differentials[\\\'s\\\'].d_xyz,\\n584.                     p_teme.differentials[\\\'s\\\'].d_xyz, atol=1.0*u.cm/u.s)\\n585. \\n586.     # test round trip\\n587.     itrf = teme.transform_to(ITRS(obstime=t))\\n588.     assert_allclose(\\n589.         itrf.cartesian.without_differentials().xyz,\\n590.         p_itrf.without_differentials().xyz,\\n591.         atol=100*u.cm\\n592.     )\\n593.     assert_allclose(\\n594.         itrf.cartesian.differentials[\\\'s\\\'].d_xyz,\\n595.         p_itrf.differentials[\\\'s\\\'].d_xyz,\\n596.         atol=1*u.cm/u.s\\n597.     )\\n598. \\n599. \\n600. def test_precessedgeocentric_loopback():\\n601.     from_coo = PrecessedGeocentric(1*u.deg, 2*u.deg, 3*u.AU,\\n602.                                    obstime=\\\'2001-01-01\\\', equinox=\\\'2001-01-01\\\')\\n603. \\n604.     # Change just the obstime\\n605.     to_frame = PrecessedGeocentric(obstime=\\\'2001-06-30\\\', equinox=\\\'2001-01-01\\\')\\n606. \\n607.     explicit_coo = from_coo.transform_to(ICRS()).transform_to(to_frame)\\n608.     implicit_coo = from_coo.transform_to(to_frame)\\n609. \\n610.     # Confirm that the explicit transformation changes the coordinate\\n611.     assert not allclose(explicit_coo.ra, from_coo.ra, rtol=1e-10)\\n612.     assert not allclose(explicit_coo.dec, from_coo.dec, rtol=1e-10)\\n613.     assert not allclose(explicit_coo.distance, from_coo.distance, rtol=1e-10)\\n614. \\n615.     # Confirm that the loopback matches the explicit transformation\\n616.     assert_allclose(explicit_coo.ra, implicit_coo.ra, rtol=1e-10)\\n617.     assert_allclose(explicit_coo.dec, implicit_coo.dec, rtol=1e-10)\\n618.     assert_allclose(explicit_coo.distance, implicit_coo.distance, rtol=1e-10)\\n619. \\n620.     # Change just the equinox\\n621.     to_frame = PrecessedGeocentric(obstime=\\\'2001-01-01\\\', equinox=\\\'2001-06-30\\\')\\n622. \\n623.     explicit_coo = from_coo.transform_to(ICRS()).transform_to(to_frame)\\n624.     implicit_coo = from_coo.transform_to(to_frame)\\n625. \\n626.     # Confirm that the explicit transformation changes the direction but not the distance\\n627.     assert not allclose(explicit_coo.ra, from_coo.ra, rtol=1e-10)\\n628.     assert not allclose(explicit_coo.dec, from_coo.dec, rtol=1e-10)\\n629.     assert allclose(explicit_coo.distance, from_coo.distance, rtol=1e-10)\\n630. \\n631.     # Confirm that the loopback matches the explicit transformation\\n632.     assert_allclose(explicit_coo.ra, implicit_coo.ra, rtol=1e-10)\\n633.     assert_allclose(explicit_coo.dec, implicit_coo.dec, rtol=1e-10)\\n634.     assert_allclose(explicit_coo.distance, implicit_coo.distance, rtol=1e-10)\\n635. \\n636. \\n637. def test_teme_loopback():\\n638.     from_coo = TEME(1*u.AU, 2*u.AU, 3*u.AU, obstime=\\\'2001-01-01\\\')\\n639.     to_frame = TEME(obstime=\\\'2001-06-30\\\')\\n640. \\n641.     explicit_coo = from_coo.transform_to(ICRS()).transform_to(to_frame)\\n642.     implicit_coo = from_coo.transform_to(to_frame)\\n643. \\n644.     # Confirm that the explicit transformation changes the coordinate\\n645.     assert not allclose(explicit_coo.cartesian.xyz, from_coo.cartesian.xyz, rtol=1e-10)\\n646. \\n647.     # Confirm that the loopback matches the explicit transformation\\n648.     assert_allclose(explicit_coo.cartesian.xyz, implicit_coo.cartesian.xyz, rtol=1e-10)\\n649. \\n650. \\n651. @pytest.mark.remote_data\\n652. def test_earth_orientation_table(monkeypatch):\\n653.     """Check that we can set the IERS table used as Earth Reference.\\n654. \\n655.     Use the here and now to be sure we get a difference.\\n656.     """\\n657.     monkeypatch.setattr(\\\'astropy.utils.iers.conf.auto_download\\\', True)\\n658.     t = Time.now()\\n659.     location = EarthLocation(lat=0*u.deg, lon=0*u.deg)\\n660.     altaz = AltAz(location=location, obstime=t)\\n661.     sc = SkyCoord(1*u.deg, 2*u.deg)\\n662.     # Default: uses IERS_Auto, which will give a prediction.\\n663.     # Note: tests run with warnings turned into errors, so it is\\n664.     # meaningful if this passes.\\n665.     if CI:\\n666.         with warnings.catch_warnings():\\n667.             # Server occasionally blocks IERS download in CI.\\n668.             warnings.filterwarnings(\\\'ignore\\\', message=r\\\'.*using local IERS-B.*\\\')\\n669.             # This also captures unclosed socket warning that is ignored in setup.cfg\\n670.             warnings.filterwarnings(\\\'ignore\\\', message=r\\\'.*unclosed.*\\\')\\n671.             altaz_auto = sc.transform_to(altaz)\\n672.     else:\\n673.         altaz_auto = sc.transform_to(altaz)  # No warnings\\n674. \\n675.     with iers.earth_orientation_table.set(iers.IERS_B.open()):\\n676.         with pytest.warns(AstropyWarning, match=\\\'after IERS data\\\'):\\n677.             altaz_b = sc.transform_to(altaz)\\n678. \\n679.     sep_b_auto = altaz_b.separation(altaz_auto)\\n680.     assert_allclose(sep_b_auto, 0.0*u.deg, atol=1*u.arcsec)\\n681.     assert sep_b_auto > 10*u.microarcsecond\\n682. \\n683.     # Check we returned to regular IERS system.\\n684.     altaz_auto2 = sc.transform_to(altaz)\\n685.     assert altaz_auto2.separation(altaz_auto) == 0.\\n686. \\n687. \\n688. @pytest.mark.remote_data\\n689. @pytest.mark.skipif(not HAS_JPLEPHEM, reason=\\\'requires jplephem\\\')\\n690. def test_ephemerides():\\n691.     """\\n692.     We test that using different ephemerides gives very similar results\\n693.     for transformations\\n694.     """\\n695.     t = Time("2014-12-25T07:00")\\n696.     moon = SkyCoord(GCRS(318.10579159*u.deg,\\n697.                          -11.65281165*u.deg,\\n698.                          365042.64880308*u.km, obstime=t))\\n699. \\n700.     icrs_frame = ICRS()\\n701.     hcrs_frame = HCRS(obstime=t)\\n702.     ecl_frame = HeliocentricMeanEcliptic(equinox=t)\\n703.     cirs_frame = CIRS(obstime=t)\\n704. \\n705.     moon_icrs_builtin = moon.transform_to(icrs_frame)\\n706.     moon_hcrs_builtin = moon.transform_to(hcrs_frame)\\n707.     moon_helioecl_builtin = moon.transform_to(ecl_frame)\\n708.     moon_cirs_builtin = moon.transform_to(cirs_frame)\\n709. \\n710.     with solar_system_ephemeris.set(\\\'jpl\\\'):\\n711.         moon_icrs_jpl = moon.transform_to(icrs_frame)\\n712.         moon_hcrs_jpl = moon.transform_to(hcrs_frame)\\n713.         moon_helioecl_jpl = moon.transform_to(ecl_frame)\\n714.         moon_cirs_jpl = moon.transform_to(cirs_frame)\\n715. \\n716.     # most transformations should differ by an amount which is\\n717.     # non-zero but of order milliarcsecs\\n718.     sep_icrs = moon_icrs_builtin.separation(moon_icrs_jpl)\\n719.     sep_hcrs = moon_hcrs_builtin.separation(moon_hcrs_jpl)\\n720.     sep_helioecl = moon_helioecl_builtin.separation(moon_helioecl_jpl)\\n721.     sep_cirs = moon_cirs_builtin.separation(moon_cirs_jpl)\\n722. \\n723.     assert_allclose([sep_icrs, sep_hcrs, sep_helioecl], 0.0*u.deg, atol=10*u.mas)\\n724.     assert all(sep > 10*u.microarcsecond for sep in (sep_icrs, sep_hcrs, sep_helioecl))\\n725. \\n726.     # CIRS should be the same\\n727.     assert_allclose(sep_cirs, 0.0*u.deg, atol=1*u.microarcsecond)\\n728. \\n729. \\n730. def test_tete_transforms():\\n731.     """\\n732.     We test the TETE transforms for proper behaviour here.\\n733. \\n734.     The TETE transforms are tested for accuracy against JPL Horizons in\\n735.     test_solar_system.py. Here we are looking to check for consistency and\\n736.     errors in the self transform.\\n737.     """\\n738.     loc = EarthLocation.from_geodetic("-22Â°57\\\'35.1", "-67Â°47\\\'14.1", 5186*u.m)\\n739.     time = Time(\\\'2020-04-06T00:00\\\')\\n740.     p, v = loc.get_gcrs_posvel(time)\\n741. \\n742.     gcrs_frame = GCRS(obstime=time, obsgeoloc=p, obsgeovel=v)\\n743.     moon = SkyCoord(169.24113968*u.deg, 10.86086666*u.deg, 358549.25381755*u.km, frame=gcrs_frame)\\n744. \\n745.     tete_frame = TETE(obstime=time, location=loc)\\n746.     # need to set obsgeoloc/vel explicitly or skycoord behaviour over-writes\\n747.     tete_geo = TETE(obstime=time, location=EarthLocation(*([0, 0, 0]*u.km)))\\n748. \\n749.     # test self-transform by comparing to GCRS-TETE-ITRS-TETE route\\n750.     tete_coo1 = moon.transform_to(tete_frame)\\n751.     tete_coo2 = moon.transform_to(tete_geo)\\n752.     assert_allclose(tete_coo1.separation_3d(tete_coo2), 0*u.mm, atol=1*u.mm)\\n753. \\n754.     # test TETE-ITRS transform by comparing GCRS-CIRS-ITRS to GCRS-TETE-ITRS\\n755.     itrs1 = moon.transform_to(CIRS()).transform_to(ITRS())\\n756.     itrs2 = moon.transform_to(TETE()).transform_to(ITRS())\\n757.     assert_allclose(itrs1.separation_3d(itrs2), 0*u.mm, atol=1*u.mm)\\n758. \\n759.     # test round trip GCRS->TETE->GCRS\\n760.     new_moon = moon.transform_to(TETE()).transform_to(moon)\\n761.     assert_allclose(new_moon.separation_3d(moon), 0*u.mm, atol=1*u.mm)\\n762. \\n763.     # test round trip via ITRS\\n764.     tete_rt = tete_coo1.transform_to(ITRS(obstime=time)).transform_to(tete_coo1)\\n765.     assert_allclose(tete_rt.separation_3d(tete_coo1), 0*u.mm, atol=1*u.mm)\\n766. \\n767.     # ensure deprecated routine remains consistent\\n768.     # make sure test raises warning!\\n769.     with pytest.warns(AstropyDeprecationWarning, match=\\\'The use of\\\'):\\n770.         tete_alt = _apparent_position_in_true_coordinates(moon)\\n771.     assert_allclose(tete_coo1.separation_3d(tete_alt), 0*u.mm, atol=100*u.mm)\\n772. \\n773. \\n774. def test_straight_overhead():\\n775.     """\\n776.     With a precise CIRS<->AltAz transformation this should give Alt=90 exactly\\n777. \\n778.     If the CIRS self-transform breaks it won\\\'t, due to improper treatment of aberration\\n779.     """\\n780.     t = Time(\\\'J2010\\\')\\n781.     obj = EarthLocation(-1*u.deg, 52*u.deg, height=10.*u.km)\\n782.     home = EarthLocation(-1*u.deg, 52*u.deg, height=0.*u.km)\\n783. \\n784.     # An object that appears straight overhead - FOR A GEOCENTRIC OBSERVER.\\n785.     # Note, this won\\\'t be overhead for a topocentric observer because of\\n786.     # aberration.\\n787.     cirs_geo = obj.get_itrs(t).transform_to(CIRS(obstime=t))\\n788. \\n789.     # now get the Geocentric CIRS position of observatory\\n790.     obsrepr = home.get_itrs(t).transform_to(CIRS(obstime=t)).cartesian\\n791. \\n792.     # topocentric CIRS position of a straight overhead object\\n793.     cirs_repr = cirs_geo.cartesian - obsrepr\\n794. \\n795.     # create a CIRS object that appears straight overhead for a TOPOCENTRIC OBSERVER\\n796.     topocentric_cirs_frame = CIRS(obstime=t, location=home)\\n797.     cirs_topo = topocentric_cirs_frame.realize_frame(cirs_repr)\\n798. \\n799.     # Check AltAz (though Azimuth can be anything so is not tested).\\n800.     aa = cirs_topo.transform_to(AltAz(obstime=t, location=home))\\n801.     assert_allclose(aa.alt, 90*u.deg, atol=1*u.uas, rtol=0)\\n802. \\n803.     # Check HADec.\\n804.     hd = cirs_topo.transform_to(HADec(obstime=t, location=home))\\n805.     assert_allclose(hd.ha, 0*u.hourangle, atol=1*u.uas, rtol=0)\\n806.     assert_allclose(hd.dec, 52*u.deg, atol=1*u.uas, rtol=0)\\n807. \\n808. \\n809. def jplephem_ge(minversion):\\n810.     """Check if jplephem is installed and has version >= minversion."""\\n811.     # This is a separate routine since somehow with pyinstaller the stanza\\n812.     # not HAS_JPLEPHEM or metadata.version(\\\'jplephem\\\') < \\\'2.15\\\'\\n813.     # leads to a module not found error.\\n814.     try:\\n815.         return HAS_JPLEPHEM and metadata.version(\\\'jplephem\\\') >= minversion\\n816.     except Exception:\\n817.         return False\\n818. \\n819. \\n820. @pytest.mark.remote_data\\n821. @pytest.mark.skipif(not jplephem_ge(\\\'2.15\\\'), reason=\\\'requires jplephem >= 2.15\\\')\\n822. def test_aa_hd_high_precision():\\n823.     """These tests are provided by @mkbrewer - see issue #10356.\\n824. \\n825.     The code that produces them agrees very well (<0.5 mas) with SkyField once Polar motion\\n826.     is turned off, but SkyField does not include polar motion, so a comparison to Skyfield\\n827.     or JPL Horizons will be ~1" off.\\n828. \\n829.     The absence of polar motion within Skyfield and the disagreement between Skyfield and Horizons\\n830.     make high precision comparisons to those codes difficult.\\n831. \\n832.     Updated 2020-11-29, after the comparison between codes became even better,\\n833.     down to 100 nas.\\n834. \\n835.     NOTE: the agreement reflects consistency in approach between two codes,\\n836.     not necessarily absolute precision.  If this test starts failing, the\\n837.     tolerance can and should be weakened *if* it is clear that the change is\\n838.     due to an improvement (e.g., a new IAU precession model).\\n839. \\n840.     """\\n841.     lat = -22.959748*u.deg\\n842.     lon = -67.787260*u.deg\\n843.     elev = 5186*u.m\\n844.     loc = EarthLocation.from_geodetic(lon, lat, elev)\\n845.     # Note: at this level of precision for the comparison, we have to include\\n846.     # the location in the time, as it influences the transformation to TDB.\\n847.     t = Time(\\\'2017-04-06T00:00:00.0\\\', location=loc)\\n848.     with solar_system_ephemeris.set(\\\'de430\\\'):\\n849.         moon = get_body(\\\'moon\\\', t, loc)\\n850.         moon_aa = moon.transform_to(AltAz(obstime=t, location=loc))\\n851.         moon_hd = moon.transform_to(HADec(obstime=t, location=loc))\\n852. \\n853.     # Numbers from\\n854.     # https://github.com/astropy/astropy/pull/11073#issuecomment-735486271\\n855.     # updated in https://github.com/astropy/astropy/issues/11683\\n856.     TARGET_AZ, TARGET_EL = 15.032673509956*u.deg, 50.303110133923*u.deg\\n857.     TARGET_DISTANCE = 376252883.247239*u.m\\n858.     assert_allclose(moon_aa.az, TARGET_AZ, atol=0.1*u.uas, rtol=0)\\n859.     assert_allclose(moon_aa.alt, TARGET_EL, atol=0.1*u.uas, rtol=0)\\n860.     assert_allclose(moon_aa.distance, TARGET_DISTANCE, atol=0.1*u.mm, rtol=0)\\n861.     ha, dec = erfa.ae2hd(moon_aa.az.to_value(u.radian), moon_aa.alt.to_value(u.radian),\\n862.                          lat.to_value(u.radian))\\n863.     ha = u.Quantity(ha, u.radian, copy=False)\\n864.     dec = u.Quantity(dec, u.radian, copy=False)\\n865.     assert_allclose(moon_hd.ha, ha, atol=0.1*u.uas, rtol=0)\\n866.     assert_allclose(moon_hd.dec, dec, atol=0.1*u.uas, rtol=0)\\n867. \\n868. \\n869. def test_aa_high_precision_nodata():\\n870.     """\\n871.     These tests are designed to ensure high precision alt-az transforms.\\n872. \\n873.     They are a slight fudge since the target values come from astropy itself. They are generated\\n874.     with a version of the code that passes the tests above, but for the internal solar system\\n875.     ephemerides to avoid the use of remote data.\\n876.     """\\n877.     # Last updated when switching to erfa 2.0.0 and its moon98 function.\\n878.     TARGET_AZ, TARGET_EL = 15.03231495*u.deg, 50.3027193*u.deg\\n879.     lat = -22.959748*u.deg\\n880.     lon = -67.787260*u.deg\\n881.     elev = 5186*u.m\\n882.     loc = EarthLocation.from_geodetic(lon, lat, elev)\\n883.     t = Time(\\\'2017-04-06T00:00:00.0\\\')\\n884. \\n885.     moon = get_body(\\\'moon\\\', t, loc)\\n886.     moon_aa = moon.transform_to(AltAz(obstime=t, location=loc))\\n887.     assert_allclose(moon_aa.az - TARGET_AZ, 0*u.mas, atol=0.5*u.mas)\\n888.     assert_allclose(moon_aa.alt - TARGET_EL, 0*u.mas, atol=0.5*u.mas)\\n889. \\n890. \\n891. class TestGetLocationGCRS:\\n892.     # TETE and CIRS use get_location_gcrs to get obsgeoloc and obsgeovel\\n893.     # with knowledge of some of the matrices. Check that this is consistent\\n894.     # with a direct transformation.\\n895.     def setup_class(cls):\\n896.         cls.loc = loc = EarthLocation.from_geodetic(\\n897.             np.linspace(0, 360, 6)*u.deg, np.linspace(-90, 90, 6)*u.deg, 100*u.m)\\n898.         cls.obstime = obstime = Time(np.linspace(2000, 2010, 6), format=\\\'jyear\\\')\\n899.         # Get comparison via a full transformation.  We do not use any methods\\n900.         # of EarthLocation, since those depend on the fast transform.\\n901.         loc_itrs = ITRS(loc.x, loc.y, loc.z, obstime=obstime)\\n902.         zeros = np.broadcast_to(0. * (u.km / u.s), (3,) + loc_itrs.shape, subok=True)\\n903.         loc_itrs.data.differentials[\\\'s\\\'] = CartesianDifferential(zeros)\\n904.         loc_gcrs_cart = loc_itrs.transform_to(GCRS(obstime=obstime)).cartesian\\n905.         cls.obsgeoloc = loc_gcrs_cart.without_differentials()\\n906.         cls.obsgeovel = loc_gcrs_cart.differentials[\\\'s\\\'].to_cartesian()\\n907. \\n908.     def check_obsgeo(self, obsgeoloc, obsgeovel):\\n909.         assert_allclose(obsgeoloc.xyz, self.obsgeoloc.xyz, atol=.1*u.um, rtol=0.)\\n910.         assert_allclose(obsgeovel.xyz, self.obsgeovel.xyz, atol=.1*u.mm/u.s, rtol=0.)\\n911. \\n912.     def test_get_gcrs_posvel(self):\\n913.         # Really just a sanity check\\n914.         self.check_obsgeo(*self.loc.get_gcrs_posvel(self.obstime))\\n915. \\n916.     def test_tete_quick(self):\\n917.         # Following copied from intermediate_rotation_transforms.gcrs_to_tete\\n918.         rbpn = erfa.pnm06a(*get_jd12(self.obstime, \\\'tt\\\'))\\n919.         loc_gcrs_frame = get_location_gcrs(self.loc, self.obstime,\\n920.                                            tete_to_itrs_mat(self.obstime, rbpn=rbpn),\\n921.                                            rbpn)\\n922.         self.check_obsgeo(loc_gcrs_frame.obsgeoloc, loc_gcrs_frame.obsgeovel)\\n923. \\n924.     def test_cirs_quick(self):\\n925.         cirs_frame = CIRS(location=self.loc, obstime=self.obstime)\\n926.         # Following copied from intermediate_rotation_transforms.gcrs_to_cirs\\n927.         pmat = gcrs_to_cirs_mat(cirs_frame.obstime)\\n928.         loc_gcrs_frame = get_location_gcrs(self.loc, self.obstime,\\n929.                                            cirs_to_itrs_mat(cirs_frame.obstime), pmat)\\n930.         self.check_obsgeo(loc_gcrs_frame.obsgeoloc, loc_gcrs_frame.obsgeovel)\', \'start_line_number\': 501, \'end_line_number\': 930}\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-12-21 10:12:32,575 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport numpy as np\nimport pytest\n\nfrom astropy import units as u\nfrom astropy.coordinates import ITRS\nfrom astropy.tests.helper import assert_quantity_allclose as assert_allclose\nfrom astropy.time import Time\n\n\ndef test_itrs_to_itrs_direct_transform():\n    """\n    Test that ITRS to ITRS transforms with different obstimes do not change\n    the coordinates, as should be the case for a direct transform.\n    This is for the issue raised in gh-13319.\n    """\n    # A point that is fixed in the ITRS frame\n    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\n                     obstime="J2000")\n\n    # Transform to a different obstime\n    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))\n\n    # Without the direct transform, this will fail as it will go through\n    # a sky frame (e.g., ICRS), where the Earth\'s motion is significant,\n    # resulting in a large change in coordinates. With the fix, the\n    # cartesian values should be nearly identical.\n    assert_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 2923, 'end_index': 3144, 'uri': 'https://huggingface.co/datasets/Partha117/swe_bench_formatted/viewer/default/test', 'title': '', 'license_': ''}, {'start_index': 4088, 'end_index': 4475, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 4410, 'end_index': 4698, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 8848, 'end_index': 9069, 'uri': 'https://huggingface.co/datasets/Partha117/swe_bench_formatted/viewer/default/test', 'title': '', 'license_': ''}, {'start_index': 14294, 'end_index': 14560, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 14441, 'end_index': 15086, 'uri': 'https://github.com/maxzints/SMARTDS-2-PyDSS-Visualizer', 'title': '', 'license_': ''}, {'start_index': 20837, 'end_index': 21924, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 24614, 'end_index': 24839, 'uri': 'https://huggingface.co/datasets/Partha117/swe_bench_formatted/viewer/default/test', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 78559, 'candidates_token_count': 344, 'total_token_count': 86636, 'prompt_tokens_details': [{'modality': 1, 'token_count': 78559}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 344}], 'thoughts_token_count': 7733, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -3.6723898954169694, 'model_name': 'gemini-2.5-pro'} id='run--35a4efea-c11b-4853-bfb8-f9bfb497eb39-0' usage_metadata={'input_tokens': 78559, 'output_tokens': 344, 'total_tokens': 86636, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 7733}}
2025-12-21 10:12:44,675 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nimport pytest\\n\\nfrom astropy import units as u\\nfrom astropy.coordinates import ITRS\\nfrom astropy.tests.helper import assert_quantity_allclose as assert_allclose\\nfrom astropy.time import Time\\n\\n\\ndef test_itrs_to_itrs_direct_transform():\\n    \\"\\"\\"\\n    Test that ITRS to ITRS transforms with different obstimes do not change\\n    the coordinates, as should be the case for a direct transform.\\n    This is for the issue raised in gh-13319.\\n    \\"\\"\\"\\n    # A point that is fixed in the ITRS frame\\n    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\\n                     obstime=\\"J2000\\")\\n\\n    # Transform to a different obstime\\n    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime=\\"J2010\\"))\\n\\n    # Without the direct transform, this will fail as it will go through\\n    # a sky frame (e.g., ICRS), where the Earth\'s motion is significant,\\n    # resulting in a large change in coordinates. With the fix, the\\n    # cartesian values should be nearly identical.\\n    assert_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)\\n", "relative_path": "astropy/coordinates/tests/test_itrs_gh13319.py"}'}, '__gemini_function_call_thought_signatures__': {'39748c88-3b76-4073-b239-d42a81d9cd54': 'CvYcAY89a1/JH78NmWvjT+SvpStBBQ/TH04Y9d+0VbpG5RiSBPcbmfKCGxlEuBd1zowh5pyNVO7RTa0cpejUi1HipIUKWj7JlhKjr37fEhy2nF7IS2JiCVMFm7kIUumXVLcp4ey2rWnBhvlo1zNB71RGXKRSe+5JAJHEYkJ91ZZCW8mPcMgFo56RUKPPX9Qo9pN41zLN1SM7ovC3JMuz7+MOAiqcNUIafLMfhEi0uhxiL+ZdTOB7DA3R/WX+yyt89Yd9D/93OY7gj5EnXeWqzfSu3Gv8+iDqTkpElzjLOKWLo3dOcjioe6+20T8V8mbPvD0PlsYnx0hVQ9dITwA+KcbohLEBG9UtZibYdrPammUUsXjOKC6RP/79WnUfEjUq1zCYnaAeJTB8oCrqQteq2NloTwNwofQFX9zxVDI4YodliurugiY/2sRflRMtBoup5P2lLdd5wcwm38Iz5b9vZW3EiN0FQAQQJUqcuEV+ODclwoOXU6U40vngIte4m8ZWLep8tmrotbMo9SfF4QE0q50cWRuosexgjj46UWt6RmFyUt7YYVDmDdUUw9UFvMUJqRtDO2fMsHKSwC5KCZQ3iw+3ttSSAvGZpiCYGDfSB7/xrHqs1AcHpXJcAVgtL2LQaq5zYUmwdFyL011CGpRjbei5k6R4N3UBULHX+9sGV0bSG9sNEv1WikYyPpJPbAFs2LGoIKcXBGtM6nS4cDnbR1PI8Q37lMz43n3FJ3FJJIuE30Kygv1TtWw4NARcYZPPY7hEtf81UbJ0J88pvS5J++JXtR7S7lSsVPD5YWqzMa+65ztOV+UOoroXp6+19Tm06Te69QfNaAL3B5f5rgJvSk1ZZvw1a23LTCqsk/f2DFMjBtCBBqQ2vHhN7459PxJnObsM1asYIDP95vvQmuzDUeqc6NgNpAfDvAt0Hu2t1K5AfWrdaAapqJ9zTGVkF9JQuUByQZ+Zc+7TNP/gYm3lt9E/xDlw/rnCmMU9XhujawX1BYoro6GCK5x73uru1PphzKhJOC7XlfCaE1F6PGnSv+5kGPgoYi4yN88neuuQBkm9WKSGkR5ginaKfHJJiOrAF9N4/uHU3Rdd1vsiaha79bkWppeCgU6nvM4of/wUzDX6dzRd1vl5Av5cCJ2zUVchQRhvMfRHsn0Yo8LTXRUwJ1dsbdGzrYbU2lA9afbJRo/FqNR0hhHVH96gcQLWMbsYvfUTa3O7VCUal9sATN4Dglon+3W6At6chFSycSf2rmF/YUEXQubxE5yXAY0H6cn+/GY7af1U4WVEYd5R68yvCDjEvB26ogmeS50gBuBJOBtOAbYghKhMUwbzd5uInDo8/0AwvKvLvMSV5LMk9l3dLSmGpA0p5DGpX20n5dDVlLkeJ/mQd3bjA0mKN4rPY3MuIg3HkhpqOsru/oaiKA/qB3MNsFmIpa70qqP0xshY5nGIX6q3WUjlYkOHFarsCj0pIiY6Hp++NfvdKvcU4+yNGrHqZts5ox967WaEbC2jz7ORhjYnmfoVg9JSyaKMClTD1X2oxkdDJRJQ+1ULV91uQ4G2pYLU4DBCIoY74dS8eIJif9kp+p7ephYoyGa3B/qchQSEqBOxhlNDZ8zjexl/7QKj7hW9e2AZAn8Qfel22DB9USu59442Qm5Uzxxp3EPoFhK7Jw9fWEKclqj78xZocpXy8wLUW7SNHJvkElg/i3Kj+8kz2AC01nqjU7fmzLSCOMHAPIt7zK0eNrZfYfpaRotEqOKmKDSxBI6cNLLEB9QkNdQee2Nm3CeqgE6qv6TEHZl+NQuxSspKr5BybARSd9vfl2b76hO1qJDLnTo0mXh294uPQeh3lJlpDhBjStRkgEzHr2rsVga6PoZi5rLJ6jb66gcizYeoVUKaj3blk2menOpr0M1Iu5JgbQMsCwgfXsQuthywtLGmUV+9MD0fR43TsvcFKgK23bAzgwJ0cTL39AQak/4VBk6ls1RGgo+xjPE1zyVX9SyqEdMJ6x2jdLrp2lss8HlBAmLk5xgxahOIA4q6S9BBwz6pmMg5aB0NvF8XcKE1E//wBRmTVELswxzmrFRGYA4kReu3gSkWEAZa2VM+m0La/TQXifIq6hfWXAOT4s9xTMbEksJJOs9k3SQ+UeAudk+BcEStNPwh/ZhXI46nKXJuKpg98klqmJbVnVlGc99MhMUe4tRzqc3c3J3eZfNEVtoa/nt8EXyKInV93qQA9BcVVyI9n81Xisi590xgWHfgVlDU8WJWshnaWf93+k8ZpQSC1Gb5m+1PJfiBcV2OrUGFaYypK7sDlTVVf6mGnaiAjQtF/SknHJcGR//gG0HJKh+ZledrnsP360Molivhr0gOoqUgZ74+9p3NH+IKFeZj/qJByYHMNGD+RuzVFp93WmdpcTCc2LEugdUgWiXr9k8jM0OGYGb0xH3uHwTWt7Ic6IvWVUaurirvu1sZ2tLnsHg2CLobE9XwaKAK0HCq187DwNnOJ4EUhs+WHZ/IQkqe1gWmrFseZ6i8NgkWXVICoFEUtzLX0IFQm2UMKuYzcGAxnFsb0slUUDWyNCYeLSFPfSwrOFVMFcTIfJEsMuL/5c/OHaoHwgFDhz/OzuqzIKUpJQQL6Mo0mbZO1wvVMEhwBlz8FC0U4hW+F7z1A+RgCGc6uuNIVgvYyK1W5EDL9r9pS5ZkJfcCBTHGb9vxU0f7Lpf6WehHwzgKoCY3nrUKL/nstz6DEeVc+CnzLUlJJDOBCmv+nFhLGfVkrINLs3F+8jeXo+WWxOKPvBfCtLt3/2X9sNdS6zmu6VUR+iSFUn+J5L5Rcd+5TMqSpqyoGSVe/g1kedZmVYc3LYB7n7q6A921YsMPT9OLIjadPAMmjlYmzOMYZwOyaq8EyBJdlTkciM1M0a1XsAqZYD/1wfwOlmRAnUJS/rDndBMfCU230KoPdktB9XQZHtQeYyVOcmVDlaLDV0fLiRu+Bj49z4bBZB2Xk2JdhHBHokU+7lSSC0aO68gAeTmlZSIuWsrFG72FsuBM4WQfUtGdGEZ1H27t9jk9ZeFHNqmb7VNWPBia1LBOa2xVUxZP4jOqEEXYdftoeUOVmLlMY20KnrMXPwNGPcQyFBi0DTP0NMoe82DzcV063JBFPt8p1mUIMCAmMIXfcwhRpn461F5CtbLKMj6o+o8BEMaw8BCl8WPP4o6SLbTI488/WUqSTSyrVhB/U5cHoPQygX91b8gKMDRObv3BtdqXEXGMMTOGlG81RnVr0J7n4EE8ifZcTAyeFyf/WBToIfFsAzHjTji+JfHNyihgkFcHx1r04S0oueQP1aNPWKaTzt9x64GyWFbmLbPTEFutJaa7W3YyLsFOyUMyrif/62DpNpNLnCQIP4J7DdVmspRiR0GHIl89XfyZUl2sBLqwmuyeV+F6fobdDwj7Drw88VJoNHPkczRH5ZxNv1+pWpzSbGZaKC7JhYCnw7q8s2+jKkdY2Q3SXmWJe1xwWwlf730HyFM2NHHVfBl542qmEPLjXxYokpeplkOqelALB+WZQMlbam3hxgq7cI4WJOQLW0/ibGEZ05iL3oy+xuKtYn/aJXqhHZneZ8BMGzeZPyJ5PuiXNVSERyK5pcD+a305lcyjyy3rtmdnl+kTnkvb7WgPZrCsSFSjIwzSAxgBq5bNnL1O+H+Dg1reqWQNAjsrCy4t+ehQV9xx3LH3P/D2JBCqpIU2KQr+JpIUJEW+iYapGb4gdBABin867kbJ3nOoGopRJIWHW9tk8qPezoWSbPOu+ZOSsWtT1MpAv6eCCedjb1VXiYtbKQbvViCDI6DiR7fJ38wMuAuXKPCeDrOCoKNyXyK/RPU8+XyxBgqMvozBnEE0cQCmDg5c4SzvEmg/fZ5QY6dNx6A0ILZjyDdkspbvg5XwOQoalc+7x3qE91vKv8bAuMyD6H5ygBAVJS0YOm1qWyj7l53Gbw59dE5EjSDs9BycgxQJpiSCcSV3P8ToYbDI0kAFym3usMKxQURVWag1MUdebrQ2VXAi5C+ciPgKZd1unBvff81BmCAGVOscbWN8ltcPDn9OxnSKhZRosNm9JjeqzoFIPa310Lzxr8BgJf9J1oUEaVhjlb6Oy/eB2KU7yT1pC95y1NnD1T5vcLkLs0b9UWz86X7qFERbQ0DlPHOgjYbvblZ0voYECm90kN3xWFGLkWop9zUSTYyLocmRYgli4/rdblw3HY1D0OLo6SXeEreXFsde8M6LDUY/cn+D5FGU3HJiziwvOqe8+T9fzG/FJ+kO5DFxuJUStPabsBtHJEHp2gsKkt7m17Z1UzQ93RPqnj1w7F6uLh67PQnKjuJ9En2IYEzcYAOdxlPOe40p+0h+yW4pDq0+myTmyd1igIG/9OX7CRQbItUCKUN6VRn9i66Nkd2IHljp0N/3CVPEax8QU/xOz5xbvnB0cOZLiMNV4EdvCQcdpKoOCzB0hjfJbMq0utDjVzitFbQM7QL4bi/f5/mEc1oDWLqO3QQivp8bt5rZ+vqktPzWX+OaxmsXxCX9/BmXJxFPlfR6YhGtWnCXcU/wNZCgaBbX/IJZ9VR+VitOB9sSrsVF6ijSFFtyciV93okaqoSJVD4cMs1tFVs9IQvmnWYqbpeFW/epty3HwOpY2rzx1hhpmA5T4Fi2+/imBnqJjYYrmEyp+G5J8tgtfBlKGRVBIE94X/JJtfVLWXA3S3msbcVGEvY5fsVCPZOmA+OtdOD0DyHlfqUZaxp5cUhtfprY5aAge4qZlzurUB/TCxwpR8BE/+tPVO5VNYvE5oXRa7AtHOO7wXPCw+QZkq7Y9z5hM6gOZJap7fQVeEEJSIjiY/+3H8z7aUYgxCZBR4HWz5RiSN9nymzBoODhTxct7+70V5UispBSq27smxs8hX5cllgRyqdZGW/7qHjY1HqFIlMFcmh8k5YZX94m2XihgCwLgK/zkGMd'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 662, 'candidates_token_count': 367, 'total_token_count': 2047, 'prompt_tokens_details': [{'modality': 1, 'token_count': 662}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 367}], 'thoughts_token_count': 1018, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2062031592595155, 'model_name': 'gemini-2.5-pro'} id='run--8eb4fdad-0536-49d8-8ad8-f810be3a248b-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nimport pytest\n\nfrom astropy import units as u\nfrom astropy.coordinates import ITRS\nfrom astropy.tests.helper import assert_quantity_allclose as assert_allclose\nfrom astropy.time import Time\n\n\ndef test_itrs_to_itrs_direct_transform():\n    """\n    Test that ITRS to ITRS transforms with different obstimes do not change\n    the coordinates, as should be the case for a direct transform.\n    This is for the issue raised in gh-13319.\n    """\n    # A point that is fixed in the ITRS frame\n    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\n                     obstime="J2000")\n\n    # Transform to a different obstime\n    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))\n\n    # Without the direct transform, this will fail as it will go through\n    # a sky frame (e.g., ICRS), where the Earth\'s motion is significant,\n    # resulting in a large change in coordinates. With the fix, the\n    # cartesian values should be nearly identical.\n    assert_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)\n', 'relative_path': 'astropy/coordinates/tests/test_itrs_gh13319.py'}, 'id': '39748c88-3b76-4073-b239-d42a81d9cd54', 'type': 'tool_call'}] usage_metadata={'input_tokens': 662, 'output_tokens': 367, 'total_tokens': 2047, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1018}}
2025-12-21 10:12:45,560 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/coordinates/tests/test_itrs_gh13319.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1059, 'candidates_token_count': 20, 'total_token_count': 1079, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2077}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -5.322652286849916e-05, 'model_name': 'gemini-2.5-pro'} id='run--c16843ac-2988-4714-ba22-850e48314d61-0' usage_metadata={'input_tokens': 1059, 'output_tokens': 20, 'total_tokens': 1079, 'input_token_details': {'cache_read': 0}}
2025-12-21 10:12:45,817 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/coordinates/tests/test_itrs_gh13319.py b/astropy/coordinates/tests/test_itrs_gh13319.py
new file mode 100644
index 0000000000..a21977a35e
--- /dev/null
+++ b/astropy/coordinates/tests/test_itrs_gh13319.py
@@ -0,0 +1,27 @@
+import numpy as np
+import pytest
+
+from astropy import units as u
+from astropy.coordinates import ITRS
+from astropy.tests.helper import assert_quantity_allclose as assert_allclose
+from astropy.time import Time
+
+
+def test_itrs_to_itrs_direct_transform():
+    """
+    Test that ITRS to ITRS transforms with different obstimes do not change
+    the coordinates, as should be the case for a direct transform.
+    This is for the issue raised in gh-13319.
+    """
+    # A point that is fixed in the ITRS frame
+    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,
+                     obstime="J2000")
+
+    # Transform to a different obstime
+    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))
+
+    # Without the direct transform, this will fail as it will go through
+    # a sky frame (e.g., ICRS), where the Earth's motion is significant,
+    # resulting in a large change in coordinates. With the fix, the
+    # cartesian values should be nearly identical.
+    assert_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)

2025-12-21 10:12:45,818 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 10:12:45,855 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 10:12:45,855 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 10:12:45,956 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:12:45,956 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at 6500928dc0 Merge pull request #13502 from taldcroft/better-iers-docs

2025-12-21 10:12:45,956 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 10:12:46,058 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:12:46,058 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 10:12:46,058 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 10:12:46,058 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/coordinates/tests in the container
2025-12-21 10:12:46,058 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/coordinates/tests
2025-12-21 10:12:46,160 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:12:46,160 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 10:12:46,160 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/tests/test_itrs_gh13319.py in the container
2025-12-21 10:12:46,169 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 10:12:51,948 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/coordinates/tests/test_itrs_gh13319.py"}'}, '__gemini_function_call_thought_signatures__': {'ddcce977-bc7c-46b5-be46-25ec7ac568d9': 'CsgQAY89a1/zfEm7u75dSL7r/5gLjxs4b4i2mBelhXGCK8iI5K11O40UAzLFuoRaFPyEWAAmIBn53fMXtVNdNSVvdd9maNJkVg8uZkaYYW2l7qardoBI4JBWh4YMWEszXO9T3YqJpAGupU3/QOxZfbAduiZvnKwuXDbOe24TyfIXsbVUZG3I7l81FHQ47YvKnS+I1DyTxiHgbK7CrIpiIhkpgc7oWvr1NRwMUhC5ynTadwd1mLr8BkPTKerdvdbIuskFZKbnr9RM3U17pyLauWyzo2ttJBQQqORA3iJqCSNkvkjuqHINnjyQN6SbQH+z8MW0HwZ6els/kibfmXWK+kM3Zzaj6s1k9khd6Pi325un5F5qiMvssIQcsuKORMB6p/Bd2na/1JvyZK854anuJygWHvttL0BpHMVIhX2n3yd9a0kKbOWv04pEHb8gzHL07V7kIhV4SvDvX3O3k0PN/b9rA7hpzKtdrlsQhRvnbbUNJrA+wImQqS06UuQRwgzEJlZ5F5GUydZDPW+WhRHfCkS+3lbjoZ3RDkh17zQfLp/ZaCgRPiBy2JVJA2fFF+GmQv8iU22a4dxAv1zmD54gw1mWg9zvmw7T8IupjaxkfBESN6sNrekx8GfqHxlOGyr/Xtn0FJrhVV78mOhoFd/yEOg69wYBBjw47XlaWrut0vY+j/jyzo6sPojkSrA6+GOFaDK+2PxlLiPmoCYBMJbvF79LBMk+Qy5EWchR9AnShNuhfxJi7X5t+1q7CEMwriMWvIw6DMYLbfrC4SiWibBo/7ig128fDzdfBw7/+Rmu/MmYFCrhh7tSMLzmxBpe8LZGlLCC7uai8tF+iE+l0zoeyohovlywMFfl9Jm6fTfHsLul9L6eBabmjmR+ZPhQ4XvzFgP3RSfpqDaTTEvdwzfg876vTvfZHZ1E1lkTGf5k/7LCcbDSYK41E2xzESf9XUq10a+4YP0vVq7jADrLHVCWT94b6VzT2fIgskMpjtEPwCyB5muErZsYshmDNwiH9GmbYYvxi2O1e43u9WYRp2rHlLSt4Vcgy2deRVWQP4JKIoQZqzcHs2exCgUxeAxVhi+c+LX8GvHTyF//5pkwh1brNZY9HJ9EZvNiL7jCTebJZgtlsI8UkR8Y+VcfF3/2omKVIakr01myiN7C4qJLCzydmyfmeu5BnxeuW4Uyyww2uSCwcCoLCb9kY6aJ1WmMsJvWSLJuh3iqRAeXt8Z0uvvbka4x9i/EQtnQhi9YqOIHwrMuSGQJkmvAr6fmebzWJpL4oh5Z9zm2denqXPRq75cTrB+gd7dizfZHOkmTzf4qPVe8LgzN4wy1g9pe4ZF84xmOKldZEak2wdlFAAN7GgVKumqdFuJnUPD3qlCdsTwS+nIVTr+2n8lv6gcPBjCjvZKU+Zoyn8/Xjm09jtoA3YoaqSLBMXVXq3lpAEDGq5iLF2ySSKsL+tH/TYG+FsbU34peDWGmTrFNyqfUu6GpEOn421Fpuw1qPwD+Q5Te/KBVbiGcLSa9zATMEvyt0hHevN7ES26t2kOjjVtiw8aM3xkq3oSm3FBkhbvMMJ5WQPrv+fWJgXlwPDa7xbSO67+2wp72l45fW7splF9CqeHz/Dl/rmbGh39aWsRS/tQ4KoyNeHYzy4UHlXjJIUwdnsvy2nYvEuRGskIu9+vwGoDcPOLyu6PMQ4BS3YddokZvuRTjL20ZnU/3ms3oHmm0mQbOQcNWhe90e0bzRZyjDhgMeMb+pLKFIjqS5iqqIhdBv49qFhV3nXmH6AsLyenoMdHy7ZwKsOJ2lGC1opBnNdXE7IY4SArmeerldBCGabEfurNY/mDSN2/smAkKtHz3+V1B0N25Q3h/fZfUmS8l6NRvQDFh6qAbBzGf6KX87FybKbjrOGGuDEkq5OONTSlKBbRnc54bQEgs1ylL4DP6ilY6a5xrrm7erBgCfNpJPvCrXJv8HPkgvPemywf8i09Giia/5nflhpjD3xkG9pamy1jG2V+755J76ixJIXi8inmsr1H4OPH0N6UwCWRX/GR2XsweTkXJIi/lZaA034gt7mnx+jkkCPFcBex2Duuji3A3yGNw0Slmls4ZpVsP2Oy2OQzbHpPgp25Lkb5f+S6naAs4qj9lvPf7SPkxwH5mQkK+JsNP+cjV019iQWsneXhegEEIkC5aATkuq8QLYlsh9ibiTrQq2k3b/safAHz3Zmix6q2Taun9i+EQh+LyBageBTqZuKAwJuX8DGJrxKMCrVoHRCDZk9y7Q6rkXCB49rEogNK/AAZ4PKN+Ye28Cm5Xl9jj83WyCl5dVisy/c5IuYfNhgFvTrhmBGhcRabn0TY6qw82K1TU3CWQpGKlK0pf5lYcfDq0mOAnhWuEjguuakbMuU5m5NTFKMRiyCFuuaCYWpqOYyrtoJ895ykZi1BZ0ZPC4TCH3RI0bENLyfX9/kJxT2QsGqpxQnXVydgWflSjUjkrfDCpWLgdkmBfWRihXQFTIEvVwP1Pzg0QbSQiySuWPg+REMc1Su5o2iABG4BiSf75NZGOqUQJBMNopd2o7u4RN1r6VE5JYREkp2dIZxD3/cOG+aaIRmNw6J7cDhZ1aJzKLsinpFhXhL/lCOMjKV1yJm2wXJXzUEmlYeZDaF5AUlw1nxv856QD6clz2UfcR7l+pbKnAQ/Kg9XHQUpEFuMZ3z3e+EZrhk/Ou20ZqirQai6BfXtAAjY7cudI6Pab8ug5PfDmdc50D3QrmX8to4FX4p82Oh5ia4pyuvmZQf9IgpjCm5ExPnjXXHa6FASj0aIoduTsQry+UtmrOy17usmCWTOszB8kEzPutNYws44='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1600, 'candidates_token_count': 25, 'total_token_count': 2177, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1600}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 552, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.521162872314453, 'model_name': 'gemini-2.5-pro'} id='run--9840ee13-ceea-4c04-86fd-b78f8979f773-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/coordinates/tests/test_itrs_gh13319.py'}, 'id': 'ddcce977-bc7c-46b5-be46-25ec7ac568d9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1600, 'output_tokens': 25, 'total_tokens': 2177, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 552}}
2025-12-21 10:12:51,950 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/coordinates/tests/test_itrs_gh13319.py
2025-12-21 10:12:56,628 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 10:12:56,628 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/coordinates/tests/test_itrs_
_gh13319.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev287+g6500928dc.d20251221.
Running tests in astropy/coordinates/tests/test_itrs_gh13319.py.

Date: 2025-12-21T10:12:54

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/coordinates/tests/test_itrs_gh13319.py [31mF[0m[31m                         [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_itrs_to_itrs_direct_transform ______________________[0m

    def test_itrs_to_itrs_direct_transform():
        """
        Test that ITRS to ITRS transforms with different obstimes do not change
        the coordinates, as should be the case for a direct transform.
        This is for the issue raised in gh-13319.
        """
        # A point that is fixed in the ITRS frame
        itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,
                         obstime="J2000")
    
        # Transform to a different obstime
>       itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))

[1m[31mastropy/coordinates/tests/test_itrs_gh13319.py[0m:21: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31mastropy/coordinates/baseframe.py[0m:1202: in transform_to
    return trans(self, new_frame)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1079: in __call__
    return supcall(fromcoord, toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1556: in single_transform
    return self(from_coo, to_frame)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1079: in __call__
    return supcall(fromcoord, toframe)
[1m[31mastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py[0m:212: in itrs_to_cirs
    pmat = cirs_to_itrs_mat(itrs_coo.obstime)
[1m[31mastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py[0m:51: in cirs_to_itrs_mat
    xp, yp = get_polar_motion(time)
[1m[31mastropy/coordinates/builtin_frames/utils.py[0m:47: in get_polar_motion
    xp, yp, status = iers_table.pm_xy(time, return_status=True)
[1m[31mastropy/utils/iers/iers.py[0m:365: in pm_xy
    return self._interpolate(jd1, jd2, ['PM_x', 'PM_y'],
[1m[31mastropy/utils/iers/iers.py[0m:392: in _interpolate
    mjd, utc = self.mjd_utc(jd1, jd2)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <IERS_B length=22066>
 year month  day    MJD      PM_x   ... e_UT1_UTC  e_LOD  e_dX_2000A e_dY_2000A
                ...  1.2e-05 6.7e-06    7.5e-05    7.6e-05
 2022     5    31 59730.0  0.149795 ...  1.17e-05 6.7e-06    7.5e-05    7.5e-05
jd1 = <Time object: scale='tt' format='jyear_str' value=J2000.000>, jd2 = 0.0

    def mjd_utc(self, jd1, jd2=0.):
        """Turn a time to MJD, returning integer and fractional parts.
    
        Parameters
        ----------
        jd1 : float, array, or `~astropy.time.Time`
            first part of two-part JD, or Time object
        jd2 : float or array, optional
            second part of two-part JD.
            Default is 0., ignored if jd1 is `~astropy.time.Time`.
    
        Returns
        -------
        mjd : float or array
            integer part of MJD
        utc : float or array
            fractional part of MJD
        """
        try:  # see if this is a Time object
            jd1, jd2 = jd1.utc.jd1, jd1.utc.jd2
        except Exception:
            pass
    
>       mjd = np.floor(jd1 - MJD_ZERO + jd2)
[1m[31mE       TypeError: unsupported operand type(s) for -: 'Time' and 'float'[0m

[1m[31mastropy/utils/iers/iers.py[0m:271: TypeError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/coordinates/tests/test_itrs_gh13319.py::[1mtest_itrs_to_itrs_direct_transform[0m - TypeError: unsupported operand type(s) for -: 'Time' and 'float'
[31m============================== [31m[1m1 failed[0m[31m in 1.22s[0m[31m ===============================[0m

2025-12-21 10:13:12,237 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='The test execution failed. The output shows the traceback of the failure. I will now return the output as requested.\nThe test `test_itrs_to_itrs_direct_transform` in `astropy/coordinates/tests/test_itrs_gh13319.py` failed with a `TypeError: unsupported operand type(s) for -: \'Time\' and \'float\'` inside the `astropy/utils/iers/iers.py` file.\n\nThis is the full output from the test execution:\n```\npytest astropy/coordinates/tests/test_itrs_\n_gh13319.py\n\n<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.2.dev287+g6500928dc.d20251221.\nRunning tests in astropy/coordinates/tests/test_itrs_gh13319.py.\n\nDate: 2025-12-21T10:12:54\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7\ncollecting ... \ncollected 1 item                                                               \n\nastropy/coordinates/tests/test_itrs_gh13319.py F                         [100%]\n\n=================================== FAILURES ===================================\n______________________ test_itrs_to_itrs_direct_transform ______________________\n\n    def test_itrs_to_itrs_direct_transform():\n        """\n        Test that ITRS to ITRS transforms with different obstimes do not change\n        the coordinates, as should be the case for a direct transform.\n        This is for the issue raised in gh-13319.\n        """\n        # A point that is fixed in the ITRS frame\n        itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\n                         obstime="J2000")\n    \n        # Transform to a different obstime\n>       itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))\n\nastropy/coordinates/tests/test_itrs_gh13319.py:21: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nastropy/coordinates/baseframe.py:1202: in transform_to\n    return trans(self, new_frame)\nastropy/coordinates/transformations.py:1478: in __call__\n    curr_coord = t(curr_coord, curr_toframe)\nastropy/coordinates/transformations.py:1079: in __call__\n    return supcall(fromcoord, toframe)\nastropy/coordinates/transformations.py:1556: in single_transform\n    return self(from_coo, to_frame)\nastropy/coordinates/transformations.py:1478: in __call__\n    curr_coord = t(curr_coord, curr_toframe)\nastropy/coordinates/transformations.py:1478: in __call__\n    curr_coord = t(curr_coord, curr_toframe)\nastropy/coordinates/transformations.py:1079: in __call__\n    return supcall(fromcoord, toframe)\nastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py:212: in itrs_to_cirs\n    pmat = cirs_to_itrs_mat(itrs_coo.obstime)\nastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py:51: in cirs_to_itrs_mat\n    xp, yp = get_polar_motion(time)\nastropy/coordinates/builtin_frames/utils.py:47: in get_polar_motion\n    xp, yp, status = iers_table.pm_xy(time, return_status=True)\nastropy/utils/iers/iers.py:365: in pm_xy\n    return self._interpolate(jd1, jd2, [\'PM_x\', \'PM_y\'],\nastropy/utils/iers/iers.py:392: in _interpolate\n    mjd, utc = self.mjd_utc(jd1, jd2)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <IERS_B length=22066>\n year month  day    MJD      PM_x   ... e_UT1_UTC  e_LOD  e_dX_2000A e_dY_2000A\n                ...  1.2e-05 6.7e-06    7.5e-05    7.6e-05\n 2022     5    31 59730.0  0.149795 ...  1.17e-05 6.7e-06    7.5e-05    7.5e-05\njd1 = <Time object: scale=\'tt\' format=\'jyear_str\' value=J2000.000>, jd2 = 0.0\n\n    def mjd_utc(self, jd1, jd2=0.):\n        """Turn a time to MJD, returning integer and fractional parts.\n    \n        Parameters\n        ----------\n        jd1 : float, array, or `~astropy.time.Time`\n            first part of two-part JD, or Time object\n        jd2 : float or array, optional\n            second part of two-part JD.\n            Default is 0., ignored if jd1 is `~astropy.time.Time`.\n    \n        Returns\n        -------\n        mjd : float or array\n            integer part of MJD\n        utc : float or array\n            fractional part of MJD\n        """\n        try:  # see if this is a Time object\n            jd1, jd2 = jd1.utc.jd1, jd1.utc.jd2\n        except Exception:\n            pass\n    \n>       mjd = np.floor(jd1 - MJD_ZERO + jd2)\nE       TypeError: unsupported operand type(s) for -: \'Time\' and \'float\'\n\nastropy/utils/iers/iers.py:271: TypeError\n=========================== short test summary info ============================\nFAILED astropy/coordinates/tests/test_itrs_gh13319.py::test_itrs_to_itrs_direct_transform - TypeError: unsupported operand type(s) for -: \'Time\' and \'float\'\n============================== 1 failed in 1.22s ===============================\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 4667, 'end_index': 5231, 'uri': 'http://docs.astropy.org/en/stable/_modules/astropy/utils/iers/iers.html', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 3786, 'candidates_token_count': 2044, 'total_token_count': 5830, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4338}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 2044}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.007583313958752179, 'model_name': 'gemini-2.5-pro'} id='run--4c2de270-72de-4e21-824e-912743882bed-0' usage_metadata={'input_tokens': 3786, 'output_tokens': 2044, 'total_tokens': 5830, 'input_token_details': {'cache_read': 0}}
2025-12-21 10:13:31,288 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log="FAILED astropy/coordinates/tests/test_itrs_gh13319.py::test_itrs_to_itrs_direct_transform - TypeError: unsupported operand type(s) for -: 'Time' and 'float'\n\nThe test fails because transforming ITRS coordinates to a different `obstime` incorrectly routes through an intermediate sky frame, causing a `TypeError`. This demonstrates the bug described in the issue, where such transformations should be direct and not change the cartesian values, but currently follow a broken path." reproduced_bug_commands=['pytest astropy/coordinates/tests/test_itrs__gh13319.py']
2025-12-21 10:13:31,289 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-21 10:13:31,289 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-21 10:13:31,290 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/coordinates/tests/test_itrs__gh13319.py
2025-12-21 10:13:32,531 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 4
2025-12-21 10:13:32,531 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/coordinates/tests/test_itrs_
__gh13319.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev287+g6500928dc.d20251221.
Running tests in astropy/coordinates/tests/test_itrs__gh13319.py.

Date: 2025-12-21T10:13:32

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7
[1mcollecting ... [0m[1m
collected 0 items                                                              [0m

[33m============================ [33mno tests ran[0m[33m in 0.03s[0m[33m =============================[0m
[31mERROR: file or directory not found: astropy/coordinates/tests/test_itrs__gh13319.py
[0m

2025-12-21 10:13:32,531 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-21 10:13:32,531 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-21 10:13:32,536 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-21 10:13:32,537 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 10:13:32,537 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/coordinates/builtin_frames in the container
2025-12-21 10:13:32,537 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/coordinates/builtin_frames
2025-12-21 10:13:32,638 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:13:32,638 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
s


2025-12-21 10:13:32,639 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/builtin_frames/itrs_observed_transforms.py in the container
2025-12-21 10:13:32,639 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/builtin_frames/__init__.py in the container
2025-12-21 10:13:32,640 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py in the container
2025-12-21 10:13:32,647 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 10:13:32,647 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-21 10:13:32,647 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/coordinates/tests/test_itrs__gh13319.py
2025-12-21 10:13:33,909 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 4
2025-12-21 10:13:33,909 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/coordinates/tests/test_itrs_
__gh13319.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev287+g6500928dc.d20251221.
Running tests in astropy/coordinates/tests/test_itrs__gh13319.py.

Date: 2025-12-21T10:13:33

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7
[1mcollecting ... [0m[1m
collected 0 items                                                              [0m

[33m============================ [33mno tests ran[0m[33m in 0.03s[0m[33m =============================[0m
[31mERROR: file or directory not found: astropy/coordinates/tests/test_itrs__gh13319.py
[0m

2025-12-21 10:13:33,909 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-21 10:13:33,940 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - WARNING - Validation FAILED: old_passed=False, new_passed=False
2025-12-21 10:13:33,941 - thread-130546535499456.app.lang_graph.nodes.validation_feedback_node - INFO - Validation failed - providing feedback for retry (attempt 1)
2025-12-21 10:13:33,942 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-12-21 10:13:33,943 - thread-130546535499456.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-12-21 10:13:33,943 - thread-130546535499456.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-12-21 10:13:33,971 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content="Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED astropy/coordinates/tests/test_itrs_gh13319.py::test_itrs_to_itrs_direct_transform - TypeError: unsupported operand type(s) for -: 'Time' and 'float'\n\nThe test fails because transforming ITRS coordinates to a different `obstime` incorrectly routes through an intermediate sky frame, causing a `TypeError`. This demonstrates the bug described in the issue, where such transformations should be direct and not change the cartesian values, but currently follow a broken path.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n" additional_kwargs={} response_metadata={}
2025-12-21 10:16:15,769 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport numpy as np\nimport pytest\n\nfrom astropy import units as u\nfrom astropy.coordinates import ITRS\nfrom astropy.tests.helper import assert_quantity_allclose\nfrom astropy.time import Time\n\n\ndef test_itrs_to_itrs_direct_transform():\n    """\n    Test that ITRS to ITRS transforms with different obstimes do not change\n    the coordinates, as should be the case for a direct transform.\n    This is for the issue raised in gh-13319.\n    """\n    # A point that is fixed in the ITRS frame\n    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\n                     obstime="J2000")\n\n    # Transform to a different obstime\n    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))\n\n    # Without the direct transform, this will fail. It might fail with a\n    # TypeError, or it might give a large coordinate difference because it\n    # incorrectly goes through a sky frame (e.g., ICRS). With the fix, a\n    # direct transform is used, and the cartesian values should be nearly\n    # identical.\n    assert_quantity_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1928, 'end_index': 2149, 'uri': 'https://huggingface.co/datasets/Partha117/swe_bench_formatted/viewer/default/test', 'title': '', 'license_': ''}, {'start_index': 3774, 'end_index': 4218, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 4272, 'end_index': 4715, 'uri': 'https://github.com/astropy/astropy', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 5056, 'end_index': 5396, 'uri': 'https://huggingface.co/datasets/Partha117/swe_bench_formatted/viewer/default/test', 'title': '', 'license_': ''}, {'start_index': 11072, 'end_index': 11950, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}, {'start_index': 22561, 'end_index': 22968, 'uri': 'https://github.com/astropy/astropy', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 80460, 'candidates_token_count': 350, 'total_token_count': 94759, 'prompt_tokens_details': [{'modality': 1, 'token_count': 80460}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 350}], 'thoughts_token_count': 13949, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -7.4627197265625, 'model_name': 'gemini-2.5-pro'} id='run--38a98556-07a4-4471-b97f-90dd7b33ae7f-0' usage_metadata={'input_tokens': 80460, 'output_tokens': 350, 'total_tokens': 94759, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 13949}}
2025-12-21 10:16:30,239 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import numpy as np\\nimport pytest\\n\\nfrom astropy import units as u\\nfrom astropy.coordinates import ITRS\\nfrom astropy.tests.helper import assert_quantity_allclose\\nfrom astropy.time import Time\\n\\n\\ndef test_itrs_to_itrs_direct_transform():\\n    \\"\\"\\"\\n    Test that ITRS to ITRS transforms with different obstimes do not change\\n    the coordinates, as should be the case for a direct transform.\\n    This is for the issue raised in gh-13319.\\n    \\"\\"\\"\\n    # A point that is fixed in the ITRS frame\\n    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\\n                     obstime=\\"J2000\\")\\n\\n    # Transform to a different obstime\\n    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime=\\"J2010\\"))\\n\\n    # Without the direct transform, this will fail. It might fail with a\\n    # TypeError, or it might give a large coordinate difference because it\\n    # incorrectly goes through a sky frame (e.g., ICRS). With the fix, a\\n    # direct transform is used, and the cartesian values should be nearly\\n    # identical.\\n    assert_quantity_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)\\n", "relative_path": "astropy/coordinates/tests/test_itrs_direct_transform.py"}'}, '__gemini_function_call_thought_signatures__': {'2343e1ef-7000-45d9-8bc2-c882c0cf2050': 'CvIhAY89a1+CkJCZJyaSZ8X08Ho8mKXyjdCzdzL8XWfHF4gVzH3XCSYg8MusHhONUvvUO2FZolZss+p7O+KjaChn8Lvy76KKAJbInt4R789iDCiWxI8OgG+PJu8q2TP+KgT4feH0l8kZPRudh0yqSea9waRMawImPCN0p17e470QedNfGnXKb8pEIZAlF0hFNNfIEL+RODaZTf3KF0b/ZBZJBkjfYHKObDEOcOuER0HCUhgK0IERgJhUDxLBTf5WYC/CNJH7FmrG+uM3uluXfylx3qUeUEyeVDnEzg8dIc51mgHzku/eG7NruiI7D6RUvQ5uUCQfZvSGcNO6s07CE12Ad9Hud3R4hCOYsr41GUZrp8tsnWqfjenVri87oVkSIvmSHUk5CIW0/grVVu371iYHeNbPbyfL6L4vP8Rc/DZAIiGHHKYZXh/FdJRu+RZlCpvPM8Kg35ZysSICRb7lmPl33rT2daVrxLtxk6i7Vdg88rSAY6S55Hjg6q3aVoRgxDLBrk5Zo+YclyjQjOzgebTjG9d9ckjyDxaWZRkDI1uUjLOTxcRiiOo0LgHwEDx0fc3Dhl1Z16+x05W1GyJr2+eZ0bbiAyaXz3+v4sKEguYi430RpUR8cRYXW/cn4mZiX/AVPQHsHnZW1U/EErrHC80bKcGYJwGwkl1/XPXkjOdkdG6tK0Yn4WfYiTHGpAkY/J5KsyhEUM8DDU8JQ4oinRWRnI0NyshLy3ZkWDoquIyEE5waaeiMsUrgpA++ZYTSVt2wJ4xrrvbQwX0Ih6OfGndXeyryNiES+/gRitdJThragLHoGK0m5sCslJTrr0HPKv1sv45r3n3le3WJQTAXK7kLuCsEY2AJBVpBUZ7pzOOE6VgEELefvwIha8mUZiP3Gvf9tbMHpnWAo+Yd8jiJgM9/IdPTZJZqN+Bn+5o1FcDJVMOqk77SnISEe2eMZAR72c2aVZgt+/SseHDAdRMMX4SU7ZTcdxW+Jg+4ypMW8Sk2MA+VMi5BQrnLXvi+61LD2pXh07d5J+vVgr6+60cl/Z7RG+El7yVvLkuWLlxLVtDtOEJyWbXDYhc1f3e1JDlkMvOs108umSwkayNsWHRUKDgUuHY00KZCpQ5SZ5/u4LNm/sfaA0LkgTsZZB4g8fc0YBLnkT2bC3ErigRKt2bipYUKfjtLuK3ydnDw9b7TR0JUZxGf3QJ4qQFJ4Nm5/50SjKSduikIJzA5p3mohzwjhnt1mM499ZBRH9GAq31ACkKftrbP+a7NI+BMp2Y7Te6vFHjqxwF1mdjeZJECyGNIVxA9CW/0plyKevHSEx1zCZDtvwtoM1h2zV/3heY4ljtv/oxSkoALn+T73oxEMtHXciz80jDk0WjGxP2pmWPpRhUPPCGMLuqRhEBKDQBWIlAMGMXrazDf3RJo1SlH46h4Zh/lviRZOyXrTtL7yBsL3UFX83SQvLtxtmfGZBBn4A/ZT/rJ/g1dh79SXA4oJuRMOQ/Lrk3ulENOnF64XZlQTZE4zQh2hQA8XWF6+sFi1jBOlk2E1p5vroOyHf4OEHrhCobxB101U9kKtJHi8MUymC9/FzOyETQQwcEIsQxO6MPgOwAgN398POmCso5HmpGTUwLFCf4cJgEKlcoEIA3GOEmpYFrxdvMLizUgfBF2US10eq4YIc80MqXBxI+/hbGpXJErcMNu7wd8Rqub+2KlLzYdpJQtFawfnMjI6BE0cwG7GPckALeZh9bRK/jAUzZ7vD877LWf83tk6hVesuDI3XYEOsjY2CO4G4mMl2YMcFTdYmNHYu/xsxkKGw1jvwPUFOvU1kAxnv46B0GXk+l5Sj7PB+A+vgGRRT46Nsoh2kXArnjMdwa0cv5tm9WRdKV9Y7hnDup4OzKtj8zsKuyG3V6osD63B+ayl0BcNXiqi2jNbSNbbDSaYvsgrKuIBSsqDlZmo4B1zvMN5SJdQCWR9aTOGYpb1b/4r+iIOZCHidGbqsR6W91Lh6VM/5GzUHc7DAPAc90hfpAb7lPTcWb+FCfGDA68Gr1WX1QL6dkuTBLooEoO2FPpZyyfyQfKH50kycZ3YRwNbICr56ev5AE2MzP3dixbQDFcnRhSJ+lWRX2KrAiJMDEfM1xvZ0uMnW12BMzJ61UGmQ5A44H1TcsB7hpVnwFob8R9A62d5xuMP3FzlK+EObH7JUbNY0LLzN09SHl02cacKADCugSjDAwihT+Fv0DwSvZwAH4/GJ1dB/mYDdQtYW0XMG5Qqi+Q6yTL15KgKrx/07WsEUylzJdWy8OTm7zSKDNn27D9t8LuOnny3G+fwgxJd8JMIXetfOJffSOJ6pHUV1KZ2yRuwBxIu3rbYkyf0gDNr5JplFOV9Xc6iPsTD8UuSxz5vEdIvRc3e2Ab9eWrRFFG0eEbYHVQxl29KxpbePLpAfDaPLJrR5G/DwUDv/QeVQ40xeHb9LJ8cTEXKMOoxda5vpmQKk0HAbfZeaTxhqADWmkD2GtiGNNF9+28d2ubt2sELzxvU9eT8UNZwtyCBfaamfag42tNebslX1usg6qFSFjfATjldLnt8yeJ9tHcapwarXhUKkKfL2hA7dG7eL7iegMfQvtdULmNtQcv+U7iscFKpL1FbHFyxxYkLzVfAg+Hq4SpTHFATxbz8oa2oRZIyM2zYg8CqdwxzJq6VWrI6ky7BxNSTyP2E6GBvISoeiYIeXwVOqw2R6p0NRIpf6rKnBWUHqQNeIosYqTs7NWoUXCSfHdtKItntyWhGeVw08B7iSRmQRbZF7hcKENx1meww9W2wSrg/bOlUOBblIg2FJTdNRx5TXKeG8BC3S3Vgn/enpe0HkmZ6nfW3QiQm8TfJdnpAzmbsAuP9BCWQ7YWwYA+RPeH1ycIfnITkCMrp9ftePy2qo+vqILilxN9ir8RqN9zEDr0LDWK/IU2CnVuZhmA5izWONs2baslEgSl6SMe627oWzxWaOPgtv6hSe5n+jhZFG/GBvGYxQ7NzO5U130Nzt82lCg8zEgjYukTEO2hez6sV9VTsKLfKnvFZuD7xN5yUwoFe18EsKnTOyJGHPN/KixOuhGBZD5iOtJtkRJL+r+naKoZ3uJDH2XIddtxHfmiCEhJkCjLgE+mzbFXMOCBtsjxg/fdZjeCvfcjTofhbgkSd63pYxoNC6iisGTUZIHuyl1dJy5pdIXaObxM0Oz17+aSEsXlcnL5vv7UwRJ2l9IdsHn6SC1jP9pHrAl3k6gcWB4L6PEmHao3VjmgwbKKIPx+m8yhu/AKXSBDc3IieIZStH62IWg2ab8QDEY86H56fBPQAwSNETNHTp+oXC0+9zLWiFNuW4J9PQUmqGun5AWuB08zHin0xupamuNvhNHvQIdy0mtbZUH1Shd5WjB59Dr6OWkM0CUkbh+zQtt77MmuBceupBsUvsrTbQ/RY6+vaOc5t/hUzioEuaCkC0TTIR31LV+bFZlqGh4XtQv3LrXnyQkJOXzCvhsJ5KyTMbSz8dedr5KRgpZW7JQDC7BSWlEskVpsRGFbxYielI98IZvsgyb5lB//p1DlkHKG3Eqdm14yNU9xr68xNnMkRSATeJZ3ZQMWxbWo/UrOosjrulJr+BZZYIbXC6GAHkXe5jV/JhMs5v39wWqqdHnAeJgxQiKw83FbbKjHrr1+HdK3Gv2faGUYFKZHRGFZGID2A1r+D1I9U0+kcon+9aW3oWgwOEZf2C9HOATqGLnSGJmS4Jmm5xajyLu7nonrBwd0EgdsS9r7VARL61wVXdYoR49ojPJeEFvP2wDfVBif/OQu7eURcQHZW88aud+GQB7Z0HtQDZUAzHar8lDyszDjcQRBIPQdz27PE2q2D6xzq+Es4YDwvtgOOMHlRL8X37u/+YMi8Ouuzp9cQmJhRGhrFYUS4n2ZyWl2x1FkYHfszYqctId52o3k2FWA/b+w+nLN+dJhLiJLkoe65uFUIEe3xllwmStHAWOV+KAbulPderAn2eDh1AjQtk07zoIqDCSu+PLDW/KUsCVJ3JG1k3ZiYUW8RR3NaeB4hHH57fOIQf0he3rIiAgbcw0nuAxXVHjWNv+xwqBN3MQ5U5bECQWcg3IsbFIF4d4Qyi5AdBzhmfqj1fyzDey/xw6H0IPNZaPqHukOhtKe2QgqRVzBci4tYQ6Om9eiUkBfT/hazH1slcq/ceq4kuN2cANxEY0JSbaDGmHypXXbwA5aTa2fVgIYI1+czNbn94dzpgQ0iklFkaIcwgh5Wb4jqfKDNScb2G95NToEct/l1HefNdGCcGuGNkrl/txT88r5uDXm4IRC1yFRc2YwnktQVvWwW+Pt38qCc+UioO9m3N6doDSix/rrXJaYPOez1ffoQ6SgItaHgP501SJ4tg/mz6KYfjEUGiuGqm0kcWevhoveIDCrkHoIQpjJe51dafBUicSqWymDNkN4p9czlE+DuvEnSBeOAM7DrostrleEryOEJEFomUfrs6MjFd9TFy1MQoOxQFsRk1vvz8cwUqV9J+FDoYZhgqOVg21fczJVvrgspQ+nTbwtzL0SxU18X1NJHOcuy/Q5Rzymk+n49li28yPXBUq/pEXgd6BtS7iD7c1ikZPRoQrkCxImzogxWZ4Bl9shu4pXv7SV+/uPdlxIqju73OD3zoA7+eFEBNB08HyYyMduOx6O6dSo+RIrxCHArAt8QdajTSWrVNAdAPuK7+FD/cHCAYD6ZJFHBKrLTs0QeQakVEoowgdBO5TtOPFMvEiyRLnDfnHWuzeTcnmEtES4Bd22Itr6o1zR0D5LqMSDqS90dLzyqQyjsTVwxz+3I3xnVpqtyJXPKsEkQgS0L93Y1yTYY4p4HTWb1iDDQfUtkS7MHhYVFZ79DVyejcmhF/PVeVRB4ktLh+CzmiIkJsJPHmaLIXiZ6LDsBpnULc8gUYtaYO0Uz/B83s+UYM2YOI+Ugoci+7Na8agJEBKWzGjs98W72N1LbzlN8iDDotP2hcIenuSmfkrMwovVzxthCoa+RxSsWbWDLlLYCxTIS5UEl3Pnc3TRAbFlRy0awQcMlw03/raCLN+tLMgXcVnfSN8Z1qUUmKV2E7JraPGd0M+AZiC8cQo7rmcrSvqz0s2y1jbXVX5bHGW6+heRkdahDub3e17A2O/phMYyHE3Pk1+gPY1l2eceYfAJ1R147+H4t+I0c/+dYHx5wlXPjc/3LKjF42t7y1zWzYrv3P+CJD9Clrje2Ek5xq76/UfobY2pcPMAXFp0c2cXoT6CtaYrRxEG3osRYq1fNRHTQCsLObWLDGLMwRu/U1+vk+vxz9XqXFlavTwGlykvTogsCWs6shEoziFspytQDj8BXwMTdSkOOFeULQXBzm98WJrgbvf07+J4MGQlLjPbixQQ0IVytyy48zuyl7M3TO5hMNnsYvgRtGXCzvMgl58kV1QA5LOVmFYFrQg8wG61jdHCLrE5JqU3YMHICJoTwyDgehYg1V+cUMR79hp6B8ZwjxAc4TaWSpAltRGGKweGJH+un8iYIYwq1gydqDyyyuT+1B6yckz3h7jM5m2I8u7sY6vnPBKEWK1JwVUBxXsbCzPaEx9k5oocIc1Jua+SEkXIYSPv3PZr5xSklT5QNOD4vEAZ9deQdFfa+n91oqn6lw0gSibHN+ibY+qF9lkYc2YUGpWWD51jlaHnaOD1efxhmgeCCirJWKJr6JOoHQtq/rH205jUVVx0Jc8gZPAuyWK3H+BvlrGOuS7qSuHv5Ijk/0XAioOqblHFJqKCaxLxwLDUQzBDD2Ficay43IGqSvMe3RkQ+7HXHQ64'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 668, 'candidates_token_count': 370, 'total_token_count': 2199, 'prompt_tokens_details': [{'modality': 1, 'token_count': 668}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 370}], 'thoughts_token_count': 1161, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3088085483860325, 'model_name': 'gemini-2.5-pro'} id='run--6a00ab42-fce2-434e-b1e7-2dcd853ac05d-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import numpy as np\nimport pytest\n\nfrom astropy import units as u\nfrom astropy.coordinates import ITRS\nfrom astropy.tests.helper import assert_quantity_allclose\nfrom astropy.time import Time\n\n\ndef test_itrs_to_itrs_direct_transform():\n    """\n    Test that ITRS to ITRS transforms with different obstimes do not change\n    the coordinates, as should be the case for a direct transform.\n    This is for the issue raised in gh-13319.\n    """\n    # A point that is fixed in the ITRS frame\n    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,\n                     obstime="J2000")\n\n    # Transform to a different obstime\n    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))\n\n    # Without the direct transform, this will fail. It might fail with a\n    # TypeError, or it might give a large coordinate difference because it\n    # incorrectly goes through a sky frame (e.g., ICRS). With the fix, a\n    # direct transform is used, and the cartesian values should be nearly\n    # identical.\n    assert_quantity_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)\n', 'relative_path': 'astropy/coordinates/tests/test_itrs_direct_transform.py'}, 'id': '2343e1ef-7000-45d9-8bc2-c882c0cf2050', 'type': 'tool_call'}] usage_metadata={'input_tokens': 668, 'output_tokens': 370, 'total_tokens': 2199, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1161}}
2025-12-21 10:16:31,125 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/coordinates/tests/test_itrs_direct_transform.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1065, 'candidates_token_count': 17, 'total_token_count': 1082, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2226}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 17}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.772414372466943e-05, 'model_name': 'gemini-2.5-pro'} id='run--e6dfcbf7-1282-4158-acb3-422b0ec59e53-0' usage_metadata={'input_tokens': 1065, 'output_tokens': 17, 'total_tokens': 1082, 'input_token_details': {'cache_read': 0}}
2025-12-21 10:16:31,157 - thread-130546535499456.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/coordinates/tests/test_itrs_direct_transform.py b/astropy/coordinates/tests/test_itrs_direct_transform.py
new file mode 100644
index 0000000000..d46acb6c73
--- /dev/null
+++ b/astropy/coordinates/tests/test_itrs_direct_transform.py
@@ -0,0 +1,28 @@
+import numpy as np
+import pytest
+
+from astropy import units as u
+from astropy.coordinates import ITRS
+from astropy.tests.helper import assert_quantity_allclose
+from astropy.time import Time
+
+
+def test_itrs_to_itrs_direct_transform():
+    """
+    Test that ITRS to ITRS transforms with different obstimes do not change
+    the coordinates, as should be the case for a direct transform.
+    This is for the issue raised in gh-13319.
+    """
+    # A point that is fixed in the ITRS frame
+    itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,
+                     obstime="J2000")
+
+    # Transform to a different obstime
+    itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))
+
+    # Without the direct transform, this will fail. It might fail with a
+    # TypeError, or it might give a large coordinate difference because it
+    # incorrectly goes through a sky frame (e.g., ICRS). With the fix, a
+    # direct transform is used, and the cartesian values should be nearly
+    # identical.
+    assert_quantity_allclose(itrs_coo1.cartesian.xyz, itrs_coo2.cartesian.xyz, atol=1 * u.mm)

2025-12-21 10:16:31,158 - thread-130546535499456.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 10:16:31,187 - thread-130546535499456.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 10:16:31,187 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 10:16:31,288 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:16:31,288 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

HEAD is now at 6500928dc0 Merge pull request #13502 from taldcroft/better-iers-docs

2025-12-21 10:16:31,288 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 10:16:31,390 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:16:31,390 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:

Removing astropy/coordinates/builtin_frames/itrs_observed_transforms.py
Removing astropy/coordinates/tests/test_itrs_gh13319.py

2025-12-21 10:16:31,390 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 10:16:31,390 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/coordinates/tests in the container
2025-12-21 10:16:31,390 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/coordinates/tests
2025-12-21 10:16:31,492 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:16:31,492 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:


2025-12-21 10:16:31,492 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/tests/test_itrs_direct_transform.py in the container
2025-12-21 10:16:31,499 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 10:16:39,155 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/coordinates/tests/test_itrs_direct_transform.py"}'}, '__gemini_function_call_thought_signatures__': {'2b22495b-3d61-48da-a666-60b39a8af7bd': 'Co0WAY89a1+tO3Yb/LITMQCqFBWrbzUdYSoNZLJQHFVNM/5wV1rrJDp9G3AYgRKy2L+NNO7iJAZvXmqAgsGbyO9n7GgOdyRzWv11sLoJc0orN8H0Mtztd9Ofv4rpX1tSSlcuCkYe0+ELpI3RNtp4qQdA++KfTRwqyvH3f5A+zL/yT4T7rImW14KNwzbQ+vQkY6sgWxXmZyzoy6gPRd/iRBt1s/QY9dQfXGhUHQT7bkJjO3EHLmG6u9cTTJrsmSzULzsTdqVt4IBun2hER6gPnv8SW2F9spxz2NPOlmx+/sm+72HQMDOjzAQp/xBZ0nJ2O6qm67xksxmJF05OUdz2vEYvL8zx8oVI+yl8ZXOxL5tj9l0pwbzb0OIdVlMRqHCdZGaCi5N8mLfTsLAu9whEUqs45uuVJHmF8Z8f5wJrn3ytbgPNxBMELDWshQj/of3UmF0WDsbuFnWZqY7WLlv8lRRqbZ7bmx2PDOm48U/UgXfN5DoC1XqU0JmLqjQPJxgU2hCUqabbujbvfH7zsxCSTZtm1YMPM1z1SwMR+xAHw1TEpaPQs9kNh4zIYEMFJAsBtJkxtDllOZWqqggOa5ObOblhcEOnUH/QfdLvfFSkesWx3axlJ4ZPAavPo4MF2Kp1rOGm+G9ck8b+WU6l/aGmMPtIllcPtWHImLlL7fVQw+xePpUeME7aKSNUuNeCV3QCxre95Rz18K7/CQANOv+7Vg01QG27VEainMuTYITje+smVMghXIa/cZVKJYxyGoMheIrjtUD/QzhuSCziNIPrEzimwGQb7NLEVY4wGwX1mFgiKERWhFniXO9Bb6V40qe1mo3s3AIiePwmz1Xq/7Ux60SmCiR8pv0hRevExkhUG8W3pmKrs9hZm9urs9BdExQcMca702zzmn12ChUn7KlsfCXaT1Te6bGpApNjEBGUDsh2alqeMarkEb670oNrSjlJt7BmGD9h0tgG0jH6BUvwfi8Z5kCan+RSqVRHs5pv5/er8qsSOyIgPV9WpX0a0+8Ab292JH0AuVEKdIny9z6di0z00InvmcZ5x0r43LY4fuYOGSDz3apEeE+CFdZWub/qX/udaQajhGMBO0tm/DA5mkvcrjY56Ex/pRmgOgpygXC6vN+03uTFqZkZU1/EixnkPKJgS4eEboev61G1aP0q36GJLqWKnyig0+KP84Y6SY7tX+G0T3T8VQAFCFxYn98YqsuQdDwoz+KVJplms9r2hXndpWC5jPlh0jaQGZnnUZeY09zgh+Q3aAeDmeoG5Wenlf9k7r3glyanOXE4EPbusJ1B9mGygOv49ERheSP0w94DG9E1b6zWT6aUD2dy5WYnHjwVS7f6o75NRxYevcIunX86UlSIvafAJSMgFAggVZIy925DgqyWT1/0dNVQ+VmJV2cFh5XvJaI7q85ln8flh06jBBtv9S5QKJjeki1/ppLbRtB1RweYh+lR8sAo5TK8YkzhnCN6mX3XMNLYNMT4w6feueW7o+Ia1BNQ514LzwF1ADYr0LuJVdgL5AUwH0CMj+wWwxzY/Qo4ifE7q7EECg0mMFX4ZxNRtAMUgFFH9FsqCXyhSre0AHCQd3SPxK/WHxmaEkawfZvPjThnp3ycRTHNYymXSJgPn+hjG08cjhsYVyj+Lkzk8amn46M40POb6UJyqXA+eL7Ch8mZStdQTO5uwnQFb7TSc8vP9x9Rki/H5fKlvpMgf0mrSS8si5FSrCzVY3NNs3ZTVl2G5LizygKRjBXTjo8WrvcTJXOqDAIe04fefUgbn2GzVTPdymnvS7uOldBICs8xQkriOL5r8gD4uDMj1iRL4LOIAJIXrH6Oj1yOe8GqIsyg3QeNUBNdXAnNgVIRlQ8R71K1S04tucyJFSWs+9eYY/GtL6s+5XiJDL3CWQmSEtZTfNnLK/5kL7nhfoBpuKxvrejW7+E0cSosW6XZuo2xjDmgR1Ok/FCizSDA0FTV078PStEEhkfH4FZzOZcGRhTfh5U20pQoJh2oh7BnGzAIETLNk0dUrAIKGTl7AkAd3dY+PLn2FG5o76rD7gGHqfEj+5N5B2FOkrP57+Ym4WZqSzV06jFi45E5sM9z8vRvIhzF7eS0MGf4L64LNTqInA/j1OE7I5wKfHy1DQMSI1K5bmgiOjs/VWMsHPYnb3RHuppdHdnmvgpDtjFAYoG2Up+PTefO3oRcFfXtf/FY4rhn7UiwglqNjpd3N+5gIZtGnDoykLWYODnecM2Y1HTpovu6l19CAI2N3CeOsKKsKV7GlZ84cNUCqX6EqD6MG+w97Vj99pieen0IBNax+7P2/PWT9nriBSksSywpJeT/OoEBRgLdMh46LynUEq8YvQQLw8rfXtzoWv2j1Q/+yWq4cQu2/QQTCWLBpDtVTPKvN2wCRHbHSMlXEwsZcrNaHj7739KJcWjMu35NEKHA0/yiDsChmMQMqtkHircoExJwxF9GH6AtO6tr4MvJpDFhgsS49xm2itpsPWZGgE3sC6FgPFqsgmz9vctXsprbKT6VHzELHPms7RnyNbxSeQLgmrnCjDB55R9mfhzrFUqFYjc7PIIoI/u24xRcbLPAiHW0NbvhA1BOf2wXYhA1YyEDkhc/wlBiClxerbyQJN4QaOmeWxo7lNBvRxLYoxWIVaUwmCkVCSTV+7XSH4k/T2lvFCtl/GfHG2O0PguSBMEpSfsOSFGABy+N5Y1RA99WgUzw4tTm4o5sb0ULL/p3FWlwq0Vc4ndSYrAughcRVo1d6+6bMC3eRnMzGHnAJ9VYENquYP0zLIRx4ImPdv5htf5SuU0XOGpIsfRt4BBlaaqnxJyx3P3Yi1clk8XA4/sWXNvn7oDRupWDkVfJegai4aSEGfkZfil7nSUJWhyPfsejIqLvrnUeVC9PoiqdCrtsfIRNuMHhU3YLYDwe9FcH+VDmykOTMg24pPr6X/K8FmOjamnNFEWDT91QyTTKG7Yil4QSo2coGItRmbxOu61vku1OJkONs14cDssYeLq0kzXw/xN0WmHy+h5F0Eh8Y1EVNX4TPYa0/6ydwNcC5v2jl0P6letYBYqkUIIf/2VGGnWLxVeD8+XhExq+Kf4NZ1JZ5Cuw27+eundGoLFBwIr8aQR2Mu4brJA5uQOenI8a1CLOotSDhHbv2F4TQkFgk9sA2TDGFB6SkKLN/PFGIl1WNts6Q0jioGeLIIuVkjj1y2BCdY1bWYeYRaBN3Z5APrOfo4979rA4ZqxZj2+gctpbrWpDuP8BEdQOMNZY1KpFWRnX3Gv/KRv1X8A0DmXUBcwSuTtOaGzwIkAlCiK+cN2fxr0QYKtG+xnrgMwHezlGkusrZmHi3/rWrz0gqoI9Qs6Umrld+kALtjNl5HCh+KWK6vcViXN0MvJlUmybfcVxb3vNGdQH1gAh3A2LvxNwNQm5igxRH3/ykrDywbjXyPeM+GIvQzyIddA1reS3558A4FR6XbWHzfolHB4SqXzX+izSnBEROuGgSu3LGOwHPigPGa1tcfV5ZoS4VeAMCs2vFWvc7xnxrJqbIuQ2Jjkj4E1X1XW7nPX7uRIUuSRfcVHumMzpA37xj3jkYdmfGb6elqvYgY5m8VpP534IHvQyyROYpUqDOpaTIdbnvic+d/sRiO0j/NiGhCL8+ZK0xt1feTvRW3JrDrGPov3n5H5WWw64pf4vWPxOREBf1M95WHiZ9PLvNH2RCV9ZjU7vJs2JTLNN/Itvp/HITXOs4adPJK7TTzKV4OB8UYSfMTbYinb3Q9XswR4sBYJwmoJu6j3Y'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1597, 'candidates_token_count': 22, 'total_token_count': 2345, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1597}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 22}], 'thoughts_token_count': 726, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -5.888567144220525, 'model_name': 'gemini-2.5-pro'} id='run--cf75dc42-7721-48bb-83b3-ed8b75ecc74e-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/coordinates/tests/test_itrs_direct_transform.py'}, 'id': '2b22495b-3d61-48da-a666-60b39a8af7bd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1597, 'output_tokens': 22, 'total_tokens': 2345, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 726}}
2025-12-21 10:16:39,158 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/coordinates/tests/test_itrs_direct_transform.py
2025-12-21 10:16:41,938 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 10:16:41,938 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/coordinates/tests/test_itrs_
_direct_transform.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev287+g6500928dc.d20251221.
Running tests in astropy/coordinates/tests/test_itrs_direct_transform.py.

Date: 2025-12-21T10:16:40

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/coordinates/tests/test_itrs_direct_transform.py [31mF[0m[31m                [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_itrs_to_itrs_direct_transform ______________________[0m

    def test_itrs_to_itrs_direct_transform():
        """
        Test that ITRS to ITRS transforms with different obstimes do not change
        the coordinates, as should be the case for a direct transform.
        This is for the issue raised in gh-13319.
        """
        # A point that is fixed in the ITRS frame
        itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,
                         obstime="J2000")
    
        # Transform to a different obstime
>       itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))

[1m[31mastropy/coordinates/tests/test_itrs_direct_transform.py[0m:21: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31mastropy/coordinates/baseframe.py[0m:1202: in transform_to
    return trans(self, new_frame)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1079: in __call__
    return supcall(fromcoord, toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1556: in single_transform
    return self(from_coo, to_frame)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1079: in __call__
    return supcall(fromcoord, toframe)
[1m[31mastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py[0m:212: in itrs_to_cirs
    pmat = cirs_to_itrs_mat(itrs_coo.obstime)
[1m[31mastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py[0m:51: in cirs_to_itrs_mat
    xp, yp = get_polar_motion(time)
[1m[31mastropy/coordinates/builtin_frames/utils.py[0m:47: in get_polar_motion
    xp, yp, status = iers_table.pm_xy(time, return_status=True)
[1m[31mastropy/utils/iers/iers.py[0m:365: in pm_xy
    return self._interpolate(jd1, jd2, ['PM_x', 'PM_y'],
[1m[31mastropy/utils/iers/iers.py[0m:392: in _interpolate
    mjd, utc = self.mjd_utc(jd1, jd2)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <IERS_B length=22066>
 year month  day    MJD      PM_x   ... e_UT1_UTC  e_LOD  e_dX_2000A e_dY_2000A
                ...  1.2e-05 6.7e-06    7.5e-05    7.6e-05
 2022     5    31 59730.0  0.149795 ...  1.17e-05 6.7e-06    7.5e-05    7.5e-05
jd1 = <Time object: scale='tt' format='jyear_str' value=J2000.000>, jd2 = 0.0

    def mjd_utc(self, jd1, jd2=0.):
        """Turn a time to MJD, returning integer and fractional parts.
    
        Parameters
        ----------
        jd1 : float, array, or `~astropy.time.Time`
            first part of two-part JD, or Time object
        jd2 : float or array, optional
            second part of two-part JD.
            Default is 0., ignored if jd1 is `~astropy.time.Time`.
    
        Returns
        -------
        mjd : float or array
            integer part of MJD
        utc : float or array
            fractional part of MJD
        """
        try:  # see if this is a Time object
            jd1, jd2 = jd1.utc.jd1, jd1.utc.jd2
        except Exception:
            pass
    
>       mjd = np.floor(jd1 - MJD_ZERO + jd2)
[1m[31mE       TypeError: unsupported operand type(s) for -: 'Time' and 'float'[0m

[1m[31mastropy/utils/iers/iers.py[0m:271: TypeError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/coordinates/tests/test_itrs_direct_transform.py::[1mtest_itrs_to_itrs_direct_transform[0m - TypeError: unsupported operand type(s) for -: 'Time' and 'float'
[31m============================== [31m[1m1 failed[0m[31m in 1.01s[0m[31m ===============================[0m

2025-12-21 10:16:42,676 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={} response_metadata={'usage_metadata': {'prompt_token_count': 3765, 'total_token_count': 3765, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3765}], 'candidates_token_count': 0, 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': [], 'candidates_tokens_details': []}, 'model_name': 'gemini-2.5-pro'} id='run--aa9e1154-21e7-4f75-b0ad-b001d3b2065a-0' usage_metadata={'input_tokens': 3765, 'output_tokens': 0, 'total_tokens': 3765, 'input_token_details': {'cache_read': 0}}
2025-12-21 10:16:58,175 - thread-130546535499456.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='FAILED astropy/coordinates/tests/test_itrs_direct_transform.py::test_itrs_to_itrs_direct_transform - TypeError: unsupported operand type(s) for -: \'Time\' and \'float\'\n\nThe test fails with a TypeError, which is one of the failure modes mentioned in the test\'s docstring ("It might fail with a TypeError, or it might give a large coordinate difference"). This indicates that the transform is incorrectly going through a sky frame as described in the issue, rather than using a direct transformation that should leave the coordinates unchanged. Therefore, the test correctly reproduces the bug.' reproduced_bug_commands=['pytest astropy/coordinates/tests/test_itrs_direct_transform.py']
2025-12-21 10:16:58,177 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-21 10:16:58,177 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-21 10:16:58,177 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/coordinates/tests/test_itrs_direct_transform.py
2025-12-21 10:17:01,174 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 10:17:01,174 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/coordinates/tests/test_itrs_
_direct_transform.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev287+g6500928dc.d20251221.
Running tests in astropy/coordinates/tests/test_itrs_direct_transform.py.

Date: 2025-12-21T10:16:59

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/coordinates/tests/test_itrs_direct_transform.py [31mF[0m[31m                [100%][0m

=================================== FAILURES ===================================
[31m[1m______________________ test_itrs_to_itrs_direct_transform ______________________[0m

    def test_itrs_to_itrs_direct_transform():
        """
        Test that ITRS to ITRS transforms with different obstimes do not change
        the coordinates, as should be the case for a direct transform.
        This is for the issue raised in gh-13319.
        """
        # A point that is fixed in the ITRS frame
        itrs_coo1 = ITRS(x=1000 * u.km, y=2000 * u.km, z=3000 * u.km,
                         obstime="J2000")
    
        # Transform to a different obstime
>       itrs_coo2 = itrs_coo1.transform_to(ITRS(obstime="J2010"))

[1m[31mastropy/coordinates/tests/test_itrs_direct_transform.py[0m:21: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31mastropy/coordinates/baseframe.py[0m:1202: in transform_to
    return trans(self, new_frame)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1079: in __call__
    return supcall(fromcoord, toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1556: in single_transform
    return self(from_coo, to_frame)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1478: in __call__
    curr_coord = t(curr_coord, curr_toframe)
[1m[31mastropy/coordinates/transformations.py[0m:1079: in __call__
    return supcall(fromcoord, toframe)
[1m[31mastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py[0m:212: in itrs_to_cirs
    pmat = cirs_to_itrs_mat(itrs_coo.obstime)
[1m[31mastropy/coordinates/builtin_frames/intermediate_rotation_transforms.py[0m:51: in cirs_to_itrs_mat
    xp, yp = get_polar_motion(time)
[1m[31mastropy/coordinates/builtin_frames/utils.py[0m:47: in get_polar_motion
    xp, yp, status = iers_table.pm_xy(time, return_status=True)
[1m[31mastropy/utils/iers/iers.py[0m:365: in pm_xy
    return self._interpolate(jd1, jd2, ['PM_x', 'PM_y'],
[1m[31mastropy/utils/iers/iers.py[0m:392: in _interpolate
    mjd, utc = self.mjd_utc(jd1, jd2)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <IERS_B length=22066>
 year month  day    MJD      PM_x   ... e_UT1_UTC  e_LOD  e_dX_2000A e_dY_2000A
                ...  1.2e-05 6.7e-06    7.5e-05    7.6e-05
 2022     5    31 59730.0  0.149795 ...  1.17e-05 6.7e-06    7.5e-05    7.5e-05
jd1 = <Time object: scale='tt' format='jyear_str' value=J2000.000>, jd2 = 0.0

    def mjd_utc(self, jd1, jd2=0.):
        """Turn a time to MJD, returning integer and fractional parts.
    
        Parameters
        ----------
        jd1 : float, array, or `~astropy.time.Time`
            first part of two-part JD, or Time object
        jd2 : float or array, optional
            second part of two-part JD.
            Default is 0., ignored if jd1 is `~astropy.time.Time`.
    
        Returns
        -------
        mjd : float or array
            integer part of MJD
        utc : float or array
            fractional part of MJD
        """
        try:  # see if this is a Time object
            jd1, jd2 = jd1.utc.jd1, jd1.utc.jd2
        except Exception:
            pass
    
>       mjd = np.floor(jd1 - MJD_ZERO + jd2)
[1m[31mE       TypeError: unsupported operand type(s) for -: 'Time' and 'float'[0m

[1m[31mastropy/utils/iers/iers.py[0m:271: TypeError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/coordinates/tests/test_itrs_direct_transform.py::[1mtest_itrs_to_itrs_direct_transform[0m - TypeError: unsupported operand type(s) for -: 'Time' and 'float'
[31m============================== [31m[1m1 failed[0m[31m in 1.12s[0m[31m ===============================[0m

2025-12-21 10:17:01,174 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-21 10:17:01,174 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-21 10:17:01,179 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-21 10:17:01,180 - thread-130546535499456.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 10:17:01,180 - thread-130546535499456.app.docker.base_container - INFO - Creating directory astropy/coordinates/builtin_frames in the container
2025-12-21 10:17:01,180 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/coordinates/builtin_frames
2025-12-21 10:17:01,281 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:17:01,281 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
s


2025-12-21 10:17:01,281 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/builtin_frames/itrs_observed_transforms.py in the container
2025-12-21 10:17:01,282 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/builtin_frames/__init__.py in the container
2025-12-21 10:17:01,282 - thread-130546535499456.app.docker.base_container - INFO - Updating astropy/coordinates/builtin_frames/intermediate_rotation_transforms.py in the container
2025-12-21 10:17:01,290 - thread-130546535499456.app.docker.base_container - INFO - Files updated successfully
2025-12-21 10:17:01,290 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-21 10:17:01,290 - thread-130546535499456.app.docker.base_container - DEBUG - Executing command: pytest astropy/coordinates/tests/test_itrs_direct_transform.py
2025-12-21 10:17:03,320 - thread-130546535499456.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 10:17:03,320 - thread-130546535499456.app.docker.base_container - DEBUG - Command output:
pytest astropy/coordinates/tests/test_itrs_
_direct_transform.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.2.dev287+g6500928dc.d20251221.
Running tests in astropy/coordinates/tests/test_itrs_direct_transform.py.

Date: 2025-12-21T10:17:02

Platform: Linux-6.8.0-36-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: doctestplus-1.0.0, cov-4.1.0, xdist-3.3.1, filter-subpackage-0.1.2, astropy-header-0.2.2, remotedata-0.4.0, astropy-0.10.0, mock-3.11.1, arraydiff-0.5.0, openfiles-0.5.0, hypothesis-6.46.7
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/coordinates/tests/test_itrs_direct_transform.py [32m.[0m[32m                [100%][0m

[32m============================== [32m[1m1 passed[0m[32m in 0.25s[0m[32m ===============================[0m

2025-12-21 10:17:03,320 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-21 10:17:03,348 - thread-130546535499456.app.lang_graph.nodes.dual_version_validation_node - INFO - Validation PASSED: Test fails on old, passes on new
2025-12-21 10:17:03,349 - thread-130546535499456.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-12-21 10:17:03,349 - thread-130546535499456.app.docker.base_container - INFO - Closing persistent shell...
2025-12-21 10:17:03,450 - thread-130546535499456.app.docker.base_container - INFO - Cleaning up container and temporary files
