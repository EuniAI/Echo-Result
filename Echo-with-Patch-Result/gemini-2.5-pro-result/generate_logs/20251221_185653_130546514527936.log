2025-12-21 18:56:53,630 - thread-130546514527936.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpiall4o5y/astropy
2025-12-21 18:56:53,630 - thread-130546514527936.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-12-21 18:56:53,630 - thread-130546514527936.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-7166:v1
2025-12-21 18:59:22,126 - thread-130546514527936.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_107b44b96c
2025-12-21 18:59:22,140 - thread-130546514527936.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_107b44b96c
2025-12-21 18:59:22,717 - thread-130546514527936.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-12-21 18:59:26,702 - thread-130546514527936.app.docker.base_container - INFO - Persistent shell is ready
2025-12-21 18:59:26,702 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-12-21 18:59:26,966 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 18:59:26,966 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:


2025-12-21 18:59:26,966 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-12-21 18:59:27,201 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 18:59:27,201 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:


2025-12-21 18:59:27,202 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-12-21 18:59:33,423 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 18:59:33,424 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:
[A(testbed) root@ucl-research:/testbed# python -m pip install -e .[test] --verbos[Ke

Using pip 21.2.2 from /opt/miniconda3/envs/testbed/lib/python3.6/site-packages/pip (python 3.6)
Obtaining file:///testbed
    Running command python setup.py egg_info
    running egg_info
    creating /tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info
    writing /tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/PKG-INFO
    writing dependency_links to /tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/dependency_links.txt
    writing entry points to /tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/entry_points.txt
    writing requirements to /tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/requires.txt
    writing top-level names to /tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/top_level.txt
    writing manifest file '/tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/SOURCES.txt'
    reading manifest file '/tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    warning: no files found matching 'astropy/utils/misc/data/.hidden_file.txt'
    warning: no files found matching '*' under directory 'scripts'
    warning: no files found matching '*' under directory 'astropy/sphinx/themes'
    no previously-included directories found matching 'docs/_build'
    no previously-included directories found matching 'build'
    warning: no files found matching '*.pyx' under directory 'astropy_helpers/astropy_helpers'
    warning: no files found matching '*.h' under directory 'astropy_helpers/astropy_helpers'
    no previously-included directories found matching 'astropy_helpers/build'
    warning: no previously-included files matching '*.o' found anywhere in distribution
    writing manifest file '/tmp/pip-pip-egg-info-23ms26uj/astropy.egg-info/SOURCES.txt'
Requirement already satisfied: numpy>=1.10.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from astropy==3.1.dev21446) (1.16.0)
Requirement already satisfied: pytest-astropy in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from astropy==3.1.dev21446) (0.2.1)
Requirement already satisfied: pytest>=3.1.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest-astropy->astropy==3.1.dev21446) (3.3.1)
Requirement already satisfied: pytest-openfiles>=0.2.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest-astropy->astropy==3.1.dev21446) (0.2.0)
Requirement already satisfied: pytest-doctestplus>=0.1.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest-astropy->astropy==3.1.dev21446) (0.1.2)
Requirement already satisfied: pytest-remotedata>=0.2.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest-astropy->astropy==3.1.dev21446) (0.2.0)
Requirement already satisfied: pytest-arraydiff in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest-astropy->astropy==3.1.dev21446) (0.1)
Requirement already satisfied: pluggy<0.7,>=0.5 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest>=3.1.0->pytest-astropy->astropy==3.1.dev21446) (0.6.0)
Requirement already satisfied: setuptools in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest>=3.1.0->pytest-astropy->astropy==3.1.dev21446) (38.2.4)
Requirement already satisfied: py>=1.5.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest>=3.1.0->pytest-astropy->astropy==3.1.dev21446) (1.11.0)
Requirement already satisfied: six>=1.10.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest>=3.1.0->pytest-astropy->astropy==3.1.dev21446) (1.16.0)
Requirement already satisfied: attrs>=17.2.0 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest>=3.1.0->pytest-astropy->astropy==3.1.dev21446) (17.3.0)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from pytest-openfiles>=0.2.0->pytest-astropy->astropy==3.1.dev21446) (5.4.2)
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 3.1.dev21446
    Uninstalling astropy-3.1.dev21446:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Removing file or directory /opt/miniconda3/envs/testbed/lib/python3.6/site-packages/astropy.egg-link
      Removing pth entries from /opt/miniconda3/envs/testbed/lib/python3.6/site-packages/easy-install.pth:
      Removing entry: /testbed
      Successfully uninstalled astropy-3.1.dev21446
  Running setup.py develop for astropy
    Running command /opt/miniconda3/envs/testbed/bin/python -c 'import io, os, sys, setuptools, tokenize; sys.argv[0] = '"'"'/testbed/setup.py'"'"'; __file__='"'"'/testbed/setup.py'"'"';f = getattr(tokenize, '"'"'open'"'"', open)(__file__) if os.path.exists(__file__) else io.StringIO('"'"'from setuptools import setup; setup()'"'"');code = f.read().replace('"'"'\r\n'"'"', '"'"'\n'"'"');f.close();exec(compile(code, __file__, '"'"'exec'"'"'))' develop --no-deps
    running develop
    running egg_info
    writing astropy.egg-info/PKG-INFO
    writing dependency_links to astropy.egg-info/dependency_links.txt
    writing entry points to astropy.egg-info/entry_points.txt
    writing requirements to astropy.egg-info/requires.txt
    writing top-level names to astropy.egg-info/top_level.txt
    reading manifest file 'astropy.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    warning: no files found matching 'astropy/utils/misc/data/.hidden_file.txt'
    warning: no files found matching '*' under directory 'scripts'
    warning: no files found matching '*' under directory 'astropy/sphinx/themes'
    no previously-included directories found matching 'docs/_build'
    no previously-included directories found matching 'build'
    warning: no files found matching '*.pyx' under directory 'astropy_helpers/astropy_helpers'
    warning: no files found matching '*.h' under directory 'astropy_helpers/astropy_helpers'
    no previously-included directories found matching 'astropy_helpers/build'
    warning: no previously-included files matching '*.o' found anywhere in distribution
    writing manifest file 'astropy.egg-info/SOURCES.txt'
    running build_ext
    running pre_hook from astropy.modeling.setup_package for build_ext command
    running pre_hook from astropy._erfa.setup_package for build_ext command
    building 'astropy._compiler' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wl,--sysroot=/ -Wsign-compare -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/opt/miniconda3/envs/testbed/include/python3.6m -c astropy/_compiler.c -o build/temp.linux-x86_64-3.6/astropy/_compiler.o
    gcc -pthread -shared -B /opt/miniconda3/envs/testbed/compiler_compat -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath=/opt/miniconda3/envs/testbed/lib -Wl,--no-as-needed -Wl,--sysroot=/ build/temp.linux-x86_64-3.6/astropy/_compiler.o -o /testbed/astropy/_compiler.cpython-36m-x86_64-linux-gnu.so
    skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
    skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
    skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
    skipping 'astropy/cosmology/scalar_inv_efuncs.c' Cython extension (up-to-date)
    skipping 'astropy/convolution/boundary_wrap.c' Cython extension (up-to-date)
    skipping 'astropy/convolution/boundary_extend.c' Cython extension (up-to-date)
    skipping 'astropy/convolution/boundary_fill.c' Cython extension (up-to-date)
    skipping 'astropy/convolution/boundary_none.c' Cython extension (up-to-date)
    skipping 'astropy/stats/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
    Creating /opt/miniconda3/envs/testbed/lib/python3.6/site-packages/astropy.egg-link (link to .)
    Adding astropy 3.1.dev21446 to easy-install.pth file
    Installing fits2bitmap script to /opt/miniconda3/envs/testbed/bin
    Installing fitscheck script to /opt/miniconda3/envs/testbed/bin
    Installing fitsdiff script to /opt/miniconda3/envs/testbed/bin
    Installing fitsheader script to /opt/miniconda3/envs/testbed/bin
    Installing fitsinfo script to /opt/miniconda3/envs/testbed/bin
    Installing samp_hub script to /opt/miniconda3/envs/testbed/bin
    Installing showtable script to /opt/miniconda3/envs/testbed/bin
    Installing volint script to /opt/miniconda3/envs/testbed/bin
    Installing wcslint script to /opt/miniconda3/envs/testbed/bin

    Installed /testbed
Successfully installed astropy-3.1.dev21446
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/9f/8b/a094f5da22d7abf5098205367b3296dd15b914f4232af5ca39ba6214d08c/pip-22.0-py3-none-any.whl#sha256=6cb1ea2bd7fda0668e26ae8c3e45188f301a7ef17ff22efe1f70f3643e56a822 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/4a/ca/e72b3b399d7a8cb34311aa8f52924108591c013b09f0268820afb4cd96fb/pip-22.0.tar.gz#sha256=d3fa5c3e42b33de52bddce89de40268c9a263cd6ef7c94c40774808dafb32c82 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/89/a1/2f4e58eda11e591fbfa518233378835679fc5ab766b690b3df85215014d5/pip-22.0.1-py3-none-any.whl#sha256=30739ac5fb973cfa4399b0afff0523d4fe6bed2f7a5229333f64d9c2ce0d1933 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/63/71/5686e51f06fa59da55f7e81c3101844e57434a30f4a0d7456674d1459841/pip-22.0.1.tar.gz#sha256=7fd7a92f2fb1d2ac2ae8c72fb10b1e640560a0361ed4427453509e2bcc18605b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/83/b5/df8640236faa5a3cb80bfafd68e9fb4b22578208b8398c032ccff803f9e0/pip-22.0.2-py3-none-any.whl#sha256=682eabc4716bfce606aca8dab488e9c7b58b0737e9001004eb858cdafcd8dbdd (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/d9/c1/146b24a7648fdf3f8b4dc6521ab0b26ac151ef903bac0b63a4e1450cb4d1/pip-22.0.2.tar.gz#sha256=27b4b70c34ec35f77947f777070d8331adbb1e444842e98e7150c288dc0caea4 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/6a/df/a6ef77a6574781a668791419ffe366c8acd1c3cf4709d210cb53cd5ce1c2/pip-22.0.3-py3-none-any.whl#sha256=c146f331f0805c77017c6bb9740cec4a49a0d4582d0c3cc8244b057f83eca359 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/88/d9/761f0b1e0551a3559afe4d34bd9bf68fc8de3292363b3775dda39b62ce84/pip-22.0.3.tar.gz#sha256=f29d589df8c8ab99c060e68ad294c4a9ed896624f6368c5349d70aa581b333d0 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/4d/16/0a14ca596f30316efd412a60bdfac02a7259bf8673d4d917dc60b9a21812/pip-22.0.4-py3-none-any.whl#sha256=c6aca0f2f081363f689f041d90dab2a07a9a07fb840284db2218117a52da800b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/33/c9/e2164122d365d8f823213a53970fa3005eb16218edcfc56ca24cb6deba2b/pip-22.0.4.tar.gz#sha256=b3a9de2c6ef801e9247d1527a4b16f92f2cc141cd1489f3fffaf6a9e96729764 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/79/3a/d341ae105c8b49eac912bee40739d496ae80f9441efa7df6c68f4997bbc8/pip-22.1b1-py3-none-any.whl#sha256=09e9e8f8e10f2515134b59600ad3630219430eabb734336079cbc6ffb2e01a0e (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/a7/c0/794f22836ef3202a7ad61f0872278ee7ac62e8c7617e4c9a08f01b5e82da/pip-22.1b1.tar.gz#sha256=f54ab61985754b56c5589178cfd7dfca5ed9f98d5c8f2de2eecb29f1341200f1 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/f3/77/23152f90de45957b59591c34dcb39b78194eb67d088d4f8799e9aa9726c4/pip-22.1-py3-none-any.whl#sha256=802e797fb741be1c2d475533d4ea951957e4940091422bd4a24848a7ac95609d (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/99/bb/696e256f4f445809f25efd4e4ce42ff99664dc089cafa1e097d5fec7fc33/pip-22.1.tar.gz#sha256=2debf847016cfe643fa1512e2d781d3ca9e5c878ba0652583842d50cc2bcc605 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/9b/e6/aa8149e048eda381f2a433599be9b1f5e5e3a189636cd6cf9614aa2ff5be/pip-22.1.1-py3-none-any.whl#sha256=e7bcf0b2cbdec2af84cc1b7b79b25fdbd7228fbdb61a4dca0b82810d0ba9d18b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/3e/0a/6125e67aa4d3245faeed476e4e26f190b5209f84f01efd733ac6372eb247/pip-22.1.1.tar.gz#sha256=8dfb15d8a1c3d3085a4cbe11f29e19527dfaf2ba99354326fd62cec013eaee81 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/96/2f/caec18213f6a67852f6997fb0673ae08d2e93d1b81573edb93ba4ef06970/pip-22.1.2-py3-none-any.whl#sha256=a3edacb89022ef5258bf61852728bf866632a394da837ca49eb4303635835f17 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/4b/b6/0fa7aa968a9fa4ef63a51b3ff0644e59f49dcd7235b3fd6cceb23f202e08/pip-22.1.2.tar.gz#sha256=6d55b27e10f506312894a87ccc59f280136bad9061719fac9101bdad5a6bce69 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/9b/9e/9e0610f25e65e2cdf90b1ee9c47ca710865401904038558ac0129ea23cbc/pip-22.2-py3-none-any.whl#sha256=9abf423d5d64f3289ab9d5bf31da9e6234f2e9c5d8dcf1423bcb46b809a02c2c (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/cd/b6/cf07132d631444dd7ce0ed199f2327eb34e2418f1675145e5b10e1ee65cd/pip-22.2.tar.gz#sha256=8d63fcd4ee293e30b644827268a0a973d080e5c7425ef26d427f5eb2126c7681 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/84/25/5734a44897751d8bac6822efb819acda2d969bcc1b915bbd7d48102952cb/pip-22.2.1-py3-none-any.whl#sha256=0bbbc87dfbe6eed217beff0021f8b7dea04c8f4a0baa9d31dc4cff281ffc5b2b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/46/28/addd7e66bb3af799d35a5dcbb79407b591a7ed674f4efd2bd8f930c40821/pip-22.2.1.tar.gz#sha256=50516e47a2b79e77446f0d05649f0d53772c192571486236b1905492bfc24bac (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/1f/2c/d9626f045e7b49a6225c6b09257861f24da78f4e5f23af2ddbdf852c99b8/pip-22.2.2-py3-none-any.whl#sha256=b61a374b5bc40a6e982426aede40c9b5a08ff20e640f5b56977f4f91fed1e39a (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/4b/30/e15b806597e67057e07a5acdc135216ccbf76a5f1681a324533b61066b0b/pip-22.2.2.tar.gz#sha256=3fd1929db052f056d7a998439176d3333fa1b3f6c1ad881de1885c0717608a4b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/47/ef/8b5470b5b94b36231ed9c0bde90caa71c0d4322d4a15f009b2b7f4287fe0/pip-22.3-py3-none-any.whl#sha256=1daab4b8d3b97d1d763caeb01a4640a2250a0ea899e257b1e44b9eded91e15ab (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/f8/08/7f92782ff571c7c7cb6c5eeb8ebbb1f68cb02bdb24e55c5de4dd9ce98bc3/pip-22.3.tar.gz#sha256=8182aec21dad6c0a49a2a3d121a87cd524b950e0b6092b181625f07ebdde7530 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/09/bd/2410905c76ee14c62baf69e3f4aa780226c1bbfc9485731ad018e35b0cb5/pip-22.3.1-py3-none-any.whl#sha256=908c78e6bc29b676ede1c4d57981d490cb892eb45cd8c214ab6298125119e077 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/a3/50/c4d2727b99052780aad92c7297465af5fe6eec2dbae490aa9763273ffdc1/pip-22.3.1.tar.gz#sha256=65fd48317359f3af8e593943e6ae1506b66325085ea64b706a998c6e83eeaf38 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/ab/43/508c403c38eeaa5fc86516eb13bb470ce77601b6d2bbcdb16e26328d0a15/pip-23.0-py3-none-any.whl#sha256=b5f88adff801f5ef052bcdef3daa31b55eb67b0fccd6d0106c206fa248e0463c (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/b5/16/5e24bf63cff51dcc169f43bd43b86b005c49941e09cc3482a5b370db239e/pip-23.0.tar.gz#sha256=aee438284e82c8def684b0bcc50b1f6ed5e941af97fa940e83e2e8ef1a59da9b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/07/51/2c0959c5adf988c44d9e1e0d940f5b074516ecc87e96b1af25f59de9ba38/pip-23.0.1-py3-none-any.whl#sha256=236bcb61156d76c4b8a05821b988c7b8c35bf0da28a4b614e8d6ab5212c25c6f (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/6b/8b/0b16094553ecc680e43ded8f920c3873b01b1da79a54274c98f08cb29fca/pip-23.0.1.tar.gz#sha256=cd015ea1bfb0fcef59d8a286c1f8bebcb983f6317719d415dc5351efb7cd7024 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/ae/db/a8821cdac455a1740580c92de3ed7b7f257cfdbad8b1ba8864e6abe58a08/pip-23.1-py3-none-any.whl#sha256=64b1d4528e491aa835ec6ece0c1ac40ce6ab6d886e60740f6519db44b2e9634d (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/da/bf/1bdbe62f5fbde085351693e3a8e387a59f8220932b911b1719fe65efa2d7/pip-23.1.tar.gz#sha256=408539897ee535dbfb83a153f7bc4d620f990d8bd44a52a986efc0b4d330d34a (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/f8/f8/17bd3f7c13515523d811ce4104410c16c03e3c6830f9276612e2f4b28382/pip-23.1.1-py3-none-any.whl#sha256=3d8d72fa0714e93c9d3c2a0ede91e898c64596e0fa7d4523f72dd95728efc418 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/43/7d/1f52f99a7f2eae870483b2c2a3064511487de87911bce146df8a154fbe81/pip-23.1.1.tar.gz#sha256=c95b53d309f903f33dfe5fd37e502a5c3a05ee3454d518e45df522a4f091b728 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/08/e3/57d4c24a050aa0bcca46b2920bff40847db79535dc78141eb83581a52eb8/pip-23.1.2-py3-none-any.whl#sha256=3ef6ac33239e4027d9a5598a381b9d30880a1477e50039db2eac6e8a8f6d1b18 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/fa/ee/74ff76da0ab649eec7581233daeb43d8aa35383d8f75317b2ab3b80c922f/pip-23.1.2.tar.gz#sha256=0e7c86f486935893c708287b30bd050a36ac827ec7fe5e43fe7cb198dd835fba (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/02/65/f15431ddee78562355ccb39097bf9160a1689f2db40dc418754be98806a1/pip-23.2-py3-none-any.whl#sha256=78e5353a9dda374b462f2054f83a7b63f3f065c98236a68361845c1b0ee7e35f (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/3d/ab/21fa8d1ecf5648559f056fda732b0f9fca0585eb2688252e67f70e74deaf/pip-23.2.tar.gz#sha256=a160a170f3331d9ca1a0247eb1cd79c758879f1f81158f9cd05bbb5df80bea5c (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/50/c2/e06851e8cc28dcad7c155f4753da8833ac06a5c704c109313b8d5a62968a/pip-23.2.1-py3-none-any.whl#sha256=7ccf472345f20d35bdc9d1841ff5f313260c2c33fe417f48c30ac46cccabf5be (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/ba/19/e63fb4e0d20e48bd2167bb7e857abc0e21679e24805ba921a224df8977c0/pip-23.2.1.tar.gz#sha256=fb0bd5435b3200c602b5bf61d2d43c2f13c02e29c1707567ae7fbc514eb9faf2 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/e0/63/b428aaca15fcd98c39b07ca7149e24bc14205ad0f1c80ba2b01835aedde1/pip-23.3-py3-none-any.whl#sha256=bc38bb52bc286514f8f7cb3a1ba5ed100b76aaef29b521d48574329331c5ae7b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/0d/f6/07ef4561bb911285c229fa46ed3df1877bd6c5325c4c67d516560d59a6e6/pip-23.3.tar.gz#sha256=bb7d4f69f488432e4e96394612f43ab43dd478d073ef7422604a570f7157561e (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/47/6a/453160888fab7c6a432a6e25f8afe6256d0d9f2cbd25971021da6491d899/pip-23.3.1-py3-none-any.whl#sha256=55eb67bb6171d37447e82213be585b75fe2b12b359e993773aca4de9247a052b (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/1f/7f/4da15e07ccd11c84c1ccc8f6e24288d5e76c99441bf80e315b33542db951/pip-23.3.1.tar.gz#sha256=1fcaa041308d01f14575f6d0d2ea4b75a3e2871fe4f9c694976f908768e14174 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/15/aa/3f4c7bcee2057a76562a5b33ecbd199be08cdb4443a02e26bd2c3cf6fc39/pip-23.3.2-py3-none-any.whl#sha256=5052d7889c1f9d05224cd41741acb7c5d6fa735ab34e339624a614eaaa7e7d76 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/b7/06/6b1ad0ae8f97d7a0d6f6ad640db10780578999e647a9593512ceb6f06469/pip-23.3.2.tar.gz#sha256=7fd9972f96db22c8077a1ee2691b172c8089b17a5652a44494a9ecb0d78f9149 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/8a/6a/19e9fe04fca059ccf770861c7d5721ab4c2aebc539889e97c7977528a53b/pip-24.0-py3-none-any.whl#sha256=ba0d021a166865d2265246961bec0152ff124de910c5cc39f1156ce3fa7c69dc (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.7'): https://files.pythonhosted.org/packages/94/59/6638090c25e9bc4ce0c42817b5a234e183872a1129735a9330c472cc2056/pip-24.0.tar.gz#sha256=ea9bd1a847e8c5774a5777bb398c19e80bcd4e2aa16a4b301b718fe6f593aba2 (from https://pypi.org/simple/pip/) (requires-python:>=3.7)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/1e/65/22725f8ba583376d0c300c3b9b52b9a67cfd93d786a80be73c167e45abc8/pip-24.1b1-py3-none-any.whl#sha256=752516cffafef5cf29d3fb2f06c978f27e98709654689cf277b2fce984c7a591 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/71/38/b0cb3d68b4776b6208a2f16b6d444a848a1fe465a78ce4b7dbbeb8a4fc58/pip-24.1b1.tar.gz#sha256=a9bd4c037d72325b4e903ec3f383263deea3eb73cd01db7a844edd026fc68afe (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/c1/64/0f1528ed3dfd75a56e084caab3c8dbed596bf87a1dfc40cbc57166bb0c25/pip-24.1b2-py3-none-any.whl#sha256=7b4ae01a2af4bfae0386860c5a12c035fcc228364ddef89192a1c31d48d263a1 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/0b/b2/1d1eac32a16fd9478fb9bc6eb6b899f91e6fecceba194fa097c35d385e9a/pip-24.1b2.tar.gz#sha256=926201900a0e26929387023907bf395c9a6c0d37bbea176942ca5e1b6b27e815 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/25/49/2255373efd193c6fbd97dc22399e9c830a6517a0f02ca77fbc0bd83ac5cc/pip-24.1-py3-none-any.whl#sha256=a775837439bf5da2c1a0c2fa43d5744854497c689ddbd9344cf3ea6d00598540 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/df/60/7538a9cd4d76829c2f585b73d6e400c833a1769408451c813354c58de6cc/pip-24.1.tar.gz#sha256=bdae551038c0ce6a83030b4aedef27fc95f0daa683593fea22fa05e55ed8e317 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/f4/ab/e3c039b5ddba9335bd8f82d599eb310de1d2a2db0411b8d804d507405c74/pip-24.1.1-py3-none-any.whl#sha256=efca15145a95e95c00608afeab66311d40bfb73bb2266a855befd705e6bb15a0 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/c0/d0/9641dc7b05877874c6418f8034ddefc809495e65caa14d38c7551cd114bb/pip-24.1.1.tar.gz#sha256=5aa64f65e1952733ee0a9a9b1f52496ebdb3f3077cc46f80a16d983b58d1180a (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/e7/54/0c1c068542cee73d8863336e974fc881e608d0170f3af15d0c0f28644531/pip-24.1.2-py3-none-any.whl#sha256=7cd207eed4c60b0f411b444cd1464198fe186671c323b6cd6d433ed80fc9d247 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/12/3d/d899257cace386bebb7bdf8a872d5fe3b935cc6381c3ddb76d3e5d99890d/pip-24.1.2.tar.gz#sha256=e5458a0b89f2755e0ee8c0c77613fe5273e05f337907874d64f13171a898a7ff (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/d4/55/90db48d85f7689ec6f81c0db0622d704306c5284850383c090e6c7195a5c/pip-24.2-py3-none-any.whl#sha256=2cd581cf58ab7fcfca4ce8efa6dcacd0de5bf8d0a3eb9ec927e07405f4d9e2a2 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/4d/87/fb90046e096a03aeab235e139436b3fe804cdd447ed2093b0d70eba3f7f8/pip-24.2.tar.gz#sha256=5b5e490b5e9cb275c879595064adce9ebd31b854e3e803740b72f9ccf34a45b8 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/ce/22/4bb91eb040e18eedaba1ba9db41ef909bc73d20023cea09024099909998a/pip-24.3-py3-none-any.whl#sha256=461877c364317128146d1eb33c62c2a80e33cb23b4cafdf4ad728bc74958e0dd (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/a3/63/dca2c8e2dbfbde322386caf6e674f97f46a6f11d496dc96b99594f8ecc33/pip-24.3.tar.gz#sha256=cd831345d9ce4f74ff7115203d3a0bd6730a1ba814f9327ede48910b1e30a447 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/ef/7d/500c9ad20238fcfcb4cb9243eede163594d7020ce87bd9610c9e02771876/pip-24.3.1-py3-none-any.whl#sha256=3790624780082365f47549d032f3770eeb2b1e8bd1f7b2e02dace1afa361b4ed (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/f4/b1/b422acd212ad7eedddaf7981eee6e5de085154ff726459cf2da7c5a184c1/pip-24.3.1.tar.gz#sha256=ebcb60557f2aefabc2e0f918751cd24ea0d56d8ec5445fe1807f1d2109660b99 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/85/8a/1ddf40be20103bcc605db840e9ade09c8e8c9f920a03e9cfe88eae97a058/pip-25.0-py3-none-any.whl#sha256=b6eb97a803356a52b2dd4bb73ba9e65b2ba16caa6bcb25a7497350a4e5859b65 (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/47/3e/68beeeeb306ea20ffd30b3ed993f531d16cd884ec4f60c9b1e238f69f2af/pip-25.0.tar.gz#sha256=8e0a97f7b4c47ae4a494560da84775e9e2f671d415d8d828e052efefb206b30b (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/c9/bc/b7db44f5f39f9d0494071bddae6880eb645970366d0a200022a1a93d57f5/pip-25.0.1-py3-none-any.whl#sha256=c46efd13b6aa8279f33f2864459c8ce587ea6a1a59ee20de055868d8f7688f7f (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.8'): https://files.pythonhosted.org/packages/70/53/b309b4a497b09655cb7e07088966881a57d082f48ac3cb54ea729fd2c6cf/pip-25.0.1.tar.gz#sha256=88f96547ea48b940a3a385494e181e29fb8637898f88d88737c5049780f196ea (from https://pypi.org/simple/pip/) (requires-python:>=3.8)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/e0/f0/8a2806114cd36e282823fd4d8e88e3b94dc943c2569c350d0c826a49db38/pip-25.1-py3-none-any.whl#sha256=13b4aa0aaad055020a11bec8a1c2a70a2b2d080e12d89b962266029fff0a16ba (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/79/67/c06f625e2968c417052b3a4a0eef40656d5d4d44033e57b40ec474af1d28/pip-25.1.tar.gz#sha256=272bdd1289f80165e9070a4f881e8f9e1001bbb50378561d1af20e49bf5a2200 (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/29/a2/d40fb2460e883eca5199c62cfc2463fd261f760556ae6290f88488c362c0/pip-25.1.1-py3-none-any.whl#sha256=2913a38a2abf4ea6b64ab507bd9e967f3b53dc1ede74b01b0931e1ce548751af (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/59/de/241caa0ca606f2ec5fe0c1f4261b0465df78d786a38da693864a116c37f4/pip-25.1.1.tar.gz#sha256=3de45d411d308d5054c2168185d8da7f9a2cd753dbac8acbfa88a8909ecd9077 (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/b7/3f/945ef7ab14dc4f9d7f40288d2df998d1837ee0888ec3659c813487572faa/pip-25.2-py3-none-any.whl#sha256=6d67a2b4e7f14d8b31b8b52648866fa717f45a1eb70e83002f4331d07e953717 (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/20/16/650289cd3f43d5a2fadfd98c68bd1e1e7f2550a1a5326768cddfbcedb2c5/pip-25.2.tar.gz#sha256=578283f006390f85bb6282dffb876454593d637f5d1be494b5202ce4877e71f2 (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/44/3c/d717024885424591d5376220b5e836c2d5293ce2011523c9de23ff7bf068/pip-25.3-py3-none-any.whl#sha256=9655943313a94722b7774661c21049070f6bbb0a1516bf02f7c8d5d9201514cd (from https://pypi.org/simple/pip/) (requires-python:>=3.9)
  Link requires a different Python (3.6.13 not in: '>=3.9'): https://files.pythonhosted.org/packages/fe/6e/74a3f0179a4a73a53d66ce57fdb4de0080a8baa1de0063de206d6167acc2/pip-25.3.tar.gz#sha256=8d0538dbbd7babbd207f261ed969c65de439f6bc9e5dbd3b3b9a77f25d95f343 (from https://pypi.org/simple/pip/) (requires-python:>=3.9)

2025-12-21 18:59:33,458 - thread-130546514527936.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Retrieving focal code context via external CRA
2025-12-21 19:07:25,325 - thread-130546514527936.app.lang_graph.nodes.focal_code_retrieval_node - INFO - Focal code context retrieved: 3 items
2025-12-21 19:07:25,327 - thread-130546514527936.app.lang_graph.nodes.test_case_retrieval_node - INFO - Retrieving test case context via external CRA
2025-12-21 19:10:17,041 - thread-130546514527936.app.lang_graph.nodes.test_case_retrieval_node - INFO - Test case context retrieved: 3 items
2025-12-21 19:10:17,045 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nInheritDocstrings metaclass doesn\'t work for properties\n\nIssue description: \nInside the InheritDocstrings metaclass it uses `inspect.isfunction` which returns `False` for properties.\n\nIssue comments:\n\n\nPatch Information:\n```diff\ndiff --git a/astropy/utils/misc.py b/astropy/utils/misc.py\nindex de3fb01d18..4d502fafed 100644\n--- a/astropy/utils/misc.py\n+++ b/astropy/utils/misc.py\n@@ -496,8 +496,8 @@ def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):\n \n class InheritDocstrings(type):\n     """\n-    This metaclass makes methods of a class automatically have their\n-    docstrings filled in from the methods they override in the base\n+    This metaclass makes methods and properties of a class automatically have their\n+    docstrings filled in from the members they override in the base\n     class.\n \n     If the class uses multiple inheritance, the docstring will be\n@@ -528,13 +528,24 @@ class InheritDocstrings(type):\n                 not key.startswith(\'_\'))\n \n         for key, val in dct.items():\n-            if (inspect.isfunction(val) and\n+            if ((inspect.isfunction(val) or isinstance(val, property)) and\n                 is_public_member(key) and\n-                val.__doc__ is None):\n+                getattr(val, \'__doc__\', None) is None):\n                 for base in cls.__mro__[1:]:\n-                    super_method = getattr(base, key, None)\n-                    if super_method is not None:\n-                        val.__doc__ = super_method.__doc__\n+                    super_member = getattr(base, key, None)\n+                    if super_member is not None and getattr(super_member, \'__doc__\', None) is not None:\n+                        inherited_doc = super_member.__doc__\n+                        if inspect.isfunction(val):\n+                            val.__doc__ = inherited_doc\n+                        else:\n+                            try:\n+                                val.__doc__ = inherited_doc\n+                            except Exception:\n+                                try:\n+                                    new_prop = type(val)(val.fget, val.fset, val.fdel, inherited_doc)\n+                                except Exception:\n+                                    new_prop = property(val.fget, val.fset, val.fdel, inherited_doc)\n+                                setattr(cls, key, new_prop)\n                         break\n \n         super().__init__(name, bases, dct)\n\n```\n\nFocal Code Context (relevant code that may need fixing):\n{\'relative_path\': \'astropy/modeling/core.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. This module defines base classes for all models.  The base class of all\\n5. models is `~astropy.modeling.Model`. `~astropy.modeling.FittableModel` is\\n6. the base class for all fittable models. Fittable models can be linear or\\n7. nonlinear in a regression analysis sense.\\n8. \\n9. All models provide a `__call__` method which performs the transformation in\\n10. a purely mathematical way, i.e. the models are unitless.  Model instances can\\n11. represent either a single model, or a "model set" representing multiple copies\\n12. of the same type of model, but with potentially different values of the\\n13. parameters in each model making up the set.\\n14. """\\n15. \\n16. \\n17. import abc\\n18. import copy\\n19. import copyreg\\n20. import inspect\\n21. import functools\\n22. import operator\\n23. import sys\\n24. import types\\n25. import warnings\\n26. \\n27. from collections import defaultdict, OrderedDict\\n28. from contextlib import suppress\\n29. from inspect import signature\\n30. from itertools import chain, islice\\n31. \\n32. import numpy as np\\n33. \\n34. from ..utils import indent, isinstancemethod, metadata\\n35. from ..table import Table\\n36. from ..units import Quantity, UnitsError, dimensionless_unscaled\\n37. from ..units.utils import quantity_asanyarray\\n38. from ..utils import (sharedmethod, find_current_module,\\n39.                      InheritDocstrings, OrderedDescriptorContainer,\\n40.                      check_broadcast, IncompatibleShapeError, isiterable)\\n41. from ..utils.codegen import make_function_with_signature\\n42. from ..utils.exceptions import AstropyDeprecationWarning\\n43. from .utils import (combine_labels, make_binary_operator_eval,\\n44.                     ExpressionTree, AliasDict, get_inputs_and_params,\\n45.                     _BoundingBox, _combine_equivalency_dict)\\n46. from ..nddata.utils import add_array, extract_array\\n47. \\n48. from .parameters import Parameter, InputParameterError, param_repr_oneline\\n49. \\n50. \\n51. __all__ = [\\\'Model\\\', \\\'FittableModel\\\', \\\'Fittable1DModel\\\', \\\'Fittable2DModel\\\',\\n52.            \\\'custom_model\\\', \\\'ModelDefinitionError\\\']\\n53. \\n54. \\n55. class ModelDefinitionError(TypeError):\\n56.     """Used for incorrect models definitions"""\\n57. \\n58. \\n59. def _model_oper(oper, **kwargs):\\n60.     """\\n61.     Returns a function that evaluates a given Python arithmetic operator\\n62.     between two models.  The operator should be given as a string, like ``\\\'+\\\'``\\n63.     or ``\\\'**\\\'``.\\n64. \\n65.     Any additional keyword arguments passed in are passed to\\n66.     `_CompoundModelMeta._from_operator`.\\n67.     """\\n68. \\n69.     # Note: Originally this used functools.partial, but that won\\\'t work when\\n70.     # used in the class definition of _CompoundModelMeta since\\n71.     # _CompoundModelMeta has not been defined yet.\\n72. \\n73.     # Perform an arithmetic operation on two models.\\n74.     return lambda left, right: _CompoundModelMeta._from_operator(oper,\\n75.             left, right, **kwargs)\\n76. \\n77. \\n78. class _ModelMeta(OrderedDescriptorContainer, InheritDocstrings, abc.ABCMeta):\\n79.     """\\n80.     Metaclass for Model.\\n81. \\n82.     Currently just handles auto-generating the param_names list based on\\n83.     Parameter descriptors declared at the class-level of Model subclasses.\\n84.     """\\n85. \\n86.     _is_dynamic = False\\n87.     """\\n88.     This flag signifies whether this class was created in the "normal" way,\\n89.     with a class statement in the body of a module, as opposed to a call to\\n90.     `type` or some other metaclass constructor, such that the resulting class\\n91.     does not belong to a specific module.  This is important for pickling of\\n92.     dynamic classes.\\n93. \\n94.     This flag is always forced to False for new classes, so code that creates\\n95.     dynamic classes should manually set it to True on those classes when\\n96.     creating them.\\n97.     """\\n98. \\n99.     # Default empty dict for _parameters_, which will be empty on model\\n100.     # classes that don\\\'t have any Parameters\\n101.     _parameters_ = OrderedDict()\\n102. \\n103.     def __new__(mcls, name, bases, members):\\n104.         # See the docstring for _is_dynamic above\\n105.         if \\\'_is_dynamic\\\' not in members:\\n106.             members[\\\'_is_dynamic\\\'] = mcls._is_dynamic\\n107. \\n108.         return super().__new__(mcls, name, bases, members)\\n109. \\n110.     def __init__(cls, name, bases, members):\\n111.         # Make sure OrderedDescriptorContainer gets to run before doing\\n112.         # anything else\\n113.         super().__init__(name, bases, members)\\n114. \\n115.         if cls._parameters_:\\n116.             if hasattr(cls, \\\'_param_names\\\'):\\n117.                 # Slight kludge to support compound models, where\\n118.                 # cls.param_names is a property; could be improved with a\\n119.                 # little refactoring but fine for now\\n120.                 cls._param_names = tuple(cls._parameters_)\\n121.             else:\\n122.                 cls.param_names = tuple(cls._parameters_)\\n123. \\n124.         cls._create_inverse_property(members)\\n125.         cls._create_bounding_box_property(members)\\n126.         cls._handle_special_methods(members)\\n127. \\n128.     def __repr__(cls):\\n129.         """\\n130.         Custom repr for Model subclasses.\\n131.         """\\n132. \\n133.         return cls._format_cls_repr()\\n134. \\n135.     def _repr_pretty_(cls, p, cycle):\\n136.         """\\n137.         Repr for IPython\\\'s pretty printer.\\n138. \\n139.         By default IPython "pretty prints" classes, so we need to implement\\n140.         this so that IPython displays the custom repr for Models.\\n141.         """\\n142. \\n143.         p.text(repr(cls))\\n144. \\n145.     def __reduce__(cls):\\n146.         if not cls._is_dynamic:\\n147.             # Just return a string specifying where the class can be imported\\n148.             # from\\n149.             return cls.__name__\\n150.         else:\\n151.             members = dict(cls.__dict__)\\n152.             # Delete any ABC-related attributes--these will be restored when\\n153.             # the class is reconstructed:\\n154.             for key in list(members):\\n155.                 if key.startswith(\\\'_abc_\\\'):\\n156.                     del members[key]\\n157. \\n158.             # Delete custom __init__ and __call__ if they exist:\\n159.             for key in (\\\'__init__\\\', \\\'__call__\\\'):\\n160.                 if key in members:\\n161.                     del members[key]\\n162. \\n163.             return (type(cls), (cls.__name__, cls.__bases__, members))\\n164. \\n165.     @property\\n166.     def name(cls):\\n167.         """\\n168.         The name of this model class--equivalent to ``cls.__name__``.\\n169. \\n170.         This attribute is provided for symmetry with the `Model.name` attribute\\n171.         of model instances.\\n172.         """\\n173. \\n174.         return cls.__name__\\n175. \\n176.     @property\\n177.     def n_inputs(cls):\\n178.         return len(cls.inputs)\\n179. \\n180.     @property\\n181.     def n_outputs(cls):\\n182.         return len(cls.outputs)\\n183. \\n184.     @property\\n185.     def _is_concrete(cls):\\n186.         """\\n187.         A class-level property that determines whether the class is a concrete\\n188.         implementation of a Model--i.e. it is not some abstract base class or\\n189.         internal implementation detail (i.e. begins with \\\'_\\\').\\n190.         """\\n191.         return not (cls.__name__.startswith(\\\'_\\\') or inspect.isabstract(cls))\\n192. \\n193.     def rename(cls, name):\\n194.         """\\n195.         Creates a copy of this model class with a new name.\\n196. \\n197.         The new class is technically a subclass of the original class, so that\\n198.         instance and type checks will still work.  For example::\\n199. \\n200.             >>> from astropy.modeling.models import Rotation2D\\n201.             >>> SkyRotation = Rotation2D.rename(\\\'SkyRotation\\\')\\n202.             >>> SkyRotation\\n203.             <class \\\'__main__.SkyRotation\\\'>\\n204.             Name: SkyRotation (Rotation2D)\\n205.             Inputs: (\\\'x\\\', \\\'y\\\')\\n206.             Outputs: (\\\'x\\\', \\\'y\\\')\\n207.             Fittable parameters: (\\\'angle\\\',)\\n208.             >>> issubclass(SkyRotation, Rotation2D)\\n209.             True\\n210.             >>> r = SkyRotation(90)\\n211.             >>> isinstance(r, Rotation2D)\\n212.             True\\n213.         """\\n214. \\n215.         mod = find_current_module(2)\\n216.         if mod:\\n217.             modname = mod.__name__\\n218.         else:\\n219.             modname = \\\'__main__\\\'\\n220. \\n221.         new_cls = type(name, (cls,), {})\\n222.         new_cls.__module__ = modname\\n223. \\n224.         if hasattr(cls, \\\'__qualname__\\\'):\\n225.             if new_cls.__module__ == \\\'__main__\\\':\\n226.                 # __main__ is not added to a class\\\'s qualified name\\n227.                 new_cls.__qualname__ = name\\n228.             else:\\n229.                 new_cls.__qualname__ = \\\'{0}.{1}\\\'.format(modname, name)\\n230. \\n231.         return new_cls\\n232. \\n233.     def _create_inverse_property(cls, members):\\n234.         inverse = members.get(\\\'inverse\\\')\\n235.         if inverse is None or cls.__bases__[0] is object:\\n236.             # The latter clause is the prevent the below code from running on\\n237.             # the Model base class, which implements the default getter and\\n238.             # setter for .inverse\\n239.             return\\n240. \\n241.         if isinstance(inverse, property):\\n242.             # We allow the @property decorator to be omitted entirely from\\n243.             # the class definition, though its use should be encouraged for\\n244.             # clarity\\n245.             inverse = inverse.fget\\n246. \\n247.         # Store the inverse getter internally, then delete the given .inverse\\n248.         # attribute so that cls.inverse resolves to Model.inverse instead\\n249.         cls._inverse = inverse\\n250.         del cls.inverse\\n251. \\n252.     def _create_bounding_box_property(cls, members):\\n253.         """\\n254.         Takes any bounding_box defined on a concrete Model subclass (either\\n255.         as a fixed tuple or a property or method) and wraps it in the generic\\n256.         getter/setter interface for the bounding_box attribute.\\n257.         """\\n258. \\n259.         # TODO: Much of this is verbatim from _create_inverse_property--I feel\\n260.         # like there could be a way to generify properties that work this way,\\n261.         # but for the time being that would probably only confuse things more.\\n262.         bounding_box = members.get(\\\'bounding_box\\\')\\n263.         if bounding_box is None or cls.__bases__[0] is object:\\n264.             return\\n265. \\n266.         if isinstance(bounding_box, property):\\n267.             bounding_box = bounding_box.fget\\n268. \\n269.         if not callable(bounding_box):\\n270.             # See if it\\\'s a hard-coded bounding_box (as a sequence) and\\n271.             # normalize it\\n272.             try:\\n273.                 bounding_box = _BoundingBox.validate(cls, bounding_box)\\n274.             except ValueError as exc:\\n275.                 raise ModelDefinitionError(exc.args[0])\\n276.         else:\\n277.             sig = signature(bounding_box)\\n278.             # May be a method that only takes \\\'self\\\' as an argument (like a\\n279.             # property, but the @property decorator was forgotten)\\n280.             # TODO: Maybe warn in the above case?\\n281.             #\\n282.             # However, if the method takes additional arguments then this is a\\n283.             # parameterized bounding box and should be callable\\n284.             if len(sig.parameters) > 1:\\n285.                 bounding_box = \\\\\\n286.                         cls._create_bounding_box_subclass(bounding_box, sig)\\n287. \\n288.         # See the Model.bounding_box getter definition for how this attribute\\n289.         # is used\\n290.         cls._bounding_box = bounding_box\\n291.         del cls.bounding_box\\n292. \\n293.     def _create_bounding_box_subclass(cls, func, sig):\\n294.         """\\n295.         For Models that take optional arguments for defining their bounding\\n296.         box, we create a subclass of _BoundingBox with a ``__call__`` method\\n297.         that supports those additional arguments.\\n298. \\n299.         Takes the function\\\'s Signature as an argument since that is already\\n300.         computed in _create_bounding_box_property, so no need to duplicate that\\n301.         effort.\\n302.         """\\n303. \\n304.         # TODO: Might be convenient if calling the bounding box also\\n305.         # automatically sets the _user_bounding_box.  So that\\n306.         #\\n307.         #    >>> model.bounding_box(arg=1)\\n308.         #\\n309.         # in addition to returning the computed bbox, also sets it, so that\\n310.         # it\\\'s a shortcut for\\n311.         #\\n312.         #    >>> model.bounding_box = model.bounding_box(arg=1)\\n313.         #\\n314.         # Not sure if that would be non-obvious / confusing though...\\n315. \\n316.         def __call__(self, **kwargs):\\n317.             return func(self._model, **kwargs)\\n318. \\n319.         kwargs = []\\n320.         for idx, param in enumerate(sig.parameters.values()):\\n321.             if idx == 0:\\n322.                 # Presumed to be a \\\'self\\\' argument\\n323.                 continue\\n324. \\n325.             if param.default is param.empty:\\n326.                 raise ModelDefinitionError(\\n327.                     \\\'The bounding_box method for {0} is not correctly \\\'\\n328.                     \\\'defined: If defined as a method all arguments to that \\\'\\n329.                     \\\'method (besides self) must be keyword arguments with \\\'\\n330.                     \\\'default values that can be used to compute a default \\\'\\n331.                     \\\'bounding box.\\\'.format(cls.name))\\n332. \\n333.             kwargs.append((param.name, param.default))\\n334. \\n335.         __call__ = make_function_with_signature(__call__, (\\\'self\\\',), kwargs)\\n336. \\n337.         return type(str(\\\'_{0}BoundingBox\\\'.format(cls.name)), (_BoundingBox,),\\n338.                     {\\\'__call__\\\': __call__})\\n339. \\n340.     def _handle_special_methods(cls, members):\\n341. \\n342.         # Handle init creation from inputs\\n343.         def update_wrapper(wrapper, cls):\\n344.             # Set up the new __call__\\\'s metadata attributes as though it were\\n345.             # manually defined in the class definition\\n346.             # A bit like functools.update_wrapper but uses the class instead of\\n347.             # the wrapped function\\n348.             wrapper.__module__ = cls.__module__\\n349.             wrapper.__doc__ = getattr(cls, wrapper.__name__).__doc__\\n350.             if hasattr(cls, \\\'__qualname__\\\'):\\n351.                 wrapper.__qualname__ = \\\'{0}.{1}\\\'.format(\\n352.                         cls.__qualname__, wrapper.__name__)\\n353. \\n354.         if (\\\'__call__\\\' not in members and \\\'inputs\\\' in members and\\n355.                 isinstance(members[\\\'inputs\\\'], tuple)):\\n356. \\n357.             # Don\\\'t create a custom __call__ for classes that already have one\\n358.             # explicitly defined (this includes the Model base class, and any\\n359.             # other classes that manually override __call__\\n360. \\n361.             def __call__(self, *inputs, **kwargs):\\n362.                 """Evaluate this model on the supplied inputs."""\\n363.                 return super(cls, self).__call__(*inputs, **kwargs)\\n364. \\n365.             # When called, models can take two optional keyword arguments:\\n366.             #\\n367.             # * model_set_axis, which indicates (for multi-dimensional input)\\n368.             #   which axis is used to indicate different models\\n369.             #\\n370.             # * equivalencies, a dictionary of equivalencies to be applied to\\n371.             #   the input values, where each key should correspond to one of\\n372.             #   the inputs.\\n373.             #\\n374.             # The following code creates the __call__ function with these\\n375.             # two keyword arguments.\\n376.             inputs = members[\\\'inputs\\\']\\n377.             args = (\\\'self\\\',) + inputs\\n378.             new_call = make_function_with_signature(\\n379.                     __call__, args, [(\\\'model_set_axis\\\', None),\\n380.                                      (\\\'with_bounding_box\\\', False),\\n381.                                      (\\\'fill_value\\\', np.nan),\\n382.                                      (\\\'equivalencies\\\', None)])\\n383. \\n384.             # The following makes it look like __call__ was defined in the class\\n385.             update_wrapper(new_call, cls)\\n386. \\n387.             cls.__call__ = new_call\\n388. \\n389.         if (\\\'__init__\\\' not in members and not inspect.isabstract(cls) and\\n390.                 cls._parameters_):\\n391. \\n392.             # If *all* the parameters have default values we can make them\\n393.             # keyword arguments; otherwise they must all be positional arguments\\n394.             if all(p.default is not None for p in cls._parameters_.values()):\\n395.                 args = (\\\'self\\\',)\\n396.                 kwargs = []\\n397.                 for param_name in cls.param_names:\\n398.                     default = cls._parameters_[param_name].default\\n399.                     unit = cls._parameters_[param_name].unit\\n400.                     # If the unit was specified in the parameter but the default\\n401.                     # is not a Quantity, attach the unit to the default.\\n402.                     if unit is not None:\\n403.                         default = Quantity(default, unit, copy=False)\\n404.                     kwargs.append((param_name, default))\\n405.             else:\\n406.                 args = (\\\'self\\\',) + cls.param_names\\n407.                 kwargs = {}\\n408. \\n409.             def __init__(self, *params, **kwargs):\\n410.                 return super(cls, self).__init__(*params, **kwargs)\\n411. \\n412.             new_init = make_function_with_signature(\\n413.                     __init__, args, kwargs, varkwargs=\\\'kwargs\\\')\\n414.             update_wrapper(new_init, cls)\\n415.             cls.__init__ = new_init\\n416. \\n417.     # *** Arithmetic operators for creating compound models ***\\n418.     __add__ = _model_oper(\\\'+\\\')\\n419.     __sub__ = _model_oper(\\\'-\\\')\\n420.     __mul__ = _model_oper(\\\'*\\\')\\n421.     __truediv__ = _model_oper(\\\'/\\\')\\n422.     __pow__ = _model_oper(\\\'**\\\')\\n423.     __or__ = _model_oper(\\\'|\\\')\\n424.     __and__ = _model_oper(\\\'&\\\')\\n425. \\n426.     # *** Other utilities ***\\n427. \\n428.     def _format_cls_repr(cls, keywords=[]):\\n429.         """\\n430.         Internal implementation of ``__repr__``.\\n431. \\n432.         This is separated out for ease of use by subclasses that wish to\\n433.         override the default ``__repr__`` while keeping the same basic\\n434.         formatting.\\n435.         """\\n436. \\n437.         # For the sake of familiarity start the output with the standard class\\n438.         # __repr__\\n439.         parts = [super().__repr__()]\\n440. \\n441.         if not cls._is_concrete:\\n442.             return parts[0]\\n443. \\n444.         def format_inheritance(cls):\\n445.             bases = []\\n446.             for base in cls.mro()[1:]:\\n447.                 if not issubclass(base, Model):\\n448.                     continue\\n449.                 elif (inspect.isabstract(base) or\\n450.                         base.__name__.startswith(\\\'_\\\')):\\n451.                     break\\n452.                 bases.append(base.name)\\n453.             if bases:\\n454.                 return \\\'{0} ({1})\\\'.format(cls.name, \\\' -> \\\'.join(bases))\\n455.             else:\\n456.                 return cls.name\\n457. \\n458.         try:\\n459.             default_keywords = [\\n460.                 (\\\'Name\\\', format_inheritance(cls)),\\n461.                 (\\\'Inputs\\\', cls.inputs),\\n462.                 (\\\'Outputs\\\', cls.outputs),\\n463.             ]\\n464. \\n465.             if cls.param_names:\\n466.                 default_keywords.append((\\\'Fittable parameters\\\',\\n467.                                          cls.param_names))\\n468. \\n469.             for keyword, value in default_keywords + keywords:\\n470.                 if value is not None:\\n471.                     parts.append(\\\'{0}: {1}\\\'.format(keyword, value))\\n472. \\n473.             return \\\'\\\\n\\\'.join(parts)\\n474.         except Exception:\\n475.             # If any of the above formatting fails fall back on the basic repr\\n476.             # (this is particularly useful in debugging)\\n477.             return parts[0]\\n478. \\n479. \\n480. class Model(metaclass=_ModelMeta):\\n481.     """\\n482.     Base class for all models.\\n483. \\n484.     This is an abstract class and should not be instantiated directly.\\n485. \\n486.     This class sets the constraints and other properties for all individual\\n487.     parameters and performs parameter validation.\\n488. \\n489.     The following initialization arguments apply to the majority of Model\\n490.     subclasses by default (exceptions include specialized utility models\\n491.     like `~astropy.modeling.mappings.Mapping`).  Parametric models take all\\n492.     their parameters as arguments, followed by any of the following optional\\n493.     keyword arguments:\\n494. \\n495.     Parameters\\n496.     ----------\\n497.     name : str, optional\\n498.         A human-friendly name associated with this model instance\\n499.         (particularly useful for identifying the individual components of a\\n500.         compound model).\', \'start_line_number\': 1, \'end_line_number\': 500}\n\n{\'relative_path\': \'astropy/modeling/models.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. """\\n4. Creates a common namespace for all pre-defined models.\\n5. """\\n6. \\n7. \\n8. from .core import custom_model  # pylint: disable=W0611\\n9. from .mappings import *\\n10. from .projections import *\\n11. from .rotations import *\\n12. from .polynomial import *\\n13. from .functional_models import *\\n14. from .powerlaws import *\\n15. from .tabular import *\\n16. from .blackbody import BlackBody1D\\n17. \\n18. \\n19. """\\n20. Attach a docstring explaining constraints to all models which support them.\\n21. \\n22. Note: add new models to this list\\n23. """\\n24. \\n25. CONSTRAINTS_DOC = """\\n26.     Other Parameters\\n27.     ----------------\\n28.     fixed : a dict\\n29.         A dictionary ``{parameter_name: boolean}`` of parameters to not be\\n30.         varied during fitting. True means the parameter is held fixed.\\n31.         Alternatively the `~astropy.modeling.Parameter.fixed`\\n32.         property of a parameter may be used.\\n33.     tied : dict\\n34.         A dictionary ``{parameter_name: callable}`` of parameters which are\\n35.         linked to some other parameter. The dictionary values are callables\\n36.         providing the linking relationship.  Alternatively the\\n37.         `~astropy.modeling.Parameter.tied` property of a parameter\\n38.         may be used.\\n39.     bounds : dict\\n40.         A dictionary ``{parameter_name: boolean}`` of lower and upper bounds of\\n41.         parameters. Keys  are parameter names. Values  are a list of length 2\\n42.         giving the desired range for the parameter.  Alternatively the\\n43.         `~astropy.modeling.Parameter.min` and\\n44.         `~astropy.modeling.Parameter.max` properties of a parameter\\n45.         may be used.\\n46.     eqcons : list\\n47.         A list of functions of length ``n`` such that ``eqcons[j](x0,*args) ==\\n48.         0.0`` in a successfully optimized problem.\\n49.     ineqcons : list\\n50.         A list of functions of length ``n`` such that ``ieqcons[j](x0,*args) >=\\n51.         0.0`` is a successfully optimized problem.\\n52. """\\n53. \\n54. \\n55. MODELS_WITH_CONSTRAINTS = [\\n56.     AiryDisk2D, Moffat1D, Moffat2D, Box1D, Box2D,\\n57.     Const1D, Const2D, Ellipse2D, Disk2D,\\n58.     Gaussian1D, Gaussian2D,\\n59.     Linear1D, Lorentz1D, MexicanHat1D, MexicanHat2D,\\n60.     PowerLaw1D, Sersic1D, Sersic2D, Sine1D, Trapezoid1D, TrapezoidDisk2D,\\n61.     Chebyshev1D, Chebyshev2D, Hermite1D, Hermite2D, Legendre2D, Legendre1D,\\n62.     Polynomial1D, Polynomial2D, Voigt1D\\n63. ]\\n64. \\n65. \\n66. for item in MODELS_WITH_CONSTRAINTS:\\n67.     if isinstance(item.__doc__, str):\\n68.         item.__doc__ += CONSTRAINTS_DOC\', \'start_line_number\': 1, \'end_line_number\': 68}\n\n{\'relative_path\': \'astropy/utils/misc.py\', \'content\': \'1. # -*- coding: utf-8 -*-\\n2. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n3. """\\n4. A "grab bag" of relatively small general-purpose utilities that don\\\'t have\\n5. a clear module/package to live in.\\n6. """\\n7. \\n8. \\n9. \\n10. import abc\\n11. import contextlib\\n12. import difflib\\n13. import inspect\\n14. import json\\n15. import os\\n16. import signal\\n17. import sys\\n18. import traceback\\n19. import unicodedata\\n20. import locale\\n21. import threading\\n22. import re\\n23. import urllib.request\\n24. \\n25. from itertools import zip_longest\\n26. from contextlib import contextmanager\\n27. from collections import defaultdict, OrderedDict\\n28. \\n29. \\n30. \\n31. __all__ = [\\\'isiterable\\\', \\\'silence\\\', \\\'format_exception\\\', \\\'NumpyRNGContext\\\',\\n32.            \\\'find_api_page\\\', \\\'is_path_hidden\\\', \\\'walk_skip_hidden\\\',\\n33.            \\\'JsonCustomEncoder\\\', \\\'indent\\\', \\\'InheritDocstrings\\\',\\n34.            \\\'OrderedDescriptor\\\', \\\'OrderedDescriptorContainer\\\', \\\'set_locale\\\',\\n35.            \\\'ShapedLikeNDArray\\\', \\\'check_broadcast\\\', \\\'IncompatibleShapeError\\\',\\n36.            \\\'dtype_bytes_or_chars\\\']\\n37. \\n38. \\n39. def isiterable(obj):\\n40.     """Returns `True` if the given object is iterable."""\\n41. \\n42.     try:\\n43.         iter(obj)\\n44.         return True\\n45.     except TypeError:\\n46.         return False\\n47. \\n48. \\n49. def indent(s, shift=1, width=4):\\n50.     """Indent a block of text.  The indentation is applied to each line."""\\n51. \\n52.     indented = \\\'\\\\n\\\'.join(\\\' \\\' * (width * shift) + l if l else \\\'\\\'\\n53.                          for l in s.splitlines())\\n54.     if s[-1] == \\\'\\\\n\\\':\\n55.         indented += \\\'\\\\n\\\'\\n56. \\n57.     return indented\\n58. \\n59. \\n60. class _DummyFile:\\n61.     """A noop writeable object."""\\n62. \\n63.     def write(self, s):\\n64.         pass\\n65. \\n66. \\n67. @contextlib.contextmanager\\n68. def silence():\\n69.     """A context manager that silences sys.stdout and sys.stderr."""\\n70. \\n71.     old_stdout = sys.stdout\\n72.     old_stderr = sys.stderr\\n73.     sys.stdout = _DummyFile()\\n74.     sys.stderr = _DummyFile()\\n75.     yield\\n76.     sys.stdout = old_stdout\\n77.     sys.stderr = old_stderr\\n78. \\n79. \\n80. def format_exception(msg, *args, **kwargs):\\n81.     """\\n82.     Given an exception message string, uses new-style formatting arguments\\n83.     ``{filename}``, ``{lineno}``, ``{func}`` and/or ``{text}`` to fill in\\n84.     information about the exception that occurred.  For example:\\n85. \\n86.         try:\\n87.             1/0\\n88.         except:\\n89.             raise ZeroDivisionError(\\n90.                 format_except(\\\'A divide by zero occurred in {filename} at \\\'\\n91.                               \\\'line {lineno} of function {func}.\\\'))\\n92. \\n93.     Any additional positional or keyword arguments passed to this function are\\n94.     also used to format the message.\\n95. \\n96.     .. note::\\n97.         This uses `sys.exc_info` to gather up the information needed to fill\\n98.         in the formatting arguments. Since `sys.exc_info` is not carried\\n99.         outside a handled exception, it\\\'s not wise to use this\\n100.         outside of an ``except`` clause - if it is, this will substitute\\n101.         \\\'<unkown>\\\' for the 4 formatting arguments.\\n102.     """\\n103. \\n104.     tb = traceback.extract_tb(sys.exc_info()[2], limit=1)\\n105.     if len(tb) > 0:\\n106.         filename, lineno, func, text = tb[0]\\n107.     else:\\n108.         filename = lineno = func = text = \\\'<unknown>\\\'\\n109. \\n110.     return msg.format(*args, filename=filename, lineno=lineno, func=func,\\n111.                       text=text, **kwargs)\\n112. \\n113. \\n114. class NumpyRNGContext:\\n115.     """\\n116.     A context manager (for use with the ``with`` statement) that will seed the\\n117.     numpy random number generator (RNG) to a specific value, and then restore\\n118.     the RNG state back to whatever it was before.\\n119. \\n120.     This is primarily intended for use in the astropy testing suit, but it\\n121.     may be useful in ensuring reproducibility of Monte Carlo simulations in a\\n122.     science context.\\n123. \\n124.     Parameters\\n125.     ----------\\n126.     seed : int\\n127.         The value to use to seed the numpy RNG\\n128. \\n129.     Examples\\n130.     --------\\n131.     A typical use case might be::\\n132. \\n133.         with NumpyRNGContext(<some seed value you pick>):\\n134.             from numpy import random\\n135. \\n136.             randarr = random.randn(100)\\n137.             ... run your test using `randarr` ...\\n138. \\n139.         #Any code using numpy.random at this indent level will act just as it\\n140.         #would have if it had been before the with statement - e.g. whatever\\n141.         #the default seed is.\\n142. \\n143. \\n144.     """\\n145. \\n146.     def __init__(self, seed):\\n147.         self.seed = seed\\n148. \\n149.     def __enter__(self):\\n150.         from numpy import random\\n151. \\n152.         self.startstate = random.get_state()\\n153.         random.seed(self.seed)\\n154. \\n155.     def __exit__(self, exc_type, exc_value, traceback):\\n156.         from numpy import random\\n157. \\n158.         random.set_state(self.startstate)\\n159. \\n160. \\n161. def find_api_page(obj, version=None, openinbrowser=True, timeout=None):\\n162.     """\\n163.     Determines the URL of the API page for the specified object, and\\n164.     optionally open that page in a web browser.\\n165. \\n166.     .. note::\\n167.         You must be connected to the internet for this to function even if\\n168.         ``openinbrowser`` is `False`, unless you provide a local version of\\n169.         the documentation to ``version`` (e.g., ``file:///path/to/docs``).\\n170. \\n171.     Parameters\\n172.     ----------\\n173.     obj\\n174.         The object to open the docs for or its fully-qualified name\\n175.         (as a str).\\n176.     version : str\\n177.         The doc version - either a version number like \\\'0.1\\\', \\\'dev\\\' for\\n178.         the development/latest docs, or a URL to point to a specific\\n179.         location that should be the *base* of the documentation. Defaults to\\n180.         latest if you are on aren\\\'t on a release, otherwise, the version you\\n181.         are on.\\n182.     openinbrowser : bool\\n183.         If `True`, the `webbrowser` package will be used to open the doc\\n184.         page in a new web browser window.\\n185.     timeout : number, optional\\n186.         The number of seconds to wait before timing-out the query to\\n187.         the astropy documentation.  If not given, the default python\\n188.         stdlib timeout will be used.\\n189. \\n190.     Returns\\n191.     -------\\n192.     url : str\\n193.         The loaded URL\\n194. \\n195.     Raises\\n196.     ------\\n197.     ValueError\\n198.         If the documentation can\\\'t be found\\n199. \\n200.     """\\n201.     import webbrowser\\n202. \\n203.     from zlib import decompress\\n204. \\n205.     if (not isinstance(obj, str) and\\n206.             hasattr(obj, \\\'__module__\\\') and\\n207.             hasattr(obj, \\\'__name__\\\')):\\n208.         obj = obj.__module__ + \\\'.\\\' + obj.__name__\\n209.     elif inspect.ismodule(obj):\\n210.         obj = obj.__name__\\n211. \\n212.     if version is None:\\n213.         from .. import version\\n214. \\n215.         if version.release:\\n216.             version = \\\'v\\\' + version.version\\n217.         else:\\n218.             version = \\\'dev\\\'\\n219. \\n220.     if \\\'://\\\' in version:\\n221.         if version.endswith(\\\'index.html\\\'):\\n222.             baseurl = version[:-10]\\n223.         elif version.endswith(\\\'/\\\'):\\n224.             baseurl = version\\n225.         else:\\n226.             baseurl = version + \\\'/\\\'\\n227.     elif version == \\\'dev\\\' or version == \\\'latest\\\':\\n228.         baseurl = \\\'http://devdocs.astropy.org/\\\'\\n229.     else:\\n230.         baseurl = \\\'http://docs.astropy.org/en/{vers}/\\\'.format(vers=version)\\n231. \\n232.     if timeout is None:\\n233.         uf = urllib.request.urlopen(baseurl + \\\'objects.inv\\\')\\n234.     else:\\n235.         uf = urllib.request.urlopen(baseurl + \\\'objects.inv\\\', timeout=timeout)\\n236. \\n237.     try:\\n238.         oiread = uf.read()\\n239. \\n240.         # need to first read/remove the first four lines, which have info before\\n241.         # the compressed section with the actual object inventory\\n242.         idx = -1\\n243.         headerlines = []\\n244.         for _ in range(4):\\n245.             oldidx = idx\\n246.             idx = oiread.index(b\\\'\\\\n\\\', oldidx + 1)\\n247.             headerlines.append(oiread[(oldidx+1):idx].decode(\\\'utf-8\\\'))\\n248. \\n249.         # intersphinx version line, project name, and project version\\n250.         ivers, proj, vers, compr = headerlines\\n251.         if \\\'The remainder of this file is compressed using zlib\\\' not in compr:\\n252.             raise ValueError(\\\'The file downloaded from {0} does not seem to be\\\'\\n253.                              \\\'the usual Sphinx objects.inv format.  Maybe it \\\'\\n254.                              \\\'has changed?\\\'.format(baseurl + \\\'objects.inv\\\'))\\n255. \\n256.         compressed = oiread[(idx+1):]\\n257.     finally:\\n258.         uf.close()\\n259. \\n260.     decompressed = decompress(compressed).decode(\\\'utf-8\\\')\\n261. \\n262.     resurl = None\\n263. \\n264.     for l in decompressed.strip().splitlines():\\n265.         ls = l.split()\\n266.         name = ls[0]\\n267.         loc = ls[3]\\n268.         if loc.endswith(\\\'$\\\'):\\n269.             loc = loc[:-1] + name\\n270. \\n271.         if name == obj:\\n272.             resurl = baseurl + loc\\n273.             break\\n274. \\n275.     if resurl is None:\\n276.         raise ValueError(\\\'Could not find the docs for the object {obj}\\\'.format(obj=obj))\\n277.     elif openinbrowser:\\n278.         webbrowser.open(resurl)\\n279. \\n280.     return resurl\\n281. \\n282. \\n283. def signal_number_to_name(signum):\\n284.     """\\n285.     Given an OS signal number, returns a signal name.  If the signal\\n286.     number is unknown, returns ``\\\'UNKNOWN\\\'``.\\n287.     """\\n288.     # Since these numbers and names are platform specific, we use the\\n289.     # builtin signal module and build a reverse mapping.\\n290. \\n291.     signal_to_name_map = dict((k, v) for v, k in signal.__dict__.items()\\n292.                               if v.startswith(\\\'SIG\\\'))\\n293. \\n294.     return signal_to_name_map.get(signum, \\\'UNKNOWN\\\')\\n295. \\n296. \\n297. if sys.platform == \\\'win32\\\':\\n298.     import ctypes\\n299. \\n300.     def _has_hidden_attribute(filepath):\\n301.         """\\n302.         Returns True if the given filepath has the hidden attribute on\\n303.         MS-Windows.  Based on a post here:\\n304.         http://stackoverflow.com/questions/284115/cross-platform-hidden-file-detection\\n305.         """\\n306.         if isinstance(filepath, bytes):\\n307.             filepath = filepath.decode(sys.getfilesystemencoding())\\n308.         try:\\n309.             attrs = ctypes.windll.kernel32.GetFileAttributesW(filepath)\\n310.             result = bool(attrs & 2) and attrs != -1\\n311.         except AttributeError:\\n312.             result = False\\n313.         return result\\n314. else:\\n315.     def _has_hidden_attribute(filepath):\\n316.         return False\\n317. \\n318. \\n319. def is_path_hidden(filepath):\\n320.     """\\n321.     Determines if a given file or directory is hidden.\\n322. \\n323.     Parameters\\n324.     ----------\\n325.     filepath : str\\n326.         The path to a file or directory\\n327. \\n328.     Returns\\n329.     -------\\n330.     hidden : bool\\n331.         Returns `True` if the file is hidden\\n332.     """\\n333.     name = os.path.basename(os.path.abspath(filepath))\\n334.     if isinstance(name, bytes):\\n335.         is_dotted = name.startswith(b\\\'.\\\')\\n336.     else:\\n337.         is_dotted = name.startswith(\\\'.\\\')\\n338.     return is_dotted or _has_hidden_attribute(filepath)\\n339. \\n340. \\n341. def walk_skip_hidden(top, onerror=None, followlinks=False):\\n342.     """\\n343.     A wrapper for `os.walk` that skips hidden files and directories.\\n344. \\n345.     This function does not have the parameter ``topdown`` from\\n346.     `os.walk`: the directories must always be recursed top-down when\\n347.     using this function.\\n348. \\n349.     See also\\n350.     --------\\n351.     os.walk : For a description of the parameters\\n352.     """\\n353.     for root, dirs, files in os.walk(\\n354.             top, topdown=True, onerror=onerror,\\n355.             followlinks=followlinks):\\n356.         # These lists must be updated in-place so os.walk will skip\\n357.         # hidden directories\\n358.         dirs[:] = [d for d in dirs if not is_path_hidden(d)]\\n359.         files[:] = [f for f in files if not is_path_hidden(f)]\\n360.         yield root, dirs, files\\n361. \\n362. \\n363. class JsonCustomEncoder(json.JSONEncoder):\\n364.     """Support for data types that JSON default encoder\\n365.     does not do.\\n366. \\n367.     This includes:\\n368. \\n369.         * Numpy array or number\\n370.         * Complex number\\n371.         * Set\\n372.         * Bytes\\n373.         * astropy.UnitBase\\n374.         * astropy.Quantity\\n375. \\n376.     Examples\\n377.     --------\\n378.     >>> import json\\n379.     >>> import numpy as np\\n380.     >>> from astropy.utils.misc import JsonCustomEncoder\\n381.     >>> json.dumps(np.arange(3), cls=JsonCustomEncoder)\\n382.     \\\'[0, 1, 2]\\\'\\n383. \\n384.     """\\n385. \\n386.     def default(self, obj):\\n387.         from .. import units as u\\n388.         import numpy as np\\n389.         if isinstance(obj, u.Quantity):\\n390.             return dict(value=obj.value, unit=obj.unit.to_string())\\n391.         if isinstance(obj, (np.number, np.ndarray)):\\n392.             return obj.tolist()\\n393.         elif isinstance(obj, complex):\\n394.             return [obj.real, obj.imag]\\n395.         elif isinstance(obj, set):\\n396.             return list(obj)\\n397.         elif isinstance(obj, bytes):  # pragma: py3\\n398.             return obj.decode()\\n399.         elif isinstance(obj, (u.UnitBase, u.FunctionUnitBase)):\\n400.             if obj == u.dimensionless_unscaled:\\n401.                 obj = \\\'dimensionless_unit\\\'\\n402.             else:\\n403.                 return obj.to_string()\\n404. \\n405.         return json.JSONEncoder.default(self, obj)\\n406. \\n407. \\n408. def strip_accents(s):\\n409.     """\\n410.     Remove accents from a Unicode string.\\n411. \\n412.     This helps with matching "ångström" to "angstrom", for example.\\n413.     """\\n414.     return \\\'\\\'.join(\\n415.         c for c in unicodedata.normalize(\\\'NFD\\\', s)\\n416.         if unicodedata.category(c) != \\\'Mn\\\')\\n417. \\n418. \\n419. def did_you_mean(s, candidates, n=3, cutoff=0.8, fix=None):\\n420.     """\\n421.     When a string isn\\\'t found in a set of candidates, we can be nice\\n422.     to provide a list of alternatives in the exception.  This\\n423.     convenience function helps to format that part of the exception.\\n424. \\n425.     Parameters\\n426.     ----------\\n427.     s : str\\n428. \\n429.     candidates : sequence of str or dict of str keys\\n430. \\n431.     n : int\\n432.         The maximum number of results to include.  See\\n433.         `difflib.get_close_matches`.\\n434. \\n435.     cutoff : float\\n436.         In the range [0, 1]. Possibilities that don\\\'t score at least\\n437.         that similar to word are ignored.  See\\n438.         `difflib.get_close_matches`.\\n439. \\n440.     fix : callable\\n441.         A callable to modify the results after matching.  It should\\n442.         take a single string and return a sequence of strings\\n443.         containing the fixed matches.\\n444. \\n445.     Returns\\n446.     -------\\n447.     message : str\\n448.         Returns the string "Did you mean X, Y, or Z?", or the empty\\n449.         string if no alternatives were found.\\n450.     """\\n451.     if isinstance(s, str):\\n452.         s = strip_accents(s)\\n453.     s_lower = s.lower()\\n454. \\n455.     # Create a mapping from the lower case name to all capitalization\\n456.     # variants of that name.\\n457.     candidates_lower = {}\\n458.     for candidate in candidates:\\n459.         candidate_lower = candidate.lower()\\n460.         candidates_lower.setdefault(candidate_lower, [])\\n461.         candidates_lower[candidate_lower].append(candidate)\\n462. \\n463.     # The heuristic here is to first try "singularizing" the word.  If\\n464.     # that doesn\\\'t match anything use difflib to find close matches in\\n465.     # original, lower and upper case.\\n466.     if s_lower.endswith(\\\'s\\\') and s_lower[:-1] in candidates_lower:\\n467.         matches = [s_lower[:-1]]\\n468.     else:\\n469.         matches = difflib.get_close_matches(\\n470.             s_lower, candidates_lower, n=n, cutoff=cutoff)\\n471. \\n472.     if len(matches):\\n473.         capitalized_matches = set()\\n474.         for match in matches:\\n475.             capitalized_matches.update(candidates_lower[match])\\n476.         matches = capitalized_matches\\n477. \\n478.         if fix is not None:\\n479.             mapped_matches = []\\n480.             for match in matches:\\n481.                 mapped_matches.extend(fix(match))\\n482.             matches = mapped_matches\\n483. \\n484.         matches = list(set(matches))\\n485.         matches = sorted(matches)\\n486. \\n487.         if len(matches) == 1:\\n488.             matches = matches[0]\\n489.         else:\\n490.             matches = (\\\', \\\'.join(matches[:-1]) + \\\' or \\\' +\\n491.                        matches[-1])\\n492.         return \\\'Did you mean {0}?\\\'.format(matches)\\n493. \\n494.     return \\\'\\\'\\n495. \\n496. \\n497. class InheritDocstrings(type):\\n498.     """\\n499.     This metaclass makes methods of a class automatically have their\\n500.     docstrings filled in from the methods they override in the base\\n501.     class.\\n502. \\n503.     If the class uses multiple inheritance, the docstring will be\\n504.     chosen from the first class in the bases list, in the same way as\\n505.     methods are normally resolved in Python.  If this results in\\n506.     selecting the wrong docstring, the docstring will need to be\\n507.     explicitly included on the method.\\n508. \\n509.     For example::\\n510. \\n511.         >>> from astropy.utils.misc import InheritDocstrings\\n512.         >>> class A(metaclass=InheritDocstrings):\\n513.         ...     def wiggle(self):\\n514.         ...         "Wiggle the thingamajig"\\n515.         ...         pass\\n516.         >>> class B(A):\\n517.         ...     def wiggle(self):\\n518.         ...         pass\\n519.         >>> B.wiggle.__doc__\\n520.         u\\\'Wiggle the thingamajig\\\'\\n521.     """\\n522. \\n523.     def __init__(cls, name, bases, dct):\\n524.         def is_public_member(key):\\n525.             return (\\n526.                 (key.startswith(\\\'__\\\') and key.endswith(\\\'__\\\')\\n527.                  and len(key) > 4) or\\n528.                 not key.startswith(\\\'_\\\'))\\n529. \\n530.         for key, val in dct.items():\\n531.             if (inspect.isfunction(val) and\\n532.                 is_public_member(key) and\\n533.                 val.__doc__ is None):\\n534.                 for base in cls.__mro__[1:]:\\n535.                     super_method = getattr(base, key, None)\\n536.                     if super_method is not None:\\n537.                         val.__doc__ = super_method.__doc__\\n538.                         break\\n539. \\n540.         super().__init__(name, bases, dct)\\n541. \\n542. \\n543. class OrderedDescriptor(metaclass=abc.ABCMeta):\\n544.     """\\n545.     Base class for descriptors whose order in the class body should be\\n546.     preserved.  Intended for use in concert with the\\n547.     `OrderedDescriptorContainer` metaclass.\\n548. \\n549.     Subclasses of `OrderedDescriptor` must define a value for a class attribute\\n550.     called ``_class_attribute_``.  This is the name of a class attribute on the\\n551.     *container* class for these descriptors, which will be set to an\\n552.     `~collections.OrderedDict` at class creation time.  This\\n553.     `~collections.OrderedDict` will contain a mapping of all class attributes\\n554.     that were assigned instances of the `OrderedDescriptor` subclass, to the\\n555.     instances themselves.  See the documentation for\\n556.     `OrderedDescriptorContainer` for a concrete example.\\n557. \\n558.     Optionally, subclasses of `OrderedDescriptor` may define a value for a\\n559.     class attribute called ``_name_attribute_``.  This should be the name of\\n560.     an attribute on instances of the subclass.  When specified, during\\n561.     creation of a class containing these descriptors, the name attribute on\\n562.     each instance will be set to the name of the class attribute it was\\n563.     assigned to on the class.\\n564. \\n565.     .. note::\\n566. \\n567.         Although this class is intended for use with *descriptors* (i.e.\\n568.         classes that define any of the ``__get__``, ``__set__``, or\\n569.         ``__delete__`` magic methods), this base class is not itself a\\n570.         descriptor, and technically this could be used for classes that are\\n571.         not descriptors too.  However, use with descriptors is the original\\n572.         intended purpose.\\n573.     """\\n574. \\n575.     # This id increments for each OrderedDescriptor instance created, so they\\n576.     # are always ordered in the order they were created.  Class bodies are\\n577.     # guaranteed to be executed from top to bottom.  Not sure if this is\\n578.     # thread-safe though.\\n579.     _nextid = 1\\n580. \\n581.     @property\\n582.     @abc.abstractmethod\\n583.     def _class_attribute_(self):\\n584.         """\\n585.         Subclasses should define this attribute to the name of an attribute on\\n586.         classes containing this subclass.  That attribute will contain the mapping\\n587.         of all instances of that `OrderedDescriptor` subclass defined in the class\\n588.         body.  If the same descriptor needs to be used with different classes,\\n589.         each with different names of this attribute, multiple subclasses will be\\n590.         needed.\\n591.         """\\n592. \\n593.     _name_attribute_ = None\\n594.     """\\n595.     Subclasses may optionally define this attribute to specify the name of an\\n596.     attribute on instances of the class that should be filled with the\\n597.     instance\\\'s attribute name at class creation time.\\n598.     """\\n599. \\n600.     def __init__(self, *args, **kwargs):\\n601.         # The _nextid attribute is shared across all subclasses so that\\n602.         # different subclasses of OrderedDescriptors can be sorted correctly\\n603.         # between themselves\\n604.         self.__order = OrderedDescriptor._nextid\\n605.         OrderedDescriptor._nextid += 1\\n606.         super().__init__()\\n607. \\n608.     def __lt__(self, other):\\n609.         """\\n610.         Defined for convenient sorting of `OrderedDescriptor` instances, which\\n611.         are defined to sort in their creation order.\\n612.         """\\n613. \\n614.         if (isinstance(self, OrderedDescriptor) and\\n615.                 isinstance(other, OrderedDescriptor)):\\n616.             try:\\n617.                 return self.__order < other.__order\\n618.             except AttributeError:\\n619.                 raise RuntimeError(\\n620.                     \\\'Could not determine ordering for {0} and {1}; at least \\\'\\n621.                     \\\'one of them is not calling super().__init__ in its \\\'\\n622.                     \\\'__init__.\\\'.format(self, other))\\n623.         else:\\n624.             return NotImplemented\\n625. \\n626. \\n627. class OrderedDescriptorContainer(type):\\n628.     """\\n629.     Classes should use this metaclass if they wish to use `OrderedDescriptor`\\n630.     attributes, which are class attributes that "remember" the order in which\\n631.     they were defined in the class body.\\n632. \\n633.     Every subclass of `OrderedDescriptor` has an attribute called\\n634.     ``_class_attribute_``.  For example, if we have\\n635. \\n636.     .. code:: python\\n637. \\n638.         class ExampleDecorator(OrderedDescriptor):\\n639.             _class_attribute_ = \\\'_examples_\\\'\\n640. \\n641.     Then when a class with the `OrderedDescriptorContainer` metaclass is\\n642.     created, it will automatically be assigned a class attribute ``_examples_``\\n643.     referencing an `~collections.OrderedDict` containing all instances of\\n644.     ``ExampleDecorator`` defined in the class body, mapped to by the names of\\n645.     the attributes they were assigned to.\\n646. \\n647.     When subclassing a class with this metaclass, the descriptor dict (i.e.\\n648.     ``_examples_`` in the above example) will *not* contain descriptors\\n649.     inherited from the base class.  That is, this only works by default with\\n650.     decorators explicitly defined in the class body.  However, the subclass\\n651.     *may* define an attribute ``_inherit_decorators_`` which lists\\n652.     `OrderedDescriptor` classes that *should* be added from base classes.\\n653.     See the examples section below for an example of this.\\n654. \\n655.     Examples\\n656.     --------\\n657. \\n658.     >>> from astropy.utils import OrderedDescriptor, OrderedDescriptorContainer\\n659.     >>> class TypedAttribute(OrderedDescriptor):\\n660.     ...     \\\\"\\\\"\\\\"\\n661.     ...     Attributes that may only be assigned objects of a specific type,\\n662.     ...     or subclasses thereof.  For some reason we care about their order.\\n663.     ...     \\\\"\\\\"\\\\"\\n664.     ...\\n665.     ...     _class_attribute_ = \\\'typed_attributes\\\'\\n666.     ...     _name_attribute_ = \\\'name\\\'\\n667.     ...     # A default name so that instances not attached to a class can\\n668.     ...     # still be repr\\\'d; useful for debugging\\n669.     ...     name = \\\'<unbound>\\\'\\n670.     ...\\n671.     ...     def __init__(self, type):\\n672.     ...         # Make sure not to forget to call the super __init__\\n673.     ...         super().__init__()\\n674.     ...         self.type = type\\n675.     ...\\n676.     ...     def __get__(self, obj, objtype=None):\\n677.     ...         if obj is None:\\n678.     ...             return self\\n679.     ...         if self.name in obj.__dict__:\\n680.     ...             return obj.__dict__[self.name]\\n681.     ...         else:\\n682.     ...             raise AttributeError(self.name)\\n683.     ...\\n684.     ...     def __set__(self, obj, value):\\n685.     ...         if not isinstance(value, self.type):\\n686.     ...             raise ValueError(\\\'{0}.{1} must be of type {2!r}\\\'.format(\\n687.     ...                 obj.__class__.__name__, self.name, self.type))\\n688.     ...         obj.__dict__[self.name] = value\\n689.     ...\\n690.     ...     def __delete__(self, obj):\\n691.     ...         if self.name in obj.__dict__:\\n692.     ...             del obj.__dict__[self.name]\\n693.     ...         else:\\n694.     ...             raise AttributeError(self.name)\\n695.     ...\\n696.     ...     def __repr__(self):\\n697.     ...         if isinstance(self.type, tuple) and len(self.type) > 1:\\n698.     ...             typestr = \\\'({0})\\\'.format(\\n699.     ...                 \\\', \\\'.join(t.__name__ for t in self.type))\\n700.     ...         else:\\n701.     ...             typestr = self.type.__name__\\n702.     ...         return \\\'<{0}(name={1}, type={2})>\\\'.format(\\n703.     ...                 self.__class__.__name__, self.name, typestr)\\n704.     ...\\n705. \\n706.     Now let\\\'s create an example class that uses this ``TypedAttribute``::\\n707. \\n708.         >>> class Point2D(metaclass=OrderedDescriptorContainer):\\n709.         ...     x = TypedAttribute((float, int))\\n710.         ...     y = TypedAttribute((float, int))\\n711.         ...\\n712.         ...     def __init__(self, x, y):\\n713.         ...         self.x, self.y = x, y\\n714.         ...\\n715.         >>> p1 = Point2D(1.0, 2.0)\\n716.         >>> p1.x\\n717.         1.0\\n718.         >>> p1.y\\n719.         2.0\\n720.         >>> p2 = Point2D(\\\'a\\\', \\\'b\\\')  # doctest: +IGNORE_EXCEPTION_DETAIL\\n721.         Traceback (most recent call last):\\n722.             ...\\n723.         ValueError: Point2D.x must be of type (float, int>)\\n724. \\n725.     We see that ``TypedAttribute`` works more or less as advertised, but\\n726.     there\\\'s nothing special about that.  Let\\\'s see what\\n727.     `OrderedDescriptorContainer` did for us::\\n728. \\n729.         >>> Point2D.typed_attributes\\n730.         OrderedDict([(\\\'x\\\', <TypedAttribute(name=x, type=(float, int))>),\\n731.         (\\\'y\\\', <TypedAttribute(name=y, type=(float, int))>)])\\n732. \\n733.     If we create a subclass, it does *not* by default add inherited descriptors\\n734.     to ``typed_attributes``::\\n735. \\n736.         >>> class Point3D(Point2D):\\n737.         ...     z = TypedAttribute((float, int))\\n738.         ...\\n739.         >>> Point3D.typed_attributes\\n740.         OrderedDict([(\\\'z\\\', <TypedAttribute(name=z, type=(float, int))>)])\\n741. \\n742.     However, if we specify ``_inherit_descriptors_`` from ``Point2D`` then\\n743.     it will do so::\\n744. \\n745.         >>> class Point3D(Point2D):\\n746.         ...     _inherit_descriptors_ = (TypedAttribute,)\\n747.         ...     z = TypedAttribute((float, int))\\n748.         ...\\n749.         >>> Point3D.typed_attributes\\n750.         OrderedDict([(\\\'x\\\', <TypedAttribute(name=x, type=(float, int))>),\\n751.         (\\\'y\\\', <TypedAttribute(name=y, type=(float, int))>),\\n752.         (\\\'z\\\', <TypedAttribute(name=z, type=(float, int))>)])\\n753. \\n754.     .. note::\\n755. \\n756.         Hopefully it is clear from these examples that this construction\\n757.         also allows a class of type `OrderedDescriptorContainer` to use\\n758.         multiple different `OrderedDescriptor` classes simultaneously.\\n759.     """\\n760. \\n761.     _inherit_descriptors_ = ()\\n762. \\n763.     def __init__(cls, cls_name, bases, members):\\n764.         descriptors = defaultdict(list)\\n765.         seen = set()\\n766.         inherit_descriptors = ()\\n767.         descr_bases = {}\\n768. \\n769.         for mro_cls in cls.__mro__:\\n770.             for name, obj in mro_cls.__dict__.items():\\n771.                 if name in seen:\\n772.                     # Checks if we\\\'ve already seen an attribute of the given\\n773.                     # name (if so it will override anything of the same name in\\n774.                     # any base class)\\n775.                     continue\\n776. \\n777.                 seen.add(name)\\n778. \\n779.                 if (not isinstance(obj, OrderedDescriptor) or\\n780.                         (inherit_descriptors and\\n781.                             not isinstance(obj, inherit_descriptors))):\\n782.                     # The second condition applies when checking any\\n783.                     # subclasses, to see if we can inherit any descriptors of\\n784.                     # the given type from subclasses (by default inheritance is\\n785.                     # disabled unless the class has _inherit_descriptors_\\n786.                     # defined)\\n787.                     continue\\n788. \\n789.                 if obj._name_attribute_ is not None:\\n790.                     setattr(obj, obj._name_attribute_, name)\\n791. \\n792.                 # Don\\\'t just use the descriptor\\\'s class directly; instead go\\n793.                 # through its MRO and find the class on which _class_attribute_\\n794.                 # is defined directly.  This way subclasses of some\\n795.                 # OrderedDescriptor *may* override _class_attribute_ and have\\n796.                 # its own _class_attribute_, but by default all subclasses of\\n797.                 # some OrderedDescriptor are still grouped together\\n798.                 # TODO: It might be worth clarifying this in the docs\\n799.                 if obj.__class__ not in descr_bases:\\n800.                     for obj_cls_base in obj.__class__.__mro__:\\n801.                         if \\\'_class_attribute_\\\' in obj_cls_base.__dict__:\\n802.                             descr_bases[obj.__class__] = obj_cls_base\\n803.                             descriptors[obj_cls_base].append((obj, name))\\n804.                             break\\n805.                 else:\\n806.                     # Make sure to put obj first for sorting purposes\\n807.                     obj_cls_base = descr_bases[obj.__class__]\\n808.                     descriptors[obj_cls_base].append((obj, name))\\n809. \\n810.             if not getattr(mro_cls, \\\'_inherit_descriptors_\\\', False):\\n811.                 # If _inherit_descriptors_ is undefined then we don\\\'t inherit\\n812.                 # any OrderedDescriptors from any of the base classes, and\\n813.                 # there\\\'s no reason to continue through the MRO\\n814.                 break\\n815.             else:\\n816.                 inherit_descriptors = mro_cls._inherit_descriptors_\\n817. \\n818.         for descriptor_cls, instances in descriptors.items():\\n819.             instances.sort()\\n820.             instances = OrderedDict((key, value) for value, key in instances)\\n821.             setattr(cls, descriptor_cls._class_attribute_, instances)\\n822. \\n823.         super().__init__(cls_name, bases, members)\\n824. \\n825. \\n826. LOCALE_LOCK = threading.Lock()\\n827. \\n828. \\n829. @contextmanager\\n830. def set_locale(name):\\n831.     """\\n832.     Context manager to temporarily set the locale to ``name``.\\n833. \\n834.     An example is setting locale to "C" so that the C strtod()\\n835.     function will use "." as the decimal point to enable consistent\\n836.     numerical string parsing.\\n837. \\n838.     Note that one cannot nest multiple set_locale() context manager\\n839.     statements as this causes a threading lock.\\n840. \\n841.     This code taken from https://stackoverflow.com/questions/18593661/how-do-i-strftime-a-date-object-in-a-different-locale.\\n842. \\n843.     Parameters\\n844.     ==========\\n845.     name : str\\n846.         Locale name, e.g. "C" or "fr_FR".\\n847.     """\\n848.     name = str(name)\\n849. \\n850.     with LOCALE_LOCK:\\n851.         saved = locale.setlocale(locale.LC_ALL)\\n852.         if saved == name:\\n853.             # Don\\\'t do anything if locale is already the requested locale\\n854.             yield\\n855.         else:\\n856.             try:\\n857.                 locale.setlocale(locale.LC_ALL, name)\\n858.                 yield\\n859.             finally:\\n860.                 locale.setlocale(locale.LC_ALL, saved)\\n861. \\n862. \\n863. class ShapedLikeNDArray(metaclass=abc.ABCMeta):\\n864.     """Mixin class to provide shape-changing methods.\\n865. \\n866.     The class proper is assumed to have some underlying data, which are arrays\\n867.     or array-like structures. It must define a ``shape`` property, which gives\\n868.     the shape of those data, as well as an ``_apply`` method that creates a new\\n869.     instance in which a `~numpy.ndarray` method has been applied to those.\\n870. \\n871.     Furthermore, for consistency with `~numpy.ndarray`, it is recommended to\\n872.     define a setter for the ``shape`` property, which, like the\\n873.     `~numpy.ndarray.shape` property allows in-place reshaping the internal data\\n874.     (and, unlike the ``reshape`` method raises an exception if this is not\\n875.     possible).\\n876. \\n877.     This class also defines default implementations for ``ndim`` and ``size``\\n878.     properties, calculating those from the ``shape``.  These can be overridden\\n879.     by subclasses if there are faster ways to obtain those numbers.\\n880. \\n881.     """\\n882. \\n883.     # Note to developers: if new methods are added here, be sure to check that\\n884.     # they work properly with the classes that use this, such as Time and\\n885.     # BaseRepresentation, i.e., look at their ``_apply`` methods and add\\n886.     # relevant tests.  This is particularly important for methods that imply\\n887.     # copies rather than views of data (see the special-case treatment of\\n888.     # \\\'flatten\\\' in Time).\\n889. \\n890.     @property\\n891.     @abc.abstractmethod\\n892.     def shape(self):\\n893.         """The shape of the instance and underlying arrays."""\\n894. \\n895.     @abc.abstractmethod\\n896.     def _apply(method, *args, **kwargs):\\n897.         """Create a new instance, with ``method`` applied to underlying data.\\n898. \\n899.         The method is any of the shape-changing methods for `~numpy.ndarray`\\n900.         (``reshape``, ``swapaxes``, etc.), as well as those picking particular\\n901.         elements (``__getitem__``, ``take``, etc.). It will be applied to the\\n902.         underlying arrays (e.g., ``jd1`` and ``jd2`` in `~astropy.time.Time`),\\n903.         with the results used to create a new instance.\\n904. \\n905.         Parameters\\n906.         ----------\\n907.         method : str\\n908.             Method to be applied to the instance\\\'s internal data arrays.\\n909.         args : tuple\\n910.             Any positional arguments for ``method``.\\n911.         kwargs : dict\\n912.             Any keyword arguments for ``method``.\\n913. \\n914.         """\\n915. \\n916.     @property\\n917.     def ndim(self):\\n918.         """The number of dimensions of the instance and underlying arrays."""\\n919.         return len(self.shape)\\n920. \\n921.     @property\\n922.     def size(self):\\n923.         """The size of the object, as calculated from its shape."""\\n924.         size = 1\\n925.         for sh in self.shape:\\n926.             size *= sh\\n927.         return size\\n928. \\n929.     @property\\n930.     def isscalar(self):\\n931.         return self.shape == ()\\n932. \\n933.     def __len__(self):\\n934.         if self.isscalar:\\n935.             raise TypeError("Scalar {0!r} object has no len()"\\n936.                             .format(self.__class__.__name__))\\n937.         return self.shape[0]\\n938. \\n939.     def __bool__(self):\\n940.         """Any instance should evaluate to True, except when it is empty."""\\n941.         return self.size > 0\\n942. \\n943.     def __getitem__(self, item):\\n944.         try:\\n945.             return self._apply(\\\'__getitem__\\\', item)\\n946.         except IndexError:\\n947.             if self.isscalar:\\n948.                 raise TypeError(\\\'scalar {0!r} object is not subscriptable.\\\'\\n949.                                 .format(self.__class__.__name__))\\n950.             else:\\n951.                 raise\\n952. \\n953.     def __iter__(self):\\n954.         if self.isscalar:\\n955.             raise TypeError(\\\'scalar {0!r} object is not iterable.\\\'\\n956.                             .format(self.__class__.__name__))\\n957. \\n958.         # We cannot just write a generator here, since then the above error\\n959.         # would only be raised once we try to use the iterator, rather than\\n960.         # upon its definition using iter(self).\\n961.         def self_iter():\\n962.             for idx in range(len(self)):\\n963.                 yield self[idx]\\n964. \\n965.         return self_iter()\\n966. \\n967.     def copy(self, *args, **kwargs):\\n968.         """Return an instance containing copies of the internal data.\\n969. \\n970.         Parameters are as for :meth:`~numpy.ndarray.copy`.\\n971.         """\\n972.         return self._apply(\\\'copy\\\', *args, **kwargs)\\n973. \\n974.     def reshape(self, *args, **kwargs):\\n975.         """Returns an instance containing the same data with a new shape.\\n976. \\n977.         Parameters are as for :meth:`~numpy.ndarray.reshape`.  Note that it is\\n978.         not always possible to change the shape of an array without copying the\\n979.         data (see :func:`~numpy.reshape` documentation). If you want an error\\n980.         to be raise if the data is copied, you should assign the new shape to\\n981.         the shape attribute (note: this may not be implemented for all classes\\n982.         using ``ShapedLikeNDArray``).\\n983.         """\\n984.         return self._apply(\\\'reshape\\\', *args, **kwargs)\\n985. \\n986.     def ravel(self, *args, **kwargs):\\n987.         """Return an instance with the array collapsed into one dimension.\\n988. \\n989.         Parameters are as for :meth:`~numpy.ndarray.ravel`. Note that it is\\n990.         not always possible to unravel an array without copying the data.\\n991.         If you want an error to be raise if the data is copied, you should\\n992.         should assign shape ``(-1,)`` to the shape attribute.\\n993.         """\\n994.         return self._apply(\\\'ravel\\\', *args, **kwargs)\\n995. \\n996.     def flatten(self, *args, **kwargs):\\n997.         """Return a copy with the array collapsed into one dimension.\\n998. \\n999.         Parameters are as for :meth:`~numpy.ndarray.flatten`.\\n1000.         """\\n1001.         return self._apply(\\\'flatten\\\', *args, **kwargs)\\n1002. \\n1003.     def transpose(self, *args, **kwargs):\\n1004.         """Return an instance with the data transposed.\\n1005. \\n1006.         Parameters are as for :meth:`~numpy.ndarray.transpose`.  All internal\\n1007.         data are views of the data of the original.\\n1008.         """\\n1009.         return self._apply(\\\'transpose\\\', *args, **kwargs)\\n1010. \\n1011.     @property\\n1012.     def T(self):\\n1013.         """Return an instance with the data transposed.\\n1014. \\n1015.         Parameters are as for :attr:`~numpy.ndarray.T`.  All internal\\n1016.         data are views of the data of the original.\\n1017.         """\\n1018.         if self.ndim < 2:\\n1019.             return self\\n1020.         else:\\n1021.             return self.transpose()\\n1022. \\n1023.     def swapaxes(self, *args, **kwargs):\\n1024.         """Return an instance with the given axes interchanged.\\n1025. \\n1026.         Parameters are as for :meth:`~numpy.ndarray.swapaxes`:\\n1027.         ``axis1, axis2``.  All internal data are views of the data of the\\n1028.         original.\\n1029.         """\\n1030.         return self._apply(\\\'swapaxes\\\', *args, **kwargs)\\n1031. \\n1032.     def diagonal(self, *args, **kwargs):\\n1033.         """Return an instance with the specified diagonals.\\n1034. \\n1035.         Parameters are as for :meth:`~numpy.ndarray.diagonal`.  All internal\\n1036.         data are views of the data of the original.\\n1037.         """\\n1038.         return self._apply(\\\'diagonal\\\', *args, **kwargs)\\n1039. \\n1040.     def squeeze(self, *args, **kwargs):\\n1041.         """Return an instance with single-dimensional shape entries removed\\n1042. \\n1043.         Parameters are as for :meth:`~numpy.ndarray.squeeze`.  All internal\\n1044.         data are views of the data of the original.\\n1045.         """\\n1046.         return self._apply(\\\'squeeze\\\', *args, **kwargs)\\n1047. \\n1048.     def take(self, indices, axis=None, mode=\\\'raise\\\'):\\n1049.         """Return a new instance formed from the elements at the given indices.\\n1050. \\n1051.         Parameters are as for :meth:`~numpy.ndarray.take`, except that,\\n1052.         obviously, no output array can be given.\\n1053.         """\\n1054.         return self._apply(\\\'take\\\', indices, axis=axis, mode=mode)\\n1055. \\n1056. \\n1057. class IncompatibleShapeError(ValueError):\\n1058.     def __init__(self, shape_a, shape_a_idx, shape_b, shape_b_idx):\\n1059.         super().__init__(shape_a, shape_a_idx, shape_b, shape_b_idx)\\n1060. \\n1061. \\n1062. def check_broadcast(*shapes):\\n1063.     """\\n1064.     Determines whether two or more Numpy arrays can be broadcast with each\\n1065.     other based on their shape tuple alone.\\n1066. \\n1067.     Parameters\\n1068.     ----------\\n1069.     *shapes : tuple\\n1070.         All shapes to include in the comparison.  If only one shape is given it\\n1071.         is passed through unmodified.  If no shapes are given returns an empty\\n1072.         `tuple`.\\n1073. \\n1074.     Returns\\n1075.     -------\\n1076.     broadcast : `tuple`\\n1077.         If all shapes are mutually broadcastable, returns a tuple of the full\\n1078.         broadcast shape.\\n1079.     """\\n1080. \\n1081.     if len(shapes) == 0:\\n1082.         return ()\\n1083.     elif len(shapes) == 1:\\n1084.         return shapes[0]\\n1085. \\n1086.     reversed_shapes = (reversed(shape) for shape in shapes)\\n1087. \\n1088.     full_shape = []\\n1089. \\n1090.     for dims in zip_longest(*reversed_shapes, fillvalue=1):\\n1091.         max_dim = 1\\n1092.         max_dim_idx = None\\n1093.         for idx, dim in enumerate(dims):\\n1094.             if dim == 1:\\n1095.                 continue\\n1096. \\n1097.             if max_dim == 1:\\n1098.                 # The first dimension of size greater than 1\\n1099.                 max_dim = dim\\n1100.                 max_dim_idx = idx\\n1101.             elif dim != max_dim:\\n1102.                 raise IncompatibleShapeError(\\n1103.                     shapes[max_dim_idx], max_dim_idx, shapes[idx], idx)\\n1104. \\n1105.         full_shape.append(max_dim)\\n1106. \\n1107.     return tuple(full_shape[::-1])\\n1108. \\n1109. \\n1110. def dtype_bytes_or_chars(dtype):\\n1111.     """\\n1112.     Parse the number out of a dtype.str value like \\\'<U5\\\' or \\\'<f8\\\'.\\n1113. \\n1114.     See #5819 for discussion on the need for this function for getting\\n1115.     the number of characters corresponding to a string dtype.\\n1116. \\n1117.     Parameters\\n1118.     ----------\\n1119.     dtype : numpy dtype object\\n1120.         Input dtype\\n1121. \\n1122.     Returns\\n1123.     -------\\n1124.     bytes_or_chars : int or None\\n1125.         Bits (for numeric types) or characters (for string types)\\n1126.     """\\n1127.     match = re.search(r\\\'(\\\\d+)$\\\', dtype.str)\\n1128.     out = int(match.group(1)) if match else None\\n1129.     return out\', \'start_line_number\': 1, \'end_line_number\': 1129}\n\nTest Case Context (similar existing tests for reference):\n{\'relative_path\': \'astropy/modeling/tests/test_parameters.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. """\\n3. Tests models.parameters\\n4. """\\n5. \\n6. \\n7. import itertools\\n8. \\n9. import pytest\\n10. import numpy as np\\n11. from numpy.testing import utils\\n12. \\n13. from . import irafutil\\n14. from .. import models, fitting\\n15. from ..core import Model, FittableModel\\n16. from ..parameters import Parameter, InputParameterError\\n17. from ...utils.data import get_pkg_data_filename\\n18. \\n19. \\n20. def setter1(val):\\n21.     return val\\n22. \\n23. \\n24. def setter2(val, model):\\n25.     model.do_something(val)\\n26.     return val * model.p\\n27. \\n28. \\n29. class SetterModel(FittableModel):\\n30. \\n31.     inputs = (\\\'x\\\', \\\'y\\\')\\n32.     outputs = (\\\'z\\\',)\\n33. \\n34.     xc = Parameter(default=1, setter=setter1)\\n35.     yc = Parameter(default=1, setter=setter2)\\n36. \\n37.     def __init__(self, xc, yc, p):\\n38.         self.p = p  # p is a value intended to be used by the setter\\n39.         super().__init__()\\n40.         self.xc = xc\\n41.         self.yc = yc\\n42. \\n43.     def evaluate(self, x, y, xc, yc):\\n44.         return ((x - xc)**2 + (y - yc)**2)\\n45. \\n46.     def do_something(self, v):\\n47.         pass\\n48. \\n49. \\n50. class TParModel(Model):\\n51.     """\\n52.     A toy model to test parameters machinery\\n53.     """\\n54. \\n55.     coeff = Parameter()\\n56.     e = Parameter()\\n57. \\n58.     def __init__(self, coeff, e, **kwargs):\\n59.         super().__init__(coeff=coeff, e=e, **kwargs)\\n60. \\n61.     @staticmethod\\n62.     def evaluate(coeff, e):\\n63.         pass\\n64. \\n65. \\n66. class MockModel(FittableModel):\\n67.     alpha = Parameter(name=\\\'alpha\\\', default=42)\\n68. \\n69.     @staticmethod\\n70.     def evaluate(*args):\\n71.         pass\\n72. \\n73. \\n74. def test_parameter_properties():\\n75.     """Test if getting / setting of Parameter properties works."""\\n76. \\n77.     m = MockModel()\\n78.     p = m.alpha\\n79. \\n80.     assert p.name == \\\'alpha\\\'\\n81. \\n82.     # Parameter names are immutable\\n83.     with pytest.raises(AttributeError):\\n84.         p.name = \\\'beta\\\'\\n85. \\n86.     assert p.fixed is False\\n87.     p.fixed = True\\n88.     assert p.fixed is True\\n89. \\n90.     assert p.tied is False\\n91.     p.tied = lambda _: 0\\n92. \\n93.     p.tied = False\\n94.     assert p.tied is False\\n95. \\n96.     assert p.min is None\\n97.     p.min = 42\\n98.     assert p.min == 42\\n99.     p.min = None\\n100.     assert p.min is None\\n101. \\n102.     assert p.max is None\\n103.     # TODO: shouldn\\\'t setting a max < min give an error?\\n104.     p.max = 41\\n105.     assert p.max == 41\\n106. \\n107. \\n108. def test_parameter_operators():\\n109.     """Test if the parameter arithmetic operators work."""\\n110. \\n111.     m = MockModel()\\n112.     par = m.alpha\\n113.     num = 42.\\n114.     val = 3\\n115. \\n116.     assert par - val == num - val\\n117.     assert val - par == val - num\\n118.     assert par / val == num / val\\n119.     assert val / par == val / num\\n120.     assert par ** val == num ** val\\n121.     assert val ** par == val ** num\\n122.     assert par < 45\\n123.     assert par > 41\\n124.     assert par <= par\\n125.     assert par >= par\\n126.     assert par == par\\n127.     assert -par == -num\\n128.     assert abs(par) == abs(num)\\n129. \\n130. \\n131. class TestParameters:\\n132. \\n133.     def setup_class(self):\\n134.         """\\n135.         Unit tests for parameters\\n136. \\n137.         Read an iraf database file created by onedspec.identify.  Use the\\n138.         information to create a 1D Chebyshev model and perform the same fit.\\n139. \\n140.         Create also a gausian model.\\n141.         """\\n142.         test_file = get_pkg_data_filename(\\\'data/idcompspec.fits\\\')\\n143.         f = open(test_file)\\n144.         lines = f.read()\\n145.         reclist = lines.split("begin")\\n146.         f.close()\\n147.         record = irafutil.IdentifyRecord(reclist[1])\\n148.         self.icoeff = record.coeff\\n149.         order = int(record.fields[\\\'order\\\'])\\n150.         self.model = models.Chebyshev1D(order - 1)\\n151.         self.gmodel = models.Gaussian1D(2, mean=3, stddev=4)\\n152.         self.linear_fitter = fitting.LinearLSQFitter()\\n153.         self.x = record.x\\n154.         self.y = record.z\\n155.         self.yy = np.array([record.z, record.z])\\n156. \\n157.     def test_set_slice(self):\\n158.         """\\n159.         Tests updating the parameters attribute with a slice.\\n160. \\n161.         This is what fitters internally do.\\n162.         """\\n163. \\n164.         self.model.parameters[:] = np.array([3, 4, 5, 6, 7])\\n165.         assert (self.model.parameters == [3., 4., 5., 6., 7.]).all()\\n166. \\n167.     def test_set_parameters_as_list(self):\\n168.         """Tests updating parameters using a list."""\\n169. \\n170.         self.model.parameters = [30, 40, 50, 60, 70]\\n171.         assert (self.model.parameters == [30., 40., 50., 60, 70]).all()\\n172. \\n173.     def test_set_parameters_as_array(self):\\n174.         """Tests updating parameters using an array."""\\n175. \\n176.         self.model.parameters = np.array([3, 4, 5, 6, 7])\\n177.         assert (self.model.parameters == [3., 4., 5., 6., 7.]).all()\\n178. \\n179.     def test_set_as_tuple(self):\\n180.         """Tests updating parameters using a tuple."""\\n181. \\n182.         self.model.parameters = (1, 2, 3, 4, 5)\\n183.         assert (self.model.parameters == [1, 2, 3, 4, 5]).all()\\n184. \\n185.     def test_set_model_attr_seq(self):\\n186.         """\\n187.         Tests updating the parameters attribute when a model\\\'s\\n188.         parameter (in this case coeff) is updated.\\n189.         """\\n190. \\n191.         self.model.parameters = [0, 0., 0., 0, 0]\\n192.         self.model.c0 = 7\\n193.         assert (self.model.parameters == [7, 0., 0., 0, 0]).all()\\n194. \\n195.     def test_set_model_attr_num(self):\\n196.         """Update the parameter list when a model\\\'s parameter is updated."""\\n197. \\n198.         self.gmodel.amplitude = 7\\n199.         assert (self.gmodel.parameters == [7, 3, 4]).all()\\n200. \\n201.     def test_set_item(self):\\n202.         """Update the parameters using indexing."""\\n203. \\n204.         self.model.parameters = [1, 2, 3, 4, 5]\\n205.         self.model.parameters[0] = 10.\\n206.         assert (self.model.parameters == [10, 2, 3, 4, 5]).all()\\n207.         assert self.model.c0 == 10\\n208. \\n209.     def test_wrong_size1(self):\\n210.         """\\n211.         Tests raising an error when attempting to reset the parameters\\n212.         using a list of a different size.\\n213.         """\\n214. \\n215.         with pytest.raises(InputParameterError):\\n216.             self.model.parameters = [1, 2, 3]\\n217. \\n218.     def test_wrong_size2(self):\\n219.         """\\n220.         Tests raising an exception when attempting to update a model\\\'s\\n221.         parameter (in this case coeff) with a sequence of the wrong size.\\n222.         """\\n223. \\n224.         with pytest.raises(InputParameterError):\\n225.             self.model.c0 = [1, 2, 3]\\n226. \\n227.     def test_wrong_shape(self):\\n228.         """\\n229.         Tests raising an exception when attempting to update a model\\\'s\\n230.         parameter and the new value has the wrong shape.\\n231.         """\\n232. \\n233.         with pytest.raises(InputParameterError):\\n234.             self.gmodel.amplitude = [1, 2]\\n235. \\n236.     def test_par_against_iraf(self):\\n237.         """\\n238.         Test the fitter modifies model.parameters.\\n239. \\n240.         Uses an iraf example.\\n241.         """\\n242. \\n243.         new_model = self.linear_fitter(self.model, self.x, self.y)\\n244.         print(self.y, self.x)\\n245.         utils.assert_allclose(new_model.parameters,\\n246.                               np.array(\\n247.                                   [4826.1066602783685, 952.8943813407858,\\n248.                                    12.641236013982386,\\n249.                                    -1.7910672553339604,\\n250.                                    0.90252884366711317]),\\n251.                               rtol=10 ** (-2))\\n252. \\n253.     def testPolynomial1D(self):\\n254.         d = {\\\'c0\\\': 11, \\\'c1\\\': 12, \\\'c2\\\': 13, \\\'c3\\\': 14}\\n255.         p1 = models.Polynomial1D(3, **d)\\n256.         utils.assert_equal(p1.parameters, [11, 12, 13, 14])\\n257. \\n258.     def test_poly1d_multiple_sets(self):\\n259.         p1 = models.Polynomial1D(3, n_models=3)\\n260.         utils.assert_equal(p1.parameters, [0.0, 0.0, 0.0, 0, 0, 0,\\n261.                                            0, 0, 0, 0, 0, 0])\\n262.         utils.assert_array_equal(p1.c0, [0, 0, 0])\\n263.         p1.c0 = [10, 10, 10]\\n264.         utils.assert_equal(p1.parameters, [10.0, 10.0, 10.0, 0, 0,\\n265.                                            0, 0, 0, 0, 0, 0, 0])\\n266. \\n267.     def test_par_slicing(self):\\n268.         """\\n269.         Test assigning to a parameter slice\\n270.         """\\n271.         p1 = models.Polynomial1D(3, n_models=3)\\n272.         p1.c0[:2] = [10, 10]\\n273.         utils.assert_equal(p1.parameters, [10.0, 10.0, 0.0, 0, 0,\\n274.                                            0, 0, 0, 0, 0, 0, 0])\\n275. \\n276.     def test_poly2d(self):\\n277.         p2 = models.Polynomial2D(degree=3)\\n278.         p2.c0_0 = 5\\n279.         utils.assert_equal(p2.parameters, [5, 0, 0, 0, 0, 0, 0, 0, 0, 0])\\n280. \\n281.     def test_poly2d_multiple_sets(self):\\n282.         kw = {\\\'c0_0\\\': [2, 3], \\\'c1_0\\\': [1, 2], \\\'c2_0\\\': [4, 5],\\n283.               \\\'c0_1\\\': [1, 1], \\\'c0_2\\\': [2, 2], \\\'c1_1\\\': [5, 5]}\\n284.         p2 = models.Polynomial2D(2, **kw)\\n285.         utils.assert_equal(p2.parameters, [2, 3, 1, 2, 4, 5,\\n286.                                            1, 1, 2, 2, 5, 5])\\n287. \\n288.     def test_shift_model_parameters1d(self):\\n289.         sh1 = models.Shift(2)\\n290.         sh1.offset = 3\\n291.         assert sh1.offset == 3\\n292.         assert sh1.offset.value == 3\\n293. \\n294.     def test_scale_model_parametersnd(self):\\n295.         sc1 = models.Scale([2, 2])\\n296.         sc1.factor = [3, 3]\\n297.         assert np.all(sc1.factor == [3, 3])\\n298.         utils.assert_array_equal(sc1.factor.value, [3, 3])\\n299. \\n300.     def test_parameters_wrong_shape(self):\\n301.         sh1 = models.Shift(2)\\n302.         with pytest.raises(InputParameterError):\\n303.             sh1.offset = [3, 3]\\n304. \\n305. \\n306. class TestMultipleParameterSets:\\n307. \\n308.     def setup_class(self):\\n309.         self.x1 = np.arange(1, 10, .1)\\n310.         self.y, self.x = np.mgrid[:10, :7]\\n311.         self.x11 = np.array([self.x1, self.x1]).T\\n312.         self.gmodel = models.Gaussian1D([12, 10], [3.5, 5.2], stddev=[.4, .7],\\n313.                                         n_models=2)\\n314. \\n315.     def test_change_par(self):\\n316.         """\\n317.         Test that a change to one parameter as a set propagates to param_sets.\\n318.         """\\n319.         self.gmodel.amplitude = [1, 10]\\n320.         utils.assert_almost_equal(\\n321.             self.gmodel.param_sets,\\n322.             np.array([[1.,\\n323.                        10],\\n324.                       [3.5,\\n325.                        5.2],\\n326.                       [0.4,\\n327.                        0.7]]))\\n328.         np.all(self.gmodel.parameters == [1.0, 10.0, 3.5, 5.2, 0.4, 0.7])\\n329. \\n330.     def test_change_par2(self):\\n331.         """\\n332.         Test that a change to one single parameter in a set propagates to\\n333.         param_sets.\\n334.         """\\n335.         self.gmodel.amplitude[0] = 11\\n336.         utils.assert_almost_equal(\\n337.             self.gmodel.param_sets,\\n338.             np.array([[11.,\\n339.                        10],\\n340.                       [3.5,\\n341.                        5.2],\\n342.                       [0.4,\\n343.                        0.7]]))\\n344.         np.all(self.gmodel.parameters == [11.0, 10.0, 3.5, 5.2, 0.4, 0.7])\\n345. \\n346.     def test_change_parameters(self):\\n347.         self.gmodel.parameters = [13, 10, 9, 5.2, 0.4, 0.7]\\n348.         utils.assert_almost_equal(self.gmodel.amplitude.value, [13., 10.])\\n349.         utils.assert_almost_equal(self.gmodel.mean.value, [9., 5.2])\\n350. \\n351. \\n352. class TestParameterInitialization:\\n353.     """\\n354.     This suite of tests checks most if not all cases if instantiating a model\\n355.     with parameters of different shapes/sizes and with different numbers of\\n356.     parameter sets.\\n357.     """\\n358. \\n359.     def test_single_model_scalar_parameters(self):\\n360.         t = TParModel(10, 1)\\n361.         assert len(t) == 1\\n362.         assert t.model_set_axis is False\\n363.         assert np.all(t.param_sets == [[10], [1]])\\n364.         assert np.all(t.parameters == [10, 1])\\n365.         assert t.coeff.shape == ()\\n366.         assert t.e.shape == ()\\n367. \\n368.     def test_single_model_scalar_and_array_parameters(self):\\n369.         t = TParModel(10, [1, 2])\\n370.         assert len(t) == 1\\n371.         assert t.model_set_axis is False\\n372.         assert np.issubdtype(t.param_sets.dtype, np.object_)\\n373.         assert len(t.param_sets) == 2\\n374.         assert np.all(t.param_sets[0] == [10])\\n375.         assert np.all(t.param_sets[1] == [[1, 2]])\\n376.         assert np.all(t.parameters == [10, 1, 2])\\n377.         assert t.coeff.shape == ()\\n378.         assert t.e.shape == (2,)\\n379. \\n380.     def test_single_model_1d_array_parameters(self):\\n381.         t = TParModel([10, 20], [1, 2])\\n382.         assert len(t) == 1\\n383.         assert t.model_set_axis is False\\n384.         assert np.all(t.param_sets == [[[10, 20]], [[1, 2]]])\\n385.         assert np.all(t.parameters == [10, 20, 1, 2])\\n386.         assert t.coeff.shape == (2,)\\n387.         assert t.e.shape == (2,)\\n388. \\n389.     def test_single_model_1d_array_different_length_parameters(self):\\n390.         with pytest.raises(InputParameterError):\\n391.             # Not broadcastable\\n392.             t = TParModel([1, 2], [3, 4, 5])\\n393. \\n394.     def test_single_model_2d_array_parameters(self):\\n395.         t = TParModel([[10, 20], [30, 40]], [[1, 2], [3, 4]])\\n396.         assert len(t) == 1\\n397.         assert t.model_set_axis is False\\n398.         assert np.all(t.param_sets == [[[[10, 20], [30, 40]]],\\n399.                                        [[[1, 2], [3, 4]]]])\\n400.         assert np.all(t.parameters == [10, 20, 30, 40, 1, 2, 3, 4])\\n401.         assert t.coeff.shape == (2, 2)\\n402.         assert t.e.shape == (2, 2)\\n403. \\n404.     def test_single_model_2d_non_square_parameters(self):\\n405.         coeff = np.array([[10, 20], [30, 40], [50, 60]])\\n406.         e = np.array([[1, 2], [3, 4], [5, 6]])\\n407. \\n408.         t = TParModel(coeff, e)\\n409.         assert len(t) == 1\\n410.         assert t.model_set_axis is False\\n411.         assert np.all(t.param_sets == [[[[10, 20], [30, 40], [50, 60]]],\\n412.                                        [[[1, 2], [3, 4], [5, 6]]]])\\n413.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60,\\n414.                                        1, 2, 3, 4, 5, 6])\\n415.         assert t.coeff.shape == (3, 2)\\n416.         assert t.e.shape == (3, 2)\\n417. \\n418.         t2 = TParModel(coeff.T, e.T)\\n419.         assert len(t2) == 1\\n420.         assert t2.model_set_axis is False\\n421.         assert np.all(t2.param_sets == [[[[10, 30, 50], [20, 40, 60]]],\\n422.                                         [[[1, 3, 5], [2, 4, 6]]]])\\n423.         assert np.all(t2.parameters == [10, 30, 50, 20, 40, 60,\\n424.                                         1, 3, 5, 2, 4, 6])\\n425.         assert t2.coeff.shape == (2, 3)\\n426.         assert t2.e.shape == (2, 3)\\n427. \\n428.         # Not broadcastable\\n429.         with pytest.raises(InputParameterError):\\n430.             TParModel(coeff, e.T)\\n431. \\n432.         with pytest.raises(InputParameterError):\\n433.             TParModel(coeff.T, e)\\n434. \\n435.     def test_single_model_2d_broadcastable_parameters(self):\\n436.         t = TParModel([[10, 20, 30], [40, 50, 60]], [1, 2, 3])\\n437.         assert len(t) == 1\\n438.         assert t.model_set_axis is False\\n439.         assert len(t.param_sets) == 2\\n440.         assert np.issubdtype(t.param_sets.dtype, np.object_)\\n441.         assert np.all(t.param_sets[0] == [[[10, 20, 30], [40, 50, 60]]])\\n442.         assert np.all(t.param_sets[1] == [[1, 2, 3]])\\n443.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60, 1, 2, 3])\\n444. \\n445.     @pytest.mark.parametrize((\\\'p1\\\', \\\'p2\\\'), [\\n446.         (1, 2), (1, [2, 3]), ([1, 2], 3), ([1, 2, 3], [4, 5]),\\n447.         ([1, 2], [3, 4, 5])])\\n448.     def test_two_model_incorrect_scalar_parameters(self, p1, p2):\\n449.         with pytest.raises(InputParameterError):\\n450.             TParModel(p1, p2, n_models=2)\\n451. \\n452.     @pytest.mark.parametrize(\\\'kwargs\\\', [\\n453.         {\\\'n_models\\\': 2}, {\\\'model_set_axis\\\': 0},\\n454.         {\\\'n_models\\\': 2, \\\'model_set_axis\\\': 0}])\\n455.     def test_two_model_scalar_parameters(self, kwargs):\\n456.         t = TParModel([10, 20], [1, 2], **kwargs)\\n457.         assert len(t) == 2\\n458.         assert t.model_set_axis == 0\\n459.         assert np.all(t.param_sets == [[10, 20], [1, 2]])\\n460.         assert np.all(t.parameters == [10, 20, 1, 2])\\n461.         assert t.coeff.shape == ()\\n462.         assert t.e.shape == ()\\n463. \\n464.     @pytest.mark.parametrize(\\\'kwargs\\\', [\\n465.         {\\\'n_models\\\': 2}, {\\\'model_set_axis\\\': 0},\\n466.         {\\\'n_models\\\': 2, \\\'model_set_axis\\\': 0}])\\n467.     def test_two_model_scalar_and_array_parameters(self, kwargs):\\n468.         t = TParModel([10, 20], [[1, 2], [3, 4]], **kwargs)\\n469.         assert len(t) == 2\\n470.         assert t.model_set_axis == 0\\n471.         assert len(t.param_sets) == 2\\n472.         assert np.issubdtype(t.param_sets.dtype, np.object_)\\n473.         assert np.all(t.param_sets[0] == [[10], [20]])\\n474.         assert np.all(t.param_sets[1] == [[1, 2], [3, 4]])\\n475.         assert np.all(t.parameters == [10, 20, 1, 2, 3, 4])\\n476.         assert t.coeff.shape == ()\\n477.         assert t.e.shape == (2,)\\n478. \\n479.     def test_two_model_1d_array_parameters(self):\\n480.         t = TParModel([[10, 20], [30, 40]], [[1, 2], [3, 4]], n_models=2)\\n481.         assert len(t) == 2\\n482.         assert t.model_set_axis == 0\\n483.         assert np.all(t.param_sets == [[[10, 20], [30, 40]],\\n484.                                        [[1, 2], [3, 4]]])\\n485.         assert np.all(t.parameters == [10, 20, 30, 40, 1, 2, 3, 4])\\n486.         assert t.coeff.shape == (2,)\\n487.         assert t.e.shape == (2,)\\n488. \\n489.         t2 = TParModel([[10, 20, 30], [40, 50, 60]],\\n490.                           [[1, 2, 3], [4, 5, 6]], n_models=2)\\n491.         assert len(t2) == 2\\n492.         assert t2.model_set_axis == 0\\n493.         assert np.all(t2.param_sets == [[[10, 20, 30], [40, 50, 60]],\\n494.                                         [[1, 2, 3], [4, 5, 6]]])\\n495.         assert np.all(t2.parameters == [10, 20, 30, 40, 50, 60,\\n496.                                         1, 2, 3, 4, 5, 6])\\n497.         assert t2.coeff.shape == (3,)\\n498.         assert t2.e.shape == (3,)\\n499. \\n500.     def test_two_model_mixed_dimension_array_parameters(self):\\n501.         with pytest.raises(InputParameterError):\\n502.             # Can\\\'t broadcast different array shapes\\n503.             TParModel([[[1, 2], [3, 4]], [[5, 6], [7, 8]]],\\n504.                          [[9, 10, 11], [12, 13, 14]], n_models=2)\\n505. \\n506.         t = TParModel([[[10, 20], [30, 40]], [[50, 60], [70, 80]]],\\n507.                          [[1, 2], [3, 4]], n_models=2)\\n508.         assert len(t) == 2\\n509.         assert t.model_set_axis == 0\\n510.         assert len(t.param_sets) == 2\\n511.         assert np.issubdtype(t.param_sets.dtype, np.object_)\\n512.         assert np.all(t.param_sets[0] == [[[10, 20], [30, 40]],\\n513.                                           [[50, 60], [70, 80]]])\\n514.         assert np.all(t.param_sets[1] == [[[1, 2]], [[3, 4]]])\\n515.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60, 70, 80,\\n516.                                        1, 2, 3, 4])\\n517.         assert t.coeff.shape == (2, 2)\\n518.         assert t.e.shape == (2,)\\n519. \\n520.     def test_two_model_2d_array_parameters(self):\\n521.         t = TParModel([[[10, 20], [30, 40]], [[50, 60], [70, 80]]],\\n522.                          [[[1, 2], [3, 4]], [[5, 6], [7, 8]]], n_models=2)\\n523.         assert len(t) == 2\\n524.         assert t.model_set_axis == 0\\n525.         assert np.all(t.param_sets == [[[[10, 20], [30, 40]],\\n526.                                         [[50, 60], [70, 80]]],\\n527.                                        [[[1, 2], [3, 4]],\\n528.                                         [[5, 6], [7, 8]]]])\\n529.         assert np.all(t.parameters == [10, 20, 30, 40, 50, 60, 70, 80,\\n530.                                        1, 2, 3, 4, 5, 6, 7, 8])\\n531.         assert t.coeff.shape == (2, 2)\\n532.         assert t.e.shape == (2, 2)\\n533. \\n534.     def test_two_model_nonzero_model_set_axis(self):\\n535.         # An example where the model set axis is the *last* axis of the\\n536.         # parameter arrays\\n537.         coeff = np.array([[[10, 20], [30, 40]], [[50, 60], [70, 80]]])\\n538.         coeff = np.rollaxis(coeff, 0, 3)\\n539.         e = np.array([[1, 2], [3, 4]])\\n540.         e = np.rollaxis(e, 0, 2)\\n541.         t = TParModel(coeff, e, model_set_axis=-1)\\n542.         assert len(t) == 2\\n543.         assert t.model_set_axis == -1\\n544.         assert len(t.param_sets) == 2\\n545.         assert np.issubdtype(t.param_sets.dtype, np.object_)\\n546.         assert np.all(t.param_sets[0] == [[[10, 50], [20, 60]],\\n547.                                           [[30, 70], [40, 80]]])\\n548.         assert np.all(t.param_sets[1] == [[[1, 3], [2, 4]]])\\n549.         assert np.all(t.parameters == [10, 50, 20, 60, 30, 70, 40, 80,\\n550.                                        1, 3, 2, 4])\\n551.         assert t.coeff.shape == (2, 2)\\n552.         assert t.e.shape == (2,)\\n553. \\n554.     def test_wrong_number_of_params(self):\\n555.         with pytest.raises(InputParameterError):\\n556.             TParModel(coeff=[[1, 2], [3, 4]], e=(2, 3, 4), n_models=2)\\n557.         with pytest.raises(InputParameterError):\\n558.             TParModel(coeff=[[1, 2], [3, 4]], e=(2, 3, 4), model_set_axis=0)\\n559. \\n560.     def test_wrong_number_of_params2(self):\\n561.         with pytest.raises(InputParameterError):\\n562.             m = TParModel(coeff=[[1, 2], [3, 4]], e=4, n_models=2)\\n563.         with pytest.raises(InputParameterError):\\n564.             m = TParModel(coeff=[[1, 2], [3, 4]], e=4, model_set_axis=0)\\n565. \\n566.     def test_array_parameter1(self):\\n567.         with pytest.raises(InputParameterError):\\n568.             t = TParModel(np.array([[1, 2], [3, 4]]), 1, model_set_axis=0)\\n569. \\n570.     def test_array_parameter2(self):\\n571.         with pytest.raises(InputParameterError):\\n572.             m = TParModel(np.array([[1, 2], [3, 4]]), (1, 1, 11),\\n573.                              model_set_axis=0)\\n574. \\n575.     def test_array_parameter4(self):\\n576.         """\\n577.         Test multiple parameter model with array-valued parameters of the same\\n578.         size as the number of parameter sets.\\n579.         """\\n580. \\n581.         t4 = TParModel([[1, 2], [3, 4]], [5, 6], model_set_axis=False)\\n582.         assert len(t4) == 1\\n583.         assert t4.coeff.shape == (2, 2)\\n584.         assert t4.e.shape == (2,)\\n585.         assert np.issubdtype(t4.param_sets.dtype, np.object_)\\n586.         assert np.all(t4.param_sets[0] == [[1, 2], [3, 4]])\\n587.         assert np.all(t4.param_sets[1] == [5, 6])\\n588. \\n589. \\n590. def test_non_broadcasting_parameters():\\n591.     """\\n592.     Tests that in a model with 3 parameters that do not all mutually broadcast,\\n593.     this is determined correctly regardless of what order the parameters are\\n594.     in.\\n595.     """\\n596. \\n597.     a = 3\\n598.     b = np.array([[1, 2, 3], [4, 5, 6]])\\n599.     c = np.array([[1, 2, 3, 4], [1, 2, 3, 4]])\\n600. \\n601.     class TestModel(Model):\\n602.         p1 = Parameter()\\n603.         p2 = Parameter()\\n604.         p3 = Parameter()\\n605. \\n606.         def evaluate(self, *args):\\n607.             return\\n608. \\n609.     # a broadcasts with both b and c, but b does not broadcast with c\\n610.     for args in itertools.permutations((a, b, c)):\\n611.         with pytest.raises(InputParameterError):\\n612.             TestModel(*args)\\n613. \\n614. \\n615. def test_setter():\\n616.     pars = np.random.rand(20).reshape((10, 2))\\n617. \\n618.     model = SetterModel(-1, 3, np.pi)\\n619. \\n620.     for x, y in pars:\\n621.         model.x = x\\n622.         model.y = y\\n623.         utils.assert_almost_equal(model(x, y), (x + 1)**2 + (y - np.pi * 3)**2)\', \'start_line_number\': 1, \'end_line_number\': 623}\n\n{\'relative_path\': \'astropy/utils/tests/test_decorators.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. import functools\\n4. import inspect\\n5. import pickle\\n6. \\n7. import pytest\\n8. \\n9. from ..decorators import (deprecated_attribute, deprecated, wraps,\\n10.                           sharedmethod, classproperty,\\n11.                           format_doc, deprecated_renamed_argument)\\n12. from ..exceptions import AstropyDeprecationWarning, AstropyUserWarning\\n13. from ...tests.helper import catch_warnings\\n14. \\n15. \\n16. def test_wraps():\\n17.     """\\n18.     Tests the compatibility replacement for functools.wraps which supports\\n19.     argument preservation across all supported Python versions.\\n20.     """\\n21. \\n22.     def foo(a, b, c=1, d=2, e=3, **kwargs):\\n23.         """A test function."""\\n24. \\n25.         return a, b, c, d, e, kwargs\\n26. \\n27.     @wraps(foo)\\n28.     def bar(*args, **kwargs):\\n29.         return (\\\'test\\\',) + foo(*args, **kwargs)\\n30. \\n31.     expected = (\\\'test\\\', 1, 2, 3, 4, 5, {\\\'f\\\': 6, \\\'g\\\': 7})\\n32.     assert bar(1, 2, 3, 4, 5, f=6, g=7) == expected\\n33.     assert bar.__name__ == \\\'foo\\\'\\n34. \\n35.     if foo.__doc__ is not None:\\n36.         # May happen if using optimized opcode\\n37.         assert bar.__doc__ == "A test function."\\n38. \\n39.     if hasattr(foo, \\\'__qualname__\\\'):\\n40.         assert bar.__qualname__ == foo.__qualname__\\n41. \\n42.     argspec = inspect.getfullargspec(bar)\\n43.     assert argspec.varkw == \\\'kwargs\\\'\\n44. \\n45.     assert argspec.args == [\\\'a\\\', \\\'b\\\', \\\'c\\\', \\\'d\\\', \\\'e\\\']\\n46.     assert argspec.defaults == (1, 2, 3)\\n47. \\n48. \\n49. def test_wraps_exclude_names():\\n50.     """\\n51.     Test the optional ``exclude_names`` argument to the wraps decorator.\\n52.     """\\n53. \\n54.     # This particular test demonstrates wrapping an instance method\\n55.     # as a function and excluding the "self" argument:\\n56. \\n57.     class TestClass:\\n58.         def method(self, a, b, c=1, d=2, **kwargs):\\n59.             return (a, b, c, d, kwargs)\\n60. \\n61.     test = TestClass()\\n62. \\n63.     @wraps(test.method, exclude_args=(\\\'self\\\',))\\n64.     def func(*args, **kwargs):\\n65.         return test.method(*args, **kwargs)\\n66. \\n67.     argspec = inspect.getfullargspec(func)\\n68.     assert argspec.args == [\\\'a\\\', \\\'b\\\', \\\'c\\\', \\\'d\\\']\\n69. \\n70.     assert func(\\\'a\\\', \\\'b\\\', e=3) == (\\\'a\\\', \\\'b\\\', 1, 2, {\\\'e\\\': 3})\\n71. \\n72. \\n73. def test_wraps_keep_orig_name():\\n74.     """\\n75.     Test that when __name__ is excluded from the ``assigned`` argument\\n76.     to ``wrap`` that the function being wrapped keeps its original name.\\n77. \\n78.     Regression test for https://github.com/astropy/astropy/pull/4016\\n79.     """\\n80. \\n81.     def foo():\\n82.         pass\\n83. \\n84.     assigned = list(functools.WRAPPER_ASSIGNMENTS)\\n85.     assigned.remove(\\\'__name__\\\')\\n86. \\n87.     def bar():\\n88.         pass\\n89. \\n90.     orig_bar = bar\\n91. \\n92.     bar = wraps(foo, assigned=assigned)(bar)\\n93. \\n94.     assert bar is not orig_bar\\n95.     assert bar.__name__ == \\\'bar\\\'\\n96. \\n97. \\n98. def test_deprecated_attribute():\\n99.     class DummyClass:\\n100.         def __init__(self):\\n101.             self._foo = 42\\n102. \\n103.         def set_private(self):\\n104.             self._foo = 100\\n105. \\n106.         foo = deprecated_attribute(\\\'foo\\\', \\\'0.2\\\')\\n107. \\n108.     dummy = DummyClass()\\n109. \\n110.     with catch_warnings(AstropyDeprecationWarning) as w:\\n111.         x = dummy.foo\\n112. \\n113.     assert len(w) == 1\\n114.     assert str(w[0].message) == ("The foo attribute is deprecated and may be "\\n115.                                  "removed in a future version.")\\n116. \\n117.     with catch_warnings() as w:\\n118.         dummy.set_private()\\n119. \\n120.     assert len(w) == 0\\n121. \\n122. \\n123. # This needs to be defined outside of the test function, because we\\n124. # want to try to pickle it.\\n125. @deprecated(\\\'100.0\\\')\\n126. class TA:\\n127.     """\\n128.     This is the class docstring.\\n129.     """\\n130. \\n131.     def __init__(self):\\n132.         """\\n133.         This is the __init__ docstring\\n134.         """\\n135.         pass\\n136. \\n137. \\n138. class TMeta(type):\\n139.     metaclass_attr = 1\\n140. \\n141. \\n142. @deprecated(\\\'100.0\\\')\\n143. class TB(metaclass=TMeta):\\n144.     pass\\n145. \\n146. \\n147. def test_deprecated_class():\\n148.     orig_A = TA.__bases__[0]\\n149. \\n150.     # The only thing that should be different about the new class\\n151.     # is __doc__, __init__, __bases__ and __subclasshook__.\\n152.     # and __init_subclass__ for Python 3.6+.\\n153.     for x in dir(orig_A):\\n154.         if x not in (\\\'__doc__\\\', \\\'__init__\\\', \\\'__bases__\\\', \\\'__dict__\\\',\\n155.                      \\\'__subclasshook__\\\', \\\'__init_subclass__\\\'):\\n156.             assert getattr(TA, x) == getattr(orig_A, x)\\n157. \\n158.     with catch_warnings(AstropyDeprecationWarning) as w:\\n159.         TA()\\n160. \\n161.     assert len(w) == 1\\n162.     if TA.__doc__ is not None:\\n163.         assert \\\'function\\\' not in TA.__doc__\\n164.         assert \\\'deprecated\\\' in TA.__doc__\\n165.         assert \\\'function\\\' not in TA.__init__.__doc__\\n166.         assert \\\'deprecated\\\' in TA.__init__.__doc__\\n167. \\n168.     # Make sure the object is picklable\\n169.     pickle.dumps(TA)\\n170. \\n171. \\n172. def test_deprecated_class_with_new_method():\\n173.     """\\n174.     Test that a class with __new__ method still works even if it accepts\\n175.     additional arguments.\\n176.     This previously failed because the deprecated decorator would wrap objects\\n177.     __init__ which takes no arguments.\\n178.     """\\n179.     @deprecated(\\\'1.0\\\')\\n180.     class A:\\n181.         def __new__(cls, a):\\n182.             return super().__new__(cls)\\n183. \\n184.     # Creating an instance should work but raise a DeprecationWarning\\n185.     with catch_warnings(AstropyDeprecationWarning) as w:\\n186.         A(1)\\n187.     assert len(w) == 1\\n188. \\n189.     @deprecated(\\\'1.0\\\')\\n190.     class B:\\n191.         def __new__(cls, a):\\n192.             return super().__new__(cls)\\n193. \\n194.         def __init__(self, a):\\n195.             pass\\n196. \\n197.     # Creating an instance should work but raise a DeprecationWarning\\n198.     with catch_warnings(AstropyDeprecationWarning) as w:\\n199.         B(1)\\n200.     assert len(w) == 1\\n201. \\n202. \\n203. def test_deprecated_class_with_super():\\n204.     """\\n205.     Regression test for an issue where classes that used `super()` in their\\n206.     ``__init__`` did not actually call the correct class\\\'s ``__init__`` in the\\n207.     MRO.\\n208.     """\\n209. \\n210.     @deprecated(\\\'100.0\\\')\\n211.     class TB:\\n212.         def __init__(self, a, b):\\n213.             super().__init__()\\n214. \\n215.     with catch_warnings(AstropyDeprecationWarning) as w:\\n216.         TB(1, 2)\\n217. \\n218.     assert len(w) == 1\\n219.     if TB.__doc__ is not None:\\n220.         assert \\\'function\\\' not in TB.__doc__\\n221.         assert \\\'deprecated\\\' in TB.__doc__\\n222.         assert \\\'function\\\' not in TB.__init__.__doc__\\n223.         assert \\\'deprecated\\\' in TB.__init__.__doc__\\n224. \\n225. \\n226. def test_deprecated_class_with_custom_metaclass():\\n227.     """\\n228.     Regression test for an issue where deprecating a class with a metaclass\\n229.     other than type did not restore the metaclass properly.\\n230.     """\\n231. \\n232.     with catch_warnings(AstropyDeprecationWarning) as w:\\n233.         TB()\\n234. \\n235.     assert len(w) == 1\\n236.     assert type(TB) is TMeta\\n237.     assert TB.metaclass_attr == 1\\n238. \\n239. \\n240. def test_deprecated_static_and_classmethod():\\n241.     """\\n242.     Regression test for issue introduced by\\n243.     https://github.com/astropy/astropy/pull/2811 and mentioned also here:\\n244.     https://github.com/astropy/astropy/pull/2580#issuecomment-51049969\\n245.     where it appears that deprecated staticmethods didn\\\'t work on Python 2.6.\\n246.     """\\n247. \\n248.     class A:\\n249.         """Docstring"""\\n250. \\n251.         @deprecated(\\\'1.0\\\')\\n252.         @staticmethod\\n253.         def B():\\n254.             pass\\n255. \\n256.         @deprecated(\\\'1.0\\\')\\n257.         @classmethod\\n258.         def C(cls):\\n259.             pass\\n260. \\n261.     with catch_warnings(AstropyDeprecationWarning) as w:\\n262.         A.B()\\n263. \\n264.     assert len(w) == 1\\n265.     if A.__doc__ is not None:\\n266.         assert \\\'deprecated\\\' in A.B.__doc__\\n267. \\n268.     with catch_warnings(AstropyDeprecationWarning) as w:\\n269.         A.C()\\n270. \\n271.     assert len(w) == 1\\n272.     if A.__doc__ is not None:\\n273.         assert \\\'deprecated\\\' in A.C.__doc__\\n274. \\n275. \\n276. def test_deprecated_argument():\\n277.     # Tests the decorator with function, method, staticmethod and classmethod.\\n278. \\n279.     class Test:\\n280. \\n281.         @classmethod\\n282.         @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\')\\n283.         def test1(cls, overwrite):\\n284.             return overwrite\\n285. \\n286.         @staticmethod\\n287.         @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\')\\n288.         def test2(overwrite):\\n289.             return overwrite\\n290. \\n291.         @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\')\\n292.         def test3(self, overwrite):\\n293.             return overwrite\\n294. \\n295.     @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\', relax=False)\\n296.     def test1(overwrite):\\n297.         return overwrite\\n298. \\n299.     for method in [Test().test1, Test().test2, Test().test3, test1]:\\n300.         # As positional argument only\\n301.         assert method(1) == 1\\n302. \\n303.         # As new keyword argument\\n304.         assert method(overwrite=1) == 1\\n305. \\n306.         # Using the deprecated name\\n307.         with catch_warnings(AstropyDeprecationWarning) as w:\\n308.             assert method(clobber=1) == 1\\n309.             assert len(w) == 1\\n310.             assert \\\'1.3\\\' in str(w[0].message)\\n311.             assert \\\'test_decorators.py\\\' in str(w[0].filename)\\n312. \\n313.         # Using both. Both keyword\\n314.         with pytest.raises(TypeError):\\n315.             method(clobber=2, overwrite=1)\\n316.         # One positional, one keyword\\n317.         with pytest.raises(TypeError):\\n318.             method(1, clobber=2)\\n319. \\n320. \\n321. def test_deprecated_argument_in_kwargs():\\n322.     # To rename an argument that is consumed by "kwargs" the "arg_in_kwargs"\\n323.     # parameter is used.\\n324.     @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\',\\n325.                                  arg_in_kwargs=True)\\n326.     def test(**kwargs):\\n327.         return kwargs[\\\'overwrite\\\']\\n328. \\n329.     # As positional argument only\\n330.     with pytest.raises(TypeError):\\n331.         test(1)\\n332. \\n333.     # As new keyword argument\\n334.     assert test(overwrite=1) == 1\\n335. \\n336.     # Using the deprecated name\\n337.     with catch_warnings(AstropyDeprecationWarning) as w:\\n338.         assert test(clobber=1) == 1\\n339.         assert len(w) == 1\\n340.         assert \\\'1.3\\\' in str(w[0].message)\\n341.         assert \\\'test_decorators.py\\\' in str(w[0].filename)\\n342. \\n343.     # Using both. Both keyword\\n344.     with pytest.raises(TypeError):\\n345.         test(clobber=2, overwrite=1)\\n346.     # One positional, one keyword\\n347.     with pytest.raises(TypeError):\\n348.         test(1, clobber=2)\\n349. \\n350. \\n351. def test_deprecated_argument_relaxed():\\n352.     # Relax turns the TypeError if both old and new keyword are used into\\n353.     # a warning.\\n354.     @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\', relax=True)\\n355.     def test(overwrite):\\n356.         return overwrite\\n357. \\n358.     # As positional argument only\\n359.     assert test(1) == 1\\n360. \\n361.     # As new keyword argument\\n362.     assert test(overwrite=1) == 1\\n363. \\n364.     # Using the deprecated name\\n365.     with catch_warnings(AstropyDeprecationWarning) as w:\\n366.         assert test(clobber=1) == 1\\n367.         assert len(w) == 1\\n368.         assert \\\'1.3\\\' in str(w[0].message)\\n369. \\n370.     # Using both. Both keyword\\n371.     with catch_warnings(AstropyUserWarning) as w:\\n372.         assert test(clobber=2, overwrite=1) == 1\\n373.         assert len(w) == 1\\n374. \\n375.     # One positional, one keyword\\n376.     with catch_warnings(AstropyUserWarning) as w:\\n377.         assert test(1, clobber=2) == 1\\n378.         assert len(w) == 1\\n379. \\n380. \\n381. def test_deprecated_argument_pending():\\n382.     # Relax turns the TypeError if both old and new keyword are used into\\n383.     # a warning.\\n384.     @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\', pending=True)\\n385.     def test(overwrite):\\n386.         return overwrite\\n387. \\n388.     # As positional argument only\\n389.     assert test(1) == 1\\n390. \\n391.     # As new keyword argument\\n392.     assert test(overwrite=1) == 1\\n393. \\n394.     # Using the deprecated name\\n395.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:\\n396.         assert test(clobber=1) == 1\\n397.         assert len(w) == 0\\n398. \\n399.     # Using both. Both keyword\\n400.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:\\n401.         assert test(clobber=2, overwrite=1) == 1\\n402.         assert len(w) == 0\\n403. \\n404.     # One positional, one keyword\\n405.     with catch_warnings(AstropyUserWarning, AstropyDeprecationWarning) as w:\\n406.         assert test(1, clobber=2) == 1\\n407.         assert len(w) == 0\\n408. \\n409. \\n410. def test_deprecated_argument_multi_deprecation():\\n411.     @deprecated_renamed_argument([\\\'x\\\', \\\'y\\\', \\\'z\\\'], [\\\'a\\\', \\\'b\\\', \\\'c\\\'],\\n412.                                  [1.3, 1.2, 1.3], relax=True)\\n413.     def test(a, b, c):\\n414.         return a, b, c\\n415. \\n416.     with catch_warnings(AstropyDeprecationWarning) as w:\\n417.         assert test(x=1, y=2, z=3) == (1, 2, 3)\\n418.         assert len(w) == 3\\n419. \\n420.     # Make sure relax is valid for all arguments\\n421.     with catch_warnings(AstropyUserWarning) as w:\\n422.         assert test(x=1, y=2, z=3, b=3) == (1, 3, 3)\\n423.         assert len(w) == 1\\n424. \\n425.     with catch_warnings(AstropyUserWarning) as w:\\n426.         assert test(x=1, y=2, z=3, a=3) == (3, 2, 3)\\n427.         assert len(w) == 1\\n428. \\n429.     with catch_warnings(AstropyUserWarning) as w:\\n430.         assert test(x=1, y=2, z=3, c=5) == (1, 2, 5)\\n431.         assert len(w) == 1\\n432. \\n433. \\n434. def test_deprecated_argument_multi_deprecation_2():\\n435.     @deprecated_renamed_argument([\\\'x\\\', \\\'y\\\', \\\'z\\\'], [\\\'a\\\', \\\'b\\\', \\\'c\\\'],\\n436.                                  [1.3, 1.2, 1.3], relax=[True, True, False])\\n437.     def test(a, b, c):\\n438.         return a, b, c\\n439. \\n440.     with catch_warnings(AstropyUserWarning) as w:\\n441.         assert test(x=1, y=2, z=3, b=3) == (1, 3, 3)\\n442.         assert len(w) == 1\\n443. \\n444.     with catch_warnings(AstropyUserWarning) as w:\\n445.         assert test(x=1, y=2, z=3, a=3) == (3, 2, 3)\\n446.         assert len(w) == 1\\n447. \\n448.     with pytest.raises(TypeError):\\n449.         assert test(x=1, y=2, z=3, c=5) == (1, 2, 5)\\n450. \\n451. \\n452. def test_deprecated_argument_not_allowed_use():\\n453.     # If the argument is supposed to be inside the kwargs one needs to set the\\n454.     # arg_in_kwargs parameter. Without it it raises a TypeError.\\n455.     with pytest.raises(TypeError):\\n456.         @deprecated_renamed_argument(\\\'clobber\\\', \\\'overwrite\\\', \\\'1.3\\\')\\n457.         def test1(**kwargs):\\n458.             return kwargs[\\\'overwrite\\\']\\n459. \\n460.     # Cannot replace "*args".\\n461.     with pytest.raises(TypeError):\\n462.         @deprecated_renamed_argument(\\\'overwrite\\\', \\\'args\\\', \\\'1.3\\\')\\n463.         def test2(*args):\\n464.             return args\\n465. \\n466.     # Cannot replace "**kwargs".\\n467.     with pytest.raises(TypeError):\\n468.         @deprecated_renamed_argument(\\\'overwrite\\\', \\\'kwargs\\\', \\\'1.3\\\')\\n469.         def test3(**kwargs):\\n470.             return kwargs\\n471. \\n472. \\n473. def test_sharedmethod_reuse_on_subclasses():\\n474.     """\\n475.     Regression test for an issue where sharedmethod would bind to one class\\n476.     for all time, causing the same method not to work properly on other\\n477.     subclasses of that class.\\n478. \\n479.     It has the same problem when the same sharedmethod is called on different\\n480.     instances of some class as well.\\n481.     """\\n482. \\n483.     class AMeta(type):\\n484.         def foo(cls):\\n485.             return cls.x\\n486. \\n487.     class A:\\n488.         x = 3\\n489. \\n490.         def __init__(self, x):\\n491.             self.x = x\\n492. \\n493.         @sharedmethod\\n494.         def foo(self):\\n495.             return self.x\\n496. \\n497.     a1 = A(1)\\n498.     a2 = A(2)\\n499. \\n500.     assert a1.foo() == 1\\n501.     assert a2.foo() == 2\\n502. \\n503.     # Similar test now, but for multiple subclasses using the same sharedmethod\\n504.     # as a classmethod\\n505.     assert A.foo() == 3\\n506. \\n507.     class B(A):\\n508.         x = 5\\n509. \\n510.     assert B.foo() == 5\\n511. \\n512. \\n513. def test_classproperty_docstring():\\n514.     """\\n515.     Tests that the docstring is set correctly on classproperties.\\n516. \\n517.     This failed previously due to a bug in Python that didn\\\'t always\\n518.     set __doc__ properly on instances of property subclasses.\\n519.     """\\n520. \\n521.     class A:\\n522.         # Inherits docstring from getter\\n523.         @classproperty\\n524.         def foo(cls):\\n525.             """The foo."""\\n526. \\n527.             return 1\\n528. \\n529.     assert A.__dict__[\\\'foo\\\'].__doc__ == "The foo."\\n530. \\n531.     class B:\\n532.         # Use doc passed to classproperty constructor\\n533.         def _get_foo(cls): return 1\\n534. \\n535.         foo = classproperty(_get_foo, doc="The foo.")\\n536. \\n537.     assert B.__dict__[\\\'foo\\\'].__doc__ == "The foo."\\n538. \\n539. \\n540. def test_format_doc_stringInput_simple():\\n541.     # Simple tests with string input\\n542. \\n543.     docstring_fail = \\\'\\\'\\n544. \\n545.     # Raises an valueerror if input is empty\\n546.     with pytest.raises(ValueError):\\n547.         @format_doc(docstring_fail)\\n548.         def testfunc_fail():\\n549.             pass\\n550. \\n551.     docstring = \\\'test\\\'\\n552. \\n553.     # A first test that replaces an empty docstring\\n554.     @format_doc(docstring)\\n555.     def testfunc_1():\\n556.         pass\\n557.     assert inspect.getdoc(testfunc_1) == docstring\\n558. \\n559.     # Test that it replaces an existing docstring\\n560.     @format_doc(docstring)\\n561.     def testfunc_2():\\n562.         \\\'\\\'\\\'not test\\\'\\\'\\\'\\n563.         pass\\n564.     assert inspect.getdoc(testfunc_2) == docstring\\n565. \\n566. \\n567. def test_format_doc_stringInput_format():\\n568.     # Tests with string input and formatting\\n569. \\n570.     docstring = \\\'yes {0} no {opt}\\\'\\n571. \\n572.     # Raises an indexerror if not given the formatted args and kwargs\\n573.     with pytest.raises(IndexError):\\n574.         @format_doc(docstring)\\n575.         def testfunc1():\\n576.             pass\\n577. \\n578.     # Test that the formatting is done right\\n579.     @format_doc(docstring, \\\'/\\\', opt=\\\'= life\\\')\\n580.     def testfunc2():\\n581.         pass\\n582.     assert inspect.getdoc(testfunc2) == \\\'yes / no = life\\\'\\n583. \\n584.     # Test that we can include the original docstring\\n585. \\n586.     docstring2 = \\\'yes {0} no {__doc__}\\\'\\n587. \\n588.     @format_doc(docstring2, \\\'/\\\')\\n589.     def testfunc3():\\n590.         \\\'\\\'\\\'= 2 / 2 * life\\\'\\\'\\\'\\n591.         pass\\n592.     assert inspect.getdoc(testfunc3) == \\\'yes / no = 2 / 2 * life\\\'\\n593. \\n594. \\n595. def test_format_doc_objectInput_simple():\\n596.     # Simple tests with object input\\n597. \\n598.     def docstring_fail():\\n599.         pass\\n600. \\n601.     # Self input while the function has no docstring raises an error\\n602.     with pytest.raises(ValueError):\\n603.         @format_doc(docstring_fail)\\n604.         def testfunc_fail():\\n605.             pass\\n606. \\n607.     def docstring0():\\n608.         \\\'\\\'\\\'test\\\'\\\'\\\'\\n609.         pass\\n610. \\n611.     # A first test that replaces an empty docstring\\n612.     @format_doc(docstring0)\\n613.     def testfunc_1():\\n614.         pass\\n615.     assert inspect.getdoc(testfunc_1) == inspect.getdoc(docstring0)\\n616. \\n617.     # Test that it replaces an existing docstring\\n618.     @format_doc(docstring0)\\n619.     def testfunc_2():\\n620.         \\\'\\\'\\\'not test\\\'\\\'\\\'\\n621.         pass\\n622.     assert inspect.getdoc(testfunc_2) == inspect.getdoc(docstring0)\\n623. \\n624. \\n625. def test_format_doc_objectInput_format():\\n626.     # Tests with object input and formatting\\n627. \\n628.     def docstring():\\n629.         \\\'\\\'\\\'test {0} test {opt}\\\'\\\'\\\'\\n630.         pass\\n631. \\n632.     # Raises an indexerror if not given the formatted args and kwargs\\n633.     with pytest.raises(IndexError):\\n634.         @format_doc(docstring)\\n635.         def testfunc_fail():\\n636.             pass\\n637. \\n638.     # Test that the formatting is done right\\n639.     @format_doc(docstring, \\\'+\\\', opt=\\\'= 2 * test\\\')\\n640.     def testfunc2():\\n641.         pass\\n642.     assert inspect.getdoc(testfunc2) == \\\'test + test = 2 * test\\\'\\n643. \\n644.     # Test that we can include the original docstring\\n645. \\n646.     def docstring2():\\n647.         \\\'\\\'\\\'test {0} test {__doc__}\\\'\\\'\\\'\\n648.         pass\\n649. \\n650.     @format_doc(docstring2, \\\'+\\\')\\n651.     def testfunc3():\\n652.         \\\'\\\'\\\'= 4 / 2 * test\\\'\\\'\\\'\\n653.         pass\\n654.     assert inspect.getdoc(testfunc3) == \\\'test + test = 4 / 2 * test\\\'\\n655. \\n656. \\n657. def test_format_doc_selfInput_simple():\\n658.     # Simple tests with self input\\n659. \\n660.     # Self input while the function has no docstring raises an error\\n661.     with pytest.raises(ValueError):\\n662.         @format_doc(None)\\n663.         def testfunc_fail():\\n664.             pass\\n665. \\n666.     # Test that it keeps an existing docstring\\n667.     @format_doc(None)\\n668.     def testfunc_1():\\n669.         \\\'\\\'\\\'not test\\\'\\\'\\\'\\n670.         pass\\n671.     assert inspect.getdoc(testfunc_1) == \\\'not test\\\'\\n672. \\n673. \\n674. def test_format_doc_selfInput_format():\\n675.     # Tests with string input which is \\\'__doc__\\\' (special case) and formatting\\n676. \\n677.     # Raises an indexerror if not given the formatted args and kwargs\\n678.     with pytest.raises(IndexError):\\n679.         @format_doc(None)\\n680.         def testfunc_fail():\\n681.             \\\'\\\'\\\'dum {0} dum {opt}\\\'\\\'\\\'\\n682.             pass\\n683. \\n684.     # Test that the formatting is done right\\n685.     @format_doc(None, \\\'di\\\', opt=\\\'da dum\\\')\\n686.     def testfunc1():\\n687.         \\\'\\\'\\\'dum {0} dum {opt}\\\'\\\'\\\'\\n688.         pass\\n689.     assert inspect.getdoc(testfunc1) == \\\'dum di dum da dum\\\'\\n690. \\n691.     # Test that we cannot recursively insert the original documentation\\n692. \\n693.     @format_doc(None, \\\'di\\\')\\n694.     def testfunc2():\\n695.         \\\'\\\'\\\'dum {0} dum {__doc__}\\\'\\\'\\\'\\n696.         pass\\n697.     assert inspect.getdoc(testfunc2) == \\\'dum di dum \\\'\\n698. \\n699. \\n700. def test_format_doc_onMethod():\\n701.     # Check if the decorator works on methods too, to spice it up we try double\\n702.     # decorator\\n703.     docstring = \\\'what we do {__doc__}\\\'\\n704. \\n705.     class TestClass:\\n706.         @format_doc(docstring)\\n707.         @format_doc(None, \\\'strange.\\\')\\n708.         def test_method(self):\\n709.             \\\'\\\'\\\'is {0}\\\'\\\'\\\'\\n710.             pass\\n711. \\n712.     assert inspect.getdoc(TestClass.test_method) == \\\'what we do is strange.\\\'\\n713. \\n714. \\n715. def test_format_doc_onClass():\\n716.     # Check if the decorator works on classes too\\n717.     docstring = \\\'what we do {__doc__} {0}{opt}\\\'\\n718. \\n719.     @format_doc(docstring, \\\'strange\\\', opt=\\\'.\\\')\\n720.     class TestClass:\\n721.         \\\'\\\'\\\'is\\\'\\\'\\\'\\n722.         pass\\n723. \\n724.     assert inspect.getdoc(TestClass) == \\\'what we do is strange.\\\'\', \'start_line_number\': 1, \'end_line_number\': 724}\n\n{\'relative_path\': \'astropy/utils/tests/test_misc.py\', \'content\': \'1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\\n2. \\n3. import json\\n4. import os\\n5. from datetime import datetime\\n6. import locale\\n7. \\n8. import pytest\\n9. import numpy as np\\n10. \\n11. from .. import data, misc\\n12. \\n13. \\n14. def test_isiterable():\\n15.     assert misc.isiterable(2) is False\\n16.     assert misc.isiterable([2]) is True\\n17.     assert misc.isiterable([1, 2, 3]) is True\\n18.     assert misc.isiterable(np.array(2)) is False\\n19.     assert misc.isiterable(np.array([1, 2, 3])) is True\\n20. \\n21. \\n22. def test_signal_number_to_name_no_failure():\\n23.     # Regression test for #5340: ensure signal_number_to_name throws no\\n24.     # AttributeError (it used ".iteritems()" which was removed in Python3).\\n25.     misc.signal_number_to_name(0)\\n26. \\n27. \\n28. @pytest.mark.remote_data\\n29. def test_api_lookup():\\n30.     strurl = misc.find_api_page(\\\'astropy.utils.misc\\\', \\\'dev\\\', False, timeout=3)\\n31.     objurl = misc.find_api_page(misc, \\\'dev\\\', False, timeout=3)\\n32. \\n33.     assert strurl == objurl\\n34.     assert strurl == \\\'http://devdocs.astropy.org/utils/index.html#module-astropy.utils.misc\\\'\\n35. \\n36. \\n37. def test_skip_hidden():\\n38.     path = data._find_pkg_data_path(\\\'data\\\')\\n39.     for root, dirs, files in os.walk(path):\\n40.         assert \\\'.hidden_file.txt\\\' in files\\n41.         assert \\\'local.dat\\\' in files\\n42.         # break after the first level since the data dir contains some other\\n43.         # subdirectories that don\\\'t have these files\\n44.         break\\n45. \\n46.     for root, dirs, files in misc.walk_skip_hidden(path):\\n47.         assert \\\'.hidden_file.txt\\\' not in files\\n48.         assert \\\'local.dat\\\' in files\\n49.         break\\n50. \\n51. \\n52. def test_JsonCustomEncoder():\\n53.     from ... import units as u\\n54.     assert json.dumps(np.arange(3), cls=misc.JsonCustomEncoder) == \\\'[0, 1, 2]\\\'\\n55.     assert json.dumps(1+2j, cls=misc.JsonCustomEncoder) == \\\'[1.0, 2.0]\\\'\\n56.     assert json.dumps(set([1, 2, 1]), cls=misc.JsonCustomEncoder) == \\\'[1, 2]\\\'\\n57.     assert json.dumps(b\\\'hello world \\\\xc3\\\\x85\\\',\\n58.                       cls=misc.JsonCustomEncoder) == \\\'"hello world \\\\\\\\u00c5"\\\'\\n59.     assert json.dumps({1: 2},\\n60.                       cls=misc.JsonCustomEncoder) == \\\'{"1": 2}\\\'  # default\\n61.     assert json.dumps({1: u.m}, cls=misc.JsonCustomEncoder) == \\\'{"1": "m"}\\\'\\n62.     # Quantities\\n63.     tmp = json.dumps({\\\'a\\\': 5*u.cm}, cls=misc.JsonCustomEncoder)\\n64.     newd = json.loads(tmp)\\n65.     tmpd = {"a": {"unit": "cm", "value": 5.0}}\\n66.     assert newd == tmpd\\n67.     tmp2 = json.dumps({\\\'a\\\': np.arange(2)*u.cm}, cls=misc.JsonCustomEncoder)\\n68.     newd = json.loads(tmp2)\\n69.     tmpd = {"a": {"unit": "cm", "value": [0., 1.]}}\\n70.     assert newd == tmpd\\n71.     tmp3 = json.dumps({\\\'a\\\': np.arange(2)*u.erg/u.s}, cls=misc.JsonCustomEncoder)\\n72.     newd = json.loads(tmp3)\\n73.     tmpd = {"a": {"unit": "erg / s", "value": [0., 1.]}}\\n74.     assert newd == tmpd\\n75. \\n76. \\n77. def test_inherit_docstrings():\\n78.     class Base(metaclass=misc.InheritDocstrings):\\n79.         def __call__(self, *args):\\n80.             "FOO"\\n81.             pass\\n82. \\n83.     class Subclass(Base):\\n84.         def __call__(self, *args):\\n85.             pass\\n86. \\n87.     if Base.__call__.__doc__ is not None:\\n88.         # TODO: Maybe if __doc__ is None this test should be skipped instead?\\n89.         assert Subclass.__call__.__doc__ == "FOO"\\n90. \\n91. \\n92. def test_set_locale():\\n93.     # First, test if the required locales are available\\n94.     current = locale.setlocale(locale.LC_ALL)\\n95.     try:\\n96.         locale.setlocale(locale.LC_ALL, str(\\\'en_US\\\'))\\n97.         locale.setlocale(locale.LC_ALL, str(\\\'de_DE\\\'))\\n98.     except locale.Error as e:\\n99.         pytest.skip(\\\'Locale error: {}\\\'.format(e))\\n100.     finally:\\n101.         locale.setlocale(locale.LC_ALL, current)\\n102. \\n103.     date = datetime(2000, 10, 1, 0, 0, 0)\\n104.     day_mon = date.strftime(\\\'%a, %b\\\')\\n105. \\n106.     with misc.set_locale(\\\'en_US\\\'):\\n107.         assert date.strftime(\\\'%a, %b\\\') == \\\'Sun, Oct\\\'\\n108. \\n109.     with misc.set_locale(\\\'de_DE\\\'):\\n110.         assert date.strftime(\\\'%a, %b\\\') == \\\'So, Okt\\\'\\n111. \\n112.     # Back to original\\n113.     assert date.strftime(\\\'%a, %b\\\') == day_mon\\n114. \\n115.     with misc.set_locale(current):\\n116.         assert date.strftime(\\\'%a, %b\\\') == day_mon\\n117. \\n118. \\n119. def test_check_broadcast():\\n120.     assert misc.check_broadcast((10, 1), (3,)) == (10, 3)\\n121.     assert misc.check_broadcast((10, 1), (3,), (4, 1, 1, 3)) == (4, 1, 10, 3)\\n122.     with pytest.raises(ValueError):\\n123.         misc.check_broadcast((10, 2), (3,))\\n124. \\n125.     with pytest.raises(ValueError):\\n126.         misc.check_broadcast((10, 1), (3,), (4, 1, 2, 3))\\n127. \\n128. \\n129. def test_dtype_bytes_or_chars():\\n130.     assert misc.dtype_bytes_or_chars(np.dtype(np.float64)) == 8\\n131.     assert misc.dtype_bytes_or_chars(np.dtype(object)) is None\\n132.     assert misc.dtype_bytes_or_chars(np.dtype(np.int32)) == 4\\n133.     assert misc.dtype_bytes_or_chars(np.array(b\\\'12345\\\').dtype) == 5\\n134.     assert misc.dtype_bytes_or_chars(np.array(u\\\'12345\\\').dtype) == 5\', \'start_line_number\': 1, \'end_line_number\': 134}\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-12-21 19:10:52,278 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport pytest\nfrom astropy.utils import misc\n\n\ndef test_inherit_docstrings_on_properties():\n    """\n    Regression test for an issue where docstrings were not being\n    inherited for properties because inspect.isfunction() returns\n    False for properties.\n    """\n    class Base(metaclass=misc.InheritDocstrings):\n        @property\n        def foo(self):\n            """The docstring for foo."""\n            return 1\n\n    class Sub(Base):\n        @property\n        def foo(self):\n            return 2\n\n    if Base.foo.__doc__ is not None:\n        assert Sub.foo.__doc__ == "The docstring for foo."\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 47482, 'candidates_token_count': 159, 'total_token_count': 51735, 'prompt_tokens_details': [{'modality': 1, 'token_count': 47482}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 159}], 'thoughts_token_count': 4094, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -4.311654720666273, 'model_name': 'gemini-2.5-pro'} id='run--ea34e6a9-5208-429e-be75-d7d8559919eb-0' usage_metadata={'input_tokens': 47482, 'output_tokens': 159, 'total_tokens': 51735, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 4094}}
2025-12-21 19:11:03,667 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import pytest\\nfrom astropy.utils import misc\\n\\n\\ndef test_inherit_docstrings_on_properties():\\n    \\"\\"\\"\\n    Regression test for an issue where docstrings were not being\\n    inherited for properties because inspect.isfunction() returns\\n    False for properties.\\n    \\"\\"\\"\\n    class Base(metaclass=misc.InheritDocstrings):\\n        @property\\n        def foo(self):\\n            \\"\\"\\"The docstring for foo.\\"\\"\\"\\n            return 1\\n\\n    class Sub(Base):\\n        @property\\n        def foo(self):\\n            return 2\\n\\n    if Base.foo.__doc__ is not None:\\n        assert Sub.foo.__doc__ == \\"The docstring for foo.\\"\\n", "relative_path": "astropy/utils/tests/test_inherit_docstrings.py"}'}, '__gemini_function_call_thought_signatures__': {'3be46b42-4323-43ee-b296-724e75a23170': 'CoQeAY89a18K7T3V+tgSgd0VsjBH+qEGJNB6m7cF820QkakR/dDUPQTQiA/MCRYukToIn9MgEAMOiLoGJUWGbB56HtIdAOcittZjXyy442br/VM1d0EK2UyY6tiD9H5XnWVHKkk+NjeqHb77W8NaU7/1dhl5gZXDkuk56mHX9T3LYU0oetPqz4J80XX+B802ULaVL3r6mYAdtyKT6WH0eKaCL1PkoCgojlohS0izgb2FKBIjBpB9QUJKs9b8rLVi/ViTCJDhpfQ/l1Kj8+RbCKlrjoYvY7k56QVccYMjB4uIf+/AT4XZdd0RXcYUo+jr9f1lr/rq+K+w6um4ISQah33/yzVX5AjjQwpVK12/nYDCd0SM0An70p/Q+PHZDl4Li5/JgagO4ZoH0RMD4uMjg+LPwUiLvLoh7Nm5L9c5u41oj0W0/B+hiPyDIViZbcm+aMpg/T1aNQUZLCIAsZSjVG878Aqu3CThmWCxEJT/R1tMR/Vcnt27gbUCLPLalqTPMlns9xaSJtj1T7tkwzDZyf+K3J4r+jlsRvLUoV4wjCUv8/6buEdtmeIdnxou6x1ReR4/Tepr5MtPvBbmm2IdkefgEC8whrI3gR0YtIxj0Yx3kbPHTrFZ0Fr+KTfeUJPPRCEhcWS5WAlVjDD7ZdxC81b6Uly+eRc+K7QQ119zFOLfmR2w0G/btJTAEuyRiwyjU1zOu/6CF7Czh1aiPQTfRuX0WU4oB0owNETMHK85FXEJWcW8++YBmX1U1ExxlAPmQBg7yVTZa3mHx7wRoXAzarYhJNsH8jW9R0RYHPMNzAmrELbygK2H0Xz5h6MtcS775F/hCnSenRxt0zWTIwg6C84XZUKW5SqEua9M4ehPNJuLuxp1II2dChv0/fjc0nPfl//Dwv2kFx9OPHFl2udhsVN2OoIqeWNm3iHhg1b4+XO9zxZ1fTvK3HBKLeUF6az++lpuyCRGjAPlFU+i0A9wL3IuDz1bbgJTvtdFcztKdA8EHsJ8i9keHYI6IQZnQC4nbi3U0VFLMWuRSdUqXcf7DIgL72vZ0OfU0vsrOmGdegasRg9x9I4Kn4TbJbIHIC5NUNnoTaOlQYl2N23kIoIj7IgYeFNrSVmccj8JaeHrCTHEoZSoBNXi23UI5jmAPtxvddv5zjtSR2lkA8kTrsNYxMZKmWvkkQxe+TcdlToM2+ENg6V12kBUpNOQhz/Qw/10DzouQL5rgY1C1XAD01C08nLyF9bFyqjo7+MoYnBaTRg8jof/PD+VTvBucJu3xw1NdEfe27g0UeDeyG4TXbUWK0iT6A9QqtL6tMbi3UaokomTi9wUsrG2wzk9UHB1pJBKtgUDf/qwurI2kpxXqYVoB+VvDwLfVIKUS6XoRqzAgwmItzd9OMEYK47nsl4rTF2wAIjUy+i+sztEFyTjYJxEN/ViP+upeJ4/IWBH6iVhqZ9Zg8kZKnZqxuDVpngOzmCYilRdbuC2UmRgd3H50fJK3nouA0fvxLmt5mzrIK9XsQM9L+0S5qD/8TNqg3tunYoeA0fsCwZK0AebG14BNI0P2a7fmVuiy0PD8ysKbi041HCfyR0DPxp2z3IswqFUVItBlKT0QMaASq18+7W8W4qIU2FFEvvx5bqqWbqSVfHUCA7L0k4VPIW99v+DvJo+oLlyKn46GkU2vujfwmgjR5AUm38xky2GWenjPxMUDLylUnctlM0BQDt4SBPNYoERYeriswL5Edhr0sDHPFb1BpT7dG9QRA8rI//wlkhMp/BY60zCHJxkAfKlAf0vz5i3MxvoGfpukxUXNPOUR3miQsEkmThCDYS1J08Ofoh/spLttNvDUyrV2SYqjPcRZn8OivxTtUFJRDwF3B+V+wKolY1r8wYgm+r/1mfsHyDhnh6g/s8826IyrrU6FYWB23lRyKv2+fJBzncZJEkSGWOipKwSyb576CA2IyZmawPdSRgDOgFD476UQr3wBLZJJIrlVZAgKEULwEQsErblcpgAC6nnEOw3uuxnzo1Lrx26hMBqR4qLjq+a/uINyBrCv1gifkGj9NvIDTn+uY0pkPHYauykb9H2k2RK/jNrUvdNS9BO3jJYHShl0w4KCWqWaGbiTrg2VMtaX1Iy/2aiuDW6fxhqWUG8jaaNBb/VeC2KcyiNj71uV3kfl4UPPS1BF0hFEiBQmOKZ4/+TOWqU4xWsPqBhWduii6WX3nZlv/HCPmJfEYDbry2MDXyfGITmjpJBt8Nl/l7Td4X29XSd+y5lN8mLm5eKOfMffpJf52TbFkxdPXFBTzPYkQHr4N/ZJvyAB6arDaQ58KB2iIWjv36k0icoYp9zqdYdDriEt4Gi5f49IVcI72Vbw919vgRVe1sSJjvEVJSDEWLICM8i+2YNZtVnsbfEV7QtMGumFkcv3oyi92PvBzUrW5XVKbh1XJzswgvKpn5cl8aP0jkzFNgibiUyC0qDQ/ifsO4+1OieNJ85kYVQj/RJoNIOOueldiiNiqIXTs3DHURdypUknhjAPDVRRGD6Mjap+55//QQ23R7LdmCaQMiP3i5RDcPv0FEN3JrlP6iV32dmO4qQTapTufPl/7Ai7riValU8tJy7Vfco9QVpWbocOTq2oROfd/dcfnDFK07XWCBEAVtR9t5bkVfD9R+9H+2lFFR4yEgecVl7TNL182URBopK2vHhkQUDz4Jj1vWvsjDRg+Ic5yEENY7Z1vThM0G7K+tI5rql+ir4fZzSuQEfBm46pbaad0C11wzkwBF3cOCcj5GNvpWSWc2dnlNQ7LvNDnxqAkzQoa2taakX6ccRSZeZ/ae6i+X7bHgtxQkzdFzPCaukeN9QvFO91o5UqlTa+LeJolB/Q+NoHeulueo8LXeR8a2smDDKpXI2r27rEGWTsGF0rS+ybn1GovPRgtceVCEu1rMxRLvh2cO/WC8nKPIwIbPNJqbX4kA2TmZ/cWch57kdMiUYZL1JkPeyZU79Z0X6luDZ36JubUNp5WICqyMw6TK3OPgEY29pDyxEGFTJxGdcjMXDbuN2l8lOVhPEuEk685/jSa0wwppQ/UzEplRi0gmSsWsQN5eSPIYzAIoQNTV99MxORgHb9ULH3kLVuQOYtOSMpid8LPG7nlviDlVNmyWHXXBOotG+Zr1jOFOvK0kEoietfF8AfGThsadmtNn7w3GDwtR/d7NAjRglbQnoQn/+Z62DTZ7kFwCtJosPwFDIHu2fMfe71m9O762gVRzB5tUygyaxL26cWRKJPOCCJc9IUg8WLd0Qz15wf6zhvoQMU/zwFpcUHOr2x4XevRZB++Hnuz454cMn784ZlzEYqryXFUyzcRXQAJaXm/0v+BzYKznTNecG/mtTXd38HpW0Nd2tfmi2Aq9qUoWef0Ek4LpwCw0C4jYTFz9Uf6OnxXQ8dISkRWkEFM8eJJBTlYczVGdS3w9Xbd7d4kxYLUB6RfwLo8Vb4E5lJTEr9IyTtniJsBT/udeBwYQGPZBHPQg3hTHXt6ljMQYS9sMCcRnv1O8Gma8d2rV+I3HjEBVdUogIU0bk+5kDBlH2laj/tfykq1JBaARinzFRCuZoI5PQdwf/qPJzNIxB8dFjZvqAhTENJjrlg248pARc4vV9uePkuHMviCyzgYvvHCMGkbZJq1bl7CtqXk5fwBoGwGKVGedop6hC3ots210ns5Nh5FGxOXjhIIekAUpMIgetJs0UvM47PlpugoHGNkiDRQ0pjErCug4Ab3Oulwfgi5gFJM+hmPTReavvVcpN6ERM3iDt3cOzyNjcTwHBA/nkH44b6EUgqIAT5zQlEhrhh2D28hVoPL+hlXTUzodwdiadUiKtiMcqdkhVJqj2GeEiW+Sl0MQtOT1vftSCKsiHBM9gUW1/yOmqZ3kB2BtBHSd6LU6bAR4LazyeQeks3nWP7rZ9Yemue/eTGvFn3o/YSxqebFmBQP42zew2sdyHaQqC+e747pGMLSWCtpYgy6Yr7x9pIhc5Ct4v2yq/rGum9PWSOYZM3DGF0luxFXpBgcDfr0/L9fxlqWoRssfV/uniGa8Sy+qpXgNz9UFudMmuRM/c1+yVqApmBILFRsuczvS9+LyEcYKzRZBIp7z5uUL/sQne0dbWfmiecoyHV5FmVHrIKZBMzSOL1/2M6b5eTwuhG4v7BbVnhwcEDPsb5HOQWbrJ5Cmd/8UTbcv+uue4iNw54gH45DmX8TiY/N3ZVAXfWZSxf46vS6BOEd+ZZE/CWzQMaZaqFw3dPxwtDSr2E0Beyg01Uk6rCgga5CjlmSP5tJcC+CRU9qntlN9MbfJsE9p/ISbQudD4r5Glst4nWj01rorsHd/3r8LHBCaM4FbRB1ARmQruAVnfciNrUJhK1syymNsh0/jmTk1IAhKgMlWqAGOcz4CrUPMZBk82a8bnzAwR5+Vc7wU2hFu53y5rA7Rx8bqypG7rdKHAmxJXWa/tOgFtYYkoq997EnuASro7nSQuytuykJ0uwpaZyp2fnjDNq2YThSam/aaSzCA2SLZriBGNGP5B8AUI/iA36Eb/26OmTr1gj98AoMOtYr2P2s7hHX03XubJkMnXzO/KK44I5Tv1WB8OcSXmIO+JFA+4RpkjWI00NcskQ5IuqldFcinvr9QYYLaxrSiaSPT5S4Zb+mFjod/eMimWcyeFlTTnKHwNvoSyUmH16NHrmAazVwd8sXJdzFcPmr6OPpDqVfAK+n//9C3/+J9gjPmKHczF/VOKafCvqYOPg9iw4V0xiZnCiNoUcT1T/bZk807maiwvlPejinksA5PF3BpH34hg5VDHzq1DxBGJrPnl65ud8+L65T53ONtHlZsOAR0TL6W1kN4YjkloJD1NlspacbVsYK2rYvvQsmZc+4ZLQAQlW+AbqL7Occ0t53OIDqmxYealM8IuGF1Mr6v3g8/zb+m//BaAxF3WHKXRlUulFQJ34LV1MQUJrNfRUgd3ajh+8SmLSUYAe9SlC0fKeUhWNtni2emd9zKWUJwpzVrsW/1+FcKr4o/DsYaZNDDo1ShNT7Nnxm13YTu+bZKSa3mqv3OOSAgm+Oi47uzCS81hMldTJIDcYzWQ21i5fEIhS+WeP6VWw23Rmf/JZoE99S2weKge4USVCBFYZh944ljDyw0f7oDA5A=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 477, 'candidates_token_count': 177, 'total_token_count': 1657, 'prompt_tokens_details': [{'modality': 1, 'token_count': 477}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 177}], 'thoughts_token_count': 1003, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4655094470007945, 'model_name': 'gemini-2.5-pro'} id='run--defcd4f3-fefd-4b54-835f-e76e4ae6fc38-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import pytest\nfrom astropy.utils import misc\n\n\ndef test_inherit_docstrings_on_properties():\n    """\n    Regression test for an issue where docstrings were not being\n    inherited for properties because inspect.isfunction() returns\n    False for properties.\n    """\n    class Base(metaclass=misc.InheritDocstrings):\n        @property\n        def foo(self):\n            """The docstring for foo."""\n            return 1\n\n    class Sub(Base):\n        @property\n        def foo(self):\n            return 2\n\n    if Base.foo.__doc__ is not None:\n        assert Sub.foo.__doc__ == "The docstring for foo."\n', 'relative_path': 'astropy/utils/tests/test_inherit_docstrings.py'}, 'id': '3be46b42-4323-43ee-b296-724e75a23170', 'type': 'tool_call'}] usage_metadata={'input_tokens': 477, 'output_tokens': 177, 'total_tokens': 1657, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1003}}
2025-12-21 19:11:04,431 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/utils/tests/test_inherit_docstrings.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 679, 'candidates_token_count': 15, 'total_token_count': 694, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1682}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 15}], 'thoughts_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.175504923798144e-05, 'model_name': 'gemini-2.5-pro'} id='run--02126502-344c-48ea-864a-846b52b646ad-0' usage_metadata={'input_tokens': 679, 'output_tokens': 15, 'total_tokens': 694, 'input_token_details': {'cache_read': 0}}
2025-12-21 19:11:04,698 - thread-130546514527936.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/utils/tests/test_inherit_docstrings.py b/astropy/utils/tests/test_inherit_docstrings.py
new file mode 100644
index 0000000000..f7adffec51
--- /dev/null
+++ b/astropy/utils/tests/test_inherit_docstrings.py
@@ -0,0 +1,23 @@
+import pytest
+from astropy.utils import misc
+
+
+def test_inherit_docstrings_on_properties():
+    """
+    Regression test for an issue where docstrings were not being
+    inherited for properties because inspect.isfunction() returns
+    False for properties.
+    """
+    class Base(metaclass=misc.InheritDocstrings):
+        @property
+        def foo(self):
+            """The docstring for foo."""
+            return 1
+
+    class Sub(Base):
+        @property
+        def foo(self):
+            return 2
+
+    if Base.foo.__doc__ is not None:
+        assert Sub.foo.__doc__ == "The docstring for foo."

2025-12-21 19:11:04,700 - thread-130546514527936.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-12-21 19:11:04,734 - thread-130546514527936.app.docker.base_container - INFO - Resetting git repository in the container
2025-12-21 19:11:04,734 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-12-21 19:11:05,491 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 19:11:05,491 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:

HEAD is now at 26d147868f Merge pull request #7098 from lpsinger/wcsaxes-zorder

2025-12-21 19:11:05,491 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-12-21 19:11:05,592 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 19:11:05,592 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:


2025-12-21 19:11:05,593 - thread-130546514527936.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 19:11:05,593 - thread-130546514527936.app.docker.base_container - INFO - Creating directory astropy/utils/tests in the container
2025-12-21 19:11:05,593 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/utils/tests
2025-12-21 19:11:05,694 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 19:11:05,694 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:


2025-12-21 19:11:05,695 - thread-130546514527936.app.docker.base_container - INFO - Updating astropy/utils/tests/test_inherit_docstrings.py in the container
2025-12-21 19:11:05,705 - thread-130546514527936.app.docker.base_container - INFO - Files updated successfully
2025-12-21 19:11:07,191 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls -F"}'}, '__gemini_function_call_thought_signatures__': {'3a58c79a-39c7-4820-beb4-c8ef4d0ad5cb': 'Ct4CAY89a19Eu5M6TzvZ7HeB3pmR8CWJ/SwCrlhSC2J4aKin0m+Og09F9N/SGEb3CK2QACBN7el0vArtGYHG6TyGzfMsgvAJyfx0r30wc1tK0FpuWfxTlMgYdbZTm/eJ3xFgypAVxJXyPHk+fkvS1EUWgq+M27/hyzpS/1UZGYd50JYolgQlpQYXgf55+XbJgYv01jvQeNV1WWOopThBsF8uX+huauD53I4hcz/3DtoAVVIVRgRSnm8WkBtkPYIb8W6F8ctBa4IWMOG7t+Xrl2PfTYrEGt2bD99G4vRsjBp6W3elEEwt6NUKQrmTPF0jJsW3xle0/hAOurVIJSuvpm09bEpPINYHeCc5MnEs62V20drT437JN9zUv/vl+vKtG/xEkrO3u+K+YzDNQAnp+FCs7tTCM7ypCBy/Y94dIhAH+Q28B3BjrqtkeUmQFmSxGL7bjW4Hox7TRBbY3LI9Lic='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 266, 'candidates_token_count': 7, 'total_token_count': 350, 'prompt_tokens_details': [{'modality': 1, 'token_count': 266}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 7}], 'thoughts_token_count': 77, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8528470311846051, 'model_name': 'gemini-2.5-pro'} id='run--64051ff0-c8a9-4745-b887-be693d3a05f2-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls -F'}, 'id': '3a58c79a-39c7-4820-beb4-c8ef4d0ad5cb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 266, 'output_tokens': 7, 'total_tokens': 350, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 77}}
2025-12-21 19:11:07,193 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: ls -F
2025-12-21 19:11:07,295 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 19:11:07,295 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:

CHANGES.rst	    __pycache__/       cextern/		 pip-requirements-dev
CITATION	    ah_bootstrap.py    conftest.py	 pip-requirements-doc
CODE_OF_CONDUCT.md  appveyor.yml       docs/		 readthedocs.yml
CONTRIBUTING.md     astropy/	       examples/	 setup.cfg
LICENSE.rst	    astropy.egg-info/  ez_setup.py	 setup.py*
MANIFEST.in	    astropy_helpers/   licenses/	 static/
README.rst	    build/	       pip-requirements

2025-12-21 19:11:08,931 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/utils/tests/test_inherit_docstrings.py"}'}, '__gemini_function_call_thought_signatures__': {'9acbdddb-1a9c-4452-a18d-7ff6a7f30bf8': 'Cu8CAY89a18uvP6gxiY3vi8LOeSzLKJ+eYF8Q4f9dDoqY8+RXxrWZAqFeMD8NdhPWPIYRa5F9y0P0gwmL5Iq8HSa5HvMwi9dum/238tmosjoiCV+UPqP21S2tNWydM5VLaULVA/ngN63ljjv1z4HK20n+6RI2OM1mfhhI22xSz80Oy0Y16eG6p9w3c+cuDMfbzeF9eJEy2PjrDryShdQYFbJf9uVYacgI+fFMX8o/QhI+oCvEyIw8HAIKOsznAvm/GL367hZsof/AailFUp6YCxtz3qtgHwFVnAZZUqTclFCfvmAbXQd/XXqhlWeei0t28QgXBWs+suP+9apnRZTAILkA/oDwwbblPgNfONbJ+DibeZ0wER96BKOduKlB3TrsMHgf6f2zmdKHTmibAdYkT3j337mL4YK9eyoXqkWj3aVyIks+10T4wCcmK+DHhTeDuX8CEXEaIYzEZloQNl0I4SPwlMLVAIDWsQszJVsFx5LcA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 412, 'candidates_token_count': 20, 'total_token_count': 518, 'prompt_tokens_details': [{'modality': 1, 'token_count': 489}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 86, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4025712966918945, 'model_name': 'gemini-2.5-pro'} id='run--da697590-ec06-4ff6-a6ad-6fde65ed9275-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/utils/tests/test_inherit_docstrings.py'}, 'id': '9acbdddb-1a9c-4452-a18d-7ff6a7f30bf8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 412, 'output_tokens': 20, 'total_tokens': 518, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 86}}
2025-12-21 19:11:08,934 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: pytest astropy/utils/tests/test_inherit_docstrings.py
2025-12-21 19:11:10,827 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 19:11:10,828 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:
pytest astropy/utils/tests/test_inherit_doc
cstrings.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.6.13, pytest-3.3.1, py-1.11.0, pluggy-0.6.0

Running tests with Astropy version 3.1.dev21446.
Running tests in astropy/utils/tests/test_inherit_docstrings.py.

Date: 2025-12-21T19:11:10

Platform: Linux-6.8.0-36-generic-x86_64-with-debian-bookworm-sid

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
[GCC 7.5.0]

encodings: sys: utf-8, locale: ANSI_X3.4-1968, filesystem: ascii
byteorder: little
float info: dig: 15, mant_dig: 15

Numpy: 1.16.0
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
Cython: 0.27.3
Using Astropy options: remote_data: none.

rootdir: /testbed, inifile: setup.cfg
plugins: xdist-1.20.1, remotedata-0.2.0, openfiles-0.2.0, mock-1.6.3, forked-0.2, filter-subpackage-0.1, doctestplus-0.1.2, cov-2.5.1, astropy-header-0.1, arraydiff-0.1, hypothesis-3.44.2
[1m
collecting 0 items                                                             [0m[1m
collecting 0 items                                                             [0m[1m
collecting 1 item                                                              [0m[1m
collected 1 item                                                               [0m

astropy/utils/tests/test_inherit_docstrings.py F[36m                         [100%][0m

=================================== FAILURES ===================================
[31m[1m____________________ test_inherit_docstrings_on_properties _____________________[0m

[1m    def test_inherit_docstrings_on_properties():[0m
[1m        """[0m
[1m        Regression test for an issue where docstrings were not being[0m
[1m        inherited for properties because inspect.isfunction() returns[0m
[1m        False for properties.[0m
[1m        """[0m
[1m        class Base(metaclass=misc.InheritDocstrings):[0m
[1m            @property[0m
[1m            def foo(self):[0m
[1m                """The docstring for foo."""[0m
[1m                return 1[0m
[1m    [0m
[1m        class Sub(Base):[0m
[1m            @property[0m
[1m            def foo(self):[0m
[1m                return 2[0m
[1m    [0m
[1m        if Base.foo.__doc__ is not None:[0m
[1m>           assert Sub.foo.__doc__ == "The docstring for foo."[0m
[1m[31mE           AssertionError: assert None == 'The docstring for foo.'[0m
[1m[31mE            +  where None = <property object at 0x7c0b99091098>.__doc__[0m
[1m[31mE            +    where <property object at 0x7c0b99091098> = <class 'astropy.utils.tests.test_inherit_docstrings.test_inherit_docstrings_on_properties.<locals>.Sub'>.foo[0m

[1m[31mastropy/utils/tests/test_inherit_docstrings.py[0m:23: AssertionError
[33m=============================== warnings summary ===============================[0m
None
  Module already imported so cannot be rewritten: astropy.tests.plugins.display

-- Docs: http://doc.pytest.org/en/latest/warnings.html
[31m[1m===================== 1 failed, 1 warnings in 0.11 seconds =====================[0m

2025-12-21 19:11:17,912 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='============================= test session starts ==============================\nplatform linux -- Python 3.6.13, pytest-3.3.1, py-1.11.0, pluggy-0.6.0\nRunning tests with Astropy version 3.1.dev21446.\nRunning tests in astropy/utils/tests/test_inherit_docstrings.py.\nDate: 2025-12-21T19:11:10\nPlatform: Linux-6.8.0-36-generic-x86_64-with-debian-bookworm-sid\nExecutable: /opt/miniconda3/envs/testbed/bin/python\nFull Python Version: \n3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) \n[GCC 7.5.0]\nencodings: sys: utf-8, locale: ANSI_X3.4-1968, filesystem: ascii\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\nNumpy: 1.16.0\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nCython: 0.27.3\nUsing Astropy options: remote_data: none.\nrootdir: /testbed, inifile: setup.cfg\nplugins: xdist-1.20.1, remotedata-0.2.0, openfiles-0.2.0, mock-1.6.3, forked-0.2, filter-subpackage-0.1, doctestplus-0.1.2, cov-2.5.1, astropy-header-0.1, arraydiff-0.1, hypothesis-3.44.2\ncollecting 0 items                                                             \ncollecting 0 items                                                             \ncollecting 1 item                                                              \ncollected 1 item                                                               \nastropy/utils/tests/test_inherit_docstrings.py F                         [100%]\n=================================== FAILURES ===================================\n____________________ test_inherit_docstrings_on_properties _____________________\n    def test_inherit_docstrings_on_properties():\n        """\n        Regression test for an issue where docstrings were not being\n        inherited for properties because inspect.isfunction() returns\n        False for properties.\n        """\n        class Base(metaclass=misc.InheritDocstrings):\n            @property\n            def foo(self):\n                """The docstring for foo."""\n                return 1\n        class Sub(Base):\n            @property\n            def foo(self):\n                return 2\n        if Base.foo.__doc__ is not None:\n>           assert Sub.foo.__doc__ == "The docstring for foo."\nE           AssertionError: assert None == \'The docstring for foo.\'\nE            +  where None = <property object at 0x7c0b99091098>.__doc__\nE            +    where <property object at 0x7c0b99091098> = <class \'astropy.utils.tests.test_inherit_docstrings.test_inherit_docstrings_on_properties.<locals>.Sub\'>.foo\nastropy/utils/tests/test_inherit_docstrings.py:23: AssertionError\n=============================== warnings summary ===============================\nNone\n  Module already imported so cannot be rewritten: astropy.tests.plugins.display\n-- Docs: http://doc.pytest.org/en/latest/warnings.html\n===================== 1 failed, 1 warnings in 0.11 seconds =====================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1530, 'candidates_token_count': 852, 'total_token_count': 2435, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1693}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 852}], 'thoughts_token_count': 53, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.006569275833631346, 'model_name': 'gemini-2.5-pro'} id='run--5383b2f1-9181-4ecf-b7da-ab164bc933e1-0' usage_metadata={'input_tokens': 1530, 'output_tokens': 852, 'total_tokens': 2435, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 53}}
2025-12-21 19:11:31,258 - thread-130546514527936.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='\nCHANGES.rst\t    __pycache__/       cextern/\t\t pip-requirements-dev\nCITATION\t    ah_bootstrap.py    conftest.py\t pip-requirements-doc\nCODE_OF_CONDUCT.md  appveyor.yml       docs/\t\t readthedocs.yml\nCONTRIBUTING.md     astropy/\t       examples/\t setup.cfg\nLICENSE.rst\t    astropy.egg-info/  ez_setup.py\t setup.py*\nMANIFEST.in\t    astropy_helpers/   licenses/\t static/\nREADME.rst\t    build/\t       pip-requirements\n\n\nTool output: pytest astropy/utils/tests/test_inherit_doc\ncstrings.py\n\n============================= test session starts ==============================\nplatform linux -- Python 3.6.13, pytest-3.3.1, py-1.11.0, pluggy-0.6.0\n\nRunning tests with Astropy version 3.1.dev21446.\nRunning tests in astropy/utils/tests/test_inherit_docstrings.py.\n\nDate: 2025-12-21T19:11:10\n\nPlatform: Linux-6.8.0-36-generic-x86_64-with-debian-bookworm-sid\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) \n[GCC 7.5.0]\n\nencodings: sys: utf-8, locale: ANSI_X3.4-1968, filesystem: ascii\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nNumpy: 1.16.0\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nCython: 0.27.3\nUsing Astropy options: remote_data: none.\n\nrootdir: /testbed, inifile: setup.cfg\nplugins: xdist-1.20.1, remotedata-0.2.0, openfiles-0.2.0, mock-1.6.3, forked-0.2, filter-subpackage-0.1, doctestplus-0.1.2, cov-2.5.1, astropy-header-0.1, arraydiff-0.1, hypothesis-3.44.2\n\ncollecting 0 items                                                             \ncollecting 0 items                                                             \ncollecting 1 item                                                              \ncollected 1 item                                                               \n\nastropy/utils/tests/test_inherit_docstrings.py F                         [100%]\n\n=================================== FAILURES ===================================\n____________________ test_inherit_docstrings_on_properties _____________________\n\n    def test_inherit_docstrings_on_properties():\n        """\n        Regression test for an issue where docstrings were not being\n        inherited for properties because inspect.isfunction() returns\n        False for properties.\n        """\n        class Base(metaclass=misc.InheritDocstrings):\n            @property\n            def foo(self):\n                """The docstring for foo."""\n                return 1\n    \n        class Sub(Base):\n            @property\n            def foo(self):\n                return 2\n    \n        if Base.foo.__doc__ is not None:\n>           assert Sub.foo.__doc__ == "The docstring for foo."\nE           AssertionError: assert None == \'The docstring for foo.\'\nE            +  where None = <property object at 0x7c0b99091098>.__doc__\nE            +    where <property object at 0x7c0b99091098> = <class \'astropy.utils.tests.test_inherit_docstrings.test_inherit_docstrings_on_properties.<locals>.Sub\'>.foo\n\nastropy/utils/tests/test_inherit_docstrings.py:23: AssertionError\n=============================== warnings summary ===============================\nNone\n  Module already imported so cannot be rewritten: astropy.tests.plugins.display\n\n-- Docs: http://doc.pytest.org/en/latest/warnings.html\n===================== 1 failed, 1 warnings in 0.11 seconds =====================' reproduced_bug_commands=['pytest astropy/utils/tests/test_inherit_docstrings.py']
2025-12-21 19:11:31,260 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Starting dual-version validation
2025-12-21 19:11:31,260 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on old codebase (should fail)
2025-12-21 19:11:31,260 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: pytest astropy/utils/tests/test_inherit_docstrings.py
2025-12-21 19:11:32,640 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 1
2025-12-21 19:11:32,640 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:
pytest astropy/utils/tests/test_inherit_doc
cstrings.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.6.13, pytest-3.3.1, py-1.11.0, pluggy-0.6.0

Running tests with Astropy version 3.1.dev21446.
Running tests in astropy/utils/tests/test_inherit_docstrings.py.

Date: 2025-12-21T19:11:32

Platform: Linux-6.8.0-36-generic-x86_64-with-debian-bookworm-sid

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
[GCC 7.5.0]

encodings: sys: utf-8, locale: ANSI_X3.4-1968, filesystem: ascii
byteorder: little
float info: dig: 15, mant_dig: 15

Numpy: 1.16.0
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
Cython: 0.27.3
Using Astropy options: remote_data: none.

rootdir: /testbed, inifile: setup.cfg
plugins: xdist-1.20.1, remotedata-0.2.0, openfiles-0.2.0, mock-1.6.3, forked-0.2, filter-subpackage-0.1, doctestplus-0.1.2, cov-2.5.1, astropy-header-0.1, arraydiff-0.1, hypothesis-3.44.2
[1m
collecting 0 items                                                             [0m[1m
collecting 0 items                                                             [0m[1m
collecting 1 item                                                              [0m[1m
collected 1 item                                                               [0m

astropy/utils/tests/test_inherit_docstrings.py F[36m                         [100%][0m

=================================== FAILURES ===================================
[31m[1m____________________ test_inherit_docstrings_on_properties _____________________[0m

[1m    def test_inherit_docstrings_on_properties():[0m
[1m        """[0m
[1m        Regression test for an issue where docstrings were not being[0m
[1m        inherited for properties because inspect.isfunction() returns[0m
[1m        False for properties.[0m
[1m        """[0m
[1m        class Base(metaclass=misc.InheritDocstrings):[0m
[1m            @property[0m
[1m            def foo(self):[0m
[1m                """The docstring for foo."""[0m
[1m                return 1[0m
[1m    [0m
[1m        class Sub(Base):[0m
[1m            @property[0m
[1m            def foo(self):[0m
[1m                return 2[0m
[1m    [0m
[1m        if Base.foo.__doc__ is not None:[0m
[1m>           assert Sub.foo.__doc__ == "The docstring for foo."[0m
[1m[31mE           AssertionError: assert None == 'The docstring for foo.'[0m
[1m[31mE            +  where None = <property object at 0x755b090e76d8>.__doc__[0m
[1m[31mE            +    where <property object at 0x755b090e76d8> = <class 'astropy.utils.tests.test_inherit_docstrings.test_inherit_docstrings_on_properties.<locals>.Sub'>.foo[0m

[1m[31mastropy/utils/tests/test_inherit_docstrings.py[0m:23: AssertionError
[33m=============================== warnings summary ===============================[0m
None
  Module already imported so cannot be rewritten: astropy.tests.plugins.display

-- Docs: http://doc.pytest.org/en/latest/warnings.html
[31m[1m===================== 1 failed, 1 warnings in 0.10 seconds =====================[0m

2025-12-21 19:11:32,640 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Test failed on old codebase (as expected)
2025-12-21 19:11:32,640 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Applying patch to repository
2025-12-21 19:11:32,645 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Updating container with patched code
2025-12-21 19:11:32,645 - thread-130546514527936.app.docker.base_container - INFO - Updating files in the container after edits.
2025-12-21 19:11:32,645 - thread-130546514527936.app.docker.base_container - INFO - Creating directory astropy/utils in the container
2025-12-21 19:11:32,645 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/utils
2025-12-21 19:11:32,747 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 19:11:32,747 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:


2025-12-21 19:11:32,747 - thread-130546514527936.app.docker.base_container - INFO - Updating astropy/utils/misc.py in the container
2025-12-21 19:11:32,758 - thread-130546514527936.app.docker.base_container - INFO - Files updated successfully
2025-12-21 19:11:32,758 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Running test on patched codebase (should pass)
2025-12-21 19:11:32,758 - thread-130546514527936.app.docker.base_container - DEBUG - Executing command: pytest astropy/utils/tests/test_inherit_docstrings.py
2025-12-21 19:11:34,111 - thread-130546514527936.app.docker.base_container - DEBUG - Command exit code: 0
2025-12-21 19:11:34,112 - thread-130546514527936.app.docker.base_container - DEBUG - Command output:
pytest astropy/utils/tests/test_inherit_doc
cstrings.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.6.13, pytest-3.3.1, py-1.11.0, pluggy-0.6.0

Running tests with Astropy version 3.1.dev21446.
Running tests in astropy/utils/tests/test_inherit_docstrings.py.

Date: 2025-12-21T19:11:33

Platform: Linux-6.8.0-36-generic-x86_64-with-debian-bookworm-sid

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.6.13 |Anaconda, Inc.| (default, Jun  4 2021, 14:25:59) 
[GCC 7.5.0]

encodings: sys: utf-8, locale: ANSI_X3.4-1968, filesystem: ascii
byteorder: little
float info: dig: 15, mant_dig: 15

Numpy: 1.16.0
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
Cython: 0.27.3
Using Astropy options: remote_data: none.

rootdir: /testbed, inifile: setup.cfg
plugins: xdist-1.20.1, remotedata-0.2.0, openfiles-0.2.0, mock-1.6.3, forked-0.2, filter-subpackage-0.1, doctestplus-0.1.2, cov-2.5.1, astropy-header-0.1, arraydiff-0.1, hypothesis-3.44.2
[1m
collecting 0 items                                                             [0m[1m
collecting 0 items                                                             [0m[1m
collecting 1 item                                                              [0m[1m
collected 1 item                                                               [0m

astropy/utils/tests/test_inherit_docstrings.py .[36m                         [100%][0m

[33m=============================== warnings summary ===============================[0m
None
  Module already imported so cannot be rewritten: astropy.tests.plugins.display

-- Docs: http://doc.pytest.org/en/latest/warnings.html
[33m[1m===================== 1 passed, 1 warnings in 0.08 seconds =====================[0m

2025-12-21 19:11:34,112 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Resetting repository to clean state
2025-12-21 19:11:34,139 - thread-130546514527936.app.lang_graph.nodes.dual_version_validation_node - INFO - Validation PASSED: Test fails on old, passes on new
2025-12-21 19:11:34,140 - thread-130546514527936.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-12-21 19:11:34,140 - thread-130546514527936.app.docker.base_container - INFO - Closing persistent shell...
2025-12-21 19:11:34,240 - thread-130546514527936.app.docker.base_container - INFO - Cleaning up container and temporary files
