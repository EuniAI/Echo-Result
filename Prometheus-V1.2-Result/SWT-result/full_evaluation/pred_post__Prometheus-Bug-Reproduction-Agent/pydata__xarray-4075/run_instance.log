2025-12-07 15:21:55,185 - WARNING - Starting evaluation at 1765120915.1857884
2025-12-07 15:21:55,237 - INFO - Creating container for pydata__xarray-4075...
2025-12-07 15:21:55,256 - INFO - Container for pydata__xarray-4075 created: ff5d86f4685c959484f35c87b24b0e93906762fc20ef59d483972106da9cdab9
2025-12-07 15:21:55,436 - INFO - Container for pydata__xarray-4075 started: ff5d86f4685c959484f35c87b24b0e93906762fc20ef59d483972106da9cdab9
2025-12-07 15:21:55,578 - INFO - Git diff before:

2025-12-07 15:21:55,579 - INFO - Eval script for pydata__xarray-4075 written to eval.sh, now applying to container...
2025-12-07 15:22:13,307 - INFO - Test output for pydata__xarray-4075 written to run_instance_swt_logs/full_evaluation/pred_post__Prometheus-Bug-Reproduction-Agent/pydata__xarray-4075/test_output.txt
2025-12-07 15:22:13,386 - INFO - Git diff after:
diff --git a/xarray/core/weighted.py b/xarray/core/weighted.py
index 996d2e4c..21ed06ea 100644
--- a/xarray/core/weighted.py
+++ b/xarray/core/weighted.py
@@ -142,7 +142,14 @@ class Weighted:
         # we need to mask data values that are nan; else the weights are wrong
         mask = da.notnull()
 
-        sum_of_weights = self._reduce(mask, self.weights, dim=dim, skipna=False)
+        # bool -> int, because ``xr.dot([True, True], [True, True])`` -> True
+        # (and not 2); GH4074
+        if self.weights.dtype == bool:
+            sum_of_weights = self._reduce(
+                mask, self.weights.astype(int), dim=dim, skipna=False
+            )
+        else:
+            sum_of_weights = self._reduce(mask, self.weights, dim=dim, skipna=False)
 
         # 0-weights are not valid
         valid_weights = sum_of_weights != 0.0
2025-12-07 15:22:13,386 - INFO - Git diff changed after running eval script
2025-12-07 15:22:13,386 - INFO - Attempting to stop container exec.eval.x86_64.bd0581d44706317407e86a.1ba5104be995dab7a89bc8.124396453871152...
2025-12-07 15:22:28,592 - INFO - Attempting to remove container exec.eval.x86_64.bd0581d44706317407e86a.1ba5104be995dab7a89bc8.124396453871152...
2025-12-07 15:22:28,610 - INFO - Container exec.eval.x86_64.bd0581d44706317407e86a.1ba5104be995dab7a89bc8.124396453871152 removed.
2025-12-07 15:22:28,610 - WARNING - End of eval at 1765120948.6101844
