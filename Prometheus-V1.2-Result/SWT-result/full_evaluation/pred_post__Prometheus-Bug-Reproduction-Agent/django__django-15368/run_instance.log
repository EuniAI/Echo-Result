2025-12-07 14:11:54,367 - WARNING - Starting evaluation at 1765116714.367194
2025-12-07 14:11:54,412 - INFO - Creating container for django__django-15368...
2025-12-07 14:11:54,435 - INFO - Container for django__django-15368 created: 837cf916bafcb17e4077981a30fbee50d5f1c6b97b36880b11c894a41c19b4b0
2025-12-07 14:11:54,603 - INFO - Container for django__django-15368 started: 837cf916bafcb17e4077981a30fbee50d5f1c6b97b36880b11c894a41c19b4b0
2025-12-07 14:11:55,747 - INFO - Git diff before:

2025-12-07 14:11:55,747 - INFO - Eval script for django__django-15368 written to eval.sh, now applying to container...
2025-12-07 14:12:07,332 - INFO - Test output for django__django-15368 written to run_instance_swt_logs/full_evaluation/pred_post__Prometheus-Bug-Reproduction-Agent/django__django-15368/test_output.txt
2025-12-07 14:12:07,417 - INFO - Git diff after:
diff --git a/django/db/models/query.py b/django/db/models/query.py
index f8d848e926..e20c46075e 100644
--- a/django/db/models/query.py
+++ b/django/db/models/query.py
@@ -17,7 +17,7 @@ from django.db import (
 from django.db.models import AutoField, DateField, DateTimeField, sql
 from django.db.models.constants import LOOKUP_SEP, OnConflict
 from django.db.models.deletion import Collector
-from django.db.models.expressions import Case, Expression, F, Ref, Value, When
+from django.db.models.expressions import Case, F, Ref, Value, When
 from django.db.models.functions import Cast, Trunc
 from django.db.models.query_utils import FilteredRelation, Q
 from django.db.models.sql.constants import CURSOR, GET_ITERATOR_CHUNK_SIZE
@@ -670,7 +670,7 @@ class QuerySet:
                 when_statements = []
                 for obj in batch_objs:
                     attr = getattr(obj, field.attname)
-                    if not isinstance(attr, Expression):
+                    if not hasattr(attr, 'resolve_expression'):
                         attr = Value(attr, output_field=field)
                     when_statements.append(When(pk=obj.pk, then=attr))
                 case_statement = Case(*when_statements, output_field=field)
2025-12-07 14:12:07,417 - INFO - Git diff changed after running eval script
2025-12-07 14:12:07,418 - INFO - Attempting to stop container exec.eval.x86_64.6b24dca158642bd6288384.846f7f04ddbf0436f84ba7.124396453813600...
2025-12-07 14:12:22,653 - INFO - Attempting to remove container exec.eval.x86_64.6b24dca158642bd6288384.846f7f04ddbf0436f84ba7.124396453813600...
2025-12-07 14:12:22,682 - INFO - Container exec.eval.x86_64.6b24dca158642bd6288384.846f7f04ddbf0436f84ba7.124396453813600 removed.
2025-12-07 14:12:22,682 - WARNING - End of eval at 1765116742.6826565
