+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git diff HEAD 55bcbd8d172b689811fae17cde2f09218dd74e9c
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch main
nothing to commit, working tree clean
+ git show
commit 55bcbd8d172b689811fae17cde2f09218dd74e9c
Author: Ekaterina Vahrusheva <lajilit@gmail.com>
Date:   Thu Mar 2 21:38:05 2023 +0300

    Fixed #34378 -- Made QuerySet.in_bulk() not clear odering when id_list is passed.
    
    This reverts 340eaded4e30cf25bcd4e9781d33a617fe9c0f84.

diff --git a/django/db/models/query.py b/django/db/models/query.py
index 71bb088679..6ac2a4cb10 100644
--- a/django/db/models/query.py
+++ b/django/db/models/query.py
@@ -1108,9 +1108,9 @@ class QuerySet(AltersData):
                 qs = ()
                 for offset in range(0, len(id_list), batch_size):
                     batch = id_list[offset : offset + batch_size]
-                    qs += tuple(self.filter(**{filter_key: batch}).order_by())
+                    qs += tuple(self.filter(**{filter_key: batch}))
             else:
-                qs = self.filter(**{filter_key: id_list}).order_by()
+                qs = self.filter(**{filter_key: id_list})
         else:
             qs = self._chain()
         return {getattr(obj, field_name): obj for obj in qs}
diff --git a/tests/lookup/tests.py b/tests/lookup/tests.py
index 53eb76d174..9778eaa5c5 100644
--- a/tests/lookup/tests.py
+++ b/tests/lookup/tests.py
@@ -246,6 +246,35 @@ class LookupTests(TestCase):
         with self.assertRaisesMessage(ValueError, msg):
             Article.objects.in_bulk([self.au1], field_name="author")
 
+    @skipUnlessDBFeature("can_distinct_on_fields")
+    def test_in_bulk_preserve_ordering(self):
+        articles = (
+            Article.objects.order_by("author_id", "-pub_date")
+            .distinct("author_id")
+            .in_bulk([self.au1.id, self.au2.id], field_name="author_id")
+        )
+        self.assertEqual(
+            articles,
+            {self.au1.id: self.a4, self.au2.id: self.a5},
+        )
+
+    @skipUnlessDBFeature("can_distinct_on_fields")
+    def test_in_bulk_preserve_ordering_with_batch_size(self):
+        old_max_query_params = connection.features.max_query_params
+        connection.features.max_query_params = 1
+        try:
+            articles = (
+                Article.objects.order_by("author_id", "-pub_date")
+                .distinct("author_id")
+                .in_bulk([self.au1.id, self.au2.id], field_name="author_id")
+            )
+            self.assertEqual(
+                articles,
+                {self.au1.id: self.a4, self.au2.id: self.a5},
+            )
+        finally:
+            connection.features.max_query_params = old_max_query_params
+
     @skipUnlessDBFeature("can_distinct_on_fields")
     def test_in_bulk_distinct_field(self):
         self.assertEqual(
+ git diff 55bcbd8d172b689811fae17cde2f09218dd74e9c
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ python -m pip install -e .
Obtaining file:///testbed
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: asgiref>=3.6.0 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from Django==5.0.dev20230303050010) (3.10.0)
Requirement already satisfied: sqlparse>=0.2.2 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from Django==5.0.dev20230303050010) (0.5.3)
Building wheels for collected packages: Django
  Building editable for Django (pyproject.toml): started
  Building editable for Django (pyproject.toml): finished with status 'done'
  Created wheel for Django: filename=django-5.0.dev20230303050010-0.editable-py3-none-any.whl size=27423 sha256=a070066f2c56fb282da234414d24dc904a5d97a0f53a8e7c431329703102e00e
  Stored in directory: /tmp/pip-ephem-wheel-cache-3thei4ho/wheels/49/5f/4f/01b7d31ea6ddac9643da788242d33e5fd3467d95d17b032c6b
Successfully built Django
Installing collected packages: Django
  Attempting uninstall: Django
    Found existing installation: Django 5.0.dev20230303050010
    Uninstalling Django-5.0.dev20230303050010:
      Successfully uninstalled Django-5.0.dev20230303050010
Successfully installed Django-5.0.dev20230303050010
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ git apply -v -
Checking patch django/contrib/admin/sites.py...
Applied patch django/contrib/admin/sites.py cleanly.
+ git apply -v -
Checking patch tests/admin_views/test_catchall_view.py...
Applied patch tests/admin_views/test_catchall_view.py cleanly.
+ python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(django/contrib/admin/sites\.py)' ./tests/runtests.py --verbosity 2 --settings=test_sqlite --parallel 1 admin_views.test_catchall_view
Creating test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...
['--count', '-C', 'coverage.cover', '--include-pattern', '/testbed/(django/contrib/admin/sites\\.py)']
Testing against Django installed in '/testbed/django'
Importing application admin_views
Found 1 test(s).
Skipping setup of unused database(s): other.
Operations to perform:
  Synchronize unmigrated apps: admin_views, auth, contenttypes, messages, sessions, staticfiles
  Apply all migrations: admin, sites
Synchronizing apps without migrations:
  Creating tables...
    Creating table django_content_type
    Creating table auth_permission
    Creating table auth_group
    Creating table auth_user
    Creating table django_session
    Creating table admin_views_section
    Creating table admin_views_article
    Creating table admin_views_book
    Creating table admin_views_promo
    Creating table admin_views_chapter
    Creating table admin_views_chapterxtra1
    Creating table admin_views_chapterxtra2
    Creating table admin_views_rowlevelchangepermissionmodel
    Creating table admin_views_customarticle
    Creating table admin_views_modelwithstringprimarykey
    Creating table admin_views_color
    Creating table admin_views_thing
    Creating table admin_views_actor
    Creating table admin_views_inquisition
    Creating table admin_views_sketch
    Creating table admin_views_character
    Creating table admin_views_stumpjoke
    Creating table admin_views_fabric
    Creating table admin_views_person
    Creating table admin_views_persona
    Creating table admin_views_account
    Creating table admin_views_fooaccount
    Creating table admin_views_baraccount
    Creating table admin_views_subscriber
    Creating table admin_views_externalsubscriber
    Creating table admin_views_oldsubscriber
    Creating table admin_views_media
    Creating table admin_views_podcast
    Creating table admin_views_vodcast
    Creating table admin_views_parent
    Creating table admin_views_child
    Creating table admin_views_pkchild
    Creating table admin_views_toy
    Creating table admin_views_emptymodel
    Creating table admin_views_gallery
    Creating table admin_views_picture
    Creating table admin_views_language
    Creating table admin_views_title
    Creating table admin_views_titletranslation
    Creating table admin_views_recommender
    Creating table admin_views_recommendation
    Creating table admin_views_collector
    Creating table admin_views_widget
    Creating table admin_views_doohickey
    Creating table admin_views_grommet
    Creating table admin_views_whatsit
    Creating table admin_views_doodad
    Creating table admin_views_fancydoodad
    Creating table admin_views_category
    Creating table admin_views_link
    Creating table admin_views_prepopulatedpost
    Creating table admin_views_prepopulatedsubpost
    Creating table admin_views_post
    Creating table admin_views_gadget
    Creating table admin_views_villain
    Creating table admin_views_supervillain
    Creating table admin_views_funkytag
    Creating table admin_views_plot
    Creating table admin_views_plotdetails
    Creating table admin_views_secrethideout
    Creating table admin_views_supersecrethideout
    Creating table admin_views_bookmark
    Creating table admin_views_cyclicone
    Creating table admin_views_cyclictwo
    Creating table admin_views_topping
    Creating table admin_views_pizza
    Creating table admin_views_album
    Creating table admin_views_song
    Creating table admin_views_employee
    Creating table admin_views_workhour
    Creating table admin_views_manager
    Creating table admin_views_bonus
    Creating table admin_views_question
    Creating table admin_views_answer
    Creating table admin_views_reservation
    Creating table admin_views_fooddelivery
    Creating table admin_views_coverletter
    Creating table admin_views_paper
    Creating table admin_views_shortmessage
    Creating table admin_views_telegram
    Creating table admin_views_story
    Creating table admin_views_otherstory
    Creating table admin_views_complexsortedperson
    Creating table admin_views_pluggablesearchperson
    Creating table admin_views_prepopulatedpostlargeslug
    Creating table admin_views_adminorderedfield
    Creating table admin_views_adminorderedmodelmethod
    Creating table admin_views_adminorderedadminmethod
    Creating table admin_views_adminorderedcallable
    Creating table admin_views_report
    Creating table admin_views_mainprepopulated
    Creating table admin_views_relatedprepopulated
    Creating table admin_views_unorderedobject
    Creating table admin_views_undeletableobject
    Creating table admin_views_unchangeableobject
    Creating table admin_views_usermessenger
    Creating table admin_views_simple
    Creating table admin_views_choice
    Creating table admin_views_parentwithdependentchildren
    Creating table admin_views_dependentchild
    Creating table admin_views_filteredmanager
    Creating table admin_views_emptymodelvisible
    Creating table admin_views_emptymodelhidden
    Creating table admin_views_emptymodelmixin
    Creating table admin_views_state
    Creating table admin_views_city
    Creating table admin_views_restaurant
    Creating table admin_views_worker
    Creating table admin_views_referencedbyparent
    Creating table admin_views_parentwithfk
    Creating table admin_views_childofreferer
    Creating table admin_views_inlinereferer
    Creating table admin_views_referencedbyinline
    Creating table admin_views_inlinereference
    Creating table admin_views_recipe
    Creating table admin_views_ingredient
    Creating table admin_views_recipeingredient
    Creating table admin_views_notreferenced
    Creating table admin_views_explicitlyprovidedpk
    Creating table admin_views_implicitlygeneratedpk
    Creating table admin_views_referencedbygenrel
    Creating table admin_views_genrelreference
    Creating table admin_views_parentwithuuidpk
    Creating table admin_views_relatedwithuuidpkmodel
    Creating table admin_views_author
    Creating table admin_views_authorship
    Creating table admin_views_readonlyrelatedfield
    Creating table admin_views_h√©llo
    Creating table admin_views_box
    Creating table admin_views_country
    Creating table admin_views_traveler
    Running deferred SQL...
Running migrations:
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying sites.0001_initial... OK
  Applying sites.0002_alter_domain_unique... OK
System check identified no issues (1 silenced).
test_redirect_for_missing_slash_preserves_query_string (admin_views.test_catchall_view.AdminSiteFinalCatchAllPatternTests.test_redirect_for_missing_slash_preserves_query_string)
The catch-all view should preserve the query string when redirecting ... ok

----------------------------------------------------------------------
Ran 1 test in 2.389s

OK
Destroying test database for alias 'default' ('file:memorydb_default?mode=memory&cache=shared')...
+ cat coverage.cover
{"/testbed/django/contrib/admin/sites.py": {"0": 0, "1": 1, "2": 1, "4": 1, "5": 1, "6": 1, "7": 1, "8": 1, "9": 1, "10": 1, "11": 1, "12": 1, "13": 1, "14": 1, "15": 1, "16": 1, "17": 1, "18": 1, "19": 1, "20": 1, "21": 1, "22": 1, "23": 1, "25": 1, "28": 2, "32": 2, "36": 2, "600": 2, "613": 1, "29": 1, "33": 1, "46": 1, "49": 1, "52": 1, "55": 1, "57": 1, "59": 1, "61": 1, "62": 1, "63": 1, "64": 1, "65": 1, "66": 1, "67": 1, "69": 1, "71": 1, "78": 1, "81": 1, "99": 1, "150": 1, "163": 1, "169": 1, "177": 1, "183": 1, "190": 2, "191": 2, "197": 1, "204": 1, "251": 1, "315": 2, "316": 2, "319": 1, "342": 1, "360": 1, "374": 1, "383": 1, "405": 2, "406": 2, "443": 1, "446": 2, "447": 2, "461": 1, "533": 1, "549": 1, "570": 1, "594": 1, "72": 11, "73": 11, "74": 11, "75": 11, "76": 11, "79": 0, "86": 0, "87": 0, "88": 0, "90": 0, "91": 0, "92": 0, "94": 0, "95": 0, "96": 0, "97": 0, "113": 150, "114": 150, "115": 148, "116": 300, "117": 150, "118": 0, "119": 0, "120": 0, "123": 150, "124": 0, "125": 0, "126": 0, "128": 0, "130": 0, "131": 0, "135": 150, "138": 150, "142": 16, "143": 32, "144": 16, "148": 150, "156": 0, "157": 0, "158": 0, "159": 0, "160": 0, "161": 0, "167": 0, "173": 0, "174": 0, "175": 0, "181": 0, "188": 0, "195": 3, "202": 3, "228": 16, "243": 16, "244": 16, "247": 16, "248": 16, "249": 16, "229": 2, "230": 0, "231": 0, "232": 0, "235": 0, "237": 0, "238": 0, "239": 0, "241": 2, "255": 12, "256": 12, "258": 12, "267": 12, "268": 12, "269": 12, "270": 24, "271": 12, "272": 12, "273": 12, "275": 24, "276": 12, "277": 12, "278": 12, "280": 12, "281": 12, "282": 24, "283": 12, "284": 12, "285": 12, "266": 12, "291": 12, "292": 376, "293": 728, "294": 728, "295": 364, "296": 364, "299": 364, "300": 17, "304": 12, "305": 12, "306": 24, "307": 12, "310": 12, "311": 11, "313": 12, "259": 107, "262": 107, "263": 107, "260": 1, "317": 10, "327": 1, "329": 1, "328": 1, "332": 1, "333": 1, "334": 1, "335": 1, "336": 1, "337": 1, "338": 1, "339": 1, "331": 1, "346": 0, "347": 0, "349": 0, "351": 0, "352": 0, "353": 0, "350": 0, "355": 0, "356": 0, "357": 0, "358": 0, "364": 0, "367": 0, "366": 0, "369": 0, "370": 0, "371": 0, "372": 0, "381": 0, "389": 0, "392": 0, "393": 0, "396": 0, "397": 0, "391": 0, "400": 0, "401": 0, "402": 0, "403": 0, "410": 0, "412": 0, "413": 0, "418": 0, "419": 0, "421": 0, "422": 0, "423": 0, "424": 0, "425": 0, "426": 0, "429": 0, "430": 0, "432": 0, "433": 0, "436": 0, "437": 0, "438": 0, "435": 0, "440": 0, "441": 0, "444": 0, "448": 1, "449": 1, "450": 1, "451": 1, "455": 1, "456": 2, "457": 1, "452": 0, "453": 0, "459": 0, "466": 1, "468": 1, "469": 0, "471": 0, "475": 1, "477": 109, "478": 108, "480": 108, "481": 108, "482": 0, "484": 108, "488": 108, "489": 0, "491": 108, "493": 108, "494": 108, "495": 108, "496": 108, "497": 108, "498": 108, "492": 108, "500": 108, "501": 107, "502": 107, "503": 214, "504": 107, "506": 1, "507": 1, "508": 108, "509": 107, "510": 214, "511": 107, "513": 1, "514": 1, "516": 108, "517": 106, "520": 2, "521": 2, "522": 4, "523": 2, "524": 2, "525": 2, "527": 2, "528": 2, "519": 2, "531": 1, "472": 0, "470": 0, "538": 1, "541": 3, "544": 3, "545": 110, "547": 1, "554": 0, "556": 0, "557": 0, "558": 0, "559": 0, "560": 0, "561": 0, "564": 0, "566": 0, "567": 0, "571": 0, "573": 0, "574": 0, "576": 0, "577": 0, "578": 0, "579": 0, "580": 0, "581": 0, "582": 0, "585": 0, "587": 0, "588": 0, "589": 0, "590": 0, "591": 0, "595": 1, "597": 1, "601": 1, "605": 1, "602": 1, "603": 1, "606": 0}}
+ git checkout 55bcbd8d172b689811fae17cde2f09218dd74e9c
Note: switching to '55bcbd8d172b689811fae17cde2f09218dd74e9c'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 55bcbd8d17 Fixed #34378 -- Made QuerySet.in_bulk() not clear odering when id_list is passed.
M	django/contrib/admin/sites.py
+ git apply /root/pre_state.patch
error: unrecognized input
