2025-12-07 15:42:16,029 - WARNING - Starting evaluation at 1765122136.029511
2025-12-07 15:42:16,079 - INFO - Creating container for pytest-dev__pytest-5631...
2025-12-07 15:42:16,100 - INFO - Container for pytest-dev__pytest-5631 created: 76b9dfd3acbcc09bbc681d6578fc2698dcfafa5a607990092a2bb07d36f8992e
2025-12-07 15:42:16,289 - INFO - Container for pytest-dev__pytest-5631 started: 76b9dfd3acbcc09bbc681d6578fc2698dcfafa5a607990092a2bb07d36f8992e
2025-12-07 15:42:16,446 - INFO - Git diff before:

2025-12-07 15:42:16,446 - INFO - Eval script for pytest-dev__pytest-5631 written to eval.sh, now applying to container...
2025-12-07 15:42:22,856 - INFO - Test output for pytest-dev__pytest-5631 written to run_instance_swt_logs/full_evaluation/pred_post__Prometheus-Bug-Reproduction-Agent/pytest-dev__pytest-5631/test_output.txt
2025-12-07 15:42:22,940 - INFO - Git diff after:
diff --git a/src/_pytest/compat.py b/src/_pytest/compat.py
index d238061b4..52ffc36bc 100644
--- a/src/_pytest/compat.py
+++ b/src/_pytest/compat.py
@@ -64,13 +64,18 @@ def num_mock_patch_args(function):
     patchings = getattr(function, "patchings", None)
     if not patchings:
         return 0
-    mock_modules = [sys.modules.get("mock"), sys.modules.get("unittest.mock")]
-    if any(mock_modules):
-        sentinels = [m.DEFAULT for m in mock_modules if m is not None]
-        return len(
-            [p for p in patchings if not p.attribute_name and p.new in sentinels]
-        )
-    return len(patchings)
+
+    mock_sentinel = getattr(sys.modules.get("mock"), "DEFAULT", object())
+    ut_mock_sentinel = getattr(sys.modules.get("unittest.mock"), "DEFAULT", object())
+
+    return len(
+        [
+            p
+            for p in patchings
+            if not p.attribute_name
+            and (p.new is mock_sentinel or p.new is ut_mock_sentinel)
+        ]
+    )
 
 
 def getfuncargnames(function, is_method=False, cls=None):
2025-12-07 15:42:22,940 - INFO - Git diff changed after running eval script
2025-12-07 15:42:22,940 - INFO - Attempting to stop container exec.eval.x86_64.bbbc4277fd8f648e693b98.75fc3544aed58c8b7c5ce3.124396453910704...
2025-12-07 15:42:38,119 - INFO - Attempting to remove container exec.eval.x86_64.bbbc4277fd8f648e693b98.75fc3544aed58c8b7c5ce3.124396453910704...
2025-12-07 15:42:38,135 - INFO - Container exec.eval.x86_64.bbbc4277fd8f648e693b98.75fc3544aed58c8b7c5ce3.124396453910704 removed.
2025-12-07 15:42:38,136 - WARNING - End of eval at 1765122158.1359768
