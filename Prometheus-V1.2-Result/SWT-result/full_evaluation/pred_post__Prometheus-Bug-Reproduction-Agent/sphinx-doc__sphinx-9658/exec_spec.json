{"instance_id": "sphinx-doc__sphinx-9658", "repo": "sphinx-doc/sphinx", "version": "4.3", "environment_setup_commit": "6c6cc8a6f50b18331cb818160d168d7bb9c03e55", "patch_list": ["diff --git a/sphinx/ext/autodoc/mock.py b/sphinx/ext/autodoc/mock.py\n--- a/sphinx/ext/autodoc/mock.py\n+++ b/sphinx/ext/autodoc/mock.py\n@@ -26,6 +26,7 @@ class _MockObject:\n     \"\"\"Used by autodoc_mock_imports.\"\"\"\n \n     __display_name__ = '_MockObject'\n+    __name__ = ''\n     __sphinx_mock__ = True\n     __sphinx_decorator_args__: Tuple[Any, ...] = ()\n \n@@ -40,7 +41,7 @@ def __new__(cls, *args: Any, **kwargs: Any) -> Any:\n         return super().__new__(cls)\n \n     def __init__(self, *args: Any, **kwargs: Any) -> None:\n-        self.__qualname__ = ''\n+        self.__qualname__ = self.__name__\n \n     def __len__(self) -> int:\n         return 0\n@@ -73,6 +74,7 @@ def _make_subclass(name: str, module: str, superclass: Any = _MockObject,\n                    attributes: Any = None, decorator_args: Tuple = ()) -> Any:\n     attrs = {'__module__': module,\n              '__display_name__': module + '.' + name,\n+             '__name__': name,\n              '__sphinx_decorator_args__': decorator_args}\n     attrs.update(attributes or {})\n \n", "diff --git a/tests/test_ext_autodoc_show_inheritance.py b/tests/test_ext_autodoc_show_inheritance.py\nnew file mode 100644\nindex 000000000..ad2a727ad\n--- /dev/null\n+++ b/tests/test_ext_autodoc_show_inheritance.py\n@@ -0,0 +1,33 @@\n+import pytest\n+\n+from .test_ext_autodoc import do_autodoc\n+\n+\n+@pytest.mark.sphinx('html', testroot='ext-autodoc')\n+def test_show_inheritance_for_subclass_of_mocked_class(app):\n+    \"\"\"\n+    Test that the base class is rendered correctly for a class that inherits\n+    from a mocked class, when the 'show-inheritance' option is used.\n+    \"\"\"\n+    # All missing modules in the target file must be mocked for it to be importable.\n+    app.config.autodoc_mock_imports = [\n+        \"missing_module\",\n+        \"missing_package1\",\n+        \"missing_package2\",\n+        \"missing_package3\",\n+        \"sphinx.missing_module4\",\n+    ]\n+    options = {\n+        'show-inheritance': None,\n+    }\n+    actual = do_autodoc(app, 'class', 'target.need_mocks.Inherited', options)\n+    assert list(actual) == [\n+        '',\n+        '.. py:class:: Inherited()',\n+        '   :module: target.need_mocks',\n+        '',\n+        '   Bases: :py:class:`missing_module.Class`',\n+        '',\n+        '   docstring',\n+        '',\n+    ]\n"], "arch": "x86_64", "base_commit": "232dbe41c5250eb7d559d40438c4743483e95f15", "test_directives": ["tests/test_ext_autodoc_show_inheritance.py"], "coverage_files": ["sphinx/ext/autodoc/mock.py"], "env_name": "testbed", "run_id": "full_evaluation", "patch_id": "pred_post__Prometheus-Bug-Reproduction-Agent", "timeout": 1800, "rm_image": false, "force_rebuild": false, "exec_mode": "unit_test", "reproduction_script_name": null, "compute_coverage": true, "install": {"python": "3.9", "pip_packages": ["tox==4.16.0", "tox-current-env==0.0.11"], "install": "python -m pip install -e .[test]", "pre_install": ["sed -i 's/pytest/pytest -rA/' tox.ini", "sed -i 's/Jinja2>=2.3/Jinja2<3.0/' setup.py", "sed -i 's/sphinxcontrib-applehelp/sphinxcontrib-applehelp<=1.0.7/' setup.py", "sed -i 's/sphinxcontrib-devhelp/sphinxcontrib-devhelp<=1.0.5/' setup.py", "sed -i 's/sphinxcontrib-qthelp/sphinxcontrib-qthelp<=1.0.6/' setup.py", "sed -i 's/alabaster>=0.7,<0.8/alabaster>=0.7,<0.7.12/' setup.py", "sed -i \"s/'packaging',/'packaging', 'markupsafe<=2.0.1',/\" setup.py", "sed -i 's/sphinxcontrib-htmlhelp>=2.0.0/sphinxcontrib-htmlhelp>=2.0.0,<=2.0.4/' setup.py", "sed -i 's/sphinxcontrib-serializinghtml>=1.1.5/sphinxcontrib-serializinghtml>=1.1.5,<=1.1.9/' setup.py"]}, "cache_level": "instance", "test_command": "python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(sphinx/ext/autodoc/mock\\.py)' -m tox -epy39 -v -- tests/test_ext_autodoc_show_inheritance.py", "req_install_commands": ["conda create -n testbed python=3.9  -y"]}