{"instance_id": "sphinx-doc__sphinx-9673", "repo": "sphinx-doc/sphinx", "version": "4.3", "environment_setup_commit": "6c6cc8a6f50b18331cb818160d168d7bb9c03e55", "patch_list": ["diff --git a/tests/test_ext_napoleon_autodoc_typehints.py b/tests/test_ext_napoleon_autodoc_typehints.py\nnew file mode 100644\nindex 000000000..aa989d1b5\n--- /dev/null\n+++ b/tests/test_ext_napoleon_autodoc_typehints.py\n@@ -0,0 +1,61 @@\n+import pytest\n+import textwrap\n+\n+\n+@pytest.mark.sphinx(\n+    'text',\n+    testroot='ext-autodoc',\n+    confoverrides={\n+        'extensions': ['sphinx.ext.autodoc', 'sphinx.ext.napoleon'],\n+        'autodoc_typehints': 'description',\n+        'autodoc_typehints_description_target': 'documented',\n+        'napoleon_numpy_docstring': False,\n+    }\n+)\n+def test_napoleon_autodoc_typehints_description_target(app):\n+    \"\"\"\n+    Test that for Google style docstrings, with\n+    autodoc_typehints_description_target='documented', the return type is\n+    included in the documentation when the return section is present.\n+\n+    This is a regression test for https://github.com/sphinx-doc/sphinx/issues/9735\n+    \"\"\"\n+    python_code = textwrap.dedent('''\n+        def my_function(arg1: int) -> str:\n+            \"\"\"A summary.\n+\n+            Args:\n+                arg1: The first argument.\n+\n+            Returns:\n+                The return value.\n+            \"\"\"\n+            return str(arg1)\n+    ''')\n+    (app.srcdir / 'module.py').write_text(python_code, encoding='utf8')\n+\n+    rst_content = textwrap.dedent('''\n+        .. automodule:: module\n+           :members:\n+    ''')\n+    (app.srcdir / 'index.rst').write_text(rst_content, encoding='utf8')\n+\n+    app.build()\n+\n+    output = (app.outdir / 'index.txt').read_text(encoding='utf8')\n+\n+    expected_output = (\n+        \"module.my_function(arg1)\\n\"\n+        \"\\n\"\n+        \"   A summary.\\n\"\n+        \"\\n\"\n+        \"   Parameters:\\n\"\n+        \"      **arg1** (*int*) -- The first argument.\\n\"\n+        \"\\n\"\n+        \"   Returns:\\n\"\n+        \"      The return value.\\n\"\n+        \"\\n\"\n+        \"   Return type:\\n\"\n+        \"      str\\n\"\n+    )\n+    assert expected_output in output\n"], "arch": "x86_64", "base_commit": "5fb51fb1467dc5eea7505402c3c5d9b378d3b441", "test_directives": ["tests/test_ext_napoleon_autodoc_typehints.py"], "coverage_files": ["sphinx/ext/autodoc/typehints.py"], "env_name": "testbed", "run_id": "full_evaluation", "patch_id": "pred_pre__Prometheus-Bug-Reproduction-Agent", "timeout": 1800, "rm_image": false, "force_rebuild": false, "exec_mode": "unit_test", "reproduction_script_name": null, "compute_coverage": true, "install": {"python": "3.9", "pip_packages": ["tox==4.16.0", "tox-current-env==0.0.11"], "install": "python -m pip install -e .[test]", "pre_install": ["sed -i 's/pytest/pytest -rA/' tox.ini", "sed -i 's/Jinja2>=2.3/Jinja2<3.0/' setup.py", "sed -i 's/sphinxcontrib-applehelp/sphinxcontrib-applehelp<=1.0.7/' setup.py", "sed -i 's/sphinxcontrib-devhelp/sphinxcontrib-devhelp<=1.0.5/' setup.py", "sed -i 's/sphinxcontrib-qthelp/sphinxcontrib-qthelp<=1.0.6/' setup.py", "sed -i 's/alabaster>=0.7,<0.8/alabaster>=0.7,<0.7.12/' setup.py", "sed -i \"s/'packaging',/'packaging', 'markupsafe<=2.0.1',/\" setup.py", "sed -i 's/sphinxcontrib-htmlhelp>=2.0.0/sphinxcontrib-htmlhelp>=2.0.0,<=2.0.4/' setup.py", "sed -i 's/sphinxcontrib-serializinghtml>=1.1.5/sphinxcontrib-serializinghtml>=1.1.5,<=1.1.9/' setup.py"]}, "cache_level": "instance", "test_command": "python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(sphinx/ext/autodoc/typehints\\.py)' -m tox -epy39 -v -- tests/test_ext_napoleon_autodoc_typehints.py", "req_install_commands": ["conda create -n testbed python=3.9  -y"]}