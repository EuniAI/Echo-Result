{"instance_id": "django__django-13590", "repo": "django/django", "version": "3.2", "environment_setup_commit": "65dfb06a1ab56c238cc80f5e1c31f61210c4577d", "patch_list": ["diff --git a/tests/lookup/test_range_namedtuple.py b/tests/lookup/test_range_namedtuple.py\nnew file mode 100644\nindex 0000000000..5b90d41a4c\n--- /dev/null\n+++ b/tests/lookup/test_range_namedtuple.py\n@@ -0,0 +1,53 @@\n+import collections.abc\n+from collections import namedtuple\n+from datetime import datetime\n+from math import ceil\n+from operator import attrgetter\n+\n+from django.core.exceptions import FieldError\n+from django.db import connection, models\n+from django.db.models import Exists, Max, OuterRef\n+from django.db.models.functions import Substr\n+from django.test import TestCase, skipUnlessDBFeature\n+from django.test.utils import isolate_apps\n+from django.utils.deprecation import RemovedInDjango40Warning\n+\n+from .models import (\n+    Article, Author, Freebie, Game, IsNullWithNoneAsRHS, Player, Season, Tag,\n+)\n+\n+\n+class RangeNamedTupleTest(TestCase):\n+\n+    @classmethod\n+    def setUpTestData(cls):\n+        cls.au1 = Author.objects.create(name='Author 1', alias='a1')\n+        cls.au2 = Author.objects.create(name='Author 2', alias='a2')\n+        cls.a1 = Article.objects.create(headline='Article 1', pub_date=datetime(2005, 7, 26), author=cls.au1, slug='a1')\n+        cls.a2 = Article.objects.create(headline='Article 2', pub_date=datetime(2005, 7, 27), author=cls.au1, slug='a2')\n+        cls.a3 = Article.objects.create(headline='Article 3', pub_date=datetime(2005, 7, 27), author=cls.au1, slug='a3')\n+        cls.a4 = Article.objects.create(headline='Article 4', pub_date=datetime(2005, 7, 28), author=cls.au1, slug='a4')\n+        cls.a5 = Article.objects.create(headline='Article 5', pub_date=datetime(2005, 8, 1, 9, 0), author=cls.au2, slug='a5')\n+        cls.a6 = Article.objects.create(headline='Article 6', pub_date=datetime(2005, 8, 1, 8, 0), author=cls.au2, slug='a6')\n+        cls.a7 = Article.objects.create(headline='Article 7', pub_date=datetime(2005, 7, 27), author=cls.au2, slug='a7')\n+        cls.t1 = Tag.objects.create(name='Tag 1')\n+        cls.t1.articles.add(cls.a1, cls.a2, cls.a3)\n+        cls.t2 = Tag.objects.create(name='Tag 2')\n+        cls.t2.articles.add(cls.a3, cls.a4, cls.a5)\n+        cls.t3 = Tag.objects.create(name='Tag 3')\n+        cls.t3.articles.add(cls.a5, cls.a6, cls.a7)\n+\n+\n+    def test_range_namedtuple(self):\n+        DateRange = namedtuple('DateRange', ['near', 'far'])\n+        start_date = datetime(2005, 7, 27)\n+        end_date = datetime(2005, 7, 28)\n+        date_range = DateRange(near=start_date, far=end_date)\n+        # This should not raise a TypeError.\n+        qs = Article.objects.filter(pub_date__range=date_range)\n+        self.assertQuerysetEqual(\n+            qs,\n+            [self.a2.pk, self.a3.pk, self.a4.pk, self.a7.pk],\n+            transform=attrgetter('pk'),\n+            ordered=False,\n+        )\n"], "arch": "x86_64", "base_commit": "755dbf39fcdc491fe9b588358303e259c7750be4", "test_directives": ["lookup.test_range_namedtuple"], "coverage_files": ["django/db/models/sql/query.py"], "env_name": "testbed", "run_id": "full_evaluation", "patch_id": "pred_pre__Prometheus-Bug-Reproduction-Agent", "timeout": 1800, "rm_image": false, "force_rebuild": false, "exec_mode": "unit_test", "reproduction_script_name": null, "compute_coverage": true, "install": {"python": "3.6", "packages": "requirements.txt", "install": "python -m pip install -e .", "eval_commands": ["sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && locale-gen", "export LANG=en_US.UTF-8", "export LANGUAGE=en_US:en", "export LC_ALL=en_US.UTF-8"]}, "cache_level": "instance", "test_command": "python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(django/db/models/sql/query\\.py)' ./tests/runtests.py --verbosity 2 --settings=test_sqlite --parallel 1 lookup.test_range_namedtuple", "req_install_commands": ["conda create -n testbed python=3.6 -y", "cat <<'EOF_59812759871' > $HOME/requirements.txt\nasgiref >= 3.3.2\nargon2-cffi >= 16.1.0\nbackports.zoneinfo; python_version < '3.9'\nbcrypt\ndocutils\ngeoip2\njinja2 >= 2.9.2\nnumpy\nPillow >= 6.2.0\npylibmc; sys.platform != 'win32'\npymemcache >= 3.4.0\npython-memcached >= 1.59\npytz\npywatchman; sys.platform != 'win32'\nPyYAML\nselenium\nsqlparse >= 0.2.2\ntblib >= 1.5.0\ntzdata\ncolorama; sys.platform == 'win32'\n\nEOF_59812759871", "conda activate testbed && python -m pip install -r $HOME/requirements.txt", "rm $HOME/requirements.txt"]}