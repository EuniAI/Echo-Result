{"instance_id": "sphinx-doc__sphinx-10466", "repo": "sphinx-doc/sphinx", "version": "5.0", "environment_setup_commit": "60775ec4c4ea08509eee4b564cbf90f316021aff", "patch_list": ["diff --git a/tests/test_build_gettext_catalog.py b/tests/test_build_gettext_catalog.py\nnew file mode 100644\nindex 000000000..9ff37c8b6\n--- /dev/null\n+++ b/tests/test_build_gettext_catalog.py\n@@ -0,0 +1,31 @@\n+import pytest\n+from unittest.mock import Mock\n+\n+from sphinx.builders.gettext import Catalog\n+\n+\n+def test_message_locations_are_deduplicated():\n+    \"\"\"Test that duplicate locations in a message are removed.\"\"\"\n+    catalog = Catalog()\n+    msgid = \"Type\"\n+\n+    # Simulate multiple origins pointing to the same file and line,\n+    # as described in the bug report.\n+    locations = [\n+        ('../../manual/render/shader_nodes/vector/vector_rotate.rst', 38),\n+        ('../../manual/modeling/hair.rst', 0),\n+        ('../../manual/modeling/hair.rst', 0),\n+        ('../../manual/modeling/hair.rst', 0),\n+        ('../../manual/modeling/metas/properties.rst', 92),\n+    ]\n+\n+    for i, (source, line) in enumerate(locations):\n+        origin = Mock(source=source, line=line, uid=f'uid{i}')\n+        catalog.add(msgid, origin)\n+\n+    messages = list(catalog)\n+    message = messages[0]\n+\n+    # Before fix, message.locations has 5 items because of duplicates.\n+    # After fix, it should have 3 unique items.\n+    assert len(message.locations) == 3\n"], "arch": "x86_64", "base_commit": "cab2d93076d0cca7c53fac885f927dde3e2a5fec", "test_directives": ["tests/test_build_gettext_catalog.py"], "coverage_files": ["sphinx/builders/gettext.py"], "env_name": "testbed", "run_id": "full_evaluation", "patch_id": "pred_pre__Prometheus-Bug-Reproduction-Agent", "timeout": 1800, "rm_image": false, "force_rebuild": false, "exec_mode": "unit_test", "reproduction_script_name": null, "compute_coverage": true, "install": {"python": "3.9", "pip_packages": ["tox==4.16.0", "tox-current-env==0.0.11"], "install": "python -m pip install -e .[test]", "pre_install": ["sed -i 's/pytest/pytest -rA/' tox.ini"]}, "cache_level": "instance", "test_command": "python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(sphinx/builders/gettext\\.py)' -m tox -epy39 -v -- tests/test_build_gettext_catalog.py", "req_install_commands": ["conda create -n testbed python=3.9  -y"]}