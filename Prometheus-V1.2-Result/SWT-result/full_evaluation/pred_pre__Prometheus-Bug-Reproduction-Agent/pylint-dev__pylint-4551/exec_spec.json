{"instance_id": "pylint-dev__pylint-4551", "repo": "pylint-dev/pylint", "version": "2.9", "environment_setup_commit": "c04f92ef68e5ea779a60bfddb91dc677c5470fd0", "patch_list": ["diff --git a/tests/unittest_pyreverse_inspector_issue_1539.py b/tests/unittest_pyreverse_inspector_issue_1539.py\nnew file mode 100644\nindex 000000000..e580bd1eb\n--- /dev/null\n+++ b/tests/unittest_pyreverse_inspector_issue_1539.py\n@@ -0,0 +1,42 @@\n+import astroid\n+\n+from pylint.pyreverse import inspector\n+\n+\n+def test_type_hint_in_init_with_none_default_is_used():\n+    \"\"\"\n+    Test that the Linker correctly infers the type of an instance\n+    attribute from a type-hinted __init__ argument with a default\n+    value of None.\n+\n+    This reproduces the bug described in https://github.com/PyCQA/pylint/issues/1539\n+    \"\"\"\n+    module_node = astroid.parse(\n+        \"\"\"\n+    class C:\n+        def __init__(self, a: str = None):\n+            self.a = a\n+    \"\"\"\n+    )\n+    class_node = module_node[\"C\"]\n+\n+    # The Linker is a visitor that populates class information. For a single\n+    # module test, the module node itself can act as the project context.\n+    linker = inspector.Linker(module_node)\n+    linker.visit(module_node)\n+\n+    # After visiting, the instance_attrs_type dictionary on the class node\n+    # should be populated with type information.\n+    assert hasattr(class_node, \"instance_attrs_type\")\n+    attrs_type = class_node.instance_attrs_type\n+\n+    # The type for attribute 'a' should be inferred from the 'str' hint.\n+    assert \"a\" in attrs_type\n+    inferred_types = attrs_type[\"a\"]\n+    # Before the fix, this would likely be inferred as None or be empty.\n+    assert len(inferred_types) == 1\n+\n+    # The inferred type for 'str' should be an astroid ClassDef node.\n+    inferred_type = inferred_types[0]\n+    assert isinstance(inferred_type, astroid.nodes.ClassDef)\n+    assert inferred_type.name == \"str\"\n"], "arch": "x86_64", "base_commit": "99589b08de8c5a2c6cc61e13a37420a868c80599", "test_directives": ["tests/unittest_pyreverse_inspector_issue_1539.py"], "coverage_files": ["pylint/pyreverse/utils.py", "pylint/pyreverse/inspector.py", "pylint/pyreverse/diagrams.py", "pylint/pyreverse/writer.py"], "env_name": "testbed", "run_id": "full_evaluation", "patch_id": "pred_pre__Prometheus-Bug-Reproduction-Agent", "timeout": 1800, "rm_image": false, "force_rebuild": false, "exec_mode": "unit_test", "reproduction_script_name": null, "compute_coverage": true, "install": {"python": "3.9", "packages": "requirements.txt", "install": "python -m pip install -e ."}, "cache_level": "instance", "test_command": "python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(pylint/pyreverse/utils\\.py|pylint/pyreverse/inspector\\.py|pylint/pyreverse/diagrams\\.py|pylint/pyreverse/writer\\.py)' -m pytest --no-header -rA  -p no:cacheprovider tests/unittest_pyreverse_inspector_issue_1539.py", "req_install_commands": ["conda create -n testbed python=3.9 -y", "cat <<'EOF_59812759871' > $HOME/requirements.txt\nblack==21.7b0;python_full_version>=\"3.6.2\"\nflake8==3.9.2\nisort==5.9.2\nmypy==0.910\n\nastroid==2.6.5  # Pinned to a specific version for tests\npytest~=6.2\npytest-benchmark~=3.4\n\ncoveralls~=3.2\ncoverage~=5.5\npre-commit~=2.13;python_full_version>=\"3.6.2\"\ntbump~=6.3.2\npyenchant~=3.2\npytest-cov~=2.12\npytest-profiling~=1.7\npytest-xdist~=2.3\ntypes-pkg_resources==0.1.3\ntypes-toml==0.1.3\n\nEOF_59812759871", "conda activate testbed && python -m pip install -r $HOME/requirements.txt", "rm $HOME/requirements.txt"]}