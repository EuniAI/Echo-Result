+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /opt/miniconda3/bin/conda
++++ dirname /opt/miniconda3/bin
+++ PATH=/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval 'PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmf-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmpy-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/gdal-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/geotiff-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/proj4-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/udunits2-activate.sh"'
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''2'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_1='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmf-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmpy-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/gdal-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/geotiff-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/proj4-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/udunits2-activate.sh"'
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=2
++ CONDA_SHLVL=2
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_1=/opt/miniconda3
++ CONDA_PREFIX_1=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/esmf-activate.sh
+++ '[' -n '' ']'
+++ '[' -f /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
+++ export ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/esmpy-activate.sh
+++ '[' -n /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
+++ export _CONDA_SET_ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ _CONDA_SET_ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ '[' -f /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
+++ export ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/gdal-activate.sh
+++ '[' -n '' ']'
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/gdal ']'
+++ export GDAL_DATA=/opt/miniconda3/envs/testbed/share/gdal
+++ GDAL_DATA=/opt/miniconda3/envs/testbed/share/gdal
+++ export GDAL_DRIVER_PATH=/opt/miniconda3/envs/testbed/lib/gdalplugins
+++ GDAL_DRIVER_PATH=/opt/miniconda3/envs/testbed/lib/gdalplugins
+++ '[' '!' -d /opt/miniconda3/envs/testbed/lib/gdalplugins ']'
+++ export CPL_ZIP_ENCODING=UTF-8
+++ CPL_ZIP_ENCODING=UTF-8
+++ '[' -n '5.1.16(1)-release' ']'
+++ '[' -f /opt/miniconda3/envs/testbed/share/bash-completion/completions/gdalinfo ']'
+++ source /opt/miniconda3/envs/testbed/share/bash-completion/completions/gdalinfo
++++ function_exists _get_comp_words_by_ref
++++ declare -f -F _get_comp_words_by_ref
++++ return 1
++++ return 0
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/geotiff-activate.sh
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/epsg_csv ']'
+++ '[' -d /opt/miniconda3/envs/testbed/Library/share/epsg_csv ']'
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh
+++ '[' -n '' ']'
+++ _la_log 'Beginning libarrow activation.'
+++ '[' '' = 1 ']'
+++ _la_gdb_prefix=/opt/miniconda3/envs/testbed/share/gdb/auto-load
+++ '[' '!' -w /opt/miniconda3/envs/testbed/share/gdb/auto-load ']'
+++ _la_placeholder=replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX
+++ _la_symlink_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib
+++ _la_orig_install_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
+++ _la_log '          _la_gdb_prefix: /opt/miniconda3/envs/testbed/share/gdb/auto-load'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_placeholder: replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_symlink_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib'
+++ '[' '' = 1 ']'
+++ _la_log '    _la_orig_install_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib'
+++ '[' '' = 1 ']'
+++ _la_log '  content of that folder:'
+++ '[' '' = 1 ']'
++++ ls -al /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
++++ sed 's/^/      /'
+++ _la_log '      total 12
      drwxr-xr-x 2 root root 4096 Nov  4 19:56 .
      drwxr-xr-x 3 root root 4096 Nov  4 19:56 ..
      -rw-r--r-- 1 root root  971 Nov  4 19:56 libarrow.so.2100.0.0-gdb.py'
+++ '[' '' = 1 ']'
+++ for _la_target in "$_la_orig_install_dir/"*.py
+++ '[' '!' -e /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py ']'
++++ basename /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py
+++ _la_symlink=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py
+++ _la_log '   _la_target: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py'
+++ '[' '' = 1 ']'
+++ _la_log '  _la_symlink: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py'
+++ '[' '' = 1 ']'
+++ '[' -L /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py ']'
++++ readlink /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py
+++ '[' /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py = /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py ']'
+++ _la_log 'symlink $_la_symlink already exists and points to $_la_target, skipping.'
+++ '[' '' = 1 ']'
+++ continue
+++ _la_log 'Libarrow activation complete.'
+++ '[' '' = 1 ']'
+++ unset _la_gdb_prefix
+++ unset _la_log
+++ unset _la_orig_install_dir
+++ unset _la_placeholder
+++ unset _la_symlink
+++ unset _la_symlink_dir
+++ unset _la_target
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh
+++ test -n ''
+++ xml_catalog_files_libxml2=
+++ XML_CATALOG_FILES=
+++ conda_catalog_files=
+++ ifs_libxml2=' 	
'
+++ IFS=' '
+++ rem=/opt/miniconda3/envs/testbed
+++ for pre in ${rem}
+++ test '' = /opt/miniconda3/envs/testbed
+++ conda_catalog_files=/opt/miniconda3/envs/testbed
+++ rem=
+++ IFS=' 	
'
+++ conda_catalog_files='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ export 'XML_CATALOG_FILES=file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ XML_CATALOG_FILES='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ unset conda_catalog_files ifs_libxml2 rem
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/proj4-activate.sh
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/proj ']'
+++ export PROJ_DATA=/opt/miniconda3/envs/testbed/share/proj
+++ PROJ_DATA=/opt/miniconda3/envs/testbed/share/proj
+++ '[' -f /opt/miniconda3/envs/testbed/share/proj/copyright_and_licenses.csv ']'
+++ export PROJ_NETWORK=ON
+++ PROJ_NETWORK=ON
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/udunits2-activate.sh
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/udunits ']'
+++ export UDUNITS2_XML_PATH=/opt/miniconda3/envs/testbed/share/udunits/udunits2.xml
+++ UDUNITS2_XML_PATH=/opt/miniconda3/envs/testbed/share/udunits/udunits2.xml
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ cd /testbed
+ git diff HEAD 8cc34cb412ba89ebca12fc84f76a9e452628f1bc
+ git config --global --add safe.directory /testbed
+ cd /testbed
+ git status
On branch main
nothing to commit, working tree clean
+ git show
commit 8cc34cb412ba89ebca12fc84f76a9e452628f1bc
Author: Aureliana Barghini <35919497+aurghs@users.noreply.github.com>
Date:   Thu Jan 28 16:20:59 2021 +0100

    WIP: backend interface, now it uses subclassing  (#4836)
    
    * draft
    
    * working version
    
    * fix: instantiate BackendEtrypoints
    
    * rename AbstractBackendEntrypoint in BackendEntrypoint
    
    * fix plugins tests
    
    * style
    
    * style
    
    * raise NotImplemetedError if BackendEntrypoint.open_dataset is not implemented

diff --git a/xarray/backends/cfgrib_.py b/xarray/backends/cfgrib_.py
index 4a0ac7d6..65c5bc2a 100644
--- a/xarray/backends/cfgrib_.py
+++ b/xarray/backends/cfgrib_.py
@@ -12,7 +12,7 @@ from .common import (
     BackendEntrypoint,
 )
 from .locks import SerializableLock, ensure_lock
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import cfgrib
@@ -86,62 +86,58 @@ class CfGribDataStore(AbstractDataStore):
         return encoding
 
 
-def guess_can_open_cfgrib(store_spec):
-    try:
-        _, ext = os.path.splitext(store_spec)
-    except TypeError:
-        return False
-    return ext in {".grib", ".grib2", ".grb", ".grb2"}
-
-
-def open_backend_dataset_cfgrib(
-    filename_or_obj,
-    *,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    lock=None,
-    indexpath="{path}.{short_hash}.idx",
-    filter_by_keys={},
-    read_keys=[],
-    encode_cf=("parameter", "time", "geography", "vertical"),
-    squeeze=True,
-    time_dims=("time", "step"),
-):
-
-    store = CfGribDataStore(
+class CfgribfBackendEntrypoint(BackendEntrypoint):
+    def guess_can_open(self, store_spec):
+        try:
+            _, ext = os.path.splitext(store_spec)
+        except TypeError:
+            return False
+        return ext in {".grib", ".grib2", ".grb", ".grb2"}
+
+    def open_dataset(
+        self,
         filename_or_obj,
-        indexpath=indexpath,
-        filter_by_keys=filter_by_keys,
-        read_keys=read_keys,
-        encode_cf=encode_cf,
-        squeeze=squeeze,
-        time_dims=time_dims,
-        lock=lock,
-    )
-
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
+        *,
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        lock=None,
+        indexpath="{path}.{short_hash}.idx",
+        filter_by_keys={},
+        read_keys=[],
+        encode_cf=("parameter", "time", "geography", "vertical"),
+        squeeze=True,
+        time_dims=("time", "step"),
+    ):
+
+        store = CfGribDataStore(
+            filename_or_obj,
+            indexpath=indexpath,
+            filter_by_keys=filter_by_keys,
+            read_keys=read_keys,
+            encode_cf=encode_cf,
+            squeeze=squeeze,
+            time_dims=time_dims,
+            lock=lock,
         )
-    return ds
-
-
-cfgrib_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_cfgrib, guess_can_open=guess_can_open_cfgrib
-)
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+        return ds
 
 
 if has_cfgrib:
-    BACKEND_ENTRYPOINTS["cfgrib"] = cfgrib_backend
+    BACKEND_ENTRYPOINTS["cfgrib"] = CfgribfBackendEntrypoint
diff --git a/xarray/backends/common.py b/xarray/backends/common.py
index adb70658..e2905d08 100644
--- a/xarray/backends/common.py
+++ b/xarray/backends/common.py
@@ -1,7 +1,7 @@
 import logging
 import time
 import traceback
-from typing import Dict
+from typing import Dict, Tuple, Type, Union
 
 import numpy as np
 
@@ -344,12 +344,13 @@ class WritableCFDataStore(AbstractWritableDataStore):
 
 
 class BackendEntrypoint:
-    __slots__ = ("guess_can_open", "open_dataset", "open_dataset_parameters")
+    open_dataset_parameters: Union[Tuple, None] = None
 
-    def __init__(self, open_dataset, open_dataset_parameters=None, guess_can_open=None):
-        self.open_dataset = open_dataset
-        self.open_dataset_parameters = open_dataset_parameters
-        self.guess_can_open = guess_can_open
+    def open_dataset(self):
+        raise NotImplementedError
 
+    def guess_can_open(self, store_spec):
+        return False
 
-BACKEND_ENTRYPOINTS: Dict[str, BackendEntrypoint] = {}
+
+BACKEND_ENTRYPOINTS: Dict[str, Type[BackendEntrypoint]] = {}
diff --git a/xarray/backends/h5netcdf_.py b/xarray/backends/h5netcdf_.py
index 562600de..aa892c4f 100644
--- a/xarray/backends/h5netcdf_.py
+++ b/xarray/backends/h5netcdf_.py
@@ -23,7 +23,7 @@ from .netCDF4_ import (
     _get_datatype,
     _nc4_require_group,
 )
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import h5netcdf
@@ -328,62 +328,61 @@ class H5NetCDFStore(WritableCFDataStore):
         self._manager.close(**kwargs)
 
 
-def guess_can_open_h5netcdf(store_spec):
-    try:
-        return read_magic_number(store_spec).startswith(b"\211HDF\r\n\032\n")
-    except TypeError:
-        pass
-
-    try:
-        _, ext = os.path.splitext(store_spec)
-    except TypeError:
-        return False
-
-    return ext in {".nc", ".nc4", ".cdf"}
-
-
-def open_backend_dataset_h5netcdf(
-    filename_or_obj,
-    *,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    format=None,
-    group=None,
-    lock=None,
-    invalid_netcdf=None,
-    phony_dims=None,
-):
-
-    store = H5NetCDFStore.open(
+class H5netcdfBackendEntrypoint(BackendEntrypoint):
+    def guess_can_open(self, store_spec):
+        try:
+            return read_magic_number(store_spec).startswith(b"\211HDF\r\n\032\n")
+        except TypeError:
+            pass
+
+        try:
+            _, ext = os.path.splitext(store_spec)
+        except TypeError:
+            return False
+
+        return ext in {".nc", ".nc4", ".cdf"}
+
+    def open_dataset(
+        self,
         filename_or_obj,
-        format=format,
-        group=group,
-        lock=lock,
-        invalid_netcdf=invalid_netcdf,
-        phony_dims=phony_dims,
-    )
+        *,
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        format=None,
+        group=None,
+        lock=None,
+        invalid_netcdf=None,
+        phony_dims=None,
+    ):
 
-    ds = open_backend_dataset_store(
-        store,
-        mask_and_scale=mask_and_scale,
-        decode_times=decode_times,
-        concat_characters=concat_characters,
-        decode_coords=decode_coords,
-        drop_variables=drop_variables,
-        use_cftime=use_cftime,
-        decode_timedelta=decode_timedelta,
-    )
-    return ds
+        store = H5NetCDFStore.open(
+            filename_or_obj,
+            format=format,
+            group=group,
+            lock=lock,
+            invalid_netcdf=invalid_netcdf,
+            phony_dims=phony_dims,
+        )
 
+        store_entrypoint = StoreBackendEntrypoint()
+
+        ds = store_entrypoint.open_dataset(
+            store,
+            mask_and_scale=mask_and_scale,
+            decode_times=decode_times,
+            concat_characters=concat_characters,
+            decode_coords=decode_coords,
+            drop_variables=drop_variables,
+            use_cftime=use_cftime,
+            decode_timedelta=decode_timedelta,
+        )
+        return ds
 
-h5netcdf_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_h5netcdf, guess_can_open=guess_can_open_h5netcdf
-)
 
 if has_h5netcdf:
-    BACKEND_ENTRYPOINTS["h5netcdf"] = h5netcdf_backend
+    BACKEND_ENTRYPOINTS["h5netcdf"] = H5netcdfBackendEntrypoint
diff --git a/xarray/backends/netCDF4_.py b/xarray/backends/netCDF4_.py
index 5bb4eec8..e3d87aaf 100644
--- a/xarray/backends/netCDF4_.py
+++ b/xarray/backends/netCDF4_.py
@@ -22,7 +22,7 @@ from .common import (
 from .file_manager import CachingFileManager, DummyFileManager
 from .locks import HDF5_LOCK, NETCDFC_LOCK, combine_locks, ensure_lock, get_write_lock
 from .netcdf3 import encode_nc3_attr_value, encode_nc3_variable
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import netCDF4
@@ -512,65 +512,62 @@ class NetCDF4DataStore(WritableCFDataStore):
         self._manager.close(**kwargs)
 
 
-def guess_can_open_netcdf4(store_spec):
-    if isinstance(store_spec, str) and is_remote_uri(store_spec):
-        return True
-    try:
-        _, ext = os.path.splitext(store_spec)
-    except TypeError:
-        return False
-    return ext in {".nc", ".nc4", ".cdf"}
-
-
-def open_backend_dataset_netcdf4(
-    filename_or_obj,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    group=None,
-    mode="r",
-    format="NETCDF4",
-    clobber=True,
-    diskless=False,
-    persist=False,
-    lock=None,
-    autoclose=False,
-):
+class NetCDF4BackendEntrypoint(BackendEntrypoint):
+    def guess_can_open(self, store_spec):
+        if isinstance(store_spec, str) and is_remote_uri(store_spec):
+            return True
+        try:
+            _, ext = os.path.splitext(store_spec)
+        except TypeError:
+            return False
+        return ext in {".nc", ".nc4", ".cdf"}
 
-    store = NetCDF4DataStore.open(
+    def open_dataset(
+        self,
         filename_or_obj,
-        mode=mode,
-        format=format,
-        group=group,
-        clobber=clobber,
-        diskless=diskless,
-        persist=persist,
-        lock=lock,
-        autoclose=autoclose,
-    )
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        group=None,
+        mode="r",
+        format="NETCDF4",
+        clobber=True,
+        diskless=False,
+        persist=False,
+        lock=None,
+        autoclose=False,
+    ):
 
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
+        store = NetCDF4DataStore.open(
+            filename_or_obj,
+            mode=mode,
+            format=format,
+            group=group,
+            clobber=clobber,
+            diskless=diskless,
+            persist=persist,
+            lock=lock,
+            autoclose=autoclose,
         )
-    return ds
 
-
-netcdf4_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_netcdf4, guess_can_open=guess_can_open_netcdf4
-)
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+        return ds
 
 
 if has_netcdf4:
-    BACKEND_ENTRYPOINTS["netcdf4"] = netcdf4_backend
+    BACKEND_ENTRYPOINTS["netcdf4"] = NetCDF4BackendEntrypoint
diff --git a/xarray/backends/plugins.py b/xarray/backends/plugins.py
index 6d3ec7e7..b8cd2bf6 100644
--- a/xarray/backends/plugins.py
+++ b/xarray/backends/plugins.py
@@ -36,6 +36,7 @@ def remove_duplicates(backend_entrypoints):
 def detect_parameters(open_dataset):
     signature = inspect.signature(open_dataset)
     parameters = signature.parameters
+    parameters_list = []
     for name, param in parameters.items():
         if param.kind in (
             inspect.Parameter.VAR_KEYWORD,
@@ -45,7 +46,9 @@ def detect_parameters(open_dataset):
                 f"All the parameters in {open_dataset!r} signature should be explicit. "
                 "*args and **kwargs is not supported"
             )
-    return tuple(parameters)
+        if name != "self":
+            parameters_list.append(name)
+    return tuple(parameters_list)
 
 
 def create_engines_dict(backend_entrypoints):
@@ -57,8 +60,8 @@ def create_engines_dict(backend_entrypoints):
     return engines
 
 
-def set_missing_parameters(engines):
-    for name, backend in engines.items():
+def set_missing_parameters(backend_entrypoints):
+    for name, backend in backend_entrypoints.items():
         if backend.open_dataset_parameters is None:
             open_dataset = backend.open_dataset
             backend.open_dataset_parameters = detect_parameters(open_dataset)
@@ -70,7 +73,10 @@ def build_engines(entrypoints):
     external_backend_entrypoints = create_engines_dict(pkg_entrypoints)
     backend_entrypoints.update(external_backend_entrypoints)
     set_missing_parameters(backend_entrypoints)
-    return backend_entrypoints
+    engines = {}
+    for name, backend in backend_entrypoints.items():
+        engines[name] = backend()
+    return engines
 
 
 @functools.lru_cache(maxsize=1)
diff --git a/xarray/backends/pseudonetcdf_.py b/xarray/backends/pseudonetcdf_.py
index c2bfd519..80485fce 100644
--- a/xarray/backends/pseudonetcdf_.py
+++ b/xarray/backends/pseudonetcdf_.py
@@ -11,7 +11,7 @@ from .common import (
 )
 from .file_manager import CachingFileManager
 from .locks import HDF5_LOCK, NETCDFC_LOCK, combine_locks, ensure_lock
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     from PseudoNetCDF import pncopen
@@ -100,57 +100,55 @@ class PseudoNetCDFDataStore(AbstractDataStore):
         self._manager.close()
 
 
-def open_backend_dataset_pseudonetcdf(
-    filename_or_obj,
-    mask_and_scale=False,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    mode=None,
-    lock=None,
-    **format_kwargs,
-):
-
-    store = PseudoNetCDFDataStore.open(
-        filename_or_obj, lock=lock, mode=mode, **format_kwargs
+class PseudoNetCDFBackendEntrypoint(BackendEntrypoint):
+
+    # *args and **kwargs are not allowed in open_backend_dataset_ kwargs,
+    # unless the open_dataset_parameters are explicity defined like this:
+    open_dataset_parameters = (
+        "filename_or_obj",
+        "mask_and_scale",
+        "decode_times",
+        "concat_characters",
+        "decode_coords",
+        "drop_variables",
+        "use_cftime",
+        "decode_timedelta",
+        "mode",
+        "lock",
     )
 
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
+    def open_dataset(
+        self,
+        filename_or_obj,
+        mask_and_scale=False,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        mode=None,
+        lock=None,
+        **format_kwargs,
+    ):
+        store = PseudoNetCDFDataStore.open(
+            filename_or_obj, lock=lock, mode=mode, **format_kwargs
         )
-    return ds
-
-
-# *args and **kwargs are not allowed in open_backend_dataset_ kwargs,
-# unless the open_dataset_parameters are explicity defined like this:
-open_dataset_parameters = (
-    "filename_or_obj",
-    "mask_and_scale",
-    "decode_times",
-    "concat_characters",
-    "decode_coords",
-    "drop_variables",
-    "use_cftime",
-    "decode_timedelta",
-    "mode",
-    "lock",
-)
-pseudonetcdf_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_pseudonetcdf,
-    open_dataset_parameters=open_dataset_parameters,
-)
+
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+        return ds
 
 
 if has_pseudonetcdf:
-    BACKEND_ENTRYPOINTS["pseudonetcdf"] = pseudonetcdf_backend
+    BACKEND_ENTRYPOINTS["pseudonetcdf"] = PseudoNetCDFBackendEntrypoint
diff --git a/xarray/backends/pydap_.py b/xarray/backends/pydap_.py
index c5ce943a..7f8622ca 100644
--- a/xarray/backends/pydap_.py
+++ b/xarray/backends/pydap_.py
@@ -11,7 +11,7 @@ from .common import (
     BackendEntrypoint,
     robust_getitem,
 )
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import pydap.client
@@ -107,45 +107,41 @@ class PydapDataStore(AbstractDataStore):
         return Frozen(self.ds.dimensions)
 
 
-def guess_can_open_pydap(store_spec):
-    return isinstance(store_spec, str) and is_remote_uri(store_spec)
+class PydapBackendEntrypoint(BackendEntrypoint):
+    def guess_can_open(self, store_spec):
+        return isinstance(store_spec, str) and is_remote_uri(store_spec)
 
-
-def open_backend_dataset_pydap(
-    filename_or_obj,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    session=None,
-):
-
-    store = PydapDataStore.open(
+    def open_dataset(
+        self,
         filename_or_obj,
-        session=session,
-    )
-
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        session=None,
+    ):
+        store = PydapDataStore.open(
+            filename_or_obj,
+            session=session,
         )
-        return ds
-
 
-pydap_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_pydap, guess_can_open=guess_can_open_pydap
-)
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+            return ds
 
 
 if has_pydap:
-    BACKEND_ENTRYPOINTS["pydap"] = pydap_backend
+    BACKEND_ENTRYPOINTS["pydap"] = PydapBackendEntrypoint
diff --git a/xarray/backends/pynio_.py b/xarray/backends/pynio_.py
index 261daa69..41c99efd 100644
--- a/xarray/backends/pynio_.py
+++ b/xarray/backends/pynio_.py
@@ -11,7 +11,7 @@ from .common import (
 )
 from .file_manager import CachingFileManager
 from .locks import HDF5_LOCK, NETCDFC_LOCK, SerializableLock, combine_locks, ensure_lock
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import Nio
@@ -97,41 +97,39 @@ class NioDataStore(AbstractDataStore):
         self._manager.close()
 
 
-def open_backend_dataset_pynio(
-    filename_or_obj,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    mode="r",
-    lock=None,
-):
-
-    store = NioDataStore(
+class PynioBackendEntrypoint(BackendEntrypoint):
+    def open_dataset(
         filename_or_obj,
-        mode=mode,
-        lock=lock,
-    )
-
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        mode="r",
+        lock=None,
+    ):
+        store = NioDataStore(
+            filename_or_obj,
+            mode=mode,
+            lock=lock,
         )
-    return ds
 
-
-pynio_backend = BackendEntrypoint(open_dataset=open_backend_dataset_pynio)
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+        return ds
 
 
 if has_pynio:
-    BACKEND_ENTRYPOINTS["pynio"] = pynio_backend
+    BACKEND_ENTRYPOINTS["pynio"] = PynioBackendEntrypoint
diff --git a/xarray/backends/scipy_.py b/xarray/backends/scipy_.py
index df51d07d..ddc157ed 100644
--- a/xarray/backends/scipy_.py
+++ b/xarray/backends/scipy_.py
@@ -15,7 +15,7 @@ from .common import (
 from .file_manager import CachingFileManager, DummyFileManager
 from .locks import ensure_lock, get_write_lock
 from .netcdf3 import encode_nc3_attr_value, encode_nc3_variable, is_valid_nc3_name
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import scipy.io
@@ -232,56 +232,54 @@ class ScipyDataStore(WritableCFDataStore):
         self._manager.close()
 
 
-def guess_can_open_scipy(store_spec):
-    try:
-        return read_magic_number(store_spec).startswith(b"CDF")
-    except TypeError:
-        pass
+class ScipyBackendEntrypoint(BackendEntrypoint):
+    def guess_can_open(self, store_spec):
+        try:
+            return read_magic_number(store_spec).startswith(b"CDF")
+        except TypeError:
+            pass
 
-    try:
-        _, ext = os.path.splitext(store_spec)
-    except TypeError:
-        return False
-    return ext in {".nc", ".nc4", ".cdf", ".gz"}
-
-
-def open_backend_dataset_scipy(
-    filename_or_obj,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    mode="r",
-    format=None,
-    group=None,
-    mmap=None,
-    lock=None,
-):
-
-    store = ScipyDataStore(
-        filename_or_obj, mode=mode, format=format, group=group, mmap=mmap, lock=lock
-    )
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
-        )
-    return ds
+        try:
+            _, ext = os.path.splitext(store_spec)
+        except TypeError:
+            return False
+        return ext in {".nc", ".nc4", ".cdf", ".gz"}
+
+    def open_dataset(
+        self,
+        filename_or_obj,
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        mode="r",
+        format=None,
+        group=None,
+        mmap=None,
+        lock=None,
+    ):
 
+        store = ScipyDataStore(
+            filename_or_obj, mode=mode, format=format, group=group, mmap=mmap, lock=lock
+        )
 
-scipy_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_scipy, guess_can_open=guess_can_open_scipy
-)
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+        return ds
 
 
 if has_scipy:
-    BACKEND_ENTRYPOINTS["scipy"] = scipy_backend
+    BACKEND_ENTRYPOINTS["scipy"] = ScipyBackendEntrypoint
diff --git a/xarray/backends/store.py b/xarray/backends/store.py
index 66fca0d3..d57b3ab9 100644
--- a/xarray/backends/store.py
+++ b/xarray/backends/store.py
@@ -3,47 +3,43 @@ from ..core.dataset import Dataset
 from .common import BACKEND_ENTRYPOINTS, AbstractDataStore, BackendEntrypoint
 
 
-def guess_can_open_store(store_spec):
-    return isinstance(store_spec, AbstractDataStore)
-
-
-def open_backend_dataset_store(
-    store,
-    *,
-    mask_and_scale=True,
-    decode_times=True,
-    concat_characters=True,
-    decode_coords=True,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-):
-    vars, attrs = store.load()
-    encoding = store.get_encoding()
-
-    vars, attrs, coord_names = conventions.decode_cf_variables(
-        vars,
-        attrs,
-        mask_and_scale=mask_and_scale,
-        decode_times=decode_times,
-        concat_characters=concat_characters,
-        decode_coords=decode_coords,
-        drop_variables=drop_variables,
-        use_cftime=use_cftime,
-        decode_timedelta=decode_timedelta,
-    )
-
-    ds = Dataset(vars, attrs=attrs)
-    ds = ds.set_coords(coord_names.intersection(vars))
-    ds.set_close(store.close)
-    ds.encoding = encoding
-
-    return ds
-
-
-store_backend = BackendEntrypoint(
-    open_dataset=open_backend_dataset_store, guess_can_open=guess_can_open_store
-)
-
-
-BACKEND_ENTRYPOINTS["store"] = store_backend
+class StoreBackendEntrypoint(BackendEntrypoint):
+    def guess_can_open(self, store_spec):
+        return isinstance(store_spec, AbstractDataStore)
+
+    def open_dataset(
+        self,
+        store,
+        *,
+        mask_and_scale=True,
+        decode_times=True,
+        concat_characters=True,
+        decode_coords=True,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+    ):
+        vars, attrs = store.load()
+        encoding = store.get_encoding()
+
+        vars, attrs, coord_names = conventions.decode_cf_variables(
+            vars,
+            attrs,
+            mask_and_scale=mask_and_scale,
+            decode_times=decode_times,
+            concat_characters=concat_characters,
+            decode_coords=decode_coords,
+            drop_variables=drop_variables,
+            use_cftime=use_cftime,
+            decode_timedelta=decode_timedelta,
+        )
+
+        ds = Dataset(vars, attrs=attrs)
+        ds = ds.set_coords(coord_names.intersection(vars))
+        ds.set_close(store.close)
+        ds.encoding = encoding
+
+        return ds
+
+
+BACKEND_ENTRYPOINTS["store"] = StoreBackendEntrypoint
diff --git a/xarray/backends/zarr.py b/xarray/backends/zarr.py
index ceeb23ca..1d667a38 100644
--- a/xarray/backends/zarr.py
+++ b/xarray/backends/zarr.py
@@ -15,7 +15,7 @@ from .common import (
     BackendEntrypoint,
     _encode_variable_name,
 )
-from .store import open_backend_dataset_store
+from .store import StoreBackendEntrypoint
 
 try:
     import zarr
@@ -670,49 +670,48 @@ def open_zarr(
     return ds
 
 
-def open_backend_dataset_zarr(
-    filename_or_obj,
-    mask_and_scale=True,
-    decode_times=None,
-    concat_characters=None,
-    decode_coords=None,
-    drop_variables=None,
-    use_cftime=None,
-    decode_timedelta=None,
-    group=None,
-    mode="r",
-    synchronizer=None,
-    consolidated=False,
-    consolidate_on_close=False,
-    chunk_store=None,
-):
-
-    store = ZarrStore.open_group(
+class ZarrBackendEntrypoint(BackendEntrypoint):
+    def open_dataset(
+        self,
         filename_or_obj,
-        group=group,
-        mode=mode,
-        synchronizer=synchronizer,
-        consolidated=consolidated,
-        consolidate_on_close=consolidate_on_close,
-        chunk_store=chunk_store,
-    )
-
-    with close_on_error(store):
-        ds = open_backend_dataset_store(
-            store,
-            mask_and_scale=mask_and_scale,
-            decode_times=decode_times,
-            concat_characters=concat_characters,
-            decode_coords=decode_coords,
-            drop_variables=drop_variables,
-            use_cftime=use_cftime,
-            decode_timedelta=decode_timedelta,
+        mask_and_scale=True,
+        decode_times=None,
+        concat_characters=None,
+        decode_coords=None,
+        drop_variables=None,
+        use_cftime=None,
+        decode_timedelta=None,
+        group=None,
+        mode="r",
+        synchronizer=None,
+        consolidated=False,
+        consolidate_on_close=False,
+        chunk_store=None,
+    ):
+        store = ZarrStore.open_group(
+            filename_or_obj,
+            group=group,
+            mode=mode,
+            synchronizer=synchronizer,
+            consolidated=consolidated,
+            consolidate_on_close=consolidate_on_close,
+            chunk_store=chunk_store,
         )
-    return ds
-
 
-zarr_backend = BackendEntrypoint(open_dataset=open_backend_dataset_zarr)
+        store_entrypoint = StoreBackendEntrypoint()
+        with close_on_error(store):
+            ds = store_entrypoint.open_dataset(
+                store,
+                mask_and_scale=mask_and_scale,
+                decode_times=decode_times,
+                concat_characters=concat_characters,
+                decode_coords=decode_coords,
+                drop_variables=drop_variables,
+                use_cftime=use_cftime,
+                decode_timedelta=decode_timedelta,
+            )
+        return ds
 
 
 if has_zarr:
-    BACKEND_ENTRYPOINTS["zarr"] = zarr_backend
+    BACKEND_ENTRYPOINTS["zarr"] = ZarrBackendEntrypoint
diff --git a/xarray/tests/test_plugins.py b/xarray/tests/test_plugins.py
index 38ebce6d..64a1c563 100644
--- a/xarray/tests/test_plugins.py
+++ b/xarray/tests/test_plugins.py
@@ -6,19 +6,24 @@ import pytest
 from xarray.backends import common, plugins
 
 
-def dummy_open_dataset_args(filename_or_obj, *args):
-    pass
+class DummyBackendEntrypointArgs(common.BackendEntrypoint):
+    def open_dataset(filename_or_obj, *args):
+        pass
 
 
-def dummy_open_dataset_kwargs(filename_or_obj, **kwargs):
-    pass
+class DummyBackendEntrypointKwargs(common.BackendEntrypoint):
+    def open_dataset(filename_or_obj, **kwargs):
+        pass
 
 
-def dummy_open_dataset(filename_or_obj, *, decoder):
-    pass
+class DummyBackendEntrypoint1(common.BackendEntrypoint):
+    def open_dataset(self, filename_or_obj, *, decoder):
+        pass
 
 
-dummy_cfgrib = common.BackendEntrypoint(dummy_open_dataset)
+class DummyBackendEntrypoint2(common.BackendEntrypoint):
+    def open_dataset(self, filename_or_obj, *, decoder):
+        pass
 
 
 @pytest.fixture
@@ -65,46 +70,48 @@ def test_create_engines_dict():
 
 
 def test_set_missing_parameters():
-    backend_1 = common.BackendEntrypoint(dummy_open_dataset)
-    backend_2 = common.BackendEntrypoint(dummy_open_dataset, ("filename_or_obj",))
+    backend_1 = DummyBackendEntrypoint1
+    backend_2 = DummyBackendEntrypoint2
+    backend_2.open_dataset_parameters = ("filename_or_obj",)
     engines = {"engine_1": backend_1, "engine_2": backend_2}
     plugins.set_missing_parameters(engines)
 
     assert len(engines) == 2
-    engine_1 = engines["engine_1"]
-    assert engine_1.open_dataset_parameters == ("filename_or_obj", "decoder")
-    engine_2 = engines["engine_2"]
-    assert engine_2.open_dataset_parameters == ("filename_or_obj",)
+    assert backend_1.open_dataset_parameters == ("filename_or_obj", "decoder")
+    assert backend_2.open_dataset_parameters == ("filename_or_obj",)
+
+    backend = DummyBackendEntrypointKwargs()
+    backend.open_dataset_parameters = ("filename_or_obj", "decoder")
+    plugins.set_missing_parameters({"engine": backend})
+    assert backend.open_dataset_parameters == ("filename_or_obj", "decoder")
+
+    backend = DummyBackendEntrypointArgs()
+    backend.open_dataset_parameters = ("filename_or_obj", "decoder")
+    plugins.set_missing_parameters({"engine": backend})
+    assert backend.open_dataset_parameters == ("filename_or_obj", "decoder")
 
 
 def test_set_missing_parameters_raise_error():
 
-    backend = common.BackendEntrypoint(dummy_open_dataset_args)
+    backend = DummyBackendEntrypointKwargs()
     with pytest.raises(TypeError):
         plugins.set_missing_parameters({"engine": backend})
 
-    backend = common.BackendEntrypoint(
-        dummy_open_dataset_args, ("filename_or_obj", "decoder")
-    )
-    plugins.set_missing_parameters({"engine": backend})
-
-    backend = common.BackendEntrypoint(dummy_open_dataset_kwargs)
+    backend = DummyBackendEntrypointArgs()
     with pytest.raises(TypeError):
         plugins.set_missing_parameters({"engine": backend})
 
-    backend = common.BackendEntrypoint(
-        dummy_open_dataset_kwargs, ("filename_or_obj", "decoder")
-    )
-    plugins.set_missing_parameters({"engine": backend})
-
 
-@mock.patch("pkg_resources.EntryPoint.load", mock.MagicMock(return_value=dummy_cfgrib))
+@mock.patch(
+    "pkg_resources.EntryPoint.load",
+    mock.MagicMock(return_value=DummyBackendEntrypoint1),
+)
 def test_build_engines():
-    dummy_cfgrib_pkg_entrypoint = pkg_resources.EntryPoint.parse(
+    dummy_pkg_entrypoint = pkg_resources.EntryPoint.parse(
         "cfgrib = xarray.tests.test_plugins:backend_1"
     )
-    backend_entrypoints = plugins.build_engines([dummy_cfgrib_pkg_entrypoint])
-    assert backend_entrypoints["cfgrib"] is dummy_cfgrib
+    backend_entrypoints = plugins.build_engines([dummy_pkg_entrypoint])
+    assert isinstance(backend_entrypoints["cfgrib"], DummyBackendEntrypoint1)
     assert backend_entrypoints["cfgrib"].open_dataset_parameters == (
         "filename_or_obj",
         "decoder",
+ git diff 8cc34cb412ba89ebca12fc84f76a9e452628f1bc
+ source /opt/miniconda3/bin/activate
++ _CONDA_ROOT=/opt/miniconda3
++ . /opt/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ '[' -z x ']'
++ conda activate
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate
++ '[' -n '' ']'
++ local ask_conda
+++ PS1='(testbed) '
+++ __conda_exe shell.posix activate
+++ /opt/miniconda3/bin/conda shell.posix activate
++ ask_conda='. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/udunits2-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/proj4-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/geotiff-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/gdal-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/esmpy-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/esmf-deactivate.sh"
PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
++ eval '. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/udunits2-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/proj4-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/geotiff-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/gdal-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/esmpy-deactivate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/deactivate.d/esmf-deactivate.sh"
PS1='\''(base) '\''
export PATH='\''/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3'\''
export CONDA_SHLVL='\''3'\''
export CONDA_DEFAULT_ENV='\''base'\''
export CONDA_PROMPT_MODIFIER='\''(base) '\''
export CONDA_PREFIX_2='\''/opt/miniconda3/envs/testbed'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\'''
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/udunits2-deactivate.sh
++++ unset UDUNITS2_XML_PATH
++++ '[' -n '' ']'
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/proj4-deactivate.sh
++++ unset PROJ_DATA
++++ unset PROJ_NETWORK
++++ '[' -n '' ']'
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/libxml2_deactivate.sh
++++ test -n ''
++++ unset XML_CATALOG_FILES
++++ unset xml_catalog_files_libxml2
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/geotiff-deactivate.sh
++++ unset GEOTIFF_CSV
++++ '[' -n '' ']'
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/gdal-deactivate.sh
++++ unset GDAL_DATA
++++ '[' -n '' ']'
++++ unset GDAL_DRIVER_PATH
++++ '[' -n '' ']'
++++ unset CPL_ZIP_ENCODING
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/esmpy-deactivate.sh
++++ unset ESMFMKFILE
++++ '[' -n /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
++++ export ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
++++ ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
++++ unset _CONDA_SET_ESMFMKFILE
+++ . /opt/miniconda3/envs/testbed/etc/conda/deactivate.d/esmf-deactivate.sh
++++ unset ESMFMKFILE
++++ '[' -n '' ']'
+++ PS1='(base) '
+++ export PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ PATH=/opt/miniconda3/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
+++ export CONDA_PREFIX=/opt/miniconda3
+++ CONDA_PREFIX=/opt/miniconda3
+++ export CONDA_SHLVL=3
+++ CONDA_SHLVL=3
+++ export CONDA_DEFAULT_ENV=base
+++ CONDA_DEFAULT_ENV=base
+++ export 'CONDA_PROMPT_MODIFIER=(base) '
+++ CONDA_PROMPT_MODIFIER='(base) '
+++ export CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ CONDA_PREFIX_2=/opt/miniconda3/envs/testbed
+++ export CONDA_EXE=/opt/miniconda3/bin/conda
+++ CONDA_EXE=/opt/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ conda activate testbed
+ local cmd=activate
+ case "$cmd" in
+ __conda_activate activate testbed
+ '[' -n '' ']'
+ local ask_conda
++ PS1='(base) '
++ __conda_exe shell.posix activate testbed
++ /opt/miniconda3/bin/conda shell.posix activate testbed
+ ask_conda='PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmf-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmpy-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/gdal-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/geotiff-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/proj4-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/udunits2-activate.sh"'
+ eval 'PS1='\''(testbed) '\''
export PATH='\''/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin'\''
export CONDA_PREFIX='\''/opt/miniconda3/envs/testbed'\''
export CONDA_SHLVL='\''4'\''
export CONDA_DEFAULT_ENV='\''testbed'\''
export CONDA_PROMPT_MODIFIER='\''(testbed) '\''
export CONDA_PREFIX_3='\''/opt/miniconda3'\''
export CONDA_EXE='\''/opt/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/opt/miniconda3/bin/python'\''
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmf-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/esmpy-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/gdal-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/geotiff-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/proj4-activate.sh"
. "/opt/miniconda3/envs/testbed/etc/conda/activate.d/udunits2-activate.sh"'
++ PS1='(testbed) '
++ export PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/opt/miniconda3/envs/testbed/bin:/opt/miniconda3/condabin:/opt/miniconda3/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ export CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ CONDA_PREFIX=/opt/miniconda3/envs/testbed
++ export CONDA_SHLVL=4
++ CONDA_SHLVL=4
++ export CONDA_DEFAULT_ENV=testbed
++ CONDA_DEFAULT_ENV=testbed
++ export 'CONDA_PROMPT_MODIFIER=(testbed) '
++ CONDA_PROMPT_MODIFIER='(testbed) '
++ export CONDA_PREFIX_3=/opt/miniconda3
++ CONDA_PREFIX_3=/opt/miniconda3
++ export CONDA_EXE=/opt/miniconda3/bin/conda
++ CONDA_EXE=/opt/miniconda3/bin/conda
++ export _CE_M=
++ _CE_M=
++ export _CE_CONDA=
++ _CE_CONDA=
++ export CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ CONDA_PYTHON_EXE=/opt/miniconda3/bin/python
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/esmf-activate.sh
+++ '[' -n '' ']'
+++ '[' -f /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
+++ export ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/esmpy-activate.sh
+++ '[' -n /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
+++ export _CONDA_SET_ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ _CONDA_SET_ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ '[' -f /opt/miniconda3/envs/testbed/lib/esmf.mk ']'
+++ export ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
+++ ESMFMKFILE=/opt/miniconda3/envs/testbed/lib/esmf.mk
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/gdal-activate.sh
+++ '[' -n '' ']'
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/gdal ']'
+++ export GDAL_DATA=/opt/miniconda3/envs/testbed/share/gdal
+++ GDAL_DATA=/opt/miniconda3/envs/testbed/share/gdal
+++ export GDAL_DRIVER_PATH=/opt/miniconda3/envs/testbed/lib/gdalplugins
+++ GDAL_DRIVER_PATH=/opt/miniconda3/envs/testbed/lib/gdalplugins
+++ '[' '!' -d /opt/miniconda3/envs/testbed/lib/gdalplugins ']'
+++ export CPL_ZIP_ENCODING=UTF-8
+++ CPL_ZIP_ENCODING=UTF-8
+++ '[' -n '5.1.16(1)-release' ']'
+++ '[' -f /opt/miniconda3/envs/testbed/share/bash-completion/completions/gdalinfo ']'
+++ source /opt/miniconda3/envs/testbed/share/bash-completion/completions/gdalinfo
++++ function_exists _get_comp_words_by_ref
++++ declare -f -F _get_comp_words_by_ref
++++ return 1
++++ return 0
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/geotiff-activate.sh
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/epsg_csv ']'
+++ '[' -d /opt/miniconda3/envs/testbed/Library/share/epsg_csv ']'
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libarrow_activate.sh
+++ '[' -n '' ']'
+++ _la_log 'Beginning libarrow activation.'
+++ '[' '' = 1 ']'
+++ _la_gdb_prefix=/opt/miniconda3/envs/testbed/share/gdb/auto-load
+++ '[' '!' -w /opt/miniconda3/envs/testbed/share/gdb/auto-load ']'
+++ _la_placeholder=replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX
+++ _la_symlink_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib
+++ _la_orig_install_dir=/opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
+++ _la_log '          _la_gdb_prefix: /opt/miniconda3/envs/testbed/share/gdb/auto-load'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_placeholder: replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX'
+++ '[' '' = 1 ']'
+++ _la_log '         _la_symlink_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib'
+++ '[' '' = 1 ']'
+++ _la_log '    _la_orig_install_dir: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib'
+++ '[' '' = 1 ']'
+++ _la_log '  content of that folder:'
+++ '[' '' = 1 ']'
++++ ls -al /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib
++++ sed 's/^/      /'
+++ _la_log '      total 12
      drwxr-xr-x 2 root root 4096 Nov  4 19:56 .
      drwxr-xr-x 3 root root 4096 Nov  4 19:56 ..
      -rw-r--r-- 1 root root  971 Nov  4 19:56 libarrow.so.2100.0.0-gdb.py'
+++ '[' '' = 1 ']'
+++ for _la_target in "$_la_orig_install_dir/"*.py
+++ '[' '!' -e /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py ']'
++++ basename /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py
+++ _la_symlink=/opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py
+++ _la_log '   _la_target: /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py'
+++ '[' '' = 1 ']'
+++ _la_log '  _la_symlink: /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py'
+++ '[' '' = 1 ']'
+++ '[' -L /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py ']'
++++ readlink /opt/miniconda3/envs/testbed/share/gdb/auto-load//opt/miniconda3/envs/testbed/lib/libarrow.so.2100.0.0-gdb.py
+++ '[' /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py = /opt/miniconda3/envs/testbed/share/gdb/auto-load/replace_this_section_with_absolute_slashed_path_to_CONDA_PREFIX/lib/libarrow.so.2100.0.0-gdb.py ']'
+++ _la_log 'symlink $_la_symlink already exists and points to $_la_target, skipping.'
+++ '[' '' = 1 ']'
+++ continue
+++ _la_log 'Libarrow activation complete.'
+++ '[' '' = 1 ']'
+++ unset _la_gdb_prefix
+++ unset _la_log
+++ unset _la_orig_install_dir
+++ unset _la_placeholder
+++ unset _la_symlink
+++ unset _la_symlink_dir
+++ unset _la_target
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/libxml2_activate.sh
+++ test -n ''
+++ xml_catalog_files_libxml2=
+++ XML_CATALOG_FILES=
+++ conda_catalog_files=
+++ ifs_libxml2=' 	
'
+++ IFS=' '
+++ rem=/opt/miniconda3/envs/testbed
+++ for pre in ${rem}
+++ test '' = /opt/miniconda3/envs/testbed
+++ conda_catalog_files=/opt/miniconda3/envs/testbed
+++ rem=
+++ IFS=' 	
'
+++ conda_catalog_files='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ export 'XML_CATALOG_FILES=file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ XML_CATALOG_FILES='file:///opt/miniconda3/envs/testbed/etc/xml/catalog file:///etc/xml/catalog'
+++ unset conda_catalog_files ifs_libxml2 rem
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/proj4-activate.sh
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/proj ']'
+++ export PROJ_DATA=/opt/miniconda3/envs/testbed/share/proj
+++ PROJ_DATA=/opt/miniconda3/envs/testbed/share/proj
+++ '[' -f /opt/miniconda3/envs/testbed/share/proj/copyright_and_licenses.csv ']'
+++ export PROJ_NETWORK=ON
+++ PROJ_NETWORK=ON
++ . /opt/miniconda3/envs/testbed/etc/conda/activate.d/udunits2-activate.sh
+++ '[' -n '' ']'
+++ '[' -d /opt/miniconda3/envs/testbed/share/udunits ']'
+++ export UDUNITS2_XML_PATH=/opt/miniconda3/envs/testbed/share/udunits/udunits2.xml
+++ UDUNITS2_XML_PATH=/opt/miniconda3/envs/testbed/share/udunits/udunits2.xml
+ __conda_hashr
+ '[' -n '' ']'
+ '[' -n '' ']'
+ hash -r
+ python -m pip install -e .
Obtaining file:///testbed
  Preparing metadata (setup.py): started
  Preparing metadata (setup.py): finished with status 'done'
Requirement already satisfied: numpy>=1.15 in /opt/miniconda3/envs/testbed/lib/python3.10/site-packages (from xarray==0.16.3.dev94+g8cc34cb41) (1.23.0)
Requirement already satisfied: pandas>=0.25 in /opt/miniconda3/envs/testbed/lib/python3.10/site-packages (from xarray==0.16.3.dev94+g8cc34cb41) (1.5.3)
Requirement already satisfied: setuptools>=40.4 in /opt/miniconda3/envs/testbed/lib/python3.10/site-packages (from xarray==0.16.3.dev94+g8cc34cb41) (68.0.0)
Requirement already satisfied: python-dateutil>=2.8.1 in /opt/miniconda3/envs/testbed/lib/python3.10/site-packages (from pandas>=0.25->xarray==0.16.3.dev94+g8cc34cb41) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in /opt/miniconda3/envs/testbed/lib/python3.10/site-packages (from pandas>=0.25->xarray==0.16.3.dev94+g8cc34cb41) (2023.3)
Requirement already satisfied: six>=1.5 in /opt/miniconda3/envs/testbed/lib/python3.10/site-packages (from python-dateutil>=2.8.1->pandas>=0.25->xarray==0.16.3.dev94+g8cc34cb41) (1.16.0)
Installing collected packages: xarray
  Attempting uninstall: xarray
    Found existing installation: xarray 0.16.3.dev94+g8cc34cb41
    Uninstalling xarray-0.16.3.dev94+g8cc34cb41:
      Successfully uninstalled xarray-0.16.3.dev94+g8cc34cb41
  DEPRECATION: Legacy editable install of xarray==0.16.3.dev94+g8cc34cb41 from file:///testbed (setup.py develop) is deprecated. pip 25.3 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools >= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457
  Running setup.py develop for xarray
Successfully installed xarray
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
+ git apply -v -
Checking patch xarray/tests/test_dataarray_integrate.py...
Applied patch xarray/tests/test_dataarray_integrate.py cleanly.
+ python3 /root/trace.py --count -C coverage.cover --include-pattern '/testbed/(xarray/core/dataset\.py|xarray/core/dataarray\.py)' -m pytest --no-header -rA -p no:cacheprovider xarray/tests/test_dataarray_integrate.py
['--count', '-C', 'coverage.cover', '--include-pattern', '/testbed/(xarray/core/dataset\\.py|xarray/core/dataarray\\.py)']
============================= test session starts ==============================
collected 1 item

xarray/tests/test_dataarray_integrate.py F                               [100%]

=================================== FAILURES ===================================
_____________________ test_dataarray_integrate_coord_kwarg _____________________

    def test_dataarray_integrate_coord_kwarg():
        """
        Test that DataArray.integrate accepts 'coord' as an argument for
        consistency with Dataset.integrate.
        """
        da = DataArray([1, 2, 3], coords={"x": [0, 1, 2]}, dims="x")
        expected = da.integrate(dim="x")
>       actual = da.integrate(coord="x")
E       TypeError: DataArray.integrate() got an unexpected keyword argument 'coord'

/testbed/xarray/tests/test_dataarray_integrate.py:16: TypeError
=============================== warnings summary ===============================
xarray/__init__.py:1
  /testbed/xarray/__init__.py:1: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources

xarray/core/dask_array_compat.py:61
xarray/core/dask_array_compat.py:61
  /testbed/xarray/core/dask_array_compat.py:61: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(dask_version) > LooseVersion("2.9.0"):

xarray/core/pdcompat.py:45
  /testbed/xarray/core/pdcompat.py:45: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    if LooseVersion(pd.__version__) < "0.25.0":

../opt/miniconda3/envs/testbed/lib/python3.10/site-packages/setuptools/_distutils/version.py:345
  /opt/miniconda3/envs/testbed/lib/python3.10/site-packages/setuptools/_distutils/version.py:345: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    other = LooseVersion(other)

xarray/tests/__init__.py:59
xarray/tests/__init__.py:59
xarray/tests/__init__.py:59
xarray/tests/__init__.py:59
  /testbed/xarray/tests/__init__.py:59: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
    return version.LooseVersion(vstring)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED xarray/tests/test_dataarray_integrate.py::test_dataarray_integrate_coord_kwarg
======================== 1 failed, 9 warnings in 12.20s ========================
+ cat coverage.cover
{"/testbed/xarray/core/dataarray.py": {"1": 1, "2": 1, "3": 1, "4": 1, "5": 1, "22": 1, "23": 1, "25": 1, "26": 1, "38": 1, "39": 1, "40": 1, "46": 1, "47": 1, "52": 1, "53": 1, "54": 1, "55": 1, "56": 1, "57": 1, "58": 1, "65": 1, "73": 1, "74": 0, "76": 0, "77": 0, "78": 0, "79": 0, "80": 0, "81": 0, "82": 0, "83": 0, "84": 0, "85": 0, "86": 0, "87": 0, "90": 2, "92": 1, "175": 1, "193": 2, "218": 1, "221": 2, "4294": 1, "96": 2, "97": 1, "98": 0, "100": 0, "101": 0, "103": 0, "106": 1, "107": 1, "109": 1, "110": 0, "111": 0, "113": 0, "115": 0, "116": 0, "121": 0, "122": 0, "123": 0, "124": 0, "125": 1, "126": 0, "127": 0, "128": 0, "131": 2, "132": 1, "133": 0, "135": 1, "137": 1, "138": 2, "139": 1, "140": 0, "141": 0, "142": 0, "143": 0, "144": 0, "146": 1, "147": 2, "148": 3, "149": 0, "150": 0, "152": 0, "155": 2, "156": 1, "157": 0, "158": 0, "160": 0, "163": 1, "164": 0, "165": 0, "167": 0, "170": 1, "172": 1, "176": 1, "177": 0, "178": 1, "179": 0, "180": 0, "181": 0, "183": 0, "185": 0, "188": 0, "189": 0, "190": 1, "184": 0, "194": 1, "196": 1, "199": 1, "206": 1, "197": 0, "200": 0, "202": 0, "203": 0, "204": 0, "207": 0, "209": 0, "210": 0, "212": 0, "213": 0, "345": 1, "346": 1, "347": 1, "348": 1, "349": 1, "350": 1, "352": 1, "362": 1, "363": 1, "364": 1, "365": 1, "366": 1, "368": 1, "372": 2, "373": 2, "374": 2, "375": 2, "376": 2, "378": 2, "379": 2, "370": 8, "429": 2, "430": 1, "431": 2, "432": 1, "427": 4, "433": 1, "443": 3, "442": 4, "444": 1, "470": 1, "487": 1, "491": 3, "490": 4, "492": 1, "498": 1, "516": 3, "515": 4, "517": 1, "545": 2, "543": 6, "547": 2, "548": 2, "549": 1, "585": 1, "586": 1, "590": 1, "591": 1, "594": 1, "595": 1, "599": 1, "600": 1, "603": 1, "604": 1, "607": 1, "608": 1, "611": 1, "612": 1, "615": 1, "616": 1, "619": 1, "622": 1, "623": 1, "627": 1, "628": 1, "631": 1, "632": 1, "636": 1, "637": 1, "640": 1, "641": 1, "644": 1, "650": 1, "651": 1, "660": 1, "661": 1, "667": 1, "674": 1, "675": 1, "689": 1, "702": 1, "709": 1, "726": 1, "729": 1, "730": 1, "735": 1, "736": 1, "745": 1, "748": 1, "749": 1, "753": 1, "754": 1, "758": 1, "759": 1, "763": 1, "764": 1, "769": 1, "770": 1, "773": 1, "774": 1, "780": 1, "781": 1, "787": 2, "788": 2, "785": 4, "789": 1, "818": 1, "823": 1, "826": 1, "829": 1, "832": 1, "833": 1, "836": 1, "837": 1, "840": 1, "844": 1, "848": 1, "849": 1, "855": 1, "879": 1, "901": 1, "920": 1, "997": 1, "1000": 1, "1007": 1, "1009": 1, "1010": 1, "1023": 1, "1024": 2, "1025": 2, "1026": 2, "1016": 6, "1018": 2, "1019": 2, "1020": 1, "1021": 1, "1022": 1, "1027": 1, "1065": 2, "1066": 2, "1067": 2, "1063": 6, "1068": 1, "1069": 1, "1128": 2, "1129": 2, "1130": 1, "1131": 2, "1126": 6, "1132": 1, "1133": 1, "1218": 2, "1216": 4, "1219": 1, "1220": 1, "1235": 2, "1233": 4, "1236": 1, "1237": 1, "1252": 2, "1250": 4, "1253": 1, "1254": 1, "1268": 3, "1267": 4, "1269": 1, "1345": 2, "1346": 1, "1347": 2, "1348": 1, "1342": 5, "1344": 1, "1349": 1, "1406": 2, "1407": 2, "1408": 1, "1409": 2, "1410": 1, "1404": 6, "1411": 1, "1412": 1, "1479": 2, "1480": 2, "1481": 2, "1482": 2, "1477": 7, "1483": 1, "1484": 1, "1610": 2, "1611": 2, "1612": 2, "1607": 6, "1609": 1, "1613": 1, "1665": 2, "1663": 4, "1666": 1, "1667": 1, "1703": 2, "1702": 3, "1704": 1, "1764": 2, "1765": 1, "1762": 4, "1766": 1, "1767": 1, "1817": 2, "1818": 2, "1815": 5, "1819": 1, "1820": 1, "1875": 2, "1872": 4, "1874": 1, "1876": 1, "1905": 2, "1903": 4, "1906": 1, "1907": 1, "1940": 2, "1938": 4, "1941": 1, "1942": 1, "1999": 2, "2000": 2, "2001": 2, "1997": 5, "2002": 1, "2061": 1, "2134": 2, "2135": 2, "2131": 5, "2133": 1, "2136": 1, "2181": 1, "2182": 1, "2186": 3, "2185": 4, "2187": 1, "2209": 2, "2210": 2, "2207": 6, "2212": 2, "2214": 1, "2229": 2, "2227": 5, "2231": 2, "2233": 1, "2258": 1, "2281": 4, "2280": 5, "2282": 1, "2304": 1, "2333": 2, "2334": 2, "2335": 2, "2336": 2, "2339": 1, "2340": 2, "2331": 9, "2337": 2, "2338": 1, "2341": 1, "2342": 1, "2448": 1, "2472": 1, "2496": 1, "2517": 2, "2518": 2, "2519": 2, "2520": 2, "2514": 8, "2516": 1, "2521": 1, "2522": 1, "2559": 1, "2587": 3, "2586": 4, "2588": 1, "2644": 1, "2653": 1, "2671": 1, "2704": 1, "2729": 1, "2730": 1, "2785": 1, "2786": 1, "2808": 1, "2814": 1, "2815": 1, "2821": 1, "2827": 1, "2828": 1, "2834": 1, "2844": 1, "2859": 1, "2879": 1, "2893": 1, "2902": 1, "2906": 1, "2909": 1, "2914": 1, "2915": 1, "2934": 1, "2937": 2, "2938": 2, "2935": 5, "2936": 1, "2940": 1, "2963": 1, "2964": 1, "2991": 1, "2994": 1, "2996": 1, "3025": 1, "3074": 2, "3075": 2, "3072": 5, "3076": 1, "3077": 1, "3122": 2, "3123": 2, "3120": 5, "3124": 1, "3125": 1, "3170": 1, "3171": 1, "3174": 1, "3175": 1, "3179": 3, "3178": 4, "3180": 1, "3234": 2, "3231": 4, "3233": 1, "3235": 1, "3292": 2, "3293": 2, "3294": 2, "3295": 2, "3289": 7, "3291": 1, "3296": 1, "3383": 4, "3382": 5, "3384": 1, "3425": 4, "3424": 5, "3426": 1, "3484": 3, "3483": 4, "3485": 1, "3534": 1, "3553": 2, "3554": 2, "3555": 2, "3550": 6, "3552": 1, "3556": 1, "3659": 2, "3660": 2, "3661": 2, "3662": 2, "3663": 2, "3655": 8, "3657": 1, "3658": 1, "3720": 2, "3721": 2, "3724": 1, "3727": 1, "3730": 1, "3731": 2, "3718": 9, "3722": 2, "3723": 1, "3725": 2, "3726": 1, "3728": 2, "3729": 1, "3732": 1, "3733": 1, "3890": 2, "3891": 2, "3892": 2, "3893": 2, "3888": 6, "3894": 1, "3987": 2, "3988": 2, "3989": 2, "3990": 2, "3985": 6, "3991": 1, "4084": 2, "4085": 2, "4086": 2, "4087": 2, "4082": 6, "4088": 1, "4187": 2, "4188": 2, "4189": 2, "4190": 2, "4185": 6, "4191": 1, "4290": 1, "381": 3, "382": 2, "383": 2, "384": 2, "387": 1, "389": 0, "390": 0, "391": 0, "392": 0, "393": 0, "394": 0, "395": 0, "396": 0, "397": 0, "398": 0, "400": 1, "401": 0, "402": 1, "403": 1, "404": 1, "405": 1, "407": 1, "408": 1, "409": 1, "410": 1, "411": 2, "412": 1, "416": 3, "417": 3, "418": 3, "419": 3, "423": 3, "425": 3, "434": 1, "435": 0, "436": 1, "437": 0, "438": 1, "439": 1, "440": 1, "445": 0, "446": 0, "447": 0, "448": 0, "450": 0, "451": 0, "453": 0, "456": 0, "457": 0, "459": 0, "461": 0, "462": 0, "463": 0, "465": 0, "466": 0, "468": 0, "454": 0, "452": 0, "471": 0, "472": 0, "473": 0, "474": 0, "475": 0, "476": 0, "479": 0, "480": 0, "481": 0, "482": 0, "483": 0, "484": 0, "485": 0, "488": 1, "493": 1, "494": 1, "495": 1, "496": 1, "501": 0, "506": 0, "507": 0, "508": 0, "509": 0, "510": 0, "511": 0, "513": 0, "502": 0, "503": 0, "504": 0, "518": 1, "519": 0, "520": 1, "521": 0, "522": 0, "525": 1, "526": 0, "527": 0, "532": 1, "533": 1, "534": 1, "535": 0, "536": 0, "537": 1, "539": 1, "540": 1, "541": 1, "568": 0, "569": 0, "570": 0, "573": 0, "574": 0, "575": 0, "576": 0, "578": 0, "580": 0, "581": 0, "583": 0, "588": 1, "592": 0, "597": 2, "601": 0, "605": 0, "609": 0, "613": 0, "617": 0, "620": 0, "625": 0, "629": 0, "634": 0, "638": 0, "642": 0, "648": 0, "658": 0, "662": 0, "663": 0, "668": 0, "669": 0, "671": 0, "672": 0, "679": 0, "681": 0, "682": 0, "683": 0, "684": 0, "685": 0, "686": 0, "687": 0, "690": 0, "692": 0, "693": 0, "694": 0, "695": 0, "696": 0, "697": 0, "700": 0, "703": 0, "704": 0, "707": 0, "710": 0, "711": 0, "716": 0, "717": 0, "718": 0, "720": 0, "722": 0, "724": 0, "721": 0, "727": 0, "732": 0, "733": 0, "738": 0, "742": 0, "743": 0, "746": 0, "751": 0, "756": 0, "761": 0, "767": 0, "771": 0, "776": 0, "777": 0, "778": 0, "783": 1, "805": 0, "806": 0, "807": 0, "808": 0, "809": 0, "811": 0, "812": 0, "813": 0, "815": 0, "816": 0, "819": 0, "821": 0, "824": 0, "827": 0, "830": 0, "834": 0, "838": 0, "841": 0, "842": 0, "845": 0, "846": 0, "850": 0, "851": 0, "852": 0, "853": 0, "873": 0, "874": 0, "875": 0, "876": 0, "877": 0, "898": 0, "899": 0, "917": 0, "918": 0, "989": 0, "990": 0, "991": 0, "992": 0, "994": 0, "995": 0, "998": 0, "1003": 0, "1014": 0, "1055": 0, "1056": 0, "1058": 0, "1059": 0, "1061": 0, "1100": 0, "1102": 0, "1103": 0, "1104": 0, "1106": 0, "1111": 0, "1113": 0, "1114": 0, "1115": 0, "1116": 0, "1118": 0, "1119": 0, "1120": 0, "1121": 0, "1122": 0, "1124": 0, "1207": 0, "1208": 0, "1209": 0, "1210": 0, "1211": 0, "1212": 0, "1214": 0, "1230": 0, "1231": 0, "1247": 0, "1248": 0, "1264": 0, "1265": 0, "1332": 0, "1333": 0, "1335": 0, "1336": 0, "1338": 0, "1340": 0, "1395": 0, "1396": 0, "1397": 0, "1398": 0, "1399": 0, "1400": 0, "1401": 0, "1460": 0, "1461": 0, "1462": 0, "1463": 0, "1464": 0, "1465": 0, "1466": 0, "1468": 0, "1469": 0, "1470": 0, "1471": 0, "1472": 0, "1473": 0, "1475": 0, "1593": 0, "1594": 0, "1595": 0, "1596": 0, "1598": 0, "1599": 0, "1600": 0, "1601": 0, "1602": 0, "1603": 0, "1605": 0, "1653": 0, "1654": 0, "1655": 0, "1656": 0, "1658": 0, "1659": 0, "1661": 0, "1691": 0, "1692": 0, "1693": 0, "1695": 0, "1696": 0, "1697": 0, "1699": 0, "1700": 0, "1758": 0, "1759": 0, "1760": 0, "1802": 0, "1803": 0, "1804": 0, "1805": 0, "1806": 0, "1807": 0, "1808": 0, "1809": 0, "1811": 0, "1812": 0, "1813": 0, "1869": 0, "1870": 0, "1898": 0, "1899": 0, "1901": 0, "1926": 0, "1927": 0, "1928": 0, "1929": 0, "1930": 0, "1931": 0, "1932": 0, "1933": 0, "1934": 0, "1935": 0, "1936": 0, "1994": 0, "1995": 0, "2058": 0, "2059": 0, "2115": 0, "2116": 0, "2117": 0, "2119": 0, "2120": 0, "2121": 0, "2124": 0, "2125": 0, "2126": 0, "2129": 0, "2169": 0, "2170": 0, "2171": 0, "2172": 0, "2173": 0, "2174": 0, "2175": 0, "2176": 0, "2177": 0, "2179": 0, "2183": 0, "2204": 0, "2205": 0, "2224": 0, "2225": 0, "2252": 0, "2253": 0, "2255": 0, "2256": 0, "2276": 0, "2277": 0, "2278": 0, "2301": 0, "2302": 0, "2323": 0, "2324": 0, "2325": 0, "2328": 0, "2329": 0, "2435": 0, "2437": 0, "2438": 0, "2439": 0, "2440": 0, "2441": 0, "2442": 0, "2443": 0, "2444": 0, "2445": 0, "2468": 0, "2470": 0, "2492": 0, "2494": 0, "2512": 0, "2556": 0, "2557": 0, "2575": 0, "2576": 0, "2577": 0, "2578": 0, "2579": 0, "2580": 0, "2581": 0, "2583": 0, "2584": 0, "2617": 0, "2618": 0, "2619": 0, "2620": 0, "2621": 0, "2624": 0, "2625": 0, "2632": 0, "2633": 0, "2635": 0, "2636": 0, "2638": 0, "2640": 0, "2641": 0, "2642": 0, "2650": 0, "2651": 0, "2667": 0, "2668": 0, "2669": 0, "2688": 0, "2690": 0, "2692": 0, "2693": 0, "2696": 0, "2697": 0, "2700": 0, "2702": 0, "2723": 0, "2724": 0, "2725": 0, "2726": 0, "2727": 0, "2765": 0, "2766": 0, "2767": 0, "2768": 0, "2770": 0, "2772": 0, "2773": 0, "2774": 0, "2775": 0, "2777": 0, "2778": 0, "2779": 0, "2780": 0, "2782": 0, "2783": 0, "2769": 0, "2801": 0, "2802": 0, "2803": 0, "2804": 0, "2805": 0, "2806": 0, "2810": 0, "2812": 0, "2817": 0, "2819": 0, "2823": 0, "2825": 0, "2830": 0, "2832": 0, "2837": 0, "2840": 0, "2841": 0, "2838": 0, "2854": 0, "2855": 0, "2856": 0, "2857": 0, "2874": 0, "2875": 0, "2876": 0, "2877": 0, "2888": 0, "2889": 0, "2890": 0, "2891": 0, "2896": 0, "2897": 0, "2898": 0, "2900": 0, "2903": 0, "2904": 0, "2907": 0, "2912": 0, "2916": 9, "2917": 9, "2932": 9, "2918": 0, "2919": 0, "2920": 0, "2921": 0, "2922": 0, "2923": 0, "2924": 0, "2926": 0, "2927": 0, "2928": 0, "2929": 0, "2930": 0, "2941": 26, "2942": 26, "2961": 26, "2943": 0, "2944": 0, "2945": 0, "2946": 0, "2947": 0, "2948": 0, "2949": 0, "2953": 0, "2952": 0, "2954": 0, "2951": 0, "2956": 0, "2957": 0, "2959": 0, "2965": 10, "2966": 10, "2989": 10, "2967": 0, "2968": 0, "2969": 0, "2976": 0, "2977": 0, "2978": 0, "2979": 0, "2980": 0, "2987": 0, "2981": 0, "2982": 0, "2983": 0, "2986": 0, "2992": 0, "3012": 0, "3013": 0, "3014": 0, "3015": 0, "3016": 0, "3019": 0, "3020": 0, "3021": 0, "3023": 0, "3069": 0, "3070": 0, "3115": 0, "3116": 0, "3118": 0, "3165": 0, "3166": 0, "3168": 0, "3172": 0, "3176": 0, "3222": 0, "3223": 0, "3224": 0, "3226": 0, "3227": 0, "3229": 0, "3286": 0, "3287": 0, "3373": 0, "3374": 0, "3375": 0, "3376": 0, "3377": 0, "3378": 0, "3380": 0, "3421": 0, "3422": 0, "3480": 0, "3481": 0, "3531": 1, "3532": 1, "3547": 0, "3548": 0, "3651": 0, "3653": 0, "3714": 0, "3715": 0, "3877": 0, "3878": 0, "3879": 0, "3880": 0, "3881": 0, "3882": 0, "3883": 0, "3884": 0, "3886": 0, "3976": 0, "3977": 0, "3978": 0, "3979": 0, "3980": 0, "3981": 0, "3982": 0, "4073": 0, "4074": 0, "4075": 0, "4076": 0, "4077": 0, "4078": 0, "4079": 0, "4179": 0, "4180": 0, "4181": 0, "4183": 0, "4282": 0, "4283": 0, "4284": 0, "4286": 0}}
{"/testbed/xarray/core/dataset.py": {"1": 1, "2": 1, "3": 1, "4": 1, "5": 1, "6": 1, "7": 1, "8": 1, "9": 1, "10": 1, "11": 1, "12": 1, "34": 1, "35": 1, "37": 1, "39": 1, "40": 1, "41": 1, "54": 1, "55": 1, "60": 1, "65": 1, "66": 1, "74": 1, "75": 1, "81": 1, "82": 1, "83": 1, "84": 1, "99": 1, "107": 1, "108": 0, "109": 0, "110": 0, "112": 0, "114": 0, "115": 0, "116": 0, "117": 0, "121": 1, "140": 4, "139": 5, "141": 1, "187": 1, "218": 2, "214": 6, "215": 1, "216": 1, "217": 1, "219": 1, "304": 2, "299": 7, "300": 1, "301": 1, "302": 1, "303": 1, "305": 1, "357": 1, "362": 1, "385": 1, "422": 1, "423": 1, "424": 1, "425": 1, "418": 1, "446": 1, "459": 2, "500": 2, "512": 2, "7009": 1, "145": 0, "146": 0, "147": 0, "148": 0, "150": 0, "151": 0, "152": 0, "153": 0, "155": 0, "156": 0, "158": 0, "160": 0, "161": 0, "162": 0, "163": 0, "165": 0, "167": 0, "168": 0, "169": 0, "171": 0, "173": 0, "174": 0, "175": 0, "177": 0, "178": 0, "179": 0, "181": 0, "182": 0, "184": 0, "193": 2, "194": 2, "195": 7, "196": 5, "197": 5, "198": 2, "199": 0, "200": 0, "202": 2, "203": 1, "204": 1, "205": 1, "206": 0, "207": 0, "209": 0, "211": 2, "225": 0, "226": 0, "227": 0, "228": 0, "230": 0, "231": 0, "232": 0, "234": 0, "235": 0, "236": 0, "237": 0, "239": 0, "240": 0, "241": 0, "242": 0, "243": 0, "245": 0, "246": 0, "248": 0, "249": 0, "250": 0, "253": 0, "254": 0, "255": 0, "256": 0, "257": 0, "258": 0, "260": 0, "261": 0, "262": 0, "263": 0, "265": 0, "266": 0, "269": 0, "270": 0, "271": 0, "272": 0, "273": 0, "274": 0, "275": 0, "276": 0, "277": 0, "279": 0, "280": 0, "281": 0, "283": 0, "284": 0, "286": 0, "287": 0, "290": 0, "291": 0, "292": 0, "293": 0, "294": 0, "295": 0, "296": 0, "311": 0, "312": 0, "314": 0, "315": 0, "316": 0, "317": 0, "318": 0, "320": 0, "322": 0, "323": 0, "324": 0, "326": 0, "327": 0, "328": 0, "329": 0, "331": 0, "332": 0, "333": 0, "335": 0, "336": 0, "337": 0, "338": 0, "340": 0, "342": 0, "343": 0, "344": 0, "345": 0, "347": 0, "348": 0, "349": 0, "350": 0, "351": 0, "352": 0, "354": 0, "358": 0, "359": 0, "363": 0, "364": 0, "365": 0, "367": 0, "368": 0, "370": 0, "371": 0, "373": 0, "375": 0, "376": 0, "377": 0, "378": 0, "381": 0, "388": 0, "390": 0, "391": 0, "393": 0, "394": 0, "396": 0, "397": 0, "398": 0, "401": 0, "402": 0, "405": 0, "406": 0, "407": 0, "408": 0, "409": 0, "412": 0, "413": 0, "415": 0, "427": 0, "429": 0, "430": 0, "431": 0, "435": 0, "436": 0, "437": 0, "439": 0, "440": 0, "441": 0, "443": 0, "452": 0, "453": 0, "454": 0, "455": 0, "456": 0, "460": 1, "462": 1, "465": 1, "472": 1, "475": 1, "478": 1, "483": 1, "486": 1, "487": 1, "491": 1, "463": 1, "466": 0, "468": 0, "469": 0, "467": 0, "473": 0, "476": 1, "479": 0, "480": 0, "481": 0, "484": 0, "488": 0, "489": 0, "493": 0, "495": 0, "496": 0, "494": 0, "501": 1, "503": 1, "506": 1, "504": 0, "507": 0, "508": 0, "509": 0, "635": 1, "636": 1, "637": 1, "638": 1, "639": 1, "640": 1, "641": 1, "642": 1, "644": 1, "656": 1, "657": 1, "658": 1, "659": 1, "660": 1, "666": 2, "667": 2, "668": 2, "662": 4, "699": 1, "700": 1, "711": 1, "712": 1, "722": 1, "723": 1, "729": 1, "730": 1, "733": 1, "734": 1, "740": 1, "741": 1, "744": 1, "745": 1, "756": 1, "757": 1, "771": 1, "810": 1, "817": 1, "832": 1, "841": 1, "853": 1, "854": 1, "859": 1, "860": 1, "865": 1, "885": 1, "905": 1, "906": 1, "921": 1, "922": 1, "943": 1, "965": 1, "982": 1, "1003": 1, "1008": 1, "1009": 1, "1010": 1, "1011": 1, "1012": 1, "1004": 1, "1031": 2, "1032": 2, "1033": 2, "1034": 2, "1035": 2, "1036": 2, "1037": 2, "1029": 9, "1038": 1, "1082": 2, "1083": 2, "1084": 2, "1085": 2, "1079": 7, "1081": 1, "1086": 1, "1096": 2, "1097": 2, "1098": 2, "1099": 2, "1093": 7, "1095": 1, "1100": 1, "1112": 1, "1132": 1, "1258": 1, "1259": 1, "1271": 1, "1311": 1, "1337": 1, "1340": 1, "1345": 1, "1346": 1, "1351": 1, "1352": 1, "1363": 1, "1369": 1, "1372": 1, "1375": 1, "1378": 1, "1386": 1, "1387": 1, "1390": 1, "1391": 1, "1398": 1, "1399": 1, "1402": 1, "1403": 1, "1406": 1, "1407": 1, "1410": 1, "1424": 1, "1442": 1, "1453": 1, "1455": 1, "1467": 1, "1485": 1, "1505": 1, "1521": 1, "1522": 1, "1528": 1, "1529": 1, "1535": 1, "1536": 1, "1540": 1, "1571": 2, "1572": 2, "1569": 4, "1573": 1, "1609": 1, "1619": 1, "1620": 2, "1621": 2, "1622": 2, "1623": 2, "1624": 2, "1625": 2, "1626": 2, "1627": 2, "1617": 10, "1628": 1, "1715": 2, "1716": 2, "1717": 2, "1718": 1, "1719": 2, "1720": 2, "1721": 2, "1722": 2, "1723": 2, "1724": 2, "1713": 11, "1725": 1, "1815": 1, "1818": 1, "1823": 1, "1858": 1, "1859": 1, "1881": 1, "1882": 2, "1883": 2, "1884": 2, "1875": 6, "1877": 2, "1878": 2, "1879": 1, "1880": 1, "1885": 1, "1937": 3, "1936": 4, "1938": 1, "1978": 3, "1979": 1, "1980": 1, "2000": 1, "2040": 2, "2041": 2, "2042": 2, "2038": 6, "2043": 1, "2044": 1, "2135": 2, "2130": 5, "2132": 1, "2134": 1, "2136": 1, "2174": 2, "2175": 2, "2176": 2, "2177": 2, "2172": 7, "2178": 1, "2179": 1, "2250": 2, "2248": 4, "2251": 1, "2252": 1, "2297": 2, "2295": 4, "2298": 1, "2299": 1, "2347": 2, "2345": 4, "2348": 1, "2349": 1, "2396": 3, "2395": 4, "2397": 1, "2422": 2, "2423": 2, "2424": 2, "2425": 2, "2419": 7, "2421": 1, "2426": 1, "2482": 2, "2483": 2, "2484": 2, "2485": 2, "2486": 2, "2480": 8, "2487": 1, "2488": 1, "2695": 2, "2696": 2, "2697": 2, "2698": 2, "2699": 2, "2700": 2, "2693": 9, "2701": 1, "2702": 1, "2729": 2, "2730": 2, "2731": 2, "2732": 2, "2727": 7, "2733": 1, "2734": 1, "2933": 2, "2934": 2, "2935": 2, "2930": 6, "2932": 1, "2936": 1, "2995": 1, "3009": 1, "3012": 1, "3028": 1, "3036": 2, "3034": 4, "3037": 1, "3038": 1, "3077": 3, "3076": 4, "3078": 1, "3122": 3, "3121": 4, "3123": 1, "3160": 2, "3159": 3, "3161": 1, "3266": 2, "3267": 2, "3264": 5, "3268": 1, "3269": 1, "3398": 2, "3399": 2, "3396": 5, "3400": 1, "3401": 1, "3463": 2, "3460": 4, "3462": 1, "3464": 1, "3496": 2, "3494": 4, "3497": 1, "3498": 1, "3531": 1, "3563": 2, "3561": 4, "3564": 1, "3565": 1, "3603": 2, "3604": 2, "3599": 6, "3601": 1, "3602": 1, "3605": 1, "3719": 1, "3750": 4, "3751": 2, "3752": 1, "3791": 2, "3792": 2, "3793": 2, "3789": 5, "3794": 1, "3883": 1, "3915": 2, "3916": 2, "3917": 2, "3918": 2, "3912": 7, "3914": 1, "3919": 1, "3982": 3, "3981": 4, "3983": 1, "3994": 3, "3993": 4, "3995": 1, "4027": 1, "4076": 1, "4145": 1, "4211": 3, "4210": 4, "4212": 1, "4253": 1, "4297": 2, "4298": 2, "4299": 2, "4294": 5, "4296": 1, "4355": 1, "4440": 2, "4441": 2, "4442": 2, "4443": 2, "4446": 1, "4438": 8, "4444": 2, "4445": 1, "4447": 1, "4448": 1, "4573": 1, "4598": 1, "4623": 1, "4645": 2, "4646": 2, "4647": 2, "4648": 2, "4642": 8, "4644": 1, "4649": 1, "4650": 1, "4736": 2, "4737": 2, "4733": 6, "4735": 1, "4738": 1, "4739": 1, "4796": 2, "4797": 2, "4793": 6, "4795": 1, "4798": 1, "4799": 1, "4815": 3, "4814": 4, "4816": 1, "4906": 1, "4941": 2, "4940": 3, "4942": 1, "4970": 1, "4979": 1, "5010": 5, "5011": 3, "5012": 1, "5042": 5, "5043": 3, "5044": 1, "5079": 1, "5080": 1, "5149": 1, "5220": 1, "5251": 1, "5252": 1, "5323": 1, "5324": 1, "5343": 1, "5344": 1, "5360": 1, "5361": 1, "5388": 1, "5431": 1, "5437": 1, "5521": 1, "5582": 1, "5663": 1, "5721": 1, "5722": 1, "5723": 1, "5724": 1, "5725": 1, "5718": 1, "5862": 1, "5907": 1, "5966": 1, "6025": 1, "6072": 1, "6073": 1, "6076": 1, "6077": 1, "6080": 1, "6082": 1, "6173": 1, "6222": 2, "6223": 2, "6224": 2, "6219": 6, "6221": 1, "6225": 1, "6332": 2, "6333": 2, "6334": 2, "6335": 2, "6336": 2, "6328": 8, "6330": 1, "6331": 1, "6521": 2, "6522": 2, "6525": 1, "6528": 1, "6531": 1, "6532": 2, "6519": 9, "6523": 2, "6524": 1, "6526": 2, "6527": 1, "6529": 2, "6530": 1, "6533": 1, "6534": 1, "6688": 2, "6689": 2, "6690": 2, "6691": 2, "6686": 6, "6692": 1, "6786": 2, "6787": 2, "6788": 2, "6789": 2, "6784": 6, "6790": 1, "6882": 1, "6945": 1, "672": 0, "673": 0, "674": 0, "675": 0, "677": 0, "678": 0, "679": 0, "680": 0, "681": 0, "684": 0, "685": 0, "687": 0, "688": 0, "691": 0, "692": 0, "693": 0, "694": 0, "695": 0, "696": 0, "697": 0, "704": 0, "705": 0, "706": 0, "707": 0, "708": 0, "709": 0, "720": 4, "725": 0, "726": 0, "727": 0, "731": 0, "736": 0, "737": 0, "738": 0, "742": 0, "754": 0, "769": 0, "791": 0, "792": 0, "794": 0, "795": 0, "798": 0, "800": 0, "801": 0, "804": 0, "805": 0, "806": 0, "808": 0, "811": 0, "813": 0, "814": 0, "818": 0, "819": 0, "820": 0, "821": 0, "823": 0, "824": 0, "826": 0, "827": 0, "828": 0, "830": 0, "833": 0, "835": 0, "837": 0, "838": 0, "836": 0, "842": 0, "844": 0, "845": 0, "847": 0, "850": 0, "848": 0, "846": 0, "855": 0, "857": 0, "861": 0, "863": 0, "866": 0, "868": 0, "872": 0, "875": 0, "876": 0, "877": 0, "878": 0, "879": 0, "880": 0, "881": 0, "874": 0, "883": 0, "870": 0, "869": 0, "871": 0, "886": 0, "888": 0, "892": 0, "895": 0, "896": 0, "897": 0, "898": 0, "899": 0, "900": 0, "901": 0, "894": 0, "903": 0, "890": 0, "889": 0, "891": 0, "907": 0, "908": 0, "909": 0, "910": 0, "911": 0, "912": 0, "913": 0, "915": 0, "916": 0, "918": 0, "919": 0, "923": 0, "927": 0, "928": 0, "929": 0, "930": 0, "931": 0, "932": 0, "933": 0, "935": 0, "936": 0, "938": 0, "939": 0, "941": 0, "962": 0, "963": 0, "968": 0, "969": 0, "971": 0, "972": 0, "975": 0, "977": 0, "978": 0, "980": 0, "1000": 0, "1001": 0, "1017": 2, "1018": 1, "1019": 2, "1020": 2, "1021": 2, "1022": 2, "1023": 2, "1024": 2, "1025": 2, "1026": 2, "1027": 2, "1047": 1, "1048": 0, "1049": 0, "1050": 0, "1051": 0, "1052": 0, "1053": 0, "1054": 0, "1055": 0, "1056": 0, "1057": 0, "1058": 0, "1059": 0, "1060": 0, "1077": 1, "1062": 1, "1063": 0, "1064": 1, "1065": 0, "1066": 1, "1067": 0, "1068": 1, "1069": 1, "1070": 1, "1071": 0, "1072": 1, "1073": 1, "1074": 2, "1075": 1, "1088": 1, "1089": 2, "1090": 1, "1106": 0, "1107": 0, "1108": 0, "1109": 0, "1113": 0, "1114": 0, "1116": 0, "1117": 0, "1118": 0, "1119": 0, "1120": 0, "1121": 0, "1124": 0, "1125": 0, "1126": 0, "1127": 0, "1128": 0, "1129": 0, "1130": 0, "1230": 0, "1231": 0, "1232": 0, "1233": 0, "1235": 0, "1236": 0, "1237": 0, "1238": 0, "1239": 0, "1240": 0, "1241": 0, "1243": 0, "1244": 0, "1245": 0, "1246": 0, "1247": 0, "1249": 0, "1251": 0, "1254": 0, "1256": 0, "1250": 0, "1263": 0, "1264": 0, "1265": 0, "1266": 0, "1267": 0, "1268": 0, "1269": 0, "1275": 0, "1276": 0, "1277": 0, "1279": 0, "1280": 0, "1281": 0, "1282": 0, "1283": 0, "1284": 0, "1286": 0, "1287": 0, "1288": 0, "1289": 0, "1290": 0, "1292": 0, "1293": 0, "1294": 0, "1296": 0, "1299": 0, "1300": 0, "1301": 0, "1303": 0, "1304": 0, "1305": 0, "1306": 0, "1307": 0, "1309": 0, "1313": 1, "1315": 1, "1316": 1, "1317": 0, "1318": 0, "1319": 0, "1322": 1, "1324": 1, "1326": 3, "1327": 2, "1328": 1, "1330": 1, "1331": 0, "1333": 3, "1335": 1, "1338": 0, "1343": 0, "1348": 0, "1349": 0, "1354": 0, "1355": 0, "1358": 0, "1361": 0, "1367": 0, "1370": 0, "1373": 0, "1376": 0, "1379": 0, "1380": 0, "1388": 0, "1395": 0, "1400": 0, "1404": 0, "1408": 0, "1416": 1, "1417": 0, "1419": 1, "1420": 1, "1422": 0, "1435": 0, "1436": 0, "1437": 0, "1440": 0, "1444": 0, "1445": 0, "1446": 0, "1447": 0, "1448": 0, "1449": 0, "1460": 0, "1463": 0, "1464": 0, "1461": 0, "1480": 0, "1481": 0, "1482": 0, "1483": 0, "1500": 0, "1501": 0, "1502": 0, "1503": 0, "1514": 0, "1515": 0, "1516": 0, "1518": 0, "1519": 0, "1524": 1, "1525": 0, "1526": 1, "1533": 2, "1538": 1, "1560": 0, "1561": 0, "1563": 0, "1564": 0, "1565": 0, "1566": 0, "1567": 0, "1589": 0, "1590": 0, "1592": 0, "1593": 0, "1595": 0, "1596": 0, "1597": 0, "1598": 0, "1599": 0, "1600": 0, "1602": 0, "1603": 0, "1604": 0, "1605": 0, "1606": 0, "1607": 0, "1611": 0, "1615": 0, "1696": 0, "1697": 0, "1698": 0, "1700": 0, "1701": 0, "1702": 0, "1703": 0, "1704": 0, "1705": 0, "1706": 0, "1707": 0, "1708": 0, "1709": 0, "1710": 0, "1796": 0, "1798": 0, "1799": 0, "1801": 0, "1802": 0, "1803": 0, "1804": 0, "1805": 0, "1806": 0, "1807": 0, "1808": 0, "1809": 0, "1810": 0, "1811": 0, "1812": 0, "1816": 0, "1819": 0, "1820": 0, "1821": 0, "1837": 0, "1838": 0, "1840": 0, "1841": 0, "1842": 0, "1843": 0, "1844": 0, "1845": 0, "1846": 0, "1847": 0, "1848": 0, "1849": 0, "1850": 0, "1851": 0, "1852": 0, "1853": 0, "1854": 0, "1856": 0, "1863": 0, "1864": 0, "1865": 0, "1866": 0, "1867": 0, "1868": 0, "1869": 0, "1872": 0, "1873": 0, "1913": 0, "1914": 0, "1915": 0, "1917": 0, "1919": 0, "1921": 0, "1922": 0, "1924": 0, "1925": 0, "1926": 0, "1927": 0, "1930": 0, "1932": 0, "1934": 0, "1931": 0, "1945": 0, "1947": 0, "1950": 0, "1951": 0, "1952": 0, "1953": 0, "1954": 0, "1955": 0, "1956": 0, "1957": 0, "1958": 0, "1959": 0, "1960": 0, "1962": 0, "1964": 0, "1965": 0, "1966": 0, "1967": 0, "1968": 0, "1969": 0, "1971": 0, "1972": 0, "1973": 0, "1974": 0, "1976": 0, "1982": 0, "1983": 0, "1984": 0, "1985": 0, "1987": 0, "1988": 0, "1989": 0, "1990": 0, "1991": 0, "1992": 0, "1993": 0, "1994": 0, "1996": 0, "1998": 0, "2006": 0, "2008": 0, "2009": 0, "2010": 0, "2011": 0, "2012": 0, "2013": 0, "2014": 0, "2016": 0, "2020": 0, "2022": 0, "2023": 0, "2028": 0, "2029": 0, "2032": 0, "2033": 0, "2034": 0, "2036": 0, "2090": 0, "2091": 0, "2092": 0, "2096": 0, "2098": 0, "2099": 0, "2100": 0, "2101": 0, "2103": 0, "2104": 0, "2105": 0, "2106": 0, "2107": 0, "2108": 0, "2109": 0, "2110": 0, "2111": 0, "2112": 0, "2113": 0, "2114": 0, "2116": 0, "2117": 0, "2118": 0, "2120": 0, "2121": 0, "2122": 0, "2123": 0, "2124": 0, "2125": 0, "2126": 0, "2127": 0, "2139": 0, "2141": 0, "2142": 0, "2144": 0, "2145": 0, "2146": 0, "2147": 0, "2149": 0, "2150": 0, "2151": 0, "2153": 0, "2154": 0, "2155": 0, "2156": 0, "2158": 0, "2160": 0, "2162": 0, "2163": 0, "2166": 0, "2167": 0, "2168": 0, "2169": 0, "2170": 0, "2241": 0, "2242": 0, "2243": 0, "2245": 0, "2246": 0, "2273": 0, "2274": 0, "2275": 0, "2276": 0, "2277": 0, "2278": 0, "2279": 0, "2280": 0, "2281": 0, "2282": 0, "2283": 0, "2284": 0, "2285": 0, "2287": 0, "2288": 0, "2289": 0, "2290": 0, "2292": 0, "2293": 0, "2320": 0, "2321": 0, "2322": 0, "2323": 0, "2324": 0, "2325": 0, "2326": 0, "2327": 0, "2328": 0, "2329": 0, "2330": 0, "2331": 0, "2332": 0, "2334": 0, "2335": 0, "2336": 0, "2337": 0, "2339": 0, "2341": 0, "2343": 0, "2340": 0, "2371": 0, "2370": 0, "2372": 0, "2373": 0, "2375": 0, "2376": 0, "2377": 0, "2378": 0, "2379": 0, "2380": 0, "2381": 0, "2382": 0, "2383": 0, "2385": 0, "2386": 0, "2387": 0, "2388": 0, "2390": 0, "2391": 0, "2392": 0, "2393": 0, "2409": 0, "2410": 0, "2412": 0, "2413": 0, "2415": 0, "2417": 0, "2471": 0, "2472": 0, "2473": 0, "2474": 0, "2475": 0, "2476": 0, "2477": 0, "2683": 0, "2684": 0, "2685": 0, "2686": 0, "2687": 0, "2688": 0, "2689": 0, "2690": 0, "2706": 0, "2708": 0, "2709": 0, "2710": 0, "2712": 0, "2713": 0, "2714": 0, "2715": 0, "2716": 0, "2717": 0, "2718": 0, "2719": 0, "2720": 0, "2721": 0, "2723": 0, "2724": 0, "2725": 0, "2849": 0, "2851": 0, "2852": 0, "2854": 0, "2855": 0, "2857": 0, "2862": 0, "2863": 0, "2864": 0, "2861": 0, "2866": 0, "2868": 0, "2870": 0, "2877": 0, "2893": 0, "2894": 0, "2895": 0, "2896": 0, "2898": 0, "2899": 0, "2901": 0, "2904": 0, "2905": 0, "2907": 0, "2909": 0, "2910": 0, "2911": 0, "2912": 0, "2916": 0, "2917": 0, "2918": 0, "2919": 0, "2920": 0, "2923": 0, "2924": 0, "2925": 0, "2927": 0, "2928": 0, "2872": 0, "2873": 0, "2874": 0, "2875": 0, "2881": 0, "2882": 0, "2883": 0, "2884": 0, "2885": 0, "2889": 0, "2891": 0, "2902": 0, "2900": 0, "2975": 0, "2976": 0, "2977": 0, "2979": 0, "2980": 0, "2981": 0, "2982": 0, "2983": 0, "2985": 0, "2987": 0, "2988": 0, "2991": 0, "2992": 0, "2996": 0, "2997": 0, "2998": 0, "2999": 0, "3000": 0, "3001": 0, "3002": 0, "3003": 0, "3004": 0, "3005": 0, "3006": 0, "3007": 0, "3010": 0, "3013": 0, "3014": 0, "3015": 0, "3016": 0, "3017": 0, "3018": 0, "3019": 0, "3020": 0, "3021": 0, "3022": 0, "3024": 0, "3025": 0, "3026": 0, "3029": 0, "3030": 0, "3031": 0, "3032": 0, "3062": 0, "3063": 0, "3064": 0, "3065": 0, "3066": 0, "3067": 0, "3070": 0, "3071": 0, "3073": 0, "3074": 0, "3103": 0, "3104": 0, "3105": 0, "3106": 0, "3107": 0, "3108": 0, "3110": 0, "3111": 0, "3112": 0, "3116": 0, "3117": 0, "3119": 0, "3147": 0, "3148": 0, "3149": 0, "3150": 0, "3151": 0, "3152": 0, "3154": 0, "3155": 0, "3157": 0, "3225": 0, "3226": 0, "3227": 0, "3228": 0, "3229": 0, "3230": 0, "3232": 0, "3233": 0, "3234": 0, "3235": 0, "3238": 0, "3240": 0, "3241": 0, "3243": 0, "3244": 0, "3245": 0, "3246": 0, "3247": 0, "3248": 0, "3249": 0, "3250": 0, "3252": 0, "3253": 0, "3255": 0, "3256": 0, "3258": 0, "3259": 0, "3260": 0, "3262": 0, "3303": 0, "3304": 0, "3305": 0, "3308": 0, "3309": 0, "3310": 0, "3311": 0, "3313": 0, "3314": 0, "3315": 0, "3316": 0, "3317": 0, "3318": 0, "3320": 0, "3321": 0, "3323": 0, "3324": 0, "3325": 0, "3326": 0, "3328": 0, "3329": 0, "3330": 0, "3331": 0, "3332": 0, "3333": 0, "3334": 0, "3335": 0, "3336": 0, "3339": 0, "3340": 0, "3343": 0, "3344": 0, "3349": 0, "3350": 0, "3351": 0, "3352": 0, "3353": 0, "3355": 0, "3356": 0, "3357": 0, "3360": 0, "3361": 0, "3362": 0, "3363": 0, "3365": 0, "3366": 0, "3367": 0, "3368": 0, "3369": 0, "3370": 0, "3373": 0, "3374": 0, "3375": 0, "3378": 0, "3380": 0, "3381": 0, "3382": 0, "3383": 0, "3387": 0, "3389": 0, "3390": 0, "3392": 0, "3393": 0, "3454": 0, "3455": 0, "3456": 0, "3458": 0, "3485": 0, "3486": 0, "3487": 0, "3488": 0, "3489": 0, "3490": 0, "3492": 0, "3517": 0, "3518": 0, "3519": 0, "3520": 0, "3521": 0, "3522": 0, "3523": 0, "3524": 0, "3525": 0, "3526": 0, "3527": 0, "3529": 0, "3532": 0, "3533": 0, "3534": 0, "3535": 0, "3536": 0, "3537": 0, "3538": 0, "3539": 0, "3540": 0, "3541": 0, "3542": 0, "3543": 0, "3545": 0, "3548": 0, "3549": 0, "3550": 0, "3552": 0, "3554": 0, "3555": 0, "3557": 0, "3558": 0, "3593": 0, "3594": 0, "3595": 0, "3596": 0, "3597": 0, "3672": 0, "3674": 0, "3675": 0, "3676": 0, "3677": 0, "3678": 0, "3679": 0, "3680": 0, "3683": 0, "3701": 0, "3702": 0, "3707": 0, "3708": 0, "3709": 0, "3711": 0, "3712": 0, "3714": 0, "3715": 0, "3717": 0, "3684": 0, "3685": 0, "3686": 0, "3687": 0, "3689": 0, "3690": 0, "3692": 0, "3695": 0, "3696": 0, "3697": 0, "3694": 0, "3720": 0, "3721": 0, "3723": 0, "3724": 0, "3726": 0, "3727": 0, "3728": 0, "3729": 0, "3730": 0, "3732": 0, "3734": 0, "3735": 0, "3738": 0, "3740": 0, "3741": 0, "3742": 0, "3744": 0, "3746": 0, "3747": 0, "3753": 0, "3754": 0, "3755": 0, "3758": 0, "3759": 0, "3761": 0, "3762": 0, "3765": 0, "3766": 0, "3768": 0, "3769": 0, "3771": 0, "3772": 0, "3773": 0, "3774": 0, "3775": 0, "3777": 0, "3779": 0, "3780": 0, "3781": 0, "3783": 0, "3785": 0, "3786": 0, "3822": 0, "3823": 0, "3824": 0, "3827": 0, "3828": 0, "3830": 0, "3832": 0, "3833": 0, "3834": 0, "3835": 0, "3838": 0, "3839": 0, "3841": 0, "3842": 0, "3843": 0, "3844": 0, "3847": 0, "3848": 0, "3854": 0, "3850": 0, "3858": 0, "3860": 0, "3862": 0, "3864": 0, "3874": 0, "3875": 0, "3878": 0, "3880": 0, "3881": 0, "3859": 0, "3909": 0, "3910": 0, "3970": 0, "3971": 0, "3972": 0, "3973": 0, "3974": 0, "3975": 0, "3976": 0, "3977": 0, "3979": 0, "3984": 0, "3985": 0, "3986": 0, "3987": 0, "3988": 0, "3989": 0, "4013": 0, "4014": 0, "4016": 0, "4017": 0, "4018": 0, "4020": 0, "4021": 0, "4022": 0, "4023": 0, "4024": 0, "4037": 0, "4038": 0, "4040": 0, "4041": 0, "4042": 0, "4043": 0, "4044": 0, "4046": 0, "4048": 0, "4049": 0, "4050": 0, "4051": 0, "4053": 0, "4054": 0, "4055": 0, "4056": 0, "4057": 0, "4059": 0, "4060": 0, "4061": 0, "4062": 0, "4064": 0, "4065": 0, "4067": 0, "4069": 0, "4070": 0, "4071": 0, "4072": 0, "4074": 0, "4125": 0, "4126": 0, "4128": 0, "4130": 0, "4131": 0, "4134": 0, "4135": 0, "4136": 0, "4137": 0, "4138": 0, "4139": 0, "4140": 0, "4141": 0, "4142": 0, "4143": 0, "4194": 0, "4196": 0, "4197": 0, "4198": 0, "4201": 0, "4202": 0, "4203": 0, "4204": 0, "4205": 0, "4206": 0, "4207": 0, "4208": 0, "4235": 0, "4236": 0, "4238": 0, "4239": 0, "4241": 0, "4243": 0, "4244": 0, "4245": 0, "4246": 0, "4247": 0, "4250": 0, "4251": 0, "4282": 0, "4283": 0, "4284": 0, "4285": 0, "4286": 0, "4288": 0, "4289": 0, "4290": 0, "4291": 0, "4292": 0, "4326": 0, "4327": 0, "4329": 0, "4330": 0, "4332": 0, "4333": 0, "4335": 0, "4336": 0, "4337": 0, "4338": 0, "4339": 0, "4340": 0, "4342": 0, "4343": 0, "4344": 0, "4345": 0, "4346": 0, "4347": 0, "4348": 0, "4349": 0, "4351": 0, "4353": 0, "4428": 0, "4429": 0, "4430": 0, "4431": 0, "4432": 0, "4435": 0, "4436": 0, "4559": 0, "4561": 0, "4562": 0, "4563": 0, "4564": 0, "4565": 0, "4566": 0, "4567": 0, "4568": 0, "4569": 0, "4571": 0, "4593": 0, "4595": 0, "4596": 0, "4618": 0, "4620": 0, "4621": 0, "4639": 0, "4640": 0, "4681": 0, "4682": 0, "4683": 0, "4684": 0, "4686": 0, "4688": 0, "4689": 0, "4690": 0, "4691": 0, "4694": 0, "4695": 0, "4697": 0, "4698": 0, "4699": 0, "4700": 0, "4701": 0, "4702": 0, "4705": 0, "4704": 0, "4706": 0, "4707": 0, "4709": 0, "4712": 0, "4713": 0, "4717": 0, "4718": 0, "4719": 0, "4720": 0, "4721": 0, "4722": 0, "4723": 0, "4726": 0, "4727": 0, "4728": 0, "4729": 0, "4730": 0, "4781": 0, "4782": 0, "4783": 0, "4785": 0, "4787": 0, "4788": 0, "4789": 0, "4790": 0, "4791": 0, "4784": 0, "4807": 0, "4808": 0, "4809": 0, "4810": 0, "4812": 0, "4898": 0, "4899": 0, "4901": 0, "4903": 0, "4904": 0, "4924": 0, "4926": 0, "4927": 0, "4928": 0, "4930": 0, "4931": 0, "4932": 0, "4934": 0, "4936": 0, "4937": 0, "4958": 0, "4959": 0, "4960": 0, "4961": 0, "4962": 0, "4963": 0, "4966": 0, "4968": 0, "4971": 0, "4972": 0, "4974": 0, "4976": 0, "4977": 0, "4973": 0, "5006": 0, "5008": 0, "5013": 0, "5015": 0, "5016": 0, "5017": 0, "5018": 0, "5020": 0, "5021": 0, "5022": 0, "5024": 0, "5029": 0, "5030": 0, "5032": 0, "5033": 0, "5034": 0, "5035": 0, "5036": 0, "5037": 0, "5038": 0, "5040": 0, "5045": 0, "5046": 0, "5047": 0, "5048": 0, "5054": 0, "5055": 0, "5060": 0, "5062": 0, "5066": 0, "5067": 0, "5068": 0, "5075": 0, "5076": 0, "5077": 0, "5113": 0, "5114": 0, "5116": 0, "5118": 0, "5119": 0, "5120": 0, "5127": 0, "5129": 0, "5131": 0, "5132": 0, "5134": 0, "5136": 0, "5137": 0, "5139": 0, "5140": 0, "5141": 0, "5143": 0, "5144": 0, "5147": 0, "5146": 0, "5133": 0, "5178": 0, "5179": 0, "5181": 0, "5183": 0, "5184": 0, "5185": 0, "5187": 0, "5188": 0, "5189": 0, "5190": 0, "5191": 0, "5193": 0, "5194": 0, "5195": 0, "5198": 0, "5199": 0, "5201": 0, "5202": 0, "5203": 0, "5205": 0, "5207": 0, "5208": 0, "5210": 0, "5211": 0, "5212": 0, "5218": 0, "5216": 0, "5240": 0, "5241": 0, "5242": 0, "5243": 0, "5239": 0, "5245": 0, "5246": 0, "5247": 0, "5248": 0, "5249": 0, "5296": 0, "5297": 0, "5299": 0, "5301": 0, "5302": 0, "5304": 0, "5305": 0, "5306": 0, "5308": 0, "5309": 0, "5310": 0, "5311": 0, "5313": 0, "5316": 0, "5317": 0, "5319": 0, "5321": 0, "5325": 9, "5326": 9, "5341": 9, "5327": 0, "5328": 0, "5329": 0, "5330": 0, "5331": 0, "5332": 0, "5333": 0, "5335": 0, "5336": 0, "5337": 0, "5338": 0, "5339": 0, "5345": 26, "5346": 26, "5358": 26, "5347": 0, "5349": 0, "5350": 0, "5351": 0, "5352": 0, "5353": 0, "5354": 0, "5355": 0, "5356": 0, "5362": 10, "5363": 10, "5386": 10, "5364": 0, "5366": 0, "5367": 0, "5368": 0, "5373": 0, "5374": 0, "5375": 0, "5376": 0, "5377": 0, "5378": 0, "5379": 0, "5380": 0, "5381": 0, "5382": 0, "5384": 0, "5389": 0, "5409": 0, "5412": 0, "5413": 0, "5415": 0, "5417": 0, "5418": 0, "5420": 0, "5421": 0, "5422": 0, "5425": 0, "5426": 0, "5427": 0, "5428": 0, "5429": 0, "5390": 0, "5391": 0, "5392": 0, "5394": 0, "5397": 0, "5399": 0, "5400": 0, "5401": 0, "5402": 0, "5403": 0, "5404": 0, "5405": 0, "5406": 0, "5407": 0, "5432": 0, "5433": 0, "5434": 0, "5435": 0, "5482": 0, "5483": 0, "5484": 0, "5485": 0, "5488": 0, "5489": 0, "5492": 0, "5493": 0, "5494": 0, "5495": 0, "5497": 0, "5499": 0, "5501": 0, "5502": 0, "5503": 0, "5504": 0, "5506": 0, "5508": 0, "5510": 0, "5511": 0, "5512": 0, "5514": 0, "5516": 0, "5517": 0, "5519": 0, "5561": 0, "5562": 0, "5563": 0, "5564": 0, "5566": 0, "5567": 0, "5568": 0, "5571": 0, "5570": 0, "5572": 0, "5569": 0, "5575": 0, "5576": 0, "5578": 0, "5580": 0, "5625": 0, "5626": 0, "5627": 0, "5628": 0, "5630": 0, "5631": 0, "5632": 0, "5634": 0, "5635": 0, "5637": 0, "5639": 0, "5641": 0, "5642": 0, "5643": 0, "5644": 0, "5645": 0, "5648": 0, "5650": 0, "5651": 0, "5652": 0, "5653": 0, "5654": 0, "5655": 0, "5657": 0, "5659": 0, "5661": 0, "5695": 0, "5697": 0, "5698": 0, "5700": 0, "5701": 0, "5702": 0, "5703": 0, "5704": 0, "5705": 0, "5706": 0, "5707": 0, "5708": 0, "5709": 0, "5710": 0, "5712": 0, "5713": 0, "5714": 0, "5715": 0, "5716": 0, "5811": 0, "5812": 0, "5813": 0, "5814": 0, "5816": 0, "5818": 0, "5819": 0, "5820": 0, "5823": 0, "5825": 0, "5826": 0, "5827": 0, "5828": 0, "5829": 0, "5831": 0, "5830": 0, "5832": 0, "5833": 0, "5835": 0, "5839": 0, "5840": 0, "5841": 0, "5842": 0, "5843": 0, "5844": 0, "5845": 0, "5849": 0, "5852": 0, "5853": 0, "5854": 0, "5855": 0, "5856": 0, "5857": 0, "5858": 0, "5860": 0, "5890": 0, "5891": 0, "5893": 0, "5894": 0, "5895": 0, "5896": 0, "5897": 0, "5899": 0, "5901": 0, "5902": 0, "5903": 0, "5904": 0, "5905": 0, "5933": 0, "5935": 0, "5936": 0, "5938": 0, "5939": 0, "5940": 0, "5941": 0, "5942": 0, "5945": 0, "5946": 0, "5947": 0, "5948": 0, "5949": 0, "5950": 0, "5951": 0, "5953": 0, "5954": 0, "5955": 0, "5956": 0, "5957": 0, "5958": 0, "5959": 0, "5961": 0, "5963": 0, "5964": 0, "6018": 1, "6019": 1, "6020": 1, "6021": 2, "6022": 1, "6023": 1, "6026": 1, "6028": 1, "6029": 0, "6031": 1, "6032": 1, "6033": 0, "6034": 0, "6035": 0, "6038": 1, "6039": 1, "6040": 0, "6041": 0, "6042": 0, "6043": 0, "6044": 0, "6045": 0, "6048": 1, "6049": 1, "6050": 3, "6051": 2, "6052": 1, "6053": 0, "6054": 0, "6056": 1, "6057": 1, "6058": 0, "6059": 2, "6060": 1, "6062": 1, "6063": 1, "6064": 1, "6066": 0, "6067": 3, "6068": 2, "6069": 1, "6074": 0, "6078": 0, "6159": 0, "6160": 0, "6161": 0, "6162": 0, "6163": 0, "6164": 0, "6165": 0, "6167": 0, "6168": 0, "6169": 0, "6170": 0, "6171": 0, "6187": 0, "6188": 0, "6193": 0, "6189": 0, "6190": 0, "6197": 0, "6199": 0, "6201": 0, "6203": 0, "6204": 0, "6205": 0, "6206": 0, "6207": 0, "6208": 0, "6209": 0, "6210": 0, "6212": 0, "6214": 0, "6215": 0, "6217": 0, "6324": 0, "6326": 0, "6395": 0, "6396": 0, "6398": 0, "6399": 0, "6400": 0, "6401": 0, "6403": 0, "6404": 0, "6407": 0, "6408": 0, "6409": 0, "6410": 0, "6411": 0, "6412": 0, "6413": 0, "6414": 0, "6415": 0, "6418": 0, "6419": 0, "6421": 0, "6423": 0, "6425": 0, "6426": 0, "6427": 0, "6428": 0, "6429": 0, "6430": 0, "6431": 0, "6432": 0, "6433": 0, "6435": 0, "6437": 0, "6438": 0, "6439": 0, "6441": 0, "6442": 0, "6446": 0, "6447": 0, "6448": 0, "6450": 0, "6451": 0, "6452": 0, "6453": 0, "6454": 0, "6455": 0, "6457": 0, "6458": 0, "6460": 0, "6461": 0, "6463": 0, "6464": 0, "6466": 0, "6467": 0, "6468": 0, "6470": 0, "6472": 0, "6473": 0, "6476": 0, "6477": 0, "6480": 0, "6482": 0, "6483": 0, "6484": 0, "6485": 0, "6486": 0, "6488": 0, "6489": 0, "6490": 0, "6492": 0, "6493": 0, "6494": 0, "6495": 0, "6496": 0, "6497": 0, "6499": 0, "6500": 0, "6501": 0, "6503": 0, "6504": 0, "6505": 0, "6506": 0, "6507": 0, "6509": 0, "6510": 0, "6511": 0, "6513": 0, "6514": 0, "6515": 0, "6517": 0, "6649": 0, "6651": 0, "6652": 0, "6654": 0, "6655": 0, "6656": 0, "6657": 0, "6653": 0, "6660": 0, "6661": 0, "6663": 0, "6664": 0, "6665": 0, "6666": 0, "6667": 0, "6668": 0, "6669": 0, "6670": 0, "6671": 0, "6672": 0, "6673": 0, "6674": 0, "6675": 0, "6678": 0, "6679": 0, "6680": 0, "6681": 0, "6684": 0, "6774": 0, "6775": 0, "6776": 0, "6777": 0, "6778": 0, "6779": 0, "6780": 0, "6872": 0, "6873": 0, "6874": 0, "6875": 0, "6876": 0, "6877": 0, "6878": 0, "6918": 0, "6919": 0, "6920": 0, "6925": 0, "6926": 0, "6929": 0, "6930": 0, "6931": 0, "6932": 0, "6936": 0, "6937": 0, "6939": 0, "6940": 0, "6981": 0, "6982": 0, "6983": 0, "6988": 0, "6989": 0, "6992": 0, "6993": 0, "6994": 0, "6995": 0, "6999": 0, "7000": 0, "7002": 0, "7003": 0}}
+ git checkout 8cc34cb412ba89ebca12fc84f76a9e452628f1bc
Note: switching to '8cc34cb412ba89ebca12fc84f76a9e452628f1bc'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 8cc34cb4 WIP: backend interface, now it uses subclassing  (#4836)
+ git apply /root/pre_state.patch
error: unrecognized input
