diff --git a/astropy/modeling/tests/test_regression.py b/astropy/modeling/tests/test_regression.py
new file mode 100644
index 0000000000..6de60bffc1
--- /dev/null
+++ b/astropy/modeling/tests/test_regression.py
@@ -0,0 +1,29 @@
+# Licensed under a 3-clause BSD style license - see LICENSE.rst
+"""
+Test separability of models.
+
+"""
+# pylint: disable=invalid-name
+import pytest
+import numpy as np
+from numpy.testing import assert_allclose
+
+from astropy.modeling import models
+from astropy.modeling.separable import separability_matrix
+
+
+def test_separability_matrix_for_nested_compound_models():
+    """
+    A regression test for a bug in `separability_matrix` that does not
+    compute separability correctly for nested CompoundModels.
+    """
+    cm = models.Linear1D(10) & models.Linear1D(5)
+    model = models.Pix2Sky_TAN() & cm
+    expected = np.array([
+        [True, True, False, False],
+        [True, True, False, False],
+        [False, False, True, False],
+        [False, False, False, True]
+    ])
+    result = separability_matrix(model)
+    assert_allclose(result, expected)
