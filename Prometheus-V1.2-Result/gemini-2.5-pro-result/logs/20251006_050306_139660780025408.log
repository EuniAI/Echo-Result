2025-10-06 05:03:07,324 - thread-139660780025408.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpx5vc6etw/django
2025-10-06 05:03:07,325 - thread-139660780025408.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-10-06 05:03:07,325 - thread-139660780025408.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.django_1776_django-12741:v1
2025-10-06 05:03:32,876 - thread-139660780025408.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_b93a446583
2025-10-06 05:03:32,881 - thread-139660780025408.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_b93a446583
2025-10-06 05:03:33,890 - thread-139660780025408.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-10-06 05:03:34,032 - thread-139660780025408.app.docker.base_container - INFO - Persistent shell is ready
2025-10-06 05:03:34,032 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-10-06 05:03:34,157 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:34,157 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:03:34,157 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-10-06 05:03:34,279 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:34,280 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:03:34,280 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && locale-gen
2025-10-06 05:03:36,039 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:36,039 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
sed -i '/en_US.UTF-8/s/^# //g' /
/etc/locale.gen && locale-gen

Generating locales (this might take a while)...
  en_US.UTF-8... done
Generation complete.

2025-10-06 05:03:36,039 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export LANG=en_US.UTF-8
2025-10-06 05:03:36,140 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:36,140 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:03:36,140 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export LANGUAGE=en_US:en
2025-10-06 05:03:36,240 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:36,241 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:03:36,241 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export LC_ALL=en_US.UTF-8
2025-10-06 05:03:36,341 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:36,341 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:03:36,341 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .
2025-10-06 05:03:37,556 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:03:37,556 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Obtaining file:///testbed
Requirement already satisfied: asgiref>=3.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.1) (3.4.1)
Requirement already satisfied: pytz in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.1) (2024.2)
Requirement already satisfied: sqlparse>=0.2.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.1) (0.4.4)
Requirement already satisfied: typing-extensions in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from asgiref>=3.2->Django==3.1) (4.1.1)
Installing collected packages: Django
  Attempting uninstall: Django
    Found existing installation: Django 3.1
    Uninstalling Django-3.1:
      Successfully uninstalled Django-3.1
  Running setup.py develop for Django
Successfully installed Django-3.1
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m

2025-10-06 05:03:37,614 - thread-139660780025408.app.lang_graph.nodes.issue_bug_reproduction_context_message_node - DEBUG - Sending query to context provider subgraph:
Issue title:
Simplify signature of `DatabaseOperations.execute_sql_flush()`

Issue description: 
Description
	
The current signature is:
def execute_sql_flush(self, using, sql_list):
The using argument can be dropped and inferred by the calling instance: self.connection.alias.
def execute_sql_flush(self, sql_list):
Some internal ises of this method are already doing:
connection.ops.execute_sql_flush(connection.alias, sql_flush)

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-10-06 05:03:37,614 - thread-139660780025408.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Enter context retrieval subgraph
2025-10-06 05:03:37,615 - thread-139660780025408.app.lang_graph.nodes.context_query_message_node - DEBUG - Sending query to ContextProviderNode:
content='Issue title:\nSimplify signature of `DatabaseOperations.execute_sql_flush()`\n\nIssue description: \nDescription\n\t\nThe current signature is:\ndef execute_sql_flush(self, using, sql_list):\nThe using argument can be dropped and inferred by the calling instance: self.connection.alias.\ndef execute_sql_flush(self, sql_list):\nSome internal ises of this method are already doing:\nconnection.ops.execute_sql_flush(connection.alias, sql_flush)\n\nIssue comments:\n\n\nOBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,\nincluding ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.\n\n<reasoning>\n1. Analyze bug characteristics:\n   - Core functionality being tested\n   - Input parameters and configurations\n   - Expected error conditions\n   - Environmental dependencies\n\n2. Search requirements:\n   - Required imports and dependencies\n   - Test files exercising similar functionality\n   - Mock/fixture setup patterns\n   - Assertion styles\n   - Error handling tests\n\n3. Focus areas:\n   - All necessary imports (standard library, testing frameworks, mocking utilities)\n   - Dependencies and third-party packages\n   - Test setup and teardown\n   - Mock object configuration\n   - Network/external service simulation\n   - Error condition verification\n</reasoning>\n\nREQUIREMENTS:\n- Return 5 complete, self-contained test cases most similar to bug scenario\n- Must include ALL necessary imports at the start of each test file\n- Must include full test method implementation\n- Must include ALL mock/fixture setup\n- Must include helper functions used by test\n- Must preserve exact file paths and line numbers\n\n<examples>\n<example id="database-timeout">\n<bug>\ndb.execute("SELECT * FROM users").fetchall() \nraises ConnectionTimeout when load is high\n</bug>\n\n<ideal_test_match>\n# File: tests/test_database.py\nimport pytest\nfrom unittest.mock import Mock, patch\nfrom database.exceptions import ConnectionTimeout\nfrom database.models import QueryResult\nfrom database.client import DatabaseClient\n\nclass TestDatabaseTimeout:\n    @pytest.fixture\n    def mock_db_connection(self):\n        conn = Mock()\n        conn.execute.side_effect = [\n            ConnectionTimeout("Connection timed out"),\n            QueryResult(["user1", "user2"])  # Second try succeeds\n        ]\n        return conn\n        \n    def test_handle_timeout_during_query(self, mock_db_connection):\n        # Complete test showing timeout scenario\n        # Including retry logic verification\n        # With all necessary assertions\n</ideal_test_match>\n</example>\n\n<example id="file-permission">\n<bug>\nFileProcessor(\'/root/data.txt\').process() \nfails with PermissionError\n</bug>\n\n<ideal_test_match>\n# File: tests/test_file_processor.py\nimport os\nimport pytest\nfrom unittest.mock import patch, mock_open\nfrom file_processor import FileProcessor\nfrom file_processor.exceptions import ProcessingError\n\nclass TestFilePermissions:\n    @patch(\'os.access\')\n    @patch(\'builtins.open\')\n    def test_file_permission_denied(self, mock_open, mock_access):\n        # Full test setup with mocked file system\n        # Permission denial simulation\n        # Error handling verification\n</ideal_test_match>\n</example>\n\nSearch priority:\n1. Tests of exact same functionality (including import patterns)\n2. Tests with similar error conditions\n3. Tests with comparable mocking patterns\n4. Tests demonstrating similar assertions\n\nFind the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.\n' additional_kwargs={} response_metadata={}
2025-10-06 05:05:01,987 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I have gathered five test cases that are relevant to the issue of simplifying the `DatabaseOperations.execute_sql_flush()` signature. The selected tests include a mix of unit and integration tests, covering single and multi-database scenarios, and demonstrate different paths that lead to the execution of the `execute_sql_flush` method. These examples will help verify that the signature change doesn't break existing functionality related to database flushing." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/model_regress/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55862, 'candidates_token_count': 180, 'total_token_count': 64780, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55862}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 180}], 'thoughts_token_count': 8738, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -6.700406222873264, 'model_name': 'gemini-2.5-pro'} id='run--c1018f50-a26e-42f5-b5a8-25773c058222-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/multiple_database/tests.py'}, 'id': '2e7a54f4-115a-465b-ac25-02004cfe7768', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_scripts/tests.py'}, 'id': 'f4d98f3f-f651-4abb-a9c8-2a9cb59336b5', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_commands.py'}, 'id': '3d5c0af3-df87-49e5-90e9-ac7c72e68397', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/model_regress/tests.py'}, 'id': 'f931492e-5d2c-4ccd-8d0c-d83caab99c34', 'type': 'tool_call'}] usage_metadata={'input_tokens': 55862, 'output_tokens': 180, 'total_tokens': 64780, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 8738}}
2025-10-06 05:05:22,887 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 85728, 'total_token_count': 87457, 'prompt_tokens_details': [{'modality': 1, 'token_count': 85728}], 'thoughts_token_count': 1729, 'candidates_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': [], 'candidates_tokens_details': []}, 'finish_reason': 'STOP', 'model_name': 'gemini-2.5-pro'} id='run--c90a6048-cc53-4df4-bfd9-56fa1e6132ba-0' usage_metadata={'input_tokens': 85728, 'output_tokens': 0, 'total_tokens': 87457, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1729}}
2025-10-06 05:05:22,888 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 05:05:22,888 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Simplify signature of `DatabaseOperations.execute_sql_flush()`

Issue description: 
Description
	
The current signature is:
def execute_sql_flush(self, using, sql_list):
The using argument can be dropped and inferred by the calling instance: self.connection.alias.
def execute_sql_flush(self, sql_list):
Some internal ises of this method are already doing:
connection.ops.execute_sql_flush(connection.alias, sql_flush)

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/multiple_database/tests.py
Line number range: 1 - 500
Content:
1. import datetime
2. import pickle
3. from io import StringIO
4. from operator import attrgetter
5. from unittest.mock import Mock
6. 
7. from django.contrib.auth.models import User
8. from django.contrib.contenttypes.models import ContentType
9. from django.core import management
10. from django.db import DEFAULT_DB_ALIAS, router, transaction
11. from django.db.models import signals
12. from django.db.utils import ConnectionRouter
13. from django.test import SimpleTestCase, TestCase, override_settings
14. 
15. from .models import Book, Person, Pet, Review, UserProfile
16. from .routers import AuthRouter, TestRouter, WriteRouter
17. 
18. 
19. class QueryTestCase(TestCase):
20.     databases = {'default', 'other'}
21. 
22.     def test_db_selection(self):
23.         "Querysets will use the default database by default"
24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)
25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)
26. 
27.         self.assertEqual(Book.objects.using('other').db, 'other')
28. 
29.         self.assertEqual(Book.objects.db_manager('other').db, 'other')
30.         self.assertEqual(Book.objects.db_manager('other').all().db, 'other')
31. 
32.     def test_default_creation(self):
33.         "Objects created on the default database don't leak onto other databases"
34.         # Create a book on the default database using create()
35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
36. 
37.         # Create a book on the default database using a save
38.         dive = Book()
39.         dive.title = "Dive into Python"
40.         dive.published = datetime.date(2009, 5, 4)
41.         dive.save()
42. 
43.         # Book exists on the default database, but not on other database
44.         try:
45.             Book.objects.get(title="Pro Django")
46.             Book.objects.using('default').get(title="Pro Django")
47.         except Book.DoesNotExist:
48.             self.fail('"Pro Django" should exist on default database')
49. 
50.         with self.assertRaises(Book.DoesNotExist):
51.             Book.objects.using('other').get(title="Pro Django")
52. 
53.         try:
54.             Book.objects.get(title="Dive into Python")
55.             Book.objects.using('default').get(title="Dive into Python")
56.         except Book.DoesNotExist:
57.             self.fail('"Dive into Python" should exist on default database')
58. 
59.         with self.assertRaises(Book.DoesNotExist):
60.             Book.objects.using('other').get(title="Dive into Python")
61. 
62.     def test_other_creation(self):
63.         "Objects created on another database don't leak onto the default database"
64.         # Create a book on the second database
65.         Book.objects.using('other').create(title="Pro Django",
66.                                            published=datetime.date(2008, 12, 16))
67. 
68.         # Create a book on the default database using a save
69.         dive = Book()
70.         dive.title = "Dive into Python"
71.         dive.published = datetime.date(2009, 5, 4)
72.         dive.save(using='other')
73. 
74.         # Book exists on the default database, but not on other database
75.         try:
76.             Book.objects.using('other').get(title="Pro Django")
77.         except Book.DoesNotExist:
78.             self.fail('"Pro Django" should exist on other database')
79. 
80.         with self.assertRaises(Book.DoesNotExist):
81.             Book.objects.get(title="Pro Django")
82.         with self.assertRaises(Book.DoesNotExist):
83.             Book.objects.using('default').get(title="Pro Django")
84. 
85.         try:
86.             Book.objects.using('other').get(title="Dive into Python")
87.         except Book.DoesNotExist:
88.             self.fail('"Dive into Python" should exist on other database')
89. 
90.         with self.assertRaises(Book.DoesNotExist):
91.             Book.objects.get(title="Dive into Python")
92.         with self.assertRaises(Book.DoesNotExist):
93.             Book.objects.using('default').get(title="Dive into Python")
94. 
95.     def test_refresh(self):
96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))
97.         dive.save(using='other')
98.         dive2 = Book.objects.using('other').get()
99.         dive2.title = "Dive into Python (on default)"
100.         dive2.save(using='default')
101.         dive.refresh_from_db()
102.         self.assertEqual(dive.title, "Dive into Python")
103.         dive.refresh_from_db(using='default')
104.         self.assertEqual(dive.title, "Dive into Python (on default)")
105.         self.assertEqual(dive._state.db, "default")
106. 
107.     def test_refresh_router_instance_hint(self):
108.         router = Mock()
109.         router.db_for_read.return_value = None
110.         book = Book.objects.create(title='Dive Into Python', published=datetime.date(1957, 10, 12))
111.         with self.settings(DATABASE_ROUTERS=[router]):
112.             book.refresh_from_db()
113.         router.db_for_read.assert_called_once_with(Book, instance=book)
114. 
115.     def test_basic_queries(self):
116.         "Queries are constrained to a single database"
117.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
118. 
119.         dive = Book.objects.using('other').get(published=datetime.date(2009, 5, 4))
120.         self.assertEqual(dive.title, "Dive into Python")
121.         with self.assertRaises(Book.DoesNotExist):
122.             Book.objects.using('default').get(published=datetime.date(2009, 5, 4))
123. 
124.         dive = Book.objects.using('other').get(title__icontains="dive")
125.         self.assertEqual(dive.title, "Dive into Python")
126.         with self.assertRaises(Book.DoesNotExist):
127.             Book.objects.using('default').get(title__icontains="dive")
128. 
129.         dive = Book.objects.using('other').get(title__iexact="dive INTO python")
130.         self.assertEqual(dive.title, "Dive into Python")
131.         with self.assertRaises(Book.DoesNotExist):
132.             Book.objects.using('default').get(title__iexact="dive INTO python")
133. 
134.         dive = Book.objects.using('other').get(published__year=2009)
135.         self.assertEqual(dive.title, "Dive into Python")
136.         self.assertEqual(dive.published, datetime.date(2009, 5, 4))
137.         with self.assertRaises(Book.DoesNotExist):
138.             Book.objects.using('default').get(published__year=2009)
139. 
140.         years = Book.objects.using('other').dates('published', 'year')
141.         self.assertEqual([o.year for o in years], [2009])
142.         years = Book.objects.using('default').dates('published', 'year')
143.         self.assertEqual([o.year for o in years], [])
144. 
145.         months = Book.objects.using('other').dates('published', 'month')
146.         self.assertEqual([o.month for o in months], [5])
147.         months = Book.objects.using('default').dates('published', 'month')
148.         self.assertEqual([o.month for o in months], [])
149. 
150.     def test_m2m_separation(self):
151.         "M2M fields are constrained to a single database"
152.         # Create a book and author on the default database
153.         pro = Book.objects.create(title="Pro Django",
154.                                   published=datetime.date(2008, 12, 16))
155. 
156.         marty = Person.objects.create(name="Marty Alchin")
157. 
158.         # Create a book and author on the other database
159.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
160. 
161.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
162. 
163.         # Save the author relations
164.         pro.authors.set([marty])
165.         dive.authors.set([mark])
166. 
167.         # Inspect the m2m tables directly.
168.         # There should be 1 entry in each database
169.         self.assertEqual(Book.authors.through.objects.using('default').count(), 1)
170.         self.assertEqual(Book.authors.through.objects.using('other').count(), 1)
171. 
172.         # Queries work across m2m joins
173.         self.assertEqual(
174.             list(Book.objects.using('default').filter(authors__name='Marty Alchin').values_list('title', flat=True)),
175.             ['Pro Django']
176.         )
177.         self.assertEqual(
178.             list(Book.objects.using('other').filter(authors__name='Marty Alchin').values_list('title', flat=True)),
179.             []
180.         )
181. 
182.         self.assertEqual(
183.             list(Book.objects.using('default').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
184.             []
185.         )
186.         self.assertEqual(
187.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
188.             ['Dive into Python']
189.         )
190. 
191.         # Reget the objects to clear caches
192.         dive = Book.objects.using('other').get(title="Dive into Python")
193.         mark = Person.objects.using('other').get(name="Mark Pilgrim")
194. 
195.         # Retrieve related object by descriptor. Related objects should be database-bound
196.         self.assertEqual(list(dive.authors.all().values_list('name', flat=True)), ['Mark Pilgrim'])
197. 
198.         self.assertEqual(list(mark.book_set.all().values_list('title', flat=True)), ['Dive into Python'])
199. 
200.     def test_m2m_forward_operations(self):
201.         "M2M forward manipulations are all constrained to a single DB"
202.         # Create a book and author on the other database
203.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
204.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
205. 
206.         # Save the author relations
207.         dive.authors.set([mark])
208. 
209.         # Add a second author
210.         john = Person.objects.using('other').create(name="John Smith")
211.         self.assertEqual(
212.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
213.             []
214.         )
215. 
216.         dive.authors.add(john)
217.         self.assertEqual(
218.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
219.             ['Dive into Python']
220.         )
221.         self.assertEqual(
222.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
223.             ['Dive into Python']
224.         )
225. 
226.         # Remove the second author
227.         dive.authors.remove(john)
228.         self.assertEqual(
229.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
230.             ['Dive into Python']
231.         )
232.         self.assertEqual(
233.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
234.             []
235.         )
236. 
237.         # Clear all authors
238.         dive.authors.clear()
239.         self.assertEqual(
240.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
241.             []
242.         )
243.         self.assertEqual(
244.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
245.             []
246.         )
247. 
248.         # Create an author through the m2m interface
249.         dive.authors.create(name='Jane Brown')
250.         self.assertEqual(
251.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
252.             []
253.         )
254.         self.assertEqual(
255.             list(Book.objects.using('other').filter(authors__name='Jane Brown').values_list('title', flat=True)),
256.             ['Dive into Python']
257.         )
258. 
259.     def test_m2m_reverse_operations(self):
260.         "M2M reverse manipulations are all constrained to a single DB"
261.         # Create a book and author on the other database
262.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
263.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
264. 
265.         # Save the author relations
266.         dive.authors.set([mark])
267. 
268.         # Create a second book on the other database
269.         grease = Book.objects.using('other').create(title="Greasemonkey Hacks", published=datetime.date(2005, 11, 1))
270. 
271.         # Add a books to the m2m
272.         mark.book_set.add(grease)
273.         self.assertEqual(
274.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
275.             ['Mark Pilgrim']
276.         )
277.         self.assertEqual(
278.             list(
279.                 Person.objects.using('other').filter(book__title='Greasemonkey Hacks').values_list('name', flat=True)
280.             ),
281.             ['Mark Pilgrim']
282.         )
283. 
284.         # Remove a book from the m2m
285.         mark.book_set.remove(grease)
286.         self.assertEqual(
287.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
288.             ['Mark Pilgrim']
289.         )
290.         self.assertEqual(
291.             list(
292.                 Person.objects.using('other').filter(book__title='Greasemonkey Hacks').values_list('name', flat=True)
293.             ),
294.             []
295.         )
296. 
297.         # Clear the books associated with mark
298.         mark.book_set.clear()
299.         self.assertEqual(
300.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
301.             []
302.         )
303.         self.assertEqual(
304.             list(
305.                 Person.objects.using('other').filter(book__title='Greasemonkey Hacks').values_list('name', flat=True)
306.             ),
307.             []
308.         )
309. 
310.         # Create a book through the m2m interface
311.         mark.book_set.create(title="Dive into HTML5", published=datetime.date(2020, 1, 1))
312.         self.assertEqual(
313.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
314.             []
315.         )
316.         self.assertEqual(
317.             list(Person.objects.using('other').filter(book__title='Dive into HTML5').values_list('name', flat=True)),
318.             ['Mark Pilgrim']
319.         )
320. 
321.     def test_m2m_cross_database_protection(self):
322.         "Operations that involve sharing M2M objects across databases raise an error"
323.         # Create a book and author on the default database
324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
325. 
326.         marty = Person.objects.create(name="Marty Alchin")
327. 
328.         # Create a book and author on the other database
329.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
330. 
331.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
332.         # Set a foreign key set with an object from a different database
333.         msg = (
334.             'Cannot assign "<Person: Marty Alchin>": the current database '
335.             'router prevents this relation.'
336.         )
337.         with self.assertRaisesMessage(ValueError, msg):
338.             with transaction.atomic(using='default'):
339.                 marty.edited.set([pro, dive])
340. 
341.         # Add to an m2m with an object from a different database
342.         msg = (
343.             'Cannot add "<Book: Dive into Python>": instance is on '
344.             'database "default", value is on database "other"'
345.         )
346.         with self.assertRaisesMessage(ValueError, msg):
347.             with transaction.atomic(using='default'):
348.                 marty.book_set.add(dive)
349. 
350.         # Set a m2m with an object from a different database
351.         with self.assertRaisesMessage(ValueError, msg):
352.             with transaction.atomic(using='default'):
353.                 marty.book_set.set([pro, dive])
354. 
355.         # Add to a reverse m2m with an object from a different database
356.         msg = (
357.             'Cannot add "<Person: Marty Alchin>": instance is on '
358.             'database "other", value is on database "default"'
359.         )
360.         with self.assertRaisesMessage(ValueError, msg):
361.             with transaction.atomic(using='other'):
362.                 dive.authors.add(marty)
363. 
364.         # Set a reverse m2m with an object from a different database
365.         with self.assertRaisesMessage(ValueError, msg):
366.             with transaction.atomic(using='other'):
367.                 dive.authors.set([mark, marty])
368. 
369.     def test_m2m_deletion(self):
370.         "Cascaded deletions of m2m relations issue queries on the right database"
371.         # Create a book and author on the other database
372.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
373.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
374.         dive.authors.set([mark])
375. 
376.         # Check the initial state
377.         self.assertEqual(Person.objects.using('default').count(), 0)
378.         self.assertEqual(Book.objects.using('default').count(), 0)
379.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
380. 
381.         self.assertEqual(Person.objects.using('other').count(), 1)
382.         self.assertEqual(Book.objects.using('other').count(), 1)
383.         self.assertEqual(Book.authors.through.objects.using('other').count(), 1)
384. 
385.         # Delete the object on the other database
386.         dive.delete(using='other')
387. 
388.         self.assertEqual(Person.objects.using('default').count(), 0)
389.         self.assertEqual(Book.objects.using('default').count(), 0)
390.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
391. 
392.         # The person still exists ...
393.         self.assertEqual(Person.objects.using('other').count(), 1)
394.         # ... but the book has been deleted
395.         self.assertEqual(Book.objects.using('other').count(), 0)
396.         # ... and the relationship object has also been deleted.
397.         self.assertEqual(Book.authors.through.objects.using('other').count(), 0)
398. 
399.         # Now try deletion in the reverse direction. Set up the relation again
400.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
401.         dive.authors.set([mark])
402. 
403.         # Check the initial state
404.         self.assertEqual(Person.objects.using('default').count(), 0)
405.         self.assertEqual(Book.objects.using('default').count(), 0)
406.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
407. 
408.         self.assertEqual(Person.objects.using('other').count(), 1)
409.         self.assertEqual(Book.objects.using('other').count(), 1)
410.         self.assertEqual(Book.authors.through.objects.using('other').count(), 1)
411. 
412.         # Delete the object on the other database
413.         mark.delete(using='other')
414. 
415.         self.assertEqual(Person.objects.using('default').count(), 0)
416.         self.assertEqual(Book.objects.using('default').count(), 0)
417.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
418. 
419.         # The person has been deleted ...
420.         self.assertEqual(Person.objects.using('other').count(), 0)
421.         # ... but the book still exists
422.         self.assertEqual(Book.objects.using('other').count(), 1)
423.         # ... and the relationship object has been deleted.
424.         self.assertEqual(Book.authors.through.objects.using('other').count(), 0)
425. 
426.     def test_foreign_key_separation(self):
427.         "FK fields are constrained to a single database"
428.         # Create a book and author on the default database
429.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
430. 
431.         george = Person.objects.create(name="George Vilches")
432. 
433.         # Create a book and author on the other database
434.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
435.         chris = Person.objects.using('other').create(name="Chris Mills")
436. 
437.         # Save the author's favorite books
438.         pro.editor = george
439.         pro.save()
440. 
441.         dive.editor = chris
442.         dive.save()
443. 
444.         pro = Book.objects.using('default').get(title="Pro Django")
445.         self.assertEqual(pro.editor.name, "George Vilches")
446. 
447.         dive = Book.objects.using('other').get(title="Dive into Python")
448.         self.assertEqual(dive.editor.name, "Chris Mills")
449. 
450.         # Queries work across foreign key joins
451.         self.assertEqual(
452.             list(Person.objects.using('default').filter(edited__title='Pro Django').values_list('name', flat=True)),
453.             ['George Vilches']
454.         )
455.         self.assertEqual(
456.             list(Person.objects.using('other').filter(edited__title='Pro Django').values_list('name', flat=True)),
457.             []
458.         )
459. 
460.         self.assertEqual(
461.             list(
462.                 Person.objects.using('default').filter(edited__title='Dive into Python').values_list('name', flat=True)
463.             ),
464.             []
465.         )
466.         self.assertEqual(
467.             list(
468.                 Person.objects.using('other').filter(edited__title='Dive into Python').values_list('name', flat=True)
469.             ),
470.             ['Chris Mills']
471.         )
472. 
473.         # Reget the objects to clear caches
474.         chris = Person.objects.using('other').get(name="Chris Mills")
475.         dive = Book.objects.using('other').get(title="Dive into Python")
476. 
477.         # Retrieve related object by descriptor. Related objects should be database-bound
478.         self.assertEqual(list(chris.edited.values_list('title', flat=True)), ['Dive into Python'])
479. 
480.     def test_foreign_key_reverse_operations(self):
481.         "FK reverse manipulations are all constrained to a single DB"
482.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
483.         chris = Person.objects.using('other').create(name="Chris Mills")
484. 
485.         # Save the author relations
486.         dive.editor = chris
487.         dive.save()
488. 
489.         # Add a second book edited by chris
490.         html5 = Book.objects.using('other').create(title="Dive into HTML5", published=datetime.date(2010, 3, 15))
491.         self.assertEqual(
492.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
493.             []
494.         )
495. 
496.         chris.edited.add(html5)
497.         self.assertEqual(
498.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
499.             ['Chris Mills']
500.         )

File: tests/admin_scripts/tests.py
Line number range: 1 - 500
Content:
1. """
2. A series of tests to establish that the command-line management tools work as
3. advertised - especially with regards to the handling of the
4. DJANGO_SETTINGS_MODULE and default settings.py files.
5. """
6. import os
7. import re
8. import shutil
9. import socket
10. import subprocess
11. import sys
12. import tempfile
13. import unittest
14. from io import StringIO
15. from unittest import mock
16. 
17. from django import conf, get_version
18. from django.conf import settings
19. from django.core.management import (
20.     BaseCommand, CommandError, call_command, color,
21. )
22. from django.core.management.commands.loaddata import Command as LoaddataCommand
23. from django.core.management.commands.runserver import (
24.     Command as RunserverCommand,
25. )
26. from django.core.management.commands.testserver import (
27.     Command as TestserverCommand,
28. )
29. from django.db import ConnectionHandler, connection
30. from django.db.migrations.recorder import MigrationRecorder
31. from django.test import (
32.     LiveServerTestCase, SimpleTestCase, TestCase, override_settings,
33. )
34. 
35. custom_templates_dir = os.path.join(os.path.dirname(__file__), 'custom_templates')
36. 
37. SYSTEM_CHECK_MSG = 'System check identified no issues'
38. 
39. 
40. class AdminScriptTestCase(SimpleTestCase):
41.     def setUp(self):
42.         tmpdir = tempfile.TemporaryDirectory()
43.         self.addCleanup(tmpdir.cleanup)
44.         # os.path.realpath() is required for temporary directories on macOS,
45.         # where `/var` is a symlink to `/private/var`.
46.         self.test_dir = os.path.realpath(os.path.join(tmpdir.name, 'test_project'))
47.         os.mkdir(self.test_dir)
48. 
49.     def write_settings(self, filename, apps=None, is_dir=False, sdict=None, extra=None):
50.         if is_dir:
51.             settings_dir = os.path.join(self.test_dir, filename)
52.             os.mkdir(settings_dir)
53.             settings_file_path = os.path.join(settings_dir, '__init__.py')
54.         else:
55.             settings_file_path = os.path.join(self.test_dir, filename)
56. 
57.         with open(settings_file_path, 'w') as settings_file:
58.             settings_file.write('# Settings file automatically generated by admin_scripts test case\n')
59.             if extra:
60.                 settings_file.write("%s\n" % extra)
61.             exports = [
62.                 'DATABASES',
63.                 'ROOT_URLCONF',
64.                 'SECRET_KEY',
65.             ]
66.             for s in exports:
67.                 if hasattr(settings, s):
68.                     o = getattr(settings, s)
69.                     if not isinstance(o, (dict, tuple, list)):
70.                         o = "'%s'" % o
71.                     settings_file.write("%s = %s\n" % (s, o))
72. 
73.             if apps is None:
74.                 apps = ['django.contrib.auth', 'django.contrib.contenttypes', 'admin_scripts']
75. 
76.             settings_file.write("INSTALLED_APPS = %s\n" % apps)
77. 
78.             if sdict:
79.                 for k, v in sdict.items():
80.                     settings_file.write("%s = %s\n" % (k, v))
81. 
82.     def _ext_backend_paths(self):
83.         """
84.         Returns the paths for any external backend packages.
85.         """
86.         paths = []
87.         for backend in settings.DATABASES.values():
88.             package = backend['ENGINE'].split('.')[0]
89.             if package != 'django':
90.                 backend_pkg = __import__(package)
91.                 backend_dir = os.path.dirname(backend_pkg.__file__)
92.                 paths.append(os.path.dirname(backend_dir))
93.         return paths
94. 
95.     def run_test(self, args, settings_file=None, apps=None):
96.         base_dir = os.path.dirname(self.test_dir)
97.         # The base dir for Django's tests is one level up.
98.         tests_dir = os.path.dirname(os.path.dirname(__file__))
99.         # The base dir for Django is one level above the test dir. We don't use
100.         # `import django` to figure that out, so we don't pick up a Django
101.         # from site-packages or similar.
102.         django_dir = os.path.dirname(tests_dir)
103.         ext_backend_base_dirs = self._ext_backend_paths()
104. 
105.         # Define a temporary environment for the subprocess
106.         test_environ = os.environ.copy()
107. 
108.         # Set the test environment
109.         if settings_file:
110.             test_environ['DJANGO_SETTINGS_MODULE'] = settings_file
111.         elif 'DJANGO_SETTINGS_MODULE' in test_environ:
112.             del test_environ['DJANGO_SETTINGS_MODULE']
113.         python_path = [base_dir, django_dir, tests_dir]
114.         python_path.extend(ext_backend_base_dirs)
115.         test_environ['PYTHONPATH'] = os.pathsep.join(python_path)
116.         test_environ['PYTHONWARNINGS'] = ''
117. 
118.         p = subprocess.run(
119.             [sys.executable, *args],
120.             stdout=subprocess.PIPE, stderr=subprocess.PIPE,
121.             cwd=self.test_dir,
122.             env=test_environ, universal_newlines=True,
123.         )
124.         return p.stdout, p.stderr
125. 
126.     def run_django_admin(self, args, settings_file=None):
127.         return self.run_test(['-m', 'django', *args], settings_file)
128. 
129.     def run_manage(self, args, settings_file=None, manage_py=None):
130.         template_manage_py = (
131.             os.path.join(os.path.dirname(__file__), manage_py)
132.             if manage_py else
133.             os.path.join(os.path.dirname(conf.__file__), 'project_template', 'manage.py-tpl')
134.         )
135.         test_manage_py = os.path.join(self.test_dir, 'manage.py')
136.         shutil.copyfile(template_manage_py, test_manage_py)
137. 
138.         with open(test_manage_py) as fp:
139.             manage_py_contents = fp.read()
140.         manage_py_contents = manage_py_contents.replace(
141.             "{{ project_name }}", "test_project")
142.         with open(test_manage_py, 'w') as fp:
143.             fp.write(manage_py_contents)
144. 
145.         return self.run_test(['./manage.py', *args], settings_file)
146. 
147.     def assertNoOutput(self, stream):
148.         "Utility assertion: assert that the given stream is empty"
149.         self.assertEqual(len(stream), 0, "Stream should be empty: actually contains '%s'" % stream)
150. 
151.     def assertOutput(self, stream, msg, regex=False):
152.         "Utility assertion: assert that the given message exists in the output"
153.         if regex:
154.             self.assertIsNotNone(
155.                 re.search(msg, stream),
156.                 "'%s' does not match actual output text '%s'" % (msg, stream)
157.             )
158.         else:
159.             self.assertIn(msg, stream, "'%s' does not match actual output text '%s'" % (msg, stream))
160. 
161.     def assertNotInOutput(self, stream, msg):
162.         "Utility assertion: assert that the given message doesn't exist in the output"
163.         self.assertNotIn(msg, stream, "'%s' matches actual output text '%s'" % (msg, stream))
164. 
165. ##########################################################################
166. # DJANGO ADMIN TESTS
167. # This first series of test classes checks the environment processing
168. # of the django-admin.py script
169. ##########################################################################
170. 
171. 
172. class DjangoAdminNoSettings(AdminScriptTestCase):
173.     "A series of tests for django-admin.py when there is no settings.py file."
174. 
175.     def test_builtin_command(self):
176.         "no settings: django-admin builtin commands fail with an error when no settings provided"
177.         args = ['check', 'admin_scripts']
178.         out, err = self.run_django_admin(args)
179.         self.assertNoOutput(out)
180.         self.assertOutput(err, 'settings are not configured')
181. 
182.     def test_builtin_with_bad_settings(self):
183.         "no settings: django-admin builtin commands fail if settings file (from argument) doesn't exist"
184.         args = ['check', '--settings=bad_settings', 'admin_scripts']
185.         out, err = self.run_django_admin(args)
186.         self.assertNoOutput(out)
187.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
188. 
189.     def test_builtin_with_bad_environment(self):
190.         "no settings: django-admin builtin commands fail if settings file (from environment) doesn't exist"
191.         args = ['check', 'admin_scripts']
192.         out, err = self.run_django_admin(args, 'bad_settings')
193.         self.assertNoOutput(out)
194.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
195. 
196.     def test_commands_with_invalid_settings(self):
197.         """"
198.         Commands that don't require settings succeed if the settings file
199.         doesn't exist.
200.         """
201.         args = ['startproject']
202.         out, err = self.run_django_admin(args, settings_file='bad_settings')
203.         self.assertNoOutput(out)
204.         self.assertOutput(err, "You must provide a project name", regex=True)
205. 
206. 
207. class DjangoAdminDefaultSettings(AdminScriptTestCase):
208.     """A series of tests for django-admin.py when using a settings.py file that
209.     contains the test application.
210.     """
211.     def setUp(self):
212.         super().setUp()
213.         self.write_settings('settings.py')
214. 
215.     def test_builtin_command(self):
216.         "default: django-admin builtin commands fail with an error when no settings provided"
217.         args = ['check', 'admin_scripts']
218.         out, err = self.run_django_admin(args)
219.         self.assertNoOutput(out)
220.         self.assertOutput(err, 'settings are not configured')
221. 
222.     def test_builtin_with_settings(self):
223.         "default: django-admin builtin commands succeed if settings are provided as argument"
224.         args = ['check', '--settings=test_project.settings', 'admin_scripts']
225.         out, err = self.run_django_admin(args)
226.         self.assertNoOutput(err)
227.         self.assertOutput(out, SYSTEM_CHECK_MSG)
228. 
229.     def test_builtin_with_environment(self):
230.         "default: django-admin builtin commands succeed if settings are provided in the environment"
231.         args = ['check', 'admin_scripts']
232.         out, err = self.run_django_admin(args, 'test_project.settings')
233.         self.assertNoOutput(err)
234.         self.assertOutput(out, SYSTEM_CHECK_MSG)
235. 
236.     def test_builtin_with_bad_settings(self):
237.         "default: django-admin builtin commands fail if settings file (from argument) doesn't exist"
238.         args = ['check', '--settings=bad_settings', 'admin_scripts']
239.         out, err = self.run_django_admin(args)
240.         self.assertNoOutput(out)
241.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
242. 
243.     def test_builtin_with_bad_environment(self):
244.         "default: django-admin builtin commands fail if settings file (from environment) doesn't exist"
245.         args = ['check', 'admin_scripts']
246.         out, err = self.run_django_admin(args, 'bad_settings')
247.         self.assertNoOutput(out)
248.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
249. 
250.     def test_custom_command(self):
251.         "default: django-admin can't execute user commands if it isn't provided settings"
252.         args = ['noargs_command']
253.         out, err = self.run_django_admin(args)
254.         self.assertNoOutput(out)
255.         self.assertOutput(err, "No Django settings specified")
256.         self.assertOutput(err, "Unknown command: 'noargs_command'")
257. 
258.     def test_custom_command_with_settings(self):
259.         "default: django-admin can execute user commands if settings are provided as argument"
260.         args = ['noargs_command', '--settings=test_project.settings']
261.         out, err = self.run_django_admin(args)
262.         self.assertNoOutput(err)
263.         self.assertOutput(out, "EXECUTE: noargs_command")
264. 
265.     def test_custom_command_with_environment(self):
266.         "default: django-admin can execute user commands if settings are provided in environment"
267.         args = ['noargs_command']
268.         out, err = self.run_django_admin(args, 'test_project.settings')
269.         self.assertNoOutput(err)
270.         self.assertOutput(out, "EXECUTE: noargs_command")
271. 
272. 
273. class DjangoAdminFullPathDefaultSettings(AdminScriptTestCase):
274.     """A series of tests for django-admin.py when using a settings.py file that
275.     contains the test application specified using a full path.
276.     """
277.     def setUp(self):
278.         super().setUp()
279.         self.write_settings('settings.py', ['django.contrib.auth', 'django.contrib.contenttypes',
280.                                             'admin_scripts', 'admin_scripts.complex_app'])
281. 
282.     def test_builtin_command(self):
283.         "fulldefault: django-admin builtin commands fail with an error when no settings provided"
284.         args = ['check', 'admin_scripts']
285.         out, err = self.run_django_admin(args)
286.         self.assertNoOutput(out)
287.         self.assertOutput(err, 'settings are not configured')
288. 
289.     def test_builtin_with_settings(self):
290.         "fulldefault: django-admin builtin commands succeed if a settings file is provided"
291.         args = ['check', '--settings=test_project.settings', 'admin_scripts']
292.         out, err = self.run_django_admin(args)
293.         self.assertNoOutput(err)
294.         self.assertOutput(out, SYSTEM_CHECK_MSG)
295. 
296.     def test_builtin_with_environment(self):
297.         "fulldefault: django-admin builtin commands succeed if the environment contains settings"
298.         args = ['check', 'admin_scripts']
299.         out, err = self.run_django_admin(args, 'test_project.settings')
300.         self.assertNoOutput(err)
301.         self.assertOutput(out, SYSTEM_CHECK_MSG)
302. 
303.     def test_builtin_with_bad_settings(self):
304.         "fulldefault: django-admin builtin commands fail if settings file (from argument) doesn't exist"
305.         args = ['check', '--settings=bad_settings', 'admin_scripts']
306.         out, err = self.run_django_admin(args)
307.         self.assertNoOutput(out)
308.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
309. 
310.     def test_builtin_with_bad_environment(self):
311.         "fulldefault: django-admin builtin commands fail if settings file (from environment) doesn't exist"
312.         args = ['check', 'admin_scripts']
313.         out, err = self.run_django_admin(args, 'bad_settings')
314.         self.assertNoOutput(out)
315.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
316. 
317.     def test_custom_command(self):
318.         "fulldefault: django-admin can't execute user commands unless settings are provided"
319.         args = ['noargs_command']
320.         out, err = self.run_django_admin(args)
321.         self.assertNoOutput(out)
322.         self.assertOutput(err, "No Django settings specified")
323.         self.assertOutput(err, "Unknown command: 'noargs_command'")
324. 
325.     def test_custom_command_with_settings(self):
326.         "fulldefault: django-admin can execute user commands if settings are provided as argument"
327.         args = ['noargs_command', '--settings=test_project.settings']
328.         out, err = self.run_django_admin(args)
329.         self.assertNoOutput(err)
330.         self.assertOutput(out, "EXECUTE: noargs_command")
331. 
332.     def test_custom_command_with_environment(self):
333.         "fulldefault: django-admin can execute user commands if settings are provided in environment"
334.         args = ['noargs_command']
335.         out, err = self.run_django_admin(args, 'test_project.settings')
336.         self.assertNoOutput(err)
337.         self.assertOutput(out, "EXECUTE: noargs_command")
338. 
339. 
340. class DjangoAdminMinimalSettings(AdminScriptTestCase):
341.     """A series of tests for django-admin.py when using a settings.py file that
342.     doesn't contain the test application.
343.     """
344.     def setUp(self):
345.         super().setUp()
346.         self.write_settings('settings.py', apps=['django.contrib.auth', 'django.contrib.contenttypes'])
347. 
348.     def test_builtin_command(self):
349.         "minimal: django-admin builtin commands fail with an error when no settings provided"
350.         args = ['check', 'admin_scripts']
351.         out, err = self.run_django_admin(args)
352.         self.assertNoOutput(out)
353.         self.assertOutput(err, 'settings are not configured')
354. 
355.     def test_builtin_with_settings(self):
356.         "minimal: django-admin builtin commands fail if settings are provided as argument"
357.         args = ['check', '--settings=test_project.settings', 'admin_scripts']
358.         out, err = self.run_django_admin(args)
359.         self.assertNoOutput(out)
360.         self.assertOutput(err, "No installed app with label 'admin_scripts'.")
361. 
362.     def test_builtin_with_environment(self):
363.         "minimal: django-admin builtin commands fail if settings are provided in the environment"
364.         args = ['check', 'admin_scripts']
365.         out, err = self.run_django_admin(args, 'test_project.settings')
366.         self.assertNoOutput(out)
367.         self.assertOutput(err, "No installed app with label 'admin_scripts'.")
368. 
369.     def test_builtin_with_bad_settings(self):
370.         "minimal: django-admin builtin commands fail if settings file (from argument) doesn't exist"
371.         args = ['check', '--settings=bad_settings', 'admin_scripts']
372.         out, err = self.run_django_admin(args)
373.         self.assertNoOutput(out)
374.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
375. 
376.     def test_builtin_with_bad_environment(self):
377.         "minimal: django-admin builtin commands fail if settings file (from environment) doesn't exist"
378.         args = ['check', 'admin_scripts']
379.         out, err = self.run_django_admin(args, 'bad_settings')
380.         self.assertNoOutput(out)
381.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
382. 
383.     def test_custom_command(self):
384.         "minimal: django-admin can't execute user commands unless settings are provided"
385.         args = ['noargs_command']
386.         out, err = self.run_django_admin(args)
387.         self.assertNoOutput(out)
388.         self.assertOutput(err, "No Django settings specified")
389.         self.assertOutput(err, "Unknown command: 'noargs_command'")
390. 
391.     def test_custom_command_with_settings(self):
392.         "minimal: django-admin can't execute user commands, even if settings are provided as argument"
393.         args = ['noargs_command', '--settings=test_project.settings']
394.         out, err = self.run_django_admin(args)
395.         self.assertNoOutput(out)
396.         self.assertOutput(err, "Unknown command: 'noargs_command'")
397. 
398.     def test_custom_command_with_environment(self):
399.         "minimal: django-admin can't execute user commands, even if settings are provided in environment"
400.         args = ['noargs_command']
401.         out, err = self.run_django_admin(args, 'test_project.settings')
402.         self.assertNoOutput(out)
403.         self.assertOutput(err, "Unknown command: 'noargs_command'")
404. 
405. 
406. class DjangoAdminAlternateSettings(AdminScriptTestCase):
407.     """A series of tests for django-admin.py when using a settings file
408.     with a name other than 'settings.py'.
409.     """
410.     def setUp(self):
411.         super().setUp()
412.         self.write_settings('alternate_settings.py')
413. 
414.     def test_builtin_command(self):
415.         "alternate: django-admin builtin commands fail with an error when no settings provided"
416.         args = ['check', 'admin_scripts']
417.         out, err = self.run_django_admin(args)
418.         self.assertNoOutput(out)
419.         self.assertOutput(err, 'settings are not configured')
420. 
421.     def test_builtin_with_settings(self):
422.         "alternate: django-admin builtin commands succeed if settings are provided as argument"
423.         args = ['check', '--settings=test_project.alternate_settings', 'admin_scripts']
424.         out, err = self.run_django_admin(args)
425.         self.assertNoOutput(err)
426.         self.assertOutput(out, SYSTEM_CHECK_MSG)
427. 
428.     def test_builtin_with_environment(self):
429.         "alternate: django-admin builtin commands succeed if settings are provided in the environment"
430.         args = ['check', 'admin_scripts']
431.         out, err = self.run_django_admin(args, 'test_project.alternate_settings')
432.         self.assertNoOutput(err)
433.         self.assertOutput(out, SYSTEM_CHECK_MSG)
434. 
435.     def test_builtin_with_bad_settings(self):
436.         "alternate: django-admin builtin commands fail if settings file (from argument) doesn't exist"
437.         args = ['check', '--settings=bad_settings', 'admin_scripts']
438.         out, err = self.run_django_admin(args)
439.         self.assertNoOutput(out)
440.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
441. 
442.     def test_builtin_with_bad_environment(self):
443.         "alternate: django-admin builtin commands fail if settings file (from environment) doesn't exist"
444.         args = ['check', 'admin_scripts']
445.         out, err = self.run_django_admin(args, 'bad_settings')
446.         self.assertNoOutput(out)
447.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
448. 
449.     def test_custom_command(self):
450.         "alternate: django-admin can't execute user commands unless settings are provided"
451.         args = ['noargs_command']
452.         out, err = self.run_django_admin(args)
453.         self.assertNoOutput(out)
454.         self.assertOutput(err, "No Django settings specified")
455.         self.assertOutput(err, "Unknown command: 'noargs_command'")
456. 
457.     def test_custom_command_with_settings(self):
458.         "alternate: django-admin can execute user commands if settings are provided as argument"
459.         args = ['noargs_command', '--settings=test_project.alternate_settings']
460.         out, err = self.run_django_admin(args)
461.         self.assertNoOutput(err)
462.         self.assertOutput(out, "EXECUTE: noargs_command")
463. 
464.     def test_custom_command_with_environment(self):
465.         "alternate: django-admin can execute user commands if settings are provided in environment"
466.         args = ['noargs_command']
467.         out, err = self.run_django_admin(args, 'test_project.alternate_settings')
468.         self.assertNoOutput(err)
469.         self.assertOutput(out, "EXECUTE: noargs_command")
470. 
471. 
472. class DjangoAdminMultipleSettings(AdminScriptTestCase):
473.     """A series of tests for django-admin.py when multiple settings files
474.     (including the default 'settings.py') are available. The default settings
475.     file is insufficient for performing the operations described, so the
476.     alternate settings must be used by the running script.
477.     """
478.     def setUp(self):
479.         super().setUp()
480.         self.write_settings('settings.py', apps=['django.contrib.auth', 'django.contrib.contenttypes'])
481.         self.write_settings('alternate_settings.py')
482. 
483.     def test_builtin_command(self):
484.         "alternate: django-admin builtin commands fail with an error when no settings provided"
485.         args = ['check', 'admin_scripts']
486.         out, err = self.run_django_admin(args)
487.         self.assertNoOutput(out)
488.         self.assertOutput(err, 'settings are not configured')
489. 
490.     def test_builtin_with_settings(self):
491.         "alternate: django-admin builtin commands succeed if settings are provided as argument"
492.         args = ['check', '--settings=test_project.alternate_settings', 'admin_scripts']
493.         out, err = self.run_django_admin(args)
494.         self.assertNoOutput(err)
495.         self.assertOutput(out, SYSTEM_CHECK_MSG)
496. 
497.     def test_builtin_with_environment(self):
498.         "alternate: django-admin builtin commands succeed if settings are provided in the environment"
499.         args = ['check', 'admin_scripts']
500.         out, err = self.run_django_admin(args, 'test_project.alternate_settings')

File: tests/migrations/test_commands.py
Line number range: 1 - 500
Content:
1. import datetime
2. import importlib
3. import io
4. import os
5. import sys
6. from unittest import mock
7. 
8. from django.apps import apps
9. from django.core.management import CommandError, call_command
10. from django.db import (
11.     ConnectionHandler, DatabaseError, connection, connections, models,
12. )
13. from django.db.backends.base.schema import BaseDatabaseSchemaEditor
14. from django.db.backends.utils import truncate_name
15. from django.db.migrations.exceptions import InconsistentMigrationHistory
16. from django.db.migrations.recorder import MigrationRecorder
17. from django.test import TestCase, override_settings, skipUnlessDBFeature
18. 
19. from .models import UnicodeModel, UnserializableModel
20. from .routers import TestRouter
21. from .test_base import MigrationTestBase
22. 
23. 
24. class MigrateTests(MigrationTestBase):
25.     """
26.     Tests running the migrate command.
27.     """
28.     databases = {'default', 'other'}
29. 
30.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
31.     def test_migrate(self):
32.         """
33.         Tests basic usage of the migrate command.
34.         """
35.         # No tables are created
36.         self.assertTableNotExists("migrations_author")
37.         self.assertTableNotExists("migrations_tribble")
38.         self.assertTableNotExists("migrations_book")
39.         # Run the migrations to 0001 only
40.         stdout = io.StringIO()
41.         call_command('migrate', 'migrations', '0001', verbosity=1, stdout=stdout, no_color=True)
42.         stdout = stdout.getvalue()
43.         self.assertIn('Target specific migration: 0001_initial, from migrations', stdout)
44.         self.assertIn('Applying migrations.0001_initial... OK', stdout)
45.         # The correct tables exist
46.         self.assertTableExists("migrations_author")
47.         self.assertTableExists("migrations_tribble")
48.         self.assertTableNotExists("migrations_book")
49.         # Run migrations all the way
50.         call_command("migrate", verbosity=0)
51.         # The correct tables exist
52.         self.assertTableExists("migrations_author")
53.         self.assertTableNotExists("migrations_tribble")
54.         self.assertTableExists("migrations_book")
55.         # Unmigrate everything
56.         stdout = io.StringIO()
57.         call_command('migrate', 'migrations', 'zero', verbosity=1, stdout=stdout, no_color=True)
58.         stdout = stdout.getvalue()
59.         self.assertIn('Unapply all migrations: migrations', stdout)
60.         self.assertIn('Unapplying migrations.0002_second... OK', stdout)
61.         # Tables are gone
62.         self.assertTableNotExists("migrations_author")
63.         self.assertTableNotExists("migrations_tribble")
64.         self.assertTableNotExists("migrations_book")
65. 
66.     @override_settings(INSTALLED_APPS=[
67.         'django.contrib.auth',
68.         'django.contrib.contenttypes',
69.         'migrations.migrations_test_apps.migrated_app',
70.     ])
71.     def test_migrate_with_system_checks(self):
72.         out = io.StringIO()
73.         call_command('migrate', skip_checks=False, no_color=True, stdout=out)
74.         self.assertIn('Apply all migrations: migrated_app', out.getvalue())
75. 
76.     @override_settings(INSTALLED_APPS=['migrations', 'migrations.migrations_test_apps.unmigrated_app_syncdb'])
77.     def test_app_without_migrations(self):
78.         msg = "App 'unmigrated_app_syncdb' does not have migrations."
79.         with self.assertRaisesMessage(CommandError, msg):
80.             call_command('migrate', app_label='unmigrated_app_syncdb')
81. 
82.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_clashing_prefix'})
83.     def test_ambiguous_prefix(self):
84.         msg = (
85.             "More than one migration matches 'a' in app 'migrations'. Please "
86.             "be more specific."
87.         )
88.         with self.assertRaisesMessage(CommandError, msg):
89.             call_command('migrate', app_label='migrations', migration_name='a')
90. 
91.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations'})
92.     def test_unknown_prefix(self):
93.         msg = "Cannot find a migration matching 'nonexistent' from app 'migrations'."
94.         with self.assertRaisesMessage(CommandError, msg):
95.             call_command('migrate', app_label='migrations', migration_name='nonexistent')
96. 
97.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})
98.     def test_migrate_initial_false(self):
99.         """
100.         `Migration.initial = False` skips fake-initial detection.
101.         """
102.         # Make sure no tables are created
103.         self.assertTableNotExists("migrations_author")
104.         self.assertTableNotExists("migrations_tribble")
105.         # Run the migrations to 0001 only
106.         call_command("migrate", "migrations", "0001", verbosity=0)
107.         # Fake rollback
108.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
109.         # Make sure fake-initial detection does not run
110.         with self.assertRaises(DatabaseError):
111.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)
112. 
113.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)
114.         # Real rollback
115.         call_command("migrate", "migrations", "zero", verbosity=0)
116.         # Make sure it's all gone
117.         self.assertTableNotExists("migrations_author")
118.         self.assertTableNotExists("migrations_tribble")
119.         self.assertTableNotExists("migrations_book")
120. 
121.     @override_settings(
122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
123.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
124.     )
125.     def test_migrate_fake_initial(self):
126.         """
127.         --fake-initial only works if all tables created in the initial
128.         migration of an app exists. Database routers must be obeyed when doing
129.         that check.
130.         """
131.         # Make sure no tables are created
132.         for db in self.databases:
133.             self.assertTableNotExists("migrations_author", using=db)
134.             self.assertTableNotExists("migrations_tribble", using=db)
135.         # Run the migrations to 0001 only
136.         call_command("migrate", "migrations", "0001", verbosity=0)
137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
138.         # Make sure the right tables exist
139.         self.assertTableExists("migrations_author")
140.         self.assertTableNotExists("migrations_tribble")
141.         # Also check the "other" database
142.         self.assertTableNotExists("migrations_author", using="other")
143.         self.assertTableExists("migrations_tribble", using="other")
144. 
145.         # Fake a roll-back
146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
148.         # Make sure the tables still exist
149.         self.assertTableExists("migrations_author")
150.         self.assertTableExists("migrations_tribble", using="other")
151.         # Try to run initial migration
152.         with self.assertRaises(DatabaseError):
153.             call_command("migrate", "migrations", "0001", verbosity=0)
154.         # Run initial migration with an explicit --fake-initial
155.         out = io.StringIO()
156.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
159.         self.assertIn(
160.             "migrations.0001_initial... faked",
161.             out.getvalue().lower()
162.         )
163.         # Run migrations all the way
164.         call_command("migrate", verbosity=0)
165.         call_command("migrate", verbosity=0, database="other")
166.         # Make sure the right tables exist
167.         self.assertTableExists("migrations_author")
168.         self.assertTableNotExists("migrations_tribble")
169.         self.assertTableExists("migrations_book")
170.         self.assertTableNotExists("migrations_author", using="other")
171.         self.assertTableNotExists("migrations_tribble", using="other")
172.         self.assertTableNotExists("migrations_book", using="other")
173.         # Fake a roll-back
174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
176.         # Make sure the tables still exist
177.         self.assertTableExists("migrations_author")
178.         self.assertTableNotExists("migrations_tribble")
179.         self.assertTableExists("migrations_book")
180.         # Try to run initial migration
181.         with self.assertRaises(DatabaseError):
182.             call_command("migrate", "migrations", verbosity=0)
183.         # Run initial migration with an explicit --fake-initial
184.         with self.assertRaises(DatabaseError):
185.             # Fails because "migrations_tribble" does not exist but needs to in
186.             # order to make --fake-initial work.
187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
188.         # Fake an apply
189.         call_command("migrate", "migrations", fake=True, verbosity=0)
190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
194.         # Make sure it's all gone
195.         for db in self.databases:
196.             self.assertTableNotExists("migrations_author", using=db)
197.             self.assertTableNotExists("migrations_tribble", using=db)
198.             self.assertTableNotExists("migrations_book", using=db)
199. 
200.     @skipUnlessDBFeature('ignores_table_name_case')
201.     def test_migrate_fake_initial_case_insensitive(self):
202.         with override_settings(MIGRATION_MODULES={
203.             'migrations': 'migrations.test_fake_initial_case_insensitive.initial',
204.         }):
205.             call_command('migrate', 'migrations', '0001', verbosity=0)
206.             call_command('migrate', 'migrations', 'zero', fake=True, verbosity=0)
207. 
208.         with override_settings(MIGRATION_MODULES={
209.             'migrations': 'migrations.test_fake_initial_case_insensitive.fake_initial',
210.         }):
211.             out = io.StringIO()
212.             call_command(
213.                 'migrate',
214.                 'migrations',
215.                 '0001',
216.                 fake_initial=True,
217.                 stdout=out,
218.                 verbosity=1,
219.                 no_color=True,
220.             )
221.             self.assertIn(
222.                 'migrations.0001_initial... faked',
223.                 out.getvalue().lower(),
224.             )
225. 
226.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})
227.     def test_migrate_fake_split_initial(self):
228.         """
229.         Split initial migrations can be faked with --fake-initial.
230.         """
231.         call_command("migrate", "migrations", "0002", verbosity=0)
232.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
233.         out = io.StringIO()
234.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
235.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)
236.         value = out.getvalue().lower()
237.         self.assertIn("migrations.0001_initial... faked", value)
238.         self.assertIn("migrations.0002_second... faked", value)
239.         # Fake an apply
240.         call_command("migrate", "migrations", fake=True, verbosity=0)
241.         # Unmigrate everything
242.         call_command("migrate", "migrations", "zero", verbosity=0)
243. 
244.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})
245.     def test_migrate_conflict_exit(self):
246.         """
247.         migrate exits if it detects a conflict.
248.         """
249.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):
250.             call_command("migrate", "migrations")
251. 
252.     @override_settings(MIGRATION_MODULES={
253.         'migrations': 'migrations.test_migrations',
254.     })
255.     def test_migrate_check(self):
256.         with self.assertRaises(SystemExit):
257.             call_command('migrate', 'migrations', '0001', check_unapplied=True, verbosity=0)
258.         self.assertTableNotExists('migrations_author')
259.         self.assertTableNotExists('migrations_tribble')
260.         self.assertTableNotExists('migrations_book')
261. 
262.     @override_settings(MIGRATION_MODULES={
263.         'migrations': 'migrations.test_migrations_plan',
264.     })
265.     def test_migrate_check_plan(self):
266.         out = io.StringIO()
267.         with self.assertRaises(SystemExit):
268.             call_command(
269.                 'migrate',
270.                 'migrations',
271.                 '0001',
272.                 check_unapplied=True,
273.                 plan=True,
274.                 stdout=out,
275.                 no_color=True,
276.             )
277.         self.assertEqual(
278.             'Planned operations:\n'
279.             'migrations.0001_initial\n'
280.             '    Create model Salamander\n'
281.             '    Raw Python operation -> Grow salamander tail.\n',
282.             out.getvalue(),
283.         )
284. 
285.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
286.     def test_showmigrations_list(self):
287.         """
288.         showmigrations --list  displays migrations and whether or not they're
289.         applied.
290.         """
291.         out = io.StringIO()
292.         with mock.patch('django.core.management.color.supports_color', lambda *args: True):
293.             call_command("showmigrations", format='list', stdout=out, verbosity=0, no_color=False)
294.         self.assertEqual(
295.             '\x1b[1mmigrations\n\x1b[0m'
296.             ' [ ] 0001_initial\n'
297.             ' [ ] 0002_second\n',
298.             out.getvalue().lower()
299.         )
300. 
301.         call_command("migrate", "migrations", "0001", verbosity=0)
302. 
303.         out = io.StringIO()
304.         # Giving the explicit app_label tests for selective `show_list` in the command
305.         call_command("showmigrations", "migrations", format='list', stdout=out, verbosity=0, no_color=True)
306.         self.assertEqual(
307.             'migrations\n'
308.             ' [x] 0001_initial\n'
309.             ' [ ] 0002_second\n',
310.             out.getvalue().lower()
311.         )
312.         out = io.StringIO()
313.         # Applied datetimes are displayed at verbosity 2+.
314.         call_command('showmigrations', 'migrations', stdout=out, verbosity=2, no_color=True)
315.         migration1 = MigrationRecorder(connection).migration_qs.get(app='migrations', name='0001_initial')
316.         self.assertEqual(
317.             'migrations\n'
318.             ' [x] 0001_initial (applied at %s)\n'
319.             ' [ ] 0002_second\n' % migration1.applied.strftime('%Y-%m-%d %H:%M:%S'),
320.             out.getvalue().lower()
321.         )
322.         # Cleanup by unmigrating everything
323.         call_command("migrate", "migrations", "zero", verbosity=0)
324. 
325.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})
326.     def test_showmigrations_plan(self):
327.         """
328.         Tests --plan output of showmigrations command
329.         """
330.         out = io.StringIO()
331.         call_command("showmigrations", format='plan', stdout=out)
332.         self.assertEqual(
333.             "[ ]  migrations.0001_initial\n"
334.             "[ ]  migrations.0003_third\n"
335.             "[ ]  migrations.0002_second\n",
336.             out.getvalue().lower()
337.         )
338. 
339.         out = io.StringIO()
340.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
341.         self.assertEqual(
342.             "[ ]  migrations.0001_initial\n"
343.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\n"
344.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
345.             out.getvalue().lower()
346.         )
347.         call_command("migrate", "migrations", "0003", verbosity=0)
348. 
349.         out = io.StringIO()
350.         call_command("showmigrations", format='plan', stdout=out)
351.         self.assertEqual(
352.             "[x]  migrations.0001_initial\n"
353.             "[x]  migrations.0003_third\n"
354.             "[ ]  migrations.0002_second\n",
355.             out.getvalue().lower()
356.         )
357. 
358.         out = io.StringIO()
359.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
360.         self.assertEqual(
361.             "[x]  migrations.0001_initial\n"
362.             "[x]  migrations.0003_third ... (migrations.0001_initial)\n"
363.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
364.             out.getvalue().lower()
365.         )
366. 
367.         # Cleanup by unmigrating everything
368.         call_command("migrate", "migrations", "zero", verbosity=0)
369. 
370.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_plan'})
371.     def test_migrate_plan(self):
372.         """Tests migrate --plan output."""
373.         out = io.StringIO()
374.         # Show the plan up to the third migration.
375.         call_command('migrate', 'migrations', '0003', plan=True, stdout=out, no_color=True)
376.         self.assertEqual(
377.             'Planned operations:\n'
378.             'migrations.0001_initial\n'
379.             '    Create model Salamander\n'
380.             '    Raw Python operation -> Grow salamander tail.\n'
381.             'migrations.0002_second\n'
382.             '    Create model Book\n'
383.             "    Raw SQL operation -> ['SELECT * FROM migrations_book']\n"
384.             'migrations.0003_third\n'
385.             '    Create model Author\n'
386.             "    Raw SQL operation -> ['SELECT * FROM migrations_author']\n",
387.             out.getvalue()
388.         )
389.         try:
390.             # Migrate to the third migration.
391.             call_command('migrate', 'migrations', '0003', verbosity=0)
392.             out = io.StringIO()
393.             # Show the plan for when there is nothing to apply.
394.             call_command('migrate', 'migrations', '0003', plan=True, stdout=out, no_color=True)
395.             self.assertEqual(
396.                 'Planned operations:\n'
397.                 '  No planned migration operations.\n',
398.                 out.getvalue()
399.             )
400.             out = io.StringIO()
401.             # Show the plan for reverse migration back to 0001.
402.             call_command('migrate', 'migrations', '0001', plan=True, stdout=out, no_color=True)
403.             self.assertEqual(
404.                 'Planned operations:\n'
405.                 'migrations.0003_third\n'
406.                 '    Undo Create model Author\n'
407.                 "    Raw SQL operation -> ['SELECT * FROM migrations_book']\n"
408.                 'migrations.0002_second\n'
409.                 '    Undo Create model Book\n'
410.                 "    Raw SQL operation -> ['SELECT * FROM migrations_salamand…\n",
411.                 out.getvalue()
412.             )
413.             out = io.StringIO()
414.             # Show the migration plan to fourth, with truncated details.
415.             call_command('migrate', 'migrations', '0004', plan=True, stdout=out, no_color=True)
416.             self.assertEqual(
417.                 'Planned operations:\n'
418.                 'migrations.0004_fourth\n'
419.                 '    Raw SQL operation -> SELECT * FROM migrations_author WHE…\n',
420.                 out.getvalue()
421.             )
422.             # Show the plan when an operation is irreversible.
423.             # Migrate to the fourth migration.
424.             call_command('migrate', 'migrations', '0004', verbosity=0)
425.             out = io.StringIO()
426.             call_command('migrate', 'migrations', '0003', plan=True, stdout=out, no_color=True)
427.             self.assertEqual(
428.                 'Planned operations:\n'
429.                 'migrations.0004_fourth\n'
430.                 '    Raw SQL operation -> IRREVERSIBLE\n',
431.                 out.getvalue()
432.             )
433.             out = io.StringIO()
434.             call_command('migrate', 'migrations', '0005', plan=True, stdout=out, no_color=True)
435.             # Operation is marked as irreversible only in the revert plan.
436.             self.assertEqual(
437.                 'Planned operations:\n'
438.                 'migrations.0005_fifth\n'
439.                 '    Raw Python operation\n'
440.                 '    Raw Python operation\n'
441.                 '    Raw Python operation -> Feed salamander.\n',
442.                 out.getvalue()
443.             )
444.             call_command('migrate', 'migrations', '0005', verbosity=0)
445.             out = io.StringIO()
446.             call_command('migrate', 'migrations', '0004', plan=True, stdout=out, no_color=True)
447.             self.assertEqual(
448.                 'Planned operations:\n'
449.                 'migrations.0005_fifth\n'
450.                 '    Raw Python operation -> IRREVERSIBLE\n'
451.                 '    Raw Python operation -> IRREVERSIBLE\n'
452.                 '    Raw Python operation\n',
453.                 out.getvalue()
454.             )
455.         finally:
456.             # Cleanup by unmigrating everything: fake the irreversible, then
457.             # migrate all to zero.
458.             call_command('migrate', 'migrations', '0003', fake=True, verbosity=0)
459.             call_command('migrate', 'migrations', 'zero', verbosity=0)
460. 
461.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_empty'})
462.     def test_showmigrations_no_migrations(self):
463.         out = io.StringIO()
464.         call_command('showmigrations', stdout=out, no_color=True)
465.         self.assertEqual('migrations\n (no migrations)\n', out.getvalue().lower())
466. 
467.     @override_settings(INSTALLED_APPS=['migrations.migrations_test_apps.unmigrated_app'])
468.     def test_showmigrations_unmigrated_app(self):
469.         out = io.StringIO()
470.         call_command('showmigrations', 'unmigrated_app', stdout=out, no_color=True)
471.         self.assertEqual('unmigrated_app\n (no migrations)\n', out.getvalue().lower())
472. 
473.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})
474.     def test_showmigrations_plan_no_migrations(self):
475.         """
476.         Tests --plan output of showmigrations command without migrations
477.         """
478.         out = io.StringIO()
479.         call_command('showmigrations', format='plan', stdout=out, no_color=True)
480.         self.assertEqual('(no migrations)\n', out.getvalue().lower())
481. 
482.         out = io.StringIO()
483.         call_command('showmigrations', format='plan', stdout=out, verbosity=2, no_color=True)
484.         self.assertEqual('(no migrations)\n', out.getvalue().lower())
485. 
486.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})
487.     def test_showmigrations_plan_squashed(self):
488.         """
489.         Tests --plan output of showmigrations command with squashed migrations.
490.         """
491.         out = io.StringIO()
492.         call_command("showmigrations", format='plan', stdout=out)
493.         self.assertEqual(
494.             "[ ]  migrations.1_auto\n"
495.             "[ ]  migrations.2_auto\n"
496.             "[ ]  migrations.3_squashed_5\n"
497.             "[ ]  migrations.6_auto\n"
498.             "[ ]  migrations.7_auto\n",
499.             out.getvalue().lower()
500.         )

File: tests/model_regress/tests.py
Line number range: 1 - 258
Content:
1. import datetime
2. from operator import attrgetter
3. 
4. from django.core.exceptions import ValidationError
5. from django.db import models, router
6. from django.db.models.sql import InsertQuery
7. from django.test import TestCase, skipUnlessDBFeature
8. from django.test.utils import isolate_apps
9. from django.utils.timezone import get_fixed_timezone
10. 
11. from .models import (
12.     Article, Department, Event, Model1, Model2, Model3, NonAutoPK, Party,
13.     Worker,
14. )
15. 
16. 
17. class ModelTests(TestCase):
18.     def test_model_init_too_many_args(self):
19.         msg = "Number of args exceeds number of fields"
20.         with self.assertRaisesMessage(IndexError, msg):
21.             Worker(1, 2, 3, 4)
22. 
23.     # The bug is that the following queries would raise:
24.     # "TypeError: Related Field has invalid lookup: gte"
25.     def test_related_gte_lookup(self):
26.         """
27.         Regression test for #10153: foreign key __gte lookups.
28.         """
29.         Worker.objects.filter(department__gte=0)
30. 
31.     def test_related_lte_lookup(self):
32.         """
33.         Regression test for #10153: foreign key __lte lookups.
34.         """
35.         Worker.objects.filter(department__lte=0)
36. 
37.     def test_sql_insert_compiler_return_id_attribute(self):
38.         """
39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure
40.         """
41.         db = router.db_for_write(Party)
42.         query = InsertQuery(Party)
43.         query.insert_values([Party._meta.fields[0]], [], raw=False)
44.         # this line will raise an AttributeError without the accompanying fix
45.         query.get_compiler(using=db).as_sql()
46. 
47.     def test_empty_choice(self):
48.         # NOTE: Part of the regression test here is merely parsing the model
49.         # declaration. The verbose_name, in particular, did not always work.
50.         a = Article.objects.create(
51.             headline="Look at me!", pub_date=datetime.datetime.now()
52.         )
53.         # An empty choice field should return None for the display name.
54.         self.assertIs(a.get_status_display(), None)
55. 
56.         # Empty strings should be returned as string
57.         a = Article.objects.get(pk=a.pk)
58.         self.assertEqual(a.misc_data, '')
59. 
60.     def test_long_textfield(self):
61.         # TextFields can hold more than 4000 characters (this was broken in
62.         # Oracle).
63.         a = Article.objects.create(
64.             headline="Really, really big",
65.             pub_date=datetime.datetime.now(),
66.             article_text="ABCDE" * 1000
67.         )
68.         a = Article.objects.get(pk=a.pk)
69.         self.assertEqual(len(a.article_text), 5000)
70. 
71.     def test_long_unicode_textfield(self):
72.         # TextFields can hold more than 4000 bytes also when they are
73.         # less than 4000 characters
74.         a = Article.objects.create(
75.             headline="Really, really big",
76.             pub_date=datetime.datetime.now(),
77.             article_text='\u05d0\u05d1\u05d2' * 1000
78.         )
79.         a = Article.objects.get(pk=a.pk)
80.         self.assertEqual(len(a.article_text), 3000)
81. 
82.     def test_date_lookup(self):
83.         # Regression test for #659
84.         Party.objects.create(when=datetime.datetime(1999, 12, 31))
85.         Party.objects.create(when=datetime.datetime(1998, 12, 31))
86.         Party.objects.create(when=datetime.datetime(1999, 1, 1))
87.         Party.objects.create(when=datetime.datetime(1, 3, 3))
88.         self.assertQuerysetEqual(
89.             Party.objects.filter(when__month=2), []
90.         )
91.         self.assertQuerysetEqual(
92.             Party.objects.filter(when__month=1), [
93.                 datetime.date(1999, 1, 1)
94.             ],
95.             attrgetter("when")
96.         )
97.         self.assertQuerysetEqual(
98.             Party.objects.filter(when__month=12), [
99.                 datetime.date(1999, 12, 31),
100.                 datetime.date(1998, 12, 31),
101.             ],
102.             attrgetter("when"),
103.             ordered=False
104.         )
105.         self.assertQuerysetEqual(
106.             Party.objects.filter(when__year=1998), [
107.                 datetime.date(1998, 12, 31),
108.             ],
109.             attrgetter("when")
110.         )
111.         # Regression test for #8510
112.         self.assertQuerysetEqual(
113.             Party.objects.filter(when__day="31"), [
114.                 datetime.date(1999, 12, 31),
115.                 datetime.date(1998, 12, 31),
116.             ],
117.             attrgetter("when"),
118.             ordered=False
119.         )
120.         self.assertQuerysetEqual(
121.             Party.objects.filter(when__month="12"), [
122.                 datetime.date(1999, 12, 31),
123.                 datetime.date(1998, 12, 31),
124.             ],
125.             attrgetter("when"),
126.             ordered=False
127.         )
128.         self.assertQuerysetEqual(
129.             Party.objects.filter(when__year="1998"), [
130.                 datetime.date(1998, 12, 31),
131.             ],
132.             attrgetter("when")
133.         )
134. 
135.         # Regression test for #18969
136.         self.assertQuerysetEqual(
137.             Party.objects.filter(when__year=1), [
138.                 datetime.date(1, 3, 3),
139.             ],
140.             attrgetter("when")
141.         )
142.         self.assertQuerysetEqual(
143.             Party.objects.filter(when__year='1'), [
144.                 datetime.date(1, 3, 3),
145.             ],
146.             attrgetter("when")
147.         )
148. 
149.     def test_date_filter_null(self):
150.         # Date filtering was failing with NULL date values in SQLite
151.         # (regression test for #3501, among other things).
152.         Party.objects.create(when=datetime.datetime(1999, 1, 1))
153.         Party.objects.create()
154.         p = Party.objects.filter(when__month=1)[0]
155.         self.assertEqual(p.when, datetime.date(1999, 1, 1))
156.         self.assertQuerysetEqual(
157.             Party.objects.filter(pk=p.pk).dates("when", "month"), [
158.                 1
159.             ],
160.             attrgetter("month")
161.         )
162. 
163.     def test_get_next_prev_by_field(self):
164.         # get_next_by_FIELD() and get_previous_by_FIELD() don't crash when
165.         # microseconds values are stored in the database.
166.         Event.objects.create(when=datetime.datetime(2000, 1, 1, 16, 0, 0))
167.         Event.objects.create(when=datetime.datetime(2000, 1, 1, 6, 1, 1))
168.         Event.objects.create(when=datetime.datetime(2000, 1, 1, 13, 1, 1))
169.         e = Event.objects.create(when=datetime.datetime(2000, 1, 1, 12, 0, 20, 24))
170.         self.assertEqual(
171.             e.get_next_by_when().when, datetime.datetime(2000, 1, 1, 13, 1, 1)
172.         )
173.         self.assertEqual(
174.             e.get_previous_by_when().when, datetime.datetime(2000, 1, 1, 6, 1, 1)
175.         )
176. 
177.     def test_get_next_prev_by_field_unsaved(self):
178.         msg = 'get_next/get_previous cannot be used on unsaved objects.'
179.         with self.assertRaisesMessage(ValueError, msg):
180.             Event().get_next_by_when()
181.         with self.assertRaisesMessage(ValueError, msg):
182.             Event().get_previous_by_when()
183. 
184.     def test_primary_key_foreign_key_types(self):
185.         # Check Department and Worker (non-default PK type)
186.         d = Department.objects.create(id=10, name="IT")
187.         w = Worker.objects.create(department=d, name="Full-time")
188.         self.assertEqual(str(w), "Full-time")
189. 
190.     @skipUnlessDBFeature("supports_timezones")
191.     def test_timezones(self):
192.         # Saving and updating with timezone-aware datetime Python objects.
193.         # Regression test for #10443.
194.         # The idea is that all these creations and saving should work without
195.         # crashing. It's not rocket science.
196.         dt1 = datetime.datetime(2008, 8, 31, 16, 20, tzinfo=get_fixed_timezone(600))
197.         dt2 = datetime.datetime(2008, 8, 31, 17, 20, tzinfo=get_fixed_timezone(600))
198.         obj = Article.objects.create(
199.             headline="A headline", pub_date=dt1, article_text="foo"
200.         )
201.         obj.pub_date = dt2
202.         obj.save()
203.         self.assertEqual(
204.             Article.objects.filter(headline="A headline").update(pub_date=dt1),
205.             1
206.         )
207. 
208.     def test_chained_fks(self):
209.         """
210.         Regression for #18432: Chained foreign keys with to_field produce incorrect query
211.         """
212. 
213.         m1 = Model1.objects.create(pkey=1000)
214.         m2 = Model2.objects.create(model1=m1)
215.         m3 = Model3.objects.create(model2=m2)
216. 
217.         # this is the actual test for #18432
218.         m3 = Model3.objects.get(model2=1000)
219.         m3.model2
220. 
221.     @isolate_apps('model_regress')
222.     def test_metaclass_can_access_attribute_dict(self):
223.         """
224.         Model metaclasses have access to the class attribute dict in
225.         __init__() (#30254).
226.         """
227.         class HorseBase(models.base.ModelBase):
228.             def __init__(cls, name, bases, attrs):
229.                 super().__init__(name, bases, attrs)
230.                 cls.horns = (1 if 'magic' in attrs else 0)
231. 
232.         class Horse(models.Model, metaclass=HorseBase):
233.             name = models.CharField(max_length=255)
234.             magic = True
235. 
236.         self.assertEqual(Horse.horns, 1)
237. 
238. 
239. class ModelValidationTest(TestCase):
240.     def test_pk_validation(self):
241.         NonAutoPK.objects.create(name="one")
242.         again = NonAutoPK(name="one")
243.         with self.assertRaises(ValidationError):
244.             again.validate_unique()
245. 
246. 
247. class EvaluateMethodTest(TestCase):
248.     """
249.     Regression test for #13640: cannot filter by objects with 'evaluate' attr
250.     """
251. 
252.     def test_model_with_evaluate_method(self):
253.         """
254.         You can filter by objects that have an 'evaluate' attr
255.         """
256.         dept = Department.objects.create(pk=1, name='abc')
257.         dept.evaluate = 'abc'
258.         Worker.objects.filter(department=dept)


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and return it in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 05:07:14,497 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="This test class is highly relevant as it's designed to test operations in a multi-database environment. It contains multiple test methods that explicitly use the `using` parameter to target a specific database for write operations, such as `test_other_creation` and `test_refresh`. These tests are crucial to validate that the proposed simplification of `execute_sql_flush` does not break the fundamental ability to direct writes to the correct database.", relative_path='tests/multiple_database/tests.py', start_line=19, end_line=114), ContextOutput(reasoning='This test case is relevant because it checks that M2M operations (add, remove, clear, create) are constrained to a single database. The issue is about `execute_sql_flush` which can be used in such operations. This test ensures that even after the refactoring, the database alias is correctly inferred and operations on one database do not leak into another.', relative_path='tests/multiple_database/tests.py', start_line=200, end_line=258), ContextOutput(reasoning='This test case is important because it verifies that the system prevents M2M relations between objects stored in different databases. It uses `transaction.atomic(using=...)` to specify the database context for the operations. This is a critical safety feature in multi-db setups that must be preserved after the refactoring of `execute_sql_flush`.', relative_path='tests/multiple_database/tests.py', start_line=321, end_line=368), ContextOutput(reasoning='This test is relevant because it deals with migrations in a multi-database setup. It specifically tests the `--fake-initial` flag when tables already exist, which requires checking the state of a specific database. Migrations involve schema changes that might use `execute_sql_flush`. The test uses a database router and applies migrations to a non-default database, making it a good integration test for the proposed change.', relative_path='tests/migrations/test_commands.py', start_line=121, end_line=199), ContextOutput(reasoning='This test is relevant because it demonstrates testing a low-level database component, the `SQLInsertCompiler`. It explicitly gets a database alias and passes it to the compiler via the `using` parameter. This is analogous to the current signature of `execute_sql_flush` and provides a useful pattern for how to write a targeted test for the refactored method to ensure the database alias is correctly inferred from the connection.', relative_path='tests/model_regress/tests.py', start_line=37, end_line=46)]
2025-10-06 05:07:14,498 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='tests/multiple_database/tests.py', content='19. class QueryTestCase(TestCase):\n20.     databases = {\'default\', \'other\'}\n21. \n22.     def test_db_selection(self):\n23.         "Querysets will use the default database by default"\n24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)\n25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)\n26. \n27.         self.assertEqual(Book.objects.using(\'other\').db, \'other\')\n28. \n29.         self.assertEqual(Book.objects.db_manager(\'other\').db, \'other\')\n30.         self.assertEqual(Book.objects.db_manager(\'other\').all().db, \'other\')\n31. \n32.     def test_default_creation(self):\n33.         "Objects created on the default database don\'t leak onto other databases"\n34.         # Create a book on the default database using create()\n35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n36. \n37.         # Create a book on the default database using a save\n38.         dive = Book()\n39.         dive.title = "Dive into Python"\n40.         dive.published = datetime.date(2009, 5, 4)\n41.         dive.save()\n42. \n43.         # Book exists on the default database, but not on other database\n44.         try:\n45.             Book.objects.get(title="Pro Django")\n46.             Book.objects.using(\'default\').get(title="Pro Django")\n47.         except Book.DoesNotExist:\n48.             self.fail(\'"Pro Django" should exist on default database\')\n49. \n50.         with self.assertRaises(Book.DoesNotExist):\n51.             Book.objects.using(\'other\').get(title="Pro Django")\n52. \n53.         try:\n54.             Book.objects.get(title="Dive into Python")\n55.             Book.objects.using(\'default\').get(title="Dive into Python")\n56.         except Book.DoesNotExist:\n57.             self.fail(\'"Dive into Python" should exist on default database\')\n58. \n59.         with self.assertRaises(Book.DoesNotExist):\n60.             Book.objects.using(\'other\').get(title="Dive into Python")\n61. \n62.     def test_other_creation(self):\n63.         "Objects created on another database don\'t leak onto the default database"\n64.         # Create a book on the second database\n65.         Book.objects.using(\'other\').create(title="Pro Django",\n66.                                            published=datetime.date(2008, 12, 16))\n67. \n68.         # Create a book on the default database using a save\n69.         dive = Book()\n70.         dive.title = "Dive into Python"\n71.         dive.published = datetime.date(2009, 5, 4)\n72.         dive.save(using=\'other\')\n73. \n74.         # Book exists on the default database, but not on other database\n75.         try:\n76.             Book.objects.using(\'other\').get(title="Pro Django")\n77.         except Book.DoesNotExist:\n78.             self.fail(\'"Pro Django" should exist on other database\')\n79. \n80.         with self.assertRaises(Book.DoesNotExist):\n81.             Book.objects.get(title="Pro Django")\n82.         with self.assertRaises(Book.DoesNotExist):\n83.             Book.objects.using(\'default\').get(title="Pro Django")\n84. \n85.         try:\n86.             Book.objects.using(\'other\').get(title="Dive into Python")\n87.         except Book.DoesNotExist:\n88.             self.fail(\'"Dive into Python" should exist on other database\')\n89. \n90.         with self.assertRaises(Book.DoesNotExist):\n91.             Book.objects.get(title="Dive into Python")\n92.         with self.assertRaises(Book.DoesNotExist):\n93.             Book.objects.using(\'default\').get(title="Dive into Python")\n94. \n95.     def test_refresh(self):\n96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))\n97.         dive.save(using=\'other\')\n98.         dive2 = Book.objects.using(\'other\').get()\n99.         dive2.title = "Dive into Python (on default)"\n100.         dive2.save(using=\'default\')\n101.         dive.refresh_from_db()\n102.         self.assertEqual(dive.title, "Dive into Python")\n103.         dive.refresh_from_db(using=\'default\')\n104.         self.assertEqual(dive.title, "Dive into Python (on default)")\n105.         self.assertEqual(dive._state.db, "default")\n106. \n107.     def test_refresh_router_instance_hint(self):\n108.         router = Mock()\n109.         router.db_for_read.return_value = None\n110.         book = Book.objects.create(title=\'Dive Into Python\', published=datetime.date(1957, 10, 12))\n111.         with self.settings(DATABASE_ROUTERS=[router]):\n112.             book.refresh_from_db()\n113.         router.db_for_read.assert_called_once_with(Book, instance=book)\n114. ', start_line_number=19, end_line_number=114), Context(relative_path='tests/multiple_database/tests.py', content='200.     def test_m2m_forward_operations(self):\n201.         "M2M forward manipulations are all constrained to a single DB"\n202.         # Create a book and author on the other database\n203.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n204.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n205. \n206.         # Save the author relations\n207.         dive.authors.set([mark])\n208. \n209.         # Add a second author\n210.         john = Person.objects.using(\'other\').create(name="John Smith")\n211.         self.assertEqual(\n212.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n213.             []\n214.         )\n215. \n216.         dive.authors.add(john)\n217.         self.assertEqual(\n218.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n219.             [\'Dive into Python\']\n220.         )\n221.         self.assertEqual(\n222.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n223.             [\'Dive into Python\']\n224.         )\n225. \n226.         # Remove the second author\n227.         dive.authors.remove(john)\n228.         self.assertEqual(\n229.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n230.             [\'Dive into Python\']\n231.         )\n232.         self.assertEqual(\n233.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n234.             []\n235.         )\n236. \n237.         # Clear all authors\n238.         dive.authors.clear()\n239.         self.assertEqual(\n240.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n241.             []\n242.         )\n243.         self.assertEqual(\n244.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n245.             []\n246.         )\n247. \n248.         # Create an author through the m2m interface\n249.         dive.authors.create(name=\'Jane Brown\')\n250.         self.assertEqual(\n251.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n252.             []\n253.         )\n254.         self.assertEqual(\n255.             list(Book.objects.using(\'other\').filter(authors__name=\'Jane Brown\').values_list(\'title\', flat=True)),\n256.             [\'Dive into Python\']\n257.         )\n258. ', start_line_number=200, end_line_number=258), Context(relative_path='tests/multiple_database/tests.py', content='321.     def test_m2m_cross_database_protection(self):\n322.         "Operations that involve sharing M2M objects across databases raise an error"\n323.         # Create a book and author on the default database\n324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n325. \n326.         marty = Person.objects.create(name="Marty Alchin")\n327. \n328.         # Create a book and author on the other database\n329.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n330. \n331.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n332.         # Set a foreign key set with an object from a different database\n333.         msg = (\n334.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n335.             \'router prevents this relation.\'\n336.         )\n337.         with self.assertRaisesMessage(ValueError, msg):\n338.             with transaction.atomic(using=\'default\'):\n339.                 marty.edited.set([pro, dive])\n340. \n341.         # Add to an m2m with an object from a different database\n342.         msg = (\n343.             \'Cannot add "<Book: Dive into Python>": instance is on \'\n344.             \'database "default", value is on database "other"\'\n345.         )\n346.         with self.assertRaisesMessage(ValueError, msg):\n347.             with transaction.atomic(using=\'default\'):\n348.                 marty.book_set.add(dive)\n349. \n350.         # Set a m2m with an object from a different database\n351.         with self.assertRaisesMessage(ValueError, msg):\n352.             with transaction.atomic(using=\'default\'):\n353.                 marty.book_set.set([pro, dive])\n354. \n355.         # Add to a reverse m2m with an object from a different database\n356.         msg = (\n357.             \'Cannot add "<Person: Marty Alchin>": instance is on \'\n358.             \'database "other", value is on database "default"\'\n359.         )\n360.         with self.assertRaisesMessage(ValueError, msg):\n361.             with transaction.atomic(using=\'other\'):\n362.                 dive.authors.add(marty)\n363. \n364.         # Set a reverse m2m with an object from a different database\n365.         with self.assertRaisesMessage(ValueError, msg):\n366.             with transaction.atomic(using=\'other\'):\n367.                 dive.authors.set([mark, marty])\n368. ', start_line_number=321, end_line_number=368), Context(relative_path='tests/migrations/test_commands.py', content='121.     @override_settings(\n122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},\n123.         DATABASE_ROUTERS=[\'migrations.routers.TestRouter\'],\n124.     )\n125.     def test_migrate_fake_initial(self):\n126.         """\n127.         --fake-initial only works if all tables created in the initial\n128.         migration of an app exists. Database routers must be obeyed when doing\n129.         that check.\n130.         """\n131.         # Make sure no tables are created\n132.         for db in self.databases:\n133.             self.assertTableNotExists("migrations_author", using=db)\n134.             self.assertTableNotExists("migrations_tribble", using=db)\n135.         # Run the migrations to 0001 only\n136.         call_command("migrate", "migrations", "0001", verbosity=0)\n137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")\n138.         # Make sure the right tables exist\n139.         self.assertTableExists("migrations_author")\n140.         self.assertTableNotExists("migrations_tribble")\n141.         # Also check the "other" database\n142.         self.assertTableNotExists("migrations_author", using="other")\n143.         self.assertTableExists("migrations_tribble", using="other")\n144. \n145.         # Fake a roll-back\n146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n148.         # Make sure the tables still exist\n149.         self.assertTableExists("migrations_author")\n150.         self.assertTableExists("migrations_tribble", using="other")\n151.         # Try to run initial migration\n152.         with self.assertRaises(DatabaseError):\n153.             call_command("migrate", "migrations", "0001", verbosity=0)\n154.         # Run initial migration with an explicit --fake-initial\n155.         out = io.StringIO()\n156.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)\n158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")\n159.         self.assertIn(\n160.             "migrations.0001_initial... faked",\n161.             out.getvalue().lower()\n162.         )\n163.         # Run migrations all the way\n164.         call_command("migrate", verbosity=0)\n165.         call_command("migrate", verbosity=0, database="other")\n166.         # Make sure the right tables exist\n167.         self.assertTableExists("migrations_author")\n168.         self.assertTableNotExists("migrations_tribble")\n169.         self.assertTableExists("migrations_book")\n170.         self.assertTableNotExists("migrations_author", using="other")\n171.         self.assertTableNotExists("migrations_tribble", using="other")\n172.         self.assertTableNotExists("migrations_book", using="other")\n173.         # Fake a roll-back\n174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n176.         # Make sure the tables still exist\n177.         self.assertTableExists("migrations_author")\n178.         self.assertTableNotExists("migrations_tribble")\n179.         self.assertTableExists("migrations_book")\n180.         # Try to run initial migration\n181.         with self.assertRaises(DatabaseError):\n182.             call_command("migrate", "migrations", verbosity=0)\n183.         # Run initial migration with an explicit --fake-initial\n184.         with self.assertRaises(DatabaseError):\n185.             # Fails because "migrations_tribble" does not exist but needs to in\n186.             # order to make --fake-initial work.\n187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)\n188.         # Fake an apply\n189.         call_command("migrate", "migrations", fake=True, verbosity=0)\n190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")\n191.         # Unmigrate everything\n192.         call_command("migrate", "migrations", "zero", verbosity=0)\n193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")\n194.         # Make sure it\'s all gone\n195.         for db in self.databases:\n196.             self.assertTableNotExists("migrations_author", using=db)\n197.             self.assertTableNotExists("migrations_tribble", using=db)\n198.             self.assertTableNotExists("migrations_book", using=db)\n199. ', start_line_number=121, end_line_number=199), Context(relative_path='tests/model_regress/tests.py', content='37.     def test_sql_insert_compiler_return_id_attribute(self):\n38.         """\n39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure\n40.         """\n41.         db = router.db_for_write(Party)\n42.         query = InsertQuery(Party)\n43.         query.insert_values([Party._meta.fields[0]], [], raw=False)\n44.         # this line will raise an AttributeError without the accompanying fix\n45.         query.get_compiler(using=db).as_sql()\n46. ', start_line_number=37, end_line_number=46)]
2025-10-06 05:07:14,499 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 05:07:14,499 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   └── FUNDING.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   └── static
|   |   |       └── fontawesome
|   |   └── djangodocs-epub
|   |       └── static
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   └── gis
|       └── mapwidget.test.js
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   └── admin
    |   |       └── admin_views
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   └── registration
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   └── registration
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   └── robots.txt
    |   |   └── registration
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   └── javascript_ignored.js
    |   |   └── templates
    |   |       └── subdir
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   ├── templates
    |   |   └── shortcuts
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── cached
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   ├── loop
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   ├── jinja2
    |   |   └── template_backends
    |   ├── template_strings
    |   |   └── template_backends
    |   ├── templates
    |   |   └── template_backends
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   ├── templates
    |   |   └── template_loader
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   ├── other_templates
    |   |   └── priority
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   ├── fs2
    |   |   └── fs3
    |   ├── relative_templates
    |   |   └── dir1
    |   |       └── dir2
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── first
    |   |   ├── priority
    |   |   ├── second
    |   |   └── template_tests
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   └── views
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   └── debug
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Simplify signature of `DatabaseOperations.execute_sql_flush()`

Issue description: 
Description
	
The current signature is:
def execute_sql_flush(self, using, sql_list):
The using argument can be dropped and inferred by the calling instance: self.connection.alias.
def execute_sql_flush(self, sql_list):
Some internal ises of this method are already doing:
connection.ops.execute_sql_flush(connection.alias, sql_flush)

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/multiple_database/tests.py
Line number range: 19 - 114
Content:
19. class QueryTestCase(TestCase):
20.     databases = {'default', 'other'}
21. 
22.     def test_db_selection(self):
23.         "Querysets will use the default database by default"
24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)
25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)
26. 
27.         self.assertEqual(Book.objects.using('other').db, 'other')
28. 
29.         self.assertEqual(Book.objects.db_manager('other').db, 'other')
30.         self.assertEqual(Book.objects.db_manager('other').all().db, 'other')
31. 
32.     def test_default_creation(self):
33.         "Objects created on the default database don't leak onto other databases"
34.         # Create a book on the default database using create()
35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
36. 
37.         # Create a book on the default database using a save
38.         dive = Book()
39.         dive.title = "Dive into Python"
40.         dive.published = datetime.date(2009, 5, 4)
41.         dive.save()
42. 
43.         # Book exists on the default database, but not on other database
44.         try:
45.             Book.objects.get(title="Pro Django")
46.             Book.objects.using('default').get(title="Pro Django")
47.         except Book.DoesNotExist:
48.             self.fail('"Pro Django" should exist on default database')
49. 
50.         with self.assertRaises(Book.DoesNotExist):
51.             Book.objects.using('other').get(title="Pro Django")
52. 
53.         try:
54.             Book.objects.get(title="Dive into Python")
55.             Book.objects.using('default').get(title="Dive into Python")
56.         except Book.DoesNotExist:
57.             self.fail('"Dive into Python" should exist on default database')
58. 
59.         with self.assertRaises(Book.DoesNotExist):
60.             Book.objects.using('other').get(title="Dive into Python")
61. 
62.     def test_other_creation(self):
63.         "Objects created on another database don't leak onto the default database"
64.         # Create a book on the second database
65.         Book.objects.using('other').create(title="Pro Django",
66.                                            published=datetime.date(2008, 12, 16))
67. 
68.         # Create a book on the default database using a save
69.         dive = Book()
70.         dive.title = "Dive into Python"
71.         dive.published = datetime.date(2009, 5, 4)
72.         dive.save(using='other')
73. 
74.         # Book exists on the default database, but not on other database
75.         try:
76.             Book.objects.using('other').get(title="Pro Django")
77.         except Book.DoesNotExist:
78.             self.fail('"Pro Django" should exist on other database')
79. 
80.         with self.assertRaises(Book.DoesNotExist):
81.             Book.objects.get(title="Pro Django")
82.         with self.assertRaises(Book.DoesNotExist):
83.             Book.objects.using('default').get(title="Pro Django")
84. 
85.         try:
86.             Book.objects.using('other').get(title="Dive into Python")
87.         except Book.DoesNotExist:
88.             self.fail('"Dive into Python" should exist on other database')
89. 
90.         with self.assertRaises(Book.DoesNotExist):
91.             Book.objects.get(title="Dive into Python")
92.         with self.assertRaises(Book.DoesNotExist):
93.             Book.objects.using('default').get(title="Dive into Python")
94. 
95.     def test_refresh(self):
96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))
97.         dive.save(using='other')
98.         dive2 = Book.objects.using('other').get()
99.         dive2.title = "Dive into Python (on default)"
100.         dive2.save(using='default')
101.         dive.refresh_from_db()
102.         self.assertEqual(dive.title, "Dive into Python")
103.         dive.refresh_from_db(using='default')
104.         self.assertEqual(dive.title, "Dive into Python (on default)")
105.         self.assertEqual(dive._state.db, "default")
106. 
107.     def test_refresh_router_instance_hint(self):
108.         router = Mock()
109.         router.db_for_read.return_value = None
110.         book = Book.objects.create(title='Dive Into Python', published=datetime.date(1957, 10, 12))
111.         with self.settings(DATABASE_ROUTERS=[router]):
112.             book.refresh_from_db()
113.         router.db_for_read.assert_called_once_with(Book, instance=book)
114. 


File: tests/multiple_database/tests.py
Line number range: 200 - 258
Content:
200.     def test_m2m_forward_operations(self):
201.         "M2M forward manipulations are all constrained to a single DB"
202.         # Create a book and author on the other database
203.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
204.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
205. 
206.         # Save the author relations
207.         dive.authors.set([mark])
208. 
209.         # Add a second author
210.         john = Person.objects.using('other').create(name="John Smith")
211.         self.assertEqual(
212.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
213.             []
214.         )
215. 
216.         dive.authors.add(john)
217.         self.assertEqual(
218.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
219.             ['Dive into Python']
220.         )
221.         self.assertEqual(
222.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
223.             ['Dive into Python']
224.         )
225. 
226.         # Remove the second author
227.         dive.authors.remove(john)
228.         self.assertEqual(
229.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
230.             ['Dive into Python']
231.         )
232.         self.assertEqual(
233.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
234.             []
235.         )
236. 
237.         # Clear all authors
238.         dive.authors.clear()
239.         self.assertEqual(
240.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
241.             []
242.         )
243.         self.assertEqual(
244.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
245.             []
246.         )
247. 
248.         # Create an author through the m2m interface
249.         dive.authors.create(name='Jane Brown')
250.         self.assertEqual(
251.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
252.             []
253.         )
254.         self.assertEqual(
255.             list(Book.objects.using('other').filter(authors__name='Jane Brown').values_list('title', flat=True)),
256.             ['Dive into Python']
257.         )
258. 


File: tests/multiple_database/tests.py
Line number range: 321 - 368
Content:
321.     def test_m2m_cross_database_protection(self):
322.         "Operations that involve sharing M2M objects across databases raise an error"
323.         # Create a book and author on the default database
324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
325. 
326.         marty = Person.objects.create(name="Marty Alchin")
327. 
328.         # Create a book and author on the other database
329.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
330. 
331.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
332.         # Set a foreign key set with an object from a different database
333.         msg = (
334.             'Cannot assign "<Person: Marty Alchin>": the current database '
335.             'router prevents this relation.'
336.         )
337.         with self.assertRaisesMessage(ValueError, msg):
338.             with transaction.atomic(using='default'):
339.                 marty.edited.set([pro, dive])
340. 
341.         # Add to an m2m with an object from a different database
342.         msg = (
343.             'Cannot add "<Book: Dive into Python>": instance is on '
344.             'database "default", value is on database "other"'
345.         )
346.         with self.assertRaisesMessage(ValueError, msg):
347.             with transaction.atomic(using='default'):
348.                 marty.book_set.add(dive)
349. 
350.         # Set a m2m with an object from a different database
351.         with self.assertRaisesMessage(ValueError, msg):
352.             with transaction.atomic(using='default'):
353.                 marty.book_set.set([pro, dive])
354. 
355.         # Add to a reverse m2m with an object from a different database
356.         msg = (
357.             'Cannot add "<Person: Marty Alchin>": instance is on '
358.             'database "other", value is on database "default"'
359.         )
360.         with self.assertRaisesMessage(ValueError, msg):
361.             with transaction.atomic(using='other'):
362.                 dive.authors.add(marty)
363. 
364.         # Set a reverse m2m with an object from a different database
365.         with self.assertRaisesMessage(ValueError, msg):
366.             with transaction.atomic(using='other'):
367.                 dive.authors.set([mark, marty])
368. 


File: tests/migrations/test_commands.py
Line number range: 121 - 199
Content:
121.     @override_settings(
122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
123.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
124.     )
125.     def test_migrate_fake_initial(self):
126.         """
127.         --fake-initial only works if all tables created in the initial
128.         migration of an app exists. Database routers must be obeyed when doing
129.         that check.
130.         """
131.         # Make sure no tables are created
132.         for db in self.databases:
133.             self.assertTableNotExists("migrations_author", using=db)
134.             self.assertTableNotExists("migrations_tribble", using=db)
135.         # Run the migrations to 0001 only
136.         call_command("migrate", "migrations", "0001", verbosity=0)
137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
138.         # Make sure the right tables exist
139.         self.assertTableExists("migrations_author")
140.         self.assertTableNotExists("migrations_tribble")
141.         # Also check the "other" database
142.         self.assertTableNotExists("migrations_author", using="other")
143.         self.assertTableExists("migrations_tribble", using="other")
144. 
145.         # Fake a roll-back
146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
148.         # Make sure the tables still exist
149.         self.assertTableExists("migrations_author")
150.         self.assertTableExists("migrations_tribble", using="other")
151.         # Try to run initial migration
152.         with self.assertRaises(DatabaseError):
153.             call_command("migrate", "migrations", "0001", verbosity=0)
154.         # Run initial migration with an explicit --fake-initial
155.         out = io.StringIO()
156.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
159.         self.assertIn(
160.             "migrations.0001_initial... faked",
161.             out.getvalue().lower()
162.         )
163.         # Run migrations all the way
164.         call_command("migrate", verbosity=0)
165.         call_command("migrate", verbosity=0, database="other")
166.         # Make sure the right tables exist
167.         self.assertTableExists("migrations_author")
168.         self.assertTableNotExists("migrations_tribble")
169.         self.assertTableExists("migrations_book")
170.         self.assertTableNotExists("migrations_author", using="other")
171.         self.assertTableNotExists("migrations_tribble", using="other")
172.         self.assertTableNotExists("migrations_book", using="other")
173.         # Fake a roll-back
174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
176.         # Make sure the tables still exist
177.         self.assertTableExists("migrations_author")
178.         self.assertTableNotExists("migrations_tribble")
179.         self.assertTableExists("migrations_book")
180.         # Try to run initial migration
181.         with self.assertRaises(DatabaseError):
182.             call_command("migrate", "migrations", verbosity=0)
183.         # Run initial migration with an explicit --fake-initial
184.         with self.assertRaises(DatabaseError):
185.             # Fails because "migrations_tribble" does not exist but needs to in
186.             # order to make --fake-initial work.
187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
188.         # Fake an apply
189.         call_command("migrate", "migrations", fake=True, verbosity=0)
190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
194.         # Make sure it's all gone
195.         for db in self.databases:
196.             self.assertTableNotExists("migrations_author", using=db)
197.             self.assertTableNotExists("migrations_tribble", using=db)
198.             self.assertTableNotExists("migrations_book", using=db)
199. 


File: tests/model_regress/tests.py
Line number range: 37 - 46
Content:
37.     def test_sql_insert_compiler_return_id_attribute(self):
38.         """
39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure
40.         """
41.         db = router.db_for_write(Party)
42.         query = InsertQuery(Party)
43.         query.insert_values([Party._meta.fields[0]], [], raw=False)
44.         # this line will raise an AttributeError without the accompanying fix
45.         query.get_compiler(using=db).as_sql()
46. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-06 05:07:58,549 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user's request is to find tests relevant to refactoring `DatabaseOperations.execute_sql_flush` to remove the `using` parameter.\n2. This change primarily affects low-level database operations and management commands that use them.\n3. The provided context includes tests for multi-database features at the ORM level (`tests/multiple_database/tests.py`) and for the `migrate` command (`tests/migrations/test_commands.py`).\n4. While these tests are related to multi-database functionality, they do not directly test the `DatabaseOperations` class or the `flush` command, which is the main user of `execute_sql_flush`.\n5. To find the most relevant examples of tests that would cover such a refactoring, it is essential to examine the tests specifically for `DatabaseOperations` and the `flush` command.\n6. Therefore, the contents of `tests/backends/base/test_operations.py` and `tests/admin_scripts/tests.py` are needed." refined_query="Please provide the content of `tests/backends/base/test_operations.py` and `tests/admin_scripts/tests.py` to find tests that directly exercise `DatabaseOperations` methods and the `flush` management command, which are highly relevant to the proposed change of simplifying `execute_sql_flush`'s signature."
2025-10-06 05:08:01,989 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_scripts/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'0655faa5-4cdd-450d-966a-6bcb474697ee': 'CpMDAR/MhbYuVQN0ynJ365/2nbIfzATEPO4QVzPsCKgNkrk0eKkshH+r2omirqcF3wi/mwtFmELVuhW3jPEVaSv21Ad69AVTlK05vscCEbL7x13xgrfe3RdJ9v5GiNhthw3u50nw5TJpKxVjE1LIeYTcT2H6ovV/E2NwsOdU9M+6j0GYrAectZ3MCOD6XnBE+/FyMIwCAVrc48DNTYT7it4vOJewJPBrEog0v/dL2CAu1AqmbxNeOK/D9/B70aC6VdsmvT3jAH1JFwOmTi7mbPSE3W01LjxfRsDX9oV1ppC8x3Bh1emmbokOD1jTj8M8OYbA5rsOXkoLeQdC2MDwBxtTDYPM2N6hWxhn3lFfDEqdfJAATFMwRlOTjqVWTGDIznS0eooCh5UsxzCbvMw/GCmGz6SQ7M9iypL99r6AEnqfzThnN1/sthaYVCDbuOJ0buoqm2F3LS0RS4Vsr2zxEr/9/L+2C7NhiIbqvKLZy/wdSIlMGfpKOod4jzvCaV9sTjkeflum/1rQZoj9Zl79qo2MgcnVeQoiAR/MhbZeTEEQB1JPZ9RLLd+QLcagN6yFHFGmHqHQMVPApA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55099, 'candidates_token_count': 48, 'total_token_count': 55268, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55099}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 48}], 'thoughts_token_count': 121, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.04921484490235647, 'model_name': 'gemini-2.5-pro'} id='run--025c2289-987c-4134-a36f-ce77e297e6ff-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/backends/base/test_operations.py'}, 'id': '0655faa5-4cdd-450d-966a-6bcb474697ee', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_scripts/tests.py'}, 'id': 'cf409959-d181-4d0f-b308-cc3863046427', 'type': 'tool_call'}] usage_metadata={'input_tokens': 55099, 'output_tokens': 48, 'total_tokens': 55268, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 121}}
2025-10-06 05:08:06,475 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the contents of `tests/backends/base/test_operations.py` and `tests/admin_scripts/tests.py` as requested. The first file includes test cases for database operations, notably the `SqlFlushTests` class which is highly relevant as it directly tests the `sql_flush` and `execute_sql_flush` methods. The second file contains a comprehensive test suite for various management commands, which will be instrumental in verifying the behavior of the `flush` command under different scenarios.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 66756, 'candidates_token_count': 107, 'total_token_count': 66999, 'prompt_tokens_details': [{'modality': 1, 'token_count': 66875}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 107}], 'thoughts_token_count': 136, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1576837914012303, 'model_name': 'gemini-2.5-pro'} id='run--063bfbb5-1e13-4628-ace1-5ad0c75a6ba9-0' usage_metadata={'input_tokens': 66756, 'output_tokens': 107, 'total_tokens': 66999, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 136}}
2025-10-06 05:08:06,476 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 05:08:06,476 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Simplify signature of `DatabaseOperations.execute_sql_flush()`

Issue description: 
Description
	
The current signature is:
def execute_sql_flush(self, using, sql_list):
The using argument can be dropped and inferred by the calling instance: self.connection.alias.
def execute_sql_flush(self, sql_list):
Some internal ises of this method are already doing:
connection.ops.execute_sql_flush(connection.alias, sql_flush)

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the content of `tests/backends/base/test_operations.py` and `tests/admin_scripts/tests.py` to find tests that directly exercise `DatabaseOperations` methods and the `flush` management command, which are highly relevant to the proposed change of simplifying `execute_sql_flush`'s signature.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/backends/base/test_operations.py
Line number range: 1 - 184
Content:
1. import decimal
2. 
3. from django.core.management.color import no_style
4. from django.db import NotSupportedError, connection, transaction
5. from django.db.backends.base.operations import BaseDatabaseOperations
6. from django.db.models import DurationField
7. from django.test import (
8.     SimpleTestCase, TestCase, TransactionTestCase, override_settings,
9.     skipIfDBFeature,
10. )
11. from django.utils import timezone
12. 
13. from ..models import Author, Book
14. 
15. 
16. class SimpleDatabaseOperationTests(SimpleTestCase):
17.     may_require_msg = 'subclasses of BaseDatabaseOperations may require a %s() method'
18. 
19.     def setUp(self):
20.         self.ops = BaseDatabaseOperations(connection=connection)
21. 
22.     def test_deferrable_sql(self):
23.         self.assertEqual(self.ops.deferrable_sql(), '')
24. 
25.     def test_end_transaction_rollback(self):
26.         self.assertEqual(self.ops.end_transaction_sql(success=False), 'ROLLBACK;')
27. 
28.     def test_no_limit_value(self):
29.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'no_limit_value'):
30.             self.ops.no_limit_value()
31. 
32.     def test_quote_name(self):
33.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'quote_name'):
34.             self.ops.quote_name('a')
35. 
36.     def test_regex_lookup(self):
37.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'regex_lookup'):
38.             self.ops.regex_lookup(lookup_type='regex')
39. 
40.     def test_set_time_zone_sql(self):
41.         self.assertEqual(self.ops.set_time_zone_sql(), '')
42. 
43.     def test_sql_flush(self):
44.         msg = 'subclasses of BaseDatabaseOperations must provide a sql_flush() method'
45.         with self.assertRaisesMessage(NotImplementedError, msg):
46.             self.ops.sql_flush(None, None)
47. 
48.     def test_pk_default_value(self):
49.         self.assertEqual(self.ops.pk_default_value(), 'DEFAULT')
50. 
51.     def test_tablespace_sql(self):
52.         self.assertEqual(self.ops.tablespace_sql(None), '')
53. 
54.     def test_sequence_reset_by_name_sql(self):
55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])
56. 
57.     def test_adapt_unknown_value_decimal(self):
58.         value = decimal.Decimal('3.14')
59.         self.assertEqual(
60.             self.ops.adapt_unknown_value(value),
61.             self.ops.adapt_decimalfield_value(value)
62.         )
63. 
64.     def test_adapt_unknown_value_date(self):
65.         value = timezone.now().date()
66.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_datefield_value(value))
67. 
68.     def test_adapt_unknown_value_time(self):
69.         value = timezone.now().time()
70.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_timefield_value(value))
71. 
72.     def test_adapt_timefield_value_none(self):
73.         self.assertIsNone(self.ops.adapt_timefield_value(None))
74. 
75.     def test_adapt_datetimefield_value(self):
76.         self.assertIsNone(self.ops.adapt_datetimefield_value(None))
77. 
78.     def test_adapt_timefield_value(self):
79.         msg = 'Django does not support timezone-aware times.'
80.         with self.assertRaisesMessage(ValueError, msg):
81.             self.ops.adapt_timefield_value(timezone.make_aware(timezone.now()))
82. 
83.     @override_settings(USE_TZ=False)
84.     def test_adapt_timefield_value_unaware(self):
85.         now = timezone.now()
86.         self.assertEqual(self.ops.adapt_timefield_value(now), str(now))
87. 
88.     def test_date_extract_sql(self):
89.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):
90.             self.ops.date_extract_sql(None, None)
91. 
92.     def test_time_extract_sql(self):
93.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):
94.             self.ops.time_extract_sql(None, None)
95. 
96.     def test_date_interval_sql(self):
97.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_interval_sql'):
98.             self.ops.date_interval_sql(None)
99. 
100.     def test_date_trunc_sql(self):
101.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_trunc_sql'):
102.             self.ops.date_trunc_sql(None, None)
103. 
104.     def test_time_trunc_sql(self):
105.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'time_trunc_sql'):
106.             self.ops.time_trunc_sql(None, None)
107. 
108.     def test_datetime_trunc_sql(self):
109.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_trunc_sql'):
110.             self.ops.datetime_trunc_sql(None, None, None)
111. 
112.     def test_datetime_cast_date_sql(self):
113.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_date_sql'):
114.             self.ops.datetime_cast_date_sql(None, None)
115. 
116.     def test_datetime_cast_time_sql(self):
117.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_time_sql'):
118.             self.ops.datetime_cast_time_sql(None, None)
119. 
120.     def test_datetime_extract_sql(self):
121.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_extract_sql'):
122.             self.ops.datetime_extract_sql(None, None, None)
123. 
124. 
125. class DatabaseOperationTests(TestCase):
126.     def setUp(self):
127.         self.ops = BaseDatabaseOperations(connection=connection)
128. 
129.     @skipIfDBFeature('supports_over_clause')
130.     def test_window_frame_raise_not_supported_error(self):
131.         msg = 'This backend does not support window expressions.'
132.         with self.assertRaisesMessage(NotSupportedError, msg):
133.             self.ops.window_frame_rows_start_end()
134. 
135.     @skipIfDBFeature('can_distinct_on_fields')
136.     def test_distinct_on_fields(self):
137.         msg = 'DISTINCT ON fields is not supported by this database backend'
138.         with self.assertRaisesMessage(NotSupportedError, msg):
139.             self.ops.distinct_sql(['a', 'b'], None)
140. 
141.     @skipIfDBFeature('supports_temporal_subtraction')
142.     def test_subtract_temporals(self):
143.         duration_field = DurationField()
144.         duration_field_internal_type = duration_field.get_internal_type()
145.         msg = (
146.             'This backend does not support %s subtraction.' %
147.             duration_field_internal_type
148.         )
149.         with self.assertRaisesMessage(NotSupportedError, msg):
150.             self.ops.subtract_temporals(duration_field_internal_type, None, None)
151. 
152. 
153. class SqlFlushTests(TransactionTestCase):
154.     available_apps = ['backends']
155. 
156.     def test_sql_flush_no_tables(self):
157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])
158. 
159.     def test_execute_sql_flush_statements(self):
160.         with transaction.atomic():
161.             author = Author.objects.create(name='George Orwell')
162.             Book.objects.create(author=author)
163.             author = Author.objects.create(name='Harper Lee')
164.             Book.objects.create(author=author)
165.             Book.objects.create(author=author)
166.             self.assertIs(Author.objects.exists(), True)
167.             self.assertIs(Book.objects.exists(), True)
168. 
169.         sql_list = connection.ops.sql_flush(
170.             no_style(),
171.             [Author._meta.db_table, Book._meta.db_table],
172.             reset_sequences=True,
173.             allow_cascade=True,
174.         )
175.         connection.ops.execute_sql_flush(connection.alias, sql_list)
176. 
177.         with transaction.atomic():
178.             self.assertIs(Author.objects.exists(), False)
179.             self.assertIs(Book.objects.exists(), False)
180.             if connection.features.supports_sequence_reset:
181.                 author = Author.objects.create(name='F. Scott Fitzgerald')
182.                 self.assertEqual(author.pk, 1)
183.                 book = Book.objects.create(author=author)
184.                 self.assertEqual(book.pk, 1)

File: tests/admin_scripts/tests.py
Line number range: 1 - 500
Content:
1. """
2. A series of tests to establish that the command-line management tools work as
3. advertised - especially with regards to the handling of the
4. DJANGO_SETTINGS_MODULE and default settings.py files.
5. """
6. import os
7. import re
8. import shutil
9. import socket
10. import subprocess
11. import sys
12. import tempfile
13. import unittest
14. from io import StringIO
15. from unittest import mock
16. 
17. from django import conf, get_version
18. from django.conf import settings
19. from django.core.management import (
20.     BaseCommand, CommandError, call_command, color,
21. )
22. from django.core.management.commands.loaddata import Command as LoaddataCommand
23. from django.core.management.commands.runserver import (
24.     Command as RunserverCommand,
25. )
26. from django.core.management.commands.testserver import (
27.     Command as TestserverCommand,
28. )
29. from django.db import ConnectionHandler, connection
30. from django.db.migrations.recorder import MigrationRecorder
31. from django.test import (
32.     LiveServerTestCase, SimpleTestCase, TestCase, override_settings,
33. )
34. 
35. custom_templates_dir = os.path.join(os.path.dirname(__file__), 'custom_templates')
36. 
37. SYSTEM_CHECK_MSG = 'System check identified no issues'
38. 
39. 
40. class AdminScriptTestCase(SimpleTestCase):
41.     def setUp(self):
42.         tmpdir = tempfile.TemporaryDirectory()
43.         self.addCleanup(tmpdir.cleanup)
44.         # os.path.realpath() is required for temporary directories on macOS,
45.         # where `/var` is a symlink to `/private/var`.
46.         self.test_dir = os.path.realpath(os.path.join(tmpdir.name, 'test_project'))
47.         os.mkdir(self.test_dir)
48. 
49.     def write_settings(self, filename, apps=None, is_dir=False, sdict=None, extra=None):
50.         if is_dir:
51.             settings_dir = os.path.join(self.test_dir, filename)
52.             os.mkdir(settings_dir)
53.             settings_file_path = os.path.join(settings_dir, '__init__.py')
54.         else:
55.             settings_file_path = os.path.join(self.test_dir, filename)
56. 
57.         with open(settings_file_path, 'w') as settings_file:
58.             settings_file.write('# Settings file automatically generated by admin_scripts test case\n')
59.             if extra:
60.                 settings_file.write("%s\n" % extra)
61.             exports = [
62.                 'DATABASES',
63.                 'ROOT_URLCONF',
64.                 'SECRET_KEY',
65.             ]
66.             for s in exports:
67.                 if hasattr(settings, s):
68.                     o = getattr(settings, s)
69.                     if not isinstance(o, (dict, tuple, list)):
70.                         o = "'%s'" % o
71.                     settings_file.write("%s = %s\n" % (s, o))
72. 
73.             if apps is None:
74.                 apps = ['django.contrib.auth', 'django.contrib.contenttypes', 'admin_scripts']
75. 
76.             settings_file.write("INSTALLED_APPS = %s\n" % apps)
77. 
78.             if sdict:
79.                 for k, v in sdict.items():
80.                     settings_file.write("%s = %s\n" % (k, v))
81. 
82.     def _ext_backend_paths(self):
83.         """
84.         Returns the paths for any external backend packages.
85.         """
86.         paths = []
87.         for backend in settings.DATABASES.values():
88.             package = backend['ENGINE'].split('.')[0]
89.             if package != 'django':
90.                 backend_pkg = __import__(package)
91.                 backend_dir = os.path.dirname(backend_pkg.__file__)
92.                 paths.append(os.path.dirname(backend_dir))
93.         return paths
94. 
95.     def run_test(self, args, settings_file=None, apps=None):
96.         base_dir = os.path.dirname(self.test_dir)
97.         # The base dir for Django's tests is one level up.
98.         tests_dir = os.path.dirname(os.path.dirname(__file__))
99.         # The base dir for Django is one level above the test dir. We don't use
100.         # `import django` to figure that out, so we don't pick up a Django
101.         # from site-packages or similar.
102.         django_dir = os.path.dirname(tests_dir)
103.         ext_backend_base_dirs = self._ext_backend_paths()
104. 
105.         # Define a temporary environment for the subprocess
106.         test_environ = os.environ.copy()
107. 
108.         # Set the test environment
109.         if settings_file:
110.             test_environ['DJANGO_SETTINGS_MODULE'] = settings_file
111.         elif 'DJANGO_SETTINGS_MODULE' in test_environ:
112.             del test_environ['DJANGO_SETTINGS_MODULE']
113.         python_path = [base_dir, django_dir, tests_dir]
114.         python_path.extend(ext_backend_base_dirs)
115.         test_environ['PYTHONPATH'] = os.pathsep.join(python_path)
116.         test_environ['PYTHONWARNINGS'] = ''
117. 
118.         p = subprocess.run(
119.             [sys.executable, *args],
120.             stdout=subprocess.PIPE, stderr=subprocess.PIPE,
121.             cwd=self.test_dir,
122.             env=test_environ, universal_newlines=True,
123.         )
124.         return p.stdout, p.stderr
125. 
126.     def run_django_admin(self, args, settings_file=None):
127.         return self.run_test(['-m', 'django', *args], settings_file)
128. 
129.     def run_manage(self, args, settings_file=None, manage_py=None):
130.         template_manage_py = (
131.             os.path.join(os.path.dirname(__file__), manage_py)
132.             if manage_py else
133.             os.path.join(os.path.dirname(conf.__file__), 'project_template', 'manage.py-tpl')
134.         )
135.         test_manage_py = os.path.join(self.test_dir, 'manage.py')
136.         shutil.copyfile(template_manage_py, test_manage_py)
137. 
138.         with open(test_manage_py) as fp:
139.             manage_py_contents = fp.read()
140.         manage_py_contents = manage_py_contents.replace(
141.             "{{ project_name }}", "test_project")
142.         with open(test_manage_py, 'w') as fp:
143.             fp.write(manage_py_contents)
144. 
145.         return self.run_test(['./manage.py', *args], settings_file)
146. 
147.     def assertNoOutput(self, stream):
148.         "Utility assertion: assert that the given stream is empty"
149.         self.assertEqual(len(stream), 0, "Stream should be empty: actually contains '%s'" % stream)
150. 
151.     def assertOutput(self, stream, msg, regex=False):
152.         "Utility assertion: assert that the given message exists in the output"
153.         if regex:
154.             self.assertIsNotNone(
155.                 re.search(msg, stream),
156.                 "'%s' does not match actual output text '%s'" % (msg, stream)
157.             )
158.         else:
159.             self.assertIn(msg, stream, "'%s' does not match actual output text '%s'" % (msg, stream))
160. 
161.     def assertNotInOutput(self, stream, msg):
162.         "Utility assertion: assert that the given message doesn't exist in the output"
163.         self.assertNotIn(msg, stream, "'%s' matches actual output text '%s'" % (msg, stream))
164. 
165. ##########################################################################
166. # DJANGO ADMIN TESTS
167. # This first series of test classes checks the environment processing
168. # of the django-admin.py script
169. ##########################################################################
170. 
171. 
172. class DjangoAdminNoSettings(AdminScriptTestCase):
173.     "A series of tests for django-admin.py when there is no settings.py file."
174. 
175.     def test_builtin_command(self):
176.         "no settings: django-admin builtin commands fail with an error when no settings provided"
177.         args = ['check', 'admin_scripts']
178.         out, err = self.run_django_admin(args)
179.         self.assertNoOutput(out)
180.         self.assertOutput(err, 'settings are not configured')
181. 
182.     def test_builtin_with_bad_settings(self):
183.         "no settings: django-admin builtin commands fail if settings file (from argument) doesn't exist"
184.         args = ['check', '--settings=bad_settings', 'admin_scripts']
185.         out, err = self.run_django_admin(args)
186.         self.assertNoOutput(out)
187.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
188. 
189.     def test_builtin_with_bad_environment(self):
190.         "no settings: django-admin builtin commands fail if settings file (from environment) doesn't exist"
191.         args = ['check', 'admin_scripts']
192.         out, err = self.run_django_admin(args, 'bad_settings')
193.         self.assertNoOutput(out)
194.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
195. 
196.     def test_commands_with_invalid_settings(self):
197.         """"
198.         Commands that don't require settings succeed if the settings file
199.         doesn't exist.
200.         """
201.         args = ['startproject']
202.         out, err = self.run_django_admin(args, settings_file='bad_settings')
203.         self.assertNoOutput(out)
204.         self.assertOutput(err, "You must provide a project name", regex=True)
205. 
206. 
207. class DjangoAdminDefaultSettings(AdminScriptTestCase):
208.     """A series of tests for django-admin.py when using a settings.py file that
209.     contains the test application.
210.     """
211.     def setUp(self):
212.         super().setUp()
213.         self.write_settings('settings.py')
214. 
215.     def test_builtin_command(self):
216.         "default: django-admin builtin commands fail with an error when no settings provided"
217.         args = ['check', 'admin_scripts']
218.         out, err = self.run_django_admin(args)
219.         self.assertNoOutput(out)
220.         self.assertOutput(err, 'settings are not configured')
221. 
222.     def test_builtin_with_settings(self):
223.         "default: django-admin builtin commands succeed if settings are provided as argument"
224.         args = ['check', '--settings=test_project.settings', 'admin_scripts']
225.         out, err = self.run_django_admin(args)
226.         self.assertNoOutput(err)
227.         self.assertOutput(out, SYSTEM_CHECK_MSG)
228. 
229.     def test_builtin_with_environment(self):
230.         "default: django-admin builtin commands succeed if settings are provided in the environment"
231.         args = ['check', 'admin_scripts']
232.         out, err = self.run_django_admin(args, 'test_project.settings')
233.         self.assertNoOutput(err)
234.         self.assertOutput(out, SYSTEM_CHECK_MSG)
235. 
236.     def test_builtin_with_bad_settings(self):
237.         "default: django-admin builtin commands fail if settings file (from argument) doesn't exist"
238.         args = ['check', '--settings=bad_settings', 'admin_scripts']
239.         out, err = self.run_django_admin(args)
240.         self.assertNoOutput(out)
241.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
242. 
243.     def test_builtin_with_bad_environment(self):
244.         "default: django-admin builtin commands fail if settings file (from environment) doesn't exist"
245.         args = ['check', 'admin_scripts']
246.         out, err = self.run_django_admin(args, 'bad_settings')
247.         self.assertNoOutput(out)
248.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
249. 
250.     def test_custom_command(self):
251.         "default: django-admin can't execute user commands if it isn't provided settings"
252.         args = ['noargs_command']
253.         out, err = self.run_django_admin(args)
254.         self.assertNoOutput(out)
255.         self.assertOutput(err, "No Django settings specified")
256.         self.assertOutput(err, "Unknown command: 'noargs_command'")
257. 
258.     def test_custom_command_with_settings(self):
259.         "default: django-admin can execute user commands if settings are provided as argument"
260.         args = ['noargs_command', '--settings=test_project.settings']
261.         out, err = self.run_django_admin(args)
262.         self.assertNoOutput(err)
263.         self.assertOutput(out, "EXECUTE: noargs_command")
264. 
265.     def test_custom_command_with_environment(self):
266.         "default: django-admin can execute user commands if settings are provided in environment"
267.         args = ['noargs_command']
268.         out, err = self.run_django_admin(args, 'test_project.settings')
269.         self.assertNoOutput(err)
270.         self.assertOutput(out, "EXECUTE: noargs_command")
271. 
272. 
273. class DjangoAdminFullPathDefaultSettings(AdminScriptTestCase):
274.     """A series of tests for django-admin.py when using a settings.py file that
275.     contains the test application specified using a full path.
276.     """
277.     def setUp(self):
278.         super().setUp()
279.         self.write_settings('settings.py', ['django.contrib.auth', 'django.contrib.contenttypes',
280.                                             'admin_scripts', 'admin_scripts.complex_app'])
281. 
282.     def test_builtin_command(self):
283.         "fulldefault: django-admin builtin commands fail with an error when no settings provided"
284.         args = ['check', 'admin_scripts']
285.         out, err = self.run_django_admin(args)
286.         self.assertNoOutput(out)
287.         self.assertOutput(err, 'settings are not configured')
288. 
289.     def test_builtin_with_settings(self):
290.         "fulldefault: django-admin builtin commands succeed if a settings file is provided"
291.         args = ['check', '--settings=test_project.settings', 'admin_scripts']
292.         out, err = self.run_django_admin(args)
293.         self.assertNoOutput(err)
294.         self.assertOutput(out, SYSTEM_CHECK_MSG)
295. 
296.     def test_builtin_with_environment(self):
297.         "fulldefault: django-admin builtin commands succeed if the environment contains settings"
298.         args = ['check', 'admin_scripts']
299.         out, err = self.run_django_admin(args, 'test_project.settings')
300.         self.assertNoOutput(err)
301.         self.assertOutput(out, SYSTEM_CHECK_MSG)
302. 
303.     def test_builtin_with_bad_settings(self):
304.         "fulldefault: django-admin builtin commands fail if settings file (from argument) doesn't exist"
305.         args = ['check', '--settings=bad_settings', 'admin_scripts']
306.         out, err = self.run_django_admin(args)
307.         self.assertNoOutput(out)
308.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
309. 
310.     def test_builtin_with_bad_environment(self):
311.         "fulldefault: django-admin builtin commands fail if settings file (from environment) doesn't exist"
312.         args = ['check', 'admin_scripts']
313.         out, err = self.run_django_admin(args, 'bad_settings')
314.         self.assertNoOutput(out)
315.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
316. 
317.     def test_custom_command(self):
318.         "fulldefault: django-admin can't execute user commands unless settings are provided"
319.         args = ['noargs_command']
320.         out, err = self.run_django_admin(args)
321.         self.assertNoOutput(out)
322.         self.assertOutput(err, "No Django settings specified")
323.         self.assertOutput(err, "Unknown command: 'noargs_command'")
324. 
325.     def test_custom_command_with_settings(self):
326.         "fulldefault: django-admin can execute user commands if settings are provided as argument"
327.         args = ['noargs_command', '--settings=test_project.settings']
328.         out, err = self.run_django_admin(args)
329.         self.assertNoOutput(err)
330.         self.assertOutput(out, "EXECUTE: noargs_command")
331. 
332.     def test_custom_command_with_environment(self):
333.         "fulldefault: django-admin can execute user commands if settings are provided in environment"
334.         args = ['noargs_command']
335.         out, err = self.run_django_admin(args, 'test_project.settings')
336.         self.assertNoOutput(err)
337.         self.assertOutput(out, "EXECUTE: noargs_command")
338. 
339. 
340. class DjangoAdminMinimalSettings(AdminScriptTestCase):
341.     """A series of tests for django-admin.py when using a settings.py file that
342.     doesn't contain the test application.
343.     """
344.     def setUp(self):
345.         super().setUp()
346.         self.write_settings('settings.py', apps=['django.contrib.auth', 'django.contrib.contenttypes'])
347. 
348.     def test_builtin_command(self):
349.         "minimal: django-admin builtin commands fail with an error when no settings provided"
350.         args = ['check', 'admin_scripts']
351.         out, err = self.run_django_admin(args)
352.         self.assertNoOutput(out)
353.         self.assertOutput(err, 'settings are not configured')
354. 
355.     def test_builtin_with_settings(self):
356.         "minimal: django-admin builtin commands fail if settings are provided as argument"
357.         args = ['check', '--settings=test_project.settings', 'admin_scripts']
358.         out, err = self.run_django_admin(args)
359.         self.assertNoOutput(out)
360.         self.assertOutput(err, "No installed app with label 'admin_scripts'.")
361. 
362.     def test_builtin_with_environment(self):
363.         "minimal: django-admin builtin commands fail if settings are provided in the environment"
364.         args = ['check', 'admin_scripts']
365.         out, err = self.run_django_admin(args, 'test_project.settings')
366.         self.assertNoOutput(out)
367.         self.assertOutput(err, "No installed app with label 'admin_scripts'.")
368. 
369.     def test_builtin_with_bad_settings(self):
370.         "minimal: django-admin builtin commands fail if settings file (from argument) doesn't exist"
371.         args = ['check', '--settings=bad_settings', 'admin_scripts']
372.         out, err = self.run_django_admin(args)
373.         self.assertNoOutput(out)
374.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
375. 
376.     def test_builtin_with_bad_environment(self):
377.         "minimal: django-admin builtin commands fail if settings file (from environment) doesn't exist"
378.         args = ['check', 'admin_scripts']
379.         out, err = self.run_django_admin(args, 'bad_settings')
380.         self.assertNoOutput(out)
381.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
382. 
383.     def test_custom_command(self):
384.         "minimal: django-admin can't execute user commands unless settings are provided"
385.         args = ['noargs_command']
386.         out, err = self.run_django_admin(args)
387.         self.assertNoOutput(out)
388.         self.assertOutput(err, "No Django settings specified")
389.         self.assertOutput(err, "Unknown command: 'noargs_command'")
390. 
391.     def test_custom_command_with_settings(self):
392.         "minimal: django-admin can't execute user commands, even if settings are provided as argument"
393.         args = ['noargs_command', '--settings=test_project.settings']
394.         out, err = self.run_django_admin(args)
395.         self.assertNoOutput(out)
396.         self.assertOutput(err, "Unknown command: 'noargs_command'")
397. 
398.     def test_custom_command_with_environment(self):
399.         "minimal: django-admin can't execute user commands, even if settings are provided in environment"
400.         args = ['noargs_command']
401.         out, err = self.run_django_admin(args, 'test_project.settings')
402.         self.assertNoOutput(out)
403.         self.assertOutput(err, "Unknown command: 'noargs_command'")
404. 
405. 
406. class DjangoAdminAlternateSettings(AdminScriptTestCase):
407.     """A series of tests for django-admin.py when using a settings file
408.     with a name other than 'settings.py'.
409.     """
410.     def setUp(self):
411.         super().setUp()
412.         self.write_settings('alternate_settings.py')
413. 
414.     def test_builtin_command(self):
415.         "alternate: django-admin builtin commands fail with an error when no settings provided"
416.         args = ['check', 'admin_scripts']
417.         out, err = self.run_django_admin(args)
418.         self.assertNoOutput(out)
419.         self.assertOutput(err, 'settings are not configured')
420. 
421.     def test_builtin_with_settings(self):
422.         "alternate: django-admin builtin commands succeed if settings are provided as argument"
423.         args = ['check', '--settings=test_project.alternate_settings', 'admin_scripts']
424.         out, err = self.run_django_admin(args)
425.         self.assertNoOutput(err)
426.         self.assertOutput(out, SYSTEM_CHECK_MSG)
427. 
428.     def test_builtin_with_environment(self):
429.         "alternate: django-admin builtin commands succeed if settings are provided in the environment"
430.         args = ['check', 'admin_scripts']
431.         out, err = self.run_django_admin(args, 'test_project.alternate_settings')
432.         self.assertNoOutput(err)
433.         self.assertOutput(out, SYSTEM_CHECK_MSG)
434. 
435.     def test_builtin_with_bad_settings(self):
436.         "alternate: django-admin builtin commands fail if settings file (from argument) doesn't exist"
437.         args = ['check', '--settings=bad_settings', 'admin_scripts']
438.         out, err = self.run_django_admin(args)
439.         self.assertNoOutput(out)
440.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
441. 
442.     def test_builtin_with_bad_environment(self):
443.         "alternate: django-admin builtin commands fail if settings file (from environment) doesn't exist"
444.         args = ['check', 'admin_scripts']
445.         out, err = self.run_django_admin(args, 'bad_settings')
446.         self.assertNoOutput(out)
447.         self.assertOutput(err, "No module named '?bad_settings'?", regex=True)
448. 
449.     def test_custom_command(self):
450.         "alternate: django-admin can't execute user commands unless settings are provided"
451.         args = ['noargs_command']
452.         out, err = self.run_django_admin(args)
453.         self.assertNoOutput(out)
454.         self.assertOutput(err, "No Django settings specified")
455.         self.assertOutput(err, "Unknown command: 'noargs_command'")
456. 
457.     def test_custom_command_with_settings(self):
458.         "alternate: django-admin can execute user commands if settings are provided as argument"
459.         args = ['noargs_command', '--settings=test_project.alternate_settings']
460.         out, err = self.run_django_admin(args)
461.         self.assertNoOutput(err)
462.         self.assertOutput(out, "EXECUTE: noargs_command")
463. 
464.     def test_custom_command_with_environment(self):
465.         "alternate: django-admin can execute user commands if settings are provided in environment"
466.         args = ['noargs_command']
467.         out, err = self.run_django_admin(args, 'test_project.alternate_settings')
468.         self.assertNoOutput(err)
469.         self.assertOutput(out, "EXECUTE: noargs_command")
470. 
471. 
472. class DjangoAdminMultipleSettings(AdminScriptTestCase):
473.     """A series of tests for django-admin.py when multiple settings files
474.     (including the default 'settings.py') are available. The default settings
475.     file is insufficient for performing the operations described, so the
476.     alternate settings must be used by the running script.
477.     """
478.     def setUp(self):
479.         super().setUp()
480.         self.write_settings('settings.py', apps=['django.contrib.auth', 'django.contrib.contenttypes'])
481.         self.write_settings('alternate_settings.py')
482. 
483.     def test_builtin_command(self):
484.         "alternate: django-admin builtin commands fail with an error when no settings provided"
485.         args = ['check', 'admin_scripts']
486.         out, err = self.run_django_admin(args)
487.         self.assertNoOutput(out)
488.         self.assertOutput(err, 'settings are not configured')
489. 
490.     def test_builtin_with_settings(self):
491.         "alternate: django-admin builtin commands succeed if settings are provided as argument"
492.         args = ['check', '--settings=test_project.alternate_settings', 'admin_scripts']
493.         out, err = self.run_django_admin(args)
494.         self.assertNoOutput(err)
495.         self.assertOutput(out, SYSTEM_CHECK_MSG)
496. 
497.     def test_builtin_with_environment(self):
498.         "alternate: django-admin builtin commands succeed if settings are provided in the environment"
499.         args = ['check', 'admin_scripts']
500.         out, err = self.run_django_admin(args, 'test_project.alternate_settings')


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 05:09:54,432 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='This test is highly relevant because it directly calls `connection.ops.execute_sql_flush()`, the method being refactored. It passes `connection.alias` as the `using` argument, which is the parameter that the issue proposes to remove. This test will be essential for verifying the change.', relative_path='tests/backends/base/test_operations.py', start_line=159, end_line=184), ContextOutput(reasoning="This test is part of the `SqlFlushTests` suite and tests the `sql_flush` method, which generates the SQL statements for `execute_sql_flush`. It's a simple case that ensures the flush command handles scenarios with no tables correctly, providing good coverage for the overall flush functionality.", relative_path='tests/backends/base/test_operations.py', start_line=156, end_line=157), ContextOutput(reasoning='This test checks that the `sql_flush` method on the base `BaseDatabaseOperations` class raises a `NotImplementedError`. This is relevant because it establishes the contract that requires each database backend to provide its own implementation for generating flush SQL, which is then executed by `execute_sql_flush`.', relative_path='tests/backends/base/test_operations.py', start_line=43, end_line=46), ContextOutput(reasoning='This test covers `sequence_reset_by_name_sql`, which, like `sql_flush`, generates a list of SQL statements. Since resetting sequences is an optional part of the `sql_flush` operation, this test is relevant for understanding how SQL generation for database maintenance tasks is handled and tested.', relative_path='tests/backends/base/test_operations.py', start_line=54, end_line=55), ContextOutput(reasoning='This test from `tests/admin_scripts/tests.py` shows how a custom management command is executed through the `django-admin` script with specific settings. Since the `flush` command, which relies on `execute_sql_flush`, is a management command, this test provides a relevant example of how such commands are tested at the integration level.', relative_path='tests/admin_scripts/tests.py', start_line=258, end_line=263)]
2025-10-06 05:09:54,432 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='tests/multiple_database/tests.py', content='19. class QueryTestCase(TestCase):\n20.     databases = {\'default\', \'other\'}\n21. \n22.     def test_db_selection(self):\n23.         "Querysets will use the default database by default"\n24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)\n25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)\n26. \n27.         self.assertEqual(Book.objects.using(\'other\').db, \'other\')\n28. \n29.         self.assertEqual(Book.objects.db_manager(\'other\').db, \'other\')\n30.         self.assertEqual(Book.objects.db_manager(\'other\').all().db, \'other\')\n31. \n32.     def test_default_creation(self):\n33.         "Objects created on the default database don\'t leak onto other databases"\n34.         # Create a book on the default database using create()\n35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n36. \n37.         # Create a book on the default database using a save\n38.         dive = Book()\n39.         dive.title = "Dive into Python"\n40.         dive.published = datetime.date(2009, 5, 4)\n41.         dive.save()\n42. \n43.         # Book exists on the default database, but not on other database\n44.         try:\n45.             Book.objects.get(title="Pro Django")\n46.             Book.objects.using(\'default\').get(title="Pro Django")\n47.         except Book.DoesNotExist:\n48.             self.fail(\'"Pro Django" should exist on default database\')\n49. \n50.         with self.assertRaises(Book.DoesNotExist):\n51.             Book.objects.using(\'other\').get(title="Pro Django")\n52. \n53.         try:\n54.             Book.objects.get(title="Dive into Python")\n55.             Book.objects.using(\'default\').get(title="Dive into Python")\n56.         except Book.DoesNotExist:\n57.             self.fail(\'"Dive into Python" should exist on default database\')\n58. \n59.         with self.assertRaises(Book.DoesNotExist):\n60.             Book.objects.using(\'other\').get(title="Dive into Python")\n61. \n62.     def test_other_creation(self):\n63.         "Objects created on another database don\'t leak onto the default database"\n64.         # Create a book on the second database\n65.         Book.objects.using(\'other\').create(title="Pro Django",\n66.                                            published=datetime.date(2008, 12, 16))\n67. \n68.         # Create a book on the default database using a save\n69.         dive = Book()\n70.         dive.title = "Dive into Python"\n71.         dive.published = datetime.date(2009, 5, 4)\n72.         dive.save(using=\'other\')\n73. \n74.         # Book exists on the default database, but not on other database\n75.         try:\n76.             Book.objects.using(\'other\').get(title="Pro Django")\n77.         except Book.DoesNotExist:\n78.             self.fail(\'"Pro Django" should exist on other database\')\n79. \n80.         with self.assertRaises(Book.DoesNotExist):\n81.             Book.objects.get(title="Pro Django")\n82.         with self.assertRaises(Book.DoesNotExist):\n83.             Book.objects.using(\'default\').get(title="Pro Django")\n84. \n85.         try:\n86.             Book.objects.using(\'other\').get(title="Dive into Python")\n87.         except Book.DoesNotExist:\n88.             self.fail(\'"Dive into Python" should exist on other database\')\n89. \n90.         with self.assertRaises(Book.DoesNotExist):\n91.             Book.objects.get(title="Dive into Python")\n92.         with self.assertRaises(Book.DoesNotExist):\n93.             Book.objects.using(\'default\').get(title="Dive into Python")\n94. \n95.     def test_refresh(self):\n96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))\n97.         dive.save(using=\'other\')\n98.         dive2 = Book.objects.using(\'other\').get()\n99.         dive2.title = "Dive into Python (on default)"\n100.         dive2.save(using=\'default\')\n101.         dive.refresh_from_db()\n102.         self.assertEqual(dive.title, "Dive into Python")\n103.         dive.refresh_from_db(using=\'default\')\n104.         self.assertEqual(dive.title, "Dive into Python (on default)")\n105.         self.assertEqual(dive._state.db, "default")\n106. \n107.     def test_refresh_router_instance_hint(self):\n108.         router = Mock()\n109.         router.db_for_read.return_value = None\n110.         book = Book.objects.create(title=\'Dive Into Python\', published=datetime.date(1957, 10, 12))\n111.         with self.settings(DATABASE_ROUTERS=[router]):\n112.             book.refresh_from_db()\n113.         router.db_for_read.assert_called_once_with(Book, instance=book)\n114. ', start_line_number=19, end_line_number=114), Context(relative_path='tests/multiple_database/tests.py', content='200.     def test_m2m_forward_operations(self):\n201.         "M2M forward manipulations are all constrained to a single DB"\n202.         # Create a book and author on the other database\n203.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n204.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n205. \n206.         # Save the author relations\n207.         dive.authors.set([mark])\n208. \n209.         # Add a second author\n210.         john = Person.objects.using(\'other\').create(name="John Smith")\n211.         self.assertEqual(\n212.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n213.             []\n214.         )\n215. \n216.         dive.authors.add(john)\n217.         self.assertEqual(\n218.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n219.             [\'Dive into Python\']\n220.         )\n221.         self.assertEqual(\n222.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n223.             [\'Dive into Python\']\n224.         )\n225. \n226.         # Remove the second author\n227.         dive.authors.remove(john)\n228.         self.assertEqual(\n229.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n230.             [\'Dive into Python\']\n231.         )\n232.         self.assertEqual(\n233.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n234.             []\n235.         )\n236. \n237.         # Clear all authors\n238.         dive.authors.clear()\n239.         self.assertEqual(\n240.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n241.             []\n242.         )\n243.         self.assertEqual(\n244.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n245.             []\n246.         )\n247. \n248.         # Create an author through the m2m interface\n249.         dive.authors.create(name=\'Jane Brown\')\n250.         self.assertEqual(\n251.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n252.             []\n253.         )\n254.         self.assertEqual(\n255.             list(Book.objects.using(\'other\').filter(authors__name=\'Jane Brown\').values_list(\'title\', flat=True)),\n256.             [\'Dive into Python\']\n257.         )\n258. ', start_line_number=200, end_line_number=258), Context(relative_path='tests/multiple_database/tests.py', content='321.     def test_m2m_cross_database_protection(self):\n322.         "Operations that involve sharing M2M objects across databases raise an error"\n323.         # Create a book and author on the default database\n324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n325. \n326.         marty = Person.objects.create(name="Marty Alchin")\n327. \n328.         # Create a book and author on the other database\n329.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n330. \n331.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n332.         # Set a foreign key set with an object from a different database\n333.         msg = (\n334.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n335.             \'router prevents this relation.\'\n336.         )\n337.         with self.assertRaisesMessage(ValueError, msg):\n338.             with transaction.atomic(using=\'default\'):\n339.                 marty.edited.set([pro, dive])\n340. \n341.         # Add to an m2m with an object from a different database\n342.         msg = (\n343.             \'Cannot add "<Book: Dive into Python>": instance is on \'\n344.             \'database "default", value is on database "other"\'\n345.         )\n346.         with self.assertRaisesMessage(ValueError, msg):\n347.             with transaction.atomic(using=\'default\'):\n348.                 marty.book_set.add(dive)\n349. \n350.         # Set a m2m with an object from a different database\n351.         with self.assertRaisesMessage(ValueError, msg):\n352.             with transaction.atomic(using=\'default\'):\n353.                 marty.book_set.set([pro, dive])\n354. \n355.         # Add to a reverse m2m with an object from a different database\n356.         msg = (\n357.             \'Cannot add "<Person: Marty Alchin>": instance is on \'\n358.             \'database "other", value is on database "default"\'\n359.         )\n360.         with self.assertRaisesMessage(ValueError, msg):\n361.             with transaction.atomic(using=\'other\'):\n362.                 dive.authors.add(marty)\n363. \n364.         # Set a reverse m2m with an object from a different database\n365.         with self.assertRaisesMessage(ValueError, msg):\n366.             with transaction.atomic(using=\'other\'):\n367.                 dive.authors.set([mark, marty])\n368. ', start_line_number=321, end_line_number=368), Context(relative_path='tests/migrations/test_commands.py', content='121.     @override_settings(\n122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},\n123.         DATABASE_ROUTERS=[\'migrations.routers.TestRouter\'],\n124.     )\n125.     def test_migrate_fake_initial(self):\n126.         """\n127.         --fake-initial only works if all tables created in the initial\n128.         migration of an app exists. Database routers must be obeyed when doing\n129.         that check.\n130.         """\n131.         # Make sure no tables are created\n132.         for db in self.databases:\n133.             self.assertTableNotExists("migrations_author", using=db)\n134.             self.assertTableNotExists("migrations_tribble", using=db)\n135.         # Run the migrations to 0001 only\n136.         call_command("migrate", "migrations", "0001", verbosity=0)\n137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")\n138.         # Make sure the right tables exist\n139.         self.assertTableExists("migrations_author")\n140.         self.assertTableNotExists("migrations_tribble")\n141.         # Also check the "other" database\n142.         self.assertTableNotExists("migrations_author", using="other")\n143.         self.assertTableExists("migrations_tribble", using="other")\n144. \n145.         # Fake a roll-back\n146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n148.         # Make sure the tables still exist\n149.         self.assertTableExists("migrations_author")\n150.         self.assertTableExists("migrations_tribble", using="other")\n151.         # Try to run initial migration\n152.         with self.assertRaises(DatabaseError):\n153.             call_command("migrate", "migrations", "0001", verbosity=0)\n154.         # Run initial migration with an explicit --fake-initial\n155.         out = io.StringIO()\n156.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)\n158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")\n159.         self.assertIn(\n160.             "migrations.0001_initial... faked",\n161.             out.getvalue().lower()\n162.         )\n163.         # Run migrations all the way\n164.         call_command("migrate", verbosity=0)\n165.         call_command("migrate", verbosity=0, database="other")\n166.         # Make sure the right tables exist\n167.         self.assertTableExists("migrations_author")\n168.         self.assertTableNotExists("migrations_tribble")\n169.         self.assertTableExists("migrations_book")\n170.         self.assertTableNotExists("migrations_author", using="other")\n171.         self.assertTableNotExists("migrations_tribble", using="other")\n172.         self.assertTableNotExists("migrations_book", using="other")\n173.         # Fake a roll-back\n174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n176.         # Make sure the tables still exist\n177.         self.assertTableExists("migrations_author")\n178.         self.assertTableNotExists("migrations_tribble")\n179.         self.assertTableExists("migrations_book")\n180.         # Try to run initial migration\n181.         with self.assertRaises(DatabaseError):\n182.             call_command("migrate", "migrations", verbosity=0)\n183.         # Run initial migration with an explicit --fake-initial\n184.         with self.assertRaises(DatabaseError):\n185.             # Fails because "migrations_tribble" does not exist but needs to in\n186.             # order to make --fake-initial work.\n187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)\n188.         # Fake an apply\n189.         call_command("migrate", "migrations", fake=True, verbosity=0)\n190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")\n191.         # Unmigrate everything\n192.         call_command("migrate", "migrations", "zero", verbosity=0)\n193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")\n194.         # Make sure it\'s all gone\n195.         for db in self.databases:\n196.             self.assertTableNotExists("migrations_author", using=db)\n197.             self.assertTableNotExists("migrations_tribble", using=db)\n198.             self.assertTableNotExists("migrations_book", using=db)\n199. ', start_line_number=121, end_line_number=199), Context(relative_path='tests/model_regress/tests.py', content='37.     def test_sql_insert_compiler_return_id_attribute(self):\n38.         """\n39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure\n40.         """\n41.         db = router.db_for_write(Party)\n42.         query = InsertQuery(Party)\n43.         query.insert_values([Party._meta.fields[0]], [], raw=False)\n44.         # this line will raise an AttributeError without the accompanying fix\n45.         query.get_compiler(using=db).as_sql()\n46. ', start_line_number=37, end_line_number=46), Context(relative_path='tests/backends/base/test_operations.py', content="159.     def test_execute_sql_flush_statements(self):\n160.         with transaction.atomic():\n161.             author = Author.objects.create(name='George Orwell')\n162.             Book.objects.create(author=author)\n163.             author = Author.objects.create(name='Harper Lee')\n164.             Book.objects.create(author=author)\n165.             Book.objects.create(author=author)\n166.             self.assertIs(Author.objects.exists(), True)\n167.             self.assertIs(Book.objects.exists(), True)\n168. \n169.         sql_list = connection.ops.sql_flush(\n170.             no_style(),\n171.             [Author._meta.db_table, Book._meta.db_table],\n172.             reset_sequences=True,\n173.             allow_cascade=True,\n174.         )\n175.         connection.ops.execute_sql_flush(connection.alias, sql_list)\n176. \n177.         with transaction.atomic():\n178.             self.assertIs(Author.objects.exists(), False)\n179.             self.assertIs(Book.objects.exists(), False)\n180.             if connection.features.supports_sequence_reset:\n181.                 author = Author.objects.create(name='F. Scott Fitzgerald')\n182.                 self.assertEqual(author.pk, 1)\n183.                 book = Book.objects.create(author=author)\n184.                 self.assertEqual(book.pk, 1)", start_line_number=159, end_line_number=184), Context(relative_path='tests/backends/base/test_operations.py', content='156.     def test_sql_flush_no_tables(self):\n157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])', start_line_number=156, end_line_number=157), Context(relative_path='tests/backends/base/test_operations.py', content="43.     def test_sql_flush(self):\n44.         msg = 'subclasses of BaseDatabaseOperations must provide a sql_flush() method'\n45.         with self.assertRaisesMessage(NotImplementedError, msg):\n46.             self.ops.sql_flush(None, None)", start_line_number=43, end_line_number=46), Context(relative_path='tests/backends/base/test_operations.py', content='54.     def test_sequence_reset_by_name_sql(self):\n55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])', start_line_number=54, end_line_number=55), Context(relative_path='tests/admin_scripts/tests.py', content='258.     def test_custom_command_with_settings(self):\n259.         "default: django-admin can execute user commands if settings are provided as argument"\n260.         args = [\'noargs_command\', \'--settings=test_project.settings\']\n261.         out, err = self.run_django_admin(args)\n262.         self.assertNoOutput(err)\n263.         self.assertOutput(out, "EXECUTE: noargs_command")', start_line_number=258, end_line_number=263)]
2025-10-06 05:09:54,433 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 05:09:54,433 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   └── FUNDING.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   └── static
|   |   |       └── fontawesome
|   |   └── djangodocs-epub
|   |       └── static
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   └── gis
|       └── mapwidget.test.js
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   └── admin
    |   |       └── admin_views
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   └── registration
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   └── registration
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   └── robots.txt
    |   |   └── registration
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   └── javascript_ignored.js
    |   |   └── templates
    |   |       └── subdir
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   ├── templates
    |   |   └── shortcuts
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── cached
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   ├── loop
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   ├── jinja2
    |   |   └── template_backends
    |   ├── template_strings
    |   |   └── template_backends
    |   ├── templates
    |   |   └── template_backends
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   ├── templates
    |   |   └── template_loader
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   ├── other_templates
    |   |   └── priority
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   ├── fs2
    |   |   └── fs3
    |   ├── relative_templates
    |   |   └── dir1
    |   |       └── dir2
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── first
    |   |   ├── priority
    |   |   ├── second
    |   |   └── template_tests
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   └── views
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   └── debug
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Simplify signature of `DatabaseOperations.execute_sql_flush()`

Issue description: 
Description
	
The current signature is:
def execute_sql_flush(self, using, sql_list):
The using argument can be dropped and inferred by the calling instance: self.connection.alias.
def execute_sql_flush(self, sql_list):
Some internal ises of this method are already doing:
connection.ops.execute_sql_flush(connection.alias, sql_flush)

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/multiple_database/tests.py
Line number range: 19 - 114
Content:
19. class QueryTestCase(TestCase):
20.     databases = {'default', 'other'}
21. 
22.     def test_db_selection(self):
23.         "Querysets will use the default database by default"
24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)
25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)
26. 
27.         self.assertEqual(Book.objects.using('other').db, 'other')
28. 
29.         self.assertEqual(Book.objects.db_manager('other').db, 'other')
30.         self.assertEqual(Book.objects.db_manager('other').all().db, 'other')
31. 
32.     def test_default_creation(self):
33.         "Objects created on the default database don't leak onto other databases"
34.         # Create a book on the default database using create()
35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
36. 
37.         # Create a book on the default database using a save
38.         dive = Book()
39.         dive.title = "Dive into Python"
40.         dive.published = datetime.date(2009, 5, 4)
41.         dive.save()
42. 
43.         # Book exists on the default database, but not on other database
44.         try:
45.             Book.objects.get(title="Pro Django")
46.             Book.objects.using('default').get(title="Pro Django")
47.         except Book.DoesNotExist:
48.             self.fail('"Pro Django" should exist on default database')
49. 
50.         with self.assertRaises(Book.DoesNotExist):
51.             Book.objects.using('other').get(title="Pro Django")
52. 
53.         try:
54.             Book.objects.get(title="Dive into Python")
55.             Book.objects.using('default').get(title="Dive into Python")
56.         except Book.DoesNotExist:
57.             self.fail('"Dive into Python" should exist on default database')
58. 
59.         with self.assertRaises(Book.DoesNotExist):
60.             Book.objects.using('other').get(title="Dive into Python")
61. 
62.     def test_other_creation(self):
63.         "Objects created on another database don't leak onto the default database"
64.         # Create a book on the second database
65.         Book.objects.using('other').create(title="Pro Django",
66.                                            published=datetime.date(2008, 12, 16))
67. 
68.         # Create a book on the default database using a save
69.         dive = Book()
70.         dive.title = "Dive into Python"
71.         dive.published = datetime.date(2009, 5, 4)
72.         dive.save(using='other')
73. 
74.         # Book exists on the default database, but not on other database
75.         try:
76.             Book.objects.using('other').get(title="Pro Django")
77.         except Book.DoesNotExist:
78.             self.fail('"Pro Django" should exist on other database')
79. 
80.         with self.assertRaises(Book.DoesNotExist):
81.             Book.objects.get(title="Pro Django")
82.         with self.assertRaises(Book.DoesNotExist):
83.             Book.objects.using('default').get(title="Pro Django")
84. 
85.         try:
86.             Book.objects.using('other').get(title="Dive into Python")
87.         except Book.DoesNotExist:
88.             self.fail('"Dive into Python" should exist on other database')
89. 
90.         with self.assertRaises(Book.DoesNotExist):
91.             Book.objects.get(title="Dive into Python")
92.         with self.assertRaises(Book.DoesNotExist):
93.             Book.objects.using('default').get(title="Dive into Python")
94. 
95.     def test_refresh(self):
96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))
97.         dive.save(using='other')
98.         dive2 = Book.objects.using('other').get()
99.         dive2.title = "Dive into Python (on default)"
100.         dive2.save(using='default')
101.         dive.refresh_from_db()
102.         self.assertEqual(dive.title, "Dive into Python")
103.         dive.refresh_from_db(using='default')
104.         self.assertEqual(dive.title, "Dive into Python (on default)")
105.         self.assertEqual(dive._state.db, "default")
106. 
107.     def test_refresh_router_instance_hint(self):
108.         router = Mock()
109.         router.db_for_read.return_value = None
110.         book = Book.objects.create(title='Dive Into Python', published=datetime.date(1957, 10, 12))
111.         with self.settings(DATABASE_ROUTERS=[router]):
112.             book.refresh_from_db()
113.         router.db_for_read.assert_called_once_with(Book, instance=book)
114. 


File: tests/multiple_database/tests.py
Line number range: 200 - 258
Content:
200.     def test_m2m_forward_operations(self):
201.         "M2M forward manipulations are all constrained to a single DB"
202.         # Create a book and author on the other database
203.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
204.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
205. 
206.         # Save the author relations
207.         dive.authors.set([mark])
208. 
209.         # Add a second author
210.         john = Person.objects.using('other').create(name="John Smith")
211.         self.assertEqual(
212.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
213.             []
214.         )
215. 
216.         dive.authors.add(john)
217.         self.assertEqual(
218.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
219.             ['Dive into Python']
220.         )
221.         self.assertEqual(
222.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
223.             ['Dive into Python']
224.         )
225. 
226.         # Remove the second author
227.         dive.authors.remove(john)
228.         self.assertEqual(
229.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
230.             ['Dive into Python']
231.         )
232.         self.assertEqual(
233.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
234.             []
235.         )
236. 
237.         # Clear all authors
238.         dive.authors.clear()
239.         self.assertEqual(
240.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
241.             []
242.         )
243.         self.assertEqual(
244.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
245.             []
246.         )
247. 
248.         # Create an author through the m2m interface
249.         dive.authors.create(name='Jane Brown')
250.         self.assertEqual(
251.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
252.             []
253.         )
254.         self.assertEqual(
255.             list(Book.objects.using('other').filter(authors__name='Jane Brown').values_list('title', flat=True)),
256.             ['Dive into Python']
257.         )
258. 


File: tests/multiple_database/tests.py
Line number range: 321 - 368
Content:
321.     def test_m2m_cross_database_protection(self):
322.         "Operations that involve sharing M2M objects across databases raise an error"
323.         # Create a book and author on the default database
324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
325. 
326.         marty = Person.objects.create(name="Marty Alchin")
327. 
328.         # Create a book and author on the other database
329.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
330. 
331.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
332.         # Set a foreign key set with an object from a different database
333.         msg = (
334.             'Cannot assign "<Person: Marty Alchin>": the current database '
335.             'router prevents this relation.'
336.         )
337.         with self.assertRaisesMessage(ValueError, msg):
338.             with transaction.atomic(using='default'):
339.                 marty.edited.set([pro, dive])
340. 
341.         # Add to an m2m with an object from a different database
342.         msg = (
343.             'Cannot add "<Book: Dive into Python>": instance is on '
344.             'database "default", value is on database "other"'
345.         )
346.         with self.assertRaisesMessage(ValueError, msg):
347.             with transaction.atomic(using='default'):
348.                 marty.book_set.add(dive)
349. 
350.         # Set a m2m with an object from a different database
351.         with self.assertRaisesMessage(ValueError, msg):
352.             with transaction.atomic(using='default'):
353.                 marty.book_set.set([pro, dive])
354. 
355.         # Add to a reverse m2m with an object from a different database
356.         msg = (
357.             'Cannot add "<Person: Marty Alchin>": instance is on '
358.             'database "other", value is on database "default"'
359.         )
360.         with self.assertRaisesMessage(ValueError, msg):
361.             with transaction.atomic(using='other'):
362.                 dive.authors.add(marty)
363. 
364.         # Set a reverse m2m with an object from a different database
365.         with self.assertRaisesMessage(ValueError, msg):
366.             with transaction.atomic(using='other'):
367.                 dive.authors.set([mark, marty])
368. 


File: tests/migrations/test_commands.py
Line number range: 121 - 199
Content:
121.     @override_settings(
122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
123.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
124.     )
125.     def test_migrate_fake_initial(self):
126.         """
127.         --fake-initial only works if all tables created in the initial
128.         migration of an app exists. Database routers must be obeyed when doing
129.         that check.
130.         """
131.         # Make sure no tables are created
132.         for db in self.databases:
133.             self.assertTableNotExists("migrations_author", using=db)
134.             self.assertTableNotExists("migrations_tribble", using=db)
135.         # Run the migrations to 0001 only
136.         call_command("migrate", "migrations", "0001", verbosity=0)
137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
138.         # Make sure the right tables exist
139.         self.assertTableExists("migrations_author")
140.         self.assertTableNotExists("migrations_tribble")
141.         # Also check the "other" database
142.         self.assertTableNotExists("migrations_author", using="other")
143.         self.assertTableExists("migrations_tribble", using="other")
144. 
145.         # Fake a roll-back
146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
148.         # Make sure the tables still exist
149.         self.assertTableExists("migrations_author")
150.         self.assertTableExists("migrations_tribble", using="other")
151.         # Try to run initial migration
152.         with self.assertRaises(DatabaseError):
153.             call_command("migrate", "migrations", "0001", verbosity=0)
154.         # Run initial migration with an explicit --fake-initial
155.         out = io.StringIO()
156.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
159.         self.assertIn(
160.             "migrations.0001_initial... faked",
161.             out.getvalue().lower()
162.         )
163.         # Run migrations all the way
164.         call_command("migrate", verbosity=0)
165.         call_command("migrate", verbosity=0, database="other")
166.         # Make sure the right tables exist
167.         self.assertTableExists("migrations_author")
168.         self.assertTableNotExists("migrations_tribble")
169.         self.assertTableExists("migrations_book")
170.         self.assertTableNotExists("migrations_author", using="other")
171.         self.assertTableNotExists("migrations_tribble", using="other")
172.         self.assertTableNotExists("migrations_book", using="other")
173.         # Fake a roll-back
174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
176.         # Make sure the tables still exist
177.         self.assertTableExists("migrations_author")
178.         self.assertTableNotExists("migrations_tribble")
179.         self.assertTableExists("migrations_book")
180.         # Try to run initial migration
181.         with self.assertRaises(DatabaseError):
182.             call_command("migrate", "migrations", verbosity=0)
183.         # Run initial migration with an explicit --fake-initial
184.         with self.assertRaises(DatabaseError):
185.             # Fails because "migrations_tribble" does not exist but needs to in
186.             # order to make --fake-initial work.
187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
188.         # Fake an apply
189.         call_command("migrate", "migrations", fake=True, verbosity=0)
190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
194.         # Make sure it's all gone
195.         for db in self.databases:
196.             self.assertTableNotExists("migrations_author", using=db)
197.             self.assertTableNotExists("migrations_tribble", using=db)
198.             self.assertTableNotExists("migrations_book", using=db)
199. 


File: tests/model_regress/tests.py
Line number range: 37 - 46
Content:
37.     def test_sql_insert_compiler_return_id_attribute(self):
38.         """
39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure
40.         """
41.         db = router.db_for_write(Party)
42.         query = InsertQuery(Party)
43.         query.insert_values([Party._meta.fields[0]], [], raw=False)
44.         # this line will raise an AttributeError without the accompanying fix
45.         query.get_compiler(using=db).as_sql()
46. 


File: tests/backends/base/test_operations.py
Line number range: 159 - 184
Content:
159.     def test_execute_sql_flush_statements(self):
160.         with transaction.atomic():
161.             author = Author.objects.create(name='George Orwell')
162.             Book.objects.create(author=author)
163.             author = Author.objects.create(name='Harper Lee')
164.             Book.objects.create(author=author)
165.             Book.objects.create(author=author)
166.             self.assertIs(Author.objects.exists(), True)
167.             self.assertIs(Book.objects.exists(), True)
168. 
169.         sql_list = connection.ops.sql_flush(
170.             no_style(),
171.             [Author._meta.db_table, Book._meta.db_table],
172.             reset_sequences=True,
173.             allow_cascade=True,
174.         )
175.         connection.ops.execute_sql_flush(connection.alias, sql_list)
176. 
177.         with transaction.atomic():
178.             self.assertIs(Author.objects.exists(), False)
179.             self.assertIs(Book.objects.exists(), False)
180.             if connection.features.supports_sequence_reset:
181.                 author = Author.objects.create(name='F. Scott Fitzgerald')
182.                 self.assertEqual(author.pk, 1)
183.                 book = Book.objects.create(author=author)
184.                 self.assertEqual(book.pk, 1)


File: tests/backends/base/test_operations.py
Line number range: 156 - 157
Content:
156.     def test_sql_flush_no_tables(self):
157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])


File: tests/backends/base/test_operations.py
Line number range: 43 - 46
Content:
43.     def test_sql_flush(self):
44.         msg = 'subclasses of BaseDatabaseOperations must provide a sql_flush() method'
45.         with self.assertRaisesMessage(NotImplementedError, msg):
46.             self.ops.sql_flush(None, None)


File: tests/backends/base/test_operations.py
Line number range: 54 - 55
Content:
54.     def test_sequence_reset_by_name_sql(self):
55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])


File: tests/admin_scripts/tests.py
Line number range: 258 - 263
Content:
258.     def test_custom_command_with_settings(self):
259.         "default: django-admin can execute user commands if settings are provided as argument"
260.         args = ['noargs_command', '--settings=test_project.settings']
261.         out, err = self.run_django_admin(args)
262.         self.assertNoOutput(err)
263.         self.assertOutput(out, "EXECUTE: noargs_command")

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-06 05:10:25,018 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user wants to find 5 complete, self-contained test cases related to simplifying the `DatabaseOperations.execute_sql_flush()` method. This involves removing the `using` parameter.\n2. The most relevant tests would be those that directly call this method or related methods in `DatabaseOperations`, and those that test multi-database functionality, as that's what the `using` parameter controls.\n3. I have identified several relevant test methods in files like `tests/backends/base/test_operations.py`, `tests/multiple_database/tests.py`, and `tests/migrations/test_commands.py` from the provided context.\n4. However, the context only contains snippets of these files. To provide complete, runnable test cases as requested, I need the full file content to get all necessary imports, class setups, and helper functions.\n5. Therefore, additional context is essential to fulfill the user's request." refined_query='Please provide the full source code for the following files: `tests/backends/base/test_operations.py`, `tests/multiple_database/tests.py`, and `tests/migrations/test_commands.py`. I need the complete files to extract full test cases, including all necessary imports and helper code, imports and helper code related code.'
2025-10-06 05:10:28,635 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/migrations/test_commands.py"}'}, '__gemini_function_call_thought_signatures__': {'a9a5c1a2-41d5-46a7-9e04-ae0eadb8aa27': 'Cr8EAR/MhbZFrWNBTz5Q0zaAoejnG78fSbI/T3wUNeNCEJKOBle1CI/937LUtYjFc2nm5tl8bPpy72eeJEjrtFgPk8D07mCsF1uofP8nFcCGV7nnsURPyVBfrhZTqOAh2MMf8EY705yCavq8xAVI37GfZW4iMMsYm3GWVN0cxGKCd7J5oyyy3e1WtzeNfOyKL+HzMOkMggsrVmZ9BmUSBdK+v31Tb1IxQb4kcRFITdn/fqKISK1WC4bg5izWqBfYeORZdIEhQXh9PmayTzjTtDbLuVfejvU1gwjs9YitTFht823bGhvfchReGfimu+PbmAS2jVHGOiULgijNoB6X7kS8d1j01+yrXAc1FIlixHJdtNQYtavsXqDF2thdM0lfO4BXw3X14hIV4hXBNYfBJ41kPOdr/EgXjfpsDeNTBNQ3oyc2EY9/wdr9KUX1hg7SseTsckDJqv7MG2D1/ZefXt2+d7tFvCR9bnFZ20Ko7B18HPxT7GubU13RPRAJBBMyN7+3u5x+LOIhwmbDHjLrxUiAVIlRwAKrEO6A7fUGLqO/ZjdfgNHIV36iCQphgzq/9oJjtvqOSPNIyICJy0aYi3gpmjzcO0qkUs8ZYxWQ1uNlytQXkpLUi2GZGXUMCMjXViuU4i6ZIL+4yaDNKMuQbwTIAG4St6nIYJ2UCZtpOgKcZ+yY6ZUvGatzWUxT1M07Rb6xkRW6m0h4P2sNp4JkRT+AZAoSXEMO2Fa081PvjYiOogchkPCfk7eb3o5ZYhf4XTY='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55102, 'candidates_token_count': 71, 'total_token_count': 55316, 'cached_content_token_count': 54234, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55102}], 'cache_tokens_details': [{'modality': 1, 'token_count': 54234}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 71}], 'thoughts_token_count': 143}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08726674738064619, 'model_name': 'gemini-2.5-pro'} id='run--71f40646-98c5-4258-98e3-9df2f93d4579-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/backends/base/test_operations.py'}, 'id': 'a9a5c1a2-41d5-46a7-9e04-ae0eadb8aa27', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/multiple_database/tests.py'}, 'id': '37045a53-5376-4ab5-8659-d3d63320988f', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/migrations/test_commands.py'}, 'id': 'b36cfe9c-7579-479f-850e-f6d3fbec35f2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 55102, 'output_tokens': 71, 'total_tokens': 55316, 'input_token_details': {'cache_read': 54234}, 'output_token_details': {'reasoning': 143}}
2025-10-06 05:10:33,553 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"relative_path": "tests/migrations/test_commands.py", "start_line": 1.0, "end_line": 1000.0}'}, '__gemini_function_call_thought_signatures__': {'8434d956-1897-49c6-b975-67084e031a2d': 'CooJAR/MhbatteFfJExtF7bUVvp02G4xrJ73DXOCnRoSaOP4EojGACQLlgks7Elo2D3i2VfqNAjddNkT+kFkk1Emt/mlLjw+e5RK7WS/dgNsy23VRBNZEiYSk9Itg4/y/WspR1kDuhT+QaymSuJjtmvefindxaqDtXjzM8UtVJhOlSK4hTqE7R5mAHK0ihPcPzhg8FkvllZu5vaqUCADf/Hcp9Tor76J7VMgCXBPgLs2RVKnlJQP1p49h9QmKvvKjdUgTiAqKAMbDRfph//5VPRhEfbmMjqDX5qpx+N4hZiqTYc92ZwmFGws58K3wxjmbxA1SHxZI4pdg2K//xvjXTS8hShm7XO2ru4J55KtCg4fAliGo3pHe/FyhnBLrWLihYJrBk23sQ2o/E3tb2saOa5MOb9ppK7zz0EdzIJrn6/xqZMg51UxjFc7HTzwuno4a4hDPoA8gRZvaX+g0b7Y6tcLJuQXnsT86L2UZBaSdtwUejp9AUG3J8nApbcQAMmHZuisYtApRs2vXhajYKPV/8St0wOybHYXpK9SpT/EQIaTqTB7loquaHU2W0urJePdmarDPPeFlFncPKeDtnIcPRJTO9TD95KZjA5zWfUyv9HR+suCd4YTuty80Pjrfuq9zjenLMiFb12nOEfysUEXAdFvs8xsMbOpwXro9XZsshydV95pMkgebhtYJt0WVv0DGH+TKBQrIRJfbghpERIjaFACnHTt4CL7Cr5yTgdIioF/3jUKcDU1awrDuay+KVohZ0BbyCELkOyUoiT6l+VPKw6jDJETFgp03bYCNzMgiUnjvlkXIAfOdIWorWgZYrz3mXUn7pc97Xg11ft7WsdfhuG8MyxyqWKv5fGYaJ+9GnuYvTYMnRNqJz2YjlYMkADq3CZ5ESavghSrQ8pYDapwV2ZyMGMRRSHPlo209HXuFhnWmpTHASbEd8nJYyAHuOuKseBPfrEaxfqig6z9ledhwHSu7CclVKqE8L03z903OgeHdw/t+reOFael9H1x9TQRZiaGQDeYy3glYzWBbFoq1BTqebES5SKTagZ7v0Itk9LhF6YOhYVrRTm05/qW7gzeX6V4VI6Px4j179NzRoETDiejiv6LDgNijChozkRpRaqBtaUPR3XdZLnmK89g3ChQ6KTztoZgUnpZ5zeiBcxL9hTUW7BkPpanvdeK9Fte5obVlz5LGMdAQsaaxchOuiY3Tbi/EgdumRQYHRcG7kl+T9M9RCcptXk8Vl2oDSEm9Yb3K/X7mnGA5JOtqHhu5KU4gLPOzrsL5CMdT9b5bSljPDh4AdjdFP3IQ8IgCh5LhSUcNFqMvupBsQnZyn0hJF9/EJrpd6K/RmqOHte1RN8xZDPZ1odG4utXYpoNLKcBK/87QspWWChBIf45MZT9vj4dSzYEh1Bl+gPyXH1/gM+LSd9WIG+ITCVwF/1tBkrcsLzSXpCie/JYcXEjTqaZ8V0yEt133anAfLBneXJGyb7WsTZqNCY52Sd5Vz+LQdcIi1pw4GKk69Uka/4anxbTws/NnruAyIlQp4/Jq1AAFA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 75153, 'candidates_token_count': 89, 'total_token_count': 75565, 'prompt_tokens_details': [{'modality': 1, 'token_count': 75294}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 89}], 'thoughts_token_count': 323, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2999756630886807, 'model_name': 'gemini-2.5-pro'} id='run--de429ca6-2eef-4ddb-9bd8-1ec7bbb05158-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'relative_path': 'tests/backends/base/test_operations.py', 'start_line': 1.0, 'end_line': 1000.0}, 'id': '8434d956-1897-49c6-b975-67084e031a2d', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'relative_path': 'tests/multiple_database/tests.py', 'start_line': 1.0, 'end_line': 1000.0}, 'id': 'b59fbb04-2efd-4475-9d1f-ddc8d063a3f6', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'relative_path': 'tests/migrations/test_commands.py', 'start_line': 1.0, 'end_line': 1000.0}, 'id': '8b5a2c2f-631e-4e02-902f-58d70d8d767b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 75153, 'output_tokens': 89, 'total_tokens': 75565, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 323}}
2025-10-06 05:10:37,626 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the full source code for the requested files: `tests/backends/base/test_operations.py`, `tests/multiple_database/tests.py`, and `tests/migrations/test_commands.py`. I used the `read_code_with_relative_path` tool to read the entire content of each file, ensuring all lines were captured. The complete source code for each file is now available for your use.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 112898, 'candidates_token_count': 93, 'total_token_count': 113159, 'cached_content_token_count': 71637, 'prompt_tokens_details': [{'modality': 1, 'token_count': 113360}], 'cache_tokens_details': [{'modality': 1, 'token_count': 71637}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 93}], 'thoughts_token_count': 168}, 'finish_reason': 'STOP', 'avg_logprobs': -0.26723455613659275, 'model_name': 'gemini-2.5-pro'} id='run--08c7bac1-281c-4b31-b1ba-1c18bef69569-0' usage_metadata={'input_tokens': 112898, 'output_tokens': 93, 'total_tokens': 113159, 'input_token_details': {'cache_read': 71637}, 'output_token_details': {'reasoning': 168}}
2025-10-06 05:10:37,627 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 05:10:37,628 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Simplify signature of `DatabaseOperations.execute_sql_flush()`

Issue description: 
Description
	
The current signature is:
def execute_sql_flush(self, using, sql_list):
The using argument can be dropped and inferred by the calling instance: self.connection.alias.
def execute_sql_flush(self, sql_list):
Some internal ises of this method are already doing:
connection.ops.execute_sql_flush(connection.alias, sql_flush)

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the full source code for the following files: `tests/backends/base/test_operations.py`, `tests/multiple_database/tests.py`, and `tests/migrations/test_commands.py`. I need the complete files to extract full test cases, including all necessary imports and helper code, imports and helper code related code.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/backends/base/test_operations.py
Line number range: 1 - 184
Content:
1. import decimal
2. 
3. from django.core.management.color import no_style
4. from django.db import NotSupportedError, connection, transaction
5. from django.db.backends.base.operations import BaseDatabaseOperations
6. from django.db.models import DurationField
7. from django.test import (
8.     SimpleTestCase, TestCase, TransactionTestCase, override_settings,
9.     skipIfDBFeature,
10. )
11. from django.utils import timezone
12. 
13. from ..models import Author, Book
14. 
15. 
16. class SimpleDatabaseOperationTests(SimpleTestCase):
17.     may_require_msg = 'subclasses of BaseDatabaseOperations may require a %s() method'
18. 
19.     def setUp(self):
20.         self.ops = BaseDatabaseOperations(connection=connection)
21. 
22.     def test_deferrable_sql(self):
23.         self.assertEqual(self.ops.deferrable_sql(), '')
24. 
25.     def test_end_transaction_rollback(self):
26.         self.assertEqual(self.ops.end_transaction_sql(success=False), 'ROLLBACK;')
27. 
28.     def test_no_limit_value(self):
29.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'no_limit_value'):
30.             self.ops.no_limit_value()
31. 
32.     def test_quote_name(self):
33.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'quote_name'):
34.             self.ops.quote_name('a')
35. 
36.     def test_regex_lookup(self):
37.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'regex_lookup'):
38.             self.ops.regex_lookup(lookup_type='regex')
39. 
40.     def test_set_time_zone_sql(self):
41.         self.assertEqual(self.ops.set_time_zone_sql(), '')
42. 
43.     def test_sql_flush(self):
44.         msg = 'subclasses of BaseDatabaseOperations must provide a sql_flush() method'
45.         with self.assertRaisesMessage(NotImplementedError, msg):
46.             self.ops.sql_flush(None, None)
47. 
48.     def test_pk_default_value(self):
49.         self.assertEqual(self.ops.pk_default_value(), 'DEFAULT')
50. 
51.     def test_tablespace_sql(self):
52.         self.assertEqual(self.ops.tablespace_sql(None), '')
53. 
54.     def test_sequence_reset_by_name_sql(self):
55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])
56. 
57.     def test_adapt_unknown_value_decimal(self):
58.         value = decimal.Decimal('3.14')
59.         self.assertEqual(
60.             self.ops.adapt_unknown_value(value),
61.             self.ops.adapt_decimalfield_value(value)
62.         )
63. 
64.     def test_adapt_unknown_value_date(self):
65.         value = timezone.now().date()
66.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_datefield_value(value))
67. 
68.     def test_adapt_unknown_value_time(self):
69.         value = timezone.now().time()
70.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_timefield_value(value))
71. 
72.     def test_adapt_timefield_value_none(self):
73.         self.assertIsNone(self.ops.adapt_timefield_value(None))
74. 
75.     def test_adapt_datetimefield_value(self):
76.         self.assertIsNone(self.ops.adapt_datetimefield_value(None))
77. 
78.     def test_adapt_timefield_value(self):
79.         msg = 'Django does not support timezone-aware times.'
80.         with self.assertRaisesMessage(ValueError, msg):
81.             self.ops.adapt_timefield_value(timezone.make_aware(timezone.now()))
82. 
83.     @override_settings(USE_TZ=False)
84.     def test_adapt_timefield_value_unaware(self):
85.         now = timezone.now()
86.         self.assertEqual(self.ops.adapt_timefield_value(now), str(now))
87. 
88.     def test_date_extract_sql(self):
89.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):
90.             self.ops.date_extract_sql(None, None)
91. 
92.     def test_time_extract_sql(self):
93.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):
94.             self.ops.time_extract_sql(None, None)
95. 
96.     def test_date_interval_sql(self):
97.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_interval_sql'):
98.             self.ops.date_interval_sql(None)
99. 
100.     def test_date_trunc_sql(self):
101.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_trunc_sql'):
102.             self.ops.date_trunc_sql(None, None)
103. 
104.     def test_time_trunc_sql(self):
105.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'time_trunc_sql'):
106.             self.ops.time_trunc_sql(None, None)
107. 
108.     def test_datetime_trunc_sql(self):
109.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_trunc_sql'):
110.             self.ops.datetime_trunc_sql(None, None, None)
111. 
112.     def test_datetime_cast_date_sql(self):
113.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_date_sql'):
114.             self.ops.datetime_cast_date_sql(None, None)
115. 
116.     def test_datetime_cast_time_sql(self):
117.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_time_sql'):
118.             self.ops.datetime_cast_time_sql(None, None)
119. 
120.     def test_datetime_extract_sql(self):
121.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_extract_sql'):
122.             self.ops.datetime_extract_sql(None, None, None)
123. 
124. 
125. class DatabaseOperationTests(TestCase):
126.     def setUp(self):
127.         self.ops = BaseDatabaseOperations(connection=connection)
128. 
129.     @skipIfDBFeature('supports_over_clause')
130.     def test_window_frame_raise_not_supported_error(self):
131.         msg = 'This backend does not support window expressions.'
132.         with self.assertRaisesMessage(NotSupportedError, msg):
133.             self.ops.window_frame_rows_start_end()
134. 
135.     @skipIfDBFeature('can_distinct_on_fields')
136.     def test_distinct_on_fields(self):
137.         msg = 'DISTINCT ON fields is not supported by this database backend'
138.         with self.assertRaisesMessage(NotSupportedError, msg):
139.             self.ops.distinct_sql(['a', 'b'], None)
140. 
141.     @skipIfDBFeature('supports_temporal_subtraction')
142.     def test_subtract_temporals(self):
143.         duration_field = DurationField()
144.         duration_field_internal_type = duration_field.get_internal_type()
145.         msg = (
146.             'This backend does not support %s subtraction.' %
147.             duration_field_internal_type
148.         )
149.         with self.assertRaisesMessage(NotSupportedError, msg):
150.             self.ops.subtract_temporals(duration_field_internal_type, None, None)
151. 
152. 
153. class SqlFlushTests(TransactionTestCase):
154.     available_apps = ['backends']
155. 
156.     def test_sql_flush_no_tables(self):
157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])
158. 
159.     def test_execute_sql_flush_statements(self):
160.         with transaction.atomic():
161.             author = Author.objects.create(name='George Orwell')
162.             Book.objects.create(author=author)
163.             author = Author.objects.create(name='Harper Lee')
164.             Book.objects.create(author=author)
165.             Book.objects.create(author=author)
166.             self.assertIs(Author.objects.exists(), True)
167.             self.assertIs(Book.objects.exists(), True)
168. 
169.         sql_list = connection.ops.sql_flush(
170.             no_style(),
171.             [Author._meta.db_table, Book._meta.db_table],
172.             reset_sequences=True,
173.             allow_cascade=True,
174.         )
175.         connection.ops.execute_sql_flush(connection.alias, sql_list)
176. 
177.         with transaction.atomic():
178.             self.assertIs(Author.objects.exists(), False)
179.             self.assertIs(Book.objects.exists(), False)
180.             if connection.features.supports_sequence_reset:
181.                 author = Author.objects.create(name='F. Scott Fitzgerald')
182.                 self.assertEqual(author.pk, 1)
183.                 book = Book.objects.create(author=author)
184.                 self.assertEqual(book.pk, 1)

File: tests/multiple_database/tests.py
Line number range: 1 - 1000
Content:
1. import datetime
2. import pickle
3. from io import StringIO
4. from operator import attrgetter
5. from unittest.mock import Mock
6. 
7. from django.contrib.auth.models import User
8. from django.contrib.contenttypes.models import ContentType
9. from django.core import management
10. from django.db import DEFAULT_DB_ALIAS, router, transaction
11. from django.db.models import signals
12. from django.db.utils import ConnectionRouter
13. from django.test import SimpleTestCase, TestCase, override_settings
14. 
15. from .models import Book, Person, Pet, Review, UserProfile
16. from .routers import AuthRouter, TestRouter, WriteRouter
17. 
18. 
19. class QueryTestCase(TestCase):
20.     databases = {'default', 'other'}
21. 
22.     def test_db_selection(self):
23.         "Querysets will use the default database by default"
24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)
25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)
26. 
27.         self.assertEqual(Book.objects.using('other').db, 'other')
28. 
29.         self.assertEqual(Book.objects.db_manager('other').db, 'other')
30.         self.assertEqual(Book.objects.db_manager('other').all().db, 'other')
31. 
32.     def test_default_creation(self):
33.         "Objects created on the default database don't leak onto other databases"
34.         # Create a book on the default database using create()
35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
36. 
37.         # Create a book on the default database using a save
38.         dive = Book()
39.         dive.title = "Dive into Python"
40.         dive.published = datetime.date(2009, 5, 4)
41.         dive.save()
42. 
43.         # Book exists on the default database, but not on other database
44.         try:
45.             Book.objects.get(title="Pro Django")
46.             Book.objects.using('default').get(title="Pro Django")
47.         except Book.DoesNotExist:
48.             self.fail('"Pro Django" should exist on default database')
49. 
50.         with self.assertRaises(Book.DoesNotExist):
51.             Book.objects.using('other').get(title="Pro Django")
52. 
53.         try:
54.             Book.objects.get(title="Dive into Python")
55.             Book.objects.using('default').get(title="Dive into Python")
56.         except Book.DoesNotExist:
57.             self.fail('"Dive into Python" should exist on default database')
58. 
59.         with self.assertRaises(Book.DoesNotExist):
60.             Book.objects.using('other').get(title="Dive into Python")
61. 
62.     def test_other_creation(self):
63.         "Objects created on another database don't leak onto the default database"
64.         # Create a book on the second database
65.         Book.objects.using('other').create(title="Pro Django",
66.                                            published=datetime.date(2008, 12, 16))
67. 
68.         # Create a book on the default database using a save
69.         dive = Book()
70.         dive.title = "Dive into Python"
71.         dive.published = datetime.date(2009, 5, 4)
72.         dive.save(using='other')
73. 
74.         # Book exists on the default database, but not on other database
75.         try:
76.             Book.objects.using('other').get(title="Pro Django")
77.         except Book.DoesNotExist:
78.             self.fail('"Pro Django" should exist on other database')
79. 
80.         with self.assertRaises(Book.DoesNotExist):
81.             Book.objects.get(title="Pro Django")
82.         with self.assertRaises(Book.DoesNotExist):
83.             Book.objects.using('default').get(title="Pro Django")
84. 
85.         try:
86.             Book.objects.using('other').get(title="Dive into Python")
87.         except Book.DoesNotExist:
88.             self.fail('"Dive into Python" should exist on other database')
89. 
90.         with self.assertRaises(Book.DoesNotExist):
91.             Book.objects.get(title="Dive into Python")
92.         with self.assertRaises(Book.DoesNotExist):
93.             Book.objects.using('default').get(title="Dive into Python")
94. 
95.     def test_refresh(self):
96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))
97.         dive.save(using='other')
98.         dive2 = Book.objects.using('other').get()
99.         dive2.title = "Dive into Python (on default)"
100.         dive2.save(using='default')
101.         dive.refresh_from_db()
102.         self.assertEqual(dive.title, "Dive into Python")
103.         dive.refresh_from_db(using='default')
104.         self.assertEqual(dive.title, "Dive into Python (on default)")
105.         self.assertEqual(dive._state.db, "default")
106. 
107.     def test_refresh_router_instance_hint(self):
108.         router = Mock()
109.         router.db_for_read.return_value = None
110.         book = Book.objects.create(title='Dive Into Python', published=datetime.date(1957, 10, 12))
111.         with self.settings(DATABASE_ROUTERS=[router]):
112.             book.refresh_from_db()
113.         router.db_for_read.assert_called_once_with(Book, instance=book)
114. 
115.     def test_basic_queries(self):
116.         "Queries are constrained to a single database"
117.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
118. 
119.         dive = Book.objects.using('other').get(published=datetime.date(2009, 5, 4))
120.         self.assertEqual(dive.title, "Dive into Python")
121.         with self.assertRaises(Book.DoesNotExist):
122.             Book.objects.using('default').get(published=datetime.date(2009, 5, 4))
123. 
124.         dive = Book.objects.using('other').get(title__icontains="dive")
125.         self.assertEqual(dive.title, "Dive into Python")
126.         with self.assertRaises(Book.DoesNotExist):
127.             Book.objects.using('default').get(title__icontains="dive")
128. 
129.         dive = Book.objects.using('other').get(title__iexact="dive INTO python")
130.         self.assertEqual(dive.title, "Dive into Python")
131.         with self.assertRaises(Book.DoesNotExist):
132.             Book.objects.using('default').get(title__iexact="dive INTO python")
133. 
134.         dive = Book.objects.using('other').get(published__year=2009)
135.         self.assertEqual(dive.title, "Dive into Python")
136.         self.assertEqual(dive.published, datetime.date(2009, 5, 4))
137.         with self.assertRaises(Book.DoesNotExist):
138.             Book.objects.using('default').get(published__year=2009)
139. 
140.         years = Book.objects.using('other').dates('published', 'year')
141.         self.assertEqual([o.year for o in years], [2009])
142.         years = Book.objects.using('default').dates('published', 'year')
143.         self.assertEqual([o.year for o in years], [])
144. 
145.         months = Book.objects.using('other').dates('published', 'month')
146.         self.assertEqual([o.month for o in months], [5])
147.         months = Book.objects.using('default').dates('published', 'month')
148.         self.assertEqual([o.month for o in months], [])
149. 
150.     def test_m2m_separation(self):
151.         "M2M fields are constrained to a single database"
152.         # Create a book and author on the default database
153.         pro = Book.objects.create(title="Pro Django",
154.                                   published=datetime.date(2008, 12, 16))
155. 
156.         marty = Person.objects.create(name="Marty Alchin")
157. 
158.         # Create a book and author on the other database
159.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
160. 
161.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
162. 
163.         # Save the author relations
164.         pro.authors.set([marty])
165.         dive.authors.set([mark])
166. 
167.         # Inspect the m2m tables directly.
168.         # There should be 1 entry in each database
169.         self.assertEqual(Book.authors.through.objects.using('default').count(), 1)
170.         self.assertEqual(Book.authors.through.objects.using('other').count(), 1)
171. 
172.         # Queries work across m2m joins
173.         self.assertEqual(
174.             list(Book.objects.using('default').filter(authors__name='Marty Alchin').values_list('title', flat=True)),
175.             ['Pro Django']
176.         )
177.         self.assertEqual(
178.             list(Book.objects.using('other').filter(authors__name='Marty Alchin').values_list('title', flat=True)),
179.             []
180.         )
181. 
182.         self.assertEqual(
183.             list(Book.objects.using('default').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
184.             []
185.         )
186.         self.assertEqual(
187.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
188.             ['Dive into Python']
189.         )
190. 
191.         # Reget the objects to clear caches
192.         dive = Book.objects.using('other').get(title="Dive into Python")
193.         mark = Person.objects.using('other').get(name="Mark Pilgrim")
194. 
195.         # Retrieve related object by descriptor. Related objects should be database-bound
196.         self.assertEqual(list(dive.authors.all().values_list('name', flat=True)), ['Mark Pilgrim'])
197. 
198.         self.assertEqual(list(mark.book_set.all().values_list('title', flat=True)), ['Dive into Python'])
199. 
200.     def test_m2m_forward_operations(self):
201.         "M2M forward manipulations are all constrained to a single DB"
202.         # Create a book and author on the other database
203.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
204.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
205. 
206.         # Save the author relations
207.         dive.authors.set([mark])
208. 
209.         # Add a second author
210.         john = Person.objects.using('other').create(name="John Smith")
211.         self.assertEqual(
212.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
213.             []
214.         )
215. 
216.         dive.authors.add(john)
217.         self.assertEqual(
218.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
219.             ['Dive into Python']
220.         )
221.         self.assertEqual(
222.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
223.             ['Dive into Python']
224.         )
225. 
226.         # Remove the second author
227.         dive.authors.remove(john)
228.         self.assertEqual(
229.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
230.             ['Dive into Python']
231.         )
232.         self.assertEqual(
233.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
234.             []
235.         )
236. 
237.         # Clear all authors
238.         dive.authors.clear()
239.         self.assertEqual(
240.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
241.             []
242.         )
243.         self.assertEqual(
244.             list(Book.objects.using('other').filter(authors__name='John Smith').values_list('title', flat=True)),
245.             []
246.         )
247. 
248.         # Create an author through the m2m interface
249.         dive.authors.create(name='Jane Brown')
250.         self.assertEqual(
251.             list(Book.objects.using('other').filter(authors__name='Mark Pilgrim').values_list('title', flat=True)),
252.             []
253.         )
254.         self.assertEqual(
255.             list(Book.objects.using('other').filter(authors__name='Jane Brown').values_list('title', flat=True)),
256.             ['Dive into Python']
257.         )
258. 
259.     def test_m2m_reverse_operations(self):
260.         "M2M reverse manipulations are all constrained to a single DB"
261.         # Create a book and author on the other database
262.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
263.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
264. 
265.         # Save the author relations
266.         dive.authors.set([mark])
267. 
268.         # Create a second book on the other database
269.         grease = Book.objects.using('other').create(title="Greasemonkey Hacks", published=datetime.date(2005, 11, 1))
270. 
271.         # Add a books to the m2m
272.         mark.book_set.add(grease)
273.         self.assertEqual(
274.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
275.             ['Mark Pilgrim']
276.         )
277.         self.assertEqual(
278.             list(
279.                 Person.objects.using('other').filter(book__title='Greasemonkey Hacks').values_list('name', flat=True)
280.             ),
281.             ['Mark Pilgrim']
282.         )
283. 
284.         # Remove a book from the m2m
285.         mark.book_set.remove(grease)
286.         self.assertEqual(
287.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
288.             ['Mark Pilgrim']
289.         )
290.         self.assertEqual(
291.             list(
292.                 Person.objects.using('other').filter(book__title='Greasemonkey Hacks').values_list('name', flat=True)
293.             ),
294.             []
295.         )
296. 
297.         # Clear the books associated with mark
298.         mark.book_set.clear()
299.         self.assertEqual(
300.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
301.             []
302.         )
303.         self.assertEqual(
304.             list(
305.                 Person.objects.using('other').filter(book__title='Greasemonkey Hacks').values_list('name', flat=True)
306.             ),
307.             []
308.         )
309. 
310.         # Create a book through the m2m interface
311.         mark.book_set.create(title="Dive into HTML5", published=datetime.date(2020, 1, 1))
312.         self.assertEqual(
313.             list(Person.objects.using('other').filter(book__title='Dive into Python').values_list('name', flat=True)),
314.             []
315.         )
316.         self.assertEqual(
317.             list(Person.objects.using('other').filter(book__title='Dive into HTML5').values_list('name', flat=True)),
318.             ['Mark Pilgrim']
319.         )
320. 
321.     def test_m2m_cross_database_protection(self):
322.         "Operations that involve sharing M2M objects across databases raise an error"
323.         # Create a book and author on the default database
324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
325. 
326.         marty = Person.objects.create(name="Marty Alchin")
327. 
328.         # Create a book and author on the other database
329.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
330. 
331.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
332.         # Set a foreign key set with an object from a different database
333.         msg = (
334.             'Cannot assign "<Person: Marty Alchin>": the current database '
335.             'router prevents this relation.'
336.         )
337.         with self.assertRaisesMessage(ValueError, msg):
338.             with transaction.atomic(using='default'):
339.                 marty.edited.set([pro, dive])
340. 
341.         # Add to an m2m with an object from a different database
342.         msg = (
343.             'Cannot add "<Book: Dive into Python>": instance is on '
344.             'database "default", value is on database "other"'
345.         )
346.         with self.assertRaisesMessage(ValueError, msg):
347.             with transaction.atomic(using='default'):
348.                 marty.book_set.add(dive)
349. 
350.         # Set a m2m with an object from a different database
351.         with self.assertRaisesMessage(ValueError, msg):
352.             with transaction.atomic(using='default'):
353.                 marty.book_set.set([pro, dive])
354. 
355.         # Add to a reverse m2m with an object from a different database
356.         msg = (
357.             'Cannot add "<Person: Marty Alchin>": instance is on '
358.             'database "other", value is on database "default"'
359.         )
360.         with self.assertRaisesMessage(ValueError, msg):
361.             with transaction.atomic(using='other'):
362.                 dive.authors.add(marty)
363. 
364.         # Set a reverse m2m with an object from a different database
365.         with self.assertRaisesMessage(ValueError, msg):
366.             with transaction.atomic(using='other'):
367.                 dive.authors.set([mark, marty])
368. 
369.     def test_m2m_deletion(self):
370.         "Cascaded deletions of m2m relations issue queries on the right database"
371.         # Create a book and author on the other database
372.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
373.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
374.         dive.authors.set([mark])
375. 
376.         # Check the initial state
377.         self.assertEqual(Person.objects.using('default').count(), 0)
378.         self.assertEqual(Book.objects.using('default').count(), 0)
379.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
380. 
381.         self.assertEqual(Person.objects.using('other').count(), 1)
382.         self.assertEqual(Book.objects.using('other').count(), 1)
383.         self.assertEqual(Book.authors.through.objects.using('other').count(), 1)
384. 
385.         # Delete the object on the other database
386.         dive.delete(using='other')
387. 
388.         self.assertEqual(Person.objects.using('default').count(), 0)
389.         self.assertEqual(Book.objects.using('default').count(), 0)
390.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
391. 
392.         # The person still exists ...
393.         self.assertEqual(Person.objects.using('other').count(), 1)
394.         # ... but the book has been deleted
395.         self.assertEqual(Book.objects.using('other').count(), 0)
396.         # ... and the relationship object has also been deleted.
397.         self.assertEqual(Book.authors.through.objects.using('other').count(), 0)
398. 
399.         # Now try deletion in the reverse direction. Set up the relation again
400.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
401.         dive.authors.set([mark])
402. 
403.         # Check the initial state
404.         self.assertEqual(Person.objects.using('default').count(), 0)
405.         self.assertEqual(Book.objects.using('default').count(), 0)
406.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
407. 
408.         self.assertEqual(Person.objects.using('other').count(), 1)
409.         self.assertEqual(Book.objects.using('other').count(), 1)
410.         self.assertEqual(Book.authors.through.objects.using('other').count(), 1)
411. 
412.         # Delete the object on the other database
413.         mark.delete(using='other')
414. 
415.         self.assertEqual(Person.objects.using('default').count(), 0)
416.         self.assertEqual(Book.objects.using('default').count(), 0)
417.         self.assertEqual(Book.authors.through.objects.using('default').count(), 0)
418. 
419.         # The person has been deleted ...
420.         self.assertEqual(Person.objects.using('other').count(), 0)
421.         # ... but the book still exists
422.         self.assertEqual(Book.objects.using('other').count(), 1)
423.         # ... and the relationship object has been deleted.
424.         self.assertEqual(Book.authors.through.objects.using('other').count(), 0)
425. 
426.     def test_foreign_key_separation(self):
427.         "FK fields are constrained to a single database"
428.         # Create a book and author on the default database
429.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
430. 
431.         george = Person.objects.create(name="George Vilches")
432. 
433.         # Create a book and author on the other database
434.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
435.         chris = Person.objects.using('other').create(name="Chris Mills")
436. 
437.         # Save the author's favorite books
438.         pro.editor = george
439.         pro.save()
440. 
441.         dive.editor = chris
442.         dive.save()
443. 
444.         pro = Book.objects.using('default').get(title="Pro Django")
445.         self.assertEqual(pro.editor.name, "George Vilches")
446. 
447.         dive = Book.objects.using('other').get(title="Dive into Python")
448.         self.assertEqual(dive.editor.name, "Chris Mills")
449. 
450.         # Queries work across foreign key joins
451.         self.assertEqual(
452.             list(Person.objects.using('default').filter(edited__title='Pro Django').values_list('name', flat=True)),
453.             ['George Vilches']
454.         )
455.         self.assertEqual(
456.             list(Person.objects.using('other').filter(edited__title='Pro Django').values_list('name', flat=True)),
457.             []
458.         )
459. 
460.         self.assertEqual(
461.             list(
462.                 Person.objects.using('default').filter(edited__title='Dive into Python').values_list('name', flat=True)
463.             ),
464.             []
465.         )
466.         self.assertEqual(
467.             list(
468.                 Person.objects.using('other').filter(edited__title='Dive into Python').values_list('name', flat=True)
469.             ),
470.             ['Chris Mills']
471.         )
472. 
473.         # Reget the objects to clear caches
474.         chris = Person.objects.using('other').get(name="Chris Mills")
475.         dive = Book.objects.using('other').get(title="Dive into Python")
476. 
477.         # Retrieve related object by descriptor. Related objects should be database-bound
478.         self.assertEqual(list(chris.edited.values_list('title', flat=True)), ['Dive into Python'])
479. 
480.     def test_foreign_key_reverse_operations(self):
481.         "FK reverse manipulations are all constrained to a single DB"
482.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
483.         chris = Person.objects.using('other').create(name="Chris Mills")
484. 
485.         # Save the author relations
486.         dive.editor = chris
487.         dive.save()
488. 
489.         # Add a second book edited by chris
490.         html5 = Book.objects.using('other').create(title="Dive into HTML5", published=datetime.date(2010, 3, 15))
491.         self.assertEqual(
492.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
493.             []
494.         )
495. 
496.         chris.edited.add(html5)
497.         self.assertEqual(
498.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
499.             ['Chris Mills']
500.         )
501.         self.assertEqual(
502.             list(
503.                 Person.objects.using('other').filter(edited__title='Dive into Python').values_list('name', flat=True)
504.             ),
505.             ['Chris Mills']
506.         )
507. 
508.         # Remove the second editor
509.         chris.edited.remove(html5)
510.         self.assertEqual(
511.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
512.             []
513.         )
514.         self.assertEqual(
515.             list(
516.                 Person.objects.using('other').filter(edited__title='Dive into Python').values_list('name', flat=True)
517.             ),
518.             ['Chris Mills']
519.         )
520. 
521.         # Clear all edited books
522.         chris.edited.clear()
523.         self.assertEqual(
524.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
525.             []
526.         )
527.         self.assertEqual(
528.             list(
529.                 Person.objects.using('other').filter(edited__title='Dive into Python').values_list('name', flat=True)
530.             ),
531.             []
532.         )
533. 
534.         # Create an author through the m2m interface
535.         chris.edited.create(title='Dive into Water', published=datetime.date(2010, 3, 15))
536.         self.assertEqual(
537.             list(Person.objects.using('other').filter(edited__title='Dive into HTML5').values_list('name', flat=True)),
538.             []
539.         )
540.         self.assertEqual(
541.             list(Person.objects.using('other').filter(edited__title='Dive into Water').values_list('name', flat=True)),
542.             ['Chris Mills']
543.         )
544.         self.assertEqual(
545.             list(
546.                 Person.objects.using('other').filter(edited__title='Dive into Python').values_list('name', flat=True)
547.             ),
548.             []
549.         )
550. 
551.     def test_foreign_key_cross_database_protection(self):
552.         "Operations that involve sharing FK objects across databases raise an error"
553.         # Create a book and author on the default database
554.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
555.         marty = Person.objects.create(name="Marty Alchin")
556. 
557.         # Create a book and author on the other database
558.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
559. 
560.         # Set a foreign key with an object from a different database
561.         msg = (
562.             'Cannot assign "<Person: Marty Alchin>": the current database '
563.             'router prevents this relation.'
564.         )
565.         with self.assertRaisesMessage(ValueError, msg):
566.             dive.editor = marty
567. 
568.         # Set a foreign key set with an object from a different database
569.         with self.assertRaisesMessage(ValueError, msg):
570.             with transaction.atomic(using='default'):
571.                 marty.edited.set([pro, dive])
572. 
573.         # Add to a foreign key set with an object from a different database
574.         with self.assertRaisesMessage(ValueError, msg):
575.             with transaction.atomic(using='default'):
576.                 marty.edited.add(dive)
577. 
578.     def test_foreign_key_deletion(self):
579.         "Cascaded deletions of Foreign Key relations issue queries on the right database"
580.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
581.         Pet.objects.using('other').create(name="Fido", owner=mark)
582. 
583.         # Check the initial state
584.         self.assertEqual(Person.objects.using('default').count(), 0)
585.         self.assertEqual(Pet.objects.using('default').count(), 0)
586. 
587.         self.assertEqual(Person.objects.using('other').count(), 1)
588.         self.assertEqual(Pet.objects.using('other').count(), 1)
589. 
590.         # Delete the person object, which will cascade onto the pet
591.         mark.delete(using='other')
592. 
593.         self.assertEqual(Person.objects.using('default').count(), 0)
594.         self.assertEqual(Pet.objects.using('default').count(), 0)
595. 
596.         # Both the pet and the person have been deleted from the right database
597.         self.assertEqual(Person.objects.using('other').count(), 0)
598.         self.assertEqual(Pet.objects.using('other').count(), 0)
599. 
600.     def test_foreign_key_validation(self):
601.         "ForeignKey.validate() uses the correct database"
602.         mickey = Person.objects.using('other').create(name="Mickey")
603.         pluto = Pet.objects.using('other').create(name="Pluto", owner=mickey)
604.         self.assertIsNone(pluto.full_clean())
605. 
606.     # Any router that accesses `model` in db_for_read() works here.
607.     @override_settings(DATABASE_ROUTERS=[AuthRouter()])
608.     def test_foreign_key_validation_with_router(self):
609.         """
610.         ForeignKey.validate() passes `model` to db_for_read() even if
611.         model_instance=None.
612.         """
613.         mickey = Person.objects.create(name="Mickey")
614.         owner_field = Pet._meta.get_field('owner')
615.         self.assertEqual(owner_field.clean(mickey.pk, None), mickey.pk)
616. 
617.     def test_o2o_separation(self):
618.         "OneToOne fields are constrained to a single database"
619.         # Create a user and profile on the default database
620.         alice = User.objects.db_manager('default').create_user('alice', 'alice@example.com')
621.         alice_profile = UserProfile.objects.using('default').create(user=alice, flavor='chocolate')
622. 
623.         # Create a user and profile on the other database
624.         bob = User.objects.db_manager('other').create_user('bob', 'bob@example.com')
625.         bob_profile = UserProfile.objects.using('other').create(user=bob, flavor='crunchy frog')
626. 
627.         # Retrieve related objects; queries should be database constrained
628.         alice = User.objects.using('default').get(username="alice")
629.         self.assertEqual(alice.userprofile.flavor, "chocolate")
630. 
631.         bob = User.objects.using('other').get(username="bob")
632.         self.assertEqual(bob.userprofile.flavor, "crunchy frog")
633. 
634.         # Queries work across joins
635.         self.assertEqual(
636.             list(
637.                 User.objects.using('default')
638.                 .filter(userprofile__flavor='chocolate').values_list('username', flat=True)
639.             ),
640.             ['alice']
641.         )
642.         self.assertEqual(
643.             list(
644.                 User.objects.using('other')
645.                 .filter(userprofile__flavor='chocolate').values_list('username', flat=True)
646.             ),
647.             []
648.         )
649. 
650.         self.assertEqual(
651.             list(
652.                 User.objects.using('default')
653.                 .filter(userprofile__flavor='crunchy frog').values_list('username', flat=True)
654.             ),
655.             []
656.         )
657.         self.assertEqual(
658.             list(
659.                 User.objects.using('other')
660.                 .filter(userprofile__flavor='crunchy frog').values_list('username', flat=True)
661.             ),
662.             ['bob']
663.         )
664. 
665.         # Reget the objects to clear caches
666.         alice_profile = UserProfile.objects.using('default').get(flavor='chocolate')
667.         bob_profile = UserProfile.objects.using('other').get(flavor='crunchy frog')
668. 
669.         # Retrieve related object by descriptor. Related objects should be database-bound
670.         self.assertEqual(alice_profile.user.username, 'alice')
671.         self.assertEqual(bob_profile.user.username, 'bob')
672. 
673.     def test_o2o_cross_database_protection(self):
674.         "Operations that involve sharing FK objects across databases raise an error"
675.         # Create a user and profile on the default database
676.         alice = User.objects.db_manager('default').create_user('alice', 'alice@example.com')
677. 
678.         # Create a user and profile on the other database
679.         bob = User.objects.db_manager('other').create_user('bob', 'bob@example.com')
680. 
681.         # Set a one-to-one relation with an object from a different database
682.         alice_profile = UserProfile.objects.using('default').create(user=alice, flavor='chocolate')
683.         msg = (
684.             'Cannot assign "%r": the current database router prevents this '
685.             'relation.' % alice_profile
686.         )
687.         with self.assertRaisesMessage(ValueError, msg):
688.             bob.userprofile = alice_profile
689. 
690.         # BUT! if you assign a FK object when the base object hasn't
691.         # been saved yet, you implicitly assign the database for the
692.         # base object.
693.         bob_profile = UserProfile.objects.using('other').create(user=bob, flavor='crunchy frog')
694. 
695.         new_bob_profile = UserProfile(flavor="spring surprise")
696. 
697.         # assigning a profile requires an explicit pk as the object isn't saved
698.         charlie = User(pk=51, username='charlie', email='charlie@example.com')
699.         charlie.set_unusable_password()
700. 
701.         # initially, no db assigned
702.         self.assertIsNone(new_bob_profile._state.db)
703.         self.assertIsNone(charlie._state.db)
704. 
705.         # old object comes from 'other', so the new object is set to use 'other'...
706.         new_bob_profile.user = bob
707.         charlie.userprofile = bob_profile
708.         self.assertEqual(new_bob_profile._state.db, 'other')
709.         self.assertEqual(charlie._state.db, 'other')
710. 
711.         # ... but it isn't saved yet
712.         self.assertEqual(list(User.objects.using('other').values_list('username', flat=True)), ['bob'])
713.         self.assertEqual(list(UserProfile.objects.using('other').values_list('flavor', flat=True)), ['crunchy frog'])
714. 
715.         # When saved (no using required), new objects goes to 'other'
716.         charlie.save()
717.         bob_profile.save()
718.         new_bob_profile.save()
719.         self.assertEqual(list(User.objects.using('default').values_list('username', flat=True)), ['alice'])
720.         self.assertEqual(list(User.objects.using('other').values_list('username', flat=True)), ['bob', 'charlie'])
721.         self.assertEqual(list(UserProfile.objects.using('default').values_list('flavor', flat=True)), ['chocolate'])
722.         self.assertEqual(
723.             list(UserProfile.objects.using('other').values_list('flavor', flat=True)),
724.             ['crunchy frog', 'spring surprise']
725.         )
726. 
727.         # This also works if you assign the O2O relation in the constructor
728.         denise = User.objects.db_manager('other').create_user('denise', 'denise@example.com')
729.         denise_profile = UserProfile(flavor="tofu", user=denise)
730. 
731.         self.assertEqual(denise_profile._state.db, 'other')
732.         # ... but it isn't saved yet
733.         self.assertEqual(list(UserProfile.objects.using('default').values_list('flavor', flat=True)), ['chocolate'])
734.         self.assertEqual(
735.             list(UserProfile.objects.using('other').values_list('flavor', flat=True)),
736.             ['crunchy frog', 'spring surprise']
737.         )
738. 
739.         # When saved, the new profile goes to 'other'
740.         denise_profile.save()
741.         self.assertEqual(list(UserProfile.objects.using('default').values_list('flavor', flat=True)), ['chocolate'])
742.         self.assertEqual(
743.             list(UserProfile.objects.using('other').values_list('flavor', flat=True)),
744.             ['crunchy frog', 'spring surprise', 'tofu']
745.         )
746. 
747.     def test_generic_key_separation(self):
748.         "Generic fields are constrained to a single database"
749.         # Create a book and author on the default database
750.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
751.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)
752. 
753.         # Create a book and author on the other database
754.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
755. 
756.         review2 = Review.objects.using('other').create(source="Python Weekly", content_object=dive)
757. 
758.         review1 = Review.objects.using('default').get(source="Python Monthly")
759.         self.assertEqual(review1.content_object.title, "Pro Django")
760. 
761.         review2 = Review.objects.using('other').get(source="Python Weekly")
762.         self.assertEqual(review2.content_object.title, "Dive into Python")
763. 
764.         # Reget the objects to clear caches
765.         dive = Book.objects.using('other').get(title="Dive into Python")
766. 
767.         # Retrieve related object by descriptor. Related objects should be database-bound
768.         self.assertEqual(list(dive.reviews.all().values_list('source', flat=True)), ['Python Weekly'])
769. 
770.     def test_generic_key_reverse_operations(self):
771.         "Generic reverse manipulations are all constrained to a single DB"
772.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
773.         temp = Book.objects.using('other').create(title="Temp", published=datetime.date(2009, 5, 4))
774.         review1 = Review.objects.using('other').create(source="Python Weekly", content_object=dive)
775.         review2 = Review.objects.using('other').create(source="Python Monthly", content_object=temp)
776. 
777.         self.assertEqual(
778.             list(Review.objects.using('default').filter(object_id=dive.pk).values_list('source', flat=True)),
779.             []
780.         )
781.         self.assertEqual(
782.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
783.             ['Python Weekly']
784.         )
785. 
786.         # Add a second review
787.         dive.reviews.add(review2)
788.         self.assertEqual(
789.             list(Review.objects.using('default').filter(object_id=dive.pk).values_list('source', flat=True)),
790.             []
791.         )
792.         self.assertEqual(
793.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
794.             ['Python Monthly', 'Python Weekly']
795.         )
796. 
797.         # Remove the second author
798.         dive.reviews.remove(review1)
799.         self.assertEqual(
800.             list(Review.objects.using('default').filter(object_id=dive.pk).values_list('source', flat=True)),
801.             []
802.         )
803.         self.assertEqual(
804.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
805.             ['Python Monthly']
806.         )
807. 
808.         # Clear all reviews
809.         dive.reviews.clear()
810.         self.assertEqual(
811.             list(Review.objects.using('default').filter(object_id=dive.pk).values_list('source', flat=True)),
812.             []
813.         )
814.         self.assertEqual(
815.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
816.             []
817.         )
818. 
819.         # Create an author through the generic interface
820.         dive.reviews.create(source='Python Daily')
821.         self.assertEqual(
822.             list(Review.objects.using('default').filter(object_id=dive.pk).values_list('source', flat=True)),
823.             []
824.         )
825.         self.assertEqual(
826.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
827.             ['Python Daily']
828.         )
829. 
830.     def test_generic_key_cross_database_protection(self):
831.         "Operations that involve sharing generic key objects across databases raise an error"
832.         # Create a book and author on the default database
833.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
834.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)
835. 
836.         # Create a book and author on the other database
837.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
838. 
839.         Review.objects.using('other').create(source="Python Weekly", content_object=dive)
840. 
841.         # Set a foreign key with an object from a different database
842.         msg = (
843.             'Cannot assign "<ContentType: multiple_database | book>": the '
844.             'current database router prevents this relation.'
845.         )
846.         with self.assertRaisesMessage(ValueError, msg):
847.             review1.content_object = dive
848. 
849.         # Add to a foreign key set with an object from a different database
850.         msg = (
851.             "<Review: Python Monthly> instance isn't saved. "
852.             "Use bulk=False or save the object first."
853.         )
854.         with self.assertRaisesMessage(ValueError, msg):
855.             with transaction.atomic(using='other'):
856.                 dive.reviews.add(review1)
857. 
858.         # BUT! if you assign a FK object when the base object hasn't
859.         # been saved yet, you implicitly assign the database for the
860.         # base object.
861.         review3 = Review(source="Python Daily")
862.         # initially, no db assigned
863.         self.assertIsNone(review3._state.db)
864. 
865.         # Dive comes from 'other', so review3 is set to use 'other'...
866.         review3.content_object = dive
867.         self.assertEqual(review3._state.db, 'other')
868.         # ... but it isn't saved yet
869.         self.assertEqual(
870.             list(Review.objects.using('default').filter(object_id=pro.pk).values_list('source', flat=True)),
871.             ['Python Monthly']
872.         )
873.         self.assertEqual(
874.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
875.             ['Python Weekly']
876.         )
877. 
878.         # When saved, John goes to 'other'
879.         review3.save()
880.         self.assertEqual(
881.             list(Review.objects.using('default').filter(object_id=pro.pk).values_list('source', flat=True)),
882.             ['Python Monthly']
883.         )
884.         self.assertEqual(
885.             list(Review.objects.using('other').filter(object_id=dive.pk).values_list('source', flat=True)),
886.             ['Python Daily', 'Python Weekly']
887.         )
888. 
889.     def test_generic_key_deletion(self):
890.         "Cascaded deletions of Generic Key relations issue queries on the right database"
891.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
892.         Review.objects.using('other').create(source="Python Weekly", content_object=dive)
893. 
894.         # Check the initial state
895.         self.assertEqual(Book.objects.using('default').count(), 0)
896.         self.assertEqual(Review.objects.using('default').count(), 0)
897. 
898.         self.assertEqual(Book.objects.using('other').count(), 1)
899.         self.assertEqual(Review.objects.using('other').count(), 1)
900. 
901.         # Delete the Book object, which will cascade onto the pet
902.         dive.delete(using='other')
903. 
904.         self.assertEqual(Book.objects.using('default').count(), 0)
905.         self.assertEqual(Review.objects.using('default').count(), 0)
906. 
907.         # Both the pet and the person have been deleted from the right database
908.         self.assertEqual(Book.objects.using('other').count(), 0)
909.         self.assertEqual(Review.objects.using('other').count(), 0)
910. 
911.     def test_ordering(self):
912.         "get_next_by_XXX commands stick to a single database"
913.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))
914.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
915.         learn = Book.objects.using('other').create(title="Learning Python", published=datetime.date(2008, 7, 16))
916. 
917.         self.assertEqual(learn.get_next_by_published().title, "Dive into Python")
918.         self.assertEqual(dive.get_previous_by_published().title, "Learning Python")
919. 
920.     def test_raw(self):
921.         "test the raw() method across databases"
922.         dive = Book.objects.using('other').create(title="Dive into Python", published=datetime.date(2009, 5, 4))
923.         val = Book.objects.db_manager("other").raw('SELECT id FROM multiple_database_book')
924.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))
925. 
926.         val = Book.objects.raw('SELECT id FROM multiple_database_book').using('other')
927.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))
928. 
929.     def test_select_related(self):
930.         "Database assignment is retained if an object is retrieved with select_related()"
931.         # Create a book and author on the other database
932.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
933.         Book.objects.using('other').create(
934.             title="Dive into Python",
935.             published=datetime.date(2009, 5, 4),
936.             editor=mark,
937.         )
938. 
939.         # Retrieve the Person using select_related()
940.         book = Book.objects.using('other').select_related('editor').get(title="Dive into Python")
941. 
942.         # The editor instance should have a db state
943.         self.assertEqual(book.editor._state.db, 'other')
944. 
945.     def test_subquery(self):
946.         """Make sure as_sql works with subqueries and primary/replica."""
947.         sub = Person.objects.using('other').filter(name='fff')
948.         qs = Book.objects.filter(editor__in=sub)
949. 
950.         # When you call __str__ on the query object, it doesn't know about using
951.         # so it falls back to the default. If the subquery explicitly uses a
952.         # different database, an error should be raised.
953.         msg = (
954.             "Subqueries aren't allowed across different databases. Force the "
955.             "inner query to be evaluated using `list(inner_query)`."
956.         )
957.         with self.assertRaisesMessage(ValueError, msg):
958.             str(qs.query)
959. 
960.         # Evaluating the query shouldn't work, either
961.         with self.assertRaisesMessage(ValueError, msg):
962.             for obj in qs:
963.                 pass
964. 
965.     def test_related_manager(self):
966.         "Related managers return managers, not querysets"
967.         mark = Person.objects.using('other').create(name="Mark Pilgrim")
968. 
969.         # extra_arg is removed by the BookManager's implementation of
970.         # create(); but the BookManager's implementation won't get called
971.         # unless edited returns a Manager, not a queryset
972.         mark.book_set.create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)
973.         mark.book_set.get_or_create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)
974.         mark.edited.create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)
975.         mark.edited.get_or_create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)
976. 
977. 
978. class ConnectionRouterTestCase(SimpleTestCase):
979.     @override_settings(DATABASE_ROUTERS=[
980.         'multiple_database.tests.TestRouter',
981.         'multiple_database.tests.WriteRouter'])
982.     def test_router_init_default(self):
983.         connection_router = ConnectionRouter()
984.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], ['TestRouter', 'WriteRouter'])
985. 
986.     def test_router_init_arg(self):
987.         connection_router = ConnectionRouter([
988.             'multiple_database.tests.TestRouter',
989.             'multiple_database.tests.WriteRouter'
990.         ])
991.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], ['TestRouter', 'WriteRouter'])
992. 
993.         # Init with instances instead of strings
994.         connection_router = ConnectionRouter([TestRouter(), WriteRouter()])
995.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], ['TestRouter', 'WriteRouter'])
996. 
997. 
998. # Make the 'other' database appear to be a replica of the 'default'
999. @override_settings(DATABASE_ROUTERS=[TestRouter()])
1000. class RouterTestCase(TestCase):

File: tests/migrations/test_commands.py
Line number range: 1 - 1000
Content:
1. import datetime
2. import importlib
3. import io
4. import os
5. import sys
6. from unittest import mock
7. 
8. from django.apps import apps
9. from django.core.management import CommandError, call_command
10. from django.db import (
11.     ConnectionHandler, DatabaseError, connection, connections, models,
12. )
13. from django.db.backends.base.schema import BaseDatabaseSchemaEditor
14. from django.db.backends.utils import truncate_name
15. from django.db.migrations.exceptions import InconsistentMigrationHistory
16. from django.db.migrations.recorder import MigrationRecorder
17. from django.test import TestCase, override_settings, skipUnlessDBFeature
18. 
19. from .models import UnicodeModel, UnserializableModel
20. from .routers import TestRouter
21. from .test_base import MigrationTestBase
22. 
23. 
24. class MigrateTests(MigrationTestBase):
25.     """
26.     Tests running the migrate command.
27.     """
28.     databases = {'default', 'other'}
29. 
30.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
31.     def test_migrate(self):
32.         """
33.         Tests basic usage of the migrate command.
34.         """
35.         # No tables are created
36.         self.assertTableNotExists("migrations_author")
37.         self.assertTableNotExists("migrations_tribble")
38.         self.assertTableNotExists("migrations_book")
39.         # Run the migrations to 0001 only
40.         stdout = io.StringIO()
41.         call_command('migrate', 'migrations', '0001', verbosity=1, stdout=stdout, no_color=True)
42.         stdout = stdout.getvalue()
43.         self.assertIn('Target specific migration: 0001_initial, from migrations', stdout)
44.         self.assertIn('Applying migrations.0001_initial... OK', stdout)
45.         # The correct tables exist
46.         self.assertTableExists("migrations_author")
47.         self.assertTableExists("migrations_tribble")
48.         self.assertTableNotExists("migrations_book")
49.         # Run migrations all the way
50.         call_command("migrate", verbosity=0)
51.         # The correct tables exist
52.         self.assertTableExists("migrations_author")
53.         self.assertTableNotExists("migrations_tribble")
54.         self.assertTableExists("migrations_book")
55.         # Unmigrate everything
56.         stdout = io.StringIO()
57.         call_command('migrate', 'migrations', 'zero', verbosity=1, stdout=stdout, no_color=True)
58.         stdout = stdout.getvalue()
59.         self.assertIn('Unapply all migrations: migrations', stdout)
60.         self.assertIn('Unapplying migrations.0002_second... OK', stdout)
61.         # Tables are gone
62.         self.assertTableNotExists("migrations_author")
63.         self.assertTableNotExists("migrations_tribble")
64.         self.assertTableNotExists("migrations_book")
65. 
66.     @override_settings(INSTALLED_APPS=[
67.         'django.contrib.auth',
68.         'django.contrib.contenttypes',
69.         'migrations.migrations_test_apps.migrated_app',
70.     ])
71.     def test_migrate_with_system_checks(self):
72.         out = io.StringIO()
73.         call_command('migrate', skip_checks=False, no_color=True, stdout=out)
74.         self.assertIn('Apply all migrations: migrated_app', out.getvalue())
75. 
76.     @override_settings(INSTALLED_APPS=['migrations', 'migrations.migrations_test_apps.unmigrated_app_syncdb'])
77.     def test_app_without_migrations(self):
78.         msg = "App 'unmigrated_app_syncdb' does not have migrations."
79.         with self.assertRaisesMessage(CommandError, msg):
80.             call_command('migrate', app_label='unmigrated_app_syncdb')
81. 
82.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_clashing_prefix'})
83.     def test_ambiguous_prefix(self):
84.         msg = (
85.             "More than one migration matches 'a' in app 'migrations'. Please "
86.             "be more specific."
87.         )
88.         with self.assertRaisesMessage(CommandError, msg):
89.             call_command('migrate', app_label='migrations', migration_name='a')
90. 
91.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations'})
92.     def test_unknown_prefix(self):
93.         msg = "Cannot find a migration matching 'nonexistent' from app 'migrations'."
94.         with self.assertRaisesMessage(CommandError, msg):
95.             call_command('migrate', app_label='migrations', migration_name='nonexistent')
96. 
97.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})
98.     def test_migrate_initial_false(self):
99.         """
100.         `Migration.initial = False` skips fake-initial detection.
101.         """
102.         # Make sure no tables are created
103.         self.assertTableNotExists("migrations_author")
104.         self.assertTableNotExists("migrations_tribble")
105.         # Run the migrations to 0001 only
106.         call_command("migrate", "migrations", "0001", verbosity=0)
107.         # Fake rollback
108.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
109.         # Make sure fake-initial detection does not run
110.         with self.assertRaises(DatabaseError):
111.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)
112. 
113.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)
114.         # Real rollback
115.         call_command("migrate", "migrations", "zero", verbosity=0)
116.         # Make sure it's all gone
117.         self.assertTableNotExists("migrations_author")
118.         self.assertTableNotExists("migrations_tribble")
119.         self.assertTableNotExists("migrations_book")
120. 
121.     @override_settings(
122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},
123.         DATABASE_ROUTERS=['migrations.routers.TestRouter'],
124.     )
125.     def test_migrate_fake_initial(self):
126.         """
127.         --fake-initial only works if all tables created in the initial
128.         migration of an app exists. Database routers must be obeyed when doing
129.         that check.
130.         """
131.         # Make sure no tables are created
132.         for db in self.databases:
133.             self.assertTableNotExists("migrations_author", using=db)
134.             self.assertTableNotExists("migrations_tribble", using=db)
135.         # Run the migrations to 0001 only
136.         call_command("migrate", "migrations", "0001", verbosity=0)
137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")
138.         # Make sure the right tables exist
139.         self.assertTableExists("migrations_author")
140.         self.assertTableNotExists("migrations_tribble")
141.         # Also check the "other" database
142.         self.assertTableNotExists("migrations_author", using="other")
143.         self.assertTableExists("migrations_tribble", using="other")
144. 
145.         # Fake a roll-back
146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
148.         # Make sure the tables still exist
149.         self.assertTableExists("migrations_author")
150.         self.assertTableExists("migrations_tribble", using="other")
151.         # Try to run initial migration
152.         with self.assertRaises(DatabaseError):
153.             call_command("migrate", "migrations", "0001", verbosity=0)
154.         # Run initial migration with an explicit --fake-initial
155.         out = io.StringIO()
156.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)
158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")
159.         self.assertIn(
160.             "migrations.0001_initial... faked",
161.             out.getvalue().lower()
162.         )
163.         # Run migrations all the way
164.         call_command("migrate", verbosity=0)
165.         call_command("migrate", verbosity=0, database="other")
166.         # Make sure the right tables exist
167.         self.assertTableExists("migrations_author")
168.         self.assertTableNotExists("migrations_tribble")
169.         self.assertTableExists("migrations_book")
170.         self.assertTableNotExists("migrations_author", using="other")
171.         self.assertTableNotExists("migrations_tribble", using="other")
172.         self.assertTableNotExists("migrations_book", using="other")
173.         # Fake a roll-back
174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")
176.         # Make sure the tables still exist
177.         self.assertTableExists("migrations_author")
178.         self.assertTableNotExists("migrations_tribble")
179.         self.assertTableExists("migrations_book")
180.         # Try to run initial migration
181.         with self.assertRaises(DatabaseError):
182.             call_command("migrate", "migrations", verbosity=0)
183.         # Run initial migration with an explicit --fake-initial
184.         with self.assertRaises(DatabaseError):
185.             # Fails because "migrations_tribble" does not exist but needs to in
186.             # order to make --fake-initial work.
187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)
188.         # Fake an apply
189.         call_command("migrate", "migrations", fake=True, verbosity=0)
190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")
191.         # Unmigrate everything
192.         call_command("migrate", "migrations", "zero", verbosity=0)
193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")
194.         # Make sure it's all gone
195.         for db in self.databases:
196.             self.assertTableNotExists("migrations_author", using=db)
197.             self.assertTableNotExists("migrations_tribble", using=db)
198.             self.assertTableNotExists("migrations_book", using=db)
199. 
200.     @skipUnlessDBFeature('ignores_table_name_case')
201.     def test_migrate_fake_initial_case_insensitive(self):
202.         with override_settings(MIGRATION_MODULES={
203.             'migrations': 'migrations.test_fake_initial_case_insensitive.initial',
204.         }):
205.             call_command('migrate', 'migrations', '0001', verbosity=0)
206.             call_command('migrate', 'migrations', 'zero', fake=True, verbosity=0)
207. 
208.         with override_settings(MIGRATION_MODULES={
209.             'migrations': 'migrations.test_fake_initial_case_insensitive.fake_initial',
210.         }):
211.             out = io.StringIO()
212.             call_command(
213.                 'migrate',
214.                 'migrations',
215.                 '0001',
216.                 fake_initial=True,
217.                 stdout=out,
218.                 verbosity=1,
219.                 no_color=True,
220.             )
221.             self.assertIn(
222.                 'migrations.0001_initial... faked',
223.                 out.getvalue().lower(),
224.             )
225. 
226.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})
227.     def test_migrate_fake_split_initial(self):
228.         """
229.         Split initial migrations can be faked with --fake-initial.
230.         """
231.         call_command("migrate", "migrations", "0002", verbosity=0)
232.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)
233.         out = io.StringIO()
234.         with mock.patch('django.core.management.color.supports_color', lambda *args: False):
235.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)
236.         value = out.getvalue().lower()
237.         self.assertIn("migrations.0001_initial... faked", value)
238.         self.assertIn("migrations.0002_second... faked", value)
239.         # Fake an apply
240.         call_command("migrate", "migrations", fake=True, verbosity=0)
241.         # Unmigrate everything
242.         call_command("migrate", "migrations", "zero", verbosity=0)
243. 
244.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})
245.     def test_migrate_conflict_exit(self):
246.         """
247.         migrate exits if it detects a conflict.
248.         """
249.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):
250.             call_command("migrate", "migrations")
251. 
252.     @override_settings(MIGRATION_MODULES={
253.         'migrations': 'migrations.test_migrations',
254.     })
255.     def test_migrate_check(self):
256.         with self.assertRaises(SystemExit):
257.             call_command('migrate', 'migrations', '0001', check_unapplied=True, verbosity=0)
258.         self.assertTableNotExists('migrations_author')
259.         self.assertTableNotExists('migrations_tribble')
260.         self.assertTableNotExists('migrations_book')
261. 
262.     @override_settings(MIGRATION_MODULES={
263.         'migrations': 'migrations.test_migrations_plan',
264.     })
265.     def test_migrate_check_plan(self):
266.         out = io.StringIO()
267.         with self.assertRaises(SystemExit):
268.             call_command(
269.                 'migrate',
270.                 'migrations',
271.                 '0001',
272.                 check_unapplied=True,
273.                 plan=True,
274.                 stdout=out,
275.                 no_color=True,
276.             )
277.         self.assertEqual(
278.             'Planned operations:\n'
279.             'migrations.0001_initial\n'
280.             '    Create model Salamander\n'
281.             '    Raw Python operation -> Grow salamander tail.\n',
282.             out.getvalue(),
283.         )
284. 
285.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
286.     def test_showmigrations_list(self):
287.         """
288.         showmigrations --list  displays migrations and whether or not they're
289.         applied.
290.         """
291.         out = io.StringIO()
292.         with mock.patch('django.core.management.color.supports_color', lambda *args: True):
293.             call_command("showmigrations", format='list', stdout=out, verbosity=0, no_color=False)
294.         self.assertEqual(
295.             '\x1b[1mmigrations\n\x1b[0m'
296.             ' [ ] 0001_initial\n'
297.             ' [ ] 0002_second\n',
298.             out.getvalue().lower()
299.         )
300. 
301.         call_command("migrate", "migrations", "0001", verbosity=0)
302. 
303.         out = io.StringIO()
304.         # Giving the explicit app_label tests for selective `show_list` in the command
305.         call_command("showmigrations", "migrations", format='list', stdout=out, verbosity=0, no_color=True)
306.         self.assertEqual(
307.             'migrations\n'
308.             ' [x] 0001_initial\n'
309.             ' [ ] 0002_second\n',
310.             out.getvalue().lower()
311.         )
312.         out = io.StringIO()
313.         # Applied datetimes are displayed at verbosity 2+.
314.         call_command('showmigrations', 'migrations', stdout=out, verbosity=2, no_color=True)
315.         migration1 = MigrationRecorder(connection).migration_qs.get(app='migrations', name='0001_initial')
316.         self.assertEqual(
317.             'migrations\n'
318.             ' [x] 0001_initial (applied at %s)\n'
319.             ' [ ] 0002_second\n' % migration1.applied.strftime('%Y-%m-%d %H:%M:%S'),
320.             out.getvalue().lower()
321.         )
322.         # Cleanup by unmigrating everything
323.         call_command("migrate", "migrations", "zero", verbosity=0)
324. 
325.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})
326.     def test_showmigrations_plan(self):
327.         """
328.         Tests --plan output of showmigrations command
329.         """
330.         out = io.StringIO()
331.         call_command("showmigrations", format='plan', stdout=out)
332.         self.assertEqual(
333.             "[ ]  migrations.0001_initial\n"
334.             "[ ]  migrations.0003_third\n"
335.             "[ ]  migrations.0002_second\n",
336.             out.getvalue().lower()
337.         )
338. 
339.         out = io.StringIO()
340.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
341.         self.assertEqual(
342.             "[ ]  migrations.0001_initial\n"
343.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\n"
344.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
345.             out.getvalue().lower()
346.         )
347.         call_command("migrate", "migrations", "0003", verbosity=0)
348. 
349.         out = io.StringIO()
350.         call_command("showmigrations", format='plan', stdout=out)
351.         self.assertEqual(
352.             "[x]  migrations.0001_initial\n"
353.             "[x]  migrations.0003_third\n"
354.             "[ ]  migrations.0002_second\n",
355.             out.getvalue().lower()
356.         )
357. 
358.         out = io.StringIO()
359.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
360.         self.assertEqual(
361.             "[x]  migrations.0001_initial\n"
362.             "[x]  migrations.0003_third ... (migrations.0001_initial)\n"
363.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\n",
364.             out.getvalue().lower()
365.         )
366. 
367.         # Cleanup by unmigrating everything
368.         call_command("migrate", "migrations", "zero", verbosity=0)
369. 
370.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_plan'})
371.     def test_migrate_plan(self):
372.         """Tests migrate --plan output."""
373.         out = io.StringIO()
374.         # Show the plan up to the third migration.
375.         call_command('migrate', 'migrations', '0003', plan=True, stdout=out, no_color=True)
376.         self.assertEqual(
377.             'Planned operations:\n'
378.             'migrations.0001_initial\n'
379.             '    Create model Salamander\n'
380.             '    Raw Python operation -> Grow salamander tail.\n'
381.             'migrations.0002_second\n'
382.             '    Create model Book\n'
383.             "    Raw SQL operation -> ['SELECT * FROM migrations_book']\n"
384.             'migrations.0003_third\n'
385.             '    Create model Author\n'
386.             "    Raw SQL operation -> ['SELECT * FROM migrations_author']\n",
387.             out.getvalue()
388.         )
389.         try:
390.             # Migrate to the third migration.
391.             call_command('migrate', 'migrations', '0003', verbosity=0)
392.             out = io.StringIO()
393.             # Show the plan for when there is nothing to apply.
394.             call_command('migrate', 'migrations', '0003', plan=True, stdout=out, no_color=True)
395.             self.assertEqual(
396.                 'Planned operations:\n'
397.                 '  No planned migration operations.\n',
398.                 out.getvalue()
399.             )
400.             out = io.StringIO()
401.             # Show the plan for reverse migration back to 0001.
402.             call_command('migrate', 'migrations', '0001', plan=True, stdout=out, no_color=True)
403.             self.assertEqual(
404.                 'Planned operations:\n'
405.                 'migrations.0003_third\n'
406.                 '    Undo Create model Author\n'
407.                 "    Raw SQL operation -> ['SELECT * FROM migrations_book']\n"
408.                 'migrations.0002_second\n'
409.                 '    Undo Create model Book\n'
410.                 "    Raw SQL operation -> ['SELECT * FROM migrations_salamand…\n",
411.                 out.getvalue()
412.             )
413.             out = io.StringIO()
414.             # Show the migration plan to fourth, with truncated details.
415.             call_command('migrate', 'migrations', '0004', plan=True, stdout=out, no_color=True)
416.             self.assertEqual(
417.                 'Planned operations:\n'
418.                 'migrations.0004_fourth\n'
419.                 '    Raw SQL operation -> SELECT * FROM migrations_author WHE…\n',
420.                 out.getvalue()
421.             )
422.             # Show the plan when an operation is irreversible.
423.             # Migrate to the fourth migration.
424.             call_command('migrate', 'migrations', '0004', verbosity=0)
425.             out = io.StringIO()
426.             call_command('migrate', 'migrations', '0003', plan=True, stdout=out, no_color=True)
427.             self.assertEqual(
428.                 'Planned operations:\n'
429.                 'migrations.0004_fourth\n'
430.                 '    Raw SQL operation -> IRREVERSIBLE\n',
431.                 out.getvalue()
432.             )
433.             out = io.StringIO()
434.             call_command('migrate', 'migrations', '0005', plan=True, stdout=out, no_color=True)
435.             # Operation is marked as irreversible only in the revert plan.
436.             self.assertEqual(
437.                 'Planned operations:\n'
438.                 'migrations.0005_fifth\n'
439.                 '    Raw Python operation\n'
440.                 '    Raw Python operation\n'
441.                 '    Raw Python operation -> Feed salamander.\n',
442.                 out.getvalue()
443.             )
444.             call_command('migrate', 'migrations', '0005', verbosity=0)
445.             out = io.StringIO()
446.             call_command('migrate', 'migrations', '0004', plan=True, stdout=out, no_color=True)
447.             self.assertEqual(
448.                 'Planned operations:\n'
449.                 'migrations.0005_fifth\n'
450.                 '    Raw Python operation -> IRREVERSIBLE\n'
451.                 '    Raw Python operation -> IRREVERSIBLE\n'
452.                 '    Raw Python operation\n',
453.                 out.getvalue()
454.             )
455.         finally:
456.             # Cleanup by unmigrating everything: fake the irreversible, then
457.             # migrate all to zero.
458.             call_command('migrate', 'migrations', '0003', fake=True, verbosity=0)
459.             call_command('migrate', 'migrations', 'zero', verbosity=0)
460. 
461.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_empty'})
462.     def test_showmigrations_no_migrations(self):
463.         out = io.StringIO()
464.         call_command('showmigrations', stdout=out, no_color=True)
465.         self.assertEqual('migrations\n (no migrations)\n', out.getvalue().lower())
466. 
467.     @override_settings(INSTALLED_APPS=['migrations.migrations_test_apps.unmigrated_app'])
468.     def test_showmigrations_unmigrated_app(self):
469.         out = io.StringIO()
470.         call_command('showmigrations', 'unmigrated_app', stdout=out, no_color=True)
471.         self.assertEqual('unmigrated_app\n (no migrations)\n', out.getvalue().lower())
472. 
473.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})
474.     def test_showmigrations_plan_no_migrations(self):
475.         """
476.         Tests --plan output of showmigrations command without migrations
477.         """
478.         out = io.StringIO()
479.         call_command('showmigrations', format='plan', stdout=out, no_color=True)
480.         self.assertEqual('(no migrations)\n', out.getvalue().lower())
481. 
482.         out = io.StringIO()
483.         call_command('showmigrations', format='plan', stdout=out, verbosity=2, no_color=True)
484.         self.assertEqual('(no migrations)\n', out.getvalue().lower())
485. 
486.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})
487.     def test_showmigrations_plan_squashed(self):
488.         """
489.         Tests --plan output of showmigrations command with squashed migrations.
490.         """
491.         out = io.StringIO()
492.         call_command("showmigrations", format='plan', stdout=out)
493.         self.assertEqual(
494.             "[ ]  migrations.1_auto\n"
495.             "[ ]  migrations.2_auto\n"
496.             "[ ]  migrations.3_squashed_5\n"
497.             "[ ]  migrations.6_auto\n"
498.             "[ ]  migrations.7_auto\n",
499.             out.getvalue().lower()
500.         )
501. 
502.         out = io.StringIO()
503.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
504.         self.assertEqual(
505.             "[ ]  migrations.1_auto\n"
506.             "[ ]  migrations.2_auto ... (migrations.1_auto)\n"
507.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
508.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
509.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
510.             out.getvalue().lower()
511.         )
512. 
513.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)
514. 
515.         out = io.StringIO()
516.         call_command("showmigrations", format='plan', stdout=out)
517.         self.assertEqual(
518.             "[x]  migrations.1_auto\n"
519.             "[x]  migrations.2_auto\n"
520.             "[x]  migrations.3_squashed_5\n"
521.             "[ ]  migrations.6_auto\n"
522.             "[ ]  migrations.7_auto\n",
523.             out.getvalue().lower()
524.         )
525. 
526.         out = io.StringIO()
527.         call_command("showmigrations", format='plan', stdout=out, verbosity=2)
528.         self.assertEqual(
529.             "[x]  migrations.1_auto\n"
530.             "[x]  migrations.2_auto ... (migrations.1_auto)\n"
531.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\n"
532.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\n"
533.             "[ ]  migrations.7_auto ... (migrations.6_auto)\n",
534.             out.getvalue().lower()
535.         )
536. 
537.     @override_settings(INSTALLED_APPS=[
538.         'migrations.migrations_test_apps.mutate_state_b',
539.         'migrations.migrations_test_apps.alter_fk.author_app',
540.         'migrations.migrations_test_apps.alter_fk.book_app',
541.     ])
542.     def test_showmigrations_plan_single_app_label(self):
543.         """
544.         `showmigrations --plan app_label` output with a single app_label.
545.         """
546.         # Single app with no dependencies on other apps.
547.         out = io.StringIO()
548.         call_command('showmigrations', 'mutate_state_b', format='plan', stdout=out)
549.         self.assertEqual(
550.             '[ ]  mutate_state_b.0001_initial\n'
551.             '[ ]  mutate_state_b.0002_add_field\n',
552.             out.getvalue()
553.         )
554.         # Single app with dependencies.
555.         out = io.StringIO()
556.         call_command('showmigrations', 'author_app', format='plan', stdout=out)
557.         self.assertEqual(
558.             '[ ]  author_app.0001_initial\n'
559.             '[ ]  book_app.0001_initial\n'
560.             '[ ]  author_app.0002_alter_id\n',
561.             out.getvalue()
562.         )
563.         # Some migrations already applied.
564.         call_command('migrate', 'author_app', '0001', verbosity=0)
565.         out = io.StringIO()
566.         call_command('showmigrations', 'author_app', format='plan', stdout=out)
567.         self.assertEqual(
568.             '[X]  author_app.0001_initial\n'
569.             '[ ]  book_app.0001_initial\n'
570.             '[ ]  author_app.0002_alter_id\n',
571.             out.getvalue()
572.         )
573.         # Cleanup by unmigrating author_app.
574.         call_command('migrate', 'author_app', 'zero', verbosity=0)
575. 
576.     @override_settings(INSTALLED_APPS=[
577.         'migrations.migrations_test_apps.mutate_state_b',
578.         'migrations.migrations_test_apps.alter_fk.author_app',
579.         'migrations.migrations_test_apps.alter_fk.book_app',
580.     ])
581.     def test_showmigrations_plan_multiple_app_labels(self):
582.         """
583.         `showmigrations --plan app_label` output with multiple app_labels.
584.         """
585.         # Multiple apps: author_app depends on book_app; mutate_state_b doesn't
586.         # depend on other apps.
587.         out = io.StringIO()
588.         call_command('showmigrations', 'mutate_state_b', 'author_app', format='plan', stdout=out)
589.         self.assertEqual(
590.             '[ ]  author_app.0001_initial\n'
591.             '[ ]  book_app.0001_initial\n'
592.             '[ ]  author_app.0002_alter_id\n'
593.             '[ ]  mutate_state_b.0001_initial\n'
594.             '[ ]  mutate_state_b.0002_add_field\n',
595.             out.getvalue()
596.         )
597.         # Multiple apps: args order shouldn't matter (the same result is
598.         # expected as above).
599.         out = io.StringIO()
600.         call_command('showmigrations', 'author_app', 'mutate_state_b', format='plan', stdout=out)
601.         self.assertEqual(
602.             '[ ]  author_app.0001_initial\n'
603.             '[ ]  book_app.0001_initial\n'
604.             '[ ]  author_app.0002_alter_id\n'
605.             '[ ]  mutate_state_b.0001_initial\n'
606.             '[ ]  mutate_state_b.0002_add_field\n',
607.             out.getvalue()
608.         )
609. 
610.     @override_settings(INSTALLED_APPS=['migrations.migrations_test_apps.unmigrated_app'])
611.     def test_showmigrations_plan_app_label_no_migrations(self):
612.         out = io.StringIO()
613.         call_command('showmigrations', 'unmigrated_app', format='plan', stdout=out, no_color=True)
614.         self.assertEqual('(no migrations)\n', out.getvalue())
615. 
616.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
617.     def test_sqlmigrate_forwards(self):
618.         """
619.         sqlmigrate outputs forward looking SQL.
620.         """
621.         out = io.StringIO()
622.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
623.         output = out.getvalue().lower()
624. 
625.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
626.         index_op_desc_author = output.find('-- create model author')
627.         index_create_table = output.find('create table')
628.         index_op_desc_tribble = output.find('-- create model tribble')
629.         index_op_desc_unique_together = output.find('-- alter unique_together')
630.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
631. 
632.         if connection.features.can_rollback_ddl:
633.             self.assertGreater(index_tx_start, -1, "Transaction start not found")
634.             self.assertGreater(
635.                 index_tx_end, index_op_desc_unique_together,
636.                 "Transaction end not found or found before operation description (unique_together)"
637.             )
638. 
639.         self.assertGreater(
640.             index_op_desc_author, index_tx_start,
641.             "Operation description (author) not found or found before transaction start"
642.         )
643.         self.assertGreater(
644.             index_create_table, index_op_desc_author,
645.             "CREATE TABLE not found or found before operation description (author)"
646.         )
647.         self.assertGreater(
648.             index_op_desc_tribble, index_create_table,
649.             "Operation description (tribble) not found or found before CREATE TABLE (author)"
650.         )
651.         self.assertGreater(
652.             index_op_desc_unique_together, index_op_desc_tribble,
653.             "Operation description (unique_together) not found or found before operation description (tribble)"
654.         )
655. 
656.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})
657.     def test_sqlmigrate_backwards(self):
658.         """
659.         sqlmigrate outputs reverse looking SQL.
660.         """
661.         # Cannot generate the reverse SQL unless we've applied the migration.
662.         call_command("migrate", "migrations", verbosity=0)
663. 
664.         out = io.StringIO()
665.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)
666.         output = out.getvalue().lower()
667. 
668.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())
669.         index_op_desc_unique_together = output.find('-- alter unique_together')
670.         index_op_desc_tribble = output.find('-- create model tribble')
671.         index_op_desc_author = output.find('-- create model author')
672.         index_drop_table = output.rfind('drop table')
673.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())
674. 
675.         if connection.features.can_rollback_ddl:
676.             self.assertGreater(index_tx_start, -1, "Transaction start not found")
677.             self.assertGreater(
678.                 index_tx_end, index_op_desc_unique_together,
679.                 "Transaction end not found or found before DROP TABLE"
680.             )
681.         self.assertGreater(
682.             index_op_desc_unique_together, index_tx_start,
683.             "Operation description (unique_together) not found or found before transaction start"
684.         )
685.         self.assertGreater(
686.             index_op_desc_tribble, index_op_desc_unique_together,
687.             "Operation description (tribble) not found or found before operation description (unique_together)"
688.         )
689.         self.assertGreater(
690.             index_op_desc_author, index_op_desc_tribble,
691.             "Operation description (author) not found or found before operation description (tribble)"
692.         )
693. 
694.         self.assertGreater(
695.             index_drop_table, index_op_desc_author,
696.             "DROP TABLE not found or found before operation description (author)"
697.         )
698. 
699.         # Cleanup by unmigrating everything
700.         call_command("migrate", "migrations", "zero", verbosity=0)
701. 
702.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})
703.     def test_sqlmigrate_for_non_atomic_migration(self):
704.         """
705.         Transaction wrappers aren't shown for non-atomic migrations.
706.         """
707.         out = io.StringIO()
708.         call_command("sqlmigrate", "migrations", "0001", stdout=out)
709.         output = out.getvalue().lower()
710.         queries = [q.strip() for q in output.splitlines()]
711.         if connection.ops.start_transaction_sql():
712.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)
713.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)
714. 
715.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations'})
716.     def test_sqlmigrate_for_non_transactional_databases(self):
717.         """
718.         Transaction wrappers aren't shown for databases that don't support
719.         transactional DDL.
720.         """
721.         out = io.StringIO()
722.         with mock.patch.object(connection.features, 'can_rollback_ddl', False):
723.             call_command('sqlmigrate', 'migrations', '0001', stdout=out)
724.         output = out.getvalue().lower()
725.         queries = [q.strip() for q in output.splitlines()]
726.         start_transaction_sql = connection.ops.start_transaction_sql()
727.         if start_transaction_sql:
728.             self.assertNotIn(start_transaction_sql.lower(), queries)
729.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)
730. 
731.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_squashed'})
732.     def test_sqlmigrate_ambiguous_prefix_squashed_migrations(self):
733.         msg = (
734.             "More than one migration matches '0001' in app 'migrations'. "
735.             "Please be more specific."
736.         )
737.         with self.assertRaisesMessage(CommandError, msg):
738.             call_command('sqlmigrate', 'migrations', '0001')
739. 
740.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_squashed'})
741.     def test_sqlmigrate_squashed_migration(self):
742.         out = io.StringIO()
743.         call_command('sqlmigrate', 'migrations', '0001_squashed_0002', stdout=out)
744.         output = out.getvalue().lower()
745.         self.assertIn('-- create model author', output)
746.         self.assertIn('-- create model book', output)
747.         self.assertNotIn('-- create model tribble', output)
748. 
749.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_squashed'})
750.     def test_sqlmigrate_replaced_migration(self):
751.         out = io.StringIO()
752.         call_command('sqlmigrate', 'migrations', '0001_initial', stdout=out)
753.         output = out.getvalue().lower()
754.         self.assertIn('-- create model author', output)
755.         self.assertIn('-- create model tribble', output)
756. 
757.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations_no_operations'})
758.     def test_migrations_no_operations(self):
759.         err = io.StringIO()
760.         call_command('sqlmigrate', 'migrations', '0001_initial', stderr=err)
761.         self.assertEqual(err.getvalue(), 'No operations found.\n')
762. 
763.     @override_settings(
764.         INSTALLED_APPS=[
765.             "migrations.migrations_test_apps.migrated_app",
766.             "migrations.migrations_test_apps.migrated_unapplied_app",
767.             "migrations.migrations_test_apps.unmigrated_app",
768.         ],
769.     )
770.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):
771.         """
772.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:
773. 
774.         * `A` has migrations
775.         * `B` has a migration we want to apply
776.         * `C` has no migrations, but has an FK to `A`
777. 
778.         When we try to migrate "B", an exception occurs because the
779.         "B" was not included in the ProjectState that is used to detect
780.         soft-applied migrations (#22823).
781.         """
782.         call_command("migrate", "migrated_unapplied_app", stdout=io.StringIO())
783. 
784.         # unmigrated_app.SillyModel has a foreign key to 'migrations.Tribble',
785.         # but that model is only defined in a migration, so the global app
786.         # registry never sees it and the reference is left dangling. Remove it
787.         # to avoid problems in subsequent tests.
788.         del apps._pending_operations[('migrations', 'tribble')]
789. 
790.     @override_settings(INSTALLED_APPS=['migrations.migrations_test_apps.unmigrated_app_syncdb'])
791.     def test_migrate_syncdb_deferred_sql_executed_with_schemaeditor(self):
792.         """
793.         For an app without migrations, editor.execute() is used for executing
794.         the syncdb deferred SQL.
795.         """
796.         stdout = io.StringIO()
797.         with mock.patch.object(BaseDatabaseSchemaEditor, 'execute') as execute:
798.             call_command('migrate', run_syncdb=True, verbosity=1, stdout=stdout, no_color=True)
799.             create_table_count = len([call for call in execute.mock_calls if 'CREATE TABLE' in str(call)])
800.             self.assertEqual(create_table_count, 2)
801.             # There's at least one deferred SQL for creating the foreign key
802.             # index.
803.             self.assertGreater(len(execute.mock_calls), 2)
804.         stdout = stdout.getvalue()
805.         self.assertIn('Synchronize unmigrated apps: unmigrated_app_syncdb', stdout)
806.         self.assertIn('Creating tables...', stdout)
807.         table_name = truncate_name('unmigrated_app_syncdb_classroom', connection.ops.max_name_length())
808.         self.assertIn('Creating table %s' % table_name, stdout)
809. 
810.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations'})
811.     def test_migrate_syncdb_app_with_migrations(self):
812.         msg = "Can't use run_syncdb with app 'migrations' as it has migrations."
813.         with self.assertRaisesMessage(CommandError, msg):
814.             call_command('migrate', 'migrations', run_syncdb=True, verbosity=0)
815. 
816.     @override_settings(INSTALLED_APPS=[
817.         'migrations.migrations_test_apps.unmigrated_app_syncdb',
818.         'migrations.migrations_test_apps.unmigrated_app_simple',
819.     ])
820.     def test_migrate_syncdb_app_label(self):
821.         """
822.         Running migrate --run-syncdb with an app_label only creates tables for
823.         the specified app.
824.         """
825.         stdout = io.StringIO()
826.         with mock.patch.object(BaseDatabaseSchemaEditor, 'execute') as execute:
827.             call_command('migrate', 'unmigrated_app_syncdb', run_syncdb=True, stdout=stdout)
828.             create_table_count = len([call for call in execute.mock_calls if 'CREATE TABLE' in str(call)])
829.             self.assertEqual(create_table_count, 2)
830.             self.assertGreater(len(execute.mock_calls), 2)
831.             self.assertIn('Synchronize unmigrated app: unmigrated_app_syncdb', stdout.getvalue())
832. 
833.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
834.     def test_migrate_record_replaced(self):
835.         """
836.         Running a single squashed migration should record all of the original
837.         replaced migrations as run.
838.         """
839.         recorder = MigrationRecorder(connection)
840.         out = io.StringIO()
841.         call_command("migrate", "migrations", verbosity=0)
842.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
843.         self.assertEqual(
844.             'migrations\n'
845.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
846.             out.getvalue().lower()
847.         )
848.         applied_migrations = recorder.applied_migrations()
849.         self.assertIn(("migrations", "0001_initial"), applied_migrations)
850.         self.assertIn(("migrations", "0002_second"), applied_migrations)
851.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)
852.         # Rollback changes
853.         call_command("migrate", "migrations", "zero", verbosity=0)
854. 
855.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})
856.     def test_migrate_record_squashed(self):
857.         """
858.         Running migrate for a squashed migration should record as run
859.         if all of the replaced migrations have been run (#25231).
860.         """
861.         recorder = MigrationRecorder(connection)
862.         recorder.record_applied("migrations", "0001_initial")
863.         recorder.record_applied("migrations", "0002_second")
864.         out = io.StringIO()
865.         call_command("migrate", "migrations", verbosity=0)
866.         call_command("showmigrations", "migrations", stdout=out, no_color=True)
867.         self.assertEqual(
868.             'migrations\n'
869.             ' [x] 0001_squashed_0002 (2 squashed migrations)\n',
870.             out.getvalue().lower()
871.         )
872.         self.assertIn(
873.             ("migrations", "0001_squashed_0002"),
874.             recorder.applied_migrations()
875.         )
876.         # No changes were actually applied so there is nothing to rollback
877. 
878.     @override_settings(MIGRATION_MODULES={'migrations': 'migrations.test_migrations'})
879.     def test_migrate_inconsistent_history(self):
880.         """
881.         Running migrate with some migrations applied before their dependencies
882.         should not be allowed.
883.         """
884.         recorder = MigrationRecorder(connection)
885.         recorder.record_applied("migrations", "0002_second")
886.         msg = "Migration migrations.0002_second is applied before its dependency migrations.0001_initial"
887.         with self.assertRaisesMessage(InconsistentMigrationHistory, msg):
888.             call_command("migrate")
889.         applied_migrations = recorder.applied_migrations()
890.         self.assertNotIn(("migrations", "0001_initial"), applied_migrations)
891. 
892. 
893. class MakeMigrationsTests(MigrationTestBase):
894.     """
895.     Tests running the makemigrations command.
896.     """
897. 
898.     def setUp(self):
899.         super().setUp()
900.         self._old_models = apps.app_configs['migrations'].models.copy()
901. 
902.     def tearDown(self):
903.         apps.app_configs['migrations'].models = self._old_models
904.         apps.all_models['migrations'] = self._old_models
905.         apps.clear_cache()
906.         super().tearDown()
907. 
908.     def test_files_content(self):
909.         self.assertTableNotExists("migrations_unicodemodel")
910.         apps.register_model('migrations', UnicodeModel)
911.         with self.temporary_migration_module() as migration_dir:
912.             call_command("makemigrations", "migrations", verbosity=0)
913. 
914.             # Check for empty __init__.py file in migrations folder
915.             init_file = os.path.join(migration_dir, "__init__.py")
916.             self.assertTrue(os.path.exists(init_file))
917. 
918.             with open(init_file) as fp:
919.                 content = fp.read()
920.             self.assertEqual(content, '')
921. 
922.             # Check for existing 0001_initial.py file in migration folder
923.             initial_file = os.path.join(migration_dir, "0001_initial.py")
924.             self.assertTrue(os.path.exists(initial_file))
925. 
926.             with open(initial_file, encoding='utf-8') as fp:
927.                 content = fp.read()
928.                 self.assertIn('migrations.CreateModel', content)
929.                 self.assertIn('initial = True', content)
930. 
931.                 self.assertIn('úñí©óðé µóðéø', content)  # Meta.verbose_name
932.                 self.assertIn('úñí©óðé µóðéøß', content)  # Meta.verbose_name_plural
933.                 self.assertIn('ÚÑÍ¢ÓÐÉ', content)  # title.verbose_name
934.                 self.assertIn('“Ðjáñgó”', content)  # title.default
935. 
936.     def test_makemigrations_order(self):
937.         """
938.         makemigrations should recognize number-only migrations (0001.py).
939.         """
940.         module = 'migrations.test_migrations_order'
941.         with self.temporary_migration_module(module=module) as migration_dir:
942.             if hasattr(importlib, 'invalidate_caches'):
943.                 # importlib caches os.listdir() on some platforms like macOS
944.                 # (#23850).
945.                 importlib.invalidate_caches()
946.             call_command('makemigrations', 'migrations', '--empty', '-n', 'a', '-v', '0')
947.             self.assertTrue(os.path.exists(os.path.join(migration_dir, '0002_a.py')))
948. 
949.     def test_makemigrations_empty_connections(self):
950.         empty_connections = ConnectionHandler({'default': {}})
951.         with mock.patch('django.core.management.commands.makemigrations.connections', new=empty_connections):
952.             # with no apps
953.             out = io.StringIO()
954.             call_command('makemigrations', stdout=out)
955.             self.assertIn('No changes detected', out.getvalue())
956.             # with an app
957.             with self.temporary_migration_module() as migration_dir:
958.                 call_command('makemigrations', 'migrations', verbosity=0)
959.                 init_file = os.path.join(migration_dir, '__init__.py')
960.                 self.assertTrue(os.path.exists(init_file))
961. 
962.     @override_settings(INSTALLED_APPS=['migrations', 'migrations2'])
963.     def test_makemigrations_consistency_checks_respect_routers(self):
964.         """
965.         The history consistency checks in makemigrations respect
966.         settings.DATABASE_ROUTERS.
967.         """
968.         def patched_has_table(migration_recorder):
969.             if migration_recorder.connection is connections['other']:
970.                 raise Exception('Other connection')
971.             else:
972.                 return mock.DEFAULT
973. 
974.         self.assertTableNotExists('migrations_unicodemodel')
975.         apps.register_model('migrations', UnicodeModel)
976.         with mock.patch.object(
977.                 MigrationRecorder, 'has_table',
978.                 autospec=True, side_effect=patched_has_table) as has_table:
979.             with self.temporary_migration_module() as migration_dir:
980.                 call_command("makemigrations", "migrations", verbosity=0)
981.                 initial_file = os.path.join(migration_dir, "0001_initial.py")
982.                 self.assertTrue(os.path.exists(initial_file))
983.                 self.assertEqual(has_table.call_count, 1)  # 'default' is checked
984. 
985.                 # Router says not to migrate 'other' so consistency shouldn't
986.                 # be checked.
987.                 with self.settings(DATABASE_ROUTERS=['migrations.routers.TestRouter']):
988.                     call_command('makemigrations', 'migrations', verbosity=0)
989.                 self.assertEqual(has_table.call_count, 2)  # 'default' again
990. 
991.                 # With a router that doesn't prohibit migrating 'other',
992.                 # consistency is checked.
993.                 with self.settings(DATABASE_ROUTERS=['migrations.routers.DefaultOtherRouter']):
994.                     with self.assertRaisesMessage(Exception, 'Other connection'):
995.                         call_command('makemigrations', 'migrations', verbosity=0)
996.                 self.assertEqual(has_table.call_count, 4)  # 'default' and 'other'
997. 
998.                 # With a router that doesn't allow migrating on any database,
999.                 # no consistency checks are made.
1000.                 with self.settings(DATABASE_ROUTERS=['migrations.routers.TestRouter']):


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 05:10:52,258 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='The user explicitly requested the full source code for `tests/backends/base/test_operations.py`. This file is highly relevant as it contains a test class `SqlFlushTests` with a test method `test_execute_sql_flush_statements` that directly calls `connection.ops.execute_sql_flush(connection.alias, sql_list)`, which is the exact usage pattern mentioned in the issue description that is being refactored.', relative_path='tests/backends/base/test_operations.py', start_line=1, end_line=184), ContextOutput(reasoning='The user explicitly requested the full source code for `tests/multiple_database/tests.py`. This file is relevant for understanding how database operations are tested in a multi-database environment, including how the `using` parameter is handled, which is central to the issue of simplifying the `execute_sql_flush` signature.', relative_path='tests/multiple_database/tests.py', start_line=1, end_line=1000), ContextOutput(reasoning='The user explicitly requested the full source code for `tests/migrations/test_commands.py`. This file is relevant because migration commands perform many low-level database operations. The tests in this file demonstrate how to set up tests that involve database state changes, schema modifications, and command calls, which provides context for testing the refactored `execute_sql_flush` method.', relative_path='tests/migrations/test_commands.py', start_line=1, end_line=1000)]
2025-10-06 05:10:52,259 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='tests/model_regress/tests.py', content='37.     def test_sql_insert_compiler_return_id_attribute(self):\n38.         """\n39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure\n40.         """\n41.         db = router.db_for_write(Party)\n42.         query = InsertQuery(Party)\n43.         query.insert_values([Party._meta.fields[0]], [], raw=False)\n44.         # this line will raise an AttributeError without the accompanying fix\n45.         query.get_compiler(using=db).as_sql()\n46. ', start_line_number=37, end_line_number=46), Context(relative_path='tests/admin_scripts/tests.py', content='258.     def test_custom_command_with_settings(self):\n259.         "default: django-admin can execute user commands if settings are provided as argument"\n260.         args = [\'noargs_command\', \'--settings=test_project.settings\']\n261.         out, err = self.run_django_admin(args)\n262.         self.assertNoOutput(err)\n263.         self.assertOutput(out, "EXECUTE: noargs_command")', start_line_number=258, end_line_number=263), Context(relative_path='tests/backends/base/test_operations.py', content="1. import decimal\n2. \n3. from django.core.management.color import no_style\n4. from django.db import NotSupportedError, connection, transaction\n5. from django.db.backends.base.operations import BaseDatabaseOperations\n6. from django.db.models import DurationField\n7. from django.test import (\n8.     SimpleTestCase, TestCase, TransactionTestCase, override_settings,\n9.     skipIfDBFeature,\n10. )\n11. from django.utils import timezone\n12. \n13. from ..models import Author, Book\n14. \n15. \n16. class SimpleDatabaseOperationTests(SimpleTestCase):\n17.     may_require_msg = 'subclasses of BaseDatabaseOperations may require a %s() method'\n18. \n19.     def setUp(self):\n20.         self.ops = BaseDatabaseOperations(connection=connection)\n21. \n22.     def test_deferrable_sql(self):\n23.         self.assertEqual(self.ops.deferrable_sql(), '')\n24. \n25.     def test_end_transaction_rollback(self):\n26.         self.assertEqual(self.ops.end_transaction_sql(success=False), 'ROLLBACK;')\n27. \n28.     def test_no_limit_value(self):\n29.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'no_limit_value'):\n30.             self.ops.no_limit_value()\n31. \n32.     def test_quote_name(self):\n33.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'quote_name'):\n34.             self.ops.quote_name('a')\n35. \n36.     def test_regex_lookup(self):\n37.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'regex_lookup'):\n38.             self.ops.regex_lookup(lookup_type='regex')\n39. \n40.     def test_set_time_zone_sql(self):\n41.         self.assertEqual(self.ops.set_time_zone_sql(), '')\n42. \n43.     def test_sql_flush(self):\n44.         msg = 'subclasses of BaseDatabaseOperations must provide a sql_flush() method'\n45.         with self.assertRaisesMessage(NotImplementedError, msg):\n46.             self.ops.sql_flush(None, None)\n47. \n48.     def test_pk_default_value(self):\n49.         self.assertEqual(self.ops.pk_default_value(), 'DEFAULT')\n50. \n51.     def test_tablespace_sql(self):\n52.         self.assertEqual(self.ops.tablespace_sql(None), '')\n53. \n54.     def test_sequence_reset_by_name_sql(self):\n55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])\n56. \n57.     def test_adapt_unknown_value_decimal(self):\n58.         value = decimal.Decimal('3.14')\n59.         self.assertEqual(\n60.             self.ops.adapt_unknown_value(value),\n61.             self.ops.adapt_decimalfield_value(value)\n62.         )\n63. \n64.     def test_adapt_unknown_value_date(self):\n65.         value = timezone.now().date()\n66.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_datefield_value(value))\n67. \n68.     def test_adapt_unknown_value_time(self):\n69.         value = timezone.now().time()\n70.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_timefield_value(value))\n71. \n72.     def test_adapt_timefield_value_none(self):\n73.         self.assertIsNone(self.ops.adapt_timefield_value(None))\n74. \n75.     def test_adapt_datetimefield_value(self):\n76.         self.assertIsNone(self.ops.adapt_datetimefield_value(None))\n77. \n78.     def test_adapt_timefield_value(self):\n79.         msg = 'Django does not support timezone-aware times.'\n80.         with self.assertRaisesMessage(ValueError, msg):\n81.             self.ops.adapt_timefield_value(timezone.make_aware(timezone.now()))\n82. \n83.     @override_settings(USE_TZ=False)\n84.     def test_adapt_timefield_value_unaware(self):\n85.         now = timezone.now()\n86.         self.assertEqual(self.ops.adapt_timefield_value(now), str(now))\n87. \n88.     def test_date_extract_sql(self):\n89.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):\n90.             self.ops.date_extract_sql(None, None)\n91. \n92.     def test_time_extract_sql(self):\n93.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):\n94.             self.ops.time_extract_sql(None, None)\n95. \n96.     def test_date_interval_sql(self):\n97.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_interval_sql'):\n98.             self.ops.date_interval_sql(None)\n99. \n100.     def test_date_trunc_sql(self):\n101.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_trunc_sql'):\n102.             self.ops.date_trunc_sql(None, None)\n103. \n104.     def test_time_trunc_sql(self):\n105.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'time_trunc_sql'):\n106.             self.ops.time_trunc_sql(None, None)\n107. \n108.     def test_datetime_trunc_sql(self):\n109.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_trunc_sql'):\n110.             self.ops.datetime_trunc_sql(None, None, None)\n111. \n112.     def test_datetime_cast_date_sql(self):\n113.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_date_sql'):\n114.             self.ops.datetime_cast_date_sql(None, None)\n115. \n116.     def test_datetime_cast_time_sql(self):\n117.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_time_sql'):\n118.             self.ops.datetime_cast_time_sql(None, None)\n119. \n120.     def test_datetime_extract_sql(self):\n121.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_extract_sql'):\n122.             self.ops.datetime_extract_sql(None, None, None)\n123. \n124. \n125. class DatabaseOperationTests(TestCase):\n126.     def setUp(self):\n127.         self.ops = BaseDatabaseOperations(connection=connection)\n128. \n129.     @skipIfDBFeature('supports_over_clause')\n130.     def test_window_frame_raise_not_supported_error(self):\n131.         msg = 'This backend does not support window expressions.'\n132.         with self.assertRaisesMessage(NotSupportedError, msg):\n133.             self.ops.window_frame_rows_start_end()\n134. \n135.     @skipIfDBFeature('can_distinct_on_fields')\n136.     def test_distinct_on_fields(self):\n137.         msg = 'DISTINCT ON fields is not supported by this database backend'\n138.         with self.assertRaisesMessage(NotSupportedError, msg):\n139.             self.ops.distinct_sql(['a', 'b'], None)\n140. \n141.     @skipIfDBFeature('supports_temporal_subtraction')\n142.     def test_subtract_temporals(self):\n143.         duration_field = DurationField()\n144.         duration_field_internal_type = duration_field.get_internal_type()\n145.         msg = (\n146.             'This backend does not support %s subtraction.' %\n147.             duration_field_internal_type\n148.         )\n149.         with self.assertRaisesMessage(NotSupportedError, msg):\n150.             self.ops.subtract_temporals(duration_field_internal_type, None, None)\n151. \n152. \n153. class SqlFlushTests(TransactionTestCase):\n154.     available_apps = ['backends']\n155. \n156.     def test_sql_flush_no_tables(self):\n157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])\n158. \n159.     def test_execute_sql_flush_statements(self):\n160.         with transaction.atomic():\n161.             author = Author.objects.create(name='George Orwell')\n162.             Book.objects.create(author=author)\n163.             author = Author.objects.create(name='Harper Lee')\n164.             Book.objects.create(author=author)\n165.             Book.objects.create(author=author)\n166.             self.assertIs(Author.objects.exists(), True)\n167.             self.assertIs(Book.objects.exists(), True)\n168. \n169.         sql_list = connection.ops.sql_flush(\n170.             no_style(),\n171.             [Author._meta.db_table, Book._meta.db_table],\n172.             reset_sequences=True,\n173.             allow_cascade=True,\n174.         )\n175.         connection.ops.execute_sql_flush(connection.alias, sql_list)\n176. \n177.         with transaction.atomic():\n178.             self.assertIs(Author.objects.exists(), False)\n179.             self.assertIs(Book.objects.exists(), False)\n180.             if connection.features.supports_sequence_reset:\n181.                 author = Author.objects.create(name='F. Scott Fitzgerald')\n182.                 self.assertEqual(author.pk, 1)\n183.                 book = Book.objects.create(author=author)\n184.                 self.assertEqual(book.pk, 1)", start_line_number=1, end_line_number=184), Context(relative_path='tests/multiple_database/tests.py', content='1. import datetime\n2. import pickle\n3. from io import StringIO\n4. from operator import attrgetter\n5. from unittest.mock import Mock\n6. \n7. from django.contrib.auth.models import User\n8. from django.contrib.contenttypes.models import ContentType\n9. from django.core import management\n10. from django.db import DEFAULT_DB_ALIAS, router, transaction\n11. from django.db.models import signals\n12. from django.db.utils import ConnectionRouter\n13. from django.test import SimpleTestCase, TestCase, override_settings\n14. \n15. from .models import Book, Person, Pet, Review, UserProfile\n16. from .routers import AuthRouter, TestRouter, WriteRouter\n17. \n18. \n19. class QueryTestCase(TestCase):\n20.     databases = {\'default\', \'other\'}\n21. \n22.     def test_db_selection(self):\n23.         "Querysets will use the default database by default"\n24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)\n25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)\n26. \n27.         self.assertEqual(Book.objects.using(\'other\').db, \'other\')\n28. \n29.         self.assertEqual(Book.objects.db_manager(\'other\').db, \'other\')\n30.         self.assertEqual(Book.objects.db_manager(\'other\').all().db, \'other\')\n31. \n32.     def test_default_creation(self):\n33.         "Objects created on the default database don\'t leak onto other databases"\n34.         # Create a book on the default database using create()\n35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n36. \n37.         # Create a book on the default database using a save\n38.         dive = Book()\n39.         dive.title = "Dive into Python"\n40.         dive.published = datetime.date(2009, 5, 4)\n41.         dive.save()\n42. \n43.         # Book exists on the default database, but not on other database\n44.         try:\n45.             Book.objects.get(title="Pro Django")\n46.             Book.objects.using(\'default\').get(title="Pro Django")\n47.         except Book.DoesNotExist:\n48.             self.fail(\'"Pro Django" should exist on default database\')\n49. \n50.         with self.assertRaises(Book.DoesNotExist):\n51.             Book.objects.using(\'other\').get(title="Pro Django")\n52. \n53.         try:\n54.             Book.objects.get(title="Dive into Python")\n55.             Book.objects.using(\'default\').get(title="Dive into Python")\n56.         except Book.DoesNotExist:\n57.             self.fail(\'"Dive into Python" should exist on default database\')\n58. \n59.         with self.assertRaises(Book.DoesNotExist):\n60.             Book.objects.using(\'other\').get(title="Dive into Python")\n61. \n62.     def test_other_creation(self):\n63.         "Objects created on another database don\'t leak onto the default database"\n64.         # Create a book on the second database\n65.         Book.objects.using(\'other\').create(title="Pro Django",\n66.                                            published=datetime.date(2008, 12, 16))\n67. \n68.         # Create a book on the default database using a save\n69.         dive = Book()\n70.         dive.title = "Dive into Python"\n71.         dive.published = datetime.date(2009, 5, 4)\n72.         dive.save(using=\'other\')\n73. \n74.         # Book exists on the default database, but not on other database\n75.         try:\n76.             Book.objects.using(\'other\').get(title="Pro Django")\n77.         except Book.DoesNotExist:\n78.             self.fail(\'"Pro Django" should exist on other database\')\n79. \n80.         with self.assertRaises(Book.DoesNotExist):\n81.             Book.objects.get(title="Pro Django")\n82.         with self.assertRaises(Book.DoesNotExist):\n83.             Book.objects.using(\'default\').get(title="Pro Django")\n84. \n85.         try:\n86.             Book.objects.using(\'other\').get(title="Dive into Python")\n87.         except Book.DoesNotExist:\n88.             self.fail(\'"Dive into Python" should exist on other database\')\n89. \n90.         with self.assertRaises(Book.DoesNotExist):\n91.             Book.objects.get(title="Dive into Python")\n92.         with self.assertRaises(Book.DoesNotExist):\n93.             Book.objects.using(\'default\').get(title="Dive into Python")\n94. \n95.     def test_refresh(self):\n96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))\n97.         dive.save(using=\'other\')\n98.         dive2 = Book.objects.using(\'other\').get()\n99.         dive2.title = "Dive into Python (on default)"\n100.         dive2.save(using=\'default\')\n101.         dive.refresh_from_db()\n102.         self.assertEqual(dive.title, "Dive into Python")\n103.         dive.refresh_from_db(using=\'default\')\n104.         self.assertEqual(dive.title, "Dive into Python (on default)")\n105.         self.assertEqual(dive._state.db, "default")\n106. \n107.     def test_refresh_router_instance_hint(self):\n108.         router = Mock()\n109.         router.db_for_read.return_value = None\n110.         book = Book.objects.create(title=\'Dive Into Python\', published=datetime.date(1957, 10, 12))\n111.         with self.settings(DATABASE_ROUTERS=[router]):\n112.             book.refresh_from_db()\n113.         router.db_for_read.assert_called_once_with(Book, instance=book)\n114. \n115.     def test_basic_queries(self):\n116.         "Queries are constrained to a single database"\n117.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n118. \n119.         dive = Book.objects.using(\'other\').get(published=datetime.date(2009, 5, 4))\n120.         self.assertEqual(dive.title, "Dive into Python")\n121.         with self.assertRaises(Book.DoesNotExist):\n122.             Book.objects.using(\'default\').get(published=datetime.date(2009, 5, 4))\n123. \n124.         dive = Book.objects.using(\'other\').get(title__icontains="dive")\n125.         self.assertEqual(dive.title, "Dive into Python")\n126.         with self.assertRaises(Book.DoesNotExist):\n127.             Book.objects.using(\'default\').get(title__icontains="dive")\n128. \n129.         dive = Book.objects.using(\'other\').get(title__iexact="dive INTO python")\n130.         self.assertEqual(dive.title, "Dive into Python")\n131.         with self.assertRaises(Book.DoesNotExist):\n132.             Book.objects.using(\'default\').get(title__iexact="dive INTO python")\n133. \n134.         dive = Book.objects.using(\'other\').get(published__year=2009)\n135.         self.assertEqual(dive.title, "Dive into Python")\n136.         self.assertEqual(dive.published, datetime.date(2009, 5, 4))\n137.         with self.assertRaises(Book.DoesNotExist):\n138.             Book.objects.using(\'default\').get(published__year=2009)\n139. \n140.         years = Book.objects.using(\'other\').dates(\'published\', \'year\')\n141.         self.assertEqual([o.year for o in years], [2009])\n142.         years = Book.objects.using(\'default\').dates(\'published\', \'year\')\n143.         self.assertEqual([o.year for o in years], [])\n144. \n145.         months = Book.objects.using(\'other\').dates(\'published\', \'month\')\n146.         self.assertEqual([o.month for o in months], [5])\n147.         months = Book.objects.using(\'default\').dates(\'published\', \'month\')\n148.         self.assertEqual([o.month for o in months], [])\n149. \n150.     def test_m2m_separation(self):\n151.         "M2M fields are constrained to a single database"\n152.         # Create a book and author on the default database\n153.         pro = Book.objects.create(title="Pro Django",\n154.                                   published=datetime.date(2008, 12, 16))\n155. \n156.         marty = Person.objects.create(name="Marty Alchin")\n157. \n158.         # Create a book and author on the other database\n159.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n160. \n161.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n162. \n163.         # Save the author relations\n164.         pro.authors.set([marty])\n165.         dive.authors.set([mark])\n166. \n167.         # Inspect the m2m tables directly.\n168.         # There should be 1 entry in each database\n169.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 1)\n170.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n171. \n172.         # Queries work across m2m joins\n173.         self.assertEqual(\n174.             list(Book.objects.using(\'default\').filter(authors__name=\'Marty Alchin\').values_list(\'title\', flat=True)),\n175.             [\'Pro Django\']\n176.         )\n177.         self.assertEqual(\n178.             list(Book.objects.using(\'other\').filter(authors__name=\'Marty Alchin\').values_list(\'title\', flat=True)),\n179.             []\n180.         )\n181. \n182.         self.assertEqual(\n183.             list(Book.objects.using(\'default\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n184.             []\n185.         )\n186.         self.assertEqual(\n187.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n188.             [\'Dive into Python\']\n189.         )\n190. \n191.         # Reget the objects to clear caches\n192.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n193.         mark = Person.objects.using(\'other\').get(name="Mark Pilgrim")\n194. \n195.         # Retrieve related object by descriptor. Related objects should be database-bound\n196.         self.assertEqual(list(dive.authors.all().values_list(\'name\', flat=True)), [\'Mark Pilgrim\'])\n197. \n198.         self.assertEqual(list(mark.book_set.all().values_list(\'title\', flat=True)), [\'Dive into Python\'])\n199. \n200.     def test_m2m_forward_operations(self):\n201.         "M2M forward manipulations are all constrained to a single DB"\n202.         # Create a book and author on the other database\n203.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n204.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n205. \n206.         # Save the author relations\n207.         dive.authors.set([mark])\n208. \n209.         # Add a second author\n210.         john = Person.objects.using(\'other\').create(name="John Smith")\n211.         self.assertEqual(\n212.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n213.             []\n214.         )\n215. \n216.         dive.authors.add(john)\n217.         self.assertEqual(\n218.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n219.             [\'Dive into Python\']\n220.         )\n221.         self.assertEqual(\n222.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n223.             [\'Dive into Python\']\n224.         )\n225. \n226.         # Remove the second author\n227.         dive.authors.remove(john)\n228.         self.assertEqual(\n229.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n230.             [\'Dive into Python\']\n231.         )\n232.         self.assertEqual(\n233.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n234.             []\n235.         )\n236. \n237.         # Clear all authors\n238.         dive.authors.clear()\n239.         self.assertEqual(\n240.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n241.             []\n242.         )\n243.         self.assertEqual(\n244.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n245.             []\n246.         )\n247. \n248.         # Create an author through the m2m interface\n249.         dive.authors.create(name=\'Jane Brown\')\n250.         self.assertEqual(\n251.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n252.             []\n253.         )\n254.         self.assertEqual(\n255.             list(Book.objects.using(\'other\').filter(authors__name=\'Jane Brown\').values_list(\'title\', flat=True)),\n256.             [\'Dive into Python\']\n257.         )\n258. \n259.     def test_m2m_reverse_operations(self):\n260.         "M2M reverse manipulations are all constrained to a single DB"\n261.         # Create a book and author on the other database\n262.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n263.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n264. \n265.         # Save the author relations\n266.         dive.authors.set([mark])\n267. \n268.         # Create a second book on the other database\n269.         grease = Book.objects.using(\'other\').create(title="Greasemonkey Hacks", published=datetime.date(2005, 11, 1))\n270. \n271.         # Add a books to the m2m\n272.         mark.book_set.add(grease)\n273.         self.assertEqual(\n274.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n275.             [\'Mark Pilgrim\']\n276.         )\n277.         self.assertEqual(\n278.             list(\n279.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n280.             ),\n281.             [\'Mark Pilgrim\']\n282.         )\n283. \n284.         # Remove a book from the m2m\n285.         mark.book_set.remove(grease)\n286.         self.assertEqual(\n287.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n288.             [\'Mark Pilgrim\']\n289.         )\n290.         self.assertEqual(\n291.             list(\n292.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n293.             ),\n294.             []\n295.         )\n296. \n297.         # Clear the books associated with mark\n298.         mark.book_set.clear()\n299.         self.assertEqual(\n300.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n301.             []\n302.         )\n303.         self.assertEqual(\n304.             list(\n305.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n306.             ),\n307.             []\n308.         )\n309. \n310.         # Create a book through the m2m interface\n311.         mark.book_set.create(title="Dive into HTML5", published=datetime.date(2020, 1, 1))\n312.         self.assertEqual(\n313.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n314.             []\n315.         )\n316.         self.assertEqual(\n317.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n318.             [\'Mark Pilgrim\']\n319.         )\n320. \n321.     def test_m2m_cross_database_protection(self):\n322.         "Operations that involve sharing M2M objects across databases raise an error"\n323.         # Create a book and author on the default database\n324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n325. \n326.         marty = Person.objects.create(name="Marty Alchin")\n327. \n328.         # Create a book and author on the other database\n329.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n330. \n331.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n332.         # Set a foreign key set with an object from a different database\n333.         msg = (\n334.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n335.             \'router prevents this relation.\'\n336.         )\n337.         with self.assertRaisesMessage(ValueError, msg):\n338.             with transaction.atomic(using=\'default\'):\n339.                 marty.edited.set([pro, dive])\n340. \n341.         # Add to an m2m with an object from a different database\n342.         msg = (\n343.             \'Cannot add "<Book: Dive into Python>": instance is on \'\n344.             \'database "default", value is on database "other"\'\n345.         )\n346.         with self.assertRaisesMessage(ValueError, msg):\n347.             with transaction.atomic(using=\'default\'):\n348.                 marty.book_set.add(dive)\n349. \n350.         # Set a m2m with an object from a different database\n351.         with self.assertRaisesMessage(ValueError, msg):\n352.             with transaction.atomic(using=\'default\'):\n353.                 marty.book_set.set([pro, dive])\n354. \n355.         # Add to a reverse m2m with an object from a different database\n356.         msg = (\n357.             \'Cannot add "<Person: Marty Alchin>": instance is on \'\n358.             \'database "other", value is on database "default"\'\n359.         )\n360.         with self.assertRaisesMessage(ValueError, msg):\n361.             with transaction.atomic(using=\'other\'):\n362.                 dive.authors.add(marty)\n363. \n364.         # Set a reverse m2m with an object from a different database\n365.         with self.assertRaisesMessage(ValueError, msg):\n366.             with transaction.atomic(using=\'other\'):\n367.                 dive.authors.set([mark, marty])\n368. \n369.     def test_m2m_deletion(self):\n370.         "Cascaded deletions of m2m relations issue queries on the right database"\n371.         # Create a book and author on the other database\n372.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n373.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n374.         dive.authors.set([mark])\n375. \n376.         # Check the initial state\n377.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n378.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n379.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n380. \n381.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n382.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n383.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n384. \n385.         # Delete the object on the other database\n386.         dive.delete(using=\'other\')\n387. \n388.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n389.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n390.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n391. \n392.         # The person still exists ...\n393.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n394.         # ... but the book has been deleted\n395.         self.assertEqual(Book.objects.using(\'other\').count(), 0)\n396.         # ... and the relationship object has also been deleted.\n397.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 0)\n398. \n399.         # Now try deletion in the reverse direction. Set up the relation again\n400.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n401.         dive.authors.set([mark])\n402. \n403.         # Check the initial state\n404.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n405.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n406.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n407. \n408.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n409.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n410.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n411. \n412.         # Delete the object on the other database\n413.         mark.delete(using=\'other\')\n414. \n415.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n416.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n417.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n418. \n419.         # The person has been deleted ...\n420.         self.assertEqual(Person.objects.using(\'other\').count(), 0)\n421.         # ... but the book still exists\n422.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n423.         # ... and the relationship object has been deleted.\n424.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 0)\n425. \n426.     def test_foreign_key_separation(self):\n427.         "FK fields are constrained to a single database"\n428.         # Create a book and author on the default database\n429.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n430. \n431.         george = Person.objects.create(name="George Vilches")\n432. \n433.         # Create a book and author on the other database\n434.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n435.         chris = Person.objects.using(\'other\').create(name="Chris Mills")\n436. \n437.         # Save the author\'s favorite books\n438.         pro.editor = george\n439.         pro.save()\n440. \n441.         dive.editor = chris\n442.         dive.save()\n443. \n444.         pro = Book.objects.using(\'default\').get(title="Pro Django")\n445.         self.assertEqual(pro.editor.name, "George Vilches")\n446. \n447.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n448.         self.assertEqual(dive.editor.name, "Chris Mills")\n449. \n450.         # Queries work across foreign key joins\n451.         self.assertEqual(\n452.             list(Person.objects.using(\'default\').filter(edited__title=\'Pro Django\').values_list(\'name\', flat=True)),\n453.             [\'George Vilches\']\n454.         )\n455.         self.assertEqual(\n456.             list(Person.objects.using(\'other\').filter(edited__title=\'Pro Django\').values_list(\'name\', flat=True)),\n457.             []\n458.         )\n459. \n460.         self.assertEqual(\n461.             list(\n462.                 Person.objects.using(\'default\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n463.             ),\n464.             []\n465.         )\n466.         self.assertEqual(\n467.             list(\n468.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n469.             ),\n470.             [\'Chris Mills\']\n471.         )\n472. \n473.         # Reget the objects to clear caches\n474.         chris = Person.objects.using(\'other\').get(name="Chris Mills")\n475.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n476. \n477.         # Retrieve related object by descriptor. Related objects should be database-bound\n478.         self.assertEqual(list(chris.edited.values_list(\'title\', flat=True)), [\'Dive into Python\'])\n479. \n480.     def test_foreign_key_reverse_operations(self):\n481.         "FK reverse manipulations are all constrained to a single DB"\n482.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n483.         chris = Person.objects.using(\'other\').create(name="Chris Mills")\n484. \n485.         # Save the author relations\n486.         dive.editor = chris\n487.         dive.save()\n488. \n489.         # Add a second book edited by chris\n490.         html5 = Book.objects.using(\'other\').create(title="Dive into HTML5", published=datetime.date(2010, 3, 15))\n491.         self.assertEqual(\n492.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n493.             []\n494.         )\n495. \n496.         chris.edited.add(html5)\n497.         self.assertEqual(\n498.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n499.             [\'Chris Mills\']\n500.         )\n501.         self.assertEqual(\n502.             list(\n503.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n504.             ),\n505.             [\'Chris Mills\']\n506.         )\n507. \n508.         # Remove the second editor\n509.         chris.edited.remove(html5)\n510.         self.assertEqual(\n511.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n512.             []\n513.         )\n514.         self.assertEqual(\n515.             list(\n516.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n517.             ),\n518.             [\'Chris Mills\']\n519.         )\n520. \n521.         # Clear all edited books\n522.         chris.edited.clear()\n523.         self.assertEqual(\n524.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n525.             []\n526.         )\n527.         self.assertEqual(\n528.             list(\n529.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n530.             ),\n531.             []\n532.         )\n533. \n534.         # Create an author through the m2m interface\n535.         chris.edited.create(title=\'Dive into Water\', published=datetime.date(2010, 3, 15))\n536.         self.assertEqual(\n537.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n538.             []\n539.         )\n540.         self.assertEqual(\n541.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into Water\').values_list(\'name\', flat=True)),\n542.             [\'Chris Mills\']\n543.         )\n544.         self.assertEqual(\n545.             list(\n546.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n547.             ),\n548.             []\n549.         )\n550. \n551.     def test_foreign_key_cross_database_protection(self):\n552.         "Operations that involve sharing FK objects across databases raise an error"\n553.         # Create a book and author on the default database\n554.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n555.         marty = Person.objects.create(name="Marty Alchin")\n556. \n557.         # Create a book and author on the other database\n558.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n559. \n560.         # Set a foreign key with an object from a different database\n561.         msg = (\n562.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n563.             \'router prevents this relation.\'\n564.         )\n565.         with self.assertRaisesMessage(ValueError, msg):\n566.             dive.editor = marty\n567. \n568.         # Set a foreign key set with an object from a different database\n569.         with self.assertRaisesMessage(ValueError, msg):\n570.             with transaction.atomic(using=\'default\'):\n571.                 marty.edited.set([pro, dive])\n572. \n573.         # Add to a foreign key set with an object from a different database\n574.         with self.assertRaisesMessage(ValueError, msg):\n575.             with transaction.atomic(using=\'default\'):\n576.                 marty.edited.add(dive)\n577. \n578.     def test_foreign_key_deletion(self):\n579.         "Cascaded deletions of Foreign Key relations issue queries on the right database"\n580.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n581.         Pet.objects.using(\'other\').create(name="Fido", owner=mark)\n582. \n583.         # Check the initial state\n584.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n585.         self.assertEqual(Pet.objects.using(\'default\').count(), 0)\n586. \n587.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n588.         self.assertEqual(Pet.objects.using(\'other\').count(), 1)\n589. \n590.         # Delete the person object, which will cascade onto the pet\n591.         mark.delete(using=\'other\')\n592. \n593.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n594.         self.assertEqual(Pet.objects.using(\'default\').count(), 0)\n595. \n596.         # Both the pet and the person have been deleted from the right database\n597.         self.assertEqual(Person.objects.using(\'other\').count(), 0)\n598.         self.assertEqual(Pet.objects.using(\'other\').count(), 0)\n599. \n600.     def test_foreign_key_validation(self):\n601.         "ForeignKey.validate() uses the correct database"\n602.         mickey = Person.objects.using(\'other\').create(name="Mickey")\n603.         pluto = Pet.objects.using(\'other\').create(name="Pluto", owner=mickey)\n604.         self.assertIsNone(pluto.full_clean())\n605. \n606.     # Any router that accesses `model` in db_for_read() works here.\n607.     @override_settings(DATABASE_ROUTERS=[AuthRouter()])\n608.     def test_foreign_key_validation_with_router(self):\n609.         """\n610.         ForeignKey.validate() passes `model` to db_for_read() even if\n611.         model_instance=None.\n612.         """\n613.         mickey = Person.objects.create(name="Mickey")\n614.         owner_field = Pet._meta.get_field(\'owner\')\n615.         self.assertEqual(owner_field.clean(mickey.pk, None), mickey.pk)\n616. \n617.     def test_o2o_separation(self):\n618.         "OneToOne fields are constrained to a single database"\n619.         # Create a user and profile on the default database\n620.         alice = User.objects.db_manager(\'default\').create_user(\'alice\', \'alice@example.com\')\n621.         alice_profile = UserProfile.objects.using(\'default\').create(user=alice, flavor=\'chocolate\')\n622. \n623.         # Create a user and profile on the other database\n624.         bob = User.objects.db_manager(\'other\').create_user(\'bob\', \'bob@example.com\')\n625.         bob_profile = UserProfile.objects.using(\'other\').create(user=bob, flavor=\'crunchy frog\')\n626. \n627.         # Retrieve related objects; queries should be database constrained\n628.         alice = User.objects.using(\'default\').get(username="alice")\n629.         self.assertEqual(alice.userprofile.flavor, "chocolate")\n630. \n631.         bob = User.objects.using(\'other\').get(username="bob")\n632.         self.assertEqual(bob.userprofile.flavor, "crunchy frog")\n633. \n634.         # Queries work across joins\n635.         self.assertEqual(\n636.             list(\n637.                 User.objects.using(\'default\')\n638.                 .filter(userprofile__flavor=\'chocolate\').values_list(\'username\', flat=True)\n639.             ),\n640.             [\'alice\']\n641.         )\n642.         self.assertEqual(\n643.             list(\n644.                 User.objects.using(\'other\')\n645.                 .filter(userprofile__flavor=\'chocolate\').values_list(\'username\', flat=True)\n646.             ),\n647.             []\n648.         )\n649. \n650.         self.assertEqual(\n651.             list(\n652.                 User.objects.using(\'default\')\n653.                 .filter(userprofile__flavor=\'crunchy frog\').values_list(\'username\', flat=True)\n654.             ),\n655.             []\n656.         )\n657.         self.assertEqual(\n658.             list(\n659.                 User.objects.using(\'other\')\n660.                 .filter(userprofile__flavor=\'crunchy frog\').values_list(\'username\', flat=True)\n661.             ),\n662.             [\'bob\']\n663.         )\n664. \n665.         # Reget the objects to clear caches\n666.         alice_profile = UserProfile.objects.using(\'default\').get(flavor=\'chocolate\')\n667.         bob_profile = UserProfile.objects.using(\'other\').get(flavor=\'crunchy frog\')\n668. \n669.         # Retrieve related object by descriptor. Related objects should be database-bound\n670.         self.assertEqual(alice_profile.user.username, \'alice\')\n671.         self.assertEqual(bob_profile.user.username, \'bob\')\n672. \n673.     def test_o2o_cross_database_protection(self):\n674.         "Operations that involve sharing FK objects across databases raise an error"\n675.         # Create a user and profile on the default database\n676.         alice = User.objects.db_manager(\'default\').create_user(\'alice\', \'alice@example.com\')\n677. \n678.         # Create a user and profile on the other database\n679.         bob = User.objects.db_manager(\'other\').create_user(\'bob\', \'bob@example.com\')\n680. \n681.         # Set a one-to-one relation with an object from a different database\n682.         alice_profile = UserProfile.objects.using(\'default\').create(user=alice, flavor=\'chocolate\')\n683.         msg = (\n684.             \'Cannot assign "%r": the current database router prevents this \'\n685.             \'relation.\' % alice_profile\n686.         )\n687.         with self.assertRaisesMessage(ValueError, msg):\n688.             bob.userprofile = alice_profile\n689. \n690.         # BUT! if you assign a FK object when the base object hasn\'t\n691.         # been saved yet, you implicitly assign the database for the\n692.         # base object.\n693.         bob_profile = UserProfile.objects.using(\'other\').create(user=bob, flavor=\'crunchy frog\')\n694. \n695.         new_bob_profile = UserProfile(flavor="spring surprise")\n696. \n697.         # assigning a profile requires an explicit pk as the object isn\'t saved\n698.         charlie = User(pk=51, username=\'charlie\', email=\'charlie@example.com\')\n699.         charlie.set_unusable_password()\n700. \n701.         # initially, no db assigned\n702.         self.assertIsNone(new_bob_profile._state.db)\n703.         self.assertIsNone(charlie._state.db)\n704. \n705.         # old object comes from \'other\', so the new object is set to use \'other\'...\n706.         new_bob_profile.user = bob\n707.         charlie.userprofile = bob_profile\n708.         self.assertEqual(new_bob_profile._state.db, \'other\')\n709.         self.assertEqual(charlie._state.db, \'other\')\n710. \n711.         # ... but it isn\'t saved yet\n712.         self.assertEqual(list(User.objects.using(\'other\').values_list(\'username\', flat=True)), [\'bob\'])\n713.         self.assertEqual(list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)), [\'crunchy frog\'])\n714. \n715.         # When saved (no using required), new objects goes to \'other\'\n716.         charlie.save()\n717.         bob_profile.save()\n718.         new_bob_profile.save()\n719.         self.assertEqual(list(User.objects.using(\'default\').values_list(\'username\', flat=True)), [\'alice\'])\n720.         self.assertEqual(list(User.objects.using(\'other\').values_list(\'username\', flat=True)), [\'bob\', \'charlie\'])\n721.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n722.         self.assertEqual(\n723.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n724.             [\'crunchy frog\', \'spring surprise\']\n725.         )\n726. \n727.         # This also works if you assign the O2O relation in the constructor\n728.         denise = User.objects.db_manager(\'other\').create_user(\'denise\', \'denise@example.com\')\n729.         denise_profile = UserProfile(flavor="tofu", user=denise)\n730. \n731.         self.assertEqual(denise_profile._state.db, \'other\')\n732.         # ... but it isn\'t saved yet\n733.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n734.         self.assertEqual(\n735.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n736.             [\'crunchy frog\', \'spring surprise\']\n737.         )\n738. \n739.         # When saved, the new profile goes to \'other\'\n740.         denise_profile.save()\n741.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n742.         self.assertEqual(\n743.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n744.             [\'crunchy frog\', \'spring surprise\', \'tofu\']\n745.         )\n746. \n747.     def test_generic_key_separation(self):\n748.         "Generic fields are constrained to a single database"\n749.         # Create a book and author on the default database\n750.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n751.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)\n752. \n753.         # Create a book and author on the other database\n754.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n755. \n756.         review2 = Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n757. \n758.         review1 = Review.objects.using(\'default\').get(source="Python Monthly")\n759.         self.assertEqual(review1.content_object.title, "Pro Django")\n760. \n761.         review2 = Review.objects.using(\'other\').get(source="Python Weekly")\n762.         self.assertEqual(review2.content_object.title, "Dive into Python")\n763. \n764.         # Reget the objects to clear caches\n765.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n766. \n767.         # Retrieve related object by descriptor. Related objects should be database-bound\n768.         self.assertEqual(list(dive.reviews.all().values_list(\'source\', flat=True)), [\'Python Weekly\'])\n769. \n770.     def test_generic_key_reverse_operations(self):\n771.         "Generic reverse manipulations are all constrained to a single DB"\n772.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n773.         temp = Book.objects.using(\'other\').create(title="Temp", published=datetime.date(2009, 5, 4))\n774.         review1 = Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n775.         review2 = Review.objects.using(\'other\').create(source="Python Monthly", content_object=temp)\n776. \n777.         self.assertEqual(\n778.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n779.             []\n780.         )\n781.         self.assertEqual(\n782.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n783.             [\'Python Weekly\']\n784.         )\n785. \n786.         # Add a second review\n787.         dive.reviews.add(review2)\n788.         self.assertEqual(\n789.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n790.             []\n791.         )\n792.         self.assertEqual(\n793.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n794.             [\'Python Monthly\', \'Python Weekly\']\n795.         )\n796. \n797.         # Remove the second author\n798.         dive.reviews.remove(review1)\n799.         self.assertEqual(\n800.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n801.             []\n802.         )\n803.         self.assertEqual(\n804.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n805.             [\'Python Monthly\']\n806.         )\n807. \n808.         # Clear all reviews\n809.         dive.reviews.clear()\n810.         self.assertEqual(\n811.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n812.             []\n813.         )\n814.         self.assertEqual(\n815.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n816.             []\n817.         )\n818. \n819.         # Create an author through the generic interface\n820.         dive.reviews.create(source=\'Python Daily\')\n821.         self.assertEqual(\n822.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n823.             []\n824.         )\n825.         self.assertEqual(\n826.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n827.             [\'Python Daily\']\n828.         )\n829. \n830.     def test_generic_key_cross_database_protection(self):\n831.         "Operations that involve sharing generic key objects across databases raise an error"\n832.         # Create a book and author on the default database\n833.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n834.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)\n835. \n836.         # Create a book and author on the other database\n837.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n838. \n839.         Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n840. \n841.         # Set a foreign key with an object from a different database\n842.         msg = (\n843.             \'Cannot assign "<ContentType: multiple_database | book>": the \'\n844.             \'current database router prevents this relation.\'\n845.         )\n846.         with self.assertRaisesMessage(ValueError, msg):\n847.             review1.content_object = dive\n848. \n849.         # Add to a foreign key set with an object from a different database\n850.         msg = (\n851.             "<Review: Python Monthly> instance isn\'t saved. "\n852.             "Use bulk=False or save the object first."\n853.         )\n854.         with self.assertRaisesMessage(ValueError, msg):\n855.             with transaction.atomic(using=\'other\'):\n856.                 dive.reviews.add(review1)\n857. \n858.         # BUT! if you assign a FK object when the base object hasn\'t\n859.         # been saved yet, you implicitly assign the database for the\n860.         # base object.\n861.         review3 = Review(source="Python Daily")\n862.         # initially, no db assigned\n863.         self.assertIsNone(review3._state.db)\n864. \n865.         # Dive comes from \'other\', so review3 is set to use \'other\'...\n866.         review3.content_object = dive\n867.         self.assertEqual(review3._state.db, \'other\')\n868.         # ... but it isn\'t saved yet\n869.         self.assertEqual(\n870.             list(Review.objects.using(\'default\').filter(object_id=pro.pk).values_list(\'source\', flat=True)),\n871.             [\'Python Monthly\']\n872.         )\n873.         self.assertEqual(\n874.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n875.             [\'Python Weekly\']\n876.         )\n877. \n878.         # When saved, John goes to \'other\'\n879.         review3.save()\n880.         self.assertEqual(\n881.             list(Review.objects.using(\'default\').filter(object_id=pro.pk).values_list(\'source\', flat=True)),\n882.             [\'Python Monthly\']\n883.         )\n884.         self.assertEqual(\n885.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n886.             [\'Python Daily\', \'Python Weekly\']\n887.         )\n888. \n889.     def test_generic_key_deletion(self):\n890.         "Cascaded deletions of Generic Key relations issue queries on the right database"\n891.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n892.         Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n893. \n894.         # Check the initial state\n895.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n896.         self.assertEqual(Review.objects.using(\'default\').count(), 0)\n897. \n898.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n899.         self.assertEqual(Review.objects.using(\'other\').count(), 1)\n900. \n901.         # Delete the Book object, which will cascade onto the pet\n902.         dive.delete(using=\'other\')\n903. \n904.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n905.         self.assertEqual(Review.objects.using(\'default\').count(), 0)\n906. \n907.         # Both the pet and the person have been deleted from the right database\n908.         self.assertEqual(Book.objects.using(\'other\').count(), 0)\n909.         self.assertEqual(Review.objects.using(\'other\').count(), 0)\n910. \n911.     def test_ordering(self):\n912.         "get_next_by_XXX commands stick to a single database"\n913.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n914.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n915.         learn = Book.objects.using(\'other\').create(title="Learning Python", published=datetime.date(2008, 7, 16))\n916. \n917.         self.assertEqual(learn.get_next_by_published().title, "Dive into Python")\n918.         self.assertEqual(dive.get_previous_by_published().title, "Learning Python")\n919. \n920.     def test_raw(self):\n921.         "test the raw() method across databases"\n922.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n923.         val = Book.objects.db_manager("other").raw(\'SELECT id FROM multiple_database_book\')\n924.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))\n925. \n926.         val = Book.objects.raw(\'SELECT id FROM multiple_database_book\').using(\'other\')\n927.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))\n928. \n929.     def test_select_related(self):\n930.         "Database assignment is retained if an object is retrieved with select_related()"\n931.         # Create a book and author on the other database\n932.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n933.         Book.objects.using(\'other\').create(\n934.             title="Dive into Python",\n935.             published=datetime.date(2009, 5, 4),\n936.             editor=mark,\n937.         )\n938. \n939.         # Retrieve the Person using select_related()\n940.         book = Book.objects.using(\'other\').select_related(\'editor\').get(title="Dive into Python")\n941. \n942.         # The editor instance should have a db state\n943.         self.assertEqual(book.editor._state.db, \'other\')\n944. \n945.     def test_subquery(self):\n946.         """Make sure as_sql works with subqueries and primary/replica."""\n947.         sub = Person.objects.using(\'other\').filter(name=\'fff\')\n948.         qs = Book.objects.filter(editor__in=sub)\n949. \n950.         # When you call __str__ on the query object, it doesn\'t know about using\n951.         # so it falls back to the default. If the subquery explicitly uses a\n952.         # different database, an error should be raised.\n953.         msg = (\n954.             "Subqueries aren\'t allowed across different databases. Force the "\n955.             "inner query to be evaluated using `list(inner_query)`."\n956.         )\n957.         with self.assertRaisesMessage(ValueError, msg):\n958.             str(qs.query)\n959. \n960.         # Evaluating the query shouldn\'t work, either\n961.         with self.assertRaisesMessage(ValueError, msg):\n962.             for obj in qs:\n963.                 pass\n964. \n965.     def test_related_manager(self):\n966.         "Related managers return managers, not querysets"\n967.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n968. \n969.         # extra_arg is removed by the BookManager\'s implementation of\n970.         # create(); but the BookManager\'s implementation won\'t get called\n971.         # unless edited returns a Manager, not a queryset\n972.         mark.book_set.create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)\n973.         mark.book_set.get_or_create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)\n974.         mark.edited.create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)\n975.         mark.edited.get_or_create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)\n976. \n977. \n978. class ConnectionRouterTestCase(SimpleTestCase):\n979.     @override_settings(DATABASE_ROUTERS=[\n980.         \'multiple_database.tests.TestRouter\',\n981.         \'multiple_database.tests.WriteRouter\'])\n982.     def test_router_init_default(self):\n983.         connection_router = ConnectionRouter()\n984.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n985. \n986.     def test_router_init_arg(self):\n987.         connection_router = ConnectionRouter([\n988.             \'multiple_database.tests.TestRouter\',\n989.             \'multiple_database.tests.WriteRouter\'\n990.         ])\n991.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n992. \n993.         # Init with instances instead of strings\n994.         connection_router = ConnectionRouter([TestRouter(), WriteRouter()])\n995.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n996. \n997. \n998. # Make the \'other\' database appear to be a replica of the \'default\'\n999. @override_settings(DATABASE_ROUTERS=[TestRouter()])\n1000. class RouterTestCase(TestCase):', start_line_number=1, end_line_number=1000), Context(relative_path='tests/migrations/test_commands.py', content='1. import datetime\n2. import importlib\n3. import io\n4. import os\n5. import sys\n6. from unittest import mock\n7. \n8. from django.apps import apps\n9. from django.core.management import CommandError, call_command\n10. from django.db import (\n11.     ConnectionHandler, DatabaseError, connection, connections, models,\n12. )\n13. from django.db.backends.base.schema import BaseDatabaseSchemaEditor\n14. from django.db.backends.utils import truncate_name\n15. from django.db.migrations.exceptions import InconsistentMigrationHistory\n16. from django.db.migrations.recorder import MigrationRecorder\n17. from django.test import TestCase, override_settings, skipUnlessDBFeature\n18. \n19. from .models import UnicodeModel, UnserializableModel\n20. from .routers import TestRouter\n21. from .test_base import MigrationTestBase\n22. \n23. \n24. class MigrateTests(MigrationTestBase):\n25.     """\n26.     Tests running the migrate command.\n27.     """\n28.     databases = {\'default\', \'other\'}\n29. \n30.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n31.     def test_migrate(self):\n32.         """\n33.         Tests basic usage of the migrate command.\n34.         """\n35.         # No tables are created\n36.         self.assertTableNotExists("migrations_author")\n37.         self.assertTableNotExists("migrations_tribble")\n38.         self.assertTableNotExists("migrations_book")\n39.         # Run the migrations to 0001 only\n40.         stdout = io.StringIO()\n41.         call_command(\'migrate\', \'migrations\', \'0001\', verbosity=1, stdout=stdout, no_color=True)\n42.         stdout = stdout.getvalue()\n43.         self.assertIn(\'Target specific migration: 0001_initial, from migrations\', stdout)\n44.         self.assertIn(\'Applying migrations.0001_initial... OK\', stdout)\n45.         # The correct tables exist\n46.         self.assertTableExists("migrations_author")\n47.         self.assertTableExists("migrations_tribble")\n48.         self.assertTableNotExists("migrations_book")\n49.         # Run migrations all the way\n50.         call_command("migrate", verbosity=0)\n51.         # The correct tables exist\n52.         self.assertTableExists("migrations_author")\n53.         self.assertTableNotExists("migrations_tribble")\n54.         self.assertTableExists("migrations_book")\n55.         # Unmigrate everything\n56.         stdout = io.StringIO()\n57.         call_command(\'migrate\', \'migrations\', \'zero\', verbosity=1, stdout=stdout, no_color=True)\n58.         stdout = stdout.getvalue()\n59.         self.assertIn(\'Unapply all migrations: migrations\', stdout)\n60.         self.assertIn(\'Unapplying migrations.0002_second... OK\', stdout)\n61.         # Tables are gone\n62.         self.assertTableNotExists("migrations_author")\n63.         self.assertTableNotExists("migrations_tribble")\n64.         self.assertTableNotExists("migrations_book")\n65. \n66.     @override_settings(INSTALLED_APPS=[\n67.         \'django.contrib.auth\',\n68.         \'django.contrib.contenttypes\',\n69.         \'migrations.migrations_test_apps.migrated_app\',\n70.     ])\n71.     def test_migrate_with_system_checks(self):\n72.         out = io.StringIO()\n73.         call_command(\'migrate\', skip_checks=False, no_color=True, stdout=out)\n74.         self.assertIn(\'Apply all migrations: migrated_app\', out.getvalue())\n75. \n76.     @override_settings(INSTALLED_APPS=[\'migrations\', \'migrations.migrations_test_apps.unmigrated_app_syncdb\'])\n77.     def test_app_without_migrations(self):\n78.         msg = "App \'unmigrated_app_syncdb\' does not have migrations."\n79.         with self.assertRaisesMessage(CommandError, msg):\n80.             call_command(\'migrate\', app_label=\'unmigrated_app_syncdb\')\n81. \n82.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_clashing_prefix\'})\n83.     def test_ambiguous_prefix(self):\n84.         msg = (\n85.             "More than one migration matches \'a\' in app \'migrations\'. Please "\n86.             "be more specific."\n87.         )\n88.         with self.assertRaisesMessage(CommandError, msg):\n89.             call_command(\'migrate\', app_label=\'migrations\', migration_name=\'a\')\n90. \n91.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n92.     def test_unknown_prefix(self):\n93.         msg = "Cannot find a migration matching \'nonexistent\' from app \'migrations\'."\n94.         with self.assertRaisesMessage(CommandError, msg):\n95.             call_command(\'migrate\', app_label=\'migrations\', migration_name=\'nonexistent\')\n96. \n97.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})\n98.     def test_migrate_initial_false(self):\n99.         """\n100.         `Migration.initial = False` skips fake-initial detection.\n101.         """\n102.         # Make sure no tables are created\n103.         self.assertTableNotExists("migrations_author")\n104.         self.assertTableNotExists("migrations_tribble")\n105.         # Run the migrations to 0001 only\n106.         call_command("migrate", "migrations", "0001", verbosity=0)\n107.         # Fake rollback\n108.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n109.         # Make sure fake-initial detection does not run\n110.         with self.assertRaises(DatabaseError):\n111.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)\n112. \n113.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)\n114.         # Real rollback\n115.         call_command("migrate", "migrations", "zero", verbosity=0)\n116.         # Make sure it\'s all gone\n117.         self.assertTableNotExists("migrations_author")\n118.         self.assertTableNotExists("migrations_tribble")\n119.         self.assertTableNotExists("migrations_book")\n120. \n121.     @override_settings(\n122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},\n123.         DATABASE_ROUTERS=[\'migrations.routers.TestRouter\'],\n124.     )\n125.     def test_migrate_fake_initial(self):\n126.         """\n127.         --fake-initial only works if all tables created in the initial\n128.         migration of an app exists. Database routers must be obeyed when doing\n129.         that check.\n130.         """\n131.         # Make sure no tables are created\n132.         for db in self.databases:\n133.             self.assertTableNotExists("migrations_author", using=db)\n134.             self.assertTableNotExists("migrations_tribble", using=db)\n135.         # Run the migrations to 0001 only\n136.         call_command("migrate", "migrations", "0001", verbosity=0)\n137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")\n138.         # Make sure the right tables exist\n139.         self.assertTableExists("migrations_author")\n140.         self.assertTableNotExists("migrations_tribble")\n141.         # Also check the "other" database\n142.         self.assertTableNotExists("migrations_author", using="other")\n143.         self.assertTableExists("migrations_tribble", using="other")\n144. \n145.         # Fake a roll-back\n146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n148.         # Make sure the tables still exist\n149.         self.assertTableExists("migrations_author")\n150.         self.assertTableExists("migrations_tribble", using="other")\n151.         # Try to run initial migration\n152.         with self.assertRaises(DatabaseError):\n153.             call_command("migrate", "migrations", "0001", verbosity=0)\n154.         # Run initial migration with an explicit --fake-initial\n155.         out = io.StringIO()\n156.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)\n158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")\n159.         self.assertIn(\n160.             "migrations.0001_initial... faked",\n161.             out.getvalue().lower()\n162.         )\n163.         # Run migrations all the way\n164.         call_command("migrate", verbosity=0)\n165.         call_command("migrate", verbosity=0, database="other")\n166.         # Make sure the right tables exist\n167.         self.assertTableExists("migrations_author")\n168.         self.assertTableNotExists("migrations_tribble")\n169.         self.assertTableExists("migrations_book")\n170.         self.assertTableNotExists("migrations_author", using="other")\n171.         self.assertTableNotExists("migrations_tribble", using="other")\n172.         self.assertTableNotExists("migrations_book", using="other")\n173.         # Fake a roll-back\n174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n176.         # Make sure the tables still exist\n177.         self.assertTableExists("migrations_author")\n178.         self.assertTableNotExists("migrations_tribble")\n179.         self.assertTableExists("migrations_book")\n180.         # Try to run initial migration\n181.         with self.assertRaises(DatabaseError):\n182.             call_command("migrate", "migrations", verbosity=0)\n183.         # Run initial migration with an explicit --fake-initial\n184.         with self.assertRaises(DatabaseError):\n185.             # Fails because "migrations_tribble" does not exist but needs to in\n186.             # order to make --fake-initial work.\n187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)\n188.         # Fake an apply\n189.         call_command("migrate", "migrations", fake=True, verbosity=0)\n190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")\n191.         # Unmigrate everything\n192.         call_command("migrate", "migrations", "zero", verbosity=0)\n193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")\n194.         # Make sure it\'s all gone\n195.         for db in self.databases:\n196.             self.assertTableNotExists("migrations_author", using=db)\n197.             self.assertTableNotExists("migrations_tribble", using=db)\n198.             self.assertTableNotExists("migrations_book", using=db)\n199. \n200.     @skipUnlessDBFeature(\'ignores_table_name_case\')\n201.     def test_migrate_fake_initial_case_insensitive(self):\n202.         with override_settings(MIGRATION_MODULES={\n203.             \'migrations\': \'migrations.test_fake_initial_case_insensitive.initial\',\n204.         }):\n205.             call_command(\'migrate\', \'migrations\', \'0001\', verbosity=0)\n206.             call_command(\'migrate\', \'migrations\', \'zero\', fake=True, verbosity=0)\n207. \n208.         with override_settings(MIGRATION_MODULES={\n209.             \'migrations\': \'migrations.test_fake_initial_case_insensitive.fake_initial\',\n210.         }):\n211.             out = io.StringIO()\n212.             call_command(\n213.                 \'migrate\',\n214.                 \'migrations\',\n215.                 \'0001\',\n216.                 fake_initial=True,\n217.                 stdout=out,\n218.                 verbosity=1,\n219.                 no_color=True,\n220.             )\n221.             self.assertIn(\n222.                 \'migrations.0001_initial... faked\',\n223.                 out.getvalue().lower(),\n224.             )\n225. \n226.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})\n227.     def test_migrate_fake_split_initial(self):\n228.         """\n229.         Split initial migrations can be faked with --fake-initial.\n230.         """\n231.         call_command("migrate", "migrations", "0002", verbosity=0)\n232.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n233.         out = io.StringIO()\n234.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n235.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)\n236.         value = out.getvalue().lower()\n237.         self.assertIn("migrations.0001_initial... faked", value)\n238.         self.assertIn("migrations.0002_second... faked", value)\n239.         # Fake an apply\n240.         call_command("migrate", "migrations", fake=True, verbosity=0)\n241.         # Unmigrate everything\n242.         call_command("migrate", "migrations", "zero", verbosity=0)\n243. \n244.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})\n245.     def test_migrate_conflict_exit(self):\n246.         """\n247.         migrate exits if it detects a conflict.\n248.         """\n249.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):\n250.             call_command("migrate", "migrations")\n251. \n252.     @override_settings(MIGRATION_MODULES={\n253.         \'migrations\': \'migrations.test_migrations\',\n254.     })\n255.     def test_migrate_check(self):\n256.         with self.assertRaises(SystemExit):\n257.             call_command(\'migrate\', \'migrations\', \'0001\', check_unapplied=True, verbosity=0)\n258.         self.assertTableNotExists(\'migrations_author\')\n259.         self.assertTableNotExists(\'migrations_tribble\')\n260.         self.assertTableNotExists(\'migrations_book\')\n261. \n262.     @override_settings(MIGRATION_MODULES={\n263.         \'migrations\': \'migrations.test_migrations_plan\',\n264.     })\n265.     def test_migrate_check_plan(self):\n266.         out = io.StringIO()\n267.         with self.assertRaises(SystemExit):\n268.             call_command(\n269.                 \'migrate\',\n270.                 \'migrations\',\n271.                 \'0001\',\n272.                 check_unapplied=True,\n273.                 plan=True,\n274.                 stdout=out,\n275.                 no_color=True,\n276.             )\n277.         self.assertEqual(\n278.             \'Planned operations:\\n\'\n279.             \'migrations.0001_initial\\n\'\n280.             \'    Create model Salamander\\n\'\n281.             \'    Raw Python operation -> Grow salamander tail.\\n\',\n282.             out.getvalue(),\n283.         )\n284. \n285.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n286.     def test_showmigrations_list(self):\n287.         """\n288.         showmigrations --list  displays migrations and whether or not they\'re\n289.         applied.\n290.         """\n291.         out = io.StringIO()\n292.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: True):\n293.             call_command("showmigrations", format=\'list\', stdout=out, verbosity=0, no_color=False)\n294.         self.assertEqual(\n295.             \'\\x1b[1mmigrations\\n\\x1b[0m\'\n296.             \' [ ] 0001_initial\\n\'\n297.             \' [ ] 0002_second\\n\',\n298.             out.getvalue().lower()\n299.         )\n300. \n301.         call_command("migrate", "migrations", "0001", verbosity=0)\n302. \n303.         out = io.StringIO()\n304.         # Giving the explicit app_label tests for selective `show_list` in the command\n305.         call_command("showmigrations", "migrations", format=\'list\', stdout=out, verbosity=0, no_color=True)\n306.         self.assertEqual(\n307.             \'migrations\\n\'\n308.             \' [x] 0001_initial\\n\'\n309.             \' [ ] 0002_second\\n\',\n310.             out.getvalue().lower()\n311.         )\n312.         out = io.StringIO()\n313.         # Applied datetimes are displayed at verbosity 2+.\n314.         call_command(\'showmigrations\', \'migrations\', stdout=out, verbosity=2, no_color=True)\n315.         migration1 = MigrationRecorder(connection).migration_qs.get(app=\'migrations\', name=\'0001_initial\')\n316.         self.assertEqual(\n317.             \'migrations\\n\'\n318.             \' [x] 0001_initial (applied at %s)\\n\'\n319.             \' [ ] 0002_second\\n\' % migration1.applied.strftime(\'%Y-%m-%d %H:%M:%S\'),\n320.             out.getvalue().lower()\n321.         )\n322.         # Cleanup by unmigrating everything\n323.         call_command("migrate", "migrations", "zero", verbosity=0)\n324. \n325.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})\n326.     def test_showmigrations_plan(self):\n327.         """\n328.         Tests --plan output of showmigrations command\n329.         """\n330.         out = io.StringIO()\n331.         call_command("showmigrations", format=\'plan\', stdout=out)\n332.         self.assertEqual(\n333.             "[ ]  migrations.0001_initial\\n"\n334.             "[ ]  migrations.0003_third\\n"\n335.             "[ ]  migrations.0002_second\\n",\n336.             out.getvalue().lower()\n337.         )\n338. \n339.         out = io.StringIO()\n340.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n341.         self.assertEqual(\n342.             "[ ]  migrations.0001_initial\\n"\n343.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\\n"\n344.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\\n",\n345.             out.getvalue().lower()\n346.         )\n347.         call_command("migrate", "migrations", "0003", verbosity=0)\n348. \n349.         out = io.StringIO()\n350.         call_command("showmigrations", format=\'plan\', stdout=out)\n351.         self.assertEqual(\n352.             "[x]  migrations.0001_initial\\n"\n353.             "[x]  migrations.0003_third\\n"\n354.             "[ ]  migrations.0002_second\\n",\n355.             out.getvalue().lower()\n356.         )\n357. \n358.         out = io.StringIO()\n359.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n360.         self.assertEqual(\n361.             "[x]  migrations.0001_initial\\n"\n362.             "[x]  migrations.0003_third ... (migrations.0001_initial)\\n"\n363.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\\n",\n364.             out.getvalue().lower()\n365.         )\n366. \n367.         # Cleanup by unmigrating everything\n368.         call_command("migrate", "migrations", "zero", verbosity=0)\n369. \n370.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_plan\'})\n371.     def test_migrate_plan(self):\n372.         """Tests migrate --plan output."""\n373.         out = io.StringIO()\n374.         # Show the plan up to the third migration.\n375.         call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n376.         self.assertEqual(\n377.             \'Planned operations:\\n\'\n378.             \'migrations.0001_initial\\n\'\n379.             \'    Create model Salamander\\n\'\n380.             \'    Raw Python operation -> Grow salamander tail.\\n\'\n381.             \'migrations.0002_second\\n\'\n382.             \'    Create model Book\\n\'\n383.             "    Raw SQL operation -> [\'SELECT * FROM migrations_book\']\\n"\n384.             \'migrations.0003_third\\n\'\n385.             \'    Create model Author\\n\'\n386.             "    Raw SQL operation -> [\'SELECT * FROM migrations_author\']\\n",\n387.             out.getvalue()\n388.         )\n389.         try:\n390.             # Migrate to the third migration.\n391.             call_command(\'migrate\', \'migrations\', \'0003\', verbosity=0)\n392.             out = io.StringIO()\n393.             # Show the plan for when there is nothing to apply.\n394.             call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n395.             self.assertEqual(\n396.                 \'Planned operations:\\n\'\n397.                 \'  No planned migration operations.\\n\',\n398.                 out.getvalue()\n399.             )\n400.             out = io.StringIO()\n401.             # Show the plan for reverse migration back to 0001.\n402.             call_command(\'migrate\', \'migrations\', \'0001\', plan=True, stdout=out, no_color=True)\n403.             self.assertEqual(\n404.                 \'Planned operations:\\n\'\n405.                 \'migrations.0003_third\\n\'\n406.                 \'    Undo Create model Author\\n\'\n407.                 "    Raw SQL operation -> [\'SELECT * FROM migrations_book\']\\n"\n408.                 \'migrations.0002_second\\n\'\n409.                 \'    Undo Create model Book\\n\'\n410.                 "    Raw SQL operation -> [\'SELECT * FROM migrations_salamand…\\n",\n411.                 out.getvalue()\n412.             )\n413.             out = io.StringIO()\n414.             # Show the migration plan to fourth, with truncated details.\n415.             call_command(\'migrate\', \'migrations\', \'0004\', plan=True, stdout=out, no_color=True)\n416.             self.assertEqual(\n417.                 \'Planned operations:\\n\'\n418.                 \'migrations.0004_fourth\\n\'\n419.                 \'    Raw SQL operation -> SELECT * FROM migrations_author WHE…\\n\',\n420.                 out.getvalue()\n421.             )\n422.             # Show the plan when an operation is irreversible.\n423.             # Migrate to the fourth migration.\n424.             call_command(\'migrate\', \'migrations\', \'0004\', verbosity=0)\n425.             out = io.StringIO()\n426.             call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n427.             self.assertEqual(\n428.                 \'Planned operations:\\n\'\n429.                 \'migrations.0004_fourth\\n\'\n430.                 \'    Raw SQL operation -> IRREVERSIBLE\\n\',\n431.                 out.getvalue()\n432.             )\n433.             out = io.StringIO()\n434.             call_command(\'migrate\', \'migrations\', \'0005\', plan=True, stdout=out, no_color=True)\n435.             # Operation is marked as irreversible only in the revert plan.\n436.             self.assertEqual(\n437.                 \'Planned operations:\\n\'\n438.                 \'migrations.0005_fifth\\n\'\n439.                 \'    Raw Python operation\\n\'\n440.                 \'    Raw Python operation\\n\'\n441.                 \'    Raw Python operation -> Feed salamander.\\n\',\n442.                 out.getvalue()\n443.             )\n444.             call_command(\'migrate\', \'migrations\', \'0005\', verbosity=0)\n445.             out = io.StringIO()\n446.             call_command(\'migrate\', \'migrations\', \'0004\', plan=True, stdout=out, no_color=True)\n447.             self.assertEqual(\n448.                 \'Planned operations:\\n\'\n449.                 \'migrations.0005_fifth\\n\'\n450.                 \'    Raw Python operation -> IRREVERSIBLE\\n\'\n451.                 \'    Raw Python operation -> IRREVERSIBLE\\n\'\n452.                 \'    Raw Python operation\\n\',\n453.                 out.getvalue()\n454.             )\n455.         finally:\n456.             # Cleanup by unmigrating everything: fake the irreversible, then\n457.             # migrate all to zero.\n458.             call_command(\'migrate\', \'migrations\', \'0003\', fake=True, verbosity=0)\n459.             call_command(\'migrate\', \'migrations\', \'zero\', verbosity=0)\n460. \n461.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_empty\'})\n462.     def test_showmigrations_no_migrations(self):\n463.         out = io.StringIO()\n464.         call_command(\'showmigrations\', stdout=out, no_color=True)\n465.         self.assertEqual(\'migrations\\n (no migrations)\\n\', out.getvalue().lower())\n466. \n467.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app\'])\n468.     def test_showmigrations_unmigrated_app(self):\n469.         out = io.StringIO()\n470.         call_command(\'showmigrations\', \'unmigrated_app\', stdout=out, no_color=True)\n471.         self.assertEqual(\'unmigrated_app\\n (no migrations)\\n\', out.getvalue().lower())\n472. \n473.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})\n474.     def test_showmigrations_plan_no_migrations(self):\n475.         """\n476.         Tests --plan output of showmigrations command without migrations\n477.         """\n478.         out = io.StringIO()\n479.         call_command(\'showmigrations\', format=\'plan\', stdout=out, no_color=True)\n480.         self.assertEqual(\'(no migrations)\\n\', out.getvalue().lower())\n481. \n482.         out = io.StringIO()\n483.         call_command(\'showmigrations\', format=\'plan\', stdout=out, verbosity=2, no_color=True)\n484.         self.assertEqual(\'(no migrations)\\n\', out.getvalue().lower())\n485. \n486.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})\n487.     def test_showmigrations_plan_squashed(self):\n488.         """\n489.         Tests --plan output of showmigrations command with squashed migrations.\n490.         """\n491.         out = io.StringIO()\n492.         call_command("showmigrations", format=\'plan\', stdout=out)\n493.         self.assertEqual(\n494.             "[ ]  migrations.1_auto\\n"\n495.             "[ ]  migrations.2_auto\\n"\n496.             "[ ]  migrations.3_squashed_5\\n"\n497.             "[ ]  migrations.6_auto\\n"\n498.             "[ ]  migrations.7_auto\\n",\n499.             out.getvalue().lower()\n500.         )\n501. \n502.         out = io.StringIO()\n503.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n504.         self.assertEqual(\n505.             "[ ]  migrations.1_auto\\n"\n506.             "[ ]  migrations.2_auto ... (migrations.1_auto)\\n"\n507.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\\n"\n508.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\\n"\n509.             "[ ]  migrations.7_auto ... (migrations.6_auto)\\n",\n510.             out.getvalue().lower()\n511.         )\n512. \n513.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)\n514. \n515.         out = io.StringIO()\n516.         call_command("showmigrations", format=\'plan\', stdout=out)\n517.         self.assertEqual(\n518.             "[x]  migrations.1_auto\\n"\n519.             "[x]  migrations.2_auto\\n"\n520.             "[x]  migrations.3_squashed_5\\n"\n521.             "[ ]  migrations.6_auto\\n"\n522.             "[ ]  migrations.7_auto\\n",\n523.             out.getvalue().lower()\n524.         )\n525. \n526.         out = io.StringIO()\n527.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n528.         self.assertEqual(\n529.             "[x]  migrations.1_auto\\n"\n530.             "[x]  migrations.2_auto ... (migrations.1_auto)\\n"\n531.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\\n"\n532.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\\n"\n533.             "[ ]  migrations.7_auto ... (migrations.6_auto)\\n",\n534.             out.getvalue().lower()\n535.         )\n536. \n537.     @override_settings(INSTALLED_APPS=[\n538.         \'migrations.migrations_test_apps.mutate_state_b\',\n539.         \'migrations.migrations_test_apps.alter_fk.author_app\',\n540.         \'migrations.migrations_test_apps.alter_fk.book_app\',\n541.     ])\n542.     def test_showmigrations_plan_single_app_label(self):\n543.         """\n544.         `showmigrations --plan app_label` output with a single app_label.\n545.         """\n546.         # Single app with no dependencies on other apps.\n547.         out = io.StringIO()\n548.         call_command(\'showmigrations\', \'mutate_state_b\', format=\'plan\', stdout=out)\n549.         self.assertEqual(\n550.             \'[ ]  mutate_state_b.0001_initial\\n\'\n551.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n552.             out.getvalue()\n553.         )\n554.         # Single app with dependencies.\n555.         out = io.StringIO()\n556.         call_command(\'showmigrations\', \'author_app\', format=\'plan\', stdout=out)\n557.         self.assertEqual(\n558.             \'[ ]  author_app.0001_initial\\n\'\n559.             \'[ ]  book_app.0001_initial\\n\'\n560.             \'[ ]  author_app.0002_alter_id\\n\',\n561.             out.getvalue()\n562.         )\n563.         # Some migrations already applied.\n564.         call_command(\'migrate\', \'author_app\', \'0001\', verbosity=0)\n565.         out = io.StringIO()\n566.         call_command(\'showmigrations\', \'author_app\', format=\'plan\', stdout=out)\n567.         self.assertEqual(\n568.             \'[X]  author_app.0001_initial\\n\'\n569.             \'[ ]  book_app.0001_initial\\n\'\n570.             \'[ ]  author_app.0002_alter_id\\n\',\n571.             out.getvalue()\n572.         )\n573.         # Cleanup by unmigrating author_app.\n574.         call_command(\'migrate\', \'author_app\', \'zero\', verbosity=0)\n575. \n576.     @override_settings(INSTALLED_APPS=[\n577.         \'migrations.migrations_test_apps.mutate_state_b\',\n578.         \'migrations.migrations_test_apps.alter_fk.author_app\',\n579.         \'migrations.migrations_test_apps.alter_fk.book_app\',\n580.     ])\n581.     def test_showmigrations_plan_multiple_app_labels(self):\n582.         """\n583.         `showmigrations --plan app_label` output with multiple app_labels.\n584.         """\n585.         # Multiple apps: author_app depends on book_app; mutate_state_b doesn\'t\n586.         # depend on other apps.\n587.         out = io.StringIO()\n588.         call_command(\'showmigrations\', \'mutate_state_b\', \'author_app\', format=\'plan\', stdout=out)\n589.         self.assertEqual(\n590.             \'[ ]  author_app.0001_initial\\n\'\n591.             \'[ ]  book_app.0001_initial\\n\'\n592.             \'[ ]  author_app.0002_alter_id\\n\'\n593.             \'[ ]  mutate_state_b.0001_initial\\n\'\n594.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n595.             out.getvalue()\n596.         )\n597.         # Multiple apps: args order shouldn\'t matter (the same result is\n598.         # expected as above).\n599.         out = io.StringIO()\n600.         call_command(\'showmigrations\', \'author_app\', \'mutate_state_b\', format=\'plan\', stdout=out)\n601.         self.assertEqual(\n602.             \'[ ]  author_app.0001_initial\\n\'\n603.             \'[ ]  book_app.0001_initial\\n\'\n604.             \'[ ]  author_app.0002_alter_id\\n\'\n605.             \'[ ]  mutate_state_b.0001_initial\\n\'\n606.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n607.             out.getvalue()\n608.         )\n609. \n610.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app\'])\n611.     def test_showmigrations_plan_app_label_no_migrations(self):\n612.         out = io.StringIO()\n613.         call_command(\'showmigrations\', \'unmigrated_app\', format=\'plan\', stdout=out, no_color=True)\n614.         self.assertEqual(\'(no migrations)\\n\', out.getvalue())\n615. \n616.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n617.     def test_sqlmigrate_forwards(self):\n618.         """\n619.         sqlmigrate outputs forward looking SQL.\n620.         """\n621.         out = io.StringIO()\n622.         call_command("sqlmigrate", "migrations", "0001", stdout=out)\n623.         output = out.getvalue().lower()\n624. \n625.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())\n626.         index_op_desc_author = output.find(\'-- create model author\')\n627.         index_create_table = output.find(\'create table\')\n628.         index_op_desc_tribble = output.find(\'-- create model tribble\')\n629.         index_op_desc_unique_together = output.find(\'-- alter unique_together\')\n630.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())\n631. \n632.         if connection.features.can_rollback_ddl:\n633.             self.assertGreater(index_tx_start, -1, "Transaction start not found")\n634.             self.assertGreater(\n635.                 index_tx_end, index_op_desc_unique_together,\n636.                 "Transaction end not found or found before operation description (unique_together)"\n637.             )\n638. \n639.         self.assertGreater(\n640.             index_op_desc_author, index_tx_start,\n641.             "Operation description (author) not found or found before transaction start"\n642.         )\n643.         self.assertGreater(\n644.             index_create_table, index_op_desc_author,\n645.             "CREATE TABLE not found or found before operation description (author)"\n646.         )\n647.         self.assertGreater(\n648.             index_op_desc_tribble, index_create_table,\n649.             "Operation description (tribble) not found or found before CREATE TABLE (author)"\n650.         )\n651.         self.assertGreater(\n652.             index_op_desc_unique_together, index_op_desc_tribble,\n653.             "Operation description (unique_together) not found or found before operation description (tribble)"\n654.         )\n655. \n656.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n657.     def test_sqlmigrate_backwards(self):\n658.         """\n659.         sqlmigrate outputs reverse looking SQL.\n660.         """\n661.         # Cannot generate the reverse SQL unless we\'ve applied the migration.\n662.         call_command("migrate", "migrations", verbosity=0)\n663. \n664.         out = io.StringIO()\n665.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)\n666.         output = out.getvalue().lower()\n667. \n668.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())\n669.         index_op_desc_unique_together = output.find(\'-- alter unique_together\')\n670.         index_op_desc_tribble = output.find(\'-- create model tribble\')\n671.         index_op_desc_author = output.find(\'-- create model author\')\n672.         index_drop_table = output.rfind(\'drop table\')\n673.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())\n674. \n675.         if connection.features.can_rollback_ddl:\n676.             self.assertGreater(index_tx_start, -1, "Transaction start not found")\n677.             self.assertGreater(\n678.                 index_tx_end, index_op_desc_unique_together,\n679.                 "Transaction end not found or found before DROP TABLE"\n680.             )\n681.         self.assertGreater(\n682.             index_op_desc_unique_together, index_tx_start,\n683.             "Operation description (unique_together) not found or found before transaction start"\n684.         )\n685.         self.assertGreater(\n686.             index_op_desc_tribble, index_op_desc_unique_together,\n687.             "Operation description (tribble) not found or found before operation description (unique_together)"\n688.         )\n689.         self.assertGreater(\n690.             index_op_desc_author, index_op_desc_tribble,\n691.             "Operation description (author) not found or found before operation description (tribble)"\n692.         )\n693. \n694.         self.assertGreater(\n695.             index_drop_table, index_op_desc_author,\n696.             "DROP TABLE not found or found before operation description (author)"\n697.         )\n698. \n699.         # Cleanup by unmigrating everything\n700.         call_command("migrate", "migrations", "zero", verbosity=0)\n701. \n702.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})\n703.     def test_sqlmigrate_for_non_atomic_migration(self):\n704.         """\n705.         Transaction wrappers aren\'t shown for non-atomic migrations.\n706.         """\n707.         out = io.StringIO()\n708.         call_command("sqlmigrate", "migrations", "0001", stdout=out)\n709.         output = out.getvalue().lower()\n710.         queries = [q.strip() for q in output.splitlines()]\n711.         if connection.ops.start_transaction_sql():\n712.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)\n713.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)\n714. \n715.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n716.     def test_sqlmigrate_for_non_transactional_databases(self):\n717.         """\n718.         Transaction wrappers aren\'t shown for databases that don\'t support\n719.         transactional DDL.\n720.         """\n721.         out = io.StringIO()\n722.         with mock.patch.object(connection.features, \'can_rollback_ddl\', False):\n723.             call_command(\'sqlmigrate\', \'migrations\', \'0001\', stdout=out)\n724.         output = out.getvalue().lower()\n725.         queries = [q.strip() for q in output.splitlines()]\n726.         start_transaction_sql = connection.ops.start_transaction_sql()\n727.         if start_transaction_sql:\n728.             self.assertNotIn(start_transaction_sql.lower(), queries)\n729.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)\n730. \n731.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n732.     def test_sqlmigrate_ambiguous_prefix_squashed_migrations(self):\n733.         msg = (\n734.             "More than one migration matches \'0001\' in app \'migrations\'. "\n735.             "Please be more specific."\n736.         )\n737.         with self.assertRaisesMessage(CommandError, msg):\n738.             call_command(\'sqlmigrate\', \'migrations\', \'0001\')\n739. \n740.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n741.     def test_sqlmigrate_squashed_migration(self):\n742.         out = io.StringIO()\n743.         call_command(\'sqlmigrate\', \'migrations\', \'0001_squashed_0002\', stdout=out)\n744.         output = out.getvalue().lower()\n745.         self.assertIn(\'-- create model author\', output)\n746.         self.assertIn(\'-- create model book\', output)\n747.         self.assertNotIn(\'-- create model tribble\', output)\n748. \n749.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n750.     def test_sqlmigrate_replaced_migration(self):\n751.         out = io.StringIO()\n752.         call_command(\'sqlmigrate\', \'migrations\', \'0001_initial\', stdout=out)\n753.         output = out.getvalue().lower()\n754.         self.assertIn(\'-- create model author\', output)\n755.         self.assertIn(\'-- create model tribble\', output)\n756. \n757.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_no_operations\'})\n758.     def test_migrations_no_operations(self):\n759.         err = io.StringIO()\n760.         call_command(\'sqlmigrate\', \'migrations\', \'0001_initial\', stderr=err)\n761.         self.assertEqual(err.getvalue(), \'No operations found.\\n\')\n762. \n763.     @override_settings(\n764.         INSTALLED_APPS=[\n765.             "migrations.migrations_test_apps.migrated_app",\n766.             "migrations.migrations_test_apps.migrated_unapplied_app",\n767.             "migrations.migrations_test_apps.unmigrated_app",\n768.         ],\n769.     )\n770.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):\n771.         """\n772.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:\n773. \n774.         * `A` has migrations\n775.         * `B` has a migration we want to apply\n776.         * `C` has no migrations, but has an FK to `A`\n777. \n778.         When we try to migrate "B", an exception occurs because the\n779.         "B" was not included in the ProjectState that is used to detect\n780.         soft-applied migrations (#22823).\n781.         """\n782.         call_command("migrate", "migrated_unapplied_app", stdout=io.StringIO())\n783. \n784.         # unmigrated_app.SillyModel has a foreign key to \'migrations.Tribble\',\n785.         # but that model is only defined in a migration, so the global app\n786.         # registry never sees it and the reference is left dangling. Remove it\n787.         # to avoid problems in subsequent tests.\n788.         del apps._pending_operations[(\'migrations\', \'tribble\')]\n789. \n790.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app_syncdb\'])\n791.     def test_migrate_syncdb_deferred_sql_executed_with_schemaeditor(self):\n792.         """\n793.         For an app without migrations, editor.execute() is used for executing\n794.         the syncdb deferred SQL.\n795.         """\n796.         stdout = io.StringIO()\n797.         with mock.patch.object(BaseDatabaseSchemaEditor, \'execute\') as execute:\n798.             call_command(\'migrate\', run_syncdb=True, verbosity=1, stdout=stdout, no_color=True)\n799.             create_table_count = len([call for call in execute.mock_calls if \'CREATE TABLE\' in str(call)])\n800.             self.assertEqual(create_table_count, 2)\n801.             # There\'s at least one deferred SQL for creating the foreign key\n802.             # index.\n803.             self.assertGreater(len(execute.mock_calls), 2)\n804.         stdout = stdout.getvalue()\n805.         self.assertIn(\'Synchronize unmigrated apps: unmigrated_app_syncdb\', stdout)\n806.         self.assertIn(\'Creating tables...\', stdout)\n807.         table_name = truncate_name(\'unmigrated_app_syncdb_classroom\', connection.ops.max_name_length())\n808.         self.assertIn(\'Creating table %s\' % table_name, stdout)\n809. \n810.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n811.     def test_migrate_syncdb_app_with_migrations(self):\n812.         msg = "Can\'t use run_syncdb with app \'migrations\' as it has migrations."\n813.         with self.assertRaisesMessage(CommandError, msg):\n814.             call_command(\'migrate\', \'migrations\', run_syncdb=True, verbosity=0)\n815. \n816.     @override_settings(INSTALLED_APPS=[\n817.         \'migrations.migrations_test_apps.unmigrated_app_syncdb\',\n818.         \'migrations.migrations_test_apps.unmigrated_app_simple\',\n819.     ])\n820.     def test_migrate_syncdb_app_label(self):\n821.         """\n822.         Running migrate --run-syncdb with an app_label only creates tables for\n823.         the specified app.\n824.         """\n825.         stdout = io.StringIO()\n826.         with mock.patch.object(BaseDatabaseSchemaEditor, \'execute\') as execute:\n827.             call_command(\'migrate\', \'unmigrated_app_syncdb\', run_syncdb=True, stdout=stdout)\n828.             create_table_count = len([call for call in execute.mock_calls if \'CREATE TABLE\' in str(call)])\n829.             self.assertEqual(create_table_count, 2)\n830.             self.assertGreater(len(execute.mock_calls), 2)\n831.             self.assertIn(\'Synchronize unmigrated app: unmigrated_app_syncdb\', stdout.getvalue())\n832. \n833.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})\n834.     def test_migrate_record_replaced(self):\n835.         """\n836.         Running a single squashed migration should record all of the original\n837.         replaced migrations as run.\n838.         """\n839.         recorder = MigrationRecorder(connection)\n840.         out = io.StringIO()\n841.         call_command("migrate", "migrations", verbosity=0)\n842.         call_command("showmigrations", "migrations", stdout=out, no_color=True)\n843.         self.assertEqual(\n844.             \'migrations\\n\'\n845.             \' [x] 0001_squashed_0002 (2 squashed migrations)\\n\',\n846.             out.getvalue().lower()\n847.         )\n848.         applied_migrations = recorder.applied_migrations()\n849.         self.assertIn(("migrations", "0001_initial"), applied_migrations)\n850.         self.assertIn(("migrations", "0002_second"), applied_migrations)\n851.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)\n852.         # Rollback changes\n853.         call_command("migrate", "migrations", "zero", verbosity=0)\n854. \n855.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})\n856.     def test_migrate_record_squashed(self):\n857.         """\n858.         Running migrate for a squashed migration should record as run\n859.         if all of the replaced migrations have been run (#25231).\n860.         """\n861.         recorder = MigrationRecorder(connection)\n862.         recorder.record_applied("migrations", "0001_initial")\n863.         recorder.record_applied("migrations", "0002_second")\n864.         out = io.StringIO()\n865.         call_command("migrate", "migrations", verbosity=0)\n866.         call_command("showmigrations", "migrations", stdout=out, no_color=True)\n867.         self.assertEqual(\n868.             \'migrations\\n\'\n869.             \' [x] 0001_squashed_0002 (2 squashed migrations)\\n\',\n870.             out.getvalue().lower()\n871.         )\n872.         self.assertIn(\n873.             ("migrations", "0001_squashed_0002"),\n874.             recorder.applied_migrations()\n875.         )\n876.         # No changes were actually applied so there is nothing to rollback\n877. \n878.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n879.     def test_migrate_inconsistent_history(self):\n880.         """\n881.         Running migrate with some migrations applied before their dependencies\n882.         should not be allowed.\n883.         """\n884.         recorder = MigrationRecorder(connection)\n885.         recorder.record_applied("migrations", "0002_second")\n886.         msg = "Migration migrations.0002_second is applied before its dependency migrations.0001_initial"\n887.         with self.assertRaisesMessage(InconsistentMigrationHistory, msg):\n888.             call_command("migrate")\n889.         applied_migrations = recorder.applied_migrations()\n890.         self.assertNotIn(("migrations", "0001_initial"), applied_migrations)\n891. \n892. \n893. class MakeMigrationsTests(MigrationTestBase):\n894.     """\n895.     Tests running the makemigrations command.\n896.     """\n897. \n898.     def setUp(self):\n899.         super().setUp()\n900.         self._old_models = apps.app_configs[\'migrations\'].models.copy()\n901. \n902.     def tearDown(self):\n903.         apps.app_configs[\'migrations\'].models = self._old_models\n904.         apps.all_models[\'migrations\'] = self._old_models\n905.         apps.clear_cache()\n906.         super().tearDown()\n907. \n908.     def test_files_content(self):\n909.         self.assertTableNotExists("migrations_unicodemodel")\n910.         apps.register_model(\'migrations\', UnicodeModel)\n911.         with self.temporary_migration_module() as migration_dir:\n912.             call_command("makemigrations", "migrations", verbosity=0)\n913. \n914.             # Check for empty __init__.py file in migrations folder\n915.             init_file = os.path.join(migration_dir, "__init__.py")\n916.             self.assertTrue(os.path.exists(init_file))\n917. \n918.             with open(init_file) as fp:\n919.                 content = fp.read()\n920.             self.assertEqual(content, \'\')\n921. \n922.             # Check for existing 0001_initial.py file in migration folder\n923.             initial_file = os.path.join(migration_dir, "0001_initial.py")\n924.             self.assertTrue(os.path.exists(initial_file))\n925. \n926.             with open(initial_file, encoding=\'utf-8\') as fp:\n927.                 content = fp.read()\n928.                 self.assertIn(\'migrations.CreateModel\', content)\n929.                 self.assertIn(\'initial = True\', content)\n930. \n931.                 self.assertIn(\'úñí©óðé µóðéø\', content)  # Meta.verbose_name\n932.                 self.assertIn(\'úñí©óðé µóðéøß\', content)  # Meta.verbose_name_plural\n933.                 self.assertIn(\'ÚÑÍ¢ÓÐÉ\', content)  # title.verbose_name\n934.                 self.assertIn(\'“Ðjáñgó”\', content)  # title.default\n935. \n936.     def test_makemigrations_order(self):\n937.         """\n938.         makemigrations should recognize number-only migrations (0001.py).\n939.         """\n940.         module = \'migrations.test_migrations_order\'\n941.         with self.temporary_migration_module(module=module) as migration_dir:\n942.             if hasattr(importlib, \'invalidate_caches\'):\n943.                 # importlib caches os.listdir() on some platforms like macOS\n944.                 # (#23850).\n945.                 importlib.invalidate_caches()\n946.             call_command(\'makemigrations\', \'migrations\', \'--empty\', \'-n\', \'a\', \'-v\', \'0\')\n947.             self.assertTrue(os.path.exists(os.path.join(migration_dir, \'0002_a.py\')))\n948. \n949.     def test_makemigrations_empty_connections(self):\n950.         empty_connections = ConnectionHandler({\'default\': {}})\n951.         with mock.patch(\'django.core.management.commands.makemigrations.connections\', new=empty_connections):\n952.             # with no apps\n953.             out = io.StringIO()\n954.             call_command(\'makemigrations\', stdout=out)\n955.             self.assertIn(\'No changes detected\', out.getvalue())\n956.             # with an app\n957.             with self.temporary_migration_module() as migration_dir:\n958.                 call_command(\'makemigrations\', \'migrations\', verbosity=0)\n959.                 init_file = os.path.join(migration_dir, \'__init__.py\')\n960.                 self.assertTrue(os.path.exists(init_file))\n961. \n962.     @override_settings(INSTALLED_APPS=[\'migrations\', \'migrations2\'])\n963.     def test_makemigrations_consistency_checks_respect_routers(self):\n964.         """\n965.         The history consistency checks in makemigrations respect\n966.         settings.DATABASE_ROUTERS.\n967.         """\n968.         def patched_has_table(migration_recorder):\n969.             if migration_recorder.connection is connections[\'other\']:\n970.                 raise Exception(\'Other connection\')\n971.             else:\n972.                 return mock.DEFAULT\n973. \n974.         self.assertTableNotExists(\'migrations_unicodemodel\')\n975.         apps.register_model(\'migrations\', UnicodeModel)\n976.         with mock.patch.object(\n977.                 MigrationRecorder, \'has_table\',\n978.                 autospec=True, side_effect=patched_has_table) as has_table:\n979.             with self.temporary_migration_module() as migration_dir:\n980.                 call_command("makemigrations", "migrations", verbosity=0)\n981.                 initial_file = os.path.join(migration_dir, "0001_initial.py")\n982.                 self.assertTrue(os.path.exists(initial_file))\n983.                 self.assertEqual(has_table.call_count, 1)  # \'default\' is checked\n984. \n985.                 # Router says not to migrate \'other\' so consistency shouldn\'t\n986.                 # be checked.\n987.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.TestRouter\']):\n988.                     call_command(\'makemigrations\', \'migrations\', verbosity=0)\n989.                 self.assertEqual(has_table.call_count, 2)  # \'default\' again\n990. \n991.                 # With a router that doesn\'t prohibit migrating \'other\',\n992.                 # consistency is checked.\n993.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.DefaultOtherRouter\']):\n994.                     with self.assertRaisesMessage(Exception, \'Other connection\'):\n995.                         call_command(\'makemigrations\', \'migrations\', verbosity=0)\n996.                 self.assertEqual(has_table.call_count, 4)  # \'default\' and \'other\'\n997. \n998.                 # With a router that doesn\'t allow migrating on any database,\n999.                 # no consistency checks are made.\n1000.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.TestRouter\']):', start_line_number=1, end_line_number=1000)]
2025-10-06 05:10:52,260 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 05:10:52,260 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-10-06 05:10:52,261 - thread-139660780025408.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Context retrieved: [Context(relative_path='tests/model_regress/tests.py', content='37.     def test_sql_insert_compiler_return_id_attribute(self):\n38.         """\n39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure\n40.         """\n41.         db = router.db_for_write(Party)\n42.         query = InsertQuery(Party)\n43.         query.insert_values([Party._meta.fields[0]], [], raw=False)\n44.         # this line will raise an AttributeError without the accompanying fix\n45.         query.get_compiler(using=db).as_sql()\n46. ', start_line_number=37, end_line_number=46), Context(relative_path='tests/admin_scripts/tests.py', content='258.     def test_custom_command_with_settings(self):\n259.         "default: django-admin can execute user commands if settings are provided as argument"\n260.         args = [\'noargs_command\', \'--settings=test_project.settings\']\n261.         out, err = self.run_django_admin(args)\n262.         self.assertNoOutput(err)\n263.         self.assertOutput(out, "EXECUTE: noargs_command")', start_line_number=258, end_line_number=263), Context(relative_path='tests/backends/base/test_operations.py', content="1. import decimal\n2. \n3. from django.core.management.color import no_style\n4. from django.db import NotSupportedError, connection, transaction\n5. from django.db.backends.base.operations import BaseDatabaseOperations\n6. from django.db.models import DurationField\n7. from django.test import (\n8.     SimpleTestCase, TestCase, TransactionTestCase, override_settings,\n9.     skipIfDBFeature,\n10. )\n11. from django.utils import timezone\n12. \n13. from ..models import Author, Book\n14. \n15. \n16. class SimpleDatabaseOperationTests(SimpleTestCase):\n17.     may_require_msg = 'subclasses of BaseDatabaseOperations may require a %s() method'\n18. \n19.     def setUp(self):\n20.         self.ops = BaseDatabaseOperations(connection=connection)\n21. \n22.     def test_deferrable_sql(self):\n23.         self.assertEqual(self.ops.deferrable_sql(), '')\n24. \n25.     def test_end_transaction_rollback(self):\n26.         self.assertEqual(self.ops.end_transaction_sql(success=False), 'ROLLBACK;')\n27. \n28.     def test_no_limit_value(self):\n29.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'no_limit_value'):\n30.             self.ops.no_limit_value()\n31. \n32.     def test_quote_name(self):\n33.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'quote_name'):\n34.             self.ops.quote_name('a')\n35. \n36.     def test_regex_lookup(self):\n37.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'regex_lookup'):\n38.             self.ops.regex_lookup(lookup_type='regex')\n39. \n40.     def test_set_time_zone_sql(self):\n41.         self.assertEqual(self.ops.set_time_zone_sql(), '')\n42. \n43.     def test_sql_flush(self):\n44.         msg = 'subclasses of BaseDatabaseOperations must provide a sql_flush() method'\n45.         with self.assertRaisesMessage(NotImplementedError, msg):\n46.             self.ops.sql_flush(None, None)\n47. \n48.     def test_pk_default_value(self):\n49.         self.assertEqual(self.ops.pk_default_value(), 'DEFAULT')\n50. \n51.     def test_tablespace_sql(self):\n52.         self.assertEqual(self.ops.tablespace_sql(None), '')\n53. \n54.     def test_sequence_reset_by_name_sql(self):\n55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])\n56. \n57.     def test_adapt_unknown_value_decimal(self):\n58.         value = decimal.Decimal('3.14')\n59.         self.assertEqual(\n60.             self.ops.adapt_unknown_value(value),\n61.             self.ops.adapt_decimalfield_value(value)\n62.         )\n63. \n64.     def test_adapt_unknown_value_date(self):\n65.         value = timezone.now().date()\n66.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_datefield_value(value))\n67. \n68.     def test_adapt_unknown_value_time(self):\n69.         value = timezone.now().time()\n70.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_timefield_value(value))\n71. \n72.     def test_adapt_timefield_value_none(self):\n73.         self.assertIsNone(self.ops.adapt_timefield_value(None))\n74. \n75.     def test_adapt_datetimefield_value(self):\n76.         self.assertIsNone(self.ops.adapt_datetimefield_value(None))\n77. \n78.     def test_adapt_timefield_value(self):\n79.         msg = 'Django does not support timezone-aware times.'\n80.         with self.assertRaisesMessage(ValueError, msg):\n81.             self.ops.adapt_timefield_value(timezone.make_aware(timezone.now()))\n82. \n83.     @override_settings(USE_TZ=False)\n84.     def test_adapt_timefield_value_unaware(self):\n85.         now = timezone.now()\n86.         self.assertEqual(self.ops.adapt_timefield_value(now), str(now))\n87. \n88.     def test_date_extract_sql(self):\n89.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):\n90.             self.ops.date_extract_sql(None, None)\n91. \n92.     def test_time_extract_sql(self):\n93.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_extract_sql'):\n94.             self.ops.time_extract_sql(None, None)\n95. \n96.     def test_date_interval_sql(self):\n97.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_interval_sql'):\n98.             self.ops.date_interval_sql(None)\n99. \n100.     def test_date_trunc_sql(self):\n101.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'date_trunc_sql'):\n102.             self.ops.date_trunc_sql(None, None)\n103. \n104.     def test_time_trunc_sql(self):\n105.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'time_trunc_sql'):\n106.             self.ops.time_trunc_sql(None, None)\n107. \n108.     def test_datetime_trunc_sql(self):\n109.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_trunc_sql'):\n110.             self.ops.datetime_trunc_sql(None, None, None)\n111. \n112.     def test_datetime_cast_date_sql(self):\n113.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_date_sql'):\n114.             self.ops.datetime_cast_date_sql(None, None)\n115. \n116.     def test_datetime_cast_time_sql(self):\n117.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_cast_time_sql'):\n118.             self.ops.datetime_cast_time_sql(None, None)\n119. \n120.     def test_datetime_extract_sql(self):\n121.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % 'datetime_extract_sql'):\n122.             self.ops.datetime_extract_sql(None, None, None)\n123. \n124. \n125. class DatabaseOperationTests(TestCase):\n126.     def setUp(self):\n127.         self.ops = BaseDatabaseOperations(connection=connection)\n128. \n129.     @skipIfDBFeature('supports_over_clause')\n130.     def test_window_frame_raise_not_supported_error(self):\n131.         msg = 'This backend does not support window expressions.'\n132.         with self.assertRaisesMessage(NotSupportedError, msg):\n133.             self.ops.window_frame_rows_start_end()\n134. \n135.     @skipIfDBFeature('can_distinct_on_fields')\n136.     def test_distinct_on_fields(self):\n137.         msg = 'DISTINCT ON fields is not supported by this database backend'\n138.         with self.assertRaisesMessage(NotSupportedError, msg):\n139.             self.ops.distinct_sql(['a', 'b'], None)\n140. \n141.     @skipIfDBFeature('supports_temporal_subtraction')\n142.     def test_subtract_temporals(self):\n143.         duration_field = DurationField()\n144.         duration_field_internal_type = duration_field.get_internal_type()\n145.         msg = (\n146.             'This backend does not support %s subtraction.' %\n147.             duration_field_internal_type\n148.         )\n149.         with self.assertRaisesMessage(NotSupportedError, msg):\n150.             self.ops.subtract_temporals(duration_field_internal_type, None, None)\n151. \n152. \n153. class SqlFlushTests(TransactionTestCase):\n154.     available_apps = ['backends']\n155. \n156.     def test_sql_flush_no_tables(self):\n157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])\n158. \n159.     def test_execute_sql_flush_statements(self):\n160.         with transaction.atomic():\n161.             author = Author.objects.create(name='George Orwell')\n162.             Book.objects.create(author=author)\n163.             author = Author.objects.create(name='Harper Lee')\n164.             Book.objects.create(author=author)\n165.             Book.objects.create(author=author)\n166.             self.assertIs(Author.objects.exists(), True)\n167.             self.assertIs(Book.objects.exists(), True)\n168. \n169.         sql_list = connection.ops.sql_flush(\n170.             no_style(),\n171.             [Author._meta.db_table, Book._meta.db_table],\n172.             reset_sequences=True,\n173.             allow_cascade=True,\n174.         )\n175.         connection.ops.execute_sql_flush(connection.alias, sql_list)\n176. \n177.         with transaction.atomic():\n178.             self.assertIs(Author.objects.exists(), False)\n179.             self.assertIs(Book.objects.exists(), False)\n180.             if connection.features.supports_sequence_reset:\n181.                 author = Author.objects.create(name='F. Scott Fitzgerald')\n182.                 self.assertEqual(author.pk, 1)\n183.                 book = Book.objects.create(author=author)\n184.                 self.assertEqual(book.pk, 1)", start_line_number=1, end_line_number=184), Context(relative_path='tests/multiple_database/tests.py', content='1. import datetime\n2. import pickle\n3. from io import StringIO\n4. from operator import attrgetter\n5. from unittest.mock import Mock\n6. \n7. from django.contrib.auth.models import User\n8. from django.contrib.contenttypes.models import ContentType\n9. from django.core import management\n10. from django.db import DEFAULT_DB_ALIAS, router, transaction\n11. from django.db.models import signals\n12. from django.db.utils import ConnectionRouter\n13. from django.test import SimpleTestCase, TestCase, override_settings\n14. \n15. from .models import Book, Person, Pet, Review, UserProfile\n16. from .routers import AuthRouter, TestRouter, WriteRouter\n17. \n18. \n19. class QueryTestCase(TestCase):\n20.     databases = {\'default\', \'other\'}\n21. \n22.     def test_db_selection(self):\n23.         "Querysets will use the default database by default"\n24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)\n25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)\n26. \n27.         self.assertEqual(Book.objects.using(\'other\').db, \'other\')\n28. \n29.         self.assertEqual(Book.objects.db_manager(\'other\').db, \'other\')\n30.         self.assertEqual(Book.objects.db_manager(\'other\').all().db, \'other\')\n31. \n32.     def test_default_creation(self):\n33.         "Objects created on the default database don\'t leak onto other databases"\n34.         # Create a book on the default database using create()\n35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n36. \n37.         # Create a book on the default database using a save\n38.         dive = Book()\n39.         dive.title = "Dive into Python"\n40.         dive.published = datetime.date(2009, 5, 4)\n41.         dive.save()\n42. \n43.         # Book exists on the default database, but not on other database\n44.         try:\n45.             Book.objects.get(title="Pro Django")\n46.             Book.objects.using(\'default\').get(title="Pro Django")\n47.         except Book.DoesNotExist:\n48.             self.fail(\'"Pro Django" should exist on default database\')\n49. \n50.         with self.assertRaises(Book.DoesNotExist):\n51.             Book.objects.using(\'other\').get(title="Pro Django")\n52. \n53.         try:\n54.             Book.objects.get(title="Dive into Python")\n55.             Book.objects.using(\'default\').get(title="Dive into Python")\n56.         except Book.DoesNotExist:\n57.             self.fail(\'"Dive into Python" should exist on default database\')\n58. \n59.         with self.assertRaises(Book.DoesNotExist):\n60.             Book.objects.using(\'other\').get(title="Dive into Python")\n61. \n62.     def test_other_creation(self):\n63.         "Objects created on another database don\'t leak onto the default database"\n64.         # Create a book on the second database\n65.         Book.objects.using(\'other\').create(title="Pro Django",\n66.                                            published=datetime.date(2008, 12, 16))\n67. \n68.         # Create a book on the default database using a save\n69.         dive = Book()\n70.         dive.title = "Dive into Python"\n71.         dive.published = datetime.date(2009, 5, 4)\n72.         dive.save(using=\'other\')\n73. \n74.         # Book exists on the default database, but not on other database\n75.         try:\n76.             Book.objects.using(\'other\').get(title="Pro Django")\n77.         except Book.DoesNotExist:\n78.             self.fail(\'"Pro Django" should exist on other database\')\n79. \n80.         with self.assertRaises(Book.DoesNotExist):\n81.             Book.objects.get(title="Pro Django")\n82.         with self.assertRaises(Book.DoesNotExist):\n83.             Book.objects.using(\'default\').get(title="Pro Django")\n84. \n85.         try:\n86.             Book.objects.using(\'other\').get(title="Dive into Python")\n87.         except Book.DoesNotExist:\n88.             self.fail(\'"Dive into Python" should exist on other database\')\n89. \n90.         with self.assertRaises(Book.DoesNotExist):\n91.             Book.objects.get(title="Dive into Python")\n92.         with self.assertRaises(Book.DoesNotExist):\n93.             Book.objects.using(\'default\').get(title="Dive into Python")\n94. \n95.     def test_refresh(self):\n96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))\n97.         dive.save(using=\'other\')\n98.         dive2 = Book.objects.using(\'other\').get()\n99.         dive2.title = "Dive into Python (on default)"\n100.         dive2.save(using=\'default\')\n101.         dive.refresh_from_db()\n102.         self.assertEqual(dive.title, "Dive into Python")\n103.         dive.refresh_from_db(using=\'default\')\n104.         self.assertEqual(dive.title, "Dive into Python (on default)")\n105.         self.assertEqual(dive._state.db, "default")\n106. \n107.     def test_refresh_router_instance_hint(self):\n108.         router = Mock()\n109.         router.db_for_read.return_value = None\n110.         book = Book.objects.create(title=\'Dive Into Python\', published=datetime.date(1957, 10, 12))\n111.         with self.settings(DATABASE_ROUTERS=[router]):\n112.             book.refresh_from_db()\n113.         router.db_for_read.assert_called_once_with(Book, instance=book)\n114. \n115.     def test_basic_queries(self):\n116.         "Queries are constrained to a single database"\n117.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n118. \n119.         dive = Book.objects.using(\'other\').get(published=datetime.date(2009, 5, 4))\n120.         self.assertEqual(dive.title, "Dive into Python")\n121.         with self.assertRaises(Book.DoesNotExist):\n122.             Book.objects.using(\'default\').get(published=datetime.date(2009, 5, 4))\n123. \n124.         dive = Book.objects.using(\'other\').get(title__icontains="dive")\n125.         self.assertEqual(dive.title, "Dive into Python")\n126.         with self.assertRaises(Book.DoesNotExist):\n127.             Book.objects.using(\'default\').get(title__icontains="dive")\n128. \n129.         dive = Book.objects.using(\'other\').get(title__iexact="dive INTO python")\n130.         self.assertEqual(dive.title, "Dive into Python")\n131.         with self.assertRaises(Book.DoesNotExist):\n132.             Book.objects.using(\'default\').get(title__iexact="dive INTO python")\n133. \n134.         dive = Book.objects.using(\'other\').get(published__year=2009)\n135.         self.assertEqual(dive.title, "Dive into Python")\n136.         self.assertEqual(dive.published, datetime.date(2009, 5, 4))\n137.         with self.assertRaises(Book.DoesNotExist):\n138.             Book.objects.using(\'default\').get(published__year=2009)\n139. \n140.         years = Book.objects.using(\'other\').dates(\'published\', \'year\')\n141.         self.assertEqual([o.year for o in years], [2009])\n142.         years = Book.objects.using(\'default\').dates(\'published\', \'year\')\n143.         self.assertEqual([o.year for o in years], [])\n144. \n145.         months = Book.objects.using(\'other\').dates(\'published\', \'month\')\n146.         self.assertEqual([o.month for o in months], [5])\n147.         months = Book.objects.using(\'default\').dates(\'published\', \'month\')\n148.         self.assertEqual([o.month for o in months], [])\n149. \n150.     def test_m2m_separation(self):\n151.         "M2M fields are constrained to a single database"\n152.         # Create a book and author on the default database\n153.         pro = Book.objects.create(title="Pro Django",\n154.                                   published=datetime.date(2008, 12, 16))\n155. \n156.         marty = Person.objects.create(name="Marty Alchin")\n157. \n158.         # Create a book and author on the other database\n159.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n160. \n161.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n162. \n163.         # Save the author relations\n164.         pro.authors.set([marty])\n165.         dive.authors.set([mark])\n166. \n167.         # Inspect the m2m tables directly.\n168.         # There should be 1 entry in each database\n169.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 1)\n170.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n171. \n172.         # Queries work across m2m joins\n173.         self.assertEqual(\n174.             list(Book.objects.using(\'default\').filter(authors__name=\'Marty Alchin\').values_list(\'title\', flat=True)),\n175.             [\'Pro Django\']\n176.         )\n177.         self.assertEqual(\n178.             list(Book.objects.using(\'other\').filter(authors__name=\'Marty Alchin\').values_list(\'title\', flat=True)),\n179.             []\n180.         )\n181. \n182.         self.assertEqual(\n183.             list(Book.objects.using(\'default\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n184.             []\n185.         )\n186.         self.assertEqual(\n187.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n188.             [\'Dive into Python\']\n189.         )\n190. \n191.         # Reget the objects to clear caches\n192.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n193.         mark = Person.objects.using(\'other\').get(name="Mark Pilgrim")\n194. \n195.         # Retrieve related object by descriptor. Related objects should be database-bound\n196.         self.assertEqual(list(dive.authors.all().values_list(\'name\', flat=True)), [\'Mark Pilgrim\'])\n197. \n198.         self.assertEqual(list(mark.book_set.all().values_list(\'title\', flat=True)), [\'Dive into Python\'])\n199. \n200.     def test_m2m_forward_operations(self):\n201.         "M2M forward manipulations are all constrained to a single DB"\n202.         # Create a book and author on the other database\n203.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n204.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n205. \n206.         # Save the author relations\n207.         dive.authors.set([mark])\n208. \n209.         # Add a second author\n210.         john = Person.objects.using(\'other\').create(name="John Smith")\n211.         self.assertEqual(\n212.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n213.             []\n214.         )\n215. \n216.         dive.authors.add(john)\n217.         self.assertEqual(\n218.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n219.             [\'Dive into Python\']\n220.         )\n221.         self.assertEqual(\n222.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n223.             [\'Dive into Python\']\n224.         )\n225. \n226.         # Remove the second author\n227.         dive.authors.remove(john)\n228.         self.assertEqual(\n229.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n230.             [\'Dive into Python\']\n231.         )\n232.         self.assertEqual(\n233.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n234.             []\n235.         )\n236. \n237.         # Clear all authors\n238.         dive.authors.clear()\n239.         self.assertEqual(\n240.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n241.             []\n242.         )\n243.         self.assertEqual(\n244.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n245.             []\n246.         )\n247. \n248.         # Create an author through the m2m interface\n249.         dive.authors.create(name=\'Jane Brown\')\n250.         self.assertEqual(\n251.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n252.             []\n253.         )\n254.         self.assertEqual(\n255.             list(Book.objects.using(\'other\').filter(authors__name=\'Jane Brown\').values_list(\'title\', flat=True)),\n256.             [\'Dive into Python\']\n257.         )\n258. \n259.     def test_m2m_reverse_operations(self):\n260.         "M2M reverse manipulations are all constrained to a single DB"\n261.         # Create a book and author on the other database\n262.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n263.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n264. \n265.         # Save the author relations\n266.         dive.authors.set([mark])\n267. \n268.         # Create a second book on the other database\n269.         grease = Book.objects.using(\'other\').create(title="Greasemonkey Hacks", published=datetime.date(2005, 11, 1))\n270. \n271.         # Add a books to the m2m\n272.         mark.book_set.add(grease)\n273.         self.assertEqual(\n274.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n275.             [\'Mark Pilgrim\']\n276.         )\n277.         self.assertEqual(\n278.             list(\n279.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n280.             ),\n281.             [\'Mark Pilgrim\']\n282.         )\n283. \n284.         # Remove a book from the m2m\n285.         mark.book_set.remove(grease)\n286.         self.assertEqual(\n287.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n288.             [\'Mark Pilgrim\']\n289.         )\n290.         self.assertEqual(\n291.             list(\n292.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n293.             ),\n294.             []\n295.         )\n296. \n297.         # Clear the books associated with mark\n298.         mark.book_set.clear()\n299.         self.assertEqual(\n300.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n301.             []\n302.         )\n303.         self.assertEqual(\n304.             list(\n305.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n306.             ),\n307.             []\n308.         )\n309. \n310.         # Create a book through the m2m interface\n311.         mark.book_set.create(title="Dive into HTML5", published=datetime.date(2020, 1, 1))\n312.         self.assertEqual(\n313.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n314.             []\n315.         )\n316.         self.assertEqual(\n317.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n318.             [\'Mark Pilgrim\']\n319.         )\n320. \n321.     def test_m2m_cross_database_protection(self):\n322.         "Operations that involve sharing M2M objects across databases raise an error"\n323.         # Create a book and author on the default database\n324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n325. \n326.         marty = Person.objects.create(name="Marty Alchin")\n327. \n328.         # Create a book and author on the other database\n329.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n330. \n331.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n332.         # Set a foreign key set with an object from a different database\n333.         msg = (\n334.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n335.             \'router prevents this relation.\'\n336.         )\n337.         with self.assertRaisesMessage(ValueError, msg):\n338.             with transaction.atomic(using=\'default\'):\n339.                 marty.edited.set([pro, dive])\n340. \n341.         # Add to an m2m with an object from a different database\n342.         msg = (\n343.             \'Cannot add "<Book: Dive into Python>": instance is on \'\n344.             \'database "default", value is on database "other"\'\n345.         )\n346.         with self.assertRaisesMessage(ValueError, msg):\n347.             with transaction.atomic(using=\'default\'):\n348.                 marty.book_set.add(dive)\n349. \n350.         # Set a m2m with an object from a different database\n351.         with self.assertRaisesMessage(ValueError, msg):\n352.             with transaction.atomic(using=\'default\'):\n353.                 marty.book_set.set([pro, dive])\n354. \n355.         # Add to a reverse m2m with an object from a different database\n356.         msg = (\n357.             \'Cannot add "<Person: Marty Alchin>": instance is on \'\n358.             \'database "other", value is on database "default"\'\n359.         )\n360.         with self.assertRaisesMessage(ValueError, msg):\n361.             with transaction.atomic(using=\'other\'):\n362.                 dive.authors.add(marty)\n363. \n364.         # Set a reverse m2m with an object from a different database\n365.         with self.assertRaisesMessage(ValueError, msg):\n366.             with transaction.atomic(using=\'other\'):\n367.                 dive.authors.set([mark, marty])\n368. \n369.     def test_m2m_deletion(self):\n370.         "Cascaded deletions of m2m relations issue queries on the right database"\n371.         # Create a book and author on the other database\n372.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n373.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n374.         dive.authors.set([mark])\n375. \n376.         # Check the initial state\n377.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n378.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n379.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n380. \n381.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n382.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n383.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n384. \n385.         # Delete the object on the other database\n386.         dive.delete(using=\'other\')\n387. \n388.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n389.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n390.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n391. \n392.         # The person still exists ...\n393.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n394.         # ... but the book has been deleted\n395.         self.assertEqual(Book.objects.using(\'other\').count(), 0)\n396.         # ... and the relationship object has also been deleted.\n397.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 0)\n398. \n399.         # Now try deletion in the reverse direction. Set up the relation again\n400.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n401.         dive.authors.set([mark])\n402. \n403.         # Check the initial state\n404.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n405.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n406.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n407. \n408.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n409.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n410.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n411. \n412.         # Delete the object on the other database\n413.         mark.delete(using=\'other\')\n414. \n415.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n416.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n417.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n418. \n419.         # The person has been deleted ...\n420.         self.assertEqual(Person.objects.using(\'other\').count(), 0)\n421.         # ... but the book still exists\n422.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n423.         # ... and the relationship object has been deleted.\n424.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 0)\n425. \n426.     def test_foreign_key_separation(self):\n427.         "FK fields are constrained to a single database"\n428.         # Create a book and author on the default database\n429.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n430. \n431.         george = Person.objects.create(name="George Vilches")\n432. \n433.         # Create a book and author on the other database\n434.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n435.         chris = Person.objects.using(\'other\').create(name="Chris Mills")\n436. \n437.         # Save the author\'s favorite books\n438.         pro.editor = george\n439.         pro.save()\n440. \n441.         dive.editor = chris\n442.         dive.save()\n443. \n444.         pro = Book.objects.using(\'default\').get(title="Pro Django")\n445.         self.assertEqual(pro.editor.name, "George Vilches")\n446. \n447.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n448.         self.assertEqual(dive.editor.name, "Chris Mills")\n449. \n450.         # Queries work across foreign key joins\n451.         self.assertEqual(\n452.             list(Person.objects.using(\'default\').filter(edited__title=\'Pro Django\').values_list(\'name\', flat=True)),\n453.             [\'George Vilches\']\n454.         )\n455.         self.assertEqual(\n456.             list(Person.objects.using(\'other\').filter(edited__title=\'Pro Django\').values_list(\'name\', flat=True)),\n457.             []\n458.         )\n459. \n460.         self.assertEqual(\n461.             list(\n462.                 Person.objects.using(\'default\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n463.             ),\n464.             []\n465.         )\n466.         self.assertEqual(\n467.             list(\n468.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n469.             ),\n470.             [\'Chris Mills\']\n471.         )\n472. \n473.         # Reget the objects to clear caches\n474.         chris = Person.objects.using(\'other\').get(name="Chris Mills")\n475.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n476. \n477.         # Retrieve related object by descriptor. Related objects should be database-bound\n478.         self.assertEqual(list(chris.edited.values_list(\'title\', flat=True)), [\'Dive into Python\'])\n479. \n480.     def test_foreign_key_reverse_operations(self):\n481.         "FK reverse manipulations are all constrained to a single DB"\n482.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n483.         chris = Person.objects.using(\'other\').create(name="Chris Mills")\n484. \n485.         # Save the author relations\n486.         dive.editor = chris\n487.         dive.save()\n488. \n489.         # Add a second book edited by chris\n490.         html5 = Book.objects.using(\'other\').create(title="Dive into HTML5", published=datetime.date(2010, 3, 15))\n491.         self.assertEqual(\n492.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n493.             []\n494.         )\n495. \n496.         chris.edited.add(html5)\n497.         self.assertEqual(\n498.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n499.             [\'Chris Mills\']\n500.         )\n501.         self.assertEqual(\n502.             list(\n503.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n504.             ),\n505.             [\'Chris Mills\']\n506.         )\n507. \n508.         # Remove the second editor\n509.         chris.edited.remove(html5)\n510.         self.assertEqual(\n511.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n512.             []\n513.         )\n514.         self.assertEqual(\n515.             list(\n516.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n517.             ),\n518.             [\'Chris Mills\']\n519.         )\n520. \n521.         # Clear all edited books\n522.         chris.edited.clear()\n523.         self.assertEqual(\n524.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n525.             []\n526.         )\n527.         self.assertEqual(\n528.             list(\n529.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n530.             ),\n531.             []\n532.         )\n533. \n534.         # Create an author through the m2m interface\n535.         chris.edited.create(title=\'Dive into Water\', published=datetime.date(2010, 3, 15))\n536.         self.assertEqual(\n537.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n538.             []\n539.         )\n540.         self.assertEqual(\n541.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into Water\').values_list(\'name\', flat=True)),\n542.             [\'Chris Mills\']\n543.         )\n544.         self.assertEqual(\n545.             list(\n546.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n547.             ),\n548.             []\n549.         )\n550. \n551.     def test_foreign_key_cross_database_protection(self):\n552.         "Operations that involve sharing FK objects across databases raise an error"\n553.         # Create a book and author on the default database\n554.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n555.         marty = Person.objects.create(name="Marty Alchin")\n556. \n557.         # Create a book and author on the other database\n558.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n559. \n560.         # Set a foreign key with an object from a different database\n561.         msg = (\n562.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n563.             \'router prevents this relation.\'\n564.         )\n565.         with self.assertRaisesMessage(ValueError, msg):\n566.             dive.editor = marty\n567. \n568.         # Set a foreign key set with an object from a different database\n569.         with self.assertRaisesMessage(ValueError, msg):\n570.             with transaction.atomic(using=\'default\'):\n571.                 marty.edited.set([pro, dive])\n572. \n573.         # Add to a foreign key set with an object from a different database\n574.         with self.assertRaisesMessage(ValueError, msg):\n575.             with transaction.atomic(using=\'default\'):\n576.                 marty.edited.add(dive)\n577. \n578.     def test_foreign_key_deletion(self):\n579.         "Cascaded deletions of Foreign Key relations issue queries on the right database"\n580.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n581.         Pet.objects.using(\'other\').create(name="Fido", owner=mark)\n582. \n583.         # Check the initial state\n584.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n585.         self.assertEqual(Pet.objects.using(\'default\').count(), 0)\n586. \n587.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n588.         self.assertEqual(Pet.objects.using(\'other\').count(), 1)\n589. \n590.         # Delete the person object, which will cascade onto the pet\n591.         mark.delete(using=\'other\')\n592. \n593.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n594.         self.assertEqual(Pet.objects.using(\'default\').count(), 0)\n595. \n596.         # Both the pet and the person have been deleted from the right database\n597.         self.assertEqual(Person.objects.using(\'other\').count(), 0)\n598.         self.assertEqual(Pet.objects.using(\'other\').count(), 0)\n599. \n600.     def test_foreign_key_validation(self):\n601.         "ForeignKey.validate() uses the correct database"\n602.         mickey = Person.objects.using(\'other\').create(name="Mickey")\n603.         pluto = Pet.objects.using(\'other\').create(name="Pluto", owner=mickey)\n604.         self.assertIsNone(pluto.full_clean())\n605. \n606.     # Any router that accesses `model` in db_for_read() works here.\n607.     @override_settings(DATABASE_ROUTERS=[AuthRouter()])\n608.     def test_foreign_key_validation_with_router(self):\n609.         """\n610.         ForeignKey.validate() passes `model` to db_for_read() even if\n611.         model_instance=None.\n612.         """\n613.         mickey = Person.objects.create(name="Mickey")\n614.         owner_field = Pet._meta.get_field(\'owner\')\n615.         self.assertEqual(owner_field.clean(mickey.pk, None), mickey.pk)\n616. \n617.     def test_o2o_separation(self):\n618.         "OneToOne fields are constrained to a single database"\n619.         # Create a user and profile on the default database\n620.         alice = User.objects.db_manager(\'default\').create_user(\'alice\', \'alice@example.com\')\n621.         alice_profile = UserProfile.objects.using(\'default\').create(user=alice, flavor=\'chocolate\')\n622. \n623.         # Create a user and profile on the other database\n624.         bob = User.objects.db_manager(\'other\').create_user(\'bob\', \'bob@example.com\')\n625.         bob_profile = UserProfile.objects.using(\'other\').create(user=bob, flavor=\'crunchy frog\')\n626. \n627.         # Retrieve related objects; queries should be database constrained\n628.         alice = User.objects.using(\'default\').get(username="alice")\n629.         self.assertEqual(alice.userprofile.flavor, "chocolate")\n630. \n631.         bob = User.objects.using(\'other\').get(username="bob")\n632.         self.assertEqual(bob.userprofile.flavor, "crunchy frog")\n633. \n634.         # Queries work across joins\n635.         self.assertEqual(\n636.             list(\n637.                 User.objects.using(\'default\')\n638.                 .filter(userprofile__flavor=\'chocolate\').values_list(\'username\', flat=True)\n639.             ),\n640.             [\'alice\']\n641.         )\n642.         self.assertEqual(\n643.             list(\n644.                 User.objects.using(\'other\')\n645.                 .filter(userprofile__flavor=\'chocolate\').values_list(\'username\', flat=True)\n646.             ),\n647.             []\n648.         )\n649. \n650.         self.assertEqual(\n651.             list(\n652.                 User.objects.using(\'default\')\n653.                 .filter(userprofile__flavor=\'crunchy frog\').values_list(\'username\', flat=True)\n654.             ),\n655.             []\n656.         )\n657.         self.assertEqual(\n658.             list(\n659.                 User.objects.using(\'other\')\n660.                 .filter(userprofile__flavor=\'crunchy frog\').values_list(\'username\', flat=True)\n661.             ),\n662.             [\'bob\']\n663.         )\n664. \n665.         # Reget the objects to clear caches\n666.         alice_profile = UserProfile.objects.using(\'default\').get(flavor=\'chocolate\')\n667.         bob_profile = UserProfile.objects.using(\'other\').get(flavor=\'crunchy frog\')\n668. \n669.         # Retrieve related object by descriptor. Related objects should be database-bound\n670.         self.assertEqual(alice_profile.user.username, \'alice\')\n671.         self.assertEqual(bob_profile.user.username, \'bob\')\n672. \n673.     def test_o2o_cross_database_protection(self):\n674.         "Operations that involve sharing FK objects across databases raise an error"\n675.         # Create a user and profile on the default database\n676.         alice = User.objects.db_manager(\'default\').create_user(\'alice\', \'alice@example.com\')\n677. \n678.         # Create a user and profile on the other database\n679.         bob = User.objects.db_manager(\'other\').create_user(\'bob\', \'bob@example.com\')\n680. \n681.         # Set a one-to-one relation with an object from a different database\n682.         alice_profile = UserProfile.objects.using(\'default\').create(user=alice, flavor=\'chocolate\')\n683.         msg = (\n684.             \'Cannot assign "%r": the current database router prevents this \'\n685.             \'relation.\' % alice_profile\n686.         )\n687.         with self.assertRaisesMessage(ValueError, msg):\n688.             bob.userprofile = alice_profile\n689. \n690.         # BUT! if you assign a FK object when the base object hasn\'t\n691.         # been saved yet, you implicitly assign the database for the\n692.         # base object.\n693.         bob_profile = UserProfile.objects.using(\'other\').create(user=bob, flavor=\'crunchy frog\')\n694. \n695.         new_bob_profile = UserProfile(flavor="spring surprise")\n696. \n697.         # assigning a profile requires an explicit pk as the object isn\'t saved\n698.         charlie = User(pk=51, username=\'charlie\', email=\'charlie@example.com\')\n699.         charlie.set_unusable_password()\n700. \n701.         # initially, no db assigned\n702.         self.assertIsNone(new_bob_profile._state.db)\n703.         self.assertIsNone(charlie._state.db)\n704. \n705.         # old object comes from \'other\', so the new object is set to use \'other\'...\n706.         new_bob_profile.user = bob\n707.         charlie.userprofile = bob_profile\n708.         self.assertEqual(new_bob_profile._state.db, \'other\')\n709.         self.assertEqual(charlie._state.db, \'other\')\n710. \n711.         # ... but it isn\'t saved yet\n712.         self.assertEqual(list(User.objects.using(\'other\').values_list(\'username\', flat=True)), [\'bob\'])\n713.         self.assertEqual(list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)), [\'crunchy frog\'])\n714. \n715.         # When saved (no using required), new objects goes to \'other\'\n716.         charlie.save()\n717.         bob_profile.save()\n718.         new_bob_profile.save()\n719.         self.assertEqual(list(User.objects.using(\'default\').values_list(\'username\', flat=True)), [\'alice\'])\n720.         self.assertEqual(list(User.objects.using(\'other\').values_list(\'username\', flat=True)), [\'bob\', \'charlie\'])\n721.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n722.         self.assertEqual(\n723.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n724.             [\'crunchy frog\', \'spring surprise\']\n725.         )\n726. \n727.         # This also works if you assign the O2O relation in the constructor\n728.         denise = User.objects.db_manager(\'other\').create_user(\'denise\', \'denise@example.com\')\n729.         denise_profile = UserProfile(flavor="tofu", user=denise)\n730. \n731.         self.assertEqual(denise_profile._state.db, \'other\')\n732.         # ... but it isn\'t saved yet\n733.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n734.         self.assertEqual(\n735.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n736.             [\'crunchy frog\', \'spring surprise\']\n737.         )\n738. \n739.         # When saved, the new profile goes to \'other\'\n740.         denise_profile.save()\n741.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n742.         self.assertEqual(\n743.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n744.             [\'crunchy frog\', \'spring surprise\', \'tofu\']\n745.         )\n746. \n747.     def test_generic_key_separation(self):\n748.         "Generic fields are constrained to a single database"\n749.         # Create a book and author on the default database\n750.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n751.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)\n752. \n753.         # Create a book and author on the other database\n754.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n755. \n756.         review2 = Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n757. \n758.         review1 = Review.objects.using(\'default\').get(source="Python Monthly")\n759.         self.assertEqual(review1.content_object.title, "Pro Django")\n760. \n761.         review2 = Review.objects.using(\'other\').get(source="Python Weekly")\n762.         self.assertEqual(review2.content_object.title, "Dive into Python")\n763. \n764.         # Reget the objects to clear caches\n765.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n766. \n767.         # Retrieve related object by descriptor. Related objects should be database-bound\n768.         self.assertEqual(list(dive.reviews.all().values_list(\'source\', flat=True)), [\'Python Weekly\'])\n769. \n770.     def test_generic_key_reverse_operations(self):\n771.         "Generic reverse manipulations are all constrained to a single DB"\n772.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n773.         temp = Book.objects.using(\'other\').create(title="Temp", published=datetime.date(2009, 5, 4))\n774.         review1 = Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n775.         review2 = Review.objects.using(\'other\').create(source="Python Monthly", content_object=temp)\n776. \n777.         self.assertEqual(\n778.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n779.             []\n780.         )\n781.         self.assertEqual(\n782.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n783.             [\'Python Weekly\']\n784.         )\n785. \n786.         # Add a second review\n787.         dive.reviews.add(review2)\n788.         self.assertEqual(\n789.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n790.             []\n791.         )\n792.         self.assertEqual(\n793.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n794.             [\'Python Monthly\', \'Python Weekly\']\n795.         )\n796. \n797.         # Remove the second author\n798.         dive.reviews.remove(review1)\n799.         self.assertEqual(\n800.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n801.             []\n802.         )\n803.         self.assertEqual(\n804.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n805.             [\'Python Monthly\']\n806.         )\n807. \n808.         # Clear all reviews\n809.         dive.reviews.clear()\n810.         self.assertEqual(\n811.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n812.             []\n813.         )\n814.         self.assertEqual(\n815.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n816.             []\n817.         )\n818. \n819.         # Create an author through the generic interface\n820.         dive.reviews.create(source=\'Python Daily\')\n821.         self.assertEqual(\n822.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n823.             []\n824.         )\n825.         self.assertEqual(\n826.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n827.             [\'Python Daily\']\n828.         )\n829. \n830.     def test_generic_key_cross_database_protection(self):\n831.         "Operations that involve sharing generic key objects across databases raise an error"\n832.         # Create a book and author on the default database\n833.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n834.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)\n835. \n836.         # Create a book and author on the other database\n837.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n838. \n839.         Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n840. \n841.         # Set a foreign key with an object from a different database\n842.         msg = (\n843.             \'Cannot assign "<ContentType: multiple_database | book>": the \'\n844.             \'current database router prevents this relation.\'\n845.         )\n846.         with self.assertRaisesMessage(ValueError, msg):\n847.             review1.content_object = dive\n848. \n849.         # Add to a foreign key set with an object from a different database\n850.         msg = (\n851.             "<Review: Python Monthly> instance isn\'t saved. "\n852.             "Use bulk=False or save the object first."\n853.         )\n854.         with self.assertRaisesMessage(ValueError, msg):\n855.             with transaction.atomic(using=\'other\'):\n856.                 dive.reviews.add(review1)\n857. \n858.         # BUT! if you assign a FK object when the base object hasn\'t\n859.         # been saved yet, you implicitly assign the database for the\n860.         # base object.\n861.         review3 = Review(source="Python Daily")\n862.         # initially, no db assigned\n863.         self.assertIsNone(review3._state.db)\n864. \n865.         # Dive comes from \'other\', so review3 is set to use \'other\'...\n866.         review3.content_object = dive\n867.         self.assertEqual(review3._state.db, \'other\')\n868.         # ... but it isn\'t saved yet\n869.         self.assertEqual(\n870.             list(Review.objects.using(\'default\').filter(object_id=pro.pk).values_list(\'source\', flat=True)),\n871.             [\'Python Monthly\']\n872.         )\n873.         self.assertEqual(\n874.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n875.             [\'Python Weekly\']\n876.         )\n877. \n878.         # When saved, John goes to \'other\'\n879.         review3.save()\n880.         self.assertEqual(\n881.             list(Review.objects.using(\'default\').filter(object_id=pro.pk).values_list(\'source\', flat=True)),\n882.             [\'Python Monthly\']\n883.         )\n884.         self.assertEqual(\n885.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n886.             [\'Python Daily\', \'Python Weekly\']\n887.         )\n888. \n889.     def test_generic_key_deletion(self):\n890.         "Cascaded deletions of Generic Key relations issue queries on the right database"\n891.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n892.         Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n893. \n894.         # Check the initial state\n895.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n896.         self.assertEqual(Review.objects.using(\'default\').count(), 0)\n897. \n898.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n899.         self.assertEqual(Review.objects.using(\'other\').count(), 1)\n900. \n901.         # Delete the Book object, which will cascade onto the pet\n902.         dive.delete(using=\'other\')\n903. \n904.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n905.         self.assertEqual(Review.objects.using(\'default\').count(), 0)\n906. \n907.         # Both the pet and the person have been deleted from the right database\n908.         self.assertEqual(Book.objects.using(\'other\').count(), 0)\n909.         self.assertEqual(Review.objects.using(\'other\').count(), 0)\n910. \n911.     def test_ordering(self):\n912.         "get_next_by_XXX commands stick to a single database"\n913.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n914.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n915.         learn = Book.objects.using(\'other\').create(title="Learning Python", published=datetime.date(2008, 7, 16))\n916. \n917.         self.assertEqual(learn.get_next_by_published().title, "Dive into Python")\n918.         self.assertEqual(dive.get_previous_by_published().title, "Learning Python")\n919. \n920.     def test_raw(self):\n921.         "test the raw() method across databases"\n922.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n923.         val = Book.objects.db_manager("other").raw(\'SELECT id FROM multiple_database_book\')\n924.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))\n925. \n926.         val = Book.objects.raw(\'SELECT id FROM multiple_database_book\').using(\'other\')\n927.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))\n928. \n929.     def test_select_related(self):\n930.         "Database assignment is retained if an object is retrieved with select_related()"\n931.         # Create a book and author on the other database\n932.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n933.         Book.objects.using(\'other\').create(\n934.             title="Dive into Python",\n935.             published=datetime.date(2009, 5, 4),\n936.             editor=mark,\n937.         )\n938. \n939.         # Retrieve the Person using select_related()\n940.         book = Book.objects.using(\'other\').select_related(\'editor\').get(title="Dive into Python")\n941. \n942.         # The editor instance should have a db state\n943.         self.assertEqual(book.editor._state.db, \'other\')\n944. \n945.     def test_subquery(self):\n946.         """Make sure as_sql works with subqueries and primary/replica."""\n947.         sub = Person.objects.using(\'other\').filter(name=\'fff\')\n948.         qs = Book.objects.filter(editor__in=sub)\n949. \n950.         # When you call __str__ on the query object, it doesn\'t know about using\n951.         # so it falls back to the default. If the subquery explicitly uses a\n952.         # different database, an error should be raised.\n953.         msg = (\n954.             "Subqueries aren\'t allowed across different databases. Force the "\n955.             "inner query to be evaluated using `list(inner_query)`."\n956.         )\n957.         with self.assertRaisesMessage(ValueError, msg):\n958.             str(qs.query)\n959. \n960.         # Evaluating the query shouldn\'t work, either\n961.         with self.assertRaisesMessage(ValueError, msg):\n962.             for obj in qs:\n963.                 pass\n964. \n965.     def test_related_manager(self):\n966.         "Related managers return managers, not querysets"\n967.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n968. \n969.         # extra_arg is removed by the BookManager\'s implementation of\n970.         # create(); but the BookManager\'s implementation won\'t get called\n971.         # unless edited returns a Manager, not a queryset\n972.         mark.book_set.create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)\n973.         mark.book_set.get_or_create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)\n974.         mark.edited.create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)\n975.         mark.edited.get_or_create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)\n976. \n977. \n978. class ConnectionRouterTestCase(SimpleTestCase):\n979.     @override_settings(DATABASE_ROUTERS=[\n980.         \'multiple_database.tests.TestRouter\',\n981.         \'multiple_database.tests.WriteRouter\'])\n982.     def test_router_init_default(self):\n983.         connection_router = ConnectionRouter()\n984.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n985. \n986.     def test_router_init_arg(self):\n987.         connection_router = ConnectionRouter([\n988.             \'multiple_database.tests.TestRouter\',\n989.             \'multiple_database.tests.WriteRouter\'\n990.         ])\n991.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n992. \n993.         # Init with instances instead of strings\n994.         connection_router = ConnectionRouter([TestRouter(), WriteRouter()])\n995.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n996. \n997. \n998. # Make the \'other\' database appear to be a replica of the \'default\'\n999. @override_settings(DATABASE_ROUTERS=[TestRouter()])\n1000. class RouterTestCase(TestCase):', start_line_number=1, end_line_number=1000), Context(relative_path='tests/migrations/test_commands.py', content='1. import datetime\n2. import importlib\n3. import io\n4. import os\n5. import sys\n6. from unittest import mock\n7. \n8. from django.apps import apps\n9. from django.core.management import CommandError, call_command\n10. from django.db import (\n11.     ConnectionHandler, DatabaseError, connection, connections, models,\n12. )\n13. from django.db.backends.base.schema import BaseDatabaseSchemaEditor\n14. from django.db.backends.utils import truncate_name\n15. from django.db.migrations.exceptions import InconsistentMigrationHistory\n16. from django.db.migrations.recorder import MigrationRecorder\n17. from django.test import TestCase, override_settings, skipUnlessDBFeature\n18. \n19. from .models import UnicodeModel, UnserializableModel\n20. from .routers import TestRouter\n21. from .test_base import MigrationTestBase\n22. \n23. \n24. class MigrateTests(MigrationTestBase):\n25.     """\n26.     Tests running the migrate command.\n27.     """\n28.     databases = {\'default\', \'other\'}\n29. \n30.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n31.     def test_migrate(self):\n32.         """\n33.         Tests basic usage of the migrate command.\n34.         """\n35.         # No tables are created\n36.         self.assertTableNotExists("migrations_author")\n37.         self.assertTableNotExists("migrations_tribble")\n38.         self.assertTableNotExists("migrations_book")\n39.         # Run the migrations to 0001 only\n40.         stdout = io.StringIO()\n41.         call_command(\'migrate\', \'migrations\', \'0001\', verbosity=1, stdout=stdout, no_color=True)\n42.         stdout = stdout.getvalue()\n43.         self.assertIn(\'Target specific migration: 0001_initial, from migrations\', stdout)\n44.         self.assertIn(\'Applying migrations.0001_initial... OK\', stdout)\n45.         # The correct tables exist\n46.         self.assertTableExists("migrations_author")\n47.         self.assertTableExists("migrations_tribble")\n48.         self.assertTableNotExists("migrations_book")\n49.         # Run migrations all the way\n50.         call_command("migrate", verbosity=0)\n51.         # The correct tables exist\n52.         self.assertTableExists("migrations_author")\n53.         self.assertTableNotExists("migrations_tribble")\n54.         self.assertTableExists("migrations_book")\n55.         # Unmigrate everything\n56.         stdout = io.StringIO()\n57.         call_command(\'migrate\', \'migrations\', \'zero\', verbosity=1, stdout=stdout, no_color=True)\n58.         stdout = stdout.getvalue()\n59.         self.assertIn(\'Unapply all migrations: migrations\', stdout)\n60.         self.assertIn(\'Unapplying migrations.0002_second... OK\', stdout)\n61.         # Tables are gone\n62.         self.assertTableNotExists("migrations_author")\n63.         self.assertTableNotExists("migrations_tribble")\n64.         self.assertTableNotExists("migrations_book")\n65. \n66.     @override_settings(INSTALLED_APPS=[\n67.         \'django.contrib.auth\',\n68.         \'django.contrib.contenttypes\',\n69.         \'migrations.migrations_test_apps.migrated_app\',\n70.     ])\n71.     def test_migrate_with_system_checks(self):\n72.         out = io.StringIO()\n73.         call_command(\'migrate\', skip_checks=False, no_color=True, stdout=out)\n74.         self.assertIn(\'Apply all migrations: migrated_app\', out.getvalue())\n75. \n76.     @override_settings(INSTALLED_APPS=[\'migrations\', \'migrations.migrations_test_apps.unmigrated_app_syncdb\'])\n77.     def test_app_without_migrations(self):\n78.         msg = "App \'unmigrated_app_syncdb\' does not have migrations."\n79.         with self.assertRaisesMessage(CommandError, msg):\n80.             call_command(\'migrate\', app_label=\'unmigrated_app_syncdb\')\n81. \n82.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_clashing_prefix\'})\n83.     def test_ambiguous_prefix(self):\n84.         msg = (\n85.             "More than one migration matches \'a\' in app \'migrations\'. Please "\n86.             "be more specific."\n87.         )\n88.         with self.assertRaisesMessage(CommandError, msg):\n89.             call_command(\'migrate\', app_label=\'migrations\', migration_name=\'a\')\n90. \n91.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n92.     def test_unknown_prefix(self):\n93.         msg = "Cannot find a migration matching \'nonexistent\' from app \'migrations\'."\n94.         with self.assertRaisesMessage(CommandError, msg):\n95.             call_command(\'migrate\', app_label=\'migrations\', migration_name=\'nonexistent\')\n96. \n97.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})\n98.     def test_migrate_initial_false(self):\n99.         """\n100.         `Migration.initial = False` skips fake-initial detection.\n101.         """\n102.         # Make sure no tables are created\n103.         self.assertTableNotExists("migrations_author")\n104.         self.assertTableNotExists("migrations_tribble")\n105.         # Run the migrations to 0001 only\n106.         call_command("migrate", "migrations", "0001", verbosity=0)\n107.         # Fake rollback\n108.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n109.         # Make sure fake-initial detection does not run\n110.         with self.assertRaises(DatabaseError):\n111.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)\n112. \n113.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)\n114.         # Real rollback\n115.         call_command("migrate", "migrations", "zero", verbosity=0)\n116.         # Make sure it\'s all gone\n117.         self.assertTableNotExists("migrations_author")\n118.         self.assertTableNotExists("migrations_tribble")\n119.         self.assertTableNotExists("migrations_book")\n120. \n121.     @override_settings(\n122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},\n123.         DATABASE_ROUTERS=[\'migrations.routers.TestRouter\'],\n124.     )\n125.     def test_migrate_fake_initial(self):\n126.         """\n127.         --fake-initial only works if all tables created in the initial\n128.         migration of an app exists. Database routers must be obeyed when doing\n129.         that check.\n130.         """\n131.         # Make sure no tables are created\n132.         for db in self.databases:\n133.             self.assertTableNotExists("migrations_author", using=db)\n134.             self.assertTableNotExists("migrations_tribble", using=db)\n135.         # Run the migrations to 0001 only\n136.         call_command("migrate", "migrations", "0001", verbosity=0)\n137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")\n138.         # Make sure the right tables exist\n139.         self.assertTableExists("migrations_author")\n140.         self.assertTableNotExists("migrations_tribble")\n141.         # Also check the "other" database\n142.         self.assertTableNotExists("migrations_author", using="other")\n143.         self.assertTableExists("migrations_tribble", using="other")\n144. \n145.         # Fake a roll-back\n146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n148.         # Make sure the tables still exist\n149.         self.assertTableExists("migrations_author")\n150.         self.assertTableExists("migrations_tribble", using="other")\n151.         # Try to run initial migration\n152.         with self.assertRaises(DatabaseError):\n153.             call_command("migrate", "migrations", "0001", verbosity=0)\n154.         # Run initial migration with an explicit --fake-initial\n155.         out = io.StringIO()\n156.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)\n158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")\n159.         self.assertIn(\n160.             "migrations.0001_initial... faked",\n161.             out.getvalue().lower()\n162.         )\n163.         # Run migrations all the way\n164.         call_command("migrate", verbosity=0)\n165.         call_command("migrate", verbosity=0, database="other")\n166.         # Make sure the right tables exist\n167.         self.assertTableExists("migrations_author")\n168.         self.assertTableNotExists("migrations_tribble")\n169.         self.assertTableExists("migrations_book")\n170.         self.assertTableNotExists("migrations_author", using="other")\n171.         self.assertTableNotExists("migrations_tribble", using="other")\n172.         self.assertTableNotExists("migrations_book", using="other")\n173.         # Fake a roll-back\n174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n176.         # Make sure the tables still exist\n177.         self.assertTableExists("migrations_author")\n178.         self.assertTableNotExists("migrations_tribble")\n179.         self.assertTableExists("migrations_book")\n180.         # Try to run initial migration\n181.         with self.assertRaises(DatabaseError):\n182.             call_command("migrate", "migrations", verbosity=0)\n183.         # Run initial migration with an explicit --fake-initial\n184.         with self.assertRaises(DatabaseError):\n185.             # Fails because "migrations_tribble" does not exist but needs to in\n186.             # order to make --fake-initial work.\n187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)\n188.         # Fake an apply\n189.         call_command("migrate", "migrations", fake=True, verbosity=0)\n190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")\n191.         # Unmigrate everything\n192.         call_command("migrate", "migrations", "zero", verbosity=0)\n193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")\n194.         # Make sure it\'s all gone\n195.         for db in self.databases:\n196.             self.assertTableNotExists("migrations_author", using=db)\n197.             self.assertTableNotExists("migrations_tribble", using=db)\n198.             self.assertTableNotExists("migrations_book", using=db)\n199. \n200.     @skipUnlessDBFeature(\'ignores_table_name_case\')\n201.     def test_migrate_fake_initial_case_insensitive(self):\n202.         with override_settings(MIGRATION_MODULES={\n203.             \'migrations\': \'migrations.test_fake_initial_case_insensitive.initial\',\n204.         }):\n205.             call_command(\'migrate\', \'migrations\', \'0001\', verbosity=0)\n206.             call_command(\'migrate\', \'migrations\', \'zero\', fake=True, verbosity=0)\n207. \n208.         with override_settings(MIGRATION_MODULES={\n209.             \'migrations\': \'migrations.test_fake_initial_case_insensitive.fake_initial\',\n210.         }):\n211.             out = io.StringIO()\n212.             call_command(\n213.                 \'migrate\',\n214.                 \'migrations\',\n215.                 \'0001\',\n216.                 fake_initial=True,\n217.                 stdout=out,\n218.                 verbosity=1,\n219.                 no_color=True,\n220.             )\n221.             self.assertIn(\n222.                 \'migrations.0001_initial... faked\',\n223.                 out.getvalue().lower(),\n224.             )\n225. \n226.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})\n227.     def test_migrate_fake_split_initial(self):\n228.         """\n229.         Split initial migrations can be faked with --fake-initial.\n230.         """\n231.         call_command("migrate", "migrations", "0002", verbosity=0)\n232.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n233.         out = io.StringIO()\n234.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n235.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)\n236.         value = out.getvalue().lower()\n237.         self.assertIn("migrations.0001_initial... faked", value)\n238.         self.assertIn("migrations.0002_second... faked", value)\n239.         # Fake an apply\n240.         call_command("migrate", "migrations", fake=True, verbosity=0)\n241.         # Unmigrate everything\n242.         call_command("migrate", "migrations", "zero", verbosity=0)\n243. \n244.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})\n245.     def test_migrate_conflict_exit(self):\n246.         """\n247.         migrate exits if it detects a conflict.\n248.         """\n249.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):\n250.             call_command("migrate", "migrations")\n251. \n252.     @override_settings(MIGRATION_MODULES={\n253.         \'migrations\': \'migrations.test_migrations\',\n254.     })\n255.     def test_migrate_check(self):\n256.         with self.assertRaises(SystemExit):\n257.             call_command(\'migrate\', \'migrations\', \'0001\', check_unapplied=True, verbosity=0)\n258.         self.assertTableNotExists(\'migrations_author\')\n259.         self.assertTableNotExists(\'migrations_tribble\')\n260.         self.assertTableNotExists(\'migrations_book\')\n261. \n262.     @override_settings(MIGRATION_MODULES={\n263.         \'migrations\': \'migrations.test_migrations_plan\',\n264.     })\n265.     def test_migrate_check_plan(self):\n266.         out = io.StringIO()\n267.         with self.assertRaises(SystemExit):\n268.             call_command(\n269.                 \'migrate\',\n270.                 \'migrations\',\n271.                 \'0001\',\n272.                 check_unapplied=True,\n273.                 plan=True,\n274.                 stdout=out,\n275.                 no_color=True,\n276.             )\n277.         self.assertEqual(\n278.             \'Planned operations:\\n\'\n279.             \'migrations.0001_initial\\n\'\n280.             \'    Create model Salamander\\n\'\n281.             \'    Raw Python operation -> Grow salamander tail.\\n\',\n282.             out.getvalue(),\n283.         )\n284. \n285.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n286.     def test_showmigrations_list(self):\n287.         """\n288.         showmigrations --list  displays migrations and whether or not they\'re\n289.         applied.\n290.         """\n291.         out = io.StringIO()\n292.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: True):\n293.             call_command("showmigrations", format=\'list\', stdout=out, verbosity=0, no_color=False)\n294.         self.assertEqual(\n295.             \'\\x1b[1mmigrations\\n\\x1b[0m\'\n296.             \' [ ] 0001_initial\\n\'\n297.             \' [ ] 0002_second\\n\',\n298.             out.getvalue().lower()\n299.         )\n300. \n301.         call_command("migrate", "migrations", "0001", verbosity=0)\n302. \n303.         out = io.StringIO()\n304.         # Giving the explicit app_label tests for selective `show_list` in the command\n305.         call_command("showmigrations", "migrations", format=\'list\', stdout=out, verbosity=0, no_color=True)\n306.         self.assertEqual(\n307.             \'migrations\\n\'\n308.             \' [x] 0001_initial\\n\'\n309.             \' [ ] 0002_second\\n\',\n310.             out.getvalue().lower()\n311.         )\n312.         out = io.StringIO()\n313.         # Applied datetimes are displayed at verbosity 2+.\n314.         call_command(\'showmigrations\', \'migrations\', stdout=out, verbosity=2, no_color=True)\n315.         migration1 = MigrationRecorder(connection).migration_qs.get(app=\'migrations\', name=\'0001_initial\')\n316.         self.assertEqual(\n317.             \'migrations\\n\'\n318.             \' [x] 0001_initial (applied at %s)\\n\'\n319.             \' [ ] 0002_second\\n\' % migration1.applied.strftime(\'%Y-%m-%d %H:%M:%S\'),\n320.             out.getvalue().lower()\n321.         )\n322.         # Cleanup by unmigrating everything\n323.         call_command("migrate", "migrations", "zero", verbosity=0)\n324. \n325.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})\n326.     def test_showmigrations_plan(self):\n327.         """\n328.         Tests --plan output of showmigrations command\n329.         """\n330.         out = io.StringIO()\n331.         call_command("showmigrations", format=\'plan\', stdout=out)\n332.         self.assertEqual(\n333.             "[ ]  migrations.0001_initial\\n"\n334.             "[ ]  migrations.0003_third\\n"\n335.             "[ ]  migrations.0002_second\\n",\n336.             out.getvalue().lower()\n337.         )\n338. \n339.         out = io.StringIO()\n340.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n341.         self.assertEqual(\n342.             "[ ]  migrations.0001_initial\\n"\n343.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\\n"\n344.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\\n",\n345.             out.getvalue().lower()\n346.         )\n347.         call_command("migrate", "migrations", "0003", verbosity=0)\n348. \n349.         out = io.StringIO()\n350.         call_command("showmigrations", format=\'plan\', stdout=out)\n351.         self.assertEqual(\n352.             "[x]  migrations.0001_initial\\n"\n353.             "[x]  migrations.0003_third\\n"\n354.             "[ ]  migrations.0002_second\\n",\n355.             out.getvalue().lower()\n356.         )\n357. \n358.         out = io.StringIO()\n359.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n360.         self.assertEqual(\n361.             "[x]  migrations.0001_initial\\n"\n362.             "[x]  migrations.0003_third ... (migrations.0001_initial)\\n"\n363.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\\n",\n364.             out.getvalue().lower()\n365.         )\n366. \n367.         # Cleanup by unmigrating everything\n368.         call_command("migrate", "migrations", "zero", verbosity=0)\n369. \n370.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_plan\'})\n371.     def test_migrate_plan(self):\n372.         """Tests migrate --plan output."""\n373.         out = io.StringIO()\n374.         # Show the plan up to the third migration.\n375.         call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n376.         self.assertEqual(\n377.             \'Planned operations:\\n\'\n378.             \'migrations.0001_initial\\n\'\n379.             \'    Create model Salamander\\n\'\n380.             \'    Raw Python operation -> Grow salamander tail.\\n\'\n381.             \'migrations.0002_second\\n\'\n382.             \'    Create model Book\\n\'\n383.             "    Raw SQL operation -> [\'SELECT * FROM migrations_book\']\\n"\n384.             \'migrations.0003_third\\n\'\n385.             \'    Create model Author\\n\'\n386.             "    Raw SQL operation -> [\'SELECT * FROM migrations_author\']\\n",\n387.             out.getvalue()\n388.         )\n389.         try:\n390.             # Migrate to the third migration.\n391.             call_command(\'migrate\', \'migrations\', \'0003\', verbosity=0)\n392.             out = io.StringIO()\n393.             # Show the plan for when there is nothing to apply.\n394.             call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n395.             self.assertEqual(\n396.                 \'Planned operations:\\n\'\n397.                 \'  No planned migration operations.\\n\',\n398.                 out.getvalue()\n399.             )\n400.             out = io.StringIO()\n401.             # Show the plan for reverse migration back to 0001.\n402.             call_command(\'migrate\', \'migrations\', \'0001\', plan=True, stdout=out, no_color=True)\n403.             self.assertEqual(\n404.                 \'Planned operations:\\n\'\n405.                 \'migrations.0003_third\\n\'\n406.                 \'    Undo Create model Author\\n\'\n407.                 "    Raw SQL operation -> [\'SELECT * FROM migrations_book\']\\n"\n408.                 \'migrations.0002_second\\n\'\n409.                 \'    Undo Create model Book\\n\'\n410.                 "    Raw SQL operation -> [\'SELECT * FROM migrations_salamand…\\n",\n411.                 out.getvalue()\n412.             )\n413.             out = io.StringIO()\n414.             # Show the migration plan to fourth, with truncated details.\n415.             call_command(\'migrate\', \'migrations\', \'0004\', plan=True, stdout=out, no_color=True)\n416.             self.assertEqual(\n417.                 \'Planned operations:\\n\'\n418.                 \'migrations.0004_fourth\\n\'\n419.                 \'    Raw SQL operation -> SELECT * FROM migrations_author WHE…\\n\',\n420.                 out.getvalue()\n421.             )\n422.             # Show the plan when an operation is irreversible.\n423.             # Migrate to the fourth migration.\n424.             call_command(\'migrate\', \'migrations\', \'0004\', verbosity=0)\n425.             out = io.StringIO()\n426.             call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n427.             self.assertEqual(\n428.                 \'Planned operations:\\n\'\n429.                 \'migrations.0004_fourth\\n\'\n430.                 \'    Raw SQL operation -> IRREVERSIBLE\\n\',\n431.                 out.getvalue()\n432.             )\n433.             out = io.StringIO()\n434.             call_command(\'migrate\', \'migrations\', \'0005\', plan=True, stdout=out, no_color=True)\n435.             # Operation is marked as irreversible only in the revert plan.\n436.             self.assertEqual(\n437.                 \'Planned operations:\\n\'\n438.                 \'migrations.0005_fifth\\n\'\n439.                 \'    Raw Python operation\\n\'\n440.                 \'    Raw Python operation\\n\'\n441.                 \'    Raw Python operation -> Feed salamander.\\n\',\n442.                 out.getvalue()\n443.             )\n444.             call_command(\'migrate\', \'migrations\', \'0005\', verbosity=0)\n445.             out = io.StringIO()\n446.             call_command(\'migrate\', \'migrations\', \'0004\', plan=True, stdout=out, no_color=True)\n447.             self.assertEqual(\n448.                 \'Planned operations:\\n\'\n449.                 \'migrations.0005_fifth\\n\'\n450.                 \'    Raw Python operation -> IRREVERSIBLE\\n\'\n451.                 \'    Raw Python operation -> IRREVERSIBLE\\n\'\n452.                 \'    Raw Python operation\\n\',\n453.                 out.getvalue()\n454.             )\n455.         finally:\n456.             # Cleanup by unmigrating everything: fake the irreversible, then\n457.             # migrate all to zero.\n458.             call_command(\'migrate\', \'migrations\', \'0003\', fake=True, verbosity=0)\n459.             call_command(\'migrate\', \'migrations\', \'zero\', verbosity=0)\n460. \n461.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_empty\'})\n462.     def test_showmigrations_no_migrations(self):\n463.         out = io.StringIO()\n464.         call_command(\'showmigrations\', stdout=out, no_color=True)\n465.         self.assertEqual(\'migrations\\n (no migrations)\\n\', out.getvalue().lower())\n466. \n467.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app\'])\n468.     def test_showmigrations_unmigrated_app(self):\n469.         out = io.StringIO()\n470.         call_command(\'showmigrations\', \'unmigrated_app\', stdout=out, no_color=True)\n471.         self.assertEqual(\'unmigrated_app\\n (no migrations)\\n\', out.getvalue().lower())\n472. \n473.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})\n474.     def test_showmigrations_plan_no_migrations(self):\n475.         """\n476.         Tests --plan output of showmigrations command without migrations\n477.         """\n478.         out = io.StringIO()\n479.         call_command(\'showmigrations\', format=\'plan\', stdout=out, no_color=True)\n480.         self.assertEqual(\'(no migrations)\\n\', out.getvalue().lower())\n481. \n482.         out = io.StringIO()\n483.         call_command(\'showmigrations\', format=\'plan\', stdout=out, verbosity=2, no_color=True)\n484.         self.assertEqual(\'(no migrations)\\n\', out.getvalue().lower())\n485. \n486.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})\n487.     def test_showmigrations_plan_squashed(self):\n488.         """\n489.         Tests --plan output of showmigrations command with squashed migrations.\n490.         """\n491.         out = io.StringIO()\n492.         call_command("showmigrations", format=\'plan\', stdout=out)\n493.         self.assertEqual(\n494.             "[ ]  migrations.1_auto\\n"\n495.             "[ ]  migrations.2_auto\\n"\n496.             "[ ]  migrations.3_squashed_5\\n"\n497.             "[ ]  migrations.6_auto\\n"\n498.             "[ ]  migrations.7_auto\\n",\n499.             out.getvalue().lower()\n500.         )\n501. \n502.         out = io.StringIO()\n503.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n504.         self.assertEqual(\n505.             "[ ]  migrations.1_auto\\n"\n506.             "[ ]  migrations.2_auto ... (migrations.1_auto)\\n"\n507.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\\n"\n508.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\\n"\n509.             "[ ]  migrations.7_auto ... (migrations.6_auto)\\n",\n510.             out.getvalue().lower()\n511.         )\n512. \n513.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)\n514. \n515.         out = io.StringIO()\n516.         call_command("showmigrations", format=\'plan\', stdout=out)\n517.         self.assertEqual(\n518.             "[x]  migrations.1_auto\\n"\n519.             "[x]  migrations.2_auto\\n"\n520.             "[x]  migrations.3_squashed_5\\n"\n521.             "[ ]  migrations.6_auto\\n"\n522.             "[ ]  migrations.7_auto\\n",\n523.             out.getvalue().lower()\n524.         )\n525. \n526.         out = io.StringIO()\n527.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n528.         self.assertEqual(\n529.             "[x]  migrations.1_auto\\n"\n530.             "[x]  migrations.2_auto ... (migrations.1_auto)\\n"\n531.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\\n"\n532.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\\n"\n533.             "[ ]  migrations.7_auto ... (migrations.6_auto)\\n",\n534.             out.getvalue().lower()\n535.         )\n536. \n537.     @override_settings(INSTALLED_APPS=[\n538.         \'migrations.migrations_test_apps.mutate_state_b\',\n539.         \'migrations.migrations_test_apps.alter_fk.author_app\',\n540.         \'migrations.migrations_test_apps.alter_fk.book_app\',\n541.     ])\n542.     def test_showmigrations_plan_single_app_label(self):\n543.         """\n544.         `showmigrations --plan app_label` output with a single app_label.\n545.         """\n546.         # Single app with no dependencies on other apps.\n547.         out = io.StringIO()\n548.         call_command(\'showmigrations\', \'mutate_state_b\', format=\'plan\', stdout=out)\n549.         self.assertEqual(\n550.             \'[ ]  mutate_state_b.0001_initial\\n\'\n551.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n552.             out.getvalue()\n553.         )\n554.         # Single app with dependencies.\n555.         out = io.StringIO()\n556.         call_command(\'showmigrations\', \'author_app\', format=\'plan\', stdout=out)\n557.         self.assertEqual(\n558.             \'[ ]  author_app.0001_initial\\n\'\n559.             \'[ ]  book_app.0001_initial\\n\'\n560.             \'[ ]  author_app.0002_alter_id\\n\',\n561.             out.getvalue()\n562.         )\n563.         # Some migrations already applied.\n564.         call_command(\'migrate\', \'author_app\', \'0001\', verbosity=0)\n565.         out = io.StringIO()\n566.         call_command(\'showmigrations\', \'author_app\', format=\'plan\', stdout=out)\n567.         self.assertEqual(\n568.             \'[X]  author_app.0001_initial\\n\'\n569.             \'[ ]  book_app.0001_initial\\n\'\n570.             \'[ ]  author_app.0002_alter_id\\n\',\n571.             out.getvalue()\n572.         )\n573.         # Cleanup by unmigrating author_app.\n574.         call_command(\'migrate\', \'author_app\', \'zero\', verbosity=0)\n575. \n576.     @override_settings(INSTALLED_APPS=[\n577.         \'migrations.migrations_test_apps.mutate_state_b\',\n578.         \'migrations.migrations_test_apps.alter_fk.author_app\',\n579.         \'migrations.migrations_test_apps.alter_fk.book_app\',\n580.     ])\n581.     def test_showmigrations_plan_multiple_app_labels(self):\n582.         """\n583.         `showmigrations --plan app_label` output with multiple app_labels.\n584.         """\n585.         # Multiple apps: author_app depends on book_app; mutate_state_b doesn\'t\n586.         # depend on other apps.\n587.         out = io.StringIO()\n588.         call_command(\'showmigrations\', \'mutate_state_b\', \'author_app\', format=\'plan\', stdout=out)\n589.         self.assertEqual(\n590.             \'[ ]  author_app.0001_initial\\n\'\n591.             \'[ ]  book_app.0001_initial\\n\'\n592.             \'[ ]  author_app.0002_alter_id\\n\'\n593.             \'[ ]  mutate_state_b.0001_initial\\n\'\n594.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n595.             out.getvalue()\n596.         )\n597.         # Multiple apps: args order shouldn\'t matter (the same result is\n598.         # expected as above).\n599.         out = io.StringIO()\n600.         call_command(\'showmigrations\', \'author_app\', \'mutate_state_b\', format=\'plan\', stdout=out)\n601.         self.assertEqual(\n602.             \'[ ]  author_app.0001_initial\\n\'\n603.             \'[ ]  book_app.0001_initial\\n\'\n604.             \'[ ]  author_app.0002_alter_id\\n\'\n605.             \'[ ]  mutate_state_b.0001_initial\\n\'\n606.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n607.             out.getvalue()\n608.         )\n609. \n610.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app\'])\n611.     def test_showmigrations_plan_app_label_no_migrations(self):\n612.         out = io.StringIO()\n613.         call_command(\'showmigrations\', \'unmigrated_app\', format=\'plan\', stdout=out, no_color=True)\n614.         self.assertEqual(\'(no migrations)\\n\', out.getvalue())\n615. \n616.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n617.     def test_sqlmigrate_forwards(self):\n618.         """\n619.         sqlmigrate outputs forward looking SQL.\n620.         """\n621.         out = io.StringIO()\n622.         call_command("sqlmigrate", "migrations", "0001", stdout=out)\n623.         output = out.getvalue().lower()\n624. \n625.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())\n626.         index_op_desc_author = output.find(\'-- create model author\')\n627.         index_create_table = output.find(\'create table\')\n628.         index_op_desc_tribble = output.find(\'-- create model tribble\')\n629.         index_op_desc_unique_together = output.find(\'-- alter unique_together\')\n630.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())\n631. \n632.         if connection.features.can_rollback_ddl:\n633.             self.assertGreater(index_tx_start, -1, "Transaction start not found")\n634.             self.assertGreater(\n635.                 index_tx_end, index_op_desc_unique_together,\n636.                 "Transaction end not found or found before operation description (unique_together)"\n637.             )\n638. \n639.         self.assertGreater(\n640.             index_op_desc_author, index_tx_start,\n641.             "Operation description (author) not found or found before transaction start"\n642.         )\n643.         self.assertGreater(\n644.             index_create_table, index_op_desc_author,\n645.             "CREATE TABLE not found or found before operation description (author)"\n646.         )\n647.         self.assertGreater(\n648.             index_op_desc_tribble, index_create_table,\n649.             "Operation description (tribble) not found or found before CREATE TABLE (author)"\n650.         )\n651.         self.assertGreater(\n652.             index_op_desc_unique_together, index_op_desc_tribble,\n653.             "Operation description (unique_together) not found or found before operation description (tribble)"\n654.         )\n655. \n656.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n657.     def test_sqlmigrate_backwards(self):\n658.         """\n659.         sqlmigrate outputs reverse looking SQL.\n660.         """\n661.         # Cannot generate the reverse SQL unless we\'ve applied the migration.\n662.         call_command("migrate", "migrations", verbosity=0)\n663. \n664.         out = io.StringIO()\n665.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)\n666.         output = out.getvalue().lower()\n667. \n668.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())\n669.         index_op_desc_unique_together = output.find(\'-- alter unique_together\')\n670.         index_op_desc_tribble = output.find(\'-- create model tribble\')\n671.         index_op_desc_author = output.find(\'-- create model author\')\n672.         index_drop_table = output.rfind(\'drop table\')\n673.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())\n674. \n675.         if connection.features.can_rollback_ddl:\n676.             self.assertGreater(index_tx_start, -1, "Transaction start not found")\n677.             self.assertGreater(\n678.                 index_tx_end, index_op_desc_unique_together,\n679.                 "Transaction end not found or found before DROP TABLE"\n680.             )\n681.         self.assertGreater(\n682.             index_op_desc_unique_together, index_tx_start,\n683.             "Operation description (unique_together) not found or found before transaction start"\n684.         )\n685.         self.assertGreater(\n686.             index_op_desc_tribble, index_op_desc_unique_together,\n687.             "Operation description (tribble) not found or found before operation description (unique_together)"\n688.         )\n689.         self.assertGreater(\n690.             index_op_desc_author, index_op_desc_tribble,\n691.             "Operation description (author) not found or found before operation description (tribble)"\n692.         )\n693. \n694.         self.assertGreater(\n695.             index_drop_table, index_op_desc_author,\n696.             "DROP TABLE not found or found before operation description (author)"\n697.         )\n698. \n699.         # Cleanup by unmigrating everything\n700.         call_command("migrate", "migrations", "zero", verbosity=0)\n701. \n702.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})\n703.     def test_sqlmigrate_for_non_atomic_migration(self):\n704.         """\n705.         Transaction wrappers aren\'t shown for non-atomic migrations.\n706.         """\n707.         out = io.StringIO()\n708.         call_command("sqlmigrate", "migrations", "0001", stdout=out)\n709.         output = out.getvalue().lower()\n710.         queries = [q.strip() for q in output.splitlines()]\n711.         if connection.ops.start_transaction_sql():\n712.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)\n713.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)\n714. \n715.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n716.     def test_sqlmigrate_for_non_transactional_databases(self):\n717.         """\n718.         Transaction wrappers aren\'t shown for databases that don\'t support\n719.         transactional DDL.\n720.         """\n721.         out = io.StringIO()\n722.         with mock.patch.object(connection.features, \'can_rollback_ddl\', False):\n723.             call_command(\'sqlmigrate\', \'migrations\', \'0001\', stdout=out)\n724.         output = out.getvalue().lower()\n725.         queries = [q.strip() for q in output.splitlines()]\n726.         start_transaction_sql = connection.ops.start_transaction_sql()\n727.         if start_transaction_sql:\n728.             self.assertNotIn(start_transaction_sql.lower(), queries)\n729.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)\n730. \n731.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n732.     def test_sqlmigrate_ambiguous_prefix_squashed_migrations(self):\n733.         msg = (\n734.             "More than one migration matches \'0001\' in app \'migrations\'. "\n735.             "Please be more specific."\n736.         )\n737.         with self.assertRaisesMessage(CommandError, msg):\n738.             call_command(\'sqlmigrate\', \'migrations\', \'0001\')\n739. \n740.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n741.     def test_sqlmigrate_squashed_migration(self):\n742.         out = io.StringIO()\n743.         call_command(\'sqlmigrate\', \'migrations\', \'0001_squashed_0002\', stdout=out)\n744.         output = out.getvalue().lower()\n745.         self.assertIn(\'-- create model author\', output)\n746.         self.assertIn(\'-- create model book\', output)\n747.         self.assertNotIn(\'-- create model tribble\', output)\n748. \n749.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n750.     def test_sqlmigrate_replaced_migration(self):\n751.         out = io.StringIO()\n752.         call_command(\'sqlmigrate\', \'migrations\', \'0001_initial\', stdout=out)\n753.         output = out.getvalue().lower()\n754.         self.assertIn(\'-- create model author\', output)\n755.         self.assertIn(\'-- create model tribble\', output)\n756. \n757.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_no_operations\'})\n758.     def test_migrations_no_operations(self):\n759.         err = io.StringIO()\n760.         call_command(\'sqlmigrate\', \'migrations\', \'0001_initial\', stderr=err)\n761.         self.assertEqual(err.getvalue(), \'No operations found.\\n\')\n762. \n763.     @override_settings(\n764.         INSTALLED_APPS=[\n765.             "migrations.migrations_test_apps.migrated_app",\n766.             "migrations.migrations_test_apps.migrated_unapplied_app",\n767.             "migrations.migrations_test_apps.unmigrated_app",\n768.         ],\n769.     )\n770.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):\n771.         """\n772.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:\n773. \n774.         * `A` has migrations\n775.         * `B` has a migration we want to apply\n776.         * `C` has no migrations, but has an FK to `A`\n777. \n778.         When we try to migrate "B", an exception occurs because the\n779.         "B" was not included in the ProjectState that is used to detect\n780.         soft-applied migrations (#22823).\n781.         """\n782.         call_command("migrate", "migrated_unapplied_app", stdout=io.StringIO())\n783. \n784.         # unmigrated_app.SillyModel has a foreign key to \'migrations.Tribble\',\n785.         # but that model is only defined in a migration, so the global app\n786.         # registry never sees it and the reference is left dangling. Remove it\n787.         # to avoid problems in subsequent tests.\n788.         del apps._pending_operations[(\'migrations\', \'tribble\')]\n789. \n790.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app_syncdb\'])\n791.     def test_migrate_syncdb_deferred_sql_executed_with_schemaeditor(self):\n792.         """\n793.         For an app without migrations, editor.execute() is used for executing\n794.         the syncdb deferred SQL.\n795.         """\n796.         stdout = io.StringIO()\n797.         with mock.patch.object(BaseDatabaseSchemaEditor, \'execute\') as execute:\n798.             call_command(\'migrate\', run_syncdb=True, verbosity=1, stdout=stdout, no_color=True)\n799.             create_table_count = len([call for call in execute.mock_calls if \'CREATE TABLE\' in str(call)])\n800.             self.assertEqual(create_table_count, 2)\n801.             # There\'s at least one deferred SQL for creating the foreign key\n802.             # index.\n803.             self.assertGreater(len(execute.mock_calls), 2)\n804.         stdout = stdout.getvalue()\n805.         self.assertIn(\'Synchronize unmigrated apps: unmigrated_app_syncdb\', stdout)\n806.         self.assertIn(\'Creating tables...\', stdout)\n807.         table_name = truncate_name(\'unmigrated_app_syncdb_classroom\', connection.ops.max_name_length())\n808.         self.assertIn(\'Creating table %s\' % table_name, stdout)\n809. \n810.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n811.     def test_migrate_syncdb_app_with_migrations(self):\n812.         msg = "Can\'t use run_syncdb with app \'migrations\' as it has migrations."\n813.         with self.assertRaisesMessage(CommandError, msg):\n814.             call_command(\'migrate\', \'migrations\', run_syncdb=True, verbosity=0)\n815. \n816.     @override_settings(INSTALLED_APPS=[\n817.         \'migrations.migrations_test_apps.unmigrated_app_syncdb\',\n818.         \'migrations.migrations_test_apps.unmigrated_app_simple\',\n819.     ])\n820.     def test_migrate_syncdb_app_label(self):\n821.         """\n822.         Running migrate --run-syncdb with an app_label only creates tables for\n823.         the specified app.\n824.         """\n825.         stdout = io.StringIO()\n826.         with mock.patch.object(BaseDatabaseSchemaEditor, \'execute\') as execute:\n827.             call_command(\'migrate\', \'unmigrated_app_syncdb\', run_syncdb=True, stdout=stdout)\n828.             create_table_count = len([call for call in execute.mock_calls if \'CREATE TABLE\' in str(call)])\n829.             self.assertEqual(create_table_count, 2)\n830.             self.assertGreater(len(execute.mock_calls), 2)\n831.             self.assertIn(\'Synchronize unmigrated app: unmigrated_app_syncdb\', stdout.getvalue())\n832. \n833.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})\n834.     def test_migrate_record_replaced(self):\n835.         """\n836.         Running a single squashed migration should record all of the original\n837.         replaced migrations as run.\n838.         """\n839.         recorder = MigrationRecorder(connection)\n840.         out = io.StringIO()\n841.         call_command("migrate", "migrations", verbosity=0)\n842.         call_command("showmigrations", "migrations", stdout=out, no_color=True)\n843.         self.assertEqual(\n844.             \'migrations\\n\'\n845.             \' [x] 0001_squashed_0002 (2 squashed migrations)\\n\',\n846.             out.getvalue().lower()\n847.         )\n848.         applied_migrations = recorder.applied_migrations()\n849.         self.assertIn(("migrations", "0001_initial"), applied_migrations)\n850.         self.assertIn(("migrations", "0002_second"), applied_migrations)\n851.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)\n852.         # Rollback changes\n853.         call_command("migrate", "migrations", "zero", verbosity=0)\n854. \n855.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})\n856.     def test_migrate_record_squashed(self):\n857.         """\n858.         Running migrate for a squashed migration should record as run\n859.         if all of the replaced migrations have been run (#25231).\n860.         """\n861.         recorder = MigrationRecorder(connection)\n862.         recorder.record_applied("migrations", "0001_initial")\n863.         recorder.record_applied("migrations", "0002_second")\n864.         out = io.StringIO()\n865.         call_command("migrate", "migrations", verbosity=0)\n866.         call_command("showmigrations", "migrations", stdout=out, no_color=True)\n867.         self.assertEqual(\n868.             \'migrations\\n\'\n869.             \' [x] 0001_squashed_0002 (2 squashed migrations)\\n\',\n870.             out.getvalue().lower()\n871.         )\n872.         self.assertIn(\n873.             ("migrations", "0001_squashed_0002"),\n874.             recorder.applied_migrations()\n875.         )\n876.         # No changes were actually applied so there is nothing to rollback\n877. \n878.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n879.     def test_migrate_inconsistent_history(self):\n880.         """\n881.         Running migrate with some migrations applied before their dependencies\n882.         should not be allowed.\n883.         """\n884.         recorder = MigrationRecorder(connection)\n885.         recorder.record_applied("migrations", "0002_second")\n886.         msg = "Migration migrations.0002_second is applied before its dependency migrations.0001_initial"\n887.         with self.assertRaisesMessage(InconsistentMigrationHistory, msg):\n888.             call_command("migrate")\n889.         applied_migrations = recorder.applied_migrations()\n890.         self.assertNotIn(("migrations", "0001_initial"), applied_migrations)\n891. \n892. \n893. class MakeMigrationsTests(MigrationTestBase):\n894.     """\n895.     Tests running the makemigrations command.\n896.     """\n897. \n898.     def setUp(self):\n899.         super().setUp()\n900.         self._old_models = apps.app_configs[\'migrations\'].models.copy()\n901. \n902.     def tearDown(self):\n903.         apps.app_configs[\'migrations\'].models = self._old_models\n904.         apps.all_models[\'migrations\'] = self._old_models\n905.         apps.clear_cache()\n906.         super().tearDown()\n907. \n908.     def test_files_content(self):\n909.         self.assertTableNotExists("migrations_unicodemodel")\n910.         apps.register_model(\'migrations\', UnicodeModel)\n911.         with self.temporary_migration_module() as migration_dir:\n912.             call_command("makemigrations", "migrations", verbosity=0)\n913. \n914.             # Check for empty __init__.py file in migrations folder\n915.             init_file = os.path.join(migration_dir, "__init__.py")\n916.             self.assertTrue(os.path.exists(init_file))\n917. \n918.             with open(init_file) as fp:\n919.                 content = fp.read()\n920.             self.assertEqual(content, \'\')\n921. \n922.             # Check for existing 0001_initial.py file in migration folder\n923.             initial_file = os.path.join(migration_dir, "0001_initial.py")\n924.             self.assertTrue(os.path.exists(initial_file))\n925. \n926.             with open(initial_file, encoding=\'utf-8\') as fp:\n927.                 content = fp.read()\n928.                 self.assertIn(\'migrations.CreateModel\', content)\n929.                 self.assertIn(\'initial = True\', content)\n930. \n931.                 self.assertIn(\'úñí©óðé µóðéø\', content)  # Meta.verbose_name\n932.                 self.assertIn(\'úñí©óðé µóðéøß\', content)  # Meta.verbose_name_plural\n933.                 self.assertIn(\'ÚÑÍ¢ÓÐÉ\', content)  # title.verbose_name\n934.                 self.assertIn(\'“Ðjáñgó”\', content)  # title.default\n935. \n936.     def test_makemigrations_order(self):\n937.         """\n938.         makemigrations should recognize number-only migrations (0001.py).\n939.         """\n940.         module = \'migrations.test_migrations_order\'\n941.         with self.temporary_migration_module(module=module) as migration_dir:\n942.             if hasattr(importlib, \'invalidate_caches\'):\n943.                 # importlib caches os.listdir() on some platforms like macOS\n944.                 # (#23850).\n945.                 importlib.invalidate_caches()\n946.             call_command(\'makemigrations\', \'migrations\', \'--empty\', \'-n\', \'a\', \'-v\', \'0\')\n947.             self.assertTrue(os.path.exists(os.path.join(migration_dir, \'0002_a.py\')))\n948. \n949.     def test_makemigrations_empty_connections(self):\n950.         empty_connections = ConnectionHandler({\'default\': {}})\n951.         with mock.patch(\'django.core.management.commands.makemigrations.connections\', new=empty_connections):\n952.             # with no apps\n953.             out = io.StringIO()\n954.             call_command(\'makemigrations\', stdout=out)\n955.             self.assertIn(\'No changes detected\', out.getvalue())\n956.             # with an app\n957.             with self.temporary_migration_module() as migration_dir:\n958.                 call_command(\'makemigrations\', \'migrations\', verbosity=0)\n959.                 init_file = os.path.join(migration_dir, \'__init__.py\')\n960.                 self.assertTrue(os.path.exists(init_file))\n961. \n962.     @override_settings(INSTALLED_APPS=[\'migrations\', \'migrations2\'])\n963.     def test_makemigrations_consistency_checks_respect_routers(self):\n964.         """\n965.         The history consistency checks in makemigrations respect\n966.         settings.DATABASE_ROUTERS.\n967.         """\n968.         def patched_has_table(migration_recorder):\n969.             if migration_recorder.connection is connections[\'other\']:\n970.                 raise Exception(\'Other connection\')\n971.             else:\n972.                 return mock.DEFAULT\n973. \n974.         self.assertTableNotExists(\'migrations_unicodemodel\')\n975.         apps.register_model(\'migrations\', UnicodeModel)\n976.         with mock.patch.object(\n977.                 MigrationRecorder, \'has_table\',\n978.                 autospec=True, side_effect=patched_has_table) as has_table:\n979.             with self.temporary_migration_module() as migration_dir:\n980.                 call_command("makemigrations", "migrations", verbosity=0)\n981.                 initial_file = os.path.join(migration_dir, "0001_initial.py")\n982.                 self.assertTrue(os.path.exists(initial_file))\n983.                 self.assertEqual(has_table.call_count, 1)  # \'default\' is checked\n984. \n985.                 # Router says not to migrate \'other\' so consistency shouldn\'t\n986.                 # be checked.\n987.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.TestRouter\']):\n988.                     call_command(\'makemigrations\', \'migrations\', verbosity=0)\n989.                 self.assertEqual(has_table.call_count, 2)  # \'default\' again\n990. \n991.                 # With a router that doesn\'t prohibit migrating \'other\',\n992.                 # consistency is checked.\n993.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.DefaultOtherRouter\']):\n994.                     with self.assertRaisesMessage(Exception, \'Other connection\'):\n995.                         call_command(\'makemigrations\', \'migrations\', verbosity=0)\n996.                 self.assertEqual(has_table.call_count, 4)  # \'default\' and \'other\'\n997. \n998.                 # With a router that doesn\'t allow migrating on any database,\n999.                 # no consistency checks are made.\n1000.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.TestRouter\']):', start_line_number=1, end_line_number=1000)]
2025-10-06 05:10:52,263 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nSimplify signature of `DatabaseOperations.execute_sql_flush()`\n\nIssue description: \nDescription\n\t\nThe current signature is:\ndef execute_sql_flush(self, using, sql_list):\nThe using argument can be dropped and inferred by the calling instance: self.connection.alias.\ndef execute_sql_flush(self, sql_list):\nSome internal ises of this method are already doing:\nconnection.ops.execute_sql_flush(connection.alias, sql_flush)\n\nIssue comments:\n\n\nBug reproducing context:\nFile: tests/model_regress/tests.py\nLine number range: 37 - 46\nContent:\n37.     def test_sql_insert_compiler_return_id_attribute(self):\n38.         """\n39.         Regression test for #14019: SQLInsertCompiler.as_sql() failure\n40.         """\n41.         db = router.db_for_write(Party)\n42.         query = InsertQuery(Party)\n43.         query.insert_values([Party._meta.fields[0]], [], raw=False)\n44.         # this line will raise an AttributeError without the accompanying fix\n45.         query.get_compiler(using=db).as_sql()\n46. \n\n\nFile: tests/admin_scripts/tests.py\nLine number range: 258 - 263\nContent:\n258.     def test_custom_command_with_settings(self):\n259.         "default: django-admin can execute user commands if settings are provided as argument"\n260.         args = [\'noargs_command\', \'--settings=test_project.settings\']\n261.         out, err = self.run_django_admin(args)\n262.         self.assertNoOutput(err)\n263.         self.assertOutput(out, "EXECUTE: noargs_command")\n\n\nFile: tests/backends/base/test_operations.py\nLine number range: 1 - 184\nContent:\n1. import decimal\n2. \n3. from django.core.management.color import no_style\n4. from django.db import NotSupportedError, connection, transaction\n5. from django.db.backends.base.operations import BaseDatabaseOperations\n6. from django.db.models import DurationField\n7. from django.test import (\n8.     SimpleTestCase, TestCase, TransactionTestCase, override_settings,\n9.     skipIfDBFeature,\n10. )\n11. from django.utils import timezone\n12. \n13. from ..models import Author, Book\n14. \n15. \n16. class SimpleDatabaseOperationTests(SimpleTestCase):\n17.     may_require_msg = \'subclasses of BaseDatabaseOperations may require a %s() method\'\n18. \n19.     def setUp(self):\n20.         self.ops = BaseDatabaseOperations(connection=connection)\n21. \n22.     def test_deferrable_sql(self):\n23.         self.assertEqual(self.ops.deferrable_sql(), \'\')\n24. \n25.     def test_end_transaction_rollback(self):\n26.         self.assertEqual(self.ops.end_transaction_sql(success=False), \'ROLLBACK;\')\n27. \n28.     def test_no_limit_value(self):\n29.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'no_limit_value\'):\n30.             self.ops.no_limit_value()\n31. \n32.     def test_quote_name(self):\n33.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'quote_name\'):\n34.             self.ops.quote_name(\'a\')\n35. \n36.     def test_regex_lookup(self):\n37.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'regex_lookup\'):\n38.             self.ops.regex_lookup(lookup_type=\'regex\')\n39. \n40.     def test_set_time_zone_sql(self):\n41.         self.assertEqual(self.ops.set_time_zone_sql(), \'\')\n42. \n43.     def test_sql_flush(self):\n44.         msg = \'subclasses of BaseDatabaseOperations must provide a sql_flush() method\'\n45.         with self.assertRaisesMessage(NotImplementedError, msg):\n46.             self.ops.sql_flush(None, None)\n47. \n48.     def test_pk_default_value(self):\n49.         self.assertEqual(self.ops.pk_default_value(), \'DEFAULT\')\n50. \n51.     def test_tablespace_sql(self):\n52.         self.assertEqual(self.ops.tablespace_sql(None), \'\')\n53. \n54.     def test_sequence_reset_by_name_sql(self):\n55.         self.assertEqual(self.ops.sequence_reset_by_name_sql(None, []), [])\n56. \n57.     def test_adapt_unknown_value_decimal(self):\n58.         value = decimal.Decimal(\'3.14\')\n59.         self.assertEqual(\n60.             self.ops.adapt_unknown_value(value),\n61.             self.ops.adapt_decimalfield_value(value)\n62.         )\n63. \n64.     def test_adapt_unknown_value_date(self):\n65.         value = timezone.now().date()\n66.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_datefield_value(value))\n67. \n68.     def test_adapt_unknown_value_time(self):\n69.         value = timezone.now().time()\n70.         self.assertEqual(self.ops.adapt_unknown_value(value), self.ops.adapt_timefield_value(value))\n71. \n72.     def test_adapt_timefield_value_none(self):\n73.         self.assertIsNone(self.ops.adapt_timefield_value(None))\n74. \n75.     def test_adapt_datetimefield_value(self):\n76.         self.assertIsNone(self.ops.adapt_datetimefield_value(None))\n77. \n78.     def test_adapt_timefield_value(self):\n79.         msg = \'Django does not support timezone-aware times.\'\n80.         with self.assertRaisesMessage(ValueError, msg):\n81.             self.ops.adapt_timefield_value(timezone.make_aware(timezone.now()))\n82. \n83.     @override_settings(USE_TZ=False)\n84.     def test_adapt_timefield_value_unaware(self):\n85.         now = timezone.now()\n86.         self.assertEqual(self.ops.adapt_timefield_value(now), str(now))\n87. \n88.     def test_date_extract_sql(self):\n89.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'date_extract_sql\'):\n90.             self.ops.date_extract_sql(None, None)\n91. \n92.     def test_time_extract_sql(self):\n93.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'date_extract_sql\'):\n94.             self.ops.time_extract_sql(None, None)\n95. \n96.     def test_date_interval_sql(self):\n97.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'date_interval_sql\'):\n98.             self.ops.date_interval_sql(None)\n99. \n100.     def test_date_trunc_sql(self):\n101.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'date_trunc_sql\'):\n102.             self.ops.date_trunc_sql(None, None)\n103. \n104.     def test_time_trunc_sql(self):\n105.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'time_trunc_sql\'):\n106.             self.ops.time_trunc_sql(None, None)\n107. \n108.     def test_datetime_trunc_sql(self):\n109.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'datetime_trunc_sql\'):\n110.             self.ops.datetime_trunc_sql(None, None, None)\n111. \n112.     def test_datetime_cast_date_sql(self):\n113.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'datetime_cast_date_sql\'):\n114.             self.ops.datetime_cast_date_sql(None, None)\n115. \n116.     def test_datetime_cast_time_sql(self):\n117.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'datetime_cast_time_sql\'):\n118.             self.ops.datetime_cast_time_sql(None, None)\n119. \n120.     def test_datetime_extract_sql(self):\n121.         with self.assertRaisesMessage(NotImplementedError, self.may_require_msg % \'datetime_extract_sql\'):\n122.             self.ops.datetime_extract_sql(None, None, None)\n123. \n124. \n125. class DatabaseOperationTests(TestCase):\n126.     def setUp(self):\n127.         self.ops = BaseDatabaseOperations(connection=connection)\n128. \n129.     @skipIfDBFeature(\'supports_over_clause\')\n130.     def test_window_frame_raise_not_supported_error(self):\n131.         msg = \'This backend does not support window expressions.\'\n132.         with self.assertRaisesMessage(NotSupportedError, msg):\n133.             self.ops.window_frame_rows_start_end()\n134. \n135.     @skipIfDBFeature(\'can_distinct_on_fields\')\n136.     def test_distinct_on_fields(self):\n137.         msg = \'DISTINCT ON fields is not supported by this database backend\'\n138.         with self.assertRaisesMessage(NotSupportedError, msg):\n139.             self.ops.distinct_sql([\'a\', \'b\'], None)\n140. \n141.     @skipIfDBFeature(\'supports_temporal_subtraction\')\n142.     def test_subtract_temporals(self):\n143.         duration_field = DurationField()\n144.         duration_field_internal_type = duration_field.get_internal_type()\n145.         msg = (\n146.             \'This backend does not support %s subtraction.\' %\n147.             duration_field_internal_type\n148.         )\n149.         with self.assertRaisesMessage(NotSupportedError, msg):\n150.             self.ops.subtract_temporals(duration_field_internal_type, None, None)\n151. \n152. \n153. class SqlFlushTests(TransactionTestCase):\n154.     available_apps = [\'backends\']\n155. \n156.     def test_sql_flush_no_tables(self):\n157.         self.assertEqual(connection.ops.sql_flush(no_style(), []), [])\n158. \n159.     def test_execute_sql_flush_statements(self):\n160.         with transaction.atomic():\n161.             author = Author.objects.create(name=\'George Orwell\')\n162.             Book.objects.create(author=author)\n163.             author = Author.objects.create(name=\'Harper Lee\')\n164.             Book.objects.create(author=author)\n165.             Book.objects.create(author=author)\n166.             self.assertIs(Author.objects.exists(), True)\n167.             self.assertIs(Book.objects.exists(), True)\n168. \n169.         sql_list = connection.ops.sql_flush(\n170.             no_style(),\n171.             [Author._meta.db_table, Book._meta.db_table],\n172.             reset_sequences=True,\n173.             allow_cascade=True,\n174.         )\n175.         connection.ops.execute_sql_flush(connection.alias, sql_list)\n176. \n177.         with transaction.atomic():\n178.             self.assertIs(Author.objects.exists(), False)\n179.             self.assertIs(Book.objects.exists(), False)\n180.             if connection.features.supports_sequence_reset:\n181.                 author = Author.objects.create(name=\'F. Scott Fitzgerald\')\n182.                 self.assertEqual(author.pk, 1)\n183.                 book = Book.objects.create(author=author)\n184.                 self.assertEqual(book.pk, 1)\n\n\nFile: tests/multiple_database/tests.py\nLine number range: 1 - 1000\nContent:\n1. import datetime\n2. import pickle\n3. from io import StringIO\n4. from operator import attrgetter\n5. from unittest.mock import Mock\n6. \n7. from django.contrib.auth.models import User\n8. from django.contrib.contenttypes.models import ContentType\n9. from django.core import management\n10. from django.db import DEFAULT_DB_ALIAS, router, transaction\n11. from django.db.models import signals\n12. from django.db.utils import ConnectionRouter\n13. from django.test import SimpleTestCase, TestCase, override_settings\n14. \n15. from .models import Book, Person, Pet, Review, UserProfile\n16. from .routers import AuthRouter, TestRouter, WriteRouter\n17. \n18. \n19. class QueryTestCase(TestCase):\n20.     databases = {\'default\', \'other\'}\n21. \n22.     def test_db_selection(self):\n23.         "Querysets will use the default database by default"\n24.         self.assertEqual(Book.objects.db, DEFAULT_DB_ALIAS)\n25.         self.assertEqual(Book.objects.all().db, DEFAULT_DB_ALIAS)\n26. \n27.         self.assertEqual(Book.objects.using(\'other\').db, \'other\')\n28. \n29.         self.assertEqual(Book.objects.db_manager(\'other\').db, \'other\')\n30.         self.assertEqual(Book.objects.db_manager(\'other\').all().db, \'other\')\n31. \n32.     def test_default_creation(self):\n33.         "Objects created on the default database don\'t leak onto other databases"\n34.         # Create a book on the default database using create()\n35.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n36. \n37.         # Create a book on the default database using a save\n38.         dive = Book()\n39.         dive.title = "Dive into Python"\n40.         dive.published = datetime.date(2009, 5, 4)\n41.         dive.save()\n42. \n43.         # Book exists on the default database, but not on other database\n44.         try:\n45.             Book.objects.get(title="Pro Django")\n46.             Book.objects.using(\'default\').get(title="Pro Django")\n47.         except Book.DoesNotExist:\n48.             self.fail(\'"Pro Django" should exist on default database\')\n49. \n50.         with self.assertRaises(Book.DoesNotExist):\n51.             Book.objects.using(\'other\').get(title="Pro Django")\n52. \n53.         try:\n54.             Book.objects.get(title="Dive into Python")\n55.             Book.objects.using(\'default\').get(title="Dive into Python")\n56.         except Book.DoesNotExist:\n57.             self.fail(\'"Dive into Python" should exist on default database\')\n58. \n59.         with self.assertRaises(Book.DoesNotExist):\n60.             Book.objects.using(\'other\').get(title="Dive into Python")\n61. \n62.     def test_other_creation(self):\n63.         "Objects created on another database don\'t leak onto the default database"\n64.         # Create a book on the second database\n65.         Book.objects.using(\'other\').create(title="Pro Django",\n66.                                            published=datetime.date(2008, 12, 16))\n67. \n68.         # Create a book on the default database using a save\n69.         dive = Book()\n70.         dive.title = "Dive into Python"\n71.         dive.published = datetime.date(2009, 5, 4)\n72.         dive.save(using=\'other\')\n73. \n74.         # Book exists on the default database, but not on other database\n75.         try:\n76.             Book.objects.using(\'other\').get(title="Pro Django")\n77.         except Book.DoesNotExist:\n78.             self.fail(\'"Pro Django" should exist on other database\')\n79. \n80.         with self.assertRaises(Book.DoesNotExist):\n81.             Book.objects.get(title="Pro Django")\n82.         with self.assertRaises(Book.DoesNotExist):\n83.             Book.objects.using(\'default\').get(title="Pro Django")\n84. \n85.         try:\n86.             Book.objects.using(\'other\').get(title="Dive into Python")\n87.         except Book.DoesNotExist:\n88.             self.fail(\'"Dive into Python" should exist on other database\')\n89. \n90.         with self.assertRaises(Book.DoesNotExist):\n91.             Book.objects.get(title="Dive into Python")\n92.         with self.assertRaises(Book.DoesNotExist):\n93.             Book.objects.using(\'default\').get(title="Dive into Python")\n94. \n95.     def test_refresh(self):\n96.         dive = Book(title="Dive into Python", published=datetime.date(2009, 5, 4))\n97.         dive.save(using=\'other\')\n98.         dive2 = Book.objects.using(\'other\').get()\n99.         dive2.title = "Dive into Python (on default)"\n100.         dive2.save(using=\'default\')\n101.         dive.refresh_from_db()\n102.         self.assertEqual(dive.title, "Dive into Python")\n103.         dive.refresh_from_db(using=\'default\')\n104.         self.assertEqual(dive.title, "Dive into Python (on default)")\n105.         self.assertEqual(dive._state.db, "default")\n106. \n107.     def test_refresh_router_instance_hint(self):\n108.         router = Mock()\n109.         router.db_for_read.return_value = None\n110.         book = Book.objects.create(title=\'Dive Into Python\', published=datetime.date(1957, 10, 12))\n111.         with self.settings(DATABASE_ROUTERS=[router]):\n112.             book.refresh_from_db()\n113.         router.db_for_read.assert_called_once_with(Book, instance=book)\n114. \n115.     def test_basic_queries(self):\n116.         "Queries are constrained to a single database"\n117.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n118. \n119.         dive = Book.objects.using(\'other\').get(published=datetime.date(2009, 5, 4))\n120.         self.assertEqual(dive.title, "Dive into Python")\n121.         with self.assertRaises(Book.DoesNotExist):\n122.             Book.objects.using(\'default\').get(published=datetime.date(2009, 5, 4))\n123. \n124.         dive = Book.objects.using(\'other\').get(title__icontains="dive")\n125.         self.assertEqual(dive.title, "Dive into Python")\n126.         with self.assertRaises(Book.DoesNotExist):\n127.             Book.objects.using(\'default\').get(title__icontains="dive")\n128. \n129.         dive = Book.objects.using(\'other\').get(title__iexact="dive INTO python")\n130.         self.assertEqual(dive.title, "Dive into Python")\n131.         with self.assertRaises(Book.DoesNotExist):\n132.             Book.objects.using(\'default\').get(title__iexact="dive INTO python")\n133. \n134.         dive = Book.objects.using(\'other\').get(published__year=2009)\n135.         self.assertEqual(dive.title, "Dive into Python")\n136.         self.assertEqual(dive.published, datetime.date(2009, 5, 4))\n137.         with self.assertRaises(Book.DoesNotExist):\n138.             Book.objects.using(\'default\').get(published__year=2009)\n139. \n140.         years = Book.objects.using(\'other\').dates(\'published\', \'year\')\n141.         self.assertEqual([o.year for o in years], [2009])\n142.         years = Book.objects.using(\'default\').dates(\'published\', \'year\')\n143.         self.assertEqual([o.year for o in years], [])\n144. \n145.         months = Book.objects.using(\'other\').dates(\'published\', \'month\')\n146.         self.assertEqual([o.month for o in months], [5])\n147.         months = Book.objects.using(\'default\').dates(\'published\', \'month\')\n148.         self.assertEqual([o.month for o in months], [])\n149. \n150.     def test_m2m_separation(self):\n151.         "M2M fields are constrained to a single database"\n152.         # Create a book and author on the default database\n153.         pro = Book.objects.create(title="Pro Django",\n154.                                   published=datetime.date(2008, 12, 16))\n155. \n156.         marty = Person.objects.create(name="Marty Alchin")\n157. \n158.         # Create a book and author on the other database\n159.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n160. \n161.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n162. \n163.         # Save the author relations\n164.         pro.authors.set([marty])\n165.         dive.authors.set([mark])\n166. \n167.         # Inspect the m2m tables directly.\n168.         # There should be 1 entry in each database\n169.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 1)\n170.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n171. \n172.         # Queries work across m2m joins\n173.         self.assertEqual(\n174.             list(Book.objects.using(\'default\').filter(authors__name=\'Marty Alchin\').values_list(\'title\', flat=True)),\n175.             [\'Pro Django\']\n176.         )\n177.         self.assertEqual(\n178.             list(Book.objects.using(\'other\').filter(authors__name=\'Marty Alchin\').values_list(\'title\', flat=True)),\n179.             []\n180.         )\n181. \n182.         self.assertEqual(\n183.             list(Book.objects.using(\'default\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n184.             []\n185.         )\n186.         self.assertEqual(\n187.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n188.             [\'Dive into Python\']\n189.         )\n190. \n191.         # Reget the objects to clear caches\n192.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n193.         mark = Person.objects.using(\'other\').get(name="Mark Pilgrim")\n194. \n195.         # Retrieve related object by descriptor. Related objects should be database-bound\n196.         self.assertEqual(list(dive.authors.all().values_list(\'name\', flat=True)), [\'Mark Pilgrim\'])\n197. \n198.         self.assertEqual(list(mark.book_set.all().values_list(\'title\', flat=True)), [\'Dive into Python\'])\n199. \n200.     def test_m2m_forward_operations(self):\n201.         "M2M forward manipulations are all constrained to a single DB"\n202.         # Create a book and author on the other database\n203.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n204.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n205. \n206.         # Save the author relations\n207.         dive.authors.set([mark])\n208. \n209.         # Add a second author\n210.         john = Person.objects.using(\'other\').create(name="John Smith")\n211.         self.assertEqual(\n212.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n213.             []\n214.         )\n215. \n216.         dive.authors.add(john)\n217.         self.assertEqual(\n218.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n219.             [\'Dive into Python\']\n220.         )\n221.         self.assertEqual(\n222.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n223.             [\'Dive into Python\']\n224.         )\n225. \n226.         # Remove the second author\n227.         dive.authors.remove(john)\n228.         self.assertEqual(\n229.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n230.             [\'Dive into Python\']\n231.         )\n232.         self.assertEqual(\n233.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n234.             []\n235.         )\n236. \n237.         # Clear all authors\n238.         dive.authors.clear()\n239.         self.assertEqual(\n240.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n241.             []\n242.         )\n243.         self.assertEqual(\n244.             list(Book.objects.using(\'other\').filter(authors__name=\'John Smith\').values_list(\'title\', flat=True)),\n245.             []\n246.         )\n247. \n248.         # Create an author through the m2m interface\n249.         dive.authors.create(name=\'Jane Brown\')\n250.         self.assertEqual(\n251.             list(Book.objects.using(\'other\').filter(authors__name=\'Mark Pilgrim\').values_list(\'title\', flat=True)),\n252.             []\n253.         )\n254.         self.assertEqual(\n255.             list(Book.objects.using(\'other\').filter(authors__name=\'Jane Brown\').values_list(\'title\', flat=True)),\n256.             [\'Dive into Python\']\n257.         )\n258. \n259.     def test_m2m_reverse_operations(self):\n260.         "M2M reverse manipulations are all constrained to a single DB"\n261.         # Create a book and author on the other database\n262.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n263.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n264. \n265.         # Save the author relations\n266.         dive.authors.set([mark])\n267. \n268.         # Create a second book on the other database\n269.         grease = Book.objects.using(\'other\').create(title="Greasemonkey Hacks", published=datetime.date(2005, 11, 1))\n270. \n271.         # Add a books to the m2m\n272.         mark.book_set.add(grease)\n273.         self.assertEqual(\n274.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n275.             [\'Mark Pilgrim\']\n276.         )\n277.         self.assertEqual(\n278.             list(\n279.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n280.             ),\n281.             [\'Mark Pilgrim\']\n282.         )\n283. \n284.         # Remove a book from the m2m\n285.         mark.book_set.remove(grease)\n286.         self.assertEqual(\n287.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n288.             [\'Mark Pilgrim\']\n289.         )\n290.         self.assertEqual(\n291.             list(\n292.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n293.             ),\n294.             []\n295.         )\n296. \n297.         # Clear the books associated with mark\n298.         mark.book_set.clear()\n299.         self.assertEqual(\n300.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n301.             []\n302.         )\n303.         self.assertEqual(\n304.             list(\n305.                 Person.objects.using(\'other\').filter(book__title=\'Greasemonkey Hacks\').values_list(\'name\', flat=True)\n306.             ),\n307.             []\n308.         )\n309. \n310.         # Create a book through the m2m interface\n311.         mark.book_set.create(title="Dive into HTML5", published=datetime.date(2020, 1, 1))\n312.         self.assertEqual(\n313.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into Python\').values_list(\'name\', flat=True)),\n314.             []\n315.         )\n316.         self.assertEqual(\n317.             list(Person.objects.using(\'other\').filter(book__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n318.             [\'Mark Pilgrim\']\n319.         )\n320. \n321.     def test_m2m_cross_database_protection(self):\n322.         "Operations that involve sharing M2M objects across databases raise an error"\n323.         # Create a book and author on the default database\n324.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n325. \n326.         marty = Person.objects.create(name="Marty Alchin")\n327. \n328.         # Create a book and author on the other database\n329.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n330. \n331.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n332.         # Set a foreign key set with an object from a different database\n333.         msg = (\n334.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n335.             \'router prevents this relation.\'\n336.         )\n337.         with self.assertRaisesMessage(ValueError, msg):\n338.             with transaction.atomic(using=\'default\'):\n339.                 marty.edited.set([pro, dive])\n340. \n341.         # Add to an m2m with an object from a different database\n342.         msg = (\n343.             \'Cannot add "<Book: Dive into Python>": instance is on \'\n344.             \'database "default", value is on database "other"\'\n345.         )\n346.         with self.assertRaisesMessage(ValueError, msg):\n347.             with transaction.atomic(using=\'default\'):\n348.                 marty.book_set.add(dive)\n349. \n350.         # Set a m2m with an object from a different database\n351.         with self.assertRaisesMessage(ValueError, msg):\n352.             with transaction.atomic(using=\'default\'):\n353.                 marty.book_set.set([pro, dive])\n354. \n355.         # Add to a reverse m2m with an object from a different database\n356.         msg = (\n357.             \'Cannot add "<Person: Marty Alchin>": instance is on \'\n358.             \'database "other", value is on database "default"\'\n359.         )\n360.         with self.assertRaisesMessage(ValueError, msg):\n361.             with transaction.atomic(using=\'other\'):\n362.                 dive.authors.add(marty)\n363. \n364.         # Set a reverse m2m with an object from a different database\n365.         with self.assertRaisesMessage(ValueError, msg):\n366.             with transaction.atomic(using=\'other\'):\n367.                 dive.authors.set([mark, marty])\n368. \n369.     def test_m2m_deletion(self):\n370.         "Cascaded deletions of m2m relations issue queries on the right database"\n371.         # Create a book and author on the other database\n372.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n373.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n374.         dive.authors.set([mark])\n375. \n376.         # Check the initial state\n377.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n378.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n379.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n380. \n381.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n382.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n383.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n384. \n385.         # Delete the object on the other database\n386.         dive.delete(using=\'other\')\n387. \n388.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n389.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n390.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n391. \n392.         # The person still exists ...\n393.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n394.         # ... but the book has been deleted\n395.         self.assertEqual(Book.objects.using(\'other\').count(), 0)\n396.         # ... and the relationship object has also been deleted.\n397.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 0)\n398. \n399.         # Now try deletion in the reverse direction. Set up the relation again\n400.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n401.         dive.authors.set([mark])\n402. \n403.         # Check the initial state\n404.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n405.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n406.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n407. \n408.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n409.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n410.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 1)\n411. \n412.         # Delete the object on the other database\n413.         mark.delete(using=\'other\')\n414. \n415.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n416.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n417.         self.assertEqual(Book.authors.through.objects.using(\'default\').count(), 0)\n418. \n419.         # The person has been deleted ...\n420.         self.assertEqual(Person.objects.using(\'other\').count(), 0)\n421.         # ... but the book still exists\n422.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n423.         # ... and the relationship object has been deleted.\n424.         self.assertEqual(Book.authors.through.objects.using(\'other\').count(), 0)\n425. \n426.     def test_foreign_key_separation(self):\n427.         "FK fields are constrained to a single database"\n428.         # Create a book and author on the default database\n429.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n430. \n431.         george = Person.objects.create(name="George Vilches")\n432. \n433.         # Create a book and author on the other database\n434.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n435.         chris = Person.objects.using(\'other\').create(name="Chris Mills")\n436. \n437.         # Save the author\'s favorite books\n438.         pro.editor = george\n439.         pro.save()\n440. \n441.         dive.editor = chris\n442.         dive.save()\n443. \n444.         pro = Book.objects.using(\'default\').get(title="Pro Django")\n445.         self.assertEqual(pro.editor.name, "George Vilches")\n446. \n447.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n448.         self.assertEqual(dive.editor.name, "Chris Mills")\n449. \n450.         # Queries work across foreign key joins\n451.         self.assertEqual(\n452.             list(Person.objects.using(\'default\').filter(edited__title=\'Pro Django\').values_list(\'name\', flat=True)),\n453.             [\'George Vilches\']\n454.         )\n455.         self.assertEqual(\n456.             list(Person.objects.using(\'other\').filter(edited__title=\'Pro Django\').values_list(\'name\', flat=True)),\n457.             []\n458.         )\n459. \n460.         self.assertEqual(\n461.             list(\n462.                 Person.objects.using(\'default\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n463.             ),\n464.             []\n465.         )\n466.         self.assertEqual(\n467.             list(\n468.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n469.             ),\n470.             [\'Chris Mills\']\n471.         )\n472. \n473.         # Reget the objects to clear caches\n474.         chris = Person.objects.using(\'other\').get(name="Chris Mills")\n475.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n476. \n477.         # Retrieve related object by descriptor. Related objects should be database-bound\n478.         self.assertEqual(list(chris.edited.values_list(\'title\', flat=True)), [\'Dive into Python\'])\n479. \n480.     def test_foreign_key_reverse_operations(self):\n481.         "FK reverse manipulations are all constrained to a single DB"\n482.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n483.         chris = Person.objects.using(\'other\').create(name="Chris Mills")\n484. \n485.         # Save the author relations\n486.         dive.editor = chris\n487.         dive.save()\n488. \n489.         # Add a second book edited by chris\n490.         html5 = Book.objects.using(\'other\').create(title="Dive into HTML5", published=datetime.date(2010, 3, 15))\n491.         self.assertEqual(\n492.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n493.             []\n494.         )\n495. \n496.         chris.edited.add(html5)\n497.         self.assertEqual(\n498.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n499.             [\'Chris Mills\']\n500.         )\n501.         self.assertEqual(\n502.             list(\n503.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n504.             ),\n505.             [\'Chris Mills\']\n506.         )\n507. \n508.         # Remove the second editor\n509.         chris.edited.remove(html5)\n510.         self.assertEqual(\n511.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n512.             []\n513.         )\n514.         self.assertEqual(\n515.             list(\n516.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n517.             ),\n518.             [\'Chris Mills\']\n519.         )\n520. \n521.         # Clear all edited books\n522.         chris.edited.clear()\n523.         self.assertEqual(\n524.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n525.             []\n526.         )\n527.         self.assertEqual(\n528.             list(\n529.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n530.             ),\n531.             []\n532.         )\n533. \n534.         # Create an author through the m2m interface\n535.         chris.edited.create(title=\'Dive into Water\', published=datetime.date(2010, 3, 15))\n536.         self.assertEqual(\n537.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into HTML5\').values_list(\'name\', flat=True)),\n538.             []\n539.         )\n540.         self.assertEqual(\n541.             list(Person.objects.using(\'other\').filter(edited__title=\'Dive into Water\').values_list(\'name\', flat=True)),\n542.             [\'Chris Mills\']\n543.         )\n544.         self.assertEqual(\n545.             list(\n546.                 Person.objects.using(\'other\').filter(edited__title=\'Dive into Python\').values_list(\'name\', flat=True)\n547.             ),\n548.             []\n549.         )\n550. \n551.     def test_foreign_key_cross_database_protection(self):\n552.         "Operations that involve sharing FK objects across databases raise an error"\n553.         # Create a book and author on the default database\n554.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n555.         marty = Person.objects.create(name="Marty Alchin")\n556. \n557.         # Create a book and author on the other database\n558.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n559. \n560.         # Set a foreign key with an object from a different database\n561.         msg = (\n562.             \'Cannot assign "<Person: Marty Alchin>": the current database \'\n563.             \'router prevents this relation.\'\n564.         )\n565.         with self.assertRaisesMessage(ValueError, msg):\n566.             dive.editor = marty\n567. \n568.         # Set a foreign key set with an object from a different database\n569.         with self.assertRaisesMessage(ValueError, msg):\n570.             with transaction.atomic(using=\'default\'):\n571.                 marty.edited.set([pro, dive])\n572. \n573.         # Add to a foreign key set with an object from a different database\n574.         with self.assertRaisesMessage(ValueError, msg):\n575.             with transaction.atomic(using=\'default\'):\n576.                 marty.edited.add(dive)\n577. \n578.     def test_foreign_key_deletion(self):\n579.         "Cascaded deletions of Foreign Key relations issue queries on the right database"\n580.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n581.         Pet.objects.using(\'other\').create(name="Fido", owner=mark)\n582. \n583.         # Check the initial state\n584.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n585.         self.assertEqual(Pet.objects.using(\'default\').count(), 0)\n586. \n587.         self.assertEqual(Person.objects.using(\'other\').count(), 1)\n588.         self.assertEqual(Pet.objects.using(\'other\').count(), 1)\n589. \n590.         # Delete the person object, which will cascade onto the pet\n591.         mark.delete(using=\'other\')\n592. \n593.         self.assertEqual(Person.objects.using(\'default\').count(), 0)\n594.         self.assertEqual(Pet.objects.using(\'default\').count(), 0)\n595. \n596.         # Both the pet and the person have been deleted from the right database\n597.         self.assertEqual(Person.objects.using(\'other\').count(), 0)\n598.         self.assertEqual(Pet.objects.using(\'other\').count(), 0)\n599. \n600.     def test_foreign_key_validation(self):\n601.         "ForeignKey.validate() uses the correct database"\n602.         mickey = Person.objects.using(\'other\').create(name="Mickey")\n603.         pluto = Pet.objects.using(\'other\').create(name="Pluto", owner=mickey)\n604.         self.assertIsNone(pluto.full_clean())\n605. \n606.     # Any router that accesses `model` in db_for_read() works here.\n607.     @override_settings(DATABASE_ROUTERS=[AuthRouter()])\n608.     def test_foreign_key_validation_with_router(self):\n609.         """\n610.         ForeignKey.validate() passes `model` to db_for_read() even if\n611.         model_instance=None.\n612.         """\n613.         mickey = Person.objects.create(name="Mickey")\n614.         owner_field = Pet._meta.get_field(\'owner\')\n615.         self.assertEqual(owner_field.clean(mickey.pk, None), mickey.pk)\n616. \n617.     def test_o2o_separation(self):\n618.         "OneToOne fields are constrained to a single database"\n619.         # Create a user and profile on the default database\n620.         alice = User.objects.db_manager(\'default\').create_user(\'alice\', \'alice@example.com\')\n621.         alice_profile = UserProfile.objects.using(\'default\').create(user=alice, flavor=\'chocolate\')\n622. \n623.         # Create a user and profile on the other database\n624.         bob = User.objects.db_manager(\'other\').create_user(\'bob\', \'bob@example.com\')\n625.         bob_profile = UserProfile.objects.using(\'other\').create(user=bob, flavor=\'crunchy frog\')\n626. \n627.         # Retrieve related objects; queries should be database constrained\n628.         alice = User.objects.using(\'default\').get(username="alice")\n629.         self.assertEqual(alice.userprofile.flavor, "chocolate")\n630. \n631.         bob = User.objects.using(\'other\').get(username="bob")\n632.         self.assertEqual(bob.userprofile.flavor, "crunchy frog")\n633. \n634.         # Queries work across joins\n635.         self.assertEqual(\n636.             list(\n637.                 User.objects.using(\'default\')\n638.                 .filter(userprofile__flavor=\'chocolate\').values_list(\'username\', flat=True)\n639.             ),\n640.             [\'alice\']\n641.         )\n642.         self.assertEqual(\n643.             list(\n644.                 User.objects.using(\'other\')\n645.                 .filter(userprofile__flavor=\'chocolate\').values_list(\'username\', flat=True)\n646.             ),\n647.             []\n648.         )\n649. \n650.         self.assertEqual(\n651.             list(\n652.                 User.objects.using(\'default\')\n653.                 .filter(userprofile__flavor=\'crunchy frog\').values_list(\'username\', flat=True)\n654.             ),\n655.             []\n656.         )\n657.         self.assertEqual(\n658.             list(\n659.                 User.objects.using(\'other\')\n660.                 .filter(userprofile__flavor=\'crunchy frog\').values_list(\'username\', flat=True)\n661.             ),\n662.             [\'bob\']\n663.         )\n664. \n665.         # Reget the objects to clear caches\n666.         alice_profile = UserProfile.objects.using(\'default\').get(flavor=\'chocolate\')\n667.         bob_profile = UserProfile.objects.using(\'other\').get(flavor=\'crunchy frog\')\n668. \n669.         # Retrieve related object by descriptor. Related objects should be database-bound\n670.         self.assertEqual(alice_profile.user.username, \'alice\')\n671.         self.assertEqual(bob_profile.user.username, \'bob\')\n672. \n673.     def test_o2o_cross_database_protection(self):\n674.         "Operations that involve sharing FK objects across databases raise an error"\n675.         # Create a user and profile on the default database\n676.         alice = User.objects.db_manager(\'default\').create_user(\'alice\', \'alice@example.com\')\n677. \n678.         # Create a user and profile on the other database\n679.         bob = User.objects.db_manager(\'other\').create_user(\'bob\', \'bob@example.com\')\n680. \n681.         # Set a one-to-one relation with an object from a different database\n682.         alice_profile = UserProfile.objects.using(\'default\').create(user=alice, flavor=\'chocolate\')\n683.         msg = (\n684.             \'Cannot assign "%r": the current database router prevents this \'\n685.             \'relation.\' % alice_profile\n686.         )\n687.         with self.assertRaisesMessage(ValueError, msg):\n688.             bob.userprofile = alice_profile\n689. \n690.         # BUT! if you assign a FK object when the base object hasn\'t\n691.         # been saved yet, you implicitly assign the database for the\n692.         # base object.\n693.         bob_profile = UserProfile.objects.using(\'other\').create(user=bob, flavor=\'crunchy frog\')\n694. \n695.         new_bob_profile = UserProfile(flavor="spring surprise")\n696. \n697.         # assigning a profile requires an explicit pk as the object isn\'t saved\n698.         charlie = User(pk=51, username=\'charlie\', email=\'charlie@example.com\')\n699.         charlie.set_unusable_password()\n700. \n701.         # initially, no db assigned\n702.         self.assertIsNone(new_bob_profile._state.db)\n703.         self.assertIsNone(charlie._state.db)\n704. \n705.         # old object comes from \'other\', so the new object is set to use \'other\'...\n706.         new_bob_profile.user = bob\n707.         charlie.userprofile = bob_profile\n708.         self.assertEqual(new_bob_profile._state.db, \'other\')\n709.         self.assertEqual(charlie._state.db, \'other\')\n710. \n711.         # ... but it isn\'t saved yet\n712.         self.assertEqual(list(User.objects.using(\'other\').values_list(\'username\', flat=True)), [\'bob\'])\n713.         self.assertEqual(list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)), [\'crunchy frog\'])\n714. \n715.         # When saved (no using required), new objects goes to \'other\'\n716.         charlie.save()\n717.         bob_profile.save()\n718.         new_bob_profile.save()\n719.         self.assertEqual(list(User.objects.using(\'default\').values_list(\'username\', flat=True)), [\'alice\'])\n720.         self.assertEqual(list(User.objects.using(\'other\').values_list(\'username\', flat=True)), [\'bob\', \'charlie\'])\n721.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n722.         self.assertEqual(\n723.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n724.             [\'crunchy frog\', \'spring surprise\']\n725.         )\n726. \n727.         # This also works if you assign the O2O relation in the constructor\n728.         denise = User.objects.db_manager(\'other\').create_user(\'denise\', \'denise@example.com\')\n729.         denise_profile = UserProfile(flavor="tofu", user=denise)\n730. \n731.         self.assertEqual(denise_profile._state.db, \'other\')\n732.         # ... but it isn\'t saved yet\n733.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n734.         self.assertEqual(\n735.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n736.             [\'crunchy frog\', \'spring surprise\']\n737.         )\n738. \n739.         # When saved, the new profile goes to \'other\'\n740.         denise_profile.save()\n741.         self.assertEqual(list(UserProfile.objects.using(\'default\').values_list(\'flavor\', flat=True)), [\'chocolate\'])\n742.         self.assertEqual(\n743.             list(UserProfile.objects.using(\'other\').values_list(\'flavor\', flat=True)),\n744.             [\'crunchy frog\', \'spring surprise\', \'tofu\']\n745.         )\n746. \n747.     def test_generic_key_separation(self):\n748.         "Generic fields are constrained to a single database"\n749.         # Create a book and author on the default database\n750.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n751.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)\n752. \n753.         # Create a book and author on the other database\n754.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n755. \n756.         review2 = Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n757. \n758.         review1 = Review.objects.using(\'default\').get(source="Python Monthly")\n759.         self.assertEqual(review1.content_object.title, "Pro Django")\n760. \n761.         review2 = Review.objects.using(\'other\').get(source="Python Weekly")\n762.         self.assertEqual(review2.content_object.title, "Dive into Python")\n763. \n764.         # Reget the objects to clear caches\n765.         dive = Book.objects.using(\'other\').get(title="Dive into Python")\n766. \n767.         # Retrieve related object by descriptor. Related objects should be database-bound\n768.         self.assertEqual(list(dive.reviews.all().values_list(\'source\', flat=True)), [\'Python Weekly\'])\n769. \n770.     def test_generic_key_reverse_operations(self):\n771.         "Generic reverse manipulations are all constrained to a single DB"\n772.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n773.         temp = Book.objects.using(\'other\').create(title="Temp", published=datetime.date(2009, 5, 4))\n774.         review1 = Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n775.         review2 = Review.objects.using(\'other\').create(source="Python Monthly", content_object=temp)\n776. \n777.         self.assertEqual(\n778.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n779.             []\n780.         )\n781.         self.assertEqual(\n782.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n783.             [\'Python Weekly\']\n784.         )\n785. \n786.         # Add a second review\n787.         dive.reviews.add(review2)\n788.         self.assertEqual(\n789.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n790.             []\n791.         )\n792.         self.assertEqual(\n793.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n794.             [\'Python Monthly\', \'Python Weekly\']\n795.         )\n796. \n797.         # Remove the second author\n798.         dive.reviews.remove(review1)\n799.         self.assertEqual(\n800.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n801.             []\n802.         )\n803.         self.assertEqual(\n804.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n805.             [\'Python Monthly\']\n806.         )\n807. \n808.         # Clear all reviews\n809.         dive.reviews.clear()\n810.         self.assertEqual(\n811.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n812.             []\n813.         )\n814.         self.assertEqual(\n815.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n816.             []\n817.         )\n818. \n819.         # Create an author through the generic interface\n820.         dive.reviews.create(source=\'Python Daily\')\n821.         self.assertEqual(\n822.             list(Review.objects.using(\'default\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n823.             []\n824.         )\n825.         self.assertEqual(\n826.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n827.             [\'Python Daily\']\n828.         )\n829. \n830.     def test_generic_key_cross_database_protection(self):\n831.         "Operations that involve sharing generic key objects across databases raise an error"\n832.         # Create a book and author on the default database\n833.         pro = Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n834.         review1 = Review.objects.create(source="Python Monthly", content_object=pro)\n835. \n836.         # Create a book and author on the other database\n837.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n838. \n839.         Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n840. \n841.         # Set a foreign key with an object from a different database\n842.         msg = (\n843.             \'Cannot assign "<ContentType: multiple_database | book>": the \'\n844.             \'current database router prevents this relation.\'\n845.         )\n846.         with self.assertRaisesMessage(ValueError, msg):\n847.             review1.content_object = dive\n848. \n849.         # Add to a foreign key set with an object from a different database\n850.         msg = (\n851.             "<Review: Python Monthly> instance isn\'t saved. "\n852.             "Use bulk=False or save the object first."\n853.         )\n854.         with self.assertRaisesMessage(ValueError, msg):\n855.             with transaction.atomic(using=\'other\'):\n856.                 dive.reviews.add(review1)\n857. \n858.         # BUT! if you assign a FK object when the base object hasn\'t\n859.         # been saved yet, you implicitly assign the database for the\n860.         # base object.\n861.         review3 = Review(source="Python Daily")\n862.         # initially, no db assigned\n863.         self.assertIsNone(review3._state.db)\n864. \n865.         # Dive comes from \'other\', so review3 is set to use \'other\'...\n866.         review3.content_object = dive\n867.         self.assertEqual(review3._state.db, \'other\')\n868.         # ... but it isn\'t saved yet\n869.         self.assertEqual(\n870.             list(Review.objects.using(\'default\').filter(object_id=pro.pk).values_list(\'source\', flat=True)),\n871.             [\'Python Monthly\']\n872.         )\n873.         self.assertEqual(\n874.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n875.             [\'Python Weekly\']\n876.         )\n877. \n878.         # When saved, John goes to \'other\'\n879.         review3.save()\n880.         self.assertEqual(\n881.             list(Review.objects.using(\'default\').filter(object_id=pro.pk).values_list(\'source\', flat=True)),\n882.             [\'Python Monthly\']\n883.         )\n884.         self.assertEqual(\n885.             list(Review.objects.using(\'other\').filter(object_id=dive.pk).values_list(\'source\', flat=True)),\n886.             [\'Python Daily\', \'Python Weekly\']\n887.         )\n888. \n889.     def test_generic_key_deletion(self):\n890.         "Cascaded deletions of Generic Key relations issue queries on the right database"\n891.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n892.         Review.objects.using(\'other\').create(source="Python Weekly", content_object=dive)\n893. \n894.         # Check the initial state\n895.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n896.         self.assertEqual(Review.objects.using(\'default\').count(), 0)\n897. \n898.         self.assertEqual(Book.objects.using(\'other\').count(), 1)\n899.         self.assertEqual(Review.objects.using(\'other\').count(), 1)\n900. \n901.         # Delete the Book object, which will cascade onto the pet\n902.         dive.delete(using=\'other\')\n903. \n904.         self.assertEqual(Book.objects.using(\'default\').count(), 0)\n905.         self.assertEqual(Review.objects.using(\'default\').count(), 0)\n906. \n907.         # Both the pet and the person have been deleted from the right database\n908.         self.assertEqual(Book.objects.using(\'other\').count(), 0)\n909.         self.assertEqual(Review.objects.using(\'other\').count(), 0)\n910. \n911.     def test_ordering(self):\n912.         "get_next_by_XXX commands stick to a single database"\n913.         Book.objects.create(title="Pro Django", published=datetime.date(2008, 12, 16))\n914.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n915.         learn = Book.objects.using(\'other\').create(title="Learning Python", published=datetime.date(2008, 7, 16))\n916. \n917.         self.assertEqual(learn.get_next_by_published().title, "Dive into Python")\n918.         self.assertEqual(dive.get_previous_by_published().title, "Learning Python")\n919. \n920.     def test_raw(self):\n921.         "test the raw() method across databases"\n922.         dive = Book.objects.using(\'other\').create(title="Dive into Python", published=datetime.date(2009, 5, 4))\n923.         val = Book.objects.db_manager("other").raw(\'SELECT id FROM multiple_database_book\')\n924.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))\n925. \n926.         val = Book.objects.raw(\'SELECT id FROM multiple_database_book\').using(\'other\')\n927.         self.assertQuerysetEqual(val, [dive.pk], attrgetter("pk"))\n928. \n929.     def test_select_related(self):\n930.         "Database assignment is retained if an object is retrieved with select_related()"\n931.         # Create a book and author on the other database\n932.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n933.         Book.objects.using(\'other\').create(\n934.             title="Dive into Python",\n935.             published=datetime.date(2009, 5, 4),\n936.             editor=mark,\n937.         )\n938. \n939.         # Retrieve the Person using select_related()\n940.         book = Book.objects.using(\'other\').select_related(\'editor\').get(title="Dive into Python")\n941. \n942.         # The editor instance should have a db state\n943.         self.assertEqual(book.editor._state.db, \'other\')\n944. \n945.     def test_subquery(self):\n946.         """Make sure as_sql works with subqueries and primary/replica."""\n947.         sub = Person.objects.using(\'other\').filter(name=\'fff\')\n948.         qs = Book.objects.filter(editor__in=sub)\n949. \n950.         # When you call __str__ on the query object, it doesn\'t know about using\n951.         # so it falls back to the default. If the subquery explicitly uses a\n952.         # different database, an error should be raised.\n953.         msg = (\n954.             "Subqueries aren\'t allowed across different databases. Force the "\n955.             "inner query to be evaluated using `list(inner_query)`."\n956.         )\n957.         with self.assertRaisesMessage(ValueError, msg):\n958.             str(qs.query)\n959. \n960.         # Evaluating the query shouldn\'t work, either\n961.         with self.assertRaisesMessage(ValueError, msg):\n962.             for obj in qs:\n963.                 pass\n964. \n965.     def test_related_manager(self):\n966.         "Related managers return managers, not querysets"\n967.         mark = Person.objects.using(\'other\').create(name="Mark Pilgrim")\n968. \n969.         # extra_arg is removed by the BookManager\'s implementation of\n970.         # create(); but the BookManager\'s implementation won\'t get called\n971.         # unless edited returns a Manager, not a queryset\n972.         mark.book_set.create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)\n973.         mark.book_set.get_or_create(title="Dive into Python", published=datetime.date(2009, 5, 4), extra_arg=True)\n974.         mark.edited.create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)\n975.         mark.edited.get_or_create(title="Dive into Water", published=datetime.date(2009, 5, 4), extra_arg=True)\n976. \n977. \n978. class ConnectionRouterTestCase(SimpleTestCase):\n979.     @override_settings(DATABASE_ROUTERS=[\n980.         \'multiple_database.tests.TestRouter\',\n981.         \'multiple_database.tests.WriteRouter\'])\n982.     def test_router_init_default(self):\n983.         connection_router = ConnectionRouter()\n984.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n985. \n986.     def test_router_init_arg(self):\n987.         connection_router = ConnectionRouter([\n988.             \'multiple_database.tests.TestRouter\',\n989.             \'multiple_database.tests.WriteRouter\'\n990.         ])\n991.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n992. \n993.         # Init with instances instead of strings\n994.         connection_router = ConnectionRouter([TestRouter(), WriteRouter()])\n995.         self.assertEqual([r.__class__.__name__ for r in connection_router.routers], [\'TestRouter\', \'WriteRouter\'])\n996. \n997. \n998. # Make the \'other\' database appear to be a replica of the \'default\'\n999. @override_settings(DATABASE_ROUTERS=[TestRouter()])\n1000. class RouterTestCase(TestCase):\n\n\nFile: tests/migrations/test_commands.py\nLine number range: 1 - 1000\nContent:\n1. import datetime\n2. import importlib\n3. import io\n4. import os\n5. import sys\n6. from unittest import mock\n7. \n8. from django.apps import apps\n9. from django.core.management import CommandError, call_command\n10. from django.db import (\n11.     ConnectionHandler, DatabaseError, connection, connections, models,\n12. )\n13. from django.db.backends.base.schema import BaseDatabaseSchemaEditor\n14. from django.db.backends.utils import truncate_name\n15. from django.db.migrations.exceptions import InconsistentMigrationHistory\n16. from django.db.migrations.recorder import MigrationRecorder\n17. from django.test import TestCase, override_settings, skipUnlessDBFeature\n18. \n19. from .models import UnicodeModel, UnserializableModel\n20. from .routers import TestRouter\n21. from .test_base import MigrationTestBase\n22. \n23. \n24. class MigrateTests(MigrationTestBase):\n25.     """\n26.     Tests running the migrate command.\n27.     """\n28.     databases = {\'default\', \'other\'}\n29. \n30.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n31.     def test_migrate(self):\n32.         """\n33.         Tests basic usage of the migrate command.\n34.         """\n35.         # No tables are created\n36.         self.assertTableNotExists("migrations_author")\n37.         self.assertTableNotExists("migrations_tribble")\n38.         self.assertTableNotExists("migrations_book")\n39.         # Run the migrations to 0001 only\n40.         stdout = io.StringIO()\n41.         call_command(\'migrate\', \'migrations\', \'0001\', verbosity=1, stdout=stdout, no_color=True)\n42.         stdout = stdout.getvalue()\n43.         self.assertIn(\'Target specific migration: 0001_initial, from migrations\', stdout)\n44.         self.assertIn(\'Applying migrations.0001_initial... OK\', stdout)\n45.         # The correct tables exist\n46.         self.assertTableExists("migrations_author")\n47.         self.assertTableExists("migrations_tribble")\n48.         self.assertTableNotExists("migrations_book")\n49.         # Run migrations all the way\n50.         call_command("migrate", verbosity=0)\n51.         # The correct tables exist\n52.         self.assertTableExists("migrations_author")\n53.         self.assertTableNotExists("migrations_tribble")\n54.         self.assertTableExists("migrations_book")\n55.         # Unmigrate everything\n56.         stdout = io.StringIO()\n57.         call_command(\'migrate\', \'migrations\', \'zero\', verbosity=1, stdout=stdout, no_color=True)\n58.         stdout = stdout.getvalue()\n59.         self.assertIn(\'Unapply all migrations: migrations\', stdout)\n60.         self.assertIn(\'Unapplying migrations.0002_second... OK\', stdout)\n61.         # Tables are gone\n62.         self.assertTableNotExists("migrations_author")\n63.         self.assertTableNotExists("migrations_tribble")\n64.         self.assertTableNotExists("migrations_book")\n65. \n66.     @override_settings(INSTALLED_APPS=[\n67.         \'django.contrib.auth\',\n68.         \'django.contrib.contenttypes\',\n69.         \'migrations.migrations_test_apps.migrated_app\',\n70.     ])\n71.     def test_migrate_with_system_checks(self):\n72.         out = io.StringIO()\n73.         call_command(\'migrate\', skip_checks=False, no_color=True, stdout=out)\n74.         self.assertIn(\'Apply all migrations: migrated_app\', out.getvalue())\n75. \n76.     @override_settings(INSTALLED_APPS=[\'migrations\', \'migrations.migrations_test_apps.unmigrated_app_syncdb\'])\n77.     def test_app_without_migrations(self):\n78.         msg = "App \'unmigrated_app_syncdb\' does not have migrations."\n79.         with self.assertRaisesMessage(CommandError, msg):\n80.             call_command(\'migrate\', app_label=\'unmigrated_app_syncdb\')\n81. \n82.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_clashing_prefix\'})\n83.     def test_ambiguous_prefix(self):\n84.         msg = (\n85.             "More than one migration matches \'a\' in app \'migrations\'. Please "\n86.             "be more specific."\n87.         )\n88.         with self.assertRaisesMessage(CommandError, msg):\n89.             call_command(\'migrate\', app_label=\'migrations\', migration_name=\'a\')\n90. \n91.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n92.     def test_unknown_prefix(self):\n93.         msg = "Cannot find a migration matching \'nonexistent\' from app \'migrations\'."\n94.         with self.assertRaisesMessage(CommandError, msg):\n95.             call_command(\'migrate\', app_label=\'migrations\', migration_name=\'nonexistent\')\n96. \n97.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_initial_false"})\n98.     def test_migrate_initial_false(self):\n99.         """\n100.         `Migration.initial = False` skips fake-initial detection.\n101.         """\n102.         # Make sure no tables are created\n103.         self.assertTableNotExists("migrations_author")\n104.         self.assertTableNotExists("migrations_tribble")\n105.         # Run the migrations to 0001 only\n106.         call_command("migrate", "migrations", "0001", verbosity=0)\n107.         # Fake rollback\n108.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n109.         # Make sure fake-initial detection does not run\n110.         with self.assertRaises(DatabaseError):\n111.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0)\n112. \n113.         call_command("migrate", "migrations", "0001", fake=True, verbosity=0)\n114.         # Real rollback\n115.         call_command("migrate", "migrations", "zero", verbosity=0)\n116.         # Make sure it\'s all gone\n117.         self.assertTableNotExists("migrations_author")\n118.         self.assertTableNotExists("migrations_tribble")\n119.         self.assertTableNotExists("migrations_book")\n120. \n121.     @override_settings(\n122.         MIGRATION_MODULES={"migrations": "migrations.test_migrations"},\n123.         DATABASE_ROUTERS=[\'migrations.routers.TestRouter\'],\n124.     )\n125.     def test_migrate_fake_initial(self):\n126.         """\n127.         --fake-initial only works if all tables created in the initial\n128.         migration of an app exists. Database routers must be obeyed when doing\n129.         that check.\n130.         """\n131.         # Make sure no tables are created\n132.         for db in self.databases:\n133.             self.assertTableNotExists("migrations_author", using=db)\n134.             self.assertTableNotExists("migrations_tribble", using=db)\n135.         # Run the migrations to 0001 only\n136.         call_command("migrate", "migrations", "0001", verbosity=0)\n137.         call_command("migrate", "migrations", "0001", verbosity=0, database="other")\n138.         # Make sure the right tables exist\n139.         self.assertTableExists("migrations_author")\n140.         self.assertTableNotExists("migrations_tribble")\n141.         # Also check the "other" database\n142.         self.assertTableNotExists("migrations_author", using="other")\n143.         self.assertTableExists("migrations_tribble", using="other")\n144. \n145.         # Fake a roll-back\n146.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n147.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n148.         # Make sure the tables still exist\n149.         self.assertTableExists("migrations_author")\n150.         self.assertTableExists("migrations_tribble", using="other")\n151.         # Try to run initial migration\n152.         with self.assertRaises(DatabaseError):\n153.             call_command("migrate", "migrations", "0001", verbosity=0)\n154.         # Run initial migration with an explicit --fake-initial\n155.         out = io.StringIO()\n156.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n157.             call_command("migrate", "migrations", "0001", fake_initial=True, stdout=out, verbosity=1)\n158.             call_command("migrate", "migrations", "0001", fake_initial=True, verbosity=0, database="other")\n159.         self.assertIn(\n160.             "migrations.0001_initial... faked",\n161.             out.getvalue().lower()\n162.         )\n163.         # Run migrations all the way\n164.         call_command("migrate", verbosity=0)\n165.         call_command("migrate", verbosity=0, database="other")\n166.         # Make sure the right tables exist\n167.         self.assertTableExists("migrations_author")\n168.         self.assertTableNotExists("migrations_tribble")\n169.         self.assertTableExists("migrations_book")\n170.         self.assertTableNotExists("migrations_author", using="other")\n171.         self.assertTableNotExists("migrations_tribble", using="other")\n172.         self.assertTableNotExists("migrations_book", using="other")\n173.         # Fake a roll-back\n174.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n175.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0, database="other")\n176.         # Make sure the tables still exist\n177.         self.assertTableExists("migrations_author")\n178.         self.assertTableNotExists("migrations_tribble")\n179.         self.assertTableExists("migrations_book")\n180.         # Try to run initial migration\n181.         with self.assertRaises(DatabaseError):\n182.             call_command("migrate", "migrations", verbosity=0)\n183.         # Run initial migration with an explicit --fake-initial\n184.         with self.assertRaises(DatabaseError):\n185.             # Fails because "migrations_tribble" does not exist but needs to in\n186.             # order to make --fake-initial work.\n187.             call_command("migrate", "migrations", fake_initial=True, verbosity=0)\n188.         # Fake an apply\n189.         call_command("migrate", "migrations", fake=True, verbosity=0)\n190.         call_command("migrate", "migrations", fake=True, verbosity=0, database="other")\n191.         # Unmigrate everything\n192.         call_command("migrate", "migrations", "zero", verbosity=0)\n193.         call_command("migrate", "migrations", "zero", verbosity=0, database="other")\n194.         # Make sure it\'s all gone\n195.         for db in self.databases:\n196.             self.assertTableNotExists("migrations_author", using=db)\n197.             self.assertTableNotExists("migrations_tribble", using=db)\n198.             self.assertTableNotExists("migrations_book", using=db)\n199. \n200.     @skipUnlessDBFeature(\'ignores_table_name_case\')\n201.     def test_migrate_fake_initial_case_insensitive(self):\n202.         with override_settings(MIGRATION_MODULES={\n203.             \'migrations\': \'migrations.test_fake_initial_case_insensitive.initial\',\n204.         }):\n205.             call_command(\'migrate\', \'migrations\', \'0001\', verbosity=0)\n206.             call_command(\'migrate\', \'migrations\', \'zero\', fake=True, verbosity=0)\n207. \n208.         with override_settings(MIGRATION_MODULES={\n209.             \'migrations\': \'migrations.test_fake_initial_case_insensitive.fake_initial\',\n210.         }):\n211.             out = io.StringIO()\n212.             call_command(\n213.                 \'migrate\',\n214.                 \'migrations\',\n215.                 \'0001\',\n216.                 fake_initial=True,\n217.                 stdout=out,\n218.                 verbosity=1,\n219.                 no_color=True,\n220.             )\n221.             self.assertIn(\n222.                 \'migrations.0001_initial... faked\',\n223.                 out.getvalue().lower(),\n224.             )\n225. \n226.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_fake_split_initial"})\n227.     def test_migrate_fake_split_initial(self):\n228.         """\n229.         Split initial migrations can be faked with --fake-initial.\n230.         """\n231.         call_command("migrate", "migrations", "0002", verbosity=0)\n232.         call_command("migrate", "migrations", "zero", fake=True, verbosity=0)\n233.         out = io.StringIO()\n234.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: False):\n235.             call_command("migrate", "migrations", "0002", fake_initial=True, stdout=out, verbosity=1)\n236.         value = out.getvalue().lower()\n237.         self.assertIn("migrations.0001_initial... faked", value)\n238.         self.assertIn("migrations.0002_second... faked", value)\n239.         # Fake an apply\n240.         call_command("migrate", "migrations", fake=True, verbosity=0)\n241.         # Unmigrate everything\n242.         call_command("migrate", "migrations", "zero", verbosity=0)\n243. \n244.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_conflict"})\n245.     def test_migrate_conflict_exit(self):\n246.         """\n247.         migrate exits if it detects a conflict.\n248.         """\n249.         with self.assertRaisesMessage(CommandError, "Conflicting migrations detected"):\n250.             call_command("migrate", "migrations")\n251. \n252.     @override_settings(MIGRATION_MODULES={\n253.         \'migrations\': \'migrations.test_migrations\',\n254.     })\n255.     def test_migrate_check(self):\n256.         with self.assertRaises(SystemExit):\n257.             call_command(\'migrate\', \'migrations\', \'0001\', check_unapplied=True, verbosity=0)\n258.         self.assertTableNotExists(\'migrations_author\')\n259.         self.assertTableNotExists(\'migrations_tribble\')\n260.         self.assertTableNotExists(\'migrations_book\')\n261. \n262.     @override_settings(MIGRATION_MODULES={\n263.         \'migrations\': \'migrations.test_migrations_plan\',\n264.     })\n265.     def test_migrate_check_plan(self):\n266.         out = io.StringIO()\n267.         with self.assertRaises(SystemExit):\n268.             call_command(\n269.                 \'migrate\',\n270.                 \'migrations\',\n271.                 \'0001\',\n272.                 check_unapplied=True,\n273.                 plan=True,\n274.                 stdout=out,\n275.                 no_color=True,\n276.             )\n277.         self.assertEqual(\n278.             \'Planned operations:\\n\'\n279.             \'migrations.0001_initial\\n\'\n280.             \'    Create model Salamander\\n\'\n281.             \'    Raw Python operation -> Grow salamander tail.\\n\',\n282.             out.getvalue(),\n283.         )\n284. \n285.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n286.     def test_showmigrations_list(self):\n287.         """\n288.         showmigrations --list  displays migrations and whether or not they\'re\n289.         applied.\n290.         """\n291.         out = io.StringIO()\n292.         with mock.patch(\'django.core.management.color.supports_color\', lambda *args: True):\n293.             call_command("showmigrations", format=\'list\', stdout=out, verbosity=0, no_color=False)\n294.         self.assertEqual(\n295.             \'\\x1b[1mmigrations\\n\\x1b[0m\'\n296.             \' [ ] 0001_initial\\n\'\n297.             \' [ ] 0002_second\\n\',\n298.             out.getvalue().lower()\n299.         )\n300. \n301.         call_command("migrate", "migrations", "0001", verbosity=0)\n302. \n303.         out = io.StringIO()\n304.         # Giving the explicit app_label tests for selective `show_list` in the command\n305.         call_command("showmigrations", "migrations", format=\'list\', stdout=out, verbosity=0, no_color=True)\n306.         self.assertEqual(\n307.             \'migrations\\n\'\n308.             \' [x] 0001_initial\\n\'\n309.             \' [ ] 0002_second\\n\',\n310.             out.getvalue().lower()\n311.         )\n312.         out = io.StringIO()\n313.         # Applied datetimes are displayed at verbosity 2+.\n314.         call_command(\'showmigrations\', \'migrations\', stdout=out, verbosity=2, no_color=True)\n315.         migration1 = MigrationRecorder(connection).migration_qs.get(app=\'migrations\', name=\'0001_initial\')\n316.         self.assertEqual(\n317.             \'migrations\\n\'\n318.             \' [x] 0001_initial (applied at %s)\\n\'\n319.             \' [ ] 0002_second\\n\' % migration1.applied.strftime(\'%Y-%m-%d %H:%M:%S\'),\n320.             out.getvalue().lower()\n321.         )\n322.         # Cleanup by unmigrating everything\n323.         call_command("migrate", "migrations", "zero", verbosity=0)\n324. \n325.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_run_before"})\n326.     def test_showmigrations_plan(self):\n327.         """\n328.         Tests --plan output of showmigrations command\n329.         """\n330.         out = io.StringIO()\n331.         call_command("showmigrations", format=\'plan\', stdout=out)\n332.         self.assertEqual(\n333.             "[ ]  migrations.0001_initial\\n"\n334.             "[ ]  migrations.0003_third\\n"\n335.             "[ ]  migrations.0002_second\\n",\n336.             out.getvalue().lower()\n337.         )\n338. \n339.         out = io.StringIO()\n340.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n341.         self.assertEqual(\n342.             "[ ]  migrations.0001_initial\\n"\n343.             "[ ]  migrations.0003_third ... (migrations.0001_initial)\\n"\n344.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\\n",\n345.             out.getvalue().lower()\n346.         )\n347.         call_command("migrate", "migrations", "0003", verbosity=0)\n348. \n349.         out = io.StringIO()\n350.         call_command("showmigrations", format=\'plan\', stdout=out)\n351.         self.assertEqual(\n352.             "[x]  migrations.0001_initial\\n"\n353.             "[x]  migrations.0003_third\\n"\n354.             "[ ]  migrations.0002_second\\n",\n355.             out.getvalue().lower()\n356.         )\n357. \n358.         out = io.StringIO()\n359.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n360.         self.assertEqual(\n361.             "[x]  migrations.0001_initial\\n"\n362.             "[x]  migrations.0003_third ... (migrations.0001_initial)\\n"\n363.             "[ ]  migrations.0002_second ... (migrations.0001_initial, migrations.0003_third)\\n",\n364.             out.getvalue().lower()\n365.         )\n366. \n367.         # Cleanup by unmigrating everything\n368.         call_command("migrate", "migrations", "zero", verbosity=0)\n369. \n370.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_plan\'})\n371.     def test_migrate_plan(self):\n372.         """Tests migrate --plan output."""\n373.         out = io.StringIO()\n374.         # Show the plan up to the third migration.\n375.         call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n376.         self.assertEqual(\n377.             \'Planned operations:\\n\'\n378.             \'migrations.0001_initial\\n\'\n379.             \'    Create model Salamander\\n\'\n380.             \'    Raw Python operation -> Grow salamander tail.\\n\'\n381.             \'migrations.0002_second\\n\'\n382.             \'    Create model Book\\n\'\n383.             "    Raw SQL operation -> [\'SELECT * FROM migrations_book\']\\n"\n384.             \'migrations.0003_third\\n\'\n385.             \'    Create model Author\\n\'\n386.             "    Raw SQL operation -> [\'SELECT * FROM migrations_author\']\\n",\n387.             out.getvalue()\n388.         )\n389.         try:\n390.             # Migrate to the third migration.\n391.             call_command(\'migrate\', \'migrations\', \'0003\', verbosity=0)\n392.             out = io.StringIO()\n393.             # Show the plan for when there is nothing to apply.\n394.             call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n395.             self.assertEqual(\n396.                 \'Planned operations:\\n\'\n397.                 \'  No planned migration operations.\\n\',\n398.                 out.getvalue()\n399.             )\n400.             out = io.StringIO()\n401.             # Show the plan for reverse migration back to 0001.\n402.             call_command(\'migrate\', \'migrations\', \'0001\', plan=True, stdout=out, no_color=True)\n403.             self.assertEqual(\n404.                 \'Planned operations:\\n\'\n405.                 \'migrations.0003_third\\n\'\n406.                 \'    Undo Create model Author\\n\'\n407.                 "    Raw SQL operation -> [\'SELECT * FROM migrations_book\']\\n"\n408.                 \'migrations.0002_second\\n\'\n409.                 \'    Undo Create model Book\\n\'\n410.                 "    Raw SQL operation -> [\'SELECT * FROM migrations_salamand…\\n",\n411.                 out.getvalue()\n412.             )\n413.             out = io.StringIO()\n414.             # Show the migration plan to fourth, with truncated details.\n415.             call_command(\'migrate\', \'migrations\', \'0004\', plan=True, stdout=out, no_color=True)\n416.             self.assertEqual(\n417.                 \'Planned operations:\\n\'\n418.                 \'migrations.0004_fourth\\n\'\n419.                 \'    Raw SQL operation -> SELECT * FROM migrations_author WHE…\\n\',\n420.                 out.getvalue()\n421.             )\n422.             # Show the plan when an operation is irreversible.\n423.             # Migrate to the fourth migration.\n424.             call_command(\'migrate\', \'migrations\', \'0004\', verbosity=0)\n425.             out = io.StringIO()\n426.             call_command(\'migrate\', \'migrations\', \'0003\', plan=True, stdout=out, no_color=True)\n427.             self.assertEqual(\n428.                 \'Planned operations:\\n\'\n429.                 \'migrations.0004_fourth\\n\'\n430.                 \'    Raw SQL operation -> IRREVERSIBLE\\n\',\n431.                 out.getvalue()\n432.             )\n433.             out = io.StringIO()\n434.             call_command(\'migrate\', \'migrations\', \'0005\', plan=True, stdout=out, no_color=True)\n435.             # Operation is marked as irreversible only in the revert plan.\n436.             self.assertEqual(\n437.                 \'Planned operations:\\n\'\n438.                 \'migrations.0005_fifth\\n\'\n439.                 \'    Raw Python operation\\n\'\n440.                 \'    Raw Python operation\\n\'\n441.                 \'    Raw Python operation -> Feed salamander.\\n\',\n442.                 out.getvalue()\n443.             )\n444.             call_command(\'migrate\', \'migrations\', \'0005\', verbosity=0)\n445.             out = io.StringIO()\n446.             call_command(\'migrate\', \'migrations\', \'0004\', plan=True, stdout=out, no_color=True)\n447.             self.assertEqual(\n448.                 \'Planned operations:\\n\'\n449.                 \'migrations.0005_fifth\\n\'\n450.                 \'    Raw Python operation -> IRREVERSIBLE\\n\'\n451.                 \'    Raw Python operation -> IRREVERSIBLE\\n\'\n452.                 \'    Raw Python operation\\n\',\n453.                 out.getvalue()\n454.             )\n455.         finally:\n456.             # Cleanup by unmigrating everything: fake the irreversible, then\n457.             # migrate all to zero.\n458.             call_command(\'migrate\', \'migrations\', \'0003\', fake=True, verbosity=0)\n459.             call_command(\'migrate\', \'migrations\', \'zero\', verbosity=0)\n460. \n461.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_empty\'})\n462.     def test_showmigrations_no_migrations(self):\n463.         out = io.StringIO()\n464.         call_command(\'showmigrations\', stdout=out, no_color=True)\n465.         self.assertEqual(\'migrations\\n (no migrations)\\n\', out.getvalue().lower())\n466. \n467.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app\'])\n468.     def test_showmigrations_unmigrated_app(self):\n469.         out = io.StringIO()\n470.         call_command(\'showmigrations\', \'unmigrated_app\', stdout=out, no_color=True)\n471.         self.assertEqual(\'unmigrated_app\\n (no migrations)\\n\', out.getvalue().lower())\n472. \n473.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_empty"})\n474.     def test_showmigrations_plan_no_migrations(self):\n475.         """\n476.         Tests --plan output of showmigrations command without migrations\n477.         """\n478.         out = io.StringIO()\n479.         call_command(\'showmigrations\', format=\'plan\', stdout=out, no_color=True)\n480.         self.assertEqual(\'(no migrations)\\n\', out.getvalue().lower())\n481. \n482.         out = io.StringIO()\n483.         call_command(\'showmigrations\', format=\'plan\', stdout=out, verbosity=2, no_color=True)\n484.         self.assertEqual(\'(no migrations)\\n\', out.getvalue().lower())\n485. \n486.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed_complex"})\n487.     def test_showmigrations_plan_squashed(self):\n488.         """\n489.         Tests --plan output of showmigrations command with squashed migrations.\n490.         """\n491.         out = io.StringIO()\n492.         call_command("showmigrations", format=\'plan\', stdout=out)\n493.         self.assertEqual(\n494.             "[ ]  migrations.1_auto\\n"\n495.             "[ ]  migrations.2_auto\\n"\n496.             "[ ]  migrations.3_squashed_5\\n"\n497.             "[ ]  migrations.6_auto\\n"\n498.             "[ ]  migrations.7_auto\\n",\n499.             out.getvalue().lower()\n500.         )\n501. \n502.         out = io.StringIO()\n503.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n504.         self.assertEqual(\n505.             "[ ]  migrations.1_auto\\n"\n506.             "[ ]  migrations.2_auto ... (migrations.1_auto)\\n"\n507.             "[ ]  migrations.3_squashed_5 ... (migrations.2_auto)\\n"\n508.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\\n"\n509.             "[ ]  migrations.7_auto ... (migrations.6_auto)\\n",\n510.             out.getvalue().lower()\n511.         )\n512. \n513.         call_command("migrate", "migrations", "3_squashed_5", verbosity=0)\n514. \n515.         out = io.StringIO()\n516.         call_command("showmigrations", format=\'plan\', stdout=out)\n517.         self.assertEqual(\n518.             "[x]  migrations.1_auto\\n"\n519.             "[x]  migrations.2_auto\\n"\n520.             "[x]  migrations.3_squashed_5\\n"\n521.             "[ ]  migrations.6_auto\\n"\n522.             "[ ]  migrations.7_auto\\n",\n523.             out.getvalue().lower()\n524.         )\n525. \n526.         out = io.StringIO()\n527.         call_command("showmigrations", format=\'plan\', stdout=out, verbosity=2)\n528.         self.assertEqual(\n529.             "[x]  migrations.1_auto\\n"\n530.             "[x]  migrations.2_auto ... (migrations.1_auto)\\n"\n531.             "[x]  migrations.3_squashed_5 ... (migrations.2_auto)\\n"\n532.             "[ ]  migrations.6_auto ... (migrations.3_squashed_5)\\n"\n533.             "[ ]  migrations.7_auto ... (migrations.6_auto)\\n",\n534.             out.getvalue().lower()\n535.         )\n536. \n537.     @override_settings(INSTALLED_APPS=[\n538.         \'migrations.migrations_test_apps.mutate_state_b\',\n539.         \'migrations.migrations_test_apps.alter_fk.author_app\',\n540.         \'migrations.migrations_test_apps.alter_fk.book_app\',\n541.     ])\n542.     def test_showmigrations_plan_single_app_label(self):\n543.         """\n544.         `showmigrations --plan app_label` output with a single app_label.\n545.         """\n546.         # Single app with no dependencies on other apps.\n547.         out = io.StringIO()\n548.         call_command(\'showmigrations\', \'mutate_state_b\', format=\'plan\', stdout=out)\n549.         self.assertEqual(\n550.             \'[ ]  mutate_state_b.0001_initial\\n\'\n551.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n552.             out.getvalue()\n553.         )\n554.         # Single app with dependencies.\n555.         out = io.StringIO()\n556.         call_command(\'showmigrations\', \'author_app\', format=\'plan\', stdout=out)\n557.         self.assertEqual(\n558.             \'[ ]  author_app.0001_initial\\n\'\n559.             \'[ ]  book_app.0001_initial\\n\'\n560.             \'[ ]  author_app.0002_alter_id\\n\',\n561.             out.getvalue()\n562.         )\n563.         # Some migrations already applied.\n564.         call_command(\'migrate\', \'author_app\', \'0001\', verbosity=0)\n565.         out = io.StringIO()\n566.         call_command(\'showmigrations\', \'author_app\', format=\'plan\', stdout=out)\n567.         self.assertEqual(\n568.             \'[X]  author_app.0001_initial\\n\'\n569.             \'[ ]  book_app.0001_initial\\n\'\n570.             \'[ ]  author_app.0002_alter_id\\n\',\n571.             out.getvalue()\n572.         )\n573.         # Cleanup by unmigrating author_app.\n574.         call_command(\'migrate\', \'author_app\', \'zero\', verbosity=0)\n575. \n576.     @override_settings(INSTALLED_APPS=[\n577.         \'migrations.migrations_test_apps.mutate_state_b\',\n578.         \'migrations.migrations_test_apps.alter_fk.author_app\',\n579.         \'migrations.migrations_test_apps.alter_fk.book_app\',\n580.     ])\n581.     def test_showmigrations_plan_multiple_app_labels(self):\n582.         """\n583.         `showmigrations --plan app_label` output with multiple app_labels.\n584.         """\n585.         # Multiple apps: author_app depends on book_app; mutate_state_b doesn\'t\n586.         # depend on other apps.\n587.         out = io.StringIO()\n588.         call_command(\'showmigrations\', \'mutate_state_b\', \'author_app\', format=\'plan\', stdout=out)\n589.         self.assertEqual(\n590.             \'[ ]  author_app.0001_initial\\n\'\n591.             \'[ ]  book_app.0001_initial\\n\'\n592.             \'[ ]  author_app.0002_alter_id\\n\'\n593.             \'[ ]  mutate_state_b.0001_initial\\n\'\n594.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n595.             out.getvalue()\n596.         )\n597.         # Multiple apps: args order shouldn\'t matter (the same result is\n598.         # expected as above).\n599.         out = io.StringIO()\n600.         call_command(\'showmigrations\', \'author_app\', \'mutate_state_b\', format=\'plan\', stdout=out)\n601.         self.assertEqual(\n602.             \'[ ]  author_app.0001_initial\\n\'\n603.             \'[ ]  book_app.0001_initial\\n\'\n604.             \'[ ]  author_app.0002_alter_id\\n\'\n605.             \'[ ]  mutate_state_b.0001_initial\\n\'\n606.             \'[ ]  mutate_state_b.0002_add_field\\n\',\n607.             out.getvalue()\n608.         )\n609. \n610.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app\'])\n611.     def test_showmigrations_plan_app_label_no_migrations(self):\n612.         out = io.StringIO()\n613.         call_command(\'showmigrations\', \'unmigrated_app\', format=\'plan\', stdout=out, no_color=True)\n614.         self.assertEqual(\'(no migrations)\\n\', out.getvalue())\n615. \n616.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n617.     def test_sqlmigrate_forwards(self):\n618.         """\n619.         sqlmigrate outputs forward looking SQL.\n620.         """\n621.         out = io.StringIO()\n622.         call_command("sqlmigrate", "migrations", "0001", stdout=out)\n623.         output = out.getvalue().lower()\n624. \n625.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())\n626.         index_op_desc_author = output.find(\'-- create model author\')\n627.         index_create_table = output.find(\'create table\')\n628.         index_op_desc_tribble = output.find(\'-- create model tribble\')\n629.         index_op_desc_unique_together = output.find(\'-- alter unique_together\')\n630.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())\n631. \n632.         if connection.features.can_rollback_ddl:\n633.             self.assertGreater(index_tx_start, -1, "Transaction start not found")\n634.             self.assertGreater(\n635.                 index_tx_end, index_op_desc_unique_together,\n636.                 "Transaction end not found or found before operation description (unique_together)"\n637.             )\n638. \n639.         self.assertGreater(\n640.             index_op_desc_author, index_tx_start,\n641.             "Operation description (author) not found or found before transaction start"\n642.         )\n643.         self.assertGreater(\n644.             index_create_table, index_op_desc_author,\n645.             "CREATE TABLE not found or found before operation description (author)"\n646.         )\n647.         self.assertGreater(\n648.             index_op_desc_tribble, index_create_table,\n649.             "Operation description (tribble) not found or found before CREATE TABLE (author)"\n650.         )\n651.         self.assertGreater(\n652.             index_op_desc_unique_together, index_op_desc_tribble,\n653.             "Operation description (unique_together) not found or found before operation description (tribble)"\n654.         )\n655. \n656.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations"})\n657.     def test_sqlmigrate_backwards(self):\n658.         """\n659.         sqlmigrate outputs reverse looking SQL.\n660.         """\n661.         # Cannot generate the reverse SQL unless we\'ve applied the migration.\n662.         call_command("migrate", "migrations", verbosity=0)\n663. \n664.         out = io.StringIO()\n665.         call_command("sqlmigrate", "migrations", "0001", stdout=out, backwards=True)\n666.         output = out.getvalue().lower()\n667. \n668.         index_tx_start = output.find(connection.ops.start_transaction_sql().lower())\n669.         index_op_desc_unique_together = output.find(\'-- alter unique_together\')\n670.         index_op_desc_tribble = output.find(\'-- create model tribble\')\n671.         index_op_desc_author = output.find(\'-- create model author\')\n672.         index_drop_table = output.rfind(\'drop table\')\n673.         index_tx_end = output.find(connection.ops.end_transaction_sql().lower())\n674. \n675.         if connection.features.can_rollback_ddl:\n676.             self.assertGreater(index_tx_start, -1, "Transaction start not found")\n677.             self.assertGreater(\n678.                 index_tx_end, index_op_desc_unique_together,\n679.                 "Transaction end not found or found before DROP TABLE"\n680.             )\n681.         self.assertGreater(\n682.             index_op_desc_unique_together, index_tx_start,\n683.             "Operation description (unique_together) not found or found before transaction start"\n684.         )\n685.         self.assertGreater(\n686.             index_op_desc_tribble, index_op_desc_unique_together,\n687.             "Operation description (tribble) not found or found before operation description (unique_together)"\n688.         )\n689.         self.assertGreater(\n690.             index_op_desc_author, index_op_desc_tribble,\n691.             "Operation description (author) not found or found before operation description (tribble)"\n692.         )\n693. \n694.         self.assertGreater(\n695.             index_drop_table, index_op_desc_author,\n696.             "DROP TABLE not found or found before operation description (author)"\n697.         )\n698. \n699.         # Cleanup by unmigrating everything\n700.         call_command("migrate", "migrations", "zero", verbosity=0)\n701. \n702.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_non_atomic"})\n703.     def test_sqlmigrate_for_non_atomic_migration(self):\n704.         """\n705.         Transaction wrappers aren\'t shown for non-atomic migrations.\n706.         """\n707.         out = io.StringIO()\n708.         call_command("sqlmigrate", "migrations", "0001", stdout=out)\n709.         output = out.getvalue().lower()\n710.         queries = [q.strip() for q in output.splitlines()]\n711.         if connection.ops.start_transaction_sql():\n712.             self.assertNotIn(connection.ops.start_transaction_sql().lower(), queries)\n713.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)\n714. \n715.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n716.     def test_sqlmigrate_for_non_transactional_databases(self):\n717.         """\n718.         Transaction wrappers aren\'t shown for databases that don\'t support\n719.         transactional DDL.\n720.         """\n721.         out = io.StringIO()\n722.         with mock.patch.object(connection.features, \'can_rollback_ddl\', False):\n723.             call_command(\'sqlmigrate\', \'migrations\', \'0001\', stdout=out)\n724.         output = out.getvalue().lower()\n725.         queries = [q.strip() for q in output.splitlines()]\n726.         start_transaction_sql = connection.ops.start_transaction_sql()\n727.         if start_transaction_sql:\n728.             self.assertNotIn(start_transaction_sql.lower(), queries)\n729.         self.assertNotIn(connection.ops.end_transaction_sql().lower(), queries)\n730. \n731.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n732.     def test_sqlmigrate_ambiguous_prefix_squashed_migrations(self):\n733.         msg = (\n734.             "More than one migration matches \'0001\' in app \'migrations\'. "\n735.             "Please be more specific."\n736.         )\n737.         with self.assertRaisesMessage(CommandError, msg):\n738.             call_command(\'sqlmigrate\', \'migrations\', \'0001\')\n739. \n740.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n741.     def test_sqlmigrate_squashed_migration(self):\n742.         out = io.StringIO()\n743.         call_command(\'sqlmigrate\', \'migrations\', \'0001_squashed_0002\', stdout=out)\n744.         output = out.getvalue().lower()\n745.         self.assertIn(\'-- create model author\', output)\n746.         self.assertIn(\'-- create model book\', output)\n747.         self.assertNotIn(\'-- create model tribble\', output)\n748. \n749.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_squashed\'})\n750.     def test_sqlmigrate_replaced_migration(self):\n751.         out = io.StringIO()\n752.         call_command(\'sqlmigrate\', \'migrations\', \'0001_initial\', stdout=out)\n753.         output = out.getvalue().lower()\n754.         self.assertIn(\'-- create model author\', output)\n755.         self.assertIn(\'-- create model tribble\', output)\n756. \n757.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations_no_operations\'})\n758.     def test_migrations_no_operations(self):\n759.         err = io.StringIO()\n760.         call_command(\'sqlmigrate\', \'migrations\', \'0001_initial\', stderr=err)\n761.         self.assertEqual(err.getvalue(), \'No operations found.\\n\')\n762. \n763.     @override_settings(\n764.         INSTALLED_APPS=[\n765.             "migrations.migrations_test_apps.migrated_app",\n766.             "migrations.migrations_test_apps.migrated_unapplied_app",\n767.             "migrations.migrations_test_apps.unmigrated_app",\n768.         ],\n769.     )\n770.     def test_regression_22823_unmigrated_fk_to_migrated_model(self):\n771.         """\n772.         Assuming you have 3 apps, `A`, `B`, and `C`, such that:\n773. \n774.         * `A` has migrations\n775.         * `B` has a migration we want to apply\n776.         * `C` has no migrations, but has an FK to `A`\n777. \n778.         When we try to migrate "B", an exception occurs because the\n779.         "B" was not included in the ProjectState that is used to detect\n780.         soft-applied migrations (#22823).\n781.         """\n782.         call_command("migrate", "migrated_unapplied_app", stdout=io.StringIO())\n783. \n784.         # unmigrated_app.SillyModel has a foreign key to \'migrations.Tribble\',\n785.         # but that model is only defined in a migration, so the global app\n786.         # registry never sees it and the reference is left dangling. Remove it\n787.         # to avoid problems in subsequent tests.\n788.         del apps._pending_operations[(\'migrations\', \'tribble\')]\n789. \n790.     @override_settings(INSTALLED_APPS=[\'migrations.migrations_test_apps.unmigrated_app_syncdb\'])\n791.     def test_migrate_syncdb_deferred_sql_executed_with_schemaeditor(self):\n792.         """\n793.         For an app without migrations, editor.execute() is used for executing\n794.         the syncdb deferred SQL.\n795.         """\n796.         stdout = io.StringIO()\n797.         with mock.patch.object(BaseDatabaseSchemaEditor, \'execute\') as execute:\n798.             call_command(\'migrate\', run_syncdb=True, verbosity=1, stdout=stdout, no_color=True)\n799.             create_table_count = len([call for call in execute.mock_calls if \'CREATE TABLE\' in str(call)])\n800.             self.assertEqual(create_table_count, 2)\n801.             # There\'s at least one deferred SQL for creating the foreign key\n802.             # index.\n803.             self.assertGreater(len(execute.mock_calls), 2)\n804.         stdout = stdout.getvalue()\n805.         self.assertIn(\'Synchronize unmigrated apps: unmigrated_app_syncdb\', stdout)\n806.         self.assertIn(\'Creating tables...\', stdout)\n807.         table_name = truncate_name(\'unmigrated_app_syncdb_classroom\', connection.ops.max_name_length())\n808.         self.assertIn(\'Creating table %s\' % table_name, stdout)\n809. \n810.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n811.     def test_migrate_syncdb_app_with_migrations(self):\n812.         msg = "Can\'t use run_syncdb with app \'migrations\' as it has migrations."\n813.         with self.assertRaisesMessage(CommandError, msg):\n814.             call_command(\'migrate\', \'migrations\', run_syncdb=True, verbosity=0)\n815. \n816.     @override_settings(INSTALLED_APPS=[\n817.         \'migrations.migrations_test_apps.unmigrated_app_syncdb\',\n818.         \'migrations.migrations_test_apps.unmigrated_app_simple\',\n819.     ])\n820.     def test_migrate_syncdb_app_label(self):\n821.         """\n822.         Running migrate --run-syncdb with an app_label only creates tables for\n823.         the specified app.\n824.         """\n825.         stdout = io.StringIO()\n826.         with mock.patch.object(BaseDatabaseSchemaEditor, \'execute\') as execute:\n827.             call_command(\'migrate\', \'unmigrated_app_syncdb\', run_syncdb=True, stdout=stdout)\n828.             create_table_count = len([call for call in execute.mock_calls if \'CREATE TABLE\' in str(call)])\n829.             self.assertEqual(create_table_count, 2)\n830.             self.assertGreater(len(execute.mock_calls), 2)\n831.             self.assertIn(\'Synchronize unmigrated app: unmigrated_app_syncdb\', stdout.getvalue())\n832. \n833.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})\n834.     def test_migrate_record_replaced(self):\n835.         """\n836.         Running a single squashed migration should record all of the original\n837.         replaced migrations as run.\n838.         """\n839.         recorder = MigrationRecorder(connection)\n840.         out = io.StringIO()\n841.         call_command("migrate", "migrations", verbosity=0)\n842.         call_command("showmigrations", "migrations", stdout=out, no_color=True)\n843.         self.assertEqual(\n844.             \'migrations\\n\'\n845.             \' [x] 0001_squashed_0002 (2 squashed migrations)\\n\',\n846.             out.getvalue().lower()\n847.         )\n848.         applied_migrations = recorder.applied_migrations()\n849.         self.assertIn(("migrations", "0001_initial"), applied_migrations)\n850.         self.assertIn(("migrations", "0002_second"), applied_migrations)\n851.         self.assertIn(("migrations", "0001_squashed_0002"), applied_migrations)\n852.         # Rollback changes\n853.         call_command("migrate", "migrations", "zero", verbosity=0)\n854. \n855.     @override_settings(MIGRATION_MODULES={"migrations": "migrations.test_migrations_squashed"})\n856.     def test_migrate_record_squashed(self):\n857.         """\n858.         Running migrate for a squashed migration should record as run\n859.         if all of the replaced migrations have been run (#25231).\n860.         """\n861.         recorder = MigrationRecorder(connection)\n862.         recorder.record_applied("migrations", "0001_initial")\n863.         recorder.record_applied("migrations", "0002_second")\n864.         out = io.StringIO()\n865.         call_command("migrate", "migrations", verbosity=0)\n866.         call_command("showmigrations", "migrations", stdout=out, no_color=True)\n867.         self.assertEqual(\n868.             \'migrations\\n\'\n869.             \' [x] 0001_squashed_0002 (2 squashed migrations)\\n\',\n870.             out.getvalue().lower()\n871.         )\n872.         self.assertIn(\n873.             ("migrations", "0001_squashed_0002"),\n874.             recorder.applied_migrations()\n875.         )\n876.         # No changes were actually applied so there is nothing to rollback\n877. \n878.     @override_settings(MIGRATION_MODULES={\'migrations\': \'migrations.test_migrations\'})\n879.     def test_migrate_inconsistent_history(self):\n880.         """\n881.         Running migrate with some migrations applied before their dependencies\n882.         should not be allowed.\n883.         """\n884.         recorder = MigrationRecorder(connection)\n885.         recorder.record_applied("migrations", "0002_second")\n886.         msg = "Migration migrations.0002_second is applied before its dependency migrations.0001_initial"\n887.         with self.assertRaisesMessage(InconsistentMigrationHistory, msg):\n888.             call_command("migrate")\n889.         applied_migrations = recorder.applied_migrations()\n890.         self.assertNotIn(("migrations", "0001_initial"), applied_migrations)\n891. \n892. \n893. class MakeMigrationsTests(MigrationTestBase):\n894.     """\n895.     Tests running the makemigrations command.\n896.     """\n897. \n898.     def setUp(self):\n899.         super().setUp()\n900.         self._old_models = apps.app_configs[\'migrations\'].models.copy()\n901. \n902.     def tearDown(self):\n903.         apps.app_configs[\'migrations\'].models = self._old_models\n904.         apps.all_models[\'migrations\'] = self._old_models\n905.         apps.clear_cache()\n906.         super().tearDown()\n907. \n908.     def test_files_content(self):\n909.         self.assertTableNotExists("migrations_unicodemodel")\n910.         apps.register_model(\'migrations\', UnicodeModel)\n911.         with self.temporary_migration_module() as migration_dir:\n912.             call_command("makemigrations", "migrations", verbosity=0)\n913. \n914.             # Check for empty __init__.py file in migrations folder\n915.             init_file = os.path.join(migration_dir, "__init__.py")\n916.             self.assertTrue(os.path.exists(init_file))\n917. \n918.             with open(init_file) as fp:\n919.                 content = fp.read()\n920.             self.assertEqual(content, \'\')\n921. \n922.             # Check for existing 0001_initial.py file in migration folder\n923.             initial_file = os.path.join(migration_dir, "0001_initial.py")\n924.             self.assertTrue(os.path.exists(initial_file))\n925. \n926.             with open(initial_file, encoding=\'utf-8\') as fp:\n927.                 content = fp.read()\n928.                 self.assertIn(\'migrations.CreateModel\', content)\n929.                 self.assertIn(\'initial = True\', content)\n930. \n931.                 self.assertIn(\'úñí©óðé µóðéø\', content)  # Meta.verbose_name\n932.                 self.assertIn(\'úñí©óðé µóðéøß\', content)  # Meta.verbose_name_plural\n933.                 self.assertIn(\'ÚÑÍ¢ÓÐÉ\', content)  # title.verbose_name\n934.                 self.assertIn(\'“Ðjáñgó”\', content)  # title.default\n935. \n936.     def test_makemigrations_order(self):\n937.         """\n938.         makemigrations should recognize number-only migrations (0001.py).\n939.         """\n940.         module = \'migrations.test_migrations_order\'\n941.         with self.temporary_migration_module(module=module) as migration_dir:\n942.             if hasattr(importlib, \'invalidate_caches\'):\n943.                 # importlib caches os.listdir() on some platforms like macOS\n944.                 # (#23850).\n945.                 importlib.invalidate_caches()\n946.             call_command(\'makemigrations\', \'migrations\', \'--empty\', \'-n\', \'a\', \'-v\', \'0\')\n947.             self.assertTrue(os.path.exists(os.path.join(migration_dir, \'0002_a.py\')))\n948. \n949.     def test_makemigrations_empty_connections(self):\n950.         empty_connections = ConnectionHandler({\'default\': {}})\n951.         with mock.patch(\'django.core.management.commands.makemigrations.connections\', new=empty_connections):\n952.             # with no apps\n953.             out = io.StringIO()\n954.             call_command(\'makemigrations\', stdout=out)\n955.             self.assertIn(\'No changes detected\', out.getvalue())\n956.             # with an app\n957.             with self.temporary_migration_module() as migration_dir:\n958.                 call_command(\'makemigrations\', \'migrations\', verbosity=0)\n959.                 init_file = os.path.join(migration_dir, \'__init__.py\')\n960.                 self.assertTrue(os.path.exists(init_file))\n961. \n962.     @override_settings(INSTALLED_APPS=[\'migrations\', \'migrations2\'])\n963.     def test_makemigrations_consistency_checks_respect_routers(self):\n964.         """\n965.         The history consistency checks in makemigrations respect\n966.         settings.DATABASE_ROUTERS.\n967.         """\n968.         def patched_has_table(migration_recorder):\n969.             if migration_recorder.connection is connections[\'other\']:\n970.                 raise Exception(\'Other connection\')\n971.             else:\n972.                 return mock.DEFAULT\n973. \n974.         self.assertTableNotExists(\'migrations_unicodemodel\')\n975.         apps.register_model(\'migrations\', UnicodeModel)\n976.         with mock.patch.object(\n977.                 MigrationRecorder, \'has_table\',\n978.                 autospec=True, side_effect=patched_has_table) as has_table:\n979.             with self.temporary_migration_module() as migration_dir:\n980.                 call_command("makemigrations", "migrations", verbosity=0)\n981.                 initial_file = os.path.join(migration_dir, "0001_initial.py")\n982.                 self.assertTrue(os.path.exists(initial_file))\n983.                 self.assertEqual(has_table.call_count, 1)  # \'default\' is checked\n984. \n985.                 # Router says not to migrate \'other\' so consistency shouldn\'t\n986.                 # be checked.\n987.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.TestRouter\']):\n988.                     call_command(\'makemigrations\', \'migrations\', verbosity=0)\n989.                 self.assertEqual(has_table.call_count, 2)  # \'default\' again\n990. \n991.                 # With a router that doesn\'t prohibit migrating \'other\',\n992.                 # consistency is checked.\n993.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.DefaultOtherRouter\']):\n994.                     with self.assertRaisesMessage(Exception, \'Other connection\'):\n995.                         call_command(\'makemigrations\', \'migrations\', verbosity=0)\n996.                 self.assertEqual(has_table.call_count, 4)  # \'default\' and \'other\'\n997. \n998.                 # With a router that doesn\'t allow migrating on any database,\n999.                 # no consistency checks are made.\n1000.                 with self.settings(DATABASE_ROUTERS=[\'migrations.routers.TestRouter\']):\n\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-10-06 05:12:04,773 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nfrom django.core.management.color import no_style\nfrom django.db import connection\nfrom django.test import TransactionTestCase\n\nfrom backends.models import Author, Book\n\n\nclass SqlFlushSignatureTest(TransactionTestCase):\n    available_apps = [\'backends\']\n\n    def test_execute_sql_flush_signature_simplified(self):\n        """\n        Test that execute_sql_flush() can be called without the `using`\n        argument.\n        """\n        author = Author.objects.create(name=\'George Orwell\')\n        Book.objects.create(author=author, title=\'1984\')\n\n        sql_list = connection.ops.sql_flush(\n            no_style(),\n            [Author._meta.db_table, Book._meta.db_table],\n            allow_cascade=True,\n        )\n        # This call will raise a TypeError before the signature is changed to\n        # accept a single argument.\n        connection.ops.execute_sql_flush(sql_list)\n\n        self.assertFalse(Author.objects.exists())\n        self.assertFalse(Book.objects.exists())\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 842, 'end_index': 2195, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}, {'start_index': 3953, 'end_index': 4376, 'uri': 'https://github.com/django/django', 'license_': 'Python-2.0', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 36551, 'candidates_token_count': 253, 'total_token_count': 44227, 'prompt_tokens_details': [{'modality': 1, 'token_count': 36551}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 253}], 'thoughts_token_count': 7423, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -4.890175800549654, 'model_name': 'gemini-2.5-pro'} id='run--3a404b2e-e833-41a8-a81c-94fae080ff37-0' usage_metadata={'input_tokens': 36551, 'output_tokens': 253, 'total_tokens': 44227, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 7423}}
2025-10-06 05:12:20,666 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "from django.core.management.color import no_style\\nfrom django.db import connection\\nfrom django.test import TransactionTestCase\\n\\nfrom backends.models import Author, Book\\n\\n\\nclass SqlFlushSignatureTest(TransactionTestCase):\\n    available_apps = [\'backends\']\\n\\n    def test_execute_sql_flush_signature_simplified(self):\\n        \\"\\"\\"\\n        Test that execute_sql_flush() can be called without the `using`\\n        argument.\\n        \\"\\"\\"\\n        author = Author.objects.create(name=\'George Orwell\')\\n        Book.objects.create(author=author, title=\'1984\')\\n\\n        sql_list = connection.ops.sql_flush(\\n            no_style(),\\n            [Author._meta.db_table, Book._meta.db_table],\\n            allow_cascade=True,\\n        )\\n        # This call will raise a TypeError before the signature is changed to\\n        # accept a single argument.\\n        connection.ops.execute_sql_flush(sql_list)\\n\\n        self.assertFalse(Author.objects.exists())\\n        self.assertFalse(Book.objects.exists())\\n", "relative_path": "tests/backends/test_sql_flush.py"}'}, '__gemini_function_call_thought_signatures__': {'bccf51e8-b0d8-4731-a453-a3d06232fa79': 'CuIpAR/Mhbawiv93EBj9uI/IuwU+hPESbf2vxmVc+6I3H2ri0Dweo9jQvsJDKfEVe7qQ66ApJ3O6MikssAfgCLCUUcOPHCF66ZGMIDqL0Kv5CYR++HfLYMh1WeGOrWkh5GX9Wg1bVWMuwU9uaBEsVEJz9bkznndfGqgJ2enVII6sRHHrp3tIeD3WZtJrf90CUq8QYptkT67zU55l0Lvm4OB3AIN9HkSdnnXZ0AN8vlnjFhKkTeRcyuiTRDNPgT86c+CsNiJsVmEdcjCbe/avFnWVPtWDLxZUN0Wv97ycaN5x5HCIqZiQsMAUhf+uBq3DaFtCtebzkGV+5xT2yk7b7kcV9VH4o/MQoa09HFUsV2Qlsea5YtTJQz7+49e0jYllFAD7znTD6wWrqxyDxp24nI21v0jsvGe71Em5dBf8pflVMsv3tLKqjIsU5ggE97xJg/n/S4crAQDDZzk/CO4Wvh1MzmF29jmsDRc7Gjrq7fuWyTw60yGJdJQcrfb4jmK/8zOfpdmNcqZreLNTrJGbIqoQPfxswOYz6jhLdK9zM+7cdSDV4IeqQCaAfrl8r9QgwzvVtA2WnhH2QiV9tAi5JcOInbtGxZTrOS9e7I8TQjIyIiAi4YX0SOm6QC2KmkqJF5NAcrY12A+j9v6PfSS7gScQoroJLqmLJup2Cx2wcJIppYbhrb+YEwZset7KigBzlxQjF7WdnLzVjds/lhBjyjuVAAmWobwqJnnLJ5KRO32AE0ppi9FNeuplOnBRXh2YOp1P3wKBu6Uk9X8x5oOSX/TAsBf4AZXWbkkfjsni4CN3Pbaf2XBylFvb/Z/dQcR8wvByRuopoUuQBNgaeyV8ZFoj1wg9zz8mar8zrd/2lVN1j9E2VxDRZXpprLcDF3r+eEPn5W8asFUIs4n/bmrzwjs3Z7zwXAkWEPN0LmGfCoyxR9aeHf8o9mcK47XGE3bgt9Ddinh5ly0r42dbfDglZoNmMl6jnDjb7kOIf/SlxJXzQ0Mmtd7kF0a+ixs3j0QXwZleMoAbfz9FHxnJWE1jqezzj+fmtvTPDBgGxFCObdCFMrO4kFTQZNAB1liGvSC8ZW9qpmvE25Vk++nnz3UZoQq835hUyf/bUScw3HVgiTQ7yfkU7st8YoenqQUthsZ65/Jxx7VhQKvEQUU3joBXZ2fRdxR3gdn67r7XLzTMFqQVT7i05OwDp1pLXBPE3Cyphy3hJGIr7g4ggRDjdxFwINl7Zj0HziQmMGGODvfB+dzFfVt9hOYdpolDARyXIHGyCxyH8zuXL90ajDLtRwjWXn/oFicVBDoZbSoGn/I+1hKTbJm5tfuVGs88Ryptda6rzXrzc0RyEjrY3/mo0QWqHttFX62j0npiphhpUiCVkMtyEDbZBOZ5CM0pPIvPEkOdwhNafXPMgJiQTUjtq492ymb3ijd+5fHiPBl2kuvYASjcdRiWHUtsoV/5aNNdkJLMWYc6S9nuYWWlz13Ll3hf1LTc0TaokkKLtjrZ1h5cBaeniQcNLC5PK1dGcaozhpDAKPiqM+PoYbnqDXkgQFUSevgxOr1AEekAxfzcRTbkql52LPfXQXFK7lNd7cL//JpliBq7AuPaoJErl4ngTd3S0jo/QlRG2rTjuyYlUZlJnfSI2Q+LK63rlCymrmcwgUZdVSYsHTYjFJoIcuwRDt9El3jW85ys0+vPsow9FNY3/Cb0puQ/BxK2AhgeSC6bJ66gIRMQj0AALFwgS70VxI4o/7bx/KwQ97iIMsu98HW4PMY0Uah8DqtBHcEiISskKsVZv6TFGbzZsyVUZlDfS18F+iIo4YdD6cVt4jEr50Ck26A91CjKFia3qEQ/h20H4hz7vgZdKJzCXN05D8/ZoCAfe7IQHwOeb2CkNgAhIatgyXakZBdkQIKSDdHDjzIMVEzBeFdJ44+g+qVuSFXdbEVN25znHiBiRLjOc6Jq5zIgAVIejAiVwpL9pbgoAZty29O2LJDQPclFRhwd5zdI30beUeDhk8XcJt20P4370EXjcqLIPyKaQZCbOmTvr84KhoEl5/XF/Y5Y+68Oz//5sDBd3bABME0BzzAO77XowsHKzmfIbNbrUcD/mSXCizw4GnInO3+BaOd7tCwKX19JHryQGBvrmUuKiuwp1IpaUmX+kz++yqrtXiAPwT+wP5uM5GsGHK1pFh41hpEL/pdWNP6ailQ7l9OJaoYvJjxQYcmACfkI0R8eUVG6PwQ3By572wqyIpFZJLgNLqDOt+RmOFyaEZl8SKh+82X5I1sCHj/KVfSAKc975pnV4WQn7y6aU2nKZiwtEFnPVSpEpJATLaLAETFs858dixCqAi2y3tOVYBafEvn77KvpwSZXtEwBynAVLKUWfT+grBXbeQ6OAETDs+eEE+3jDj/LLTOyy0pq6suDNGDP/phOi9ojMKnYhe1l5XyuMSGu9729FhImr4QlfcF3pdU6UeQYqjQh/rE2mbtc8jbJ8SpkqKm4adPgUobmfugoUwZSwH7M5EvQqaJq+Qense803iDKcJ2x1U7AwbPI9xM2g1yBklmkilqpFToS+1ydi6e0VkCSm4npOXaxSPsJCPfoAjO44wC//KZiWMoAcXkwld+GSsRm9Y+HpAX04Z+m9Ce2y7+vpeCq54FeovC2WsBI1k/a5Ih1muBqVKp82ylewQgmQ2pdKsBOVQg6p2Kl+3liEf/+R6x6N+jNmr0ZgkHLlVyTf+o7XWMZ3pwtTfdgjWV8eeMb/7ChkxgUqJsAAGSGVN47VEQTPHeivIhxLrOTBTzsX2ZKk+yEjVoArblURMQV46GkM/7pqHcxIGzTVw+mMHX7VMNC6LdHFDCHnt9+VkJ8CpcOZR/wwktUOHeuFbTHf48ubN9xTcpK8nq/nAzyyge7eLwp6DEZCdjsp0kuLlQEylMq2Qf1jOGkDT7Cz8tSHh2aSscnbiEjyVbT7AHDzV0nzluHmP/NOxur4pb3PHJ/k6G4j1HJhqTkT9tli4Z1nlNOzAaNugoAqD3WWtQ8iqYtZUQC3n3h4sschHLIrg0M+UppzDVPerrlKyuDQ29Cl8S8FGQXQP7Af97PDWRqDoO9YOsh88YtQlm1i4iiroGrjJ0nLUGV+1YEndmB8JSRhgX9B0eB78rl77dveY+eUd8qGOx3HTgJpvaHKIodOoCcsprmkzM6H3PJTwfbYv+CPB0yrdvqXtOAZPjFC3pCgw1D8ii4TJBOtCu997v1fu87MjwYegK8RzhJlox5UFWus80FUtT39IUcrCXTPPWqvNJePtGkGpFnF3mTjBYT+ZMacaw8kx1zNzQqQftqnoIjmMl8eAeljp2keN4Dy9Orp6+M6lSU1ma4GTUA/MdmGlbCAm0PKugDANq/kZ0qSLV89HAlXfWvkO2jk804RO1T26fUfDyZBOHjsM83MnEPpP7zAUn0H0GT0Mf6NcqULGiojPmv2HvoIE3IuSJL7GTYI9P/in1Fbnpxwdbjq1EY3b5DTouWKTFG6pdPYkYrEg5WiWSdq4VW70HZX1Z0Fyqrk5Cq2EeKB+4HkB96BVqo2nLoXo3Czfi1ShoVCMI6HvXHVHu3ogUvpBcq/IBwnH+Y62AuWXecsD6omzRKDA+j8A9D0Yo9PZtFVQObeAa0X02f7GbGsmLmQvX6HY8yOjhXCnACBCoRemY0+6NPYPKqjKfupHOFVTo+n1Zv+GNRLgnQSeDmkjaaE8nhzv+pnfoXgi2sANRdBU4xLfjx5A3s5RR6PdUmdTviaiKWHQMidNcW//j1WNyvi7yq0E/DCPgUyVMmkx8/oMHPQEh3lp2+fgRErnjK1IyjZ2CBL19/ERt3J/GhF3Ir2Kd0IQAwPbC1XjXCuzfHGsE87BYe8lnQRivFd5HzWei1opOJ+M6z1e4gsLYgX3WdQrFSYqtqDx6989uxBU6fMC1rHodfB3sAJo2gktscB04bKtw6uN59OslpFlzLI0B5wmwMkVxd2mqC3h/aEfgUJIbtp/mecvPyR9ObuXoFkFEaPvLUDv7Jp3ioZEZsZtK/h1tyvberDVwjlxaL2FEpvEFEEJ2MkDuLyPOuTv98wtTf/MNU5n0g6LoehmXe4dijb/o0ZmtEzIJF++1+SfMGbKzUjYaut2arItyjvR17xF7+vdeGsO5M4PhIDIXVnqO8gjtFDOh03KUfHfzk+eTZpUFcQfXTmKNk9qEfhFrfuNSgobx6x6hkKNzu8IqLS4Q1ONeH3y0stLnL8pPVnMO/gBKUiDbrzFQKWzBYFpvDWbcrT436IqpTsRngZCJj8+nqtR+MngWIdcUNFehPlgf6VFAeFWK0o5znLfZmN1eQElv8fndNiQVcjlT/4ynKWZuuWRVfFM+pJ9WQ59QtlZXIOT405OM6IA7kpZS9yPzcCNgs1jbmr+79vPCyIx9xT0geI3jt5V61T2dwLNC+3rlQT+aILMALvrbvCxRwuVux5afFvOg+iH7/2Y2c7QbopiDGcIZpsMNT8p6bDb0NB08A3W7X18DsJj3pqbCni0IrLjmNIggo6nvH7LnI2PyT3BxffhNMlvV6rtUv/oMfpiCejIZ0cjS44TirjXYFHmgUKDnibwjgWL7oHIqoeWkBAVOZo+bBX07cVb2c8f+Yq7nU0s6K4bsOpYzUW3UdYUae/Kt5lglpq+nNszac03Mr0KY5S+L2CkczoIYcj2w4El0Nni6R4lC56Yy/BHdoLmNo3JtBu6fvaoNGhs749jEJ2NhkrFe0Ys9n2rq5whwumrf9bG15E8e4ai1bkw+4Rz8Kb2DBsltuf40RE5Q9pIQN/cdB+SfXlebR3Gekn5eoSNRPCb07iEIXFubGGDyyRMz7mhhpX8zmbvsUUPWnLX4Bzcw0/EE26K4WzTysU6X1e8m3ErCMLesroxkdAxGTaXOudxadVxTsxLPnAZYXfPkWYN/HqxfvPj1pwb4w9a0nKSHQm7Sq8/9+hkAotOUvwb7E4TjRa6Nnv16wHhoGlthWvud02/tjfJsHbHKAo8CbD29nfV0zr5EsyDR9YzCRXJE/bEFvlxeXvrXRHIUy85Hby1uAqMl/y+b/v16vgeEeuJjrINw/9WN5IyKZr6JMopAI5Id5UBCTtVeFiA3tIzdC4FCDClMA/VdrXVYiB8a/tgQ3TBdBURwnQeaCyciXbNwRRmDWHRfqdygkQm4H8inxAX4oxoPTFpj385NpjPk7IsmySEx11Oxgy1AFexf2mbL4zukgLPeRMF1hwFbxeyohhTsB/CSS/NZwZGpkD78gBRGX9tjMjZktccovzOh58gZzPH6IavvcTBAAfHhxgTZ8jwUPtE2Qx0tyGOD/OprCUE1NDjclW/cMFzyF1sQ6x0o+TBiGAPj/fRfzEOarNikP7xY+RdKWkoBMw/XPAVnYpMGvchdvX8PzRspJMe6W3YtOlcpHSgIA/Yr+K7tPTQw7sW/E7qwliEnVZzfp4KWILtpuXRuL3ENghS8BO+QgbHuJyJW1BpgOkSRI3/QV4aoowG4WBYZU78AcBxqylg/WphBeTOSkLhlUqd25NFSSEQbqCPWu0stc05J57dVjIB9I4ycR6kFUxChx8smzbtecfO4r8J8UF+af5OXwm5qtsKmUdmNXz2IG+mN+UJlB5mK0HyUD2kem8mev6COknjIufkZ6Qi8RLkG14KvsGvRfr3CnPO9BQMEIhsB9Br/6MqHXh4ubdImRMrtXAj1v8vbWranJNtpf9fFgsfln/8VQ1mw4VpI3pMUCUbjdEk8qg82B2WfZXc+JWvBFQ7uj9xmV//7vXl/0WWjL9Bxx2COE6CU+6NM7q+GVCMs1AYvostiCsZ4zefnzDGzUypm8E1US9M7WvlptbBqgEeu3T0PnWpn4cKiEO7TBBBXBmYC64OgRxSlfmS3/un0NS/NcfXHiPLU4ahlWBeaLSGGJcfCgdJkj3uExwmbR6qgMlpLGov+tbmL1zcCaxYy7DicA6yEAsXqW+dh5pRw54f5LZWG4YUZq/Mqi/odZocoiG6KvNi9HMVTQLxP2AXztCnWxLGrjqAEbHVl0LX4ZjDINb5KAgrvt3uz3Zo3Y5Nrdl1VJWov0C+SYLjGN73kRVH1pf1BXtjIBxBi5SMGOsvT39gIcoY7jceFjXmcapdTMKoJoJ1pkSR9BZc+D1aOyhoR3DeRNOIKw2WRzlgF2XUbYUSsI4o85f7AP7wBDG9UvpJijffvTmAxPcpqteJNlBhZJFx1cMSUSYw5TVPVhHAfMaPnSj1CMGQvNQhqQAjXqJ0N7ASOGkeB/DUsuekULKd+8I6jqrLx4TXS892UhRuEtJ7azs24d6BybMc8XPLLJTAh54hFUw6TKPRcFq6qQCnfj1p+7nuawmMA6S9OM7w5SvoU68JgtSIvTZ0I02DQo6GfqokqzeFHut4lbpYpLtI6NvcyNJp+DAJejaSSAUL2xFFnGTqXcn/zBjHsFGchniCLTc6NwuSjhiGPmCacO1tJnTsGispdF7rBsFbMen7/2/vPRBLITZmJ0pTMYSjAdONSOOIFm+kryVIlcrvMTkv07/Ouja00p8H/WZ75OHkj2fxoGBJ3HoI8sLyoNtW2S+khqg5dtPH9OetHR1H6Urto/AGgqASZVIzdCleIOui6+KoILApB/LxBhhFj3QhCO5/5LC3X2wWQucHGsHSc511CFzVKzm999AMun/ltLpNT9v8BMvsOnBsVa+Clw9ddvRRK+50K3k3pyV4YzbaoI23cawwPha2a23nAZCFJwZxsX1lJjkXE6KPOOV9JqyHFIr9c1OGcQFQizuMRM5IvzFw7O7i3zXSW5auurX58KdQIgzssPZCcbpsgJKtfFDvYO0/NnUdvFQbw0gOJ+jet/uIjLIA8BrMIQBcbUVDHPuP8oeXY9IrbuL8T7uf2L6euGhxARat3E80sQCqaYfR57biF3+wQ+mev/8q5dc+BoQI6HKaPGb8x/ms6+6MPtTcWUGSknwtTd9yFwuLUj45h6xDDloU95euIyGn0ImP/zN18XZWk7cWaBTfUJy6HwMAJdBXNLRLdV6tqI9DY0Z9S8AUKAzyNjsfwJYyqFJaZLfzZ67GYwJMarVV/Im1gzwBl1GILRFPtSYeP+tTt+hXIcsWmfD75G8bOpyrsN7hTz4qF8'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 53593, 'candidates_token_count': 267, 'total_token_count': 55326, 'prompt_tokens_details': [{'modality': 1, 'token_count': 53593}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 267}], 'thoughts_token_count': 1466, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7154569018646126, 'model_name': 'gemini-2.5-pro'} id='run--c6f4ba79-864d-4de7-809b-4aafd8aea21b-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'from django.core.management.color import no_style\nfrom django.db import connection\nfrom django.test import TransactionTestCase\n\nfrom backends.models import Author, Book\n\n\nclass SqlFlushSignatureTest(TransactionTestCase):\n    available_apps = [\'backends\']\n\n    def test_execute_sql_flush_signature_simplified(self):\n        """\n        Test that execute_sql_flush() can be called without the `using`\n        argument.\n        """\n        author = Author.objects.create(name=\'George Orwell\')\n        Book.objects.create(author=author, title=\'1984\')\n\n        sql_list = connection.ops.sql_flush(\n            no_style(),\n            [Author._meta.db_table, Book._meta.db_table],\n            allow_cascade=True,\n        )\n        # This call will raise a TypeError before the signature is changed to\n        # accept a single argument.\n        connection.ops.execute_sql_flush(sql_list)\n\n        self.assertFalse(Author.objects.exists())\n        self.assertFalse(Book.objects.exists())\n', 'relative_path': 'tests/backends/test_sql_flush.py'}, 'id': 'bccf51e8-b0d8-4731-a453-a3d06232fa79', 'type': 'tool_call'}] usage_metadata={'input_tokens': 53593, 'output_tokens': 267, 'total_tokens': 55326, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1466}}
2025-10-06 05:12:21,973 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/backends/test_sql_flush.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 53881, 'candidates_token_count': 11, 'total_token_count': 53892, 'cached_content_token_count': 52486, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55345}], 'cache_tokens_details': [{'modality': 1, 'token_count': 52486}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 11}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1866055005653338e-05, 'model_name': 'gemini-2.5-pro'} id='run--5be52274-4deb-4b3d-aec4-0c38d8e30bb1-0' usage_metadata={'input_tokens': 53881, 'output_tokens': 11, 'total_tokens': 53892, 'input_token_details': {'cache_read': 52486}}
2025-10-06 05:12:22,137 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/backends/test_sql_flush.py b/tests/backends/test_sql_flush.py
new file mode 100644
index 0000000000..9a93833323
--- /dev/null
+++ b/tests/backends/test_sql_flush.py
@@ -0,0 +1,29 @@
+from django.core.management.color import no_style
+from django.db import connection
+from django.test import TransactionTestCase
+
+from backends.models import Author, Book
+
+
+class SqlFlushSignatureTest(TransactionTestCase):
+    available_apps = ['backends']
+
+    def test_execute_sql_flush_signature_simplified(self):
+        """
+        Test that execute_sql_flush() can be called without the `using`
+        argument.
+        """
+        author = Author.objects.create(name='George Orwell')
+        Book.objects.create(author=author, title='1984')
+
+        sql_list = connection.ops.sql_flush(
+            no_style(),
+            [Author._meta.db_table, Book._meta.db_table],
+            allow_cascade=True,
+        )
+        # This call will raise a TypeError before the signature is changed to
+        # accept a single argument.
+        connection.ops.execute_sql_flush(sql_list)
+
+        self.assertFalse(Author.objects.exists())
+        self.assertFalse(Book.objects.exists())

2025-10-06 05:12:22,138 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 05:12:22,185 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 05:12:22,185 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 05:12:22,699 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:22,699 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 537d422942 Simplified LongNameTest.test_sequence_name_length_limits_flush() with execute_sql_flush().

2025-10-06 05:12:22,699 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 05:12:22,799 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:22,800 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:12:22,800 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 05:12:22,800 - thread-139660780025408.app.docker.base_container - INFO - Creating directory tests/backends in the container
2025-10-06 05:12:22,800 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/backends
2025-10-06 05:12:22,901 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:22,901 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:12:22,901 - thread-139660780025408.app.docker.base_container - INFO - Updating tests/backends/test_sql_flush.py in the container
2025-10-06 05:12:22,904 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 05:12:24,628 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests"}'}, '__gemini_function_call_thought_signatures__': {'7caee2ca-295d-4026-ba2c-d88d42b5791d': 'CqsDAR/MhbaIOenbFYCMaZ4yQpwIHZ8tqtCW1DICo0HyP6/UIFMXmbTc9tvYq94+z24AVMekvenfiz+P112jZo/HbmOvxcAd0BJgX5n9sp4aFcGUTNJ+XmuFheE2svS30deIo4Iqi8SeEqcuDfgVMiorCIzBrnAuTqNK5Gud+KlzF+vf3cNOEg4pnuxE/S8qGcKn7LPnSA1ohdAcva6Iz4t1uODm/C0rpR4LgyYX/gYrYV3bBS1BdRb1TjemO/DEafrC598660iraCab8oZgzdKdrkaedXFHR6qvxYtQGTHF3CALi6Hz/vvEKTciITsqPaCFYWb8dN/bXkzjI+1VAKPpcHT0TOkPEwktVoUiE0KvkvI6JS3OykwRqeXhrGi3zscSFCGscaxKYwCA14sRy31skZgYdasZBBhlvBb0jEnO1h++7Yx3WI5e6yMDeLbifsF+i4PR39shL7xqLrqMu5QSKzr6/1/pVRmve6wN56gvWNufTwGFNjsC2O9FUsgTyzghYt1nMKbTpjibrPVImjWMp3fvYQi4rH+8yl2iUj+pa2iDj+wBhlOXtnXiSw=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 326, 'candidates_token_count': 6, 'total_token_count': 427, 'prompt_tokens_details': [{'modality': 1, 'token_count': 326}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 6}], 'thoughts_token_count': 95, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.045943021774292, 'model_name': 'gemini-2.5-pro'} id='run--c2a81131-e7a6-4378-8137-2f15e8279675-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests'}, 'id': '7caee2ca-295d-4026-ba2c-d88d42b5791d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 326, 'output_tokens': 6, 'total_tokens': 427, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 95}}
2025-10-06 05:12:24,629 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests
2025-10-06 05:12:24,730 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:24,730 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

absolute_url_overrides	     m2o_recursive
admin_autodiscover	     mail
admin_changelist	     managers_regress
admin_checks		     many_to_many
admin_custom_urls	     many_to_one
admin_default_site	     many_to_one_null
admin_docs		     max_lengths
admin_filters		     messages_tests
admin_inlines		     middleware
admin_ordering		     middleware_exceptions
admin_registration	     migrate_signals
admin_scripts		     migrations
admin_utils		     migrations2
admin_views		     migration_test_data_persistence
admin_widgets		     modeladmin
aggregation		     model_enums
aggregation_regress	     model_fields
annotations		     model_forms
app_loading		     model_formsets
apps			     model_formsets_regress
asgi			     model_indexes
async			     model_inheritance
auth_tests		     model_inheritance_regress
backends		     model_meta
base			     model_options
bash_completion		     model_package
basic			     model_regress
builtin_server		     multiple_database
bulk_create		     mutually_referential
cache			     nested_foreign_keys
check_framework		     no_models
conditional_processing	     null_fk
constraints		     null_fk_ordering
contenttypes_tests	     null_queries
context_processors	     one_to_one
csrf_tests		     ordering
custom_columns		     order_with_respect_to
custom_lookups		     or_lookups
custom_managers		     pagination
custom_methods		     postgres_tests
custom_migration_operations  prefetch_related
custom_pk		     project_template
datatypes		     properties
dates			     proxy_model_inheritance
datetimes		     proxy_models
db_functions		     queries
dbshell			     queryset_pickle
db_typecasts		     raw_query
db_utils		     README.rst
decorators		     redirects_tests
defer			     requests
defer_regress		     requirements
delete			     reserved_names
delete_regress		     resolve_url
deprecation		     responses
dispatch		     reverse_lookup
distinct_on_fields	     runtests.py
empty			     save_delete_hooks
empty_models		     schema
expressions		     select_for_update
expressions_case	     select_related
expressions_window	     select_related_onetoone
extra_regress		     select_related_regress
field_deconstruction	     serializers
field_defaults		     servers
field_subclassing	     sessions_tests
files			     settings_tests
file_storage		     shell
file_uploads		     shortcuts
filtered_relation	     signals
fixtures		     signed_cookies_tests
fixtures_model_package	     signing
fixtures_regress	     sitemaps_tests
flatpages_tests		     sites_framework
force_insert_update	     sites_tests
foreign_object		     staticfiles_tests
forms_tests		     str
from_db_value		     string_lookup
generic_inline_admin	     swappable_models
generic_relations	     syndication_tests
generic_relations_regress    template_backends
generic_views		     template_loader
get_earliest_or_latest	     templates
get_object_or_404	     template_tests
get_or_create		     test_client
gis_tests		     test_client_regress
handlers		     test_exceptions
httpwrappers		     test_runner
humanize_tests		     test_runner_apps
i18n			     test_sqlite.py
import_error_package	     test_utils
indexes			     timezones
inline_formsets		     transaction_hooks
inspectdb		     transactions
introspection		     unmanaged_models
invalid_models_tests	     update
known_related_objects	     update_only_fields
logging_tests		     urlpatterns
lookup			     urlpatterns_reverse
m2m_and_m2o		     urls.py
m2m_intermediary	     user_commands
m2m_multiple		     utils_tests
m2m_recursive		     validation
m2m_regress		     validators
m2m_signals		     version
m2m_through		     view_tests
m2m_through_regress	     wsgi

2025-10-06 05:12:26,267 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --help"}'}, '__gemini_function_call_thought_signatures__': {'fdfe7ade-1dc4-483d-8394-bf617bb32a43': 'CsECAR/MhbZHycnNv69ePtLf0ZE0t6Mk7Nni06l9BWMfvTyKIeow6M0OOFb7dfSzTcMhc2JGF+bIhotufqIgBpmN4XIdjDCh0YlSDnlQI786NFkhnsUhLPN2+4HFEm9RiMhlNnziTaj9LXl3MU3soNYlrGQoX+zuFEfYHXp/+0yhv5NZsgpWLmacXnBPVuRpTEBkbceVM2RP0jbiRgIS2JrRU+l7NcZYHP88OR5rOYGJlX5i9f5rkMNPeZ7KlJctR6eUgDJY4tA0GmGnzZW/Zv6jP35kG+1bU5eIVuDjJYeMRNw69EeHNocgR5vxfumuQMtUWZAiv/Z6VRCX1UgbLez7FzA7ZZ+bQRruKRlfwQ6FL/TS3vFYc5uaSJ077bq7FH9uERyHcvenRBr6C+Z4akyC5Al30k77HgAWrP1nyGZMpEwU'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1342, 'candidates_token_count': 13, 'total_token_count': 1441, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1435}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 86, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.40316269947932315, 'model_name': 'gemini-2.5-pro'} id='run--5d913d31-3652-445f-9042-ef1b66c5f0bc-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --help'}, 'id': 'fdfe7ade-1dc4-483d-8394-bf617bb32a43', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1342, 'output_tokens': 13, 'total_tokens': 1441, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 86}}
2025-10-06 05:12:26,268 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --help
2025-10-06 05:12:26,685 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:26,685 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kp

usage: runtests.py [-h] [-v {0,1,2,3}] [--noinput] [--failfast] [--keepdb]
                   [--settings SETTINGS] [--bisect BISECT] [--pair PAIR]
                   [--reverse] [--selenium BROWSERS] [--headless]
                   [--selenium-hub SELENIUM_HUB]
                   [--external-host EXTERNAL_HOST] [--debug-sql]
                   [--parallel [N]] [--tag TAGS] [--exclude-tag EXCLUDE_TAGS]
                   [--start-after START_AFTER] [--start-at START_AT] [--pdb]
                   [-b]
                   [module [module ...]]

Run the Django test suite.

positional arguments:
  module                Optional path(s) to test modules; e.g. "i18n" or
                        "i18n.tests.TranslationTests.test_lazy_objects".

optional arguments:
  -h, --help            show this help message and exit
  -v {0,1,2,3}, --verbosity {0,1,2,3}
                        Verbosity level; 0=minimal output, 1=normal output,
                        2=all output
  --noinput             Tells Django to NOT prompt the user for input of any
                        kind.
  --failfast            Tells Django to stop running the test suite after
                        first failed test.
  --keepdb              Tells Django to preserve the test database between
                        runs.
  --settings SETTINGS   Python path to settings module, e.g.
                        "myproject.settings". If this isn't provided, either
                        the DJANGO_SETTINGS_MODULE environment variable or
                        "test_sqlite" will be used.
  --bisect BISECT       Bisect the test suite to discover a test that causes a
                        test failure when combined with the named test.
  --pair PAIR           Run the test suite in pairs with the named test to
                        find problem pairs.
  --reverse             Sort test suites and test cases in opposite order to
                        debug test side effects not apparent with normal
                        execution lineup.
  --selenium BROWSERS   A comma-separated list of browsers to run the Selenium
                        tests against.
  --headless            Run selenium tests in headless mode, if the browser
                        supports the option.
  --selenium-hub SELENIUM_HUB
                        A URL for a selenium hub instance to use in
                        combination with --selenium.
  --external-host EXTERNAL_HOST
                        The external host that can be reached by the selenium
                        hub instance when running Selenium tests via Selenium
                        Hub.
  --debug-sql           Turn on the SQL query logger within tests.
  --parallel [N]        Run tests using up to N parallel processes.
  --tag TAGS            Run only tests with the specified tags. Can be used
                        multiple times.
  --exclude-tag EXCLUDE_TAGS
                        Do not run tests with the specified tag. Can be used
                        multiple times.
  --start-after START_AFTER
                        Run tests starting after the specified top-level
                        module.
  --start-at START_AT   Run tests starting at the specified top-level module.
  --pdb                 Runs the PDB debugger on error or failure.
  -b, --buffer          Discard output of passing tests.

2025-10-06 05:12:28,252 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py tests.backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'37f57b6e-7960-4490-9394-df0ac4ddf9d1': 'CrgCAR/MhbYpdO7YzFUhGgl+5iyTSuMSl13NNFsInsegBM/ozqb2/6WDsaw1Ak2HTlX+8Qv6cy2a+j821nzVGMGlc3OybqiA5wJqv3wkCNzTN4Li9xF/+ES34Fe9k+sL1T5+mAZijwkJof///JSzuDVfPKRR5BLQmLOasC2CjFM2YlnOOWOXN+CXHtgh7/jC791URlbZ6aiOPuLPtIZG11U7Lk18U5xkkefvQtfUw1BGK0RLYIhpH5DgUOjDfVjUbyeKGGRYpkR9AigjBoqsHmGamIMHdHOE8NtL1kTp9lqjRPO9fsfurYheRhKWbJvXi+0+gFE7e+9/Z3QEswURtj+YtzTntd5nwiDDMFO3OikRn14Q89NpHpwymfVat9nCvB6ao/5Eh+AIziNmPn3IUbgZNZV7roU8tOrp'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2349, 'candidates_token_count': 20, 'total_token_count': 2447, 'cached_content_token_count': 1385, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2526}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1385}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 78}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2927615404129028, 'model_name': 'gemini-2.5-pro'} id='run--f744e61f-9226-4f7c-aba1-d9b9756eadfa-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py tests.backends.test_sql_flush'}, 'id': '37f57b6e-7960-4490-9394-df0ac4ddf9d1', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2349, 'output_tokens': 20, 'total_tokens': 2447, 'input_token_details': {'cache_read': 1385}, 'output_token_details': {'reasoning': 78}}
2025-10-06 05:12:28,254 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py tests.backends.test_sql_flush
2025-10-06 05:12:28,599 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:12:28,599 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/backends/test_sql_flush.py", line 5, in <module>
    from backends.models import Author, Book
  File "/testbed/tests/backends/models.py", line 8, in <module>
    class Square(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class backends.models.Square doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 05:12:31,469 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "find tests -name \'test_sqlite.py\'"}'}, '__gemini_function_call_thought_signatures__': {'11ba701b-986c-486c-bcb3-6ffcc75e9d67': 'Cq4GAR/MhbbzVOIANnTQXkRcDbSnetrOtutRiLA7CleQhJdk63NZWXZ80iZ0kvgZN/ZqiJJl4jWwFdXNxbozkO+wME6cCWaxOh5YVV1ePHYDvkGnTYeYUuoNK0hN+Vc9zVXgZR627Ew2zQbtoweglVIRGVDEiaXIiv2NWa0xud2iozbz6+dOqrToJq/AhnNsi+kFnAACHhU+YlexguO/rWbJnTIIuTKw3lZwdDrE67HU+p2yF3KJVsRUWVrWXo4YwLaPFGtdnH6SIT/MKVzuSfYXarAH9JD8bAg0QyKRUd2/kuPwBYDDAs8ZAvQRvQ4sUclAlnAUIxerHRdO8R/z+9JxukTmZudXdN+N0yvHa/fJpZGIztlg/zXmlmkCzmGJBOb4H5NP3yywf/YbjEoA8qENrp1S4PuohZprYDzevG8yivyCZ6dtDyfxGjq57XaGfC8mUdtu0Ln2OLOVHi2UTBZLwbtPVe0uPfZhONMn7xZxAPWbIGSjmHH5eFiQT2t2CYgOfFevJ6V8S4dqef2SkJA7Vg7vNWi/aqaMqrBYLkekfC82Cx4ZoAADrF4FMQatSRy7kNQgCJiOkC9dgs/JEs+QPjlUl4/agqh2QspOPAUGcOeDw4QeWSd8DC/L7QUhh9dJ761UVDoBRvDR7mj+8oFD0ipJeKhjJoO/Q993pY08WzD5WQM2XcmLh6r3r4i3cBjbi7VkszI5C5rd72HzuKQlsSfMoUzB4/vZ6m5gYOOnfs2BCeJ58yaTJNWUoapraw9nJtmuvobAY4AcfaQ+AjviT7mZ5JWxwpcIJK/yJH1JKNinFeWdtWL1rDyTAcjV4WNcuS5leNDRdLsfRjaqbwTElspUhh2CanivSoICciuhB4UJJ+ZrgHw9Ce9OF+1svaMPfXGeFP2sfWdJJUKV5DbeJd5T68PKsDA/FLsZhf937GILgIb6HusPlfU06NCXNpHNX2hm75S4l8DVqSl9B0Q2S5ARLHlD1Kd6+pii4mbufB60joO0cPa2wbysgmmE2iaBW80BDzeEj9rl0WEYcLNtKccTxjUOVvYDnRhlq4e9hKoZeKf5xuXhDIA+ozbSYg=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2754, 'candidates_token_count': 15, 'total_token_count': 2973, 'cached_content_token_count': 1444, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3007}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1444}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 15}], 'thoughts_token_count': 204}, 'finish_reason': 'STOP', 'avg_logprobs': -1.580956522623698, 'model_name': 'gemini-2.5-pro'} id='run--787e8733-a75d-46bf-8c01-bb29d259e5b9-0' tool_calls=[{'name': 'run_command', 'args': {'command': "find tests -name 'test_sqlite.py'"}, 'id': '11ba701b-986c-486c-bcb3-6ffcc75e9d67', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2754, 'output_tokens': 15, 'total_tokens': 2973, 'input_token_details': {'cache_read': 1444}, 'output_token_details': {'reasoning': 204}}
2025-10-06 05:12:31,470 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: find tests -name 'test_sqlite.py'
2025-10-06 05:12:31,571 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:31,571 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

tests/test_sqlite.py
tests/dbshell/test_sqlite.py

2025-10-06 05:12:34,027 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/test_sqlite.py"}'}, '__gemini_function_call_thought_signatures__': {'0f493567-558d-4a14-858e-c6a775fa1af5': 'Co4FAR/MhbYVEpiPh7EOLwcm2XTijr/MzxmjR7jwabqCRUyTSkZ7lr+sQgyKhRo/5/5PYEgRRtmVdzvyQqsXwsA/VYDzr8XoPK9VifKRO8XlGx7QHAO6jAh9Fg/5ye1b2ivnY+ZyFH8vhWb8kjovd13DGgdOjCeYNOfSPDTBaKMk9Z8WxM24HbapGpxUGDOblYZJ5IJKzkcMVjFcr5c34gEkQFmxEvZq0vdOBDoOYtAU/fXWTppmWzqNS0T+noFTQ09mteHYaMKTUuMmE6CSZpewIek6Bi2WTOwFJCpFpfW1/fYZqKq0NdPi0f8Uywyl92J93fv5lLbAE5XZuaKdVoiDchRsugq74KMFKjftF9p7Yj6oeNevT95XPJ1oVFjTvx9EbRSYB3NcC50WG33H1nt63wI2MEgNg3rYRkEz3uKU7OxWUA+RnyW782IVRNtd8tSQiBUcqiKw+Aee16zZ3YGfGDX4oL05LDVAB71WXhdreXvLdVCOh56VZMlTg41OMbwNuGW8qfYaPQfaGCM3cBH+0yQX6HBWxR+YpfRgOfYqzcAaGZ4EXRBity0skSx82Kk6hBeMAjf+f2q2FJBEiP2uxWsJUBn9HqHIbsttRUfZyjfy9y1RUxsUkyHU+q5//nHmFYdluYfH0SgZOlE8YcObM/N+tQDg5jVMfZd/FbRJxYrmEx/3A8TRSaFiVVt7BeTKAD0JOopFIVDlyGIbre4vCd72bB8f4RMTwiEF1hJV4pQ7b1uXeGmkt+3bG4Z1hi1uwlrGTxfV6yaDOVPI/dX7ytiNzL1xRJFOQrGD+j83VEqxT/JJl9lx12ksKC8a7nfbBng/63T6uVf2fZ7AthmdLFbAkCOwGiH2AqjuUfuK'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2793, 'candidates_token_count': 12, 'total_token_count': 2991, 'cached_content_token_count': 2927, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3248}], 'cache_tokens_details': [{'modality': 1, 'token_count': 2927}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 12}], 'thoughts_token_count': 186}, 'finish_reason': 'STOP', 'avg_logprobs': -2.352243105570475, 'model_name': 'gemini-2.5-pro'} id='run--4e26f666-eb64-4724-ba07-7266b93f8f4c-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/test_sqlite.py'}, 'id': '0f493567-558d-4a14-858e-c6a775fa1af5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2793, 'output_tokens': 12, 'total_tokens': 2991, 'input_token_details': {'cache_read': 2927}, 'output_token_details': {'reasoning': 186}}
2025-10-06 05:12:34,029 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/test_sqlite.py
2025-10-06 05:12:34,130 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:34,130 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

# This is an example test settings file for use with the Django test suite.
#
# The 'sqlite3' backend requires only the ENGINE setting (an in-
# memory database will be used). All other backends will require a
# NAME and potentially authentication information. See the
# following section in the docs for more information:
#
# https://docs.djangoproject.com/en/dev/internals/contributing/writing-code/unit-tests/
#
# The different databases that Django supports behave differently in certain
# situations, so it is recommended to run the test suite against as many
# database backends as possible.  You may want to create a separate settings
# file for each of the backends you test against.

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
    },
    'other': {
        'ENGINE': 'django.db.backends.sqlite3',
    }
}

SECRET_KEY = "django_tests_secret_key"

# Use a fast hasher to speed up tests.
PASSWORD_HASHERS = [
    'django.contrib.auth.hashers.MD5PasswordHasher',
]

2025-10-06 05:12:38,944 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "echo \\"from tests.test_sqlite import *\\\\n\\\\nINSTALLED_APPS = [\\\\n    \'django.contrib.auth\',\\\\n    \'django.contrib.contenttypes\',\\\\n    \'backends\',\\\\n]\\" > custom_settings.py"}'}, '__gemini_function_call_thought_signatures__': {'7c34bb73-1d39-4c0a-b976-3f700b829a27': 'CoQNAR/MhbZ6oblimrnH1L+J6zPdaCwwNDYzwt/bANclQhDhmgN4E5yksQi1+qFqJzc3NUwIfc6vS1LEzAWRaDOrfGYvFQI4JjXcVcoX4dbe+A1QkAIsoh/kqwjGzeI7x7B/1OSf2DvIHf/sJ+MMIILSIPXSVobo2TJZepRMIAQXYDLKGRO7mXHwj7mCFZHXjlhC3kcyRfpMTtXkJdGRH9RjqwbvwA1pdCTQxWXBISJBsAQ6XF9K2hhNXU5+lQ/KVEg3KlziHZttSPjF7clJWWUTIS10Yyq5rNBmtES6md0hOsPhENRHWq5qcmakoMlsncIjvhx0TnEOZGdW+vkP29iUwDOBVkADdjj6+QAloWQC3KUjFrJEEW9cnTKXFDzCXZ4fMsGD8Gvfmz9BTEopseFLBmXve+HfLmMklhlYpwRPif3Eiy7pMAD/sKrcPOxXf6PW9bvclK5ZpztVbYlkWX57n92ekRBcNI9+U9Aw9G9bKbQcdrBPVumuNY7EHNXXSKpubTpHyaWii3oqzvfqbI/y1Q0Il09smcv0wg7O+rskYZWegMcd3FCFo1OqICu56x7hMmUUURr5M35WVYHUSLZ3QumaIcunvLF+DPHWn+wO4+LA97DksOUZJnX7fq7NfO4SVCZctf60MASkKJZD+MD2Je7F/Lapz/zpZb/EXoA/eVO2xWiT4etBM6yBlwGFonI474UKt6cpeX0YYCYLe7ibhL5dpWZYop8EJrwZk7M0upTUukvk4EWI0ZuqqlXzFNXT+aQakP/0sK6bPlOqIMZoFirgKe06nq8t8GKe9lC0cvVg10YVRr33zDZRCzQTpRcEsEzlWaLfIOSzBD6xj2HxxEeTO/f3thT8gxX0i/zcAXiOiqWzZNnAnVwLspAPxrYGdfjy+2sznrdv761MejsVhg8mMjWBB+VbHBw3e5q64AyIxmRBPXqQO1S4pmi3A0hnUL320PUip80lkRJR0ThaXS9ax7a0yVi9NOnDopWZxcUCLxfdMktJDzUdncjg0jSRG9yg5ZOeMLJ+J3dHpEwyNsVhr8gZ8fPrGXo2f+YpSW+pZDjWYXi+IiYHKQVVgOQJ861oaOJAWUWVvyGsDbaN/LPuQlR01StFUiK9Cier+rhUmP8o+ACefGJ3K2eyt8/kIUuLL7J7uyoujOLd00f/LHWmrDNJKCkgY/cGMw8JafGp2hfoqINC4nSUWVA7H7447OQUFZJ1qWgHa8zGR3ibsoU8Yz20ZpHrH/Psm2FdoPbKaLVw5iWIMAU8iT6kabkbQEoEq1/m8WizuygAG2VDzAK9zxIwEh6baRYzomW7rFM63sfTlmGk8k04Vwai3LfY77m6bNYllaW1g5gDsdAP2WD42Kf+AB83to78V9KAccvPzTo43LrvzTSdUEq2CVS9k1x7ZKaqX5UVAvV3r0cvL5jQ/zEyhmNT5+RcNhzMhCsEAGh76HNOLUaCzVw7sEhea5q4ZwwyLytkIO9MnGR+AoDKunDwCCtN8qmenLQu72WFeARWJQTk00qBlFnxZ4BnCok37M5FXIgT3fBPb43oHsSeWpEffGrrVw0OEbAtM8puakOcL7P+I5eArubpe71sCrk6E6OeA3Uqh+z47vLcKSLX+6WY1rNX4mM8EIJgu7wo9f1r/iLTklSozlPVc4bcXanieKnFiE5OBDE3cym7HMSTxbAcihNE3kOuOodQTqUX6OKKE7Or6DK5Z0q7gUzuXFbFPq04ScnEnQnwyP9UNrHmcEudWub2FGG/jRZrl77x5eLi5VNHuk2T/w9iuJz66L+adCRpMA/OQdGBe8pUhWP7ZoJWnd5t04ubwlXXX6kTyNsKtEmLaETtd8V0uuQIeVXPmHEsjPKovjPZDcgii8DolCi5tKD2vhKl0uuhW7b0yK/vZmqg8+s++A7av0GsNeGmD+jEf3kh4j6hfg72HfRiuj0FeRfqIOQwKtbW1i/aAxu9213eFxTGnVuiTPjxJ1q6xXrcyRw7E8Oi12riY5HcDnA5cYtyx0EnoqEA978zBbKr3dKvy6QZBkjoXr2f21J977xu/4g1vBqakMsUC3hM9SPHvxBiyTMdkMnR9/8x0h/fPzmgRjBQjwBi41UzWskE8qGUSMgzHiWBZ10jJCSUc2S1vJUs3VcG79z1q7W5fzW4qpHLhfPq7wbN/wofEuhDJs0DRGzXvciHr1pNMRgwgSpPgvwYQMQaMiCdyr/oDofO'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3079, 'candidates_token_count': 54, 'total_token_count': 3570, 'cached_content_token_count': 3003, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3718}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3003}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 54}], 'thoughts_token_count': 437}, 'finish_reason': 'STOP', 'avg_logprobs': -0.75381632204409, 'model_name': 'gemini-2.5-pro'} id='run--fc9feea0-b4db-49e7-b05c-5474d231062b-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'echo "from tests.test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'backends\',\\n]" > custom_settings.py'}, 'id': '7c34bb73-1d39-4c0a-b976-3f700b829a27', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3079, 'output_tokens': 54, 'total_tokens': 3570, 'input_token_details': {'cache_read': 3003}, 'output_token_details': {'reasoning': 437}}
2025-10-06 05:12:38,945 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: echo "from tests.test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]" > custom_settings.py
2025-10-06 05:12:39,046 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:39,046 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:12:40,943 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'5b483cf0-c614-4e42-8c7d-fe8eb4dcf405': 'CrIDAR/MhbZsfO4JtLeK+068P+JsjXggWjkjSvx5e5bWZ4umTks0mFSsLXFiD60PMbgtl4reCdIKQIUmWMbAy5x/dQErtd+Rrwg8rgeEZkS6cekW7LvnafS5qfjgrVsQ/33BBO53lX6m+wH4hB0DOA/aafaAcmBnMOFm0pEsDfiTxW56B7ch69Oj8Z8T6j3zqMr/92TstBZg3QG9qtUZrNBY2tRInQOdBdavmK93xEMrXCCGR51NqStK/HvyEqqq0BX3++XNtI760twYsofT9Pi1ccv7LNcorfX+/j6E+c2hlSugLDBw6MU8BRvXTM6q7WuHMB2noPiJzWPXOp8eYut1XPy6ZpqpmCawlzUha5FaAYrNIshwEV9gjuuioxG1yc1gZawNs8q1SgXH+fmsMy0EbwBRXW9rHgMCVOHwnqVUzoITXOZSfGj1WkoIzHOs6JdgIngeCHjerB0NPVu+OX6tJCEKKAa2wsV8dQQnhrU7IJh75jP8TiGY5DJZCNlY5Mly90Srsi2Qsm1JFt/DXmrRBhi56TNQ7OTPLmQMcFKw/dniYTzQzXl1Oza2HAWrcqJ8KP0KIgEfzIW2ANjOW5q/vFpUtc7TTbs7ON9uujCmk/+DldvZqiY='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3138, 'candidates_token_count': 26, 'total_token_count': 3268, 'cached_content_token_count': 3074, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4212}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3074}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 104}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4162550706129808, 'model_name': 'gemini-2.5-pro'} id='run--03ece1c2-21e3-4d6c-95dd-1e3fbeff7111-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush'}, 'id': '5b483cf0-c614-4e42-8c7d-fe8eb4dcf405', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3138, 'output_tokens': 26, 'total_tokens': 3268, 'input_token_details': {'cache_read': 3074}, 'output_token_details': {'reasoning': 104}}
2025-10-06 05:12:40,945 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush
2025-10-06 05:12:41,189 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:12:41,189 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 287, in django_tests
    state = setup(verbosity, test_labels, parallel, start_at, start_after)
  File "tests/runtests.py", line 140, in setup
    'INSTALLED_APPS': settings.INSTALLED_APPS,
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 64, in _setup
    self._wrapped = Settings(settings_module)
  File "/testbed/django/conf/__init__.py", line 171, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 994, in _gcd_import
  File "<frozen importlib._bootstrap>", line 971, in _find_and_load
  File "<frozen importlib._bootstrap>", line 955, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 665, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 674, in exec_module
  File "<frozen importlib._bootstrap_external>", line 781, in get_code
  File "<frozen importlib._bootstrap_external>", line 741, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/testbed/custom_settings.py", line 1
    from tests.test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]
                                                                                                                                            ^
SyntaxError: unexpected character after line continuation character

2025-10-06 05:12:43,952 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat <<\'EOF\' > custom_settings.py\\nfrom tests.test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'backends\',\\n]\\nEOF"}'}, '__gemini_function_call_thought_signatures__': {'ebc39682-15b9-40b3-8acb-5203c31f6f99': 'Cq4GAR/MhbZ8BsmH2F6fcaHR5uVO6GSWq6DH2FsQhSeXT5uWsRwzQU+PYwOH/8IFAOIkjlLv63Har23XeEYV2HaGVnVaZrVYRr4E1kWAfz53jNjJfeAkE5bUsSvhwaPkcw2cex33Wl8mS5Me7kkYmhZ1H7u+yElXtbiaVgMEkQdrpSQK+uF41WXYFAMbc4d//S6w9nZNTkn2+SJqucLGf/IJwrl4Mb5R465HlmdtsfMzF/BRyKxEMHqiuLdQkeDHWZaAZH/9/LAkx6CcFCx/+MMV6q0+z13feLGxttJEjMVw+PTZbDmD00pXnXagVt+pjKVGmTZTSWp+a1ZAqlSHBk39UsG4eRDkSJnFto8Uk5UmJ8snNZSe8Hj9A5GhZ0GVSywBW0scSv7X2sT7Wiq0poQa95or48mX875PmhQwB0LguDSn01KD3FwV5UqlCvL705COBStX74s0H9GzNariC+sDYUUq84IgHrVPZBISgHDusEojjYMQZSc/hgePwkpBCGAZC7TqNoM2p0ogO1QdcloP0DuF2faFA+Y6TA+Ic5AEvbNUBuf6DEGV9vDey1wmCjNJ2eHnSkRLEubnV3nBPOhXgwzgK6DFDZPOAvv/T0V4QA64Jm5u/DixKpUMqmciqzwD0wQc/CysslKsDxY/lsPm/4pnVjyTwAXREuvf96/2OrYjrYIDptP08jQ3K8LY0+mV3OyG1pHgzbVg1p4xJpE0BNBEU5Wh22AgXxeFs9UUOepv/yjGfLle8ld8fdMJp8WtHm0ZxyA2p7NS62k/cGAjXjqWU6hyHSTQcMdqBwliOtPMxG2r+IFRjYItNmxzTxO3dFsB7Lhw3j+7GbTvqhr96tt2EnNzFZebWRCMviFO2hNaFDytMhf84iYbJGV5Lup8gCoskcQXQcaiAapBF8jly9xpBu/hJcubIDuKflZAjjbmc6Dbr09jRbIcUF6E26plGVoz1kr1zAHzTNzTcjbXoIaxGoL7Xb1T2o9hV00nLp72He5pwXqvJncoSX6DRx47nVplyKPRxAREj9/6eD34BhE8Or8oJ/dl2OEsFmPt56kbCiUdbDW52f9hI7MTMg=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3740, 'candidates_token_count': 58, 'total_token_count': 3997, 'cached_content_token_count': 3144, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4916}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3144}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 58}], 'thoughts_token_count': 199}, 'finish_reason': 'STOP', 'avg_logprobs': -0.20908005484219255, 'model_name': 'gemini-2.5-pro'} id='run--dc59e7e7-566b-4d48-89c3-ac10ff54ede3-0' tool_calls=[{'name': 'run_command', 'args': {'command': "cat <<'EOF' > custom_settings.py\nfrom tests.test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]\nEOF"}, 'id': 'ebc39682-15b9-40b3-8acb-5203c31f6f99', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3740, 'output_tokens': 58, 'total_tokens': 3997, 'input_token_details': {'cache_read': 3144}, 'output_token_details': {'reasoning': 199}}
2025-10-06 05:12:43,954 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat <<'EOF' > custom_settings.py
from tests.test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'backends',
]
EOF
2025-10-06 05:12:44,055 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:44,055 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
cat <<'EOF' > custom_settings.py

> from tests.test_sqlite import *

> 

> INSTALLED_APPS = [

>     'django.contrib.auth',

>     'django.contrib.contenttypes',

>     'backends',

> ]

> EOF


2025-10-06 05:12:45,685 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'c05d71db-5bac-461c-9fed-166d20cbcec8': 'CvYBAR/MhbbBx8Y2KqQAFQDxsLXQqTava1r/D/cuLesHjQ7VPWgMGNbWMRcu6/Uk1rbbwIZHnEA12tveZXNmF2mF6ovtQMLZfsx7xv9ZWGf02ghbmWU6ZRhZsA8X+9hJxLg75GCUYMCeY65xddzmXst+cMhjme8hsg4sEK32PioXRJsYfPKJogJ3B9K6DI+jhBgC9i37q83U+zpTo/66zxh795J8idZyuedUeRm5SErpAQ9Fga3nbeC56Q4Bq/J78z4VIti1X/CArPc+jmuYRsHiZD+v8oVMQat7JxAKJ4jpVC0cwzuJVsmOyj8UNvWa1dHKLc3+wuWO'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3868, 'candidates_token_count': 26, 'total_token_count': 3947, 'cached_content_token_count': 4738, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5241}], 'cache_tokens_details': [{'modality': 1, 'token_count': 4738}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 53}, 'finish_reason': 'STOP', 'avg_logprobs': -0.14674712144411528, 'model_name': 'gemini-2.5-pro'} id='run--88ea498a-6ec1-4ac9-acac-916d798f1265-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush'}, 'id': 'c05d71db-5bac-461c-9fed-166d20cbcec8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3868, 'output_tokens': 26, 'total_tokens': 3947, 'input_token_details': {'cache_read': 4738}, 'output_token_details': {'reasoning': 53}}
2025-10-06 05:12:45,687 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush
2025-10-06 05:12:45,996 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:12:45,996 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/backends/test_sql_flush.py", line 5, in <module>
    from backends.models import Author, Book
  File "/testbed/tests/backends/models.py", line 8, in <module>
    class Square(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class backends.models.Square doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 05:12:47,778 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat custom_settings.py"}'}, '__gemini_function_call_thought_signatures__': {'63a690c3-33ad-41a8-93dc-ec3a729833b3': 'Cv8CAR/MhbZb6Bmy/MVc8+G/yJ0mEyghR+uQDy2H2pMzHEh8ycH4ce6g8+HYxd1I3JYMiV6pbJICcgfEqlwyyrTu9bfdrbkvYjCsDRwJ6cM3QKDBTtHCeVu+9iqXXI/UH8y7WpDEyxAgLSW05dZDOvGnRvmBl31VCEk4evCgpnnAO4yzWeCY2A/ncyZLgeJIiatvgjTvmaJ0pWDYXxcm6puQkGjNeEHZXRFsOHNPMpcQgKWgH0nXiG/0YnWr26Gqsbn/5pS0QitFhd5vclpOnxnH/hXxL+JKmee9EoJc4GPHX8UQq0zvPrVl/iV+NTt65yvYaJurdHWJLUHdag4V5Vf0+l9FXEeeHn1NuiO5llxi7NZDt8c5nOAvOeBjl2XsZ9WHMqjHAVOAfvGdNSRNvpUu658h+r3biqC8XWPs2jQEu1tpQvy1vkZxTPxfVcozZNJyhszfPxM9wXpEDdNecFBXh4JmBPr/HpHLx1xqmQPk+a+hDcf680u/r1LfBmX/qrg='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4279, 'candidates_token_count': 10, 'total_token_count': 4386, 'cached_content_token_count': 4795, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5703}], 'cache_tokens_details': [{'modality': 1, 'token_count': 4795}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 10}], 'thoughts_token_count': 97}, 'finish_reason': 'STOP', 'avg_logprobs': -1.233607292175293, 'model_name': 'gemini-2.5-pro'} id='run--3b0d3fb3-06de-4c06-81f2-c934921b4297-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat custom_settings.py'}, 'id': '63a690c3-33ad-41a8-93dc-ec3a729833b3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4279, 'output_tokens': 10, 'total_tokens': 4386, 'input_token_details': {'cache_read': 4795}, 'output_token_details': {'reasoning': 97}}
2025-10-06 05:12:47,779 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat custom_settings.py
2025-10-06 05:12:47,880 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:47,880 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

from tests.test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'backends',
]

2025-10-06 05:12:51,001 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests/backends"}'}, '__gemini_function_call_thought_signatures__': {'6172933c-5d62-44c9-a8f9-3fa9cb05759e': 'Ct0FAR/MhbYfCmFaN/gEJcDWMIKyNUaeQ4nGVebgqKatKITdKbj3qM3j5ftEEh9Wg7zN6dJFwQ4/ffADBNKImfgU5MeoEDRmPkWTWMuEqNKKo0NEGyP5Hqr7KtBHIBMJoo3vXGkM9HtgG/6py02rfHyC2XZ6EaLHpVh362w0MTSqXK0lEY8nm8fJE5kM9B+3QVrAlBcMcmQgRaDPHdo9yu4PKuW8v+QWZHWtCbgX3mne4Y6Ij9B+5Lx3BcLX/XE787rsAn4cdP8zTIQO2HG9Bxp9DeqO1UJexBF1OngQpH5wMhTR8+s4PEpC0ZSzv1MqAiKknxCBtxg4Svq5GVsssXFf1bc6Kw6GcwK2zZmhnkKx9r0kHLcLKbGkEF/QBF9EaJYnVUJ2j+iiO6fCXabU5BOZMXYw4iifGD/s3+wxvkYKvc+RyTT8hIY0XDTWY0z+H1MKHszwABYikEEUAeUzqFEEux7kqO5XHd2gZjK2AU/uUVgRV/jxadqgg3ykRv7tvVahGysKZ1SdiRW9CUu3SeMTPlsILKaBtsEhwM7QXBU98qW9LwF6kcE1zvecEAJO9drGqwgtpdKyPJKOLkWUUwlhbsE1Dzp3sKcDjs0v5IUMzSCE4onjoNgd82I5txP9o2g/Y5jbNY0Wpu00S4PhsdJgR3m7EV2BcwRHT+87+OO4iiU8oIYvFohLisFxIfHRswoJ0SJz7yYnNstxrmOD7frKlJ5XcPy0+glfkmZAC56wJidEkjoPGmw4RR9tRhVgLr9CHa/hPWQEq0LFqEKZoNDwtjZfE13Wnr0hIDddx+bGznxzDlPx1vX+v0xivu96hNvWADDs8yj2coMR/un4PmHS5FhZ8zYg6x4IxiHak6TEgHdSCMQfZzJGUOoB2IhdYgbAbZcSAEZAOBm4RRkhXrkyTkBniNnCWe1CqB6x0Y1d2iWQdHoilSp6NFEJRgR9W96DBfdXIXEK4vT8hU76ag=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4335, 'candidates_token_count': 8, 'total_token_count': 4532, 'cached_content_token_count': 4795, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5854}], 'cache_tokens_details': [{'modality': 1, 'token_count': 4795}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 8}], 'thoughts_token_count': 189}, 'finish_reason': 'STOP', 'avg_logprobs': -3.1268460750579834, 'model_name': 'gemini-2.5-pro'} id='run--25e83a7c-e838-4fa1-8acf-14e535ba78b2-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests/backends'}, 'id': '6172933c-5d62-44c9-a8f9-3fa9cb05759e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4335, 'output_tokens': 8, 'total_tokens': 4532, 'input_token_details': {'cache_read': 4795}, 'output_token_details': {'reasoning': 189}}
2025-10-06 05:12:51,003 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests/backends
2025-10-06 05:12:51,104 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:51,104 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

base	     mysql	 __pycache__		 tests.py
__init__.py  oracle	 sqlite			 test_sql_flush.py
models.py    postgresql  test_ddl_references.py  test_utils.py

2025-10-06 05:12:55,730 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat <<\'EOF\' > custom_settings.py\\nimport sys\\nfrom os.path import abspath, dirname\\nsys.path.insert(0, abspath(dirname(__file__)) + \'/tests\')\\n\\nfrom test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'backends\',\\n]\\nEOF"}'}, '__gemini_function_call_thought_signatures__': {'5529681e-a861-493e-882f-1d5397c69eb3': 'CtoLAR/Mhbb2nTly3X2WS6k2gYggeHO1P0m5MFOQIkP6JLMdzEBg9EkK0yvUgpP68lyWe0Qw7wzVvpo9xa3sJNm7VRGsA3P3S3UaL3n4mWtKS5FCZGp3pg6QwuxR0APx7b6yHJ9glAd696KvUhag1E+V2QckFvdXEaXSCu0A4SIYKl+uAPejZYcFl2EjvVc+y/+7TT2JHkRGnqQHnvYG8Z/oaX7nC3vTie4c1mYAKlL5AoCcpF1iixt7CjfeFJv+PTgPibnWdoxvVpKWZTbujPrAAgIWmCVzuZY0un5beIxEVK5dFU62wwCHD2ruL/yJsNAMUPfpAXh6vTjxf1q5tat509BVIemsFDuQUoNswyQC33QDQTY6gzd1Vc8r+x7tG7s7RB3PopBbyTakCuTx4CQp/40BMrg6NbmloUheusgvKnVbg+n5nTrFyRNwASjxDGKUnCW4qWL7hxgShY9cM4dZJNX/YMqnXaF45b8FwDMgh6HCW0R4NFsy69oJVu1WyOiSHvH/oQWGlli5yJ1xjsJxTZdi4+X10RL+u7jg/+47rEreRqXUjc/v8/uhncTQcs/Q/DR4VoiWX1YrdKmfrwoPJNTE9StFrcGTZ/VfeJym9lcjoB/VodRId4qHecipdRW14O4kew8iLi8TRsHZ/Cif+rtBhKAzuKkoSLbyfhxE4nJkfQ1ey6hDLKvXSiP4oLFcpX4AwnP912Uw0HddqQy0so06vF5PdkVBJirdtikL/yfDdk3Sw1kmk0P2sLZBpQp+bjFuuH8lO6/hQobuoGQEgji1caDFdUUrujtSYFwWA0GLH3v6xDV+lSJezzGiX4SaZsLC3vp7eVT3qTO1EL0hQ3FA8253u2w6hKwYAkYT2j2i7tkPS5Cp9mItmmhBMlbTHkNt/WPhMQJ3+S3Xt4CkKh7/paNVX6UXkJ/chMhDHaDqotZ7KgR2G/rP6H4Q/xpV1cEVj5bIccauu9LJcapNG2I8kq/aF7uM4rRYaKZHFJ4/8vMmLMgsjizEusgytsthgtvBoCNPSXSf0lN23QKbs/raFX3odGcmUgyRg0LP0ck9v0S3VjMOhmAcHAvM+A87porH6HvEPHuAozZomBWJCclqyHBWWuOq4NAaRPFTsOtHliQtxeWLSYcQAmfvRJykKuHibRi2Hxyas/6HlmCjmdvAwDR2zqhTg34IMVIAMoTgzpBUUw3T5Ggq8T/1n0xlg5dHs0YwXfvM+wRjPUlFz5zXgRsY0AwfLw4EaB76lWyoTatyu8M6K7lXctFWQYusj1Sb9o8ddhpYa47rQRybMFtuWWfkACPvDRYMf/6MFZ6lRVzU/KQ+m2XsbcCKL46heV2Ec7QDBAQJf58+yxK7jQrlN/4wpCWZEmR4jnnn+il2mHHhMaeI2vz00dFhecPrTM0D26m4PtPYLSX9wDbDbbDfhpbJj6mCcbH0cd4G+JEJ5ZHdhXJ5m/nxaEBGdLTphnPipbDvCdGkGdZmCiA2mDR3HkIv/Y5VKDeBrBJmAjP5PVPAKQXoqSILYgs+fNVFDX9WxXF3rwJaLPagBNQUtv7iv85+NMyBKFWzTyhjzNvRL0pHrU99zjJQN8KwYx4nfGTIR7NLfzRAB5b35cq+G6CvVKfUPBy9dnReryQW3Y+msBglanQZd6eh1yAQMDm1Eo15+In7ca6Qjo6cSGqrZv06V68lyw4U+m2GPdUDza+eMaHHJl5tLqAmpWSgJmEFQbgwCi95O5aVBoVJFJL1pLyLPOi27Dvm/tKxF0fS8zEiQewXXTEj4Q4IvJoCHsd8aYIUQmoFWnT19MRFxB0C4uF3Nzjp1NLPlisHgRgMKFkMl6wDvGu+vRAR1bv968dY40T6VjyTLZ5Ec65OFuOw1FniaCyHgyCJl6CiB/y1nl3ZOn2Cyb8QTCbdz5fa3UnnifMTuGVxWZyVQB0zwTw7O2jHDBguKLbmMoZpKkBeqUwQISLa/5LwZaVl9YwvUoMA+1jHUdm0dtR76w=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4399, 'candidates_token_count': 89, 'total_token_count': 4899, 'cached_content_token_count': 4807, 'prompt_tokens_details': [{'modality': 1, 'token_count': 6105}], 'cache_tokens_details': [{'modality': 1, 'token_count': 4807}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 89}], 'thoughts_token_count': 411}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5212996836458699, 'model_name': 'gemini-2.5-pro'} id='run--7f6dac0b-2543-4f34-8b4b-ccd39cd4728d-0' tool_calls=[{'name': 'run_command', 'args': {'command': "cat <<'EOF' > custom_settings.py\nimport sys\nfrom os.path import abspath, dirname\nsys.path.insert(0, abspath(dirname(__file__)) + '/tests')\n\nfrom test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]\nEOF"}, 'id': '5529681e-a861-493e-882f-1d5397c69eb3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4399, 'output_tokens': 89, 'total_tokens': 4899, 'input_token_details': {'cache_read': 4807}, 'output_token_details': {'reasoning': 411}}
2025-10-06 05:12:55,731 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat <<'EOF' > custom_settings.py
import sys
from os.path import abspath, dirname
sys.path.insert(0, abspath(dirname(__file__)) + '/tests')

from test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'backends',
]
EOF
2025-10-06 05:12:55,832 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:12:55,832 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
cat <<'EOF' > custom_settings.py

> import sys

> from os.path import abspath, dirname

> sys.path.insert(0, abspath(dirname(__file__)) + '/tests')

> 

> from test_sqlite import *

> 

> INSTALLED_APPS = [

>     'django.contrib.auth',

>     'django.contrib.contenttypes',

>     'backends',

> ]

> EOF


2025-10-06 05:12:57,145 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'11612d3f-5075-4549-a354-503c6be4b618': 'Ct8BAR/MhbbktwiQJqre18KVzRZfSp6XvbTmO/hka7px9eE1LHeBJK2HfC8jiw2mQoLWAF/pIKMX3E9Rhmb97JowziHuP6AfWgEojwTplAmzMLC1BROi1S8P/fNUcnpVUmUOdQJUxwbAh+lTJ8bNae7BUk0XVJJkCaUZgZMMn8SHNLmxssxhvNRXT6CyQQHMJ9yzN+SW4GX0FaYgervF4g/VIsG13U4GOGtw4DGdihibBfWn5xLzEF9baf3uyStSGrq5DR6G4YF0HEJS0Vi/UBeSaTmJgMjwHYi5ik+tWbs2hA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4595, 'candidates_token_count': 26, 'total_token_count': 4669, 'cached_content_token_count': 4853, 'prompt_tokens_details': [{'modality': 1, 'token_count': 6710}], 'cache_tokens_details': [{'modality': 1, 'token_count': 4853}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 48}, 'finish_reason': 'STOP', 'avg_logprobs': -0.21845008776738092, 'model_name': 'gemini-2.5-pro'} id='run--558c9794-3d39-42e2-b608-83a4164541b3-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush'}, 'id': '11612d3f-5075-4549-a354-503c6be4b618', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4595, 'output_tokens': 26, 'total_tokens': 4669, 'input_token_details': {'cache_read': 4853}, 'output_token_details': {'reasoning': 48}}
2025-10-06 05:12:57,147 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush
2025-10-06 05:12:57,427 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:12:57,427 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/backends/test_sql_flush.py", line 5, in <module>
    from backends.models import Author, Book
  File "/testbed/tests/backends/models.py", line 8, in <module>
    class Square(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class backends.models.Square doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 05:13:01,106 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat <<\'EOF\' > custom_settings.py\\nfrom tests.test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'tests.backends\',\\n]\\nEOF"}'}, '__gemini_function_call_thought_signatures__': {'10ef3eb5-4865-4ea3-8306-ee76a069b20d': 'CpEJAR/MhbYJRE1a3clTQbSrkmpxJGv9y1C9gygWMi/mKjIacUEQz/aA6tB3R6fLMnNhN0JZFM890S66D7Vj7fa59AQbrJ0Oba95kby8cVC3BeGX/v1VFwRZiQHWHQ6E9/czxk56YAQOsAq7duu17iPgEIuwLm47MH4nvUnBl2ABtkgqbo1ndhVKYs0jzXUW3MwZ0E3FT3i7SU1ddHzpbHiingbeCqaG433nlNRQr+EU2uDePpNmbbNsROC3q+J4EmBuSbIUOs/AAMWCyH0exozsm1DqQvQU3Qc0uTq86kmgDKkqmBuVAvFM5lWmvIUWNzSdybOttplCk2h+DbFfHtamx3pIwdGA+TEWnFfqrNYygJpW2sGde0KTIrqjKF2MaAVl/3mJHiTQzNGQFpz1bD5kCA1rsZpVLiuuhe3YPVAVdm31VPCEc0j26Qwr5o3nqvBSU79rbZuwv3U8I+AHUaI45/53FocHxpMH9sGC1SjIe9jW+vslgFPUgslrxeWfUX0sj6TduLhqBYCzt8801xysqILl+O175/01/Wvl8t49g5KEgqsb4GuQDLTVg0h1gjPL6Afnt8hDc7VUWFZf/TSXeKzx3rpd9B+0u7JLpKcl4M0P4qB6Vgo+9huSUDUFCEJ9gc96SzjS9ZSVVT2+QkooT3jbFhrAjoFueFdnkNPpN1WQbJmW9tuky4HU0dXaoKRJ4o+Ud8EinTzc5YsCBdYyjP8a0oDlAXFM6SNgPQTbQWS0o5MsC87YnEvUvY6tjXYFSFSF9ajj+NTBQS5xcSd9uij4osJ4n2oGGmLpxPc+r2AnCUve5KWXg3MsxZ7zxjlW6ADjoemNm9ema9l9gk2/pf8wUM3jhUiAru8SRhCvtJugdI+a2T98eoS6gi5PlcJEBqnFjE9eBoYloT2nXMnJzSutdRzlvq7F9NycXDmU92a9Qv9IS13Nkv3lOdqR6vbMWNm8P4fq6QQ30qSEuMF8tBN0oEm5wb4X+py9Un8KxhbMpLKFievd4ue7rzjDF4DeC55yXhruOXNGR0wRipi7p1J2s72tPysXaro51buQdkBD2q9SvrCSl3wfBcdRy/OhpF8meMgqqUBd+j3uuQBtUMkzSeg5P94V2uzYW2oQlhPxDQV4gkbNtyjhfsKy/+7gllN7F7j8vm5PHyng+g8T7E2DmCMZ9V5UQ92dyn1T6onVzGueaWEgxZne/v/oU+wXRYXEMG5m5ik85aZXzrvygUdBvWtHWaTVzWU80uMfZ6tFZDdXS08GTrcL/1qKoUdZWzcFEpn3SZ2G9TH1dW/1GTqq9ize0U+el9Vqavzd8ovnLhLVqv8/Gv5lk2bO/dPj29DfMvhsUq+dHwtHF6yKmc/NFjj7JFewAGZrkVDHVzxyoqMjqg0JJCEwuKbBR6vmxx2aVZB3reaJP0yYBEbMWnhmf01NHWzte1vnJe9n4OgW1qK6KxkXnSNbeEs8Zm6+p810PONHGnXQvsnjpDJVZAlL26s8iwcQJG/vo9S4yitm/OetbMRExTrhjGKUrjLzOWNgLej1biERDvS5oyiHa2E='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5006, 'candidates_token_count': 60, 'total_token_count': 5377, 'cached_content_token_count': 6523, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7167}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6523}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 60}], 'thoughts_token_count': 311}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4735504786173503, 'model_name': 'gemini-2.5-pro'} id='run--b4104ba9-2fa8-45ae-8618-df51b80c514e-0' tool_calls=[{'name': 'run_command', 'args': {'command': "cat <<'EOF' > custom_settings.py\nfrom tests.test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'tests.backends',\n]\nEOF"}, 'id': '10ef3eb5-4865-4ea3-8306-ee76a069b20d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5006, 'output_tokens': 60, 'total_tokens': 5377, 'input_token_details': {'cache_read': 6523}, 'output_token_details': {'reasoning': 311}}
2025-10-06 05:13:01,108 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat <<'EOF' > custom_settings.py
from tests.test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'tests.backends',
]
EOF
2025-10-06 05:13:01,209 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:01,209 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
cat <<'EOF' > custom_settings.py

> from tests.test_sqlite import *

> 

> INSTALLED_APPS = [

>     'django.contrib.auth',

>     'django.contrib.contenttypes',

>     'tests.backends',

> ]

> EOF


2025-10-06 05:13:02,674 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'01737c18-b515-4a56-bac4-e04c5466c63d': 'CtYBAR/Mhbbf8vkCyjE/HKg49ufheDG4vZz2W5C1rR3pWJXPce1NArUW7bG2ADGj/hp0dUUOwzElloeAflWZXTBPnhWlejx5p918b06I03T20UdR86sPrJ3oZdg3NeirlQHcphvdpoFs2yZvuUu9i0gTb/WSpxfD1IZbwFH/OtlM4hkNurDsHLQUPCqwnCd6Dvz76U56OMP9qxGDsGxxcPDnxOJbPLZbckiU5QxNprZEWaJcztryuQkzpIkaHkI1UQ5/NLWsewf51fs2pDyLd9pEG64EoGskxA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5138, 'candidates_token_count': 26, 'total_token_count': 5214, 'cached_content_token_count': 6554, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7608}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6554}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 50}, 'finish_reason': 'STOP', 'avg_logprobs': -0.07876752890073337, 'model_name': 'gemini-2.5-pro'} id='run--54e4ed33-0976-4d74-b450-658fbaea0442-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush'}, 'id': '01737c18-b515-4a56-bac4-e04c5466c63d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5138, 'output_tokens': 26, 'total_tokens': 5214, 'input_token_details': {'cache_read': 6554}, 'output_token_details': {'reasoning': 50}}
2025-10-06 05:13:02,675 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --settings=custom_settings tests.backends.test_sql_flush
2025-10-06 05:13:02,957 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:02,957 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/backends/test_sql_flush.py", line 5, in <module>
    from backends.models import Author, Book
  File "/testbed/tests/backends/models.py", line 8, in <module>
    class Square(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class backends.models.Square doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 05:13:07,600 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat <<\'EOF\' > custom_settings.py\\nfrom tests.test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'backends\',\\n]\\nEOF"}'}, '__gemini_function_call_thought_signatures__': {'280daa2a-1d38-4068-8aad-09d0afd16694': 'Cr0LAR/MhbYmSgM/UEqw6ALVIY22anlwYJAvi7bA3eyaPNz2t3V28t5gCHxHFfx42RGO2i0Fo41hBSdNvHTyCF0nS0C5cy2IYRKEtCKqoodFp24OrtPQrsrrArpZO0C4ubCwqgx9gKrHb7kIPSeO5ytwgyY9fw709GSEMN6LPhaKtyFULQkVg0+l3jDPOtjuLOUadybct9HmzgwJQMgoQY6xAF6i88gIIBKlX4ypNJmXinenhU1s9c3aU+Day7xc+/4FysOewfwqN7xWJA8neyRg6d5aYgpkBpg4f6UBvxrzDZtB2OLpiXjgNZYlUg1J1eY6SuDeQ7gCrLM3LfsmFAICFaX2ZcIZGYJWbx6L63yKoJqQgSzWVw7mth2v7EFLMK/BW4n6Vd7cDbxx1O5nrxdx9U6jk1JMfYFyd2IsXh1TctYH2PoH/IxEFhogwuCmq019PoyqrPC3YNAiX6Epf6Fiv+lU2rC2HTFg7v4ZkMxJt8Qs2kmBDTZrPNWYh2wNKjuG/dq8ZOghOfDR17bcwwU80rwt3u3rOL2+18gi3TTXRWti8qhUMdGDnU6XiZW3rFryTFHDM2+2NCCpRGb/PLuUdI7EJ9yv3HBVYAtzDa2C/iJ18vktJnoZe3GCgHdF5GPVR/CR5PANvsPvLKW4DceToT1DOubSXh3+DB6vpIgQQ776CBZtbxbly3GYIAnCiXuicf8d3SjoBA9jWbIBTWeJJy+SK8+ivoWNlFlBjt/UIUwJVMGp+zPB2f0GKKtQTqzQ/PKZAjoNh2OolRg/34sCG7rcclI5HqEVxUThNVuFoXjQtNqAcvv83eReCPSJ8CmuLj+SH60jtqqXSkywGcV3HB05dSNsdqjrJjUeM4qJe6hcvfo8UAO2HjQGuNHax25YrK+belaF8nQIpm6tzaEgWGIL4rzFHtrHNXWBKbkbOK6/Lr5BssFd/6DD60dEEGYJkqCgJpb/H0hr/elBksKBSGV7fm2W490KIReT6EvDVGhzsO9t0FSjPHKT3WsLAKCm91iupdMpTkKtwYEJ9OBbjjlEjN4Pp2H0UNYvlHuC4Mij3yP/bZ7R9QTq31cL0Pq6kkRy4gqtA8G3f9lAqHBMWWrhW/7Gzkxj7NeFPnbNAfqxdkSf6CWt18UcoIv/TgTbGFzDxNoomaVNADYzGlMAEtD+Y7kAEwDrIRhspJLzZunoxG0fehkL8dpKvUiH1MiMLAHt0uQXkgWChxLAOLGqgofpZ3Pe4p56bbLiLI89Djn/tFt5ybYOBQkKTZGzaFi0s/qUcHIySKkGptyhllS2qFSvoyBUv+b5J8HFPKS+2LapceS/YE2UkNpzDh7B/7Zcs2bAEmE7ePkm6UAkTK6ZPQAbbuJJrrVXubqf8vqt3GVG34SAI1U5dk+n30Q/GCS6sX/9usr6DqYMDN02kz9T6Ovr/yrImUzoLeFJwu/xamNJglkR3rtXtX5yqmbozQTLQ6tUDcB2lsYyKbQf4VvVUg/2+YnAu6hZHbFBThTSI2b94GLodfprZFWoHJ6vk7YPNe01JLxt+gDAS/xcyoEGuQ4IkQXmCFjC9dQHnO21rpMr4W23VEWQXfHBbBIV6tOo9pA/m/QZyuxGqIGQPvp/8wHt/5qImvct1PsarihABsiZNC+wGrOz0X2+dLH4OgzTvx86/89vFuG9Xs9/mz/YgNxC7LU2A/QwpyxK/wdDxPIRL5DVYSdKCkNV1NF5l74Q//y1vXZAh5+Od+6Ue0W8890iQnqf5aOZ1z60hmva9cOiG937nxY3GQGbZyESMR7fdHV64d9MNPql6fD9wlPvw5WZu+NDme9oiqfoZUyRserGUnz3OOW9xCASvn9dlEd4W8l1Z8ygpsOHRgis9hT9QWGQ7wv4kiwF/c/v5jHF7RttXpAc62IzpyX0Q2vmlYbcsdJNueV28vSsIBv926mT3zLXusyJDv/ISvi6JO8KJAEfzIW2KwOz0QaFnaoMSUWgi1CRwuJcXrjKXBZIgw+YDBOBUQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5549, 'candidates_token_count': 58, 'total_token_count': 6019, 'cached_content_token_count': 6597, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8067}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6597}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 58}], 'thoughts_token_count': 412}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6970887677422886, 'model_name': 'gemini-2.5-pro'} id='run--058b7611-a23f-4a26-a8fb-4aaa0c049e62-0' tool_calls=[{'name': 'run_command', 'args': {'command': "cat <<'EOF' > custom_settings.py\nfrom tests.test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]\nEOF"}, 'id': '280daa2a-1d38-4068-8aad-09d0afd16694', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5549, 'output_tokens': 58, 'total_tokens': 6019, 'input_token_details': {'cache_read': 6597}, 'output_token_details': {'reasoning': 412}}
2025-10-06 05:13:07,601 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat <<'EOF' > custom_settings.py
from tests.test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'backends',
]
EOF
2025-10-06 05:13:07,702 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:07,702 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
cat <<'EOF' > custom_settings.py

> from tests.test_sqlite import *

> 

> INSTALLED_APPS = [

>     'django.contrib.auth',

>     'django.contrib.contenttypes',

>     'backends',

> ]

> EOF


2025-10-06 05:13:09,782 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd tests && python runtests.py --settings=../custom_settings backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'f3faa9f1-3cbf-435b-b631-8c80241df5cd': 'CtEDAR/MhbbuAQ3f+a2xcxQiuvnzW/HjSxVpgfw2GC6PhO+jPpjGlyDiegxK2WTTn6mFmTOl+cRCMxKimRPR++wvwguPA77I5jAsGmGzoSvrFuNVoqahotLnA02fFWAgGgMOu/fIK3J97LDqw2gOhVibbhovdCNN0V/uW26e39nG4Yl/l+PJGp6hl502UkHfl1wPiPFwuFyWPCpEJ8o82BJubnUhsMozud8CsdF5ETECcDRqtkQ1xHOwuktfU+8aidM8ArfmlF/EEAPWSYVWuvxL9CI3kIFcI6A5mye/zAVcLTietPJC/UZZMVqbMGAj4NbSscsTWWrfrAhW5nbO44jjQWGeoCaAU4WnDb5JgMSTetpN68W6BgvgBq8bKxQhApRBUXUir/faHrR1mhbpwHksl4ZGoX/EOJoJyISNaCqaPW08g3unaY3sZdMTC+VuH51sS3Bdaujdp5q0kcfrc06L0VTxt6cVbsMs4GfDS0K0MyQi61C6efCeQ4IswTqo/iLDb6YPQnOceJwLQMoCV4Lm0mfZJ50pyyM/NXFVcxafQP22B5vAIpUs/DS6gMc2k+Z8/t+UsIPwDxM4n9tlQ9ECg1e/HUCkIXAaR0IMoI4Bji6v'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5677, 'candidates_token_count': 27, 'total_token_count': 5823, 'cached_content_token_count': 6637, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8605}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6637}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 119}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7397560543484158, 'model_name': 'gemini-2.5-pro'} id='run--ed48f45f-9a0a-4d11-9b6b-f116e69c8dbf-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cd tests && python runtests.py --settings=../custom_settings backends.test_sql_flush'}, 'id': 'f3faa9f1-3cbf-435b-b631-8c80241df5cd', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5677, 'output_tokens': 27, 'total_tokens': 5823, 'input_token_details': {'cache_read': 6637}, 'output_token_details': {'reasoning': 119}}
2025-10-06 05:13:09,784 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd tests && python runtests.py --settings=../custom_settings backends.test_sql_flush
2025-10-06 05:13:10,031 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:10,031 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "runtests.py", line 287, in django_tests
    state = setup(verbosity, test_labels, parallel, start_at, start_after)
  File "runtests.py", line 140, in setup
    'INSTALLED_APPS': settings.INSTALLED_APPS,
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 64, in _setup
    self._wrapped = Settings(settings_module)
  File "/testbed/django/conf/__init__.py", line 171, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/importlib/__init__.py", line 121, in import_module
    raise TypeError(msg.format(name))
TypeError: the 'package' argument is required to perform a relative import for '../custom_settings'

2025-10-06 05:13:13,471 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat <<\'EOF\' > tests/custom_settings.py\\nfrom test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'backends\',\\n]\\nEOF"}'}, '__gemini_function_call_thought_signatures__': {'ae443767-96fd-4b7c-bb17-bbe5a3de505b': 'CrAIAR/Mhbareh+25e67PQGk1Rgwzfuj7QCq+HvtNl0IWZrQQOucM/HuHVHvyli1T1cRc5ZmiPRjuO+p5j5BJQean63JlbO4nB48JSdc7XN1hchYZw+3HYSS/rbqe8drteo9pbfLv7m5RScICvqF3rX0IMG7FZzmKOPyMShoSn9z84WsgQsa4UcpV4yYtSMCLIFittzjZUNXU3ehekTm5yEo9cBn0yyWAZkVA4GV9oLbrTf7/5Er4l1MjiafUan6MbKYaqt2ClJ3MlAdP1xdjxGN6/oOrtOOW2Dh2QAcjOVk7PxK+Yo3Ptsg+icEMoRlYhUFyIhvKx4vfHN0b8ChW0Vy7aEJ2euL3+XJsVSf0mGeW7oo3dxchZgmlBhccHTwUhmWWdu/vIRiJQfFhwFKj1e5FZc6tcx2fs/AeuFkfX/zC0j2Eo9WmLgryWaykDTXGGSg5mtq5wKOIepxlOXuvZCWKflbQMo2tccuqL8n/0mBlKQPvwLfkFies+1l0sZxUkD9uLcRLBwKNsaHeGIsiqAHcd3fiO6lifsRz86Sk5++asUYCaJ94+kAN6O25mQsE5sVkEC74UBq4ZlsWQiSuv8WpbMBnw7eqjHYIRKfFdauP7YhKZhb9jlLDl0f6pOGOo0i2VqlGQMbF/4ClEfwpUuI/xmsou0YToOqRc65t3LNX9pk7MqHpubP8ssVb0oRBxPNgeU+mSY42Jkaztxj4JRFfyUiHyVYZN/v5Kjtd9+D8csvo7aWUhKorIOvrtWD0whmNbADGcvXxnJbZ6+SvXsAxKwrcL3mtEjY9eG0Zf3crkrUgJ3vMw4f9bFdHMh41/z6E4L90ONDlRJ2qIYmhmyTozABe8UqUa86w+uB0PSdanY4jBSW+vnDz5b0faCvJWjK7wkFbf7gJhdjFzMX+YlvebwSaeA5kbFCPOBF/wQRyjKJfsGsCumsi5uLQJQP1uWXEe+QOxad6C6OGFoAb2tpUTR5NnPH10LHkGUytulWXxLF1SUn4NuEGTLGtSQuiUZWPfDqbB2R1YNh6xPZTC7tivf1Ey+F8DkolhLH39qGSHRBEH6EJoN6qkHn+aXmUfTRDIev3cCj0S0oM9MpSByqySvtCKPdaMoCsJEEI/H290NjlFXm7CGaxL/fYhdZhfgpOPxQ5BQ5qvJp+7uF0sO+OymgFGwjSrJZjQYxlO6bkiHTI4H7YHxIii/CM+VoCkQ6Phd9gDldCJgF5tc7gUu0/IthzsXeKzZrmEuI9fuD0/E0TuGgMy2rsX2hz42OGZIyDqbKepdJvLsKKwiSX355nXgop+zhUugopgTb43zYGO57eg6uZTUjUHpmx6UWM3lLdUVLKqM+MRTMdyqkysyKPxPmrxPhSvSOU2e2fQZZ49Hn10atASibkeKZuh3k2RakGOqGyYJABVzJLEyujEkY1Q=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6028, 'candidates_token_count': 58, 'total_token_count': 6380, 'cached_content_token_count': 8338, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9073}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8338}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 58}], 'thoughts_token_count': 294}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3141399909710062, 'model_name': 'gemini-2.5-pro'} id='run--2f8f174e-ac85-4d74-b96f-5b2f3b028473-0' tool_calls=[{'name': 'run_command', 'args': {'command': "cat <<'EOF' > tests/custom_settings.py\nfrom test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]\nEOF"}, 'id': 'ae443767-96fd-4b7c-bb17-bbe5a3de505b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6028, 'output_tokens': 58, 'total_tokens': 6380, 'input_token_details': {'cache_read': 8338}, 'output_token_details': {'reasoning': 294}}
2025-10-06 05:13:13,473 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat <<'EOF' > tests/custom_settings.py
from test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'backends',
]
EOF
2025-10-06 05:13:13,573 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:13,573 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
cat <<'EOF' > tests/custom_settings.py

> from test_sqlite import *

> 

> INSTALLED_APPS = [

>     'django.contrib.auth',

>     'django.contrib.contenttypes',

>     'backends',

> ]

> EOF

bash: tests/custom_settings.py: No such file or directory

2025-10-06 05:13:15,330 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pwd"}'}, '__gemini_function_call_thought_signatures__': {'f5fa4624-a61c-49d5-b5f2-b2c958e67b3c': 'Cu8CAR/MhbYFdh0uJVIcjnzzI2ERBOdFYfgS6N0aNQl5bBsq5o0J4Irngn0l6IYmGYhB8EGJWpF3zMWVO05b+EIyKGEMkssK4ffAgzmQsRhKjC0zOlwYrNouC9NQKesNw3cVvHIKmhaolVNiEtH1NAOW7ZqykAW2mjNBfr2FGRWFS8EtT1OhRWsQj9lPWdWK683hCXnnUS+AGqGvEJcHdUd1AhaS1fOvnwINJ0zRWWi4JsW8T8pBAFpjOPLD5DduUCeq2cAIMa6rpv748NOZNyCpZgf2YRVK90B+X2Rk+yss6g6PenMKIyAbSyKURSUm770C8GWR8VWAhcHkBORVdFAPOA8fj0vM1Cb8wrbkahrQmWLSS2HNthGD1lXW6TjKdOc2ZVTNoxuhjWA9wgMOCT+5KFkB5teCZXohU6/uAEgXU2ksX/MIOAbaX4FDIOuX9Y6eoEQKDifNS60TR3UWymSsLomTsrrJoaSzNAXrFT4zeQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6172, 'candidates_token_count': 5, 'total_token_count': 6257, 'cached_content_token_count': 8360, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9509}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8360}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 5}], 'thoughts_token_count': 80}, 'finish_reason': 'STOP', 'avg_logprobs': -2.369628143310547, 'model_name': 'gemini-2.5-pro'} id='run--5d9285e3-3b88-4708-b339-678cde6ec627-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pwd'}, 'id': 'f5fa4624-a61c-49d5-b5f2-b2c958e67b3c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6172, 'output_tokens': 5, 'total_tokens': 6257, 'input_token_details': {'cache_read': 8360}, 'output_token_details': {'reasoning': 80}}
2025-10-06 05:13:15,332 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: pwd
2025-10-06 05:13:15,433 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:15,433 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

/testbed/tests

2025-10-06 05:13:18,044 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd .. && cat <<\'EOF\' > tests/custom_settings.py\\nfrom test_sqlite import *\\n\\nINSTALLED_APPS = [\\n    \'django.contrib.auth\',\\n    \'django.contrib.contenttypes\',\\n    \'backends\',\\n]\\nEOF"}'}, '__gemini_function_call_thought_signatures__': {'1da0557f-8762-40fc-95f2-49f449e15629': 'Ct8EAR/MhbYFG9BOFtvdWTfoKcFsAD/z3Cpl+Jl5pLJvemMyTiVLrY3VKCKY9cTjpmzKu/vH+G0EtSopYmAuVYHNrLj9yPy3JOpGnWBtmZ5mGEVx96+2Xk4BVfe15qHPWIbZ6ky6l/dcq8U4tb1jdECQVfliDcWlKveYiZTU9FnloRn0GcPFEJDhsadTxUbFRJfRMA7knJ5Fd3UmWBme8WoUjlludnq7f+xNukG9IF73Au9y17vMD2nIKPa60gJTXvtw9vDHP6gHZnwgk0QaQz+icU0F9lnrM0Al718Tsg0RMy5BF797pKpujwYTSiEi9BVuyLOSiW2bE+aPTDXIktZ32UPKXRImRgyBhXKjyLWbIOUGu2zzyMCuvjSFABsXTCs6nskZnYc/8Kear17bp32Ou693KjOxU3Vaan0KZ6mEoFJ472JoHQj8I9m+LAZFI9wUujRdZoYoyiR2THEpFqtVQBGm7Ly10ygn3HoIqsCr9P8ngt8MJXQXcGENMi7K7lTeZ7wJRXQNu/OrXDQkBgJSz6qs5BM/7LuKvH7nmLG8ow7Xe70Psyi3PA+geoJ8WMzHV7tx7WOhOqYYkjIjQIjm/gzZ8U9xvQFRmLiChJyLOH3SG7sUglhwIyZOZOD9v8wz2Zc7Xx+X80z56aE+LHJj5+1W5TX/Y8XDtDgz77x1JIHflHrd4OSYRt/6fTjYWKQQvB45ob9nSRtDT3wAl5ECwprvvgG07GU1R5gMZ39QbD5jGJiGo4hqeMUQJTKpziF4HPUt6ypeY/2qsbfT1EZrcANeflcVHlkcuMs0PwT7GwoiAR/Mhbaid1yc7iV5Jl6CNlzn/9NOjN/fapBabQRaVUn9wA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6188, 'candidates_token_count': 61, 'total_token_count': 6415, 'cached_content_token_count': 8349, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9603}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8349}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 61}], 'thoughts_token_count': 166}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2275662187670098, 'model_name': 'gemini-2.5-pro'} id='run--8703ec3d-ab4e-4d63-b8dd-c2eff9fa0350-0' tool_calls=[{'name': 'run_command', 'args': {'command': "cd .. && cat <<'EOF' > tests/custom_settings.py\nfrom test_sqlite import *\n\nINSTALLED_APPS = [\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'backends',\n]\nEOF"}, 'id': '1da0557f-8762-40fc-95f2-49f449e15629', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6188, 'output_tokens': 61, 'total_tokens': 6415, 'input_token_details': {'cache_read': 8349}, 'output_token_details': {'reasoning': 166}}
2025-10-06 05:13:18,046 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd .. && cat <<'EOF' > tests/custom_settings.py
from test_sqlite import *

INSTALLED_APPS = [
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'backends',
]
EOF
2025-10-06 05:13:18,146 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:18,146 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
cd .. && cat <<'EOF' > tests/custom_settings.py

> from test_sqlite import *

> 

> INSTALLED_APPS = [

>     'django.contrib.auth',

>     'django.contrib.contenttypes',

>     'backends',

> ]

> EOF


2025-10-06 05:13:19,774 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'44ceaf63-eef1-45bf-8454-d66af993aa9e': 'Cv8BAR/MhbbJGBF8dVCTyt0a4xvZwzY9+wqpFbFar6oDba24zVP/87cuf++FTcj4wnRMb2TX9D5L5ChIGLmkq/iaFDokWk+o8I6LRZP2xJ8fxEg32cF/+JUri4/6T1CbXks1ABGnwf+mN8+/rsyRU1qSHv2u3dg6twcLA/floKhZTXIDY2jnF7XkIHOtykAu4CC4FxiRUsd81NS5LIqzlxQGDHpXxJjiy6AyG5qAFpwrx1MGhOO1EFOjBtvuUT1oSZ4tojkcMgjbtvAIjRLAfNIdR2G75xntXO9sBLBJz91ekT0KxZjivkqScaC/zqoHvrMHcwKoMeG4TvllJg+MVD0RCiIBH8yFtmBYH18QJzMVdxPXTWremLdS02g4vkgQXgkG7MW9'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6322, 'candidates_token_count': 26, 'total_token_count': 6412, 'cached_content_token_count': 8350, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9901}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8350}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 64}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0841824274796706, 'model_name': 'gemini-2.5-pro'} id='run--ca2d939d-e707-428e-9c6a-420157bfdbda-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush'}, 'id': '44ceaf63-eef1-45bf-8454-d66af993aa9e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6322, 'output_tokens': 26, 'total_tokens': 6412, 'input_token_details': {'cache_read': 8350}, 'output_token_details': {'reasoning': 64}}
2025-10-06 05:13:19,775 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush
2025-10-06 05:13:20,218 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:20,218 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Creating test database for alias 'default'...
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_execute_sql_flush_signature_simplified (backends.test_sql_flush.SqlFlushSignatureTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/backends/test_sql_flush.py", line 17, in test_execute_sql_flush_signature_simplified
    Book.objects.create(author=author, title='1984')
  File "/testbed/django/db/models/manager.py", line 85, in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
  File "/testbed/django/db/models/query.py", line 444, in create
    obj = self.model(**kwargs)
  File "/testbed/django/db/models/base.py", line 501, in __init__
    raise TypeError("%s() got an unexpected keyword argument '%s'" % (cls.__name__, kwarg))
TypeError: Book() got an unexpected keyword argument 'title'

----------------------------------------------------------------------
Ran 1 test in 0.011s

FAILED (errors=1)
Destroying test database for alias 'default'...

2025-10-06 05:13:22,172 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/backends/test_sql_flush.py"}'}, '__gemini_function_call_thought_signatures__': {'1213f7bc-2caf-40d0-bdff-9d7c62ae6df5': 'CuoCAR/Mhbbgj839XtxidyOaQhfClYPbtGJJNvE5gIo33g7Rcp2behlIb+agt2TmE668pdrrQbzAHxNHFEsCG+MiG6538czkleO46P2sdx7p5lkGk5Tx6Kgk4dHpGW1GZ4FnBGwNgW2kEcB5CdF0kq9M/8Jc9Czy8gQSyNFdBXsq494NqHHEY1z6q04Q9lPS//e8N6EqtjeJPKwW7hfHuznhKyPyy633FFrVp9nKIzEI3bohxwqBcsVPHh8IO70EGEXe8Js5itpC11eFyUQmKNkE1AieblbHL4HgBMshxqMdBBgZotV8xRafjt8X/KipYnTwnxFS14KYQlCNSoWBLZgVbvwjdVx3XvU5sysaxfg0faIugq6d+zk2smQgyRL37jxSCmPgdbgq5IcOHGx2+bOAf++9wEnlnY//njnAAJeVafFhrvLQl/h5sQ7Lp7/UsSupPRoVfEPBp/JqSZsUyiYY87jdT4gvc1zk0kA='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6675, 'candidates_token_count': 16, 'total_token_count': 6781, 'cached_content_token_count': 8369, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10316}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8369}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 16}], 'thoughts_token_count': 90}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0338735580444336, 'model_name': 'gemini-2.5-pro'} id='run--3e5bed7f-36e8-437a-b913-33e84fb00d20-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/backends/test_sql_flush.py'}, 'id': '1213f7bc-2caf-40d0-bdff-9d7c62ae6df5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6675, 'output_tokens': 16, 'total_tokens': 6781, 'input_token_details': {'cache_read': 8369}, 'output_token_details': {'reasoning': 90}}
2025-10-06 05:13:22,174 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/backends/test_sql_flush.py
2025-10-06 05:13:22,275 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:22,275 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

cat: tests/backends/test_sql_flush.py: No such file or directory

2025-10-06 05:13:24,012 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd .. && cat tests/backends/test_sql_flush.py"}'}, '__gemini_function_call_thought_signatures__': {'b17a2b48-17aa-488f-ba6b-f860cbbc6b59': 'Cs8CAR/MhbbUOXsG2XKCuGfIKoh7WKL9ggKbYlG7XEYDEJIlv9z1TyolSr0OaTnP8yGX3TS0JkcXkzADDoQ44gHhOUC74XfsV6Bh5xBuZ+IBOO4hZOz9f5xJwEFH3pNQmtbg7pIHu75aMy/5htrGXBBEPDsBIPGF0/ZCGOthNcIJmFDCZ8f0ixjyqcQ5A7/MM3AYktb12Ap4Mpn/YKIA/O+6R0/N50/6l1K8Ox7Dj8+USottzMh2Rs40deF+ZMNpkw2vRygHDg2gCXig/QF8VhxbySUW98Zna1A2zOV0Gx+vpSiRCR0ne6qs2QHf/btOoBOY3mv8U38XehDF1lLzUFpt7wmY65gG1U2GYUW1RR2ZxxaiPvA6ogOJ9wzdALnorm8Wth88gUOLVaPReFaR30iql+yoc9WhMbX4w7osHAW7WRFD6+JeqgNH0R3YjYrywVw='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6716, 'candidates_token_count': 19, 'total_token_count': 6821, 'cached_content_token_count': 10036, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10445}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10036}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 19}], 'thoughts_token_count': 86}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2916066019158614, 'model_name': 'gemini-2.5-pro'} id='run--4da85848-04b7-429d-b84e-85016612cc80-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cd .. && cat tests/backends/test_sql_flush.py'}, 'id': 'b17a2b48-17aa-488f-ba6b-f860cbbc6b59', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6716, 'output_tokens': 19, 'total_tokens': 6821, 'input_token_details': {'cache_read': 10036}, 'output_token_details': {'reasoning': 86}}
2025-10-06 05:13:24,013 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd .. && cat tests/backends/test_sql_flush.py
2025-10-06 05:13:24,114 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:24,114 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

from django.core.management.color import no_style
from django.db import connection
from django.test import TransactionTestCase

from backends.models import Author, Book


class SqlFlushSignatureTest(TransactionTestCase):
    available_apps = ['backends']

    def test_execute_sql_flush_signature_simplified(self):
        """
        Test that execute_sql_flush() can be called without the `using`
        argument.
        """
        author = Author.objects.create(name='George Orwell')
        Book.objects.create(author=author, title='1984')

        sql_list = connection.ops.sql_flush(
            no_style(),
            [Author._meta.db_table, Book._meta.db_table],
            allow_cascade=True,
        )
        # This call will raise a TypeError before the signature is changed to
        # accept a single argument.
        connection.ops.execute_sql_flush(sql_list)

        self.assertFalse(Author.objects.exists())
        self.assertFalse(Book.objects.exists())

2025-10-06 05:13:26,097 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/backends/models.py"}'}, '__gemini_function_call_thought_signatures__': {'b4a69978-5dea-4e2e-a8a6-0715f95f0c98': 'CpAEAR/MhbZCkaE4UI8vjj/TXGAcllBg6jw1qvw+qONP3zkf6gHdyPxz+XvVuRnYmC6i68byyCM3i4ZZxxhdp3tTlNFrEH+dECXYEvz/KOuReILCob9UqUBySjSwSZ+QcNV7+PyIfkVfQ/n+o7e83h3bCPKCdU1uhllG0V7Z3pAKxAQKvTU66CckhMYixP8q73GNMTj6GUywp6njWfQezvishn/buokoXTrlyE1Ew57n1R7xZsJ+J5AowJ+oNZGhpo5h1hasALpZetMFKWgxeYG0alud90C0I+qfT2VQW/oRRfwvZNtihDbKjYwiJxD7IqnkA7JpLHtX2sjWKKHj7BUZ9kQtQuitXO+DUpn8v9DBevZO7HPf/Ag4/ACM6N8f6Mv2NkldKwhaiMRpH02IKl91ZJmTxl3usPS850iyeA6CeSt5K+yJzwIcRIuAlEek8CUGysfidXPN0bNpURknNfpZg4qJO6r3hzvNKR/9ZnBgf/RfVsKhkdJqMy7gYTp/KLSrOAPuHiTAtz88kg7Q12jbzP70nziHp3Xrt73ChxkALjwHOvJqbINdX1d2ipo5QDuM7WsOlhGj8665osb83nYStNk7G09SB8XROcXITZCfYVEmghyowcgUpbuaQBZ2v3JE+nHAX+CF53tuTTh9NV+Xy9tkOHqmZhTV29tBJ9qXSevdiBmoCVFJPNggD6x8BLXK'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6989, 'candidates_token_count': 12, 'total_token_count': 7139, 'cached_content_token_count': 10042, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10802}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10042}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 12}], 'thoughts_token_count': 138}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8453556696573893, 'model_name': 'gemini-2.5-pro'} id='run--e99ad65b-12a1-4995-b671-5277a486f6e5-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/backends/models.py'}, 'id': 'b4a69978-5dea-4e2e-a8a6-0715f95f0c98', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6989, 'output_tokens': 12, 'total_tokens': 7139, 'input_token_details': {'cache_read': 10042}, 'output_token_details': {'reasoning': 138}}
2025-10-06 05:13:26,099 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/backends/models.py
2025-10-06 05:13:26,200 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:26,200 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

from django.contrib.contenttypes.fields import (
    GenericForeignKey, GenericRelation,
)
from django.contrib.contenttypes.models import ContentType
from django.db import models


class Square(models.Model):
    root = models.IntegerField()
    square = models.PositiveIntegerField()

    def __str__(self):
        return "%s ** 2 == %s" % (self.root, self.square)


class Person(models.Model):
    first_name = models.CharField(max_length=20)
    last_name = models.CharField(max_length=20)

    def __str__(self):
        return '%s %s' % (self.first_name, self.last_name)


class SchoolClass(models.Model):
    year = models.PositiveIntegerField()
    day = models.CharField(max_length=9, blank=True)
    last_updated = models.DateTimeField()


class VeryLongModelNameZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZZ(models.Model):
    primary_key_is_quite_long_zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz = models.AutoField(primary_key=True)
    charfield_is_quite_long_zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz = models.CharField(max_length=100)
    m2m_also_quite_long_zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz = models.ManyToManyField(Person, blank=True)


class Tag(models.Model):
    name = models.CharField(max_length=30)
    content_type = models.ForeignKey(ContentType, models.CASCADE, related_name='backend_tags')
    object_id = models.PositiveIntegerField()
    content_object = GenericForeignKey('content_type', 'object_id')


class Post(models.Model):
    name = models.CharField(max_length=30)
    text = models.TextField()
    tags = GenericRelation('Tag')

    class Meta:
        db_table = 'CaseSensitive_Post'


class Reporter(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)

    def __str__(self):
        return "%s %s" % (self.first_name, self.last_name)


class ReporterProxy(Reporter):
    class Meta:
        proxy = True


class Article(models.Model):
    headline = models.CharField(max_length=100)
    pub_date = models.DateField()
    reporter = models.ForeignKey(Reporter, models.CASCADE)
    reporter_proxy = models.ForeignKey(
        ReporterProxy,
        models.SET_NULL,
        null=True,
        related_name='reporter_proxy',
    )

    def __str__(self):
        return self.headline


class Item(models.Model):
    name = models.CharField(max_length=30)
    date = models.DateField()
    time = models.TimeField()
    last_modified = models.DateTimeField()

    def __str__(self):
        return self.name


class Object(models.Model):
    related_objects = models.ManyToManyField("self", db_constraint=False, symmetrical=False)
    obj_ref = models.ForeignKey('ObjectReference', models.CASCADE, null=True)

    def __str__(self):
        return str(self.id)


class ObjectReference(models.Model):
    obj = models.ForeignKey(Object, models.CASCADE, db_constraint=False)

    def __str__(self):
        return str(self.obj_id)


class ObjectSelfReference(models.Model):
    key = models.CharField(max_length=3, unique=True)
    obj = models.ForeignKey('ObjectSelfReference', models.SET_NULL, null=True)


class CircularA(models.Model):
    key = models.CharField(max_length=3, unique=True)
    obj = models.ForeignKey('CircularB', models.SET_NULL, null=True)

    def natural_key(self):
        return (self.key,)


class CircularB(models.Model):
    key = models.CharField(max_length=3, unique=True)
    obj = models.ForeignKey('CircularA', models.SET_NULL, null=True)

    def natural_key(self):
        return (self.key,)


class RawData(models.Model):
    raw_data = models.BinaryField()


class Author(models.Model):
    name = models.CharField(max_length=255, unique=True)


class Book(models.Model):
    author = models.ForeignKey(Author, models.CASCADE, to_field='name')

2025-10-06 05:13:30,350 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "sed -i \\"s/, title=\'1984\'//g\\" tests/backends/test_sql_flush.py"}'}, '__gemini_function_call_thought_signatures__': {'cdc94101-53d6-488f-8846-1327c9b6152c': 'CrYJAR/MhbasA9cbr8cQaU31Jj/mPrHRmg1dDOKs/eCHb6lnisTOQLw3nf2J9Vpi0iZCf4S1WqP2/HoMcFDFwJgmr2enOWLllL9L1MRoOwD8QPag3BNgJwQ/2b5ZmJDeJQQzxMZ4o6EjAGtjBaUEUJuEkQWZC7LQbZvj4ljfXNQuyDcMTl6vv1miEda4OnfQynYzATH5CinuoqEAQ61WjSyheIqJLzpgRM/qSefj5WsFs+vD6a5kHPBn4goUvZwBvfQWNZNqqOlR70rnyqvLLNlzCCitytT6vt1P30IaskPTslVeXVSL4Nvp2qVrWV38w2X68PmurPXzm9EqwDSNbVzeSEueVlWGEwVBcJxguRRxY9coytbe+gnGGoGbyMUa1qtFHeYNMltRmcpOKNnAp655jOvGXVYmGXS3kFi8b1lRXABJcc7qV0FR/HMVIQhKuBR5NfcKuF5GOEXDOIj5RfxYjBQ/yioEqvpY5GfLo4CNitwSOyUQ0uzbbDKFlAfVkMQ7mFCXWb4k+R4MsGBgZ3BHKuwrEoMJTEBr3tKYRIxtwFqfFfyycc/yO5nJQgXZL8f9elEkDK83fxQnft0vtUDlW/YfRGPNGeNlCebC3Oa5Ng3YMHitgeQ0rYSCYxqrf0EkC9eDmD2kJ0tiBEF8pN5sIM+SIXA3/jMFbph8ucx4B7zvz6RR3Bo5enl4+FYWBwvOppgxTtwMWAgBg3E0U6osx11C/yoAScpLkgy6oncruExlWLvEmlX5pC1dEGMD/aLkWqC34KDy3BslDS2MzgdfOAFLEMa3XoyqEPXX2Jy69z98t6udutYLfF63leAR+o9tJqvWxnNYynnE5yMWFDKARG5wMFvxLybJ8JYxJNmTfCqyOuDOSfWkzR6GLCSNbRg01+0OLEN+MoB57Yz38D9jb6hULVeTE66UlWpILtn76tGZPsCr8BErE5EdBeXgLYGjAqxrLP9vDargiHno6e7U5HFxjxWHeQrVT8hhLtWDDlORycrbTRlEpz/0hrTvemT3MNEFmnbnShD6a2r4fX59TmMFcXtbwQ4zbGAf7Z2MDDKW8wuuB+Ll2jwjQF0zbMX0jBIwLf2D9POXQcj0tix0zc5Tprrczlt1Kko6zB/dnkS0L3gS36xvD0jSiSSw1eEOYa297wnPH2XlheUFsztyyf0JQl8VUBXISASxwoq6WzgCdrtXUGmn7F87XLm6f+PeQhtRzsu+coG3gKA9Vvfv0PhEtdmffIYiZdD2CbtGA/lZi0Y3Hal6jG6jJ/qpNFENnClDmZQIJPkAPtfozb5QQLdw1WFUWaWaEchqtFrGB6mR9q1Yeie+EzX9k3xTS7ebKfvAyOkUUYuN2vQaYjWo+qFVhpt+WSXzOt/cMS6D7LZcdJdy4X5jOtqua/DfttXkRTrEY1l75MaNf5yZaVJQXl2200JA7NKj4CvBRbkbl1zg8wM+niOC/5tR6PIj5RYCeivE2b5oCAl27bUxfIdDnUYUfEJFbj7nL2vlOGyq6Ft1z74R8rFzFjv0UxJabJRce2wVw+oIX9utQFI9b9hjMIbV0yKT97iQV3ZsqXH729F0SWXGV0C9JGqRYcEAyGwBuaYWEnyGCiIBH8yFtgR8H9gjRelDqL2p8T98kNSYmc1DJNqx33QcDH3R'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8107, 'candidates_token_count': 31, 'total_token_count': 8501, 'cached_content_token_count': 10099, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12056}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10099}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 363}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8451931861139113, 'model_name': 'gemini-2.5-pro'} id='run--68e355f1-2e45-4cb5-801f-19d4a7eba2ea-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'sed -i "s/, title=\'1984\'//g" tests/backends/test_sql_flush.py'}, 'id': 'cdc94101-53d6-488f-8846-1327c9b6152c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8107, 'output_tokens': 31, 'total_tokens': 8501, 'input_token_details': {'cache_read': 10099}, 'output_token_details': {'reasoning': 363}}
2025-10-06 05:13:30,352 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: sed -i "s/, title='1984'//g" tests/backends/test_sql_flush.py
2025-10-06 05:13:30,453 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 05:13:30,453 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 05:13:32,212 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'a3e97278-2f53-45ca-86d0-48dd15fa2685': 'CoYDAR/MhbZSRNoHg0ivMpvmCctEZCzJhPByPcGtGQGnBgjNHOhoYYSMnKMq0sYu8JYIq47JgFCbzdGEZkqoE2z0qLPIVgpEEqXlFud3/fsQ1bGdcbBeoJYAzOCZSy/DjxBA+M751/B8/i8XzBZgUCD1Beg3SMqr2HJig051ZMyX8MnMfLAu8nRw9pZ10wo4vuTfTlNxI944Qbb+PT/lMaxjd5i+PaobC+SH2zuoEaDGSap9u4StE/8Aq3qKzvZe0ACosdMsaQzJRy/X1G5T7Mzo8uxLl6lhD4T+vjrKX4BHe3UHrjNDZeZWi2oXtJ+I4DNiCZ0Ys9pkjhSkhhQ2EI4gCyKr2v7SCOijtbXbqt1csvzc1DkJl3GvAEsLY8uxNR9eYwBFKpDkCXkhAOpg8ehpjjVYeWAWc71u9ahnZIw2Wy1HlDJhtVmSKEgVuhd2uzPPw6lP7Uf1vPZRjqX3SjiWmP/jLCuxQOgez4SdrSiciyFzu2XRhhfbz1yRZ+zijfxotHBaQZ7C'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8143, 'candidates_token_count': 26, 'total_token_count': 8274, 'cached_content_token_count': 11821, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12453}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11821}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 105}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2549914580125075, 'model_name': 'gemini-2.5-pro'} id='run--8186a517-5063-4f52-bcf6-45eaeb52458a-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush'}, 'id': 'a3e97278-2f53-45ca-86d0-48dd15fa2685', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8143, 'output_tokens': 26, 'total_tokens': 8274, 'input_token_details': {'cache_read': 11821}, 'output_token_details': {'reasoning': 105}}
2025-10-06 05:13:32,214 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush
2025-10-06 05:13:32,619 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:32,619 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Creating test database for alias 'default'...
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_execute_sql_flush_signature_simplified (backends.test_sql_flush.SqlFlushSignatureTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/backends/test_sql_flush.py", line 26, in test_execute_sql_flush_signature_simplified
    connection.ops.execute_sql_flush(sql_list)
TypeError: execute_sql_flush() missing 1 required positional argument: 'sql_list'

----------------------------------------------------------------------
Ran 1 test in 0.010s

FAILED (errors=1)
Destroying test database for alias 'default'...

2025-10-06 05:13:36,443 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='I have executed the test file as requested. Here is the output:\n\n' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8370, 'candidates_token_count': 41, 'total_token_count': 8694, 'cached_content_token_count': 11834, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12783}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11834}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 41}], 'thoughts_token_count': 283}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5760047726514863, 'model_name': 'gemini-2.5-pro'} id='run--63cd2957-031b-4da4-bba7-6e933c6fd524-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush'}, 'id': '59efb44c-ea28-4b32-9291-5bcc84a7b84b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8370, 'output_tokens': 41, 'total_tokens': 8694, 'input_token_details': {'cache_read': 11834}, 'output_token_details': {'reasoning': 283}}
2025-10-06 05:13:36,445 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush
2025-10-06 05:13:36,546 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:36,546 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

bash: cd: tests: No such file or directory

2025-10-06 05:13:38,642 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cd /testbed && cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush"}'}, '__gemini_function_call_thought_signatures__': {'191887c2-03a9-4485-b86a-4afde1e2000f': 'CtkCAR/MhbYYPOUCPH0Gx2GiJPVio1NM8P02oYby3m+H2Q/3SZON1Oz/amVTcbGgFJ0IQR9m/0UEL0bsD2UiQ21yTLuykgsJGQV7bv3JfG6eL2fG8TAxUzxewYeMRiLekN8m/5q92ztf5WrEpoljkMqfoARhZinngIp6V7taQoSQi5Zhila7FizP7kza//L2Y61E/3OOUBXrTGe+ZzKWZBKrK9sXrij0CUPK+EvkwHVMCn6dT0QvjZ8/Hdyat5puwKnkRT8Jzv0IvD9ZQY776D+9mm+t1WPQLxF1xVPnnD8oj+E0AGfgOpjtJ6VK2br/aYRBeHuyaOtpZo4h2WSAZ1hPPF8edph97Z3WIIa7kbNChI9dGx5/BJM1U3HIgiag+vZV5cLhqGDuyo+TrQhqVovKuUTmcOsJhlisOhK0tY9Eeo+VWyjoUNaWRSTFY72rIb4XCHzaCd6VmH6r'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8428, 'candidates_token_count': 31, 'total_token_count': 8534, 'cached_content_token_count': 11818, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12841}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11818}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 75}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3817586898803711, 'model_name': 'gemini-2.5-pro'} id='run--7ed310b5-3b77-4582-a339-42c7f6b777cc-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cd /testbed && cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush'}, 'id': '191887c2-03a9-4485-b86a-4afde1e2000f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8428, 'output_tokens': 31, 'total_tokens': 8534, 'input_token_details': {'cache_read': 11818}, 'output_token_details': {'reasoning': 75}}
2025-10-06 05:13:38,643 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cd /testbed && cd tests && python runtests.py --settings=custom_settings backends.test_sql_flush
2025-10-06 05:13:39,047 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 05:13:39,047 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Creating test database for alias 'default'...
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_execute_sql_flush_signature_simplified (backends.test_sql_flush.SqlFlushSignatureTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/backends/test_sql_flush.py", line 26, in test_execute_sql_flush_signature_simplified
    connection.ops.execute_sql_flush(sql_list)
TypeError: execute_sql_flush() missing 1 required positional argument: 'sql_list'

----------------------------------------------------------------------
Ran 1 test in 0.010s

FAILED (errors=1)
Destroying test database for alias 'default'...

2025-10-06 05:13:40,127 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='I have executed the test file as requested. Here is the output:\n' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8660, 'candidates_token_count': 15, 'total_token_count': 8675, 'cached_content_token_count': 11827, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13146}], 'cache_tokens_details': [{'modality': 1, 'token_count': 11827}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 15}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.06363573869069418, 'model_name': 'gemini-2.5-pro'} id='run--fdfa87f8-5fa7-4ad6-bdea-2d8fc709e452-0' usage_metadata={'input_tokens': 8660, 'output_tokens': 15, 'total_tokens': 8675, 'input_token_details': {'cache_read': 11827}}
2025-10-06 05:13:59,482 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='FAILED (errors=1)\nERROR: test_execute_sql_flush_signature_simplified (backends.test_sql_flush.SqlFlushSignatureTest)\nTraceback (most recent call last):\n  File "/testbed/tests/backends/test_sql_flush.py", line 26, in test_execute_sql_flush_signature_simplified\n    connection.ops.execute_sql_flush(sql_list)\nTypeError: execute_sql_flush() missing 1 required positional argument: \'sql_list\'' reproduced_bug_commands=['python tests/runtests.py backends.test_sql_flush.SqlFlushSignatureTest --settings=custom_settings']
2025-10-06 05:13:59,483 - thread-139660780025408.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-10-06 05:13:59,483 - thread-139660780025408.app.docker.base_container - INFO - Closing persistent shell...
2025-10-06 05:13:59,584 - thread-139660780025408.app.docker.base_container - INFO - Cleaning up container and temporary files
