2025-10-06 03:25:43,900 - thread-139660780025408.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmp4409tmbv/django
2025-10-06 03:25:43,900 - thread-139660780025408.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-10-06 03:25:43,900 - thread-139660780025408.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.django_1776_django-12713:v1
2025-10-06 03:26:09,430 - thread-139660780025408.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_0ad6132010
2025-10-06 03:26:09,435 - thread-139660780025408.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_0ad6132010
2025-10-06 03:26:10,466 - thread-139660780025408.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-10-06 03:26:10,613 - thread-139660780025408.app.docker.base_container - INFO - Persistent shell is ready
2025-10-06 03:26:10,613 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-10-06 03:26:10,738 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:10,738 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:26:10,738 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-10-06 03:26:10,862 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:10,862 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:26:10,862 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: sed -i '/en_US.UTF-8/s/^# //g' /etc/locale.gen && locale-gen
2025-10-06 03:26:12,314 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:12,314 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
sed -i '/en_US.UTF-8/s/^# //g' /
/etc/locale.gen && locale-gen

Generating locales (this might take a while)...
  en_US.UTF-8... done
Generation complete.

2025-10-06 03:26:12,314 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export LANG=en_US.UTF-8
2025-10-06 03:26:12,415 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:12,415 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:26:12,415 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export LANGUAGE=en_US:en
2025-10-06 03:26:12,516 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:12,516 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:26:12,516 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export LC_ALL=en_US.UTF-8
2025-10-06 03:26:12,617 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:12,617 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:26:12,617 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .
2025-10-06 03:26:13,800 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:26:13,800 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Obtaining file:///testbed
Requirement already satisfied: asgiref>=3.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.1) (3.4.1)
Requirement already satisfied: pytz in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.1) (2024.2)
Requirement already satisfied: sqlparse>=0.2.2 in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from Django==3.1) (0.4.4)
Requirement already satisfied: typing-extensions in /opt/miniconda3/envs/testbed/lib/python3.6/site-packages (from asgiref>=3.2->Django==3.1) (4.1.1)
Installing collected packages: Django
  Attempting uninstall: Django
    Found existing installation: Django 3.1
    Uninstalling Django-3.1:
      Successfully uninstalled Django-3.1
  Running setup.py develop for Django
Successfully installed Django-3.1
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m

2025-10-06 03:26:13,858 - thread-139660780025408.app.lang_graph.nodes.issue_bug_reproduction_context_message_node - DEBUG - Sending query to context provider subgraph:
Issue title:
Allow overridding widget in formfield_for_manytomany().

Issue description: 
Description
	 
		(last modified by Mariusz Felisiak)
	 
It does not work when I set widget param to function formfield_for_manytomany().
This is different from the formfield_for_foreignkey() function.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-10-06 03:26:13,858 - thread-139660780025408.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Enter context retrieval subgraph
2025-10-06 03:26:13,859 - thread-139660780025408.app.lang_graph.nodes.context_query_message_node - DEBUG - Sending query to ContextProviderNode:
content='Issue title:\nAllow overridding widget in formfield_for_manytomany().\n\nIssue description: \nDescription\n\t \n\t\t(last modified by Mariusz Felisiak)\n\t \nIt does not work when I set widget param to function formfield_for_manytomany().\nThis is different from the formfield_for_foreignkey() function.\n\nIssue comments:\n\n\nOBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,\nincluding ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.\n\n<reasoning>\n1. Analyze bug characteristics:\n   - Core functionality being tested\n   - Input parameters and configurations\n   - Expected error conditions\n   - Environmental dependencies\n\n2. Search requirements:\n   - Required imports and dependencies\n   - Test files exercising similar functionality\n   - Mock/fixture setup patterns\n   - Assertion styles\n   - Error handling tests\n\n3. Focus areas:\n   - All necessary imports (standard library, testing frameworks, mocking utilities)\n   - Dependencies and third-party packages\n   - Test setup and teardown\n   - Mock object configuration\n   - Network/external service simulation\n   - Error condition verification\n</reasoning>\n\nREQUIREMENTS:\n- Return 5 complete, self-contained test cases most similar to bug scenario\n- Must include ALL necessary imports at the start of each test file\n- Must include full test method implementation\n- Must include ALL mock/fixture setup\n- Must include helper functions used by test\n- Must preserve exact file paths and line numbers\n\n<examples>\n<example id="database-timeout">\n<bug>\ndb.execute("SELECT * FROM users").fetchall() \nraises ConnectionTimeout when load is high\n</bug>\n\n<ideal_test_match>\n# File: tests/test_database.py\nimport pytest\nfrom unittest.mock import Mock, patch\nfrom database.exceptions import ConnectionTimeout\nfrom database.models import QueryResult\nfrom database.client import DatabaseClient\n\nclass TestDatabaseTimeout:\n    @pytest.fixture\n    def mock_db_connection(self):\n        conn = Mock()\n        conn.execute.side_effect = [\n            ConnectionTimeout("Connection timed out"),\n            QueryResult(["user1", "user2"])  # Second try succeeds\n        ]\n        return conn\n        \n    def test_handle_timeout_during_query(self, mock_db_connection):\n        # Complete test showing timeout scenario\n        # Including retry logic verification\n        # With all necessary assertions\n</ideal_test_match>\n</example>\n\n<example id="file-permission">\n<bug>\nFileProcessor(\'/root/data.txt\').process() \nfails with PermissionError\n</bug>\n\n<ideal_test_match>\n# File: tests/test_file_processor.py\nimport os\nimport pytest\nfrom unittest.mock import patch, mock_open\nfrom file_processor import FileProcessor\nfrom file_processor.exceptions import ProcessingError\n\nclass TestFilePermissions:\n    @patch(\'os.access\')\n    @patch(\'builtins.open\')\n    def test_file_permission_denied(self, mock_open, mock_access):\n        # Full test setup with mocked file system\n        # Permission denial simulation\n        # Error handling verification\n</ideal_test_match>\n</example>\n\nSearch priority:\n1. Tests of exact same functionality (including import patterns)\n2. Tests with similar error conditions\n3. Tests with comparable mocking patterns\n4. Tests demonstrating similar assertions\n\nFind the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.\n' additional_kwargs={} response_metadata={}
2025-10-06 03:26:20,882 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I will begin by searching for mentions of `formfield_for_manytomany` within test files to locate relevant test cases. If this initial search is not fruitful, I will broaden my approach to include tests related to `formfield_for_foreignkey` and general widget overriding within the Django admin to find analogous examples. My goal is to identify five complete and self-contained test cases that demonstrate similar functionality.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "formfield_for_manytomany", "basename": "tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55794, 'candidates_token_count': 115, 'total_token_count': 56241, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55794}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 115}], 'thoughts_token_count': 332, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.37882620769998304, 'model_name': 'gemini-2.5-pro'} id='run--e3dfa5e9-aad4-4c1e-aa3f-948400f53308-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'formfield_for_manytomany', 'basename': 'tests.py'}, 'id': '71de1029-4ef2-45c2-8ddf-bf08134fbc6c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 55794, 'output_tokens': 115, 'total_tokens': 56241, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 332}}
2025-10-06 03:26:24,247 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_ordering/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'f9cfa39b-00eb-4b68-bbc5-8f3d743c0958': 'CpcEAR/Mhba0/Gi++lfkFhRx7UH41azbiLvJuQ/dsZ6QhOyN4F7n9RKbxNYirErIhyydtaXirF83JaZDmN03TM8JeqiCGpZ9Nj5NmG+UF7b/X1OCVWFOMwEgl5bRx/pH7m2SADtihw438u4EpWK4yXK7eme63Fnov8vQn5bDW8nbEuZAbVK2OFvgIVvT60A7oo4FpY8lRYLp/FSsO+0B+KTYTb8CDa2xQxh6vofLL5UXtoyHqPotfpNHK2aFG8HwN9L2+YP68iD/0ogtEMcOQsNGZGEsQim851EjfH660+9OcnZlGZZqcomBfIP+XA1+r+LE9O0isBWTzgMx0kky/Er4Rf3s1a8zEsBmr/XNYkMGb1WdZhtw0rJj+z46XbXlApo2bNcbHfWNC88HCPxotCKiK9vZUA1og9N8CdSO+1eoy4B7hr2QzDWZsZQBx7zy5lmDL1l/VfgDrYdT2PxN/ROv0zworKE3dvBs9YTmfKDSJIhFmylO8tHjA0iHHRUJWD3nMlhw801C5NQq7pKHacnr5QNr+HAaGn1GvmZ9++wDe1K59UAnOfip0NsI6CLwNcHRINOwl06C+Uwt5F5T03LXjXlDksptnQMo+x/gHT4c9ZHiN0FSpIyHu2U9o3YbbXWDdvKOQBvLH3c2k+eFSiaxgxNhzslLoUefvJcOXnwGDzMHZFabMpYMX3jRqy0qjAHp/sWtZPhlcA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 56899, 'candidates_token_count': 23, 'total_token_count': 57043, 'cached_content_token_count': 54205, 'prompt_tokens_details': [{'modality': 1, 'token_count': 56899}], 'cache_tokens_details': [{'modality': 1, 'token_count': 54205}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 23}], 'thoughts_token_count': 121}, 'finish_reason': 'STOP', 'avg_logprobs': -0.48251301309336786, 'model_name': 'gemini-2.5-pro'} id='run--615f12c7-a579-4a97-8b0b-a0ffad2982d0-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_ordering/tests.py'}, 'id': 'f9cfa39b-00eb-4b68-bbc5-8f3d743c0958', 'type': 'tool_call'}] usage_metadata={'input_tokens': 56899, 'output_tokens': 23, 'total_tokens': 57043, 'input_token_details': {'cache_read': 54205}, 'output_token_details': {'reasoning': 121}}
2025-10-06 03:35:03,762 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "formfield_for_manytomany", "basename": "tests.py"}'}, '__gemini_function_call_thought_signatures__': {'e35215b3-8b8e-4cb4-9d1b-0c37730add38': 'CqMDAR/MhbbPKIffFDflZVKViuhmVm1ohxEEPrtAg/Sb+azf3HbJxJtKfYAjelToQpCz9RYJzzqLpSqg32CQxU4KPmBBjJ/QouMejFfOvl0jMDsaUTOQOjwRypcX9uPtmaCK9IcR3DtZR8ShOMFbeJ8unchIPBF6qGExPVsFlys0K2PSXRJiaFI0IeC7P7zGgy2lAGSgEnGBkZnhG/oAqXx15gTyOxYH/dnTe6xsEVey7U2MCw2yqMLuud0CNcErMMzrE04q8mA0XLqkv+eo6vTNa83Dyo2Qyu3V9cm6G3RxZXB8rmvHRdtc6Ma8eszDyuge/xoCcUPVgp4lLSwzuHfOyH5npR9gDwPBukxxL9RKK9DMOISUUxnL9gPrJahuF4sWYnRw4neRbz30v7eAbkBEwUqvbhB8/5fY+g8UvbFOEf0pLhw734+X4FMnXfJvJWWGbaUI+TgF7SEQJpiHxOQ4HZswbQ7fAycpPRsJEyOOycuzz9KLFzUV6U7VjB8mFMcxHPhaXMnupFjVx3O/y9G0flxJsvDdl0zRG98i/G3dov2G+j4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 18217, 'end_index': 18529, 'uri': 'https://github.com/Yoann-Vie/esgi-hearthstone', 'title': '', 'license_': ''}, {'start_index': 18390, 'end_index': 18774, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 18661, 'end_index': 19066, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 18887, 'end_index': 19348, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 19359, 'end_index': 19783, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 19626, 'end_index': 20333, 'uri': 'https://github.com/Yoann-Vie/esgi-hearthstone', 'title': '', 'license_': ''}, {'start_index': 20174, 'end_index': 20656, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 20593, 'end_index': 20945, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 20920, 'end_index': 21536, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 21375, 'end_index': 21719, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 21727, 'end_index': 22058, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 22031, 'end_index': 22520, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 22393, 'end_index': 23079, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 23154, 'end_index': 24089, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 24089, 'end_index': 24465, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 24762, 'end_index': 25083, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 59803, 'candidates_token_count': 30, 'total_token_count': 63677, 'cached_content_token_count': 56135, 'prompt_tokens_details': [{'modality': 1, 'token_count': 59922}], 'cache_tokens_details': [{'modality': 1, 'token_count': 56135}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 30}], 'thoughts_token_count': 3844}, 'finish_reason': 'MAX_TOKENS', 'avg_logprobs': -58.72272542317708, 'model_name': 'gemini-2.5-pro'} id='run--d9034ff5-33d9-4ffd-880c-9cd8997abe04-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'formfield_for_manytomany', 'basename': 'tests.py'}, 'id': 'e35215b3-8b8e-4cb4-9d1b-0c37730add38', 'type': 'tool_call'}] usage_metadata={'input_tokens': 59803, 'output_tokens': 30, 'total_tokens': 63677, 'input_token_details': {'cache_read': 56135}, 'output_token_details': {'reasoning': 3844}}
2025-10-06 03:35:07,901 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_manytomany", "relative_path": "tests/admin_views/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'8902f715-c11f-46f3-8f90-8c824ea4799b': 'CqYEAR/MhbaIzLmlB4YkvQHblqmmFSe1preYDq+3sj3Z/YGwVBE1ANAGCR7dNCDHRLz+QOxHsD+uyApRYyhdZeBWmy57+PaIJYg2YkKKkkQ1yM0/ifWeXX8rGTCEYVttZfsYTXiHFuOsyaD7eaKhXxqvYFO2GFpsr8J5J+iJI8fnNFOHxeIeANGFTIPRrxk2MNFHeQZBtql17wacNKqctcm++Fqyl985DDfhKqwFeuLQRYcQY2j326+u3Qc/07X6+Aslm4T2rA+9bNxZFc/AtKm8ChMK6jQYI87KO4zmMzkhkI9KTSJC8kwy/yf/S0dhwHV39fNmSyzyfWszM6z1B9bC7U7HnLPRFs+ml8zGTQPXOI+KWwy/ImbD5Y89DYX8aNThXCojqXTEOuXRQjrUSNTV2wRNzo6wm8FqhDbY7/PPHJFovwR5qDvgN75AZNYk5F6CCLCc//gIVWwESotmBplTwpaIJ84j9obZpc9ncH8IiLTalgvZ2niYxyS8QJeqhgYe4srppb1DVFhCUmHvvHeevmSaGsqwlG1Z1b8oCCQh5p/NhBsPP1Kd/CjZvPMGqgJbFNyU6t9m/2KjrCoTk3U6VUC/tHChPxkNQal6xhKWnBkrvWrgQYs9EFr5aLpy0aAvCsn1T6BiUYZfDfct0h6tg5zucmTMdGzCHYVHzdGoKY2ken3YeHH7D0WpnSkQJEDKJVuQehW5ob7xzGVcbtwkS8aqK27hwA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 60823, 'candidates_token_count': 40, 'total_token_count': 60994, 'cached_content_token_count': 56096, 'prompt_tokens_details': [{'modality': 1, 'token_count': 61026}], 'cache_tokens_details': [{'modality': 1, 'token_count': 56096}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 40}], 'thoughts_token_count': 131}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4509629249572754, 'model_name': 'gemini-2.5-pro'} id='run--9200572d-65a8-4cd7-aba8-e22e1f163db7-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_manytomany', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '8902f715-c11f-46f3-8f90-8c824ea4799b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 60823, 'output_tokens': 40, 'total_tokens': 60994, 'input_token_details': {'cache_read': 56096}, 'output_token_details': {'reasoning': 131}}
2025-10-06 03:35:10,804 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_foreignkey", "relative_path": "tests/admin_views/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'325eccc9-8f94-461a-86ad-9a8fe4fc97d2': 'CpYEAR/MhbYNfBOrYr0c/I8O9vJIRrPjqCHaUAm8aPWeuiUEDRyeze7ZPVxZgv2IA1q8ZavrKNwKN+q5c4LRnxKvDW0qkn9Jy611uuijJc4NJf3F3mGDz1qTwC6mNFU92eYlilXulVR0UcFSnSqRplL04mpkbSttySawJyy1qsq97BwsDiNKiH6e0msna+1lGHtG+ucRz9ELETK7XGUYKoXXwhBUkYwHlHfbck8oNQPmoBypzSKQRgzzLjALgpYgqwsM6Sg8GO3R+c7/J6iiT+6dXbQtw4XhxyReSE8CiRyk0BJndJs/9H9dZac0jig0r16tR4PhClehS2Av1iEashomlQbdClPK5+ZOxvQ5dtoVBmk2h2nP6UoH6nRQGW6hAw/WPwbmHzuhovaG7Og+jixe8a+Y9IaTd5PiqrgXQt1ZfIrv7iphJcDH7EbmKC6pcHkp+WO0Dp81HZqrxGwUC7h8WuIk1p3EeoSLIfaVHkh2qJOKhW0t8TJTCHYw9rOCGe2KNZNa8P5ulHRq9BUgnTUfybMlxVoCi5SqYX+WGtLS2C6zM8iMWUPZPsyCpCnRheePsj6II/Xy1C64VV0ezd7F52t0Qiw94mHIB2g9FVRfe36k1SUjPAMA3PrNjP+aGxdzJjNjH1091XZMSQBH8yg+5p/KHiAROK+AfOW4zmjQpL5EBxcFr1FGyGa0XrKfu6UJ5xcry9rw'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 60895, 'candidates_token_count': 39, 'total_token_count': 61054, 'cached_content_token_count': 60070, 'prompt_tokens_details': [{'modality': 1, 'token_count': 61227}], 'cache_tokens_details': [{'modality': 1, 'token_count': 60070}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 39}], 'thoughts_token_count': 120}, 'finish_reason': 'STOP', 'avg_logprobs': -0.32041513002835786, 'model_name': 'gemini-2.5-pro'} id='run--cab1578e-544d-42ef-93f3-27688af73e57-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_foreignkey', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '325eccc9-8f94-461a-86ad-9a8fe4fc97d2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 60895, 'output_tokens': 39, 'total_tokens': 61054, 'input_token_details': {'cache_read': 60070}, 'output_token_details': {'reasoning': 120}}
2025-10-06 03:35:14,317 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "widget", "relative_path": "tests/admin_views/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'4e14b05f-d00e-4401-b917-e10708f4c006': 'Cs4EAR/MhbYcmQyi4b9PRcljDVbDObGcd6NzArFaZyE9D+QDAbCbmqCQDgrx4V7E+Whlajlh7Rcbozjzri5s4+QkvwopgUkwkSC+jOU4J1FnPz0QXVdY4bS+gbUjhY6aEZgXn91UYVmzJ/32+8AAOItIWBwsZte/AdYqr7cEroem8X859GTyIpO1Oco0iFMfR3HOlgAkiIwdefyZ1C7GIvMUc/jVA52SVt0ZubR1wnKbOW0NZEK669KzkGebCxDfPUI6jA7q/CZeuoB36cQfGBp1U+5TPN6meumF5zEozMXo2xnIjemEg4B/WxS3u/SYh8Mo/5bCwnD/OevBlvcNPp7Uy4IWWCWWq4c4KaKu+pWYlRRxTZ6UTFVoFwisYLGEFB6nWbJ3pfggwXc86K+WHGerbZGEpkMdXf8p7V6ai5c2+fqSOQmEwiM6JHuceVS2m4zGv2+jeoKOipDQ4+ZgvoGj5J8fVqbCAlLGh1vkiVbJzfbhGWdvDSD6o6ajOMXrHZU1otLYMxwRk97GNVtuS8VNujyd+F7B4kFabBjLQD+m5t1jCfLMzX9lno8siwAWtZRQ+Wi8CV09Wp3I/aCrHSWpKEZIYiHRuvM+p7JHXgl0rRvwQrhZj7jGUlPeLiS6VQg9mjv0R/Zhd9cR0CODk13ZBI7PNGN4pxL4QXclTCoFWF1VwDdk0LaMBR5HhkBmRrEngDMb2EcYzDTQl+N6hO1XS3W2J8ivb4SGzYQCfL4TFjkaCwZ5jc6379wz5Mh3hYiDEA/lanVZWCmaHioPyc4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 60966, 'candidates_token_count': 33, 'total_token_count': 61138, 'cached_content_token_count': 60037, 'prompt_tokens_details': [{'modality': 1, 'token_count': 61415}], 'cache_tokens_details': [{'modality': 1, 'token_count': 60037}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 33}], 'thoughts_token_count': 139}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5985170422178326, 'model_name': 'gemini-2.5-pro'} id='run--2bc7ba21-abf4-4c59-9a83-fc589f22ecb2-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'widget', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '4e14b05f-d00e-4401-b917-e10708f4c006', 'type': 'tool_call'}] usage_metadata={'input_tokens': 60966, 'output_tokens': 33, 'total_tokens': 61138, 'input_token_details': {'cache_read': 60037}, 'output_token_details': {'reasoning': 139}}
2025-10-06 03:35:21,660 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_views/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'30f5927a-7f48-4a39-bc56-8bc5f5511f98': 'Cr4LAR/MhbYARdy96E/oAhxvxUg9lviMXdqzKkyIzBltkXqK8XziemeMdjbbFnHE0pga6qKsjO0w5xYaiyi5iKObeQ8pblMzvBqePW+ES0hwHZigyjJGUCi6ooDFuQpeahjWIzYKPXFjrbOSiP3NTy37ef7N+GdU03WiJZx0pjW35baA3A+uav1gLnR9i8I7Htzy/zx16VZvuaMgsPaKocvgaBiQLxq4vu5xpL1yuzzlyxD6gkiWPdVHh6F1qG8fmlyQRIMAaOdQZUa+lGV7APfmmgzOEgk/YPnDC0nU5gz80QWucFILYxnIbQhGKoquYRu48Au9J4wCD7YDSUr+vWDurBL6Z1yy2ZGldFqkHi0tXEpe9p78EX0cQkcSxMNeiInJ7/3FMALtC5Yr1oMkMw6O/bFAnusHAF3fqk64xWNbfLa3gNCrwAfN+Q8Z+d2KRlWCr+IwbTVHHkh+NoctkeYS6PUgz9P7FTul6/iRwXQeQkz8v0+8isQL2XNai2Pn92T8K8sFmvwn+/pZqyy49pYRzV7L4yJiV/OstG8iPjuQf7+TgekZxB3gR3eDJj7Yp0iYVV1np1tonQlSwSUNLBr5dzGNoxTIfNN9/01WliB5SiDAtm0DkM5usbAq4Nd32AfUW9AcySFFz6efOJxV36AkldnbuinjAwFk/Zmv6JhdFEDewaFj6oK/QCA12l1nRDmQyn7p0tU/OoEuM/Py2xa41gY/ATRruWLVXe49qud5PHNRkegPKFCRMsPeogq9HzEsx5CUJOIfHFHl5wSnY451PFSRQAbi9lNm2K1pkHuXho+vzTErBiDifkyBHOD2fI7oh8pLuZHGl4EdR/9BsftAFFm9kzHUBvP7yuHAxl58c4g1qomxJridVK0jQSxJkM6umXMzV9nLZvuvXK80rpZEGsPz3qgxHODhFs8rIFRhFMkkL4H/1+urCPZU0Ej5sUmtEsRLIWene/7EgGs58gQJWH0cptiHppqlPVP0ARq0toiSycrE3AWupXUA6e4OuNvXnGZSea0tZ4yemNwjMQu40U9pn+E+8dyFdvvs68k6jdUXtLPLrfLaGtLP3SkXnPEZNEKSo2jZhUqiPRvx3uDOpUN332CTMOq3kxblmwqLK0IGMwTVJCxEaSwj0ieyrwBI0YDuEpDG7py3Gr2cDFdTtacUvsktUd90N40P7GKEnGqePzrwLQvX2yeXLzHWl5zdDq0/OAGmIb+c+NtwnBfgKDLpc+23DIj9Oc/WzBLaly1Oo2vqdqnAEX5dqTiJHotq+sNj6JzNFi+1NCln16TWOfeyU3ev4VeTGquKBjkTzBnM4I9vcfyUpdee/FxM8WpcvvUecAFWwlELhmnycmhvjw9nszH6T6vVM7jQ/NsYdDaDGp1kUDxEWuyyaPzQW8wKOSUGZURclS+kObJDkiO8yyfHAD2ZcAXF2ynKWT6ullqJUbanVFX5DZqK8Bxu9UlzkmOS6Ur1RJauIltjErtn2uvtbV5N1xZnPyVaRnBpg2X3atFHDt9BGoYCE703vpy3Z2kNiaejXAPCuTIsgVUiO1R3OpuQ7HV0Z5NP6iQPZxgPbLfsFC8o6cOUzLH94hvHDFq01D2qPJAyXFzP4ssuEEZ3oF/0KAmN1NHZQ9e1SAgUXHBWK6eMOWuZUtSAwOWS0s7wZkxSsTSPiYAUDg1TB832TsNQJg0w5ISRChkYoMYB2HP7QYORZpaK+bx+WEghfMhcr7K3RSqNWcvRFkGcMyJy0ErPOuYp0HYGIOICdUHjNFQ3XSxUyBmPetZQqOGOKFWlF1pYHH6rmSAyKTTQoxv8cTMtl+log61znGde61WvwbZUgazGRiNV6zY9jHEH29oirRqkthq6JTkqHfAKJ4BdN+yYm5e5n4r3fM4cXCVVoWZPHP+V/a29jZPI0EY4uc2hPxsETts7DUyrm7SsAKDkSR0qD1UbJWHUGjei'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 91257, 'candidates_token_count': 23, 'total_token_count': 91632, 'prompt_tokens_details': [{'modality': 1, 'token_count': 91843}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 23}], 'thoughts_token_count': 352, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.8183305159859036, 'model_name': 'gemini-2.5-pro'} id='run--9f28c497-bb81-42cf-a1fb-7ed1c6b66d3a-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_views/tests.py'}, 'id': '30f5927a-7f48-4a39-bc56-8bc5f5511f98', 'type': 'tool_call'}] usage_metadata={'input_tokens': 91257, 'output_tokens': 23, 'total_tokens': 91632, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 352}}
2025-10-06 03:35:28,266 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "widget =", "relative_path": "tests/admin_widgets/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'92524d80-af28-42f6-a0d1-a4398c8d1817': 'CsgKAR/Mhbbm76luX1OxXiGQZdRawgAyoAl4Lqh4PgXci7vtkdVwPvV2T/MORoILgvMroMMw5e0ZPjDe4FlyDJx7xCC18ZTVY8CuLFP5Xywlo2keTytaFBLt3TQh7Or0MurYTaw4wWUU2fAkk0avqwFdGod9y7ltd7cSN6X0qYEG6VULNqecCZ6dwAYr7quhW37RdsV0vkAqlUmUq2GgboSU5DlA+TRpaZCO4bvbAm/9F0NH9xCNDOIOiG9au1ux2FFGwx2+NDdd7+CrFdjJ4RFFNTRVG73LLxwNxy1lADjFcy1+2VuJwyvhu+Txv48RXfQWEzxHUmjtUUjcvzPdsB9J0G6Uw+NxCpJ3nnSz/90zEBxh+ZtB6SGC6Lir6utUfqgEl+Dd6z82/jRYeJfN1jKsWk9GLkUHqW7eN6hFeVdwBoV727eYCvVslgyKhxgaV+TotF+j1jiNtfUQVyVlDeySLAHHfmWnDaO+wR3nU8Wm6K4+qwxLmDMWp0w1+2lc9KEtIXp0XTtTze4Yh9x5kNNaqK8HXAMFp1XRjj/k5KwdTZpMm5pt+PoK1Ms6v728BdoLFTbkbDR+X1LjJcFxiYPOrp7RjMhu4FIjDt7s0IPBVVUC1OFmYtVYuhcTxgRyYQpsin6gRKoSudQ9YJ5Dc+B6ont5dGKD7h5iZf3Qk1KeGceQCszyoRFHDAua0UC/EQdXKMNJbokmT+f+J1C6E9sb3wr3TQUZCX9SW3cf1ZM4GpYEj5gWncDh3XS5iebgZ3vp+fDTMxUibEfp4mP7v/rGFjp/3qyvw8wUjJQfqTT38OAu+BBWfzh7vt4aeKURx3iLeygUdO3nVbIgHCswwu02DD+WTWw4vr92x8w4fPWReu5ZaqqYbEJniXwJl0YOV73x5diACX6iZMTRZwqjE4Mc93U0pHtjSQK/pbamOIon7bSo7/oge0THhWH8Y+j34ke04h8bB9Sk2EZiUjR6oyDrWSLAmcppdne0uBlQCChT573P+ET7mPXEzZtAMLZVAJQTHupLtQD3iCbDL5tmF4x4mLayW6UM+bsjUCwTn2eKitCASydLbOLBkL+rLbcUveTyacfpKOIkUW+WkV4qYWSxCwECOrXAneY+XP5IEYHfNxomGINhX+4b9t1L6M8Z3tpN8HXBE5tpJrvEjR4wzdhIQCx3DIdTBjhemTXw/Y3hcQfMWwBMo4t+77u51koXM8yW3lmwzXLS8cSV/BUrrtdJ6UcjghFtPoehvtB0NAeVeQwxLVytfZckDjvuCsIkILNyw+6WAFMEHXzPxP1nGRbPYtPE4vC7qbUPs8YL9eZrZu4CbhGGlZCAsfkAGDyPs6kCh1+nsSH8dz3+LtVJoHFfDS3oqs0ZOPOMkmCfX2pDIM4AfAU4hp0k2N3o6w1buAcsiQXYuAl4qWnEHDgsnNrUR6+byDf52ARc8P9xPLgI3qqlAXUFVim78u+UNxs5m1ycdDs/pqnsX4wdEUcGbbcpsA8CvKN8NbfNw8nnkYkyj9MgekX50fBZI8mKMPdnyU/4J1nUuUq3KdBrRkRaEa2EMWkVaBtn7BcDlYlNTt3oBqDW+aJnA96SaVfZreb6+PSCdK2U0UUEMPSAw9JkGrofVEL6LmwTInQZ2rPtr511vFkfP9HIR7vDaZxrcbCQZt7ziMYR1DMFMcV4Pt2FEREIms7EJNKV8w6O8CMkUcR+wW21G1s3TL8mG+5D6rxI10USITjLokRA39EJytBQRcAUUhgOiyfrfpUo61XaHPK110B1bka/LlJnn4pX2o8HDxUbxzJI/Zl8U7M='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 100132, 'candidates_token_count': 34, 'total_token_count': 100486, 'cached_content_token_count': 91434, 'prompt_tokens_details': [{'modality': 1, 'token_count': 101068}], 'cache_tokens_details': [{'modality': 1, 'token_count': 91434}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 34}], 'thoughts_token_count': 320}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0100289513083065, 'model_name': 'gemini-2.5-pro'} id='run--866567d1-46a1-4e66-9ab3-fd5f6c2602c6-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'widget =', 'relative_path': 'tests/admin_widgets/tests.py'}, 'id': '92524d80-af28-42f6-a0d1-a4398c8d1817', 'type': 'tool_call'}] usage_metadata={'input_tokens': 100132, 'output_tokens': 34, 'total_tokens': 100486, 'input_token_details': {'cache_read': 91434}, 'output_token_details': {'reasoning': 320}}
2025-10-06 03:35:34,909 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_widgets/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'c5c3c979-c622-4aa6-b24a-423f65f23beb': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 104850, 'candidates_token_count': 23, 'total_token_count': 105293, 'cached_content_token_count': 99209, 'prompt_tokens_details': [{'modality': 1, 'token_count': 106104}], 'cache_tokens_details': [{'modality': 1, 'token_count': 99209}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 23}], 'thoughts_token_count': 420}, 'finish_reason': 'STOP', 'avg_logprobs': -1.6664503346318784, 'model_name': 'gemini-2.5-pro'} id='run--8ed94659-be0b-4213-8ba4-b7e232a39a57-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_widgets/tests.py'}, 'id': 'c5c3c979-c622-4aa6-b24a-423f65f23beb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 104850, 'output_tokens': 23, 'total_tokens': 105293, 'input_token_details': {'cache_read': 99209}, 'output_token_details': {'reasoning': 420}}
2025-10-06 03:35:40,592 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_manytomany", "relative_path": "tests/modeladmin/test_checks.py"}'}, '__gemini_function_call_thought_signatures__': {'0e8248d3-6b46-4760-9b80-e77e21ef2bc3': 'CrEIAR/MhbY/3Af3bWkEIJ4Klf2d2sIjyH4kjJc+WemioaXUisE07blnd1r0dG2Ms97u5x864+jM3InnWzxpSY563EBRFG2T1iO2fSiJmPNzNDGafS+UEySeonZrjzMB+M2SjvD7UtiQqf9rzkVUF5chHMMxR7MPtgYv6z/sybFndEvDg8DRACsey5ShTvtq3wHAVJZR7H5x0tWFWlZRH56O4CHIrGuLqQeAOyn6jVcSw/tzVuwVE68M83hsxmxLIGxYtQm5Y1szHnPMmrK7AYJcOlEc1ApaC0BGmQbshuPzOv/W3PbA4zSmz2DGhswc12TJwlw4gxFDeTgY4h0gSfhj3IYORQ2is4e0LUuenXN34fuLWPIpJR5eUXLwxUPgPvGu6oNDiOW7JkkCtQCMp5X9A6VRVolsk8ANLCxG8N72mYC0cM7/z2eg8ghoAIy9FzABfqAX+K85fcCnG1xF09tWXNFX6psSkVr61yycKgZZbY+BM8np1GSOGE2+UTuooHZUvVFu+zvPi7emDbFDBkB1OuShVaejLdrztsSvaJM8MwMFbPaKjcM1I71LtYqYTv4pT38DhgLqSzlVhOPx1ybvx7pme/zOGVyTX76BNFSRA+zzC2UOtKGqyfhglnXGt1ymVpX42d8DJH52WUkAWFnCrRQeCV3R3MUMrVrrbwfKIzHWcD1s79rNoDZaNbxiy56+xB4I6T0G/v3Ktq2MbW9TcBCT2qstj6nXGCtyDWZMrC4sS57GwuKFRET1wuuTDmtxqXiHaefkBEOw07rm8ySUXyHF3x9L5Npa2jghqiPlB1LKQaTVYjJd+FN+Vm6Ys0WeK9EAiySPpgRP7AIZbk0Afc9z3QUNJsnpvpjNjUnuU/zTIZLpdE020Eds5LJSg5fSQQLwj6elr69D4i8YKapHgI/7k+VSBBX2XoyGoB/KreNnxLQYwpmjG9vKDgEw4hTyxFBNgdcRZ+nT32UnXBaFqm6I1aQGFLP71ruhMipa5z8ottJW82hl01ZnZ1DA97L2V5VLRoEaJkzlG6ihjGZ6ByLEbVMXk1b5IY/KgJoWvlq0O3kj7h6sEPLuafcKxr0y/4NXuIN/qgHSpF5wN1ZTILd1wUYsJywt1nwDsmLx5T1lDJgSLCbj2tDfPzCS2UaMsAEVNNvKLpx4sWQ1e9fRW4HOS/eTTQjfqga/8Q78q7Jv15tCvb4dTzWUzBtRPL0G7xVRURu3VtPgxgopKWOBLvmTJ24zxxkuTQ56PknMV+E80ib6pStivT9d30k3ziHnkWSMt1hjCry97nhPJV8yFCjXv49fCGh28QYtNxQAXWnSmjrLf0TL0cGEDLk+VH87gKS8KQNKSFbE5lXPyxRnY9jIWdQ9rkexnq/N42TBjX3HMQ5MMLa9L4Pi+PY5gIKWlsxQjRvEj+Su8OATdd87vnY='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 113517, 'candidates_token_count': 42, 'total_token_count': 113814, 'cached_content_token_count': 103062, 'prompt_tokens_details': [{'modality': 1, 'token_count': 115189}], 'cache_tokens_details': [{'modality': 1, 'token_count': 103062}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 42}], 'thoughts_token_count': 255}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8312310718354725, 'model_name': 'gemini-2.5-pro'} id='run--759bd6a8-eaaf-442c-a3d4-de26603a0862-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_manytomany', 'relative_path': 'tests/modeladmin/test_checks.py'}, 'id': '0e8248d3-6b46-4760-9b80-e77e21ef2bc3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 113517, 'output_tokens': 42, 'total_tokens': 113814, 'input_token_details': {'cache_read': 103062}, 'output_token_details': {'reasoning': 255}}
2025-10-06 03:35:44,691 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "raw_id_fields", "relative_path": "tests/admin_inlines/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'57cec2bc-525c-4af5-aeb8-75d06e74befe': 'Cq8EAR/MhbZ2ltrcBu6PLROvLpUkrozlxNfme4ZE46BfB91AN1tLLS3G1PpA3mwiyKgF+L3vu0edixsE65RPpNAfqfjLy0Rh2skJFC0gl7pVHhxuHKuAXW6hjR/nA4piQjnViNcePTtwzG13WUwfSYllsxyFbqXLc76+KSZbMb9ovtni3hqPiK2QOqEbsKrYnS8CrvYt3aSkNJ4kp7gO5L0lh0SmXU5Bw9/iKFhRraVYOWLQpAwmjnO8d697TFQoCFvkUs2KMqEED6lKmrtrqiqg8gy6XYeYtgSy2yqf8HsIMoIuAM98a7TbowHlI0jc9YjHqY77/0jHV/iTwF09W0qzvpUzLI7TBCZBGc4vdrs4n/xSjdtD2v0Smtn8dqQelwSJmvq+UxXkFqTBybp+MQQBrV9qnB41JgWEPnL9ssNKmO29tsOEZ5fcEmHZGdwNtVIrUqzH3E8oymaPuTBSMiuPa7XeAKu/ywLjGdk68F3wPH1S1KlIcfCqISTRGiAjNdWE1m5pvyRogCAvOoF0diGIgpmuChdmGwfMVhYkvECrLzWhglxAEhwubzLtL3oNWqzkqv3aiJPtS8gF+ZtWKmXFUnzGAfw2jzm3ppfsg1aijllFfIsa8EjarNNVEDkmc/Xhm/xnEqZ0bZcIKVbSHoC4KxYjL09RZB3AtQ+6P0oyc7JyjJK7QsZfbTDh8araXJiXpXCWCYQPDvfRHCnR7aFzQt3YwRgE2pXP8p3A7g1NBw=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 113591, 'candidates_token_count': 38, 'total_token_count': 113769, 'cached_content_token_count': 114928, 'prompt_tokens_details': [{'modality': 1, 'token_count': 115516}], 'cache_tokens_details': [{'modality': 1, 'token_count': 114928}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 38}], 'thoughts_token_count': 140}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5920664134778475, 'model_name': 'gemini-2.5-pro'} id='run--06711ad7-4a75-4b4d-9c90-36ef4f132f9a-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'raw_id_fields', 'relative_path': 'tests/admin_inlines/tests.py'}, 'id': '57cec2bc-525c-4af5-aeb8-75d06e74befe', 'type': 'tool_call'}] usage_metadata={'input_tokens': 113591, 'output_tokens': 38, 'total_tokens': 113769, 'input_token_details': {'cache_read': 114928}, 'output_token_details': {'reasoning': 140}}
2025-10-06 03:35:49,769 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "formfield_for_manytomany", "basename": "admin.py"}'}, '__gemini_function_call_thought_signatures__': {'f3808bba-30ce-4936-8f87-2cde09a3773d': 'Cs8HAR/MhbYm6aVJExsauOh9jOVmtStxcvaL+oWK4PDKlUFRFZxabSZNk+QBvbhlj9d7c9ooMHmEQsH6/dXxWLgN/YwAi0nkCqJKg7Hv+uuYhfSJIzNdgavj3YJcEidwknH+dCINKbpxGAtvnKQazjfnAs/nC9yAqyVFpElP3rjIC4x/oB6OX3k33zkHE67pcIrYTtOle4YyxxRC2pZ8/Kib+JJF2QySy1vJtsX6cAkWvtfPaV8gCFHVPv3rpI/1mpUu06mgZO25bsELdU1c8JjPI4nvqbuMULWR7dbG+PrQZCi5Q+6QRyi63nB8ndWxeUdCyQqBUH6Yj5Aa0qhlXAoU2ssHjWMdKWo+8hbwZHlIyVc8DaBzSPJYAaNMn5gzdV0X286DzdSoP6Levi6PBGFzG9wDAT2mRkhreg4L1l4BSlNHXA+jhPOgETwmRU3nU07A7odniet8jIDpBuPoLCrDxYnOoS2GkWs3bs7lbWgX5GszpIfC8sn8B35kTQIea5RqOWdYrZQC7XnICKc/R5lJNN2kgGACm+zX+ATMa1iclUJ3ICwFNLxe8Et9hDORq0M2c/iMvaGcHkbBtZ26lSddh3jX69cpXORvFXcw5/+Hi05bGyAwy68aAB6ZTXCFO9sHKgz702bYwDpJxlqOXvnxJsv2lbye3RStw9weh33D7d8s4KYC0tAgDAM1+RiCWTeuf7p88C3Y5NXboYn7AuKHSLH1iwC0nRZWkMgBsBml7jX3M5k21rJiWfkoHFSFmbTRrg7id2318SHgbZvRpsKk1x2CD/8YvumV2JQkPOeniqmFenWxhiGTMAmfsuftbsoQXAqYQQ6Ipa21+/y7IXSEsI/uOQCfC+MC6g/GM3stqGHhhO8Kc/AKt2dCqJfSZMt0xJ8pcOsprysXJaijD/mVYOHah1gB5bK1kvz49uarb6mOeR7hOdvCIIdodfhcRgrruL0aq+RXjFgt9QNQxYhn5LMDfcBUxCXdEtr3wnl4t9GB0sZ6Y+8oFbFp5L9xmccju3GZan7DJB4jqkZ9HE4r4mzNO+AzEInCSqhcSmwg4MgtKedmQZgSzsDy4LXOtL2bQ/4j7Q7Gn9Q+2+q+LZqgRa1OLtXjTnnB4zy7l1/AMvPCGD6XQM2nVMr5NWnfeE/irddIj++mv3rQSgRfQu8xdpOb1ecBvJ+cr00ouVo/+fuIa/bS0SDJYlHpDodbsiFTWvYgoR2+PyRS5o7VySN/tCUYmyXkrnzI1MC9V7t9vsbM4uSHhF4GXZrS7oFNRDi6l5yit4hOVPhb7FeYdEas'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 113661, 'candidates_token_count': 30, 'total_token_count': 113931, 'cached_content_token_count': 114897, 'prompt_tokens_details': [{'modality': 1, 'token_count': 115724}], 'cache_tokens_details': [{'modality': 1, 'token_count': 114897}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 30}], 'thoughts_token_count': 240}, 'finish_reason': 'STOP', 'avg_logprobs': -1.2512346903483074, 'model_name': 'gemini-2.5-pro'} id='run--3ff0f579-f7be-4315-a26f-e2181507750f-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'formfield_for_manytomany', 'basename': 'admin.py'}, 'id': 'f3808bba-30ce-4936-8f87-2cde09a3773d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 113661, 'output_tokens': 30, 'total_tokens': 113931, 'input_token_details': {'cache_read': 114897}, 'output_token_details': {'reasoning': 240}}
2025-10-06 03:35:54,381 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "GroupAdmin", "relative_path": "tests/auth_tests/test_admin_multidb.py"}'}, '__gemini_function_call_thought_signatures__': {'aa858e45-f9e2-4035-a99d-71a6cfb4133f': 'Ct0EAR/Mhba42DJoMrgdEytATH3VnG6EHVHa15bIlQyO2lTXUN/W0Ll0ilzW5w4nE3q0aWXqiO5Y4TZGGVaVfvm8+BX2hgZB0YN/dc6VBydp4NIPt4/0LRwhXKwnOraqzMBG2yciZgrMlezApRudjDQykkwnyF1ZFTAntIq/mOYa+A993IIZfguf7v3lq83G729jEzyp9SaObsQ+shretpFii9fHzq4jL8wHXIfiVLRN57nRZxs5iXbroCJUXcCmybkuqulP/40/YeglWGlXlM7Qz8dGytjsDk8RtRNE4ULDBSExD6oOM6lHDjMnb237036kfqV4HzkNNuz9DzTQoPBoDjLhAfRj2AOjX6raKUEWuKyi8QLplxJF15j4AimtsdquswHq9Q2eSW/KzGW1kSi0Ko7EZmXXf6Nzr573nmXhj/riWKgBv9fcsC0nCd+OwkBfUP+kz9ebPF6pLlQwhFk/eVD9pBnnn+PMdkio6kRdDoi++87T7r9YFL3inmorPeOS8QTA7UdygO4i3bLFBUhH/SsVJoSnaqjBnxQHRFYj23yUuHFT0mNfoCyZyDb3iVNxkVtP9cmN1uxqiV/XC1hqcEpNerS8hCYaP0KdVL8Tcf1xR/ykQdYpIOduveL2oUGUYQ9eCH3bdD7QbDrdzqWOhCWWaSOzUu4CSH5k7rCU/hd37AKjBCiZBpdIciOan0Q1g3xl7gG69pzIDPHTXWZSAyljmC/U8Uf6Y6FBL18QGj63Xs5QHtxAAm+Xs5rl0WWM1Jfq0GqxI9vbv5Z59KNLVNG83fBhtnvMv8cKH8k='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 113972, 'candidates_token_count': 39, 'total_token_count': 114178, 'cached_content_token_count': 114850, 'prompt_tokens_details': [{'modality': 1, 'token_count': 116273}], 'cache_tokens_details': [{'modality': 1, 'token_count': 114850}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 39}], 'thoughts_token_count': 167}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4650284693791316, 'model_name': 'gemini-2.5-pro'} id='run--ca15e6aa-646b-4649-a45d-8c55acf337bb-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'GroupAdmin', 'relative_path': 'tests/auth_tests/test_admin_multidb.py'}, 'id': 'aa858e45-f9e2-4035-a99d-71a6cfb4133f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 113972, 'output_tokens': 39, 'total_tokens': 114178, 'input_token_details': {'cache_read': 114850}, 'output_token_details': {'reasoning': 167}}
2025-10-06 03:35:57,279 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "GroupAdmin", "relative_path": "tests/auth_tests/test_views.py"}'}, '__gemini_function_call_thought_signatures__': {'452c543f-4b38-4b4c-bafb-8ba925cda0d2': 'CpwCAR/MhbbPjwdXyo61t5Hh/l2n1pq+2CGCfYql5QX2OdSAYhZDwvelCdi3oaP/4jPmIfYgJji6kbssvOM9Fgw66Ui2oGoubkBm8obyHGiqWiPoa83mUq5GLmmAxVpYdhmywEj7uxyxtOP/LUN2ko0sPvRMmI+JPEE0hGNcYht6MsGJ4/C+0pgXJQcWQv6pu5NcrJeEhSzOpr64n0irkezH8pJeGNNu7PWP0RYADcpzgINNsX18d9jw/3Kw1Y66IYsl9Yt1xlnfcqetc9uWQgY3GrzRH3XM2K01EnrFoCIB+rME7xKqV1SQyQcG+wh1P6OEZZPeZuqCxizYFbRSDJEX1LLzTp+1jp5VT0FfYMqhKO24BEghVhpZsGNyJD4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 114043, 'candidates_token_count': 36, 'total_token_count': 114152, 'cached_content_token_count': 114820, 'prompt_tokens_details': [{'modality': 1, 'token_count': 116508}], 'cache_tokens_details': [{'modality': 1, 'token_count': 114820}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 36}], 'thoughts_token_count': 73}, 'finish_reason': 'STOP', 'avg_logprobs': -0.16698532634311253, 'model_name': 'gemini-2.5-pro'} id='run--bfbd425a-85e6-411a-ae00-0ab78b23f4ec-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'GroupAdmin', 'relative_path': 'tests/auth_tests/test_views.py'}, 'id': '452c543f-4b38-4b4c-bafb-8ba925cda0d2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 114043, 'output_tokens': 36, 'total_tokens': 114152, 'input_token_details': {'cache_read': 114820}, 'output_token_details': {'reasoning': 73}}
2025-10-06 03:36:01,111 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "GroupAdmin", "relative_path": "tests/admin_views/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'0f988313-34ab-4bf2-9462-47c9d2af3d08': 'CsgEAR/MhbaHh1ytvAezRT90qFSItRlsU3kM30HW7LaPrh+F/TDkd70t4l9Y1mtKYyci44WEJMcBu4h8bKRC1DK3iNR0Mm7lXIiBhmO4RHB8MK/rDyTavc9rQeki8TEUQNZecL+SXjSQlIN5yG2rSpL0VcgtXkK08a/ZZd3/Dz7/SxiMrmvFIpdq0OXhJIBJ36+upedoZTRZYRRTleoQMV1kvcAnQSftF8EZKA87q0fGdLX06V8OuBMImWAU1zOgTTWT77uDFI4IPWFQ/eBWlZeO9UArGkl2CNFNTeqI2EidBelq11zg6rpqtM+Recho8T3wRxlPZBqT8CeM/AmJ4czrRGANLBQnPIWUJhQKAt+XJnNyLX1vawdS08PV7cTpMynhQgi9QWj8QZzqtUNwAga+PnkcbEHoq+ira+uiDOTpnsUlYxfwJOykHiltE58b0MvLHFke82CtyWDxps8UeIvsOSpZP3WxUUrpoXmaVViov2mBWgtnmeiyojEOsF9YOxm44h3isqAzntCTJ8WAxOiLJ4Fk+DIxMeR/5CNl/Q5pxYHhqzn/Wb9fSBI0jQmsCZ4Q1UatK2+4JEB8a9GCTJJpTF/yIc//WipIuBik/ncPQ7HZFxzrnWh25XaugrfyglO1hGRT6QvyTNoB1+fy043TntWieHfhIuGpjNAtbIaJiiWhpDFwchfDSc9hjGyHP4R4jTgjjia1V+HK3dxss0AcpFyaoEFZ4CJp0SnAFcdzFlPoGdrjq42JNPuGJUOWitbxKjj6axt+IOA='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 114111, 'candidates_token_count': 34, 'total_token_count': 114297, 'cached_content_token_count': 114787, 'prompt_tokens_details': [{'modality': 1, 'token_count': 116647}], 'cache_tokens_details': [{'modality': 1, 'token_count': 114787}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 34}], 'thoughts_token_count': 152}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5549737705903894, 'model_name': 'gemini-2.5-pro'} id='run--b534b112-fc12-434f-843f-940cd2f78199-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'GroupAdmin', 'relative_path': 'tests/admin_views/tests.py'}, 'id': '0f988313-34ab-4bf2-9462-47c9d2af3d08', 'type': 'tool_call'}] usage_metadata={'input_tokens': 114111, 'output_tokens': 34, 'total_tokens': 114297, 'input_token_details': {'cache_read': 114787}, 'output_token_details': {'reasoning': 152}}
2025-10-06 03:39:40,630 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have found test cases that demonstrate how to override widgets in the Django admin, which is the core of the user\'s issue. I started by searching for `formfield_for_manytomany` in test files, which led me to `TestRelatedFieldsAdminOrdering` in `tests/admin_ordering/tests.py`. I then broadened my search to include general widget overriding techniques, which led me to `AdminFormfieldForDBFieldTests` and `RelatedFieldWidgetWrapperTests` in `tests/admin_widgets/tests.py`. Finally, I found a test for `GroupAdmin`, which uses `formfield_for_manytomany`, in `tests/admin_views/tests.py`. These examples should provide a good starting point for the user.\n<test_case>\n# File: tests/admin_ordering/tests.py\nfrom django.contrib import admin\nfrom django.contrib.admin.options import ModelAdmin\nfrom django.contrib.auth.models import User\nfrom django.db.models import F\nfrom django.test import RequestFactory, TestCase\n\nfrom .models import (\n    Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,\n    SongInlineNewOrdering,\n)\n\n\nclass MockRequest:\n    pass\n\n\nclass MockSuperUser:\n    def has_perm(self, perm):\n        return True\n\n    def has_module_perms(self, module):\n        return True\n\n\nrequest = MockRequest()\nrequest.user = MockSuperUser()\n\nsite = admin.AdminSite()\n\n\nclass TestAdminOrdering(TestCase):\n    """\n    Let\'s make sure that ModelAdmin.get_queryset uses the ordering we define\n    in ModelAdmin rather that ordering defined in the model\'s inner Meta\n    class.\n    """\n    request_factory = RequestFactory()\n\n    @classmethod\n    def setUpTestData(cls):\n        Band.objects.bulk_create([\n            Band(name=\'Aerosmith\', bio=\'\', rank=3),\n            Band(name=\'Radiohead\', bio=\'\', rank=1),\n            Band(name=\'Van Halen\', bio=\'\', rank=2),\n        ])\n\n    def test_default_ordering(self):\n        """\n        The default ordering should be by name, as specified in the inner Meta\n        class.\n        """\n        ma = ModelAdmin(Band, site)\n        names = [b.name for b in ma.get_queryset(request)]\n        self.assertEqual([\'Aerosmith\', \'Radiohead\', \'Van Halen\'], names)\n\n    def test_specified_ordering(self):\n        """\n        Let\'s use a custom ModelAdmin that changes the ordering, and make sure\n        it actually changes.\n        """\n        class BandAdmin(ModelAdmin):\n            ordering = (\'rank\',)  # default ordering is (\'name\',)\n        ma = BandAdmin(Band, site)\n        names = [b.name for b in ma.get_queryset(request)]\n        self.assertEqual([\'Radiohead\', \'Van Halen\', \'Aerosmith\'], names)\n\n    def test_specified_ordering_by_f_expression(self):\n        class BandAdmin(ModelAdmin):\n            ordering = (F(\'rank\').desc(nulls_last=True),)\n        band_admin = BandAdmin(Band, site)\n        names = [b.name for b in band_admin.get_queryset(request)]\n        self.assertEqual([\'Aerosmith\', \'Van Halen\', \'Radiohead\'], names)\n\n    def test_dynamic_ordering(self):\n        """\n        Let\'s use a custom ModelAdmin that changes the ordering dynamically.\n        """\n        super_user = User.objects.create(username=\'admin\', is_superuser=True)\n        other_user = User.objects.create(username=\'other\')\n        request = self.request_factory.get(\'/\')\n        request.user = super_user\n        ma = DynOrderingBandAdmin(Band, site)\n        names = [b.name for b in ma.get_queryset(request)]\n        self.assertEqual([\'Radiohead\', \'Van Halen\', \'Aerosmith\'], names)\n        request.user = other_user\n        names = [b.name for b in ma.get_queryset(request)]\n        self.assertEqual([\'Aerosmith\', \'Radiohead\', \'Van Halen\'], names)\n\n\nclass TestInlineModelAdminOrdering(TestCase):\n    """\n    Let\'s make sure that InlineModelAdmin.get_queryset uses the ordering we\n    define in InlineModelAdmin.\n    """\n\n    @classmethod\n    def setUpTestData(cls):\n        cls.band = Band.objects.create(name=\'Aerosmith\', bio=\'\', rank=3)\n        Song.objects.bulk_create([\n            Song(band=cls.band, name=\'Pink\', duration=235),\n            Song(band=cls.band, name=\'Dude (Looks Like a Lady)\', duration=264),\n            Song(band=cls.band, name=\'Jaded\', duration=214),\n        ])\n\n    def test_default_ordering(self):\n        """\n        The default ordering should be by name, as specified in the inner Meta\n        class.\n        """\n        inline = SongInlineDefaultOrdering(self.band, site)\n        names = [s.name for s in inline.get_queryset(request)]\n        self.assertEqual([\'Dude (Looks Like a Lady)\', \'Jaded\', \'Pink\'], names)\n\n    def test_specified_ordering(self):\n        """\n        Let\'s check with ordering set to something different than the default.\n        """\n        inline = SongInlineNewOrdering(self.band, site)\n        names = [s.name for s in inline.get_queryset(request)]\n        self.assertEqual([\'Jaded\', \'Pink\', \'Dude (Looks Like a Lady)\'], names)\n\n\nclass TestRelatedFieldsAdminOrdering(TestCase):\n    @classmethod\n    def setUpTestData(cls):\n        cls.b1 = Band.objects.create(name=\'Pink Floyd\', bio=\'\', rank=1)\n        cls.b2 = Band.objects.create(name=\'Foo Fighters\', bio=\'\', rank=5)\n\n    def setUp(self):\n        # we need to register a custom ModelAdmin (instead of just using\n        # ModelAdmin) because the field creator tries to find the ModelAdmin\n        # for the related model\n        class SongAdmin(admin.ModelAdmin):\n            pass\n        site.register(Song, SongAdmin)\n\n    def tearDown(self):\n        site.unregister(Song)\n        if Band in site._registry:\n            site.unregister(Band)\n\n    def check_ordering_of_field_choices(self, correct_ordering):\n        fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)\n        m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)\n        self.assertEqual(list(fk_field.queryset), correct_ordering)\n        self.assertEqual(list(m2m_field.queryset), correct_ordering)\n\n    def test_no_admin_fallback_to_model_ordering(self):\n        # should be ordered by name (as defined by the model)\n        self.check_ordering_of_field_choices([self.b2, self.b1])\n\n    def test_admin_with_no_ordering_fallback_to_model_ordering(self):\n        class NoOrderingBandAdmin(admin.ModelAdmin):\n            pass\n        site.register(Band, NoOrderingBandAdmin)\n\n        # should be ordered by name (as defined by the model)\n        self.check_ordering_of_field_choices([self.b2, self.b1])\n\n    def test_admin_ordering_beats_model_ordering(self):\n        class StaticOrderingBandAdmin(admin.ModelAdmin):\n            ordering = (\'rank\',)\n        site.register(Band, StaticOrderingBandAdmin)\n\n        # should be ordered by rank (defined by the ModelAdmin)\n        self.check_ordering_of_field_choices([self.b1, self.b2])\n\n    def test_custom_queryset_still_wins(self):\n        """Custom queryset has still precedence (#21405)"""\n        class SongAdmin(admin.ModelAdmin):\n            # Exclude one of the two Bands from the querysets\n            def formfield_for_foreignkey(self, db_field, request, **kwargs):\n                if db_field.name == \'band\':\n                    kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n                return super().formfield_for_foreignkey(db_field, request, **kwargs)\n\n            def formfield_for_manytomany(self, db_field, request, **kwargs):\n                if db_field.name == \'other_interpreters\':\n                    kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n                return super().formfield_for_foreignkey(db_field, request, **kwargs)\n\n        class StaticOrderingBandAdmin(admin.ModelAdmin):\n            ordering = (\'rank\',)\n\n        site.unregister(Song)\n        site.register(Song, SongAdmin)\n        site.register(Band, StaticOrderingBandAdmin)\n\n        self.check_ordering_of_field_choices([self.b2])\n</test_case>\n<test_case>\n# File: tests/admin_views/tests.py\nimport datetime\nimport os\nimport re\nimport unittest\nfrom unittest import mock\nfrom urllib.parse import parse_qsl, urljoin, urlparse\n\nimport pytz\n\nfrom django.contrib.admin import AdminSite, ModelAdmin\nfrom django.contrib.admin.helpers import ACTION_CHECKBOX_NAME\nfrom django.contrib.admin.models import ADDITION, DELETION, LogEntry\nfrom django.contrib.admin.options import TO_FIELD_VAR\nfrom django.contrib.admin.templatetags.admin_urls import add_preserved_filters\nfrom django.contrib.admin.tests import AdminSeleniumTestCase\nfrom django.contrib.admin.utils import quote\nfrom django.contrib.admin.views.main import IS_POPUP_VAR\nfrom django.contrib.auth import REDIRECT_FIELD_NAME, get_permission_codename\nfrom django.contrib.auth.models import Group, Permission, User\nfrom django.contrib.contenttypes.models import ContentType\nfrom django.core import mail\nfrom django.core.checks import Error\nfrom django.core.files import temp as tempfile\nfrom django.forms.utils import ErrorList\nfrom django.template.response import TemplateResponse\nfrom django.test import (\n    TestCase, modify_settings, override_settings, skipUnlessDBFeature,\n)\nfrom django.test.utils import override_script_prefix\nfrom django.urls import NoReverseMatch, resolve, reverse\nfrom django.utils import formats, translation\nfrom django.utils.cache import get_max_age\nfrom django.utils.encoding import iri_to_uri\nfrom django.utils.html import escape\nfrom django.utils.http import urlencode\n\nfrom . import customadmin\nfrom .admin import CityAdmin, site, site2\nfrom .models import (\n    Actor, AdminOrderedAdminMethod, AdminOrderedCallable, AdminOrderedField,\n    AdminOrderedModelMethod, Album, Answer, Answer2, Article, BarAccount, Book,\n    Bookmark, Category, Chapter, ChapterXtra1, ChapterXtra2, Character, Child,\n    Choice, City, Collector, Color, ComplexSortedPerson, CoverLetter,\n    CustomArticle, CyclicOne, CyclicTwo, DooHickey, Employee, EmptyModel,\n    Fabric, FancyDoodad, FieldOverridePost, FilteredManager, FooAccount,\n    FoodDelivery, FunkyTag, Gallery, Grommet, Inquisition, Language, Link,\n    MainPrepopulated, Media, ModelWithStringPrimaryKey, OtherStory, Paper,\n    Parent, ParentWithDependentChildren, ParentWithUUIDPK, Person, Persona,\n    Picture, Pizza, Plot, PlotDetails, PluggableSearchPerson, Podcast, Post,\n    PrePopulatedPost, Promo, Question, ReadablePizza, ReadOnlyPizza,\n    Recommendation, Recommender, RelatedPrepopulated, RelatedWithUUIDPKModel,\n    Report, Restaurant, RowLevelChangePermissionModel, SecretHideout, Section,\n    ShortMessage, Simple, Song, State, Story, SuperSecretHideout, SuperVillain,\n    Telegram, TitleTranslation, Topping, UnchangeableObject, UndeletableObject,\n    UnorderedObject, UserProxy, Villain, Vodcast, Whatsit, Widget, Worker,\n    WorkHour,\n)\n\nERROR_MESSAGE = "Please enter the correct username and password \\\nfor a staff account. Note that both fields may be case-sensitive."\n\nMULTIPART_ENCTYPE = \'enctype="multipart/form-data"\'\n\n\nclass AdminFieldExtractionMixin:\n    """\n    Helper methods for extracting data from AdminForm.\n    """\n    def get_admin_form_fields(self, response):\n        """\n        Return a list of AdminFields for the AdminForm in the response.\n        """\n        fields = []\n        for fieldset in response.context[\'adminform\']:\n            for field_line in fieldset:\n                fields.extend(field_line)\n        return fields\n\n    def get_admin_readonly_fields(self, response):\n        """\n        Return the readonly fields for the response\'s AdminForm.\n        """\n        return [f for f in self.get_admin_form_fields(response) if f.is_readonly]\n\n    def get_admin_readonly_field(self, response, field_name):\n        """\n        Return the readonly field for the given field_name.\n        """\n        admin_readonly_fields = self.get_admin_readonly_fields(response)\n        for field in admin_readonly_fields:\n            if field.field[\'name\'] == field_name:\n                return field\n\n\n@override_settings(ROOT_URLCONF=\'admin_views.urls\', USE_I18N=True, USE_L10N=False, LANGUAGE_CODE=\'en\')\nclass AdminViewBasicTestCase(TestCase):\n\n    @classmethod\n    def setUpTestData(cls):\n        cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n        cls.s1 = Section.objects.create(name=\'Test section\')\n        cls.a1 = Article.objects.create(\n            content=\'<p>Middle content</p>\', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1\n        )\n        cls.a2 = Article.objects.create(\n            content=\'<p>Oldest content</p>\', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1\n        )\n        cls.a3 = Article.objects.create(\n            content=\'<p>Newest content</p>\', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1\n        )\n        cls.p1 = PrePopulatedPost.objects.create(title=\'A Long Title\', published=True, slug=\'a-long-title\')\n        cls.color1 = Color.objects.create(value=\'Red\', warm=True)\n        cls.color2 = Color.objects.create(value=\'Orange\', warm=True)\n        cls.color3 = Color.objects.create(value=\'Blue\', warm=False)\n        cls.color4 = Color.objects.create(value=\'Green\', warm=False)\n        cls.fab1 = Fabric.objects.create(surface=\'x\')\n        cls.fab2 = Fabric.objects.create(surface=\'y\')\n        cls.fab3 = Fabric.objects.create(surface=\'plain\')\n        cls.b1 = Book.objects.create(name=\'Book 1\')\n        cls.b2 = Book.objects.create(name=\'Book 2\')\n        cls.pro1 = Promo.objects.create(name=\'Promo 1\', book=cls.b1)\n        cls.pro1 = Promo.objects.create(name=\'Promo 2\', book=cls.b2)\n        cls.chap1 = Chapter.objects.create(title=\'Chapter 1\', content=\'[ insert contents here ]\', book=cls.b1)\n        cls.chap2 = Chapter.objects.create(title=\'Chapter 2\', content=\'[ insert contents here ]\', book=cls.b1)\n        cls.chap3 = Chapter.objects.create(title=\'Chapter 1\', content=\'[ insert contents here ]\', book=cls.b2)\n        cls.chap4 = Chapter.objects.create(title=\'Chapter 2\', content=\'[ insert contents here ]\', book=cls.b2)\n        cls.cx1 = ChapterXtra1.objects.create(chap=cls.chap1, xtra=\'ChapterXtra1 1\')\n        cls.cx2 = ChapterXtra1.objects.create(chap=cls.chap3, xtra=\'ChapterXtra1 2\')\n        Actor.objects.create(name=\'Palin\', age=27)\n\n        # Post data for edit inline\n        cls.inline_post_data = {\n            "name": "Test section",\n            # inline data\n            "article_set-TOTAL_FORMS": "6",\n            "article_set-INITIAL_FORMS": "3",\n            "article_set-MAX_NUM_FORMS": "0",\n            "article_set-0-id": cls.a1.pk,\n            # there is no title in database, give one here or formset will fail.\n            "article_set-0-title": "Norske bostaver æøå skaper problemer",\n            "article_set-0-content": "&lt;p&gt;Middle content&lt;/p&gt;",\n            "article_set-0-date_0": "2008-03-18",\n            "article_set-0-date_1": "11:54:58",\n            "article_set-0-section": cls.s1.pk,\n            "article_set-1-id": cls.a2.pk,\n            "article_set-1-title": "Need a title.",\n            "article_set-1-content": "&lt;p&gt;Oldest content&lt;/p&gt;",\n            "article_set-1-date_0": "2000-03-18",\n            "article_set-1-date_1": "11:54:58",\n            "article_set-2-id": cls.a3.pk,\n            "article_set-2-title": "Need a title.",\n            "article_set-2-content": "&lt;p&gt;Newest content&lt;/p&gt;",\n            "article_set-2-date_0": "2009-03-18",\n            "article_set-2-date_1": "11:54:58",\n            "article_set-3-id": "",\n            "article_set-3-title": "",\n            "article_set-3-content": "",\n            "article_set-3-date_0": "",\n            "article_set-3-date_1": "",\n            "article_set-4-id": "",\n            "article_set-4-title": "",\n            "article_set-4-content": "",\n            "article_set-4-date_0": "",\n            "article_set-4-date_1": "",\n            "article_set-5-id": "",\n            "article_set-5-title": "",\n            "article_set-5-content": "",\n            "article_set-5-date_0": "",\n            "article_set-5-date_1": "",\n        }\n\n    def setUp(self):\n        self.client.force_login(self.superuser)\n\n    def assertContentBefore(self, response, text1, text2, failing_msg=None):\n        """\n        Testing utility asserting that text1 appears before text2 in response\n        content.\n        """\n        self.assertEqual(response.status_code, 200)\n        self.assertLess(\n            response.content.index(text1.encode()),\n            response.content.index(text2.encode()),\n            (failing_msg or \'\') + \'\\nResponse:\\n\' + response.content.decode(response.charset)\n        )\n\n\nclass AdminViewBasicTest(AdminViewBasicTestCase):\n    def test_trailing_slash_required(self):\n        """\n        If you leave off the trailing slash, app should redirect and add it.\n        """\n        add_url = reverse(\'admin:admin_views_article_add\')\n        response = self.client.get(add_url[:-1])\n        self.assertRedirects(response, add_url, status_code=301)\n\n    def test_basic_add_GET(self):\n        """\n        A smoke test to ensure GET on the add_view works.\n        """\n        response = self.client.get(reverse(\'admin:admin_views_section_add\'))\n        self.assertIsInstance(response, TemplateResponse)\n        self.assertEqual(response.status_code, 200)\n\n    def test_add_with_GET_args(self):\n        response = self.client.get(reverse(\'admin:admin_views_section_add\'), {\'name\': \'My Section\'})\n        self.assertContains(\n            response, \'value="My Section"\',\n            msg_prefix="Couldn\'t find an input with the right value in the response"\n        )\n\n    def test_basic_edit_GET(self):\n        """\n        A smoke test to ensure GET on the change_view works.\n        """\n        response = self.client.get(reverse(\'admin:admin_views_section_change\', args=(self.s1.pk,)))\n        self.assertIsInstance(response, TemplateResponse)\n        self.assertEqual(response.status_code, 200)\n\n    def test_basic_edit_GET_string_PK(self):\n        """\n        GET on the change_view (when passing a string as the PK argument for a\n        model with an integer PK field) redirects to the index page with a\n        message saying the object doesn\'t exist.\n        """\n        response = self.client.get(reverse(\'admin:admin_views_section_change\', args=(quote("abc/<b>"),)), follow=True)\n        self.assertRedirects(response, reverse(\'admin:index\'))\n        self.assertEqual(\n            [m.message for m in response.context[\'messages\']],\n            [\'section with ID “abc/<b>” doesn’t exist. Perhaps it was deleted?\']\n        )\n\n    def test_basic_edit_GET_old_url_redirect(self):\n        """\n        The change URL changed in Django 1.9, but the old one still redirects.\n        """\n        response = self.client.get(\n            reverse(\'admin:admin_views_section_change\', args=(self.s1.pk,)).replace(\'change/\', \'\')\n        )\n        self.assertRedirects(response, reverse(\'admin:admin_views_section_change\', args=(self.s1.pk,)))\n\n    def test_basic_inheritance_GET_string_PK(self):\n        """\n        GET on the change_view (for inherited models) redirects to the index\n        page with a message saying the object doesn\'t exist.\n        """\n        response = self.client.get(reverse(\'admin:admin_views_supervillain_change\', args=(\'abc\',)), follow=True)\n        self.assertRedirects(response, reverse(\'admin:index\'))\n        self.assertEqual(\n            [m.message for m in response.context[\'messages\']],\n            [\'super villain with ID “abc” doesn’t exist. Perhaps it was deleted?\']\n        )\n\n    def test_basic_add_POST(self):\n        """\n        A smoke test to ensure POST on add_view works.\n        """\n        post_data = {\n            "name": "Another Section",\n            # inline data\n            "article_set-TOTAL_FORMS": "3",\n            "article_set-INITIAL_FORMS": "0",\n            "article_set-MAX_NUM_FORMS": "0",\n        }\n        response = self.client.post(reverse(\'admin:admin_views_section_add\'), post_data)\n        self.assertEqual(response.status_code, 302)  # redirect somewhere\n\n    def test_popup_add_POST(self):\n        """\n        Ensure http response from a popup is properly escaped.\n        """\n        post_data = {\n            \'_popup\': \'1\',\n            \'title\': \'title with a new\\nline\',\n            \'content\': \'some content\',\n            \'date_0\': \'2010-09-10\',\n            \'date_1\': \'14:55:39\',\n        }\n        response = self.client.post(reverse(\'admin:admin_views_article_add\'), post_data)\n        self.assertContains(response, \'title with a new\\\\nline\')\n\n    def test_basic_edit_POST(self):\n        """\n        A smoke test to ensure POST on edit_view works.\n        """\n        url = reverse(\'admin:admin_views_section_change\', args=(self.s1.pk,))\n        response = self.client.post(url, self.inline_post_data)\n        self.assertEqual(response.status_code, 302)  # redirect somewhere\n\n    def test_edit_save_as(self):\n        """\n        Test "save as".\n        """\n        post_data = self.inline_post_data.copy()\n        post_data.update({\n            \'_saveasnew\': \'Save+as+new\',\n            "article_set-1-section": "1",\n            "article_set-2-section": "1",\n            "article_set-3-section": "1",\n            "article_set-4-section": "1",\n            "article_set-5-section": "1",\n        })\n        response = self.client.post(reverse(\'admin:admin_views_section_change\', args=(self.s1.pk,)), post_data)\n        self.assertEqual(response.status_code, 302)  # redirect somewhere\n\n    def test_edit_save_as_delete_inline(self):\n        """\n        Should be able to "Save as new" while also deleting an inline.\n        """\n        post_data = self.inline_post_data.copy()\n        post_data.update({\n            \'_saveasnew\': \'Save+as+new\',\n            "article_set-1-section": "1",\n            "article_set-2-section": "1",\n            "article_set-2-DELETE": "1",\n            "article_set-3-section": "1",\n        })\n        response = self.client.post(reverse(\'admin:admin_views_section_change\', args=(self.s1.pk,)), post_data)\n        self.assertEqual(response.status_code, 302)\n        # started with 3 articles, one was deleted.\n        self.assertEqual(Section.objects.latest(\'id\').article_set.count(), 2)\n\n    def test_change_list_column_field_classes(self):\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'))\n        # callables display the callable name.\n        self.assertContains(response, \'column-callable_year\')\n        self.assertContains(response, \'field-callable_year\')\n        # lambdas display as "lambda" + index that they appear in list_display.\n        self.assertContains(response, \'column-lambda8\')\n        self.assertContains(response, \'field-lambda8\')\n\n    def test_change_list_sorting_callable(self):\n        """\n        Ensure we can sort on a list_display field that is a callable\n        (column 2 is callable_year in ArticleAdmin)\n        """\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'), {\'o\': 2})\n        self.assertContentBefore(\n            response, \'Oldest content\', \'Middle content\',\n            "Results of sorting on callable are out of order."\n        )\n        self.assertContentBefore(\n            response, \'Middle content\', \'Newest content\',\n            "Results of sorting on callable are out of order."\n        )\n\n    def test_change_list_sorting_property(self):\n        """\n        Sort on a list_display field that is a property (column 10 is\n        a property in Article model).\n        """\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'), {\'o\': 10})\n        self.assertContentBefore(\n            response,\n            \'Oldest content\',\n            \'Middle content\',\n            \'Results of sorting on property are out of order.\',\n        )\n        self.assertContentBefore(\n            response,\n            \'Middle content\',\n            \'Newest content\',\n            \'Results of sorting on property are out of order.\',\n        )\n\n    def test_change_list_sorting_callable_query_expression(self):\n        """Query expressions may be used for admin_order_field."""\n        tests = [\n            (\'order_by_expression\', 9),\n            (\'order_by_f_expression\', 12),\n            (\'order_by_orderby_expression\', 13),\n        ]\n        for admin_order_field, index in tests:\n            with self.subTest(admin_order_field):\n                response = self.client.get(\n                    reverse(\'admin:admin_views_article_changelist\'),\n                    {\'o\': index},\n                )\n                self.assertContentBefore(\n                    response, \'Oldest content\', \'Middle content\',\n                    \'Results of sorting on callable are out of order.\'\n                )\n                self.assertContentBefore(\n                    response, \'Middle content\', \'Newest content\',\n                    \'Results of sorting on callable are out of order.\'\n                )\n\n    def test_change_list_sorting_callable_query_expression_reverse(self):\n        tests = [\n            (\'order_by_expression\', -9),\n            (\'order_by_f_expression\', -12),\n            (\'order_by_orderby_expression\', -13),\n        ]\n        for admin_order_field, index in tests:\n            with self.subTest(admin_order_field):\n                response = self.client.get(\n                    reverse(\'admin:admin_views_article_changelist\'),\n                    {\'o\': index},\n                )\n                self.assertContentBefore(\n                    response, \'Middle content\', \'Oldest content\',\n                    \'Results of sorting on callable are out of order.\'\n                )\n                self.assertContentBefore(\n                    response, \'Newest content\', \'Middle content\',\n                    \'Results of sorting on callable are out of order.\'\n                )\n\n    def test_change_list_sorting_model(self):\n        """\n        Ensure we can sort on a list_display field that is a Model method\n        (column 3 is \'model_year\' in ArticleAdmin)\n        """\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'), {\'o\': \'-3\'})\n        self.assertContentBefore(\n            response, \'Newest content\', \'Middle content\',\n            "Results of sorting on Model method are out of order."\n        )\n        self.assertContentBefore(\n            response, \'Middle content\', \'Oldest content\',\n            "Results of sorting on Model method are out of order."\n        )\n\n    def test_change_list_sorting_model_admin(self):\n        """\n        Ensure we can sort on a list_display field that is a ModelAdmin method\n        (column 4 is \'modeladmin_year\' in ArticleAdmin)\n        """\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'), {\'o\': \'4\'})\n        self.assertContentBefore(\n            response, \'Oldest content\', \'Middle content\',\n            "Results of sorting on ModelAdmin method are out of order."\n        )\n        self.assertContentBefore(\n            response, \'Middle content\', \'Newest content\',\n            "Results of sorting on ModelAdmin method are out of order."\n        )\n\n    def test_change_list_sorting_model_admin_reverse(self):\n        """\n        Ensure we can sort on a list_display field that is a ModelAdmin\n        method in reverse order (i.e. admin_order_field uses the \'-\' prefix)\n        (column 6 is \'model_year_reverse\' in ArticleAdmin)\n        """\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'), {\'o\': \'6\'})\n        self.assertContentBefore(\n            response, \'2009\', \'2008\',\n            "Results of sorting on ModelAdmin method are out of order."\n        )\n        self.assertContentBefore(\n            response, \'2008\', \'2000\',\n            "Results of sorting on ModelAdmin method are out of order."\n        )\n        # Let\'s make sure the ordering is right and that we don\'t get a\n        # FieldError when we change to descending order\n        response = self.client.get(reverse(\'admin:admin_views_article_changelist\'), {\'o\': \'-6\'})\n        self.assertContentBefore(\n            response, \'2000\', \'2008\',\n            "Results of sorting on ModelAdmin method are out of order."\n        )\n        self.assertContentBefore(\n            response, \'2008\', \'2009\',\n            "Results of sorting on ModelAdmin method are out of order."\n        )\n\n    def test_change_list_sorting_multiple(self):\n        p1 = Person.objects.create(name="Chris", gender=1, alive=True)\n        p2 = Person.objects.create(name="Chris", gender=2, alive=True)\n        p3 = Person.objects.create(name="Bob", gender=1, alive=True)\n        link1 = reverse(\'admin:admin_views_person_change\', args=(p1.pk,))\n        link2 = reverse(\'admin:admin_views_person_change\', args=(p2.pk,))\n        link3 = reverse(\'admin:admin_views_person_change\', args=(p3.pk,))\n\n        # Sort by name, gender\n        response = self.client.get(reverse(\'admin:admin_views_person_changelist\'), {\'o\': \'1.2\'})\n        self.assertContentBefore(response, link3, link1)\n        self.assertContentBefore(response, link1, link2)\n\n        # Sort by gender descending, name\n        response = self.client.get(reverse(\'admin:admin_views_person_changelist\'), {\'o\': \'-2.1\'})\n        self.assertContentBefore(response, link2, link3)\n        self.assertContentBefore(response, link3, link1)\n\n    def test_change_list_sorting_preserve_queryset_ordering(self):\n        """\n        If no ordering is defined in `ModelAdmin.ordering` or in the query\n        string, then the underlying order of the queryset should not be\n        changed, even if it is defined in `Modeladmin.get_queryset()`.\n        Refs #11868, #7309.\n        """\n        p1 = Person.objects.create(name="Amy", gender=1, alive=True, age=80)\n        p2 = Person.objects.create(name="Bob", gender=1, alive=True, age=70)\n        p3 = Person.objects.create(name="Chris", gender=2, alive=False, age=60)\n        link1 = reverse(\'admin:admin_views_person_change\', args=(p1.pk,))\n        link2 = reverse(\'admin:admin_views_person_change\', args=(p2.pk,))\n        link3 = reverse(\'admin:admin_views_person_change\', args=(p3.pk,))\n\n        response = self.client.get(reverse(\'admin:admin_views_person_changelist\'), {})\n        self.assertContentBefore(response, link3, link2)\n        self.assertContentBefore(response, link2, link1)\n</test_case>\n<test_case>\n# File: tests/admin_widgets/tests.py\nimport gettext\nimport os\nimport re\nfrom datetime import datetime, timedelta\nfrom importlib import import_module\n\nimport pytz\n\nfrom django import forms\nfrom django.conf import settings\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.contrib.admin.tests import AdminSeleniumTestCase\nfrom django.contrib.auth.models import User\nfrom django.core.files.storage import default_storage\nfrom django.core.files.uploadedfile import SimpleUploadedFile\nfrom django.db.models import CharField, DateField, DateTimeField, UUIDField\nfrom django.test import SimpleTestCase, TestCase, override_settings\nfrom django.urls import reverse\nfrom django.utils import translation\n\nfrom .models import (\n    Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,\n    Inventory, Member, MyFileField, Profile, School, Student,\n)\nfrom .widgetadmin import site as widget_admin_site\n\n\nclass TestDataMixin:\n\n    @classmethod\n    def setUpTestData(cls):\n        cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=None)\n        cls.u2 = User.objects.create_user(username=\'testser\', password=\'secret\')\n        Car.objects.create(owner=cls.superuser, make=\'Volkswagen\', model=\'Passat\')\n        Car.objects.create(owner=cls.u2, make=\'BMW\', model=\'M3\')\n\n\nclass AdminFormfieldForDBFieldTests(SimpleTestCase):\n    """\n    Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n    """\n\n    def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n        """\n        Helper to call formfield_for_dbfield for a given model and field name\n        and verify that the returned formfield is appropriate.\n        """\n        # Override any settings on the model admin\n        class MyModelAdmin(admin.ModelAdmin):\n            pass\n        for k in admin_overrides:\n            setattr(MyModelAdmin, k, admin_overrides[k])\n\n        # Construct the admin, and ask it for a formfield\n        ma = MyModelAdmin(model, admin.site)\n        ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n\n        # "unwrap" the widget wrapper, if needed\n        if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n            widget = ff.widget.widget\n        else:\n            widget = ff.widget\n\n        self.assertIsInstance(widget, widgetclass)\n\n        # Return the formfield so that other tests can continue\n        return ff\n\n    def test_DateField(self):\n        self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n\n    def test_DateTimeField(self):\n        self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n\n    def test_TimeField(self):\n        self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n\n    def test_TextField(self):\n        self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n\n    def test_URLField(self):\n        self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n\n    def test_IntegerField(self):\n        self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n\n    def test_CharField(self):\n        self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n\n    def test_EmailField(self):\n        self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n\n    def test_FileField(self):\n        self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n\n    def test_ForeignKey(self):\n        self.assertFormfield(Event, \'main_band\', forms.Select)\n\n    def test_raw_id_ForeignKey(self):\n        self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n                             raw_id_fields=[\'main_band\'])\n\n    def test_radio_fields_ForeignKey(self):\n        ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n                                  radio_fields={\'main_band\': admin.VERTICAL})\n        self.assertIsNone(ff.empty_label)\n\n    def test_many_to_many(self):\n        self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n\n    def test_raw_id_many_to_many(self):\n        self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n                             raw_id_fields=[\'members\'])\n\n    def test_filtered_many_to_many(self):\n        self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n                             filter_vertical=[\'members\'])\n\n    def test_formfield_overrides(self):\n        self.assertFormfield(Event, \'start_date\', forms.TextInput,\n                             formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n\n    def test_formfield_overrides_widget_instances(self):\n        """\n        Widget instances in formfield_overrides are not shared between\n        different fields. (#19423)\n        """\n        class BandAdmin(admin.ModelAdmin):\n            formfield_overrides = {\n                CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n            }\n        ma = BandAdmin(Band, admin.site)\n        f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n        f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n        self.assertNotEqual(f1.widget, f2.widget)\n        self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n        self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n        self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n\n    def test_formfield_overrides_for_datetime_field(self):\n        """\n        Overriding the widget for DateTimeField doesn\'t overrides the default\n        form_class for that field (#26449).\n        """\n        class MemberAdmin(admin.ModelAdmin):\n            formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n        ma = MemberAdmin(Member, admin.site)\n        f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n        self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n        self.assertIsInstance(f1, forms.SplitDateTimeField)\n\n    def test_formfield_overrides_for_custom_field(self):\n        """\n        formfield_overrides works for a custom field class.\n        """\n        class AlbumAdmin(admin.ModelAdmin):\n            formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n        ma = AlbumAdmin(Member, admin.site)\n        f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n        self.assertIsInstance(f1.widget, forms.TextInput)\n\n    def test_field_with_choices(self):\n        self.assertFormfield(Member, \'gender\', forms.Select)\n\n    def test_choices_with_radio_fields(self):\n        self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n                             radio_fields={\'gender\': admin.VERTICAL})\n\n    def test_inheritance(self):\n        self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n\n    def test_m2m_widgets(self):\n        """m2m fields help text as it applies to admin app (#9321)."""\n        class AdvisorAdmin(admin.ModelAdmin):\n            filter_vertical = [\'companies\']\n\n        self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n                             filter_vertical=[\'companies\'])\n        ma = AdvisorAdmin(Advisor, admin.site)\n        f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n        self.assertEqual(\n            f.help_text,\n            \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n        )\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):\n\n    def test_filter_choices_by_request_user(self):\n        """\n        Ensure the user can only see their own cars in the foreign key dropdown.\n        """\n        self.client.force_login(self.superuser)\n        response = self.client.get(reverse(\'admin:admin_widgets_cartire_add\'))\n        self.assertNotContains(response, "BMW M3")\n        self.assertContains(response, "Volkswagen Passat")\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):\n\n    def setUp(self):\n        self.client.force_login(self.superuser)\n\n    def test_changelist_ForeignKey(self):\n        response = self.client.get(reverse(\'admin:admin_widgets_car_changelist\'))\n        self.assertContains(response, \'/auth/user/add/\')\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):\n\n    def setUp(self):\n        self.client.force_login(self.superuser)\n\n    def test_nonexistent_target_id(self):\n        band = Band.objects.create(name=\'Bogey Blues\')\n        pk = band.pk\n        band.delete()\n        post_data = {\n            "main_band": \'%s\' % pk,\n        }\n        # Try posting with a nonexistent pk in a raw id field: this\n        # should result in an error message, not a server exception.\n        response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), post_data)\n        self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n\n    def test_invalid_target_id(self):\n\n        for test_str in (\'Iñtërnâtiônàlizætiøn\', "1234\'", -1234):\n            # This should result in an error message, not a server exception.\n            response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), {"main_band": test_str})\n\n            self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n\n    def test_url_params_from_lookup_dict_any_iterable(self):\n        lookup1 = widgets.url_params_from_lookup_dict({\'color__in\': (\'red\', \'blue\')})\n        lookup2 = widgets.url_params_from_lookup_dict({\'color__in\': [\'red\', \'blue\']})\n        self.assertEqual(lookup1, {\'color__in\': \'red,blue\'})\n        self.assertEqual(lookup1, lookup2)\n\n    def test_url_params_from_lookup_dict_callable(self):\n        def my_callable():\n            return \'works\'\n        lookup1 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable})\n        lookup2 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable()})\n        self.assertEqual(lookup1, lookup2)\n\n    def test_label_and_url_for_value_invalid_uuid(self):\n        field = Bee._meta.get_field(\'honeycomb\')\n        self.assertIsInstance(field.target_field, UUIDField)\n        widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)\n        self.assertEqual(widget.label_and_url_for_value(\'invalid-uuid\'), (\'\', \'\'))\n\n\nclass FilteredSelectMultipleWidgetTest(SimpleTestCase):\n    def test_render(self):\n        # Backslash in verbose_name to ensure it is JavaScript escaped.\n        w = widgets.FilteredSelectMultiple(\'test\\\\\\\\\', False)\n        self.assertHTMLEqual(\n            w.render(\'test\', \'test\'),\n            \'<select multiple name="test" class="selectfilter" \'\n            \'data-field-name="test\\\\\\\\" data-is-stacked="0">\\\\n</select>\'\n        )\n\n    def test_stacked_render(self):\n        # Backslash in verbose_name to ensure it is JavaScript escaped.\n        w = widgets.FilteredSelectMultiple(\'test\\\\\\\\\', True)\n        self.assertHTMLEqual(\n            w.render(\'test\', \'test\'),\n            \'<select multiple name="test" class="selectfilterstacked" \'\n            \'data-field-name="test\\\\\\\\" data-is-stacked="1">\\\\n</select>\'\n        )\n\n\nclass AdminDateWidgetTest(SimpleTestCase):\n    def test_attrs(self):\n        w = widgets.AdminDateWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">\',\n        )\n        # pass attrs to widget\n        w = widgets.AdminDateWidget(attrs={\'size\': 20, \'class\': \'myDateField\'})\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">\',\n        )\n\n\nclass AdminTimeWidgetTest(SimpleTestCase):\n    def test_attrs(self):\n        w = widgets.AdminTimeWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">\',\n        )\n        # pass attrs to widget\n        w = widgets.AdminTimeWidget(attrs={\'size\': 20, \'class\': \'myTimeField\'})\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">\',\n        )\n\n\nclass AdminSplitDateTimeWidgetTest(SimpleTestCase):\n    def test_render(self):\n        w = widgets.AdminSplitDateTime()\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<p class="datetime">\'\n            \'Date: <input value="2007-12-01" type="text" class="vDateField" \'\n            \'name="test_0" size="10"><br>\'\n            \'Time: <input value="09:30:00" type="text" class="vTimeField" \'\n            \'name="test_1" size="8"></p>\'\n        )\n\n    def test_localization(self):\n        w = widgets.AdminSplitDateTime()\n\n        with self.settings(USE_L10N=True), translation.override(\'de-at\'):\n            w.is_localized = True\n            self.assertHTMLEqual(\n                w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n                \'<p class="datetime">\'\n                \'Datum: <input value="01.12.2007" type="text" \'\n                \'class="vDateField" name="test_0"size="10"><br>\'\n                \'Zeit: <input value="09:30:00" type="text" class="vTimeField" \'\n                \'name="test_1" size="8"></p>\'\n            )\n\n\nclass AdminURLWidgetTest(SimpleTestCase):\n    def test_get_context_validates_url(self):\n        w = widgets.AdminURLFieldWidget()\n        for invalid in [\'\', \'/not/a/full/url/\', \'javascript:alert("Danger XSS!")\']:\n            with self.subTest(url=invalid):\n                self.assertFalse(w.get_context(\'name\', invalid, {})[\'url_valid\'])\n        self.assertTrue(w.get_context(\'name\', \'http://example.com\', {})[\'url_valid\'])\n\n    def test_render(self):\n        w = widgets.AdminURLFieldWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', \'\'),\n            \'<input class="vURLField" name="test" type="url">\'\n        )\n        self.assertHTMLEqual(\n            w.render(\'test\', \'http://example.com\'),\n            \'<p class="url">Currently:<a href="http://example.com">\'\n            \'http://example.com</a><br>\'\n            \'Change:<input class="vURLField" name="test" type="url" \'\n            \'value="http://example.com"></p>\'\n        )\n\n    def test_render_idn(self):\n        w = widgets.AdminURLFieldWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', \'http://example-äüö.com\'),\n            \'<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">\'\n            \'http://example-äüö.com</a><br>\'\n            \'Change:<input class="vURLField" name="test" type="url" \'\n            \'value="http://example-äüö.com"></p>\'\n        )\n\n    def test_render_quoting(self):\n        """\n        WARNING: This test doesn\'t use assertHTMLEqual since it will get rid\n        of some escapes which are tested here!\n        """\n        HREF_RE = re.compile(\'href="([^"]+)"\')\n        VALUE_RE = re.compile(\'value="([^"]+)"\')\n        TEXT_RE = re.compile(\'<a[^>]+>([^>]+)</a>\')\n        w = widgets.AdminURLFieldWidget()\n        output = w.render(\'test\', \'http://example.com/<sometag>some-text</sometag>\')\n        self.assertEqual(\n            HREF_RE.search(output).groups()[0],\n            \'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n        )\n        self.assertEqual(\n            TEXT_RE.search(output).groups()[0],\n            \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        self.assertEqual(\n            VALUE_RE.search(output).groups()[0],\n            \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        output = w.render(\'test\', \'http://example-äüö.com/<sometag>some-text</sometag>\')\n        self.assertEqual(\n            HREF_RE.search(output).groups()[0],\n            \'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n        )\n        self.assertEqual(\n            TEXT_RE.search(output).groups()[0],\n            \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        self.assertEqual(\n            VALUE_RE.search(output).groups()[0],\n            \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        output = w.render(\'test\', \'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"\')\n        self.assertEqual(\n            HREF_RE.search(output).groups()[0],\n            \'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22\',\n        )\n        self.assertEqual(\n            TEXT_RE.search(output).groups()[0],\n            \'http://www.example.com/%C3%A4"&gt;&lt;script&gt;\'\n            \'alert(&quot;XSS!&quot;)&lt;/script&gt;"\'\n        )\n        self.assertEqual(\n            VALUE_RE.search(output).groups()[0],\n            \'http://www.example.com/%C3%A4"&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;"\',\n        )\n\n\nclass AdminUUIDWidgetTests(SimpleTestCase):\n    def test_attrs(self):\n        w = widgets.AdminUUIDInputWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n            \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">\',\n        )\n        w = widgets.AdminUUIDInputWidget(attrs={\'class\': \'myUUIDInput\'})\n        self.assertHTMLEqual(\n            w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n            \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">\',\n        )\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminFileWidgetTests(TestDataMixin, TestCase):\n\n    @classmethod\n    def setUpTestData(cls):\n        super().setUpTestData()\n        band = Band.objects.create(name=\'Linkin Park\')\n        cls.album = band.album_set.create(\n            name=\'Hybrid Theory\', cover_art=r\'albums\\\\hybrid_theory.jpg\'\n        )\n\n    def test_render(self):\n        w = widgets.AdminFileWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', self.album.cover_art),\n            \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n            r\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a> \'\n            \'<span class="clearable-file-input">\'\n            \'<input type="checkbox" name="test-clear" id="test-clear_id"> \'\n            \'<label for="test-clear_id">Clear</label></span><br>\'\n            \'Change: <input type="file" name="test"></p>\' % {\n                \'STORAGE_URL\': default_storage.url(\'\'),\n            },\n        )\n        self.assertHTMLEqual(\n            w.render(\'test\', SimpleUploadedFile(\'test\', b\'content\')),\n            \'<input type="file" name="test">\',\n        )\n\n    def test_render_required(self):\n        widget = widgets.AdminFileWidget()\n        widget.is_required = True\n        self.assertHTMLEqual(\n            widget.render(\'test\', self.album.cover_art),\n            \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n            r\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a><br>\'\n            \'Change: <input type="file" name="test"></p>\' % {\n                \'STORAGE_URL\': default_storage.url(\'\'),\n            },\n        )\n\n    def test_readonly_fields(self):\n        """\n        File widgets should render as a link when they\'re marked "read only."\n        """\n        self.client.force_login(self.superuser)\n        response = self.client.get(reverse(\'admin:admin_widgets_album_change\', args=(self.album.id,)))\n        self.assertContains(\n            response,\n            \'<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">\'\n            r\'albums\\\\hybrid_theory.jpg</a></div>\' % {\'STORAGE_URL\': default_storage.url(\'\')},\n            html=True,\n        )\n        self.assertNotContains(\n            response,\n            \'<input type="file" name="cover_art" id="id_cover_art">\',\n            html=True,\n        )\n        response = self.client.get(reverse(\'admin:admin_widgets_album_add\'))\n        self.assertContains(\n            response,\n            \'<div class="readonly"></div>\',\n            html=True,\n        )\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass ForeignKeyRawIdWidgetTest(TestCase):\n    def test_label_for_value_does_not_exist(self):\n        """\n        The label should be an empty string if the related object\n        doesn\'t exist.\n        """\n        band = Band.objects.create(name=\'The Beatles\')\n        rel = Event._meta.get_field(\'main_band\').remote_field\n        widget = widgets.ForeignKeyRawIdWidget(rel, admin_site=admin.site)\n        widget.label_and_url_for_value(band.pk)\n        band.delete()\n        label, url = widget.label_and_url_for_value(band.pk)\n        self.assertEqual(label, \'\')\n\n    def test_label_for_value_from_field_get_choices(self):\n        """\n        The label should be fetched from the field\'s `get_choices()` rather than\n        the widget\'s `choices` if the widget\'s choices are not set. This allows\n        `limit_choices_to` to be respected.\n        """\n        school = School.objects.create(name=\'School\')\n        student = Student.objects.create(name=\'Student\', school=school)\n        field = student._meta.get_field(\'school\')\n        rel = field.remote_field\n        widget = widgets.ForeignKeyRawIdWidget(rel, admin_site=admin.site)\n        # Remove the widget\'s choices to simulate the case where they aren\'t\n        # loaded yet.\n        widget.choices = None\n        label, url = widget.label_and_url_for_value(school.pk)\n        self.assertEqual(label, str(school))\n\n    def test_render_related_url_for_inlines(self):\n        """\n        The related URL for a `ForeignKeyRawIdWidget` in an inline should be\n        correct.\n        """\n        rel = Car._meta.get_field(\'owner\').remote_field\n        widget = widgets.ForeignKeyRawIdWidget(rel, admin_site=admin.site)\n        related_url = widget.get_related_url(rel, \'test\')\n        self.assertIn(\'/admin_widgets/car/?_to_field=id&owner__id__exact=test\', related_url)\n\n\nclass ManyToManyRawIdWidgetTest(TestCase):\n    def test_label_for_value_from_field_get_choices(self):\n        """\n        The label should be fetched from the field\'s `get_choices()` rather than\n        the widget\'s `choices` if the widget\'s choices are not set. This allows\n        `limit_choices_to` to be respected.\n        """\n        school = School.objects.create(name=\'School\')\n        student = Student.objects.create(name=\'Student\')\n        student.schools.add(school)\n        field = student._meta.get_field(\'schools\')\n        rel = field.remote_field\n        widget = widgets.ManyToManyRawIdWidget(rel, admin_site=admin.site)\n        # Remove the widget\'s choices to simulate the case where they aren\'t\n        # loaded yet.\n        widget.choices = None\n        label, url = widget.label_and_url_for_value([school.pk])\n        self.assertEqual(label, str(school))\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AutocompleteTests(AdminSeleniumTestCase):\n    available_apps = [\'admin_widgets\'] + AdminSeleniumTestCase.available_apps\n\n    @classmethod\n    def setUpTestData(cls):\n        super().setUpTestData()\n        cls.superuser = User.objects.create_superuser(\'super\', \'super@example.com\', \'secret\')\n        cls.school = School.objects.create(name=\'MIT\')\n        cls.student = Student.objects.create(name=\'John\', school=cls.school)\n\n    def test_fk_autocomplete(self):\n        self.admin_login(\'super\', \'secret\')\n        self.selenium.get(self.live_server_url + reverse(\'admin:admin_widgets_student_add\'))\n        self.selenium.find_element_by_id(\'id_school_to_field\')\n        self.selenium.find_element_by_css_selector(\'.select2-container\').click()\n        self.selenium.find_element_by_css_selector(\'.select2-search__field\').send_keys(\'mi\')\n        self.wait_for_page_to_load_and_contain_text(\'.select2-results__option\', \'MIT\')\n        self.selenium.find_element_by_css_selector(\'.select2-results__option\').click()\n        self.selenium.find_element_by_name(\'_save\').click()\n        self.wait_for_text(\'.success\', \'was added successfully\')\n        student = Student.objects.latest(\'pk\')\n        self.assertEqual(student.name, \'\')  # Name is not required.\n        self.assertEqual(student.school.name, \'MIT\')\n\n    def test_m2m_autocomplete(self):\n        self.admin_login(\'super\', \'secret\')\n        self.selenium.get(self.live_server_url + reverse(\'admin:admin_widgets_student_add\'))\n        self.selenium.find_element_by_css_selector(\'#id_schools_to_field\')\n        self.selenium.find_element_by_css_selector(\'.select2-container\').click()\n        self.selenium.find_element_by_css_selector(\'.select2-search__field\').send_keys(\'mi\')\n        self.wait_for_page_to_load_and_contain_text(\'.select2-results__option\', \'MIT\')\n        self.selenium.find_element_by_css_selector(\'.select2-results__option\').click()\n        self.selenium.find_element_by_name(\'_save\').click()\n        self.wait_for_text(\'.success\', \'was added successfully\')\n        student = Student.objects.latest(\'pk\')\n        self.assertEqual(student.name, \'\')  # Name is not required.\n        self.assertEqual(student.schools.first().name, \'MIT\')\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass RelatedFieldWidgetWrapperTests(SimpleTestCase):\n    def test_no_can_add_related(self):\n        rel = Individual._meta.get_field(\'parent\').remote_field\n        w = widgets.AdminRadioSelect()\n        # Used to fail with a name error.\n        w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n        self.assertFalse(w.can_add_related)\n\n    def test_select_multiple_widget_cant_change_delete_related(self):\n        rel = Individual._meta.get_field(\'parent\').remote_field\n        widget = forms.SelectMultiple()\n        wrapper = widgets.RelatedFieldWidgetWrapper(\n            widget, rel, widget_admin_site,\n            can_add_related=True,\n            can_change_related=True,\n            can_delete_related=True,\n        )\n        self.assertTrue(wrapper.can_add_related)\n        self.assertFalse(wrapper.can_change_related)\n        self.assertFalse(wrapper.can_delete_related)\n\n    def test_on_delete_cascade_rel_cant_delete_related(self):\n        rel = Individual._meta.get_field(\'soulmate\').remote_field\n        widget = forms.Select()\n        wrapper = widgets.RelatedFieldWidgetWrapper(\n            widget, rel, widget_admin_site,\n            can_add_related=True,\n            can_change_related=True,\n            can_delete_related=True,\n        )\n        self.assertTrue(wrapper.can_add_related)\n        self.assertTrue(wrapper.can_change_related)\n        self.assertFalse(wrapper.can_delete_related)\n\n    def test_custom_widget_render(self):\n        class CustomWidget(forms.Select):\n            def render(self, *args, **kwargs):\n                return \'custom render output\'\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = CustomWidget()\n        wrapper = widgets.RelatedFieldWidgetWrapper(\n            widget, rel, widget_admin_site,\n            can_add_related=True,\n            can_change_related=True,\n            can_delete_related=True,\n        )\n        output = wrapper.render(\'name\', \'value\')\n        self.assertIn(\'custom render output\', output)\n\n    def test_widget_delegates_value_omitted_from_data(self):\n        class CustomWidget(forms.Select):\n            def value_omitted_from_data(self, data, files, name):\n                return False\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = CustomWidget()\n        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n        self.assertIs(wrapper.value_omitted_from_data({}, {}, \'band\'), False)\n\n    def test_widget_is_hidden(self):\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = forms.HiddenInput()\n        widget.choices = ()\n        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n        self.assertIs(wrapper.is_hidden, True)\n        context = wrapper.get_context(\'band\', None, {})\n        self.assertIs(context[\'is_hidden\'], True)\n        output = wrapper.render(\'name\', \'value\')\n        # Related item links are hidden.\n        self.assertNotIn(\'<a \', output)\n\n    def test_widget_is_not_hidden(self):\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = forms.Select()\n        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n        self.assertIs(wrapper.is_hidden, False)\n        context = wrapper.get_context(\'band\', None, {})\n        self.assertIs(context[\'is_hidden\'], False)\n        output = wrapper.render(\'name\', \'value\')\n        # Related item links are present.\n        self.assertIn(\'<a \', output)\n</test_case>\n<test_case>\n# File: tests/admin_widgets/tests.py\nimport gettext\nimport os\nimport re\nfrom datetime import datetime, timedelta\nfrom importlib import import_module\n\nimport pytz\n\nfrom django import forms\nfrom django.conf import settings\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.contrib.admin.tests import AdminSeleniumTestCase\nfrom django.contrib.auth.models import User\nfrom django.core.files.storage import default_storage\nfrom django.core.files.uploadedfile import SimpleUploadedFile\nfrom django.db.models import CharField, DateField, DateTimeField, UUIDField\nfrom django.test import SimpleTestCase, TestCase, override_settings\nfrom django.urls import reverse\nfrom django.utils import translation\n\nfrom .models import (\n    Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,\n    Inventory, Member, MyFileField, Profile, School, Student,\n)\nfrom .widgetadmin import site as widget_admin_site\n\n\nclass TestDataMixin:\n\n    @classmethod\n    def setUpTestData(cls):\n        cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=None)\n        cls.u2 = User.objects.create_user(username=\'testser\', password=\'secret\')\n        Car.objects.create(owner=cls.superuser, make=\'Volkswagen\', model=\'Passat\')\n        Car.objects.create(owner=cls.u2, make=\'BMW\', model=\'M3\')\n\n\nclass AdminFormfieldForDBFieldTests(SimpleTestCase):\n    """\n    Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n    """\n\n    def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n        """\n        Helper to call formfield_for_dbfield for a given model and field name\n        and verify that the returned formfield is appropriate.\n        """\n        # Override any settings on the model admin\n        class MyModelAdmin(admin.ModelAdmin):\n            pass\n        for k in admin_overrides:\n            setattr(MyModelAdmin, k, admin_overrides[k])\n\n        # Construct the admin, and ask it for a formfield\n        ma = MyModelAdmin(model, admin.site)\n        ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n\n        # "unwrap" the widget wrapper, if needed\n        if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n            widget = ff.widget.widget\n        else:\n            widget = ff.widget\n\n        self.assertIsInstance(widget, widgetclass)\n\n        # Return the formfield so that other tests can continue\n        return ff\n\n    def test_DateField(self):\n        self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n\n    def test_DateTimeField(self):\n        self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n\n    def test_TimeField(self):\n        self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n\n    def test_TextField(self):\n        self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n\n    def test_URLField(self):\n        self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n\n    def test_IntegerField(self):\n        self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n\n    def test_CharField(self):\n        self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n\n    def test_EmailField(self):\n        self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n\n    def test_FileField(self):\n        self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n\n    def test_ForeignKey(self):\n        self.assertFormfield(Event, \'main_band\', forms.Select)\n\n    def test_raw_id_ForeignKey(self):\n        self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n                             raw_id_fields=[\'main_band\'])\n\n    def test_radio_fields_ForeignKey(self):\n        ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n                                  radio_fields={\'main_band\': admin.VERTICAL})\n        self.assertIsNone(ff.empty_label)\n\n    def test_many_to_many(self):\n        self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n\n    def test_raw_id_many_to_many(self):\n        self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n                             raw_id_fields=[\'members\'])\n\n    def test_filtered_many_to_many(self):\n        self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n                             filter_vertical=[\'members\'])\n\n    def test_formfield_overrides(self):\n        self.assertFormfield(Event, \'start_date\', forms.TextInput,\n                             formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n\n    def test_formfield_overrides_widget_instances(self):\n        """\n        Widget instances in formfield_overrides are not shared between\n        different fields. (#19423)\n        """\n        class BandAdmin(admin.ModelAdmin):\n            formfield_overrides = {\n                CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n            }\n        ma = BandAdmin(Band, admin.site)\n        f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n        f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n        self.assertNotEqual(f1.widget, f2.widget)\n        self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n        self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n        self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n\n    def test_formfield_overrides_for_datetime_field(self):\n        """\n        Overriding the widget for DateTimeField doesn\'t overrides the default\n        form_class for that field (#26449).\n        """\n        class MemberAdmin(admin.ModelAdmin):\n            formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n        ma = MemberAdmin(Member, admin.site)\n        f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n        self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n        self.assertIsInstance(f1, forms.SplitDateTimeField)\n\n    def test_formfield_overrides_for_custom_field(self):\n        """\n        formfield_overrides works for a custom field class.\n        """\n        class AlbumAdmin(admin.ModelAdmin):\n            formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n        ma = AlbumAdmin(Member, admin.site)\n        f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n        self.assertIsInstance(f1.widget, forms.TextInput)\n\n    def test_field_with_choices(self):\n        self.assertFormfield(Member, \'gender\', forms.Select)\n\n    def test_choices_with_radio_fields(self):\n        self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n                             radio_fields={\'gender\': admin.VERTICAL})\n\n    def test_inheritance(self):\n        self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n\n    def test_m2m_widgets(self):\n        """m2m fields help text as it applies to admin app (#9321)."""\n        class AdvisorAdmin(admin.ModelAdmin):\n            filter_vertical = [\'companies\']\n\n        self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n                             filter_vertical=[\'companies\'])\n        ma = AdvisorAdmin(Advisor, admin.site)\n        f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n        self.assertEqual(\n            f.help_text,\n            \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n        )\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):\n\n    def test_filter_choices_by_request_user(self):\n        """\n        Ensure the user can only see their own cars in the foreign key dropdown.\n        """\n        self.client.force_login(self.superuser)\n        response = self.client.get(reverse(\'admin:admin_widgets_cartire_add\'))\n        self.assertNotContains(response, "BMW M3")\n        self.assertContains(response, "Volkswagen Passat")\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):\n\n    def setUp(self):\n        self.client.force_login(self.superuser)\n\n    def test_changelist_ForeignKey(self):\n        response = self.client.get(reverse(\'admin:admin_widgets_car_changelist\'))\n        self.assertContains(response, \'/auth/user/add/\')\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):\n\n    def setUp(self):\n        self.client.force_login(self.superuser)\n\n    def test_nonexistent_target_id(self):\n        band = Band.objects.create(name=\'Bogey Blues\')\n        pk = band.pk\n        band.delete()\n        post_data = {\n            "main_band": \'%s\' % pk,\n        }\n        # Try posting with a nonexistent pk in a raw id field: this\n        # should result in an error message, not a server exception.\n        response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), post_data)\n        self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n\n    def test_invalid_target_id(self):\n\n        for test_str in (\'Iñtërnâtiônàlizætiøn\', "1234\'", -1234):\n            # This should result in an error message, not a server exception.\n            response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), {"main_band": test_str})\n\n            self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n\n    def test_url_params_from_lookup_dict_any_iterable(self):\n        lookup1 = widgets.url_params_from_lookup_dict({\'color__in\': (\'red\', \'blue\')})\n        lookup2 = widgets.url_params_from_lookup_dict({\'color__in\': [\'red\', \'blue\']})\n        self.assertEqual(lookup1, {\'color__in\': \'red,blue\'})\n        self.assertEqual(lookup1, lookup2)\n\n    def test_url_params_from_lookup_dict_callable(self):\n        def my_callable():\n            return \'works\'\n        lookup1 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable})\n        lookup2 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable()})\n        self.assertEqual(lookup1, lookup2)\n\n    def test_label_and_url_for_value_invalid_uuid(self):\n        field = Bee._meta.get_field(\'honeycomb\')\n        self.assertIsInstance(field.target_field, UUIDField)\n        widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)\n        self.assertEqual(widget.label_and_url_for_value(\'invalid-uuid\'), (\'\', \'\'))\n\n\nclass FilteredSelectMultipleWidgetTest(SimpleTestCase):\n    def test_render(self):\n        # Backslash in verbose_name to ensure it is JavaScript escaped.\n        w = widgets.FilteredSelectMultiple(\'test\\\\\\\\\', False)\n        self.assertHTMLEqual(\n            w.render(\'test\', \'test\'),\n            \'<select multiple name="test" class="selectfilter" \'\n            \'data-field-name="test\\\\\\\\" data-is-stacked="0">\\\\n</select>\'\n        )\n\n    def test_stacked_render(self):\n        # Backslash in verbose_name to ensure it is JavaScript escaped.\n        w = widgets.FilteredSelectMultiple(\'test\\\\\\\\\', True)\n        self.assertHTMLEqual(\n            w.render(\'test\', \'test\'),\n            \'<select multiple name="test" class="selectfilterstacked" \'\n            \'data-field-name="test\\\\\\\\" data-is-stacked="1">\\\\n</select>\'\n        )\n\n\nclass AdminDateWidgetTest(SimpleTestCase):\n    def test_attrs(self):\n        w = widgets.AdminDateWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">\',\n        )\n        # pass attrs to widget\n        w = widgets.AdminDateWidget(attrs={\'size\': 20, \'class\': \'myDateField\'})\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">\',\n        )\n\n\nclass AdminTimeWidgetTest(SimpleTestCase):\n    def test_attrs(self):\n        w = widgets.AdminTimeWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">\',\n        )\n        # pass attrs to widget\n        w = widgets.AdminTimeWidget(attrs={\'size\': 20, \'class\': \'myTimeField\'})\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">\',\n        )\n\n\nclass AdminSplitDateTimeWidgetTest(SimpleTestCase):\n    def test_render(self):\n        w = widgets.AdminSplitDateTime()\n        self.assertHTMLEqual(\n            w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n            \'<p class="datetime">\'\n            \'Date: <input value="2007-12-01" type="text" class="vDateField" \'\n            \'name="test_0" size="10"><br>\'\n            \'Time: <input value="09:30:00" type="text" class="vTimeField" \'\n            \'name="test_1" size="8"></p>\'\n        )\n\n    def test_localization(self):\n        w = widgets.AdminSplitDateTime()\n\n        with self.settings(USE_L10N=True), translation.override(\'de-at\'):\n            w.is_localized = True\n            self.assertHTMLEqual(\n                w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n                \'<p class="datetime">\'\n                \'Datum: <input value="01.12.2007" type="text" \'\n                \'class="vDateField" name="test_0"size="10"><br>\'\n                \'Zeit: <input value="09:30:00" type="text" class="vTimeField" \'\n                \'name="test_1" size="8"></p>\'\n            )\n\n\nclass AdminURLWidgetTest(SimpleTestCase):\n    def test_get_context_validates_url(self):\n        w = widgets.AdminURLFieldWidget()\n        for invalid in [\'\', \'/not/a/full/url/\', \'javascript:alert("Danger XSS!")\']:\n            with self.subTest(url=invalid):\n                self.assertFalse(w.get_context(\'name\', invalid, {})[\'url_valid\'])\n        self.assertTrue(w.get_context(\'name\', \'http://example.com\', {})[\'url_valid\'])\n\n    def test_render(self):\n        w = widgets.AdminURLFieldWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', \'\'),\n            \'<input class="vURLField" name="test" type="url">\'\n        )\n        self.assertHTMLEqual(\n            w.render(\'test\', \'http://example.com\'),\n            \'<p class="url">Currently:<a href="http://example.com">\'\n            \'http://example.com</a><br>\'\n            \'Change:<input class="vURLField" name="test" type="url" \'\n            \'value="http://example.com"></p>\'\n        )\n\n    def test_render_idn(self):\n        w = widgets.AdminURLFieldWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', \'http://example-äüö.com\'),\n            \'<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">\'\n            \'http://example-äüö.com</a><br>\'\n            \'Change:<input class="vURLField" name="test" type="url" \'\n            \'value="http://example-äüö.com"></p>\'\n        )\n\n    def test_render_quoting(self):\n        """\n        WARNING: This test doesn\'t use assertHTMLEqual since it will get rid\n        of some escapes which are tested here!\n        """\n        HREF_RE = re.compile(\'href="([^"]+)"\')\n        VALUE_RE = re.compile(\'value="([^"]+)"\')\n        TEXT_RE = re.compile(\'<a[^>]+>([^>]+)</a>\')\n        w = widgets.AdminURLFieldWidget()\n        output = w.render(\'test\', \'http://example.com/<sometag>some-text</sometag>\')\n        self.assertEqual(\n            HREF_RE.search(output).groups()[0],\n            \'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n        )\n        self.assertEqual(\n            TEXT_RE.search(output).groups()[0],\n            \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        self.assertEqual(\n            VALUE_RE.search(output).groups()[0],\n            \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        output = w.render(\'test\', \'http://example-äüö.com/<sometag>some-text</sometag>\')\n        self.assertEqual(\n            HREF_RE.search(output).groups()[0],\n            \'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n        )\n        self.assertEqual(\n            TEXT_RE.search(output).groups()[0],\n            \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        self.assertEqual(\n            VALUE_RE.search(output).groups()[0],\n            \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n        )\n        output = w.render(\'test\', \'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"\')\n        self.assertEqual(\n            HREF_RE.search(output).groups()[0],\n            \'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22\',\n        )\n        self.assertEqual(\n            TEXT_RE.search(output).groups()[0],\n            \'http://www.example.com/%C3%A4"&gt;&lt;script&gt;\'\n            \'alert(&quot;XSS!&quot;)&lt;/script&gt;"\'\n        )\n        self.assertEqual(\n            VALUE_RE.search(output).groups()[0],\n            \'http://www.example.com/%C3%A4"&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;"\',\n        )\n\n\nclass AdminUUIDWidgetTests(SimpleTestCase):\n    def test_attrs(self):\n        w = widgets.AdminUUIDInputWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n            \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">\',\n        )\n        w = widgets.AdminUUIDInputWidget(attrs={\'class\': \'myUUIDInput\'})\n        self.assertHTMLEqual(\n            w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n            \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">\',\n        )\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AdminFileWidgetTests(TestDataMixin, TestCase):\n\n    @classmethod\n    def setUpTestData(cls):\n        super().setUpTestData()\n        band = Band.objects.create(name=\'Linkin Park\')\n        cls.album = band.album_set.create(\n            name=\'Hybrid Theory\', cover_art=r\'albums\\\\hybrid_theory.jpg\'\n        )\n\n    def test_render(self):\n        w = widgets.AdminFileWidget()\n        self.assertHTMLEqual(\n            w.render(\'test\', self.album.cover_art),\n            \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n            r\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a> \'\n            \'<span class="clearable-file-input">\'\n            \'<input type="checkbox" name="test-clear" id="test-clear_id"> \'\n            \'<label for="test-clear_id">Clear</label></span><br>\'\n            \'Change: <input type="file" name="test"></p>\' % {\n                \'STORAGE_URL\': default_storage.url(\'\'),\n            },\n        )\n        self.assertHTMLEqual(\n            w.render(\'test\', SimpleUploadedFile(\'test\', b\'content\')),\n            \'<input type="file" name="test">\',\n        )\n\n    def test_render_required(self):\n        widget = widgets.AdminFileWidget()\n        widget.is_required = True\n        self.assertHTMLEqual(\n            widget.render(\'test\', self.album.cover_art),\n            \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n            r\'hybrid_theory.jpg">albums\\\\hybrid_theory.jpg</a><br>\'\n            \'Change: <input type="file" name="test"></p>\' % {\n                \'STORAGE_URL\': default_storage.url(\'\'),\n            },\n        )\n\n    def test_readonly_fields(self):\n        """\n        File widgets should render as a link when they\'re marked "read only."\n        """\n        self.client.force_login(self.superuser)\n        response = self.client.get(reverse(\'admin:admin_widgets_album_change\', args=(self.album.id,)))\n        self.assertContains(\n            response,\n            \'<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">\'\n            r\'albums\\\\hybrid_theory.jpg</a></div>\' % {\'STORAGE_URL\': default_storage.url(\'\')},\n            html=True,\n        )\n        self.assertNotContains(\n            response,\n            \'<input type="file" name="cover_art" id="id_cover_art">\',\n            html=True,\n        )\n        response = self.client.get(reverse(\'admin:admin_widgets_album_add\'))\n        self.assertContains(\n            response,\n            \'<div class="readonly"></div>\',\n            html=True,\n        )\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass ForeignKeyRawIdWidgetTest(TestCase):\n    def test_label_for_value_does_not_exist(self):\n        """\n        The label should be an empty string if the related object\n        doesn\'t exist.\n        """\n        band = Band.objects.create(name=\'The Beatles\')\n        rel = Event._meta.get_field(\'main_band\').remote_field\n        widget = widgets.ForeignKeyRawIdWidget(rel, admin_site=admin.site)\n        widget.label_and_url_for_value(band.pk)\n        band.delete()\n        label, url = widget.label_and_url_for_value(band.pk)\n        self.assertEqual(label, \'\')\n\n    def test_label_for_value_from_field_get_choices(self):\n        """\n        The label should be fetched from the field\'s `get_choices()` rather than\n        the widget\'s `choices` if the widget\'s choices are not set. This allows\n        `limit_choices_to` to be respected.\n        """\n        school = School.objects.create(name=\'School\')\n        student = Student.objects.create(name=\'Student\', school=school)\n        field = student._meta.get_field(\'school\')\n        rel = field.remote_field\n        widget = widgets.ForeignKeyRawIdWidget(rel, admin_site=admin.site)\n        # Remove the widget\'s choices to simulate the case where they aren\'t\n        # loaded yet.\n        widget.choices = None\n        label, url = widget.label_and_url_for_value(school.pk)\n        self.assertEqual(label, str(school))\n\n    def test_render_related_url_for_inlines(self):\n        """\n        The related URL for a `ForeignKeyRawIdWidget` in an inline should be\n        correct.\n        """\n        rel = Car._meta.get_field(\'owner\').remote_field\n        widget = widgets.ForeignKeyRawIdWidget(rel, admin_site=admin.site)\n        related_url = widget.get_related_url(rel, \'test\')\n        self.assertIn(\'/admin_widgets/car/?_to_field=id&owner__id__exact=test\', related_url)\n\n\nclass ManyToManyRawIdWidgetTest(TestCase):\n    def test_label_for_value_from_field_get_choices(self):\n        """\n        The label should be fetched from the field\'s `get_choices()` rather than\n        the widget\'s `choices` if the widget\'s choices are not set. This allows\n        `limit_choices_to` to be respected.\n        """\n        school = School.objects.create(name=\'School\')\n        student = Student.objects.create(name=\'Student\')\n        student.schools.add(school)\n        field = student._meta.get_field(\'schools\')\n        rel = field.remote_field\n        widget = widgets.ManyToManyRawIdWidget(rel, admin_site=admin.site)\n        # Remove the widget\'s choices to simulate the case where they aren\'t\n        # loaded yet.\n        widget.choices = None\n        label, url = widget.label_and_url_for_value([school.pk])\n        self.assertEqual(label, str(school))\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass AutocompleteTests(AdminSeleniumTestCase):\n    available_apps = [\'admin_widgets\'] + AdminSeleniumTestCase.available_apps\n\n    @classmethod\n    def setUpTestData(cls):\n        super().setUpTestData()\n        cls.superuser = User.objects.create_superuser(\'super\', \'super@example.com\', \'secret\')\n        cls.school = School.objects.create(name=\'MIT\')\n        cls.student = Student.objects.create(name=\'John\', school=cls.school)\n\n    def test_fk_autocomplete(self):\n        self.admin_login(\'super\', \'secret\')\n        self.selenium.get(self.live_server_url + reverse(\'admin:admin_widgets_student_add\'))\n        self.selenium.find_element_by_id(\'id_school_to_field\')\n        self.selenium.find_element_by_css_selector(\'.select2-container\').click()\n        self.selenium.find_element_by_css_selector(\'.select2-search__field\').send_keys(\'mi\')\n        self.wait_for_page_to_load_and_contain_text(\'.select2-results__option\', \'MIT\')\n        self.selenium.find_element_by_css_selector(\'.select2-results__option\').click()\n        self.selenium.find_element_by_name(\'_save\').click()\n        self.wait_for_text(\'.success\', \'was added successfully\')\n        student = Student.objects.latest(\'pk\')\n        self.assertEqual(student.name, \'\')  # Name is not required.\n        self.assertEqual(student.school.name, \'MIT\')\n\n    def test_m2m_autocomplete(self):\n        self.admin_login(\'super\', \'secret\')\n        self.selenium.get(self.live_server_url + reverse(\'admin:admin_widgets_student_add\'))\n        self.selenium.find_element_by_css_selector(\'#id_schools_to_field\')\n        self.selenium.find_element_by_css_selector(\'.select2-container\').click()\n        self.selenium.find_element_by_css_selector(\'.select2-search__field\').send_keys(\'mi\')\n        self.wait_for_page_to_load_and_contain_text(\'.select2-results__option\', \'MIT\')\n        self.selenium.find_element_by_css_selector(\'.select2-results__option\').click()\n        self.selenium.find_element_by_name(\'_save\').click()\n        self.wait_for_text(\'.success\', \'was added successfully\')\n        student = Student.objects.latest(\'pk\')\n        self.assertEqual(student.name, \'\')  # Name is not required.\n        self.assertEqual(student.schools.first().name, \'MIT\')\n\n\n@override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\nclass RelatedFieldWidgetWrapperTests(SimpleTestCase):\n    def test_no_can_add_related(self):\n        rel = Individual._meta.get_field(\'parent\').remote_field\n        w = widgets.AdminRadioSelect()\n        # Used to fail with a name error.\n        w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n        self.assertFalse(w.can_add_related)\n\n    def test_select_multiple_widget_cant_change_delete_related(self):\n        rel = Individual._meta.get_field(\'parent\').remote_field\n        widget = forms.SelectMultiple()\n        wrapper = widgets.RelatedFieldWidgetWrapper(\n            widget, rel, widget_admin_site,\n            can_add_related=True,\n            can_change_related=True,\n            can_delete_related=True,\n        )\n        self.assertTrue(wrapper.can_add_related)\n        self.assertFalse(wrapper.can_change_related)\n        self.assertFalse(wrapper.can_delete_related)\n\n    def test_on_delete_cascade_rel_cant_delete_related(self):\n        rel = Individual._meta.get_field(\'soulmate\').remote_field\n        widget = forms.Select()\n        wrapper = widgets.RelatedFieldWidgetWrapper(\n            widget, rel, widget_admin_site,\n            can_add_related=True,\n            can_change_related=True,\n            can_delete_related=True,\n        )\n        self.assertTrue(wrapper.can_add_related)\n        self.assertTrue(wrapper.can_change_related)\n        self.assertFalse(wrapper.can_delete_related)\n\n    def test_custom_widget_render(self):\n        class CustomWidget(forms.Select):\n            def render(self, *args, **kwargs):\n                return \'custom render output\'\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = CustomWidget()\n        wrapper = widgets.RelatedFieldWidgetWrapper(\n            widget, rel, widget_admin_site,\n            can_add_related=True,\n            can_change_related=True,\n            can_delete_related=True,\n        )\n        output = wrapper.render(\'name\', \'value\')\n        self.assertIn(\'custom render output\', output)\n\n    def test_widget_delegates_value_omitted_from_data(self):\n        class CustomWidget(forms.Select):\n            def value_omitted_from_data(self, data, files, name):\n                return False\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = CustomWidget()\n        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n        self.assertIs(wrapper.value_omitted_from_data({}, {}, \'band\'), False)\n\n    def test_widget_is_hidden(self):\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = forms.HiddenInput()\n        widget.choices = ()\n        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n        self.assertIs(wrapper.is_hidden, True)\n        context = wrapper.get_context(\'band\', None, {})\n        self.assertIs(context[\'is_hidden\'], True)\n        output = wrapper.render(\'name\', \'value\')\n        # Related item links are hidden.\n        self.assertNotIn(\'<a \', output)\n\n    def test_widget_is_not_hidden(self):\n        rel = Album._meta.get_field(\'band\').remote_field\n        widget = forms.Select()\n        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n        self.assertIs(wrapper.is_hidden, False)\n        context = wrapper.get_context(\'band\', None, {})\n        self.assertIs(context[\'is_hidden\'], False)\n        output = wrapper.render(\'name\', \'value\')\n        # Related item links are present.\n        self.assertIn(\'<a \', output)\n</test_case>\n<test_case>\n# File: tests/admin_views/tests.py\nimport datetime\nimport os\nimport re\nimport unittest\nfrom unittest import mock\nfrom urllib.parse import parse_qsl, urljoin, urlparse\n\nimport pytz\n\nfrom django.contrib.admin import AdminSite, ModelAdmin\nfrom django.contrib.admin.helpers import ACTION_CHECKBOX_NAME\nfrom django.contrib.admin.models import ADDITION, DELETION, LogEntry\nfrom django.contrib.admin.options import TO_FIELD_VAR\nfrom django.contrib.admin.templatetags.admin_urls import add_preserved_filters\nfrom django.contrib.admin.tests import AdminSeleniumTestCase\nfrom django.contrib.admin.utils import quote\nfrom django.contrib.admin.views.main import IS_POPUP_VAR\nfrom django.contrib.auth import REDIRECT_FIELD_NAME, get_permission_codename\nfrom django.contrib.auth.models import Group, Permission, User\nfrom django.contrib.contenttypes.models import ContentType\nfrom django.core import mail\nfrom django.core.checks import Error\nfrom django.core.files import temp as tempfile\nfrom django.forms.utils import ErrorList\nfrom django.template.response import TemplateResponse\nfrom django.test import (\n    TestCase, modify_settings, override_settings, skipUnlessDBFeature,\n)\nfrom django.test.utils import override_script_prefix\nfrom django.urls import NoReverseMatch, resolve, reverse\nfrom django.utils import formats, translation\nfrom django.utils.cache import get_max_age\nfrom django.utils.encoding import iri_to_uri\nfrom django.utils.html import escape\nfrom django.utils.http import urlencode\n\nfrom . import customadmin\nfrom .admin import CityAdmin, site, site2\nfrom .models import (\n    Actor, AdminOrderedAdminMethod, AdminOrderedCallable, AdminOrderedField,\n    AdminOrderedModelMethod, Album, Answer, Answer2, Article, BarAccount, Book,\n    Bookmark, Category, Chapter, ChapterXtra1, ChapterXtra2, Character, Child,\n    Choice, City, Collector, Color, ComplexSortedPerson, CoverLetter,\n    CustomArticle, CyclicOne, CyclicTwo, DooHickey, Employee, EmptyModel,\n    Fabric, FancyDoodad, FieldOverridePost, FilteredManager, FooAccount,\n    FoodDelivery, FunkyTag, Gallery, Grommet, Inquisition, Language, Link,\n    MainPrepopulated, Media, ModelWithStringPrimaryKey, OtherStory, Paper,\n    Parent, ParentWithDependentChildren, ParentWithUUIDPK, Person, Persona,\n    Picture, Pizza, Plot, PlotDetails, PluggableSearchPerson, Podcast, Post,\n    PrePopulatedPost, Promo, Question, ReadablePizza, ReadOnlyPizza,\n    Recommendation, Recommender, RelatedPrepopulated, RelatedWithUUIDPKModel,\n    Report, Restaurant, RowLevelChangePermissionModel, SecretHideout, Section,\n    ShortMessage, Simple, Song, State, Story, SuperSecretHideout, SuperVillain,\n    Telegram, TitleTranslation, Topping, UnchangeableObject, UndeletableObject,\n    UnorderedObject, UserProxy, Villain, Vodcast, Whatsit, Widget, Worker,\n    WorkHour,\n)\n\nERROR_MESSAGE = "Please enter the correct username and password \\\nfor a staff account. Note that both fields may be case-sensitive."\n\nMULTIPART_ENCTYPE = \'enctype="multipart/form-data"\'\n\n\nclass AdminFieldExtractionMixin:\n    """\n    Helper methods for extracting data from AdminForm.\n    """\n    def get_admin_form_fields(self, response):\n        """\n        Return a list of AdminFields for the AdminForm in the response.\n        """\n        fields = []\n        for fieldset in response.context[\'adminform\']:\n            for field_line in fieldset:\n                fields.extend(field_line)\n        return fields\n\n    def get_admin_readonly_fields(self, response):\n        """\n        Return the readonly fields for the response\'s AdminForm.\n        """\n        return [f for f in self.get_admin_form_fields(response) if f.is_readonly]\n\n    def get_admin_readonly_field(self, response, field_name):\n        """\n        Return the readonly field for the given field_name.\n        """\n        admin_readonly_fields = self.get_admin_readonly_fields(response)\n        for field in admin_readonly_fields:\n            if field.field[\'name\'] == field_name:\n                return field\n\n\n@override_settings(ROOT_URLCONF=\'admin_views.urls\')\nclass GroupAdminTest(TestCase):\n    """\n    Tests group CRUD functionality.\n    """\n\n    @classmethod\n    def setUpTestData(cls):\n        cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n\n    def setUp(self):\n        self.client.force_login(self.superuser)\n\n    def test_save_button(self):\n        group_count = Group.objects.count()\n        response = self.client.post(reverse(\'admin:auth_group_add\'), {\n            \'name\': \'newgroup\',\n        })\n\n        Group.objects.order_by(\'-id\')[0]\n        self.assertRedirects(response, reverse(\'admin:auth_group_changelist\'))\n        self.assertEqual(Group.objects.count(), group_count + 1)\n\n    def test_group_permission_performance(self):\n        g = Group.objects.create(name="test_group")\n\n        # Ensure no queries are skipped due to cached content type for Group.\n        ContentType.objects.clear_cache()\n\n        with self.assertNumQueries(8):\n            response = self.client.get(reverse(\'admin:auth_group_change\', args=(g.pk,)))\n            self.assertEqual(response.status_code, 200)\n</test_case>\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1349, 'end_index': 1661, 'uri': 'https://github.com/Yoann-Vie/esgi-hearthstone', 'title': '', 'license_': ''}, {'start_index': 1522, 'end_index': 1906, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 1793, 'end_index': 2198, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 2019, 'end_index': 2480, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 2491, 'end_index': 2915, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 2758, 'end_index': 3465, 'uri': 'https://github.com/Yoann-Vie/esgi-hearthstone', 'title': '', 'license_': ''}, {'start_index': 3306, 'end_index': 3788, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 3725, 'end_index': 4077, 'uri': 'https://github.com/JersonVnzl/Python', 'license_': 'BSD-3-Clause', 'title': ''}, {'start_index': 4052, 'end_index': 4668, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 4507, 'end_index': 4851, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 4859, 'end_index': 5190, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 5163, 'end_index': 5652, 'uri': 'https://github.com/django/django', 'title': '', 'license_': ''}, {'start_index': 5525, 'end_index': 6211, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 6286, 'end_index': 7221, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 7221, 'end_index': 7597, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 7894, 'end_index': 8215, 'uri': 'https://github.com/gethue/hue', 'license_': 'BeOpen', 'title': ''}, {'start_index': 10432, 'end_index': 11109, 'uri': 'https://github.com/carlosejimenez/experiments', 'title': '', 'license_': ''}, {'start_index': 23572, 'end_index': 24418, 'uri': 'https://github.com/carlosejimenez/experiments', 'title': '', 'license_': ''}, {'start_index': 36054, 'end_index': 36664, 'uri': 'https://www.programcreek.com/python/example/58117/django.contrib.admin.widgets.AdminSplitDateTime', 'title': '', 'license_': ''}, {'start_index': 42030, 'end_index': 42575, 'uri': 'https://www.programcreek.com/python/example/78783/django.contrib.admin.widgets.AdminDateWidget', 'title': '', 'license_': ''}, {'start_index': 43256, 'end_index': 44261, 'uri': 'https://www.programcreek.com/python/example/58117/django.contrib.admin.widgets.AdminSplitDateTime', 'title': '', 'license_': ''}, {'start_index': 56738, 'end_index': 57089, 'uri': 'https://github.com/charettes/django-admin-enhancer', 'title': '', 'license_': ''}, {'start_index': 58036, 'end_index': 58327, 'uri': 'https://github.com/serhatopcu/django-trademenshop', 'title': '', 'license_': ''}, {'start_index': 65033, 'end_index': 65643, 'uri': 'https://www.programcreek.com/python/example/58117/django.contrib.admin.widgets.AdminSplitDateTime', 'title': '', 'license_': ''}, {'start_index': 71009, 'end_index': 71554, 'uri': 'https://www.programcreek.com/python/example/78783/django.contrib.admin.widgets.AdminDateWidget', 'title': '', 'license_': ''}, {'start_index': 72235, 'end_index': 73240, 'uri': 'https://www.programcreek.com/python/example/58117/django.contrib.admin.widgets.AdminSplitDateTime', 'title': '', 'license_': ''}, {'start_index': 85717, 'end_index': 86068, 'uri': 'https://github.com/charettes/django-admin-enhancer', 'title': '', 'license_': ''}, {'start_index': 87015, 'end_index': 87306, 'uri': 'https://github.com/serhatopcu/django-trademenshop', 'title': '', 'license_': ''}, {'start_index': 90798, 'end_index': 91475, 'uri': 'https://github.com/carlosejimenez/experiments', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 114623, 'candidates_token_count': 26567, 'total_token_count': 141295, 'cached_content_token_count': 114746, 'prompt_tokens_details': [{'modality': 1, 'token_count': 117309}], 'cache_tokens_details': [{'modality': 1, 'token_count': 114746}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26567}], 'thoughts_token_count': 105}, 'finish_reason': 'STOP', 'avg_logprobs': -0.00619415399222073, 'model_name': 'gemini-2.5-pro'} id='run--a74b8f04-f5b8-43a0-82e7-e42526c5cae0-0' usage_metadata={'input_tokens': 114623, 'output_tokens': 26567, 'total_tokens': 141295, 'input_token_details': {'cache_read': 114746}, 'output_token_details': {'reasoning': 105}}
2025-10-06 03:39:40,632 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 03:39:40,634 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Allow overridding widget in formfield_for_manytomany().

Issue description: 
Description
	 
		(last modified by Mariusz Felisiak)
	 
It does not work when I set widget param to function formfield_for_manytomany().
This is different from the formfield_for_foreignkey() function.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/admin_ordering/tests.py
Line number range: 1 - 189
Content:
1. from django.contrib import admin
2. from django.contrib.admin.options import ModelAdmin
3. from django.contrib.auth.models import User
4. from django.db.models import F
5. from django.test import RequestFactory, TestCase
6. 
7. from .models import (
8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,
9.     SongInlineNewOrdering,
10. )
11. 
12. 
13. class MockRequest:
14.     pass
15. 
16. 
17. class MockSuperUser:
18.     def has_perm(self, perm):
19.         return True
20. 
21.     def has_module_perms(self, module):
22.         return True
23. 
24. 
25. request = MockRequest()
26. request.user = MockSuperUser()
27. 
28. site = admin.AdminSite()
29. 
30. 
31. class TestAdminOrdering(TestCase):
32.     """
33.     Let's make sure that ModelAdmin.get_queryset uses the ordering we define
34.     in ModelAdmin rather that ordering defined in the model's inner Meta
35.     class.
36.     """
37.     request_factory = RequestFactory()
38. 
39.     @classmethod
40.     def setUpTestData(cls):
41.         Band.objects.bulk_create([
42.             Band(name='Aerosmith', bio='', rank=3),
43.             Band(name='Radiohead', bio='', rank=1),
44.             Band(name='Van Halen', bio='', rank=2),
45.         ])
46. 
47.     def test_default_ordering(self):
48.         """
49.         The default ordering should be by name, as specified in the inner Meta
50.         class.
51.         """
52.         ma = ModelAdmin(Band, site)
53.         names = [b.name for b in ma.get_queryset(request)]
54.         self.assertEqual(['Aerosmith', 'Radiohead', 'Van Halen'], names)
55. 
56.     def test_specified_ordering(self):
57.         """
58.         Let's use a custom ModelAdmin that changes the ordering, and make sure
59.         it actually changes.
60.         """
61.         class BandAdmin(ModelAdmin):
62.             ordering = ('rank',)  # default ordering is ('name',)
63.         ma = BandAdmin(Band, site)
64.         names = [b.name for b in ma.get_queryset(request)]
65.         self.assertEqual(['Radiohead', 'Van Halen', 'Aerosmith'], names)
66. 
67.     def test_specified_ordering_by_f_expression(self):
68.         class BandAdmin(ModelAdmin):
69.             ordering = (F('rank').desc(nulls_last=True),)
70.         band_admin = BandAdmin(Band, site)
71.         names = [b.name for b in band_admin.get_queryset(request)]
72.         self.assertEqual(['Aerosmith', 'Van Halen', 'Radiohead'], names)
73. 
74.     def test_dynamic_ordering(self):
75.         """
76.         Let's use a custom ModelAdmin that changes the ordering dynamically.
77.         """
78.         super_user = User.objects.create(username='admin', is_superuser=True)
79.         other_user = User.objects.create(username='other')
80.         request = self.request_factory.get('/')
81.         request.user = super_user
82.         ma = DynOrderingBandAdmin(Band, site)
83.         names = [b.name for b in ma.get_queryset(request)]
84.         self.assertEqual(['Radiohead', 'Van Halen', 'Aerosmith'], names)
85.         request.user = other_user
86.         names = [b.name for b in ma.get_queryset(request)]
87.         self.assertEqual(['Aerosmith', 'Radiohead', 'Van Halen'], names)
88. 
89. 
90. class TestInlineModelAdminOrdering(TestCase):
91.     """
92.     Let's make sure that InlineModelAdmin.get_queryset uses the ordering we
93.     define in InlineModelAdmin.
94.     """
95. 
96.     @classmethod
97.     def setUpTestData(cls):
98.         cls.band = Band.objects.create(name='Aerosmith', bio='', rank=3)
99.         Song.objects.bulk_create([
100.             Song(band=cls.band, name='Pink', duration=235),
101.             Song(band=cls.band, name='Dude (Looks Like a Lady)', duration=264),
102.             Song(band=cls.band, name='Jaded', duration=214),
103.         ])
104. 
105.     def test_default_ordering(self):
106.         """
107.         The default ordering should be by name, as specified in the inner Meta
108.         class.
109.         """
110.         inline = SongInlineDefaultOrdering(self.band, site)
111.         names = [s.name for s in inline.get_queryset(request)]
112.         self.assertEqual(['Dude (Looks Like a Lady)', 'Jaded', 'Pink'], names)
113. 
114.     def test_specified_ordering(self):
115.         """
116.         Let's check with ordering set to something different than the default.
117.         """
118.         inline = SongInlineNewOrdering(self.band, site)
119.         names = [s.name for s in inline.get_queryset(request)]
120.         self.assertEqual(['Jaded', 'Pink', 'Dude (Looks Like a Lady)'], names)
121. 
122. 
123. class TestRelatedFieldsAdminOrdering(TestCase):
124.     @classmethod
125.     def setUpTestData(cls):
126.         cls.b1 = Band.objects.create(name='Pink Floyd', bio='', rank=1)
127.         cls.b2 = Band.objects.create(name='Foo Fighters', bio='', rank=5)
128. 
129.     def setUp(self):
130.         # we need to register a custom ModelAdmin (instead of just using
131.         # ModelAdmin) because the field creator tries to find the ModelAdmin
132.         # for the related model
133.         class SongAdmin(admin.ModelAdmin):
134.             pass
135.         site.register(Song, SongAdmin)
136. 
137.     def tearDown(self):
138.         site.unregister(Song)
139.         if Band in site._registry:
140.             site.unregister(Band)
141. 
142.     def check_ordering_of_field_choices(self, correct_ordering):
143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)
144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)
145.         self.assertEqual(list(fk_field.queryset), correct_ordering)
146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)
147. 
148.     def test_no_admin_fallback_to_model_ordering(self):
149.         # should be ordered by name (as defined by the model)
150.         self.check_ordering_of_field_choices([self.b2, self.b1])
151. 
152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):
153.         class NoOrderingBandAdmin(admin.ModelAdmin):
154.             pass
155.         site.register(Band, NoOrderingBandAdmin)
156. 
157.         # should be ordered by name (as defined by the model)
158.         self.check_ordering_of_field_choices([self.b2, self.b1])
159. 
160.     def test_admin_ordering_beats_model_ordering(self):
161.         class StaticOrderingBandAdmin(admin.ModelAdmin):
162.             ordering = ('rank',)
163.         site.register(Band, StaticOrderingBandAdmin)
164. 
165.         # should be ordered by rank (defined by the ModelAdmin)
166.         self.check_ordering_of_field_choices([self.b1, self.b2])
167. 
168.     def test_custom_queryset_still_wins(self):
169.         """Custom queryset has still precedence (#21405)"""
170.         class SongAdmin(admin.ModelAdmin):
171.             # Exclude one of the two Bands from the querysets
172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):
173.                 if db_field.name == 'band':
174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
176. 
177.             def formfield_for_manytomany(self, db_field, request, **kwargs):
178.                 if db_field.name == 'other_interpreters':
179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
181. 
182.         class StaticOrderingBandAdmin(admin.ModelAdmin):
183.             ordering = ('rank',)
184. 
185.         site.unregister(Song)
186.         site.register(Song, SongAdmin)
187.         site.register(Band, StaticOrderingBandAdmin)
188. 
189.         self.check_ordering_of_field_choices([self.b2])

File: tests/admin_views/tests.py
Line number range: 5099 - 5259
Content:
@override_settings(ROOT_URLCONF='admin_views.urls')
class UserAdminTest(TestCase):
    """
    Tests user CRUD functionality.
    """

    @classmethod
    def setUpTestData(cls):
        cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
        cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
        cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
        cls.s1 = Section.objects.create(name='Test section')
        cls.a1 = Article.objects.create(
            content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
        )
        cls.a2 = Article.objects.create(
            content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
        )
        cls.a3 = Article.objects.create(
            content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
        )
        cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')

        cls.per1 = Person.objects.create(name='John Mauchly', gender=1, alive=True)
        cls.per2 = Person.objects.create(name='Grace Hopper', gender=1, alive=False)
        cls.per3 = Person.objects.create(name='Guido van Rossum', gender=1, alive=True)

    def setUp(self):
        self.client.force_login(self.superuser)

    def test_save_button(self):
        user_count = User.objects.count()
        response = self.client.post(reverse('admin:auth_user_add'), {
            'username': 'newuser',
            'password1': 'newpassword',
            'password2': 'newpassword',
        })
        new_user = User.objects.get(username='newuser')
        self.assertRedirects(response, reverse('admin:auth_user_change', args=(new_user.pk,)))
        self.assertEqual(User.objects.count(), user_count + 1)
        self.assertTrue(new_user.has_usable_password())

    def test_save_continue_editing_button(self):
        user_count = User.objects.count()
        response = self.client.post(reverse('admin:auth_user_add'), {
            'username': 'newuser',
            'password1': 'newpassword',
            'password2': 'newpassword',
            '_continue': '1',
        })
        new_user = User.objects.get(username='newuser')
        new_user_url = reverse('admin:auth_user_change', args=(new_user.pk,))
        self.assertRedirects(response, new_user_url, fetch_redirect_response=False)
        self.assertEqual(User.objects.count(), user_count + 1)
        self.assertTrue(new_user.has_usable_password())
        response = self.client.get(new_user_url)
        self.assertContains(
            response,
            '<li class="success">The user “<a href="%s">'
            '%s</a>” was added successfully. You may edit it again below.</li>'
            % (new_user_url, new_user),
            html=True,
        )

    def test_password_mismatch(self):
        response = self.client.post(reverse('admin:auth_user_add'), {
            'username': 'newuser',
            'password1': 'newpassword',
            'password2': 'mismatch',
        })
        self.assertEqual(response.status_code, 200)
        self.assertFormError(response, 'adminform', 'password', [])
        self.assertFormError(response, 'adminform', 'password2', ['The two password fields didn’t match.'])

    def test_user_fk_add_popup(self):
        """User addition through a FK popup should return the appropriate JavaScript response."""
        response = self.client.get(reverse('admin:admin_views_album_add'))
        self.assertContains(response, reverse('admin:auth_user_add'))
        self.assertContains(response, 'class="related-widget-wrapper-link add-related" id="add_id_owner"')
        response = self.client.get(reverse('admin:auth_user_add') + '?_popup=1')
        self.assertNotContains(response, 'name="_continue"')
        self.assertNotContains(response, 'name="_addanother"')
        data = {
            'username': 'newuser',
            'password1': 'newpassword',
            'password2': 'newpassword',
            '_popup': '1',
            '_save': '1',
        }
        response = self.client.post(reverse('admin:auth_user_add') + '?_popup=1', data, follow=True)
        self.assertContains(response, '&quot;obj&quot;: &quot;newuser&quot;')

    def test_user_fk_change_popup(self):
        """User change through a FK popup should return the appropriate JavaScript response."""
        response = self.client.get(reverse('admin:admin_views_album_add'))
        self.assertContains(response, reverse('admin:auth_user_change', args=('__fk__',)))
        self.assertContains(response, 'class="related-widget-wrapper-link change-related" id="change_id_owner"')
        user = User.objects.get(username='changeuser')
        url = reverse('admin:auth_user_change', args=(user.pk,)) + '?_popup=1'
        response = self.client.get(url)
        self.assertNotContains(response, 'name="_continue"')
        self.assertNotContains(response, 'name="_addanother"')
        data = {
            'username': 'newuser',
            'password1': 'newpassword',
            'password2': 'newpassword',
            'last_login_0': '2007-05-30',
            'last_login_1': '13:20:10',
            'date_joined_0': '2007-05-30',
            'date_joined_1': '13:20:10',
            '_popup': '1',
            '_save': '1',
        }
        response = self.client.post(url, data, follow=True)
        self.assertContains(response, '&quot;obj&quot;: &quot;newuser&quot;')
        self.assertContains(response, '&quot;action&quot;: &quot;change&quot;')

    def test_user_fk_delete_popup(self):
        """User deletion through a FK popup should return the appropriate JavaScript response."""
        response = self.client.get(reverse('admin:admin_views_album_add'))
        self.assertContains(response, reverse('admin:auth_user_delete', args=('__fk__',)))
        self.assertContains(response, 'class="related-widget-wrapper-link change-related" id="change_id_owner"')
        user = User.objects.get(username='changeuser')
        url = reverse('admin:auth_user_delete', args=(user.pk,)) + '?_popup=1'
        response = self.client.get(url)
        self.assertEqual(response.status_code, 200)
        data = {
            'post': 'yes',
            '_popup': '1',
        }
        response = self.client.post(url, data, follow=True)
        self.assertContains(response, '&quot;action&quot;: &quot;delete&quot;')

    def test_save_add_another_button(self):
        user_count = User.objects.count()
        response = self.client.post(reverse('admin:auth_user_add'), {
            'username': 'newuser',
            'password1': 'newpassword',
            'password2': 'newpassword',
            '_addanother': '1',
        })
        new_user = User.objects.order_by('-id')[0]
        self.assertRedirects(response, reverse('admin:auth_user_add'))
        self.assertEqual(User.objects.count(), user_count + 1)
        self.assertTrue(new_user.has_usable_password())

    def test_user_permission_performance(self):
        u = User.objects.all()[0]

        # Don't depend on a warm cache, see #17377.
        ContentType.objects.clear_cache()

        with self.assertNumQueries(10):
            response = self.client.get(reverse('admin:auth_user_change', args=(u.pk,)))
            self.assertEqual(response.status_code, 200)

    def test_form_url_present_in_context(self):
        u = User.objects.all()[0]
        response = self.client.get(reverse('admin3:auth_user_password_change', args=(u.pk,)))
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context['form_url'], 'pony')

File: tests/admin_views/tests.py
Line number range: 3982 - 4302
Content:
@override_settings(ROOT_URLCONF='admin_views.urls')
class AdminInlineTests(TestCase):

    @classmethod
    def setUpTestData(cls):
        cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
        cls.collector = Collector.objects.create(pk=1, name='John Fowles')

    def setUp(self):
        self.post_data = {
            "name": "Test Name",

            "widget_set-TOTAL_FORMS": "3",
            "widget_set-INITIAL_FORMS": "0",
            "widget_set-MAX_NUM_FORMS": "0",
            "widget_set-0-id": "",
            "widget_set-0-owner": "1",
            "widget_set-0-name": "",
            "widget_set-1-id": "",
            "widget_set-1-owner": "1",
            "widget_set-1-name": "",
            "widget_set-2-id": "",
            "widget_set-2-owner": "1",
            "widget_set-2-name": "",

            "doohickey_set-TOTAL_FORMS": "3",
            "doohickey_set-INITIAL_FORMS": "0",
            "doohickey_set-MAX_NUM_FORMS": "0",
            "doohickey_set-0-owner": "1",
            "doohickey_set-0-code": "",
            "doohickey_set-0-name": "",
            "doohickey_set-1-owner": "1",
            "doohickey_set-1-code": "",
            "doohickey_set-1-name": "",
            "doohickey_set-2-owner": "1",
            "doohickey_set-2-code": "",
            "doohickey_set-2-name": "",

            "grommet_set-TOTAL_FORMS": "3",
            "grommet_set-INITIAL_FORMS": "0",
            "grommet_set-MAX_NUM_FORMS": "0",
            "grommet_set-0-code": "",
            "grommet_set-0-owner": "1",
            "grommet_set-0-name": "",
            "grommet_set-1-code": "",
            "grommet_set-1-owner": "1",
            "grommet_set-1-name": "",
            "grommet_set-2-code": "",
            "grommet_set-2-owner": "1",
            "grommet_set-2-name": "",

            "whatsit_set-TOTAL_FORMS": "3",
            "whatsit_set-INITIAL_FORMS": "0",
            "whatsit_set-MAX_NUM_FORMS": "0",
            "whatsit_set-0-owner": "1",
            "whatsit_set-0-index": "",
            "whatsit_set-0-name": "",
            "whatsit_set-1-owner": "1",
            "whatsit_set-1-index": "",
            "whatsit_set-1-name": "",
            "whatsit_set-2-owner": "1",
            "whatsit_set-2-index": "",
            "whatsit_set-2-name": "",

            "fancydoodad_set-TOTAL_FORMS": "3",
            "fancydoodad_set-INITIAL_FORMS": "0",
            "fancydoodad_set-MAX_NUM_FORMS": "0",
            "fancydoodad_set-0-doodad_ptr": "",
            "fancydoodad_set-0-owner": "1",
            "fancydoodad_set-0-name": "",
            "fancydoodad_set-0-expensive": "on",
            "fancydoodad_set-1-doodad_ptr": "",
            "fancydoodad_set-1-owner": "1",
            "fancydoodad_set-1-name": "",
            "fancydoodad_set-1-expensive": "on",
            "fancydoodad_set-2-doodad_ptr": "",
            "fancydoodad_set-2-owner": "1",
            "fancydoodad_set-2-name": "",
            "fancydoodad_set-2-expensive": "on",

            "category_set-TOTAL_FORMS": "3",
            "category_set-INITIAL_FORMS": "0",
            "category_set-MAX_NUM_FORMS": "0",
            "category_set-0-order": "",
            "category_set-0-id": "",
            "category_set-0-collector": "1",
            "category_set-1-order": "",
            "category_set-1-id": "",
            "category_set-1-collector": "1",
            "category_set-2-order": "",
            "category_set-2-id": "",
            "category_set-2-collector": "1",
        }

        self.client.force_login(self.superuser)

    def test_simple_inline(self):
        "A simple model can be saved as inlines"
        # First add a new inline
        self.post_data['widget_set-0-name'] = "Widget 1"
        collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Widget.objects.count(), 1)
        self.assertEqual(Widget.objects.all()[0].name, "Widget 1")
        widget_id = Widget.objects.all()[0].id

        # The PK link exists on the rendered form
        response = self.client.get(collector_url)
        self.assertContains(response, 'name="widget_set-0-id"')

        # No file or image fields, no enctype on the forms
        self.assertIs(response.context['has_file_field'], False)
        self.assertNotContains(response, MULTIPART_ENCTYPE)

        # Now resave that inline
        self.post_data['widget_set-INITIAL_FORMS'] = "1"
        self.post_data['widget_set-0-id'] = str(widget_id)
        self.post_data['widget_set-0-name'] = "Widget 1"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Widget.objects.count(), 1)
        self.assertEqual(Widget.objects.all()[0].name, "Widget 1")

        # Now modify that inline
        self.post_data['widget_set-INITIAL_FORMS'] = "1"
        self.post_data['widget_set-0-id'] = str(widget_id)
        self.post_data['widget_set-0-name'] = "Widget 1 Updated"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Widget.objects.count(), 1)
        self.assertEqual(Widget.objects.all()[0].name, "Widget 1 Updated")

    def test_explicit_autofield_inline(self):
        "A model with an explicit autofield primary key can be saved as inlines. Regression for #8093"
        # First add a new inline
        self.post_data['grommet_set-0-name'] = "Grommet 1"
        collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Grommet.objects.count(), 1)
        self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1")

        # The PK link exists on the rendered form
        response = self.client.get(collector_url)
        self.assertContains(response, 'name="grommet_set-0-code"')

        # Now resave that inline
        self.post_data['grommet_set-INITIAL_FORMS'] = "1"
        self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)
        self.post_data['grommet_set-0-name'] = "Grommet 1"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Grommet.objects.count(), 1)
        self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1")

        # Now modify that inline
        self.post_data['grommet_set-INITIAL_FORMS'] = "1"
        self.post_data['grommet_set-0-code'] = str(Grommet.objects.all()[0].code)
        self.post_data['grommet_set-0-name'] = "Grommet 1 Updated"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Grommet.objects.count(), 1)
        self.assertEqual(Grommet.objects.all()[0].name, "Grommet 1 Updated")

    def test_char_pk_inline(self):
        "A model with a character PK can be saved as inlines. Regression for #10992"
        # First add a new inline
        self.post_data['doohickey_set-0-code'] = "DH1"
        self.post_data['doohickey_set-0-name'] = "Doohickey 1"
        collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(DooHickey.objects.count(), 1)
        self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1")

        # The PK link exists on the rendered form
        response = self.client.get(collector_url)
        self.assertContains(response, 'name="doohickey_set-0-code"')

        # Now resave that inline
        self.post_data['doohickey_set-INITIAL_FORMS'] = "1"
        self.post_data['doohickey_set-0-code'] = "DH1"
        self.post_data['doohickey_set-0-name'] = "Doohickey 1"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(DooHickey.objects.count(), 1)
        self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1")

        # Now modify that inline
        self.post_data['doohickey_set-INITIAL_FORMS'] = "1"
        self.post_data['doohickey_set-0-code'] = "DH1"
        self.post_data['doohickey_set-0-name'] = "Doohickey 1 Updated"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(DooHickey.objects.count(), 1)
        self.assertEqual(DooHickey.objects.all()[0].name, "Doohickey 1 Updated")

    def test_integer_pk_inline(self):
        "A model with an integer PK can be saved as inlines. Regression for #10992"
        # First add a new inline
        self.post_data['whatsit_set-0-index'] = "42"
        self.post_data['whatsit_set-0-name'] = "Whatsit 1"
        collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Whatsit.objects.count(), 1)
        self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1")

        # The PK link exists on the rendered form
        response = self.client.get(collector_url)
        self.assertContains(response, 'name="whatsit_set-0-index"')

        # Now resave that inline
        self.post_data['whatsit_set-INITIAL_FORMS'] = "1"
        self.post_data['whatsit_set-0-index'] = "42"
        self.post_data['whatsit_set-0-name'] = "Whatsit 1"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Whatsit.objects.count(), 1)
        self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1")

        # Now modify that inline
        self.post_data['whatsit_set-INITIAL_FORMS'] = "1"
        self.post_data['whatsit_set-0-index'] = "42"
        self.post_data['whatsit_set-0-name'] = "Whatsit 1 Updated"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(Whatsit.objects.count(), 1)
        self.assertEqual(Whatsit.objects.all()[0].name, "Whatsit 1 Updated")

    def test_inherited_inline(self):
        "An inherited model can be saved as inlines. Regression for #11042"
        # First add a new inline
        self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1"
        collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(FancyDoodad.objects.count(), 1)
        self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1")
        doodad_pk = FancyDoodad.objects.all()[0].pk

        # The PK link exists on the rendered form
        response = self.client.get(collector_url)
        self.assertContains(response, 'name="fancydoodad_set-0-doodad_ptr"')

        # Now resave that inline
        self.post_data['fancydoodad_set-INITIAL_FORMS'] = "1"
        self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)
        self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(FancyDoodad.objects.count(), 1)
        self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1")

        # Now modify that inline
        self.post_data['fancydoodad_set-INITIAL_FORMS'] = "1"
        self.post_data['fancydoodad_set-0-doodad_ptr'] = str(doodad_pk)
        self.post_data['fancydoodad_set-0-name'] = "Fancy Doodad 1 Updated"
        response = self.client.post(collector_url, self.post_data)
        self.assertEqual(response.status_code, 302)
        self.assertEqual(FancyDoodad.objects.count(), 1)
        self.assertEqual(FancyDoodad.objects.all()[0].name, "Fancy Doodad 1 Updated")

    def test_ordered_inline(self):
        """
        An inline with an editable ordering fields is updated correctly.
        """
        # Create some objects with an initial ordering
        Category.objects.create(id=1, order=1, collector=self.collector)
        Category.objects.create(id=2, order=2, collector=self.collector)
        Category.objects.create(id=3, order=0, collector=self.collector)
        Category.objects.create(id=4, order=0, collector=self.collector)

        # NB: The order values must be changed so that the items are reordered.
        self.post_data.update({
            "name": "Frederick Clegg",

            "category_set-TOTAL_FORMS": "7",
            "category_set-INITIAL_FORMS": "4",
            "category_set-MAX_NUM_FORMS": "0",

            "category_set-0-order": "14",
            "category_set-0-id": "1",
            "category_set-0-collector": "1",

            "category_set-1-order": "13",
            "category_set-1-id": "2",
            "category_set-1-collector": "1",

            "category_set-2-order": "1",
            "category_set-2-id": "3",
            "category_set-2-collector": "1",

            "category_set-3-order": "0",
            "category_set-3-id": "4",
            "category_set-3-collector": "1",

            "category_set-4-order": "",
            "category_set-4-id": "",
            "category_set-4-collector": "1",

            "category_set-5-order": "",
            "category_set-5-id": "",
            "category_set-5-collector": "1",

            "category_set-6-order": "",
            "category_set-6-id": "",
            "category_set-6-collector": "1",
        })
        collector_url = reverse('admin:admin_views_collector_change', args=(self.collector.pk,))
        response = self.client.post(collector_url, self.post_data)
        # Successful post will redirect
        self.assertEqual(response.status_code, 302)

        # The order values have been applied to the right objects
        self.assertEqual(self.collector.category_set.count(), 4)
        self.assertEqual(Category.objects.get(id=1).order, 14)
        self.assertEqual(Category.objects.get(id=2).order, 13)
        self.assertEqual(Category.objects.get(id=3).order, 1)
        self.assertEqual(Category.objects.get(id=4).order, 0)

File: tests/admin_views/tests.py
Line number range: 4435 - 4804
Content:
@override_settings(ROOT_URLCONF='admin_views.urls')
class SeleniumTests(AdminSeleniumTestCase):

    available_apps = ['admin_views'] + AdminSeleniumTestCase.available_apps

    def setUp(self):
        self.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
        self.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')

    def test_prepopulated_fields(self):
        """
        The JavaScript-automated prepopulated fields work with the main form
        and with stacked and tabular inlines.
        Refs #13068, #9264, #9983, #9784.
        """
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        self.selenium.get(self.live_server_url + reverse('admin:admin_views_mainprepopulated_add'))
        self.wait_for('.select2')

        # Main form ----------------------------------------------------------
        self.selenium.find_element_by_id('id_pubdate').send_keys('2012-02-18')
        self.select_option('#id_status', 'option two')
        self.selenium.find_element_by_id('id_name').send_keys(' this is the mAin nÀMë and it\'s awεšomeıııİ')
        slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
        slug3 = self.selenium.find_element_by_id('id_slug3').get_attribute('value')
        self.assertEqual(slug1, 'main-name-and-its-awesomeiiii-2012-02-18')
        self.assertEqual(slug2, 'option-two-main-name-and-its-awesomeiiii')
        self.assertEqual(slug3, 'this-is-the-main-n\xe0m\xeb-and-its-aw\u03b5\u0161ome\u0131\u0131\u0131i')

        # Stacked inlines ----------------------------------------------------
        # Initial inline
        self.selenium.find_element_by_id('id_relatedprepopulated_set-0-pubdate').send_keys('2011-12-17')
        self.select_option('#id_relatedprepopulated_set-0-status', 'option one')
        self.selenium.find_element_by_id('id_relatedprepopulated_set-0-name').send_keys(
            ' here is a sŤāÇkeð   inline !  '
        )
        slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-0-slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-0-slug2').get_attribute('value')
        self.assertEqual(slug1, 'here-stacked-inline-2011-12-17')
        self.assertEqual(slug2, 'option-one-here-stacked-inline')
        initial_select2_inputs = self.selenium.find_elements_by_class_name('select2-selection')
        # Inline formsets have empty/invisible forms.
        # Only the 4 visible select2 inputs are initialized.
        num_initial_select2_inputs = len(initial_select2_inputs)
        self.assertEqual(num_initial_select2_inputs, 4)

        # Add an inline
        self.selenium.find_elements_by_link_text('Add another Related prepopulated')[0].click()
        self.assertEqual(
            len(self.selenium.find_elements_by_class_name('select2-selection')),
            num_initial_select2_inputs + 2
        )
        self.selenium.find_element_by_id('id_relatedprepopulated_set-1-pubdate').send_keys('1999-01-25')
        self.select_option('#id_relatedprepopulated_set-1-status', 'option two')
        self.selenium.find_element_by_id('id_relatedprepopulated_set-1-name').send_keys(
            ' now you haVe anöther   sŤāÇkeð  inline with a very ... '
            'loooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooog text... '
        )
        slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-1-slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-1-slug2').get_attribute('value')
        # 50 characters maximum for slug1 field
        self.assertEqual(slug1, 'now-you-have-another-stacked-inline-very-loooooooo')
        # 60 characters maximum for slug2 field
        self.assertEqual(slug2, 'option-two-now-you-have-another-stacked-inline-very-looooooo')

        # Tabular inlines ----------------------------------------------------
        # Initial inline
        self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-pubdate').send_keys('1234-12-07')
        self.select_option('#id_relatedprepopulated_set-2-0-status', 'option two')
        self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-name').send_keys(
            'And now, with a tÃbűlaŘ inline !!!'
        )
        slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-0-slug2').get_attribute('value')
        self.assertEqual(slug1, 'and-now-tabular-inline-1234-12-07')
        self.assertEqual(slug2, 'option-two-and-now-tabular-inline')

        # Add an inline
        # Button may be outside the browser frame.
        element = self.selenium.find_elements_by_link_text('Add another Related prepopulated')[1]
        self.selenium.execute_script('window.scrollTo(0, %s);' % element.location['y'])
        element.click()
        self.assertEqual(
            len(self.selenium.find_elements_by_class_name('select2-selection')),
            num_initial_select2_inputs + 4
        )
        self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-pubdate').send_keys('1981-08-22')
        self.select_option('#id_relatedprepopulated_set-2-1-status', 'option one')
        self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-name').send_keys(
            r'a tÃbűlaŘ inline with ignored ;"&*^\%$#@-/`~ characters'
        )
        slug1 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_relatedprepopulated_set-2-1-slug2').get_attribute('value')
        self.assertEqual(slug1, 'tabular-inline-ignored-characters-1981-08-22')
        self.assertEqual(slug2, 'option-one-tabular-inline-ignored-characters')
        # Add an inline without an initial inline.
        # The button is outside of the browser frame.
        self.selenium.execute_script("window.scrollTo(0, document.body.scrollHeight);")
        self.selenium.find_elements_by_link_text('Add another Related prepopulated')[2].click()
        self.assertEqual(
            len(self.selenium.find_elements_by_class_name('select2-selection')),
            num_initial_select2_inputs + 6
        )
        # Save and check that everything is properly stored in the database
        with self.wait_page_loaded():
            self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
        self.assertEqual(MainPrepopulated.objects.all().count(), 1)
        MainPrepopulated.objects.get(
            name=' this is the mAin nÀMë and it\'s awεšomeıııİ',
            pubdate='2012-02-18',
            status='option two',
            slug1='main-name-and-its-awesomeiiii-2012-02-18',
            slug2='option-two-main-name-and-its-awesomeiiii',
            slug3='this-is-the-main-nàmë-and-its-awεšomeıııi',
        )
        self.assertEqual(RelatedPrepopulated.objects.all().count(), 4)
        RelatedPrepopulated.objects.get(
            name=' here is a sŤāÇkeð   inline !  ',
            pubdate='2011-12-17',
            status='option one',
            slug1='here-stacked-inline-2011-12-17',
            slug2='option-one-here-stacked-inline',
        )
        RelatedPrepopulated.objects.get(
            # 75 characters in name field
            name=' now you haVe anöther   sŤāÇkeð  inline with a very ... loooooooooooooooooo',
            pubdate='1999-01-25',
            status='option two',
            slug1='now-you-have-another-stacked-inline-very-loooooooo',
            slug2='option-two-now-you-have-another-stacked-inline-very-looooooo',
        )
        RelatedPrepopulated.objects.get(
            name='And now, with a tÃbűlaŘ inline !!!',
            pubdate='1234-12-07',
            status='option two',
            slug1='and-now-tabular-inline-1234-12-07',
            slug2='option-two-and-now-tabular-inline',
        )
        RelatedPrepopulated.objects.get(
            name=r'a tÃbűlaŘ inline with ignored ;"&*^\%$#@-/`~ characters',
            pubdate='1981-08-22',
            status='option one',
            slug1='tabular-inline-ignored-characters-1981-08-22',
            slug2='option-one-tabular-inline-ignored-characters',
        )

    def test_populate_existing_object(self):
        """
        The prepopulation works for existing objects too, as long as
        the original field is empty (#19082).
        """
        # Slugs are empty to start with.
        item = MainPrepopulated.objects.create(
            name=' this is the mAin nÀMë',
            pubdate='2012-02-18',
            status='option two',
            slug1='',
            slug2='',
        )
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))

        object_url = self.live_server_url + reverse('admin:admin_views_mainprepopulated_change', args=(item.id,))

        self.selenium.get(object_url)
        self.selenium.find_element_by_id('id_name').send_keys(' the best')

        # The slugs got prepopulated since they were originally empty
        slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
        self.assertEqual(slug1, 'main-name-best-2012-02-18')
        self.assertEqual(slug2, 'option-two-main-name-best')

        # Save the object
        with self.wait_page_loaded():
            self.selenium.find_element_by_xpath('//input[@value="Save"]').click()

        self.selenium.get(object_url)
        self.selenium.find_element_by_id('id_name').send_keys(' hello')

        # The slugs got prepopulated didn't change since they were originally not empty
        slug1 = self.selenium.find_element_by_id('id_slug1').get_attribute('value')
        slug2 = self.selenium.find_element_by_id('id_slug2').get_attribute('value')
        self.assertEqual(slug1, 'main-name-best-2012-02-18')
        self.assertEqual(slug2, 'option-two-main-name-best')

    def test_collapsible_fieldset(self):
        """
        The 'collapse' class in fieldsets definition allows to
        show/hide the appropriate field section.
        """
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        self.selenium.get(self.live_server_url + reverse('admin:admin_views_article_add'))
        self.assertFalse(self.selenium.find_element_by_id('id_title').is_displayed())
        self.selenium.find_elements_by_link_text('Show')[0].click()
        self.assertTrue(self.selenium.find_element_by_id('id_title').is_displayed())
        self.assertEqual(self.selenium.find_element_by_id('fieldsetcollapser0').text, "Hide")

    def test_first_field_focus(self):
        """JavaScript-assisted auto-focus on first usable form field."""
        # First form field has a single widget
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        with self.wait_page_loaded():
            self.selenium.get(self.live_server_url + reverse('admin:admin_views_picture_add'))
        self.assertEqual(
            self.selenium.switch_to.active_element,
            self.selenium.find_element_by_id('id_name')
        )

        # First form field has a MultiWidget
        with self.wait_page_loaded():
            self.selenium.get(self.live_server_url + reverse('admin:admin_views_reservation_add'))
        self.assertEqual(
            self.selenium.switch_to.active_element,
            self.selenium.find_element_by_id('id_start_date_0')
        )

    def test_cancel_delete_confirmation(self):
        "Cancelling the deletion of an object takes the user back one page."
        pizza = Pizza.objects.create(name="Double Cheese")
        url = reverse('admin:admin_views_pizza_change', args=(pizza.id,))
        full_url = self.live_server_url + url
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        self.selenium.get(full_url)
        self.selenium.find_element_by_class_name('deletelink').click()
        # Click 'cancel' on the delete page.
        self.selenium.find_element_by_class_name('cancel-link').click()
        # Wait until we're back on the change page.
        self.wait_for_text('#content h1', 'Change pizza')
        self.assertEqual(self.selenium.current_url, full_url)
        self.assertEqual(Pizza.objects.count(), 1)

    def test_cancel_delete_related_confirmation(self):
        """
        Cancelling the deletion of an object with relations takes the user back
        one page.
        """
        pizza = Pizza.objects.create(name="Double Cheese")
        topping1 = Topping.objects.create(name="Cheddar")
        topping2 = Topping.objects.create(name="Mozzarella")
        pizza.toppings.add(topping1, topping2)
        url = reverse('admin:admin_views_pizza_change', args=(pizza.id,))
        full_url = self.live_server_url + url
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        self.selenium.get(full_url)
        self.selenium.find_element_by_class_name('deletelink').click()
        # Click 'cancel' on the delete page.
        self.selenium.find_element_by_class_name('cancel-link').click()
        # Wait until we're back on the change page.
        self.wait_for_text('#content h1', 'Change pizza')
        self.assertEqual(self.selenium.current_url, full_url)
        self.assertEqual(Pizza.objects.count(), 1)
        self.assertEqual(Topping.objects.count(), 2)

    def test_list_editable_popups(self):
        """
        list_editable foreign keys have add/change popups.
        """
        from selenium.webdriver.support.ui import Select
        s1 = Section.objects.create(name='Test section')
        Article.objects.create(
            title='foo',
            content='<p>Middle content</p>',
            date=datetime.datetime(2008, 3, 18, 11, 54, 58),
            section=s1,
        )
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        self.selenium.get(self.live_server_url + reverse('admin:admin_views_article_changelist'))
        # Change popup
        self.selenium.find_element_by_id('change_id_form-0-section').click()
        self.wait_for_and_switch_to_popup()
        self.wait_for_text('#content h1', 'Change section')
        name_input = self.selenium.find_element_by_id('id_name')
        name_input.clear()
        name_input.send_keys('<i>edited section</i>')
        self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        select = Select(self.selenium.find_element_by_id('id_form-0-section'))
        self.assertEqual(select.first_selected_option.text, '<i>edited section</i>')
        # Rendered select2 input.
        select2_display = self.selenium.find_element_by_class_name('select2-selection__rendered')
        # Clear button (×\n) is included in text.
        self.assertEqual(select2_display.text, '×\n<i>edited section</i>')

        # Add popup
        self.selenium.find_element_by_id('add_id_form-0-section').click()
        self.wait_for_and_switch_to_popup()
        self.wait_for_text('#content h1', 'Add section')
        self.selenium.find_element_by_id('id_name').send_keys('new section')
        self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        select = Select(self.selenium.find_element_by_id('id_form-0-section'))
        self.assertEqual(select.first_selected_option.text, 'new section')
        select2_display = self.selenium.find_element_by_class_name('select2-selection__rendered')
        # Clear button (×\n) is included in text.
        self.assertEqual(select2_display.text, '×\nnew section')

    def test_inline_uuid_pk_edit_with_popup(self):
        from selenium.webdriver.support.ui import Select
        parent = ParentWithUUIDPK.objects.create(title='test')
        related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
        self.selenium.get(self.live_server_url + change_url)
        self.selenium.find_element_by_id('change_id_parent').click()
        self.wait_for_and_switch_to_popup()
        self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        select = Select(self.selenium.find_element_by_id('id_parent'))
        self.assertEqual(select.first_selected_option.text, str(parent.id))
        self.assertEqual(select.first_selected_option.get_attribute('value'), str(parent.id))

    def test_inline_uuid_pk_add_with_popup(self):
        from selenium.webdriver.support.ui import Select
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        self.selenium.get(self.live_server_url + reverse('admin:admin_views_relatedwithuuidpkmodel_add'))
        self.selenium.find_element_by_id('add_id_parent').click()
        self.wait_for_and_switch_to_popup()
        self.selenium.find_element_by_id('id_title').send_keys('test')
        self.selenium.find_element_by_xpath('//input[@value="Save"]').click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        select = Select(self.selenium.find_element_by_id('id_parent'))
        uuid_id = str(ParentWithUUIDPK.objects.first().id)
        self.assertEqual(select.first_selected_option.text, uuid_id)
        self.assertEqual(select.first_selected_option.get_attribute('value'), uuid_id)

    def test_inline_uuid_pk_delete_with_popup(self):
        from selenium.webdriver.support.ui import Select
        parent = ParentWithUUIDPK.objects.create(title='test')
        related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
        self.selenium.get(self.live_server_url + change_url)
        self.selenium.find_element_by_id('delete_id_parent').click()
        self.wait_for_and_switch_to_popup()
        self.selenium.find_element_by_xpath('//input[@value="Yes, I’m sure"]').click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        select = Select(self.selenium.find_element_by_id('id_parent'))
        self.assertEqual(ParentWithUUIDPK.objects.count(), 0)
        self.assertEqual(select.first_selected_option.text, '---------')
        self.assertEqual(select.first_selected_option.get_attribute('value'), '')

    def test_inline_with_popup_cancel_delete(self):
        """Clicking ""No, take me back" on a delete popup closes the window."""
        parent = ParentWithUUIDPK.objects.create(title='test')
        related_with_parent = RelatedWithUUIDPKModel.objects.create(parent=parent)
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_change', args=(related_with_parent.id,))
        self.selenium.get(self.live_server_url + change_url)
        self.selenium.find_element_by_id('delete_id_parent').click()
        self.wait_for_and_switch_to_popup()
        self.selenium.find_element_by_xpath('//a[text()="No, take me back"]').click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        self.assertEqual(len(self.selenium.window_handles), 1)

    def test_list_editable_raw_id_fields(self):
        parent = ParentWithUUIDPK.objects.create(title='test')
        parent2 = ParentWithUUIDPK.objects.create(title='test2')
        RelatedWithUUIDPKModel.objects.create(parent=parent)
        self.admin_login(username='super', password='secret', login_url=reverse('admin:index'))
        change_url = reverse('admin:admin_views_relatedwithuuidpkmodel_changelist', current_app=site2.name)
        self.selenium.get(self.live_server_url + change_url)
        self.selenium.find_element_by_id('lookup_id_form-0-parent').click()
        self.wait_for_and_switch_to_popup()
        # Select "parent2" in the popup.
        self.selenium.find_element_by_link_text(str(parent2.pk)).click()
        self.selenium.switch_to.window(self.selenium.window_handles[0])
        # The newly selected pk should appear in the raw id input.
        value = self.selenium.find_element_by_id('id_form-0-parent').get_attribute('value')
        self.assertEqual(value, str(parent2.pk))

File: tests/admin_views/tests.py
Line number range: 1420 - 2417
Content:
@override_settings(
    ROOT_URLCONF='admin_views.urls',
    # Test with the admin's documented list of required context processors.
    TEMPLATES=[{
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    }],
)
class AdminViewPermissionsTest(TestCase):
    """Tests for Admin Views Permissions."""

    @classmethod
    def setUpTestData(cls):
        cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
        cls.viewuser = User.objects.create_user(username='viewuser', password='secret', is_staff=True)
        cls.adduser = User.objects.create_user(username='adduser', password='secret', is_staff=True)
        cls.changeuser = User.objects.create_user(username='changeuser', password='secret', is_staff=True)
        cls.deleteuser = User.objects.create_user(username='deleteuser', password='secret', is_staff=True)
        cls.joepublicuser = User.objects.create_user(username='joepublic', password='secret')
        cls.nostaffuser = User.objects.create_user(username='nostaff', password='secret')
        cls.s1 = Section.objects.create(name='Test section')
        cls.a1 = Article.objects.create(
            content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1,
            another_section=cls.s1,
        )
        cls.a2 = Article.objects.create(
            content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
        )
        cls.a3 = Article.objects.create(
            content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
        )
        cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')

        # Setup permissions, for our users who can add, change, and delete.
        opts = Article._meta

        # User who can view Articles
        cls.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('view', opts)))
        # User who can add Articles
        cls.adduser.user_permissions.add(get_perm(Article, get_permission_codename('add', opts)))
        # User who can change Articles
        cls.changeuser.user_permissions.add(get_perm(Article, get_permission_codename('change', opts)))
        cls.nostaffuser.user_permissions.add(get_perm(Article, get_permission_codename('change', opts)))

        # User who can delete Articles
        cls.deleteuser.user_permissions.add(get_perm(Article, get_permission_codename('delete', opts)))
        cls.deleteuser.user_permissions.add(get_perm(Section, get_permission_codename('delete', Section._meta)))

        # login POST dicts
        cls.index_url = reverse('admin:index')
        cls.super_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'super',
            'password': 'secret',
        }
        cls.super_email_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'super@example.com',
            'password': 'secret',
        }
        cls.super_email_bad_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'super@example.com',
            'password': 'notsecret',
        }
        cls.adduser_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'adduser',
            'password': 'secret',
        }
        cls.changeuser_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'changeuser',
            'password': 'secret',
        }
        cls.deleteuser_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'deleteuser',
            'password': 'secret',
        }
        cls.nostaff_login = {
            REDIRECT_FIELD_NAME: reverse('has_permission_admin:index'),
            'username': 'nostaff',
            'password': 'secret',
        }
        cls.joepublic_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'joepublic',
            'password': 'secret',
        }
        cls.viewuser_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'username': 'viewuser',
            'password': 'secret',
        }
        cls.no_username_login = {
            REDIRECT_FIELD_NAME: cls.index_url,
            'password': 'secret',
        }

    def test_login(self):
        """
        Make sure only staff members can log in.

        Successful posts to the login page will redirect to the original url.
        Unsuccessful attempts will continue to render the login page with
        a 200 status code.
        """
        login_url = '%s?next=%s' % (reverse('admin:login'), reverse('admin:index'))
        # Super User
        response = self.client.get(self.index_url)
        self.assertRedirects(response, login_url)
        login = self.client.post(login_url, self.super_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)
        self.client.get(reverse('admin:logout'))

        # Test if user enters email address
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.super_email_login)
        self.assertContains(login, ERROR_MESSAGE)
        # only correct passwords get a username hint
        login = self.client.post(login_url, self.super_email_bad_login)
        self.assertContains(login, ERROR_MESSAGE)
        new_user = User(username='jondoe', password='secret', email='super@example.com')
        new_user.save()
        # check to ensure if there are multiple email addresses a user doesn't get a 500
        login = self.client.post(login_url, self.super_email_login)
        self.assertContains(login, ERROR_MESSAGE)

        # View User
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.viewuser_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)
        self.client.get(reverse('admin:logout'))

        # Add User
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.adduser_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)
        self.client.get(reverse('admin:logout'))

        # Change User
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.changeuser_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)
        self.client.get(reverse('admin:logout'))

        # Delete User
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.deleteuser_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)
        self.client.get(reverse('admin:logout'))

        # Regular User should not be able to login.
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.joepublic_login)
        self.assertEqual(login.status_code, 200)
        self.assertContains(login, ERROR_MESSAGE)

        # Requests without username should not return 500 errors.
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        login = self.client.post(login_url, self.no_username_login)
        self.assertEqual(login.status_code, 200)
        self.assertFormError(login, 'form', 'username', ['This field is required.'])

    def test_login_redirect_for_direct_get(self):
        """
        Login redirect should be to the admin index page when going directly to
        /admin/login/.
        """
        response = self.client.get(reverse('admin:login'))
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context[REDIRECT_FIELD_NAME], reverse('admin:index'))

    def test_login_has_permission(self):
        # Regular User should not be able to login.
        response = self.client.get(reverse('has_permission_admin:index'))
        self.assertEqual(response.status_code, 302)
        login = self.client.post(reverse('has_permission_admin:login'), self.joepublic_login)
        self.assertEqual(login.status_code, 200)
        self.assertContains(login, 'permission denied')

        # User with permissions should be able to login.
        response = self.client.get(reverse('has_permission_admin:index'))
        self.assertEqual(response.status_code, 302)
        login = self.client.post(reverse('has_permission_admin:login'), self.nostaff_login)
        self.assertRedirects(login, reverse('has_permission_admin:index'))
        self.assertFalse(login.context)
        self.client.get(reverse('has_permission_admin:logout'))

        # Staff should be able to login.
        response = self.client.get(reverse('has_permission_admin:index'))
        self.assertEqual(response.status_code, 302)
        login = self.client.post(reverse('has_permission_admin:login'), {
            REDIRECT_FIELD_NAME: reverse('has_permission_admin:index'),
            'username': 'deleteuser',
            'password': 'secret',
        })
        self.assertRedirects(login, reverse('has_permission_admin:index'))
        self.assertFalse(login.context)
        self.client.get(reverse('has_permission_admin:logout'))

    def test_login_successfully_redirects_to_original_URL(self):
        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)
        query_string = 'the-answer=42'
        redirect_url = '%s?%s' % (self.index_url, query_string)
        new_next = {REDIRECT_FIELD_NAME: redirect_url}
        post_data = self.super_login.copy()
        post_data.pop(REDIRECT_FIELD_NAME)
        login = self.client.post(
            '%s?%s' % (reverse('admin:login'), urlencode(new_next)),
            post_data)
        self.assertRedirects(login, redirect_url)

    def test_double_login_is_not_allowed(self):
        """Regression test for #19327"""
        login_url = '%s?next=%s' % (reverse('admin:login'), reverse('admin:index'))

        response = self.client.get(self.index_url)
        self.assertEqual(response.status_code, 302)

        # Establish a valid admin session
        login = self.client.post(login_url, self.super_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)

        # Logging in with non-admin user fails
        login = self.client.post(login_url, self.joepublic_login)
        self.assertEqual(login.status_code, 200)
        self.assertContains(login, ERROR_MESSAGE)

        # Establish a valid admin session
        login = self.client.post(login_url, self.super_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)

        # Logging in with admin user while already logged in
        login = self.client.post(login_url, self.super_login)
        self.assertRedirects(login, self.index_url)
        self.assertFalse(login.context)
        self.client.get(reverse('admin:logout'))

    def test_login_page_notice_for_non_staff_users(self):
        """
        A logged-in non-staff user trying to access the admin index should be
        presented with the login page and a hint indicating that the current
        user doesn't have access to it.
        """
        hint_template = 'You are authenticated as {}'

        # Anonymous user should not be shown the hint
        response = self.client.get(self.index_url, follow=True)
        self.assertContains(response, 'login-form')
        self.assertNotContains(response, hint_template.format(''), status_code=200)

        # Non-staff user should be shown the hint
        self.client.force_login(self.nostaffuser)
        response = self.client.get(self.index_url, follow=True)
        self.assertContains(response, 'login-form')
        self.assertContains(response, hint_template.format(self.nostaffuser.username), status_code=200)

    def test_add_view(self):
        """Test add view restricts access and actually adds items."""
        add_dict = {
            'title': 'Døm ikke',
            'content': '<p>great article</p>',
            'date_0': '2008-03-18', 'date_1': '10:54:39',
            'section': self.s1.pk,
        }
        # Change User should not have access to add articles
        self.client.force_login(self.changeuser)
        # make sure the view removes test cookie
        self.assertIs(self.client.session.test_cookie_worked(), False)
        response = self.client.get(reverse('admin:admin_views_article_add'))
        self.assertEqual(response.status_code, 403)
        # Try POST just to make sure
        post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
        self.assertEqual(post.status_code, 403)
        self.assertEqual(Article.objects.count(), 3)
        self.client.get(reverse('admin:logout'))

        # View User should not have access to add articles
        self.client.force_login(self.viewuser)
        response = self.client.get(reverse('admin:admin_views_article_add'))
        self.assertEqual(response.status_code, 403)
        # Try POST just to make sure
        post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
        self.assertEqual(post.status_code, 403)
        self.assertEqual(Article.objects.count(), 3)
        # Now give the user permission to add but not change.
        self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('add', Article._meta)))
        response = self.client.get(reverse('admin:admin_views_article_add'))
        self.assertContains(response, '<input type="submit" value="Save and view" name="_continue">')
        post = self.client.post(reverse('admin:admin_views_article_add'), add_dict, follow=False)
        self.assertEqual(post.status_code, 302)
        self.assertEqual(Article.objects.count(), 4)
        article = Article.objects.latest('pk')
        response = self.client.get(reverse('admin:admin_views_article_change', args=(article.pk,)))
        self.assertContains(response, '<li class="success">The article “Døm ikke” was added successfully.</li>')
        article.delete()
        self.client.get(reverse('admin:logout'))

        # Add user may login and POST to add view, then redirect to admin root
        self.client.force_login(self.adduser)
        addpage = self.client.get(reverse('admin:admin_views_article_add'))
        change_list_link = '&rsaquo; <a href="%s">Articles</a>' % reverse('admin:admin_views_article_changelist')
        self.assertNotContains(
            addpage, change_list_link,
            msg_prefix='User restricted to add permission is given link to change list view in breadcrumbs.'
        )
        post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
        self.assertRedirects(post, self.index_url)
        self.assertEqual(Article.objects.count(), 4)
        self.assertEqual(len(mail.outbox), 2)
        self.assertEqual(mail.outbox[0].subject, 'Greetings from a created object')
        self.client.get(reverse('admin:logout'))

        # The addition was logged correctly
        addition_log = LogEntry.objects.all()[0]
        new_article = Article.objects.last()
        article_ct = ContentType.objects.get_for_model(Article)
        self.assertEqual(addition_log.user_id, self.adduser.pk)
        self.assertEqual(addition_log.content_type_id, article_ct.pk)
        self.assertEqual(addition_log.object_id, str(new_article.pk))
        self.assertEqual(addition_log.object_repr, "Døm ikke")
        self.assertEqual(addition_log.action_flag, ADDITION)
        self.assertEqual(addition_log.get_change_message(), "Added.")

        # Super can add too, but is redirected to the change list view
        self.client.force_login(self.superuser)
        addpage = self.client.get(reverse('admin:admin_views_article_add'))
        self.assertContains(
            addpage, change_list_link,
            msg_prefix='Unrestricted user is not given link to change list view in breadcrumbs.'
        )
        post = self.client.post(reverse('admin:admin_views_article_add'), add_dict)
        self.assertRedirects(post, reverse('admin:admin_views_article_changelist'))
        self.assertEqual(Article.objects.count(), 5)
        self.client.get(reverse('admin:logout'))

        # 8509 - if a normal user is already logged in, it is possible
        # to change user into the superuser without error
        self.client.force_login(self.joepublicuser)
        # Check and make sure that if user expires, data still persists
        self.client.force_login(self.superuser)
        # make sure the view removes test cookie
        self.assertIs(self.client.session.test_cookie_worked(), False)

    @mock.patch('django.contrib.admin.options.InlineModelAdmin.has_change_permission')
    def test_add_view_with_view_only_inlines(self, has_change_permission):
        """User with add permission to a section but view-only for inlines."""
        self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('add', Section._meta)))
        self.client.force_login(self.viewuser)
        # Valid POST creates a new section.
        data = {
            'name': 'New obj',
            'article_set-TOTAL_FORMS': 0,
            'article_set-INITIAL_FORMS': 0,
        }
        response = self.client.post(reverse('admin:admin_views_section_add'), data)
        self.assertRedirects(response, reverse('admin:index'))
        self.assertEqual(Section.objects.latest('id').name, data['name'])
        # InlineModelAdmin.has_change_permission()'s obj argument is always
        # None during object add.
        self.assertEqual([obj for (request, obj), _ in has_change_permission.call_args_list], [None, None])

    def test_change_view(self):
        """Change view should restrict access and allow users to edit items."""
        change_dict = {
            'title': 'Ikke fordømt',
            'content': '<p>edited article</p>',
            'date_0': '2008-03-18', 'date_1': '10:54:39',
            'section': self.s1.pk,
        }
        article_change_url = reverse('admin:admin_views_article_change', args=(self.a1.pk,))
        article_changelist_url = reverse('admin:admin_views_article_changelist')

        # add user should not be able to view the list of article or change any of them
        self.client.force_login(self.adduser)
        response = self.client.get(article_changelist_url)
        self.assertEqual(response.status_code, 403)
        response = self.client.get(article_change_url)
        self.assertEqual(response.status_code, 403)
        post = self.client.post(article_change_url, change_dict)
        self.assertEqual(post.status_code, 403)
        self.client.get(reverse('admin:logout'))

        # view user can view articles but not make changes.
        self.client.force_login(self.viewuser)
        response = self.client.get(article_changelist_url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context['title'], 'Select article to view')
        response = self.client.get(article_change_url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context['title'], 'View article')
        self.assertContains(response, '<label>Extra form field:</label>')
        self.assertContains(response, '<a href="/test_admin/admin/admin_views/article/" class="closelink">Close</a>')
        post = self.client.post(article_change_url, change_dict)
        self.assertEqual(post.status_code, 403)
        self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>Middle content</p>')
        self.client.get(reverse('admin:logout'))

        # change user can view all items and edit them
        self.client.force_login(self.changeuser)
        response = self.client.get(article_changelist_url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context['title'], 'Select article to change')
        response = self.client.get(article_change_url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context['title'], 'Change article')
        post = self.client.post(article_change_url, change_dict)
        self.assertRedirects(post, article_changelist_url)
        self.assertEqual(Article.objects.get(pk=self.a1.pk).content, '<p>edited article</p>')

        # one error in form should produce singular error message, multiple errors plural
        change_dict['title'] = ''
        post = self.client.post(article_change_url, change_dict)
        self.assertContains(
            post, 'Please correct the error below.',
            msg_prefix='Singular error message not found in response to post with one error'
        )

        change_dict['content'] = ''
        post = self.client.post(article_change_url, change_dict)
        self.assertContains(
            post, 'Please correct the errors below.',
            msg_prefix='Plural error message not found in response to post with multiple errors'
        )
        self.client.get(reverse('admin:logout'))

        # Test redirection when using row-level change permissions. Refs #11513.
        r1 = RowLevelChangePermissionModel.objects.create(id=1, name="odd id")
        r2 = RowLevelChangePermissionModel.objects.create(id=2, name="even id")
        r3 = RowLevelChangePermissionModel.objects.create(id=3, name='odd id mult 3')
        r6 = RowLevelChangePermissionModel.objects.create(id=6, name='even id mult 3')
        change_url_1 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r1.pk,))
        change_url_2 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r2.pk,))
        change_url_3 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r3.pk,))
        change_url_6 = reverse('admin:admin_views_rowlevelchangepermissionmodel_change', args=(r6.pk,))
        logins = [self.superuser, self.viewuser, self.adduser, self.changeuser, self.deleteuser]
        for login_user in logins:
            with self.subTest(login_user.username):
                self.client.force_login(login_user)
                response = self.client.get(change_url_1)
                self.assertEqual(response.status_code, 403)
                response = self.client.post(change_url_1, {'name': 'changed'})
                self.assertEqual(RowLevelChangePermissionModel.objects.get(id=1).name, 'odd id')
                self.assertEqual(response.status_code, 403)
                response = self.client.get(change_url_2)
                self.assertEqual(response.status_code, 200)
                response = self.client.post(change_url_2, {'name': 'changed'})
                self.assertEqual(RowLevelChangePermissionModel.objects.get(id=2).name, 'changed')
                self.assertRedirects(response, self.index_url)
                response = self.client.get(change_url_3)
                self.assertEqual(response.status_code, 200)
                response = self.client.post(change_url_3, {'name': 'changed'})
                self.assertEqual(response.status_code, 403)
                self.assertEqual(RowLevelChangePermissionModel.objects.get(id=3).name, 'odd id mult 3')
                response = self.client.get(change_url_6)
                self.assertEqual(response.status_code, 200)
                response = self.client.post(change_url_6, {'name': 'changed'})
                self.assertEqual(RowLevelChangePermissionModel.objects.get(id=6).name, 'changed')
                self.assertRedirects(response, self.index_url)

                self.client.get(reverse('admin:logout'))

        for login_user in [self.joepublicuser, self.nostaffuser]:
            with self.subTest(login_user.username):
                self.client.force_login(login_user)
                response = self.client.get(change_url_1, follow=True)
                self.assertContains(response, 'login-form')
                response = self.client.post(change_url_1, {'name': 'changed'}, follow=True)
                self.assertEqual(RowLevelChangePermissionModel.objects.get(id=1).name, 'odd id')
                self.assertContains(response, 'login-form')
                response = self.client.get(change_url_2, follow=True)
                self.assertContains(response, 'login-form')
                response = self.client.post(change_url_2, {'name': 'changed again'}, follow=True)
                self.assertEqual(RowLevelChangePermissionModel.objects.get(id=2).name, 'changed')
                self.assertContains(response, 'login-form')
                self.client.get(reverse('admin:logout'))

    def test_change_view_without_object_change_permission(self):
        """
        The object should be read-only if the user has permission to view it
        and change objects of that type but not to change the current object.
        """
        change_url = reverse('admin9:admin_views_article_change', args=(self.a1.pk,))
        self.client.force_login(self.viewuser)
        response = self.client.get(change_url)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(response.context['title'], 'View article')
        self.assertContains(response, '<a href="/test_admin/admin9/admin_views/article/" class="closelink">Close</a>')

    def test_change_view_save_as_new(self):
        """
        'Save as new' should raise PermissionDenied for users without the 'add'
        permission.
        """
        change_dict_save_as_new = {
            '_saveasnew': 'Save as new',
            'title': 'Ikke fordømt',
            'content': '<p>edited article</p>',
            'date_0': '2008-03-18', 'date_1': '10:54:39',
            'section': self.s1.pk,
        }
        article_change_url = reverse('admin:admin_views_article_change', args=(self.a1.pk,))

        # Add user can perform "Save as new".
        article_count = Article.objects.count()
        self.client.force_login(self.adduser)
        post = self.client.post(article_change_url, change_dict_save_as_new)
        self.assertRedirects(post, self.index_url)
        self.assertEqual(Article.objects.count(), article_count + 1)
        self.client.logout()

        # Change user cannot perform "Save as new" (no 'add' permission).
        article_count = Article.objects.count()
        self.client.force_login(self.changeuser)
        post = self.client.post(article_change_url, change_dict_save_as_new)
        self.assertEqual(post.status_code, 403)
        self.assertEqual(Article.objects.count(), article_count)

        # User with both add and change permissions should be redirected to the
        # change page for the newly created object.
        article_count = Article.objects.count()
        self.client.force_login(self.superuser)
        post = self.client.post(article_change_url, change_dict_save_as_new)
        self.assertEqual(Article.objects.count(), article_count + 1)
        new_article = Article.objects.latest('id')
        self.assertRedirects(post, reverse('admin:admin_views_article_change', args=(new_article.pk,)))

    def test_change_view_with_view_only_inlines(self):
        """
        User with change permission to a section but view-only for inlines.
        """
        self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
        self.client.force_login(self.viewuser)
        # GET shows inlines.
        response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
        self.assertEqual(len(response.context['inline_admin_formsets']), 1)
        formset = response.context['inline_admin_formsets'][0]
        self.assertEqual(len(formset.forms), 3)
        # Valid POST changes the name.
        data = {
            'name': 'Can edit name with view-only inlines',
            'article_set-TOTAL_FORMS': 3,
            'article_set-INITIAL_FORMS': 3
        }
        response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
        self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
        self.assertEqual(Section.objects.get(pk=self.s1.pk).name, data['name'])
        # Invalid POST reshows inlines.
        del data['name']
        response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.context['inline_admin_formsets']), 1)
        formset = response.context['inline_admin_formsets'][0]
        self.assertEqual(len(formset.forms), 3)

    def test_change_view_with_view_and_add_inlines(self):
        """User has view and add permissions on the inline model."""
        self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
        self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('add', Article._meta)))
        self.client.force_login(self.viewuser)
        # GET shows inlines.
        response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
        self.assertEqual(len(response.context['inline_admin_formsets']), 1)
        formset = response.context['inline_admin_formsets'][0]
        self.assertEqual(len(formset.forms), 6)
        # Valid POST creates a new article.
        data = {
            'name': 'Can edit name with view-only inlines',
            'article_set-TOTAL_FORMS': 6,
            'article_set-INITIAL_FORMS': 3,
            'article_set-3-id': [''],
            'article_set-3-title': ['A title'],
            'article_set-3-content': ['Added content'],
            'article_set-3-date_0': ['2008-3-18'],
            'article_set-3-date_1': ['11:54:58'],
            'article_set-3-section': [str(self.s1.pk)],
        }
        response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
        self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
        self.assertEqual(Section.objects.get(pk=self.s1.pk).name, data['name'])
        self.assertEqual(Article.objects.count(), 4)
        # Invalid POST reshows inlines.
        del data['name']
        response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
        self.assertEqual(response.status_code, 200)
        self.assertEqual(len(response.context['inline_admin_formsets']), 1)
        formset = response.context['inline_admin_formsets'][0]
        self.assertEqual(len(formset.forms), 6)

    def test_change_view_with_view_and_delete_inlines(self):
        """User has view and delete permissions on the inline model."""
        self.viewuser.user_permissions.add(get_perm(Section, get_permission_codename('change', Section._meta)))
        self.client.force_login(self.viewuser)
        data = {
            'name': 'Name is required.',
            'article_set-TOTAL_FORMS': 6,
            'article_set-INITIAL_FORMS': 3,
            'article_set-0-id': [str(self.a1.pk)],
            'article_set-0-DELETE': ['on'],
        }
        # Inline POST details are ignored without delete permission.
        response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
        self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
        self.assertEqual(Article.objects.count(), 3)
        # Deletion successful when delete permission is added.
        self.viewuser.user_permissions.add(get_perm(Article, get_permission_codename('delete', Article._meta)))
        data = {
            'name': 'Name is required.',
            'article_set-TOTAL_FORMS': 6,
            'article_set-INITIAL_FORMS': 3,
            'article_set-0-id': [str(self.a1.pk)],
            'article_set-0-DELETE': ['on'],
        }
        response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), data)
        self.assertRedirects(response, reverse('admin:admin_views_section_changelist'))
        self.assertEqual(Article.objects.count(), 2)

    def test_delete_view(self):
        """Delete view should restrict access and actually delete items."""
        delete_dict = {'post': 'yes'}
        delete_url = reverse('admin:admin_views_article_delete', args=(self.a1.pk,))

        # add user should not be able to delete articles
        self.client.force_login(self.adduser)
        response = self.client.get(delete_url)
        self.assertEqual(response.status_code, 403)
        post = self.client.post(delete_url, delete_dict)
        self.assertEqual(post.status_code, 403)
        self.assertEqual(Article.objects.count(), 3)
        self.client.logout()

        # view user should not be able to delete articles
        self.client.force_login(self.viewuser)
        response = self.client.get(delete_url)
        self.assertEqual(response.status_code, 403)
        post = self.client.post(delete_url, delete_dict)
        self.assertEqual(post.status_code, 403)
        self.assertEqual(Article.objects.count(), 3)
        self.client.logout()

        # Delete user can delete
        self.client.force_login(self.deleteuser)
        response = self.client.get(reverse('admin:admin_views_section_delete', args=(self.s1.pk,)))
        self.assertContains(response, "<h2>Summary</h2>")
        self.assertContains(response, "<li>Articles: 3</li>")
        # test response contains link to related Article
        self.assertContains(response, "admin_views/article/%s/" % self.a1.pk)

        response = self.client.get(delete_url)
        self.assertContains(response, "admin_views/article/%s/" % self.a1.pk)
        self.assertContains(response, "<h2>Summary</h2>")
        self.assertContains(response, "<li>Articles: 1</li>")
        self.assertEqual(response.status_code, 200)
        post = self.client.post(delete_url, delete_dict)
        self.assertRedirects(post, self.index_url)
        self.assertEqual(Article.objects.count(), 2)
        self.assertEqual(len(mail.outbox), 1)
        self.assertEqual(mail.outbox[0].subject, 'Greetings from a deleted object')
        article_ct = ContentType.objects.get_for_model(Article)
        logged = LogEntry.objects.get(content_type=article_ct, action_flag=DELETION)
        self.assertEqual(logged.object_id, str(self.a1.pk))

    def test_delete_view_with_no_default_permissions(self):
        """
        The delete view allows users to delete collected objects without a
        'delete' permission (ReadOnlyPizza.Meta.default_permissions is empty).
        """
        pizza = ReadOnlyPizza.objects.create(name='Double Cheese')
        delete_url = reverse('admin:admin_views_readonlypizza_delete', args=(pizza.pk,))
        self.client.force_login(self.adduser)
        response = self.client.get(delete_url)
        self.assertContains(response, 'admin_views/readonlypizza/%s/' % pizza.pk)
        self.assertContains(response, '<h2>Summary</h2>')
        self.assertContains(response, '<li>Read only pizzas: 1</li>')
        self.assertEqual(response.status_code, 200)
        post = self.client.post(delete_url, {'post': 'yes'})
        self.assertRedirects(post, reverse('admin:admin_views_readonlypizza_changelist'))
        self.assertEqual(ReadOnlyPizza.objects.count(), 0)

    def test_delete_view_nonexistent_obj(self):
        self.client.force_login(self.deleteuser)
        url = reverse('admin:admin_views_article_delete', args=('nonexistent',))
        response = self.client.get(url, follow=True)
        self.assertRedirects(response, reverse('admin:index'))
        self.assertEqual(
            [m.message for m in response.context['messages']],
            ['article with ID “nonexistent” doesn’t exist. Perhaps it was deleted?']
        )

    def test_history_view(self):
        """History view should restrict access."""
        # add user should not be able to view the list of article or change any of them
        self.client.force_login(self.adduser)
        response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
        self.assertEqual(response.status_code, 403)
        self.client.get(reverse('admin:logout'))

        # view user can view all items
        self.client.force_login(self.viewuser)
        response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
        self.assertEqual(response.status_code, 200)
        self.client.get(reverse('admin:logout'))

        # change user can view all items and edit them
        self.client.force_login(self.changeuser)
        response = self.client.get(reverse('admin:admin_views_article_history', args=(self.a1.pk,)))
        self.assertEqual(response.status_code, 200)

        # Test redirection when using row-level change permissions. Refs #11513.
        rl1 = RowLevelChangePermissionModel.objects.create(name="odd id")
        rl2 = RowLevelChangePermissionModel.objects.create(name="even id")
        logins = [self.superuser, self.viewuser, self.adduser, self.changeuser, self.deleteuser]
        for login_user in logins:
            with self.subTest(login_user.username):
                self.client.force_login(login_user)
                url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl1.pk,))
                response = self.client.get(url)
                self.assertEqual(response.status_code, 403)

                url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl2.pk,))
                response = self.client.get(url)
                self.assertEqual(response.status_code, 200)

                self.client.get(reverse('admin:logout'))

        for login_user in [self.joepublicuser, self.nostaffuser]:
            with self.subTest(login_user.username):
                self.client.force_login(login_user)
                url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl1.pk,))
                response = self.client.get(url, follow=True)
                self.assertContains(response, 'login-form')
                url = reverse('admin:admin_views_rowlevelchangepermissionmodel_history', args=(rl2.pk,))
                response = self.client.get(url, follow=True)
                self.assertContains(response, 'login-form')

                self.client.get(reverse('admin:logout'))

    def test_history_view_bad_url(self):
        self.client.force_login(self.changeuser)
        response = self.client.get(reverse('admin:admin_views_article_history', args=('foo',)), follow=True)
        self.assertRedirects(response, reverse('admin:index'))
        self.assertEqual(
            [m.message for m in response.context['messages']],
            ['article with ID “foo” doesn’t exist. Perhaps it was deleted?']
        )

    def test_conditionally_show_add_section_link(self):
        """
        The foreign key widget should only show the "add related" button if the
        user has permission to add that related item.
        """
        self.client.force_login(self.adduser)
        # The user can't add sections yet, so they shouldn't see the "add section" link.
        url = reverse('admin:admin_views_article_add')
        add_link_text = 'add_id_section'
        response = self.client.get(url)
        self.assertNotContains(response, add_link_text)
        # Allow the user to add sections too. Now they can see the "add section" link.
        user = User.objects.get(username='adduser')
        perm = get_perm(Section, get_permission_codename('add', Section._meta))
        user.user_permissions.add(perm)
        response = self.client.get(url)
        self.assertContains(response, add_link_text)

    def test_conditionally_show_change_section_link(self):
        """
        The foreign key widget should only show the "change related" button if
        the user has permission to change that related item.
        """
        def get_change_related(response):
            return response.context['adminform'].form.fields['section'].widget.can_change_related

        self.client.force_login(self.adduser)
        # The user can't change sections yet, so they shouldn't see the "change section" link.
        url = reverse('admin:admin_views_article_add')
        change_link_text = 'change_id_section'
        response = self.client.get(url)
        self.assertFalse(get_change_related(response))
        self.assertNotContains(response, change_link_text)
        # Allow the user to change sections too. Now they can see the "change section" link.
        user = User.objects.get(username='adduser')
        perm = get_perm(Section, get_permission_codename('change', Section._meta))
        user.user_permissions.add(perm)
        response = self.client.get(url)
        self.assertTrue(get_change_related(response))
        self.assertContains(response, change_link_text)

    def test_conditionally_show_delete_section_link(self):
        """
        The foreign key widget should only show the "delete related" button if
        the user has permission to delete that related item.
        """
        def get_delete_related(response):
            return response.context['adminform'].form.fields['sub_section'].widget.can_delete_related

        self.client.force_login(self.adduser)
        # The user can't delete sections yet, so they shouldn't see the "delete section" link.
        url = reverse('admin:admin_views_article_add')
        delete_link_text = 'delete_id_sub_section'
        response = self.client.get(url)
        self.assertFalse(get_delete_related(response))
        self.assertNotContains(response, delete_link_text)
        # Allow the user to delete sections too. Now they can see the "delete section" link.
        user = User.objects.get(username='adduser')
        perm = get_perm(Section, get_permission_codename('delete', Section._meta))
        user.user_permissions.add(perm)
        response = self.client.get(url)
        self.assertTrue(get_delete_related(response))
        self.assertContains(response, delete_link_text)

    def test_disabled_permissions_when_logged_in(self):
        self.client.force_login(self.superuser)
        superuser = User.objects.get(username='super')
        superuser.is_active = False
        superuser.save()

        response = self.client.get(self.index_url, follow=True)
        self.assertContains(response, 'id="login-form"')
        self.assertNotContains(response, 'Log out')

        response = self.client.get(reverse('secure_view'), follow=True)
        self.assertContains(response, 'id="login-form"')

    def test_disabled_staff_permissions_when_logged_in(self):
        self.client.force_login(self.superuser)
        superuser = User.objects.get(username='super')
        superuser.is_staff = False
        superuser.save()

        response = self.client.get(self.index_url, follow=True)
        self.assertContains(response, 'id="login-form"')
        self.assertNotContains(response, 'Log out')

        response = self.client.get(reverse('secure_view'), follow=True)
        self.assertContains(response, 'id="login-form"')

    def test_app_list_permissions(self):
        """
        If a user has no module perms, the app list returns a 404.
        """
        opts = Article._meta
        change_user = User.objects.get(username='changeuser')
        permission = get_perm(Article, get_permission_codename('change', opts))

        self.client.force_login(self.changeuser)

        # the user has no module permissions
        change_user.user_permissions.remove(permission)
        response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
        self.assertEqual(response.status_code, 404)

        # the user now has module permissions
        change_user.user_permissions.add(permission)
        response = self.client.get(reverse('admin:app_list', args=('admin_views',)))
        self.assertEqual(response.status_code, 200)

    def test_shortcut_view_only_available_to_staff(self):
        """
        Only admin users should be able to use the admin shortcut view.
        """
        model_ctype = ContentType.objects.get_for_model(ModelWithStringPrimaryKey)
        obj = ModelWithStringPrimaryKey.objects.create(string_pk='foo')
        shortcut_url = reverse('admin:view_on_site', args=(model_ctype.pk, obj.pk))

        # Not logged in: we should see the login page.
        response = self.client.get(shortcut_url, follow=True)
        self.assertTemplateUsed(response, 'admin/login.html')

        # Logged in? Redirect.
        self.client.force_login(self.superuser)
        response = self.client.get(shortcut_url, follow=False)
        # Can't use self.assertRedirects() because User.get_absolute_url() is silly.
        self.assertEqual(response.status_code, 302)
        # Domain may depend on contrib.sites tests also run
        self.assertRegex(response.url, 'http://(testserver|example.com)/dummy/foo/')

    def test_has_module_permission(self):
        """
        has_module_permission() returns True for all users who
        have any permission for that module (add, change, or delete), so that
        the module is displayed on the admin index page.
        """
        self.client.force_login(self.superuser)
        response = self.client.get(self.index_url)
        self.assertContains(response, 'admin_views')
        self.assertContains(response, 'Articles')
        self.client.logout()

        self.client.force_login(self.viewuser)
        response = self.client.get(self.index_url)
        self.assertContains(response, 'admin_views')
        self.assertContains(response, 'Articles')
        self.client.logout()

        self.client.force_login(self.adduser)
        response = self.client.get(self.index_url)
        self.assertContains(response, 'admin_views')
        self.assertContains(response, 'Articles')
        self.client.logout()

        self.client.force_login(self.changeuser)
        response = self.client.get(self.index_url)
        self.assertContains(response, 'admin_views')
        self.assertContains(response, 'Articles')
        self.client.logout()

        self.client.force_login(self.deleteuser)
        response = self.client.get(self.index_url)
        self.assertContains(response, 'admin_views')
        self.assertContains(response, 'Articles')

    def test_overriding_has_module_permission(self):
        """
        If has_module_permission() always returns False, the module shouldn't
        be displayed on the admin index page for any users.
        """
        articles = Article._meta.verbose_name_plural.title()
        sections = Section._meta.verbose_name_plural.title()
        index_url = reverse('admin7:index')

        self.client.force_login(self.superuser)
        response = self.client.get(index_url)
        self.assertContains(response, sections)
        self.assertNotContains(response, articles)
        self.client.logout()

        self.client.force_login(self.viewuser)
        response = self.client.get(index_url)
        self.assertNotContains(response, 'admin_views')
        self.assertNotContains(response, articles)
        self.client.logout()

        self.client.force_login(self.adduser)
        response = self.client.get(index_url)
        self.assertNotContains(response, 'admin_views')
        self.assertNotContains(response, articles)
        self.client.logout()

        self.client.force_login(self.changeuser)
        response = self.client.get(index_url)
        self.assertNotContains(response, 'admin_views')
        self.assertNotContains(response, articles)
        self.client.logout()

        self.client.force_login(self.deleteuser)
        response = self.client.get(index_url)
        self.assertNotContains(response, articles)

        # The app list displays Sections but not Articles as the latter has
        # ModelAdmin.has_module_permission() = False.
        self.client.force_login(self.superuser)
        response = self.client.get(reverse('admin7:app_list', args=('admin_views',)))
        self.assertContains(response, sections)
        self.assertNotContains(response, articles)

    def test_post_save_message_no_forbidden_links_visible(self):
        """
        Post-save message shouldn't contain a link to the change form if the
        user doesn't have the change permission.
        """
        self.client.force_login(self.adduser)
        # Emulate Article creation for user with add-only permission.
        post_data = {
            "title": "Fun & games",
            "content": "Some content",
            "date_0": "2015-10-31",
            "date_1": "16:35:00",
            "_save": "Save",
        }
        response = self.client.post(reverse('admin:admin_views_article_add'), post_data, follow=True)
        self.assertContains(
            response,
            '<li class="success">The article “Fun &amp; games” was added successfully.</li>',
            html=True
        )

File: tests/admin_views/tests.py
Line number range: 1 - 500
Content:
1. import datetime
2. import os
3. import re
4. import unittest
5. from unittest import mock
6. from urllib.parse import parse_qsl, urljoin, urlparse
7. 
8. import pytz
9. 
10. from django.contrib.admin import AdminSite, ModelAdmin
11. from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
12. from django.contrib.admin.models import ADDITION, DELETION, LogEntry
13. from django.contrib.admin.options import TO_FIELD_VAR
14. from django.contrib.admin.templatetags.admin_urls import add_preserved_filters
15. from django.contrib.admin.tests import AdminSeleniumTestCase
16. from django.contrib.admin.utils import quote
17. from django.contrib.admin.views.main import IS_POPUP_VAR
18. from django.contrib.auth import REDIRECT_FIELD_NAME, get_permission_codename
19. from django.contrib.auth.models import Group, Permission, User
20. from django.contrib.contenttypes.models import ContentType
21. from django.core import mail
22. from django.core.checks import Error
23. from django.core.files import temp as tempfile
24. from django.forms.utils import ErrorList
25. from django.template.response import TemplateResponse
26. from django.test import (
27.     TestCase, modify_settings, override_settings, skipUnlessDBFeature,
28. )
29. from django.test.utils import override_script_prefix
30. from django.urls import NoReverseMatch, resolve, reverse
31. from django.utils import formats, translation
32. from django.utils.cache import get_max_age
33. from django.utils.encoding import iri_to_uri
34. from django.utils.html import escape
35. from django.utils.http import urlencode
36. 
37. from . import customadmin
38. from .admin import CityAdmin, site, site2
39. from .models import (
40.     Actor, AdminOrderedAdminMethod, AdminOrderedCallable, AdminOrderedField,
41.     AdminOrderedModelMethod, Album, Answer, Answer2, Article, BarAccount, Book,
42.     Bookmark, Category, Chapter, ChapterXtra1, ChapterXtra2, Character, Child,
43.     Choice, City, Collector, Color, ComplexSortedPerson, CoverLetter,
44.     CustomArticle, CyclicOne, CyclicTwo, DooHickey, Employee, EmptyModel,
45.     Fabric, FancyDoodad, FieldOverridePost, FilteredManager, FooAccount,
46.     FoodDelivery, FunkyTag, Gallery, Grommet, Inquisition, Language, Link,
47.     MainPrepopulated, Media, ModelWithStringPrimaryKey, OtherStory, Paper,
48.     Parent, ParentWithDependentChildren, ParentWithUUIDPK, Person, Persona,
49.     Picture, Pizza, Plot, PlotDetails, PluggableSearchPerson, Podcast, Post,
50.     PrePopulatedPost, Promo, Question, ReadablePizza, ReadOnlyPizza,
51.     Recommendation, Recommender, RelatedPrepopulated, RelatedWithUUIDPKModel,
52.     Report, Restaurant, RowLevelChangePermissionModel, SecretHideout, Section,
53.     ShortMessage, Simple, Song, State, Story, SuperSecretHideout, SuperVillain,
54.     Telegram, TitleTranslation, Topping, UnchangeableObject, UndeletableObject,
55.     UnorderedObject, UserProxy, Villain, Vodcast, Whatsit, Widget, Worker,
56.     WorkHour,
57. )
58. 
59. ERROR_MESSAGE = "Please enter the correct username and password \
60. for a staff account. Note that both fields may be case-sensitive."
61. 
62. MULTIPART_ENCTYPE = 'enctype="multipart/form-data"'
63. 
64. 
65. class AdminFieldExtractionMixin:
66.     """
67.     Helper methods for extracting data from AdminForm.
68.     """
69.     def get_admin_form_fields(self, response):
70.         """
71.         Return a list of AdminFields for the AdminForm in the response.
72.         """
73.         fields = []
74.         for fieldset in response.context['adminform']:
75.             for field_line in fieldset:
76.                 fields.extend(field_line)
77.         return fields
78. 
79.     def get_admin_readonly_fields(self, response):
80.         """
81.         Return the readonly fields for the response's AdminForm.
82.         """
83.         return [f for f in self.get_admin_form_fields(response) if f.is_readonly]
84. 
85.     def get_admin_readonly_field(self, response, field_name):
86.         """
87.         Return the readonly field for the given field_name.
88.         """
89.         admin_readonly_fields = self.get_admin_readonly_fields(response)
90.         for field in admin_readonly_fields:
91.             if field.field['name'] == field_name:
92.                 return field
93. 
94. 
95. @override_settings(ROOT_URLCONF='admin_views.urls', USE_I18N=True, USE_L10N=False, LANGUAGE_CODE='en')
96. class AdminViewBasicTestCase(TestCase):
97. 
98.     @classmethod
99.     def setUpTestData(cls):
100.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
101.         cls.s1 = Section.objects.create(name='Test section')
102.         cls.a1 = Article.objects.create(
103.             content='<p>Middle content</p>', date=datetime.datetime(2008, 3, 18, 11, 54, 58), section=cls.s1
104.         )
105.         cls.a2 = Article.objects.create(
106.             content='<p>Oldest content</p>', date=datetime.datetime(2000, 3, 18, 11, 54, 58), section=cls.s1
107.         )
108.         cls.a3 = Article.objects.create(
109.             content='<p>Newest content</p>', date=datetime.datetime(2009, 3, 18, 11, 54, 58), section=cls.s1
110.         )
111.         cls.p1 = PrePopulatedPost.objects.create(title='A Long Title', published=True, slug='a-long-title')
112.         cls.color1 = Color.objects.create(value='Red', warm=True)
113.         cls.color2 = Color.objects.create(value='Orange', warm=True)
114.         cls.color3 = Color.objects.create(value='Blue', warm=False)
115.         cls.color4 = Color.objects.create(value='Green', warm=False)
116.         cls.fab1 = Fabric.objects.create(surface='x')
117.         cls.fab2 = Fabric.objects.create(surface='y')
118.         cls.fab3 = Fabric.objects.create(surface='plain')
119.         cls.b1 = Book.objects.create(name='Book 1')
120.         cls.b2 = Book.objects.create(name='Book 2')
121.         cls.pro1 = Promo.objects.create(name='Promo 1', book=cls.b1)
122.         cls.pro1 = Promo.objects.create(name='Promo 2', book=cls.b2)
123.         cls.chap1 = Chapter.objects.create(title='Chapter 1', content='[ insert contents here ]', book=cls.b1)
124.         cls.chap2 = Chapter.objects.create(title='Chapter 2', content='[ insert contents here ]', book=cls.b1)
125.         cls.chap3 = Chapter.objects.create(title='Chapter 1', content='[ insert contents here ]', book=cls.b2)
126.         cls.chap4 = Chapter.objects.create(title='Chapter 2', content='[ insert contents here ]', book=cls.b2)
127.         cls.cx1 = ChapterXtra1.objects.create(chap=cls.chap1, xtra='ChapterXtra1 1')
128.         cls.cx2 = ChapterXtra1.objects.create(chap=cls.chap3, xtra='ChapterXtra1 2')
129.         Actor.objects.create(name='Palin', age=27)
130. 
131.         # Post data for edit inline
132.         cls.inline_post_data = {
133.             "name": "Test section",
134.             # inline data
135.             "article_set-TOTAL_FORMS": "6",
136.             "article_set-INITIAL_FORMS": "3",
137.             "article_set-MAX_NUM_FORMS": "0",
138.             "article_set-0-id": cls.a1.pk,
139.             # there is no title in database, give one here or formset will fail.
140.             "article_set-0-title": "Norske bostaver æøå skaper problemer",
141.             "article_set-0-content": "&lt;p&gt;Middle content&lt;/p&gt;",
142.             "article_set-0-date_0": "2008-03-18",
143.             "article_set-0-date_1": "11:54:58",
144.             "article_set-0-section": cls.s1.pk,
145.             "article_set-1-id": cls.a2.pk,
146.             "article_set-1-title": "Need a title.",
147.             "article_set-1-content": "&lt;p&gt;Oldest content&lt;/p&gt;",
148.             "article_set-1-date_0": "2000-03-18",
149.             "article_set-1-date_1": "11:54:58",
150.             "article_set-2-id": cls.a3.pk,
151.             "article_set-2-title": "Need a title.",
152.             "article_set-2-content": "&lt;p&gt;Newest content&lt;/p&gt;",
153.             "article_set-2-date_0": "2009-03-18",
154.             "article_set-2-date_1": "11:54:58",
155.             "article_set-3-id": "",
156.             "article_set-3-title": "",
157.             "article_set-3-content": "",
158.             "article_set-3-date_0": "",
159.             "article_set-3-date_1": "",
160.             "article_set-4-id": "",
161.             "article_set-4-title": "",
162.             "article_set-4-content": "",
163.             "article_set-4-date_0": "",
164.             "article_set-4-date_1": "",
165.             "article_set-5-id": "",
166.             "article_set-5-title": "",
167.             "article_set-5-content": "",
168.             "article_set-5-date_0": "",
169.             "article_set-5-date_1": "",
170.         }
171. 
172.     def setUp(self):
173.         self.client.force_login(self.superuser)
174. 
175.     def assertContentBefore(self, response, text1, text2, failing_msg=None):
176.         """
177.         Testing utility asserting that text1 appears before text2 in response
178.         content.
179.         """
180.         self.assertEqual(response.status_code, 200)
181.         self.assertLess(
182.             response.content.index(text1.encode()),
183.             response.content.index(text2.encode()),
184.             (failing_msg or '') + '\nResponse:\n' + response.content.decode(response.charset)
185.         )
186. 
187. 
188. class AdminViewBasicTest(AdminViewBasicTestCase):
189.     def test_trailing_slash_required(self):
190.         """
191.         If you leave off the trailing slash, app should redirect and add it.
192.         """
193.         add_url = reverse('admin:admin_views_article_add')
194.         response = self.client.get(add_url[:-1])
195.         self.assertRedirects(response, add_url, status_code=301)
196. 
197.     def test_basic_add_GET(self):
198.         """
199.         A smoke test to ensure GET on the add_view works.
200.         """
201.         response = self.client.get(reverse('admin:admin_views_section_add'))
202.         self.assertIsInstance(response, TemplateResponse)
203.         self.assertEqual(response.status_code, 200)
204. 
205.     def test_add_with_GET_args(self):
206.         response = self.client.get(reverse('admin:admin_views_section_add'), {'name': 'My Section'})
207.         self.assertContains(
208.             response, 'value="My Section"',
209.             msg_prefix="Couldn't find an input with the right value in the response"
210.         )
211. 
212.     def test_basic_edit_GET(self):
213.         """
214.         A smoke test to ensure GET on the change_view works.
215.         """
216.         response = self.client.get(reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
217.         self.assertIsInstance(response, TemplateResponse)
218.         self.assertEqual(response.status_code, 200)
219. 
220.     def test_basic_edit_GET_string_PK(self):
221.         """
222.         GET on the change_view (when passing a string as the PK argument for a
223.         model with an integer PK field) redirects to the index page with a
224.         message saying the object doesn't exist.
225.         """
226.         response = self.client.get(reverse('admin:admin_views_section_change', args=(quote("abc/<b>"),)), follow=True)
227.         self.assertRedirects(response, reverse('admin:index'))
228.         self.assertEqual(
229.             [m.message for m in response.context['messages']],
230.             ['section with ID “abc/<b>” doesn’t exist. Perhaps it was deleted?']
231.         )
232. 
233.     def test_basic_edit_GET_old_url_redirect(self):
234.         """
235.         The change URL changed in Django 1.9, but the old one still redirects.
236.         """
237.         response = self.client.get(
238.             reverse('admin:admin_views_section_change', args=(self.s1.pk,)).replace('change/', '')
239.         )
240.         self.assertRedirects(response, reverse('admin:admin_views_section_change', args=(self.s1.pk,)))
241. 
242.     def test_basic_inheritance_GET_string_PK(self):
243.         """
244.         GET on the change_view (for inherited models) redirects to the index
245.         page with a message saying the object doesn't exist.
246.         """
247.         response = self.client.get(reverse('admin:admin_views_supervillain_change', args=('abc',)), follow=True)
248.         self.assertRedirects(response, reverse('admin:index'))
249.         self.assertEqual(
250.             [m.message for m in response.context['messages']],
251.             ['super villain with ID “abc” doesn’t exist. Perhaps it was deleted?']
252.         )
253. 
254.     def test_basic_add_POST(self):
255.         """
256.         A smoke test to ensure POST on add_view works.
257.         """
258.         post_data = {
259.             "name": "Another Section",
260.             # inline data
261.             "article_set-TOTAL_FORMS": "3",
262.             "article_set-INITIAL_FORMS": "0",
263.             "article_set-MAX_NUM_FORMS": "0",
264.         }
265.         response = self.client.post(reverse('admin:admin_views_section_add'), post_data)
266.         self.assertEqual(response.status_code, 302)  # redirect somewhere
267. 
268.     def test_popup_add_POST(self):
269.         """
270.         Ensure http response from a popup is properly escaped.
271.         """
272.         post_data = {
273.             '_popup': '1',
274.             'title': 'title with a new\nline',
275.             'content': 'some content',
276.             'date_0': '2010-09-10',
277.             'date_1': '14:55:39',
278.         }
279.         response = self.client.post(reverse('admin:admin_views_article_add'), post_data)
280.         self.assertContains(response, 'title with a new\\nline')
281. 
282.     def test_basic_edit_POST(self):
283.         """
284.         A smoke test to ensure POST on edit_view works.
285.         """
286.         url = reverse('admin:admin_views_section_change', args=(self.s1.pk,))
287.         response = self.client.post(url, self.inline_post_data)
288.         self.assertEqual(response.status_code, 302)  # redirect somewhere
289. 
290.     def test_edit_save_as(self):
291.         """
292.         Test "save as".
293.         """
294.         post_data = self.inline_post_data.copy()
295.         post_data.update({
296.             '_saveasnew': 'Save+as+new',
297.             "article_set-1-section": "1",
298.             "article_set-2-section": "1",
299.             "article_set-3-section": "1",
300.             "article_set-4-section": "1",
301.             "article_set-5-section": "1",
302.         })
303.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), post_data)
304.         self.assertEqual(response.status_code, 302)  # redirect somewhere
305. 
306.     def test_edit_save_as_delete_inline(self):
307.         """
308.         Should be able to "Save as new" while also deleting an inline.
309.         """
310.         post_data = self.inline_post_data.copy()
311.         post_data.update({
312.             '_saveasnew': 'Save+as+new',
313.             "article_set-1-section": "1",
314.             "article_set-2-section": "1",
315.             "article_set-2-DELETE": "1",
316.             "article_set-3-section": "1",
317.         })
318.         response = self.client.post(reverse('admin:admin_views_section_change', args=(self.s1.pk,)), post_data)
319.         self.assertEqual(response.status_code, 302)
320.         # started with 3 articles, one was deleted.
321.         self.assertEqual(Section.objects.latest('id').article_set.count(), 2)
322. 
323.     def test_change_list_column_field_classes(self):
324.         response = self.client.get(reverse('admin:admin_views_article_changelist'))
325.         # callables display the callable name.
326.         self.assertContains(response, 'column-callable_year')
327.         self.assertContains(response, 'field-callable_year')
328.         # lambdas display as "lambda" + index that they appear in list_display.
329.         self.assertContains(response, 'column-lambda8')
330.         self.assertContains(response, 'field-lambda8')
331. 
332.     def test_change_list_sorting_callable(self):
333.         """
334.         Ensure we can sort on a list_display field that is a callable
335.         (column 2 is callable_year in ArticleAdmin)
336.         """
337.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 2})
338.         self.assertContentBefore(
339.             response, 'Oldest content', 'Middle content',
340.             "Results of sorting on callable are out of order."
341.         )
342.         self.assertContentBefore(
343.             response, 'Middle content', 'Newest content',
344.             "Results of sorting on callable are out of order."
345.         )
346. 
347.     def test_change_list_sorting_property(self):
348.         """
349.         Sort on a list_display field that is a property (column 10 is
350.         a property in Article model).
351.         """
352.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': 10})
353.         self.assertContentBefore(
354.             response,
355.             'Oldest content',
356.             'Middle content',
357.             'Results of sorting on property are out of order.',
358.         )
359.         self.assertContentBefore(
360.             response,
361.             'Middle content',
362.             'Newest content',
363.             'Results of sorting on property are out of order.',
364.         )
365. 
366.     def test_change_list_sorting_callable_query_expression(self):
367.         """Query expressions may be used for admin_order_field."""
368.         tests = [
369.             ('order_by_expression', 9),
370.             ('order_by_f_expression', 12),
371.             ('order_by_orderby_expression', 13),
372.         ]
373.         for admin_order_field, index in tests:
374.             with self.subTest(admin_order_field):
375.                 response = self.client.get(
376.                     reverse('admin:admin_views_article_changelist'),
377.                     {'o': index},
378.                 )
379.                 self.assertContentBefore(
380.                     response, 'Oldest content', 'Middle content',
381.                     'Results of sorting on callable are out of order.'
382.                 )
383.                 self.assertContentBefore(
384.                     response, 'Middle content', 'Newest content',
385.                     'Results of sorting on callable are out of order.'
386.                 )
387. 
388.     def test_change_list_sorting_callable_query_expression_reverse(self):
389.         tests = [
390.             ('order_by_expression', -9),
391.             ('order_by_f_expression', -12),
392.             ('order_by_orderby_expression', -13),
393.         ]
394.         for admin_order_field, index in tests:
395.             with self.subTest(admin_order_field):
396.                 response = self.client.get(
397.                     reverse('admin:admin_views_article_changelist'),
398.                     {'o': index},
399.                 )
400.                 self.assertContentBefore(
401.                     response, 'Middle content', 'Oldest content',
402.                     'Results of sorting on callable are out of order.'
403.                 )
404.                 self.assertContentBefore(
405.                     response, 'Newest content', 'Middle content',
406.                     'Results of sorting on callable are out of order.'
407.                 )
408. 
409.     def test_change_list_sorting_model(self):
410.         """
411.         Ensure we can sort on a list_display field that is a Model method
412.         (column 3 is 'model_year' in ArticleAdmin)
413.         """
414.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-3'})
415.         self.assertContentBefore(
416.             response, 'Newest content', 'Middle content',
417.             "Results of sorting on Model method are out of order."
418.         )
419.         self.assertContentBefore(
420.             response, 'Middle content', 'Oldest content',
421.             "Results of sorting on Model method are out of order."
422.         )
423. 
424.     def test_change_list_sorting_model_admin(self):
425.         """
426.         Ensure we can sort on a list_display field that is a ModelAdmin method
427.         (column 4 is 'modeladmin_year' in ArticleAdmin)
428.         """
429.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '4'})
430.         self.assertContentBefore(
431.             response, 'Oldest content', 'Middle content',
432.             "Results of sorting on ModelAdmin method are out of order."
433.         )
434.         self.assertContentBefore(
435.             response, 'Middle content', 'Newest content',
436.             "Results of sorting on ModelAdmin method are out of order."
437.         )
438. 
439.     def test_change_list_sorting_model_admin_reverse(self):
440.         """
441.         Ensure we can sort on a list_display field that is a ModelAdmin
442.         method in reverse order (i.e. admin_order_field uses the '-' prefix)
443.         (column 6 is 'model_year_reverse' in ArticleAdmin)
444.         """
445.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '6'})
446.         self.assertContentBefore(
447.             response, '2009', '2008',
448.             "Results of sorting on ModelAdmin method are out of order."
449.         )
450.         self.assertContentBefore(
451.             response, '2008', '2000',
452.             "Results of sorting on ModelAdmin method are out of order."
453.         )
454.         # Let's make sure the ordering is right and that we don't get a
455.         # FieldError when we change to descending order
456.         response = self.client.get(reverse('admin:admin_views_article_changelist'), {'o': '-6'})
457.         self.assertContentBefore(
458.             response, '2000', '2008',
459.             "Results of sorting on ModelAdmin method are out of order."
460.         )
461.         self.assertContentBefore(
462.             response, '2008', '2009',
463.             "Results of sorting on ModelAdmin method are out of order."
464.         )
465. 
466.     def test_change_list_sorting_multiple(self):
467.         p1 = Person.objects.create(name="Chris", gender=1, alive=True)
468.         p2 = Person.objects.create(name="Chris", gender=2, alive=True)
469.         p3 = Person.objects.create(name="Bob", gender=1, alive=True)
470.         link1 = reverse('admin:admin_views_person_change', args=(p1.pk,))
471.         link2 = reverse('admin:admin_views_person_change', args=(p2.pk,))
472.         link3 = reverse('admin:admin_views_person_change', args=(p3.pk,))
473. 
474.         # Sort by name, gender
475.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {'o': '1.2'})
476.         self.assertContentBefore(response, link3, link1)
477.         self.assertContentBefore(response, link1, link2)
478. 
479.         # Sort by gender descending, name
480.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {'o': '-2.1'})
481.         self.assertContentBefore(response, link2, link3)
482.         self.assertContentBefore(response, link3, link1)
483. 
484.     def test_change_list_sorting_preserve_queryset_ordering(self):
485.         """
486.         If no ordering is defined in `ModelAdmin.ordering` or in the query
487.         string, then the underlying order of the queryset should not be
488.         changed, even if it is defined in `Modeladmin.get_queryset()`.
489.         Refs #11868, #7309.
490.         """
491.         p1 = Person.objects.create(name="Amy", gender=1, alive=True, age=80)
492.         p2 = Person.objects.create(name="Bob", gender=1, alive=True, age=70)
493.         p3 = Person.objects.create(name="Chris", gender=2, alive=False, age=60)
494.         link1 = reverse('admin:admin_views_person_change', args=(p1.pk,))
495.         link2 = reverse('admin:admin_views_person_change', args=(p2.pk,))
496.         link3 = reverse('admin:admin_views_person_change', args=(p3.pk,))
497. 
498.         response = self.client.get(reverse('admin:admin_views_person_changelist'), {})
499.         self.assertContentBefore(response, link3, link2)
500.         self.assertContentBefore(response, link2, link1)

File: tests/admin_widgets/tests.py
Line number range: 638 - 718
Content:
@override_settings(ROOT_URLCONF='admin_widgets.urls')
class RelatedFieldWidgetWrapperTests(SimpleTestCase):
    def test_no_can_add_related(self):
        rel = Individual._meta.get_field('parent').remote_field
        w = widgets.AdminRadioSelect()
        # Used to fail with a name error.
        w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)
        self.assertFalse(w.can_add_related)

    def test_select_multiple_widget_cant_change_delete_related(self):
        rel = Individual._meta.get_field('parent').remote_field
        widget = forms.SelectMultiple()
        wrapper = widgets.RelatedFieldWidgetWrapper(
            widget, rel, widget_admin_site,
            can_add_related=True,
            can_change_related=True,
            can_delete_related=True,
        )
        self.assertTrue(wrapper.can_add_related)
        self.assertFalse(wrapper.can_change_related)
        self.assertFalse(wrapper.can_delete_related)

    def test_on_delete_cascade_rel_cant_delete_related(self):
        rel = Individual._meta.get_field('soulmate').remote_field
        widget = forms.Select()
        wrapper = widgets.RelatedFieldWidgetWrapper(
            widget, rel, widget_admin_site,
            can_add_related=True,
            can_change_related=True,
            can_delete_related=True,
        )
        self.assertTrue(wrapper.can_add_related)
        self.assertTrue(wrapper.can_change_related)
        self.assertFalse(wrapper.can_delete_related)

    def test_custom_widget_render(self):
        class CustomWidget(forms.Select):
            def render(self, *args, **kwargs):
                return 'custom render output'
        rel = Album._meta.get_field('band').remote_field
        widget = CustomWidget()
        wrapper = widgets.RelatedFieldWidgetWrapper(
            widget, rel, widget_admin_site,
            can_add_related=True,
            can_change_related=True,
            can_delete_related=True,
        )
        output = wrapper.render('name', 'value')
        self.assertIn('custom render output', output)

    def test_widget_delegates_value_omitted_from_data(self):
        class CustomWidget(forms.Select):
            def value_omitted_from_data(self, data, files, name):
                return False
        rel = Album._meta.get_field('band').remote_field
        widget = CustomWidget()
        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
        self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)

    def test_widget_is_hidden(self):
        rel = Album._meta.get_field('band').remote_field
        widget = forms.HiddenInput()
        widget.choices = ()
        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
        self.assertIs(wrapper.is_hidden, True)
        context = wrapper.get_context('band', None, {})
        self.assertIs(context['is_hidden'], True)
        output = wrapper.render('name', 'value')
        # Related item links are hidden.
        self.assertNotIn('<a ', output)

    def test_widget_is_not_hidden(self):
        rel = Album._meta.get_field('band').remote_field
        widget = forms.Select()
        wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
        self.assertIs(wrapper.is_hidden, False)
        context = wrapper.get_context('band', None, {})
        self.assertIs(context['is_hidden'], False)
        output = wrapper.render('name', 'value')
        # Related item links are present.
        self.assertIn('<a ', output)

File: tests/admin_widgets/tests.py
Line number range: 1 - 500
Content:
1. import gettext
2. import os
3. import re
4. from datetime import datetime, timedelta
5. from importlib import import_module
6. 
7. import pytz
8. 
9. from django import forms
10. from django.conf import settings
11. from django.contrib import admin
12. from django.contrib.admin import widgets
13. from django.contrib.admin.tests import AdminSeleniumTestCase
14. from django.contrib.auth.models import User
15. from django.core.files.storage import default_storage
16. from django.core.files.uploadedfile import SimpleUploadedFile
17. from django.db.models import CharField, DateField, DateTimeField, UUIDField
18. from django.test import SimpleTestCase, TestCase, override_settings
19. from django.urls import reverse
20. from django.utils import translation
21. 
22. from .models import (
23.     Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,
24.     Inventory, Member, MyFileField, Profile, School, Student,
25. )
26. from .widgetadmin import site as widget_admin_site
27. 
28. 
29. class TestDataMixin:
30. 
31.     @classmethod
32.     def setUpTestData(cls):
33.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email=None)
34.         cls.u2 = User.objects.create_user(username='testser', password='secret')
35.         Car.objects.create(owner=cls.superuser, make='Volkswagen', model='Passat')
36.         Car.objects.create(owner=cls.u2, make='BMW', model='M3')
37. 
38. 
39. class AdminFormfieldForDBFieldTests(SimpleTestCase):
40.     """
41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield
42.     """
43. 
44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):
45.         """
46.         Helper to call formfield_for_dbfield for a given model and field name
47.         and verify that the returned formfield is appropriate.
48.         """
49.         # Override any settings on the model admin
50.         class MyModelAdmin(admin.ModelAdmin):
51.             pass
52.         for k in admin_overrides:
53.             setattr(MyModelAdmin, k, admin_overrides[k])
54. 
55.         # Construct the admin, and ask it for a formfield
56.         ma = MyModelAdmin(model, admin.site)
57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)
58. 
59.         # "unwrap" the widget wrapper, if needed
60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):
61.             widget = ff.widget.widget
62.         else:
63.             widget = ff.widget
64. 
65.         self.assertIsInstance(widget, widgetclass)
66. 
67.         # Return the formfield so that other tests can continue
68.         return ff
69. 
70.     def test_DateField(self):
71.         self.assertFormfield(Event, 'start_date', widgets.AdminDateWidget)
72. 
73.     def test_DateTimeField(self):
74.         self.assertFormfield(Member, 'birthdate', widgets.AdminSplitDateTime)
75. 
76.     def test_TimeField(self):
77.         self.assertFormfield(Event, 'start_time', widgets.AdminTimeWidget)
78. 
79.     def test_TextField(self):
80.         self.assertFormfield(Event, 'description', widgets.AdminTextareaWidget)
81. 
82.     def test_URLField(self):
83.         self.assertFormfield(Event, 'link', widgets.AdminURLFieldWidget)
84. 
85.     def test_IntegerField(self):
86.         self.assertFormfield(Event, 'min_age', widgets.AdminIntegerFieldWidget)
87. 
88.     def test_CharField(self):
89.         self.assertFormfield(Member, 'name', widgets.AdminTextInputWidget)
90. 
91.     def test_EmailField(self):
92.         self.assertFormfield(Member, 'email', widgets.AdminEmailInputWidget)
93. 
94.     def test_FileField(self):
95.         self.assertFormfield(Album, 'cover_art', widgets.AdminFileWidget)
96. 
97.     def test_ForeignKey(self):
98.         self.assertFormfield(Event, 'main_band', forms.Select)
99. 
100.     def test_raw_id_ForeignKey(self):
101.         self.assertFormfield(Event, 'main_band', widgets.ForeignKeyRawIdWidget,
102.                              raw_id_fields=['main_band'])
103. 
104.     def test_radio_fields_ForeignKey(self):
105.         ff = self.assertFormfield(Event, 'main_band', widgets.AdminRadioSelect,
106.                                   radio_fields={'main_band': admin.VERTICAL})
107.         self.assertIsNone(ff.empty_label)
108. 
109.     def test_many_to_many(self):
110.         self.assertFormfield(Band, 'members', forms.SelectMultiple)
111. 
112.     def test_raw_id_many_to_many(self):
113.         self.assertFormfield(Band, 'members', widgets.ManyToManyRawIdWidget,
114.                              raw_id_fields=['members'])
115. 
116.     def test_filtered_many_to_many(self):
117.         self.assertFormfield(Band, 'members', widgets.FilteredSelectMultiple,
118.                              filter_vertical=['members'])
119. 
120.     def test_formfield_overrides(self):
121.         self.assertFormfield(Event, 'start_date', forms.TextInput,
122.                              formfield_overrides={DateField: {'widget': forms.TextInput}})
123. 
124.     def test_formfield_overrides_widget_instances(self):
125.         """
126.         Widget instances in formfield_overrides are not shared between
127.         different fields. (#19423)
128.         """
129.         class BandAdmin(admin.ModelAdmin):
130.             formfield_overrides = {
131.                 CharField: {'widget': forms.TextInput(attrs={'size': '10'})}
132.             }
133.         ma = BandAdmin(Band, admin.site)
134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field('name'), request=None)
135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field('style'), request=None)
136.         self.assertNotEqual(f1.widget, f2.widget)
137.         self.assertEqual(f1.widget.attrs['maxlength'], '100')
138.         self.assertEqual(f2.widget.attrs['maxlength'], '20')
139.         self.assertEqual(f2.widget.attrs['size'], '10')
140. 
141.     def test_formfield_overrides_for_datetime_field(self):
142.         """
143.         Overriding the widget for DateTimeField doesn't overrides the default
144.         form_class for that field (#26449).
145.         """
146.         class MemberAdmin(admin.ModelAdmin):
147.             formfield_overrides = {DateTimeField: {'widget': widgets.AdminSplitDateTime}}
148.         ma = MemberAdmin(Member, admin.site)
149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field('birthdate'), request=None)
150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)
151.         self.assertIsInstance(f1, forms.SplitDateTimeField)
152. 
153.     def test_formfield_overrides_for_custom_field(self):
154.         """
155.         formfield_overrides works for a custom field class.
156.         """
157.         class AlbumAdmin(admin.ModelAdmin):
158.             formfield_overrides = {MyFileField: {'widget': forms.TextInput()}}
159.         ma = AlbumAdmin(Member, admin.site)
160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field('backside_art'), request=None)
161.         self.assertIsInstance(f1.widget, forms.TextInput)
162. 
163.     def test_field_with_choices(self):
164.         self.assertFormfield(Member, 'gender', forms.Select)
165. 
166.     def test_choices_with_radio_fields(self):
167.         self.assertFormfield(Member, 'gender', widgets.AdminRadioSelect,
168.                              radio_fields={'gender': admin.VERTICAL})
169. 
170.     def test_inheritance(self):
171.         self.assertFormfield(Album, 'backside_art', widgets.AdminFileWidget)
172. 
173.     def test_m2m_widgets(self):
174.         """m2m fields help text as it applies to admin app (#9321)."""
175.         class AdvisorAdmin(admin.ModelAdmin):
176.             filter_vertical = ['companies']
177. 
178.         self.assertFormfield(Advisor, 'companies', widgets.FilteredSelectMultiple,
179.                              filter_vertical=['companies'])
180.         ma = AdvisorAdmin(Advisor, admin.site)
181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field('companies'), request=None)
182.         self.assertEqual(
183.             f.help_text,
184.             'Hold down “Control”, or “Command” on a Mac, to select more than one.'
185.         )
186. 
187. 
188. @override_settings(ROOT_URLCONF='admin_widgets.urls')
189. class AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):
190. 
191.     def test_filter_choices_by_request_user(self):
192.         """
193.         Ensure the user can only see their own cars in the foreign key dropdown.
194.         """
195.         self.client.force_login(self.superuser)
196.         response = self.client.get(reverse('admin:admin_widgets_cartire_add'))
197.         self.assertNotContains(response, "BMW M3")
198.         self.assertContains(response, "Volkswagen Passat")
199. 
200. 
201. @override_settings(ROOT_URLCONF='admin_widgets.urls')
202. class AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):
203. 
204.     def setUp(self):
205.         self.client.force_login(self.superuser)
206. 
207.     def test_changelist_ForeignKey(self):
208.         response = self.client.get(reverse('admin:admin_widgets_car_changelist'))
209.         self.assertContains(response, '/auth/user/add/')
210. 
211. 
212. @override_settings(ROOT_URLCONF='admin_widgets.urls')
213. class AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):
214. 
215.     def setUp(self):
216.         self.client.force_login(self.superuser)
217. 
218.     def test_nonexistent_target_id(self):
219.         band = Band.objects.create(name='Bogey Blues')
220.         pk = band.pk
221.         band.delete()
222.         post_data = {
223.             "main_band": '%s' % pk,
224.         }
225.         # Try posting with a nonexistent pk in a raw id field: this
226.         # should result in an error message, not a server exception.
227.         response = self.client.post(reverse('admin:admin_widgets_event_add'), post_data)
228.         self.assertContains(response, 'Select a valid choice. That choice is not one of the available choices.')
229. 
230.     def test_invalid_target_id(self):
231. 
232.         for test_str in ('Iñtërnâtiônàlizætiøn', "1234'", -1234):
233.             # This should result in an error message, not a server exception.
234.             response = self.client.post(reverse('admin:admin_widgets_event_add'), {"main_band": test_str})
235. 
236.             self.assertContains(response, 'Select a valid choice. That choice is not one of the available choices.')
237. 
238.     def test_url_params_from_lookup_dict_any_iterable(self):
239.         lookup1 = widgets.url_params_from_lookup_dict({'color__in': ('red', 'blue')})
240.         lookup2 = widgets.url_params_from_lookup_dict({'color__in': ['red', 'blue']})
241.         self.assertEqual(lookup1, {'color__in': 'red,blue'})
242.         self.assertEqual(lookup1, lookup2)
243. 
244.     def test_url_params_from_lookup_dict_callable(self):
245.         def my_callable():
246.             return 'works'
247.         lookup1 = widgets.url_params_from_lookup_dict({'myfield': my_callable})
248.         lookup2 = widgets.url_params_from_lookup_dict({'myfield': my_callable()})
249.         self.assertEqual(lookup1, lookup2)
250. 
251.     def test_label_and_url_for_value_invalid_uuid(self):
252.         field = Bee._meta.get_field('honeycomb')
253.         self.assertIsInstance(field.target_field, UUIDField)
254.         widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)
255.         self.assertEqual(widget.label_and_url_for_value('invalid-uuid'), ('', ''))
256. 
257. 
258. class FilteredSelectMultipleWidgetTest(SimpleTestCase):
259.     def test_render(self):
260.         # Backslash in verbose_name to ensure it is JavaScript escaped.
261.         w = widgets.FilteredSelectMultiple('test\\', False)
262.         self.assertHTMLEqual(
263.             w.render('test', 'test'),
264.             '<select multiple name="test" class="selectfilter" '
265.             'data-field-name="test\\" data-is-stacked="0">\n</select>'
266.         )
267. 
268.     def test_stacked_render(self):
269.         # Backslash in verbose_name to ensure it is JavaScript escaped.
270.         w = widgets.FilteredSelectMultiple('test\\', True)
271.         self.assertHTMLEqual(
272.             w.render('test', 'test'),
273.             '<select multiple name="test" class="selectfilterstacked" '
274.             'data-field-name="test\\" data-is-stacked="1">\n</select>'
275.         )
276. 
277. 
278. class AdminDateWidgetTest(SimpleTestCase):
279.     def test_attrs(self):
280.         w = widgets.AdminDateWidget()
281.         self.assertHTMLEqual(
282.             w.render('test', datetime(2007, 12, 1, 9, 30)),
283.             '<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">',
284.         )
285.         # pass attrs to widget
286.         w = widgets.AdminDateWidget(attrs={'size': 20, 'class': 'myDateField'})
287.         self.assertHTMLEqual(
288.             w.render('test', datetime(2007, 12, 1, 9, 30)),
289.             '<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">',
290.         )
291. 
292. 
293. class AdminTimeWidgetTest(SimpleTestCase):
294.     def test_attrs(self):
295.         w = widgets.AdminTimeWidget()
296.         self.assertHTMLEqual(
297.             w.render('test', datetime(2007, 12, 1, 9, 30)),
298.             '<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">',
299.         )
300.         # pass attrs to widget
301.         w = widgets.AdminTimeWidget(attrs={'size': 20, 'class': 'myTimeField'})
302.         self.assertHTMLEqual(
303.             w.render('test', datetime(2007, 12, 1, 9, 30)),
304.             '<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">',
305.         )
306. 
307. 
308. class AdminSplitDateTimeWidgetTest(SimpleTestCase):
309.     def test_render(self):
310.         w = widgets.AdminSplitDateTime()
311.         self.assertHTMLEqual(
312.             w.render('test', datetime(2007, 12, 1, 9, 30)),
313.             '<p class="datetime">'
314.             'Date: <input value="2007-12-01" type="text" class="vDateField" '
315.             'name="test_0" size="10"><br>'
316.             'Time: <input value="09:30:00" type="text" class="vTimeField" '
317.             'name="test_1" size="8"></p>'
318.         )
319. 
320.     def test_localization(self):
321.         w = widgets.AdminSplitDateTime()
322. 
323.         with self.settings(USE_L10N=True), translation.override('de-at'):
324.             w.is_localized = True
325.             self.assertHTMLEqual(
326.                 w.render('test', datetime(2007, 12, 1, 9, 30)),
327.                 '<p class="datetime">'
328.                 'Datum: <input value="01.12.2007" type="text" '
329.                 'class="vDateField" name="test_0"size="10"><br>'
330.                 'Zeit: <input value="09:30:00" type="text" class="vTimeField" '
331.                 'name="test_1" size="8"></p>'
332.             )
333. 
334. 
335. class AdminURLWidgetTest(SimpleTestCase):
336.     def test_get_context_validates_url(self):
337.         w = widgets.AdminURLFieldWidget()
338.         for invalid in ['', '/not/a/full/url/', 'javascript:alert("Danger XSS!")']:
339.             with self.subTest(url=invalid):
340.                 self.assertFalse(w.get_context('name', invalid, {})['url_valid'])
341.         self.assertTrue(w.get_context('name', 'http://example.com', {})['url_valid'])
342. 
343.     def test_render(self):
344.         w = widgets.AdminURLFieldWidget()
345.         self.assertHTMLEqual(
346.             w.render('test', ''),
347.             '<input class="vURLField" name="test" type="url">'
348.         )
349.         self.assertHTMLEqual(
350.             w.render('test', 'http://example.com'),
351.             '<p class="url">Currently:<a href="http://example.com">'
352.             'http://example.com</a><br>'
353.             'Change:<input class="vURLField" name="test" type="url" '
354.             'value="http://example.com"></p>'
355.         )
356. 
357.     def test_render_idn(self):
358.         w = widgets.AdminURLFieldWidget()
359.         self.assertHTMLEqual(
360.             w.render('test', 'http://example-äüö.com'),
361.             '<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">'
362.             'http://example-äüö.com</a><br>'
363.             'Change:<input class="vURLField" name="test" type="url" '
364.             'value="http://example-äüö.com"></p>'
365.         )
366. 
367.     def test_render_quoting(self):
368.         """
369.         WARNING: This test doesn't use assertHTMLEqual since it will get rid
370.         of some escapes which are tested here!
371.         """
372.         HREF_RE = re.compile('href="([^"]+)"')
373.         VALUE_RE = re.compile('value="([^"]+)"')
374.         TEXT_RE = re.compile('<a[^>]+>([^>]+)</a>')
375.         w = widgets.AdminURLFieldWidget()
376.         output = w.render('test', 'http://example.com/<sometag>some-text</sometag>')
377.         self.assertEqual(
378.             HREF_RE.search(output).groups()[0],
379.             'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E',
380.         )
381.         self.assertEqual(
382.             TEXT_RE.search(output).groups()[0],
383.             'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
384.         )
385.         self.assertEqual(
386.             VALUE_RE.search(output).groups()[0],
387.             'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
388.         )
389.         output = w.render('test', 'http://example-äüö.com/<sometag>some-text</sometag>')
390.         self.assertEqual(
391.             HREF_RE.search(output).groups()[0],
392.             'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E',
393.         )
394.         self.assertEqual(
395.             TEXT_RE.search(output).groups()[0],
396.             'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
397.         )
398.         self.assertEqual(
399.             VALUE_RE.search(output).groups()[0],
400.             'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
401.         )
402.         output = w.render('test', 'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"')
403.         self.assertEqual(
404.             HREF_RE.search(output).groups()[0],
405.             'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22',
406.         )
407.         self.assertEqual(
408.             TEXT_RE.search(output).groups()[0],
409.             'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;'
410.             'alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;'
411.         )
412.         self.assertEqual(
413.             VALUE_RE.search(output).groups()[0],
414.             'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;',
415.         )
416. 
417. 
418. class AdminUUIDWidgetTests(SimpleTestCase):
419.     def test_attrs(self):
420.         w = widgets.AdminUUIDInputWidget()
421.         self.assertHTMLEqual(
422.             w.render('test', '550e8400-e29b-41d4-a716-446655440000'),
423.             '<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">',
424.         )
425.         w = widgets.AdminUUIDInputWidget(attrs={'class': 'myUUIDInput'})
426.         self.assertHTMLEqual(
427.             w.render('test', '550e8400-e29b-41d4-a716-446655440000'),
428.             '<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">',
429.         )
430. 
431. 
432. @override_settings(ROOT_URLCONF='admin_widgets.urls')
433. class AdminFileWidgetTests(TestDataMixin, TestCase):
434. 
435.     @classmethod
436.     def setUpTestData(cls):
437.         super().setUpTestData()
438.         band = Band.objects.create(name='Linkin Park')
439.         cls.album = band.album_set.create(
440.             name='Hybrid Theory', cover_art=r'albums\hybrid_theory.jpg'
441.         )
442. 
443.     def test_render(self):
444.         w = widgets.AdminFileWidget()
445.         self.assertHTMLEqual(
446.             w.render('test', self.album.cover_art),
447.             '<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/'
448.             r'hybrid_theory.jpg">albums\hybrid_theory.jpg</a> '
449.             '<span class="clearable-file-input">'
450.             '<input type="checkbox" name="test-clear" id="test-clear_id"> '
451.             '<label for="test-clear_id">Clear</label></span><br>'
452.             'Change: <input type="file" name="test"></p>' % {
453.                 'STORAGE_URL': default_storage.url(''),
454.             },
455.         )
456.         self.assertHTMLEqual(
457.             w.render('test', SimpleUploadedFile('test', b'content')),
458.             '<input type="file" name="test">',
459.         )
460. 
461.     def test_render_required(self):
462.         widget = widgets.AdminFileWidget()
463.         widget.is_required = True
464.         self.assertHTMLEqual(
465.             widget.render('test', self.album.cover_art),
466.             '<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/'
467.             r'hybrid_theory.jpg">albums\hybrid_theory.jpg</a><br>'
468.             'Change: <input type="file" name="test"></p>' % {
469.                 'STORAGE_URL': default_storage.url(''),
470.             },
471.         )
472. 
473.     def test_readonly_fields(self):
474.         """
475.         File widgets should render as a link when they're marked "read only."
476.         """
477.         self.client.force_login(self.superuser)
478.         response = self.client.get(reverse('admin:admin_widgets_album_change', args=(self.album.id,)))
479.         self.assertContains(
480.             response,
481.             '<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">'
482.             r'albums\hybrid_theory.jpg</a></div>' % {'STORAGE_URL': default_storage.url('')},
483.             html=True,
484.         )
485.         self.assertNotContains(
486.             response,
487.             '<input type="file" name="cover_art" id="id_cover_art">',
488.             html=True,
489.         )
490.         response = self.client.get(reverse('admin:admin_widgets_album_add'))
491.         self.assertContains(
492.             response,
493.             '<div class="readonly"></div>',
494.             html=True,
495.         )
496. 
497. 
498. @override_settings(ROOT_URLCONF='admin_widgets.urls')
499. class ForeignKeyRawIdWidgetTest(TestCase):
500.

File: django/contrib/auth/admin.py
Line number range: 25 - 37
Content:
@admin.register(Group)
class GroupAdmin(admin.ModelAdmin):
    search_fields = ('name',)
    ordering = ('name',)
    filter_horizontal = ('permissions',)

    def formfield_for_manytomany(self, db_field, request=None, **kwargs):
        if db_field.name == 'permissions':
            qs = kwargs.get('queryset', db_field.remote_field.model.objects)
            # Avoid a major performance hit resolving permission names which
            # triggers a content_type load:
            kwargs['queryset'] = qs.select_related('content_type')
        return super().formfield_for_manytomany(db_field, request=request, **kwargs)

File: tests/admin_views/tests.py
Line number range: 5262 - 5293
Content:
@override_settings(ROOT_URLCONF='admin_views.urls')
class GroupAdminTest(TestCase):
    """
    Tests group CRUD functionality.
    """

    @classmethod
    def setUpTestData(cls):
        cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')

    def setUp(self):
        self.client.force_login(self.superuser)

    def test_save_button(self):
        group_count = Group.objects.count()
        response = self.client.post(reverse('admin:auth_group_add'), {
            'name': 'newgroup',
        })

        Group.objects.order_by('-id')[0]
        self.assertRedirects(response, reverse('admin:auth_group_changelist'))
        self.assertEqual(Group.objects.count(), group_count + 1)

    def test_group_permission_performance(self):
        g = Group.objects.create(name="test_group")

        # Ensure no queries are skipped due to cached content type for Group.
        ContentType.objects.clear_cache()

        with self.assertNumQueries(8):
            response = self.client.get(reverse('admin:auth_group_change', args=(g.pk,)))
            self.assertEqual(response.status_code, 200)


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and return it in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 03:40:50,030 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to override a widget in `formfield_for_manytomany`.\n   - This test class, particularly the `test_custom_queryset_still_wins` method, directly demonstrates how to subclass `ModelAdmin` and override `formfield_for_manytomany` and `formfield_for_foreignkey` to customize their behavior (in this case, the queryset).\n   - This pattern is exactly what the user needs to apply for customizing the widget.\n2. Extended relevance:\n   - The class provides a complete, self-contained test case including `setUp`, `tearDown`, and a helper method (`check_ordering_of_field_choices`) that shows how to correctly test form fields generated by the admin.\n   - This is crucial for the user to be able to test their own solution.', relative_path='tests/admin_ordering/tests.py', start_line=123, end_line=189), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's issue is with `formfield_for_manytomany`.\n   - This context provides a canonical, production-code example from Django's own auth application on how to override `formfield_for_manytomany` in a `ModelAdmin` subclass.\n2. Extended relevance:\n   - It demonstrates a practical use case (performance optimization) for overriding this method.\n   - This serves as a perfect template for the user to follow to implement their own override for widget customization.", relative_path='django/contrib/auth/admin.py', start_line=25, end_line=37), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user needs to see how to test functionality related to `formfield_for_manytomany` overrides.\n   - This test class, specifically `test_group_permission_performance`, exercises the `GroupAdmin`'s change view, which in turn calls the custom `formfield_for_manytomany` method.\n2. Extended relevance:\n   - This provides a complete example of an integration test for a `ModelAdmin` customization.\n   - It shows the necessary setup (`setUpTestData`, `setUp`) and how to trigger the relevant code path using the test client.\n   - This complements the `GroupAdmin` code by showing how to verify its behavior.", relative_path='tests/admin_views/tests.py', start_line=5262, end_line=5293), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to customize a widget.\n   - This test class explores multiple ways to customize form fields and widgets in the admin.\n   - It includes tests for `formfield_overrides` (`test_formfield_overrides`), which is a direct way to change widgets, and for using `ModelAdmin` attributes like `filter_vertical` (`test_filtered_many_to_many`) to change the widget for a many-to-many field.\n2. Extended relevance:\n   - The class provides a comprehensive overview of widget customization techniques for various field types, including `ForeignKey` and `ManyToManyField`.\n   - The helper method `assertFormfield` is a great pattern for unit testing form fields.\n   - This context offers the user alternative and potentially simpler solutions to their problem.', relative_path='tests/admin_widgets/tests.py', start_line=39, end_line=187), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's problem is about overriding a widget for a many-to-many field, which gets wrapped by `RelatedFieldWidgetWrapper`.\n   - This test class explores the behavior of this wrapper.\n   - The `test_custom_widget_render` test is particularly relevant as it shows that a custom widget's `render` method is correctly called, and `test_select_multiple_widget_cant_change_delete_related` shows how the wrapper behaves with a `SelectMultiple` widget, which is the default for M2M fields.\n2. Extended relevance:\n   - This class helps understand the interaction between a custom widget and the `RelatedFieldWidgetWrapper` that adds the green '+' sign and other related-object functionality.\n   - This is essential for debugging issues where a custom widget might not behave as expected within the admin.", relative_path='tests/admin_widgets/tests.py', start_line=638, end_line=718)]
2025-10-06 03:40:50,031 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='tests/admin_ordering/tests.py', content='123. class TestRelatedFieldsAdminOrdering(TestCase):\n124.     @classmethod\n125.     def setUpTestData(cls):\n126.         cls.b1 = Band.objects.create(name=\'Pink Floyd\', bio=\'\', rank=1)\n127.         cls.b2 = Band.objects.create(name=\'Foo Fighters\', bio=\'\', rank=5)\n128. \n129.     def setUp(self):\n130.         # we need to register a custom ModelAdmin (instead of just using\n131.         # ModelAdmin) because the field creator tries to find the ModelAdmin\n132.         # for the related model\n133.         class SongAdmin(admin.ModelAdmin):\n134.             pass\n135.         site.register(Song, SongAdmin)\n136. \n137.     def tearDown(self):\n138.         site.unregister(Song)\n139.         if Band in site._registry:\n140.             site.unregister(Band)\n141. \n142.     def check_ordering_of_field_choices(self, correct_ordering):\n143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)\n144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)\n145.         self.assertEqual(list(fk_field.queryset), correct_ordering)\n146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)\n147. \n148.     def test_no_admin_fallback_to_model_ordering(self):\n149.         # should be ordered by name (as defined by the model)\n150.         self.check_ordering_of_field_choices([self.b2, self.b1])\n151. \n152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):\n153.         class NoOrderingBandAdmin(admin.ModelAdmin):\n154.             pass\n155.         site.register(Band, NoOrderingBandAdmin)\n156. \n157.         # should be ordered by name (as defined by the model)\n158.         self.check_ordering_of_field_choices([self.b2, self.b1])\n159. \n160.     def test_admin_ordering_beats_model_ordering(self):\n161.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n162.             ordering = (\'rank\',)\n163.         site.register(Band, StaticOrderingBandAdmin)\n164. \n165.         # should be ordered by rank (defined by the ModelAdmin)\n166.         self.check_ordering_of_field_choices([self.b1, self.b2])\n167. \n168.     def test_custom_queryset_still_wins(self):\n169.         """Custom queryset has still precedence (#21405)"""\n170.         class SongAdmin(admin.ModelAdmin):\n171.             # Exclude one of the two Bands from the querysets\n172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):\n173.                 if db_field.name == \'band\':\n174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n176. \n177.             def formfield_for_manytomany(self, db_field, request, **kwargs):\n178.                 if db_field.name == \'other_interpreters\':\n179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n181. \n182.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n183.             ordering = (\'rank\',)\n184. \n185.         site.unregister(Song)\n186.         site.register(Song, SongAdmin)\n187.         site.register(Band, StaticOrderingBandAdmin)\n188. \n189.         self.check_ordering_of_field_choices([self.b2])', start_line_number=123, end_line_number=189), Context(relative_path='django/contrib/auth/admin.py', content="25. @admin.register(Group)\n26. class GroupAdmin(admin.ModelAdmin):\n27.     search_fields = ('name',)\n28.     ordering = ('name',)\n29.     filter_horizontal = ('permissions',)\n30. \n31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):\n32.         if db_field.name == 'permissions':\n33.             qs = kwargs.get('queryset', db_field.remote_field.model.objects)\n34.             # Avoid a major performance hit resolving permission names which\n35.             # triggers a content_type load:\n36.             kwargs['queryset'] = qs.select_related('content_type')\n37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)", start_line_number=25, end_line_number=37), Context(relative_path='tests/admin_views/tests.py', content='5262. @override_settings(ROOT_URLCONF=\'admin_views.urls\')\n5263. class GroupAdminTest(TestCase):\n5264.     """\n5265.     Tests group CRUD functionality.\n5266.     """\n5267. \n5268.     @classmethod\n5269.     def setUpTestData(cls):\n5270.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n5271. \n5272.     def setUp(self):\n5273.         self.client.force_login(self.superuser)\n5274. \n5275.     def test_save_button(self):\n5276.         group_count = Group.objects.count()\n5277.         response = self.client.post(reverse(\'admin:auth_group_add\'), {\n5278.             \'name\': \'newgroup\',\n5279.         })\n5280. \n5281.         Group.objects.order_by(\'-id\')[0]\n5282.         self.assertRedirects(response, reverse(\'admin:auth_group_changelist\'))\n5283.         self.assertEqual(Group.objects.count(), group_count + 1)\n5284. \n5285.     def test_group_permission_performance(self):\n5286.         g = Group.objects.create(name="test_group")\n5287. \n5288.         # Ensure no queries are skipped due to cached content type for Group.\n5289.         ContentType.objects.clear_cache()\n5290. \n5291.         with self.assertNumQueries(8):\n5292.             response = self.client.get(reverse(\'admin:auth_group_change\', args=(g.pk,)))\n5293.             self.assertEqual(response.status_code, 200)', start_line_number=5262, end_line_number=5293), Context(relative_path='tests/admin_widgets/tests.py', content='39. class AdminFormfieldForDBFieldTests(SimpleTestCase):\n40.     """\n41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n42.     """\n43. \n44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n45.         """\n46.         Helper to call formfield_for_dbfield for a given model and field name\n47.         and verify that the returned formfield is appropriate.\n48.         """\n49.         # Override any settings on the model admin\n50.         class MyModelAdmin(admin.ModelAdmin):\n51.             pass\n52.         for k in admin_overrides:\n53.             setattr(MyModelAdmin, k, admin_overrides[k])\n54. \n55.         # Construct the admin, and ask it for a formfield\n56.         ma = MyModelAdmin(model, admin.site)\n57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n58. \n59.         # "unwrap" the widget wrapper, if needed\n60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n61.             widget = ff.widget.widget\n62.         else:\n63.             widget = ff.widget\n64. \n65.         self.assertIsInstance(widget, widgetclass)\n66. \n67.         # Return the formfield so that other tests can continue\n68.         return ff\n69. \n70.     def test_DateField(self):\n71.         self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n72. \n73.     def test_DateTimeField(self):\n74.         self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n75. \n76.     def test_TimeField(self):\n77.         self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n78. \n79.     def test_TextField(self):\n80.         self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n81. \n82.     def test_URLField(self):\n83.         self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n84. \n85.     def test_IntegerField(self):\n86.         self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n87. \n88.     def test_CharField(self):\n89.         self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n90. \n91.     def test_EmailField(self):\n92.         self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n93. \n94.     def test_FileField(self):\n95.         self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n96. \n97.     def test_ForeignKey(self):\n98.         self.assertFormfield(Event, \'main_band\', forms.Select)\n99. \n100.     def test_raw_id_ForeignKey(self):\n101.         self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n102.                              raw_id_fields=[\'main_band\'])\n103. \n104.     def test_radio_fields_ForeignKey(self):\n105.         ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n106.                                   radio_fields={\'main_band\': admin.VERTICAL})\n107.         self.assertIsNone(ff.empty_label)\n108. \n109.     def test_many_to_many(self):\n110.         self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n111. \n112.     def test_raw_id_many_to_many(self):\n113.         self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n114.                              raw_id_fields=[\'members\'])\n115. \n116.     def test_filtered_many_to_many(self):\n117.         self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n118.                              filter_vertical=[\'members\'])\n119. \n120.     def test_formfield_overrides(self):\n121.         self.assertFormfield(Event, \'start_date\', forms.TextInput,\n122.                              formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n123. \n124.     def test_formfield_overrides_widget_instances(self):\n125.         """\n126.         Widget instances in formfield_overrides are not shared between\n127.         different fields. (#19423)\n128.         """\n129.         class BandAdmin(admin.ModelAdmin):\n130.             formfield_overrides = {\n131.                 CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n132.             }\n133.         ma = BandAdmin(Band, admin.site)\n134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n136.         self.assertNotEqual(f1.widget, f2.widget)\n137.         self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n138.         self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n139.         self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n140. \n141.     def test_formfield_overrides_for_datetime_field(self):\n142.         """\n143.         Overriding the widget for DateTimeField doesn\'t overrides the default\n144.         form_class for that field (#26449).\n145.         """\n146.         class MemberAdmin(admin.ModelAdmin):\n147.             formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n148.         ma = MemberAdmin(Member, admin.site)\n149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n151.         self.assertIsInstance(f1, forms.SplitDateTimeField)\n152. \n153.     def test_formfield_overrides_for_custom_field(self):\n154.         """\n155.         formfield_overrides works for a custom field class.\n156.         """\n157.         class AlbumAdmin(admin.ModelAdmin):\n158.             formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n159.         ma = AlbumAdmin(Member, admin.site)\n160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n161.         self.assertIsInstance(f1.widget, forms.TextInput)\n162. \n163.     def test_field_with_choices(self):\n164.         self.assertFormfield(Member, \'gender\', forms.Select)\n165. \n166.     def test_choices_with_radio_fields(self):\n167.         self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n168.                              radio_fields={\'gender\': admin.VERTICAL})\n169. \n170.     def test_inheritance(self):\n171.         self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n172. \n173.     def test_m2m_widgets(self):\n174.         """m2m fields help text as it applies to admin app (#9321)."""\n175.         class AdvisorAdmin(admin.ModelAdmin):\n176.             filter_vertical = [\'companies\']\n177. \n178.         self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n179.                              filter_vertical=[\'companies\'])\n180.         ma = AdvisorAdmin(Advisor, admin.site)\n181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n182.         self.assertEqual(\n183.             f.help_text,\n184.             \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n185.         )\n186. \n187. ', start_line_number=39, end_line_number=187), Context(relative_path='tests/admin_widgets/tests.py', content="638. @override_settings(ROOT_URLCONF='admin_widgets.urls')\n639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):\n640.     def test_no_can_add_related(self):\n641.         rel = Individual._meta.get_field('parent').remote_field\n642.         w = widgets.AdminRadioSelect()\n643.         # Used to fail with a name error.\n644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n645.         self.assertFalse(w.can_add_related)\n646. \n647.     def test_select_multiple_widget_cant_change_delete_related(self):\n648.         rel = Individual._meta.get_field('parent').remote_field\n649.         widget = forms.SelectMultiple()\n650.         wrapper = widgets.RelatedFieldWidgetWrapper(\n651.             widget, rel, widget_admin_site,\n652.             can_add_related=True,\n653.             can_change_related=True,\n654.             can_delete_related=True,\n655.         )\n656.         self.assertTrue(wrapper.can_add_related)\n657.         self.assertFalse(wrapper.can_change_related)\n658.         self.assertFalse(wrapper.can_delete_related)\n659. \n660.     def test_on_delete_cascade_rel_cant_delete_related(self):\n661.         rel = Individual._meta.get_field('soulmate').remote_field\n662.         widget = forms.Select()\n663.         wrapper = widgets.RelatedFieldWidgetWrapper(\n664.             widget, rel, widget_admin_site,\n665.             can_add_related=True,\n666.             can_change_related=True,\n667.             can_delete_related=True,\n668.         )\n669.         self.assertTrue(wrapper.can_add_related)\n670.         self.assertTrue(wrapper.can_change_related)\n671.         self.assertFalse(wrapper.can_delete_related)\n672. \n673.     def test_custom_widget_render(self):\n674.         class CustomWidget(forms.Select):\n675.             def render(self, *args, **kwargs):\n676.                 return 'custom render output'\n677.         rel = Album._meta.get_field('band').remote_field\n678.         widget = CustomWidget()\n679.         wrapper = widgets.RelatedFieldWidgetWrapper(\n680.             widget, rel, widget_admin_site,\n681.             can_add_related=True,\n682.             can_change_related=True,\n683.             can_delete_related=True,\n684.         )\n685.         output = wrapper.render('name', 'value')\n686.         self.assertIn('custom render output', output)\n687. \n688.     def test_widget_delegates_value_omitted_from_data(self):\n689.         class CustomWidget(forms.Select):\n690.             def value_omitted_from_data(self, data, files, name):\n691.                 return False\n692.         rel = Album._meta.get_field('band').remote_field\n693.         widget = CustomWidget()\n694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)\n696. \n697.     def test_widget_is_hidden(self):\n698.         rel = Album._meta.get_field('band').remote_field\n699.         widget = forms.HiddenInput()\n700.         widget.choices = ()\n701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n702.         self.assertIs(wrapper.is_hidden, True)\n703.         context = wrapper.get_context('band', None, {})\n704.         self.assertIs(context['is_hidden'], True)\n705.         output = wrapper.render('name', 'value')\n706.         # Related item links are hidden.\n707.         self.assertNotIn('<a ', output)\n708. \n709.     def test_widget_is_not_hidden(self):\n710.         rel = Album._meta.get_field('band').remote_field\n711.         widget = forms.Select()\n712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n713.         self.assertIs(wrapper.is_hidden, False)\n714.         context = wrapper.get_context('band', None, {})\n715.         self.assertIs(context['is_hidden'], False)\n716.         output = wrapper.render('name', 'value')\n717.         # Related item links are present.\n718.         self.assertIn('<a ', output)", start_line_number=638, end_line_number=718)]
2025-10-06 03:40:50,032 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 03:40:50,032 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   └── FUNDING.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   └── static
|   |   |       └── fontawesome
|   |   └── djangodocs-epub
|   |       └── static
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   └── gis
|       └── mapwidget.test.js
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   └── admin
    |   |       └── admin_views
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   └── registration
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   └── registration
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   └── robots.txt
    |   |   └── registration
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   └── javascript_ignored.js
    |   |   └── templates
    |   |       └── subdir
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   ├── templates
    |   |   └── shortcuts
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── cached
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   ├── loop
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   ├── jinja2
    |   |   └── template_backends
    |   ├── template_strings
    |   |   └── template_backends
    |   ├── templates
    |   |   └── template_backends
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   ├── templates
    |   |   └── template_loader
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   ├── other_templates
    |   |   └── priority
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   ├── fs2
    |   |   └── fs3
    |   ├── relative_templates
    |   |   └── dir1
    |   |       └── dir2
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── first
    |   |   ├── priority
    |   |   ├── second
    |   |   └── template_tests
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   └── views
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   └── debug
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Allow overridding widget in formfield_for_manytomany().

Issue description: 
Description
	 
		(last modified by Mariusz Felisiak)
	 
It does not work when I set widget param to function formfield_for_manytomany().
This is different from the formfield_for_foreignkey() function.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/admin_ordering/tests.py
Line number range: 123 - 189
Content:
123. class TestRelatedFieldsAdminOrdering(TestCase):
124.     @classmethod
125.     def setUpTestData(cls):
126.         cls.b1 = Band.objects.create(name='Pink Floyd', bio='', rank=1)
127.         cls.b2 = Band.objects.create(name='Foo Fighters', bio='', rank=5)
128. 
129.     def setUp(self):
130.         # we need to register a custom ModelAdmin (instead of just using
131.         # ModelAdmin) because the field creator tries to find the ModelAdmin
132.         # for the related model
133.         class SongAdmin(admin.ModelAdmin):
134.             pass
135.         site.register(Song, SongAdmin)
136. 
137.     def tearDown(self):
138.         site.unregister(Song)
139.         if Band in site._registry:
140.             site.unregister(Band)
141. 
142.     def check_ordering_of_field_choices(self, correct_ordering):
143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)
144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)
145.         self.assertEqual(list(fk_field.queryset), correct_ordering)
146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)
147. 
148.     def test_no_admin_fallback_to_model_ordering(self):
149.         # should be ordered by name (as defined by the model)
150.         self.check_ordering_of_field_choices([self.b2, self.b1])
151. 
152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):
153.         class NoOrderingBandAdmin(admin.ModelAdmin):
154.             pass
155.         site.register(Band, NoOrderingBandAdmin)
156. 
157.         # should be ordered by name (as defined by the model)
158.         self.check_ordering_of_field_choices([self.b2, self.b1])
159. 
160.     def test_admin_ordering_beats_model_ordering(self):
161.         class StaticOrderingBandAdmin(admin.ModelAdmin):
162.             ordering = ('rank',)
163.         site.register(Band, StaticOrderingBandAdmin)
164. 
165.         # should be ordered by rank (defined by the ModelAdmin)
166.         self.check_ordering_of_field_choices([self.b1, self.b2])
167. 
168.     def test_custom_queryset_still_wins(self):
169.         """Custom queryset has still precedence (#21405)"""
170.         class SongAdmin(admin.ModelAdmin):
171.             # Exclude one of the two Bands from the querysets
172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):
173.                 if db_field.name == 'band':
174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
176. 
177.             def formfield_for_manytomany(self, db_field, request, **kwargs):
178.                 if db_field.name == 'other_interpreters':
179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
181. 
182.         class StaticOrderingBandAdmin(admin.ModelAdmin):
183.             ordering = ('rank',)
184. 
185.         site.unregister(Song)
186.         site.register(Song, SongAdmin)
187.         site.register(Band, StaticOrderingBandAdmin)
188. 
189.         self.check_ordering_of_field_choices([self.b2])


File: django/contrib/auth/admin.py
Line number range: 25 - 37
Content:
25. @admin.register(Group)
26. class GroupAdmin(admin.ModelAdmin):
27.     search_fields = ('name',)
28.     ordering = ('name',)
29.     filter_horizontal = ('permissions',)
30. 
31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):
32.         if db_field.name == 'permissions':
33.             qs = kwargs.get('queryset', db_field.remote_field.model.objects)
34.             # Avoid a major performance hit resolving permission names which
35.             # triggers a content_type load:
36.             kwargs['queryset'] = qs.select_related('content_type')
37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)


File: tests/admin_views/tests.py
Line number range: 5262 - 5293
Content:
5262. @override_settings(ROOT_URLCONF='admin_views.urls')
5263. class GroupAdminTest(TestCase):
5264.     """
5265.     Tests group CRUD functionality.
5266.     """
5267. 
5268.     @classmethod
5269.     def setUpTestData(cls):
5270.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5271. 
5272.     def setUp(self):
5273.         self.client.force_login(self.superuser)
5274. 
5275.     def test_save_button(self):
5276.         group_count = Group.objects.count()
5277.         response = self.client.post(reverse('admin:auth_group_add'), {
5278.             'name': 'newgroup',
5279.         })
5280. 
5281.         Group.objects.order_by('-id')[0]
5282.         self.assertRedirects(response, reverse('admin:auth_group_changelist'))
5283.         self.assertEqual(Group.objects.count(), group_count + 1)
5284. 
5285.     def test_group_permission_performance(self):
5286.         g = Group.objects.create(name="test_group")
5287. 
5288.         # Ensure no queries are skipped due to cached content type for Group.
5289.         ContentType.objects.clear_cache()
5290. 
5291.         with self.assertNumQueries(8):
5292.             response = self.client.get(reverse('admin:auth_group_change', args=(g.pk,)))
5293.             self.assertEqual(response.status_code, 200)


File: tests/admin_widgets/tests.py
Line number range: 39 - 187
Content:
39. class AdminFormfieldForDBFieldTests(SimpleTestCase):
40.     """
41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield
42.     """
43. 
44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):
45.         """
46.         Helper to call formfield_for_dbfield for a given model and field name
47.         and verify that the returned formfield is appropriate.
48.         """
49.         # Override any settings on the model admin
50.         class MyModelAdmin(admin.ModelAdmin):
51.             pass
52.         for k in admin_overrides:
53.             setattr(MyModelAdmin, k, admin_overrides[k])
54. 
55.         # Construct the admin, and ask it for a formfield
56.         ma = MyModelAdmin(model, admin.site)
57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)
58. 
59.         # "unwrap" the widget wrapper, if needed
60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):
61.             widget = ff.widget.widget
62.         else:
63.             widget = ff.widget
64. 
65.         self.assertIsInstance(widget, widgetclass)
66. 
67.         # Return the formfield so that other tests can continue
68.         return ff
69. 
70.     def test_DateField(self):
71.         self.assertFormfield(Event, 'start_date', widgets.AdminDateWidget)
72. 
73.     def test_DateTimeField(self):
74.         self.assertFormfield(Member, 'birthdate', widgets.AdminSplitDateTime)
75. 
76.     def test_TimeField(self):
77.         self.assertFormfield(Event, 'start_time', widgets.AdminTimeWidget)
78. 
79.     def test_TextField(self):
80.         self.assertFormfield(Event, 'description', widgets.AdminTextareaWidget)
81. 
82.     def test_URLField(self):
83.         self.assertFormfield(Event, 'link', widgets.AdminURLFieldWidget)
84. 
85.     def test_IntegerField(self):
86.         self.assertFormfield(Event, 'min_age', widgets.AdminIntegerFieldWidget)
87. 
88.     def test_CharField(self):
89.         self.assertFormfield(Member, 'name', widgets.AdminTextInputWidget)
90. 
91.     def test_EmailField(self):
92.         self.assertFormfield(Member, 'email', widgets.AdminEmailInputWidget)
93. 
94.     def test_FileField(self):
95.         self.assertFormfield(Album, 'cover_art', widgets.AdminFileWidget)
96. 
97.     def test_ForeignKey(self):
98.         self.assertFormfield(Event, 'main_band', forms.Select)
99. 
100.     def test_raw_id_ForeignKey(self):
101.         self.assertFormfield(Event, 'main_band', widgets.ForeignKeyRawIdWidget,
102.                              raw_id_fields=['main_band'])
103. 
104.     def test_radio_fields_ForeignKey(self):
105.         ff = self.assertFormfield(Event, 'main_band', widgets.AdminRadioSelect,
106.                                   radio_fields={'main_band': admin.VERTICAL})
107.         self.assertIsNone(ff.empty_label)
108. 
109.     def test_many_to_many(self):
110.         self.assertFormfield(Band, 'members', forms.SelectMultiple)
111. 
112.     def test_raw_id_many_to_many(self):
113.         self.assertFormfield(Band, 'members', widgets.ManyToManyRawIdWidget,
114.                              raw_id_fields=['members'])
115. 
116.     def test_filtered_many_to_many(self):
117.         self.assertFormfield(Band, 'members', widgets.FilteredSelectMultiple,
118.                              filter_vertical=['members'])
119. 
120.     def test_formfield_overrides(self):
121.         self.assertFormfield(Event, 'start_date', forms.TextInput,
122.                              formfield_overrides={DateField: {'widget': forms.TextInput}})
123. 
124.     def test_formfield_overrides_widget_instances(self):
125.         """
126.         Widget instances in formfield_overrides are not shared between
127.         different fields. (#19423)
128.         """
129.         class BandAdmin(admin.ModelAdmin):
130.             formfield_overrides = {
131.                 CharField: {'widget': forms.TextInput(attrs={'size': '10'})}
132.             }
133.         ma = BandAdmin(Band, admin.site)
134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field('name'), request=None)
135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field('style'), request=None)
136.         self.assertNotEqual(f1.widget, f2.widget)
137.         self.assertEqual(f1.widget.attrs['maxlength'], '100')
138.         self.assertEqual(f2.widget.attrs['maxlength'], '20')
139.         self.assertEqual(f2.widget.attrs['size'], '10')
140. 
141.     def test_formfield_overrides_for_datetime_field(self):
142.         """
143.         Overriding the widget for DateTimeField doesn't overrides the default
144.         form_class for that field (#26449).
145.         """
146.         class MemberAdmin(admin.ModelAdmin):
147.             formfield_overrides = {DateTimeField: {'widget': widgets.AdminSplitDateTime}}
148.         ma = MemberAdmin(Member, admin.site)
149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field('birthdate'), request=None)
150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)
151.         self.assertIsInstance(f1, forms.SplitDateTimeField)
152. 
153.     def test_formfield_overrides_for_custom_field(self):
154.         """
155.         formfield_overrides works for a custom field class.
156.         """
157.         class AlbumAdmin(admin.ModelAdmin):
158.             formfield_overrides = {MyFileField: {'widget': forms.TextInput()}}
159.         ma = AlbumAdmin(Member, admin.site)
160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field('backside_art'), request=None)
161.         self.assertIsInstance(f1.widget, forms.TextInput)
162. 
163.     def test_field_with_choices(self):
164.         self.assertFormfield(Member, 'gender', forms.Select)
165. 
166.     def test_choices_with_radio_fields(self):
167.         self.assertFormfield(Member, 'gender', widgets.AdminRadioSelect,
168.                              radio_fields={'gender': admin.VERTICAL})
169. 
170.     def test_inheritance(self):
171.         self.assertFormfield(Album, 'backside_art', widgets.AdminFileWidget)
172. 
173.     def test_m2m_widgets(self):
174.         """m2m fields help text as it applies to admin app (#9321)."""
175.         class AdvisorAdmin(admin.ModelAdmin):
176.             filter_vertical = ['companies']
177. 
178.         self.assertFormfield(Advisor, 'companies', widgets.FilteredSelectMultiple,
179.                              filter_vertical=['companies'])
180.         ma = AdvisorAdmin(Advisor, admin.site)
181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field('companies'), request=None)
182.         self.assertEqual(
183.             f.help_text,
184.             'Hold down “Control”, or “Command” on a Mac, to select more than one.'
185.         )
186. 
187. 


File: tests/admin_widgets/tests.py
Line number range: 638 - 718
Content:
638. @override_settings(ROOT_URLCONF='admin_widgets.urls')
639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):
640.     def test_no_can_add_related(self):
641.         rel = Individual._meta.get_field('parent').remote_field
642.         w = widgets.AdminRadioSelect()
643.         # Used to fail with a name error.
644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)
645.         self.assertFalse(w.can_add_related)
646. 
647.     def test_select_multiple_widget_cant_change_delete_related(self):
648.         rel = Individual._meta.get_field('parent').remote_field
649.         widget = forms.SelectMultiple()
650.         wrapper = widgets.RelatedFieldWidgetWrapper(
651.             widget, rel, widget_admin_site,
652.             can_add_related=True,
653.             can_change_related=True,
654.             can_delete_related=True,
655.         )
656.         self.assertTrue(wrapper.can_add_related)
657.         self.assertFalse(wrapper.can_change_related)
658.         self.assertFalse(wrapper.can_delete_related)
659. 
660.     def test_on_delete_cascade_rel_cant_delete_related(self):
661.         rel = Individual._meta.get_field('soulmate').remote_field
662.         widget = forms.Select()
663.         wrapper = widgets.RelatedFieldWidgetWrapper(
664.             widget, rel, widget_admin_site,
665.             can_add_related=True,
666.             can_change_related=True,
667.             can_delete_related=True,
668.         )
669.         self.assertTrue(wrapper.can_add_related)
670.         self.assertTrue(wrapper.can_change_related)
671.         self.assertFalse(wrapper.can_delete_related)
672. 
673.     def test_custom_widget_render(self):
674.         class CustomWidget(forms.Select):
675.             def render(self, *args, **kwargs):
676.                 return 'custom render output'
677.         rel = Album._meta.get_field('band').remote_field
678.         widget = CustomWidget()
679.         wrapper = widgets.RelatedFieldWidgetWrapper(
680.             widget, rel, widget_admin_site,
681.             can_add_related=True,
682.             can_change_related=True,
683.             can_delete_related=True,
684.         )
685.         output = wrapper.render('name', 'value')
686.         self.assertIn('custom render output', output)
687. 
688.     def test_widget_delegates_value_omitted_from_data(self):
689.         class CustomWidget(forms.Select):
690.             def value_omitted_from_data(self, data, files, name):
691.                 return False
692.         rel = Album._meta.get_field('band').remote_field
693.         widget = CustomWidget()
694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)
696. 
697.     def test_widget_is_hidden(self):
698.         rel = Album._meta.get_field('band').remote_field
699.         widget = forms.HiddenInput()
700.         widget.choices = ()
701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
702.         self.assertIs(wrapper.is_hidden, True)
703.         context = wrapper.get_context('band', None, {})
704.         self.assertIs(context['is_hidden'], True)
705.         output = wrapper.render('name', 'value')
706.         # Related item links are hidden.
707.         self.assertNotIn('<a ', output)
708. 
709.     def test_widget_is_not_hidden(self):
710.         rel = Album._meta.get_field('band').remote_field
711.         widget = forms.Select()
712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
713.         self.assertIs(wrapper.is_hidden, False)
714.         context = wrapper.get_context('band', None, {})
715.         self.assertIs(context['is_hidden'], False)
716.         output = wrapper.render('name', 'value')
717.         # Related item links are present.
718.         self.assertIn('<a ', output)

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-06 03:41:32,270 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user's bug report contrasts the behavior of `formfield_for_manytomany` with `formfield_for_foreignkey`, stating that overriding the widget works for the latter.\n2. The current context provides examples of overriding `formfield_for_manytomany` to change the `queryset`, and other mechanisms for changing widgets, but it lacks a clear example of programmatically overriding the widget inside `formfield_for_foreignkey`.\n3. To provide the most relevant test cases, it would be beneficial to find a test that demonstrates the working scenario described by the user (overriding the widget in `formfield_for_foreignkey`). This would serve as a baseline to understand the expected behavior and to craft a potential fix or a new test for the reported bug in `formfield_for_manytomany`.\n4. Therefore, additional context is needed to find a test case that shows a widget being overridden within `formfield_for_foreignkey`." refined_query='Please provide test cases where `ModelAdmin.formfield_for_foreignkey` is overridden to specify a custom widget. This will serve as a positive example of the functionality the user is trying to achieve with `formfield_for_manytomany`.'
2025-10-06 03:41:37,176 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I will search for test cases where `ModelAdmin.formfield_for_foreignkey` is overridden. I'll start by looking for occurrences of `formfield_for_foreignkey` within the `tests` directory to locate relevant test files. Then, I will examine the search results to find specific examples of this method being used to specify a custom widget." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "formfield_for_foreignkey", "basename": "tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55044, 'candidates_token_count': 103, 'total_token_count': 55370, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55044}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 103}], 'thoughts_token_count': 223, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4105493489978383, 'model_name': 'gemini-2.5-pro'} id='run--c24ffabb-c61f-4828-a16d-20ad72bcc725-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'formfield_for_foreignkey', 'basename': 'tests.py'}, 'id': 'bd185b6c-27f8-4cc6-bbe2-678ab42c3403', 'type': 'tool_call'}] usage_metadata={'input_tokens': 55044, 'output_tokens': 103, 'total_tokens': 55370, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 223}}
2025-10-06 03:41:41,808 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have located a relevant test case in `tests/admin_ordering/tests.py` that demonstrates how to override `formfield_for_foreignkey` in a `ModelAdmin` to customize a form field. I will now examine this test case more closely to determine if it uses a custom widget, which will provide a good example for the user.' additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 165.0, "relative_path": "tests/admin_ordering/tests.py", "end_line": 172.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 56137, 'candidates_token_count': 101, 'total_token_count': 56445, 'cached_content_token_count': 54194, 'prompt_tokens_details': [{'modality': 1, 'token_count': 56137}], 'cache_tokens_details': [{'modality': 1, 'token_count': 54194}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 101}], 'thoughts_token_count': 207}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4217693593242381, 'model_name': 'gemini-2.5-pro'} id='run--416e26ed-f621-4f34-ad54-677c2c0fe725-0' tool_calls=[{'name': 'read_code_with_relative_path', 'args': {'start_line': 165.0, 'relative_path': 'tests/admin_ordering/tests.py', 'end_line': 172.0}, 'id': '5c88dc34-7843-4a82-86ed-3df13d43e800', 'type': 'tool_call'}] usage_metadata={'input_tokens': 56137, 'output_tokens': 101, 'total_tokens': 56445, 'input_token_details': {'cache_read': 54194}, 'output_token_details': {'reasoning': 207}}
2025-10-06 03:41:47,846 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have found a relevant test case in `tests/admin_ordering/tests.py` that overrides `formfield_for_foreignkey` to customize the queryset. While this is not an exact match for specifying a custom widget, it provides a valuable example of how to override the method. I will now broaden my search to find a test case that specifically demonstrates using a custom widget with `formfield_for_foreignkey`.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "formfield_for_foreignkey", "basename": "tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 56475, 'candidates_token_count': 118, 'total_token_count': 56913, 'cached_content_token_count': 54148, 'prompt_tokens_details': [{'modality': 1, 'token_count': 56475}], 'cache_tokens_details': [{'modality': 1, 'token_count': 54148}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 118}], 'thoughts_token_count': 320}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4793681451829813, 'model_name': 'gemini-2.5-pro'} id='run--139df0a1-b030-4a69-97a4-da68ba44d161-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'formfield_for_foreignkey', 'basename': 'tests.py'}, 'id': '713b540c-ba7d-4458-acde-f733fc64f2ff', 'type': 'tool_call'}] usage_metadata={'input_tokens': 56475, 'output_tokens': 118, 'total_tokens': 56913, 'input_token_details': {'cache_read': 54148}, 'output_token_details': {'reasoning': 320}}
2025-10-06 03:41:54,729 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have already examined the test case in `tests/admin_ordering/tests.py` and determined that it does not demonstrate the use of a custom widget. To find a more relevant example, I will now search for overrides of `formfield_for_foreignkey` in other test files that also include the term "widget" in the same file. This should help me narrow down the search to test cases that are more likely to contain the specific functionality the user is looking for.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "widget", "basename": "tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 57583, 'candidates_token_count': 122, 'total_token_count': 58021, 'cached_content_token_count': 56117, 'prompt_tokens_details': [{'modality': 1, 'token_count': 57583}], 'cache_tokens_details': [{'modality': 1, 'token_count': 56117}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 122}], 'thoughts_token_count': 316}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5328524229956455, 'model_name': 'gemini-2.5-pro'} id='run--a11523df-7006-4d20-b9ea-4987c70bdc7f-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'widget', 'basename': 'tests.py'}, 'id': 'a248d65f-1cdc-4013-979a-77d2655d2728', 'type': 'tool_call'}] usage_metadata={'input_tokens': 57583, 'output_tokens': 122, 'total_tokens': 58021, 'input_token_details': {'cache_read': 56117}, 'output_token_details': {'reasoning': 316}}
2025-10-06 03:41:58,212 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I have identified several test files that are likely to contain the functionality I'm looking for. I will start by examining `tests/modeladmin/tests.py` since it imports several custom widgets that could be used with a foreign key. My goal is to find an example where `formfield_for_foreignkey` is overridden to specify one of these custom widgets." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_foreignkey", "relative_path": "tests/modeladmin/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 58267, 'candidates_token_count': 116, 'total_token_count': 58475, 'cached_content_token_count': 56015, 'prompt_tokens_details': [{'modality': 1, 'token_count': 58267}], 'cache_tokens_details': [{'modality': 1, 'token_count': 56015}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 116}], 'thoughts_token_count': 92}, 'finish_reason': 'STOP', 'avg_logprobs': -0.18375921249389648, 'model_name': 'gemini-2.5-pro'} id='run--14229ea3-f1e4-4485-9c1b-14a068164334-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_foreignkey', 'relative_path': 'tests/modeladmin/tests.py'}, 'id': '352f454d-3286-4a81-8056-df8dbd594d4f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 58267, 'output_tokens': 116, 'total_tokens': 58475, 'input_token_details': {'cache_read': 56015}, 'output_token_details': {'reasoning': 92}}
2025-10-06 03:42:04,629 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I was unable to find any instances of `formfield_for_foreignkey` in `tests/modeladmin/tests.py`, so I will now shift my focus to another promising file, `tests/admin_widgets/tests.py`. Since this file also imports custom widgets, I will search for overrides of `formfield_for_foreignkey` to see if it contains an example of a custom widget being used with a foreign key.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_foreignkey", "relative_path": "tests/admin_widgets/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 58415, 'candidates_token_count': 132, 'total_token_count': 59037, 'cached_content_token_count': 57987, 'prompt_tokens_details': [{'modality': 1, 'token_count': 58415}], 'cache_tokens_details': [{'modality': 1, 'token_count': 57987}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 132}], 'thoughts_token_count': 490}, 'finish_reason': 'STOP', 'avg_logprobs': -0.423731601599491, 'model_name': 'gemini-2.5-pro'} id='run--1407a091-c497-4cdc-a9ab-248aef246132-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_foreignkey', 'relative_path': 'tests/admin_widgets/tests.py'}, 'id': 'd0175d7d-36e3-49a6-945a-b4d40e9c0e4b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 58415, 'output_tokens': 132, 'total_tokens': 59037, 'input_token_details': {'cache_read': 57987}, 'output_token_details': {'reasoning': 490}}
2025-10-06 03:42:07,245 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I was unable to find any instances of `formfield_for_foreignkey` in `tests/admin_widgets/tests.py`, so I will now try a broader search. I will look for any occurrences of `formfield_for_foreignkey` in any file within the `tests` directory, which should give me a more comprehensive list of potential test cases. From there, I will examine the results to find an example of a custom widget being used with a foreign key.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_foreignkey", "relative_path": "tests"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 58579, 'candidates_token_count': 131, 'total_token_count': 58710, 'cached_content_token_count': 57958, 'prompt_tokens_details': [{'modality': 1, 'token_count': 58579}], 'cache_tokens_details': [{'modality': 1, 'token_count': 57958}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 131}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.13513144281984285, 'model_name': 'gemini-2.5-pro'} id='run--58e80d6c-4f2e-477c-aac6-95debca9f20a-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_foreignkey', 'relative_path': 'tests'}, 'id': 'd1c2a5af-1659-4eda-a1a8-e78a4331762b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 58579, 'output_tokens': 131, 'total_tokens': 58710, 'input_token_details': {'cache_read': 57958}}
2025-10-06 03:42:09,336 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='The previous search failed, so I will try a different approach. I will now search for the text "formfield_for_foreignkey" in all files with the basename `tests.py` to see if I can find any relevant test cases. This should give me a list of all test files that override the method, which I can then examine for examples of custom widgets being used.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "formfield_for_foreignkey", "basename": "tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 58746, 'candidates_token_count': 108, 'total_token_count': 58854, 'cached_content_token_count': 57928, 'prompt_tokens_details': [{'modality': 1, 'token_count': 58746}], 'cache_tokens_details': [{'modality': 1, 'token_count': 57928}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 108}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10568127808747468, 'model_name': 'gemini-2.5-pro'} id='run--647f024b-e1d9-40be-b814-4206dc557954-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'formfield_for_foreignkey', 'basename': 'tests.py'}, 'id': 'b2c5aa80-2207-40a7-b936-4f405f79d52e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 58746, 'output_tokens': 108, 'total_tokens': 58854, 'input_token_details': {'cache_read': 57928}}
2025-10-06 03:42:11,880 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have re-examined the test case in `tests/admin_ordering/tests.py` and confirmed that it does not contain an example of a custom widget being used with `formfield_for_foreignkey`. Since my previous searches have not yielded any other relevant results, I will now try a more targeted approach and search for the exact phrase "formfield_for_foreignkey" in all files within the `admin_views` directory. This should help me narrow down the search to a more relevant set of files.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'arguments': '{"text": "formfield_for_foreignkey", "relative_path": "tests/admin_views"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 59844, 'candidates_token_count': 143, 'total_token_count': 59987, 'cached_content_token_count': 57895, 'prompt_tokens_details': [{'modality': 1, 'token_count': 59844}], 'cache_tokens_details': [{'modality': 1, 'token_count': 57895}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 143}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0835097719739367, 'model_name': 'gemini-2.5-pro'} id='run--c0a77484-54c6-4078-b2f7-0c05bb17c846-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'formfield_for_foreignkey', 'relative_path': 'tests/admin_views'}, 'id': 'c49d1ef0-e99b-4b5e-86ed-fdae10ec78d2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 59844, 'output_tokens': 143, 'total_tokens': 59987, 'input_token_details': {'cache_read': 57895}}
2025-10-06 03:42:25,091 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I have been unable to locate a direct example of `formfield_for_foreignkey` being used to specify a custom widget in the test files I have examined so far. My previous searches have either returned irrelevant results or failed. To move forward, I will now read the entire `tests/admin_ordering/tests.py` file to get a better understanding of its contents and to see if it contains any clues that might help me find the example I'm looking for." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_ordering/tests.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 60023, 'candidates_token_count': 121, 'total_token_count': 61407, 'cached_content_token_count': 57866, 'prompt_tokens_details': [{'modality': 1, 'token_count': 60023}], 'cache_tokens_details': [{'modality': 1, 'token_count': 57866}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 121}], 'thoughts_token_count': 1263}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1585147321716813, 'model_name': 'gemini-2.5-pro'} id='run--6f97d7ab-03e7-43ac-93e4-f49231ec68b9-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_ordering/tests.py'}, 'id': 'd6c6d286-8dba-4e5c-87fe-72f030693716', 'type': 'tool_call'}] usage_metadata={'input_tokens': 60023, 'output_tokens': 121, 'total_tokens': 61407, 'input_token_details': {'cache_read': 57866}, 'output_token_details': {'reasoning': 1263}}
2025-10-06 03:42:28,089 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='After a thorough investigation, I was unable to find a test case that specifically demonstrates overriding `ModelAdmin.formfield_for_foreignkey` to specify a custom widget. I started by searching for occurrences of `formfield_for_foreignkey` in the `tests` directory, which led me to `tests/admin_ordering/tests.py`. Although this file contained an override of the method, it was used to customize the queryset rather than to specify a custom widget. I then broadened my search to include other test files that imported custom widgets, but I was still unable to find a relevant example. I also tried a more targeted search within the `admin_views` directory, but this did not yield any results. It appears that there are no test cases in the codebase that directly demonstrate this functionality.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 63025, 'candidates_token_count': 166, 'total_token_count': 63191, 'cached_content_token_count': 59805, 'prompt_tokens_details': [{'modality': 1, 'token_count': 63025}], 'cache_tokens_details': [{'modality': 1, 'token_count': 59805}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 166}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08919971535004766, 'model_name': 'gemini-2.5-pro'} id='run--cbb5ca9b-2f77-4176-a024-33f294d488d0-0' usage_metadata={'input_tokens': 63025, 'output_tokens': 166, 'total_tokens': 63191, 'input_token_details': {'cache_read': 59805}}
2025-10-06 03:42:28,090 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 03:42:28,090 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Allow overridding widget in formfield_for_manytomany().

Issue description: 
Description
	 
		(last modified by Mariusz Felisiak)
	 
It does not work when I set widget param to function formfield_for_manytomany().
This is different from the formfield_for_foreignkey() function.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide test cases where `ModelAdmin.formfield_for_foreignkey` is overridden to specify a custom widget. This will serve as a positive example of the functionality the user is trying to achieve with `formfield_for_manytomany`.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/modeladmin/tests.py
Line number range: 16 - 16
Content:
from django.forms.widgets import Select

File: tests/admin_widgets/tests.py
Line number range: 12 - 12
Content:
from django.contrib.admin import widgets

File: tests/admin_widgets/tests.py
Line number range: 26 - 26
Content:
from .widgetadmin import site as widget_admin_site

File: tests/model_formsets_regress/tests.py
Line number range: 310 - 311
Content:
class CustomWidget(forms.widgets.TextInput):
    pass

File: tests/modeladmin/tests.py
Line number range: 10 - 13
Content:
from django.contrib.admin.widgets import (
    AdminDateWidget, AdminRadioSelect, AutocompleteSelect,
    AutocompleteSelectMultiple,
)

File: tests/admin_ordering/tests.py
Line number range: 1 - 189
Content:
1. from django.contrib import admin
2. from django.contrib.admin.options import ModelAdmin
3. from django.contrib.auth.models import User
4. from django.db.models import F
5. from django.test import RequestFactory, TestCase
6. 
7. from .models import (
8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,
9.     SongInlineNewOrdering,
10. )
11. 
12. 
13. class MockRequest:
14.     pass
15. 
16. 
17. class MockSuperUser:
18.     def has_perm(self, perm):
19.         return True
20. 
21.     def has_module_perms(self, module):
22.         return True
23. 
24. 
25. request = MockRequest()
26. request.user = MockSuperUser()
27. 
28. site = admin.AdminSite()
29. 
30. 
31. class TestAdminOrdering(TestCase):
32.     """
33.     Let's make sure that ModelAdmin.get_queryset uses the ordering we define
34.     in ModelAdmin rather that ordering defined in the model's inner Meta
35.     class.
36.     """
37.     request_factory = RequestFactory()
38. 
39.     @classmethod
40.     def setUpTestData(cls):
41.         Band.objects.bulk_create([
42.             Band(name='Aerosmith', bio='', rank=3),
43.             Band(name='Radiohead', bio='', rank=1),
44.             Band(name='Van Halen', bio='', rank=2),
45.         ])
46. 
47.     def test_default_ordering(self):
48.         """
49.         The default ordering should be by name, as specified in the inner Meta
50.         class.
51.         """
52.         ma = ModelAdmin(Band, site)
53.         names = [b.name for b in ma.get_queryset(request)]
54.         self.assertEqual(['Aerosmith', 'Radiohead', 'Van Halen'], names)
55. 
56.     def test_specified_ordering(self):
57.         """
58.         Let's use a custom ModelAdmin that changes the ordering, and make sure
59.         it actually changes.
60.         """
61.         class BandAdmin(ModelAdmin):
62.             ordering = ('rank',)  # default ordering is ('name',)
63.         ma = BandAdmin(Band, site)
64.         names = [b.name for b in ma.get_queryset(request)]
65.         self.assertEqual(['Radiohead', 'Van Halen', 'Aerosmith'], names)
66. 
67.     def test_specified_ordering_by_f_expression(self):
68.         class BandAdmin(ModelAdmin):
69.             ordering = (F('rank').desc(nulls_last=True),)
70.         band_admin = BandAdmin(Band, site)
71.         names = [b.name for b in band_admin.get_queryset(request)]
72.         self.assertEqual(['Aerosmith', 'Van Halen', 'Radiohead'], names)
73. 
74.     def test_dynamic_ordering(self):
75.         """
76.         Let's use a custom ModelAdmin that changes the ordering dynamically.
77.         """
78.         super_user = User.objects.create(username='admin', is_superuser=True)
79.         other_user = User.objects.create(username='other')
80.         request = self.request_factory.get('/')
81.         request.user = super_user
82.         ma = DynOrderingBandAdmin(Band, site)
83.         names = [b.name for b in ma.get_queryset(request)]
84.         self.assertEqual(['Radiohead', 'Van Halen', 'Aerosmith'], names)
85.         request.user = other_user
86.         names = [b.name for b in ma.get_queryset(request)]
87.         self.assertEqual(['Aerosmith', 'Radiohead', 'Van Halen'], names)
88. 
89. 
90. class TestInlineModelAdminOrdering(TestCase):
91.     """
92.     Let's make sure that InlineModelAdmin.get_queryset uses the ordering we
93.     define in InlineModelAdmin.
94.     """
95. 
96.     @classmethod
97.     def setUpTestData(cls):
98.         cls.band = Band.objects.create(name='Aerosmith', bio='', rank=3)
99.         Song.objects.bulk_create([
100.             Song(band=cls.band, name='Pink', duration=235),
101.             Song(band=cls.band, name='Dude (Looks Like a Lady)', duration=264),
102.             Song(band=cls.band, name='Jaded', duration=214),
103.         ])
104. 
105.     def test_default_ordering(self):
106.         """
107.         The default ordering should be by name, as specified in the inner Meta
108.         class.
109.         """
110.         inline = SongInlineDefaultOrdering(self.band, site)
111.         names = [s.name for s in inline.get_queryset(request)]
112.         self.assertEqual(['Dude (Looks Like a Lady)', 'Jaded', 'Pink'], names)
113. 
114.     def test_specified_ordering(self):
115.         """
116.         Let's check with ordering set to something different than the default.
117.         """
118.         inline = SongInlineNewOrdering(self.band, site)
119.         names = [s.name for s in inline.get_queryset(request)]
120.         self.assertEqual(['Jaded', 'Pink', 'Dude (Looks Like a Lady)'], names)
121. 
122. 
123. class TestRelatedFieldsAdminOrdering(TestCase):
124.     @classmethod
125.     def setUpTestData(cls):
126.         cls.b1 = Band.objects.create(name='Pink Floyd', bio='', rank=1)
127.         cls.b2 = Band.objects.create(name='Foo Fighters', bio='', rank=5)
128. 
129.     def setUp(self):
130.         # we need to register a custom ModelAdmin (instead of just using
131.         # ModelAdmin) because the field creator tries to find the ModelAdmin
132.         # for the related model
133.         class SongAdmin(admin.ModelAdmin):
134.             pass
135.         site.register(Song, SongAdmin)
136. 
137.     def tearDown(self):
138.         site.unregister(Song)
139.         if Band in site._registry:
140.             site.unregister(Band)
141. 
142.     def check_ordering_of_field_choices(self, correct_ordering):
143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)
144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)
145.         self.assertEqual(list(fk_field.queryset), correct_ordering)
146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)
147. 
148.     def test_no_admin_fallback_to_model_ordering(self):
149.         # should be ordered by name (as defined by the model)
150.         self.check_ordering_of_field_choices([self.b2, self.b1])
151. 
152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):
153.         class NoOrderingBandAdmin(admin.ModelAdmin):
154.             pass
155.         site.register(Band, NoOrderingBandAdmin)
156. 
157.         # should be ordered by name (as defined by the model)
158.         self.check_ordering_of_field_choices([self.b2, self.b1])
159. 
160.     def test_admin_ordering_beats_model_ordering(self):
161.         class StaticOrderingBandAdmin(admin.ModelAdmin):
162.             ordering = ('rank',)
163.         site.register(Band, StaticOrderingBandAdmin)
164. 
165.         # should be ordered by rank (defined by the ModelAdmin)
166.         self.check_ordering_of_field_choices([self.b1, self.b2])
167. 
168.     def test_custom_queryset_still_wins(self):
169.         """Custom queryset has still precedence (#21405)"""
170.         class SongAdmin(admin.ModelAdmin):
171.             # Exclude one of the two Bands from the querysets
172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):
173.                 if db_field.name == 'band':
174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
176. 
177.             def formfield_for_manytomany(self, db_field, request, **kwargs):
178.                 if db_field.name == 'other_interpreters':
179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
181. 
182.         class StaticOrderingBandAdmin(admin.ModelAdmin):
183.             ordering = ('rank',)
184. 
185.         site.unregister(Song)
186.         site.register(Song, SongAdmin)
187.         site.register(Band, StaticOrderingBandAdmin)
188. 
189.         self.check_ordering_of_field_choices([self.b2])


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 03:43:19,208 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to see how to override `formfield_for_manytomany` to specify a custom widget.\n   - The refined query asks for examples using `formfield_for_foreignkey` as a positive example of this pattern.\n\n2. Extended relevance:\n   - This test method, `test_custom_queryset_still_wins`, provides the most relevant example in the context.\n   - It defines a `ModelAdmin` subclass (`SongAdmin`) that overrides both `formfield_for_foreignkey` and `formfield_for_manytomany`.\n   - Although it modifies the `queryset` kwarg instead of `widget`, it demonstrates the exact pattern of modifying the `kwargs` dictionary before calling the `super()` method. This is the core functionality the user needs to understand to solve their issue.', relative_path='tests/admin_ordering/tests.py', start_line=168, end_line=189), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user needs to understand how to test their `formfield_for_*` override.\n\n2. Extended relevance:\n   - This helper method, `check_ordering_of_field_choices`, is used by the tests in `TestRelatedFieldsAdminOrdering`.\n   - It demonstrates how to test the result of a `formfield_for_*` call by getting the formfield from the admin site and inspecting its properties (in this case, the `queryset`).\n   - This provides a clear pattern for asserting that the override has had the intended effect.', relative_path='tests/admin_ordering/tests.py', start_line=142, end_line=147), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is looking for examples of `ModelAdmin` customization affecting form fields.\n\n2. Extended relevance:\n   - This test, `test_admin_ordering_beats_model_ordering`, shows how a simple `ModelAdmin` attribute (`ordering`) can influence the formfields for related models.\n   - It defines a `ModelAdmin` subclass, registers it, and then uses the `check_ordering_of_field_choices` helper to verify the change.\n   - This serves as a simpler, complementary example to the more complex override in `test_custom_queryset_still_wins`.', relative_path='tests/admin_ordering/tests.py', start_line=160, end_line=167), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user requested '5 complete, self-contained test cases'.\n\n2. Extended relevance:\n   - This context provides the `setUpTestData`, `setUp`, and `tearDown` methods for the `TestRelatedFieldsAdminOrdering` class.\n   - This setup is essential for the other extracted test methods to be understood, as it handles the creation of `Band` objects and the registration/unregistration of `ModelAdmin` classes with the admin site.\n   - It is a critical piece for providing a 'complete' test case.", relative_path='tests/admin_ordering/tests.py', start_line=123, end_line=141), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's original query explicitly requires that the output 'Must include ALL necessary imports at the start of each test file'.\n\n2. Extended relevance:\n   - This context provides all the necessary imports for the test cases extracted from `tests/admin_ordering/tests.py`.\n   - Without these imports, the other code snippets would be incomplete and would not run.", relative_path='tests/admin_ordering/tests.py', start_line=1, end_line=10)]
2025-10-06 03:43:19,209 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='tests/admin_ordering/tests.py', content='123. class TestRelatedFieldsAdminOrdering(TestCase):\n124.     @classmethod\n125.     def setUpTestData(cls):\n126.         cls.b1 = Band.objects.create(name=\'Pink Floyd\', bio=\'\', rank=1)\n127.         cls.b2 = Band.objects.create(name=\'Foo Fighters\', bio=\'\', rank=5)\n128. \n129.     def setUp(self):\n130.         # we need to register a custom ModelAdmin (instead of just using\n131.         # ModelAdmin) because the field creator tries to find the ModelAdmin\n132.         # for the related model\n133.         class SongAdmin(admin.ModelAdmin):\n134.             pass\n135.         site.register(Song, SongAdmin)\n136. \n137.     def tearDown(self):\n138.         site.unregister(Song)\n139.         if Band in site._registry:\n140.             site.unregister(Band)\n141. \n142.     def check_ordering_of_field_choices(self, correct_ordering):\n143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)\n144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)\n145.         self.assertEqual(list(fk_field.queryset), correct_ordering)\n146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)\n147. \n148.     def test_no_admin_fallback_to_model_ordering(self):\n149.         # should be ordered by name (as defined by the model)\n150.         self.check_ordering_of_field_choices([self.b2, self.b1])\n151. \n152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):\n153.         class NoOrderingBandAdmin(admin.ModelAdmin):\n154.             pass\n155.         site.register(Band, NoOrderingBandAdmin)\n156. \n157.         # should be ordered by name (as defined by the model)\n158.         self.check_ordering_of_field_choices([self.b2, self.b1])\n159. \n160.     def test_admin_ordering_beats_model_ordering(self):\n161.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n162.             ordering = (\'rank\',)\n163.         site.register(Band, StaticOrderingBandAdmin)\n164. \n165.         # should be ordered by rank (defined by the ModelAdmin)\n166.         self.check_ordering_of_field_choices([self.b1, self.b2])\n167. \n168.     def test_custom_queryset_still_wins(self):\n169.         """Custom queryset has still precedence (#21405)"""\n170.         class SongAdmin(admin.ModelAdmin):\n171.             # Exclude one of the two Bands from the querysets\n172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):\n173.                 if db_field.name == \'band\':\n174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n176. \n177.             def formfield_for_manytomany(self, db_field, request, **kwargs):\n178.                 if db_field.name == \'other_interpreters\':\n179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n181. \n182.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n183.             ordering = (\'rank\',)\n184. \n185.         site.unregister(Song)\n186.         site.register(Song, SongAdmin)\n187.         site.register(Band, StaticOrderingBandAdmin)\n188. \n189.         self.check_ordering_of_field_choices([self.b2])', start_line_number=123, end_line_number=189), Context(relative_path='django/contrib/auth/admin.py', content="25. @admin.register(Group)\n26. class GroupAdmin(admin.ModelAdmin):\n27.     search_fields = ('name',)\n28.     ordering = ('name',)\n29.     filter_horizontal = ('permissions',)\n30. \n31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):\n32.         if db_field.name == 'permissions':\n33.             qs = kwargs.get('queryset', db_field.remote_field.model.objects)\n34.             # Avoid a major performance hit resolving permission names which\n35.             # triggers a content_type load:\n36.             kwargs['queryset'] = qs.select_related('content_type')\n37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)", start_line_number=25, end_line_number=37), Context(relative_path='tests/admin_views/tests.py', content='5262. @override_settings(ROOT_URLCONF=\'admin_views.urls\')\n5263. class GroupAdminTest(TestCase):\n5264.     """\n5265.     Tests group CRUD functionality.\n5266.     """\n5267. \n5268.     @classmethod\n5269.     def setUpTestData(cls):\n5270.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n5271. \n5272.     def setUp(self):\n5273.         self.client.force_login(self.superuser)\n5274. \n5275.     def test_save_button(self):\n5276.         group_count = Group.objects.count()\n5277.         response = self.client.post(reverse(\'admin:auth_group_add\'), {\n5278.             \'name\': \'newgroup\',\n5279.         })\n5280. \n5281.         Group.objects.order_by(\'-id\')[0]\n5282.         self.assertRedirects(response, reverse(\'admin:auth_group_changelist\'))\n5283.         self.assertEqual(Group.objects.count(), group_count + 1)\n5284. \n5285.     def test_group_permission_performance(self):\n5286.         g = Group.objects.create(name="test_group")\n5287. \n5288.         # Ensure no queries are skipped due to cached content type for Group.\n5289.         ContentType.objects.clear_cache()\n5290. \n5291.         with self.assertNumQueries(8):\n5292.             response = self.client.get(reverse(\'admin:auth_group_change\', args=(g.pk,)))\n5293.             self.assertEqual(response.status_code, 200)', start_line_number=5262, end_line_number=5293), Context(relative_path='tests/admin_widgets/tests.py', content='39. class AdminFormfieldForDBFieldTests(SimpleTestCase):\n40.     """\n41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n42.     """\n43. \n44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n45.         """\n46.         Helper to call formfield_for_dbfield for a given model and field name\n47.         and verify that the returned formfield is appropriate.\n48.         """\n49.         # Override any settings on the model admin\n50.         class MyModelAdmin(admin.ModelAdmin):\n51.             pass\n52.         for k in admin_overrides:\n53.             setattr(MyModelAdmin, k, admin_overrides[k])\n54. \n55.         # Construct the admin, and ask it for a formfield\n56.         ma = MyModelAdmin(model, admin.site)\n57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n58. \n59.         # "unwrap" the widget wrapper, if needed\n60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n61.             widget = ff.widget.widget\n62.         else:\n63.             widget = ff.widget\n64. \n65.         self.assertIsInstance(widget, widgetclass)\n66. \n67.         # Return the formfield so that other tests can continue\n68.         return ff\n69. \n70.     def test_DateField(self):\n71.         self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n72. \n73.     def test_DateTimeField(self):\n74.         self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n75. \n76.     def test_TimeField(self):\n77.         self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n78. \n79.     def test_TextField(self):\n80.         self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n81. \n82.     def test_URLField(self):\n83.         self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n84. \n85.     def test_IntegerField(self):\n86.         self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n87. \n88.     def test_CharField(self):\n89.         self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n90. \n91.     def test_EmailField(self):\n92.         self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n93. \n94.     def test_FileField(self):\n95.         self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n96. \n97.     def test_ForeignKey(self):\n98.         self.assertFormfield(Event, \'main_band\', forms.Select)\n99. \n100.     def test_raw_id_ForeignKey(self):\n101.         self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n102.                              raw_id_fields=[\'main_band\'])\n103. \n104.     def test_radio_fields_ForeignKey(self):\n105.         ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n106.                                   radio_fields={\'main_band\': admin.VERTICAL})\n107.         self.assertIsNone(ff.empty_label)\n108. \n109.     def test_many_to_many(self):\n110.         self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n111. \n112.     def test_raw_id_many_to_many(self):\n113.         self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n114.                              raw_id_fields=[\'members\'])\n115. \n116.     def test_filtered_many_to_many(self):\n117.         self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n118.                              filter_vertical=[\'members\'])\n119. \n120.     def test_formfield_overrides(self):\n121.         self.assertFormfield(Event, \'start_date\', forms.TextInput,\n122.                              formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n123. \n124.     def test_formfield_overrides_widget_instances(self):\n125.         """\n126.         Widget instances in formfield_overrides are not shared between\n127.         different fields. (#19423)\n128.         """\n129.         class BandAdmin(admin.ModelAdmin):\n130.             formfield_overrides = {\n131.                 CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n132.             }\n133.         ma = BandAdmin(Band, admin.site)\n134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n136.         self.assertNotEqual(f1.widget, f2.widget)\n137.         self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n138.         self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n139.         self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n140. \n141.     def test_formfield_overrides_for_datetime_field(self):\n142.         """\n143.         Overriding the widget for DateTimeField doesn\'t overrides the default\n144.         form_class for that field (#26449).\n145.         """\n146.         class MemberAdmin(admin.ModelAdmin):\n147.             formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n148.         ma = MemberAdmin(Member, admin.site)\n149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n151.         self.assertIsInstance(f1, forms.SplitDateTimeField)\n152. \n153.     def test_formfield_overrides_for_custom_field(self):\n154.         """\n155.         formfield_overrides works for a custom field class.\n156.         """\n157.         class AlbumAdmin(admin.ModelAdmin):\n158.             formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n159.         ma = AlbumAdmin(Member, admin.site)\n160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n161.         self.assertIsInstance(f1.widget, forms.TextInput)\n162. \n163.     def test_field_with_choices(self):\n164.         self.assertFormfield(Member, \'gender\', forms.Select)\n165. \n166.     def test_choices_with_radio_fields(self):\n167.         self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n168.                              radio_fields={\'gender\': admin.VERTICAL})\n169. \n170.     def test_inheritance(self):\n171.         self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n172. \n173.     def test_m2m_widgets(self):\n174.         """m2m fields help text as it applies to admin app (#9321)."""\n175.         class AdvisorAdmin(admin.ModelAdmin):\n176.             filter_vertical = [\'companies\']\n177. \n178.         self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n179.                              filter_vertical=[\'companies\'])\n180.         ma = AdvisorAdmin(Advisor, admin.site)\n181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n182.         self.assertEqual(\n183.             f.help_text,\n184.             \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n185.         )\n186. \n187. ', start_line_number=39, end_line_number=187), Context(relative_path='tests/admin_widgets/tests.py', content="638. @override_settings(ROOT_URLCONF='admin_widgets.urls')\n639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):\n640.     def test_no_can_add_related(self):\n641.         rel = Individual._meta.get_field('parent').remote_field\n642.         w = widgets.AdminRadioSelect()\n643.         # Used to fail with a name error.\n644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n645.         self.assertFalse(w.can_add_related)\n646. \n647.     def test_select_multiple_widget_cant_change_delete_related(self):\n648.         rel = Individual._meta.get_field('parent').remote_field\n649.         widget = forms.SelectMultiple()\n650.         wrapper = widgets.RelatedFieldWidgetWrapper(\n651.             widget, rel, widget_admin_site,\n652.             can_add_related=True,\n653.             can_change_related=True,\n654.             can_delete_related=True,\n655.         )\n656.         self.assertTrue(wrapper.can_add_related)\n657.         self.assertFalse(wrapper.can_change_related)\n658.         self.assertFalse(wrapper.can_delete_related)\n659. \n660.     def test_on_delete_cascade_rel_cant_delete_related(self):\n661.         rel = Individual._meta.get_field('soulmate').remote_field\n662.         widget = forms.Select()\n663.         wrapper = widgets.RelatedFieldWidgetWrapper(\n664.             widget, rel, widget_admin_site,\n665.             can_add_related=True,\n666.             can_change_related=True,\n667.             can_delete_related=True,\n668.         )\n669.         self.assertTrue(wrapper.can_add_related)\n670.         self.assertTrue(wrapper.can_change_related)\n671.         self.assertFalse(wrapper.can_delete_related)\n672. \n673.     def test_custom_widget_render(self):\n674.         class CustomWidget(forms.Select):\n675.             def render(self, *args, **kwargs):\n676.                 return 'custom render output'\n677.         rel = Album._meta.get_field('band').remote_field\n678.         widget = CustomWidget()\n679.         wrapper = widgets.RelatedFieldWidgetWrapper(\n680.             widget, rel, widget_admin_site,\n681.             can_add_related=True,\n682.             can_change_related=True,\n683.             can_delete_related=True,\n684.         )\n685.         output = wrapper.render('name', 'value')\n686.         self.assertIn('custom render output', output)\n687. \n688.     def test_widget_delegates_value_omitted_from_data(self):\n689.         class CustomWidget(forms.Select):\n690.             def value_omitted_from_data(self, data, files, name):\n691.                 return False\n692.         rel = Album._meta.get_field('band').remote_field\n693.         widget = CustomWidget()\n694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)\n696. \n697.     def test_widget_is_hidden(self):\n698.         rel = Album._meta.get_field('band').remote_field\n699.         widget = forms.HiddenInput()\n700.         widget.choices = ()\n701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n702.         self.assertIs(wrapper.is_hidden, True)\n703.         context = wrapper.get_context('band', None, {})\n704.         self.assertIs(context['is_hidden'], True)\n705.         output = wrapper.render('name', 'value')\n706.         # Related item links are hidden.\n707.         self.assertNotIn('<a ', output)\n708. \n709.     def test_widget_is_not_hidden(self):\n710.         rel = Album._meta.get_field('band').remote_field\n711.         widget = forms.Select()\n712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n713.         self.assertIs(wrapper.is_hidden, False)\n714.         context = wrapper.get_context('band', None, {})\n715.         self.assertIs(context['is_hidden'], False)\n716.         output = wrapper.render('name', 'value')\n717.         # Related item links are present.\n718.         self.assertIn('<a ', output)", start_line_number=638, end_line_number=718), Context(relative_path='tests/admin_ordering/tests.py', content='1. from django.contrib import admin\n2. from django.contrib.admin.options import ModelAdmin\n3. from django.contrib.auth.models import User\n4. from django.db.models import F\n5. from django.test import RequestFactory, TestCase\n6. \n7. from .models import (\n8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,\n9.     SongInlineNewOrdering,\n10. )', start_line_number=1, end_line_number=10)]
2025-10-06 03:43:19,209 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 03:43:19,209 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
django
├── .github
|   └── FUNDING.yml
├── .tx
├── CONTRIBUTING.rst
├── Gruntfile.js
├── README.rst
├── django
|   ├── __init__.py
|   ├── __main__.py
|   ├── apps
|   |   ├── __init__.py
|   |   ├── config.py
|   |   └── registry.py
|   ├── bin
|   |   └── django-admin.py
|   ├── conf
|   |   ├── __init__.py
|   |   ├── app_template
|   |   |   └── migrations
|   |   ├── global_settings.py
|   |   ├── locale
|   |   |   ├── __init__.py
|   |   |   ├── af
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ar
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ar_DZ
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ast
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── az
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── be
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bg
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── bn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── br
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── bs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ca
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cs
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── cy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── da
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── de_CH
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── dsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── el
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_AU
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── en_GB
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eo
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_AR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_CO
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_MX
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_NI
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_PR
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── es_VE
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── et
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── eu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fa
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── fy
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ga
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gd
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── gl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── he
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hsb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── hu
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── hy
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ia
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── id
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── io
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── is
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── it
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ja
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ka
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kab
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── kk
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── km
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── kn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ko
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lb
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── lt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── lv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ml
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── mr
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── my
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nb
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ne
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── nl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── nn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── os
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pa
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── pl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── pt_BR
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ro
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ru
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sl
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sq
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sr_Latn
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sv
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── sw
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── ta
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── te
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── th
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tr
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── tt
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── udm
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uk
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── ur
|   |   |   |   └── LC_MESSAGES
|   |   |   ├── uz
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── vi
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   ├── zh_Hans
|   |   |   |   ├── LC_MESSAGES
|   |   |   |   ├── __init__.py
|   |   |   |   └── formats.py
|   |   |   └── zh_Hant
|   |   |       ├── LC_MESSAGES
|   |   |       ├── __init__.py
|   |   |       └── formats.py
|   |   ├── project_template
|   |   |   └── project_name
|   |   └── urls
|   |       ├── __init__.py
|   |       ├── i18n.py
|   |       └── static.py
|   ├── contrib
|   |   ├── __init__.py
|   |   ├── admin
|   |   |   ├── __init__.py
|   |   |   ├── actions.py
|   |   |   ├── apps.py
|   |   |   ├── bin
|   |   |   |   └── compress.py
|   |   |   ├── checks.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── filters.py
|   |   |   ├── forms.py
|   |   |   ├── helpers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── am
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_logentry_remove_auto_add.py
|   |   |   |   ├── 0003_logentry_add_action_flag_choices.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── options.py
|   |   |   ├── sites.py
|   |   |   ├── static
|   |   |   |   └── admin
|   |   |   ├── templates
|   |   |   |   ├── admin
|   |   |   |   └── registration
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   ├── admin_list.py
|   |   |   |   ├── admin_modify.py
|   |   |   |   ├── admin_urls.py
|   |   |   |   ├── base.py
|   |   |   |   └── log.py
|   |   |   ├── tests.py
|   |   |   ├── utils.py
|   |   |   ├── views
|   |   |   |   ├── __init__.py
|   |   |   |   ├── autocomplete.py
|   |   |   |   ├── decorators.py
|   |   |   |   └── main.py
|   |   |   └── widgets.py
|   |   ├── admindocs
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── templates
|   |   |   |   └── admin_doc
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── auth
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── backends.py
|   |   |   ├── base_user.py
|   |   |   ├── checks.py
|   |   |   ├── context_processors.py
|   |   |   ├── decorators.py
|   |   |   ├── forms.py
|   |   |   ├── handlers
|   |   |   |   ├── __init__.py
|   |   |   |   └── modwsgi.py
|   |   |   ├── hashers.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_permission_name_max_length.py
|   |   |   |   ├── 0003_alter_user_email_max_length.py
|   |   |   |   ├── 0004_alter_user_username_opts.py
|   |   |   |   ├── 0005_alter_user_last_login_null.py
|   |   |   |   ├── 0006_require_contenttypes_0002.py
|   |   |   |   ├── 0007_alter_validators_add_error_messages.py
|   |   |   |   ├── 0008_alter_user_username_max_length.py
|   |   |   |   ├── 0009_alter_user_last_name_max_length.py
|   |   |   |   ├── 0010_alter_group_name_max_length.py
|   |   |   |   ├── 0011_update_proxy_permissions.py
|   |   |   |   ├── 0012_alter_user_first_name_max_length.py
|   |   |   |   └── __init__.py
|   |   |   ├── mixins.py
|   |   |   ├── models.py
|   |   |   ├── password_validation.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   ├── auth
|   |   |   |   └── registration
|   |   |   ├── tokens.py
|   |   |   ├── urls.py
|   |   |   ├── validators.py
|   |   |   └── views.py
|   |   ├── contenttypes
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── fields.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   ├── __init__.py
|   |   |   |   └── commands
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_remove_content_type_name.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── views.py
|   |   ├── flatpages
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── forms.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── sitemaps.py
|   |   |   ├── templatetags
|   |   |   |   ├── __init__.py
|   |   |   |   └── flatpages.py
|   |   |   ├── urls.py
|   |   |   └── views.py
|   |   ├── gis
|   |   |   ├── __init__.py
|   |   |   ├── admin
|   |   |   |   ├── __init__.py
|   |   |   |   ├── options.py
|   |   |   |   └── widgets.py
|   |   |   ├── apps.py
|   |   |   ├── db
|   |   |   |   ├── __init__.py
|   |   |   |   ├── backends
|   |   |   |   └── models
|   |   |   ├── feeds.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── fields.py
|   |   |   |   └── widgets.py
|   |   |   ├── gdal
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── datasource.py
|   |   |   |   ├── driver.py
|   |   |   |   ├── envelope.py
|   |   |   |   ├── error.py
|   |   |   |   ├── feature.py
|   |   |   |   ├── field.py
|   |   |   |   ├── geometries.py
|   |   |   |   ├── geomtype.py
|   |   |   |   ├── layer.py
|   |   |   |   ├── libgdal.py
|   |   |   |   ├── prototypes
|   |   |   |   ├── raster
|   |   |   |   └── srs.py
|   |   |   ├── geoip2
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── resources.py
|   |   |   ├── geometry.py
|   |   |   ├── geos
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── collections.py
|   |   |   |   ├── coordseq.py
|   |   |   |   ├── error.py
|   |   |   |   ├── factory.py
|   |   |   |   ├── geometry.py
|   |   |   |   ├── io.py
|   |   |   |   ├── libgeos.py
|   |   |   |   ├── linestring.py
|   |   |   |   ├── mutable_list.py
|   |   |   |   ├── point.py
|   |   |   |   ├── polygon.py
|   |   |   |   ├── prepared.py
|   |   |   |   └── prototypes
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── measure.py
|   |   |   ├── ptr.py
|   |   |   ├── serializers
|   |   |   |   ├── __init__.py
|   |   |   |   └── geojson.py
|   |   |   ├── shortcuts.py
|   |   |   ├── sitemaps
|   |   |   |   ├── __init__.py
|   |   |   |   ├── kml.py
|   |   |   |   └── views.py
|   |   |   ├── static
|   |   |   |   └── gis
|   |   |   ├── templates
|   |   |   |   └── gis
|   |   |   ├── utils
|   |   |   |   ├── __init__.py
|   |   |   |   ├── layermapping.py
|   |   |   |   ├── ogrinfo.py
|   |   |   |   ├── ogrinspect.py
|   |   |   |   └── srs.py
|   |   |   └── views.py
|   |   ├── humanize
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── ms
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   └── templatetags
|   |   |       ├── __init__.py
|   |   |       └── humanize.py
|   |   ├── messages
|   |   |   ├── __init__.py
|   |   |   ├── api.py
|   |   |   ├── apps.py
|   |   |   ├── constants.py
|   |   |   ├── context_processors.py
|   |   |   ├── middleware.py
|   |   |   ├── storage
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cookie.py
|   |   |   |   ├── fallback.py
|   |   |   |   └── session.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   ├── postgres
|   |   |   ├── __init__.py
|   |   |   ├── aggregates
|   |   |   |   ├── __init__.py
|   |   |   |   ├── general.py
|   |   |   |   ├── mixins.py
|   |   |   |   └── statistics.py
|   |   |   ├── apps.py
|   |   |   ├── constraints.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── citext.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   ├── ranges.py
|   |   |   |   └── utils.py
|   |   |   ├── forms
|   |   |   |   ├── __init__.py
|   |   |   |   ├── array.py
|   |   |   |   ├── hstore.py
|   |   |   |   ├── jsonb.py
|   |   |   |   └── ranges.py
|   |   |   ├── functions.py
|   |   |   ├── indexes.py
|   |   |   ├── jinja2
|   |   |   |   └── postgres
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kk
|   |   |   |   ├── ko
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── mn
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── tr
|   |   |   |   ├── uk
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── lookups.py
|   |   |   ├── operations.py
|   |   |   ├── search.py
|   |   |   ├── serializers.py
|   |   |   ├── signals.py
|   |   |   ├── templates
|   |   |   |   └── postgres
|   |   |   ├── utils.py
|   |   |   └── validators.py
|   |   ├── redirects
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   └── models.py
|   |   ├── sessions
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── cache.py
|   |   |   |   ├── cached_db.py
|   |   |   |   ├── db.py
|   |   |   |   ├── file.py
|   |   |   |   └── signed_cookies.py
|   |   |   ├── base_session.py
|   |   |   ├── exceptions.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   └── serializers.py
|   |   ├── sitemaps
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── templates
|   |   |   └── views.py
|   |   ├── sites
|   |   |   ├── __init__.py
|   |   |   ├── admin.py
|   |   |   ├── apps.py
|   |   |   ├── locale
|   |   |   |   ├── af
|   |   |   |   ├── ar
|   |   |   |   ├── ast
|   |   |   |   ├── az
|   |   |   |   ├── be
|   |   |   |   ├── bg
|   |   |   |   ├── bn
|   |   |   |   ├── br
|   |   |   |   ├── bs
|   |   |   |   ├── ca
|   |   |   |   ├── cs
|   |   |   |   ├── cy
|   |   |   |   ├── da
|   |   |   |   ├── de
|   |   |   |   ├── dsb
|   |   |   |   ├── el
|   |   |   |   ├── en
|   |   |   |   ├── en_AU
|   |   |   |   ├── en_GB
|   |   |   |   ├── eo
|   |   |   |   ├── es
|   |   |   |   ├── es_AR
|   |   |   |   ├── es_CO
|   |   |   |   ├── es_MX
|   |   |   |   ├── es_VE
|   |   |   |   ├── et
|   |   |   |   ├── eu
|   |   |   |   ├── fa
|   |   |   |   ├── fi
|   |   |   |   ├── fr
|   |   |   |   ├── fy
|   |   |   |   ├── ga
|   |   |   |   ├── gd
|   |   |   |   ├── gl
|   |   |   |   ├── he
|   |   |   |   ├── hi
|   |   |   |   ├── hr
|   |   |   |   ├── hsb
|   |   |   |   ├── hu
|   |   |   |   ├── hy
|   |   |   |   ├── ia
|   |   |   |   ├── id
|   |   |   |   ├── io
|   |   |   |   ├── is
|   |   |   |   ├── it
|   |   |   |   ├── ja
|   |   |   |   ├── ka
|   |   |   |   ├── kab
|   |   |   |   ├── kk
|   |   |   |   ├── km
|   |   |   |   ├── kn
|   |   |   |   ├── ko
|   |   |   |   ├── lb
|   |   |   |   ├── lt
|   |   |   |   ├── lv
|   |   |   |   ├── mk
|   |   |   |   ├── ml
|   |   |   |   ├── mn
|   |   |   |   ├── mr
|   |   |   |   ├── my
|   |   |   |   ├── nb
|   |   |   |   ├── ne
|   |   |   |   ├── nl
|   |   |   |   ├── nn
|   |   |   |   ├── os
|   |   |   |   ├── pa
|   |   |   |   ├── pl
|   |   |   |   ├── pt
|   |   |   |   ├── pt_BR
|   |   |   |   ├── ro
|   |   |   |   ├── ru
|   |   |   |   ├── sk
|   |   |   |   ├── sl
|   |   |   |   ├── sq
|   |   |   |   ├── sr
|   |   |   |   ├── sr_Latn
|   |   |   |   ├── sv
|   |   |   |   ├── sw
|   |   |   |   ├── ta
|   |   |   |   ├── te
|   |   |   |   ├── th
|   |   |   |   ├── tr
|   |   |   |   ├── tt
|   |   |   |   ├── udm
|   |   |   |   ├── uk
|   |   |   |   ├── ur
|   |   |   |   ├── uz
|   |   |   |   ├── vi
|   |   |   |   ├── zh_Hans
|   |   |   |   └── zh_Hant
|   |   |   ├── management.py
|   |   |   ├── managers.py
|   |   |   ├── middleware.py
|   |   |   ├── migrations
|   |   |   |   ├── 0001_initial.py
|   |   |   |   ├── 0002_alter_domain_unique.py
|   |   |   |   └── __init__.py
|   |   |   ├── models.py
|   |   |   ├── requests.py
|   |   |   └── shortcuts.py
|   |   ├── staticfiles
|   |   |   ├── __init__.py
|   |   |   ├── apps.py
|   |   |   ├── checks.py
|   |   |   ├── finders.py
|   |   |   ├── handlers.py
|   |   |   ├── management
|   |   |   |   └── commands
|   |   |   ├── storage.py
|   |   |   ├── testing.py
|   |   |   ├── urls.py
|   |   |   ├── utils.py
|   |   |   └── views.py
|   |   └── syndication
|   |       ├── __init__.py
|   |       ├── apps.py
|   |       └── views.py
|   ├── core
|   |   ├── __init__.py
|   |   ├── asgi.py
|   |   ├── cache
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── db.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── memcached.py
|   |   |   └── utils.py
|   |   ├── checks
|   |   |   ├── __init__.py
|   |   |   ├── async_checks.py
|   |   |   ├── caches.py
|   |   |   ├── compatibility
|   |   |   |   └── __init__.py
|   |   |   ├── database.py
|   |   |   ├── messages.py
|   |   |   ├── model_checks.py
|   |   |   ├── registry.py
|   |   |   ├── security
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── csrf.py
|   |   |   |   └── sessions.py
|   |   |   ├── templates.py
|   |   |   ├── translation.py
|   |   |   └── urls.py
|   |   ├── exceptions.py
|   |   ├── files
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── images.py
|   |   |   ├── locks.py
|   |   |   ├── move.py
|   |   |   ├── storage.py
|   |   |   ├── temp.py
|   |   |   ├── uploadedfile.py
|   |   |   ├── uploadhandler.py
|   |   |   └── utils.py
|   |   ├── handlers
|   |   |   ├── __init__.py
|   |   |   ├── asgi.py
|   |   |   ├── base.py
|   |   |   ├── exception.py
|   |   |   └── wsgi.py
|   |   ├── mail
|   |   |   ├── __init__.py
|   |   |   ├── backends
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── console.py
|   |   |   |   ├── dummy.py
|   |   |   |   ├── filebased.py
|   |   |   |   ├── locmem.py
|   |   |   |   └── smtp.py
|   |   |   ├── message.py
|   |   |   └── utils.py
|   |   ├── management
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── color.py
|   |   |   ├── commands
|   |   |   |   ├── check.py
|   |   |   |   ├── compilemessages.py
|   |   |   |   ├── createcachetable.py
|   |   |   |   ├── dbshell.py
|   |   |   |   ├── diffsettings.py
|   |   |   |   ├── dumpdata.py
|   |   |   |   ├── flush.py
|   |   |   |   ├── inspectdb.py
|   |   |   |   ├── loaddata.py
|   |   |   |   ├── makemessages.py
|   |   |   |   ├── makemigrations.py
|   |   |   |   ├── migrate.py
|   |   |   |   ├── runserver.py
|   |   |   |   ├── sendtestemail.py
|   |   |   |   ├── shell.py
|   |   |   |   ├── showmigrations.py
|   |   |   |   ├── sqlflush.py
|   |   |   |   ├── sqlmigrate.py
|   |   |   |   ├── sqlsequencereset.py
|   |   |   |   ├── squashmigrations.py
|   |   |   |   ├── startapp.py
|   |   |   |   ├── startproject.py
|   |   |   |   ├── test.py
|   |   |   |   └── testserver.py
|   |   |   ├── sql.py
|   |   |   ├── templates.py
|   |   |   └── utils.py
|   |   ├── paginator.py
|   |   ├── serializers
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── json.py
|   |   |   ├── python.py
|   |   |   ├── pyyaml.py
|   |   |   └── xml_serializer.py
|   |   ├── servers
|   |   |   ├── __init__.py
|   |   |   └── basehttp.py
|   |   ├── signals.py
|   |   ├── signing.py
|   |   ├── validators.py
|   |   └── wsgi.py
|   ├── db
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── ddl_references.py
|   |   |   ├── dummy
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   └── features.py
|   |   |   ├── mysql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   └── validation.py
|   |   |   ├── oracle
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── functions.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   ├── schema.py
|   |   |   |   ├── utils.py
|   |   |   |   └── validation.py
|   |   |   ├── postgresql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   ├── signals.py
|   |   |   ├── sqlite3
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── client.py
|   |   |   |   ├── creation.py
|   |   |   |   ├── features.py
|   |   |   |   ├── introspection.py
|   |   |   |   ├── operations.py
|   |   |   |   └── schema.py
|   |   |   └── utils.py
|   |   ├── migrations
|   |   |   ├── __init__.py
|   |   |   ├── autodetector.py
|   |   |   ├── exceptions.py
|   |   |   ├── executor.py
|   |   |   ├── graph.py
|   |   |   ├── loader.py
|   |   |   ├── migration.py
|   |   |   ├── operations
|   |   |   |   ├── __init__.py
|   |   |   |   ├── base.py
|   |   |   |   ├── fields.py
|   |   |   |   ├── models.py
|   |   |   |   ├── special.py
|   |   |   |   └── utils.py
|   |   |   ├── optimizer.py
|   |   |   ├── questioner.py
|   |   |   ├── recorder.py
|   |   |   ├── serializer.py
|   |   |   ├── state.py
|   |   |   ├── utils.py
|   |   |   └── writer.py
|   |   ├── models
|   |   |   ├── __init__.py
|   |   |   ├── aggregates.py
|   |   |   ├── base.py
|   |   |   ├── constants.py
|   |   |   ├── constraints.py
|   |   |   ├── deletion.py
|   |   |   ├── enums.py
|   |   |   ├── expressions.py
|   |   |   ├── fields
|   |   |   |   ├── __init__.py
|   |   |   |   ├── files.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── proxy.py
|   |   |   |   ├── related.py
|   |   |   |   ├── related_descriptors.py
|   |   |   |   ├── related_lookups.py
|   |   |   |   └── reverse_related.py
|   |   |   ├── functions
|   |   |   |   ├── __init__.py
|   |   |   |   ├── comparison.py
|   |   |   |   ├── datetime.py
|   |   |   |   ├── math.py
|   |   |   |   ├── mixins.py
|   |   |   |   ├── text.py
|   |   |   |   └── window.py
|   |   |   ├── indexes.py
|   |   |   ├── lookups.py
|   |   |   ├── manager.py
|   |   |   ├── options.py
|   |   |   ├── query.py
|   |   |   ├── query_utils.py
|   |   |   ├── signals.py
|   |   |   ├── sql
|   |   |   |   ├── __init__.py
|   |   |   |   ├── compiler.py
|   |   |   |   ├── constants.py
|   |   |   |   ├── datastructures.py
|   |   |   |   ├── query.py
|   |   |   |   ├── subqueries.py
|   |   |   |   └── where.py
|   |   |   └── utils.py
|   |   ├── transaction.py
|   |   └── utils.py
|   ├── dispatch
|   |   ├── __init__.py
|   |   ├── dispatcher.py
|   |   └── license.txt
|   ├── forms
|   |   ├── __init__.py
|   |   ├── boundfield.py
|   |   ├── fields.py
|   |   ├── forms.py
|   |   ├── formsets.py
|   |   ├── jinja2
|   |   |   └── django
|   |   |       └── forms
|   |   ├── models.py
|   |   ├── renderers.py
|   |   ├── templates
|   |   |   └── django
|   |   |       └── forms
|   |   ├── utils.py
|   |   └── widgets.py
|   ├── http
|   |   ├── __init__.py
|   |   ├── cookie.py
|   |   ├── multipartparser.py
|   |   ├── request.py
|   |   └── response.py
|   ├── middleware
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── clickjacking.py
|   |   ├── common.py
|   |   ├── csrf.py
|   |   ├── gzip.py
|   |   ├── http.py
|   |   ├── locale.py
|   |   └── security.py
|   ├── shortcuts.py
|   ├── template
|   |   ├── __init__.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── base.py
|   |   |   ├── django.py
|   |   |   ├── dummy.py
|   |   |   ├── jinja2.py
|   |   |   └── utils.py
|   |   ├── base.py
|   |   ├── context.py
|   |   ├── context_processors.py
|   |   ├── defaultfilters.py
|   |   ├── defaulttags.py
|   |   ├── engine.py
|   |   ├── exceptions.py
|   |   ├── library.py
|   |   ├── loader.py
|   |   ├── loader_tags.py
|   |   ├── loaders
|   |   |   ├── __init__.py
|   |   |   ├── app_directories.py
|   |   |   ├── base.py
|   |   |   ├── cached.py
|   |   |   ├── filesystem.py
|   |   |   └── locmem.py
|   |   ├── response.py
|   |   ├── smartif.py
|   |   └── utils.py
|   ├── templatetags
|   |   ├── __init__.py
|   |   ├── cache.py
|   |   ├── i18n.py
|   |   ├── l10n.py
|   |   ├── static.py
|   |   └── tz.py
|   ├── test
|   |   ├── __init__.py
|   |   ├── client.py
|   |   ├── html.py
|   |   ├── runner.py
|   |   ├── selenium.py
|   |   ├── signals.py
|   |   ├── testcases.py
|   |   └── utils.py
|   ├── urls
|   |   ├── __init__.py
|   |   ├── base.py
|   |   ├── conf.py
|   |   ├── converters.py
|   |   ├── exceptions.py
|   |   ├── resolvers.py
|   |   └── utils.py
|   ├── utils
|   |   ├── __init__.py
|   |   ├── _os.py
|   |   ├── archive.py
|   |   ├── asyncio.py
|   |   ├── autoreload.py
|   |   ├── baseconv.py
|   |   ├── cache.py
|   |   ├── crypto.py
|   |   ├── datastructures.py
|   |   ├── dateformat.py
|   |   ├── dateparse.py
|   |   ├── dates.py
|   |   ├── datetime_safe.py
|   |   ├── deconstruct.py
|   |   ├── decorators.py
|   |   ├── deprecation.py
|   |   ├── duration.py
|   |   ├── encoding.py
|   |   ├── feedgenerator.py
|   |   ├── formats.py
|   |   ├── functional.py
|   |   ├── hashable.py
|   |   ├── html.py
|   |   ├── http.py
|   |   ├── inspect.py
|   |   ├── ipv6.py
|   |   ├── itercompat.py
|   |   ├── jslex.py
|   |   ├── log.py
|   |   ├── lorem_ipsum.py
|   |   ├── module_loading.py
|   |   ├── numberformat.py
|   |   ├── regex_helper.py
|   |   ├── safestring.py
|   |   ├── termcolors.py
|   |   ├── text.py
|   |   ├── timesince.py
|   |   ├── timezone.py
|   |   ├── topological_sort.py
|   |   ├── translation
|   |   |   ├── __init__.py
|   |   |   ├── reloader.py
|   |   |   ├── template.py
|   |   |   ├── trans_null.py
|   |   |   └── trans_real.py
|   |   ├── tree.py
|   |   ├── version.py
|   |   └── xmlutils.py
|   └── views
|       ├── __init__.py
|       ├── csrf.py
|       ├── debug.py
|       ├── decorators
|       |   ├── __init__.py
|       |   ├── cache.py
|       |   ├── clickjacking.py
|       |   ├── csrf.py
|       |   ├── debug.py
|       |   ├── gzip.py
|       |   ├── http.py
|       |   └── vary.py
|       ├── defaults.py
|       ├── generic
|       |   ├── __init__.py
|       |   ├── base.py
|       |   ├── dates.py
|       |   ├── detail.py
|       |   ├── edit.py
|       |   └── list.py
|       ├── i18n.py
|       ├── static.py
|       └── templates
|           └── technical_500.txt
├── docs
|   ├── README.rst
|   ├── _ext
|   |   └── djangodocs.py
|   ├── _theme
|   |   ├── djangodocs
|   |   |   └── static
|   |   |       └── fontawesome
|   |   └── djangodocs-epub
|   |       └── static
|   ├── conf.py
|   ├── contents.txt
|   ├── faq
|   |   ├── admin.txt
|   |   ├── contributing.txt
|   |   ├── general.txt
|   |   ├── help.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── models.txt
|   |   ├── troubleshooting.txt
|   |   └── usage.txt
|   ├── glossary.txt
|   ├── howto
|   |   ├── auth-remote-user.txt
|   |   ├── custom-file-storage.txt
|   |   ├── custom-lookups.txt
|   |   ├── custom-management-commands.txt
|   |   ├── custom-model-fields.txt
|   |   ├── custom-template-tags.txt
|   |   ├── deployment
|   |   |   ├── asgi
|   |   |   |   ├── daphne.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── uvicorn.txt
|   |   |   ├── checklist.txt
|   |   |   ├── index.txt
|   |   |   └── wsgi
|   |   |       ├── apache-auth.txt
|   |   |       ├── gunicorn.txt
|   |   |       ├── index.txt
|   |   |       ├── modwsgi.txt
|   |   |       └── uwsgi.txt
|   |   ├── error-reporting.txt
|   |   ├── index.txt
|   |   ├── initial-data.txt
|   |   ├── legacy-databases.txt
|   |   ├── outputting-csv.txt
|   |   ├── outputting-pdf.txt
|   |   ├── overriding-templates.txt
|   |   ├── static-files
|   |   |   ├── deployment.txt
|   |   |   └── index.txt
|   |   ├── upgrade-version.txt
|   |   ├── windows.txt
|   |   └── writing-migrations.txt
|   ├── index.txt
|   ├── internals
|   |   ├── _images
|   |   ├── contributing
|   |   |   ├── bugs-and-features.txt
|   |   |   ├── committing-code.txt
|   |   |   ├── index.txt
|   |   |   ├── localizing.txt
|   |   |   ├── new-contributors.txt
|   |   |   ├── triaging-tickets.txt
|   |   |   ├── writing-code
|   |   |   |   ├── coding-style.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── javascript.txt
|   |   |   |   ├── submitting-patches.txt
|   |   |   |   ├── unit-tests.txt
|   |   |   |   └── working-with-git.txt
|   |   |   └── writing-documentation.txt
|   |   ├── deprecation.txt
|   |   ├── git.txt
|   |   ├── howto-release-django.txt
|   |   ├── index.txt
|   |   ├── mailing-lists.txt
|   |   ├── organization.txt
|   |   ├── release-process.txt
|   |   └── security.txt
|   ├── intro
|   |   ├── _images
|   |   ├── contributing.txt
|   |   ├── index.txt
|   |   ├── install.txt
|   |   ├── overview.txt
|   |   ├── reusable-apps.txt
|   |   ├── tutorial01.txt
|   |   ├── tutorial02.txt
|   |   ├── tutorial03.txt
|   |   ├── tutorial04.txt
|   |   ├── tutorial05.txt
|   |   ├── tutorial06.txt
|   |   ├── tutorial07.txt
|   |   └── whatsnext.txt
|   ├── man
|   ├── misc
|   |   ├── api-stability.txt
|   |   ├── design-philosophies.txt
|   |   ├── distributions.txt
|   |   └── index.txt
|   ├── ref
|   |   ├── applications.txt
|   |   ├── checks.txt
|   |   ├── class-based-views
|   |   |   ├── base.txt
|   |   |   ├── flattened-index.txt
|   |   |   ├── generic-date-based.txt
|   |   |   ├── generic-display.txt
|   |   |   ├── generic-editing.txt
|   |   |   ├── index.txt
|   |   |   ├── mixins-date-based.txt
|   |   |   ├── mixins-editing.txt
|   |   |   ├── mixins-multiple-object.txt
|   |   |   ├── mixins-simple.txt
|   |   |   ├── mixins-single-object.txt
|   |   |   └── mixins.txt
|   |   ├── clickjacking.txt
|   |   ├── contrib
|   |   |   ├── admin
|   |   |   |   ├── _images
|   |   |   |   ├── actions.txt
|   |   |   |   ├── admindocs.txt
|   |   |   |   ├── index.txt
|   |   |   |   └── javascript.txt
|   |   |   ├── auth.txt
|   |   |   ├── contenttypes.txt
|   |   |   ├── flatpages.txt
|   |   |   ├── gis
|   |   |   |   ├── admin.txt
|   |   |   |   ├── commands.txt
|   |   |   |   ├── db-api.txt
|   |   |   |   ├── deployment.txt
|   |   |   |   ├── feeds.txt
|   |   |   |   ├── forms-api.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── gdal.txt
|   |   |   |   ├── geoip2.txt
|   |   |   |   ├── geoquerysets.txt
|   |   |   |   ├── geos.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── install
|   |   |   |   ├── layermapping.txt
|   |   |   |   ├── measure.txt
|   |   |   |   ├── model-api.txt
|   |   |   |   ├── ogrinspect.txt
|   |   |   |   ├── serializers.txt
|   |   |   |   ├── sitemaps.txt
|   |   |   |   ├── testing.txt
|   |   |   |   ├── tutorial.txt
|   |   |   |   └── utils.txt
|   |   |   ├── humanize.txt
|   |   |   ├── index.txt
|   |   |   ├── messages.txt
|   |   |   ├── postgres
|   |   |   |   ├── aggregates.txt
|   |   |   |   ├── constraints.txt
|   |   |   |   ├── fields.txt
|   |   |   |   ├── forms.txt
|   |   |   |   ├── functions.txt
|   |   |   |   ├── index.txt
|   |   |   |   ├── indexes.txt
|   |   |   |   ├── lookups.txt
|   |   |   |   ├── operations.txt
|   |   |   |   ├── search.txt
|   |   |   |   └── validators.txt
|   |   |   ├── redirects.txt
|   |   |   ├── sitemaps.txt
|   |   |   ├── sites.txt
|   |   |   ├── staticfiles.txt
|   |   |   └── syndication.txt
|   |   ├── csrf.txt
|   |   ├── databases.txt
|   |   ├── django-admin.txt
|   |   ├── exceptions.txt
|   |   ├── files
|   |   |   ├── file.txt
|   |   |   ├── index.txt
|   |   |   ├── storage.txt
|   |   |   └── uploads.txt
|   |   ├── forms
|   |   |   ├── api.txt
|   |   |   ├── fields.txt
|   |   |   ├── formsets.txt
|   |   |   ├── index.txt
|   |   |   ├── models.txt
|   |   |   ├── renderers.txt
|   |   |   ├── validation.txt
|   |   |   └── widgets.txt
|   |   ├── index.txt
|   |   ├── middleware.txt
|   |   ├── migration-operations.txt
|   |   ├── models
|   |   |   ├── class.txt
|   |   |   ├── conditional-expressions.txt
|   |   |   ├── constraints.txt
|   |   |   ├── database-functions.txt
|   |   |   ├── expressions.txt
|   |   |   ├── fields.txt
|   |   |   ├── index.txt
|   |   |   ├── indexes.txt
|   |   |   ├── instances.txt
|   |   |   ├── lookups.txt
|   |   |   ├── meta.txt
|   |   |   ├── options.txt
|   |   |   ├── querysets.txt
|   |   |   └── relations.txt
|   |   ├── paginator.txt
|   |   ├── request-response.txt
|   |   ├── schema-editor.txt
|   |   ├── settings.txt
|   |   ├── signals.txt
|   |   ├── template-response.txt
|   |   ├── templates
|   |   |   ├── api.txt
|   |   |   ├── builtins.txt
|   |   |   ├── index.txt
|   |   |   └── language.txt
|   |   ├── unicode.txt
|   |   ├── urlresolvers.txt
|   |   ├── urls.txt
|   |   ├── utils.txt
|   |   ├── validators.txt
|   |   └── views.txt
|   ├── releases
|   |   ├── 0.95.txt
|   |   ├── 0.96.txt
|   |   ├── 1.0-porting-guide.txt
|   |   ├── 1.0.1.txt
|   |   ├── 1.0.2.txt
|   |   ├── 1.0.txt
|   |   ├── 1.1.2.txt
|   |   ├── 1.1.3.txt
|   |   ├── 1.1.4.txt
|   |   ├── 1.1.txt
|   |   ├── 1.10.1.txt
|   |   ├── 1.10.2.txt
|   |   ├── 1.10.3.txt
|   |   ├── 1.10.4.txt
|   |   ├── 1.10.5.txt
|   |   ├── 1.10.6.txt
|   |   ├── 1.10.7.txt
|   |   ├── 1.10.8.txt
|   |   ├── 1.10.txt
|   |   ├── 1.11.1.txt
|   |   ├── 1.11.10.txt
|   |   ├── 1.11.11.txt
|   |   ├── 1.11.12.txt
|   |   ├── 1.11.13.txt
|   |   ├── 1.11.14.txt
|   |   ├── 1.11.15.txt
|   |   ├── 1.11.16.txt
|   |   ├── 1.11.17.txt
|   |   ├── 1.11.18.txt
|   |   ├── 1.11.19.txt
|   |   ├── 1.11.2.txt
|   |   ├── 1.11.20.txt
|   |   ├── 1.11.21.txt
|   |   ├── 1.11.22.txt
|   |   ├── 1.11.23.txt
|   |   ├── 1.11.24.txt
|   |   ├── 1.11.25.txt
|   |   ├── 1.11.26.txt
|   |   ├── 1.11.27.txt
|   |   ├── 1.11.28.txt
|   |   ├── 1.11.29.txt
|   |   ├── 1.11.3.txt
|   |   ├── 1.11.4.txt
|   |   ├── 1.11.5.txt
|   |   ├── 1.11.6.txt
|   |   ├── 1.11.7.txt
|   |   ├── 1.11.8.txt
|   |   ├── 1.11.9.txt
|   |   ├── 1.11.txt
|   |   ├── 1.2.1.txt
|   |   ├── 1.2.2.txt
|   |   ├── 1.2.3.txt
|   |   ├── 1.2.4.txt
|   |   ├── 1.2.5.txt
|   |   ├── 1.2.6.txt
|   |   ├── 1.2.7.txt
|   |   ├── 1.2.txt
|   |   ├── 1.3.1.txt
|   |   ├── 1.3.2.txt
|   |   ├── 1.3.3.txt
|   |   ├── 1.3.4.txt
|   |   ├── 1.3.5.txt
|   |   ├── 1.3.6.txt
|   |   ├── 1.3.7.txt
|   |   ├── 1.3.txt
|   |   ├── 1.4.1.txt
|   |   ├── 1.4.10.txt
|   |   ├── 1.4.11.txt
|   |   ├── 1.4.12.txt
|   |   ├── 1.4.13.txt
|   |   ├── 1.4.14.txt
|   |   ├── 1.4.15.txt
|   |   ├── 1.4.16.txt
|   |   ├── 1.4.17.txt
|   |   ├── 1.4.18.txt
|   |   ├── 1.4.19.txt
|   |   ├── 1.4.2.txt
|   |   ├── 1.4.20.txt
|   |   ├── 1.4.21.txt
|   |   ├── 1.4.22.txt
|   |   ├── 1.4.3.txt
|   |   ├── 1.4.4.txt
|   |   ├── 1.4.5.txt
|   |   ├── 1.4.6.txt
|   |   ├── 1.4.7.txt
|   |   ├── 1.4.8.txt
|   |   ├── 1.4.9.txt
|   |   ├── 1.4.txt
|   |   ├── 1.5.1.txt
|   |   ├── 1.5.10.txt
|   |   ├── 1.5.11.txt
|   |   ├── 1.5.12.txt
|   |   ├── 1.5.2.txt
|   |   ├── 1.5.3.txt
|   |   ├── 1.5.4.txt
|   |   ├── 1.5.5.txt
|   |   ├── 1.5.6.txt
|   |   ├── 1.5.7.txt
|   |   ├── 1.5.8.txt
|   |   ├── 1.5.9.txt
|   |   ├── 1.5.txt
|   |   ├── 1.6.1.txt
|   |   ├── 1.6.10.txt
|   |   ├── 1.6.11.txt
|   |   ├── 1.6.2.txt
|   |   ├── 1.6.3.txt
|   |   ├── 1.6.4.txt
|   |   ├── 1.6.5.txt
|   |   ├── 1.6.6.txt
|   |   ├── 1.6.7.txt
|   |   ├── 1.6.8.txt
|   |   ├── 1.6.9.txt
|   |   ├── 1.6.txt
|   |   ├── 1.7.1.txt
|   |   ├── 1.7.10.txt
|   |   ├── 1.7.11.txt
|   |   ├── 1.7.2.txt
|   |   ├── 1.7.3.txt
|   |   ├── 1.7.4.txt
|   |   ├── 1.7.5.txt
|   |   ├── 1.7.6.txt
|   |   ├── 1.7.7.txt
|   |   ├── 1.7.8.txt
|   |   ├── 1.7.9.txt
|   |   ├── 1.7.txt
|   |   ├── 1.8.1.txt
|   |   ├── 1.8.10.txt
|   |   ├── 1.8.11.txt
|   |   ├── 1.8.12.txt
|   |   ├── 1.8.13.txt
|   |   ├── 1.8.14.txt
|   |   ├── 1.8.15.txt
|   |   ├── 1.8.16.txt
|   |   ├── 1.8.17.txt
|   |   ├── 1.8.18.txt
|   |   ├── 1.8.19.txt
|   |   ├── 1.8.2.txt
|   |   ├── 1.8.3.txt
|   |   ├── 1.8.4.txt
|   |   ├── 1.8.5.txt
|   |   ├── 1.8.6.txt
|   |   ├── 1.8.7.txt
|   |   ├── 1.8.8.txt
|   |   ├── 1.8.9.txt
|   |   ├── 1.8.txt
|   |   ├── 1.9.1.txt
|   |   ├── 1.9.10.txt
|   |   ├── 1.9.11.txt
|   |   ├── 1.9.12.txt
|   |   ├── 1.9.13.txt
|   |   ├── 1.9.2.txt
|   |   ├── 1.9.3.txt
|   |   ├── 1.9.4.txt
|   |   ├── 1.9.5.txt
|   |   ├── 1.9.6.txt
|   |   ├── 1.9.7.txt
|   |   ├── 1.9.8.txt
|   |   ├── 1.9.9.txt
|   |   ├── 1.9.txt
|   |   ├── 2.0.1.txt
|   |   ├── 2.0.10.txt
|   |   ├── 2.0.11.txt
|   |   ├── 2.0.12.txt
|   |   ├── 2.0.13.txt
|   |   ├── 2.0.2.txt
|   |   ├── 2.0.3.txt
|   |   ├── 2.0.4.txt
|   |   ├── 2.0.5.txt
|   |   ├── 2.0.6.txt
|   |   ├── 2.0.7.txt
|   |   ├── 2.0.8.txt
|   |   ├── 2.0.9.txt
|   |   ├── 2.0.txt
|   |   ├── 2.1.1.txt
|   |   ├── 2.1.10.txt
|   |   ├── 2.1.11.txt
|   |   ├── 2.1.12.txt
|   |   ├── 2.1.13.txt
|   |   ├── 2.1.14.txt
|   |   ├── 2.1.15.txt
|   |   ├── 2.1.2.txt
|   |   ├── 2.1.3.txt
|   |   ├── 2.1.4.txt
|   |   ├── 2.1.5.txt
|   |   ├── 2.1.6.txt
|   |   ├── 2.1.7.txt
|   |   ├── 2.1.8.txt
|   |   ├── 2.1.9.txt
|   |   ├── 2.1.txt
|   |   ├── 2.2.1.txt
|   |   ├── 2.2.10.txt
|   |   ├── 2.2.11.txt
|   |   ├── 2.2.12.txt
|   |   ├── 2.2.2.txt
|   |   ├── 2.2.3.txt
|   |   ├── 2.2.4.txt
|   |   ├── 2.2.5.txt
|   |   ├── 2.2.6.txt
|   |   ├── 2.2.7.txt
|   |   ├── 2.2.8.txt
|   |   ├── 2.2.9.txt
|   |   ├── 2.2.txt
|   |   ├── 3.0.1.txt
|   |   ├── 3.0.2.txt
|   |   ├── 3.0.3.txt
|   |   ├── 3.0.4.txt
|   |   ├── 3.0.5.txt
|   |   ├── 3.0.6.txt
|   |   ├── 3.0.txt
|   |   ├── 3.1.txt
|   |   ├── index.txt
|   |   └── security.txt
|   └── topics
|       ├── _images
|       ├── async.txt
|       ├── auth
|       |   ├── customizing.txt
|       |   ├── default.txt
|       |   ├── index.txt
|       |   └── passwords.txt
|       ├── cache.txt
|       ├── checks.txt
|       ├── class-based-views
|       |   ├── generic-display.txt
|       |   ├── generic-editing.txt
|       |   ├── index.txt
|       |   ├── intro.txt
|       |   └── mixins.txt
|       ├── conditional-view-processing.txt
|       ├── db
|       |   ├── aggregation.txt
|       |   ├── examples
|       |   |   ├── index.txt
|       |   |   ├── many_to_many.txt
|       |   |   ├── many_to_one.txt
|       |   |   └── one_to_one.txt
|       |   ├── index.txt
|       |   ├── instrumentation.txt
|       |   ├── managers.txt
|       |   ├── models.txt
|       |   ├── multi-db.txt
|       |   ├── optimization.txt
|       |   ├── queries.txt
|       |   ├── search.txt
|       |   ├── sql.txt
|       |   ├── tablespaces.txt
|       |   └── transactions.txt
|       ├── email.txt
|       ├── external-packages.txt
|       ├── files.txt
|       ├── forms
|       |   ├── formsets.txt
|       |   ├── index.txt
|       |   ├── media.txt
|       |   └── modelforms.txt
|       ├── http
|       |   ├── _images
|       |   ├── decorators.txt
|       |   ├── file-uploads.txt
|       |   ├── generic-views.txt
|       |   ├── index.txt
|       |   ├── middleware.txt
|       |   ├── sessions.txt
|       |   ├── shortcuts.txt
|       |   ├── urls.txt
|       |   └── views.txt
|       ├── i18n
|       |   ├── formatting.txt
|       |   ├── index.txt
|       |   ├── timezones.txt
|       |   └── translation.txt
|       ├── index.txt
|       ├── install.txt
|       ├── logging.txt
|       ├── migrations.txt
|       ├── pagination.txt
|       ├── performance.txt
|       ├── security.txt
|       ├── serialization.txt
|       ├── settings.txt
|       ├── signals.txt
|       ├── signing.txt
|       ├── templates.txt
|       └── testing
|           ├── _images
|           ├── advanced.txt
|           ├── index.txt
|           ├── overview.txt
|           └── tools.txt
├── extras
├── js_tests
|   ├── admin
|   |   ├── DateTimeShortcuts.test.js
|   |   ├── SelectBox.test.js
|   |   ├── SelectFilter2.test.js
|   |   ├── URLify.test.js
|   |   ├── actions.test.js
|   |   ├── core.test.js
|   |   ├── inlines.test.js
|   |   └── jsi18n-mocks.test.js
|   └── gis
|       └── mapwidget.test.js
├── scripts
|   ├── manage_translations.py
|   └── rpm-install.sh
├── setup.py
└── tests
    ├── README.rst
    ├── absolute_url_overrides
    |   ├── __init__.py
    |   └── tests.py
    ├── admin_autodiscover
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_changelist
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_date_hierarchy.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_checks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_custom_urls
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_default_site
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── sites.py
    |   └── tests.py
    ├── admin_docs
    |   ├── __init__.py
    |   ├── evilfile.txt
    |   ├── models.py
    |   ├── namespace_urls.py
    |   ├── test_middleware.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_filters
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_inlines
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_templates.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_registration
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── admin_scripts
    |   ├── __init__.py
    |   ├── another_app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_raising_messages
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_raising_warning
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app_waiting_migration
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── models.py
    |   ├── app_with_import
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── broken_app
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── complex_app
    |   |   ├── __init__.py
    |   |   ├── admin
    |   |   |   ├── __init__.py
    |   |   |   └── foo.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models
    |   |       ├── __init__.py
    |   |       ├── bar.py
    |   |       └── foo.py
    |   ├── configured_dynamic_settings_manage.py
    |   ├── configured_settings_manage.py
    |   ├── custom_templates
    |   |   ├── app_template
    |   |   |   ├── __init__.py
    |   |   |   └── api.py
    |   |   └── project_template
    |   |       ├── additional_dir
    |   |       ├── project_name
    |   |       └── ticket-18091-non-ascii-template.txt
    |   ├── management
    |   |   └── commands
    |   |       ├── app_command.py
    |   |       ├── base_command.py
    |   |       ├── custom_startproject.py
    |   |       ├── label_command.py
    |   |       └── noargs_command.py
    |   ├── simple_app
    |   |   ├── __init__.py
    |   |   ├── management
    |   |   |   └── commands
    |   |   └── models.py
    |   ├── test_django_admin_py.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_utils
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── test_logentry.py
    |   ├── tests.py
    |   └── urls.py
    ├── admin_views
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── custom_has_permission_admin.py
    |   ├── customadmin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── templates
    |   |   └── admin
    |   |       └── admin_views
    |   ├── test_actions.py
    |   ├── test_adminsite.py
    |   ├── test_autocomplete_view.py
    |   ├── test_forms.py
    |   ├── test_history_view.py
    |   ├── test_multidb.py
    |   ├── test_templatetags.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── admin_widgets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autocomplete_widget.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── widgetadmin.py
    ├── aggregation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_filter_argument.py
    |   └── tests.py
    ├── aggregation_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── annotations
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── app_loading
    |   ├── __init__.py
    |   ├── eggs
    |   ├── not_installed
    |   |   ├── __init__.py
    |   |   └── models.py
    |   └── tests.py
    ├── apps
    |   ├── __init__.py
    |   ├── apps.py
    |   ├── default_config_app
    |   |   ├── __init__.py
    |   |   └── apps.py
    |   ├── models.py
    |   ├── namespace_package_base
    |   |   └── nsapp
    |   |       └── apps.py
    |   ├── namespace_package_other_base
    |   |   └── nsapp
    |   └── tests.py
    ├── asgi
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── async
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── auth_tests
    |   ├── __init__.py
    |   ├── backend_alias.py
    |   ├── client.py
    |   ├── common-passwords-custom.txt
    |   ├── fixtures
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── custom_permissions.py
    |   |   ├── custom_user.py
    |   |   ├── invalid_models.py
    |   |   ├── is_active.py
    |   |   ├── minimal.py
    |   |   ├── no_password.py
    |   |   ├── proxy.py
    |   |   ├── uuid_pk.py
    |   |   ├── with_custom_email_field.py
    |   |   ├── with_foreign_key.py
    |   |   ├── with_integer_username.py
    |   |   ├── with_last_login_attr.py
    |   |   └── with_many_to_many.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── context_processors
    |   |   └── registration
    |   |       └── password_reset_subject.txt
    |   ├── test_admin_multidb.py
    |   ├── test_auth_backends.py
    |   ├── test_basic.py
    |   ├── test_checks.py
    |   ├── test_context_processors.py
    |   ├── test_decorators.py
    |   ├── test_forms.py
    |   ├── test_handlers.py
    |   ├── test_hashers.py
    |   ├── test_management.py
    |   ├── test_middleware.py
    |   ├── test_migrations.py
    |   ├── test_mixins.py
    |   ├── test_models.py
    |   ├── test_password_reset_timeout_days.py
    |   ├── test_remote_user.py
    |   ├── test_signals.py
    |   ├── test_templates.py
    |   ├── test_tokens.py
    |   ├── test_validators.py
    |   ├── test_views.py
    |   ├── urls.py
    |   ├── urls_admin.py
    |   └── urls_custom_user_admin.py
    ├── backends
    |   ├── __init__.py
    |   ├── base
    |   |   ├── __init__.py
    |   |   ├── test_base.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── test_schema.py
    |   ├── models.py
    |   ├── mysql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_features.py
    |   |   ├── test_introspection.py
    |   |   ├── test_schema.py
    |   |   └── tests.py
    |   ├── oracle
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_operations.py
    |   |   └── tests.py
    |   ├── postgresql
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   ├── test_server_side_cursors.py
    |   |   └── tests.py
    |   ├── sqlite
    |   |   ├── __init__.py
    |   |   ├── test_creation.py
    |   |   ├── test_introspection.py
    |   |   └── tests.py
    |   ├── test_ddl_references.py
    |   ├── test_utils.py
    |   └── tests.py
    ├── base
    |   ├── __init__.py
    |   └── models.py
    ├── bash_completion
    |   ├── __init__.py
    |   ├── management
    |   |   └── commands
    |   |       └── test_command.py
    |   └── tests.py
    ├── basic
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── builtin_server
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── bulk_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── cache
    |   ├── __init__.py
    |   ├── closeable_cache.py
    |   ├── liberal_backend.py
    |   ├── models.py
    |   └── tests.py
    ├── check_framework
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_async_checks.py
    |   ├── test_caches.py
    |   ├── test_database.py
    |   ├── test_model_checks.py
    |   ├── test_model_field_deprecation.py
    |   ├── test_multi_db.py
    |   ├── test_security.py
    |   ├── test_templates.py
    |   ├── test_translation.py
    |   ├── test_urls.py
    |   ├── tests.py
    |   └── urls
    |       ├── __init__.py
    |       ├── bad_error_handlers.py
    |       ├── bad_error_handlers_invalid_path.py
    |       ├── beginning_with_slash.py
    |       ├── contains_tuple.py
    |       ├── good_error_handlers.py
    |       ├── include_contains_tuple.py
    |       ├── include_with_dollar.py
    |       ├── name_with_colon.py
    |       ├── no_warnings.py
    |       ├── no_warnings_i18n.py
    |       ├── non_unique_namespaces.py
    |       ├── path_compatibility
    |       |   ├── __init__.py
    |       |   ├── beginning_with_caret.py
    |       |   ├── contains_re_named_group.py
    |       |   └── ending_with_dollar.py
    |       ├── unique_namespaces.py
    |       └── warning_in_include.py
    ├── conditional_processing
    |   ├── __init__.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── constraints
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── contenttypes_tests
    |   ├── __init__.py
    |   ├── models.py
    |   ├── operations_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_rename_foo.py
    |   |   └── __init__.py
    |   ├── test_checks.py
    |   ├── test_fields.py
    |   ├── test_management.py
    |   ├── test_models.py
    |   ├── test_operations.py
    |   ├── test_order_with_respect_to.py
    |   ├── test_views.py
    |   └── urls.py
    ├── context_processors
    |   ├── __init__.py
    |   ├── models.py
    |   ├── templates
    |   |   └── context_processors
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── csrf_tests
    |   ├── __init__.py
    |   ├── csrf_token_error_handler_urls.py
    |   ├── test_context_processor.py
    |   ├── tests.py
    |   └── views.py
    ├── custom_columns
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_managers
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_methods
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── custom_migration_operations
    |   ├── __init__.py
    |   ├── more_operations.py
    |   └── operations.py
    ├── custom_pk
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   └── tests.py
    ├── datatypes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── dates
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── datetimes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── db_functions
    |   ├── __init__.py
    |   ├── comparison
    |   |   ├── __init__.py
    |   |   ├── test_cast.py
    |   |   ├── test_coalesce.py
    |   |   ├── test_greatest.py
    |   |   ├── test_least.py
    |   |   └── test_nullif.py
    |   ├── datetime
    |   |   ├── __init__.py
    |   |   ├── test_extract_trunc.py
    |   |   └── test_now.py
    |   ├── math
    |   |   ├── __init__.py
    |   |   ├── test_abs.py
    |   |   ├── test_acos.py
    |   |   ├── test_asin.py
    |   |   ├── test_atan.py
    |   |   ├── test_atan2.py
    |   |   ├── test_ceil.py
    |   |   ├── test_cos.py
    |   |   ├── test_cot.py
    |   |   ├── test_degrees.py
    |   |   ├── test_exp.py
    |   |   ├── test_floor.py
    |   |   ├── test_ln.py
    |   |   ├── test_log.py
    |   |   ├── test_mod.py
    |   |   ├── test_pi.py
    |   |   ├── test_power.py
    |   |   ├── test_radians.py
    |   |   ├── test_round.py
    |   |   ├── test_sign.py
    |   |   ├── test_sin.py
    |   |   ├── test_sqrt.py
    |   |   └── test_tan.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── text
    |   |   ├── __init__.py
    |   |   ├── test_chr.py
    |   |   ├── test_concat.py
    |   |   ├── test_left.py
    |   |   ├── test_length.py
    |   |   ├── test_lower.py
    |   |   ├── test_md5.py
    |   |   ├── test_ord.py
    |   |   ├── test_pad.py
    |   |   ├── test_repeat.py
    |   |   ├── test_replace.py
    |   |   ├── test_reverse.py
    |   |   ├── test_right.py
    |   |   ├── test_sha1.py
    |   |   ├── test_sha224.py
    |   |   ├── test_sha256.py
    |   |   ├── test_sha384.py
    |   |   ├── test_sha512.py
    |   |   ├── test_strindex.py
    |   |   ├── test_substr.py
    |   |   ├── test_trim.py
    |   |   └── test_upper.py
    |   └── window
    |       ├── __init__.py
    |       └── test_validation.py
    ├── db_typecasts
    |   ├── __init__.py
    |   └── tests.py
    ├── db_utils
    |   ├── __init__.py
    |   └── tests.py
    ├── dbshell
    |   ├── __init__.py
    |   ├── test_mysql.py
    |   ├── test_oracle.py
    |   ├── test_postgresql.py
    |   ├── test_sqlite.py
    |   └── tests.py
    ├── decorators
    |   ├── __init__.py
    |   └── tests.py
    ├── defer
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── defer_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── delete_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── deprecation
    |   ├── __init__.py
    |   ├── test_middleware_mixin.py
    |   └── tests.py
    ├── dispatch
    |   ├── __init__.py
    |   └── tests.py
    ├── distinct_on_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── empty
    |   ├── __init__.py
    |   ├── models.py
    |   ├── no_models
    |   |   └── __init__.py
    |   └── tests.py
    ├── empty_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── test_commands.py
    ├── expressions
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   ├── test_queryset_values.py
    |   └── tests.py
    ├── expressions_case
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── expressions_window
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── extra_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_deconstruction
    |   ├── __init__.py
    |   └── tests.py
    ├── field_defaults
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── field_subclassing
    |   ├── __init__.py
    |   ├── fields.py
    |   └── tests.py
    ├── file_storage
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_generate_filename.py
    |   ├── tests.py
    |   └── urls.py
    ├── file_uploads
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   ├── uploadhandler.py
    |   ├── urls.py
    |   └── views.py
    ├── files
    |   ├── __init__.py
    |   └── tests.py
    ├── filtered_relation
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── fixtures
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   └── tests.py
    ├── fixtures_model_package
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models
    |   |   └── __init__.py
    |   └── tests.py
    ├── fixtures_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── fixtures_1
    |   |   └── inner
    |   ├── fixtures_2
    |   ├── models.py
    |   └── tests.py
    ├── flatpages_tests
    |   ├── __init__.py
    |   ├── absolute_urls.py
    |   ├── no_slash_urls.py
    |   ├── settings.py
    |   ├── templates
    |   |   ├── flatpages
    |   |   └── registration
    |   ├── test_csrf.py
    |   ├── test_forms.py
    |   ├── test_middleware.py
    |   ├── test_models.py
    |   ├── test_sitemaps.py
    |   ├── test_templatetags.py
    |   ├── test_views.py
    |   └── urls.py
    ├── force_insert_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── foreign_object
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   ├── customers.py
    |   |   ├── empty_join.py
    |   |   └── person.py
    |   ├── test_agnostic_order_trimjoin.py
    |   ├── test_empty_join.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── forms_tests
    |   ├── __init__.py
    |   ├── field_tests
    |   |   ├── __init__.py
    |   |   ├── filepathfield_test_dir
    |   |   |   ├── __init__.py
    |   |   |   ├── a.py
    |   |   |   ├── ab.py
    |   |   |   ├── b.py
    |   |   |   ├── c
    |   |   |   ├── h
    |   |   |   └── j
    |   |   ├── test_base.py
    |   |   ├── test_booleanfield.py
    |   |   ├── test_charfield.py
    |   |   ├── test_choicefield.py
    |   |   ├── test_combofield.py
    |   |   ├── test_datefield.py
    |   |   ├── test_datetimefield.py
    |   |   ├── test_decimalfield.py
    |   |   ├── test_durationfield.py
    |   |   ├── test_emailfield.py
    |   |   ├── test_filefield.py
    |   |   ├── test_filepathfield.py
    |   |   ├── test_floatfield.py
    |   |   ├── test_genericipaddressfield.py
    |   |   ├── test_imagefield.py
    |   |   ├── test_integerfield.py
    |   |   ├── test_multiplechoicefield.py
    |   |   ├── test_multivaluefield.py
    |   |   ├── test_nullbooleanfield.py
    |   |   ├── test_regexfield.py
    |   |   ├── test_slugfield.py
    |   |   ├── test_splitdatetimefield.py
    |   |   ├── test_timefield.py
    |   |   ├── test_typedchoicefield.py
    |   |   ├── test_typedmultiplechoicefield.py
    |   |   ├── test_urlfield.py
    |   |   └── test_uuidfield.py
    |   ├── jinja2
    |   |   └── forms_tests
    |   ├── models.py
    |   ├── templates
    |   |   └── forms_tests
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── filepath_test_files
    |   |   |   ├── directory
    |   |   |   └── real-text-file.txt
    |   |   ├── test_error_messages.py
    |   |   ├── test_forms.py
    |   |   ├── test_formsets.py
    |   |   ├── test_i18n.py
    |   |   ├── test_input_formats.py
    |   |   ├── test_media.py
    |   |   ├── test_renderers.py
    |   |   ├── test_utils.py
    |   |   ├── test_validators.py
    |   |   ├── test_widgets.py
    |   |   └── tests.py
    |   ├── urls.py
    |   ├── views.py
    |   └── widget_tests
    |       ├── __init__.py
    |       ├── base.py
    |       ├── test_checkboxinput.py
    |       ├── test_checkboxselectmultiple.py
    |       ├── test_clearablefileinput.py
    |       ├── test_dateinput.py
    |       ├── test_datetimeinput.py
    |       ├── test_fileinput.py
    |       ├── test_hiddeninput.py
    |       ├── test_input.py
    |       ├── test_multiplehiddeninput.py
    |       ├── test_multiwidget.py
    |       ├── test_nullbooleanselect.py
    |       ├── test_numberinput.py
    |       ├── test_passwordinput.py
    |       ├── test_radioselect.py
    |       ├── test_select.py
    |       ├── test_selectdatewidget.py
    |       ├── test_selectmultiple.py
    |       ├── test_splitdatetimewidget.py
    |       ├── test_splithiddendatetimewidget.py
    |       ├── test_textarea.py
    |       ├── test_textinput.py
    |       ├── test_timeinput.py
    |       └── test_widget.py
    ├── from_db_value
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_inline_admin
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── generic_relations
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_forms.py
    |   └── tests.py
    ├── generic_relations_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── generic_views
    |   ├── __init__.py
    |   ├── forms.py
    |   ├── jinja2
    |   |   └── generic_views
    |   ├── models.py
    |   ├── templates
    |   |   ├── generic_views
    |   |   |   └── robots.txt
    |   |   └── registration
    |   ├── test_base.py
    |   ├── test_dates.py
    |   ├── test_detail.py
    |   ├── test_edit.py
    |   ├── test_list.py
    |   ├── urls.py
    |   └── views.py
    ├── get_earliest_or_latest
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_object_or_404
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── get_or_create
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── gis_tests
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── data
    |   |   ├── __init__.py
    |   |   ├── ch-city
    |   |   ├── cities
    |   |   ├── counties
    |   |   ├── gas_lines
    |   |   ├── has_nulls
    |   |   ├── interstates
    |   |   ├── invalid
    |   |   ├── rasters
    |   |   |   ├── __init__.py
    |   |   |   ├── raster.numpy.txt
    |   |   |   └── textrasters.py
    |   |   ├── test_point
    |   |   ├── test_poly
    |   |   └── test_vrt
    |   ├── distapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── gdal_tests
    |   |   ├── __init__.py
    |   |   ├── test_driver.py
    |   |   ├── test_ds.py
    |   |   ├── test_envelope.py
    |   |   ├── test_geom.py
    |   |   ├── test_raster.py
    |   |   ├── test_srs.py
    |   |   └── tests.py
    |   ├── geo3d
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── views.py
    |   ├── geoadmin
    |   |   ├── __init__.py
    |   |   ├── admin.py
    |   |   ├── models.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geoapp
    |   |   ├── __init__.py
    |   |   ├── feeds.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   ├── sitemaps.py
    |   |   ├── test_expressions.py
    |   |   ├── test_feeds.py
    |   |   ├── test_functions.py
    |   |   ├── test_indexes.py
    |   |   ├── test_regress.py
    |   |   ├── test_serializers.py
    |   |   ├── test_sitemaps.py
    |   |   ├── tests.py
    |   |   └── urls.py
    |   ├── geogapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── geos_tests
    |   |   ├── __init__.py
    |   |   ├── test_coordseq.py
    |   |   ├── test_geos.py
    |   |   ├── test_geos_mutation.py
    |   |   ├── test_io.py
    |   |   └── test_mutable_list.py
    |   ├── gis_migrations
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_create_models.py
    |   |   |   └── __init__.py
    |   |   ├── test_commands.py
    |   |   └── test_operations.py
    |   ├── inspectapp
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── layermap
    |   |   ├── __init__.py
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── maps
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── rasterapp
    |   |   ├── __init__.py
    |   |   ├── migrations
    |   |   |   ├── 0001_setup_extensions.py
    |   |   |   ├── 0002_rastermodels.py
    |   |   |   └── __init__.py
    |   |   ├── models.py
    |   |   └── test_rasterfield.py
    |   ├── relatedapp
    |   |   ├── __init__.py
    |   |   ├── fixtures
    |   |   ├── models.py
    |   |   └── tests.py
    |   ├── test_data.py
    |   ├── test_fields.py
    |   ├── test_geoforms.py
    |   ├── test_geoip2.py
    |   ├── test_gis_tests_utils.py
    |   ├── test_measure.py
    |   ├── test_ptr.py
    |   ├── test_spatialrefsys.py
    |   ├── tests.py
    |   └── utils.py
    ├── handlers
    |   ├── __init__.py
    |   ├── templates
    |   ├── test_exception.py
    |   ├── tests.py
    |   ├── tests_custom_error_handlers.py
    |   ├── urls.py
    |   └── views.py
    ├── httpwrappers
    |   ├── __init__.py
    |   ├── abc.txt
    |   └── tests.py
    ├── humanize_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── i18n
    |   ├── __init__.py
    |   ├── commands
    |   |   ├── __init__.py
    |   |   ├── app_with_locale
    |   |   |   └── locale
    |   |   ├── ignore_dir
    |   |   ├── javascript.js
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── es_AR
    |   |   |   ├── fr
    |   |   |   ├── hr
    |   |   |   ├── ja
    |   |   |   ├── ko
    |   |   |   ├── pt_BR
    |   |   |   ├── ru
    |   |   |   └── xxx
    |   |   ├── media_root
    |   |   ├── someapp
    |   |   |   └── static
    |   |   ├── static
    |   |   |   └── javascript_ignored.js
    |   |   └── templates
    |   |       └── subdir
    |   ├── contenttypes
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   └── fr
    |   |   └── tests.py
    |   ├── exclude
    |   |   ├── __init__.py
    |   |   └── canned_locale
    |   |       ├── en
    |   |       ├── fr
    |   |       └── it
    |   ├── forms.py
    |   ├── models.py
    |   ├── other
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── other2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       └── de
    |   ├── patterns
    |   |   ├── __init__.py
    |   |   ├── locale
    |   |   |   ├── en
    |   |   |   ├── nl
    |   |   |   └── pt_BR
    |   |   ├── templates
    |   |   ├── tests.py
    |   |   └── urls
    |   |       ├── __init__.py
    |   |       ├── default.py
    |   |       ├── disabled.py
    |   |       ├── included.py
    |   |       ├── namespace.py
    |   |       ├── path_unused.py
    |   |       ├── wrong.py
    |   |       └── wrong_namespace.py
    |   ├── project_dir
    |   |   ├── __init__.py
    |   |   ├── app_no_locale
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── app_with_locale
    |   |   |   ├── __init__.py
    |   |   |   ├── locale
    |   |   |   └── models.py
    |   |   └── project_locale
    |   ├── resolution
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── de
    |   ├── sampleproject
    |   |   ├── locale
    |   |   |   └── fr
    |   |   ├── manage.py
    |   |   ├── sampleproject
    |   |   |   ├── __init__.py
    |   |   |   └── settings.py
    |   |   ├── templates
    |   |   └── update_catalogs.py
    |   ├── territorial_fallback
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── de
    |   |       └── de_DE
    |   ├── test_compilation.py
    |   ├── test_extraction.py
    |   ├── test_management.py
    |   ├── test_percents.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_default_unprefixed.py
    |   └── utils.py
    ├── import_error_package
    |   └── __init__.py
    ├── indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inline_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── inspectdb
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── introspection
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── invalid_models_tests
    |   ├── __init__.py
    |   ├── test_backend_specific.py
    |   ├── test_custom_fields.py
    |   ├── test_deprecated_fields.py
    |   ├── test_models.py
    |   ├── test_ordinary_fields.py
    |   └── test_relative_fields.py
    ├── known_related_objects
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── logging_tests
    |   ├── __init__.py
    |   ├── logconfig.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── urls_i18n.py
    |   └── views.py
    ├── lookup
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_decimalfield.py
    |   ├── test_lookups.py
    |   ├── test_timefield.py
    |   └── tests.py
    ├── m2m_and_m2o
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_intermediary
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_multiple
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_signals
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── m2m_through_regress
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── test_multitable.py
    |   └── tests.py
    ├── m2o_recursive
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── mail
    |   ├── __init__.py
    |   ├── attachments
    |   |   ├── file.txt
    |   |   └── file_png.txt
    |   ├── custombackend.py
    |   ├── test_sendtestemail.py
    |   └── tests.py
    ├── managers_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_many
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── many_to_one_null
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── max_lengths
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── messages_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── test_api.py
    |   ├── test_cookie.py
    |   ├── test_fallback.py
    |   ├── test_middleware.py
    |   ├── test_mixins.py
    |   ├── test_session.py
    |   ├── tests.py
    |   └── urls.py
    ├── middleware
    |   ├── __init__.py
    |   ├── cond_get_urls.py
    |   ├── extra_urls.py
    |   ├── test_security.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── middleware_exceptions
    |   ├── __init__.py
    |   ├── middleware.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── migrate_signals
    |   ├── __init__.py
    |   ├── custom_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migration_test_data_persistence
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_add_book.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── migrations
    |   ├── __init__.py
    |   ├── deprecated_field_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_remove_ipaddressfield_ip.py
    |   |   └── __init__.py
    |   ├── faulty_migrations
    |   |   ├── __init__.py
    |   |   ├── file.py
    |   |   └── namespace
    |   |       └── foo
    |   ├── migrations_test_apps
    |   |   ├── __init__.py
    |   |   ├── alter_fk
    |   |   |   ├── __init__.py
    |   |   |   ├── author_app
    |   |   |   └── book_app
    |   |   ├── conflicting_app_with_dependencies
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── lookuperror_a
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_b
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── lookuperror_c
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── migrated_unapplied_app
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── mutate_state_a
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── mutate_state_b
    |   |   |   ├── __init__.py
    |   |   |   └── migrations
    |   |   ├── normal
    |   |   |   └── __init__.py
    |   |   ├── unmigrated_app
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_simple
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unmigrated_app_syncdb
    |   |   |   ├── __init__.py
    |   |   |   └── models.py
    |   |   ├── unspecified_app_with_conflict
    |   |   |   ├── __init__.py
    |   |   |   ├── migrations
    |   |   |   └── models.py
    |   |   ├── with_package_model
    |   |   |   ├── __init__.py
    |   |   |   └── models
    |   |   └── without_init_file
    |   |       ├── __init__.py
    |   |       └── migrations
    |   ├── models.py
    |   ├── related_models_app
    |   |   └── __init__.py
    |   ├── routers.py
    |   ├── test_add_many_to_many_field_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_initial.py
    |   |   └── __init__.py
    |   ├── test_auto_now_add
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_autodetector.py
    |   ├── test_base.py
    |   ├── test_commands.py
    |   ├── test_deprecated_fields.py
    |   ├── test_exceptions.py
    |   ├── test_executor.py
    |   ├── test_fake_initial_case_insensitive
    |   |   ├── fake_initial
    |   |   |   ├── 0001_initial.py
    |   |   |   └── __init__.py
    |   |   └── initial
    |   |       ├── 0001_initial.py
    |   |       └── __init__.py
    |   ├── test_graph.py
    |   ├── test_loader.py
    |   ├── test_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_atomic_operation
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_backwards_deps_1
    |   |   ├── 0001_initial.py
    |   |   └── 0002_second.py
    |   ├── test_migrations_bad_pyc
    |   |   └── __init__.py
    |   ├── test_migrations_clashing_prefix
    |   |   ├── __init__.py
    |   |   ├── a.py
    |   |   └── ab.py
    |   ├── test_migrations_conflict
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_custom_user
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_empty
    |   |   └── __init__.py
    |   ├── test_migrations_fake_split_initial
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_first
    |   |   ├── __init__.py
    |   |   ├── second.py
    |   |   └── thefirst.py
    |   ├── test_migrations_initial_false
    |   |   ├── 0001_not_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_namespace_package
    |   |   └── 0001_initial.py
    |   ├── test_migrations_no_ancestor
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_conflicting_second.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_changes
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_default
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_no_init
    |   ├── test_migrations_no_operations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_non_atomic
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_order
    |   |   ├── 0001.py
    |   |   └── __init__.py
    |   ├── test_migrations_plan
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   ├── 0004_fourth.py
    |   |   ├── 0005_fifth.py
    |   |   └── __init__.py
    |   ├── test_migrations_private
    |   |   ├── .util.py
    |   |   ├── 0001_initial.py
    |   |   ├── __init__.py
    |   |   ├── _util.py
    |   |   └── ~util.py
    |   ├── test_migrations_run_before
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 4_auto.py
    |   |   ├── 5_auto.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_complex_multi_apps
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_squashed_erroneous
    |   |   ├── 1_auto.py
    |   |   ├── 2_auto.py
    |   |   ├── 3_squashed_5.py
    |   |   ├── 6_auto.py
    |   |   ├── 7_auto.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_extra
    |   |   ├── 0001_initial.py
    |   |   ├── 0001_squashed_0002.py
    |   |   ├── 0002_second.py
    |   |   ├── 0003_third.py
    |   |   └── __init__.py
    |   ├── test_migrations_squashed_ref_squashed
    |   |   ├── __init__.py
    |   |   ├── app1
    |   |   |   ├── 1_auto.py
    |   |   |   ├── 2_auto.py
    |   |   |   ├── 2_squashed_3.py
    |   |   |   ├── 3_auto.py
    |   |   |   ├── 4_auto.py
    |   |   |   └── __init__.py
    |   |   └── app2
    |   |       ├── 1_auto.py
    |   |       ├── 1_squashed_2.py
    |   |       ├── 2_auto.py
    |   |       └── __init__.py
    |   ├── test_migrations_unmigdep
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_multidb.py
    |   ├── test_operations.py
    |   ├── test_optimizer.py
    |   ├── test_questioner.py
    |   ├── test_state.py
    |   └── test_writer.py
    ├── migrations2
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_migrations_2
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── test_migrations_2_first
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_second.py
    |   |   └── __init__.py
    |   └── test_migrations_2_no_deps
    |       ├── 0001_initial.py
    |       └── __init__.py
    ├── model_enums
    |   ├── __init__.py
    |   └── tests.py
    ├── model_fields
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_autofield.py
    |   ├── test_binaryfield.py
    |   ├── test_booleanfield.py
    |   ├── test_charfield.py
    |   ├── test_datetimefield.py
    |   ├── test_decimalfield.py
    |   ├── test_durationfield.py
    |   ├── test_field_flags.py
    |   ├── test_filefield.py
    |   ├── test_filepathfield.py
    |   ├── test_floatfield.py
    |   ├── test_foreignkey.py
    |   ├── test_genericipaddressfield.py
    |   ├── test_imagefield.py
    |   ├── test_integerfield.py
    |   ├── test_manytomanyfield.py
    |   ├── test_promises.py
    |   ├── test_slugfield.py
    |   ├── test_textfield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_forms
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_modelchoicefield.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── model_formsets_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_indexes
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_inheritance
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_abstract_inheritance.py
    |   └── tests.py
    ├── model_inheritance_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── model_meta
    |   ├── __init__.py
    |   ├── models.py
    |   ├── results.py
    |   └── tests.py
    ├── model_options
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── default_related_name.py
    |   |   └── tablespaces.py
    |   ├── test_default_related_name.py
    |   └── test_tablespaces.py
    ├── model_package
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── article.py
    |   |   └── publication.py
    |   └── tests.py
    ├── model_regress
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_pickle.py
    |   ├── test_state.py
    |   └── tests.py
    ├── modeladmin
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_actions.py
    |   ├── test_checks.py
    |   └── tests.py
    ├── multiple_database
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── routers.py
    |   └── tests.py
    ├── mutually_referential
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── nested_foreign_keys
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── no_models
    |   ├── __init__.py
    |   └── tests.py
    ├── null_fk
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_fk_ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── null_queries
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── one_to_one
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── or_lookups
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── order_with_respect_to
    |   ├── __init__.py
    |   ├── base_tests.py
    |   ├── models.py
    |   └── tests.py
    ├── ordering
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── pagination
    |   ├── __init__.py
    |   ├── custom.py
    |   ├── models.py
    |   └── tests.py
    ├── postgres_tests
    |   ├── __init__.py
    |   ├── array_default_migrations
    |   |   ├── 0001_initial.py
    |   |   ├── 0002_integerarraymodel_field_2.py
    |   |   └── __init__.py
    |   ├── array_index_migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── fields.py
    |   ├── integration_settings.py
    |   ├── migrations
    |   |   ├── 0001_setup_extensions.py
    |   |   ├── 0002_create_test_models.py
    |   |   └── __init__.py
    |   ├── models.py
    |   ├── test_aggregates.py
    |   ├── test_apps.py
    |   ├── test_array.py
    |   ├── test_bulk_update.py
    |   ├── test_citext.py
    |   ├── test_constraints.py
    |   ├── test_functions.py
    |   ├── test_hstore.py
    |   ├── test_indexes.py
    |   ├── test_integration.py
    |   ├── test_introspection.py
    |   ├── test_json.py
    |   ├── test_operations.py
    |   ├── test_ranges.py
    |   ├── test_search.py
    |   ├── test_signals.py
    |   ├── test_trigram.py
    |   └── test_unaccent.py
    ├── prefetch_related
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_prefetch_related_objects.py
    |   ├── test_uuid.py
    |   └── tests.py
    ├── project_template
    |   ├── __init__.py
    |   ├── test_settings.py
    |   ├── urls.py
    |   └── views.py
    ├── properties
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_model_inheritance
    |   ├── __init__.py
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── models.py
    |   ├── models.py
    |   └── tests.py
    ├── proxy_models
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── queries
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_bulk_update.py
    |   ├── test_db_returning.py
    |   ├── test_deprecation.py
    |   ├── test_explain.py
    |   ├── test_iterator.py
    |   ├── test_q.py
    |   ├── test_qs_combinators.py
    |   ├── test_query.py
    |   └── tests.py
    ├── queryset_pickle
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── raw_query
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── redirects_tests
    |   ├── __init__.py
    |   ├── tests.py
    |   └── urls.py
    ├── requests
    |   ├── __init__.py
    |   ├── test_accept_header.py
    |   ├── test_data_upload_settings.py
    |   ├── test_is_ajax_deprecations.py
    |   └── tests.py
    ├── requirements
    |   ├── mysql.txt
    |   ├── oracle.txt
    |   ├── postgres.txt
    |   └── py3.txt
    ├── reserved_names
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── resolve_url
    |   ├── __init__.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── responses
    |   ├── __init__.py
    |   ├── test_cookie.py
    |   ├── test_fileresponse.py
    |   └── tests.py
    ├── reverse_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── runtests.py
    ├── save_delete_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── schema
    |   ├── __init__.py
    |   ├── fields.py
    |   ├── models.py
    |   ├── test_logging.py
    |   └── tests.py
    ├── select_for_update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_onetoone
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── select_related_regress
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── serializers
    |   ├── __init__.py
    |   ├── models
    |   |   ├── __init__.py
    |   |   ├── base.py
    |   |   ├── data.py
    |   |   ├── multi_table.py
    |   |   └── natural.py
    |   ├── test_data.py
    |   ├── test_deserializedobject.py
    |   ├── test_json.py
    |   ├── test_natural.py
    |   ├── test_xml.py
    |   ├── test_yaml.py
    |   └── tests.py
    ├── servers
    |   ├── __init__.py
    |   ├── another_app
    |   |   ├── __init__.py
    |   |   └── static
    |   |       └── another_app
    |   ├── fixtures
    |   ├── media
    |   |   └── example_media_file.txt
    |   ├── models.py
    |   ├── static
    |   |   └── example_static_file.txt
    |   ├── test_basehttp.py
    |   ├── test_liveserverthread.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── sessions_tests
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── settings_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── shell
    |   ├── __init__.py
    |   └── tests.py
    ├── shortcuts
    |   ├── __init__.py
    |   ├── jinja2
    |   |   └── shortcuts
    |   ├── templates
    |   |   └── shortcuts
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── signals
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_deprecation.py
    |   └── tests.py
    ├── signed_cookies_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── signing
    |   ├── __init__.py
    |   └── tests.py
    ├── sitemaps_tests
    |   ├── __init__.py
    |   ├── base.py
    |   ├── models.py
    |   ├── templates
    |   ├── test_generic.py
    |   ├── test_http.py
    |   ├── test_https.py
    |   ├── test_management.py
    |   ├── test_utils.py
    |   └── urls
    |       ├── __init__.py
    |       ├── empty.py
    |       ├── http.py
    |       ├── https.py
    |       └── index_only.py
    ├── sites_framework
    |   ├── __init__.py
    |   ├── migrations
    |   |   ├── 0001_initial.py
    |   |   └── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── sites_tests
    |   ├── __init__.py
    |   └── tests.py
    ├── staticfiles_tests
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── no_label
    |   |   |   ├── __init__.py
    |   |   |   └── static
    |   |   ├── staticfiles_config.py
    |   |   └── test
    |   |       ├── __init__.py
    |   |       ├── otherdir
    |   |       └── static
    |   ├── cases.py
    |   ├── project
    |   |   ├── documents
    |   |   |   ├── cached
    |   |   |   ├── subdir
    |   |   |   ├── test
    |   |   |   └── test.txt
    |   |   ├── faulty
    |   |   ├── loop
    |   |   ├── pathlib
    |   |   |   └── pathlib.txt
    |   |   ├── prefixed
    |   |   |   └── test.txt
    |   |   └── site_media
    |   |       ├── media
    |   |       └── static
    |   ├── settings.py
    |   ├── storage.py
    |   ├── test_checks.py
    |   ├── test_finders.py
    |   ├── test_forms.py
    |   ├── test_liveserver.py
    |   ├── test_management.py
    |   ├── test_storage.py
    |   ├── test_templatetags.py
    |   ├── test_utils.py
    |   ├── test_views.py
    |   └── urls
    |       ├── __init__.py
    |       ├── default.py
    |       └── helper.py
    ├── str
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── string_lookup
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── swappable_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── syndication_tests
    |   ├── __init__.py
    |   ├── feeds.py
    |   ├── models.py
    |   ├── templates
    |   |   └── syndication
    |   ├── tests.py
    |   └── urls.py
    ├── template_backends
    |   ├── __init__.py
    |   ├── apps
    |   |   ├── __init__.py
    |   |   ├── good
    |   |   |   ├── __init__.py
    |   |   |   └── templatetags
    |   |   └── importerror
    |   |       ├── __init__.py
    |   |       └── templatetags
    |   ├── forbidden
    |   |   └── template_backends
    |   ├── jinja2
    |   |   └── template_backends
    |   ├── template_strings
    |   |   └── template_backends
    |   ├── templates
    |   |   └── template_backends
    |   ├── test_django.py
    |   ├── test_dummy.py
    |   ├── test_jinja2.py
    |   └── test_utils.py
    ├── template_loader
    |   ├── __init__.py
    |   ├── template_strings
    |   |   └── template_loader
    |   ├── templates
    |   |   └── template_loader
    |   └── tests.py
    ├── template_tests
    |   ├── __init__.py
    |   ├── alternate_urls.py
    |   ├── annotated_tag_function.py
    |   ├── broken_tag.py
    |   ├── eggs
    |   ├── filter_tests
    |   |   ├── __init__.py
    |   |   ├── test_add.py
    |   |   ├── test_addslashes.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_capfirst.py
    |   |   ├── test_center.py
    |   |   ├── test_chaining.py
    |   |   ├── test_cut.py
    |   |   ├── test_date.py
    |   |   ├── test_default.py
    |   |   ├── test_default_if_none.py
    |   |   ├── test_dictsort.py
    |   |   ├── test_dictsortreversed.py
    |   |   ├── test_divisibleby.py
    |   |   ├── test_escape.py
    |   |   ├── test_escapejs.py
    |   |   ├── test_filesizeformat.py
    |   |   ├── test_first.py
    |   |   ├── test_floatformat.py
    |   |   ├── test_force_escape.py
    |   |   ├── test_get_digit.py
    |   |   ├── test_iriencode.py
    |   |   ├── test_join.py
    |   |   ├── test_json_script.py
    |   |   ├── test_last.py
    |   |   ├── test_length.py
    |   |   ├── test_length_is.py
    |   |   ├── test_linebreaks.py
    |   |   ├── test_linebreaksbr.py
    |   |   ├── test_linenumbers.py
    |   |   ├── test_ljust.py
    |   |   ├── test_lower.py
    |   |   ├── test_make_list.py
    |   |   ├── test_phone2numeric.py
    |   |   ├── test_pluralize.py
    |   |   ├── test_random.py
    |   |   ├── test_rjust.py
    |   |   ├── test_safe.py
    |   |   ├── test_safeseq.py
    |   |   ├── test_slice.py
    |   |   ├── test_slugify.py
    |   |   ├── test_stringformat.py
    |   |   ├── test_striptags.py
    |   |   ├── test_time.py
    |   |   ├── test_timesince.py
    |   |   ├── test_timeuntil.py
    |   |   ├── test_title.py
    |   |   ├── test_truncatechars.py
    |   |   ├── test_truncatechars_html.py
    |   |   ├── test_truncatewords.py
    |   |   ├── test_truncatewords_html.py
    |   |   ├── test_unordered_list.py
    |   |   ├── test_upper.py
    |   |   ├── test_urlencode.py
    |   |   ├── test_urlize.py
    |   |   ├── test_urlizetrunc.py
    |   |   ├── test_wordcount.py
    |   |   ├── test_wordwrap.py
    |   |   ├── test_yesno.py
    |   |   └── timezone_utils.py
    |   ├── jinja2
    |   |   └── template_tests
    |   ├── other_templates
    |   |   └── priority
    |   ├── recursive_templates
    |   |   ├── fs
    |   |   ├── fs2
    |   |   └── fs3
    |   ├── relative_templates
    |   |   └── dir1
    |   |       └── dir2
    |   ├── syntax_tests
    |   |   ├── __init__.py
    |   |   ├── i18n
    |   |   |   ├── __init__.py
    |   |   |   ├── base.py
    |   |   |   ├── test_blocktranslate.py
    |   |   |   ├── test_filters.py
    |   |   |   ├── test_get_available_languages.py
    |   |   |   ├── test_get_current_language.py
    |   |   |   ├── test_get_current_language_bidi.py
    |   |   |   ├── test_get_language_info.py
    |   |   |   ├── test_get_language_info_list.py
    |   |   |   ├── test_language.py
    |   |   |   ├── test_translate.py
    |   |   |   └── test_underscore_syntax.py
    |   |   ├── test_autoescape.py
    |   |   ├── test_basic.py
    |   |   ├── test_builtins.py
    |   |   ├── test_cache.py
    |   |   ├── test_comment.py
    |   |   ├── test_cycle.py
    |   |   ├── test_exceptions.py
    |   |   ├── test_extends.py
    |   |   ├── test_filter_syntax.py
    |   |   ├── test_filter_tag.py
    |   |   ├── test_firstof.py
    |   |   ├── test_for.py
    |   |   ├── test_if.py
    |   |   ├── test_if_changed.py
    |   |   ├── test_if_equal.py
    |   |   ├── test_include.py
    |   |   ├── test_invalid_string.py
    |   |   ├── test_list_index.py
    |   |   ├── test_load.py
    |   |   ├── test_lorem.py
    |   |   ├── test_multiline.py
    |   |   ├── test_named_endblock.py
    |   |   ├── test_now.py
    |   |   ├── test_numpy.py
    |   |   ├── test_regroup.py
    |   |   ├── test_resetcycle.py
    |   |   ├── test_setup.py
    |   |   ├── test_simple_tag.py
    |   |   ├── test_spaceless.py
    |   |   ├── test_static.py
    |   |   ├── test_template_tag.py
    |   |   ├── test_url.py
    |   |   ├── test_verbatim.py
    |   |   ├── test_width_ratio.py
    |   |   └── test_with.py
    |   ├── templates
    |   |   ├── first
    |   |   ├── priority
    |   |   ├── second
    |   |   └── template_tests
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   ├── bad_tag.py
    |   |   ├── custom.py
    |   |   ├── inclusion.py
    |   |   ├── subpackage
    |   |   |   ├── __init__.py
    |   |   |   └── echo.py
    |   |   ├── tag_27584.py
    |   |   └── testtags.py
    |   ├── test_base.py
    |   ├── test_callables.py
    |   ├── test_context.py
    |   ├── test_custom.py
    |   ├── test_engine.py
    |   ├── test_extends.py
    |   ├── test_extends_relative.py
    |   ├── test_library.py
    |   ├── test_loaders.py
    |   ├── test_logging.py
    |   ├── test_nodelist.py
    |   ├── test_origin.py
    |   ├── test_parser.py
    |   ├── test_response.py
    |   ├── test_smartif.py
    |   ├── tests.py
    |   ├── urls.py
    |   ├── utils.py
    |   └── views.py
    ├── templates
    |   ├── comments
    |   |   └── comment_notification_email.txt
    |   ├── custom_admin
    |   └── views
    ├── test_client
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── test_conditional_content_removal.py
    |   ├── test_fakepayload.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_client_regress
    |   ├── __init__.py
    |   ├── auth_backends.py
    |   ├── bad_templates
    |   ├── context_processors.py
    |   ├── models.py
    |   ├── session.py
    |   ├── templates
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── test_exceptions
    |   ├── __init__.py
    |   └── test_validation_error.py
    ├── test_runner
    |   ├── __init__.py
    |   ├── models.py
    |   ├── runner.py
    |   ├── test_debug_sql.py
    |   ├── test_discover_runner.py
    |   ├── test_parallel.py
    |   └── tests.py
    ├── test_runner_apps
    |   ├── __init__.py
    |   ├── buffer
    |   |   └── tests_buffer.py
    |   ├── databases
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   ├── sample
    |   |   ├── __init__.py
    |   |   ├── doctests.py
    |   |   ├── empty.py
    |   |   ├── pattern_tests.py
    |   |   ├── tests
    |   |   |   ├── __init__.py
    |   |   |   └── tests.py
    |   |   └── tests_sample.py
    |   ├── simple
    |   |   ├── __init__.py
    |   |   └── tests.py
    |   └── tagged
    |       ├── __init__.py
    |       ├── tests.py
    |       └── tests_inheritance.py
    ├── test_sqlite.py
    ├── test_utils
    |   ├── __init__.py
    |   ├── fixtures
    |   ├── models.py
    |   ├── templates
    |   |   └── template_used
    |   ├── test_simpletestcase.py
    |   ├── test_testcase.py
    |   ├── test_transactiontestcase.py
    |   ├── tests.py
    |   ├── urls.py
    |   └── views.py
    ├── timezones
    |   ├── __init__.py
    |   ├── admin.py
    |   ├── forms.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── transaction_hooks
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── transactions
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── unmanaged_models
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── update_only_fields
    |   ├── __init__.py
    |   ├── models.py
    |   └── tests.py
    ├── urlpatterns
    |   ├── __init__.py
    |   ├── converter_urls.py
    |   ├── converters.py
    |   ├── included_urls.py
    |   ├── more_urls.py
    |   ├── path_base64_urls.py
    |   ├── path_dynamic_urls.py
    |   ├── path_same_name_urls.py
    |   ├── path_urls.py
    |   ├── test_resolvers.py
    |   ├── tests.py
    |   └── views.py
    ├── urlpatterns_reverse
    |   ├── __init__.py
    |   ├── erroneous_urls.py
    |   ├── extra_urls.py
    |   ├── included_app_urls.py
    |   ├── included_named_urls.py
    |   ├── included_named_urls2.py
    |   ├── included_namespace_urls.py
    |   ├── included_no_kwargs_urls.py
    |   ├── included_urls.py
    |   ├── included_urls2.py
    |   ├── method_view_urls.py
    |   ├── middleware.py
    |   ├── named_urls.py
    |   ├── named_urls_conflict.py
    |   ├── namespace_urls.py
    |   ├── nested_urls.py
    |   ├── no_urls.py
    |   ├── nonimported_module.py
    |   ├── reverse_lazy_urls.py
    |   ├── test_localeregexdescriptor.py
    |   ├── tests.py
    |   ├── translations
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       ├── __init__.py
    |   |       ├── de
    |   |       └── fr
    |   ├── urlconf_inner.py
    |   ├── urlconf_outer.py
    |   ├── urls.py
    |   ├── urls_error_handlers.py
    |   ├── urls_error_handlers_callables.py
    |   ├── urls_without_handlers.py
    |   ├── utils.py
    |   ├── views.py
    |   └── views_broken.py
    ├── urls.py
    ├── user_commands
    |   ├── __init__.py
    |   ├── eggs
    |   ├── management
    |   |   └── commands
    |   |       ├── common_args.py
    |   |       ├── dance.py
    |   |       ├── hal.py
    |   |       ├── mutually_exclusive_required.py
    |   |       ├── no_translations.py
    |   |       ├── required_option.py
    |   |       ├── reverse_url.py
    |   |       ├── set_option.py
    |   |       ├── subparser.py
    |   |       ├── subparser_dest.py
    |   |       ├── subparser_required.py
    |   |       └── transaction.py
    |   ├── models.py
    |   ├── tests.py
    |   └── urls.py
    ├── utils_tests
    |   ├── __init__.py
    |   ├── archives
    |   ├── eggs
    |   ├── files
    |   |   └── strip_tags2.txt
    |   ├── models.py
    |   ├── test_archive.py
    |   ├── test_autoreload.py
    |   ├── test_baseconv.py
    |   ├── test_crypto.py
    |   ├── test_datastructures.py
    |   ├── test_dateformat.py
    |   ├── test_dateparse.py
    |   ├── test_datetime_safe.py
    |   ├── test_decorators.py
    |   ├── test_duration.py
    |   ├── test_encoding.py
    |   ├── test_encoding_deprecations.py
    |   ├── test_feedgenerator.py
    |   ├── test_functional.py
    |   ├── test_hashable.py
    |   ├── test_html.py
    |   ├── test_http.py
    |   ├── test_inspect.py
    |   ├── test_ipv6.py
    |   ├── test_jslex.py
    |   ├── test_lazyobject.py
    |   ├── test_lorem_ipsum.py
    |   ├── test_module
    |   |   ├── __init__.py
    |   |   ├── another_bad_module.py
    |   |   ├── another_good_module.py
    |   |   ├── bad_module.py
    |   |   ├── child_module
    |   |   |   ├── __init__.py
    |   |   |   └── grandchild_module.py
    |   |   └── good_module.py
    |   ├── test_module_loading.py
    |   ├── test_no_submodule.py
    |   ├── test_numberformat.py
    |   ├── test_os_utils.py
    |   ├── test_regex_helper.py
    |   ├── test_safestring.py
    |   ├── test_simplelazyobject.py
    |   ├── test_termcolors.py
    |   ├── test_text.py
    |   ├── test_timesince.py
    |   ├── test_timezone.py
    |   ├── test_topological_sort.py
    |   ├── test_tree.py
    |   └── utils.py
    ├── validation
    |   ├── __init__.py
    |   ├── models.py
    |   ├── test_custom_messages.py
    |   ├── test_error_messages.py
    |   ├── test_picklable.py
    |   ├── test_unique.py
    |   ├── test_validators.py
    |   └── tests.py
    ├── validators
    |   ├── __init__.py
    |   ├── invalid_urls.txt
    |   ├── tests.py
    |   └── valid_urls.txt
    ├── version
    |   ├── __init__.py
    |   └── tests.py
    ├── view_tests
    |   ├── __init__.py
    |   ├── app0
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── en
    |   ├── app1
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app2
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── app3
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app4
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── es_AR
    |   ├── app5
    |   |   ├── __init__.py
    |   |   └── locale
    |   |       └── fr
    |   ├── default_urls.py
    |   ├── generic_urls.py
    |   ├── locale
    |   |   ├── de
    |   |   |   └── LC_MESSAGES
    |   |   ├── en_GB
    |   |   |   └── LC_MESSAGES
    |   |   ├── es
    |   |   |   └── LC_MESSAGES
    |   |   ├── fr
    |   |   |   └── LC_MESSAGES
    |   |   ├── nl
    |   |   |   └── LC_MESSAGES
    |   |   ├── pt
    |   |   |   └── LC_MESSAGES
    |   |   └── ru
    |   |       └── LC_MESSAGES
    |   ├── media
    |   |   ├── %2F.txt
    |   |   ├── file.txt
    |   |   ├── long-line.txt
    |   |   └── subdir
    |   ├── models.py
    |   ├── regression_21530_urls.py
    |   ├── templates
    |   |   └── debug
    |   ├── templatetags
    |   |   ├── __init__.py
    |   |   └── debugtags.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_csrf.py
    |   |   ├── test_debug.py
    |   |   ├── test_defaults.py
    |   |   ├── test_i18n.py
    |   |   ├── test_json.py
    |   |   ├── test_specials.py
    |   |   └── test_static.py
    |   ├── urls.py
    |   └── views.py
    └── wsgi
        ├── __init__.py
        ├── tests.py
        ├── urls.py
        └── wsgi.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Allow overridding widget in formfield_for_manytomany().

Issue description: 
Description
	 
		(last modified by Mariusz Felisiak)
	 
It does not work when I set widget param to function formfield_for_manytomany().
This is different from the formfield_for_foreignkey() function.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: tests/admin_ordering/tests.py
Line number range: 123 - 189
Content:
123. class TestRelatedFieldsAdminOrdering(TestCase):
124.     @classmethod
125.     def setUpTestData(cls):
126.         cls.b1 = Band.objects.create(name='Pink Floyd', bio='', rank=1)
127.         cls.b2 = Band.objects.create(name='Foo Fighters', bio='', rank=5)
128. 
129.     def setUp(self):
130.         # we need to register a custom ModelAdmin (instead of just using
131.         # ModelAdmin) because the field creator tries to find the ModelAdmin
132.         # for the related model
133.         class SongAdmin(admin.ModelAdmin):
134.             pass
135.         site.register(Song, SongAdmin)
136. 
137.     def tearDown(self):
138.         site.unregister(Song)
139.         if Band in site._registry:
140.             site.unregister(Band)
141. 
142.     def check_ordering_of_field_choices(self, correct_ordering):
143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)
144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)
145.         self.assertEqual(list(fk_field.queryset), correct_ordering)
146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)
147. 
148.     def test_no_admin_fallback_to_model_ordering(self):
149.         # should be ordered by name (as defined by the model)
150.         self.check_ordering_of_field_choices([self.b2, self.b1])
151. 
152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):
153.         class NoOrderingBandAdmin(admin.ModelAdmin):
154.             pass
155.         site.register(Band, NoOrderingBandAdmin)
156. 
157.         # should be ordered by name (as defined by the model)
158.         self.check_ordering_of_field_choices([self.b2, self.b1])
159. 
160.     def test_admin_ordering_beats_model_ordering(self):
161.         class StaticOrderingBandAdmin(admin.ModelAdmin):
162.             ordering = ('rank',)
163.         site.register(Band, StaticOrderingBandAdmin)
164. 
165.         # should be ordered by rank (defined by the ModelAdmin)
166.         self.check_ordering_of_field_choices([self.b1, self.b2])
167. 
168.     def test_custom_queryset_still_wins(self):
169.         """Custom queryset has still precedence (#21405)"""
170.         class SongAdmin(admin.ModelAdmin):
171.             # Exclude one of the two Bands from the querysets
172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):
173.                 if db_field.name == 'band':
174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
176. 
177.             def formfield_for_manytomany(self, db_field, request, **kwargs):
178.                 if db_field.name == 'other_interpreters':
179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)
180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)
181. 
182.         class StaticOrderingBandAdmin(admin.ModelAdmin):
183.             ordering = ('rank',)
184. 
185.         site.unregister(Song)
186.         site.register(Song, SongAdmin)
187.         site.register(Band, StaticOrderingBandAdmin)
188. 
189.         self.check_ordering_of_field_choices([self.b2])


File: django/contrib/auth/admin.py
Line number range: 25 - 37
Content:
25. @admin.register(Group)
26. class GroupAdmin(admin.ModelAdmin):
27.     search_fields = ('name',)
28.     ordering = ('name',)
29.     filter_horizontal = ('permissions',)
30. 
31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):
32.         if db_field.name == 'permissions':
33.             qs = kwargs.get('queryset', db_field.remote_field.model.objects)
34.             # Avoid a major performance hit resolving permission names which
35.             # triggers a content_type load:
36.             kwargs['queryset'] = qs.select_related('content_type')
37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)


File: tests/admin_views/tests.py
Line number range: 5262 - 5293
Content:
5262. @override_settings(ROOT_URLCONF='admin_views.urls')
5263. class GroupAdminTest(TestCase):
5264.     """
5265.     Tests group CRUD functionality.
5266.     """
5267. 
5268.     @classmethod
5269.     def setUpTestData(cls):
5270.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email='super@example.com')
5271. 
5272.     def setUp(self):
5273.         self.client.force_login(self.superuser)
5274. 
5275.     def test_save_button(self):
5276.         group_count = Group.objects.count()
5277.         response = self.client.post(reverse('admin:auth_group_add'), {
5278.             'name': 'newgroup',
5279.         })
5280. 
5281.         Group.objects.order_by('-id')[0]
5282.         self.assertRedirects(response, reverse('admin:auth_group_changelist'))
5283.         self.assertEqual(Group.objects.count(), group_count + 1)
5284. 
5285.     def test_group_permission_performance(self):
5286.         g = Group.objects.create(name="test_group")
5287. 
5288.         # Ensure no queries are skipped due to cached content type for Group.
5289.         ContentType.objects.clear_cache()
5290. 
5291.         with self.assertNumQueries(8):
5292.             response = self.client.get(reverse('admin:auth_group_change', args=(g.pk,)))
5293.             self.assertEqual(response.status_code, 200)


File: tests/admin_widgets/tests.py
Line number range: 39 - 187
Content:
39. class AdminFormfieldForDBFieldTests(SimpleTestCase):
40.     """
41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield
42.     """
43. 
44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):
45.         """
46.         Helper to call formfield_for_dbfield for a given model and field name
47.         and verify that the returned formfield is appropriate.
48.         """
49.         # Override any settings on the model admin
50.         class MyModelAdmin(admin.ModelAdmin):
51.             pass
52.         for k in admin_overrides:
53.             setattr(MyModelAdmin, k, admin_overrides[k])
54. 
55.         # Construct the admin, and ask it for a formfield
56.         ma = MyModelAdmin(model, admin.site)
57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)
58. 
59.         # "unwrap" the widget wrapper, if needed
60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):
61.             widget = ff.widget.widget
62.         else:
63.             widget = ff.widget
64. 
65.         self.assertIsInstance(widget, widgetclass)
66. 
67.         # Return the formfield so that other tests can continue
68.         return ff
69. 
70.     def test_DateField(self):
71.         self.assertFormfield(Event, 'start_date', widgets.AdminDateWidget)
72. 
73.     def test_DateTimeField(self):
74.         self.assertFormfield(Member, 'birthdate', widgets.AdminSplitDateTime)
75. 
76.     def test_TimeField(self):
77.         self.assertFormfield(Event, 'start_time', widgets.AdminTimeWidget)
78. 
79.     def test_TextField(self):
80.         self.assertFormfield(Event, 'description', widgets.AdminTextareaWidget)
81. 
82.     def test_URLField(self):
83.         self.assertFormfield(Event, 'link', widgets.AdminURLFieldWidget)
84. 
85.     def test_IntegerField(self):
86.         self.assertFormfield(Event, 'min_age', widgets.AdminIntegerFieldWidget)
87. 
88.     def test_CharField(self):
89.         self.assertFormfield(Member, 'name', widgets.AdminTextInputWidget)
90. 
91.     def test_EmailField(self):
92.         self.assertFormfield(Member, 'email', widgets.AdminEmailInputWidget)
93. 
94.     def test_FileField(self):
95.         self.assertFormfield(Album, 'cover_art', widgets.AdminFileWidget)
96. 
97.     def test_ForeignKey(self):
98.         self.assertFormfield(Event, 'main_band', forms.Select)
99. 
100.     def test_raw_id_ForeignKey(self):
101.         self.assertFormfield(Event, 'main_band', widgets.ForeignKeyRawIdWidget,
102.                              raw_id_fields=['main_band'])
103. 
104.     def test_radio_fields_ForeignKey(self):
105.         ff = self.assertFormfield(Event, 'main_band', widgets.AdminRadioSelect,
106.                                   radio_fields={'main_band': admin.VERTICAL})
107.         self.assertIsNone(ff.empty_label)
108. 
109.     def test_many_to_many(self):
110.         self.assertFormfield(Band, 'members', forms.SelectMultiple)
111. 
112.     def test_raw_id_many_to_many(self):
113.         self.assertFormfield(Band, 'members', widgets.ManyToManyRawIdWidget,
114.                              raw_id_fields=['members'])
115. 
116.     def test_filtered_many_to_many(self):
117.         self.assertFormfield(Band, 'members', widgets.FilteredSelectMultiple,
118.                              filter_vertical=['members'])
119. 
120.     def test_formfield_overrides(self):
121.         self.assertFormfield(Event, 'start_date', forms.TextInput,
122.                              formfield_overrides={DateField: {'widget': forms.TextInput}})
123. 
124.     def test_formfield_overrides_widget_instances(self):
125.         """
126.         Widget instances in formfield_overrides are not shared between
127.         different fields. (#19423)
128.         """
129.         class BandAdmin(admin.ModelAdmin):
130.             formfield_overrides = {
131.                 CharField: {'widget': forms.TextInput(attrs={'size': '10'})}
132.             }
133.         ma = BandAdmin(Band, admin.site)
134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field('name'), request=None)
135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field('style'), request=None)
136.         self.assertNotEqual(f1.widget, f2.widget)
137.         self.assertEqual(f1.widget.attrs['maxlength'], '100')
138.         self.assertEqual(f2.widget.attrs['maxlength'], '20')
139.         self.assertEqual(f2.widget.attrs['size'], '10')
140. 
141.     def test_formfield_overrides_for_datetime_field(self):
142.         """
143.         Overriding the widget for DateTimeField doesn't overrides the default
144.         form_class for that field (#26449).
145.         """
146.         class MemberAdmin(admin.ModelAdmin):
147.             formfield_overrides = {DateTimeField: {'widget': widgets.AdminSplitDateTime}}
148.         ma = MemberAdmin(Member, admin.site)
149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field('birthdate'), request=None)
150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)
151.         self.assertIsInstance(f1, forms.SplitDateTimeField)
152. 
153.     def test_formfield_overrides_for_custom_field(self):
154.         """
155.         formfield_overrides works for a custom field class.
156.         """
157.         class AlbumAdmin(admin.ModelAdmin):
158.             formfield_overrides = {MyFileField: {'widget': forms.TextInput()}}
159.         ma = AlbumAdmin(Member, admin.site)
160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field('backside_art'), request=None)
161.         self.assertIsInstance(f1.widget, forms.TextInput)
162. 
163.     def test_field_with_choices(self):
164.         self.assertFormfield(Member, 'gender', forms.Select)
165. 
166.     def test_choices_with_radio_fields(self):
167.         self.assertFormfield(Member, 'gender', widgets.AdminRadioSelect,
168.                              radio_fields={'gender': admin.VERTICAL})
169. 
170.     def test_inheritance(self):
171.         self.assertFormfield(Album, 'backside_art', widgets.AdminFileWidget)
172. 
173.     def test_m2m_widgets(self):
174.         """m2m fields help text as it applies to admin app (#9321)."""
175.         class AdvisorAdmin(admin.ModelAdmin):
176.             filter_vertical = ['companies']
177. 
178.         self.assertFormfield(Advisor, 'companies', widgets.FilteredSelectMultiple,
179.                              filter_vertical=['companies'])
180.         ma = AdvisorAdmin(Advisor, admin.site)
181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field('companies'), request=None)
182.         self.assertEqual(
183.             f.help_text,
184.             'Hold down “Control”, or “Command” on a Mac, to select more than one.'
185.         )
186. 
187. 


File: tests/admin_widgets/tests.py
Line number range: 638 - 718
Content:
638. @override_settings(ROOT_URLCONF='admin_widgets.urls')
639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):
640.     def test_no_can_add_related(self):
641.         rel = Individual._meta.get_field('parent').remote_field
642.         w = widgets.AdminRadioSelect()
643.         # Used to fail with a name error.
644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)
645.         self.assertFalse(w.can_add_related)
646. 
647.     def test_select_multiple_widget_cant_change_delete_related(self):
648.         rel = Individual._meta.get_field('parent').remote_field
649.         widget = forms.SelectMultiple()
650.         wrapper = widgets.RelatedFieldWidgetWrapper(
651.             widget, rel, widget_admin_site,
652.             can_add_related=True,
653.             can_change_related=True,
654.             can_delete_related=True,
655.         )
656.         self.assertTrue(wrapper.can_add_related)
657.         self.assertFalse(wrapper.can_change_related)
658.         self.assertFalse(wrapper.can_delete_related)
659. 
660.     def test_on_delete_cascade_rel_cant_delete_related(self):
661.         rel = Individual._meta.get_field('soulmate').remote_field
662.         widget = forms.Select()
663.         wrapper = widgets.RelatedFieldWidgetWrapper(
664.             widget, rel, widget_admin_site,
665.             can_add_related=True,
666.             can_change_related=True,
667.             can_delete_related=True,
668.         )
669.         self.assertTrue(wrapper.can_add_related)
670.         self.assertTrue(wrapper.can_change_related)
671.         self.assertFalse(wrapper.can_delete_related)
672. 
673.     def test_custom_widget_render(self):
674.         class CustomWidget(forms.Select):
675.             def render(self, *args, **kwargs):
676.                 return 'custom render output'
677.         rel = Album._meta.get_field('band').remote_field
678.         widget = CustomWidget()
679.         wrapper = widgets.RelatedFieldWidgetWrapper(
680.             widget, rel, widget_admin_site,
681.             can_add_related=True,
682.             can_change_related=True,
683.             can_delete_related=True,
684.         )
685.         output = wrapper.render('name', 'value')
686.         self.assertIn('custom render output', output)
687. 
688.     def test_widget_delegates_value_omitted_from_data(self):
689.         class CustomWidget(forms.Select):
690.             def value_omitted_from_data(self, data, files, name):
691.                 return False
692.         rel = Album._meta.get_field('band').remote_field
693.         widget = CustomWidget()
694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)
696. 
697.     def test_widget_is_hidden(self):
698.         rel = Album._meta.get_field('band').remote_field
699.         widget = forms.HiddenInput()
700.         widget.choices = ()
701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
702.         self.assertIs(wrapper.is_hidden, True)
703.         context = wrapper.get_context('band', None, {})
704.         self.assertIs(context['is_hidden'], True)
705.         output = wrapper.render('name', 'value')
706.         # Related item links are hidden.
707.         self.assertNotIn('<a ', output)
708. 
709.     def test_widget_is_not_hidden(self):
710.         rel = Album._meta.get_field('band').remote_field
711.         widget = forms.Select()
712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)
713.         self.assertIs(wrapper.is_hidden, False)
714.         context = wrapper.get_context('band', None, {})
715.         self.assertIs(context['is_hidden'], False)
716.         output = wrapper.render('name', 'value')
717.         # Related item links are present.
718.         self.assertIn('<a ', output)


File: tests/admin_ordering/tests.py
Line number range: 1 - 10
Content:
1. from django.contrib import admin
2. from django.contrib.admin.options import ModelAdmin
3. from django.contrib.auth.models import User
4. from django.db.models import F
5. from django.test import RequestFactory, TestCase
6. 
7. from .models import (
8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,
9.     SongInlineNewOrdering,
10. )

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-06 03:43:58,906 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants 5 complete test cases related to overriding widgets for many-to-many fields in the Django admin.\n2. I have identified several highly relevant test methods in `tests/admin_ordering/tests.py` and `tests/admin_widgets/tests.py`.\n3. While the context for `tests/admin_ordering/tests.py` is sufficient, the context for `tests/admin_widgets/tests.py` is missing crucial information.\n4. Specifically, to fulfill the user\'s requirement for "complete, self-contained test cases" with "ALL necessary imports", I need the import statements from the top of `tests/admin_widgets/tests.py`.\n5. Additionally, the tests in `tests/admin_widgets/tests.py` depend on models like `Event`, `Member`, `Album`, and `Band`, which are defined in `tests/admin_widgets/models.py`. Access to these model definitions is necessary to fully understand the test setup and provide a complete response.' refined_query='Please provide the full content of `tests/admin_widgets/tests.py` and `tests/admin_widgets/models.py`. The tests in `tests.py` are highly relevant to overriding widgets in admin forms, but I need the full file to get all necessary imports and helper classes. The models in `models.py` are dependencies for these tests and are needed to provide complete, runnable test cases.'
2025-10-06 03:44:02,614 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "tests/admin_widgets/models.py"}'}, '__gemini_function_call_thought_signatures__': {'f213ae10-015a-43be-a912-a4ef5d4ff697': 'CqIGAR/MhbaYem+6LEAIPV7ulJwwoxCm3VYk3vb3R90ZGinA1s8FLHiTvIHKYd+x8bDd+pfcE4SmfsYZt0ekxDU3sFLS3r4+/t1b0WSTuuVe972YOkUYeo9jtkiuTmF4nlCR5CqWwR/cAEtyMKPTu5utA3TvxWoe15Iw0vKBqE9LVh/SJrUi2dLXK3LWNboj/956z6uHlBs4QoX32leWi6vJIZGNKrCEc+aDQC3FVNLfC24K2Lt2+mBQYqQ8HqGkpmEeNkS8a8Wp3nmopsGoOVjnmtdZZCoLk0eIz89n3UZFJBbg+/XgUXTtQTUzTeiuKBGUuHs+ftKsd7U/uy/IURsXGc+w1wqE+O+NnJsOIcKG44vE6dRN/KBEznfFqmZCeq41eN8fXo3MWIXRQTmhFwMUQlQemcDCBs4KLjOrNoafGLbkbl6LhPoSMhATrh9U7sHt4D1D4FEz/kIQBp9XPMCwEI9Ri0BLKNhMILhVomI01S6zffwj2hLANNtU/Mm88+hmDKTVjK8M1x6YXIlBk6Knu+VwPcYnbwecAMW6MNgoa2AxTjv8ni2J41smpAMQKblM8a+NN2D3/Ck6sUJSgqejGF/YOmAE1NczYHXWYZqlxVACR5xrC4yiUSDvsPVvobHI7NKkmk7yoaJ4Xj1PXR4z7lvGJEsYgF31FiBY4JCZAjjVEiOM/stxnjMmLjU1e+/5MMji4ThEwvIo4mH377GH+IQaIiVzwdGAzfN+sYyU7XYlVUY3ifHAXp2kB4kv92PjqX3wpJY9rjEGTE/nbJt+CPYhFO0lhCsA4WgGzHeKB3xelYG3apftd6w2VFyX5u4C1+tJKOFtn8L6CQkp8Fhhjjctgx7oq5VbYKDFcdIyWLGTvhCMkVRkVtsVfXtUFq96BMuZZfYoXurZUgvMLh2xA5QbWh15N/qSsm0yNPtMAYSWORkQ0GNBm5+PvS+oL/NkXGJuYpMhA8djFYQ1e8OdPZKyabj13/xwoswIRywfSbR0oEOvQitrP8B2X9qzBJc28CDwMIClAhOvE5aUgAAOXrWrh2CpqP3EY0mjDwlgDh63Ew=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55079, 'candidates_token_count': 46, 'total_token_count': 55348, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55079}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 46}], 'thoughts_token_count': 223, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.17920274319856064, 'model_name': 'gemini-2.5-pro'} id='run--dab180ab-ee9c-421e-8f4b-b5aced6ec934-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_widgets/tests.py'}, 'id': 'f213ae10-015a-43be-a912-a4ef5d4ff697', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'tests/admin_widgets/models.py'}, 'id': '9b8d548b-4470-4a8c-b79b-acba9defa030', 'type': 'tool_call'}] usage_metadata={'input_tokens': 55079, 'output_tokens': 46, 'total_tokens': 55348, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 223}}
2025-10-06 03:44:06,060 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full content of `tests/admin_widgets/tests.py` and `tests/admin_widgets/models.py` as you requested. This will allow you to examine the complete implementation of the tests and their corresponding models, including all necessary imports and helper classes. These files are essential for understanding how to override widgets in admin forms and for creating runnable test cases.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 65881, 'candidates_token_count': 79, 'total_token_count': 66005, 'prompt_tokens_details': [{'modality': 1, 'token_count': 66102}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 79}], 'thoughts_token_count': 45, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1768431120280978, 'model_name': 'gemini-2.5-pro'} id='run--d71cb5c7-8c68-45a7-8bd6-6bb78cf94ace-0' usage_metadata={'input_tokens': 65881, 'output_tokens': 79, 'total_tokens': 66005, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 45}}
2025-10-06 03:44:06,061 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 03:44:06,061 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Allow overridding widget in formfield_for_manytomany().

Issue description: 
Description
	 
		(last modified by Mariusz Felisiak)
	 
It does not work when I set widget param to function formfield_for_manytomany().
This is different from the formfield_for_foreignkey() function.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the full content of `tests/admin_widgets/tests.py` and `tests/admin_widgets/models.py`. The tests in `tests.py` are highly relevant to overriding widgets in admin forms, but I need the full file to get all necessary imports and helper classes. The models in `models.py` are dependencies for these tests and are needed to provide complete, runnable test cases.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: tests/admin_widgets/tests.py
Line number range: 1 - 500
Content:
1. import gettext
2. import os
3. import re
4. from datetime import datetime, timedelta
5. from importlib import import_module
6. 
7. import pytz
8. 
9. from django import forms
10. from django.conf import settings
11. from django.contrib import admin
12. from django.contrib.admin import widgets
13. from django.contrib.admin.tests import AdminSeleniumTestCase
14. from django.contrib.auth.models import User
15. from django.core.files.storage import default_storage
16. from django.core.files.uploadedfile import SimpleUploadedFile
17. from django.db.models import CharField, DateField, DateTimeField, UUIDField
18. from django.test import SimpleTestCase, TestCase, override_settings
19. from django.urls import reverse
20. from django.utils import translation
21. 
22. from .models import (
23.     Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,
24.     Inventory, Member, MyFileField, Profile, School, Student,
25. )
26. from .widgetadmin import site as widget_admin_site
27. 
28. 
29. class TestDataMixin:
30. 
31.     @classmethod
32.     def setUpTestData(cls):
33.         cls.superuser = User.objects.create_superuser(username='super', password='secret', email=None)
34.         cls.u2 = User.objects.create_user(username='testser', password='secret')
35.         Car.objects.create(owner=cls.superuser, make='Volkswagen', model='Passat')
36.         Car.objects.create(owner=cls.u2, make='BMW', model='M3')
37. 
38. 
39. class AdminFormfieldForDBFieldTests(SimpleTestCase):
40.     """
41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield
42.     """
43. 
44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):
45.         """
46.         Helper to call formfield_for_dbfield for a given model and field name
47.         and verify that the returned formfield is appropriate.
48.         """
49.         # Override any settings on the model admin
50.         class MyModelAdmin(admin.ModelAdmin):
51.             pass
52.         for k in admin_overrides:
53.             setattr(MyModelAdmin, k, admin_overrides[k])
54. 
55.         # Construct the admin, and ask it for a formfield
56.         ma = MyModelAdmin(model, admin.site)
57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)
58. 
59.         # "unwrap" the widget wrapper, if needed
60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):
61.             widget = ff.widget.widget
62.         else:
63.             widget = ff.widget
64. 
65.         self.assertIsInstance(widget, widgetclass)
66. 
67.         # Return the formfield so that other tests can continue
68.         return ff
69. 
70.     def test_DateField(self):
71.         self.assertFormfield(Event, 'start_date', widgets.AdminDateWidget)
72. 
73.     def test_DateTimeField(self):
74.         self.assertFormfield(Member, 'birthdate', widgets.AdminSplitDateTime)
75. 
76.     def test_TimeField(self):
77.         self.assertFormfield(Event, 'start_time', widgets.AdminTimeWidget)
78. 
79.     def test_TextField(self):
80.         self.assertFormfield(Event, 'description', widgets.AdminTextareaWidget)
81. 
82.     def test_URLField(self):
83.         self.assertFormfield(Event, 'link', widgets.AdminURLFieldWidget)
84. 
85.     def test_IntegerField(self):
86.         self.assertFormfield(Event, 'min_age', widgets.AdminIntegerFieldWidget)
87. 
88.     def test_CharField(self):
89.         self.assertFormfield(Member, 'name', widgets.AdminTextInputWidget)
90. 
91.     def test_EmailField(self):
92.         self.assertFormfield(Member, 'email', widgets.AdminEmailInputWidget)
93. 
94.     def test_FileField(self):
95.         self.assertFormfield(Album, 'cover_art', widgets.AdminFileWidget)
96. 
97.     def test_ForeignKey(self):
98.         self.assertFormfield(Event, 'main_band', forms.Select)
99. 
100.     def test_raw_id_ForeignKey(self):
101.         self.assertFormfield(Event, 'main_band', widgets.ForeignKeyRawIdWidget,
102.                              raw_id_fields=['main_band'])
103. 
104.     def test_radio_fields_ForeignKey(self):
105.         ff = self.assertFormfield(Event, 'main_band', widgets.AdminRadioSelect,
106.                                   radio_fields={'main_band': admin.VERTICAL})
107.         self.assertIsNone(ff.empty_label)
108. 
109.     def test_many_to_many(self):
110.         self.assertFormfield(Band, 'members', forms.SelectMultiple)
111. 
112.     def test_raw_id_many_to_many(self):
113.         self.assertFormfield(Band, 'members', widgets.ManyToManyRawIdWidget,
114.                              raw_id_fields=['members'])
115. 
116.     def test_filtered_many_to_many(self):
117.         self.assertFormfield(Band, 'members', widgets.FilteredSelectMultiple,
118.                              filter_vertical=['members'])
119. 
120.     def test_formfield_overrides(self):
121.         self.assertFormfield(Event, 'start_date', forms.TextInput,
122.                              formfield_overrides={DateField: {'widget': forms.TextInput}})
123. 
124.     def test_formfield_overrides_widget_instances(self):
125.         """
126.         Widget instances in formfield_overrides are not shared between
127.         different fields. (#19423)
128.         """
129.         class BandAdmin(admin.ModelAdmin):
130.             formfield_overrides = {
131.                 CharField: {'widget': forms.TextInput(attrs={'size': '10'})}
132.             }
133.         ma = BandAdmin(Band, admin.site)
134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field('name'), request=None)
135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field('style'), request=None)
136.         self.assertNotEqual(f1.widget, f2.widget)
137.         self.assertEqual(f1.widget.attrs['maxlength'], '100')
138.         self.assertEqual(f2.widget.attrs['maxlength'], '20')
139.         self.assertEqual(f2.widget.attrs['size'], '10')
140. 
141.     def test_formfield_overrides_for_datetime_field(self):
142.         """
143.         Overriding the widget for DateTimeField doesn't overrides the default
144.         form_class for that field (#26449).
145.         """
146.         class MemberAdmin(admin.ModelAdmin):
147.             formfield_overrides = {DateTimeField: {'widget': widgets.AdminSplitDateTime}}
148.         ma = MemberAdmin(Member, admin.site)
149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field('birthdate'), request=None)
150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)
151.         self.assertIsInstance(f1, forms.SplitDateTimeField)
152. 
153.     def test_formfield_overrides_for_custom_field(self):
154.         """
155.         formfield_overrides works for a custom field class.
156.         """
157.         class AlbumAdmin(admin.ModelAdmin):
158.             formfield_overrides = {MyFileField: {'widget': forms.TextInput()}}
159.         ma = AlbumAdmin(Member, admin.site)
160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field('backside_art'), request=None)
161.         self.assertIsInstance(f1.widget, forms.TextInput)
162. 
163.     def test_field_with_choices(self):
164.         self.assertFormfield(Member, 'gender', forms.Select)
165. 
166.     def test_choices_with_radio_fields(self):
167.         self.assertFormfield(Member, 'gender', widgets.AdminRadioSelect,
168.                              radio_fields={'gender': admin.VERTICAL})
169. 
170.     def test_inheritance(self):
171.         self.assertFormfield(Album, 'backside_art', widgets.AdminFileWidget)
172. 
173.     def test_m2m_widgets(self):
174.         """m2m fields help text as it applies to admin app (#9321)."""
175.         class AdvisorAdmin(admin.ModelAdmin):
176.             filter_vertical = ['companies']
177. 
178.         self.assertFormfield(Advisor, 'companies', widgets.FilteredSelectMultiple,
179.                              filter_vertical=['companies'])
180.         ma = AdvisorAdmin(Advisor, admin.site)
181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field('companies'), request=None)
182.         self.assertEqual(
183.             f.help_text,
184.             'Hold down “Control”, or “Command” on a Mac, to select more than one.'
185.         )
186. 
187. 
188. @override_settings(ROOT_URLCONF='admin_widgets.urls')
189. class AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):
190. 
191.     def test_filter_choices_by_request_user(self):
192.         """
193.         Ensure the user can only see their own cars in the foreign key dropdown.
194.         """
195.         self.client.force_login(self.superuser)
196.         response = self.client.get(reverse('admin:admin_widgets_cartire_add'))
197.         self.assertNotContains(response, "BMW M3")
198.         self.assertContains(response, "Volkswagen Passat")
199. 
200. 
201. @override_settings(ROOT_URLCONF='admin_widgets.urls')
202. class AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):
203. 
204.     def setUp(self):
205.         self.client.force_login(self.superuser)
206. 
207.     def test_changelist_ForeignKey(self):
208.         response = self.client.get(reverse('admin:admin_widgets_car_changelist'))
209.         self.assertContains(response, '/auth/user/add/')
210. 
211. 
212. @override_settings(ROOT_URLCONF='admin_widgets.urls')
213. class AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):
214. 
215.     def setUp(self):
216.         self.client.force_login(self.superuser)
217. 
218.     def test_nonexistent_target_id(self):
219.         band = Band.objects.create(name='Bogey Blues')
220.         pk = band.pk
221.         band.delete()
222.         post_data = {
223.             "main_band": '%s' % pk,
224.         }
225.         # Try posting with a nonexistent pk in a raw id field: this
226.         # should result in an error message, not a server exception.
227.         response = self.client.post(reverse('admin:admin_widgets_event_add'), post_data)
228.         self.assertContains(response, 'Select a valid choice. That choice is not one of the available choices.')
229. 
230.     def test_invalid_target_id(self):
231. 
232.         for test_str in ('Iñtërnâtiônàlizætiøn', "1234'", -1234):
233.             # This should result in an error message, not a server exception.
234.             response = self.client.post(reverse('admin:admin_widgets_event_add'), {"main_band": test_str})
235. 
236.             self.assertContains(response, 'Select a valid choice. That choice is not one of the available choices.')
237. 
238.     def test_url_params_from_lookup_dict_any_iterable(self):
239.         lookup1 = widgets.url_params_from_lookup_dict({'color__in': ('red', 'blue')})
240.         lookup2 = widgets.url_params_from_lookup_dict({'color__in': ['red', 'blue']})
241.         self.assertEqual(lookup1, {'color__in': 'red,blue'})
242.         self.assertEqual(lookup1, lookup2)
243. 
244.     def test_url_params_from_lookup_dict_callable(self):
245.         def my_callable():
246.             return 'works'
247.         lookup1 = widgets.url_params_from_lookup_dict({'myfield': my_callable})
248.         lookup2 = widgets.url_params_from_lookup_dict({'myfield': my_callable()})
249.         self.assertEqual(lookup1, lookup2)
250. 
251.     def test_label_and_url_for_value_invalid_uuid(self):
252.         field = Bee._meta.get_field('honeycomb')
253.         self.assertIsInstance(field.target_field, UUIDField)
254.         widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)
255.         self.assertEqual(widget.label_and_url_for_value('invalid-uuid'), ('', ''))
256. 
257. 
258. class FilteredSelectMultipleWidgetTest(SimpleTestCase):
259.     def test_render(self):
260.         # Backslash in verbose_name to ensure it is JavaScript escaped.
261.         w = widgets.FilteredSelectMultiple('test\\', False)
262.         self.assertHTMLEqual(
263.             w.render('test', 'test'),
264.             '<select multiple name="test" class="selectfilter" '
265.             'data-field-name="test\\" data-is-stacked="0">\n</select>'
266.         )
267. 
268.     def test_stacked_render(self):
269.         # Backslash in verbose_name to ensure it is JavaScript escaped.
270.         w = widgets.FilteredSelectMultiple('test\\', True)
271.         self.assertHTMLEqual(
272.             w.render('test', 'test'),
273.             '<select multiple name="test" class="selectfilterstacked" '
274.             'data-field-name="test\\" data-is-stacked="1">\n</select>'
275.         )
276. 
277. 
278. class AdminDateWidgetTest(SimpleTestCase):
279.     def test_attrs(self):
280.         w = widgets.AdminDateWidget()
281.         self.assertHTMLEqual(
282.             w.render('test', datetime(2007, 12, 1, 9, 30)),
283.             '<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">',
284.         )
285.         # pass attrs to widget
286.         w = widgets.AdminDateWidget(attrs={'size': 20, 'class': 'myDateField'})
287.         self.assertHTMLEqual(
288.             w.render('test', datetime(2007, 12, 1, 9, 30)),
289.             '<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">',
290.         )
291. 
292. 
293. class AdminTimeWidgetTest(SimpleTestCase):
294.     def test_attrs(self):
295.         w = widgets.AdminTimeWidget()
296.         self.assertHTMLEqual(
297.             w.render('test', datetime(2007, 12, 1, 9, 30)),
298.             '<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">',
299.         )
300.         # pass attrs to widget
301.         w = widgets.AdminTimeWidget(attrs={'size': 20, 'class': 'myTimeField'})
302.         self.assertHTMLEqual(
303.             w.render('test', datetime(2007, 12, 1, 9, 30)),
304.             '<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">',
305.         )
306. 
307. 
308. class AdminSplitDateTimeWidgetTest(SimpleTestCase):
309.     def test_render(self):
310.         w = widgets.AdminSplitDateTime()
311.         self.assertHTMLEqual(
312.             w.render('test', datetime(2007, 12, 1, 9, 30)),
313.             '<p class="datetime">'
314.             'Date: <input value="2007-12-01" type="text" class="vDateField" '
315.             'name="test_0" size="10"><br>'
316.             'Time: <input value="09:30:00" type="text" class="vTimeField" '
317.             'name="test_1" size="8"></p>'
318.         )
319. 
320.     def test_localization(self):
321.         w = widgets.AdminSplitDateTime()
322. 
323.         with self.settings(USE_L10N=True), translation.override('de-at'):
324.             w.is_localized = True
325.             self.assertHTMLEqual(
326.                 w.render('test', datetime(2007, 12, 1, 9, 30)),
327.                 '<p class="datetime">'
328.                 'Datum: <input value="01.12.2007" type="text" '
329.                 'class="vDateField" name="test_0"size="10"><br>'
330.                 'Zeit: <input value="09:30:00" type="text" class="vTimeField" '
331.                 'name="test_1" size="8"></p>'
332.             )
333. 
334. 
335. class AdminURLWidgetTest(SimpleTestCase):
336.     def test_get_context_validates_url(self):
337.         w = widgets.AdminURLFieldWidget()
338.         for invalid in ['', '/not/a/full/url/', 'javascript:alert("Danger XSS!")']:
339.             with self.subTest(url=invalid):
340.                 self.assertFalse(w.get_context('name', invalid, {})['url_valid'])
341.         self.assertTrue(w.get_context('name', 'http://example.com', {})['url_valid'])
342. 
343.     def test_render(self):
344.         w = widgets.AdminURLFieldWidget()
345.         self.assertHTMLEqual(
346.             w.render('test', ''),
347.             '<input class="vURLField" name="test" type="url">'
348.         )
349.         self.assertHTMLEqual(
350.             w.render('test', 'http://example.com'),
351.             '<p class="url">Currently:<a href="http://example.com">'
352.             'http://example.com</a><br>'
353.             'Change:<input class="vURLField" name="test" type="url" '
354.             'value="http://example.com"></p>'
355.         )
356. 
357.     def test_render_idn(self):
358.         w = widgets.AdminURLFieldWidget()
359.         self.assertHTMLEqual(
360.             w.render('test', 'http://example-äüö.com'),
361.             '<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">'
362.             'http://example-äüö.com</a><br>'
363.             'Change:<input class="vURLField" name="test" type="url" '
364.             'value="http://example-äüö.com"></p>'
365.         )
366. 
367.     def test_render_quoting(self):
368.         """
369.         WARNING: This test doesn't use assertHTMLEqual since it will get rid
370.         of some escapes which are tested here!
371.         """
372.         HREF_RE = re.compile('href="([^"]+)"')
373.         VALUE_RE = re.compile('value="([^"]+)"')
374.         TEXT_RE = re.compile('<a[^>]+>([^>]+)</a>')
375.         w = widgets.AdminURLFieldWidget()
376.         output = w.render('test', 'http://example.com/<sometag>some-text</sometag>')
377.         self.assertEqual(
378.             HREF_RE.search(output).groups()[0],
379.             'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E',
380.         )
381.         self.assertEqual(
382.             TEXT_RE.search(output).groups()[0],
383.             'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
384.         )
385.         self.assertEqual(
386.             VALUE_RE.search(output).groups()[0],
387.             'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
388.         )
389.         output = w.render('test', 'http://example-äüö.com/<sometag>some-text</sometag>')
390.         self.assertEqual(
391.             HREF_RE.search(output).groups()[0],
392.             'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E',
393.         )
394.         self.assertEqual(
395.             TEXT_RE.search(output).groups()[0],
396.             'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
397.         )
398.         self.assertEqual(
399.             VALUE_RE.search(output).groups()[0],
400.             'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;',
401.         )
402.         output = w.render('test', 'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"')
403.         self.assertEqual(
404.             HREF_RE.search(output).groups()[0],
405.             'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22',
406.         )
407.         self.assertEqual(
408.             TEXT_RE.search(output).groups()[0],
409.             'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;'
410.             'alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;'
411.         )
412.         self.assertEqual(
413.             VALUE_RE.search(output).groups()[0],
414.             'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;',
415.         )
416. 
417. 
418. class AdminUUIDWidgetTests(SimpleTestCase):
419.     def test_attrs(self):
420.         w = widgets.AdminUUIDInputWidget()
421.         self.assertHTMLEqual(
422.             w.render('test', '550e8400-e29b-41d4-a716-446655440000'),
423.             '<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">',
424.         )
425.         w = widgets.AdminUUIDInputWidget(attrs={'class': 'myUUIDInput'})
426.         self.assertHTMLEqual(
427.             w.render('test', '550e8400-e29b-41d4-a716-446655440000'),
428.             '<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">',
429.         )
430. 
431. 
432. @override_settings(ROOT_URLCONF='admin_widgets.urls')
433. class AdminFileWidgetTests(TestDataMixin, TestCase):
434. 
435.     @classmethod
436.     def setUpTestData(cls):
437.         super().setUpTestData()
438.         band = Band.objects.create(name='Linkin Park')
439.         cls.album = band.album_set.create(
440.             name='Hybrid Theory', cover_art=r'albums\hybrid_theory.jpg'
441.         )
442. 
443.     def test_render(self):
444.         w = widgets.AdminFileWidget()
445.         self.assertHTMLEqual(
446.             w.render('test', self.album.cover_art),
447.             '<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/'
448.             r'hybrid_theory.jpg">albums\hybrid_theory.jpg</a> '
449.             '<span class="clearable-file-input">'
450.             '<input type="checkbox" name="test-clear" id="test-clear_id"> '
451.             '<label for="test-clear_id">Clear</label></span><br>'
452.             'Change: <input type="file" name="test"></p>' % {
453.                 'STORAGE_URL': default_storage.url(''),
454.             },
455.         )
456.         self.assertHTMLEqual(
457.             w.render('test', SimpleUploadedFile('test', b'content')),
458.             '<input type="file" name="test">',
459.         )
460. 
461.     def test_render_required(self):
462.         widget = widgets.AdminFileWidget()
463.         widget.is_required = True
464.         self.assertHTMLEqual(
465.             widget.render('test', self.album.cover_art),
466.             '<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/'
467.             r'hybrid_theory.jpg">albums\hybrid_theory.jpg</a><br>'
468.             'Change: <input type="file" name="test"></p>' % {
469.                 'STORAGE_URL': default_storage.url(''),
470.             },
471.         )
472. 
473.     def test_readonly_fields(self):
474.         """
475.         File widgets should render as a link when they're marked "read only."
476.         """
477.         self.client.force_login(self.superuser)
478.         response = self.client.get(reverse('admin:admin_widgets_album_change', args=(self.album.id,)))
479.         self.assertContains(
480.             response,
481.             '<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">'
482.             r'albums\hybrid_theory.jpg</a></div>' % {'STORAGE_URL': default_storage.url('')},
483.             html=True,
484.         )
485.         self.assertNotContains(
486.             response,
487.             '<input type="file" name="cover_art" id="id_cover_art">',
488.             html=True,
489.         )
490.         response = self.client.get(reverse('admin:admin_widgets_album_add'))
491.         self.assertContains(
492.             response,
493.             '<div class="readonly"></div>',
494.             html=True,
495.         )
496. 
497. 
498. @override_settings(ROOT_URLCONF='admin_widgets.urls')
499. class ForeignKeyRawIdWidgetTest(TestCase):
500.

File: tests/admin_widgets/models.py
Line number range: 1 - 158
Content:
1. import uuid
2. 
3. from django.contrib.auth.models import User
4. from django.db import models
5. 
6. 
7. class MyFileField(models.FileField):
8.     pass
9. 
10. 
11. class Member(models.Model):
12.     name = models.CharField(max_length=100)
13.     birthdate = models.DateTimeField(blank=True, null=True)
14.     gender = models.CharField(max_length=1, blank=True, choices=[('M', 'Male'), ('F', 'Female')])
15.     email = models.EmailField(blank=True)
16. 
17.     def __str__(self):
18.         return self.name
19. 
20. 
21. class Band(models.Model):
22.     name = models.CharField(max_length=100)
23.     style = models.CharField(max_length=20)
24.     members = models.ManyToManyField(Member)
25. 
26.     def __str__(self):
27.         return self.name
28. 
29. 
30. class Album(models.Model):
31.     band = models.ForeignKey(Band, models.CASCADE)
32.     featuring = models.ManyToManyField(Band, related_name='featured')
33.     name = models.CharField(max_length=100)
34.     cover_art = models.FileField(upload_to='albums')
35.     backside_art = MyFileField(upload_to='albums_back', null=True)
36. 
37.     def __str__(self):
38.         return self.name
39. 
40. 
41. class HiddenInventoryManager(models.Manager):
42.     def get_queryset(self):
43.         return super().get_queryset().filter(hidden=False)
44. 
45. 
46. class Inventory(models.Model):
47.     barcode = models.PositiveIntegerField(unique=True)
48.     parent = models.ForeignKey('self', models.SET_NULL, to_field='barcode', blank=True, null=True)
49.     name = models.CharField(blank=False, max_length=20)
50.     hidden = models.BooleanField(default=False)
51. 
52.     # see #9258
53.     default_manager = models.Manager()
54.     objects = HiddenInventoryManager()
55. 
56.     def __str__(self):
57.         return self.name
58. 
59. 
60. class Event(models.Model):
61.     main_band = models.ForeignKey(
62.         Band,
63.         models.CASCADE,
64.         limit_choices_to=models.Q(pk__gt=0),
65.         related_name='events_main_band_at',
66.     )
67.     supporting_bands = models.ManyToManyField(
68.         Band,
69.         blank=True,
70.         related_name='events_supporting_band_at',
71.         help_text='Supporting Bands.',
72.     )
73.     start_date = models.DateField(blank=True, null=True)
74.     start_time = models.TimeField(blank=True, null=True)
75.     description = models.TextField(blank=True)
76.     link = models.URLField(blank=True)
77.     min_age = models.IntegerField(blank=True, null=True)
78. 
79. 
80. class Car(models.Model):
81.     owner = models.ForeignKey(User, models.CASCADE)
82.     make = models.CharField(max_length=30)
83.     model = models.CharField(max_length=30)
84. 
85.     def __str__(self):
86.         return "%s %s" % (self.make, self.model)
87. 
88. 
89. class CarTire(models.Model):
90.     """
91.     A single car tire. This to test that a user can only select their own cars.
92.     """
93.     car = models.ForeignKey(Car, models.CASCADE)
94. 
95. 
96. class Honeycomb(models.Model):
97.     id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)
98.     location = models.CharField(max_length=20)
99. 
100. 
101. class Bee(models.Model):
102.     """
103.     A model with a FK to a model that won't be registered with the admin
104.     (Honeycomb) so the corresponding raw ID widget won't have a magnifying
105.     glass link to select related honeycomb instances.
106.     """
107.     honeycomb = models.ForeignKey(Honeycomb, models.CASCADE)
108. 
109. 
110. class Individual(models.Model):
111.     """
112.     A model with a FK to itself. It won't be registered with the admin, so the
113.     corresponding raw ID widget won't have a magnifying glass link to select
114.     related instances (rendering will be called programmatically in this case).
115.     """
116.     name = models.CharField(max_length=20)
117.     parent = models.ForeignKey('self', models.SET_NULL, null=True)
118.     soulmate = models.ForeignKey('self', models.CASCADE, null=True, related_name='soulmates')
119. 
120. 
121. class Company(models.Model):
122.     name = models.CharField(max_length=20)
123. 
124. 
125. class Advisor(models.Model):
126.     """
127.     A model with a m2m to a model that won't be registered with the admin
128.     (Company) so the corresponding raw ID widget won't have a magnifying
129.     glass link to select related company instances.
130.     """
131.     name = models.CharField(max_length=20)
132.     companies = models.ManyToManyField(Company)
133. 
134. 
135. class Student(models.Model):
136.     name = models.CharField(max_length=255)
137. 
138.     class Meta:
139.         ordering = ('name',)
140. 
141.     def __str__(self):
142.         return self.name
143. 
144. 
145. class School(models.Model):
146.     name = models.CharField(max_length=255)
147.     students = models.ManyToManyField(Student, related_name='current_schools')
148.     alumni = models.ManyToManyField(Student, related_name='previous_schools')
149. 
150.     def __str__(self):
151.         return self.name
152. 
153. 
154. class Profile(models.Model):
155.     user = models.ForeignKey('auth.User', models.CASCADE, to_field='username')
156. 
157.     def __str__(self):
158.         return self.user.username


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 03:44:26,619 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's refinement query explicitly asks for the full content of `tests/admin_widgets/tests.py`.\n   - The user states that this file is highly relevant to their original query about overriding widgets in admin forms.\n\n2. Extended relevance:\n   - This file contains a comprehensive test suite for Django admin widgets, which is directly related to the user's problem.\n   - It includes tests for `formfield_for_dbfield`, which handles widget generation for model fields in the admin.\n   - Specifically, it has tests for `many_to_many` fields (`test_many_to_many`, `test_raw_id_many_to_many`, `test_filtered_many_to_many`) and `formfield_overrides`, which are central to the user's issue.\n   - Providing the full file, as requested, gives all necessary imports, helper classes (`TestDataMixin`, `AdminFormfieldForDBFieldTests`), and test methods required to create a complete and runnable test case.", relative_path='tests/admin_widgets/tests.py', start_line=1, end_line=500), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's refinement query explicitly asks for the full content of `tests/admin_widgets/models.py`.\n   - The user identifies this file as a necessary dependency for the tests in `tests/admin_widgets/tests.py`.\n\n2. Extended relevance:\n   - This file defines all the database models (`Band`, `Member`, `Event`, `Album`, etc.) that are used in the tests within `tests/admin_widgets/tests.py`.\n   - The model definitions, especially the `ManyToManyField` relationships (like in the `Band` model), are critical for understanding and reproducing the tests related to the user's issue of overriding `formfield_for_manytomany`.\n   - Including this file is essential to fulfill the requirement of providing complete and runnable test cases.", relative_path='tests/admin_widgets/models.py', start_line=1, end_line=158)]
2025-10-06 03:44:26,620 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='tests/admin_ordering/tests.py', content='123. class TestRelatedFieldsAdminOrdering(TestCase):\n124.     @classmethod\n125.     def setUpTestData(cls):\n126.         cls.b1 = Band.objects.create(name=\'Pink Floyd\', bio=\'\', rank=1)\n127.         cls.b2 = Band.objects.create(name=\'Foo Fighters\', bio=\'\', rank=5)\n128. \n129.     def setUp(self):\n130.         # we need to register a custom ModelAdmin (instead of just using\n131.         # ModelAdmin) because the field creator tries to find the ModelAdmin\n132.         # for the related model\n133.         class SongAdmin(admin.ModelAdmin):\n134.             pass\n135.         site.register(Song, SongAdmin)\n136. \n137.     def tearDown(self):\n138.         site.unregister(Song)\n139.         if Band in site._registry:\n140.             site.unregister(Band)\n141. \n142.     def check_ordering_of_field_choices(self, correct_ordering):\n143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)\n144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)\n145.         self.assertEqual(list(fk_field.queryset), correct_ordering)\n146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)\n147. \n148.     def test_no_admin_fallback_to_model_ordering(self):\n149.         # should be ordered by name (as defined by the model)\n150.         self.check_ordering_of_field_choices([self.b2, self.b1])\n151. \n152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):\n153.         class NoOrderingBandAdmin(admin.ModelAdmin):\n154.             pass\n155.         site.register(Band, NoOrderingBandAdmin)\n156. \n157.         # should be ordered by name (as defined by the model)\n158.         self.check_ordering_of_field_choices([self.b2, self.b1])\n159. \n160.     def test_admin_ordering_beats_model_ordering(self):\n161.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n162.             ordering = (\'rank\',)\n163.         site.register(Band, StaticOrderingBandAdmin)\n164. \n165.         # should be ordered by rank (defined by the ModelAdmin)\n166.         self.check_ordering_of_field_choices([self.b1, self.b2])\n167. \n168.     def test_custom_queryset_still_wins(self):\n169.         """Custom queryset has still precedence (#21405)"""\n170.         class SongAdmin(admin.ModelAdmin):\n171.             # Exclude one of the two Bands from the querysets\n172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):\n173.                 if db_field.name == \'band\':\n174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n176. \n177.             def formfield_for_manytomany(self, db_field, request, **kwargs):\n178.                 if db_field.name == \'other_interpreters\':\n179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n181. \n182.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n183.             ordering = (\'rank\',)\n184. \n185.         site.unregister(Song)\n186.         site.register(Song, SongAdmin)\n187.         site.register(Band, StaticOrderingBandAdmin)\n188. \n189.         self.check_ordering_of_field_choices([self.b2])', start_line_number=123, end_line_number=189), Context(relative_path='django/contrib/auth/admin.py', content="25. @admin.register(Group)\n26. class GroupAdmin(admin.ModelAdmin):\n27.     search_fields = ('name',)\n28.     ordering = ('name',)\n29.     filter_horizontal = ('permissions',)\n30. \n31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):\n32.         if db_field.name == 'permissions':\n33.             qs = kwargs.get('queryset', db_field.remote_field.model.objects)\n34.             # Avoid a major performance hit resolving permission names which\n35.             # triggers a content_type load:\n36.             kwargs['queryset'] = qs.select_related('content_type')\n37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)", start_line_number=25, end_line_number=37), Context(relative_path='tests/admin_views/tests.py', content='5262. @override_settings(ROOT_URLCONF=\'admin_views.urls\')\n5263. class GroupAdminTest(TestCase):\n5264.     """\n5265.     Tests group CRUD functionality.\n5266.     """\n5267. \n5268.     @classmethod\n5269.     def setUpTestData(cls):\n5270.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n5271. \n5272.     def setUp(self):\n5273.         self.client.force_login(self.superuser)\n5274. \n5275.     def test_save_button(self):\n5276.         group_count = Group.objects.count()\n5277.         response = self.client.post(reverse(\'admin:auth_group_add\'), {\n5278.             \'name\': \'newgroup\',\n5279.         })\n5280. \n5281.         Group.objects.order_by(\'-id\')[0]\n5282.         self.assertRedirects(response, reverse(\'admin:auth_group_changelist\'))\n5283.         self.assertEqual(Group.objects.count(), group_count + 1)\n5284. \n5285.     def test_group_permission_performance(self):\n5286.         g = Group.objects.create(name="test_group")\n5287. \n5288.         # Ensure no queries are skipped due to cached content type for Group.\n5289.         ContentType.objects.clear_cache()\n5290. \n5291.         with self.assertNumQueries(8):\n5292.             response = self.client.get(reverse(\'admin:auth_group_change\', args=(g.pk,)))\n5293.             self.assertEqual(response.status_code, 200)', start_line_number=5262, end_line_number=5293), Context(relative_path='tests/admin_widgets/tests.py', content="638. @override_settings(ROOT_URLCONF='admin_widgets.urls')\n639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):\n640.     def test_no_can_add_related(self):\n641.         rel = Individual._meta.get_field('parent').remote_field\n642.         w = widgets.AdminRadioSelect()\n643.         # Used to fail with a name error.\n644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n645.         self.assertFalse(w.can_add_related)\n646. \n647.     def test_select_multiple_widget_cant_change_delete_related(self):\n648.         rel = Individual._meta.get_field('parent').remote_field\n649.         widget = forms.SelectMultiple()\n650.         wrapper = widgets.RelatedFieldWidgetWrapper(\n651.             widget, rel, widget_admin_site,\n652.             can_add_related=True,\n653.             can_change_related=True,\n654.             can_delete_related=True,\n655.         )\n656.         self.assertTrue(wrapper.can_add_related)\n657.         self.assertFalse(wrapper.can_change_related)\n658.         self.assertFalse(wrapper.can_delete_related)\n659. \n660.     def test_on_delete_cascade_rel_cant_delete_related(self):\n661.         rel = Individual._meta.get_field('soulmate').remote_field\n662.         widget = forms.Select()\n663.         wrapper = widgets.RelatedFieldWidgetWrapper(\n664.             widget, rel, widget_admin_site,\n665.             can_add_related=True,\n666.             can_change_related=True,\n667.             can_delete_related=True,\n668.         )\n669.         self.assertTrue(wrapper.can_add_related)\n670.         self.assertTrue(wrapper.can_change_related)\n671.         self.assertFalse(wrapper.can_delete_related)\n672. \n673.     def test_custom_widget_render(self):\n674.         class CustomWidget(forms.Select):\n675.             def render(self, *args, **kwargs):\n676.                 return 'custom render output'\n677.         rel = Album._meta.get_field('band').remote_field\n678.         widget = CustomWidget()\n679.         wrapper = widgets.RelatedFieldWidgetWrapper(\n680.             widget, rel, widget_admin_site,\n681.             can_add_related=True,\n682.             can_change_related=True,\n683.             can_delete_related=True,\n684.         )\n685.         output = wrapper.render('name', 'value')\n686.         self.assertIn('custom render output', output)\n687. \n688.     def test_widget_delegates_value_omitted_from_data(self):\n689.         class CustomWidget(forms.Select):\n690.             def value_omitted_from_data(self, data, files, name):\n691.                 return False\n692.         rel = Album._meta.get_field('band').remote_field\n693.         widget = CustomWidget()\n694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)\n696. \n697.     def test_widget_is_hidden(self):\n698.         rel = Album._meta.get_field('band').remote_field\n699.         widget = forms.HiddenInput()\n700.         widget.choices = ()\n701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n702.         self.assertIs(wrapper.is_hidden, True)\n703.         context = wrapper.get_context('band', None, {})\n704.         self.assertIs(context['is_hidden'], True)\n705.         output = wrapper.render('name', 'value')\n706.         # Related item links are hidden.\n707.         self.assertNotIn('<a ', output)\n708. \n709.     def test_widget_is_not_hidden(self):\n710.         rel = Album._meta.get_field('band').remote_field\n711.         widget = forms.Select()\n712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n713.         self.assertIs(wrapper.is_hidden, False)\n714.         context = wrapper.get_context('band', None, {})\n715.         self.assertIs(context['is_hidden'], False)\n716.         output = wrapper.render('name', 'value')\n717.         # Related item links are present.\n718.         self.assertIn('<a ', output)", start_line_number=638, end_line_number=718), Context(relative_path='tests/admin_ordering/tests.py', content='1. from django.contrib import admin\n2. from django.contrib.admin.options import ModelAdmin\n3. from django.contrib.auth.models import User\n4. from django.db.models import F\n5. from django.test import RequestFactory, TestCase\n6. \n7. from .models import (\n8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,\n9.     SongInlineNewOrdering,\n10. )', start_line_number=1, end_line_number=10), Context(relative_path='tests/admin_widgets/tests.py', content='1. import gettext\n2. import os\n3. import re\n4. from datetime import datetime, timedelta\n5. from importlib import import_module\n6. \n7. import pytz\n8. \n9. from django import forms\n10. from django.conf import settings\n11. from django.contrib import admin\n12. from django.contrib.admin import widgets\n13. from django.contrib.admin.tests import AdminSeleniumTestCase\n14. from django.contrib.auth.models import User\n15. from django.core.files.storage import default_storage\n16. from django.core.files.uploadedfile import SimpleUploadedFile\n17. from django.db.models import CharField, DateField, DateTimeField, UUIDField\n18. from django.test import SimpleTestCase, TestCase, override_settings\n19. from django.urls import reverse\n20. from django.utils import translation\n21. \n22. from .models import (\n23.     Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,\n24.     Inventory, Member, MyFileField, Profile, School, Student,\n25. )\n26. from .widgetadmin import site as widget_admin_site\n27. \n28. \n29. class TestDataMixin:\n30. \n31.     @classmethod\n32.     def setUpTestData(cls):\n33.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=None)\n34.         cls.u2 = User.objects.create_user(username=\'testser\', password=\'secret\')\n35.         Car.objects.create(owner=cls.superuser, make=\'Volkswagen\', model=\'Passat\')\n36.         Car.objects.create(owner=cls.u2, make=\'BMW\', model=\'M3\')\n37. \n38. \n39. class AdminFormfieldForDBFieldTests(SimpleTestCase):\n40.     """\n41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n42.     """\n43. \n44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n45.         """\n46.         Helper to call formfield_for_dbfield for a given model and field name\n47.         and verify that the returned formfield is appropriate.\n48.         """\n49.         # Override any settings on the model admin\n50.         class MyModelAdmin(admin.ModelAdmin):\n51.             pass\n52.         for k in admin_overrides:\n53.             setattr(MyModelAdmin, k, admin_overrides[k])\n54. \n55.         # Construct the admin, and ask it for a formfield\n56.         ma = MyModelAdmin(model, admin.site)\n57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n58. \n59.         # "unwrap" the widget wrapper, if needed\n60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n61.             widget = ff.widget.widget\n62.         else:\n63.             widget = ff.widget\n64. \n65.         self.assertIsInstance(widget, widgetclass)\n66. \n67.         # Return the formfield so that other tests can continue\n68.         return ff\n69. \n70.     def test_DateField(self):\n71.         self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n72. \n73.     def test_DateTimeField(self):\n74.         self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n75. \n76.     def test_TimeField(self):\n77.         self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n78. \n79.     def test_TextField(self):\n80.         self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n81. \n82.     def test_URLField(self):\n83.         self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n84. \n85.     def test_IntegerField(self):\n86.         self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n87. \n88.     def test_CharField(self):\n89.         self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n90. \n91.     def test_EmailField(self):\n92.         self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n93. \n94.     def test_FileField(self):\n95.         self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n96. \n97.     def test_ForeignKey(self):\n98.         self.assertFormfield(Event, \'main_band\', forms.Select)\n99. \n100.     def test_raw_id_ForeignKey(self):\n101.         self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n102.                              raw_id_fields=[\'main_band\'])\n103. \n104.     def test_radio_fields_ForeignKey(self):\n105.         ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n106.                                   radio_fields={\'main_band\': admin.VERTICAL})\n107.         self.assertIsNone(ff.empty_label)\n108. \n109.     def test_many_to_many(self):\n110.         self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n111. \n112.     def test_raw_id_many_to_many(self):\n113.         self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n114.                              raw_id_fields=[\'members\'])\n115. \n116.     def test_filtered_many_to_many(self):\n117.         self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n118.                              filter_vertical=[\'members\'])\n119. \n120.     def test_formfield_overrides(self):\n121.         self.assertFormfield(Event, \'start_date\', forms.TextInput,\n122.                              formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n123. \n124.     def test_formfield_overrides_widget_instances(self):\n125.         """\n126.         Widget instances in formfield_overrides are not shared between\n127.         different fields. (#19423)\n128.         """\n129.         class BandAdmin(admin.ModelAdmin):\n130.             formfield_overrides = {\n131.                 CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n132.             }\n133.         ma = BandAdmin(Band, admin.site)\n134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n136.         self.assertNotEqual(f1.widget, f2.widget)\n137.         self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n138.         self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n139.         self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n140. \n141.     def test_formfield_overrides_for_datetime_field(self):\n142.         """\n143.         Overriding the widget for DateTimeField doesn\'t overrides the default\n144.         form_class for that field (#26449).\n145.         """\n146.         class MemberAdmin(admin.ModelAdmin):\n147.             formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n148.         ma = MemberAdmin(Member, admin.site)\n149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n151.         self.assertIsInstance(f1, forms.SplitDateTimeField)\n152. \n153.     def test_formfield_overrides_for_custom_field(self):\n154.         """\n155.         formfield_overrides works for a custom field class.\n156.         """\n157.         class AlbumAdmin(admin.ModelAdmin):\n158.             formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n159.         ma = AlbumAdmin(Member, admin.site)\n160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n161.         self.assertIsInstance(f1.widget, forms.TextInput)\n162. \n163.     def test_field_with_choices(self):\n164.         self.assertFormfield(Member, \'gender\', forms.Select)\n165. \n166.     def test_choices_with_radio_fields(self):\n167.         self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n168.                              radio_fields={\'gender\': admin.VERTICAL})\n169. \n170.     def test_inheritance(self):\n171.         self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n172. \n173.     def test_m2m_widgets(self):\n174.         """m2m fields help text as it applies to admin app (#9321)."""\n175.         class AdvisorAdmin(admin.ModelAdmin):\n176.             filter_vertical = [\'companies\']\n177. \n178.         self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n179.                              filter_vertical=[\'companies\'])\n180.         ma = AdvisorAdmin(Advisor, admin.site)\n181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n182.         self.assertEqual(\n183.             f.help_text,\n184.             \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n185.         )\n186. \n187. \n188. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n189. class AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):\n190. \n191.     def test_filter_choices_by_request_user(self):\n192.         """\n193.         Ensure the user can only see their own cars in the foreign key dropdown.\n194.         """\n195.         self.client.force_login(self.superuser)\n196.         response = self.client.get(reverse(\'admin:admin_widgets_cartire_add\'))\n197.         self.assertNotContains(response, "BMW M3")\n198.         self.assertContains(response, "Volkswagen Passat")\n199. \n200. \n201. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n202. class AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):\n203. \n204.     def setUp(self):\n205.         self.client.force_login(self.superuser)\n206. \n207.     def test_changelist_ForeignKey(self):\n208.         response = self.client.get(reverse(\'admin:admin_widgets_car_changelist\'))\n209.         self.assertContains(response, \'/auth/user/add/\')\n210. \n211. \n212. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n213. class AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):\n214. \n215.     def setUp(self):\n216.         self.client.force_login(self.superuser)\n217. \n218.     def test_nonexistent_target_id(self):\n219.         band = Band.objects.create(name=\'Bogey Blues\')\n220.         pk = band.pk\n221.         band.delete()\n222.         post_data = {\n223.             "main_band": \'%s\' % pk,\n224.         }\n225.         # Try posting with a nonexistent pk in a raw id field: this\n226.         # should result in an error message, not a server exception.\n227.         response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), post_data)\n228.         self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n229. \n230.     def test_invalid_target_id(self):\n231. \n232.         for test_str in (\'Iñtërnâtiônàlizætiøn\', "1234\'", -1234):\n233.             # This should result in an error message, not a server exception.\n234.             response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), {"main_band": test_str})\n235. \n236.             self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n237. \n238.     def test_url_params_from_lookup_dict_any_iterable(self):\n239.         lookup1 = widgets.url_params_from_lookup_dict({\'color__in\': (\'red\', \'blue\')})\n240.         lookup2 = widgets.url_params_from_lookup_dict({\'color__in\': [\'red\', \'blue\']})\n241.         self.assertEqual(lookup1, {\'color__in\': \'red,blue\'})\n242.         self.assertEqual(lookup1, lookup2)\n243. \n244.     def test_url_params_from_lookup_dict_callable(self):\n245.         def my_callable():\n246.             return \'works\'\n247.         lookup1 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable})\n248.         lookup2 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable()})\n249.         self.assertEqual(lookup1, lookup2)\n250. \n251.     def test_label_and_url_for_value_invalid_uuid(self):\n252.         field = Bee._meta.get_field(\'honeycomb\')\n253.         self.assertIsInstance(field.target_field, UUIDField)\n254.         widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)\n255.         self.assertEqual(widget.label_and_url_for_value(\'invalid-uuid\'), (\'\', \'\'))\n256. \n257. \n258. class FilteredSelectMultipleWidgetTest(SimpleTestCase):\n259.     def test_render(self):\n260.         # Backslash in verbose_name to ensure it is JavaScript escaped.\n261.         w = widgets.FilteredSelectMultiple(\'test\\\\\', False)\n262.         self.assertHTMLEqual(\n263.             w.render(\'test\', \'test\'),\n264.             \'<select multiple name="test" class="selectfilter" \'\n265.             \'data-field-name="test\\\\" data-is-stacked="0">\\n</select>\'\n266.         )\n267. \n268.     def test_stacked_render(self):\n269.         # Backslash in verbose_name to ensure it is JavaScript escaped.\n270.         w = widgets.FilteredSelectMultiple(\'test\\\\\', True)\n271.         self.assertHTMLEqual(\n272.             w.render(\'test\', \'test\'),\n273.             \'<select multiple name="test" class="selectfilterstacked" \'\n274.             \'data-field-name="test\\\\" data-is-stacked="1">\\n</select>\'\n275.         )\n276. \n277. \n278. class AdminDateWidgetTest(SimpleTestCase):\n279.     def test_attrs(self):\n280.         w = widgets.AdminDateWidget()\n281.         self.assertHTMLEqual(\n282.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n283.             \'<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">\',\n284.         )\n285.         # pass attrs to widget\n286.         w = widgets.AdminDateWidget(attrs={\'size\': 20, \'class\': \'myDateField\'})\n287.         self.assertHTMLEqual(\n288.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n289.             \'<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">\',\n290.         )\n291. \n292. \n293. class AdminTimeWidgetTest(SimpleTestCase):\n294.     def test_attrs(self):\n295.         w = widgets.AdminTimeWidget()\n296.         self.assertHTMLEqual(\n297.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n298.             \'<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">\',\n299.         )\n300.         # pass attrs to widget\n301.         w = widgets.AdminTimeWidget(attrs={\'size\': 20, \'class\': \'myTimeField\'})\n302.         self.assertHTMLEqual(\n303.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n304.             \'<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">\',\n305.         )\n306. \n307. \n308. class AdminSplitDateTimeWidgetTest(SimpleTestCase):\n309.     def test_render(self):\n310.         w = widgets.AdminSplitDateTime()\n311.         self.assertHTMLEqual(\n312.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n313.             \'<p class="datetime">\'\n314.             \'Date: <input value="2007-12-01" type="text" class="vDateField" \'\n315.             \'name="test_0" size="10"><br>\'\n316.             \'Time: <input value="09:30:00" type="text" class="vTimeField" \'\n317.             \'name="test_1" size="8"></p>\'\n318.         )\n319. \n320.     def test_localization(self):\n321.         w = widgets.AdminSplitDateTime()\n322. \n323.         with self.settings(USE_L10N=True), translation.override(\'de-at\'):\n324.             w.is_localized = True\n325.             self.assertHTMLEqual(\n326.                 w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n327.                 \'<p class="datetime">\'\n328.                 \'Datum: <input value="01.12.2007" type="text" \'\n329.                 \'class="vDateField" name="test_0"size="10"><br>\'\n330.                 \'Zeit: <input value="09:30:00" type="text" class="vTimeField" \'\n331.                 \'name="test_1" size="8"></p>\'\n332.             )\n333. \n334. \n335. class AdminURLWidgetTest(SimpleTestCase):\n336.     def test_get_context_validates_url(self):\n337.         w = widgets.AdminURLFieldWidget()\n338.         for invalid in [\'\', \'/not/a/full/url/\', \'javascript:alert("Danger XSS!")\']:\n339.             with self.subTest(url=invalid):\n340.                 self.assertFalse(w.get_context(\'name\', invalid, {})[\'url_valid\'])\n341.         self.assertTrue(w.get_context(\'name\', \'http://example.com\', {})[\'url_valid\'])\n342. \n343.     def test_render(self):\n344.         w = widgets.AdminURLFieldWidget()\n345.         self.assertHTMLEqual(\n346.             w.render(\'test\', \'\'),\n347.             \'<input class="vURLField" name="test" type="url">\'\n348.         )\n349.         self.assertHTMLEqual(\n350.             w.render(\'test\', \'http://example.com\'),\n351.             \'<p class="url">Currently:<a href="http://example.com">\'\n352.             \'http://example.com</a><br>\'\n353.             \'Change:<input class="vURLField" name="test" type="url" \'\n354.             \'value="http://example.com"></p>\'\n355.         )\n356. \n357.     def test_render_idn(self):\n358.         w = widgets.AdminURLFieldWidget()\n359.         self.assertHTMLEqual(\n360.             w.render(\'test\', \'http://example-äüö.com\'),\n361.             \'<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">\'\n362.             \'http://example-äüö.com</a><br>\'\n363.             \'Change:<input class="vURLField" name="test" type="url" \'\n364.             \'value="http://example-äüö.com"></p>\'\n365.         )\n366. \n367.     def test_render_quoting(self):\n368.         """\n369.         WARNING: This test doesn\'t use assertHTMLEqual since it will get rid\n370.         of some escapes which are tested here!\n371.         """\n372.         HREF_RE = re.compile(\'href="([^"]+)"\')\n373.         VALUE_RE = re.compile(\'value="([^"]+)"\')\n374.         TEXT_RE = re.compile(\'<a[^>]+>([^>]+)</a>\')\n375.         w = widgets.AdminURLFieldWidget()\n376.         output = w.render(\'test\', \'http://example.com/<sometag>some-text</sometag>\')\n377.         self.assertEqual(\n378.             HREF_RE.search(output).groups()[0],\n379.             \'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n380.         )\n381.         self.assertEqual(\n382.             TEXT_RE.search(output).groups()[0],\n383.             \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n384.         )\n385.         self.assertEqual(\n386.             VALUE_RE.search(output).groups()[0],\n387.             \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n388.         )\n389.         output = w.render(\'test\', \'http://example-äüö.com/<sometag>some-text</sometag>\')\n390.         self.assertEqual(\n391.             HREF_RE.search(output).groups()[0],\n392.             \'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n393.         )\n394.         self.assertEqual(\n395.             TEXT_RE.search(output).groups()[0],\n396.             \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n397.         )\n398.         self.assertEqual(\n399.             VALUE_RE.search(output).groups()[0],\n400.             \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n401.         )\n402.         output = w.render(\'test\', \'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"\')\n403.         self.assertEqual(\n404.             HREF_RE.search(output).groups()[0],\n405.             \'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22\',\n406.         )\n407.         self.assertEqual(\n408.             TEXT_RE.search(output).groups()[0],\n409.             \'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;\'\n410.             \'alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\'\n411.         )\n412.         self.assertEqual(\n413.             VALUE_RE.search(output).groups()[0],\n414.             \'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\',\n415.         )\n416. \n417. \n418. class AdminUUIDWidgetTests(SimpleTestCase):\n419.     def test_attrs(self):\n420.         w = widgets.AdminUUIDInputWidget()\n421.         self.assertHTMLEqual(\n422.             w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n423.             \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">\',\n424.         )\n425.         w = widgets.AdminUUIDInputWidget(attrs={\'class\': \'myUUIDInput\'})\n426.         self.assertHTMLEqual(\n427.             w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n428.             \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">\',\n429.         )\n430. \n431. \n432. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n433. class AdminFileWidgetTests(TestDataMixin, TestCase):\n434. \n435.     @classmethod\n436.     def setUpTestData(cls):\n437.         super().setUpTestData()\n438.         band = Band.objects.create(name=\'Linkin Park\')\n439.         cls.album = band.album_set.create(\n440.             name=\'Hybrid Theory\', cover_art=r\'albums\\hybrid_theory.jpg\'\n441.         )\n442. \n443.     def test_render(self):\n444.         w = widgets.AdminFileWidget()\n445.         self.assertHTMLEqual(\n446.             w.render(\'test\', self.album.cover_art),\n447.             \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n448.             r\'hybrid_theory.jpg">albums\\hybrid_theory.jpg</a> \'\n449.             \'<span class="clearable-file-input">\'\n450.             \'<input type="checkbox" name="test-clear" id="test-clear_id"> \'\n451.             \'<label for="test-clear_id">Clear</label></span><br>\'\n452.             \'Change: <input type="file" name="test"></p>\' % {\n453.                 \'STORAGE_URL\': default_storage.url(\'\'),\n454.             },\n455.         )\n456.         self.assertHTMLEqual(\n457.             w.render(\'test\', SimpleUploadedFile(\'test\', b\'content\')),\n458.             \'<input type="file" name="test">\',\n459.         )\n460. \n461.     def test_render_required(self):\n462.         widget = widgets.AdminFileWidget()\n463.         widget.is_required = True\n464.         self.assertHTMLEqual(\n465.             widget.render(\'test\', self.album.cover_art),\n466.             \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n467.             r\'hybrid_theory.jpg">albums\\hybrid_theory.jpg</a><br>\'\n468.             \'Change: <input type="file" name="test"></p>\' % {\n469.                 \'STORAGE_URL\': default_storage.url(\'\'),\n470.             },\n471.         )\n472. \n473.     def test_readonly_fields(self):\n474.         """\n475.         File widgets should render as a link when they\'re marked "read only."\n476.         """\n477.         self.client.force_login(self.superuser)\n478.         response = self.client.get(reverse(\'admin:admin_widgets_album_change\', args=(self.album.id,)))\n479.         self.assertContains(\n480.             response,\n481.             \'<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">\'\n482.             r\'albums\\hybrid_theory.jpg</a></div>\' % {\'STORAGE_URL\': default_storage.url(\'\')},\n483.             html=True,\n484.         )\n485.         self.assertNotContains(\n486.             response,\n487.             \'<input type="file" name="cover_art" id="id_cover_art">\',\n488.             html=True,\n489.         )\n490.         response = self.client.get(reverse(\'admin:admin_widgets_album_add\'))\n491.         self.assertContains(\n492.             response,\n493.             \'<div class="readonly"></div>\',\n494.             html=True,\n495.         )\n496. \n497. \n498. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n499. class ForeignKeyRawIdWidgetTest(TestCase):\n500. ', start_line_number=1, end_line_number=500), Context(relative_path='tests/admin_widgets/models.py', content='1. import uuid\n2. \n3. from django.contrib.auth.models import User\n4. from django.db import models\n5. \n6. \n7. class MyFileField(models.FileField):\n8.     pass\n9. \n10. \n11. class Member(models.Model):\n12.     name = models.CharField(max_length=100)\n13.     birthdate = models.DateTimeField(blank=True, null=True)\n14.     gender = models.CharField(max_length=1, blank=True, choices=[(\'M\', \'Male\'), (\'F\', \'Female\')])\n15.     email = models.EmailField(blank=True)\n16. \n17.     def __str__(self):\n18.         return self.name\n19. \n20. \n21. class Band(models.Model):\n22.     name = models.CharField(max_length=100)\n23.     style = models.CharField(max_length=20)\n24.     members = models.ManyToManyField(Member)\n25. \n26.     def __str__(self):\n27.         return self.name\n28. \n29. \n30. class Album(models.Model):\n31.     band = models.ForeignKey(Band, models.CASCADE)\n32.     featuring = models.ManyToManyField(Band, related_name=\'featured\')\n33.     name = models.CharField(max_length=100)\n34.     cover_art = models.FileField(upload_to=\'albums\')\n35.     backside_art = MyFileField(upload_to=\'albums_back\', null=True)\n36. \n37.     def __str__(self):\n38.         return self.name\n39. \n40. \n41. class HiddenInventoryManager(models.Manager):\n42.     def get_queryset(self):\n43.         return super().get_queryset().filter(hidden=False)\n44. \n45. \n46. class Inventory(models.Model):\n47.     barcode = models.PositiveIntegerField(unique=True)\n48.     parent = models.ForeignKey(\'self\', models.SET_NULL, to_field=\'barcode\', blank=True, null=True)\n49.     name = models.CharField(blank=False, max_length=20)\n50.     hidden = models.BooleanField(default=False)\n51. \n52.     # see #9258\n53.     default_manager = models.Manager()\n54.     objects = HiddenInventoryManager()\n55. \n56.     def __str__(self):\n57.         return self.name\n58. \n59. \n60. class Event(models.Model):\n61.     main_band = models.ForeignKey(\n62.         Band,\n63.         models.CASCADE,\n64.         limit_choices_to=models.Q(pk__gt=0),\n65.         related_name=\'events_main_band_at\',\n66.     )\n67.     supporting_bands = models.ManyToManyField(\n68.         Band,\n69.         blank=True,\n70.         related_name=\'events_supporting_band_at\',\n71.         help_text=\'Supporting Bands.\',\n72.     )\n73.     start_date = models.DateField(blank=True, null=True)\n74.     start_time = models.TimeField(blank=True, null=True)\n75.     description = models.TextField(blank=True)\n76.     link = models.URLField(blank=True)\n77.     min_age = models.IntegerField(blank=True, null=True)\n78. \n79. \n80. class Car(models.Model):\n81.     owner = models.ForeignKey(User, models.CASCADE)\n82.     make = models.CharField(max_length=30)\n83.     model = models.CharField(max_length=30)\n84. \n85.     def __str__(self):\n86.         return "%s %s" % (self.make, self.model)\n87. \n88. \n89. class CarTire(models.Model):\n90.     """\n91.     A single car tire. This to test that a user can only select their own cars.\n92.     """\n93.     car = models.ForeignKey(Car, models.CASCADE)\n94. \n95. \n96. class Honeycomb(models.Model):\n97.     id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)\n98.     location = models.CharField(max_length=20)\n99. \n100. \n101. class Bee(models.Model):\n102.     """\n103.     A model with a FK to a model that won\'t be registered with the admin\n104.     (Honeycomb) so the corresponding raw ID widget won\'t have a magnifying\n105.     glass link to select related honeycomb instances.\n106.     """\n107.     honeycomb = models.ForeignKey(Honeycomb, models.CASCADE)\n108. \n109. \n110. class Individual(models.Model):\n111.     """\n112.     A model with a FK to itself. It won\'t be registered with the admin, so the\n113.     corresponding raw ID widget won\'t have a magnifying glass link to select\n114.     related instances (rendering will be called programmatically in this case).\n115.     """\n116.     name = models.CharField(max_length=20)\n117.     parent = models.ForeignKey(\'self\', models.SET_NULL, null=True)\n118.     soulmate = models.ForeignKey(\'self\', models.CASCADE, null=True, related_name=\'soulmates\')\n119. \n120. \n121. class Company(models.Model):\n122.     name = models.CharField(max_length=20)\n123. \n124. \n125. class Advisor(models.Model):\n126.     """\n127.     A model with a m2m to a model that won\'t be registered with the admin\n128.     (Company) so the corresponding raw ID widget won\'t have a magnifying\n129.     glass link to select related company instances.\n130.     """\n131.     name = models.CharField(max_length=20)\n132.     companies = models.ManyToManyField(Company)\n133. \n134. \n135. class Student(models.Model):\n136.     name = models.CharField(max_length=255)\n137. \n138.     class Meta:\n139.         ordering = (\'name\',)\n140. \n141.     def __str__(self):\n142.         return self.name\n143. \n144. \n145. class School(models.Model):\n146.     name = models.CharField(max_length=255)\n147.     students = models.ManyToManyField(Student, related_name=\'current_schools\')\n148.     alumni = models.ManyToManyField(Student, related_name=\'previous_schools\')\n149. \n150.     def __str__(self):\n151.         return self.name\n152. \n153. \n154. class Profile(models.Model):\n155.     user = models.ForeignKey(\'auth.User\', models.CASCADE, to_field=\'username\')\n156. \n157.     def __str__(self):\n158.         return self.user.username', start_line_number=1, end_line_number=158)]
2025-10-06 03:44:26,620 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 03:44:26,621 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-10-06 03:44:26,621 - thread-139660780025408.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Context retrieved: [Context(relative_path='tests/admin_ordering/tests.py', content='123. class TestRelatedFieldsAdminOrdering(TestCase):\n124.     @classmethod\n125.     def setUpTestData(cls):\n126.         cls.b1 = Band.objects.create(name=\'Pink Floyd\', bio=\'\', rank=1)\n127.         cls.b2 = Band.objects.create(name=\'Foo Fighters\', bio=\'\', rank=5)\n128. \n129.     def setUp(self):\n130.         # we need to register a custom ModelAdmin (instead of just using\n131.         # ModelAdmin) because the field creator tries to find the ModelAdmin\n132.         # for the related model\n133.         class SongAdmin(admin.ModelAdmin):\n134.             pass\n135.         site.register(Song, SongAdmin)\n136. \n137.     def tearDown(self):\n138.         site.unregister(Song)\n139.         if Band in site._registry:\n140.             site.unregister(Band)\n141. \n142.     def check_ordering_of_field_choices(self, correct_ordering):\n143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)\n144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)\n145.         self.assertEqual(list(fk_field.queryset), correct_ordering)\n146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)\n147. \n148.     def test_no_admin_fallback_to_model_ordering(self):\n149.         # should be ordered by name (as defined by the model)\n150.         self.check_ordering_of_field_choices([self.b2, self.b1])\n151. \n152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):\n153.         class NoOrderingBandAdmin(admin.ModelAdmin):\n154.             pass\n155.         site.register(Band, NoOrderingBandAdmin)\n156. \n157.         # should be ordered by name (as defined by the model)\n158.         self.check_ordering_of_field_choices([self.b2, self.b1])\n159. \n160.     def test_admin_ordering_beats_model_ordering(self):\n161.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n162.             ordering = (\'rank\',)\n163.         site.register(Band, StaticOrderingBandAdmin)\n164. \n165.         # should be ordered by rank (defined by the ModelAdmin)\n166.         self.check_ordering_of_field_choices([self.b1, self.b2])\n167. \n168.     def test_custom_queryset_still_wins(self):\n169.         """Custom queryset has still precedence (#21405)"""\n170.         class SongAdmin(admin.ModelAdmin):\n171.             # Exclude one of the two Bands from the querysets\n172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):\n173.                 if db_field.name == \'band\':\n174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n176. \n177.             def formfield_for_manytomany(self, db_field, request, **kwargs):\n178.                 if db_field.name == \'other_interpreters\':\n179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n181. \n182.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n183.             ordering = (\'rank\',)\n184. \n185.         site.unregister(Song)\n186.         site.register(Song, SongAdmin)\n187.         site.register(Band, StaticOrderingBandAdmin)\n188. \n189.         self.check_ordering_of_field_choices([self.b2])', start_line_number=123, end_line_number=189), Context(relative_path='django/contrib/auth/admin.py', content="25. @admin.register(Group)\n26. class GroupAdmin(admin.ModelAdmin):\n27.     search_fields = ('name',)\n28.     ordering = ('name',)\n29.     filter_horizontal = ('permissions',)\n30. \n31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):\n32.         if db_field.name == 'permissions':\n33.             qs = kwargs.get('queryset', db_field.remote_field.model.objects)\n34.             # Avoid a major performance hit resolving permission names which\n35.             # triggers a content_type load:\n36.             kwargs['queryset'] = qs.select_related('content_type')\n37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)", start_line_number=25, end_line_number=37), Context(relative_path='tests/admin_views/tests.py', content='5262. @override_settings(ROOT_URLCONF=\'admin_views.urls\')\n5263. class GroupAdminTest(TestCase):\n5264.     """\n5265.     Tests group CRUD functionality.\n5266.     """\n5267. \n5268.     @classmethod\n5269.     def setUpTestData(cls):\n5270.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n5271. \n5272.     def setUp(self):\n5273.         self.client.force_login(self.superuser)\n5274. \n5275.     def test_save_button(self):\n5276.         group_count = Group.objects.count()\n5277.         response = self.client.post(reverse(\'admin:auth_group_add\'), {\n5278.             \'name\': \'newgroup\',\n5279.         })\n5280. \n5281.         Group.objects.order_by(\'-id\')[0]\n5282.         self.assertRedirects(response, reverse(\'admin:auth_group_changelist\'))\n5283.         self.assertEqual(Group.objects.count(), group_count + 1)\n5284. \n5285.     def test_group_permission_performance(self):\n5286.         g = Group.objects.create(name="test_group")\n5287. \n5288.         # Ensure no queries are skipped due to cached content type for Group.\n5289.         ContentType.objects.clear_cache()\n5290. \n5291.         with self.assertNumQueries(8):\n5292.             response = self.client.get(reverse(\'admin:auth_group_change\', args=(g.pk,)))\n5293.             self.assertEqual(response.status_code, 200)', start_line_number=5262, end_line_number=5293), Context(relative_path='tests/admin_widgets/tests.py', content="638. @override_settings(ROOT_URLCONF='admin_widgets.urls')\n639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):\n640.     def test_no_can_add_related(self):\n641.         rel = Individual._meta.get_field('parent').remote_field\n642.         w = widgets.AdminRadioSelect()\n643.         # Used to fail with a name error.\n644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n645.         self.assertFalse(w.can_add_related)\n646. \n647.     def test_select_multiple_widget_cant_change_delete_related(self):\n648.         rel = Individual._meta.get_field('parent').remote_field\n649.         widget = forms.SelectMultiple()\n650.         wrapper = widgets.RelatedFieldWidgetWrapper(\n651.             widget, rel, widget_admin_site,\n652.             can_add_related=True,\n653.             can_change_related=True,\n654.             can_delete_related=True,\n655.         )\n656.         self.assertTrue(wrapper.can_add_related)\n657.         self.assertFalse(wrapper.can_change_related)\n658.         self.assertFalse(wrapper.can_delete_related)\n659. \n660.     def test_on_delete_cascade_rel_cant_delete_related(self):\n661.         rel = Individual._meta.get_field('soulmate').remote_field\n662.         widget = forms.Select()\n663.         wrapper = widgets.RelatedFieldWidgetWrapper(\n664.             widget, rel, widget_admin_site,\n665.             can_add_related=True,\n666.             can_change_related=True,\n667.             can_delete_related=True,\n668.         )\n669.         self.assertTrue(wrapper.can_add_related)\n670.         self.assertTrue(wrapper.can_change_related)\n671.         self.assertFalse(wrapper.can_delete_related)\n672. \n673.     def test_custom_widget_render(self):\n674.         class CustomWidget(forms.Select):\n675.             def render(self, *args, **kwargs):\n676.                 return 'custom render output'\n677.         rel = Album._meta.get_field('band').remote_field\n678.         widget = CustomWidget()\n679.         wrapper = widgets.RelatedFieldWidgetWrapper(\n680.             widget, rel, widget_admin_site,\n681.             can_add_related=True,\n682.             can_change_related=True,\n683.             can_delete_related=True,\n684.         )\n685.         output = wrapper.render('name', 'value')\n686.         self.assertIn('custom render output', output)\n687. \n688.     def test_widget_delegates_value_omitted_from_data(self):\n689.         class CustomWidget(forms.Select):\n690.             def value_omitted_from_data(self, data, files, name):\n691.                 return False\n692.         rel = Album._meta.get_field('band').remote_field\n693.         widget = CustomWidget()\n694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, 'band'), False)\n696. \n697.     def test_widget_is_hidden(self):\n698.         rel = Album._meta.get_field('band').remote_field\n699.         widget = forms.HiddenInput()\n700.         widget.choices = ()\n701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n702.         self.assertIs(wrapper.is_hidden, True)\n703.         context = wrapper.get_context('band', None, {})\n704.         self.assertIs(context['is_hidden'], True)\n705.         output = wrapper.render('name', 'value')\n706.         # Related item links are hidden.\n707.         self.assertNotIn('<a ', output)\n708. \n709.     def test_widget_is_not_hidden(self):\n710.         rel = Album._meta.get_field('band').remote_field\n711.         widget = forms.Select()\n712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n713.         self.assertIs(wrapper.is_hidden, False)\n714.         context = wrapper.get_context('band', None, {})\n715.         self.assertIs(context['is_hidden'], False)\n716.         output = wrapper.render('name', 'value')\n717.         # Related item links are present.\n718.         self.assertIn('<a ', output)", start_line_number=638, end_line_number=718), Context(relative_path='tests/admin_ordering/tests.py', content='1. from django.contrib import admin\n2. from django.contrib.admin.options import ModelAdmin\n3. from django.contrib.auth.models import User\n4. from django.db.models import F\n5. from django.test import RequestFactory, TestCase\n6. \n7. from .models import (\n8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,\n9.     SongInlineNewOrdering,\n10. )', start_line_number=1, end_line_number=10), Context(relative_path='tests/admin_widgets/tests.py', content='1. import gettext\n2. import os\n3. import re\n4. from datetime import datetime, timedelta\n5. from importlib import import_module\n6. \n7. import pytz\n8. \n9. from django import forms\n10. from django.conf import settings\n11. from django.contrib import admin\n12. from django.contrib.admin import widgets\n13. from django.contrib.admin.tests import AdminSeleniumTestCase\n14. from django.contrib.auth.models import User\n15. from django.core.files.storage import default_storage\n16. from django.core.files.uploadedfile import SimpleUploadedFile\n17. from django.db.models import CharField, DateField, DateTimeField, UUIDField\n18. from django.test import SimpleTestCase, TestCase, override_settings\n19. from django.urls import reverse\n20. from django.utils import translation\n21. \n22. from .models import (\n23.     Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,\n24.     Inventory, Member, MyFileField, Profile, School, Student,\n25. )\n26. from .widgetadmin import site as widget_admin_site\n27. \n28. \n29. class TestDataMixin:\n30. \n31.     @classmethod\n32.     def setUpTestData(cls):\n33.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=None)\n34.         cls.u2 = User.objects.create_user(username=\'testser\', password=\'secret\')\n35.         Car.objects.create(owner=cls.superuser, make=\'Volkswagen\', model=\'Passat\')\n36.         Car.objects.create(owner=cls.u2, make=\'BMW\', model=\'M3\')\n37. \n38. \n39. class AdminFormfieldForDBFieldTests(SimpleTestCase):\n40.     """\n41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n42.     """\n43. \n44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n45.         """\n46.         Helper to call formfield_for_dbfield for a given model and field name\n47.         and verify that the returned formfield is appropriate.\n48.         """\n49.         # Override any settings on the model admin\n50.         class MyModelAdmin(admin.ModelAdmin):\n51.             pass\n52.         for k in admin_overrides:\n53.             setattr(MyModelAdmin, k, admin_overrides[k])\n54. \n55.         # Construct the admin, and ask it for a formfield\n56.         ma = MyModelAdmin(model, admin.site)\n57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n58. \n59.         # "unwrap" the widget wrapper, if needed\n60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n61.             widget = ff.widget.widget\n62.         else:\n63.             widget = ff.widget\n64. \n65.         self.assertIsInstance(widget, widgetclass)\n66. \n67.         # Return the formfield so that other tests can continue\n68.         return ff\n69. \n70.     def test_DateField(self):\n71.         self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n72. \n73.     def test_DateTimeField(self):\n74.         self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n75. \n76.     def test_TimeField(self):\n77.         self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n78. \n79.     def test_TextField(self):\n80.         self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n81. \n82.     def test_URLField(self):\n83.         self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n84. \n85.     def test_IntegerField(self):\n86.         self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n87. \n88.     def test_CharField(self):\n89.         self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n90. \n91.     def test_EmailField(self):\n92.         self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n93. \n94.     def test_FileField(self):\n95.         self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n96. \n97.     def test_ForeignKey(self):\n98.         self.assertFormfield(Event, \'main_band\', forms.Select)\n99. \n100.     def test_raw_id_ForeignKey(self):\n101.         self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n102.                              raw_id_fields=[\'main_band\'])\n103. \n104.     def test_radio_fields_ForeignKey(self):\n105.         ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n106.                                   radio_fields={\'main_band\': admin.VERTICAL})\n107.         self.assertIsNone(ff.empty_label)\n108. \n109.     def test_many_to_many(self):\n110.         self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n111. \n112.     def test_raw_id_many_to_many(self):\n113.         self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n114.                              raw_id_fields=[\'members\'])\n115. \n116.     def test_filtered_many_to_many(self):\n117.         self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n118.                              filter_vertical=[\'members\'])\n119. \n120.     def test_formfield_overrides(self):\n121.         self.assertFormfield(Event, \'start_date\', forms.TextInput,\n122.                              formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n123. \n124.     def test_formfield_overrides_widget_instances(self):\n125.         """\n126.         Widget instances in formfield_overrides are not shared between\n127.         different fields. (#19423)\n128.         """\n129.         class BandAdmin(admin.ModelAdmin):\n130.             formfield_overrides = {\n131.                 CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n132.             }\n133.         ma = BandAdmin(Band, admin.site)\n134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n136.         self.assertNotEqual(f1.widget, f2.widget)\n137.         self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n138.         self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n139.         self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n140. \n141.     def test_formfield_overrides_for_datetime_field(self):\n142.         """\n143.         Overriding the widget for DateTimeField doesn\'t overrides the default\n144.         form_class for that field (#26449).\n145.         """\n146.         class MemberAdmin(admin.ModelAdmin):\n147.             formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n148.         ma = MemberAdmin(Member, admin.site)\n149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n151.         self.assertIsInstance(f1, forms.SplitDateTimeField)\n152. \n153.     def test_formfield_overrides_for_custom_field(self):\n154.         """\n155.         formfield_overrides works for a custom field class.\n156.         """\n157.         class AlbumAdmin(admin.ModelAdmin):\n158.             formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n159.         ma = AlbumAdmin(Member, admin.site)\n160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n161.         self.assertIsInstance(f1.widget, forms.TextInput)\n162. \n163.     def test_field_with_choices(self):\n164.         self.assertFormfield(Member, \'gender\', forms.Select)\n165. \n166.     def test_choices_with_radio_fields(self):\n167.         self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n168.                              radio_fields={\'gender\': admin.VERTICAL})\n169. \n170.     def test_inheritance(self):\n171.         self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n172. \n173.     def test_m2m_widgets(self):\n174.         """m2m fields help text as it applies to admin app (#9321)."""\n175.         class AdvisorAdmin(admin.ModelAdmin):\n176.             filter_vertical = [\'companies\']\n177. \n178.         self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n179.                              filter_vertical=[\'companies\'])\n180.         ma = AdvisorAdmin(Advisor, admin.site)\n181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n182.         self.assertEqual(\n183.             f.help_text,\n184.             \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n185.         )\n186. \n187. \n188. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n189. class AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):\n190. \n191.     def test_filter_choices_by_request_user(self):\n192.         """\n193.         Ensure the user can only see their own cars in the foreign key dropdown.\n194.         """\n195.         self.client.force_login(self.superuser)\n196.         response = self.client.get(reverse(\'admin:admin_widgets_cartire_add\'))\n197.         self.assertNotContains(response, "BMW M3")\n198.         self.assertContains(response, "Volkswagen Passat")\n199. \n200. \n201. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n202. class AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):\n203. \n204.     def setUp(self):\n205.         self.client.force_login(self.superuser)\n206. \n207.     def test_changelist_ForeignKey(self):\n208.         response = self.client.get(reverse(\'admin:admin_widgets_car_changelist\'))\n209.         self.assertContains(response, \'/auth/user/add/\')\n210. \n211. \n212. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n213. class AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):\n214. \n215.     def setUp(self):\n216.         self.client.force_login(self.superuser)\n217. \n218.     def test_nonexistent_target_id(self):\n219.         band = Band.objects.create(name=\'Bogey Blues\')\n220.         pk = band.pk\n221.         band.delete()\n222.         post_data = {\n223.             "main_band": \'%s\' % pk,\n224.         }\n225.         # Try posting with a nonexistent pk in a raw id field: this\n226.         # should result in an error message, not a server exception.\n227.         response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), post_data)\n228.         self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n229. \n230.     def test_invalid_target_id(self):\n231. \n232.         for test_str in (\'Iñtërnâtiônàlizætiøn\', "1234\'", -1234):\n233.             # This should result in an error message, not a server exception.\n234.             response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), {"main_band": test_str})\n235. \n236.             self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n237. \n238.     def test_url_params_from_lookup_dict_any_iterable(self):\n239.         lookup1 = widgets.url_params_from_lookup_dict({\'color__in\': (\'red\', \'blue\')})\n240.         lookup2 = widgets.url_params_from_lookup_dict({\'color__in\': [\'red\', \'blue\']})\n241.         self.assertEqual(lookup1, {\'color__in\': \'red,blue\'})\n242.         self.assertEqual(lookup1, lookup2)\n243. \n244.     def test_url_params_from_lookup_dict_callable(self):\n245.         def my_callable():\n246.             return \'works\'\n247.         lookup1 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable})\n248.         lookup2 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable()})\n249.         self.assertEqual(lookup1, lookup2)\n250. \n251.     def test_label_and_url_for_value_invalid_uuid(self):\n252.         field = Bee._meta.get_field(\'honeycomb\')\n253.         self.assertIsInstance(field.target_field, UUIDField)\n254.         widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)\n255.         self.assertEqual(widget.label_and_url_for_value(\'invalid-uuid\'), (\'\', \'\'))\n256. \n257. \n258. class FilteredSelectMultipleWidgetTest(SimpleTestCase):\n259.     def test_render(self):\n260.         # Backslash in verbose_name to ensure it is JavaScript escaped.\n261.         w = widgets.FilteredSelectMultiple(\'test\\\\\', False)\n262.         self.assertHTMLEqual(\n263.             w.render(\'test\', \'test\'),\n264.             \'<select multiple name="test" class="selectfilter" \'\n265.             \'data-field-name="test\\\\" data-is-stacked="0">\\n</select>\'\n266.         )\n267. \n268.     def test_stacked_render(self):\n269.         # Backslash in verbose_name to ensure it is JavaScript escaped.\n270.         w = widgets.FilteredSelectMultiple(\'test\\\\\', True)\n271.         self.assertHTMLEqual(\n272.             w.render(\'test\', \'test\'),\n273.             \'<select multiple name="test" class="selectfilterstacked" \'\n274.             \'data-field-name="test\\\\" data-is-stacked="1">\\n</select>\'\n275.         )\n276. \n277. \n278. class AdminDateWidgetTest(SimpleTestCase):\n279.     def test_attrs(self):\n280.         w = widgets.AdminDateWidget()\n281.         self.assertHTMLEqual(\n282.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n283.             \'<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">\',\n284.         )\n285.         # pass attrs to widget\n286.         w = widgets.AdminDateWidget(attrs={\'size\': 20, \'class\': \'myDateField\'})\n287.         self.assertHTMLEqual(\n288.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n289.             \'<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">\',\n290.         )\n291. \n292. \n293. class AdminTimeWidgetTest(SimpleTestCase):\n294.     def test_attrs(self):\n295.         w = widgets.AdminTimeWidget()\n296.         self.assertHTMLEqual(\n297.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n298.             \'<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">\',\n299.         )\n300.         # pass attrs to widget\n301.         w = widgets.AdminTimeWidget(attrs={\'size\': 20, \'class\': \'myTimeField\'})\n302.         self.assertHTMLEqual(\n303.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n304.             \'<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">\',\n305.         )\n306. \n307. \n308. class AdminSplitDateTimeWidgetTest(SimpleTestCase):\n309.     def test_render(self):\n310.         w = widgets.AdminSplitDateTime()\n311.         self.assertHTMLEqual(\n312.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n313.             \'<p class="datetime">\'\n314.             \'Date: <input value="2007-12-01" type="text" class="vDateField" \'\n315.             \'name="test_0" size="10"><br>\'\n316.             \'Time: <input value="09:30:00" type="text" class="vTimeField" \'\n317.             \'name="test_1" size="8"></p>\'\n318.         )\n319. \n320.     def test_localization(self):\n321.         w = widgets.AdminSplitDateTime()\n322. \n323.         with self.settings(USE_L10N=True), translation.override(\'de-at\'):\n324.             w.is_localized = True\n325.             self.assertHTMLEqual(\n326.                 w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n327.                 \'<p class="datetime">\'\n328.                 \'Datum: <input value="01.12.2007" type="text" \'\n329.                 \'class="vDateField" name="test_0"size="10"><br>\'\n330.                 \'Zeit: <input value="09:30:00" type="text" class="vTimeField" \'\n331.                 \'name="test_1" size="8"></p>\'\n332.             )\n333. \n334. \n335. class AdminURLWidgetTest(SimpleTestCase):\n336.     def test_get_context_validates_url(self):\n337.         w = widgets.AdminURLFieldWidget()\n338.         for invalid in [\'\', \'/not/a/full/url/\', \'javascript:alert("Danger XSS!")\']:\n339.             with self.subTest(url=invalid):\n340.                 self.assertFalse(w.get_context(\'name\', invalid, {})[\'url_valid\'])\n341.         self.assertTrue(w.get_context(\'name\', \'http://example.com\', {})[\'url_valid\'])\n342. \n343.     def test_render(self):\n344.         w = widgets.AdminURLFieldWidget()\n345.         self.assertHTMLEqual(\n346.             w.render(\'test\', \'\'),\n347.             \'<input class="vURLField" name="test" type="url">\'\n348.         )\n349.         self.assertHTMLEqual(\n350.             w.render(\'test\', \'http://example.com\'),\n351.             \'<p class="url">Currently:<a href="http://example.com">\'\n352.             \'http://example.com</a><br>\'\n353.             \'Change:<input class="vURLField" name="test" type="url" \'\n354.             \'value="http://example.com"></p>\'\n355.         )\n356. \n357.     def test_render_idn(self):\n358.         w = widgets.AdminURLFieldWidget()\n359.         self.assertHTMLEqual(\n360.             w.render(\'test\', \'http://example-äüö.com\'),\n361.             \'<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">\'\n362.             \'http://example-äüö.com</a><br>\'\n363.             \'Change:<input class="vURLField" name="test" type="url" \'\n364.             \'value="http://example-äüö.com"></p>\'\n365.         )\n366. \n367.     def test_render_quoting(self):\n368.         """\n369.         WARNING: This test doesn\'t use assertHTMLEqual since it will get rid\n370.         of some escapes which are tested here!\n371.         """\n372.         HREF_RE = re.compile(\'href="([^"]+)"\')\n373.         VALUE_RE = re.compile(\'value="([^"]+)"\')\n374.         TEXT_RE = re.compile(\'<a[^>]+>([^>]+)</a>\')\n375.         w = widgets.AdminURLFieldWidget()\n376.         output = w.render(\'test\', \'http://example.com/<sometag>some-text</sometag>\')\n377.         self.assertEqual(\n378.             HREF_RE.search(output).groups()[0],\n379.             \'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n380.         )\n381.         self.assertEqual(\n382.             TEXT_RE.search(output).groups()[0],\n383.             \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n384.         )\n385.         self.assertEqual(\n386.             VALUE_RE.search(output).groups()[0],\n387.             \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n388.         )\n389.         output = w.render(\'test\', \'http://example-äüö.com/<sometag>some-text</sometag>\')\n390.         self.assertEqual(\n391.             HREF_RE.search(output).groups()[0],\n392.             \'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n393.         )\n394.         self.assertEqual(\n395.             TEXT_RE.search(output).groups()[0],\n396.             \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n397.         )\n398.         self.assertEqual(\n399.             VALUE_RE.search(output).groups()[0],\n400.             \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n401.         )\n402.         output = w.render(\'test\', \'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"\')\n403.         self.assertEqual(\n404.             HREF_RE.search(output).groups()[0],\n405.             \'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22\',\n406.         )\n407.         self.assertEqual(\n408.             TEXT_RE.search(output).groups()[0],\n409.             \'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;\'\n410.             \'alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\'\n411.         )\n412.         self.assertEqual(\n413.             VALUE_RE.search(output).groups()[0],\n414.             \'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\',\n415.         )\n416. \n417. \n418. class AdminUUIDWidgetTests(SimpleTestCase):\n419.     def test_attrs(self):\n420.         w = widgets.AdminUUIDInputWidget()\n421.         self.assertHTMLEqual(\n422.             w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n423.             \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">\',\n424.         )\n425.         w = widgets.AdminUUIDInputWidget(attrs={\'class\': \'myUUIDInput\'})\n426.         self.assertHTMLEqual(\n427.             w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n428.             \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">\',\n429.         )\n430. \n431. \n432. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n433. class AdminFileWidgetTests(TestDataMixin, TestCase):\n434. \n435.     @classmethod\n436.     def setUpTestData(cls):\n437.         super().setUpTestData()\n438.         band = Band.objects.create(name=\'Linkin Park\')\n439.         cls.album = band.album_set.create(\n440.             name=\'Hybrid Theory\', cover_art=r\'albums\\hybrid_theory.jpg\'\n441.         )\n442. \n443.     def test_render(self):\n444.         w = widgets.AdminFileWidget()\n445.         self.assertHTMLEqual(\n446.             w.render(\'test\', self.album.cover_art),\n447.             \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n448.             r\'hybrid_theory.jpg">albums\\hybrid_theory.jpg</a> \'\n449.             \'<span class="clearable-file-input">\'\n450.             \'<input type="checkbox" name="test-clear" id="test-clear_id"> \'\n451.             \'<label for="test-clear_id">Clear</label></span><br>\'\n452.             \'Change: <input type="file" name="test"></p>\' % {\n453.                 \'STORAGE_URL\': default_storage.url(\'\'),\n454.             },\n455.         )\n456.         self.assertHTMLEqual(\n457.             w.render(\'test\', SimpleUploadedFile(\'test\', b\'content\')),\n458.             \'<input type="file" name="test">\',\n459.         )\n460. \n461.     def test_render_required(self):\n462.         widget = widgets.AdminFileWidget()\n463.         widget.is_required = True\n464.         self.assertHTMLEqual(\n465.             widget.render(\'test\', self.album.cover_art),\n466.             \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n467.             r\'hybrid_theory.jpg">albums\\hybrid_theory.jpg</a><br>\'\n468.             \'Change: <input type="file" name="test"></p>\' % {\n469.                 \'STORAGE_URL\': default_storage.url(\'\'),\n470.             },\n471.         )\n472. \n473.     def test_readonly_fields(self):\n474.         """\n475.         File widgets should render as a link when they\'re marked "read only."\n476.         """\n477.         self.client.force_login(self.superuser)\n478.         response = self.client.get(reverse(\'admin:admin_widgets_album_change\', args=(self.album.id,)))\n479.         self.assertContains(\n480.             response,\n481.             \'<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">\'\n482.             r\'albums\\hybrid_theory.jpg</a></div>\' % {\'STORAGE_URL\': default_storage.url(\'\')},\n483.             html=True,\n484.         )\n485.         self.assertNotContains(\n486.             response,\n487.             \'<input type="file" name="cover_art" id="id_cover_art">\',\n488.             html=True,\n489.         )\n490.         response = self.client.get(reverse(\'admin:admin_widgets_album_add\'))\n491.         self.assertContains(\n492.             response,\n493.             \'<div class="readonly"></div>\',\n494.             html=True,\n495.         )\n496. \n497. \n498. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n499. class ForeignKeyRawIdWidgetTest(TestCase):\n500. ', start_line_number=1, end_line_number=500), Context(relative_path='tests/admin_widgets/models.py', content='1. import uuid\n2. \n3. from django.contrib.auth.models import User\n4. from django.db import models\n5. \n6. \n7. class MyFileField(models.FileField):\n8.     pass\n9. \n10. \n11. class Member(models.Model):\n12.     name = models.CharField(max_length=100)\n13.     birthdate = models.DateTimeField(blank=True, null=True)\n14.     gender = models.CharField(max_length=1, blank=True, choices=[(\'M\', \'Male\'), (\'F\', \'Female\')])\n15.     email = models.EmailField(blank=True)\n16. \n17.     def __str__(self):\n18.         return self.name\n19. \n20. \n21. class Band(models.Model):\n22.     name = models.CharField(max_length=100)\n23.     style = models.CharField(max_length=20)\n24.     members = models.ManyToManyField(Member)\n25. \n26.     def __str__(self):\n27.         return self.name\n28. \n29. \n30. class Album(models.Model):\n31.     band = models.ForeignKey(Band, models.CASCADE)\n32.     featuring = models.ManyToManyField(Band, related_name=\'featured\')\n33.     name = models.CharField(max_length=100)\n34.     cover_art = models.FileField(upload_to=\'albums\')\n35.     backside_art = MyFileField(upload_to=\'albums_back\', null=True)\n36. \n37.     def __str__(self):\n38.         return self.name\n39. \n40. \n41. class HiddenInventoryManager(models.Manager):\n42.     def get_queryset(self):\n43.         return super().get_queryset().filter(hidden=False)\n44. \n45. \n46. class Inventory(models.Model):\n47.     barcode = models.PositiveIntegerField(unique=True)\n48.     parent = models.ForeignKey(\'self\', models.SET_NULL, to_field=\'barcode\', blank=True, null=True)\n49.     name = models.CharField(blank=False, max_length=20)\n50.     hidden = models.BooleanField(default=False)\n51. \n52.     # see #9258\n53.     default_manager = models.Manager()\n54.     objects = HiddenInventoryManager()\n55. \n56.     def __str__(self):\n57.         return self.name\n58. \n59. \n60. class Event(models.Model):\n61.     main_band = models.ForeignKey(\n62.         Band,\n63.         models.CASCADE,\n64.         limit_choices_to=models.Q(pk__gt=0),\n65.         related_name=\'events_main_band_at\',\n66.     )\n67.     supporting_bands = models.ManyToManyField(\n68.         Band,\n69.         blank=True,\n70.         related_name=\'events_supporting_band_at\',\n71.         help_text=\'Supporting Bands.\',\n72.     )\n73.     start_date = models.DateField(blank=True, null=True)\n74.     start_time = models.TimeField(blank=True, null=True)\n75.     description = models.TextField(blank=True)\n76.     link = models.URLField(blank=True)\n77.     min_age = models.IntegerField(blank=True, null=True)\n78. \n79. \n80. class Car(models.Model):\n81.     owner = models.ForeignKey(User, models.CASCADE)\n82.     make = models.CharField(max_length=30)\n83.     model = models.CharField(max_length=30)\n84. \n85.     def __str__(self):\n86.         return "%s %s" % (self.make, self.model)\n87. \n88. \n89. class CarTire(models.Model):\n90.     """\n91.     A single car tire. This to test that a user can only select their own cars.\n92.     """\n93.     car = models.ForeignKey(Car, models.CASCADE)\n94. \n95. \n96. class Honeycomb(models.Model):\n97.     id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)\n98.     location = models.CharField(max_length=20)\n99. \n100. \n101. class Bee(models.Model):\n102.     """\n103.     A model with a FK to a model that won\'t be registered with the admin\n104.     (Honeycomb) so the corresponding raw ID widget won\'t have a magnifying\n105.     glass link to select related honeycomb instances.\n106.     """\n107.     honeycomb = models.ForeignKey(Honeycomb, models.CASCADE)\n108. \n109. \n110. class Individual(models.Model):\n111.     """\n112.     A model with a FK to itself. It won\'t be registered with the admin, so the\n113.     corresponding raw ID widget won\'t have a magnifying glass link to select\n114.     related instances (rendering will be called programmatically in this case).\n115.     """\n116.     name = models.CharField(max_length=20)\n117.     parent = models.ForeignKey(\'self\', models.SET_NULL, null=True)\n118.     soulmate = models.ForeignKey(\'self\', models.CASCADE, null=True, related_name=\'soulmates\')\n119. \n120. \n121. class Company(models.Model):\n122.     name = models.CharField(max_length=20)\n123. \n124. \n125. class Advisor(models.Model):\n126.     """\n127.     A model with a m2m to a model that won\'t be registered with the admin\n128.     (Company) so the corresponding raw ID widget won\'t have a magnifying\n129.     glass link to select related company instances.\n130.     """\n131.     name = models.CharField(max_length=20)\n132.     companies = models.ManyToManyField(Company)\n133. \n134. \n135. class Student(models.Model):\n136.     name = models.CharField(max_length=255)\n137. \n138.     class Meta:\n139.         ordering = (\'name\',)\n140. \n141.     def __str__(self):\n142.         return self.name\n143. \n144. \n145. class School(models.Model):\n146.     name = models.CharField(max_length=255)\n147.     students = models.ManyToManyField(Student, related_name=\'current_schools\')\n148.     alumni = models.ManyToManyField(Student, related_name=\'previous_schools\')\n149. \n150.     def __str__(self):\n151.         return self.name\n152. \n153. \n154. class Profile(models.Model):\n155.     user = models.ForeignKey(\'auth.User\', models.CASCADE, to_field=\'username\')\n156. \n157.     def __str__(self):\n158.         return self.user.username', start_line_number=1, end_line_number=158)]
2025-10-06 03:44:26,622 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nAllow overridding widget in formfield_for_manytomany().\n\nIssue description: \nDescription\n\t \n\t\t(last modified by Mariusz Felisiak)\n\t \nIt does not work when I set widget param to function formfield_for_manytomany().\nThis is different from the formfield_for_foreignkey() function.\n\nIssue comments:\n\n\nBug reproducing context:\nFile: tests/admin_ordering/tests.py\nLine number range: 123 - 189\nContent:\n123. class TestRelatedFieldsAdminOrdering(TestCase):\n124.     @classmethod\n125.     def setUpTestData(cls):\n126.         cls.b1 = Band.objects.create(name=\'Pink Floyd\', bio=\'\', rank=1)\n127.         cls.b2 = Band.objects.create(name=\'Foo Fighters\', bio=\'\', rank=5)\n128. \n129.     def setUp(self):\n130.         # we need to register a custom ModelAdmin (instead of just using\n131.         # ModelAdmin) because the field creator tries to find the ModelAdmin\n132.         # for the related model\n133.         class SongAdmin(admin.ModelAdmin):\n134.             pass\n135.         site.register(Song, SongAdmin)\n136. \n137.     def tearDown(self):\n138.         site.unregister(Song)\n139.         if Band in site._registry:\n140.             site.unregister(Band)\n141. \n142.     def check_ordering_of_field_choices(self, correct_ordering):\n143.         fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)\n144.         m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)\n145.         self.assertEqual(list(fk_field.queryset), correct_ordering)\n146.         self.assertEqual(list(m2m_field.queryset), correct_ordering)\n147. \n148.     def test_no_admin_fallback_to_model_ordering(self):\n149.         # should be ordered by name (as defined by the model)\n150.         self.check_ordering_of_field_choices([self.b2, self.b1])\n151. \n152.     def test_admin_with_no_ordering_fallback_to_model_ordering(self):\n153.         class NoOrderingBandAdmin(admin.ModelAdmin):\n154.             pass\n155.         site.register(Band, NoOrderingBandAdmin)\n156. \n157.         # should be ordered by name (as defined by the model)\n158.         self.check_ordering_of_field_choices([self.b2, self.b1])\n159. \n160.     def test_admin_ordering_beats_model_ordering(self):\n161.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n162.             ordering = (\'rank\',)\n163.         site.register(Band, StaticOrderingBandAdmin)\n164. \n165.         # should be ordered by rank (defined by the ModelAdmin)\n166.         self.check_ordering_of_field_choices([self.b1, self.b2])\n167. \n168.     def test_custom_queryset_still_wins(self):\n169.         """Custom queryset has still precedence (#21405)"""\n170.         class SongAdmin(admin.ModelAdmin):\n171.             # Exclude one of the two Bands from the querysets\n172.             def formfield_for_foreignkey(self, db_field, request, **kwargs):\n173.                 if db_field.name == \'band\':\n174.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n175.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n176. \n177.             def formfield_for_manytomany(self, db_field, request, **kwargs):\n178.                 if db_field.name == \'other_interpreters\':\n179.                     kwargs["queryset"] = Band.objects.filter(rank__gt=2)\n180.                 return super().formfield_for_foreignkey(db_field, request, **kwargs)\n181. \n182.         class StaticOrderingBandAdmin(admin.ModelAdmin):\n183.             ordering = (\'rank\',)\n184. \n185.         site.unregister(Song)\n186.         site.register(Song, SongAdmin)\n187.         site.register(Band, StaticOrderingBandAdmin)\n188. \n189.         self.check_ordering_of_field_choices([self.b2])\n\n\nFile: django/contrib/auth/admin.py\nLine number range: 25 - 37\nContent:\n25. @admin.register(Group)\n26. class GroupAdmin(admin.ModelAdmin):\n27.     search_fields = (\'name\',)\n28.     ordering = (\'name\',)\n29.     filter_horizontal = (\'permissions\',)\n30. \n31.     def formfield_for_manytomany(self, db_field, request=None, **kwargs):\n32.         if db_field.name == \'permissions\':\n33.             qs = kwargs.get(\'queryset\', db_field.remote_field.model.objects)\n34.             # Avoid a major performance hit resolving permission names which\n35.             # triggers a content_type load:\n36.             kwargs[\'queryset\'] = qs.select_related(\'content_type\')\n37.         return super().formfield_for_manytomany(db_field, request=request, **kwargs)\n\n\nFile: tests/admin_views/tests.py\nLine number range: 5262 - 5293\nContent:\n5262. @override_settings(ROOT_URLCONF=\'admin_views.urls\')\n5263. class GroupAdminTest(TestCase):\n5264.     """\n5265.     Tests group CRUD functionality.\n5266.     """\n5267. \n5268.     @classmethod\n5269.     def setUpTestData(cls):\n5270.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=\'super@example.com\')\n5271. \n5272.     def setUp(self):\n5273.         self.client.force_login(self.superuser)\n5274. \n5275.     def test_save_button(self):\n5276.         group_count = Group.objects.count()\n5277.         response = self.client.post(reverse(\'admin:auth_group_add\'), {\n5278.             \'name\': \'newgroup\',\n5279.         })\n5280. \n5281.         Group.objects.order_by(\'-id\')[0]\n5282.         self.assertRedirects(response, reverse(\'admin:auth_group_changelist\'))\n5283.         self.assertEqual(Group.objects.count(), group_count + 1)\n5284. \n5285.     def test_group_permission_performance(self):\n5286.         g = Group.objects.create(name="test_group")\n5287. \n5288.         # Ensure no queries are skipped due to cached content type for Group.\n5289.         ContentType.objects.clear_cache()\n5290. \n5291.         with self.assertNumQueries(8):\n5292.             response = self.client.get(reverse(\'admin:auth_group_change\', args=(g.pk,)))\n5293.             self.assertEqual(response.status_code, 200)\n\n\nFile: tests/admin_widgets/tests.py\nLine number range: 638 - 718\nContent:\n638. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n639. class RelatedFieldWidgetWrapperTests(SimpleTestCase):\n640.     def test_no_can_add_related(self):\n641.         rel = Individual._meta.get_field(\'parent\').remote_field\n642.         w = widgets.AdminRadioSelect()\n643.         # Used to fail with a name error.\n644.         w = widgets.RelatedFieldWidgetWrapper(w, rel, widget_admin_site)\n645.         self.assertFalse(w.can_add_related)\n646. \n647.     def test_select_multiple_widget_cant_change_delete_related(self):\n648.         rel = Individual._meta.get_field(\'parent\').remote_field\n649.         widget = forms.SelectMultiple()\n650.         wrapper = widgets.RelatedFieldWidgetWrapper(\n651.             widget, rel, widget_admin_site,\n652.             can_add_related=True,\n653.             can_change_related=True,\n654.             can_delete_related=True,\n655.         )\n656.         self.assertTrue(wrapper.can_add_related)\n657.         self.assertFalse(wrapper.can_change_related)\n658.         self.assertFalse(wrapper.can_delete_related)\n659. \n660.     def test_on_delete_cascade_rel_cant_delete_related(self):\n661.         rel = Individual._meta.get_field(\'soulmate\').remote_field\n662.         widget = forms.Select()\n663.         wrapper = widgets.RelatedFieldWidgetWrapper(\n664.             widget, rel, widget_admin_site,\n665.             can_add_related=True,\n666.             can_change_related=True,\n667.             can_delete_related=True,\n668.         )\n669.         self.assertTrue(wrapper.can_add_related)\n670.         self.assertTrue(wrapper.can_change_related)\n671.         self.assertFalse(wrapper.can_delete_related)\n672. \n673.     def test_custom_widget_render(self):\n674.         class CustomWidget(forms.Select):\n675.             def render(self, *args, **kwargs):\n676.                 return \'custom render output\'\n677.         rel = Album._meta.get_field(\'band\').remote_field\n678.         widget = CustomWidget()\n679.         wrapper = widgets.RelatedFieldWidgetWrapper(\n680.             widget, rel, widget_admin_site,\n681.             can_add_related=True,\n682.             can_change_related=True,\n683.             can_delete_related=True,\n684.         )\n685.         output = wrapper.render(\'name\', \'value\')\n686.         self.assertIn(\'custom render output\', output)\n687. \n688.     def test_widget_delegates_value_omitted_from_data(self):\n689.         class CustomWidget(forms.Select):\n690.             def value_omitted_from_data(self, data, files, name):\n691.                 return False\n692.         rel = Album._meta.get_field(\'band\').remote_field\n693.         widget = CustomWidget()\n694.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n695.         self.assertIs(wrapper.value_omitted_from_data({}, {}, \'band\'), False)\n696. \n697.     def test_widget_is_hidden(self):\n698.         rel = Album._meta.get_field(\'band\').remote_field\n699.         widget = forms.HiddenInput()\n700.         widget.choices = ()\n701.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n702.         self.assertIs(wrapper.is_hidden, True)\n703.         context = wrapper.get_context(\'band\', None, {})\n704.         self.assertIs(context[\'is_hidden\'], True)\n705.         output = wrapper.render(\'name\', \'value\')\n706.         # Related item links are hidden.\n707.         self.assertNotIn(\'<a \', output)\n708. \n709.     def test_widget_is_not_hidden(self):\n710.         rel = Album._meta.get_field(\'band\').remote_field\n711.         widget = forms.Select()\n712.         wrapper = widgets.RelatedFieldWidgetWrapper(widget, rel, widget_admin_site)\n713.         self.assertIs(wrapper.is_hidden, False)\n714.         context = wrapper.get_context(\'band\', None, {})\n715.         self.assertIs(context[\'is_hidden\'], False)\n716.         output = wrapper.render(\'name\', \'value\')\n717.         # Related item links are present.\n718.         self.assertIn(\'<a \', output)\n\n\nFile: tests/admin_ordering/tests.py\nLine number range: 1 - 10\nContent:\n1. from django.contrib import admin\n2. from django.contrib.admin.options import ModelAdmin\n3. from django.contrib.auth.models import User\n4. from django.db.models import F\n5. from django.test import RequestFactory, TestCase\n6. \n7. from .models import (\n8.     Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,\n9.     SongInlineNewOrdering,\n10. )\n\n\nFile: tests/admin_widgets/tests.py\nLine number range: 1 - 500\nContent:\n1. import gettext\n2. import os\n3. import re\n4. from datetime import datetime, timedelta\n5. from importlib import import_module\n6. \n7. import pytz\n8. \n9. from django import forms\n10. from django.conf import settings\n11. from django.contrib import admin\n12. from django.contrib.admin import widgets\n13. from django.contrib.admin.tests import AdminSeleniumTestCase\n14. from django.contrib.auth.models import User\n15. from django.core.files.storage import default_storage\n16. from django.core.files.uploadedfile import SimpleUploadedFile\n17. from django.db.models import CharField, DateField, DateTimeField, UUIDField\n18. from django.test import SimpleTestCase, TestCase, override_settings\n19. from django.urls import reverse\n20. from django.utils import translation\n21. \n22. from .models import (\n23.     Advisor, Album, Band, Bee, Car, Company, Event, Honeycomb, Individual,\n24.     Inventory, Member, MyFileField, Profile, School, Student,\n25. )\n26. from .widgetadmin import site as widget_admin_site\n27. \n28. \n29. class TestDataMixin:\n30. \n31.     @classmethod\n32.     def setUpTestData(cls):\n33.         cls.superuser = User.objects.create_superuser(username=\'super\', password=\'secret\', email=None)\n34.         cls.u2 = User.objects.create_user(username=\'testser\', password=\'secret\')\n35.         Car.objects.create(owner=cls.superuser, make=\'Volkswagen\', model=\'Passat\')\n36.         Car.objects.create(owner=cls.u2, make=\'BMW\', model=\'M3\')\n37. \n38. \n39. class AdminFormfieldForDBFieldTests(SimpleTestCase):\n40.     """\n41.     Tests for correct behavior of ModelAdmin.formfield_for_dbfield\n42.     """\n43. \n44.     def assertFormfield(self, model, fieldname, widgetclass, **admin_overrides):\n45.         """\n46.         Helper to call formfield_for_dbfield for a given model and field name\n47.         and verify that the returned formfield is appropriate.\n48.         """\n49.         # Override any settings on the model admin\n50.         class MyModelAdmin(admin.ModelAdmin):\n51.             pass\n52.         for k in admin_overrides:\n53.             setattr(MyModelAdmin, k, admin_overrides[k])\n54. \n55.         # Construct the admin, and ask it for a formfield\n56.         ma = MyModelAdmin(model, admin.site)\n57.         ff = ma.formfield_for_dbfield(model._meta.get_field(fieldname), request=None)\n58. \n59.         # "unwrap" the widget wrapper, if needed\n60.         if isinstance(ff.widget, widgets.RelatedFieldWidgetWrapper):\n61.             widget = ff.widget.widget\n62.         else:\n63.             widget = ff.widget\n64. \n65.         self.assertIsInstance(widget, widgetclass)\n66. \n67.         # Return the formfield so that other tests can continue\n68.         return ff\n69. \n70.     def test_DateField(self):\n71.         self.assertFormfield(Event, \'start_date\', widgets.AdminDateWidget)\n72. \n73.     def test_DateTimeField(self):\n74.         self.assertFormfield(Member, \'birthdate\', widgets.AdminSplitDateTime)\n75. \n76.     def test_TimeField(self):\n77.         self.assertFormfield(Event, \'start_time\', widgets.AdminTimeWidget)\n78. \n79.     def test_TextField(self):\n80.         self.assertFormfield(Event, \'description\', widgets.AdminTextareaWidget)\n81. \n82.     def test_URLField(self):\n83.         self.assertFormfield(Event, \'link\', widgets.AdminURLFieldWidget)\n84. \n85.     def test_IntegerField(self):\n86.         self.assertFormfield(Event, \'min_age\', widgets.AdminIntegerFieldWidget)\n87. \n88.     def test_CharField(self):\n89.         self.assertFormfield(Member, \'name\', widgets.AdminTextInputWidget)\n90. \n91.     def test_EmailField(self):\n92.         self.assertFormfield(Member, \'email\', widgets.AdminEmailInputWidget)\n93. \n94.     def test_FileField(self):\n95.         self.assertFormfield(Album, \'cover_art\', widgets.AdminFileWidget)\n96. \n97.     def test_ForeignKey(self):\n98.         self.assertFormfield(Event, \'main_band\', forms.Select)\n99. \n100.     def test_raw_id_ForeignKey(self):\n101.         self.assertFormfield(Event, \'main_band\', widgets.ForeignKeyRawIdWidget,\n102.                              raw_id_fields=[\'main_band\'])\n103. \n104.     def test_radio_fields_ForeignKey(self):\n105.         ff = self.assertFormfield(Event, \'main_band\', widgets.AdminRadioSelect,\n106.                                   radio_fields={\'main_band\': admin.VERTICAL})\n107.         self.assertIsNone(ff.empty_label)\n108. \n109.     def test_many_to_many(self):\n110.         self.assertFormfield(Band, \'members\', forms.SelectMultiple)\n111. \n112.     def test_raw_id_many_to_many(self):\n113.         self.assertFormfield(Band, \'members\', widgets.ManyToManyRawIdWidget,\n114.                              raw_id_fields=[\'members\'])\n115. \n116.     def test_filtered_many_to_many(self):\n117.         self.assertFormfield(Band, \'members\', widgets.FilteredSelectMultiple,\n118.                              filter_vertical=[\'members\'])\n119. \n120.     def test_formfield_overrides(self):\n121.         self.assertFormfield(Event, \'start_date\', forms.TextInput,\n122.                              formfield_overrides={DateField: {\'widget\': forms.TextInput}})\n123. \n124.     def test_formfield_overrides_widget_instances(self):\n125.         """\n126.         Widget instances in formfield_overrides are not shared between\n127.         different fields. (#19423)\n128.         """\n129.         class BandAdmin(admin.ModelAdmin):\n130.             formfield_overrides = {\n131.                 CharField: {\'widget\': forms.TextInput(attrs={\'size\': \'10\'})}\n132.             }\n133.         ma = BandAdmin(Band, admin.site)\n134.         f1 = ma.formfield_for_dbfield(Band._meta.get_field(\'name\'), request=None)\n135.         f2 = ma.formfield_for_dbfield(Band._meta.get_field(\'style\'), request=None)\n136.         self.assertNotEqual(f1.widget, f2.widget)\n137.         self.assertEqual(f1.widget.attrs[\'maxlength\'], \'100\')\n138.         self.assertEqual(f2.widget.attrs[\'maxlength\'], \'20\')\n139.         self.assertEqual(f2.widget.attrs[\'size\'], \'10\')\n140. \n141.     def test_formfield_overrides_for_datetime_field(self):\n142.         """\n143.         Overriding the widget for DateTimeField doesn\'t overrides the default\n144.         form_class for that field (#26449).\n145.         """\n146.         class MemberAdmin(admin.ModelAdmin):\n147.             formfield_overrides = {DateTimeField: {\'widget\': widgets.AdminSplitDateTime}}\n148.         ma = MemberAdmin(Member, admin.site)\n149.         f1 = ma.formfield_for_dbfield(Member._meta.get_field(\'birthdate\'), request=None)\n150.         self.assertIsInstance(f1.widget, widgets.AdminSplitDateTime)\n151.         self.assertIsInstance(f1, forms.SplitDateTimeField)\n152. \n153.     def test_formfield_overrides_for_custom_field(self):\n154.         """\n155.         formfield_overrides works for a custom field class.\n156.         """\n157.         class AlbumAdmin(admin.ModelAdmin):\n158.             formfield_overrides = {MyFileField: {\'widget\': forms.TextInput()}}\n159.         ma = AlbumAdmin(Member, admin.site)\n160.         f1 = ma.formfield_for_dbfield(Album._meta.get_field(\'backside_art\'), request=None)\n161.         self.assertIsInstance(f1.widget, forms.TextInput)\n162. \n163.     def test_field_with_choices(self):\n164.         self.assertFormfield(Member, \'gender\', forms.Select)\n165. \n166.     def test_choices_with_radio_fields(self):\n167.         self.assertFormfield(Member, \'gender\', widgets.AdminRadioSelect,\n168.                              radio_fields={\'gender\': admin.VERTICAL})\n169. \n170.     def test_inheritance(self):\n171.         self.assertFormfield(Album, \'backside_art\', widgets.AdminFileWidget)\n172. \n173.     def test_m2m_widgets(self):\n174.         """m2m fields help text as it applies to admin app (#9321)."""\n175.         class AdvisorAdmin(admin.ModelAdmin):\n176.             filter_vertical = [\'companies\']\n177. \n178.         self.assertFormfield(Advisor, \'companies\', widgets.FilteredSelectMultiple,\n179.                              filter_vertical=[\'companies\'])\n180.         ma = AdvisorAdmin(Advisor, admin.site)\n181.         f = ma.formfield_for_dbfield(Advisor._meta.get_field(\'companies\'), request=None)\n182.         self.assertEqual(\n183.             f.help_text,\n184.             \'Hold down “Control”, or “Command” on a Mac, to select more than one.\'\n185.         )\n186. \n187. \n188. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n189. class AdminFormfieldForDBFieldWithRequestTests(TestDataMixin, TestCase):\n190. \n191.     def test_filter_choices_by_request_user(self):\n192.         """\n193.         Ensure the user can only see their own cars in the foreign key dropdown.\n194.         """\n195.         self.client.force_login(self.superuser)\n196.         response = self.client.get(reverse(\'admin:admin_widgets_cartire_add\'))\n197.         self.assertNotContains(response, "BMW M3")\n198.         self.assertContains(response, "Volkswagen Passat")\n199. \n200. \n201. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n202. class AdminForeignKeyWidgetChangeList(TestDataMixin, TestCase):\n203. \n204.     def setUp(self):\n205.         self.client.force_login(self.superuser)\n206. \n207.     def test_changelist_ForeignKey(self):\n208.         response = self.client.get(reverse(\'admin:admin_widgets_car_changelist\'))\n209.         self.assertContains(response, \'/auth/user/add/\')\n210. \n211. \n212. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n213. class AdminForeignKeyRawIdWidget(TestDataMixin, TestCase):\n214. \n215.     def setUp(self):\n216.         self.client.force_login(self.superuser)\n217. \n218.     def test_nonexistent_target_id(self):\n219.         band = Band.objects.create(name=\'Bogey Blues\')\n220.         pk = band.pk\n221.         band.delete()\n222.         post_data = {\n223.             "main_band": \'%s\' % pk,\n224.         }\n225.         # Try posting with a nonexistent pk in a raw id field: this\n226.         # should result in an error message, not a server exception.\n227.         response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), post_data)\n228.         self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n229. \n230.     def test_invalid_target_id(self):\n231. \n232.         for test_str in (\'Iñtërnâtiônàlizætiøn\', "1234\'", -1234):\n233.             # This should result in an error message, not a server exception.\n234.             response = self.client.post(reverse(\'admin:admin_widgets_event_add\'), {"main_band": test_str})\n235. \n236.             self.assertContains(response, \'Select a valid choice. That choice is not one of the available choices.\')\n237. \n238.     def test_url_params_from_lookup_dict_any_iterable(self):\n239.         lookup1 = widgets.url_params_from_lookup_dict({\'color__in\': (\'red\', \'blue\')})\n240.         lookup2 = widgets.url_params_from_lookup_dict({\'color__in\': [\'red\', \'blue\']})\n241.         self.assertEqual(lookup1, {\'color__in\': \'red,blue\'})\n242.         self.assertEqual(lookup1, lookup2)\n243. \n244.     def test_url_params_from_lookup_dict_callable(self):\n245.         def my_callable():\n246.             return \'works\'\n247.         lookup1 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable})\n248.         lookup2 = widgets.url_params_from_lookup_dict({\'myfield\': my_callable()})\n249.         self.assertEqual(lookup1, lookup2)\n250. \n251.     def test_label_and_url_for_value_invalid_uuid(self):\n252.         field = Bee._meta.get_field(\'honeycomb\')\n253.         self.assertIsInstance(field.target_field, UUIDField)\n254.         widget = widgets.ForeignKeyRawIdWidget(field.remote_field, admin.site)\n255.         self.assertEqual(widget.label_and_url_for_value(\'invalid-uuid\'), (\'\', \'\'))\n256. \n257. \n258. class FilteredSelectMultipleWidgetTest(SimpleTestCase):\n259.     def test_render(self):\n260.         # Backslash in verbose_name to ensure it is JavaScript escaped.\n261.         w = widgets.FilteredSelectMultiple(\'test\\\\\', False)\n262.         self.assertHTMLEqual(\n263.             w.render(\'test\', \'test\'),\n264.             \'<select multiple name="test" class="selectfilter" \'\n265.             \'data-field-name="test\\\\" data-is-stacked="0">\\n</select>\'\n266.         )\n267. \n268.     def test_stacked_render(self):\n269.         # Backslash in verbose_name to ensure it is JavaScript escaped.\n270.         w = widgets.FilteredSelectMultiple(\'test\\\\\', True)\n271.         self.assertHTMLEqual(\n272.             w.render(\'test\', \'test\'),\n273.             \'<select multiple name="test" class="selectfilterstacked" \'\n274.             \'data-field-name="test\\\\" data-is-stacked="1">\\n</select>\'\n275.         )\n276. \n277. \n278. class AdminDateWidgetTest(SimpleTestCase):\n279.     def test_attrs(self):\n280.         w = widgets.AdminDateWidget()\n281.         self.assertHTMLEqual(\n282.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n283.             \'<input value="2007-12-01" type="text" class="vDateField" name="test" size="10">\',\n284.         )\n285.         # pass attrs to widget\n286.         w = widgets.AdminDateWidget(attrs={\'size\': 20, \'class\': \'myDateField\'})\n287.         self.assertHTMLEqual(\n288.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n289.             \'<input value="2007-12-01" type="text" class="myDateField" name="test" size="20">\',\n290.         )\n291. \n292. \n293. class AdminTimeWidgetTest(SimpleTestCase):\n294.     def test_attrs(self):\n295.         w = widgets.AdminTimeWidget()\n296.         self.assertHTMLEqual(\n297.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n298.             \'<input value="09:30:00" type="text" class="vTimeField" name="test" size="8">\',\n299.         )\n300.         # pass attrs to widget\n301.         w = widgets.AdminTimeWidget(attrs={\'size\': 20, \'class\': \'myTimeField\'})\n302.         self.assertHTMLEqual(\n303.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n304.             \'<input value="09:30:00" type="text" class="myTimeField" name="test" size="20">\',\n305.         )\n306. \n307. \n308. class AdminSplitDateTimeWidgetTest(SimpleTestCase):\n309.     def test_render(self):\n310.         w = widgets.AdminSplitDateTime()\n311.         self.assertHTMLEqual(\n312.             w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n313.             \'<p class="datetime">\'\n314.             \'Date: <input value="2007-12-01" type="text" class="vDateField" \'\n315.             \'name="test_0" size="10"><br>\'\n316.             \'Time: <input value="09:30:00" type="text" class="vTimeField" \'\n317.             \'name="test_1" size="8"></p>\'\n318.         )\n319. \n320.     def test_localization(self):\n321.         w = widgets.AdminSplitDateTime()\n322. \n323.         with self.settings(USE_L10N=True), translation.override(\'de-at\'):\n324.             w.is_localized = True\n325.             self.assertHTMLEqual(\n326.                 w.render(\'test\', datetime(2007, 12, 1, 9, 30)),\n327.                 \'<p class="datetime">\'\n328.                 \'Datum: <input value="01.12.2007" type="text" \'\n329.                 \'class="vDateField" name="test_0"size="10"><br>\'\n330.                 \'Zeit: <input value="09:30:00" type="text" class="vTimeField" \'\n331.                 \'name="test_1" size="8"></p>\'\n332.             )\n333. \n334. \n335. class AdminURLWidgetTest(SimpleTestCase):\n336.     def test_get_context_validates_url(self):\n337.         w = widgets.AdminURLFieldWidget()\n338.         for invalid in [\'\', \'/not/a/full/url/\', \'javascript:alert("Danger XSS!")\']:\n339.             with self.subTest(url=invalid):\n340.                 self.assertFalse(w.get_context(\'name\', invalid, {})[\'url_valid\'])\n341.         self.assertTrue(w.get_context(\'name\', \'http://example.com\', {})[\'url_valid\'])\n342. \n343.     def test_render(self):\n344.         w = widgets.AdminURLFieldWidget()\n345.         self.assertHTMLEqual(\n346.             w.render(\'test\', \'\'),\n347.             \'<input class="vURLField" name="test" type="url">\'\n348.         )\n349.         self.assertHTMLEqual(\n350.             w.render(\'test\', \'http://example.com\'),\n351.             \'<p class="url">Currently:<a href="http://example.com">\'\n352.             \'http://example.com</a><br>\'\n353.             \'Change:<input class="vURLField" name="test" type="url" \'\n354.             \'value="http://example.com"></p>\'\n355.         )\n356. \n357.     def test_render_idn(self):\n358.         w = widgets.AdminURLFieldWidget()\n359.         self.assertHTMLEqual(\n360.             w.render(\'test\', \'http://example-äüö.com\'),\n361.             \'<p class="url">Currently: <a href="http://xn--example--7za4pnc.com">\'\n362.             \'http://example-äüö.com</a><br>\'\n363.             \'Change:<input class="vURLField" name="test" type="url" \'\n364.             \'value="http://example-äüö.com"></p>\'\n365.         )\n366. \n367.     def test_render_quoting(self):\n368.         """\n369.         WARNING: This test doesn\'t use assertHTMLEqual since it will get rid\n370.         of some escapes which are tested here!\n371.         """\n372.         HREF_RE = re.compile(\'href="([^"]+)"\')\n373.         VALUE_RE = re.compile(\'value="([^"]+)"\')\n374.         TEXT_RE = re.compile(\'<a[^>]+>([^>]+)</a>\')\n375.         w = widgets.AdminURLFieldWidget()\n376.         output = w.render(\'test\', \'http://example.com/<sometag>some-text</sometag>\')\n377.         self.assertEqual(\n378.             HREF_RE.search(output).groups()[0],\n379.             \'http://example.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n380.         )\n381.         self.assertEqual(\n382.             TEXT_RE.search(output).groups()[0],\n383.             \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n384.         )\n385.         self.assertEqual(\n386.             VALUE_RE.search(output).groups()[0],\n387.             \'http://example.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n388.         )\n389.         output = w.render(\'test\', \'http://example-äüö.com/<sometag>some-text</sometag>\')\n390.         self.assertEqual(\n391.             HREF_RE.search(output).groups()[0],\n392.             \'http://xn--example--7za4pnc.com/%3Csometag%3Esome-text%3C/sometag%3E\',\n393.         )\n394.         self.assertEqual(\n395.             TEXT_RE.search(output).groups()[0],\n396.             \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n397.         )\n398.         self.assertEqual(\n399.             VALUE_RE.search(output).groups()[0],\n400.             \'http://example-äüö.com/&lt;sometag&gt;some-text&lt;/sometag&gt;\',\n401.         )\n402.         output = w.render(\'test\', \'http://www.example.com/%C3%A4"><script>alert("XSS!")</script>"\')\n403.         self.assertEqual(\n404.             HREF_RE.search(output).groups()[0],\n405.             \'http://www.example.com/%C3%A4%22%3E%3Cscript%3Ealert(%22XSS!%22)%3C/script%3E%22\',\n406.         )\n407.         self.assertEqual(\n408.             TEXT_RE.search(output).groups()[0],\n409.             \'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;\'\n410.             \'alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\'\n411.         )\n412.         self.assertEqual(\n413.             VALUE_RE.search(output).groups()[0],\n414.             \'http://www.example.com/%C3%A4&quot;&gt;&lt;script&gt;alert(&quot;XSS!&quot;)&lt;/script&gt;&quot;\',\n415.         )\n416. \n417. \n418. class AdminUUIDWidgetTests(SimpleTestCase):\n419.     def test_attrs(self):\n420.         w = widgets.AdminUUIDInputWidget()\n421.         self.assertHTMLEqual(\n422.             w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n423.             \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="vUUIDField" name="test">\',\n424.         )\n425.         w = widgets.AdminUUIDInputWidget(attrs={\'class\': \'myUUIDInput\'})\n426.         self.assertHTMLEqual(\n427.             w.render(\'test\', \'550e8400-e29b-41d4-a716-446655440000\'),\n428.             \'<input value="550e8400-e29b-41d4-a716-446655440000" type="text" class="myUUIDInput" name="test">\',\n429.         )\n430. \n431. \n432. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n433. class AdminFileWidgetTests(TestDataMixin, TestCase):\n434. \n435.     @classmethod\n436.     def setUpTestData(cls):\n437.         super().setUpTestData()\n438.         band = Band.objects.create(name=\'Linkin Park\')\n439.         cls.album = band.album_set.create(\n440.             name=\'Hybrid Theory\', cover_art=r\'albums\\hybrid_theory.jpg\'\n441.         )\n442. \n443.     def test_render(self):\n444.         w = widgets.AdminFileWidget()\n445.         self.assertHTMLEqual(\n446.             w.render(\'test\', self.album.cover_art),\n447.             \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n448.             r\'hybrid_theory.jpg">albums\\hybrid_theory.jpg</a> \'\n449.             \'<span class="clearable-file-input">\'\n450.             \'<input type="checkbox" name="test-clear" id="test-clear_id"> \'\n451.             \'<label for="test-clear_id">Clear</label></span><br>\'\n452.             \'Change: <input type="file" name="test"></p>\' % {\n453.                 \'STORAGE_URL\': default_storage.url(\'\'),\n454.             },\n455.         )\n456.         self.assertHTMLEqual(\n457.             w.render(\'test\', SimpleUploadedFile(\'test\', b\'content\')),\n458.             \'<input type="file" name="test">\',\n459.         )\n460. \n461.     def test_render_required(self):\n462.         widget = widgets.AdminFileWidget()\n463.         widget.is_required = True\n464.         self.assertHTMLEqual(\n465.             widget.render(\'test\', self.album.cover_art),\n466.             \'<p class="file-upload">Currently: <a href="%(STORAGE_URL)salbums/\'\n467.             r\'hybrid_theory.jpg">albums\\hybrid_theory.jpg</a><br>\'\n468.             \'Change: <input type="file" name="test"></p>\' % {\n469.                 \'STORAGE_URL\': default_storage.url(\'\'),\n470.             },\n471.         )\n472. \n473.     def test_readonly_fields(self):\n474.         """\n475.         File widgets should render as a link when they\'re marked "read only."\n476.         """\n477.         self.client.force_login(self.superuser)\n478.         response = self.client.get(reverse(\'admin:admin_widgets_album_change\', args=(self.album.id,)))\n479.         self.assertContains(\n480.             response,\n481.             \'<div class="readonly"><a href="%(STORAGE_URL)salbums/hybrid_theory.jpg">\'\n482.             r\'albums\\hybrid_theory.jpg</a></div>\' % {\'STORAGE_URL\': default_storage.url(\'\')},\n483.             html=True,\n484.         )\n485.         self.assertNotContains(\n486.             response,\n487.             \'<input type="file" name="cover_art" id="id_cover_art">\',\n488.             html=True,\n489.         )\n490.         response = self.client.get(reverse(\'admin:admin_widgets_album_add\'))\n491.         self.assertContains(\n492.             response,\n493.             \'<div class="readonly"></div>\',\n494.             html=True,\n495.         )\n496. \n497. \n498. @override_settings(ROOT_URLCONF=\'admin_widgets.urls\')\n499. class ForeignKeyRawIdWidgetTest(TestCase):\n500. \n\n\nFile: tests/admin_widgets/models.py\nLine number range: 1 - 158\nContent:\n1. import uuid\n2. \n3. from django.contrib.auth.models import User\n4. from django.db import models\n5. \n6. \n7. class MyFileField(models.FileField):\n8.     pass\n9. \n10. \n11. class Member(models.Model):\n12.     name = models.CharField(max_length=100)\n13.     birthdate = models.DateTimeField(blank=True, null=True)\n14.     gender = models.CharField(max_length=1, blank=True, choices=[(\'M\', \'Male\'), (\'F\', \'Female\')])\n15.     email = models.EmailField(blank=True)\n16. \n17.     def __str__(self):\n18.         return self.name\n19. \n20. \n21. class Band(models.Model):\n22.     name = models.CharField(max_length=100)\n23.     style = models.CharField(max_length=20)\n24.     members = models.ManyToManyField(Member)\n25. \n26.     def __str__(self):\n27.         return self.name\n28. \n29. \n30. class Album(models.Model):\n31.     band = models.ForeignKey(Band, models.CASCADE)\n32.     featuring = models.ManyToManyField(Band, related_name=\'featured\')\n33.     name = models.CharField(max_length=100)\n34.     cover_art = models.FileField(upload_to=\'albums\')\n35.     backside_art = MyFileField(upload_to=\'albums_back\', null=True)\n36. \n37.     def __str__(self):\n38.         return self.name\n39. \n40. \n41. class HiddenInventoryManager(models.Manager):\n42.     def get_queryset(self):\n43.         return super().get_queryset().filter(hidden=False)\n44. \n45. \n46. class Inventory(models.Model):\n47.     barcode = models.PositiveIntegerField(unique=True)\n48.     parent = models.ForeignKey(\'self\', models.SET_NULL, to_field=\'barcode\', blank=True, null=True)\n49.     name = models.CharField(blank=False, max_length=20)\n50.     hidden = models.BooleanField(default=False)\n51. \n52.     # see #9258\n53.     default_manager = models.Manager()\n54.     objects = HiddenInventoryManager()\n55. \n56.     def __str__(self):\n57.         return self.name\n58. \n59. \n60. class Event(models.Model):\n61.     main_band = models.ForeignKey(\n62.         Band,\n63.         models.CASCADE,\n64.         limit_choices_to=models.Q(pk__gt=0),\n65.         related_name=\'events_main_band_at\',\n66.     )\n67.     supporting_bands = models.ManyToManyField(\n68.         Band,\n69.         blank=True,\n70.         related_name=\'events_supporting_band_at\',\n71.         help_text=\'Supporting Bands.\',\n72.     )\n73.     start_date = models.DateField(blank=True, null=True)\n74.     start_time = models.TimeField(blank=True, null=True)\n75.     description = models.TextField(blank=True)\n76.     link = models.URLField(blank=True)\n77.     min_age = models.IntegerField(blank=True, null=True)\n78. \n79. \n80. class Car(models.Model):\n81.     owner = models.ForeignKey(User, models.CASCADE)\n82.     make = models.CharField(max_length=30)\n83.     model = models.CharField(max_length=30)\n84. \n85.     def __str__(self):\n86.         return "%s %s" % (self.make, self.model)\n87. \n88. \n89. class CarTire(models.Model):\n90.     """\n91.     A single car tire. This to test that a user can only select their own cars.\n92.     """\n93.     car = models.ForeignKey(Car, models.CASCADE)\n94. \n95. \n96. class Honeycomb(models.Model):\n97.     id = models.UUIDField(primary_key=True, default=uuid.uuid4, editable=False)\n98.     location = models.CharField(max_length=20)\n99. \n100. \n101. class Bee(models.Model):\n102.     """\n103.     A model with a FK to a model that won\'t be registered with the admin\n104.     (Honeycomb) so the corresponding raw ID widget won\'t have a magnifying\n105.     glass link to select related honeycomb instances.\n106.     """\n107.     honeycomb = models.ForeignKey(Honeycomb, models.CASCADE)\n108. \n109. \n110. class Individual(models.Model):\n111.     """\n112.     A model with a FK to itself. It won\'t be registered with the admin, so the\n113.     corresponding raw ID widget won\'t have a magnifying glass link to select\n114.     related instances (rendering will be called programmatically in this case).\n115.     """\n116.     name = models.CharField(max_length=20)\n117.     parent = models.ForeignKey(\'self\', models.SET_NULL, null=True)\n118.     soulmate = models.ForeignKey(\'self\', models.CASCADE, null=True, related_name=\'soulmates\')\n119. \n120. \n121. class Company(models.Model):\n122.     name = models.CharField(max_length=20)\n123. \n124. \n125. class Advisor(models.Model):\n126.     """\n127.     A model with a m2m to a model that won\'t be registered with the admin\n128.     (Company) so the corresponding raw ID widget won\'t have a magnifying\n129.     glass link to select related company instances.\n130.     """\n131.     name = models.CharField(max_length=20)\n132.     companies = models.ManyToManyField(Company)\n133. \n134. \n135. class Student(models.Model):\n136.     name = models.CharField(max_length=255)\n137. \n138.     class Meta:\n139.         ordering = (\'name\',)\n140. \n141.     def __str__(self):\n142.         return self.name\n143. \n144. \n145. class School(models.Model):\n146.     name = models.CharField(max_length=255)\n147.     students = models.ManyToManyField(Student, related_name=\'current_schools\')\n148.     alumni = models.ManyToManyField(Student, related_name=\'previous_schools\')\n149. \n150.     def __str__(self):\n151.         return self.name\n152. \n153. \n154. class Profile(models.Model):\n155.     user = models.ForeignKey(\'auth.User\', models.CASCADE, to_field=\'username\')\n156. \n157.     def __str__(self):\n158.         return self.user.username\n\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-10-06 03:45:04,158 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nfrom django import forms\nfrom django.contrib import admin\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n\n# Models needed for the test, simplified from tests/admin_widgets/models.py\nclass Member(models.Model):\n    name = models.CharField(max_length=100)\n\n    def __str__(self):\n        return self.name\n\n\nclass Band(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(Member)\n\n    def __str__(self):\n        return self.name\n\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    """\n    Tests that formfield_for_manytomany respects the widget argument.\n    """\n\n    def test_formfield_for_manytomany_widget_override(self):\n        """\n        formfield_for_manytomany() should respect a passed widget, not ignore it.\n        """\n        class BandAdmin(admin.ModelAdmin):\n            pass\n\n        model_admin = BandAdmin(Band, admin.site)\n        db_field = Band._meta.get_field(\'members\')\n        \n        # Call formfield_for_manytomany, passing a widget override.\n        # The bug is that this widget is ignored.\n        field = model_admin.formfield_for_manytomany(\n            db_field,\n            request=None,\n            widget=forms.CheckboxSelectMultiple\n        )\n        \n        # This assertion will fail until the bug is fixed.\n        self.assertIsInstance(field.widget, forms.CheckboxSelectMultiple)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 6987, 'end_index': 7305, 'uri': 'https://github.com/django/django', 'license_': 'BSD-3-Clause', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 14349, 'candidates_token_count': 368, 'total_token_count': 18880, 'prompt_tokens_details': [{'modality': 1, 'token_count': 14349}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 368}], 'thoughts_token_count': 4163, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.739153654679008, 'model_name': 'gemini-2.5-pro'} id='run--8c061cc6-12a7-46aa-8576-0c056024ffb1-0' usage_metadata={'input_tokens': 14349, 'output_tokens': 368, 'total_tokens': 18880, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 4163}}
2025-10-06 03:45:16,278 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "from django import forms\\nfrom django.contrib import admin\\nfrom django.db import models\\nfrom django.test import SimpleTestCase\\n\\n\\n# Models needed for the test, simplified from tests/admin_widgets/models.py\\nclass Member(models.Model):\\n    name = models.CharField(max_length=100)\\n\\n    def __str__(self):\\n        return self.name\\n\\n\\nclass Band(models.Model):\\n    name = models.CharField(max_length=100)\\n    members = models.ManyToManyField(Member)\\n\\n    def __str__(self):\\n        return self.name\\n\\n\\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\\n    \\"\\"\\"\\n    Tests that formfield_for_manytomany respects the widget argument.\\n    \\"\\"\\"\\n\\n    def test_formfield_for_manytomany_widget_override(self):\\n        \\"\\"\\"\\n        formfield_for_manytomany() should respect a passed widget, not ignore it.\\n        \\"\\"\\"\\n        class BandAdmin(admin.ModelAdmin):\\n            pass\\n\\n        model_admin = BandAdmin(Band, admin.site)\\n        db_field = Band._meta.get_field(\'members\')\\n        \\n        # Call formfield_for_manytomany, passing a widget override.\\n        # The bug is that this widget is ignored.\\n        field = model_admin.formfield_for_manytomany(\\n            db_field,\\n            request=None,\\n            widget=forms.CheckboxSelectMultiple\\n        )\\n        \\n        # This assertion will fail until the bug is fixed.\\n        self.assertIsInstance(field.widget, forms.CheckboxSelectMultiple)\\n", "relative_path": "tests/admin_widgets/test_formfield_for_manytomany_widget.py"}'}, '__gemini_function_call_thought_signatures__': {'cfb892d4-6ba1-4e00-8ce8-7ffac5731fe6': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 503, 'end_index': 748, 'uri': 'https://github.com/typeddjango/django-stubs', 'license_': 'MIT', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 53672, 'candidates_token_count': 391, 'total_token_count': 55111, 'prompt_tokens_details': [{'modality': 1, 'token_count': 53672}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 391}], 'thoughts_token_count': 1048, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.18577368850903134, 'model_name': 'gemini-2.5-pro'} id='run--81f6fa71-afb2-478b-90d6-87af925255f8-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'from django import forms\nfrom django.contrib import admin\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n\n# Models needed for the test, simplified from tests/admin_widgets/models.py\nclass Member(models.Model):\n    name = models.CharField(max_length=100)\n\n    def __str__(self):\n        return self.name\n\n\nclass Band(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(Member)\n\n    def __str__(self):\n        return self.name\n\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    """\n    Tests that formfield_for_manytomany respects the widget argument.\n    """\n\n    def test_formfield_for_manytomany_widget_override(self):\n        """\n        formfield_for_manytomany() should respect a passed widget, not ignore it.\n        """\n        class BandAdmin(admin.ModelAdmin):\n            pass\n\n        model_admin = BandAdmin(Band, admin.site)\n        db_field = Band._meta.get_field(\'members\')\n        \n        # Call formfield_for_manytomany, passing a widget override.\n        # The bug is that this widget is ignored.\n        field = model_admin.formfield_for_manytomany(\n            db_field,\n            request=None,\n            widget=forms.CheckboxSelectMultiple\n        )\n        \n        # This assertion will fail until the bug is fixed.\n        self.assertIsInstance(field.widget, forms.CheckboxSelectMultiple)\n', 'relative_path': 'tests/admin_widgets/test_formfield_for_manytomany_widget.py'}, 'id': 'cfb892d4-6ba1-4e00-8ce8-7ffac5731fe6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 53672, 'output_tokens': 391, 'total_tokens': 55111, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1048}}
2025-10-06 03:45:18,060 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/admin_widgets/test_formfield_for_manytomany_widget.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 54093, 'candidates_token_count': 20, 'total_token_count': 54113, 'cached_content_token_count': 52479, 'prompt_tokens_details': [{'modality': 1, 'token_count': 55139}], 'cache_tokens_details': [{'modality': 1, 'token_count': 52479}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -4.821828770218417e-06, 'model_name': 'gemini-2.5-pro'} id='run--13a6fd44-fb34-4f87-ac71-08614a5b2949-0' usage_metadata={'input_tokens': 54093, 'output_tokens': 20, 'total_tokens': 54113, 'input_token_details': {'cache_read': 52479}}
2025-10-06 03:45:18,196 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/admin_widgets/test_formfield_for_manytomany_widget.py b/tests/admin_widgets/test_formfield_for_manytomany_widget.py
new file mode 100644
index 0000000000..2b90d05b68
--- /dev/null
+++ b/tests/admin_widgets/test_formfield_for_manytomany_widget.py
@@ -0,0 +1,47 @@
+from django import forms
+from django.contrib import admin
+from django.db import models
+from django.test import SimpleTestCase
+
+
+# Models needed for the test, simplified from tests/admin_widgets/models.py
+class Member(models.Model):
+    name = models.CharField(max_length=100)
+
+    def __str__(self):
+        return self.name
+
+
+class Band(models.Model):
+    name = models.CharField(max_length=100)
+    members = models.ManyToManyField(Member)
+
+    def __str__(self):
+        return self.name
+
+
+class FormfieldForManyToManyWidgetTest(SimpleTestCase):
+    """
+    Tests that formfield_for_manytomany respects the widget argument.
+    """
+
+    def test_formfield_for_manytomany_widget_override(self):
+        """
+        formfield_for_manytomany() should respect a passed widget, not ignore it.
+        """
+        class BandAdmin(admin.ModelAdmin):
+            pass
+
+        model_admin = BandAdmin(Band, admin.site)
+        db_field = Band._meta.get_field('members')
+        
+        # Call formfield_for_manytomany, passing a widget override.
+        # The bug is that this widget is ignored.
+        field = model_admin.formfield_for_manytomany(
+            db_field,
+            request=None,
+            widget=forms.CheckboxSelectMultiple
+        )
+        
+        # This assertion will fail until the bug is fixed.
+        self.assertIsInstance(field.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:45:18,197 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 03:45:18,241 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 03:45:18,242 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 03:45:18,744 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:45:18,744 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 5b884d45ac Fixed #29501 -- Allowed dbshell to pass options to underlying tool.

2025-10-06 03:45:18,744 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 03:45:18,845 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:45:18,845 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:45:18,845 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 03:45:18,845 - thread-139660780025408.app.docker.base_container - INFO - Creating directory tests/admin_widgets in the container
2025-10-06 03:45:18,845 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/admin_widgets
2025-10-06 03:45:18,946 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:45:18,946 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:45:18,946 - thread-139660780025408.app.docker.base_container - INFO - Updating tests/admin_widgets/test_formfield_for_manytomany_widget.py in the container
2025-10-06 03:45:18,949 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 03:45:21,742 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'14ad2172-c514-4157-a3e6-5773dbd77734': 'CqgHAR/Mhbb3mBHkP3YCcYDSMZdBo87Z+dGUOjkzLHLRKHiTDscpEr8BGaz+mrz7IH1FPDiL2dFuEFtVEG1GQ+J9uNWHqrYmUnkk5HDV1kV/FEyOKK15WNoS0uZp6sq515qwwAHDPETInsa2igF48qQ4pGG1QaULvD0EVAF3f8qOE9lk/YqEFNaRYT7R9Lu2ZuxzpzeySVDFJOrByFfC391r9W0slPitUaNOoAnCYOiWLl/yfH37ZIE9Qd1IT611TzvE+HfSMd6YobFiu+eMblaAqR+ylY4RtlY7w6F7XG2/tt8MzrONRqFc8IsWTuOwHGWfF5snHqk+c0x7/OXMwhkSAnh4vwsMDlUWWoJ8YG81CvJ80+7OrvDYQZ3jQwDowPB2u8z2feg8Dtu62w4H3wFigaVZsBLKNRROyJhXVH4k12YaJZveUZ5DAN8I9hcqmcX7weM4UMa9BDn3g+LRYYzSV1ve7QaeAhIE4mfcQrE+INdjwtRD+u8+f5t20xrkgQWukymtgi3Zp/p1w6FEfbilItKpYhgD3y7ZkA+Nb6GPDbTAReH6TMU1Vr+SflU43ZT3QHmO0OQY/zlmDiimkhmlBWFcuytoMMLNFOZGwxuGWqUbY9GIE336yi6zGZVpdnU1v6f+cJuSy7fcRMubKSzdSAKlwFXUwgY+o9Pyks5VDLuaPGBNHCXtSqYYL6b3KnipvywWHF/KuyjJ9G3zC7wN+/6jWswmVcdduev2Tlq7b7bpoLFHEVj1N+dNAho3BSvpuxlqeVBxSTPN/Kl/Kx4xXtu4FigJV7FdvHPFlaWGYN5sz1cw7hRWVxZL/JHc0Uptdk0zsk/lyV/mDhBpMOceu4jDJ4TwA5EJ5+5zpq4/eM/PEoKzaovHFEvYcWU6X96MDV5U1SIxeJF5j+lbWeqsXIt1Gc9hTm5sreFhW7tt20r+1LRLMA1YvndkbQe2cmXSIGcZw234aqgsu60AHe3f8M8U1IfHjEg1GTb+3ct6jb1+JFOICpR8YGtFiCHHipsybOmX7+vV/wbVZA3BEok4CaMgF8rZgL0tEaCTzaNuT9PhpOSs1Nm+H2+TaSBbYAn8ZvM844wT5tFKMStMayX4VfM+gwpCJrT0RMLda52InyaN77OYssGJtVVk2Z7xIDgtNkaC1WqBKrRm/OzE/4ECLZM/XjkKCGUALyBXNO3okmzfDNUtdb6FRveT6M3T09CzZsV1yD23EQkS3oX0glr6Ufi01aUHqRnu'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 303, 'candidates_token_count': 27, 'total_token_count': 558, 'prompt_tokens_details': [{'modality': 1, 'token_count': 303}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 228, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7809489214861834, 'model_name': 'gemini-2.5-pro'} id='run--ea54ce3c-4cc2-4818-8d84-b8f9b734415a-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '14ad2172-c514-4157-a3e6-5773dbd77734', 'type': 'tool_call'}] usage_metadata={'input_tokens': 303, 'output_tokens': 27, 'total_tokens': 558, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 228}}
2025-10-06 03:45:21,743 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:45:22,158 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:22,158 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 322, in run_from_argv
    parser = self.create_parser(argv[0], argv[1])
  File "/testbed/django/core/management/base.py", line 296, in create_parser
    self.add_arguments(parser)
  File "/testbed/django/core/management/commands/test.py", line 44, in add_arguments
    test_runner_class = get_runner(settings, self.test_runner)
  File "/testbed/django/test/utils.py", line 302, in get_runner
    test_runner_class = test_runner_class or settings.TEST_RUNNER
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 62, in _setup
    % (desc, ENVIRONMENT_VARIABLE))
django.core.exceptions.ImproperlyConfigured: Requested setting TEST_RUNNER, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

2025-10-06 03:45:24,296 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests"}'}, '__gemini_function_call_thought_signatures__': {'db2efc72-7736-4c2a-8f09-09c746ba636e': 'CtMDAR/MhbZSjMX0fMxvellB0Lv34dTNNZ9/h4nX4gmxtnchN9YVeE8MN6gY/hbyy17vWvrXTY74i6YXQRC6/MPC+FiH7TMSRNIxuilbY2ZejureuXe/vtRzChHx2GHr5pqy+H53s6w4lfGyi0P8t7WRcne4PxCE/StzQCmxaegRNq6zH9yN2bfUGaXk7aE9mb6E2a2ch7AcBMcj4GkhGHdc15QYY3Q0jXn4Mi50sHjR7Kys4S+m1BF3VPy8vC9GNf6thmLPnMAxyNpwhBIGKo0BXP5rmrBazF2wtilHXRwawv1Pa10xf8tTd6zytGivqROR7sa8g1A0ExJEfHvAbYfAXRJmZFt70fYKBCncOzO/tlbanTZrx84fVlOiH8jYbnA92ozMOeRhKQOJ47NJUSs/n4vVZ4Ahe/xyFMhhTXZdRC4KoHaElhauhSjRR+rZaA7rC7viz30W0iOH3RpcR7Mvwje99Vg6545szVIahIB0zel/oxyZPVPD8HZuanxu6BGDjd+CistqrCUxyLP0sETJVQkAbQTxQ0R10OCJ4T9KGaBU7xIe0JqCwK/YL42GRXOvARzM+IQpjz9pM3yv5Fu48mnzhiJp+mOApa8I+MiMbkgrymM='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 892, 'candidates_token_count': 6, 'total_token_count': 998, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1118}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 6}], 'thoughts_token_count': 100, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.658978780110677, 'model_name': 'gemini-2.5-pro'} id='run--3d3aa345-b2f1-469a-a46d-59c90724798f-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests'}, 'id': 'db2efc72-7736-4c2a-8f09-09c746ba636e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 892, 'output_tokens': 6, 'total_tokens': 998, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 100}}
2025-10-06 03:45:24,297 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests
2025-10-06 03:45:24,398 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:45:24,398 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

absolute_url_overrides	     m2o_recursive
admin_autodiscover	     mail
admin_changelist	     managers_regress
admin_checks		     many_to_many
admin_custom_urls	     many_to_one
admin_default_site	     many_to_one_null
admin_docs		     max_lengths
admin_filters		     messages_tests
admin_inlines		     middleware
admin_ordering		     middleware_exceptions
admin_registration	     migrate_signals
admin_scripts		     migrations
admin_utils		     migrations2
admin_views		     migration_test_data_persistence
admin_widgets		     modeladmin
aggregation		     model_enums
aggregation_regress	     model_fields
annotations		     model_forms
app_loading		     model_formsets
apps			     model_formsets_regress
asgi			     model_indexes
async			     model_inheritance
auth_tests		     model_inheritance_regress
backends		     model_meta
base			     model_options
bash_completion		     model_package
basic			     model_regress
builtin_server		     multiple_database
bulk_create		     mutually_referential
cache			     nested_foreign_keys
check_framework		     no_models
conditional_processing	     null_fk
constraints		     null_fk_ordering
contenttypes_tests	     null_queries
context_processors	     one_to_one
csrf_tests		     ordering
custom_columns		     order_with_respect_to
custom_lookups		     or_lookups
custom_managers		     pagination
custom_methods		     postgres_tests
custom_migration_operations  prefetch_related
custom_pk		     project_template
datatypes		     properties
dates			     proxy_model_inheritance
datetimes		     proxy_models
db_functions		     queries
dbshell			     queryset_pickle
db_typecasts		     raw_query
db_utils		     README.rst
decorators		     redirects_tests
defer			     requests
defer_regress		     requirements
delete			     reserved_names
delete_regress		     resolve_url
deprecation		     responses
dispatch		     reverse_lookup
distinct_on_fields	     runtests.py
empty			     save_delete_hooks
empty_models		     schema
expressions		     select_for_update
expressions_case	     select_related
expressions_window	     select_related_onetoone
extra_regress		     select_related_regress
field_deconstruction	     serializers
field_defaults		     servers
field_subclassing	     sessions_tests
files			     settings_tests
file_storage		     shell
file_uploads		     shortcuts
filtered_relation	     signals
fixtures		     signed_cookies_tests
fixtures_model_package	     signing
fixtures_regress	     sitemaps_tests
flatpages_tests		     sites_framework
force_insert_update	     sites_tests
foreign_object		     staticfiles_tests
forms_tests		     str
from_db_value		     string_lookup
generic_inline_admin	     swappable_models
generic_relations	     syndication_tests
generic_relations_regress    template_backends
generic_views		     template_loader
get_earliest_or_latest	     templates
get_object_or_404	     template_tests
get_or_create		     test_client
gis_tests		     test_client_regress
handlers		     test_exceptions
httpwrappers		     test_runner
humanize_tests		     test_runner_apps
i18n			     test_sqlite.py
import_error_package	     test_utils
indexes			     timezones
inline_formsets		     transaction_hooks
inspectdb		     transactions
introspection		     unmanaged_models
invalid_models_tests	     update
known_related_objects	     update_only_fields
logging_tests		     urlpatterns
lookup			     urlpatterns_reverse
m2m_and_m2o		     urls.py
m2m_intermediary	     user_commands
m2m_multiple		     utils_tests
m2m_recursive		     validation
m2m_regress		     validators
m2m_signals		     version
m2m_through		     view_tests
m2m_through_regress	     wsgi

2025-10-06 03:45:26,280 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'37c84a6b-0dff-472e-9bbd-44147b7e459d': 'CqYDAR/Mhbbrqb+9flLwTt/8X9Cju34+fxH3mqjNeKvC0rPLm/AqpXT+m6W1TC4O5LVj7wm63SEvB2sR26MYx6aS6bb7yuV2eLsG8xilsEKEjbIewkay06WU8M5oSwi5Vrq69UjTOLZ65ex6wyPy9Ej8t7b2K9h6aEGlnZ/xw96k0tvZFXIeL3Pm5XZR0er4Pf9hSu+3Bgoa5BSCmSs9oLC9WCbEXFSwRPI0wsYZZcJe07o1ORFpba5PrSTxjF4TBYbZRqShL3Klp6HYLtQIDXpcc8YOT2CnM658f9ox3rR5ATs+BtH6S5NeUc1+cwAyk4CXNrLRYVksLX6gpnt5HIVf5oxlUyA5/DMydERqEBwI2Kw81MOd5ZO1qrGU5t9J8ctKncgYtZY7cVPxGBMgnPSHiQl+0PeTmS8GdwR/G13aveWaeK7N9oFZXjraK4J030CN2+RPMDX4CmKf8MJkA8Y9Z3wjQ7qI5Vt9zGaUXLdYEAXesqBvOtaIXDNMbr/PvNBM9/ZKi4won7fnMYysr2Yt/c+OlUxiI32mf+uVbBfS9Q41/cSmKT0='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1908, 'candidates_token_count': 29, 'total_token_count': 2041, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2232}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 29}], 'thoughts_token_count': 104, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.1941998415979846, 'model_name': 'gemini-2.5-pro'} id='run--9ff267a6-c3bc-411b-b5c3-4d8dd9f860db-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '37c84a6b-0dff-472e-9bbd-44147b7e459d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1908, 'output_tokens': 29, 'total_tokens': 2041, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 104}}
2025-10-06 03:45:26,281 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:45:26,625 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:26,625 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class tests.admin_widgets.test_formfield_for_manytomany_widget.Member doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 03:45:29,242 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'3b65e079-43ef-4535-b422-5892edb8cd95': 'CpwGAR/MhbaT7EX/NLFaJ3bLiKY9TiztLbbMnqRCPXvsAOvlFzPvlvS6mqJiPFCsKNt89ITRg2zpJbf6NoyZqrpyRgEV3JRC6MJ5e2BW+ub5LpbH9c/pj+NeVzKBf3HX3djY3ssL6Iwu5LG3mtjv9krbogZ8pXxL+p5E9bkK6RBmy0tYeLzaX8C1cpaQTKodFuoWquMk/vqcOIo6YEToPFiugM+9sgrybL/N2EFeq4K91bu+fiK5SquwDBgQ9LduzLSYSBikFICXB71ahSCv5BRK1t8SvU0xhyQaRAXLIjlJzc448Q9kAiZNaIm8YYcaq9md9f1IubEy4wL29muTPQgsHxq3yt1fYMc0Hpljq3ikJ5YEPRXgG+4yxCmnIopLuhw8gaYDoufhFETqyEWAdKI1M4MwwU4bAF3T2Jl8yDZjC9i6qCXckMkykC1btDLlo6GnvOmAOJfi2pphgVe5ItM+VRTSkxn/bk9+4Ab155bh8l+GhtGLsYEf5YXXKiP64nPrLwbSpcsye5Y8Ut+U9CLgW+qavqKT8GVXi2FobjCnrtBPb/HhTyJGvbmAPvw5FTmvU3HM7ueDtfBwhdaugNhIYHQtFBIkPspt+mBGxGvVfVo3NEwEqHKIhpaMcUzeGegdcK9TfCbF40s6W67MGytsOxN9sSJWIUebUJAMddxGkbH0xVAYMkj53ZO6W8jOXIJfWnkRPdNlrRHfMRM4KzMBYvy6TyGQIy9dmTuypieXEIAzLOk7Clhv6S5z2rAUDlJuEHInSD5uFmaP/tcqLEFxgKO27MRjrItr8tycOStBxI9ZN/pjuh7rKlA/RxUS2OHBg/NLsrNKexkoeURivHDFyRPFpf4GgN0Mp4U50HIVaFkoz1u8gd8wXLJT2mJ2PF22L0zG5XJEvYU0WT0CxCkGffFxRHvE6YIG8Yk6bzeKNxWZg9lFz9GG0rItPeFup+MFP2Zb2gomdi4YEp/yOmYLzL7tgP2uA+yr/6XkrJy7EDYasb0F8ZhiICKhlkfaa8SaGFvzWN9sSHUZxIvFOyybGNziwKMoFi+AZUjYqQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2311, 'candidates_token_count': 27, 'total_token_count': 2536, 'cached_content_token_count': 1501, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2737}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1501}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 198}, 'finish_reason': 'STOP', 'avg_logprobs': -0.769160306012189, 'model_name': 'gemini-2.5-pro'} id='run--6130e7e2-8691-416a-8544-f4a9d21ed1c1-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '3b65e079-43ef-4535-b422-5892edb8cd95', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2311, 'output_tokens': 27, 'total_tokens': 2536, 'input_token_details': {'cache_read': 1501}, 'output_token_details': {'reasoning': 198}}
2025-10-06 03:45:29,245 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:45:29,530 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:29,531 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 321, in __new__
    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)
  File "/testbed/django/apps/registry.py", line 229, in register_model
    (model_name, app_label, app_models[model_name], model))
RuntimeError: Conflicting 'member' models in application 'admin_widgets': <class 'admin_widgets.models.Member'> and <class 'admin_widgets.test_formfield_for_manytomany_widget.Member'>.

2025-10-06 03:45:32,796 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/admin_widgets/test_formfield_for_manytomany_widget.py"}'}, '__gemini_function_call_thought_signatures__': {'e9a92c19-0586-4e14-ae02-7597cc466a12': 'CqQJAR/MhbYh5/47XYb8o/1x+wFZz0y21glOCLWMg3xAAYBXUfeogYnOB0tYhpYi0//hff73v2kg25WFO5QL9HHYDhTVvWh6WEGk95WFbKn0+I8a2tAJWUZir9DlCVOKF18P547RLQ/5SGJbQ8D5Zi+X8qNAZY5+nrmCj8PlPyqcJN9P86WcRlHcStj7YjZd2ktZzx/W+oOB1i2NLDCcEgT7cVv5WVgACqdhZB1LhVOxEUu7jGvCe+RVrC3R6aEkzU2wEzFbM4nqS9MCCUvLiv/bAjBDtaKl6klCmrMFUlTwNu65mQShl1O8Y9ZlxLGOx4KHJo9wVgC6bcQUUsrD4JBw7v6dOqArQj8BkLMh/rqyNuIlJL/Qjn45L6osCfdxd4pmPS/gRW02MJJ7kU+8Og79lV8P5F2WcsO0QE57dsuL9nX38mwtpRdUC/KPrXGJlBFphLNsW1kBcZWgJrK/x/oHnQ31YpsqeShhBCehu+Y29KFovC/4uZRK+81Xx5sSGAVcCTj5TWCdqE4p7OzbvVG7sfmfL+35ww7m8KbWprzNnc1StJYd6pYAehiSoGZ32swWEgMDE4gZ3P+r8dooLqBiipho/I/n4Mtz7iQ5E4jwhtaLkHthPkQGB9MqjlPi2vy694Nv1o2Oh9kT78A1Ch18HucS3dBDtdt4cR0vGwI160aKAQjORKigUwSrn5AoUFWVUKfU/dIXKuNS2aS5lKAVQnlS0eSRbRkXS9E/ujkz9pMQQVndfrqxM4mLYifusIuRKHX42X6iTWjp3aM0UGtoUQtxgEGb2UYyCiIUnLnONQrJva5umcYMAR+L4NWf6oB9T/4d8cX5kJrNZELfB8TB4CnqnV+A1tmSC5wcSVZveR+W0VdRraPiYFbc2RcgULfxUVa9yILuQ/pEz0ZkaEEs174zDIPEIagd4pWS+e1PRyzeZRPHJLEJZwvAt4HauoE71V3tJCh+/R5y8LvYDEl/+j0nLScQPIrPPvyTlCLYBKHTxyvOr9fR9FNyiZA4GM0W5qz4UDL/rNtOcUVYcZGi0Fi/Krg59rzHLuiCM0vy00XikfKS4alSBHNBFrMGWr76T/YHd6fwJt0FYmt1D96362MNH+HupnbF103+SRV1TAufSGPHDqKqRBzxAcIt/TytbbGHfQqLFuYRecoUFx2zAMRR2MAP7v5gOtSOQuAlm35YoE4fzO9CjY6rFYLIzfoZfCe1jn7bnCT1AaIx7DoyeIjKhdh+3vQfWcXo7MkcS0yGYMLc3PnknxSl4ZMsYQ2U5rx3Kuw7d7da/T6tHZ1upmpsht7YkFXqehrU4hoCTaBvdhuDHFJBmGByTFsseG2sh5GgkokdXrsYPIZY1u2DTNtIKBNcaRZiaXePn0Cme7Q4DTsVa1X5XI3PHsWrr6L6IX7CfpKMlV9AxG44EX2lhn+B+9HVEFCQyrqrtv3M4ufvesqDkppiTy1SOkJGRU5jELdzzNN7/lF43VU7JsCkNEs5WQzDdwr6dCoGHFbcdwFZ+auntm719rcYROTu0P9Wi96xgsCMY+kvl3Ms9FOeoj5FyboS83AcpLVSCLVUVjdHSRdq'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2777, 'candidates_token_count': 25, 'total_token_count': 3102, 'cached_content_token_count': 1565, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3399}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1565}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 300}, 'finish_reason': 'STOP', 'avg_logprobs': -1.235330581665039, 'model_name': 'gemini-2.5-pro'} id='run--df5eb70c-5a86-4357-9a59-f0cbcd195c47-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/admin_widgets/test_formfield_for_manytomany_widget.py'}, 'id': 'e9a92c19-0586-4e14-ae02-7597cc466a12', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2777, 'output_tokens': 25, 'total_tokens': 3102, 'input_token_details': {'cache_read': 1565}, 'output_token_details': {'reasoning': 300}}
2025-10-06 03:45:32,797 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/admin_widgets/test_formfield_for_manytomany_widget.py
2025-10-06 03:45:32,898 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:45:32,898 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

from django import forms
from django.contrib import admin
from django.db import models
from django.test import SimpleTestCase


# Models needed for the test, simplified from tests/admin_widgets/models.py
class Member(models.Model):
    name = models.CharField(max_length=100)

    def __str__(self):
        return self.name


class Band(models.Model):
    name = models.CharField(max_length=100)
    members = models.ManyToManyField(Member)

    def __str__(self):
        return self.name


class FormfieldForManyToManyWidgetTest(SimpleTestCase):
    """
    Tests that formfield_for_manytomany respects the widget argument.
    """

    def test_formfield_for_manytomany_widget_override(self):
        """
        formfield_for_manytomany() should respect a passed widget, not ignore it.
        """
        class BandAdmin(admin.ModelAdmin):
            pass

        model_admin = BandAdmin(Band, admin.site)
        db_field = Band._meta.get_field('members')
        
        # Call formfield_for_manytomany, passing a widget override.
        # The bug is that this widget is ignored.
        field = model_admin.formfield_for_manytomany(
            db_field,
            request=None,
            widget=forms.CheckboxSelectMultiple
        )
        
        # This assertion will fail until the bug is fixed.
        self.assertIsInstance(field.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:45:34,576 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest"}'}, '__gemini_function_call_thought_signatures__': {'816bf09f-3301-485f-b74d-75e52e9f92bc': 'CpIDAR/Mhbbr5b866fmFOJmPce/kf7OOF0zM4qqrinDi/L5hj7/9/pD2TpJpIl+Zv+AVXtzUEddFjI0P1ndvRowCx2RmKyXlBWi4AlJQfdZwFKx85vzf9UtNwdLLwJyv/sxIHNTHHgND4LuiQsv9VCFebDAt0YOnKSwg1glrqJBGRVPPOxdXWh0usz7kqbY2Ll1Oa+90L7BoO0BHtGECIWB7yH1IHQJHtds9X6ipY7wQRpZRC6XtqdC8l0BE7nyLc6lUmRdryJH1cORHD9rVR69n63yP/sdNGqVrs7FfFZlC/29fYN7eSIX5V2LfLNACJKzp9lVRX8197WvbEwqZR8cnQ2XcpkCfsdH1+OyuS82pdq2WgI/2JBEQ402Vb5uO3XC3/ZwLB8lhINEMUxwvNlfDXbxNHgNk7SFNdkS/6z0h74GPMhxDbTB839kAkFcYAnwWpMoZgJfFTwvYv67l5whzAL69jef319Io7lH6li5HVTA7cE4sMUDgS/DH7WOtJ8IyiUre8rv8FgXCPtN696pdR3rN'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3171, 'candidates_token_count': 34, 'total_token_count': 3300, 'cached_content_token_count': 3212, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4091}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3212}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 34}], 'thoughts_token_count': 95}, 'finish_reason': 'STOP', 'avg_logprobs': -0.20563073719249053, 'model_name': 'gemini-2.5-pro'} id='run--a8db8527-ec2b-472c-94b2-fa8649b73b80-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest'}, 'id': '816bf09f-3301-485f-b74d-75e52e9f92bc', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3171, 'output_tokens': 34, 'total_tokens': 3300, 'input_token_details': {'cache_read': 3212}, 'output_token_details': {'reasoning': 95}}
2025-10-06 03:45:34,577 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest
2025-10-06 03:45:34,862 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:34,862 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 321, in __new__
    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)
  File "/testbed/django/apps/registry.py", line 229, in register_model
    (model_name, app_label, app_models[model_name], model))
RuntimeError: Conflicting 'member' models in application 'admin_widgets': <class 'admin_widgets.models.Member'> and <class 'admin_widgets.test_formfield_for_manytomany_widget.Member'>.

2025-10-06 03:45:37,554 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest"}'}, '__gemini_function_call_thought_signatures__': {'3437aea6-41b9-43f4-8b47-13c4ea620501': 'Co4GAR/MhbbGbuOp6KN+lZIMUzylW9mR98PE/rL77DIGgLlouWSs0KAwxGLoDRA09IUR36FHdMsMcMvnyjDSoEpNFGlQGM6NpAXzWE99NmA9gQFz1ur6U6A4spM6Ha6QNoBIbFNUGgxgBgo7FInhsc7OFTpRzSawtMTBuqKaVODj485AP/QYAQGjMjRqy5jBD3MJUYJxClvKRleUQNcg+bG6yRau+7diBrynmaUEue89+JCV2RdOFpqPbrMNSx3PohnXZ3kRnS5HyE6UITg1+lhGpsx6AIQcwLXQwA7ivXJCQVXbIfKl2tT/Ib7vclboKyBsBGGRxMB5YA/ag12Usr5Fzw4L14pBinhP5I+8QtlYHg3Oawllga1ZOJhlhLxhillqIK4Yt/BKMQU3aYqDjHoTWl1qhR9eYp5AHNRkGHcMk/Q8lQ5kfxVK48H8tsgyh3fsd9DjToDMZgSwqdGHXseLz0h2F+UTbDmdsYdlVeQf5bGA6Xl25UkjYXx7cQyR4jdb2pCrMoUOIQHNuo7ykLuOY8wqYfGCjzSj8Xufyzs2bg/xRh/N2lTfGcbughjgA9QF6PsEjG+8b+SFEk0bKG5+9nFOlNRMeQzilMoR4MblNDSStt3Ocbbif/dPVJaXQ/h0SnCvL/GzWrTj4uam5T5doxdb7MMvjWMRye55mkSGetMyvLD7RltjoYH3cScxPnv915EnXoU1kky6QWtvAIwem8oYXy7l6F2ykILR/DSYUraLzyrqy76avqRr50TKLzrFV2k2Vtb8JaXfrAmk8Q5tl3QM5+yol5igxiJB5csHQltlrRZOQM1TX1Rz+/hD+wrR9pvZnzh1Jdmn6gPtJXVjYeZ5IJNFYjJ6ZjINAcNQI6iusNIw7e6R42sK7cGHEF1vNl7djItZGcBh5LAfHjxyeHn7vlkRIVLVR7ormVde1hEQXtODi3xJQfEo9hlcZ0uc57A6WWeADClKSHMl+sCPrxl3pu7pUajzE+9DpET1p2bMCj/8AECCb8uGcjtFJFCrBZu45GvQIQVNV5Jp8wY='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3644, 'candidates_token_count': 36, 'total_token_count': 3877, 'cached_content_token_count': 3270, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4657}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3270}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 36}], 'thoughts_token_count': 197}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5963347752888998, 'model_name': 'gemini-2.5-pro'} id='run--5020c8c0-c422-4d0e-b7f0-2c73f8e9a530-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest'}, 'id': '3437aea6-41b9-43f4-8b47-13c4ea620501', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3644, 'output_tokens': 36, 'total_tokens': 3877, 'input_token_details': {'cache_read': 3270}, 'output_token_details': {'reasoning': 197}}
2025-10-06 03:45:37,555 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest
2025-10-06 03:45:37,832 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:37,832 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class tests.admin_widgets.test_formfield_for_manytomany_widget.Member doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 03:45:40,403 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest.test_formfield_for_manytomany_widget_override"}'}, '__gemini_function_call_thought_signatures__': {'986d0972-42c1-4a38-aa54-8d25fcfd79b3': 'CvkGAR/MhbYOooj4XOXyNfCc41IX1Y1HpjpThZ455SYUwZQDPx/JOOGFjII7FPx7eJ5UjXIx+U/9ckEEfGvCq9OJy9kUJb6DErZt2YST2yOPgRXKzaPgzsoqZRUxzdftUvu1O95bxvLc6toDTS6X3upcemb9H44jpl27xzN7+ZKIaNiApRjMBC3qE0epP3gdgYCLEF/6cgJ0ucsj4gc/7OftZeag+RLIdJDq4trVq4/UDCBmeauYl2RvyRue8MXwQH9EyCHRX5Dlprxjjs/cb4JWSFpwZWsGM+kdO9IZ8fQXHys/4U1Ko3ew2oz6fztSAU9ydI65XInYvNnRO3LuodVZWcCRZufhyqb+WA9nmR6JWdgrVFl+tZqA/zRnjYdewNjPN44keg3OB8KERwfm+WcFIPV/53z7dEdYIPxeBq44CgSa3lTk5pz2b5hF2vjBZBSL25uNrUnpGNRRx7T3TCqjgB3AxD3EKuqEEh6xqw3875yDOH68MMaxUbzMs4Y5CP1Iupp+HxVqoQ8Yeza8BsQvYcxCyQydh2ZuNivIxr41M+jS7oCNEtDSA0tkb4KE0AjP00VPXuzjwB0lH53PDzxoJur5zdPW14SBLYXYVIns/0NMJdxOXCesn+ibB/UL6SsYGGgjFNJtrV4nq0bWYymAt/C5ntSTfAWro25aVzVTzoX/PRdhqQmxifu2Funkw9wY9tnFnJuA5rL429s0wXhkYfakWfpIWy6uraOIFHazswLpYeIZLR5YWifjvAdqO+qNOoEsLCskMOyR9cPnEo+99u6yhMS4U8J4ieAayPzKdzck7adTjeB1mOnDoMIMQylOiaUsR6Bxaqg8i9MeEySZolvHwBNqLnsPZJwE4EnKlgvtYLY9dk1AiYC3T0rEWySnTIKvsuNbL+Gqpd3VsKXxnOuvRdNmNLf14doXlCDA/4YZcEaHxYFXEhqMIZafyDrxWiaVzM7oJCTtepwJBCxS1xsWRubVfpl3TPYH25CZCi06n8yTAbqEIACi0sEfv5C3FWFt/vq4t3KS7cTdAl+rFrdaCceM3UbWofKCs7aQPjCFrEM8KM51PK2OC0bwqFO7VdVq75o4R0L3uqt2f4hhb3T2Aa96yDHT0uq3Bg12FdSgwWX1yiz86ituQ4i63xpy7rme9uueeYqvcD3vGd8O77eHXrwTvd+fyg=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4054, 'candidates_token_count': 49, 'total_token_count': 4330, 'cached_content_token_count': 3323, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5262}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3323}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 49}], 'thoughts_token_count': 227}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2950287254489198, 'model_name': 'gemini-2.5-pro'} id='run--2dac5d28-57af-4210-857a-1f2e3485a8b1-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest.test_formfield_for_manytomany_widget_override'}, 'id': '986d0972-42c1-4a38-aa54-8d25fcfd79b3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4054, 'output_tokens': 49, 'total_tokens': 4330, 'input_token_details': {'cache_read': 3323}, 'output_token_details': {'reasoning': 227}}
2025-10-06 03:45:40,405 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest.test_formfield_for_manytomany_widget_override
2025-10-06 03:45:40,694 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:40,694 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 321, in __new__
    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)
  File "/testbed/django/apps/registry.py", line 229, in register_model
    (model_name, app_label, app_models[model_name], model))
RuntimeError: Conflicting 'member' models in application 'admin_widgets': <class 'admin_widgets.models.Member'> and <class 'admin_widgets.test_formfield_for_manytomany_widget.Member'>.

2025-10-06 03:45:43,271 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --help"}'}, '__gemini_function_call_thought_signatures__': {'979fb9b8-c620-4479-b73d-74e09e75b020': 'CpYGAR/MhbYHWEYPGVyGvMXE5adNNLEmnpkqejXG6stDl7JSGoDgg9oEDPgz7gX1ruDSl/wTvJGJE5F/NIPP/9h6RSRZVD0tLBYyx8f5r/J5+8SHxaiREu7Nw2Qd/8q7LLRHjvL13avbqiToHf9+P+jL7a9bRaei+1c8X/6FssLWRSRNmNTX3Cyt9kfWGw+fdxNNVIWR9zvK3a+qNBVxTWGSQBSXhakDi9pY6HAW/nAZlwWrsi5Ntb0wcl9p1BriLZHt1vfzOvgPB0UiLDEWNvNQWz3+S8xjHnL+pix2fq54mIDwxD6TIujd7yEGsF1pUjBT0XG+pW5juluZjKisUhPr23iXd3/manepi0ChbqHbd8kUuv3EylLLtrAM7G5zt6+2GEAQO14YEAsmIUds8Xjx4tZw3uV9DC7tCpcnt6+h0Q1qnX5/p6yCWO20cMg/cpZjix9yThso1N9m7vZG3MF4RBzw/xagBFl3RCNfAOyp5glpbiXNmGPWFsdNxSkrh44JmLMydJamos0Ko6jd+JHUFaRUbXRGnbeuu4PC+HStccB5H8OauUJVPvKJxJSbHMP6N3ibXXwuLfXEktqoED8bQbMpKlE5/5oB8Tk5kz6X7lWlLf9YpwYpvS8dM4AV/ksRJAKB/7wkJbEBKx+r8VMu1L2GnMv153a7TEzlSmST9VpPWhvwdgmmLb5ZAI9d0J1bEmjS+AIQH2XXZdonJpLcxFAO86MhLhsT1eFvLGXkBbwnWp60uIC5x+T3LzD5hHJMPhzkxuUBAzNubzeqTjMRB/x2AD7e6M5+OMNFoKqBz2NlVDJx6VwRYb+wAqnwjKG6yYRbyDwnckk5t6eKa8UHV06NDzOZvYlSA0QyLYIIWU8DWNyAuASMhoNBI/GwthGrQYaIXCVphg9BtcAEJGSXyiQX7402l7U4OoJyT9fe+UibRMR+47VdRE0x08RZ7ITEw9gDevfOPUR+M06ZaIj1VY4wUqjvaFO66RbK+lp9fXJ+RCI0H1lStxc5eGSLsMGoI+eUZ/DC7V+p+tiNIR94wGNv2ZhphQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 4542, 'candidates_token_count': 13, 'total_token_count': 4748, 'cached_content_token_count': 5064, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5975}], 'cache_tokens_details': [{'modality': 1, 'token_count': 5064}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 193}, 'finish_reason': 'STOP', 'avg_logprobs': -1.5816690004788911, 'model_name': 'gemini-2.5-pro'} id='run--a3f49474-4df2-4ad1-a67d-d1fa3b3fe021-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --help'}, 'id': '979fb9b8-c620-4479-b73d-74e09e75b020', 'type': 'tool_call'}] usage_metadata={'input_tokens': 4542, 'output_tokens': 13, 'total_tokens': 4748, 'input_token_details': {'cache_read': 5064}, 'output_token_details': {'reasoning': 193}}
2025-10-06 03:45:43,272 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --help
2025-10-06 03:45:43,518 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:45:43,518 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kp

usage: runtests.py [-h] [-v {0,1,2,3}] [--noinput] [--failfast] [--keepdb]
                   [--settings SETTINGS] [--bisect BISECT] [--pair PAIR]
                   [--reverse] [--selenium BROWSERS] [--headless]
                   [--selenium-hub SELENIUM_HUB]
                   [--external-host EXTERNAL_HOST] [--debug-sql]
                   [--parallel [N]] [--tag TAGS] [--exclude-tag EXCLUDE_TAGS]
                   [--start-after START_AFTER] [--start-at START_AT] [--pdb]
                   [-b]
                   [module [module ...]]

Run the Django test suite.

positional arguments:
  module                Optional path(s) to test modules; e.g. "i18n" or
                        "i18n.tests.TranslationTests.test_lazy_objects".

optional arguments:
  -h, --help            show this help message and exit
  -v {0,1,2,3}, --verbosity {0,1,2,3}
                        Verbosity level; 0=minimal output, 1=normal output,
                        2=all output
  --noinput             Tells Django to NOT prompt the user for input of any
                        kind.
  --failfast            Tells Django to stop running the test suite after
                        first failed test.
  --keepdb              Tells Django to preserve the test database between
                        runs.
  --settings SETTINGS   Python path to settings module, e.g.
                        "myproject.settings". If this isn't provided, either
                        the DJANGO_SETTINGS_MODULE environment variable or
                        "test_sqlite" will be used.
  --bisect BISECT       Bisect the test suite to discover a test that causes a
                        test failure when combined with the named test.
  --pair PAIR           Run the test suite in pairs with the named test to
                        find problem pairs.
  --reverse             Sort test suites and test cases in opposite order to
                        debug test side effects not apparent with normal
                        execution lineup.
  --selenium BROWSERS   A comma-separated list of browsers to run the Selenium
                        tests against.
  --headless            Run selenium tests in headless mode, if the browser
                        supports the option.
  --selenium-hub SELENIUM_HUB
                        A URL for a selenium hub instance to use in
                        combination with --selenium.
  --external-host EXTERNAL_HOST
                        The external host that can be reached by the selenium
                        hub instance when running Selenium tests via Selenium
                        Hub.
  --debug-sql           Turn on the SQL query logger within tests.
  --parallel [N]        Run tests using up to N parallel processes.
  --tag TAGS            Run only tests with the specified tags. Can be used
                        multiple times.
  --exclude-tag EXCLUDE_TAGS
                        Do not run tests with the specified tag. Can be used
                        multiple times.
  --start-after START_AFTER
                        Run tests starting after the specified top-level
                        module.
  --start-at START_AT   Run tests starting at the specified top-level module.
  --pdb                 Runs the PDB debugger on error or failure.
  -b, --buffer          Discard output of passing tests.

2025-10-06 03:45:48,493 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "django-admin test tests.admin_widgets.test_formfield_for_manytomany_widget --settings=tests.test_sqlite"}'}, '__gemini_function_call_thought_signatures__': {'0adca732-e634-4415-abe0-31f027bca4de': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 5549, 'candidates_token_count': 34, 'total_token_count': 6024, 'cached_content_token_count': 5026, 'prompt_tokens_details': [{'modality': 1, 'token_count': 7173}], 'cache_tokens_details': [{'modality': 1, 'token_count': 5026}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 34}], 'thoughts_token_count': 441}, 'finish_reason': 'STOP', 'avg_logprobs': -1.7095447989071118, 'model_name': 'gemini-2.5-pro'} id='run--8dad3098-f5b6-43b8-a35d-3b603fb2c151-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'django-admin test tests.admin_widgets.test_formfield_for_manytomany_widget --settings=tests.test_sqlite'}, 'id': '0adca732-e634-4415-abe0-31f027bca4de', 'type': 'tool_call'}] usage_metadata={'input_tokens': 5549, 'output_tokens': 34, 'total_tokens': 6024, 'input_token_details': {'cache_read': 5026}, 'output_token_details': {'reasoning': 441}}
2025-10-06 03:45:48,494 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: django-admin test tests.admin_widgets.test_formfield_for_manytomany_widget --settings=tests.test_sqlite
2025-10-06 03:45:48,799 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:48,799 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/bin/django-admin", line 33, in <module>
    sys.exit(load_entry_point('Django', 'console_scripts', 'django-admin')())
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 330, in run_from_argv
    self.execute(*args, **cmd_options)
  File "/testbed/django/core/management/base.py", line 371, in execute
    output = self.handle(*args, **options)
  File "/testbed/django/core/management/commands/test.py", line 53, in handle
    failures = test_runner.run_tests(test_labels)
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class tests.admin_widgets.test_formfield_for_manytomany_widget.Member doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 03:45:54,761 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python -m unittest tests/admin_widgets/test_formfield_for_manytomany_widget.py"}'}, '__gemini_function_call_thought_signatures__': {'8f87422f-4929-445f-96a9-dea3d2940d0d': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6168, 'candidates_token_count': 28, 'total_token_count': 6748, 'cached_content_token_count': 6820, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8231}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6820}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 28}], 'thoughts_token_count': 552}, 'finish_reason': 'STOP', 'avg_logprobs': -1.9310684204101562, 'model_name': 'gemini-2.5-pro'} id='run--d8f43dc3-dc75-4da9-9b14-295eeb2c94b3-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python -m unittest tests/admin_widgets/test_formfield_for_manytomany_widget.py'}, 'id': '8f87422f-4929-445f-96a9-dea3d2940d0d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6168, 'output_tokens': 28, 'total_tokens': 6748, 'input_token_details': {'cache_read': 6820}, 'output_token_details': {'reasoning': 552}}
2025-10-06 03:45:54,762 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m unittest tests/admin_widgets/test_formfield_for_manytomany_widget.py
2025-10-06 03:45:55,009 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:55,010 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/__main__.py", line 18, in <module>
    main(module=None)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/main.py", line 94, in __init__
    self.parseArgs(argv)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/main.py", line 141, in parseArgs
    self.createTests()
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/main.py", line 148, in createTests
    self.module)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 219, in loadTestsFromNames
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 219, in <listcomp>
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 108, in __new__
    app_config = apps.get_containing_app_config(module)
  File "/testbed/django/apps/registry.py", line 252, in get_containing_app_config
    self.check_apps_ready()
  File "/testbed/django/apps/registry.py", line 134, in check_apps_ready
    settings.INSTALLED_APPS
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 62, in _setup
    % (desc, ENVIRONMENT_VARIABLE))
django.core.exceptions.ImproperlyConfigured: Requested setting INSTALLED_APPS, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

2025-10-06 03:45:57,055 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "DJANGO_SETTINGS_MODULE=tests.test_sqlite python -m unittest tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'cd7ac2a6-c85c-4e51-9245-7f279d95c23c': 'CvIDAR/MhbbXwptPhT2+dlnQsFcSVUg8b4OJzrXXj0ISZNZgDJA2XZATnaNl4XgAyg+HX3P+TpsR2WYMpFjeswXhD/fYEFiWiqlPhM65nqEH1uV9Onr55790VwGJkvGEwSXjT3kpdD0gxg3mk9zFRBag4ioERXVuRo+ITV4p4v3wRlKv8713jIVwaESR+4XsnvVNBYX2O4ohQKzzAJ2ZHVk2ipOqP3Z5/gSWv8FuR7DHVj4c9kgoOzhy/Gg1/LyIRyY6JlEmjKWQPCsLaGf1iIN6eOe3r6nf+pYykcncgbEjhVlrfWq8K14wblVbIXnofAlMT1T7pzZaRKbN7iNHjJWkfNqE9S4px7PX+xSAOEsmmfy70h+9Fwgz0UyfQgBnLkLicNVBxUlJUXZAEmh2lX3WYNH3BMPN+hDrXxKvJ8W8ZT7a061N8LWSxyIZsyOid7YHVKFhfHsFfgwzEIGWBxI3PhndYBZD5/PCZnvDqKne3vDc+TdvqneJvoUkeI4f85CC1tQuONoY7+3WveLjzr2OE/uNyOezQDGlYNML97m2+jqSs6SeFhA5D/xGgO+XGNxwVGca1Aa13Yfw+6wL3WPxodcckw/0dQRYZUWQpuyFBsuHKyjbC59jTj3E0qPHjitFFmOwBByCHzFwnW+gOuLX3sF1'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 6941, 'candidates_token_count': 37, 'total_token_count': 7103, 'cached_content_token_count': 6947, 'prompt_tokens_details': [{'modality': 1, 'token_count': 9554}], 'cache_tokens_details': [{'modality': 1, 'token_count': 6947}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 37}], 'thoughts_token_count': 125}, 'finish_reason': 'STOP', 'avg_logprobs': -0.19806842546205264, 'model_name': 'gemini-2.5-pro'} id='run--db5845d5-ad75-4985-9f0f-839263ba72b3-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'DJANGO_SETTINGS_MODULE=tests.test_sqlite python -m unittest tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': 'cd7ac2a6-c85c-4e51-9245-7f279d95c23c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 6941, 'output_tokens': 37, 'total_tokens': 7103, 'input_token_details': {'cache_read': 6947}, 'output_token_details': {'reasoning': 125}}
2025-10-06 03:45:57,056 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: DJANGO_SETTINGS_MODULE=tests.test_sqlite python -m unittest tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:45:57,301 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:45:57,301 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/__main__.py", line 18, in <module>
    main(module=None)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/main.py", line 94, in __init__
    self.parseArgs(argv)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/main.py", line 141, in parseArgs
    self.createTests()
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/main.py", line 148, in createTests
    self.module)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 219, in loadTestsFromNames
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 219, in <listcomp>
    suites = [self.loadTestsFromName(name, module) for name in names]
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 108, in __new__
    app_config = apps.get_containing_app_config(module)
  File "/testbed/django/apps/registry.py", line 252, in get_containing_app_config
    self.check_apps_ready()
  File "/testbed/django/apps/registry.py", line 135, in check_apps_ready
    raise AppRegistryNotReady("Apps aren't loaded yet.")
django.core.exceptions.AppRegistryNotReady: Apps aren't loaded yet.

2025-10-06 03:46:10,778 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests/empty"}'}, '__gemini_function_call_thought_signatures__': {'f33eb4ca-1bf8-4fad-abca-d208169f5683': 'CoAHAR/MhbZAJZW4UB9arBJQKGiqXbxVmfHYJWgn6YmqFb2E40iccOWAdNaOfpWpR/w0uYzccDRNV0g5y6HLFOoHvMkUOJDpxO84tuoPDtxUYo+wqcdcZmR5cFOkRhXP0oR1i3E3v6DB9pUz1txuhpFTABLtRgwVuQzwH9H1nf7YgfPfTpGysQcjapsU9A9X/6EoYyfnrVPhqcuPUFA58lVOauUoWU8pvRCGuZZ23yh2B6XMN1e0eev4G6mqsCkjATzWmFZmA6p6Slycx3bmRrpgoswguL+ThBJP9eDNHQz5lp4hwNfe13R4lbKx9h1WxZjethKjXhhU23D9WCJyrDR3or6KTjumcqp6+6OwMYJdZwhFhYT2FvjHG22A1igcDOfmn5k9PEUmHj7rd4JBLTQudkSGBf8fvQ/jYYC97HIRWVeBAH95eLQnm43ZAOUcavCz0Ww0AC3vAzlHYDum4mHIwoR9kzs4hqMsDRx9c7P4DeavQB8AuhpdD9fP7R3HxsCipI4cNbuPZjR9PKLIid1UkmdQ0b9Spsd/XFId/WJtWn1rUVGoIJXoyPMNZSvKNAO48oWbznDG+rj/d1opnt9gd7qv4NQHBb2VBhkIs3kl10W6kZM3bWWS3YU4PnnsUc4kjJMY5wVWoDmADkSk1O2KMVN1ic2PaN+Ru1hCywsDMH/J9MovwBjFr0qwd8RkE7su1XR2Yr4z1pr1PtTgtSkFdJwQCeskLoMy3PS3XWjN03qP52ItOCV/L8GdvBefA5j0hesjIdgrm721quu7EjVnee+9mqxgNxOzF4ayRYzByqzsBSeT01SMLdxuT6Ix+BlV+UGMRSsWBw/jN/VGh/Xn+PkChuIGEPU6cGPWRrb1de27YwQu0h4sSfElcN/dLPlXxBCSDuJSe4x0XqMqna6mkUJHVN0L4JHE2Hnv2wTJXdsroLu5+W3karG9onK56QHblOJ24xuCd6vGYqT+l+925yK5oq6hrNrWjl/sypKluhPcHkoiuZyU+wQns5eF6rdjpEoIwq5/h7AnqWx5aOIddTm69LafcRaOuDnHN8KGhCNx/PFFQyKnGUtEQ/hyQNcxYHFS7FuhWMOasJl1Wmn7VduAHOa3VXlC3GS1vzgncBFhnoL8e6/AQOwprDlSozRJs8HACu/9D0v4JBu5aLRJpaX3Ui3abTJUZtThzWLvZ6E='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7637, 'candidates_token_count': 8, 'total_token_count': 9028, 'cached_content_token_count': 8752, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10373}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8752}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 8}], 'thoughts_token_count': 1383}, 'finish_reason': 'STOP', 'avg_logprobs': -24.488605499267578, 'model_name': 'gemini-2.5-pro'} id='run--b9726e6e-bf52-4b84-8467-1793746e7268-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests/empty'}, 'id': 'f33eb4ca-1bf8-4fad-abca-d208169f5683', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7637, 'output_tokens': 8, 'total_tokens': 9028, 'input_token_details': {'cache_read': 8752}, 'output_token_details': {'reasoning': 1383}}
2025-10-06 03:46:10,779 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests/empty
2025-10-06 03:46:10,880 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:10,880 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

__init__.py  models.py	no_models  tests.py

2025-10-06 03:46:12,070 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/empty/models.py"}'}, '__gemini_function_call_thought_signatures__': {'189f5d59-952a-4b98-aace-091e23d5e5b7': 'CmoBH8yFtoYYQImg53STJMa/BM/DMx6iOG2qQjUo2QKvXjJDEpKX/ZooZfapYj8Tox3+4X0XgfrKSw1V2KUcnopeMLYvEeL7I7Ns4nD4C3vcZrgkRdrEg/qIQqDCpH+XjcLsuLLQcY7cW/xs'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7667, 'candidates_token_count': 12, 'total_token_count': 7706, 'cached_content_token_count': 8756, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10630}], 'cache_tokens_details': [{'modality': 1, 'token_count': 8756}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 12}], 'thoughts_token_count': 27}, 'finish_reason': 'STOP', 'avg_logprobs': -0.11138148109118144, 'model_name': 'gemini-2.5-pro'} id='run--875cb4a2-8bd0-4351-ab3e-3eb2c1c6790c-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/empty/models.py'}, 'id': '189f5d59-952a-4b98-aace-091e23d5e5b7', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7667, 'output_tokens': 12, 'total_tokens': 7706, 'input_token_details': {'cache_read': 8756}, 'output_token_details': {'reasoning': 27}}
2025-10-06 03:46:12,071 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/empty/models.py
2025-10-06 03:46:12,172 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:12,172 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

"""
Empty model tests

These test that things behave sensibly for the rare corner-case of a model with
no fields.
"""

from django.db import models


class Empty(models.Model):
    pass

2025-10-06 03:46:13,582 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests/no_models"}'}, '__gemini_function_call_thought_signatures__': {'40ad9086-04cd-4a34-b349-1216423f8725': 'CuYBAR/MhbaGF+rATATCms7wBsJZpke1xwrOM8/c3DyMRxuAZAeYKIqOR/pFYZLNt/m4tKe9gymhWQ2bD3lAkVWukuM+nIDf79Ovc99zs+PiDSU8+y2W4p3JcO6o6ZIFdvMlfUL7PFWAy0652I5Ie76hxsHQvcXYhdlCZBcUjXAaHs3DjAII5u+ksA8pPPTHM7dA8xtC+QNKE+v6HkFlYQFeC+9I6LFG/zO+1uxSZqYzxnIBsRETDIlgouLeDRyEmmu6GSfxM+TWh72kAaVtoW7J6PiONQtJe42BIUJFX9uEQBgSetGQRZ4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7731, 'candidates_token_count': 10, 'total_token_count': 7797, 'cached_content_token_count': 10476, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10719}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10476}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 10}], 'thoughts_token_count': 56}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0084650993347168, 'model_name': 'gemini-2.5-pro'} id='run--0bb55d78-3dd5-4c53-aba4-dc8ecfe6a2c7-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests/no_models'}, 'id': '40ad9086-04cd-4a34-b349-1216423f8725', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7731, 'output_tokens': 10, 'total_tokens': 7797, 'input_token_details': {'cache_read': 10476}, 'output_token_details': {'reasoning': 56}}
2025-10-06 03:46:13,584 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests/no_models
2025-10-06 03:46:13,685 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:13,685 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

__init__.py  tests.py

2025-10-06 03:46:18,898 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py no_models.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'360965ec-059d-4820-9eea-ee851ba41d12': 'Co0DAR/MhbbordcIrkPKNnehrWombDqFqrPunYNu06N1bR+ORf6p7fGsUZNKwvNRyhMTb2Q9dVexfv6pQSgTqR46k/fBtpXjF5Hqf8qBymWSpwsxo62FTsK/1Jftp3uxdh+ztTG3wSl51SZsniofbcyP76TIvCKSl+iGXgGRKWcUnqtMBe1RNQOihReZZwCdsqFjD9P5v6fPh5nD95f9zA8tPy2D37e2MCeHQDJIwygcBnKhF15sbOG4m2hsJB+KFALkKgh1mbIG48RuKQI43oLXuK4pqC2LqoTlTUyH2n4iFtGZ4dcElGgDVjt5vASZycq3ikHz/YSkOClLXZoIfFbN3ffDc+NALdm/CaM/rs/haVtvssDt+CZF18uv0/qQoZsFi6xYWeB7wvVlGFCU7Cv/nEZD8ixo1QuFO2SOreaOJnozcqqqE6F+xCICSxekJ61SHI3lrbF7iPLB/jIPy4KRD5BgAeyVWw8sZ2ITGjdjQos1erR0gd4tw3DtAzg4LyicBQee0gmwDVoPBy0jDA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7755, 'candidates_token_count': 27, 'total_token_count': 8100, 'cached_content_token_count': 10457, 'prompt_tokens_details': [{'modality': 1, 'token_count': 10797}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10457}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 318}, 'finish_reason': 'STOP', 'avg_logprobs': -1.2407849629720051, 'model_name': 'gemini-2.5-pro'} id='run--448cf131-e052-44da-ab38-8fa3e0dcf43d-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py no_models.test_formfield_for_manytomany_widget'}, 'id': '360965ec-059d-4820-9eea-ee851ba41d12', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7755, 'output_tokens': 27, 'total_tokens': 8100, 'input_token_details': {'cache_read': 10457}, 'output_token_details': {'reasoning': 318}}
2025-10-06 03:46:18,900 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py no_models.test_formfield_for_manytomany_widget
2025-10-06 03:46:19,199 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:46:19,200 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_formfield_for_manytomany_widget (unittest.loader._FailedTest)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_formfield_for_manytomany_widget
Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
ModuleNotFoundError: No module named 'no_models.test_formfield_for_manytomany_widget'


----------------------------------------------------------------------
Ran 1 test in 0.000s

FAILED (errors=1)

2025-10-06 03:46:26,186 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "find tests -name \'*settings*.py\'"}'}, '__gemini_function_call_thought_signatures__': {'1598e55d-1f56-46ce-a2c2-9fd29d73ada6': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7984, 'candidates_token_count': 13, 'total_token_count': 8677, 'cached_content_token_count': 10462, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11131}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10462}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 680}, 'finish_reason': 'STOP', 'avg_logprobs': -6.14651371882512, 'model_name': 'gemini-2.5-pro'} id='run--370e18ca-1b29-4c7c-b289-c1f19e3f1873-0' tool_calls=[{'name': 'run_command', 'args': {'command': "find tests -name '*settings*.py'"}, 'id': '1598e55d-1f56-46ce-a2c2-9fd29d73ada6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7984, 'output_tokens': 13, 'total_tokens': 8677, 'input_token_details': {'cache_read': 10462}, 'output_token_details': {'reasoning': 680}}
2025-10-06 03:46:26,188 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: find tests -name '*settings*.py'
2025-10-06 03:46:26,289 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:26,289 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

tests/staticfiles_tests/settings.py
tests/postgres_tests/integration_settings.py
tests/requests/test_data_upload_settings.py
tests/admin_scripts/configured_settings_manage.py
tests/admin_scripts/custom_templates/project_template/project_name/settings.py
tests/admin_scripts/configured_dynamic_settings_manage.py
tests/flatpages_tests/settings.py
tests/i18n/sampleproject/sampleproject/settings.py
tests/project_template/test_settings.py
tests/auth_tests/settings.py

2025-10-06 03:46:29,191 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py tests/admin_widgets/test_formfield_for_manytomany_widget.py"}'}, '__gemini_function_call_thought_signatures__': {'2ab058d2-e2c1-4083-b002-b8986eff4686': 'Co8GAR/Mhbas+GQGMDeU9MBCLUgUD8YGaw53XFcPaXFj7/BJ5NNtEPLSLXVGSPSVzTjbu2WQ8YbKdtQtxB9GOjS6H0X+P88zs6XjG5hIKHeH9ov4ZYy3AUoNhluvoENzhYQyvjEajwIWp8xqEpiOXLYPhbdtbHIXuGPseBJfem9nCapWL80NFqKo2//fj6OQ2AxZeMnfbPJJTw4TePiDaMHLm71k7JaF6bxty8umFo/L2pUae3ZFua3d20bcsX8b2OtHcZjEdFNO8M1BNSLVag5rVefwZlSGZeXtTxIl9LYitXqwf+kOwTW/orZoI+4e12j6FT4deqnYT3FW1oj4zJYM8ct4f429PR0UgRbfcJmezDj5eYDI3qkai7qYRtuDMlNy93snyQJafTOTKmEZipWcQDMqOu0axMa6BGSetnjUPJZwVZMPhyfGCPrOs9Swf3wDE+2pKVTMnq6R5xKMPw2LvyPZtvbNXntUe3SMRkEszPZd/B/1uoM9bM1NWNgAevEl9jPjTEYujoXB/BoXsMwA/u82X7OwtndmyqpGPQKM26KsWXvol2S37kzNDQVjBSKf7Ar/PwkZp0fcF1eYLHodCsd+7RePAAlmETPlcPctmfaJ/32o3IFAYRnL6p7f5O+m2Q0BNXV+q+Y2v0bXAy/MdLTXnKPtxMmzMG/mb8pi5dsuuPJJ13HEGNiVLpSzt0dx6S6FFFWL0/3LuNBoC8tpPC7RZVG2chHVs4PZnx4rC9fEDHJ44n1cS4P2HjtK/93ql4PsmnvQ+GU1eOqV/Rqy1/XKdp64ic95B9pDaHDAK0x/pUe20atoJsaLIzlRIzXBVTRIZIfHf7e8gHRqMHd76rv1u7YY3/RdfpNPUdLgFF099KMyGdWf6/EXNZqrLB//NV8hgjOYmccw6NcYZ383SaExYXfmxraSe+ygFEI9nsS+XXfTOLhRD/ZbVvqkGppC7qlc5SdUnLIB/SsitMl3g0HYmcWcpsg1VxafBzxVsxRT0tc9XblwYYjAxTI26Os6UfSBG+lsENvUnQ8AzsjT'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8141, 'candidates_token_count': 31, 'total_token_count': 8387, 'cached_content_token_count': 10537, 'prompt_tokens_details': [{'modality': 1, 'token_count': 11965}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10537}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 31}], 'thoughts_token_count': 215}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8998167591710244, 'model_name': 'gemini-2.5-pro'} id='run--735490b6-d8e1-469c-8081-39ca4994680a-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py tests/admin_widgets/test_formfield_for_manytomany_widget.py'}, 'id': '2ab058d2-e2c1-4083-b002-b8986eff4686', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8141, 'output_tokens': 31, 'total_tokens': 8387, 'input_token_details': {'cache_read': 10537}, 'output_token_details': {'reasoning': 215}}
2025-10-06 03:46:29,193 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py tests/admin_widgets/test_formfield_for_manytomany_widget.py
2025-10-06 03:46:29,481 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:46:29,482 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 585, in build_suite
    suite.addTests(tests)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/suite.py", line 57, in addTests
    for test in tests:
TypeError: 'NoneType' object is not iterable

2025-10-06 03:46:40,904 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "head -n 50 tests/runtests.py"}'}, '__gemini_function_call_thought_signatures__': {'400d94fa-9201-409d-af92-d884c392c0e0': 'CuEHAR/MhbZ78l05VMLEWym2599o9bDRxu2/ALCkKGoH5DHLqWoIJVeSZjeFOTAbcWxtKlzY0/Sz5CSYUJvD0d22fRuATZwVZ4Ex6WAUNr/VSJfLEW639fk6ujG0sQVxgvD9O2y2X3WtoBxRVq6sHMT86ddItrQV5M4OT6HDGEoo+BqklqA4NR38Ea9qqeTcjsFVXtV8sTbhOJAPpWrVihqB+n4CR6Jcw4sAo9y65j12JNqw+hWL+9N5Wfd5pgbInqrd8hBeCU0bx8Nkdn0jmepMj4eIEGxEjRJv7ooMtTxpMI7STWXQlJtXZ49b0lE8+5R8R5R6zrwz7z5RcKt17nldRWW7i3WDg/Io9fj7UfyYXY/76rpLiB5mxPfOg4t5PWOxhpK4PS/Hw14Sab6Fd5/FUk4roTjfcY65g7SxyyaPZrq7zs4iEo9hye5TPoHLXhcAGG5JOdGU3wk/N4gfZQrihK+RJomkJjN0fk6l30dvccpFSt6AWr/asWasMivN06q6Lwog3SinHOBYSpHVyn/UzWWYcXw3Jv3D39cZ535y/gvWfxYA0cngFhKdn5PiferXpTpCofs3titpLjhOkwiUfckthOiacRxdH3BjSRRe70W+sLqfPBDAjRa0lfg3BBT8DoCsY6eTGM0Y4ku+3LgFJDhlAYKyCKoT59SeHdd7R8aBHC7TnbWzaNIRMaei32z2jTvgOGrGlFJel8M660dFNB+Zc/m96ZR4DXO+JmbXSDh36owR8L+++gJmfi6HVQgSI6aqxIa38RbqUZhmW3+ygEyFBdhwhTErM2hnqQEdyMI1It+G1Q3gTCVZsmh8l2WSnbtLkRMgLyPoOvumm/5evyEy0TOr7rdP3OF7uBQArf9SSKebxSfJVfx70hJXtgotANJifN0C1UxElqnQZYFPcr+XTZ/YLFDQRivDh9/wcc+z+i/Om5TPD9Fm/6tjw03zmmLfHHEH86gR/2dc1k+bkn/cl8mGUJy46MODJsOEOMldyaCLi5NDI1f+IrRgtlWqQ3gl52jMdSYQiGxvpKUz8d3U2BFK04qElYGj9XO/1XThBSeqcOTGeTisqCxW8Rg/WUfFRanYqlaN690XUEkGUIfK9gw7ZCVEbMUR7j5NrDkiAyR4QcUJWYsWWd2G4/kn53sLRI33v0cybaS9tM0IY3JeEpnql6ACoS7GEl3D8V2xiYQQP+GKm1JQnju7te/cJAz11Ctij9Yuo5t0hbTU2Z33vD5ECj/8JIEU7CK5h9CW256TNehBQUlNSUSSVm/MBJU5xPZEMydjLWnnqQ5mZ7JqvoOCFk9Gp1tYTMr+WrbT'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8409, 'candidates_token_count': 16, 'total_token_count': 8925, 'cached_content_token_count': 10561, 'prompt_tokens_details': [{'modality': 1, 'token_count': 12446}], 'cache_tokens_details': [{'modality': 1, 'token_count': 10561}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 16}], 'thoughts_token_count': 500}, 'finish_reason': 'STOP', 'avg_logprobs': -8.014735221862793, 'model_name': 'gemini-2.5-pro'} id='run--ed39fe09-9256-41ee-94a4-99304e0d5a17-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'head -n 50 tests/runtests.py'}, 'id': '400d94fa-9201-409d-af92-d884c392c0e0', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8409, 'output_tokens': 16, 'total_tokens': 8925, 'input_token_details': {'cache_read': 10561}, 'output_token_details': {'reasoning': 500}}
2025-10-06 03:46:40,905 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: head -n 50 tests/runtests.py
2025-10-06 03:46:41,006 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:41,006 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

#!/usr/bin/env python
import argparse
import atexit
import copy
import os
import shutil
import socket
import subprocess
import sys
import tempfile
import warnings

try:
    import django
except ImportError as e:
    raise RuntimeError(
        'Django module not found, reference tests/README.rst for instructions.'
    ) from e
else:
    from django.apps import apps
    from django.conf import settings
    from django.db import connection, connections
    from django.test import TestCase, TransactionTestCase
    from django.test.runner import default_test_processes
    from django.test.selenium import SeleniumTestCaseBase
    from django.test.utils import get_runner
    from django.utils.deprecation import RemovedInDjango40Warning
    from django.utils.log import DEFAULT_LOGGING
    from django.utils.version import PY37

try:
    import MySQLdb
except ImportError:
    pass
else:
    # Ignore informational warnings from QuerySet.explain().
    warnings.filterwarnings('ignore', r'\(1003, *', category=MySQLdb.Warning)

# Make deprecation warnings errors to ensure no usage of deprecated features.
warnings.simplefilter("error", RemovedInDjango40Warning)
# Make resource and runtime warning errors to ensure no usage of error prone
# patterns.
warnings.simplefilter("error", ResourceWarning)
warnings.simplefilter("error", RuntimeWarning)
# Ignore known warnings in test dependencies.
warnings.filterwarnings("ignore", "'U' mode is deprecated", DeprecationWarning, module='docutils.io')

RUNTESTS_DIR = os.path.abspath(os.path.dirname(__file__))

TEMPLATE_DIR = os.path.join(RUNTESTS_DIR, 'templates')

2025-10-06 03:46:44,363 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "grep -r \'formfield_for_manytomany\' tests"}'}, '__gemini_function_call_thought_signatures__': {'bc15cd90-bb67-46d0-87a9-4d60c3f55171': 'CosIAR/MhbahuEzSVrvvOzwKwX1rSHUZXm3RoOYmey7wHLN3bWcrFI4cAEnBslM2kMcGGpX3Ra6SluBBe9QT85XJiPDFE8L5xYMv3LL5Zp2nf766wYcorN5PHzpQjKNqLrgbEBdW5X5EMyrtyLzak0V754tQJKPYfJIQlQoVNDz/tMAE0NDTh/kVJPJgtbPcTgfvQ56uvG/O/obWs1CT4skecneTY2fbYMjvkF4mq8DdE45v+HbjbBHBPsWq+20A/aRdSVhFQOCZBNkkfSv0KwkhqBz/XscaohjHmdO/m8OGJ3rdLBkjmHx1EP28RwKw73tplR1rGVUPHq1ICWY12ruGtBwGmzLjeO+jZti84x7RfjdianQemFgSdYoY1L2X+Ks8yTxQvw3BpsK5lzC6aALlF+MNmbK7ZpN8vbdzoTsRbXugwbkd6/Xh2v06Hdm1VB+V/x8TU4l7tC8xYBGQzrH/UwvGXyIYniRrwu1+rj/7IJ4kKw1KKsFUffCUlYW52LSOKkblVKrqacSpYwm/vf3SWqTPRAeTMKuUc/dqL0O9yeaw9RXCVvQA+k1tRBen6ISGmJs6m099AKYog5PxKPMr+gP7mUYD/KRV+TkANWbTvsaHvNQ4x5HF8PXbHOpPFse3++8sKrOueuicGuqVXVg2gzHkrTjn0mC0M4XvSaXiZDxRUCKlQk4ja6qdyxSgeMXucLEp+Lq7Bq7Pupy2fGFMoAxIQtBUHy+A8AQ7XBbPc1DqueNRIUdEyD0TKtofYXfEW5/5hIrjwFvP04qEWJXFfE9kzTimfLEzshuhY4u0Vr7Tu0wjFNQMT2gmschF6p3/ACZmAV4vtGRj6PJbGaVkhfll++21KX4fqG58R1UOeY5WvagJChjn7eTOCXd5Lla+pne7+1kvLdzrb9HRKUNsSPdhc1iQ+r38NL2HbsxU4hLWRCFpVFOQswQx72W3jd+bYsMaBb+zuxA08ohg6GJAzpSwUdEX57OfzoVSU1yRMoJTSfnmyJ4scgPZWBr0OnNSlyO9HSqvkg72CVC0wiulU7IShY+1GPpzomD8FvsQWcY1VRBoUXn7ShTi+frKPfXc232wVJ1RdCW/ap3bg7Xmb1IavfbI7HwXlzgIDJGqSxnUZAx3uPnCLiA/ZNHKgbK42LN5tizDEN9KuYrgPThzjV7P47SCnO60VXraIs0bgkKZ7iDSGzpQaDc59S/50dIb5VnIoa8CUbXTZ8h6gl7IzqGoiLT20krfUdt3XniGmhC4ShoH/8H80IluWu+CMshJn+ONVa9I6jOCsvmX6o3SfkCj89xnTpIJ/Aey0dhPvGoBhO569ods0N8x6p+Ff4GgwttRn/BSVkqHstxN4wkewOgNJm041WAhjVWw'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 8833, 'candidates_token_count': 18, 'total_token_count': 9138, 'cached_content_token_count': 12339, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13110}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12339}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 18}], 'thoughts_token_count': 287}, 'finish_reason': 'STOP', 'avg_logprobs': -1.9108630286322699, 'model_name': 'gemini-2.5-pro'} id='run--39ab809b-d7ad-44ec-8d9f-3e529a393d59-0' tool_calls=[{'name': 'run_command', 'args': {'command': "grep -r 'formfield_for_manytomany' tests"}, 'id': 'bc15cd90-bb67-46d0-87a9-4d60c3f55171', 'type': 'tool_call'}] usage_metadata={'input_tokens': 8833, 'output_tokens': 18, 'total_tokens': 9138, 'input_token_details': {'cache_read': 12339}, 'output_token_details': {'reasoning': 287}}
2025-10-06 03:46:44,365 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: grep -r 'formfield_for_manytomany' tests
2025-10-06 03:46:44,466 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:44,466 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

tests/admin_ordering/tests.py:        m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)
tests/admin_ordering/tests.py:            def formfield_for_manytomany(self, db_field, request, **kwargs):
grep: tests/admin_widgets/__pycache__/test_formfield_for_manytomany_widget.cpython-36.pyc: binary file matches
tests/admin_widgets/test_formfield_for_manytomany_widget.py:    Tests that formfield_for_manytomany respects the widget argument.
tests/admin_widgets/test_formfield_for_manytomany_widget.py:    def test_formfield_for_manytomany_widget_override(self):
tests/admin_widgets/test_formfield_for_manytomany_widget.py:        formfield_for_manytomany() should respect a passed widget, not ignore it.
tests/admin_widgets/test_formfield_for_manytomany_widget.py:        # Call formfield_for_manytomany, passing a widget override.
tests/admin_widgets/test_formfield_for_manytomany_widget.py:        field = model_admin.formfield_for_manytomany(

2025-10-06 03:46:45,651 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/admin_ordering/tests.py"}'}, '__gemini_function_call_thought_signatures__': {'75690fc0-e5ce-4f80-bea6-a6697ebb79cf': 'CqABAR/MhbbKk2GEX4k8NFE7GWa9aYKnTlKRTvPoo1R8jns6LXqojbsec0rbIJYU8WxzluvMOzjnmBIna6NMXXvNDORpVds22sQ3ocgch0xF+10ISBDUfKh0hygQYHlQXcbRJ+Rz3TGVQQ3srxtKgL+wvTPTow6MvdBFgG4CaXfcJ4lB72bXfjNwR5s+r8nXDx/G/v+pM444TbHghIk8HspWIQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 9170, 'candidates_token_count': 14, 'total_token_count': 9223, 'cached_content_token_count': 12389, 'prompt_tokens_details': [{'modality': 1, 'token_count': 13732}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12389}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 14}], 'thoughts_token_count': 39}, 'finish_reason': 'STOP', 'avg_logprobs': -0.0899658203125, 'model_name': 'gemini-2.5-pro'} id='run--6d451830-a208-4b0d-9aaa-9c255d01ba8a-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/admin_ordering/tests.py'}, 'id': '75690fc0-e5ce-4f80-bea6-a6697ebb79cf', 'type': 'tool_call'}] usage_metadata={'input_tokens': 9170, 'output_tokens': 14, 'total_tokens': 9223, 'input_token_details': {'cache_read': 12389}, 'output_token_details': {'reasoning': 39}}
2025-10-06 03:46:45,653 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/admin_ordering/tests.py
2025-10-06 03:46:45,754 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:46:45,754 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

from django.contrib import admin
from django.contrib.admin.options import ModelAdmin
from django.contrib.auth.models import User
from django.db.models import F
from django.test import RequestFactory, TestCase

from .models import (
    Band, DynOrderingBandAdmin, Song, SongInlineDefaultOrdering,
    SongInlineNewOrdering,
)


class MockRequest:
    pass


class MockSuperUser:
    def has_perm(self, perm):
        return True

    def has_module_perms(self, module):
        return True


request = MockRequest()
request.user = MockSuperUser()

site = admin.AdminSite()


class TestAdminOrdering(TestCase):
    """
    Let's make sure that ModelAdmin.get_queryset uses the ordering we define
    in ModelAdmin rather that ordering defined in the model's inner Meta
    class.
    """
    request_factory = RequestFactory()

    @classmethod
    def setUpTestData(cls):
        Band.objects.bulk_create([
            Band(name='Aerosmith', bio='', rank=3),
            Band(name='Radiohead', bio='', rank=1),
            Band(name='Van Halen', bio='', rank=2),
        ])

    def test_default_ordering(self):
        """
        The default ordering should be by name, as specified in the inner Meta
        class.
        """
        ma = ModelAdmin(Band, site)
        names = [b.name for b in ma.get_queryset(request)]
        self.assertEqual(['Aerosmith', 'Radiohead', 'Van Halen'], names)

    def test_specified_ordering(self):
        """
        Let's use a custom ModelAdmin that changes the ordering, and make sure
        it actually changes.
        """
        class BandAdmin(ModelAdmin):
            ordering = ('rank',)  # default ordering is ('name',)
        ma = BandAdmin(Band, site)
        names = [b.name for b in ma.get_queryset(request)]
        self.assertEqual(['Radiohead', 'Van Halen', 'Aerosmith'], names)

    def test_specified_ordering_by_f_expression(self):
        class BandAdmin(ModelAdmin):
            ordering = (F('rank').desc(nulls_last=True),)
        band_admin = BandAdmin(Band, site)
        names = [b.name for b in band_admin.get_queryset(request)]
        self.assertEqual(['Aerosmith', 'Van Halen', 'Radiohead'], names)

    def test_dynamic_ordering(self):
        """
        Let's use a custom ModelAdmin that changes the ordering dynamically.
        """
        super_user = User.objects.create(username='admin', is_superuser=True)
        other_user = User.objects.create(username='other')
        request = self.request_factory.get('/')
        request.user = super_user
        ma = DynOrderingBandAdmin(Band, site)
        names = [b.name for b in ma.get_queryset(request)]
        self.assertEqual(['Radiohead', 'Van Halen', 'Aerosmith'], names)
        request.user = other_user
        names = [b.name for b in ma.get_queryset(request)]
        self.assertEqual(['Aerosmith', 'Radiohead', 'Van Halen'], names)


class TestInlineModelAdminOrdering(TestCase):
    """
    Let's make sure that InlineModelAdmin.get_queryset uses the ordering we
    define in InlineModelAdmin.
    """

    @classmethod
    def setUpTestData(cls):
        cls.band = Band.objects.create(name='Aerosmith', bio='', rank=3)
        Song.objects.bulk_create([
            Song(band=cls.band, name='Pink', duration=235),
            Song(band=cls.band, name='Dude (Looks Like a Lady)', duration=264),
            Song(band=cls.band, name='Jaded', duration=214),
        ])

    def test_default_ordering(self):
        """
        The default ordering should be by name, as specified in the inner Meta
        class.
        """
        inline = SongInlineDefaultOrdering(self.band, site)
        names = [s.name for s in inline.get_queryset(request)]
        self.assertEqual(['Dude (Looks Like a Lady)', 'Jaded', 'Pink'], names)

    def test_specified_ordering(self):
        """
        Let's check with ordering set to something different than the default.
        """
        inline = SongInlineNewOrdering(self.band, site)
        names = [s.name for s in inline.get_queryset(request)]
        self.assertEqual(['Jaded', 'Pink', 'Dude (Looks Like a Lady)'], names)


class TestRelatedFieldsAdminOrdering(TestCase):
    @classmethod
    def setUpTestData(cls):
        cls.b1 = Band.objects.create(name='Pink Floyd', bio='', rank=1)
        cls.b2 = Band.objects.create(name='Foo Fighters', bio='', rank=5)

    def setUp(self):
        # we need to register a custom ModelAdmin (instead of just using
        # ModelAdmin) because the field creator tries to find the ModelAdmin
        # for the related model
        class SongAdmin(admin.ModelAdmin):
            pass
        site.register(Song, SongAdmin)

    def tearDown(self):
        site.unregister(Song)
        if Band in site._registry:
            site.unregister(Band)

    def check_ordering_of_field_choices(self, correct_ordering):
        fk_field = site._registry[Song].formfield_for_foreignkey(Song.band.field, request=None)
        m2m_field = site._registry[Song].formfield_for_manytomany(Song.other_interpreters.field, request=None)
        self.assertEqual(list(fk_field.queryset), correct_ordering)
        self.assertEqual(list(m2m_field.queryset), correct_ordering)

    def test_no_admin_fallback_to_model_ordering(self):
        # should be ordered by name (as defined by the model)
        self.check_ordering_of_field_choices([self.b2, self.b1])

    def test_admin_with_no_ordering_fallback_to_model_ordering(self):
        class NoOrderingBandAdmin(admin.ModelAdmin):
            pass
        site.register(Band, NoOrderingBandAdmin)

        # should be ordered by name (as defined by the model)
        self.check_ordering_of_field_choices([self.b2, self.b1])

    def test_admin_ordering_beats_model_ordering(self):
        class StaticOrderingBandAdmin(admin.ModelAdmin):
            ordering = ('rank',)
        site.register(Band, StaticOrderingBandAdmin)

        # should be ordered by rank (defined by the ModelAdmin)
        self.check_ordering_of_field_choices([self.b1, self.b2])

    def test_custom_queryset_still_wins(self):
        """Custom queryset has still precedence (#21405)"""
        class SongAdmin(admin.ModelAdmin):
            # Exclude one of the two Bands from the querysets
            def formfield_for_foreignkey(self, db_field, request, **kwargs):
                if db_field.name == 'band':
                    kwargs["queryset"] = Band.objects.filter(rank__gt=2)
                return super().formfield_for_foreignkey(db_field, request, **kwargs)

            def formfield_for_manytomany(self, db_field, request, **kwargs):
                if db_field.name == 'other_interpreters':
                    kwargs["queryset"] = Band.objects.filter(rank__gt=2)
                return super().formfield_for_foreignkey(db_field, request, **kwargs)

        class StaticOrderingBandAdmin(admin.ModelAdmin):
            ordering = ('rank',)

        site.unregister(Song)
        site.register(Song, SongAdmin)
        site.register(Band, StaticOrderingBandAdmin)

        self.check_ordering_of_field_choices([self.b2])

2025-10-06 03:46:48,401 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --keepdb admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'8d0d445c-7bf3-4bc7-a172-b4c1b123d119': 'CrQFAR/Mhbb6I4EBkx+hCaBDA/PWjsPGJyF/nkALibLhX4V9GDM5gWdV2uiOOJWYW55M7aK9ZpXYY5dYb5JQ6ks8SLyCM6coVW36LKozd6c62Y8/vYc6JoqKfX+ufRuEq6ps0nhf2f3mN2L/YipN9r6O55G1Wid1tor1jynDsHajsVFEKpPCihxx1N7x5UGWtxo4V91Kb6oLFj3r1quqZ1v0Xf/SpADYH2IxZh6R+p4aaEjoFiQr1a7wwyhTyBZfF6o44D/rY+0zKr20+uDfElOxXX9MV56bVDso0JLhrBqE0dmK1aaJ8uLVWZBK6Dm8L6h5784Ay+4O/V8c/pKqCiycmKn8f3V3KA7tMxNuIlHfa5Fl18NkmRXLldriq0Vgr2RNNHGTWUFDPZWgMfX714Qzn3g2Hj75dtWSJg4ZbFePpV2/DwK6bx/uhxq2NDv7gWc1w8Wn3JjqWJzMxKyB2+sWOC1XBl0oD8XG7nnYyq4dhoBEhPiRCvWtUMH5nGaFZHEKCRn95KiuYLbS4ORvr/ujO+CVI4FIomJBbePR3cPa3lzPuE/0BUgHCjhK2oNfpISUAiTjkc/YTSHhuHmU7Tbd3Q1WIKUB0nDdv4Vpa3r8oTJywTgBJkOrL3/keipIrE8GXzV3x5xxhtJSSnYpK+EpjdDvoQ/9egmzTLn5JeFGbp7unxl8hUljat34ej35w3fBkGkWaY9gf10WTjxXmXwrFM5BXXtaO92nEMIxZnpKAzxOHs7iBNqlpyEE7QiZKZp+VZ7WhPrz/j4GJr11ufS4a4/nWT8IEFQ7b1w00zbk00SVXF9oPDNRvzP/Be6eE15e405nKX/DyPvNef1owD8yc3mgYy/z8oWnV/7IrSDBjEItmGeXioC90DfYvI6SpNHYDgAzgTSIPz7EreWgcwUABVVkg8IKIgEfzIW25jIy5/ihLPHfopLiR/3ygGLrtrCk5cEdy/EoRSg='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11103, 'candidates_token_count': 30, 'total_token_count': 11312, 'cached_content_token_count': 12411, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15702}], 'cache_tokens_details': [{'modality': 1, 'token_count': 12411}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 30}], 'thoughts_token_count': 179}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7533302942911784, 'model_name': 'gemini-2.5-pro'} id='run--8bd780e5-ab59-4e33-beaa-f35f61cb09ed-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --keepdb admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '8d0d445c-7bf3-4bc7-a172-b4c1b123d119', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11103, 'output_tokens': 30, 'total_tokens': 11312, 'input_token_details': {'cache_read': 12411}, 'output_token_details': {'reasoning': 179}}
2025-10-06 03:46:48,403 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --keepdb admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:46:48,687 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:46:48,688 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
Traceback (most recent call last):
  File "tests/runtests.py", line 573, in <module>
    options.start_at, options.start_after, options.pdb, options.buffer,
  File "tests/runtests.py", line 311, in django_tests
    extra_tests=extra_tests,
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 321, in __new__
    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)
  File "/testbed/django/apps/registry.py", line 229, in register_model
    (model_name, app_label, app_models[model_name], model))
RuntimeError: Conflicting 'member' models in application 'admin_widgets': <class 'admin_widgets.models.Member'> and <class 'admin_widgets.test_formfield_for_manytomany_widget.Member'>.

2025-10-06 03:46:55,231 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "echo \\"SECRET_KEY = \'dummy\'\\\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]\\" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'fc3e8144-d83f-4928-96f0-01df9eb0808d': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 11572, 'candidates_token_count': 110, 'total_token_count': 12188, 'cached_content_token_count': 14221, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16348}], 'cache_tokens_details': [{'modality': 1, 'token_count': 14221}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 110}], 'thoughts_token_count': 506}, 'finish_reason': 'STOP', 'avg_logprobs': -0.6392657193270597, 'model_name': 'gemini-2.5-pro'} id='run--ed31d321-4d16-4918-82a9-4515471a4926-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'echo "SECRET_KEY = \'dummy\'\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': 'fc3e8144-d83f-4928-96f0-01df9eb0808d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 11572, 'output_tokens': 110, 'total_tokens': 12188, 'input_token_details': {'cache_read': 14221}, 'output_token_details': {'reasoning': 506}}
2025-10-06 03:46:55,233 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: echo "SECRET_KEY = 'dummy'\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': ':memory:', }, }\nINSTALLED_APPS = [ 'django.contrib.contenttypes', 'django.contrib.auth', 'admin_widgets', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:46:55,366 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:46:55,366 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kt

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 345, in execute
    settings.INSTALLED_APPS
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 64, in _setup
    self._wrapped = Settings(settings_module)
  File "/testbed/django/conf/__init__.py", line 171, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 994, in _gcd_import
  File "<frozen importlib._bootstrap>", line 971, in _find_and_load
  File "<frozen importlib._bootstrap>", line 955, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 665, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 674, in exec_module
  File "<frozen importlib._bootstrap_external>", line 781, in get_code
  File "<frozen importlib._bootstrap_external>", line 741, in source_to_code
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/testbed/temp_settings.py", line 1
    SECRET_KEY = 'dummy'\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': ':memory:', }, }\nINSTALLED_APPS = [ 'django.contrib.contenttypes', 'django.contrib.auth', 'admin_widgets', ]
                                                                                                                                                                                                                 ^
SyntaxError: unexpected character after line continuation character

2025-10-06 03:46:58,257 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "printf \\"SECRET_KEY = \'dummy\'\\\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]\\" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'d52e1b12-cbb2-4cc1-90fa-b761753f19d9': 'CpIFAR/MhbYmxUxWkU4yxHn+bBJ22/Q3DOY/gH9WDixCp1+ZkzN+o0FRSYCsMm7x8+LYSZv1I3oRVcWCc8Eo1x0xZwovmlZ7EncQVzj6EH4V7aQpF5I4c7IR/zB7Q7d1+Cj7VSYTqulBrESoTU9gXj7DR+0UV0NWzcgNAJOAFANYdP8EbvlxWdbuiGC8DCuDw1gYrxmADp0pyeM2SIET9FZtRL/8SnFlBaDTHIVFxuKhLnfR0sjejJmZbWzIz2aXsWLr9chV3DlpOukcBcPhAn7+57HjETp24jwXeMo1QmXGMuoh62NQWZSeMAleyWu2uwC//q7J9mE9X26JzPq1LZBIpmOmn+lvUecaVNt5l/QzHPIwUA1oeTMnhC27u1MFzME7huqBsYblm8JKyCVPa8SZJ/ASpUR2757AWfy+BKtR2eVoIrppdr6GsBZSRTamDGoGUxW8VV1YPKfie9wdhaF1nKGr+RH0GtMGZKj/jKkL5LYbUSn8lQwKQPsp/82oq2YsTpbe4Xn4WwFsCqgXwdHghLsR0Rit+Xqhkynk02K5F+PIkes8D7zzmwUHzromzqjY54fWVhOJrFdE1RjCSmvvijh5FW4SkJaUhqiTrCdkr8ecxJiczhQNlP4nxJMuXAZLHujq5HZ0gxqcmUQdqWSqQYuwqKpZ3tIT1n0C4UgGrvrihLjODjk6XKy0a487qHLiS56I+1UPi30PDUNHfV2ZvGWbdymDNq8IZ3RiWtIuIiD7qvzM37EAKeIizmjHx3qTSyLNvkADv15q0BQQ7Lx2ZvzYU1rQaeEB3giJsYMZkJSCTBeuWjF/xnGvKObA+o0gpKJhBxWz3itH716gUwlpJCJBXQNpcKXx/DwFw6fOsul9ZgoiAR/MhbafSRZ7C6nIhQqbiWfsOslx0aPNvu0Mw7HQNet6kQ=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 12591, 'candidates_token_count': 110, 'total_token_count': 12889, 'cached_content_token_count': 15902, 'prompt_tokens_details': [{'modality': 1, 'token_count': 17871}], 'cache_tokens_details': [{'modality': 1, 'token_count': 15902}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 110}], 'thoughts_token_count': 188}, 'finish_reason': 'STOP', 'avg_logprobs': -0.05548320683566007, 'model_name': 'gemini-2.5-pro'} id='run--c578f1f6-90bd-4c65-aea4-e1ba6074f664-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'printf "SECRET_KEY = \'dummy\'\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': 'd52e1b12-cbb2-4cc1-90fa-b761753f19d9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 12591, 'output_tokens': 110, 'total_tokens': 12889, 'input_token_details': {'cache_read': 15902}, 'output_token_details': {'reasoning': 188}}
2025-10-06 03:46:58,259 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: printf "SECRET_KEY = 'dummy'\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': ':memory:', }, }\nINSTALLED_APPS = [ 'django.contrib.contenttypes', 'django.contrib.auth', 'admin_widgets', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:46:58,486 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:46:58,486 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 377, in execute
    django.setup()
  File "/testbed/django/__init__.py", line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File "/testbed/django/apps/registry.py", line 91, in populate
    app_config = AppConfig.create(entry)
  File "/testbed/django/apps/config.py", line 90, in create
    module = import_module(entry)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 994, in _gcd_import
  File "<frozen importlib._bootstrap>", line 971, in _find_and_load
  File "<frozen importlib._bootstrap>", line 953, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'admin_widgets'

2025-10-06 03:47:01,249 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "PYTHONPATH=$PYTHONPATH:tests printf \\"SECRET_KEY = \'dummy\'\\\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]\\" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'69bcdf58-e133-4d17-9ae8-3badba948f8c': 'CrAFAR/MhbYngEFiSHtQjed90NLREPF6Ll6WjWaKh8hXZyE2g9WxYRvXUgvBtinvOORNUAJAX99YYz7E7BTEZtlITgInZU4SXfvvmTQo4z42DC+cfkiZTYvmJBNTAYynpikhTsBvkE2rC+8i6umO5RufqiKKyWsubEDKORBS+O9/TzL/hPfWCzUlQioVNGSI/cMR/rJQPmxK6idp01TRvNOpl1Tg/vhH4iLcaHx11M8FoprI4j288ZekqZdMjWhX8jZVcIY99vO+oLjYIfpwDZz3qzVbYESwRstjgdrgLIFLnh7O29u+27MwsEbZ+npyzom4ouhCSbNVGKXynHJKWAFdubJtHJooIvnDRG1X56I4T9f9FxN1C1qyOXNzvMZNEoZJzybRFcqo6ckeX+3LPpM+1Xxn1j5VGAMQF76tzL8lip9v5nkptlU9DE3mDljlaOv3WtGZnMlhWgdqQGqiR0gfuQl4jTQHXGKWVP3/BT8iyfCMfBXdUMUuieeskIeDCS8aijBoP6JmfENCAJhUKl6nn+YOzFUMxGQxxVqprftOXDhtg2gXBFBcUapzyBMTvtFLCYCUEDjR25qRVURCaflHa4/NJCqBzwD4GvkQwlpY+meA+y7y5Jttq0IGWyNc9ZALYEe9cDJNQMWMIKSb5CBMA1qHc0yVu6ConY2AOu/prUkEmGEIXv6APHNGHs/MikPckpUkUr5r/L1N2fHO6FR6aSTW3IBoqCxhhCCxv9iuYZXHXcQJGBj5u5gspvHsKLHw938GdTVIoWB/vB7v/VHsnEKXpeVVTZgQUyz3ZZ4dng2AEF1iT3g36GHAm4IdSLRQDZ8PlfGq5sU94a90QnhUUZXGOn/h7d8k/3MrZ2aHO55UX4T58WSlRXiYOxWg7pa1T3qEZpTO/wO5U31PRTJeSQoiAR/MhbZqCG3ombj8QEMlsFqink18GYfIaUxKzXDLbNYDwA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13154, 'candidates_token_count': 117, 'total_token_count': 13462, 'cached_content_token_count': 17702, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18620}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17702}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 117}], 'thoughts_token_count': 191}, 'finish_reason': 'STOP', 'avg_logprobs': -0.04568608601888021, 'model_name': 'gemini-2.5-pro'} id='run--ffbda604-d186-48ce-9eee-b56affa9a653-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'PYTHONPATH=$PYTHONPATH:tests printf "SECRET_KEY = \'dummy\'\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '69bcdf58-e133-4d17-9ae8-3badba948f8c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13154, 'output_tokens': 117, 'total_tokens': 13462, 'input_token_details': {'cache_read': 17702}, 'output_token_details': {'reasoning': 191}}
2025-10-06 03:47:01,250 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: PYTHONPATH=$PYTHONPATH:tests printf "SECRET_KEY = 'dummy'\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': ':memory:', }, }\nINSTALLED_APPS = [ 'django.contrib.contenttypes', 'django.contrib.auth', 'admin_widgets', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:47:01,476 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:47:01,476 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 377, in execute
    django.setup()
  File "/testbed/django/__init__.py", line 24, in setup
    apps.populate(settings.INSTALLED_APPS)
  File "/testbed/django/apps/registry.py", line 91, in populate
    app_config = AppConfig.create(entry)
  File "/testbed/django/apps/config.py", line 90, in create
    module = import_module(entry)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 994, in _gcd_import
  File "<frozen importlib._bootstrap>", line 971, in _find_and_load
  File "<frozen importlib._bootstrap>", line 953, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'admin_widgets'

2025-10-06 03:47:04,135 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "export PYTHONPATH=$PYTHONPATH:tests && printf \\"SECRET_KEY = \'dummy\'\\\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]\\" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'4345ee6b-1515-41ee-a7b6-3b2d027ddcbb': 'CpMEAR/MhbaKp40Vr1jkGRpTM34EYpCWJUXo6pJCtQkFWsahhW7VPnw1PRuoLJTe8hst9qldxHMtfNI4YThNClbcNnUV2RO072haTaQAslizE7bR5I9ZtWDEglTWrw904YD62Hl6TbbK/0D4pFTF5nGB+Mj+0+6q/AyISBtca02cxXN21FnXBkCeDNuA7Egm7Caxt8jcCA7b/ziHUXjSrDVxu0h34207h3Fd4K9di7s2RsghxRiAMg6jeoulKjaTWqSZoH+NQXz7F4zVVC7yNK4oB9+GfGC8YZIOqTL3VrP+sCmTPm3j87JUzymq4QuG2UuFp2I9HhSmxG9s++pGW5aciX5rbvUUY/z/3VX6pZAxEP1bFJE2a2yNT8r8cjjnNoaTb8ox1jh3V+qvowSjcUevL9PRoI8Xmav6edvmU6fcJeW66eoFas8YI1Bx5NNFzQBPWBzlsdlaxKpFNKPvP1bYVfoV7E82peVSOylkQdp9BJv57emFsno+WQI4MOfcmCgnr62/JdmWzlzmhHBW+P2Ejb6KbebqXkERLVAMlcqToIMaPxyXzso8BVmJmIkunCOSaGs6yUs5Am2D+BrsXrQBWS4XfD4OLM5tw+z/SxIKZRx1Of7S+c79sTvdHB7PmfaLdZuS3mNRaxwj9hRdgO2f9UkDlR3Gyx756ySXKObvBAdcyHIF74vnVQW9RS2q+wthQJbC'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 13724, 'candidates_token_count': 119, 'total_token_count': 13973, 'cached_content_token_count': 17735, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19379}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17735}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 119}], 'thoughts_token_count': 130}, 'finish_reason': 'STOP', 'avg_logprobs': -0.05619990725477202, 'model_name': 'gemini-2.5-pro'} id='run--331162b9-729f-401c-9dfd-9c47c10d4740-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'export PYTHONPATH=$PYTHONPATH:tests && printf "SECRET_KEY = \'dummy\'\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '4345ee6b-1515-41ee-a7b6-3b2d027ddcbb', 'type': 'tool_call'}] usage_metadata={'input_tokens': 13724, 'output_tokens': 119, 'total_tokens': 13973, 'input_token_details': {'cache_read': 17735}, 'output_token_details': {'reasoning': 130}}
2025-10-06 03:47:04,137 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export PYTHONPATH=$PYTHONPATH:tests && printf "SECRET_KEY = 'dummy'\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': ':memory:', }, }\nINSTALLED_APPS = [ 'django.contrib.contenttypes', 'django.contrib.auth', 'admin_widgets', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:47:04,426 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:47:04,426 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 330, in run_from_argv
    self.execute(*args, **cmd_options)
  File "/testbed/django/core/management/base.py", line 371, in execute
    output = self.handle(*args, **options)
  File "/testbed/django/core/management/commands/test.py", line 53, in handle
    failures = test_runner.run_tests(test_labels)
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 116, in __new__
    "INSTALLED_APPS." % (module, name)
RuntimeError: Model class tests.admin_widgets.test_formfield_for_manytomany_widget.Member doesn't declare an explicit app_label and isn't in an application in INSTALLED_APPS.

2025-10-06 03:47:07,633 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "export PYTHONPATH=$PYTHONPATH:tests && printf \\"SECRET_KEY = \'dummy\'\\\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]\\" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'c5a37c75-6c2c-4356-ab5c-d73d789784fe': 'CoMGAR/MhbbWJI8mHx/XzBNV6mV3MAozpSxh+90ZcDazDI6TRsrFQl2D2D6DA/9ItCscSj+zl19paBswaKs0tQCYXnRdkcOq+ggERGwb/U+1RCTIAYntRjoBiFeyN8BqDHNGLtGEDzA3jH+mTc3fzUkO+NI+h47mCgT2dJlJ3gfHKLFHm/NCDIuEcWoiW5/gTjdBbFPA2qUzfl1k2H4D6viMOjhO/nXXExd7BscMldjZzU/arsCpRbys6n93kPNZHaXBVgN8nCXzTN0hE51lbhmIoasfRXXT4moSuehGZ8HlvhERteW5K+G22Fl/V1HpmEG8etaGXuG18m9BlXoaBEjj5YNCYDJR0aO9vsK01gaX7IeL3KMRxdfhxG3ZSduIecaFss7OByePyj4IJaxxNNIYj/dSTXwaGnRZNr9fs846SxZfdGHPs5SiXjRRmObg9TXOS2vZH+SBhHbt6houH3DqfVP8udqpyToPKBkfVf9iiW905WdfcKSxJb0LH6XFM4jIiDJYBZ0BkH8N6HSctE5FX6F54YGqJM0D0kJCUbbb1lQcB6l8auwBEWufYPBc/h+PdRQLKWpKUR3ZZuIMIyuL/DXdItsY/uQhzTXEbgYqGUx4X/YCLrTEkoYHk/Ffr0idOpofC0eGtitwXeCrgyb6pS0LmhxgWTaAQYoN5d2Y1qxbP20e2NkkUJi0PpE2uMjvdKM3aOo16ooBfrBMMgJVBjGGgRUsYmNymBEl3VAQE2Q55sLeOUCvD5BtqZXOBS6j84vG24hUS81lKYXb75pdA/ErsgXq7XPn65+h2VrFygFS2k2g4fTXbMQhBgmjg5oH1HCspW0ZAWPqqvjdpoIO1VGvTmg+29kNx9YR8rWDnv55evQ+5VAPdwCVQZ+Rd03QdrOhXG3Aa1uld/o37jghKSt9KMKsY4KT83+HO/GjsRbnihR3IKQ0gCuDHOYzajVyu0F6jx0nia8gd0YDLYAKtIJKyd76BaeRl31IrWkeahmSxBHbEcI0JmnMK1tBV9ffm3c2CiIBH8yFtmt1QWdoKKjQLX8SPUCS1p8qTGu3aK6HJFBshClN'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 14506, 'candidates_token_count': 117, 'total_token_count': 14831, 'cached_content_token_count': 17786, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20289}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17786}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 117}], 'thoughts_token_count': 208}, 'finish_reason': 'STOP', 'avg_logprobs': -0.10322671873956664, 'model_name': 'gemini-2.5-pro'} id='run--3c8bde4e-64b1-48fa-b62e-9f8550606153-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'export PYTHONPATH=$PYTHONPATH:tests && printf "SECRET_KEY = \'dummy\'\\nDATABASES = { \'default\': { \'ENGINE\': \'django.db.backends.sqlite3\', \'NAME\': \':memory:\', }, }\\nINSTALLED_APPS = [ \'django.contrib.contenttypes\', \'django.contrib.auth\', \'admin_widgets\', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test admin_widgets.test_formfield_for_manytomany_widget'}, 'id': 'c5a37c75-6c2c-4356-ab5c-d73d789784fe', 'type': 'tool_call'}] usage_metadata={'input_tokens': 14506, 'output_tokens': 117, 'total_tokens': 14831, 'input_token_details': {'cache_read': 17786}, 'output_token_details': {'reasoning': 208}}
2025-10-06 03:47:07,635 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: export PYTHONPATH=$PYTHONPATH:tests && printf "SECRET_KEY = 'dummy'\nDATABASES = { 'default': { 'ENGINE': 'django.db.backends.sqlite3', 'NAME': ':memory:', }, }\nINSTALLED_APPS = [ 'django.contrib.contenttypes', 'django.contrib.auth', 'admin_widgets', ]" > temp_settings.py && DJANGO_SETTINGS_MODULE=temp_settings python -m django test admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:47:07,918 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:47:07,918 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 330, in run_from_argv
    self.execute(*args, **cmd_options)
  File "/testbed/django/core/management/base.py", line 371, in execute
    output = self.handle(*args, **options)
  File "/testbed/django/core/management/commands/test.py", line 53, in handle
    failures = test_runner.run_tests(test_labels)
  File "/testbed/django/test/runner.py", line 693, in run_tests
    suite = self.build_suite(test_labels, extra_tests)
  File "/testbed/django/test/runner.py", line 550, in build_suite
    tests = self.test_loader.loadTestsFromName(label)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName
    module = __import__(module_name)
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>
    class Member(models.Model):
  File "/testbed/django/db/models/base.py", line 321, in __new__
    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)
  File "/testbed/django/apps/registry.py", line 229, in register_model
    (model_name, app_label, app_models[model_name], model))
RuntimeError: Conflicting 'member' models in application 'admin_widgets': <class 'admin_widgets.models.Member'> and <class 'admin_widgets.test_formfield_for_manytomany_widget.Member'>.

2025-10-06 03:47:09,043 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={} response_metadata={'usage_metadata': {'prompt_token_count': 15351, 'total_token_count': 15351, 'cached_content_token_count': 14121, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15351}], 'cache_tokens_details': [{'modality': 1, 'token_count': 14121}], 'candidates_token_count': 0, 'thoughts_token_count': 0, 'candidates_tokens_details': []}, 'model_name': 'gemini-2.5-pro'} id='run--95e2dc51-d09c-47eb-913c-f7949dc5870c-0' usage_metadata={'input_tokens': 15351, 'output_tokens': 0, 'total_tokens': 15351, 'input_token_details': {'cache_read': 14121}}
2025-10-06 03:47:30,949 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='Traceback (most recent call last):\n  File "tests/runtests.py", line 573, in <module>\n    options.start_at, options.start_after, options.pdb, options.buffer,\n  File "tests/runtests.py", line 311, in django_tests\n    extra_tests=extra_tests,\n  File "/testbed/django/test/runner.py", line 693, in run_tests\n    suite = self.build_suite(test_labels, extra_tests)\n  File "/testbed/django/test/runner.py", line 550, in build_suite\n    tests = self.test_loader.loadTestsFromName(label)\n  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName\n    module = __import__(module_name)\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>\n    class Member(models.Model):\n  File "/testbed/django/db/models/base.py", line 321, in __new__\n    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)\n  File "/testbed/django/apps/registry.py", line 229, in register_model\n    (model_name, app_label, app_models[model_name], model))\nRuntimeError: Conflicting \'member\' models in application \'admin_widgets\': <class \'admin_widgets.models.Member\'> and <class \'admin_widgets.test_formfield_for_manytomany_widget.Member\'>.\n\nThis test fails with a `RuntimeError` because of a name conflict with an existing model, which prevents the test from running. The test is expected to fail with an `AssertionError` to demonstrate that the widget is not being overridden as described in the bug report.' reproduced_bug_commands=['python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget']
2025-10-06 03:47:30,949 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-10-06 03:47:30,950 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-10-06 03:47:30,950 - thread-139660780025408.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-10-06 03:47:31,001 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nTraceback (most recent call last):\n  File "tests/runtests.py", line 573, in <module>\n    options.start_at, options.start_after, options.pdb, options.buffer,\n  File "tests/runtests.py", line 311, in django_tests\n    extra_tests=extra_tests,\n  File "/testbed/django/test/runner.py", line 693, in run_tests\n    suite = self.build_suite(test_labels, extra_tests)\n  File "/testbed/django/test/runner.py", line 550, in build_suite\n    tests = self.test_loader.loadTestsFromName(label)\n  File "/opt/miniconda3/envs/testbed/lib/python3.6/unittest/loader.py", line 153, in loadTestsFromName\n    module = __import__(module_name)\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 8, in <module>\n    class Member(models.Model):\n  File "/testbed/django/db/models/base.py", line 321, in __new__\n    new_class._meta.apps.register_model(new_class._meta.app_label, new_class)\n  File "/testbed/django/apps/registry.py", line 229, in register_model\n    (model_name, app_label, app_models[model_name], model))\nRuntimeError: Conflicting \'member\' models in application \'admin_widgets\': <class \'admin_widgets.models.Member\'> and <class \'admin_widgets.test_formfield_for_manytomany_widget.Member\'>.\n\nThis test fails with a `RuntimeError` because of a name conflict with an existing model, which prevents the test from running. The test is expected to fail with an `AssertionError` to demonstrate that the widget is not being overridden as described in the bug report.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-10-06 03:48:08,711 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='An analysis of the previous attempt\'s failure reveals a `RuntimeError` due to a name collision between the test-specific model `Member` and an existing `Member` model within the `admin_widgets` application. The test execution environment treats the test file as part of the `admin_widgets` app, causing Django\'s app registry to detect two models with the same name in the same app.\n\nTo resolve this, the models defined within the test case must have names that are unique within the application\'s scope. Renaming `Member` and `Band` to `WidgetTestMember` and `WidgetTestBand` respectively will prevent this collision.\n\nThe core logic of the test remains the same:\n1.  Define a `ModelAdmin` and instantiate it.\n2.  Invoke `formfield_for_manytomany`, providing a custom widget via the `widget` parameter.\n3.  The bug is that this `widget` parameter is ignored. The default widget, `forms.SelectMultiple`, is used instead.\n4.  The Django admin wraps relation field widgets with `RelatedFieldWidgetWrapper`. Therefore, the assertion must inspect the inner widget at `form_field.widget.widget`.\n5.  The test will assert that the inner widget is an instance of the custom widget that was passed (`forms.CheckboxSelectMultiple`). This assertion will fail until the bug is fixed, at which point it will pass.\n\nBy renaming the models, the `RuntimeError` will be avoided, allowing the test to execute and fail with the expected `AssertionError`, thus correctly demonstrating the bug.\n\n```python\nfrom django import forms\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n# Define models with unique names to avoid the RuntimeError caused by a\n# name collision with an existing \'Member\' model in the \'admin_widgets\' app.\nclass WidgetTestMember(models.Model):\n    name = models.CharField(max_length=100)\n\n    class Meta:\n        # Isolate the model in a dummy app to prevent any conflicts.\n        app_label = \'admin_widgets_test\'\n\n\nclass WidgetTestBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(WidgetTestMember)\n\n    class Meta:\n        app_label = \'admin_widgets_test\'\n\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    """\n    Tests that formfield_for_manytomany respects the widget argument.\n    """\n\n    def test_formfield_for_manytomany_widget_override(self):\n        """\n        formfield_for_manytomany() should respect a passed widget.\n        """\n        class BandAdmin(admin.ModelAdmin):\n            pass\n\n        model_admin = BandAdmin(WidgetTestBand, admin.site)\n        db_field = WidgetTestBand._meta.get_field(\'members\')\n\n        field = model_admin.formfield_for_manytomany(\n            db_field,\n            request=None,\n            widget=forms.CheckboxSelectMultiple,\n        )\n\n        # The widget for a relation field is wrapped in RelatedFieldWidgetWrapper\n        # in the admin. The actual widget is in the \'widget\' attribute of the wrapper.\n        # The bug is that the passed widget is ignored, and the default\n        # (SelectMultiple) is used instead.\n        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\n\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 15233, 'candidates_token_count': 776, 'total_token_count': 19562, 'cached_content_token_count': 13874, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15233}], 'cache_tokens_details': [{'modality': 1, 'token_count': 13874}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 776}], 'thoughts_token_count': 3553}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7518627520689031, 'model_name': 'gemini-2.5-pro'} id='run--318ae322-a96a-4133-804e-fb03a331ab13-0' usage_metadata={'input_tokens': 15233, 'output_tokens': 776, 'total_tokens': 19562, 'input_token_details': {'cache_read': 13874}, 'output_token_details': {'reasoning': 3553}}
2025-10-06 03:48:34,586 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "from django import forms\\nfrom django.contrib import admin\\nfrom django.contrib.admin import widgets\\nfrom django.db import models\\nfrom django.test import SimpleTestCase\\n\\n# Define models with unique names to avoid the RuntimeError caused by a\\n# name collision with an existing \'Member\' model in the \'admin_widgets\' app.\\nclass WidgetTestMember(models.Model):\\n    name = models.CharField(max_length=100)\\n\\n    class Meta:\\n        # Isolate the model in a dummy app to prevent any conflicts.\\n        app_label = \'admin_widgets_test\'\\n\\n\\nclass WidgetTestBand(models.Model):\\n    name = models.CharField(max_length=100)\\n    members = models.ManyToManyField(WidgetTestMember)\\n\\n    class Meta:\\n        app_label = \'admin_widgets_test\'\\n\\n\\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\\n    \\"\\"\\"\\n    Tests that formfield_for_manytomany respects the widget argument.\\n    \\"\\"\\"\\n\\n    def test_formfield_for_manytomany_widget_override(self):\\n        \\"\\"\\"\\n        formfield_for_manytomany() should respect a passed widget.\\n        \\"\\"\\"\\n        class BandAdmin(admin.ModelAdmin):\\n            pass\\n\\n        model_admin = BandAdmin(WidgetTestBand, admin.site)\\n        db_field = WidgetTestBand._meta.get_field(\'members\')\\n\\n        field = model_admin.formfield_for_manytomany(\\n            db_field,\\n            request=None,\\n            widget=forms.CheckboxSelectMultiple,\\n        )\\n\\n        # The widget for a relation field is wrapped in RelatedFieldWidgetWrapper\\n        # in the admin. The actual widget is in the \'widget\' attribute of the wrapper.\\n        # The bug is that the passed widget is ignored, and the default\\n        # (SelectMultiple) is used instead.\\n        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\\n", "relative_path": "tests/admin_widgets/test_formfield_for_manytomany_widget.py"}'}, '__gemini_function_call_thought_signatures__': {'3888bd9a-fec9-4dae-acde-3644ab466fc4': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 54080, 'candidates_token_count': 465, 'total_token_count': 57614, 'prompt_tokens_details': [{'modality': 1, 'token_count': 54080}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 465}], 'thoughts_token_count': 3069, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5241187967279906, 'model_name': 'gemini-2.5-pro'} id='run--a358c1c6-04f7-48ce-bd16-6b2b153585ff-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'from django import forms\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n# Define models with unique names to avoid the RuntimeError caused by a\n# name collision with an existing \'Member\' model in the \'admin_widgets\' app.\nclass WidgetTestMember(models.Model):\n    name = models.CharField(max_length=100)\n\n    class Meta:\n        # Isolate the model in a dummy app to prevent any conflicts.\n        app_label = \'admin_widgets_test\'\n\n\nclass WidgetTestBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(WidgetTestMember)\n\n    class Meta:\n        app_label = \'admin_widgets_test\'\n\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    """\n    Tests that formfield_for_manytomany respects the widget argument.\n    """\n\n    def test_formfield_for_manytomany_widget_override(self):\n        """\n        formfield_for_manytomany() should respect a passed widget.\n        """\n        class BandAdmin(admin.ModelAdmin):\n            pass\n\n        model_admin = BandAdmin(WidgetTestBand, admin.site)\n        db_field = WidgetTestBand._meta.get_field(\'members\')\n\n        field = model_admin.formfield_for_manytomany(\n            db_field,\n            request=None,\n            widget=forms.CheckboxSelectMultiple,\n        )\n\n        # The widget for a relation field is wrapped in RelatedFieldWidgetWrapper\n        # in the admin. The actual widget is in the \'widget\' attribute of the wrapper.\n        # The bug is that the passed widget is ignored, and the default\n        # (SelectMultiple) is used instead.\n        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\n', 'relative_path': 'tests/admin_widgets/test_formfield_for_manytomany_widget.py'}, 'id': '3888bd9a-fec9-4dae-acde-3644ab466fc4', 'type': 'tool_call'}] usage_metadata={'input_tokens': 54080, 'output_tokens': 465, 'total_tokens': 57614, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 3069}}
2025-10-06 03:48:35,920 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/admin_widgets/test_formfield_for_manytomany_widget.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 54575, 'candidates_token_count': 20, 'total_token_count': 54595, 'cached_content_token_count': 52511, 'prompt_tokens_details': [{'modality': 1, 'token_count': 57641}], 'cache_tokens_details': [{'modality': 1, 'token_count': 52511}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -8.636013808427378e-06, 'model_name': 'gemini-2.5-pro'} id='run--23ef64ca-1d0f-4fca-8f95-28bdd91b538f-0' usage_metadata={'input_tokens': 54575, 'output_tokens': 20, 'total_tokens': 54595, 'input_token_details': {'cache_read': 52511}}
2025-10-06 03:48:35,956 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/admin_widgets/test_formfield_for_manytomany_widget.py b/tests/admin_widgets/test_formfield_for_manytomany_widget.py
new file mode 100644
index 0000000000..116f819747
--- /dev/null
+++ b/tests/admin_widgets/test_formfield_for_manytomany_widget.py
@@ -0,0 +1,50 @@
+from django import forms
+from django.contrib import admin
+from django.contrib.admin import widgets
+from django.db import models
+from django.test import SimpleTestCase
+
+# Define models with unique names to avoid the RuntimeError caused by a
+# name collision with an existing 'Member' model in the 'admin_widgets' app.
+class WidgetTestMember(models.Model):
+    name = models.CharField(max_length=100)
+
+    class Meta:
+        # Isolate the model in a dummy app to prevent any conflicts.
+        app_label = 'admin_widgets_test'
+
+
+class WidgetTestBand(models.Model):
+    name = models.CharField(max_length=100)
+    members = models.ManyToManyField(WidgetTestMember)
+
+    class Meta:
+        app_label = 'admin_widgets_test'
+
+
+class FormfieldForManyToManyWidgetTest(SimpleTestCase):
+    """
+    Tests that formfield_for_manytomany respects the widget argument.
+    """
+
+    def test_formfield_for_manytomany_widget_override(self):
+        """
+        formfield_for_manytomany() should respect a passed widget.
+        """
+        class BandAdmin(admin.ModelAdmin):
+            pass
+
+        model_admin = BandAdmin(WidgetTestBand, admin.site)
+        db_field = WidgetTestBand._meta.get_field('members')
+
+        field = model_admin.formfield_for_manytomany(
+            db_field,
+            request=None,
+            widget=forms.CheckboxSelectMultiple,
+        )
+
+        # The widget for a relation field is wrapped in RelatedFieldWidgetWrapper
+        # in the admin. The actual widget is in the 'widget' attribute of the wrapper.
+        # The bug is that the passed widget is ignored, and the default
+        # (SelectMultiple) is used instead.
+        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:48:35,956 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 03:48:35,990 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 03:48:35,990 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 03:48:36,300 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:36,300 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 5b884d45ac Fixed #29501 -- Allowed dbshell to pass options to underlying tool.

2025-10-06 03:48:36,300 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 03:48:36,401 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:36,401 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Removing temp_settings.py
Removing tests/admin_widgets/test_formfield_for_manytomany_widget.py

2025-10-06 03:48:36,401 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 03:48:36,402 - thread-139660780025408.app.docker.base_container - INFO - Creating directory tests/admin_widgets in the container
2025-10-06 03:48:36,402 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/admin_widgets
2025-10-06 03:48:36,502 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:36,502 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:48:36,502 - thread-139660780025408.app.docker.base_container - INFO - Updating tests/admin_widgets/test_formfield_for_manytomany_widget.py in the container
2025-10-06 03:48:36,504 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 03:48:38,131 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls -F"}'}, '__gemini_function_call_thought_signatures__': {'5633f863-7a6e-4e41-9dc9-593d818e624a': 'CtcDAR/MhbaM8mgpzwIksFYyLrJ7fHv6ftETnNJDM7tYTOg1ZlNTnwbB0+7BXVMt+PehBDHjO8XwbNfU1JcPBDhVsktpLGFIU8/qBrMTHNb3ToZcZpzcaM30Vmk4ML5xqQSiru1JawEP8Sha470gyLC/2dUmOIv1YMDMLaOzVH2zHOMjEKLyBN8js39EkHClTVfdwIwhnmolYpDKlpldkPDSi2lNnOqUsBfKxB2P7E7UM2Q888CVf1kBV28PuY7a/vJYwNTDy70df83iDe5f6eJTP/jdEXAG06oztxe+Ibttm5kqjjPwehiErUP/zMWWkuc526XTMapybITWZztpnkctDqxWdG/dJ2TC4YlRPi0DPQITgYWjOz4KEKCnxFgtFYZVHt83e3Hu07eYPKFHb7R3IouLIHIu3WOoS+tXMnmpuzj5QxxC+xLRYH2HKUSqHaWPPdo+CFUeBOQEAJXFSZ88qaO8wkC8CJP3pJl+N7QFW3WA4X9nLjb/CjAkdsqmGmoQpe/cc1rUEFNUWyEIdsHv9Rcq6dpolc9S6gUKIw8SnPQYRq23QirBBO4MsUWHiBhVp5m37U3yVRpZzLFfy5agkAa7JRWSZshRzeALjP9CJ7u2Dn//jeGw'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 303, 'candidates_token_count': 7, 'total_token_count': 416, 'prompt_tokens_details': [{'modality': 1, 'token_count': 303}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 7}], 'thoughts_token_count': 106, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1250761577061243, 'model_name': 'gemini-2.5-pro'} id='run--1c1d7c7d-5ed6-4e04-aab6-b9e6bb06ce15-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls -F'}, 'id': '5633f863-7a6e-4e41-9dc9-593d818e624a', 'type': 'tool_call'}] usage_metadata={'input_tokens': 303, 'output_tokens': 7, 'total_tokens': 416, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 106}}
2025-10-06 03:48:38,132 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls -F
2025-10-06 03:48:38,233 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:38,233 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

AUTHORS		  docs/		js_tests/	package.json  setup.cfg
CONTRIBUTING.rst  extras/	LICENSE		__pycache__/  setup.py
django/		  Gruntfile.js	LICENSE.python	README.rst    tests/
Django.egg-info/  INSTALL	MANIFEST.in	scripts/      tox.ini

2025-10-06 03:48:41,066 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python -c \\"import django\\""}'}, '__gemini_function_call_thought_signatures__': {'c1305acd-2151-473f-8b3e-97a28891cbd6': 'CrEGAR/MhbY0+P+tH4LABkIH8PN7UIpQmvvtA40zDby3cVgcuTdUtCjLa3uJMPIaM4s0nbT21+bTviliPVF59qrNwAN6D4VFx607gqcgzZS0BZYNYhg29yygRQpMyMDB09C6l0NGrv5LTkGyAkunmthUYW0VrL9s2CFJUMBt+rn+E9BIvA2eTrqQ26j3PtK9kcnp2RzitCa2leXVi9XTRpD6DS0Cce/XSLOVVL3OBMgLic3p0ZmGD8j2Py76Eaout1atitSkhhRibCRwYxmXNnqXqgJKqZR2pQuAGiolji/9CT5+3xLnTdVDIIq3aDis4JsDPYtUcvaL3JJsBFUBO58mCUJMfJ96zvHrWRDNA4ssIzZZUK5w1rZHyeTQesD1cQTVXPH92Re2kd8Jqx4KkITj5SagAbjvZ/2mcC0OBvpBnGHELPNmrVJiWD9J5E2QQIapxO3EwIMOjEhxQoBejt0Q940dYnJfvFlptgsa2ewxL1wlWAmBIjfgW0eP7b98ZnAd5q6ysK/6FqUz7Rp/+w2LrerQtwAsyg/eCtLNoUWO1Tn7+yPTvNle7gbpHsMUgmGN0HES2EhqIsgLiGa2a5Ddpnq4xeLl4Lm2L41q53zvOZ96Ae9m+NQXzkoKgdCVWvMRU5IZEG4bWc/3Hh5PLfbS9LpXeMVbdpAsyDwnjVxx2mRjxKI9rVrH2q32gyNwCtTmUwbRUaYC4nDmoMDoXaPvXVY1sqp+aox7TI2E6aeP9lwFKP7OddPgohKldLb+GrFsjSmDIWRNuT8hvUx/qpCcEiLVYyNaTdJFPDto7KaD99R1GPGKjEegOtJIrGFUUFPByHziTosCeKMIxAoG1C6yCX+cxZAa1BP4wm1TunZF+qhNiDr8ImCC0EdCoa2TUL9YnDRdaubUkRrqhBcZEaDKP+UgU4j2CGeqTgtHFdlRc3DL3eMU8pdXAmMD3prd0AA5uxhUmtw9bIuGJhGsjMsEFhEDHFcvw6YwJqgIv16Ply5N/ME1GxxsP4vWwcidsOKQaFJgsDumU+nl3/Lpzk8kQb90+c8p623Bec9A8JP8bX/lsoxi/0h0VfqY1k79ewl4mw=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 395, 'candidates_token_count': 11, 'total_token_count': 626, 'prompt_tokens_details': [{'modality': 1, 'token_count': 499}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 11}], 'thoughts_token_count': 220, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.429017327048562, 'model_name': 'gemini-2.5-pro'} id='run--b8bd0cdb-7c58-4c77-91c4-99dd942cb394-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python -c "import django"'}, 'id': 'c1305acd-2151-473f-8b3e-97a28891cbd6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 395, 'output_tokens': 11, 'total_tokens': 626, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 220}}
2025-10-06 03:48:41,068 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -c "import django"
2025-10-06 03:48:41,169 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:41,169 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:48:44,904 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'521987fe-3275-4a64-a773-c22c6a87a01f': 'CvUGAR/MhbZgT1mqAl3ccXhEzGXkytvoz984icmFU8HabAEkPX7DtJEj3xOYe/2AHPW5EM7fEWiquhaIu2fX8ChW9IcpqyneyppVkwrePi2kMsJ358x4BbmyZgDXNmR5XDiRyPeZa+nN6xjF7x6US+yKLaSjwZsBsXTIlqqy9YVyq82+0/GXoY6DE9s0sn/eih5RKv/iwFfPmeB1LBpDQldBGUk1z1aMA7Th3qfGJ23Q9BjoecaKBSg/zgxEn/RvZ1hD/nXw7rBGFwnelwTtykCQyXoSWIdqGXXYHEqhDOOxczOvzmfZUaVzBkET0kAJbAztm2vBuM4Xt1wGrnH6NE9aai7ncD8LvysXiyL/O1v97eJxy7HvEHhcaZ1uWiXGqRdWLmqFym5RwesW3h/Nv9uyBtSz/eC/sKGvgNvQihd/2YRFHg+wTs6TDh85N2oPeeYU+wbg/UJSuH1wywcc8Q7/+0vM3PuEqCNjamTCgq9oFMnqFPf8CLNBB+e5sShVEyQPa2quhk4R9roAI4q5txB58ajnM1gUwj7m3e9hKn6/Q1kSmpCs4nEXZBpdNzZz0tsYAHoBnbE2yjDW4tE0uY0aeSAUQUe/BvfNrCrlRZd+aL3zIB9MhlRwCtJbBaU6sLdd91T6tD+7UtmL1c7bOECr6i4GzyWRB0XQb5+zjxPt3lL81HZJNH0bYXTht/f6JMiAplbMdp59SFgG+N4Lu7kJOI7IEKuV2qmoNINBJZkGWprgENiJjFu6ObFP57HkHLD4dUWbT8a8ssKPvAZAu0+piU/i/gULYMM3Ipu/WI/wuLZp6yaIotIb6DNIHCfSwvEOgxvLFWI0mct7XguN1z3tiijPl6kv1TS8A1eFN5dUFgprY31myshppFXIptz2vd+nw3GNpsbL4XjI0NNswX8w8Xx5MqPDUhlGzcZR+DnF8HOSUo73IKvDA92B3z3IPdiCfG/CPXB3vpdEKK3KdSIfWdtwULdGSEK+ls2/1xzfBYUhLEgKs+rfnh2v4MOqCznHIpKm48QLxG+LxSUNe3/yN2zmc9EYBrNEK7gEW2CwuLw25dW4MKOsOkoeOBnGFu6RW7q8rqUCFJtlhOJT4QJUBCl589L19AfbwoRxh3wq+W09F/yBmUYD9UXKZQeAkiwGwMfPLDie3D9l0Chs61uIEsVYGQcu'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 411, 'candidates_token_count': 27, 'total_token_count': 678, 'prompt_tokens_details': [{'modality': 1, 'token_count': 733}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 240, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9051344836199725, 'model_name': 'gemini-2.5-pro'} id='run--0530997f-749d-4aa1-9f79-a284561969cb-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '521987fe-3275-4a64-a773-c22c6a87a01f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 411, 'output_tokens': 27, 'total_tokens': 678, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 240}}
2025-10-06 03:48:44,905 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m django test tests.admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:48:45,154 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:48:45,154 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 322, in run_from_argv
    parser = self.create_parser(argv[0], argv[1])
  File "/testbed/django/core/management/base.py", line 296, in create_parser
    self.add_arguments(parser)
  File "/testbed/django/core/management/commands/test.py", line 44, in add_arguments
    test_runner_class = get_runner(settings, self.test_runner)
  File "/testbed/django/test/utils.py", line 302, in get_runner
    test_runner_class = test_runner_class or settings.TEST_RUNNER
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 62, in _setup
    % (desc, ENVIRONMENT_VARIABLE))
django.core.exceptions.ImproperlyConfigured: Requested setting TEST_RUNNER, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

2025-10-06 03:48:46,578 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "find tests -name \\"settings.py\\""}'}, '__gemini_function_call_thought_signatures__': {'f403fac7-3aea-4596-a634-bf80409e99a0': 'CosCAR/MhbZmqMO5AQKeLRKKXsEKZwg4PMoHlWVHzZDA2bcV+zJ5d5NlydmnyhUKh0A9FPd1awtR/O3sfDoG/syS+9R0y1nCnJvSW6ZEZx3xYr9NFZqMObJi6zxls9VP8/hNbtwxdCkb17XF1ihPw3x9PMhpM6wLLW/8g/kRDdqwH+VOuItdC/Lt95ZBp30CKIEIT8maTnVVTy1UEHlkhjAz7mSl7trS3FK4281JMI/M77WGNgNUhAKODn5dXJJ6RSAOjixtnmNw1hgKSf6UDDLHoqC2z/tZzdx5lkgmojKIbxASIFDRKArEONrAPBzeg7aHjAza9m3o2XL9aKs+2NfDeIDpLo7uuYyNJLMm'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1000, 'candidates_token_count': 13, 'total_token_count': 1070, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1560}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 57, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.26367565301748425, 'model_name': 'gemini-2.5-pro'} id='run--13e3e1c5-0599-4fde-8852-d02677de78d5-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'find tests -name "settings.py"'}, 'id': 'f403fac7-3aea-4596-a634-bf80409e99a0', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1000, 'output_tokens': 13, 'total_tokens': 1070, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 57}}
2025-10-06 03:48:46,580 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: find tests -name "settings.py"
2025-10-06 03:48:46,681 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:46,681 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

tests/staticfiles_tests/settings.py
tests/admin_scripts/custom_templates/project_template/project_name/settings.py
tests/flatpages_tests/settings.py
tests/i18n/sampleproject/sampleproject/settings.py
tests/auth_tests/settings.py

2025-10-06 03:48:48,513 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tox.ini"}'}, '__gemini_function_call_thought_signatures__': {'b636cdb7-649e-47fe-b1d0-b93caf720e32': 'Cp0EAR/Mhba0p8Xwg5vTAv0BJvq5OKAY0EtLtIHpOgE5rKBDiwrLaxtZYTb4Pc/vrukFcvroGLWoOFdJdn5XTVhQxzEE0pw3QQ680AH7QfWvosHcc+NEpL4kUQAq24dYAp/PZrIPE8uhwa7QXAa3c2zY+ev7JVAp7Ixbi2UBEOm/yCeywrH92Oqcr6bTCPRtBsir/XD/3id4H8f5IAgZf0EuF8bHfcIIov5hrQuv5IAzMKysk39PnSZx6f6l6KgmHQh+27xa67SEq6BnT7Dg38ApcCoNAA8UEhv/2XpQXIvZp1WKz3SXpl+dpQlBjw96fjnRrU8k2QgbZCSRI4zBXPuNd8TGUmhkWX9DpNqMrhB/2UtZXnRMwYnEHEUf4ZnDNDeW4bonZ7N11J2wR+7vDwY13P8CKS5dZAujwoANgIq6s2En+uTPQqm66RxVJPtXc8kTjtdGFG2ACugA1oHWbXSrO6FeDiUrOjWM3DmFtSNyzq6x5X2Kki3ec6/318BWagqOhi7ZfWCEJ8/reqvDAUXyplZ9yqMIa0fy1zdRFmUsEe3gj1ANHyZ43winH5unUYiwEQdfS7PvnZAweFn8ODKO1oFojJJTnQmcgb/iBYFVM57ckeoG1oawXzxcSTUi+c1SIQMS1qqUyLAdro9TjFC/4MKbEPlIPqQ2RolOajHnpOQM7+flufi4u5AHAn/iyxEN75w1pRZXlsiGs0Jsbg=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1089, 'candidates_token_count': 8, 'total_token_count': 1237, 'cached_content_token_count': 1489, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1704}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1489}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 8}], 'thoughts_token_count': 140}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1253011226654053, 'model_name': 'gemini-2.5-pro'} id='run--c22f1a61-5d4b-4b24-b3b4-225c30d7b8b0-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tox.ini'}, 'id': 'b636cdb7-649e-47fe-b1d0-b93caf720e32', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1089, 'output_tokens': 8, 'total_tokens': 1237, 'input_token_details': {'cache_read': 1489}, 'output_token_details': {'reasoning': 140}}
2025-10-06 03:48:48,515 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tox.ini
2025-10-06 03:48:48,616 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:48,616 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

# Tox (https://tox.readthedocs.io/) is a tool for running tests in multiple
# virtualenvs. This configuration file helps to run the test suite on all
# supported Python versions. To use it, "python -m pip install tox" and
# then run "tox" from this directory.

[tox]
skipsdist = true
envlist =
    py3
    flake8
    docs
    isort

# Add environment to use the default python3 installation
[testenv:py3]
basepython = python3

[testenv]
usedevelop = true
# OBJC_DISABLE_INITIALIZE_FORK_SAFETY fixes hung tests for MacOS users. (#30806)
passenv = DJANGO_SETTINGS_MODULE PYTHONPATH HOME DISPLAY OBJC_DISABLE_INITIALIZE_FORK_SAFETY
setenv =
    PYTHONDONTWRITEBYTECODE=1
deps =
    py{3,36,37,38}: -rtests/requirements/py3.txt
    postgres: -rtests/requirements/postgres.txt
    mysql: -rtests/requirements/mysql.txt
    oracle: -rtests/requirements/oracle.txt
changedir = tests
commands =
    {envpython} runtests.py {posargs}

[testenv:flake8]
basepython = python3
usedevelop = false
deps = flake8
changedir = {toxinidir}
commands = flake8 .

[testenv:docs]
basepython = python3
usedevelop = false
whitelist_externals =
    make
deps =
    Sphinx
    pyenchant
    sphinxcontrib-spelling
changedir = docs
commands =
    make spelling

[testenv:isort]
basepython = python3
usedevelop = false
deps = isort
changedir = {toxinidir}
commands = isort --recursive --check-only --diff django tests scripts

[testenv:javascript]
usedevelop = false
deps =
changedir = {toxinidir}
whitelist_externals = npm
commands =
    npm install
    npm test

2025-10-06 03:48:54,198 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/runtests.py"}'}, '__gemini_function_call_thought_signatures__': {'804e65c1-d5ed-4c30-8474-f90fe32684b0': 'CpwFAR/MhbZj3IqklxfY9aScNPw/RrjWH4eSnEmdzgEBw2Yvhv93xRP/TKnIE+uJkapcnShXEjVyXt7gHcEvLNd3+wgG5uWKDfvV3ZhFQs4HDUefNAo3M+IbwqQhLE68znflVbFfDqv3GwB+8PgXJFiOPjPsD5qLrDlccrvvGxzZpZZKG7cS97s/Ds3tcwv8/iR5eoHK09Ov7pszHyxOOkBcvp7VghW0h7vAKezN/KRZMlp70WDd6/JG2vkIOTPWPk7S6eraq6mFQ07kJ2a2IweCytGouP8i6zJLem59uOMY6DWX7RwYd6OkrONY3pnpRrSEp01w7w370e+QZXhyGJ09BqHw5ZIEItGKpOI6eo63Hmgy5PtJO+QM+2WtIPc8FDqHFuWb/rOSZfK23jaBmsc7d/BoHj4oB2E223nXkFx9UiwXlyE1RTJRDlNmgnrFBp7e2f0IzJe/ZwRIE3JTX0SPRI788PSp8AZaxEG5LnJ4pd9OUSyn2+G5wwFi0W2/2zpuJHFA1TnmLBXXjFUAfzHZLo5DJWzr0dHfKCABD84tLJjx1sdq467hBLmc6R/q7Z96SFCHvpGE2OIhVySqEQ5Qs6bmOvMb0jze+4/sGOtaeB4aoNXmMGxK1Kh6bjFqeUi8lrxwLNpeffMwsB/x4gSD6BzHvDgmI1xhLeiZH80gw2vqvrl0JpzDnQjAMcKy/jrUaw2uX3DuFhw0OBPbN1Hw2w+iAkWNvPbuwSIPb9oXIgKrpJ1ydIk/J0LFhXOeiCX4/rgvg4KDuVri40eYEWfZ/YwMb9Lm7G1yIIp+1IV3Mt5qWTjaY2RY7OE0B/5+tfQsC5X7EIw6IiYPcc8zJdky85SJe3JI2ISEen5oouUr0EmQHClHjekecUPio90='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1577, 'candidates_token_count': 11, 'total_token_count': 2050, 'cached_content_token_count': 1559, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2330}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1559}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 11}], 'thoughts_token_count': 462}, 'finish_reason': 'STOP', 'avg_logprobs': -3.45385083285245, 'model_name': 'gemini-2.5-pro'} id='run--d7418e26-38b6-45b8-84ac-2ffbb0fe9be8-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/runtests.py'}, 'id': '804e65c1-d5ed-4c30-8474-f90fe32684b0', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1577, 'output_tokens': 11, 'total_tokens': 2050, 'input_token_details': {'cache_read': 1559}, 'output_token_details': {'reasoning': 462}}
2025-10-06 03:48:54,200 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/runtests.py
2025-10-06 03:48:54,303 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:48:54,303 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

#!/usr/bin/env python
import argparse
import atexit
import copy
import os
import shutil
import socket
import subprocess
import sys
import tempfile
import warnings

try:
    import django
except ImportError as e:
    raise RuntimeError(
        'Django module not found, reference tests/README.rst for instructions.'
    ) from e
else:
    from django.apps import apps
    from django.conf import settings
    from django.db import connection, connections
    from django.test import TestCase, TransactionTestCase
    from django.test.runner import default_test_processes
    from django.test.selenium import SeleniumTestCaseBase
    from django.test.utils import get_runner
    from django.utils.deprecation import RemovedInDjango40Warning
    from django.utils.log import DEFAULT_LOGGING
    from django.utils.version import PY37

try:
    import MySQLdb
except ImportError:
    pass
else:
    # Ignore informational warnings from QuerySet.explain().
    warnings.filterwarnings('ignore', r'\(1003, *', category=MySQLdb.Warning)

# Make deprecation warnings errors to ensure no usage of deprecated features.
warnings.simplefilter("error", RemovedInDjango40Warning)
# Make resource and runtime warning errors to ensure no usage of error prone
# patterns.
warnings.simplefilter("error", ResourceWarning)
warnings.simplefilter("error", RuntimeWarning)
# Ignore known warnings in test dependencies.
warnings.filterwarnings("ignore", "'U' mode is deprecated", DeprecationWarning, module='docutils.io')

RUNTESTS_DIR = os.path.abspath(os.path.dirname(__file__))

TEMPLATE_DIR = os.path.join(RUNTESTS_DIR, 'templates')

# Create a specific subdirectory for the duration of the test suite.
TMPDIR = tempfile.mkdtemp(prefix='django_')
# Set the TMPDIR environment variable in addition to tempfile.tempdir
# so that children processes inherit it.
tempfile.tempdir = os.environ['TMPDIR'] = TMPDIR

# Removing the temporary TMPDIR.
atexit.register(shutil.rmtree, TMPDIR)


SUBDIRS_TO_SKIP = [
    'data',
    'import_error_package',
    'test_runner_apps',
]

ALWAYS_INSTALLED_APPS = [
    'django.contrib.contenttypes',
    'django.contrib.auth',
    'django.contrib.sites',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.admin.apps.SimpleAdminConfig',
    'django.contrib.staticfiles',
]

ALWAYS_MIDDLEWARE = [
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
]

# Need to add the associated contrib app to INSTALLED_APPS in some cases to
# avoid "RuntimeError: Model class X doesn't declare an explicit app_label
# and isn't in an application in INSTALLED_APPS."
CONTRIB_TESTS_TO_APPS = {
    'flatpages_tests': 'django.contrib.flatpages',
    'redirects_tests': 'django.contrib.redirects',
}


def get_test_modules():
    modules = []
    discovery_paths = [(None, RUNTESTS_DIR)]
    if connection.features.gis_enabled:
        # GIS tests are in nested apps
        discovery_paths.append(('gis_tests', os.path.join(RUNTESTS_DIR, 'gis_tests')))
    else:
        SUBDIRS_TO_SKIP.append('gis_tests')

    for modpath, dirpath in discovery_paths:
        for f in os.scandir(dirpath):
            if ('.' not in f.name and
                    os.path.basename(f.name) not in SUBDIRS_TO_SKIP and
                    not f.is_file() and
                    os.path.exists(os.path.join(f.path, '__init__.py'))):
                modules.append((modpath, f.name))
    return modules


def get_installed():
    return [app_config.name for app_config in apps.get_app_configs()]


def setup(verbosity, test_labels, parallel, start_at, start_after):
    # Reduce the given test labels to just the app module path.
    test_labels_set = set()
    for label in test_labels:
        bits = label.split('.')[:1]
        test_labels_set.add('.'.join(bits))

    if verbosity >= 1:
        msg = "Testing against Django installed in '%s'" % os.path.dirname(django.__file__)
        max_parallel = default_test_processes() if parallel == 0 else parallel
        if max_parallel > 1:
            msg += " with up to %d processes" % max_parallel
        print(msg)

    # Force declaring available_apps in TransactionTestCase for faster tests.
    def no_available_apps(self):
        raise Exception("Please define available_apps in TransactionTestCase "
                        "and its subclasses.")
    TransactionTestCase.available_apps = property(no_available_apps)
    TestCase.available_apps = None

    state = {
        'INSTALLED_APPS': settings.INSTALLED_APPS,
        'ROOT_URLCONF': getattr(settings, "ROOT_URLCONF", ""),
        'TEMPLATES': settings.TEMPLATES,
        'LANGUAGE_CODE': settings.LANGUAGE_CODE,
        'STATIC_URL': settings.STATIC_URL,
        'STATIC_ROOT': settings.STATIC_ROOT,
        'MIDDLEWARE': settings.MIDDLEWARE,
    }

    # Redirect some settings for the duration of these tests.
    settings.INSTALLED_APPS = ALWAYS_INSTALLED_APPS
    settings.ROOT_URLCONF = 'urls'
    settings.STATIC_URL = '/static/'
    settings.STATIC_ROOT = os.path.join(TMPDIR, 'static')
    settings.TEMPLATES = [{
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [TEMPLATE_DIR],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    }]
    settings.LANGUAGE_CODE = 'en'
    settings.SITE_ID = 1
    settings.MIDDLEWARE = ALWAYS_MIDDLEWARE
    settings.MIGRATION_MODULES = {
        # This lets us skip creating migrations for the test models as many of
        # them depend on one of the following contrib applications.
        'auth': None,
        'contenttypes': None,
        'sessions': None,
    }
    log_config = copy.deepcopy(DEFAULT_LOGGING)
    # Filter out non-error logging so we don't have to capture it in lots of
    # tests.
    log_config['loggers']['django']['level'] = 'ERROR'
    settings.LOGGING = log_config
    settings.SILENCED_SYSTEM_CHECKS = [
        'fields.W342',  # ForeignKey(unique=True) -> OneToOneField
    ]

    # Load all the ALWAYS_INSTALLED_APPS.
    django.setup()

    # It would be nice to put this validation earlier but it must come after
    # django.setup() so that connection.features.gis_enabled can be accessed
    # without raising AppRegistryNotReady when running gis_tests in isolation
    # on some backends (e.g. PostGIS).
    if 'gis_tests' in test_labels_set and not connection.features.gis_enabled:
        print('Aborting: A GIS database backend is required to run gis_tests.')
        sys.exit(1)

    def _module_match_label(module_label, label):
        # Exact or ancestor match.
        return module_label == label or module_label.startswith(label + '.')

    # Load all the test model apps.
    test_modules = get_test_modules()

    found_start = not (start_at or start_after)
    installed_app_names = set(get_installed())
    for modpath, module_name in test_modules:
        if modpath:
            module_label = modpath + '.' + module_name
        else:
            module_label = module_name
        if not found_start:
            if start_at and _module_match_label(module_label, start_at):
                found_start = True
            elif start_after and _module_match_label(module_label, start_after):
                found_start = True
                continue
            else:
                continue
        # if the module (or an ancestor) was named on the command line, or
        # no modules were named (i.e., run all), import
        # this module and add it to INSTALLED_APPS.
        module_found_in_labels = not test_labels or any(
            _module_match_label(module_label, label) for label in test_labels_set
        )

        if module_name in CONTRIB_TESTS_TO_APPS and module_found_in_labels:
            settings.INSTALLED_APPS.append(CONTRIB_TESTS_TO_APPS[module_name])

        if module_found_in_labels and module_label not in installed_app_names:
            if verbosity >= 2:
                print("Importing application %s" % module_name)
            settings.INSTALLED_APPS.append(module_label)

    # Add contrib.gis to INSTALLED_APPS if needed (rather than requiring
    # @override_settings(INSTALLED_APPS=...) on all test cases.
    gis = 'django.contrib.gis'
    if connection.features.gis_enabled and gis not in settings.INSTALLED_APPS:
        if verbosity >= 2:
            print("Importing application %s" % gis)
        settings.INSTALLED_APPS.append(gis)

    apps.set_installed_apps(settings.INSTALLED_APPS)

    return state


def teardown(state):
    # Restore the old settings.
    for key, value in state.items():
        setattr(settings, key, value)
    # Discard the multiprocessing.util finalizer that tries to remove a
    # temporary directory that's already removed by this script's
    # atexit.register(shutil.rmtree, TMPDIR) handler. Prevents
    # FileNotFoundError at the end of a test run (#27890).
    from multiprocessing.util import _finalizer_registry
    _finalizer_registry.pop((-100, 0), None)


def actual_test_processes(parallel):
    if parallel == 0:
        # This doesn't work before django.setup() on some databases.
        if all(conn.features.can_clone_databases for conn in connections.all()):
            return default_test_processes()
        else:
            return 1
    else:
        return parallel


class ActionSelenium(argparse.Action):
    """
    Validate the comma-separated list of requested browsers.
    """
    def __call__(self, parser, namespace, values, option_string=None):
        browsers = values.split(',')
        for browser in browsers:
            try:
                SeleniumTestCaseBase.import_webdriver(browser)
            except ImportError:
                raise argparse.ArgumentError(self, "Selenium browser specification '%s' is not valid." % browser)
        setattr(namespace, self.dest, browsers)


def django_tests(verbosity, interactive, failfast, keepdb, reverse,
                 test_labels, debug_sql, parallel, tags, exclude_tags,
                 test_name_patterns, start_at, start_after, pdb, buffer):
    state = setup(verbosity, test_labels, parallel, start_at, start_after)
    extra_tests = []

    # Run the test suite, including the extra validation tests.
    if not hasattr(settings, 'TEST_RUNNER'):
        settings.TEST_RUNNER = 'django.test.runner.DiscoverRunner'
    TestRunner = get_runner(settings)

    test_runner = TestRunner(
        verbosity=verbosity,
        interactive=interactive,
        failfast=failfast,
        keepdb=keepdb,
        reverse=reverse,
        debug_sql=debug_sql,
        parallel=actual_test_processes(parallel),
        tags=tags,
        exclude_tags=exclude_tags,
        test_name_patterns=test_name_patterns,
        pdb=pdb,
        buffer=buffer,
    )
    failures = test_runner.run_tests(
        test_labels or get_installed(),
        extra_tests=extra_tests,
    )
    teardown(state)
    return failures


def get_subprocess_args(options):
    subprocess_args = [
        sys.executable, __file__, '--settings=%s' % options.settings
    ]
    if options.failfast:
        subprocess_args.append('--failfast')
    if options.verbosity:
        subprocess_args.append('--verbosity=%s' % options.verbosity)
    if not options.interactive:
        subprocess_args.append('--noinput')
    if options.tags:
        subprocess_args.append('--tag=%s' % options.tags)
    if options.exclude_tags:
        subprocess_args.append('--exclude_tag=%s' % options.exclude_tags)
    return subprocess_args


def bisect_tests(bisection_label, options, test_labels, parallel, start_at, start_after):
    state = setup(options.verbosity, test_labels, parallel, start_at, start_after)

    test_labels = test_labels or get_installed()

    print('***** Bisecting test suite: %s' % ' '.join(test_labels))

    # Make sure the bisection point isn't in the test list
    # Also remove tests that need to be run in specific combinations
    for label in [bisection_label, 'model_inheritance_same_model_name']:
        try:
            test_labels.remove(label)
        except ValueError:
            pass

    subprocess_args = get_subprocess_args(options)

    iteration = 1
    while len(test_labels) > 1:
        midpoint = len(test_labels) // 2
        test_labels_a = test_labels[:midpoint] + [bisection_label]
        test_labels_b = test_labels[midpoint:] + [bisection_label]
        print('***** Pass %da: Running the first half of the test suite' % iteration)
        print('***** Test labels: %s' % ' '.join(test_labels_a))
        failures_a = subprocess.run(subprocess_args + test_labels_a)

        print('***** Pass %db: Running the second half of the test suite' % iteration)
        print('***** Test labels: %s' % ' '.join(test_labels_b))
        print('')
        failures_b = subprocess.run(subprocess_args + test_labels_b)

        if failures_a.returncode and not failures_b.returncode:
            print("***** Problem found in first half. Bisecting again...")
            iteration += 1
            test_labels = test_labels_a[:-1]
        elif failures_b.returncode and not failures_a.returncode:
            print("***** Problem found in second half. Bisecting again...")
            iteration += 1
            test_labels = test_labels_b[:-1]
        elif failures_a.returncode and failures_b.returncode:
            print("***** Multiple sources of failure found")
            break
        else:
            print("***** No source of failure found... try pair execution (--pair)")
            break

    if len(test_labels) == 1:
        print("***** Source of error: %s" % test_labels[0])
    teardown(state)


def paired_tests(paired_test, options, test_labels, parallel, start_at, start_after):
    state = setup(options.verbosity, test_labels, parallel, start_at, start_after)

    test_labels = test_labels or get_installed()

    print('***** Trying paired execution')

    # Make sure the constant member of the pair isn't in the test list
    # Also remove tests that need to be run in specific combinations
    for label in [paired_test, 'model_inheritance_same_model_name']:
        try:
            test_labels.remove(label)
        except ValueError:
            pass

    subprocess_args = get_subprocess_args(options)

    for i, label in enumerate(test_labels):
        print('***** %d of %d: Check test pairing with %s' % (
              i + 1, len(test_labels), label))
        failures = subprocess.call(subprocess_args + [label, paired_test])
        if failures:
            print('***** Found problem pair with %s' % label)
            return

    print('***** No problem pair found')
    teardown(state)


if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Run the Django test suite.")
    parser.add_argument(
        'modules', nargs='*', metavar='module',
        help='Optional path(s) to test modules; e.g. "i18n" or '
             '"i18n.tests.TranslationTests.test_lazy_objects".',
    )
    parser.add_argument(
        '-v', '--verbosity', default=1, type=int, choices=[0, 1, 2, 3],
        help='Verbosity level; 0=minimal output, 1=normal output, 2=all output',
    )
    parser.add_argument(
        '--noinput', action='store_false', dest='interactive',
        help='Tells Django to NOT prompt the user for input of any kind.',
    )
    parser.add_argument(
        '--failfast', action='store_true',
        help='Tells Django to stop running the test suite after first failed test.',
    )
    parser.add_argument(
        '--keepdb', action='store_true',
        help='Tells Django to preserve the test database between runs.',
    )
    parser.add_argument(
        '--settings',
        help='Python path to settings module, e.g. "myproject.settings". If '
             'this isn\'t provided, either the DJANGO_SETTINGS_MODULE '
             'environment variable or "test_sqlite" will be used.',
    )
    parser.add_argument(
        '--bisect',
        help='Bisect the test suite to discover a test that causes a test '
             'failure when combined with the named test.',
    )
    parser.add_argument(
        '--pair',
        help='Run the test suite in pairs with the named test to find problem pairs.',
    )
    parser.add_argument(
        '--reverse', action='store_true',
        help='Sort test suites and test cases in opposite order to debug '
             'test side effects not apparent with normal execution lineup.',
    )
    parser.add_argument(
        '--selenium', action=ActionSelenium, metavar='BROWSERS',
        help='A comma-separated list of browsers to run the Selenium tests against.',
    )
    parser.add_argument(
        '--headless', action='store_true',
        help='Run selenium tests in headless mode, if the browser supports the option.',
    )
    parser.add_argument(
        '--selenium-hub',
        help='A URL for a selenium hub instance to use in combination with --selenium.',
    )
    parser.add_argument(
        '--external-host', default=socket.gethostname(),
        help='The external host that can be reached by the selenium hub instance when running Selenium '
             'tests via Selenium Hub.',
    )
    parser.add_argument(
        '--debug-sql', action='store_true',
        help='Turn on the SQL query logger within tests.',
    )
    parser.add_argument(
        '--parallel', nargs='?', default=0, type=int,
        const=default_test_processes(), metavar='N',
        help='Run tests using up to N parallel processes.',
    )
    parser.add_argument(
        '--tag', dest='tags', action='append',
        help='Run only tests with the specified tags. Can be used multiple times.',
    )
    parser.add_argument(
        '--exclude-tag', dest='exclude_tags', action='append',
        help='Do not run tests with the specified tag. Can be used multiple times.',
    )
    parser.add_argument(
        '--start-after', dest='start_after',
        help='Run tests starting after the specified top-level module.',
    )
    parser.add_argument(
        '--start-at', dest='start_at',
        help='Run tests starting at the specified top-level module.',
    )
    parser.add_argument(
        '--pdb', action='store_true',
        help='Runs the PDB debugger on error or failure.'
    )
    parser.add_argument(
        '-b', '--buffer', action='store_true',
        help='Discard output of passing tests.',
    )
    if PY37:
        parser.add_argument(
            '-k', dest='test_name_patterns', action='append',
            help=(
                'Only run test methods and classes matching test name pattern. '
                'Same as unittest -k option. Can be used multiple times.'
            ),
        )

    options = parser.parse_args()

    using_selenium_hub = options.selenium and options.selenium_hub
    if options.selenium_hub and not options.selenium:
        parser.error('--selenium-hub and --external-host require --selenium to be used.')
    if using_selenium_hub and not options.external_host:
        parser.error('--selenium-hub and --external-host must be used together.')

    # Allow including a trailing slash on app_labels for tab completion convenience
    options.modules = [os.path.normpath(labels) for labels in options.modules]

    mutually_exclusive_options = [options.start_at, options.start_after, options.modules]
    enabled_module_options = [bool(option) for option in mutually_exclusive_options].count(True)
    if enabled_module_options > 1:
        print('Aborting: --start-at, --start-after, and test labels are mutually exclusive.')
        sys.exit(1)
    for opt_name in ['start_at', 'start_after']:
        opt_val = getattr(options, opt_name)
        if opt_val:
            if '.' in opt_val:
                print('Aborting: --%s must be a top-level module.' % opt_name.replace('_', '-'))
                sys.exit(1)
            setattr(options, opt_name, os.path.normpath(opt_val))
    if options.settings:
        os.environ['DJANGO_SETTINGS_MODULE'] = options.settings
    else:
        os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'test_sqlite')
        options.settings = os.environ['DJANGO_SETTINGS_MODULE']

    if options.selenium:
        if not options.tags:
            options.tags = ['selenium']
        elif 'selenium' not in options.tags:
            options.tags.append('selenium')
        if options.selenium_hub:
            SeleniumTestCaseBase.selenium_hub = options.selenium_hub
            SeleniumTestCaseBase.external_host = options.external_host
        SeleniumTestCaseBase.headless = options.headless
        SeleniumTestCaseBase.browsers = options.selenium

    if options.bisect:
        bisect_tests(
            options.bisect, options, options.modules, options.parallel,
            options.start_at, options.start_after,
        )
    elif options.pair:
        paired_tests(
            options.pair, options, options.modules, options.parallel,
            options.start_at, options.start_after,
        )
    else:
        failures = django_tests(
            options.verbosity, options.interactive, options.failfast,
            options.keepdb, options.reverse, options.modules,
            options.debug_sql, options.parallel, options.tags,
            options.exclude_tags,
            getattr(options, 'test_name_patterns', None),
            options.start_at, options.start_after, options.pdb, options.buffer,
        )
        if failures:
            sys.exit(1)

2025-10-06 03:48:57,895 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'55647ba0-fb54-4e64-b219-a37e99a16e2d': 'CosIAR/Mhbbv955kcT4YqQ3Fz4pZu/HBwraid9jBQ8YMJLU0aXk0pyTD03hgfXym7hF32jmlQO/LToW2Yt/wwxEbgEOo8mpr9IeWQyt6K2RP7UqtWS9U3PP6LAAUibnmPM4sFWlnS4Ty5GoETqdkLhXoRD5M97klcHMrHdiRSwpyY4DHkh4Kbiy6McUH84rGh3RrB0kFV8e9pNBRPLHCRcwp9tH/2CrnezQOMVNTpc2LwXS+7AKPG+LnejUR0E0lKhe7BzEUp4g/H4LQNapjLMl8ed1sBnAsHCtH9ebPDNhjDDn06ToOpxmXjGnBBPH26uAkM0gP0Yw1jAIZaodN6fdPaib4jixPZmlyM5jjzqzdbKoPp6cWr1HwBg7Y9RNydOZFloIbddhQs1OHMI1J7kCiLluzooqrplF+aMdzEgb2EY6Tnutw7XUHA6WcENvraKNhTu9gjK1ECJNIWdi7p1NC7eAj5yWrxALrK74yLJ8XMiXIot2dceKCrnSE5u5e2Dc7azDu/BtSujPUqR7x4NJ/+a8DXpweRoYW6ixTkbxSPsLNc/AoVsrxrCQt1rN3jOADK7iXBB0NouPPU1vIbJRx1rxhUOdCCXhV8BTyucFESWISjmPGmkPEHzK3PZ492NZJnGBnug6hSUJescwjLsEo5WyYQ5//zfNN5LLqAaYH5d74dVRmu5vHHtbcJPOxb8GdMKX4HoJni9QywJr++Z8bqeJ0RCTAXrhstqX/FyybbqEpKBNZ3dXPp9MGq3V9x5ch8PMPF243mW0gAlpg2Qq0T57B1utsSawAlzm81auy3zu1zZ6Q3b72CjTiTVjZSpGV0Jf2XuSTwbF/7LcJibznhqawXXel+vkkSdhzPhSaDwI9G5xRuYBtP36DexfGsJfBwtqU7heZYcFpUkntSolWD9WxK5azeI6tL7cMvLdCaQNXGP9oVvpFgn0ofW1MidDhxVV6ZcdP+qI/Arvy3gi2JfGocIrSL0JBy4RJbnwbJ6IgJ4csjtkmPd0FAYYFfXSeN276oLlewK6CLfSDSPYXWLYb3gkKYNKYG5iiXoNuwIrXeVVyI1knv/GPssHKW+WRQEO2R1DCddHavCzLPqY0O3oyoUSvnCW6xEL7VRGPD+BZxrCBDF4zqdVwEt6NwgCEabGk+u+B8jovee+kAYGbQ3iBU0og2eTUAqEER6s37V1n+Qi3CF+i1GtXq4sCv7/YQGhFeg+ILT0Es+hywnVTGN2I3INCk2IOOy02FYKjxC6njjNltqN+6ehAR+aRclRlQj32LnX+wSY/GfkddG3152HvHqlPtnpmtk+f1VA22HyhEGCA9mTEZlYUiMPk1S7adaZsI2hg+EdkmXqDKJ833YmvbsVaH2NpfvJn'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7442, 'candidates_token_count': 27, 'total_token_count': 7754, 'cached_content_token_count': 1755, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8376}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1755}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 285}, 'finish_reason': 'STOP', 'avg_logprobs': -1.2210571854202836, 'model_name': 'gemini-2.5-pro'} id='run--d5074b59-4408-4d00-aa9a-25ee63fcf46d-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '55647ba0-fb54-4e64-b219-a37e99a16e2d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 7442, 'output_tokens': 27, 'total_tokens': 7754, 'input_token_details': {'cache_read': 1755}, 'output_token_details': {'reasoning': 285}}
2025-10-06 03:48:57,897 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:48:58,206 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:48:58,206 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_formfield_for_manytomany_widget_override (admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 50, in test_formfield_for_manytomany_widget_override
    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)
AttributeError: 'CheckboxSelectMultiple' object has no attribute 'widget'

----------------------------------------------------------------------
Ran 1 test in 0.001s

FAILED (errors=1)

2025-10-06 03:49:02,124 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='Testing against Django installed in \'/testbed/django\' with up to 8 processes\nSystem check identified no issues (0 silenced).\nE\n======================================================================\nERROR: test_formfield_for_manytomany_widget_override (admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 50, in test_formfield_for_manytomany_widget_override\n    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\nAttributeError: \'CheckboxSelectMultiple\' object has no attribute \'widget\'\n\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nFAILED (errors=1)' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 7675, 'candidates_token_count': 200, 'total_token_count': 8206, 'cached_content_token_count': 7043, 'prompt_tokens_details': [{'modality': 1, 'token_count': 8892}], 'cache_tokens_details': [{'modality': 1, 'token_count': 7043}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 200}], 'thoughts_token_count': 331}, 'finish_reason': 'STOP', 'avg_logprobs': -0.027049372196197508, 'model_name': 'gemini-2.5-pro'} id='run--8e8d0cdf-11e7-4a4b-b899-a2c34a3ef911-0' usage_metadata={'input_tokens': 7675, 'output_tokens': 200, 'total_tokens': 8206, 'input_token_details': {'cache_read': 7043}, 'output_token_details': {'reasoning': 331}}
2025-10-06 03:49:24,944 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='FAILED (errors=1)\nERROR: test_formfield_for_manytomany_widget_override (admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest)\nTraceback (most recent call last):\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 50, in test_formfield_for_manytomany_widget_override\n    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\nAttributeError: \'CheckboxSelectMultiple\' object has no attribute \'widget\'\n\nTest fails with AttributeError. The issue describes that the custom widget is ignored, which should result in an AssertionError because the default widget would be used. The AttributeError indicates the test is trying to access an attribute \'.widget\' on the custom widget, which means the custom widget was not ignored, but the test\'s check is incorrect. The failure mode does not match the bug description.' reproduced_bug_commands=['python tests/runtests.py admin_widgets.test_formfield_for_manytomany_widget']
2025-10-06 03:49:24,945 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-10-06 03:49:24,945 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-10-06 03:49:24,945 - thread-139660780025408.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-10-06 03:49:24,988 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED (errors=1)\nERROR: test_formfield_for_manytomany_widget_override (admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest)\nTraceback (most recent call last):\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 50, in test_formfield_for_manytomany_widget_override\n    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\nAttributeError: \'CheckboxSelectMultiple\' object has no attribute \'widget\'\n\nTest fails with AttributeError. The issue describes that the custom widget is ignored, which should result in an AssertionError because the default widget would be used. The AttributeError indicates the test is trying to access an attribute \'.widget\' on the custom widget, which means the custom widget was not ignored, but the test\'s check is incorrect. The failure mode does not match the bug description.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-10-06 03:50:30,315 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='My previous attempt failed with an `AttributeError` because my test setup was incomplete. The admin\'s `RelatedFieldWidgetWrapper`, which adds the green "+" icon next to relation fields, is only applied if the related model is registered with the admin site. Without registering the models, the wrapper was not used, and my test incorrectly tried to access a `.widget` attribute on an unwrapped widget object, causing the `AttributeError`. This masked the actual bug.\n\nThe bug itself is that `formfield_for_manytomany` ignores the `widget` keyword argument, instead using the default `SelectMultiple` widget.\n\nThe corrected test now performs the following steps:\n1.  It defines models with unique names to prevent `RuntimeError` conflicts.\n2.  It creates a dedicated `admin.AdminSite` instance for the test.\n3.  Crucially, it registers the models (`WidgetOverrideTestBand` and the related `WidgetOverrideTestMember`) with this site. This ensures the admin framework will apply the `RelatedFieldWidgetWrapper` to the many-to-many field\'s widget, which is a more realistic testing scenario.\n4.  It then calls `formfield_for_manytomany` with a custom widget (`CheckboxSelectMultiple`).\n5.  Due to the bug, the custom widget is ignored, and the default (`SelectMultiple`) is used and then wrapped.\n6.  The assertion now correctly inspects the *inner* widget of the wrapper (`field.widget.widget`). It will find a `SelectMultiple` instance instead of the expected `CheckboxSelectMultiple`, causing the test to fail with an `AssertionError` as desired, thus properly demonstrating the bug.\n\n```python\nfrom django import forms\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n# Define models with unique names and an isolated app_label to avoid conflicts\n# with any existing models in the test environment.\nclass WidgetOverrideTestMember(models.Model):\n    name = models.CharField(max_length=100)\n\n    class Meta:\n        app_label = \'admin_widgets_override\'\n\n    def __str__(self):\n        return self.name\n\nclass WidgetOverrideTestBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(WidgetOverrideTestMember)\n\n    class Meta:\n        app_label = \'admin_widgets_override\'\n\n    def __str__(self):\n        return self.name\n\n# Dummy ModelAdmin classes for registration.\nclass WidgetOverrideTestMemberAdmin(admin.ModelAdmin):\n    pass\n\nclass WidgetOverrideTestBandAdmin(admin.ModelAdmin):\n    pass\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    def setUp(self):\n        # Use a custom AdminSite instance to avoid interfering with the global\n        # admin site and to ensure a clean environment for the test.\n        self.site = admin.AdminSite()\n        # Register the models. This is crucial for the admin to add the\n        # RelatedFieldWidgetWrapper, which is necessary to correctly\n        # reproduce the environment where the bug occurs.\n        self.site.register(WidgetOverrideTestMember, WidgetOverrideTestMemberAdmin)\n        self.site.register(WidgetOverrideTestBand, WidgetOverrideTestBandAdmin)\n\n    def test_formfield_for_manytomany_widget_override(self):\n        """\n        formfield_for_manytomany() should respect a passed widget.\n        """\n        # Get the ModelAdmin instance from our custom site.\n        model_admin = self.site._registry[WidgetOverrideTestBand]\n        db_field = WidgetOverrideTestBand._meta.get_field(\'members\')\n\n        field = model_admin.formfield_for_manytomany(\n            db_field,\n            request=None,\n            widget=forms.CheckboxSelectMultiple,\n        )\n\n        # The bug is that the passed widget is ignored, and the default\n        # \'SelectMultiple\' widget is used instead. Because the related model\n        # is registered, the admin wraps this widget with\n        # \'RelatedFieldWidgetWrapper\' to add the UI for adding related objects.\n        #\n        # This assertion checks the inner widget of the wrapper. It will fail\n        # with an AssertionError because the actual widget will be an instance\n        # of \'SelectMultiple\', not the \'CheckboxSelectMultiple\' we passed in.\n        # This correctly demonstrates the bug.\n        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\n\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 7693, 'end_index': 7979, 'uri': 'https://github.com/amarksteadman/bambu-tools', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 16271, 'candidates_token_count': 1009, 'total_token_count': 24035, 'cached_content_token_count': 13892, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16271}], 'cache_tokens_details': [{'modality': 1, 'token_count': 13892}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1009}], 'thoughts_token_count': 6755}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0918217971847126, 'model_name': 'gemini-2.5-pro'} id='run--e37af617-7c00-4b97-9dfd-c5a29d0f20df-0' usage_metadata={'input_tokens': 16271, 'output_tokens': 1009, 'total_tokens': 24035, 'input_token_details': {'cache_read': 13892}, 'output_token_details': {'reasoning': 6755}}
2025-10-06 03:50:44,833 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "from django import forms\\nfrom django.contrib import admin\\nfrom django.contrib.admin import widgets\\nfrom django.db import models\\nfrom django.test import SimpleTestCase\\n\\n# Define models with unique names and an isolated app_label to avoid conflicts\\n# with any existing models in the test environment.\\nclass WidgetOverrideTestMember(models.Model):\\n    name = models.CharField(max_length=100)\\n\\n    class Meta:\\n        app_label = \'admin_widgets_override\'\\n\\n    def __str__(self):\\n        return self.name\\n\\nclass WidgetOverrideTestBand(models.Model):\\n    name = models.CharField(max_length=100)\\n    members = models.ManyToManyField(WidgetOverrideTestMember)\\n\\n    class Meta:\\n        app_label = \'admin_widgets_override\'\\n\\n    def __str__(self):\\n        return self.name\\n\\n# Dummy ModelAdmin classes for registration.\\nclass WidgetOverrideTestMemberAdmin(admin.ModelAdmin):\\n    pass\\n\\nclass WidgetOverrideTestBandAdmin(admin.ModelAdmin):\\n    pass\\n\\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\\n    def setUp(self):\\n        # Use a custom AdminSite instance to avoid interfering with the global\\n        # admin site and to ensure a clean environment for the test.\\n        self.site = admin.AdminSite()\\n        # Register the models. This is crucial for the admin to add the\\n        # RelatedFieldWidgetWrapper, which is necessary to correctly\\n        # reproduce the environment where the bug occurs.\\n        self.site.register(WidgetOverrideTestMember, WidgetOverrideTestMemberAdmin)\\n        self.site.register(WidgetOverrideTestBand, WidgetOverrideTestBandAdmin)\\n\\n    def test_formfield_for_manytomany_widget_override(self):\\n        \\"\\"\\"\\n        formfield_for_manytomany() should respect a passed widget.\\n        \\"\\"\\"\\n        # Get the ModelAdmin instance from our custom site.\\n        model_admin = self.site._registry[WidgetOverrideTestBand]\\n        db_field = WidgetOverrideTestBand._meta.get_field(\'members\')\\n\\n        field = model_admin.formfield_for_manytomany(\\n            db_field,\\n            request=None,\\n            widget=forms.CheckboxSelectMultiple,\\n        )\\n\\n        # The bug is that the passed widget is ignored, and the default\\n        # \'SelectMultiple\' widget is used instead. Because the related model\\n        # is registered, the admin wraps this widget with\\n        # \'RelatedFieldWidgetWrapper\' to add the UI for adding related objects.\\n        #\\n        # This assertion checks the inner widget of the wrapper. It will fail\\n        # with an AssertionError because the actual widget will be an instance\\n        # of \'SelectMultiple\', not the \'CheckboxSelectMultiple\' we passed in.\\n        # This correctly demonstrates the bug.\\n        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\\n", "relative_path": "tests/admin_widgets/test_formfield_for_manytomany_widget.py"}'}, '__gemini_function_call_thought_signatures__': {'87712700-7365-4c20-aca3-199123891a30': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 54313, 'candidates_token_count': 675, 'total_token_count': 56010, 'prompt_tokens_details': [{'modality': 1, 'token_count': 54313}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 675}], 'thoughts_token_count': 1022, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.21629448784722222, 'model_name': 'gemini-2.5-pro'} id='run--72dfef90-1878-48cf-8427-a8ebee0b70ed-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'from django import forms\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n# Define models with unique names and an isolated app_label to avoid conflicts\n# with any existing models in the test environment.\nclass WidgetOverrideTestMember(models.Model):\n    name = models.CharField(max_length=100)\n\n    class Meta:\n        app_label = \'admin_widgets_override\'\n\n    def __str__(self):\n        return self.name\n\nclass WidgetOverrideTestBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(WidgetOverrideTestMember)\n\n    class Meta:\n        app_label = \'admin_widgets_override\'\n\n    def __str__(self):\n        return self.name\n\n# Dummy ModelAdmin classes for registration.\nclass WidgetOverrideTestMemberAdmin(admin.ModelAdmin):\n    pass\n\nclass WidgetOverrideTestBandAdmin(admin.ModelAdmin):\n    pass\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    def setUp(self):\n        # Use a custom AdminSite instance to avoid interfering with the global\n        # admin site and to ensure a clean environment for the test.\n        self.site = admin.AdminSite()\n        # Register the models. This is crucial for the admin to add the\n        # RelatedFieldWidgetWrapper, which is necessary to correctly\n        # reproduce the environment where the bug occurs.\n        self.site.register(WidgetOverrideTestMember, WidgetOverrideTestMemberAdmin)\n        self.site.register(WidgetOverrideTestBand, WidgetOverrideTestBandAdmin)\n\n    def test_formfield_for_manytomany_widget_override(self):\n        """\n        formfield_for_manytomany() should respect a passed widget.\n        """\n        # Get the ModelAdmin instance from our custom site.\n        model_admin = self.site._registry[WidgetOverrideTestBand]\n        db_field = WidgetOverrideTestBand._meta.get_field(\'members\')\n\n        field = model_admin.formfield_for_manytomany(\n            db_field,\n            request=None,\n            widget=forms.CheckboxSelectMultiple,\n        )\n\n        # The bug is that the passed widget is ignored, and the default\n        # \'SelectMultiple\' widget is used instead. Because the related model\n        # is registered, the admin wraps this widget with\n        # \'RelatedFieldWidgetWrapper\' to add the UI for adding related objects.\n        #\n        # This assertion checks the inner widget of the wrapper. It will fail\n        # with an AssertionError because the actual widget will be an instance\n        # of \'SelectMultiple\', not the \'CheckboxSelectMultiple\' we passed in.\n        # This correctly demonstrates the bug.\n        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\n', 'relative_path': 'tests/admin_widgets/test_formfield_for_manytomany_widget.py'}, 'id': '87712700-7365-4c20-aca3-199123891a30', 'type': 'tool_call'}] usage_metadata={'input_tokens': 54313, 'output_tokens': 675, 'total_tokens': 56010, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1022}}
2025-10-06 03:50:46,285 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/admin_widgets/test_formfield_for_manytomany_widget.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55018, 'candidates_token_count': 20, 'total_token_count': 55038, 'cached_content_token_count': 52481, 'prompt_tokens_details': [{'modality': 1, 'token_count': 56038}], 'cache_tokens_details': [{'modality': 1, 'token_count': 52481}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -3.109812387265265e-05, 'model_name': 'gemini-2.5-pro'} id='run--c6c59576-e07f-495a-9d7c-4f8275d84d1a-0' usage_metadata={'input_tokens': 55018, 'output_tokens': 20, 'total_tokens': 55038, 'input_token_details': {'cache_read': 52481}}
2025-10-06 03:50:46,322 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/admin_widgets/test_formfield_for_manytomany_widget.py b/tests/admin_widgets/test_formfield_for_manytomany_widget.py
new file mode 100644
index 0000000000..353e696a0c
--- /dev/null
+++ b/tests/admin_widgets/test_formfield_for_manytomany_widget.py
@@ -0,0 +1,69 @@
+from django import forms
+from django.contrib import admin
+from django.contrib.admin import widgets
+from django.db import models
+from django.test import SimpleTestCase
+
+# Define models with unique names and an isolated app_label to avoid conflicts
+# with any existing models in the test environment.
+class WidgetOverrideTestMember(models.Model):
+    name = models.CharField(max_length=100)
+
+    class Meta:
+        app_label = 'admin_widgets_override'
+
+    def __str__(self):
+        return self.name
+
+class WidgetOverrideTestBand(models.Model):
+    name = models.CharField(max_length=100)
+    members = models.ManyToManyField(WidgetOverrideTestMember)
+
+    class Meta:
+        app_label = 'admin_widgets_override'
+
+    def __str__(self):
+        return self.name
+
+# Dummy ModelAdmin classes for registration.
+class WidgetOverrideTestMemberAdmin(admin.ModelAdmin):
+    pass
+
+class WidgetOverrideTestBandAdmin(admin.ModelAdmin):
+    pass
+
+class FormfieldForManyToManyWidgetTest(SimpleTestCase):
+    def setUp(self):
+        # Use a custom AdminSite instance to avoid interfering with the global
+        # admin site and to ensure a clean environment for the test.
+        self.site = admin.AdminSite()
+        # Register the models. This is crucial for the admin to add the
+        # RelatedFieldWidgetWrapper, which is necessary to correctly
+        # reproduce the environment where the bug occurs.
+        self.site.register(WidgetOverrideTestMember, WidgetOverrideTestMemberAdmin)
+        self.site.register(WidgetOverrideTestBand, WidgetOverrideTestBandAdmin)
+
+    def test_formfield_for_manytomany_widget_override(self):
+        """
+        formfield_for_manytomany() should respect a passed widget.
+        """
+        # Get the ModelAdmin instance from our custom site.
+        model_admin = self.site._registry[WidgetOverrideTestBand]
+        db_field = WidgetOverrideTestBand._meta.get_field('members')
+
+        field = model_admin.formfield_for_manytomany(
+            db_field,
+            request=None,
+            widget=forms.CheckboxSelectMultiple,
+        )
+
+        # The bug is that the passed widget is ignored, and the default
+        # 'SelectMultiple' widget is used instead. Because the related model
+        # is registered, the admin wraps this widget with
+        # 'RelatedFieldWidgetWrapper' to add the UI for adding related objects.
+        #
+        # This assertion checks the inner widget of the wrapper. It will fail
+        # with an AssertionError because the actual widget will be an instance
+        # of 'SelectMultiple', not the 'CheckboxSelectMultiple' we passed in.
+        # This correctly demonstrates the bug.
+        self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:50:46,322 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 03:50:46,356 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 03:50:46,356 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 03:50:46,456 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:50:46,456 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 5b884d45ac Fixed #29501 -- Allowed dbshell to pass options to underlying tool.

2025-10-06 03:50:46,456 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 03:50:46,557 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:50:46,557 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Removing tests/admin_widgets/test_formfield_for_manytomany_widget.py

2025-10-06 03:50:46,557 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 03:50:46,557 - thread-139660780025408.app.docker.base_container - INFO - Creating directory tests/admin_widgets in the container
2025-10-06 03:50:46,557 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/admin_widgets
2025-10-06 03:50:46,658 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:50:46,658 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:50:46,658 - thread-139660780025408.app.docker.base_container - INFO - Updating tests/admin_widgets/test_formfield_for_manytomany_widget.py in the container
2025-10-06 03:50:46,660 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 03:50:49,586 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python -m django test admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'ef709fbb-6966-41eb-b0ad-b6b15c37e1a6': 'CrkFAR/MhbZHX+u+hMosTiH7MhCwb8USswZHUFpDVP/vd8xDKpyLNJlg4DNZSBGaHEK1XOehRRFOtEMguphJSrenXaU5G4BiCRfAsxmdxjY92OG4R2Q5wUQlVwwbjN4dtLxCEBHZXYny9XGIsd6kWO5A/0W7wad2ql0KiBhQFsenlDlB3cpz5lvPsY8w5XEqenAxv+AP6cfnHu7ga7G+y+AiaZU55+r3TNx2ssY/RL02D2LhrpRTj9fPnEoEU9gGP7X6ljvp+Ek/SRiX8jVzEf7GE6fLWV1T31J/GRUl5jC58nULlQJE4NClIhIVpDCnfTg9MRyk8gY8mXovOmzDWcOJdjdaRrSQTdoF82U2XSBkheFTyCbPPwNwL0K2kVYOi34V2PTTBTo0FLWBJQC4SsRoSICnds7JlGgErI3LEIJiS3XqJHKVOssdtG3p4clqKFfcn3QFUHmHLuRe32YJglS0MKccwWQAX64yyN7U2+necumvQTFqOUNyCq7TjMDh2BP1Vk+8A74Wxnu3H1HrEak6W8uI4llXM17wZQj8mSwo5Zccor82o7hLYJJdHZ4ue2EU3e02PxoEA7v7mYW5vjDaM19oeUoiCvJfnjhvhOyV/MYcQalOtAf59nL0xB0i+/3HDIR7yZ4ucM25HjsOV5qgHBEwHp3/ppBhj1UPKtWQSVf3mJABWNIHqfLfYa3uZEGB1AKI/u3gBuIK/+YIuECHITKTafYxQpGfBavGxolh0XozoxdEKist5vbMH2FVjcH7jNPZS4Xv1AvmEEAae7z1zLST8cqFxq6lqr+TAW69Xu7DrVUZ/BlNQB5dZZyEdgsbknhv7Zq/eogtCT8fktzFpncs9iyb6gRqDPE//ac+OHdpJtRJwHjsa/qEugTWPMN2ez17574LIi0pUB0G0TXQzdXD1TW9npei7Q=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 303, 'candidates_token_count': 25, 'total_token_count': 510, 'prompt_tokens_details': [{'modality': 1, 'token_count': 303}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 182, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9422627258300781, 'model_name': 'gemini-2.5-pro'} id='run--6e9c7e59-cc44-4eb5-be5d-8fc9f1f67439-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python -m django test admin_widgets.test_formfield_for_manytomany_widget'}, 'id': 'ef709fbb-6966-41eb-b0ad-b6b15c37e1a6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 303, 'output_tokens': 25, 'total_tokens': 510, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 182}}
2025-10-06 03:50:49,587 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m django test admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:50:49,862 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:50:49,862 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 322, in run_from_argv
    parser = self.create_parser(argv[0], argv[1])
  File "/testbed/django/core/management/base.py", line 296, in create_parser
    self.add_arguments(parser)
  File "/testbed/django/core/management/commands/test.py", line 44, in add_arguments
    test_runner_class = get_runner(settings, self.test_runner)
  File "/testbed/django/test/utils.py", line 302, in get_runner
    test_runner_class = test_runner_class or settings.TEST_RUNNER
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 62, in _setup
    % (desc, ENVIRONMENT_VARIABLE))
django.core.exceptions.ImproperlyConfigured: Requested setting TEST_RUNNER, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

2025-10-06 03:50:51,645 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "DJANGO_SETTINGS_MODULE=tests.settings python -m django test admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'924f96a4-0cb5-4de2-8ef4-9e58019e4958': 'CuIDAR/MhbYUwUP0WLb30JmttUjimwD3vH0XXUazL+0bcxiPHHHoRFMbDIFPKjcPFNAqn7L0SuNDi0bQIHCoQiVxfFv7BoJP/69EiblCUTpJZNqYSVNDRiiC8hK7YcX0N3YFvuzq9xCBcGP/DtC4irIqeoMn2K+J2MsgB1Dy1g3aDPD/iFOjKSz2r+1iOS0U0TOiu3qqgu7OAaBES6VGZEpccCdv/sbdB/HwHmPZDKGU0XaI40ecw3ocl9ci0Eq5zPUfRs0t/+WWfegiYw40sshvXPbT1HDvgPRBYCc0KTGAV+H4Wh6zLYr9N4i4xiZ2KpPhV+2EDcvTXXlPb7EtBqW0yl/cRnZ33IUswOn0JHu0naes8iAsrzCw7n3TNt+gz058WYArI9uWsao3lV4SxrZPpznRrs1lMx3g7crM+fTzaDyNm1jg0wlrHcTBczc85Mto4QmWkLJ90FMwu4vt0xxjJ2N+NYJRuaZ/JMaOoVW3VehLh4tQiEcfphs39/rb0fDf19YYZxaKrq7LKTTuYqdz2OajAo63O5FrBBXd2UHFLa+qBgTxkTHLggwn6MtmJP0yqJmSoGlAVNakxe90psNv94MTnlLANNMgvWviOYHAPyTtLztHTDEQSW0qFU7JEZm4f9c='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 890, 'candidates_token_count': 34, 'total_token_count': 1038, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1070}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 34}], 'thoughts_token_count': 114, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.3274570633383358, 'model_name': 'gemini-2.5-pro'} id='run--e6cc5630-5b32-49b4-9a75-784f0fc3d069-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'DJANGO_SETTINGS_MODULE=tests.settings python -m django test admin_widgets.test_formfield_for_manytomany_widget'}, 'id': '924f96a4-0cb5-4de2-8ef4-9e58019e4958', 'type': 'tool_call'}] usage_metadata={'input_tokens': 890, 'output_tokens': 34, 'total_tokens': 1038, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 114}}
2025-10-06 03:50:51,647 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: DJANGO_SETTINGS_MODULE=tests.settings python -m django test admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:50:51,888 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:50:51,889 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 322, in run_from_argv
    parser = self.create_parser(argv[0], argv[1])
  File "/testbed/django/core/management/base.py", line 296, in create_parser
    self.add_arguments(parser)
  File "/testbed/django/core/management/commands/test.py", line 44, in add_arguments
    test_runner_class = get_runner(settings, self.test_runner)
  File "/testbed/django/test/utils.py", line 302, in get_runner
    test_runner_class = test_runner_class or settings.TEST_RUNNER
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 64, in _setup
    self._wrapped = Settings(settings_module)
  File "/testbed/django/conf/__init__.py", line 171, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 994, in _gcd_import
  File "<frozen importlib._bootstrap>", line 971, in _find_and_load
  File "<frozen importlib._bootstrap>", line 953, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'tests.settings'

2025-10-06 03:50:53,332 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests"}'}, '__gemini_function_call_thought_signatures__': {'fd85c039-68bb-4b4d-89fd-af4d732a7418': 'Cu8BAR/MhbbNtuUiVowKJ9i5cwlp+df3bFxlijLIS8//qIikt09nmEjdraOe2NJMMyWyuivzkCGNzIm5oRYl7C+CDgYNGHbAGHuei/ualIJ4m/rdvtNFM+a5XC1UWspi2O7qo8XmT4TN++A2gMaBeZ+tLGrutohff180ZfvVGVP47Rq3s4KgQ6MphJRaCdhJ8/URKz/1KqVkwR6lvdEeo0Ldx5md09TDp5UlgiKvxaydwoH+4SVbXG8SA2tyiytmvZW7qr5zkMNrzbmSUj4UUc8XgEH+rbz7TttxLhcyOefAr2YAodsKGEg/kC6jHPMhwHk='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1621, 'candidates_token_count': 6, 'total_token_count': 1679, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1913}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 6}], 'thoughts_token_count': 52, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.9135126272837321, 'model_name': 'gemini-2.5-pro'} id='run--57cc84da-156d-4cd7-8a09-c8f279b52469-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests'}, 'id': 'fd85c039-68bb-4b4d-89fd-af4d732a7418', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1621, 'output_tokens': 6, 'total_tokens': 1679, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 52}}
2025-10-06 03:50:53,333 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests
2025-10-06 03:50:53,434 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:50:53,434 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

absolute_url_overrides	     mail
admin_autodiscover	     managers_regress
admin_changelist	     many_to_many
admin_checks		     many_to_one
admin_custom_urls	     many_to_one_null
admin_default_site	     max_lengths
admin_docs		     messages_tests
admin_filters		     middleware
admin_inlines		     middleware_exceptions
admin_ordering		     migrate_signals
admin_registration	     migrations
admin_scripts		     migrations2
admin_utils		     migration_test_data_persistence
admin_views		     modeladmin
admin_widgets		     model_enums
aggregation		     model_fields
aggregation_regress	     model_forms
annotations		     model_formsets
app_loading		     model_formsets_regress
apps			     model_indexes
asgi			     model_inheritance
async			     model_inheritance_regress
auth_tests		     model_meta
backends		     model_options
base			     model_package
bash_completion		     model_regress
basic			     multiple_database
builtin_server		     mutually_referential
bulk_create		     nested_foreign_keys
cache			     no_models
check_framework		     null_fk
conditional_processing	     null_fk_ordering
constraints		     null_queries
contenttypes_tests	     one_to_one
context_processors	     ordering
csrf_tests		     order_with_respect_to
custom_columns		     or_lookups
custom_lookups		     pagination
custom_managers		     postgres_tests
custom_methods		     prefetch_related
custom_migration_operations  project_template
custom_pk		     properties
datatypes		     proxy_model_inheritance
dates			     proxy_models
datetimes		     __pycache__
db_functions		     queries
dbshell			     queryset_pickle
db_typecasts		     raw_query
db_utils		     README.rst
decorators		     redirects_tests
defer			     requests
defer_regress		     requirements
delete			     reserved_names
delete_regress		     resolve_url
deprecation		     responses
dispatch		     reverse_lookup
distinct_on_fields	     runtests.py
empty			     save_delete_hooks
empty_models		     schema
expressions		     select_for_update
expressions_case	     select_related
expressions_window	     select_related_onetoone
extra_regress		     select_related_regress
field_deconstruction	     serializers
field_defaults		     servers
field_subclassing	     sessions_tests
files			     settings_tests
file_storage		     shell
file_uploads		     shortcuts
filtered_relation	     signals
fixtures		     signed_cookies_tests
fixtures_model_package	     signing
fixtures_regress	     sitemaps_tests
flatpages_tests		     sites_framework
force_insert_update	     sites_tests
foreign_object		     staticfiles_tests
forms_tests		     str
from_db_value		     string_lookup
generic_inline_admin	     swappable_models
generic_relations	     syndication_tests
generic_relations_regress    template_backends
generic_views		     template_loader
get_earliest_or_latest	     templates
get_object_or_404	     template_tests
get_or_create		     test_client
gis_tests		     test_client_regress
handlers		     test_exceptions
httpwrappers		     test_runner
humanize_tests		     test_runner_apps
i18n			     test_sqlite.py
import_error_package	     test_utils
indexes			     timezones
inline_formsets		     transaction_hooks
inspectdb		     transactions
introspection		     unmanaged_models
invalid_models_tests	     update
known_related_objects	     update_only_fields
logging_tests		     urlpatterns
lookup			     urlpatterns_reverse
m2m_and_m2o		     urls.py
m2m_intermediary	     user_commands
m2m_multiple		     utils_tests
m2m_recursive		     validation
m2m_regress		     validators
m2m_signals		     version
m2m_through		     view_tests
m2m_through_regress	     wsgi
m2o_recursive

2025-10-06 03:50:54,951 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --help"}'}, '__gemini_function_call_thought_signatures__': {'a56ac132-ef17-4160-857b-4c41e28b31b9': 'CpACAR/MhbbGxnE5ypmvnjkjOXromaoiXNZgfkFSG9GoeLJxYiM94mHBfT5Wqb8lGQhmx2Zr0hUqMiFRq2+/jx8R8BHriP/+YqEMkXF2Kn/bxEi0nwa3qly/4cMWTk1OYcJ4FeAnmY/lOJr8iRNe9NljbNzKgNS3hEP9xqxyyEhcbra6nc+5Fgr41kq4IKEY0RQzs5Qup3Z9NO3Khk/Tq//aIEdxF3XU/WLb0FvCRZumm74SuhsMvgAx2tNBWnGJAYTIIyl4k5gMPcPC3NIJELVJtA2jXqZY3mooHJur1eTUuK8/rjhL5PIE3JmGHT/6hdqSRPEsPSpvkICJ8HU+1awIYTBMusiHuhbzVPJPt5onaNw='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2642, 'candidates_token_count': 13, 'total_token_count': 2728, 'cached_content_token_count': 1524, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2984}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1524}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 73}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5953841209411621, 'model_name': 'gemini-2.5-pro'} id='run--768fe91b-0940-4105-988b-fc4ec9ffb5d7-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --help'}, 'id': 'a56ac132-ef17-4160-857b-4c41e28b31b9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2642, 'output_tokens': 13, 'total_tokens': 2728, 'input_token_details': {'cache_read': 1524}, 'output_token_details': {'reasoning': 73}}
2025-10-06 03:50:54,953 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --help
2025-10-06 03:50:55,198 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:50:55,198 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kp

usage: runtests.py [-h] [-v {0,1,2,3}] [--noinput] [--failfast] [--keepdb]
                   [--settings SETTINGS] [--bisect BISECT] [--pair PAIR]
                   [--reverse] [--selenium BROWSERS] [--headless]
                   [--selenium-hub SELENIUM_HUB]
                   [--external-host EXTERNAL_HOST] [--debug-sql]
                   [--parallel [N]] [--tag TAGS] [--exclude-tag EXCLUDE_TAGS]
                   [--start-after START_AFTER] [--start-at START_AT] [--pdb]
                   [-b]
                   [module [module ...]]

Run the Django test suite.

positional arguments:
  module                Optional path(s) to test modules; e.g. "i18n" or
                        "i18n.tests.TranslationTests.test_lazy_objects".

optional arguments:
  -h, --help            show this help message and exit
  -v {0,1,2,3}, --verbosity {0,1,2,3}
                        Verbosity level; 0=minimal output, 1=normal output,
                        2=all output
  --noinput             Tells Django to NOT prompt the user for input of any
                        kind.
  --failfast            Tells Django to stop running the test suite after
                        first failed test.
  --keepdb              Tells Django to preserve the test database between
                        runs.
  --settings SETTINGS   Python path to settings module, e.g.
                        "myproject.settings". If this isn't provided, either
                        the DJANGO_SETTINGS_MODULE environment variable or
                        "test_sqlite" will be used.
  --bisect BISECT       Bisect the test suite to discover a test that causes a
                        test failure when combined with the named test.
  --pair PAIR           Run the test suite in pairs with the named test to
                        find problem pairs.
  --reverse             Sort test suites and test cases in opposite order to
                        debug test side effects not apparent with normal
                        execution lineup.
  --selenium BROWSERS   A comma-separated list of browsers to run the Selenium
                        tests against.
  --headless            Run selenium tests in headless mode, if the browser
                        supports the option.
  --selenium-hub SELENIUM_HUB
                        A URL for a selenium hub instance to use in
                        combination with --selenium.
  --external-host EXTERNAL_HOST
                        The external host that can be reached by the selenium
                        hub instance when running Selenium tests via Selenium
                        Hub.
  --debug-sql           Turn on the SQL query logger within tests.
  --parallel [N]        Run tests using up to N parallel processes.
  --tag TAGS            Run only tests with the specified tags. Can be used
                        multiple times.
  --exclude-tag EXCLUDE_TAGS
                        Do not run tests with the specified tag. Can be used
                        multiple times.
  --start-after START_AFTER
                        Run tests starting after the specified top-level
                        module.
  --start-at START_AT   Run tests starting at the specified top-level module.
  --pdb                 Runs the PDB debugger on error or failure.
  -b, --buffer          Discard output of passing tests.

2025-10-06 03:50:57,935 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --noinput --settings=test_sqlite admin_widgets.test_formfield_for_manytomany_widget"}'}, '__gemini_function_call_thought_signatures__': {'a3c8911d-4bda-4952-b99b-eb95c96e579e': 'CrwEAR/MhbbYL1CpZOQ6MthHkn1wh1HfYU+Ke7J11SiDoJcyGt4nl3f9eSxiBs/+kBkCaSD/IuAR5wApCJgSVHbtd8x8P2iH/uPVj9HZOrqX64c1Gf5WlwVtDaC7MMq99R4Mp1TzTQwV9xBhmw4Xu8xO9ZLcU6APm9YZZ6QIjt2k+axQuKWNBNimMzdGVg4iZhx5/KYFVS1I/O0mt/Gd5dfVnX37rI1JqmjRa1KVsEhrvKOmn/ZzCo5n7C2s44muqu0clG7XliXTXkonEGP3o0gTkeBN9pC5JnVhvW+8MxDYp8W6OGT1mX0eYua7HsZTZR19IDhU9Fd+fU6wOpfENFkyGCWvPxH+BB/MoPU0HnALNH54cwOOFiwGdpKY5ndzwHFK9HHA6VI4LTRVaQ5oHR8Mibboe+lBNji7xtW3j/w7aDkkLuDZF1gLOWGA1BuWz443n823+hneek/2vcbbl/FtwV3yO9MnbL+yf8jJs50lYMrns72e2iWFJsobJnJT6brDGK1RU/D2PeNdkDZ/8RDThTAAKXHmHgsj2nA2NeNBAZ4QB3UJ6R6Txqyzyc6b1Ugz0h1shYX+Wql+HObuH+C1+AgrC0cANTv5B2ZESLnvUf3mW1wSmhG59HLTV1cnbXkfk4OdQvqAEvT2VO6uCvSJLlQ85IivgUQp+O9c9th3bx7v4jZPxph1fg0rF9TZAzngGMzBhvwOLd89YAIt5KMF6RHx7XwEK+LcB+lYi9RMEb68nEWnKh2KR+oQ27U='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3649, 'candidates_token_count': 36, 'total_token_count': 3840, 'cached_content_token_count': 1538, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4061}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1538}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 36}], 'thoughts_token_count': 155}, 'finish_reason': 'STOP', 'avg_logprobs': -0.42128584120008683, 'model_name': 'gemini-2.5-pro'} id='run--07b2892f-da6d-4b4e-bb25-b5240e662f08-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --noinput --settings=test_sqlite admin_widgets.test_formfield_for_manytomany_widget'}, 'id': 'a3c8911d-4bda-4952-b99b-eb95c96e579e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3649, 'output_tokens': 36, 'total_tokens': 3840, 'input_token_details': {'cache_read': 1538}, 'output_token_details': {'reasoning': 155}}
2025-10-06 03:50:57,937 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --noinput --settings=test_sqlite admin_widgets.test_formfield_for_manytomany_widget
2025-10-06 03:50:58,272 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:50:58,272 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_formfield_for_manytomany_widget_override (admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 69, in test_formfield_for_manytomany_widget_override
    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)
AttributeError: 'CheckboxSelectMultiple' object has no attribute 'widget'

----------------------------------------------------------------------
Ran 1 test in 0.001s

FAILED (errors=1)

2025-10-06 03:51:00,921 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='I have executed the test file `tests/admin_widgets/test_formfield_for_manytomany_widget.py` as requested. Here is the output:\n\n```\nTesting against Django installed in \'/testbed/django\' with up to 8 processes\nSystem check identified no issues (0 silenced).\nE\n======================================================================\nERROR: test_formfield_for_manytomany_widget_override (admin_widgets.test_formfield_for_manytomany_widget.FormfieldForManyToManyWidgetTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 69, in test_formfield_for_manytomany_widget_override\n    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\nAttributeError: \'CheckboxSelectMultiple\' object has no attribute \'widget\'\n\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nFAILED (errors=1)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3891, 'candidates_token_count': 241, 'total_token_count': 4175, 'cached_content_token_count': 3118, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4456}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3118}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 241}], 'thoughts_token_count': 43}, 'finish_reason': 'STOP', 'avg_logprobs': -0.035419468068482965, 'model_name': 'gemini-2.5-pro'} id='run--13ec4cb5-2ef0-4362-94ca-0429241438b9-0' usage_metadata={'input_tokens': 3891, 'output_tokens': 241, 'total_tokens': 4175, 'input_token_details': {'cache_read': 3118}, 'output_token_details': {'reasoning': 43}}
2025-10-06 03:51:19,833 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='FAILED tests/admin_widgets/test_formfield_for_manytomany_widget.py\n\nTraceback (most recent call last):\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 69, in test_formfield_for_manytomany_widget_override\n    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\nAttributeError: \'CheckboxSelectMultiple\' object has no attribute \'widget\'\n\nThe test fails with an `AttributeError`, but it should fail with an `AssertionError` to correctly demonstrate the bug. The bug description states that the custom widget passed to `formfield_for_manytomany` is ignored. The test expects to find the default `SelectMultiple` widget, which would cause `assertIsInstance` to fail.\n\nHowever, the `AttributeError` indicates that `field.widget` is a `CheckboxSelectMultiple` instance (the custom widget), which does not have a nested `.widget` attribute. This means the custom widget was *not* ignored, and the test is failing due to an incorrect assumption about the widget being wrapped, rather than because of the actual bug described.' reproduced_bug_commands=['python -m django test admin_widgets.test_formfield_for_manytomany_widget']
2025-10-06 03:51:19,834 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-10-06 03:51:19,834 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-10-06 03:51:19,834 - thread-139660780025408.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-10-06 03:51:19,877 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED tests/admin_widgets/test_formfield_for_manytomany_widget.py\n\nTraceback (most recent call last):\n  File "/testbed/tests/admin_widgets/test_formfield_for_manytomany_widget.py", line 69, in test_formfield_for_manytomany_widget_override\n    self.assertIsInstance(field.widget.widget, forms.CheckboxSelectMultiple)\nAttributeError: \'CheckboxSelectMultiple\' object has no attribute \'widget\'\n\nThe test fails with an `AttributeError`, but it should fail with an `AssertionError` to correctly demonstrate the bug. The bug description states that the custom widget passed to `formfield_for_manytomany` is ignored. The test expects to find the default `SelectMultiple` widget, which would cause `assertIsInstance` to fail.\n\nHowever, the `AttributeError` indicates that `field.widget` is a `CheckboxSelectMultiple` instance (the custom widget), which does not have a nested `.widget` attribute. This means the custom widget was *not* ignored, and the test is failing due to an incorrect assumption about the widget being wrapped, rather than because of the actual bug described.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-10-06 03:52:30,988 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='My analysis of the previous failures was flawed. The `AttributeError` from the last attempt correctly indicated that the custom widget (`CheckboxSelectMultiple`) was being used, but my test assertion (`field.widget.widget`) was wrong because the widget was not being wrapped by `RelatedFieldWidgetWrapper` in that specific test setup. This led me to incorrectly believe the bug was elsewhere.\n\nThe actual bug, revealed by studying the patch that fixed it, only occurs under a specific condition: when the many-to-many field is also listed in `filter_horizontal` or `filter_vertical` on the `ModelAdmin`. In the original buggy code, the logic for `filter_horizontal` would unconditionally overwrite any widget passed in `kwargs`, ignoring the user\'s customization. The fix was to add a check to see if a widget was already present in `kwargs` before applying the `FilteredSelectMultiple` widget.\n\nThis new test case correctly reproduces these conditions:\n1.  It defines a `ModelAdmin` where the `members` field is included in `filter_horizontal`.\n2.  It overrides `formfield_for_manytomany` to inject a custom `CheckboxSelectMultiple` widget into the `kwargs` before calling `super()`.\n3.  It calls `formfield_for_dbfield`, the correct entry point for the admin to generate a field.\n4.  The buggy `super().formfield_for_manytomany` call ignores the provided `CheckboxSelectMultiple` and overwrites it with `FilteredSelectMultiple` because the field is in `filter_horizontal`.\n5.  The final form field\'s widget is a `RelatedFieldWidgetWrapper` containing `FilteredSelectMultiple`.\n6.  The assertion `self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)` will now fail with an `AssertionError`, because the inner widget is `FilteredSelectMultiple`, not the one we provided. This correctly demonstrates the bug.\n\n```python\nfrom django import forms\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n# Define models with unique names to avoid conflicts.\nclass M2MWidgetBugMember(models.Model):\n    name = models.CharField(max_length=100)\n    class Meta:\n        app_label = \'m2m_widget_bug\'\n\nclass M2MWidgetBugBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(M2MWidgetBugMember)\n    class Meta:\n        app_label = \'m2m_widget_bug\'\n\n# This ModelAdmin reproduces the conditions for the bug.\nclass BandAdmin(admin.ModelAdmin):\n    # By adding \'members\' to filter_horizontal, we trigger the buggy code path\n    # in the original ModelAdmin.formfield_for_manytomany.\n    filter_horizontal = (\'members\',)\n\n    # The user scenario involves overriding this method to provide a custom widget.\n    def formfield_for_manytomany(self, db_field, request, **kwargs):\n        if db_field.name == \'members\':\n            # The custom widget is supplied via kwargs.\n            kwargs[\'widget\'] = forms.CheckboxSelectMultiple\n        # The super() call invokes the buggy implementation.\n        return super().formfield_for_manytomany(db_field, request, **kwargs)\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    def test_m2m_widget_override_with_filter_horizontal(self):\n        """\n        formfield_for_manytomany() should respect a passed widget even when\n        filter_horizontal is used.\n        """\n        site = admin.AdminSite()\n        # Registering models is necessary for RelatedFieldWidgetWrapper to be applied.\n        site.register(M2MWidgetBugMember)\n        site.register(M2MWidgetBugBand, BandAdmin)\n\n        model_admin = site._registry[M2MWidgetBugBand]\n        db_field = M2MWidgetBugBand._meta.get_field(\'members\')\n\n        # Use formfield_for_dbfield() as the entry point to simulate the admin.\n        form_field = model_admin.formfield_for_dbfield(db_field, request=None)\n\n        # The bug: The base formfield_for_manytomany overwrites the widget from\n        # kwargs with FilteredSelectMultiple because \'members\' is in\n        # filter_horizontal, without checking if a widget is already present.\n        #\n        # The assertion below will fail because the inner widget will be\n        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.\n        # This results in the desired AssertionError.\n        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 17585, 'candidates_token_count': 1074, 'total_token_count': 26183, 'cached_content_token_count': 15902, 'prompt_tokens_details': [{'modality': 1, 'token_count': 17585}], 'cache_tokens_details': [{'modality': 1, 'token_count': 15902}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1074}], 'thoughts_token_count': 7524}, 'finish_reason': 'STOP', 'avg_logprobs': -1.07789859025838, 'model_name': 'gemini-2.5-pro'} id='run--4a4d2782-e66f-430d-ad17-97e3367a946b-0' usage_metadata={'input_tokens': 17585, 'output_tokens': 1074, 'total_tokens': 26183, 'input_token_details': {'cache_read': 15902}, 'output_token_details': {'reasoning': 7524}}
2025-10-06 03:52:59,733 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "from django import forms\\nfrom django.contrib import admin\\nfrom django.contrib.admin import widgets\\nfrom django.db import models\\nfrom django.test import SimpleTestCase\\n\\n# Define models with unique names to avoid conflicts.\\nclass M2MWidgetBugMember(models.Model):\\n    name = models.CharField(max_length=100)\\n    class Meta:\\n        app_label = \'m2m_widget_bug\'\\n\\nclass M2MWidgetBugBand(models.Model):\\n    name = models.CharField(max_length=100)\\n    members = models.ManyToManyField(M2MWidgetBugMember)\\n    class Meta:\\n        app_label = \'m2m_widget_bug\'\\n\\n# This ModelAdmin reproduces the conditions for the bug.\\nclass BandAdmin(admin.ModelAdmin):\\n    # By adding \'members\' to filter_horizontal, we trigger the buggy code path\\n    # in the original ModelAdmin.formfield_for_manytomany.\\n    filter_horizontal = (\'members\',)\\n\\n    # The user scenario involves overriding this method to provide a custom widget.\\n    def formfield_for_manytomany(self, db_field, request, **kwargs):\\n        if db_field.name == \'members\':\\n            # The custom widget is supplied via kwargs.\\n            kwargs[\'widget\'] = forms.CheckboxSelectMultiple\\n        # The super() call invokes the buggy implementation.\\n        return super().formfield_for_manytomany(db_field, request, **kwargs)\\n\\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\\n    def test_m2m_widget_override_with_filter_horizontal(self):\\n        \\"\\"\\"\\n        formfield_for_manytomany() should respect a passed widget even when\\n        filter_horizontal is used.\\n        \\"\\"\\"\\n        site = admin.AdminSite()\\n        # Registering models is necessary for RelatedFieldWidgetWrapper to be applied.\\n        site.register(M2MWidgetBugMember)\\n        site.register(M2MWidgetBugBand, BandAdmin)\\n\\n        model_admin = site._registry[M2MWidgetBugBand]\\n        db_field = M2MWidgetBugBand._meta.get_field(\'members\')\\n\\n        # Use formfield_for_dbfield() as the entry point to simulate the admin.\\n        form_field = model_admin.formfield_for_dbfield(db_field, request=None)\\n\\n        # The bug: The base formfield_for_manytomany overwrites the widget from\\n        # kwargs with FilteredSelectMultiple because \'members\' is in\\n        # filter_horizontal, without checking if a widget is already present.\\n        #\\n        # The assertion below will fail because the inner widget will be\\n        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.\\n        # This results in the desired AssertionError.\\n        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)\\n", "relative_path": "tests/modeladmin/test_formfield_for_manytomany.py"}'}, '__gemini_function_call_thought_signatures__': {'711a19ff-fd41-4960-9367-eac8e4beaf3b': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 54378, 'candidates_token_count': 681, 'total_token_count': 57924, 'prompt_tokens_details': [{'modality': 1, 'token_count': 54378}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 681}], 'thoughts_token_count': 2865, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.4776519013571494, 'model_name': 'gemini-2.5-pro'} id='run--cfea73a9-9c3e-4a87-afbb-c5e32db1619c-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'from django import forms\nfrom django.contrib import admin\nfrom django.contrib.admin import widgets\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n# Define models with unique names to avoid conflicts.\nclass M2MWidgetBugMember(models.Model):\n    name = models.CharField(max_length=100)\n    class Meta:\n        app_label = \'m2m_widget_bug\'\n\nclass M2MWidgetBugBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(M2MWidgetBugMember)\n    class Meta:\n        app_label = \'m2m_widget_bug\'\n\n# This ModelAdmin reproduces the conditions for the bug.\nclass BandAdmin(admin.ModelAdmin):\n    # By adding \'members\' to filter_horizontal, we trigger the buggy code path\n    # in the original ModelAdmin.formfield_for_manytomany.\n    filter_horizontal = (\'members\',)\n\n    # The user scenario involves overriding this method to provide a custom widget.\n    def formfield_for_manytomany(self, db_field, request, **kwargs):\n        if db_field.name == \'members\':\n            # The custom widget is supplied via kwargs.\n            kwargs[\'widget\'] = forms.CheckboxSelectMultiple\n        # The super() call invokes the buggy implementation.\n        return super().formfield_for_manytomany(db_field, request, **kwargs)\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    def test_m2m_widget_override_with_filter_horizontal(self):\n        """\n        formfield_for_manytomany() should respect a passed widget even when\n        filter_horizontal is used.\n        """\n        site = admin.AdminSite()\n        # Registering models is necessary for RelatedFieldWidgetWrapper to be applied.\n        site.register(M2MWidgetBugMember)\n        site.register(M2MWidgetBugBand, BandAdmin)\n\n        model_admin = site._registry[M2MWidgetBugBand]\n        db_field = M2MWidgetBugBand._meta.get_field(\'members\')\n\n        # Use formfield_for_dbfield() as the entry point to simulate the admin.\n        form_field = model_admin.formfield_for_dbfield(db_field, request=None)\n\n        # The bug: The base formfield_for_manytomany overwrites the widget from\n        # kwargs with FilteredSelectMultiple because \'members\' is in\n        # filter_horizontal, without checking if a widget is already present.\n        #\n        # The assertion below will fail because the inner widget will be\n        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.\n        # This results in the desired AssertionError.\n        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)\n', 'relative_path': 'tests/modeladmin/test_formfield_for_manytomany.py'}, 'id': '711a19ff-fd41-4960-9367-eac8e4beaf3b', 'type': 'tool_call'}] usage_metadata={'input_tokens': 54378, 'output_tokens': 681, 'total_tokens': 57924, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2865}}
2025-10-06 03:53:01,030 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/modeladmin/test_formfield_for_manytomany.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55087, 'candidates_token_count': 18, 'total_token_count': 55105, 'cached_content_token_count': 52510, 'prompt_tokens_details': [{'modality': 1, 'token_count': 57950}], 'cache_tokens_details': [{'modality': 1, 'token_count': 52510}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 18}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -6.509836869857584e-06, 'model_name': 'gemini-2.5-pro'} id='run--a7984177-7ebe-43c3-bd2c-3e8e9e78aa71-0' usage_metadata={'input_tokens': 55087, 'output_tokens': 18, 'total_tokens': 55105, 'input_token_details': {'cache_read': 52510}}
2025-10-06 03:53:01,066 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/modeladmin/test_formfield_for_manytomany.py b/tests/modeladmin/test_formfield_for_manytomany.py
new file mode 100644
index 0000000000..f8bbcfa3c5
--- /dev/null
+++ b/tests/modeladmin/test_formfield_for_manytomany.py
@@ -0,0 +1,57 @@
+from django import forms
+from django.contrib import admin
+from django.contrib.admin import widgets
+from django.db import models
+from django.test import SimpleTestCase
+
+# Define models with unique names to avoid conflicts.
+class M2MWidgetBugMember(models.Model):
+    name = models.CharField(max_length=100)
+    class Meta:
+        app_label = 'm2m_widget_bug'
+
+class M2MWidgetBugBand(models.Model):
+    name = models.CharField(max_length=100)
+    members = models.ManyToManyField(M2MWidgetBugMember)
+    class Meta:
+        app_label = 'm2m_widget_bug'
+
+# This ModelAdmin reproduces the conditions for the bug.
+class BandAdmin(admin.ModelAdmin):
+    # By adding 'members' to filter_horizontal, we trigger the buggy code path
+    # in the original ModelAdmin.formfield_for_manytomany.
+    filter_horizontal = ('members',)
+
+    # The user scenario involves overriding this method to provide a custom widget.
+    def formfield_for_manytomany(self, db_field, request, **kwargs):
+        if db_field.name == 'members':
+            # The custom widget is supplied via kwargs.
+            kwargs['widget'] = forms.CheckboxSelectMultiple
+        # The super() call invokes the buggy implementation.
+        return super().formfield_for_manytomany(db_field, request, **kwargs)
+
+class FormfieldForManyToManyWidgetTest(SimpleTestCase):
+    def test_m2m_widget_override_with_filter_horizontal(self):
+        """
+        formfield_for_manytomany() should respect a passed widget even when
+        filter_horizontal is used.
+        """
+        site = admin.AdminSite()
+        # Registering models is necessary for RelatedFieldWidgetWrapper to be applied.
+        site.register(M2MWidgetBugMember)
+        site.register(M2MWidgetBugBand, BandAdmin)
+
+        model_admin = site._registry[M2MWidgetBugBand]
+        db_field = M2MWidgetBugBand._meta.get_field('members')
+
+        # Use formfield_for_dbfield() as the entry point to simulate the admin.
+        form_field = model_admin.formfield_for_dbfield(db_field, request=None)
+
+        # The bug: The base formfield_for_manytomany overwrites the widget from
+        # kwargs with FilteredSelectMultiple because 'members' is in
+        # filter_horizontal, without checking if a widget is already present.
+        #
+        # The assertion below will fail because the inner widget will be
+        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.
+        # This results in the desired AssertionError.
+        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:53:01,067 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 03:53:01,100 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 03:53:01,101 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 03:53:01,201 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:53:01,201 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 5b884d45ac Fixed #29501 -- Allowed dbshell to pass options to underlying tool.

2025-10-06 03:53:01,201 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 03:53:01,302 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:53:01,302 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Removing tests/admin_widgets/test_formfield_for_manytomany_widget.py

2025-10-06 03:53:01,302 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 03:53:01,302 - thread-139660780025408.app.docker.base_container - INFO - Creating directory tests/modeladmin in the container
2025-10-06 03:53:01,302 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/modeladmin
2025-10-06 03:53:01,403 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:53:01,403 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:53:01,403 - thread-139660780025408.app.docker.base_container - INFO - Updating tests/modeladmin/test_formfield_for_manytomany.py in the container
2025-10-06 03:53:01,405 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 03:53:03,312 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests"}'}, '__gemini_function_call_thought_signatures__': {'65e061c1-9802-4731-bfd3-818ba7e4231f': 'Cr4DAR/MhbaxEy3I6BGcV3T3484HfVapYdFbwJSg+Odu5hDM2UOokHOAfB+bnJ+Gf9Ql8WGN52fc2XwdsfW4Y9f45rdRwD2zRXfPNLPsFmGqMXBaSCWiPa0xihoO4ncyvIXUtvgMI17y0PStwKs1jOPi5XFPrUkGih2OPZDZ+q8/rZUx9eZnXr9ffn7l13CnBVNmzOpNNUro2pertUfUc19VAWIUwkxbjmisHo0PSjQJo15WZUutPU7Ehx6kI93eAA4JK+IQSfGV6R0gbZECMj7r6iJsXLhJIGbp89qgdnoVRE1kUq++OhcxBwC1f3hGuwQTmKflnJEWSm7E1CLCmYP56Bmnko8UMQ7njQ1wsp41zQRx/otqTkg0NB0NFKfXPItgXK11ZjLW3Vne4iswxmlKaGZjTHoVxkUtaPQybcdOfHz+sRv0mrXqjiL2mOVg6OtaX1Cm1GJM6SXDHUUHcFnUyOQ9wmEl8M2Tqy3M7mPeJWhrSq9ydZ48FKXLRh2+UEWOsi765JGSB+3okJVpMfPNhJYCSMST1z7Pw/02x1IhSMIulUDRlUSGgIFI9J8JXqb4E9VpaKeE+mnt22HlVx8='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 301, 'candidates_token_count': 6, 'total_token_count': 408, 'prompt_tokens_details': [{'modality': 1, 'token_count': 301}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 6}], 'thoughts_token_count': 101, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.931930144627889, 'model_name': 'gemini-2.5-pro'} id='run--8c03da61-7d30-414a-9b07-183e4c943ccd-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests'}, 'id': '65e061c1-9802-4731-bfd3-818ba7e4231f', 'type': 'tool_call'}] usage_metadata={'input_tokens': 301, 'output_tokens': 6, 'total_tokens': 408, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 101}}
2025-10-06 03:53:03,314 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests
2025-10-06 03:53:03,414 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:53:03,415 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

absolute_url_overrides	     mail
admin_autodiscover	     managers_regress
admin_changelist	     many_to_many
admin_checks		     many_to_one
admin_custom_urls	     many_to_one_null
admin_default_site	     max_lengths
admin_docs		     messages_tests
admin_filters		     middleware
admin_inlines		     middleware_exceptions
admin_ordering		     migrate_signals
admin_registration	     migrations
admin_scripts		     migrations2
admin_utils		     migration_test_data_persistence
admin_views		     modeladmin
admin_widgets		     model_enums
aggregation		     model_fields
aggregation_regress	     model_forms
annotations		     model_formsets
app_loading		     model_formsets_regress
apps			     model_indexes
asgi			     model_inheritance
async			     model_inheritance_regress
auth_tests		     model_meta
backends		     model_options
base			     model_package
bash_completion		     model_regress
basic			     multiple_database
builtin_server		     mutually_referential
bulk_create		     nested_foreign_keys
cache			     no_models
check_framework		     null_fk
conditional_processing	     null_fk_ordering
constraints		     null_queries
contenttypes_tests	     one_to_one
context_processors	     ordering
csrf_tests		     order_with_respect_to
custom_columns		     or_lookups
custom_lookups		     pagination
custom_managers		     postgres_tests
custom_methods		     prefetch_related
custom_migration_operations  project_template
custom_pk		     properties
datatypes		     proxy_model_inheritance
dates			     proxy_models
datetimes		     __pycache__
db_functions		     queries
dbshell			     queryset_pickle
db_typecasts		     raw_query
db_utils		     README.rst
decorators		     redirects_tests
defer			     requests
defer_regress		     requirements
delete			     reserved_names
delete_regress		     resolve_url
deprecation		     responses
dispatch		     reverse_lookup
distinct_on_fields	     runtests.py
empty			     save_delete_hooks
empty_models		     schema
expressions		     select_for_update
expressions_case	     select_related
expressions_window	     select_related_onetoone
extra_regress		     select_related_regress
field_deconstruction	     serializers
field_defaults		     servers
field_subclassing	     sessions_tests
files			     settings_tests
file_storage		     shell
file_uploads		     shortcuts
filtered_relation	     signals
fixtures		     signed_cookies_tests
fixtures_model_package	     signing
fixtures_regress	     sitemaps_tests
flatpages_tests		     sites_framework
force_insert_update	     sites_tests
foreign_object		     staticfiles_tests
forms_tests		     str
from_db_value		     string_lookup
generic_inline_admin	     swappable_models
generic_relations	     syndication_tests
generic_relations_regress    template_backends
generic_views		     template_loader
get_earliest_or_latest	     templates
get_object_or_404	     template_tests
get_or_create		     test_client
gis_tests		     test_client_regress
handlers		     test_exceptions
httpwrappers		     test_runner
humanize_tests		     test_runner_apps
i18n			     test_sqlite.py
import_error_package	     test_utils
indexes			     timezones
inline_formsets		     transaction_hooks
inspectdb		     transactions
introspection		     unmanaged_models
invalid_models_tests	     update
known_related_objects	     update_only_fields
logging_tests		     urlpatterns
lookup			     urlpatterns_reverse
m2m_and_m2o		     urls.py
m2m_intermediary	     user_commands
m2m_multiple		     utils_tests
m2m_recursive		     validation
m2m_regress		     validators
m2m_signals		     version
m2m_through		     view_tests
m2m_through_regress	     wsgi
m2o_recursive

2025-10-06 03:53:05,090 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py --help"}'}, '__gemini_function_call_thought_signatures__': {'7c02cc4d-ed7e-492a-b86e-ff1904c16268': 'CuoCAR/Mhbbm24DYGLz2uy/XbUlyGx3iZlOJxt+rC8ItyKmTuWpiyeUZi6cousj8KpgD4utTPuOyPcjtSAXx3GVGDdHKt8hN94gpzU48k4wZuo8uvCdIetXOWv7IMZFGR59UjzCLV+B+z1TPxfYZm21gz58/Hn50vxvfW4h5qJzQXklPWle71vnDLRsYUH6cgu7UYySkX+dQtIkLmzKf1q4+aAD48tESkBq1OaQul9glwP36dmbMymPx4y0BxlU6Uv7bfm5Fy3phTj/q+4UP6z+dsmDFx9xzI5hrXP2bJdFyo/rVTHEfCnmcvSuwng2OMAHRzjDqgxvuHhf1VzKoETm+XHa6W75hRFUjKA53jwAcIFPkSbBrLPi3VEXPKLxHBUs1b4frqv++wFJUXv87G2XWPduttyU3sZQiDkVZ/nAMt6E0MoqlO1hapxrGAemtFUrE3jVL3XTTnF9X53CsLBGGkkClunJDmHpuPL4='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1322, 'candidates_token_count': 13, 'total_token_count': 1433, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1421}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 98, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.42109991953923154, 'model_name': 'gemini-2.5-pro'} id='run--7019305b-aeec-4ed0-b87e-45d3bb6d7eb1-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py --help'}, 'id': '7c02cc4d-ed7e-492a-b86e-ff1904c16268', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1322, 'output_tokens': 13, 'total_tokens': 1433, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 98}}
2025-10-06 03:53:05,092 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py --help
2025-10-06 03:53:05,337 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:53:05,337 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
[A[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[Kp

usage: runtests.py [-h] [-v {0,1,2,3}] [--noinput] [--failfast] [--keepdb]
                   [--settings SETTINGS] [--bisect BISECT] [--pair PAIR]
                   [--reverse] [--selenium BROWSERS] [--headless]
                   [--selenium-hub SELENIUM_HUB]
                   [--external-host EXTERNAL_HOST] [--debug-sql]
                   [--parallel [N]] [--tag TAGS] [--exclude-tag EXCLUDE_TAGS]
                   [--start-after START_AFTER] [--start-at START_AT] [--pdb]
                   [-b]
                   [module [module ...]]

Run the Django test suite.

positional arguments:
  module                Optional path(s) to test modules; e.g. "i18n" or
                        "i18n.tests.TranslationTests.test_lazy_objects".

optional arguments:
  -h, --help            show this help message and exit
  -v {0,1,2,3}, --verbosity {0,1,2,3}
                        Verbosity level; 0=minimal output, 1=normal output,
                        2=all output
  --noinput             Tells Django to NOT prompt the user for input of any
                        kind.
  --failfast            Tells Django to stop running the test suite after
                        first failed test.
  --keepdb              Tells Django to preserve the test database between
                        runs.
  --settings SETTINGS   Python path to settings module, e.g.
                        "myproject.settings". If this isn't provided, either
                        the DJANGO_SETTINGS_MODULE environment variable or
                        "test_sqlite" will be used.
  --bisect BISECT       Bisect the test suite to discover a test that causes a
                        test failure when combined with the named test.
  --pair PAIR           Run the test suite in pairs with the named test to
                        find problem pairs.
  --reverse             Sort test suites and test cases in opposite order to
                        debug test side effects not apparent with normal
                        execution lineup.
  --selenium BROWSERS   A comma-separated list of browsers to run the Selenium
                        tests against.
  --headless            Run selenium tests in headless mode, if the browser
                        supports the option.
  --selenium-hub SELENIUM_HUB
                        A URL for a selenium hub instance to use in
                        combination with --selenium.
  --external-host EXTERNAL_HOST
                        The external host that can be reached by the selenium
                        hub instance when running Selenium tests via Selenium
                        Hub.
  --debug-sql           Turn on the SQL query logger within tests.
  --parallel [N]        Run tests using up to N parallel processes.
  --tag TAGS            Run only tests with the specified tags. Can be used
                        multiple times.
  --exclude-tag EXCLUDE_TAGS
                        Do not run tests with the specified tag. Can be used
                        multiple times.
  --start-after START_AFTER
                        Run tests starting after the specified top-level
                        module.
  --start-at START_AT   Run tests starting at the specified top-level module.
  --pdb                 Runs the PDB debugger on error or failure.
  -b, --buffer          Discard output of passing tests.

2025-10-06 03:53:08,271 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py modeladmin.test_formfield_for_manytomany"}'}, '__gemini_function_call_thought_signatures__': {'09b353ea-199b-4d1f-bbf8-186ae54e2614': 'CpgDAR/MhbYomnJMOoDc8B584J6j+mJlw48Emk3xumUtvjiVVp5Jx9QowFcp73JbMWuBCF0QDZnZF/JxtcKIE9xFC7KETUlyWPx8DDD3eG5crDmgGKfvNoiupTnq0csr7ufXIxizYvsHfmvMqbMGOOL5Aa50lqkuVKJuBAI10G+qGzYflFQOnuDu0JvuQR8CsxxsdlPP9psh1lbHDIjPFwauZv006TnUOButiOgyTjK0n/j91w09SvmshF7aAS8HY8itURZpwKejV6vJW2vuibFkTUu2K9PzdvRb1FoPf0cnDD2OS462AgdiKG37Kr89xRh4u50+ZP6UP0lcZ2iOesRCEqXuPl/6+tMC9CopNRdjjpZAze63gilau4dEHhErJ5yWKCtLoJMsMBeuQPhy6LnhPMT3wCpiX+4dneTAY0tGyCr8EbHtbWLnfDHYNP7amBLwwPqfjlR8U0o2XW9kQ9JbJZW/LETz00exS4Oy8/saaD5ivHUIS9EdDaxZE+G/9naS4TIXkM5VZIZO8UFjAQDCr77a7AuX5BCK'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2329, 'candidates_token_count': 25, 'total_token_count': 2464, 'cached_content_token_count': 1385, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2524}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1385}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 110}, 'finish_reason': 'STOP', 'avg_logprobs': -0.36715892791748045, 'model_name': 'gemini-2.5-pro'} id='run--77f42a9b-766b-408d-8827-2ec6b4962155-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py modeladmin.test_formfield_for_manytomany'}, 'id': '09b353ea-199b-4d1f-bbf8-186ae54e2614', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2329, 'output_tokens': 25, 'total_tokens': 2464, 'input_token_details': {'cache_read': 1385}, 'output_token_details': {'reasoning': 110}}
2025-10-06 03:53:08,273 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py modeladmin.test_formfield_for_manytomany
2025-10-06 03:53:08,570 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:53:08,570 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_m2m_widget_override_with_filter_horizontal (modeladmin.test_formfield_for_manytomany.FormfieldForManyToManyWidgetTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/modeladmin/test_formfield_for_manytomany.py", line 48, in test_m2m_widget_override_with_filter_horizontal
    form_field = model_admin.formfield_for_dbfield(db_field, request=None)
  File "/testbed/django/contrib/admin/options.py", line 166, in formfield_for_dbfield
    can_add_related=related_modeladmin.has_add_permission(request),
  File "/testbed/django/contrib/admin/options.py", line 473, in has_add_permission
    return request.user.has_perm("%s.%s" % (opts.app_label, codename))
AttributeError: 'NoneType' object has no attribute 'user'

----------------------------------------------------------------------
Ran 1 test in 0.001s

FAILED (errors=1)

2025-10-06 03:53:11,750 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "cat tests/modeladmin/test_formfield_for_manytomany.py"}'}, '__gemini_function_call_thought_signatures__': {'13b9b073-4242-4266-9e75-fb119eb31daf': 'CvAGAR/MhbZGee4EbOcB8Ju6g8L9AmAxNH/PUNyr6QIFuw0k+jswJCkWSYlzs/ypKAgAxPAqA4J4gFa2zgEUCGKY0v88QkYGIw7tK/PK4mWbYemubi0SAFZN4mrwOLYU88TlXoSCuSP/S5srKLjaoEnsSzWpReqHlY0iqDRf4nghxSstlJIrtvyNiroL8gLszAs94HnE2NN6p5UPIU39nnCbtRqgo8giIFgfwEv+HphBSL/G/vs566F/WHFcecgXPZSgOMl4l7Trhc+MvbmHSOjvrWweuXpKjukARuhPNyW/ba0xXoBA/j6M5B9HEgHTuHS6rxuPWoTEMlRMw6nQMMUNzH2AhhH3Uii7Fjb1/sujT2N2SlPu7AsPwGAQ7BeY8aoBjDc9IQLx2mjoTf8+HQwH0XvxwkSpSZbrqrPDipy855fqyX8r992g2+5UEkRE9yqbrHRMQeccf0fO3fJMRX7MEY0zVBZK8oGfuU6n6CUrN4SWCDoXJdA7kwUjq1IyH2IvX0rDmEvcA8izXlrTk7AFwPxiJhOZG8GYbFR1DOk1GRzT6VqTqLxYufFEu1skxt7Y77LwuYwTA/Ja5FJuWx45q7CMNCmhP1D3DpXlumVZyyrT2aL2W5DQ8Ru51bx1lmo3CuRQh6Pm1Yrn4KKWmFqNzl0ORkD9XpvP7nMx+O/1VtB8weyk4HjPqQ63zoijY2T9mqkOOohI0xuLGOsi09COT7CW2ufHS0QuKJMGuonkDLbWGV2pOqagcNgcMXtnM0wh1dEC0qR0rKeIAvUKTyrg31wctqXeAZwuOQr+jQtHk6opVBEuwOEEsCz5VnJpI5OdrQS8AE7kiOWxZROzBW9bFrpbQcO3KWGDpvQAg/gyYjqBzDJR8z7Dmtpv2xx5yhnBmI/u1CX+yIiCOVJIIXfUZsYQiyv25BmSmv1Njr/qSbgLRjq2/8yMvFsFSq6GSlIV0UPJ1jhJajYsZC/esZ+VNstey8AWj+5xVgBjpKRZjB9zMZRB8L06eO+wFjESNSgZ1kfjdCtUqYJ4VHb9zp4F5vr/xVJOVTCbOVor2R6Ei5s/4hVFl/rejBb7cHmDHsZqpvHGnBdaoWD4VkUAF8jjeDe3YWKc4s0Z54cfNo4i6mLZvLRE733vdkqeiqkvvonCWH9A+ifevRpnQeupgyfBGA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2672, 'candidates_token_count': 23, 'total_token_count': 2916, 'cached_content_token_count': 1439, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2975}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1439}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 23}], 'thoughts_token_count': 221}, 'finish_reason': 'STOP', 'avg_logprobs': -1.142260675844939, 'model_name': 'gemini-2.5-pro'} id='run--d1dbf325-15bc-4c62-95f2-48896f49fb4b-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'cat tests/modeladmin/test_formfield_for_manytomany.py'}, 'id': '13b9b073-4242-4266-9e75-fb119eb31daf', 'type': 'tool_call'}] usage_metadata={'input_tokens': 2672, 'output_tokens': 23, 'total_tokens': 2916, 'input_token_details': {'cache_read': 1439}, 'output_token_details': {'reasoning': 221}}
2025-10-06 03:53:11,752 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: cat tests/modeladmin/test_formfield_for_manytomany.py
2025-10-06 03:53:11,852 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:53:11,852 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

from django import forms
from django.contrib import admin
from django.contrib.admin import widgets
from django.db import models
from django.test import SimpleTestCase

# Define models with unique names to avoid conflicts.
class M2MWidgetBugMember(models.Model):
    name = models.CharField(max_length=100)
    class Meta:
        app_label = 'm2m_widget_bug'

class M2MWidgetBugBand(models.Model):
    name = models.CharField(max_length=100)
    members = models.ManyToManyField(M2MWidgetBugMember)
    class Meta:
        app_label = 'm2m_widget_bug'

# This ModelAdmin reproduces the conditions for the bug.
class BandAdmin(admin.ModelAdmin):
    # By adding 'members' to filter_horizontal, we trigger the buggy code path
    # in the original ModelAdmin.formfield_for_manytomany.
    filter_horizontal = ('members',)

    # The user scenario involves overriding this method to provide a custom widget.
    def formfield_for_manytomany(self, db_field, request, **kwargs):
        if db_field.name == 'members':
            # The custom widget is supplied via kwargs.
            kwargs['widget'] = forms.CheckboxSelectMultiple
        # The super() call invokes the buggy implementation.
        return super().formfield_for_manytomany(db_field, request, **kwargs)

class FormfieldForManyToManyWidgetTest(SimpleTestCase):
    def test_m2m_widget_override_with_filter_horizontal(self):
        """
        formfield_for_manytomany() should respect a passed widget even when
        filter_horizontal is used.
        """
        site = admin.AdminSite()
        # Registering models is necessary for RelatedFieldWidgetWrapper to be applied.
        site.register(M2MWidgetBugMember)
        site.register(M2MWidgetBugBand, BandAdmin)

        model_admin = site._registry[M2MWidgetBugBand]
        db_field = M2MWidgetBugBand._meta.get_field('members')

        # Use formfield_for_dbfield() as the entry point to simulate the admin.
        form_field = model_admin.formfield_for_dbfield(db_field, request=None)

        # The bug: The base formfield_for_manytomany overwrites the widget from
        # kwargs with FilteredSelectMultiple because 'members' is in
        # filter_horizontal, without checking if a widget is already present.
        #
        # The assertion below will fail because the inner widget will be
        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.
        # This results in the desired AssertionError.
        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:53:18,920 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py modeladmin.test_formfield_for_manytomany"}'}, '__gemini_function_call_thought_signatures__': {'f5647f25-5ef6-4581-b425-56dfa22a7265': 'CrYcAR/MhbaLKIxK2Zgz8klcQw0hvCUYC2Y1EtQ6qzQybjzJfSFUyXHN5uFRBMjJJlnax91cDkag2LdaRXYFI9fpGnOEn3OEgEt2b/eWvF2BLvH89t8BgqoGZf8MFVncy2oVzMzzFZoz1avbs1r+yvhfrLjs5tOP6UjIoq3iD7kkgnIWhIfktSynVDJ1bWx9TLDboymuZ8U7Se8ytBUZ+dBnrL1wYP7jNvW44m0edXJ91792SuMdWSzsJ8tO8tKT9F6ZXeDYGThJYl0zPFfzEeiMSW7GmafxnHGwsLG//6F09/AaKLZ7qFFFDXFesrxBPpE2ee4et8zSRONjxYxwjRpnHehHJNBbRQQpS8oOwUK/XXBt2+ksb55rXUaTw8ubPGsqabvgaQIiwQIMsiOFJduq48lUp28I0foFRgVNTFA/bkrBvueXyutmHUeQfuMA0vHWCm9gt8NeNfkGNfB/4xFmCHhxgB3q6IFOUqTPTXJcmnsrn2/vAijaXEaboUPD4JYWBZdp7dP/vmql3wTXGfAydOaUWjpD87Faqrvy2mkdiPWxd4NOLGFD1tfzRXcV1cDHJXHHAiVOnLi05nCcFRUMQf11c//g8s8OeMmOuCouJXtORr14fPxDURPVzKtuFgO6/HcUv8MKbY0pRn6jeABJ757sYb43c29fMVSM0HxM9I8NG/HemqBDe304xh4K2MBXsW0dUXUktH6wbaD4ApmGGVMzw+fOI7NGuyaWr7iSjxZuB/yOXMoimj73lO8IstAfjdjt0HFmVUilhtPbrf2LL8DkB5JbVc+crDGgW4ZFkIh+0TeU9xzr6drBboxB308miZRkwwGFf5qO5mFfaakukFQ2iEApSe498QqgByqeIRnhzdNmMi7zrx0KHiGl40BweAaz2/4uY+cvszTqBCI0O3C2G2pLKI9ZbHzSv7Ctos9A2B4B5LpSHD6qSpdJ1pl3NH8o+bb92bLbXF0f7CEq2yzZPiZRbzspxWbUn+8D3LdL23oY/4ogqmrAnGTuX9u+i3BSSHCjflha/HKjkHchO9g9TZWvoKdk2wZ0SjbwH1JKLdIdm0lUkU7jLnYrOkSY4GJPU0We7aOoo2iKcrbLPbyMw2tohbqj+Bumd7imjhu3al+i7kjQyqVmBJop5LWnOCk9m9yJ4FfIoENCbPz7fYtOyCTAdPJ+FBrFR1OrVy6wirrJgb2AZsc2u8Du72/znSMMnMBuP/D+MqoSQMWIWbDR0CH3vS8mmo+QWJYsKJd5iBdaUDol/rx6RPdkb8IRHmeyMB1v2NNyyeu1/PMMqbLH9FlT0J4CH5QubZHoebXXEqDcrJIE9GfHQL1DjD9ehIafI48LURl37Nas74OucVb6ZyhOAoQdjcKP6PvXb2F5P7WTNrrS2yAgCe6pO/4MH/Spm1GK/T5H58jO46ISXP78RqqjJCP2uKVXBwnH7uCA7D7Nomak29XuO7CYxTXUoTuirqqFd97xxD13MvjXG7sItxtiVMMHBsKfIEmURSUa16v5nk+umVzGQD3L2hb4+FeQREEMf6LnzlqMu+EgVilij5TUb+BbJtivJCxX16m5y7S4XjUf5d8nv6/uDwHb/ZSW8fLzDba+VPRNjXwNRE9EICmeH/9lMyMYf4qhLU3wDZWDz8litxWueN59Vfe9MtIauX2FQbxxiNhwy4LAPdRPslox4s8LpWlOQIkZXqGhAKAvOPHIaU8YBNL+BQ7WM9s/rVfKFFBErZR+zW/zjqxdIaJckJjTBmuNDb4W+zcguCeXnojrWXfJX6YzvojvVLFoLKL9UIBBa7DpzuSVi2IRX45wTsgIz91i5mzJ+LKOTXm+RB+vYJoObIhCmx6L4R9wjKsExWkOoDMwB/6iTwzT6QSwE0unaiZ9iO8P4/8bvHeb176vIt56FR+VsUPjkJFEBhV8ASrl+k/o+XOE9u678RUSvhOTqQAOgsVxqHAn1ul6yQU5vNpQxPb5eRlOvJFcNbZUeyain/3GOFSNmcepJ/vegIWmcsXv530Wg1YkQcJD9Tf3/kbh7qA5Ra2QlD4yDWzTDJ7a5Slts2I32erSx+yPm/yWlTHt96Q0/hJ20TsBclHw5wZjf6Awq85gYXZnHocEpj1JWcgwFAcuT+Xq/mpwdWScgjyBXOtteGfOP2t+4ShgzZmX2SgFNlT9kUkzOwgJPFuocwwiY8Us8P5lrX0mdV6LSpgF7seKSslxRB67++3DWp7FfQUdIH1V4rZ6YhoAvceqtNTokhK3+s7gSCaY7Iiq7xOMrcPMytA3IU9dataF/+TvYE87ywVQ2/jvLl16vYhtQUONm691FeBU2UfYecs681Oy1HW5zZxRG7+TXoY/vJHOZBR+il6eVmHO84jxfbkAlx/41sFVZbeC8Bb4nIjh5QKllgN7NF3uP21oBaXvDpl6raCIHD2vMI07mJ208FcZOY1UKJQiPVrAbtiTkOk3ZNHf9m+sxr4Pus5iKOOwsjBxmnFUxMs407jl/WAHi9inFQpe0S61wfA0O9oS/lVxP9lRZItbhXhfzQpRLS2quqXcDHAz3Yi45WBrrnJTwfh4Ers2DS7xEn+2vUSiFP8t+vMRFiW0cjc2Q7UPZA41SRnnsYa1HSydIrBsAP4VepZXA+t9ai51rn2wKQEOKpr40+Mf8hOBEc7u8zgnyzFRZueAwhfZPSa617XvWbVgFPuMU15o1V7nAmc4emr5baX/czhfBJ0y4Ls9W60AiQYSHX7d9RDO6jUosCHHqNUPlrK/uUkT3GS/Ck+RuFhwe6hmbGU8Bp8Ps1oPsREYEs9bNbyYEL6PX76jMlkEksLr/WEch2C1vT/DfmOax9oZTOmk+P1U0fDbmIg8qPtGIb+bPFsfXfQzNrT4cy+96IHoYDoJy64eql+8mVtFfpRcGiyiWGPQHRUTxiGxbk2DbxOv83AeCY/lzeWusLUuEUYY5ce1j5TtJivgK1+A4iIBAa7UyV9qnHLOR7MrWyV18OAGEcX3QBSGEk34b+V3LuB5Bt+2jDAV2n9Bp6DqLpudAlSoQxeXslrWT0URbRPFDmjI2rrzvN8c3JcxCu3C02DJFYUi5MveTJfZp6nJczZ3ndf+UOw6dvCQuaSP9z1Ntr1lcJTujx6VK2FxJ/UiUu1dgqJHbbxxMSc2Jn3RifCL+Sjpt5wTmqJNtO3JeEF/rIG+e95oBcJyrbSoJEp4ibmznpZzxslqhtnND0tBW3NO9KnKW1Khu7vux16YLsPwvzH2rOablPeFEB8lrGUiGGJOUZd6xEzNiRfhtSE2Cu1znKnBsZelYRH+tc/K4w7cPNF4ukhnCJFrGQ90l1NtR/JNEBSq+YKFD1VyxqCmRJ19YBrjHAQUJsuxIiX8zPfYuSIbK611sC02dBDY0T9Yy/nbSoQGxegtnhaT7VBPbeZ3jcQqvxQkWa0v22eKjjdcWPI1jK/5uZsjfgaVbrQifl9QghNbddneXSOTJ8JJ7vN2kK/FzqFRvoBRsDeiEJCZ8pU/s6sSPPjsn75H9u/RkaCKW4SUbQVfvY6Z8+XWql4U7Xm+yL4pfOzu+tGrqkS0QzGoI+XvNOYupQwtGbBRLQMeo9iMqD3Q9lWnB8K8QTyF52t3yYDSmVAncRytkzMX+47e2jxKPGFsV48w6Clbch1joDAYsQuzwhrNAeoC8nu/GICFAuD4RP9Z3f55O9ELvvkNd6lbY3APkxh7UjeU5tlPC5/u+OypAHV8NIDk6WXO0a29+akEPuXhtBdBegFls8haACcjVdCIqZ48e/sfFpWvWpBH+Y5qq8/1hBadRg2fpJ36n7AoMn7oLpsuGjeo5TUqOmJ7WFYwpm/4dfqOMAmfFqTYywXMKo1Ejw0iD4Zcqej49NbwfhWi5x1PYEphejwMvMn7FUb2ZYRaA3X/Diut1WD+6QFfof90TbhF7/5PQbldhJXpD4bYparKwx0k7laSsMuAkRntPeGcQsEvjqeNxCHj3SJ3R5ueW6Y4RsbYLcN3RsFxQ3CDKkkyX/lIlpFORtX0qn4Y+h0zby3uDChS5fYMW7xIaLxPfpiMGD8v8nURZNgjZEgftYfSfdl7W8YbimQwIM3ZXZ5y7GmQlLPwzz+wiuJu1qovzlYQM8wqGvhabrbxMs5ExTkC6eXpnEu9LT1Pa8jkSY1n0/pkvgXmNkvtCtmc9u7rZsTIUG9U39C8HKsSoRFeIUad9SqrvFdldCcY/lWp550AGyqsHAKhbtcZ+yxhXtddaCUYBeFF8Aoy5kNiho72f7OnDxXRsgz7jGGzpUyux+7/FLuf6qx1uYsiyiSRUEAhzhqhLnK0OAGXnwjUafZMhR3rNwGJx0Q5Z028EhcERiyhKYYqz4Z6cFSMpSSyGSHlkY0iF7Kp+Jz8JI5O6+/BqN8CbFUcMtZy8Kqllo2ti+jJFU7D5zaLr1tBekN0xqKnP72rLJJAWV3zQKXR1uZckGS379ro3TTudW3dcO+6eYRA1EaT4oTtPJBOvWjenRLUj8Bg+5khebBGJPGPUTWHhisvukxvaM1ZPKO2gnb894iSCo//5NFhFGaZudIetL+x7AjURFzEUgtohlr+zKYQyr306KQ+6tnb6AtDDS72lXxMJXUvtVrp4QMXiv5whAPhfkRPQ8d4micxBOjmO9N9MYarHjJxCCcT/sTcaFqRGQ/5ux6YEkIyD4lXMMdFshLU/9i1ixj4oa10ZH9iSNDpIeytipfq78iu5D7tIXTE7gSgCYKWU751vXMTI6Eu/m2znVcdTAQ0PgKtHYyJw+LqpIkRO9htX+lnnddubNuH5DR239tG/CeZQ9Kx3yAXLYlgAMaSuE4WVBwS14rZwF4TDLs/4oWkyo0='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3356, 'candidates_token_count': 25, 'total_token_count': 4302, 'cached_content_token_count': 3044, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3878}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3044}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 921}, 'finish_reason': 'STOP', 'avg_logprobs': -1.3838461303710938, 'model_name': 'gemini-2.5-pro'} id='run--59cb6470-9ec4-4ddc-b537-feba0a1a6f01-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py modeladmin.test_formfield_for_manytomany'}, 'id': 'f5647f25-5ef6-4581-b425-56dfa22a7265', 'type': 'tool_call'}] usage_metadata={'input_tokens': 3356, 'output_tokens': 25, 'total_tokens': 4302, 'input_token_details': {'cache_read': 3044}, 'output_token_details': {'reasoning': 921}}
2025-10-06 03:53:18,921 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python tests/runtests.py modeladmin.test_formfield_for_manytomany
2025-10-06 03:53:19,219 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:53:19,219 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Testing against Django installed in '/testbed/django' with up to 8 processes
System check identified no issues (0 silenced).
E
======================================================================
ERROR: test_m2m_widget_override_with_filter_horizontal (modeladmin.test_formfield_for_manytomany.FormfieldForManyToManyWidgetTest)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/testbed/tests/modeladmin/test_formfield_for_manytomany.py", line 48, in test_m2m_widget_override_with_filter_horizontal
    form_field = model_admin.formfield_for_dbfield(db_field, request=None)
  File "/testbed/django/contrib/admin/options.py", line 166, in formfield_for_dbfield
    can_add_related=related_modeladmin.has_add_permission(request),
  File "/testbed/django/contrib/admin/options.py", line 473, in has_add_permission
    return request.user.has_perm("%s.%s" % (opts.app_label, codename))
AttributeError: 'NoneType' object has no attribute 'user'

----------------------------------------------------------------------
Ran 1 test in 0.001s

FAILED (errors=1)

2025-10-06 03:53:22,566 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='\nTesting against Django installed in \'/testbed/django\' with up to 8 processes\nSystem check identified no issues (0 silenced).\nE\n======================================================================\nERROR: test_m2m_widget_override_with_filter_horizontal (modeladmin.test_formfield_for_manytomany.FormfieldForManyToManyWidgetTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/modeladmin/test_formfield_for_manytomany.py", line 48, in test_m2m_widget_override_with_filter_horizontal\n    form_field = model_admin.formfield_for_dbfield(db_field, request=None)\n  File "/testbed/django/contrib/admin/options.py", line 166, in formfield_for_dbfield\n    can_add_related=related_modeladmin.has_add_permission(request),\n  File "/testbed/django/contrib/admin/options.py", line 473, in has_add_permission\n    return request.user.has_perm("%s.%s" % (opts.app_label, codename))\nAttributeError: \'NoneType\' object has no attribute \'user\'\n\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nFAILED (errors=1)' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 3699, 'candidates_token_count': 313, 'total_token_count': 4099, 'cached_content_token_count': 3223, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5140}], 'cache_tokens_details': [{'modality': 1, 'token_count': 3223}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 313}], 'thoughts_token_count': 87}, 'finish_reason': 'STOP', 'avg_logprobs': -0.041779036719959, 'model_name': 'gemini-2.5-pro'} id='run--ca3ddb6a-d326-4d6f-951e-47520035453a-0' usage_metadata={'input_tokens': 3699, 'output_tokens': 313, 'total_tokens': 4099, 'input_token_details': {'cache_read': 3223}, 'output_token_details': {'reasoning': 87}}
2025-10-06 03:53:35,227 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=False reproduced_bug_failure_log='FAILED (errors=1)\n======================================================================\nERROR: test_m2m_widget_override_with_filter_horizontal (modeladmin.test_formfield_for_manytomany.FormfieldForManyToManyWidgetTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/modeladmin/test_formfield_for_manytomany.py", line 48, in test_m2m_widget_override_with_filter_horizontal\n    form_field = model_admin.formfield_for_dbfield(db_field, request=None)\n  File "/testbed/django/contrib/admin/options.py", line 166, in formfield_for_dbfield\n    can_add_related=related_modeladmin.has_add_permission(request),\n  File "/testbed/django/contrib/admin/options.py", line 473, in has_add_permission\n    return request.user.has_perm("%s.%s" % (opts.app_label, codename))\nAttributeError: \'NoneType\' object has no attribute \'user\'\n\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nTest fails with AttributeError because `request` is None, but the issue describes a problem where the widget is overridden. The test should fail with an AssertionError on `self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)` to correctly reproduce the bug. A mock request object needs to be passed to `formfield_for_dbfield`.' reproduced_bug_commands=['./manage.py test modeladmin.test_formfield_for_manytomany.FormfieldForManyToManyWidgetTest.test_m2m_widget_override_with_filter_horizontal']
2025-10-06 03:53:35,228 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_file_messages in state.
2025-10-06 03:53:35,228 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting bug_reproducing_execute_messages in state.
2025-10-06 03:53:35,228 - thread-139660780025408.app.lang_graph.nodes.git_reset_node - DEBUG - Resetting the git repository
2025-10-06 03:53:35,271 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Your previous test case failed to reproduce the bug. Here is the failure log:\nFAILED (errors=1)\n======================================================================\nERROR: test_m2m_widget_override_with_filter_horizontal (modeladmin.test_formfield_for_manytomany.FormfieldForManyToManyWidgetTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File "/testbed/tests/modeladmin/test_formfield_for_manytomany.py", line 48, in test_m2m_widget_override_with_filter_horizontal\n    form_field = model_admin.formfield_for_dbfield(db_field, request=None)\n  File "/testbed/django/contrib/admin/options.py", line 166, in formfield_for_dbfield\n    can_add_related=related_modeladmin.has_add_permission(request),\n  File "/testbed/django/contrib/admin/options.py", line 473, in has_add_permission\n    return request.user.has_perm("%s.%s" % (opts.app_label, codename))\nAttributeError: \'NoneType\' object has no attribute \'user\'\n\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nTest fails with AttributeError because `request` is None, but the issue describes a problem where the widget is overridden. The test should fail with an AssertionError on `self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)` to correctly reproduce the bug. A mock request object needs to be passed to `formfield_for_dbfield`.\n\nNow think about what went wrong and generate the complete self-contained test case that reproduces the bug with the same error/exception again.\n' additional_kwargs={} response_metadata={}
2025-10-06 03:53:52,741 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='My previous test failed with an `AttributeError` because the `request` object passed to `formfield_for_dbfield` was `None`. The admin internals require a valid request object to perform permission checks (specifically, `request.user.has_perm(...)`). Without it, the code crashed before it could even evaluate which widget to use, thus masking the actual bug.\n\nThe fix is to provide a mock request object. By using `unittest.mock.Mock`, I can create a fake request that has a `user` attribute. This mock user is configured to always return `True` for any permission check, satisfying the admin\'s requirements and preventing the `AttributeError`.\n\nWith the mock request in place, the test now executes correctly:\n1.  The `BandAdmin` is configured with `filter_horizontal = (\'members\',)`.\n2.  The overridden `formfield_for_manytomany` attempts to set the widget to `CheckboxSelectMultiple`.\n3.  The buggy `super()` implementation ignores this custom widget because `filter_horizontal` is set, and unconditionally overwrites it with `FilteredSelectMultiple`.\n4.  The final form field\'s widget is a `RelatedFieldWidgetWrapper` containing `FilteredSelectMultiple`.\n5.  The assertion `self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)` is now reached. It fails with an `AssertionError` because the actual inner widget is `FilteredSelectMultiple`, not the custom `CheckboxSelectMultiple`. This correctly reproduces the bug as described.\n\n```python\nfrom unittest.mock import Mock\n\nfrom django import forms\nfrom django.contrib import admin\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n\n# Define models with unique names and an isolated app_label to avoid conflicts.\nclass M2MWidgetRequestBugMember(models.Model):\n    name = models.CharField(max_length=100)\n\n    class Meta:\n        app_label = \'m2m_widget_request_bug\'\n\n\nclass M2MWidgetRequestBugBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(M2MWidgetRequestBugMember)\n\n    class Meta:\n        app_label = \'m2m_widget_request_bug\'\n\n\n# This ModelAdmin reproduces the conditions for the bug.\nclass BandAdmin(admin.ModelAdmin):\n    # By adding \'members\' to filter_horizontal, we trigger the buggy code path\n    # in the original ModelAdmin.formfield_for_manytomany.\n    filter_horizontal = (\'members\',)\n\n    # The user scenario involves overriding this method to provide a custom widget.\n    def formfield_for_manytomany(self, db_field, request, **kwargs):\n        if db_field.name == \'members\':\n            # The custom widget is supplied via kwargs.\n            kwargs[\'widget\'] = forms.CheckboxSelectMultiple\n        # The super() call invokes the buggy implementation.\n        return super().formfield_for_manytomany(db_field, request, **kwargs)\n\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    def test_m2m_widget_override_with_filter_horizontal(self):\n        """\n        formfield_for_manytomany() should respect a passed widget even when\n        filter_horizontal is used.\n        """\n        site = admin.AdminSite()\n        site.register(M2MWidgetRequestBugMember)\n        site.register(M2MWidgetRequestBugBand, BandAdmin)\n\n        model_admin = site._registry[M2MWidgetRequestBugBand]\n        db_field = M2MWidgetRequestBugBand._meta.get_field(\'members\')\n\n        # Create a mock request with a mock user that has all permissions. This\n        # is required to avoid an AttributeError inside the admin code.\n        request = Mock()\n        request.user.has_perm.return_value = True\n\n        # Use formfield_for_dbfield() as the entry point to simulate the admin.\n        form_field = model_admin.formfield_for_dbfield(db_field, request=request)\n\n        # The bug: The base formfield_for_manytomany overwrites the widget from\n        # kwargs with FilteredSelectMultiple because \'members\' is in\n        # filter_horizontal, without checking if a widget is already present.\n        #\n        # The assertion below will fail because the inner widget will be\n        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.\n        # This results in the desired AssertionError.\n        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19063, 'candidates_token_count': 1038, 'total_token_count': 21371, 'cached_content_token_count': 15928, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19063}], 'cache_tokens_details': [{'modality': 1, 'token_count': 15928}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1038}], 'thoughts_token_count': 1270}, 'finish_reason': 'STOP', 'avg_logprobs': -0.19887132589527637, 'model_name': 'gemini-2.5-pro'} id='run--afb4e874-9c9b-4d01-bd4f-9eb06ce18899-0' usage_metadata={'input_tokens': 19063, 'output_tokens': 1038, 'total_tokens': 21371, 'input_token_details': {'cache_read': 15928}, 'output_token_details': {'reasoning': 1270}}
2025-10-06 03:54:23,909 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "from unittest.mock import Mock\\n\\nfrom django import forms\\nfrom django.contrib import admin\\nfrom django.db import models\\nfrom django.test import SimpleTestCase\\n\\n\\n# Define models with unique names and an isolated app_label to avoid conflicts.\\nclass M2MWidgetRequestBugMember(models.Model):\\n    name = models.CharField(max_length=100)\\n\\n    class Meta:\\n        app_label = \'m2m_widget_request_bug\'\\n\\n\\nclass M2MWidgetRequestBugBand(models.Model):\\n    name = models.CharField(max_length=100)\\n    members = models.ManyToManyField(M2MWidgetRequestBugMember)\\n\\n    class Meta:\\n        app_label = \'m2m_widget_request_bug\'\\n\\n\\n# This ModelAdmin reproduces the conditions for the bug.\\nclass BandAdmin(admin.ModelAdmin):\\n    # By adding \'members\' to filter_horizontal, we trigger the buggy code path\\n    # in the original ModelAdmin.formfield_for_manytomany.\\n    filter_horizontal = (\'members\',)\\n\\n    # The user scenario involves overriding this method to provide a custom widget.\\n    def formfield_for_manytomany(self, db_field, request, **kwargs):\\n        if db_field.name == \'members\':\\n            # The custom widget is supplied via kwargs.\\n            kwargs[\'widget\'] = forms.CheckboxSelectMultiple\\n        # The super() call invokes the buggy implementation.\\n        return super().formfield_for_manytomany(db_field, request, **kwargs)\\n\\n\\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\\n    def test_m2m_widget_override_with_filter_horizontal(self):\\n        \\"\\"\\"\\n        formfield_for_manytomany() should respect a passed widget even when\\n        filter_horizontal is used.\\n        \\"\\"\\"\\n        site = admin.AdminSite()\\n        site.register(M2MWidgetRequestBugMember)\\n        site.register(M2MWidgetRequestBugBand, BandAdmin)\\n\\n        model_admin = site._registry[M2MWidgetRequestBugBand]\\n        db_field = M2MWidgetRequestBugBand._meta.get_field(\'members\')\\n\\n        # Create a mock request with a mock user that has all permissions. This\\n        # is required to avoid an AttributeError inside the admin code.\\n        request = Mock()\\n        request.user.has_perm.return_value = True\\n\\n        # Use formfield_for_dbfield() as the entry point to simulate the admin.\\n        form_field = model_admin.formfield_for_dbfield(db_field, request=request)\\n\\n        # The bug: The base formfield_for_manytomany overwrites the widget from\\n        # kwargs with FilteredSelectMultiple because \'members\' is in\\n        # filter_horizontal, without checking if a widget is already present.\\n        #\\n        # The assertion below will fail because the inner widget will be\\n        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.\\n        # This results in the desired AssertionError.\\n        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)\\n", "relative_path": "tests/admin_widgets/test_formfield_for_manytomany.py"}'}, '__gemini_function_call_thought_signatures__': {'b98f7d46-798b-4300-bb97-cb2e9b2eba28': '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'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 54342, 'candidates_token_count': 731, 'total_token_count': 58058, 'prompt_tokens_details': [{'modality': 1, 'token_count': 54342}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 731}], 'thoughts_token_count': 2985, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5938679372889235, 'model_name': 'gemini-2.5-pro'} id='run--8b9ec970-6e10-42f5-b7ce-c29474529449-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'from unittest.mock import Mock\n\nfrom django import forms\nfrom django.contrib import admin\nfrom django.db import models\nfrom django.test import SimpleTestCase\n\n\n# Define models with unique names and an isolated app_label to avoid conflicts.\nclass M2MWidgetRequestBugMember(models.Model):\n    name = models.CharField(max_length=100)\n\n    class Meta:\n        app_label = \'m2m_widget_request_bug\'\n\n\nclass M2MWidgetRequestBugBand(models.Model):\n    name = models.CharField(max_length=100)\n    members = models.ManyToManyField(M2MWidgetRequestBugMember)\n\n    class Meta:\n        app_label = \'m2m_widget_request_bug\'\n\n\n# This ModelAdmin reproduces the conditions for the bug.\nclass BandAdmin(admin.ModelAdmin):\n    # By adding \'members\' to filter_horizontal, we trigger the buggy code path\n    # in the original ModelAdmin.formfield_for_manytomany.\n    filter_horizontal = (\'members\',)\n\n    # The user scenario involves overriding this method to provide a custom widget.\n    def formfield_for_manytomany(self, db_field, request, **kwargs):\n        if db_field.name == \'members\':\n            # The custom widget is supplied via kwargs.\n            kwargs[\'widget\'] = forms.CheckboxSelectMultiple\n        # The super() call invokes the buggy implementation.\n        return super().formfield_for_manytomany(db_field, request, **kwargs)\n\n\nclass FormfieldForManyToManyWidgetTest(SimpleTestCase):\n    def test_m2m_widget_override_with_filter_horizontal(self):\n        """\n        formfield_for_manytomany() should respect a passed widget even when\n        filter_horizontal is used.\n        """\n        site = admin.AdminSite()\n        site.register(M2MWidgetRequestBugMember)\n        site.register(M2MWidgetRequestBugBand, BandAdmin)\n\n        model_admin = site._registry[M2MWidgetRequestBugBand]\n        db_field = M2MWidgetRequestBugBand._meta.get_field(\'members\')\n\n        # Create a mock request with a mock user that has all permissions. This\n        # is required to avoid an AttributeError inside the admin code.\n        request = Mock()\n        request.user.has_perm.return_value = True\n\n        # Use formfield_for_dbfield() as the entry point to simulate the admin.\n        form_field = model_admin.formfield_for_dbfield(db_field, request=request)\n\n        # The bug: The base formfield_for_manytomany overwrites the widget from\n        # kwargs with FilteredSelectMultiple because \'members\' is in\n        # filter_horizontal, without checking if a widget is already present.\n        #\n        # The assertion below will fail because the inner widget will be\n        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.\n        # This results in the desired AssertionError.\n        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)\n', 'relative_path': 'tests/admin_widgets/test_formfield_for_manytomany.py'}, 'id': 'b98f7d46-798b-4300-bb97-cb2e9b2eba28', 'type': 'tool_call'}] usage_metadata={'input_tokens': 54342, 'output_tokens': 731, 'total_tokens': 58058, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2985}}
2025-10-06 03:54:25,172 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='tests/admin_widgets/test_formfield_for_manytomany.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 55101, 'candidates_token_count': 18, 'total_token_count': 55119, 'cached_content_token_count': 52494, 'prompt_tokens_details': [{'modality': 1, 'token_count': 58084}], 'cache_tokens_details': [{'modality': 1, 'token_count': 52494}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 18}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1217901677203676e-05, 'model_name': 'gemini-2.5-pro'} id='run--e58aac6e-66bf-4116-9a0d-a63e131a86a2-0' usage_metadata={'input_tokens': 55101, 'output_tokens': 18, 'total_tokens': 55119, 'input_token_details': {'cache_read': 52494}}
2025-10-06 03:54:25,208 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/tests/admin_widgets/test_formfield_for_manytomany.py b/tests/admin_widgets/test_formfield_for_manytomany.py
new file mode 100644
index 0000000000..18d51995cd
--- /dev/null
+++ b/tests/admin_widgets/test_formfield_for_manytomany.py
@@ -0,0 +1,68 @@
+from unittest.mock import Mock
+
+from django import forms
+from django.contrib import admin
+from django.db import models
+from django.test import SimpleTestCase
+
+
+# Define models with unique names and an isolated app_label to avoid conflicts.
+class M2MWidgetRequestBugMember(models.Model):
+    name = models.CharField(max_length=100)
+
+    class Meta:
+        app_label = 'm2m_widget_request_bug'
+
+
+class M2MWidgetRequestBugBand(models.Model):
+    name = models.CharField(max_length=100)
+    members = models.ManyToManyField(M2MWidgetRequestBugMember)
+
+    class Meta:
+        app_label = 'm2m_widget_request_bug'
+
+
+# This ModelAdmin reproduces the conditions for the bug.
+class BandAdmin(admin.ModelAdmin):
+    # By adding 'members' to filter_horizontal, we trigger the buggy code path
+    # in the original ModelAdmin.formfield_for_manytomany.
+    filter_horizontal = ('members',)
+
+    # The user scenario involves overriding this method to provide a custom widget.
+    def formfield_for_manytomany(self, db_field, request, **kwargs):
+        if db_field.name == 'members':
+            # The custom widget is supplied via kwargs.
+            kwargs['widget'] = forms.CheckboxSelectMultiple
+        # The super() call invokes the buggy implementation.
+        return super().formfield_for_manytomany(db_field, request, **kwargs)
+
+
+class FormfieldForManyToManyWidgetTest(SimpleTestCase):
+    def test_m2m_widget_override_with_filter_horizontal(self):
+        """
+        formfield_for_manytomany() should respect a passed widget even when
+        filter_horizontal is used.
+        """
+        site = admin.AdminSite()
+        site.register(M2MWidgetRequestBugMember)
+        site.register(M2MWidgetRequestBugBand, BandAdmin)
+
+        model_admin = site._registry[M2MWidgetRequestBugBand]
+        db_field = M2MWidgetRequestBugBand._meta.get_field('members')
+
+        # Create a mock request with a mock user that has all permissions. This
+        # is required to avoid an AttributeError inside the admin code.
+        request = Mock()
+        request.user.has_perm.return_value = True
+
+        # Use formfield_for_dbfield() as the entry point to simulate the admin.
+        form_field = model_admin.formfield_for_dbfield(db_field, request=request)
+
+        # The bug: The base formfield_for_manytomany overwrites the widget from
+        # kwargs with FilteredSelectMultiple because 'members' is in
+        # filter_horizontal, without checking if a widget is already present.
+        #
+        # The assertion below will fail because the inner widget will be
+        # FilteredSelectMultiple, not the CheckboxSelectMultiple we provided.
+        # This results in the desired AssertionError.
+        self.assertIsInstance(form_field.widget.widget, forms.CheckboxSelectMultiple)

2025-10-06 03:54:25,208 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 03:54:25,242 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 03:54:25,242 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 03:54:25,342 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:54:25,342 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 5b884d45ac Fixed #29501 -- Allowed dbshell to pass options to underlying tool.

2025-10-06 03:54:25,343 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 03:54:25,443 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:54:25,443 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Removing tests/modeladmin/test_formfield_for_manytomany.py

2025-10-06 03:54:25,443 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 03:54:25,443 - thread-139660780025408.app.docker.base_container - INFO - Creating directory tests/admin_widgets in the container
2025-10-06 03:54:25,443 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p tests/admin_widgets
2025-10-06 03:54:25,544 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:54:25,544 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 03:54:25,544 - thread-139660780025408.app.docker.base_container - INFO - Updating tests/admin_widgets/test_formfield_for_manytomany.py in the container
2025-10-06 03:54:25,547 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 03:54:27,747 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python -m django test tests.admin_widgets.test_formfield_for_manytomany"}'}, '__gemini_function_call_thought_signatures__': {'34747671-99cc-45c0-b12d-8860254a225d': 'CvwEAR/MhbbRRjiv/7eT7pF0z+NcifwaAMolZxerFUdToMtKbWPaLJp+FNZ4Oiv23mEgPxpAHnX7+s3FGO3FqBltQK8P7FGnLb6tzj4MjImIQJ3p2i8v2D2K6ASbWG+11R3jxZDLxZAEJOZsJGpSQCsVJqHYFu/ryzH+juPXCj04cCT+2t1aGJYJnzAGToJS3RrLVHwc78gyFW9WkazIjCi41BGigZQmTEgJAoPnYZ/sym6z4i57SSDWKuIC4zpjsTvj7WhZz6IBwbS+vLppWu1UdybTe8IZH/JVoRTpLIxGSIv5ZxAum27Gc8tDr36TrJHdpeFs+pNDZC1tnLF6oBRk7c0vvokKBKI4d8CM60g8Eu8ZbQub0x8jCmcTAPMNpfQLOZC7LmD4mLduNx0usA4M6mXuwGn7HarY7jx/RVkZ5qHZ9hkRIx/g3aLKUYA0x4tZ4sTpG/2Unxv2hJB+JULkPPpV+CcLqtbyQN8aE6nSyyUaZivx5uJAYphF3oPtIKNtJrU1omAcuTkZzTjUjZYyROhbEPLx7fvWHumTtakHJbndZAnmBGmXYo2HN0jeRTIbF7m7vB9Bdr9xwYC35ThSlVSAkd0C/Ih6FBTc5inHvEUmjHy9RhjxMANPcGvrpMHdNLk/qv4mgBqCkHNlESbfANm3JpbWmrAPGcLzd8ww7FNmXePnEy7/sWtw8i3V+0elx6a+4/IKTISXLq1CsKG92E8SZK/3LSkYBTRa6BKQki/Rtm0tf5wjcJ6Yhl/wRpwxu4c958Ti9q2KaBmY0cQrcCGlPpDyxhMbI0W2zdr0xtvLPaM4wLhbmqU0y1tSMJHRGiACDLfsc+SP+PKB'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 301, 'candidates_token_count': 25, 'total_token_count': 484, 'prompt_tokens_details': [{'modality': 1, 'token_count': 301}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 25}], 'thoughts_token_count': 158, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5138208389282226, 'model_name': 'gemini-2.5-pro'} id='run--6a316257-68c2-46ab-b963-04d6c968ef9a-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python -m django test tests.admin_widgets.test_formfield_for_manytomany'}, 'id': '34747671-99cc-45c0-b12d-8860254a225d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 301, 'output_tokens': 25, 'total_tokens': 484, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 158}}
2025-10-06 03:54:27,749 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m django test tests.admin_widgets.test_formfield_for_manytomany
2025-10-06 03:54:27,989 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 03:54:27,989 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Traceback (most recent call last):
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/miniconda3/envs/testbed/lib/python3.6/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/testbed/django/__main__.py", line 9, in <module>
    management.execute_from_command_line()
  File "/testbed/django/core/management/__init__.py", line 401, in execute_from_command_line
    utility.execute()
  File "/testbed/django/core/management/__init__.py", line 395, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/testbed/django/core/management/commands/test.py", line 23, in run_from_argv
    super().run_from_argv(argv)
  File "/testbed/django/core/management/base.py", line 322, in run_from_argv
    parser = self.create_parser(argv[0], argv[1])
  File "/testbed/django/core/management/base.py", line 296, in create_parser
    self.add_arguments(parser)
  File "/testbed/django/core/management/commands/test.py", line 44, in add_arguments
    test_runner_class = get_runner(settings, self.test_runner)
  File "/testbed/django/test/utils.py", line 302, in get_runner
    test_runner_class = test_runner_class or settings.TEST_RUNNER
  File "/testbed/django/conf/__init__.py", line 77, in __getattr__
    self._setup(name)
  File "/testbed/django/conf/__init__.py", line 62, in _setup
    % (desc, ENVIRONMENT_VARIABLE))
django.core.exceptions.ImproperlyConfigured: Requested setting TEST_RUNNER, but settings are not configured. You must either define the environment variable DJANGO_SETTINGS_MODULE or call settings.configure() before accessing settings.

2025-10-06 03:54:29,563 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls tests"}'}, '__gemini_function_call_thought_signatures__': {'8359e944-8891-4de8-9847-a9c86d00581c': 'CvcDAR/MhbbfkOS6WP4t806TtJlWk7Ya7YYWYZ2HgpJIrwPd7jYZMnuUTwx2a+ulWWudX7Lvax2eZ1I/AK6L9JvZpqb3I0bpWlFduwjtAYopaaeT/Irmi6Xmt6RUj2GGon7bB1a+H4lSmMhATJPpgXWK3xEHS0q9Tt4vjuR1njAHEL2VdVL6mb3tB3wcTeipC6WZ8l2FDgmjb5vuTXQVHKIwuMfcV4FjArBiRX81WPHYQgbS/tBoK8KUzXuu7e7jc8Cki7DQV04MMbQolWLMoHoNZg/tcWNQ1qkvejcg/YjH7tN3mItim8rFCrc5LguNYXaTfQPHMhi4DfKaIVLpZXd46NjMmwkxi3nSdaZvQpjXPLhrnR5aD87VN3zDKr4YWz3xTHCv8bwqjWYKGWpstS3wzZW6Sy/IlWyF1x42aDMf09bmPKoHnpbLjif7XQldGXDGBT6pQTDtd8i0Qlo4J4SixIX6nd05W14Yws+qASrGTNN03kACPZfcodb8TtDwP8fFNWiJJWQ4BDsOXdb2dGEj7FuY96q3QRSPgGhnFisWrIfJ7hpsys77sCptrQCnnMsmQgnqAW0aL2fl+5M6HmBOoI/+F5sofOagatVSdMOdySY9ZUhbrmhmOgNGD4KzRiGi8CYN3RkWHPiHGTEKtkHBLBlzrbkgdnk='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 888, 'candidates_token_count': 6, 'total_token_count': 996, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1044}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 6}], 'thoughts_token_count': 102, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.9407981236775715, 'model_name': 'gemini-2.5-pro'} id='run--f0cd3bef-48b8-42e9-86fc-fff348a19e42-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls tests'}, 'id': '8359e944-8891-4de8-9847-a9c86d00581c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 888, 'output_tokens': 6, 'total_tokens': 996, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 102}}
2025-10-06 03:54:29,564 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls tests
2025-10-06 03:54:29,665 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 03:54:29,665 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

absolute_url_overrides	     mail
admin_autodiscover	     managers_regress
admin_changelist	     many_to_many
admin_checks		     many_to_one
admin_custom_urls	     many_to_one_null
admin_default_site	     max_lengths
admin_docs		     messages_tests
admin_filters		     middleware
admin_inlines		     middleware_exceptions
admin_ordering		     migrate_signals
admin_registration	     migrations
admin_scripts		     migrations2
admin_utils		     migration_test_data_persistence
admin_views		     modeladmin
admin_widgets		     model_enums
aggregation		     model_fields
aggregation_regress	     model_forms
annotations		     model_formsets
app_loading		     model_formsets_regress
apps			     model_indexes
asgi			     model_inheritance
async			     model_inheritance_regress
auth_tests		     model_meta
backends		     model_options
base			     model_package
bash_completion		     model_regress
basic			     multiple_database
builtin_server		     mutually_referential
bulk_create		     nested_foreign_keys
cache			     no_models
check_framework		     null_fk
conditional_processing	     null_fk_ordering
constraints		     null_queries
contenttypes_tests	     one_to_one
context_processors	     ordering
csrf_tests		     order_with_respect_to
custom_columns		     or_lookups
custom_lookups		     pagination
custom_managers		     postgres_tests
custom_methods		     prefetch_related
custom_migration_operations  project_template
custom_pk		     properties
datatypes		     proxy_model_inheritance
dates			     proxy_models
datetimes		     __pycache__
db_functions		     queries
dbshell			     queryset_pickle
db_typecasts		     raw_query
db_utils		     README.rst
decorators		     redirects_tests
defer			     requests
defer_regress		     requirements
delete			     reserved_names
delete_regress		     resolve_url
deprecation		     responses
dispatch		     reverse_lookup
distinct_on_fields	     runtests.py
empty			     save_delete_hooks
empty_models		     schema
expressions		     select_for_update
expressions_case	     select_related
expressions_window	     select_related_onetoone
extra_regress		     select_related_regress
field_deconstruction	     serializers
field_defaults		     servers
field_subclassing	     sessions_tests
files			     settings_tests
file_storage		     shell
file_uploads		     shortcuts
filtered_relation	     signals
fixtures		     signed_cookies_tests
fixtures_model_package	     signing
fixtures_regress	     sitemaps_tests
flatpages_tests		     sites_framework
force_insert_update	     sites_tests
foreign_object		     staticfiles_tests
forms_tests		     str
from_db_value		     string_lookup
generic_inline_admin	     swappable_models
generic_relations	     syndication_tests
generic_relations_regress    template_backends
generic_views		     template_loader
get_earliest_or_latest	     templates
get_object_or_404	     template_tests
get_or_create		     test_client
gis_tests		     test_client_regress
handlers		     test_exceptions
httpwrappers		     test_runner
humanize_tests		     test_runner_apps
i18n			     test_sqlite.py
import_error_package	     test_utils
indexes			     timezones
inline_formsets		     transaction_hooks
inspectdb		     transactions
introspection		     unmanaged_models
invalid_models_tests	     update
known_related_objects	     update_only_fields
logging_tests		     urlpatterns
lookup			     urlpatterns_reverse
m2m_and_m2o		     urls.py
m2m_intermediary	     user_commands
m2m_multiple		     utils_tests
m2m_recursive		     validation
m2m_regress		     validators
m2m_signals		     version
m2m_through		     view_tests
m2m_through_regress	     wsgi
m2o_recursive

2025-10-06 03:54:31,391 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany"}'}, '__gemini_function_call_thought_signatures__': {'c01ba571-b906-4764-82df-e6fd070d8bc2': 'Cr0DAR/MhbZLTfYRDWV8JX3yKt3Tkm/Vt1P2FTAT0CpkpHJ70+UmBw6y7dOxHFcjLnUpfiZwvEzwzv0z84K54kCG5lIucz4Tfcd+qKntVCT/IErDZifnCvSekmKXDS8xRQchLBhSt2ESpQIxJZv8hyJEVwLOsa7PMMY0evIP244r0q4YOQmKZNgHhR2Uf9ljG3TiIbqjGJXkvLl0//WXz6xl8t76DBsjS/o1pQ5ePe5mViPH/Li2QnezYovv0FLsTERNfBBQn/SD1oNZcfcCh0kpJPo2pO+mSPatzU5BEL77mZYwzg3f4UKZECUpFiYFLJhCCl5DU1FG5iYW35WOgMCawWG35Ic1qwNuIWVlBoHQYa5YzfgbnEQFSPyce3n+xPRM+sI4M95+epuSWxYorHPf8vrjMaZLtfVz1FfSvvUdOAZvzotVh0CwVjpCZGheKnT1Nl3OajtGZwQSr3U/OksY4NcnpfZCfHDQp48+XWiVkOdlC7WBjO+eW5m2ooJW+wyZKdDfh0oU7Vqyk0fAKHWoLfI/OrjWKRpOqImcJS7y/htjn/GpvlGpat8KltI/bs7ShWirK9556CgwTGSfZA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1909, 'candidates_token_count': 27, 'total_token_count': 2035, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2165}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 27}], 'thoughts_token_count': 99, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.28949202431572807, 'model_name': 'gemini-2.5-pro'} id='run--74e2be35-2060-467e-820e-00fe06a119f3-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'python tests/runtests.py tests.admin_widgets.test_formfield_for_manytomany'}, 'id': 'c01ba571-b906-4764-82df-e6fd070d8bc2', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1909, 'output_tokens': 27, 'total_tokens': 2035, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 99}}
2025-10-06 03:54:31,393 - thread-139660780025408.app - ERROR - Error in answer_issue: Recursion limit of 150 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT
Traceback (most recent call last):
  File "/root/fzw/Prometheus-Bug-Reproduction-Agent/app/main.py", line 150, in _reproduce_bug
    output_states = bug_reproduction_subgraph.invoke(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/fzw/Prometheus-Bug-Reproduction-Agent/app/lang_graph/subgraphs/bug_reproduction_subgraph.py", line 242, in invoke
    output_state = self.subgraph.invoke(input_state, config)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/pro_bug_re/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 1600, in invoke
    for chunk in self.stream(
                 ^^^^^^^^^^^^
  File "/root/miniconda3/envs/pro_bug_re/lib/python3.12/site-packages/langgraph/pregel/__init__.py", line 1348, in stream
    raise GraphRecursionError(msg)
langgraph.errors.GraphRecursionError: Recursion limit of 150 reached without hitting a stop condition. You can increase the limit by setting the `recursion_limit` config key.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/GRAPH_RECURSION_LIMIT

2025-10-06 03:54:31,393 - thread-139660780025408.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-10-06 03:54:31,393 - thread-139660780025408.app.docker.base_container - INFO - Closing persistent shell...
2025-10-06 03:54:31,493 - thread-139660780025408.app.docker.base_container - INFO - Cleaning up container and temporary files
