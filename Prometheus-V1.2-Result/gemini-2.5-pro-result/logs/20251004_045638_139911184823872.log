2025-10-04 04:56:38,903 - thread-139911184823872.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpz88s3lmr/scikit-learn
2025-10-04 04:56:38,903 - thread-139911184823872.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-10-04 04:56:38,903 - thread-139911184823872.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.scikit-learn_1776_scikit-learn-26194:v1
2025-10-04 04:56:58,228 - thread-139911184823872.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_9805b29616
2025-10-04 04:56:58,232 - thread-139911184823872.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_9805b29616
2025-10-04 04:56:59,355 - thread-139911184823872.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-10-04 04:56:59,508 - thread-139911184823872.app.docker.base_container - INFO - Persistent shell is ready
2025-10-04 04:56:59,508 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-10-04 04:56:59,633 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 04:56:59,634 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 04:56:59,634 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-10-04 04:56:59,757 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 04:56:59,758 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 04:56:59,758 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: python -m pip install -v --no-use-pep517 --no-build-isolation -e .
2025-10-04 04:58:41,626 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 04:58:41,626 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
python -m pip install -v --no-us
se-pep517 --no-build-isolation -e .

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command python setup.py egg_info
  Partial import of sklearn during the build process.
  Compiling sklearn/_loss/_loss.pyx because it changed.
  Compiling sklearn/cluster/_hierarchical_fast.pyx because it depends on sklearn/metrics/_dist_metrics.pxd.
  Compiling sklearn/linear_model/_sgd_fast.pyx because it changed.
  Compiling sklearn/linear_model/_sag_fast.pyx because it changed.
  Compiling sklearn/metrics/_dist_metrics.pyx because it changed.
  Compiling sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.pyx because it changed.
  Compiling sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.pyx because it changed.
  Compiling sklearn/metrics/_pairwise_distances_reduction/_base.pyx because it changed.
  Compiling sklearn/metrics/_pairwise_distances_reduction/_argkmin.pyx because it changed.
  Compiling sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.pyx because it changed.
  Compiling sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.pyx because it changed.
  Compiling sklearn/neighbors/_ball_tree.pyx because it depends on sklearn/metrics/_dist_metrics.pxd.
  Compiling sklearn/neighbors/_kd_tree.pyx because it depends on sklearn/metrics/_dist_metrics.pxd.
  Compiling sklearn/utils/_seq_dataset.pyx because it changed.
  Compiling sklearn/utils/_weight_vector.pyx because it changed.
  performance hint: sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.pyx:61:5: Exception check on '_middle_term_sparse_dense_64' will always require the GIL to be acquired.
  Possible solutions:
        1. Declare '_middle_term_sparse_dense_64' as 'noexcept' if you control the definition and you're sure you don't want the function to raise exceptions.
        2. Use an 'int' return type on '_middle_term_sparse_dense_64' to allow an error code to be returned.
  performance hint: sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.pyx:565:5: Exception check on '_middle_term_sparse_dense_32' will always require the GIL to be acquired.
  Possible solutions:
        1. Declare '_middle_term_sparse_dense_32' as 'noexcept' if you control the definition and you're sure you don't want the function to raise exceptions.
        2. Use an 'int' return type on '_middle_term_sparse_dense_32' to allow an error code to be returned.
  performance hint: sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.pyx:550:36: Exception check after calling '_middle_term_sparse_dense_64' will always require the GIL to be acquired.
  Possible solutions:
        1. Declare '_middle_term_sparse_dense_64' as 'noexcept' if you control the definition and you're sure you don't want the function to raise exceptions.
        2. Use an 'int' return type on '_middle_term_sparse_dense_64' to allow an error code to be returned.
  performance hint: sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.pyx:1088:36: Exception check after calling '_middle_term_sparse_dense_32' will always require the GIL to be acquired.
  Possible solutions:
        1. Declare '_middle_term_sparse_dense_32' as 'noexcept' if you control the definition and you're sure you don't want the function to raise exceptions.
        2. Use an 'int' return type on '_middle_term_sparse_dense_32' to allow an error code to be returned.
  [ 5/15] Cythonizing sklearn/metrics/_pairwise_distances_reduction/_argkmin.pyx
  [11/15] Cythonizing sklearn/utils/_seq_dataset.pyx
  [ 7/15] Cythonizing sklearn/metrics/_pairwise_distances_reduction/_base.pyx
  [ 9/15] Cythonizing sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.pyx
  [ 8/15] Cythonizing sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.pyx
  [13/15] Cythonizing sklearn/cluster/_hierarchical_fast.pyx
  [ 4/15] Cythonizing sklearn/metrics/_dist_metrics.pyx
  [ 6/15] Cythonizing sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.pyx
  [10/15] Cythonizing sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.pyx
  [ 3/15] Cythonizing sklearn/linear_model/_sgd_fast.pyx
  [14/15] Cythonizing sklearn/neighbors/_ball_tree.pyx
  [ 2/15] Cythonizing sklearn/linear_model/_sag_fast.pyx
  [12/15] Cythonizing sklearn/utils/_weight_vector.pyx
  [15/15] Cythonizing sklearn/neighbors/_kd_tree.pyx
  [ 1/15] Cythonizing sklearn/_loss/_loss.pyx
  running egg_info
  creating /tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info
  writing /tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/dependency_links.txt
  writing requirements to /tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/requires.txt
  writing top-level names to /tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/top_level.txt
  writing manifest file '/tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/SOURCES.txt'
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/npy_math.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
  dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
  reading manifest file '/tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no previously-included files matching '*' found under directory 'asv_benchmarks'
  warning: no previously-included files matching '*' found under directory 'benchmarks'
  warning: no previously-included files matching '*' found under directory 'build_tools'
  warning: no previously-included files matching '*' found under directory 'maint_tools'
  warning: no previously-included files matching '*' found under directory 'benchmarks'
  warning: no previously-included files matching '*' found under directory '.binder'
  warning: no previously-included files matching '*' found under directory '.circleci'
  warning: no previously-included files found matching '.cirrus.star'
  warning: no previously-included files found matching '.codecov.yml'
  warning: no previously-included files found matching '.git-blame-ignore-revs'
  warning: no previously-included files found matching '.mailmap'
  warning: no previously-included files found matching '.pre-commit-config.yaml'
  warning: no previously-included files found matching 'azure-pipelines.yml'
  warning: no previously-included files found matching 'CODE_OF_CONDUCT.md'
  warning: no previously-included files found matching 'CONTRIBUTING.md'
  warning: no previously-included files found matching 'SECURITY.md'
  warning: no previously-included files found matching 'PULL_REQUEST_TEMPLATE.md'
  adding license file 'COPYING'
  writing manifest file '/tmp/pip-pip-egg-info-a0kz3mjo/scikit_learn.egg-info/SOURCES.txt'
  Preparing metadata (setup.py) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.17.3 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from scikit-learn==1.3.dev0) (1.26.4)
Requirement already satisfied: scipy>=1.5.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from scikit-learn==1.3.dev0) (1.13.0)
Requirement already satisfied: joblib>=1.1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from scikit-learn==1.3.dev0) (1.4.2)
Requirement already satisfied: threadpoolctl>=2.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from scikit-learn==1.3.dev0) (3.5.0)
Installing collected packages: scikit-learn
  Attempting uninstall: scikit-learn
    Found existing installation: scikit-learn 1.3.dev0
    Uninstalling scikit-learn-1.3.dev0:
      Removing file or directory /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/scikit-learn.egg-link
      Removing pth entries from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/easy-install.pth:
      Removing entry: /testbed
      Successfully uninstalled scikit-learn-1.3.dev0
[33m  DEPRECATION: Legacy editable install of scikit-learn==1.3.dev0 from file:///testbed (setup.py develop) is deprecated. pip 25.0 will enforce this behaviour change. A possible replacement is to add a pyproject.toml or enable --use-pep517, and use setuptools >= 64. If the resulting installation is not behaving as expected, try using --config-settings editable_mode=compat. Please consult the setuptools documentation for more information. Discussion can be found at https://github.com/pypa/pip/issues/11457[0m[33m
[0m  Running setup.py develop for scikit-learn
    Running command python setup.py develop
    Partial import of sklearn during the build process.
    running develop
    /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/setuptools/command/develop.py:41: EasyInstallDeprecationWarning: easy_install command is deprecated.
    !!

            ********************************************************************************
            Please avoid running ``setup.py`` and ``easy_install``.
            Instead, use pypa/build, pypa/installer or other
            standards-based tools.

            See https://github.com/pypa/setuptools/issues/917 for details.
            ********************************************************************************

    !!
      easy_install.initialize_options(self)
    /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/setuptools/_distutils/cmd.py:66: SetuptoolsDeprecationWarning: setup.py install is deprecated.
    !!

            ********************************************************************************
            Please avoid running ``setup.py`` directly.
            Instead, use pypa/build, pypa/installer or other
            standards-based tools.

            See https://blog.ganssle.io/articles/2021/10/setup-py-deprecated.html for details.
            ********************************************************************************

    !!
      self.initialize_options()
    running egg_info
    writing scikit_learn.egg-info/PKG-INFO
    writing dependency_links to scikit_learn.egg-info/dependency_links.txt
    writing requirements to scikit_learn.egg-info/requires.txt
    writing top-level names to scikit_learn.egg-info/top_level.txt
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/npy_math.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/arrayscalars.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h won't be automatically included in the manifest: the path must be relative
    dependency /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include/numpy/ufuncobject.h won't be automatically included in the manifest: the path must be relative
    reading manifest file 'scikit_learn.egg-info/SOURCES.txt'
    reading manifest template 'MANIFEST.in'
    warning: no previously-included files matching '*' found under directory 'asv_benchmarks'
    warning: no previously-included files matching '*' found under directory 'benchmarks'
    warning: no previously-included files matching '*' found under directory 'build_tools'
    warning: no previously-included files matching '*' found under directory 'maint_tools'
    warning: no previously-included files matching '*' found under directory 'benchmarks'
    warning: no previously-included files matching '*' found under directory '.binder'
    warning: no previously-included files matching '*' found under directory '.circleci'
    warning: no previously-included files found matching '.cirrus.star'
    warning: no previously-included files found matching '.codecov.yml'
    warning: no previously-included files found matching '.git-blame-ignore-revs'
    warning: no previously-included files found matching '.mailmap'
    warning: no previously-included files found matching '.pre-commit-config.yaml'
    warning: no previously-included files found matching 'azure-pipelines.yml'
    warning: no previously-included files found matching 'CODE_OF_CONDUCT.md'
    warning: no previously-included files found matching 'CONTRIBUTING.md'
    warning: no previously-included files found matching 'SECURITY.md'
    warning: no previously-included files found matching 'PULL_REQUEST_TEMPLATE.md'
    adding license file 'COPYING'
    writing manifest file 'scikit_learn.egg-info/SOURCES.txt'
    running build_ext
    running build_clib
    building 'libsvm-skl' library
    building 'liblinear-skl' library
    building 'sklearn._loss._loss' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/_loss/_loss.c -o build/temp.linux-x86_64-cpython-39/sklearn/_loss/_loss.o -g0 -O2 -fopenmp
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/_loss/_loss.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/_loss/_loss.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.cluster._hierarchical_fast' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/cluster/_hierarchical_fast.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/cluster/_hierarchical_fast.o -g0 -O2 -fopenmp
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/cluster/_hierarchical_fast.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/cluster/_hierarchical_fast.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.linear_model._sgd_fast' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -Isklearn/linear_model -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/linear_model/_sgd_fast.c -o build/temp.linux-x86_64-cpython-39/sklearn/linear_model/_sgd_fast.o -g0 -O2 -fopenmp
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/linear_model/_sgd_fast.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/linear_model/_sgd_fast.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.linear_model._sag_fast' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -Isklearn/linear_model -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/linear_model/_sag_fast.c -o build/temp.linux-x86_64-cpython-39/sklearn/linear_model/_sag_fast.o -g0 -O2 -fopenmp
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/linear_model/_sag_fast.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/linear_model/_sag_fast.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._dist_metrics' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_dist_metrics.c -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_dist_metrics.o -g0 -O2 -fopenmp
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_pf_7sklearn_7metrics_13_dist_metrics_14DistanceMetric_22_pairwise_sparse_dense’:
    sklearn/metrics/_dist_metrics.c:28367:29: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    28367 |             __pyx_v_x2_data = ((&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_Y_data.data + __pyx_t_18 * __pyx_v_Y_data.strides[0]) )) + __pyx_t_19)) )))) + (__pyx_v_i2 * __pyx_v_n_features));
          |                             ^
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_pf_7sklearn_7metrics_13_dist_metrics_14DistanceMetric_24_pairwise_dense_sparse’:
    sklearn/metrics/_dist_metrics.c:29133:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    29133 |           __pyx_v_x1_data = ((&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_X_data.data + __pyx_t_15 * __pyx_v_X_data.strides[0]) )) + __pyx_t_16)) )))) + (__pyx_v_i1 * __pyx_v_n_features));
          |                           ^
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17EuclideanDistance_dist_csr’:
    sklearn/metrics/_dist_metrics.c:30779:88: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17EuclideanDistance_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    30779 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_17EuclideanDistance_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 932, __pyx_L1_error)
          |                                                                                       ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                        |
          |                                                                                        struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:30409:209: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_EuclideanDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    30409 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_17EuclideanDistance_rdist_csr(CYTHON_UNUSED struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_EuclideanDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_dist’:
    sklearn/metrics/_dist_metrics.c:31284:85: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    31284 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 981, __pyx_L1_error)
          |                                                                                    ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                     |
          |                                                                                     struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:31185:193: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    31185 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_dist_csr’:
    sklearn/metrics/_dist_metrics.c:32103:89: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    32103 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1061, __pyx_L1_error)
          |                                                                                        ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                         |
          |                                                                                         struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:31708:197: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    31708 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_18SEuclideanDistance_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_dist’:
    sklearn/metrics/_dist_metrics.c:33851:84: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    33851 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1304, __pyx_L1_error)
          |                                                                                   ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                    |
          |                                                                                    struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:33708:191: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    33708 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_dist_csr’:
    sklearn/metrics/_dist_metrics.c:34872:88: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    34872 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1411, __pyx_L1_error)
          |                                                                                       ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                        |
          |                                                                                        struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:34255:195: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    34255 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_17MinkowskiDistance_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_dist’:
    sklearn/metrics/_dist_metrics.c:35515:85: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    35515 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1488, __pyx_L1_error)
          |                                                                                    ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                     |
          |                                                                                     struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:35426:193: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    35426 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_dist_csr’:
    sklearn/metrics/_dist_metrics.c:36267:89: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    36267 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1565, __pyx_L1_error)
          |                                                                                        ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                         |
          |                                                                                         struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:35919:197: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    35919 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_18WMinkowskiDistance_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_dist’:
    sklearn/metrics/_dist_metrics.c:37269:86: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    37269 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1650, __pyx_L1_error)
          |                                                                                     ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                      |
          |                                                                                      struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:37116:195: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    37116 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_dist_csr’:
    sklearn/metrics/_dist_metrics.c:38101:90: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    38101 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 1731, __pyx_L1_error)
          |                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                          |
          |                                                                                          struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:37693:199: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    37693 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19MahalanobisDistance_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_dist’:
    sklearn/metrics/_dist_metrics.c:43157:84: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    43157 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 2636, __pyx_L1_error)
          |                                                                                   ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                    |
          |                                                                                    struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:43086:205: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
    43086 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_rdist(CYTHON_UNUSED struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_dist_csr’:
    sklearn/metrics/_dist_metrics.c:43692:88: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    43692 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 2664, __pyx_L1_error)
          |                                                                                       ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                        |
          |                                                                                        struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *
    sklearn/metrics/_dist_metrics.c:4511:209: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric *’
     4511 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_17HaversineDistance_rdist_csr(CYTHON_UNUSED struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float64_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size); /* proto*/
          |                                                                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_pf_7sklearn_7metrics_13_dist_metrics_16DistanceMetric32_22_pairwise_sparse_dense’:
    sklearn/metrics/_dist_metrics.c:49361:29: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    49361 |             __pyx_v_x2_data = ((&(*((__pyx_t_7sklearn_5utils_9_typedefs_float32_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float32_t const  *) ( /* dim=0 */ (__pyx_v_Y_data.data + __pyx_t_18 * __pyx_v_Y_data.strides[0]) )) + __pyx_t_19)) )))) + (__pyx_v_i2 * __pyx_v_n_features));
          |                             ^
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_pf_7sklearn_7metrics_13_dist_metrics_16DistanceMetric32_24_pairwise_dense_sparse’:
    sklearn/metrics/_dist_metrics.c:50127:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    50127 |           __pyx_v_x1_data = ((&(*((__pyx_t_7sklearn_5utils_9_typedefs_float32_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float32_t const  *) ( /* dim=0 */ (__pyx_v_X_data.data + __pyx_t_15 * __pyx_v_X_data.strides[0]) )) + __pyx_t_16)) )))) + (__pyx_v_i1 * __pyx_v_n_features));
          |                           ^
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19EuclideanDistance32_dist_csr’:
    sklearn/metrics/_dist_metrics.c:51773:90: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19EuclideanDistance32_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    51773 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19EuclideanDistance32_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 3667, __pyx_L1_error)
          |                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                          |
          |                                                                                          struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:51403:213: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_EuclideanDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    51403 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19EuclideanDistance32_rdist_csr(CYTHON_UNUSED struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_EuclideanDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_dist’:
    sklearn/metrics/_dist_metrics.c:52278:87: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    52278 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 3716, __pyx_L1_error)
          |                                                                                      ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                       |
          |                                                                                       struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:52179:197: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    52179 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_dist_csr’:
    sklearn/metrics/_dist_metrics.c:53097:91: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    53097 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 3796, __pyx_L1_error)
          |                                                                                          ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                           |
          |                                                                                           struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:52702:201: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    52702 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_20SEuclideanDistance32_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_SEuclideanDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_dist’:
    sklearn/metrics/_dist_metrics.c:54845:86: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    54845 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 4039, __pyx_L1_error)
          |                                                                                     ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                      |
          |                                                                                      struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:54702:195: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    54702 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_dist_csr’:
    sklearn/metrics/_dist_metrics.c:55866:90: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    55866 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 4146, __pyx_L1_error)
          |                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                          |
          |                                                                                          struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:55249:199: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    55249 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19MinkowskiDistance32_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MinkowskiDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_dist’:
    sklearn/metrics/_dist_metrics.c:56509:87: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    56509 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 4223, __pyx_L1_error)
          |                                                                                      ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                       |
          |                                                                                       struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:56420:197: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    56420 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_dist_csr’:
    sklearn/metrics/_dist_metrics.c:57261:91: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    57261 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 4300, __pyx_L1_error)
          |                                                                                          ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                           |
          |                                                                                           struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:56913:201: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    56913 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_20WMinkowskiDistance32_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_WMinkowskiDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_dist’:
    sklearn/metrics/_dist_metrics.c:58263:88: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    58263 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 4385, __pyx_L1_error)
          |                                                                                       ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                        |
          |                                                                                        struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:58110:199: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    58110 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_rdist(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_dist_csr’:
    sklearn/metrics/_dist_metrics.c:59095:92: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    59095 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 4466, __pyx_L1_error)
          |                                                                                           ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                            |
          |                                                                                            struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:58687:203: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    58687 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_21MahalanobisDistance32_rdist_csr(struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_MahalanobisDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size) {
          |                                                                                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_dist’:
    sklearn/metrics/_dist_metrics.c:64151:86: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_rdist’ from incompatible pointer type [-Wincompatible-pointer-types]
    64151 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_rdist(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1, __pyx_v_x2, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 5371, __pyx_L1_error)
          |                                                                                     ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                      |
          |                                                                                      struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:64080:209: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
    64080 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_rdist(CYTHON_UNUSED struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    sklearn/metrics/_dist_metrics.c: In function ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_dist_csr’:
    sklearn/metrics/_dist_metrics.c:64686:90: warning: passing argument 1 of ‘__pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_rdist_csr’ from incompatible pointer type [-Wincompatible-pointer-types]
    64686 |   __pyx_t_1 = __pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_rdist_csr(((struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *)__pyx_v_self), __pyx_v_x1_data, __pyx_v_x1_indices, __pyx_v_x2_data, __pyx_v_x2_indices, __pyx_v_x1_start, __pyx_v_x1_end, __pyx_v_x2_start, __pyx_v_x2_end, __pyx_v_size); if (unlikely(__pyx_t_1 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(1, 5399, __pyx_L1_error)
          |                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          |                                                                                          |
          |                                                                                          struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *
    sklearn/metrics/_dist_metrics.c:4585:213: note: expected ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance32 *’ but argument is of type ‘struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_DistanceMetric32 *’
     4585 | static __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_7metrics_13_dist_metrics_19HaversineDistance32_rdist_csr(CYTHON_UNUSED struct __pyx_obj_7sklearn_7metrics_13_dist_metrics_HaversineDistance32 *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x1_data, __Pyx_memviewslice __pyx_v_x1_indices, __pyx_t_7sklearn_5utils_9_typedefs_float32_t const *__pyx_v_x2_data, __Pyx_memviewslice __pyx_v_x2_indices, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x1_end, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_start, __pyx_t_7sklearn_5utils_9_typedefs_int32_t const __pyx_v_x2_end, CYTHON_UNUSED __pyx_t_7sklearn_5utils_9_typedefs_intp_t const __pyx_v_size); /* proto*/
          |                                                                                                                                             ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~~~
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/metrics/_dist_metrics.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_dist_metrics.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._pairwise_distances_reduction._datasets_pair' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.o -std=c++11 -g0 -O2 -fopenmp
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._pairwise_distances_reduction._middle_term_computer' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.o -std=c++11 -g0 -O2 -fopenmp
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._pairwise_distances_reduction._base' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_pairwise_distances_reduction/_base.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_base.o -std=c++11 -g0 -O2 -fopenmp
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_base.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_base.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._pairwise_distances_reduction._argkmin' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_pairwise_distances_reduction/_argkmin.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin.o -std=c++11 -g0 -O2 -fopenmp
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._pairwise_distances_reduction._argkmin_classmode' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.o -std=c++11 -g0 -O2 -fopenmp
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.metrics._pairwise_distances_reduction._radius_neighbors' extension
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpp -o build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.o -std=c++11 -g0 -O2 -fopenmp
    sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpp: In function ‘void __pyx_f_7sklearn_7metrics_29_pairwise_distances_reduction_17_radius_neighbors_17RadiusNeighbors64_compute_exact_distances(__pyx_obj_7sklearn_7metrics_29_pairwise_distances_reduction_17_radius_neighbors_RadiusNeighbors64*)’:
    sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpp:23847:59: warning: comparison of integer expressions of different signedness: ‘__pyx_t_7sklearn_5utils_9_typedefs_intp_t’ {aka ‘long int’} and ‘std::vector<long int>::size_type’ {aka ‘long unsigned int’} [-Wsign-compare]
    23847 |                             for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
          |                                                 ~~~~~~~~~~^~~~~~~~~~~
    sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpp: In function ‘void __pyx_f_7sklearn_7metrics_29_pairwise_distances_reduction_17_radius_neighbors_17RadiusNeighbors32_compute_exact_distances(__pyx_obj_7sklearn_7metrics_29_pairwise_distances_reduction_17_radius_neighbors_RadiusNeighbors32*)’:
    sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpp:28407:59: warning: comparison of integer expressions of different signedness: ‘__pyx_t_7sklearn_5utils_9_typedefs_intp_t’ {aka ‘long int’} and ‘std::vector<long int>::size_type’ {aka ‘long unsigned int’} [-Wsign-compare]
    28407 |                             for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
          |                                                 ~~~~~~~~~~^~~~~~~~~~~
    g++ -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared build/temp.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.neighbors._ball_tree' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/neighbors/_ball_tree.c -o build/temp.linux-x86_64-cpython-39/sklearn/neighbors/_ball_tree.o -g0 -O2 -fopenmp
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__recursive_build’:
    sklearn/neighbors/_ball_tree.c:30460:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    30460 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_1)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c:30471:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    30471 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_2 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_pf_7sklearn_9neighbors_10_ball_tree_10BinaryTree_22query’:
    sklearn/neighbors/_ball_tree.c:31414:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    31414 |     __pyx_v_pt = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_Xarr.data + __pyx_t_11 * __pyx_v_Xarr.strides[0]) )) + __pyx_t_12)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_pf_7sklearn_9neighbors_10_ball_tree_10BinaryTree_24query_radius’:
    sklearn/neighbors/_ball_tree.c:32905:14: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    32905 |   __pyx_v_pt = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_Xarr.data + __pyx_t_12 * __pyx_v_Xarr.strides[0]) )) + __pyx_t_13)) ))));
          |              ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__query_single_depthfirst’:
    sklearn/neighbors/_ball_tree.c:35982:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    35982 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_2 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:36063:106: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_rdist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36063 |       __pyx_t_4 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_rdist(__pyx_v_self, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_9 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) )))), (__pyx_v_self->data.shape[1])); if (unlikely(__pyx_t_4 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(0, 1614, __pyx_L1_error)
          |                                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30309:307: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30309 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_rdist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__query_single_breadthfirst’:
    sklearn/neighbors/_ball_tree.c:36277:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36277 |   __pyx_v_node_data = (&(*((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_1)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c:36288:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36288 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:36455:108: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_rdist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36455 |         __pyx_t_3 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_rdist(__pyx_v_self, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_11 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) )))), (__pyx_v_self->data.shape[1])); if (unlikely(__pyx_t_3 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(0, 1676, __pyx_L1_error)
          |                                                                                                           ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30309:307: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30309 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_rdist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__query_dual_depthfirst’:
    sklearn/neighbors/_ball_tree.c:36628:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36628 |   __pyx_v_data1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_2 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) ))));
          |                 ^
    sklearn/neighbors/_ball_tree.c:36639:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36639 |   __pyx_v_data2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_other->data.data + __pyx_t_3 * __pyx_v_other->data.strides[0]) )) + __pyx_t_2)) ))));
          |                 ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__query_dual_breadthfirst’:
    sklearn/neighbors/_ball_tree.c:37295:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37295 |   __pyx_v_node_data1 = (&(*((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_8)) ))));
          |                      ^
    sklearn/neighbors/_ball_tree.c:37305:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37305 |   __pyx_v_node_data2 = (&(*((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) __pyx_v_other->node_data.data) + __pyx_t_8)) ))));
          |                      ^
    sklearn/neighbors/_ball_tree.c:37316:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37316 |   __pyx_v_data1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_8 * __pyx_v_self->data.strides[0]) )) + __pyx_t_9)) ))));
          |                 ^
    sklearn/neighbors/_ball_tree.c:37327:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37327 |   __pyx_v_data2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_other->data.data + __pyx_t_9 * __pyx_v_other->data.strides[0]) )) + __pyx_t_8)) ))));
          |                 ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__query_radius_single’:
    sklearn/neighbors/_ball_tree.c:37858:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37858 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:37868:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37868 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__kde_single_breadthfirst’:
    sklearn/neighbors/_ball_tree.c:38373:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38373 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:38401:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38401 |     __pyx_v_sample_weight = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) __pyx_v_self->sample_weight.data) + __pyx_t_2)) ))));
          |                           ^
    sklearn/neighbors/_ball_tree.c:38420:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38420 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c:38430:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38430 |   __pyx_v_node_data = (&(*((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__kde_single_depthfirst’:
    sklearn/neighbors/_ball_tree.c:39276:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39276 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:39286:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39286 |   __pyx_v_node_data = (&(*((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_10_ball_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c:39314:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39314 |     __pyx_v_sample_weight = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) __pyx_v_self->sample_weight.data) + __pyx_t_2)) ))));
          |                           ^
    sklearn/neighbors/_ball_tree.c:39333:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39333 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__two_point_single’:
    sklearn/neighbors/_ball_tree.c:39934:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39934 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:39944:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39944 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__two_point_dual’:
    sklearn/neighbors/_ball_tree.c:40326:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40326 |   __pyx_v_data1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                 ^
    sklearn/neighbors/_ball_tree.c:40337:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40337 |   __pyx_v_data2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_other->data.data + __pyx_t_2 * __pyx_v_other->data.strides[0]) )) + __pyx_t_1)) ))));
          |                 ^
    sklearn/neighbors/_ball_tree.c:40347:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40347 |   __pyx_v_idx_array1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_1)) ))));
          |                      ^
    sklearn/neighbors/_ball_tree.c:40357:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40357 |   __pyx_v_idx_array2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_other->idx_array.data) + __pyx_t_1)) ))));
          |                      ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_init_node’:
    sklearn/neighbors/_ball_tree.c:42459:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42459 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_tree->idx_array.data) + __pyx_t_1)) ))));
          |                     ^
    sklearn/neighbors/_ball_tree.c:42470:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42470 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_tree->data.data + __pyx_t_1 * __pyx_v_tree->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_ball_tree.c:42482:20: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42482 |   __pyx_v_centroid = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree->node_bounds.data + __pyx_t_2 * __pyx_v_tree->node_bounds.strides[0]) ) + __pyx_t_3 * __pyx_v_tree->node_bounds.strides[1]) )) + __pyx_t_1)) ))));
          |                    ^
    sklearn/neighbors/_ball_tree.c:42510:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42510 |     __pyx_v_sample_weight = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) __pyx_v_tree->sample_weight.data) + __pyx_t_1)) ))));
          |                           ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_min_dist’:
    sklearn/neighbors/_ball_tree.c:42852:101: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42852 |   __pyx_t_4 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree->node_bounds.data + __pyx_t_1 * __pyx_v_tree->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (__pyx_v_tree->data.shape[1])); if (unlikely(__pyx_t_4 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 105, __pyx_L1_error)
          |                                                                                                    ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:306: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_max_dist’:
    sklearn/neighbors/_ball_tree.c:42925:101: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42925 |   __pyx_t_4 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree->node_bounds.data + __pyx_t_1 * __pyx_v_tree->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (__pyx_v_tree->data.shape[1])); if (unlikely(__pyx_t_4 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 113, __pyx_L1_error)
          |                                                                                                    ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:306: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_min_max_dist’:
    sklearn/neighbors/_ball_tree.c:42996:101: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42996 |   __pyx_t_4 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree->node_bounds.data + __pyx_t_1 * __pyx_v_tree->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (__pyx_v_tree->data.shape[1])); if (unlikely(__pyx_t_4 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 121, __pyx_L1_error)
          |                                                                                                    ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:306: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_min_dist_dual’:
    sklearn/neighbors/_ball_tree.c:43276:90: warning: passing argument 2 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    43276 |   __pyx_t_7 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree1, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree2->node_bounds.data + __pyx_t_1 * __pyx_v_tree2->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree2->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree1->node_bounds.data + __pyx_t_4 * __pyx_v_tree1->node_bounds.strides[0]) ) + __pyx_t_5 * __pyx_v_tree1->node_bounds.strides[1]) )) + __pyx_t_6)) )))), (__pyx_v_tree1->data.shape[1])); if (unlikely(__pyx_t_7 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 150, __pyx_L1_error)
          |                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:248: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:43276:426: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    43276 |   __pyx_t_7 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree1, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree2->node_bounds.data + __pyx_t_1 * __pyx_v_tree2->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree2->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree1->node_bounds.data + __pyx_t_4 * __pyx_v_tree1->node_bounds.strides[0]) ) + __pyx_t_5 * __pyx_v_tree1->node_bounds.strides[1]) )) + __pyx_t_6)) )))), (__pyx_v_tree1->data.shape[1])); if (unlikely(__pyx_t_7 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 150, __pyx_L1_error)
          |                                                                                                                                                                                                                                                                                                                                                                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:306: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_max_dist_dual’:
    sklearn/neighbors/_ball_tree.c:43374:90: warning: passing argument 2 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    43374 |   __pyx_t_7 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree1, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree2->node_bounds.data + __pyx_t_1 * __pyx_v_tree2->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree2->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree1->node_bounds.data + __pyx_t_4 * __pyx_v_tree1->node_bounds.strides[0]) ) + __pyx_t_5 * __pyx_v_tree1->node_bounds.strides[1]) )) + __pyx_t_6)) )))), (__pyx_v_tree1->data.shape[1])); if (unlikely(__pyx_t_7 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 160, __pyx_L1_error)
          |                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:248: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                          ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:43374:426: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    43374 |   __pyx_t_7 = __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(__pyx_v_tree1, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree2->node_bounds.data + __pyx_t_1 * __pyx_v_tree2->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree2->node_bounds.strides[1]) )) + __pyx_t_3)) )))), (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree1->node_bounds.data + __pyx_t_4 * __pyx_v_tree1->node_bounds.strides[0]) ) + __pyx_t_5 * __pyx_v_tree1->node_bounds.strides[1]) )) + __pyx_t_6)) )))), (__pyx_v_tree1->data.shape[1])); if (unlikely(__pyx_t_7 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(2, 160, __pyx_L1_error)
          |                                                                                                                                                                                                                                                                                                                                                                                                                                         ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_ball_tree.c:30216:306: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30216 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree_dist(struct __pyx_obj_7sklearn_9neighbors_10_ball_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__kde_single_depthfirst’:
    sklearn/neighbors/_ball_tree.c:39549:62: warning: ‘__pyx_v_sample_weight’ may be used uninitialized in this function [-Wmaybe-uninitialized]
    39549 |         __pyx_t_9 = PyFloat_FromDouble((__pyx_v_sample_weight[(__pyx_v_idx_array[__pyx_v_i])])); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2185, __pyx_L1_error)
          |                                                              ^
    sklearn/neighbors/_ball_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_10_ball_tree_10BinaryTree__kde_single_breadthfirst’:
    sklearn/neighbors/_ball_tree.c:38817:65: warning: ‘__pyx_v_sample_weight’ may be used uninitialized in this function [-Wmaybe-uninitialized]
    38817 |           __pyx_t_12 = PyFloat_FromDouble((__pyx_v_sample_weight[(__pyx_v_idx_array[__pyx_v_i])])); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2050, __pyx_L1_error)
          |                                                                 ^
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/neighbors/_ball_tree.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/neighbors/_ball_tree.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.neighbors._kd_tree' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/neighbors/_kd_tree.c -o build/temp.linux-x86_64-cpython-39/sklearn/neighbors/_kd_tree.o -g0 -O2 -fopenmp
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__recursive_build’:
    sklearn/neighbors/_kd_tree.c:30391:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    30391 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_1)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c:30402:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    30402 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_2 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_pf_7sklearn_9neighbors_8_kd_tree_10BinaryTree_22query’:
    sklearn/neighbors/_kd_tree.c:31345:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    31345 |     __pyx_v_pt = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_Xarr.data + __pyx_t_11 * __pyx_v_Xarr.strides[0]) )) + __pyx_t_12)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_pf_7sklearn_9neighbors_8_kd_tree_10BinaryTree_24query_radius’:
    sklearn/neighbors/_kd_tree.c:32836:14: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    32836 |   __pyx_v_pt = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_Xarr.data + __pyx_t_12 * __pyx_v_Xarr.strides[0]) )) + __pyx_t_13)) ))));
          |              ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__query_single_depthfirst’:
    sklearn/neighbors/_kd_tree.c:35913:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    35913 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_2 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:35994:103: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree_rdist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    35994 |       __pyx_t_4 = __pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree_rdist(__pyx_v_self, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_9 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) )))), (__pyx_v_self->data.shape[1])); if (unlikely(__pyx_t_4 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(0, 1614, __pyx_L1_error)
          |                                                                                                      ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_kd_tree.c:30240:301: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30240 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree_rdist(struct __pyx_obj_7sklearn_9neighbors_8_kd_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__query_single_breadthfirst’:
    sklearn/neighbors/_kd_tree.c:36208:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36208 |   __pyx_v_node_data = (&(*((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_1)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c:36219:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36219 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:36386:105: warning: passing argument 3 of ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree_rdist’ discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36386 |         __pyx_t_3 = __pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree_rdist(__pyx_v_self, __pyx_v_pt, (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_11 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) )))), (__pyx_v_self->data.shape[1])); if (unlikely(__pyx_t_3 == ((__pyx_t_7sklearn_5utils_9_typedefs_float64_t)-1.0))) __PYX_ERR(0, 1676, __pyx_L1_error)
          |                                                                                                        ~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sklearn/neighbors/_kd_tree.c:30240:301: note: expected ‘__pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘double *’} but argument is of type ‘const __pyx_t_7sklearn_5utils_9_typedefs_float64_t *’ {aka ‘const double *’}
    30240 | static CYTHON_INLINE __pyx_t_7sklearn_5utils_9_typedefs_float64_t __pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree_rdist(struct __pyx_obj_7sklearn_9neighbors_8_kd_tree_BinaryTree *__pyx_v_self, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x1, __pyx_t_7sklearn_5utils_9_typedefs_float64_t *__pyx_v_x2, __pyx_t_7sklearn_5utils_9_typedefs_intp_t __pyx_v_size) {
          |                                                                                                                                                                                                                                                               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__query_dual_depthfirst’:
    sklearn/neighbors/_kd_tree.c:36559:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36559 |   __pyx_v_data1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_2 * __pyx_v_self->data.strides[0]) )) + __pyx_t_3)) ))));
          |                 ^
    sklearn/neighbors/_kd_tree.c:36570:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    36570 |   __pyx_v_data2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_other->data.data + __pyx_t_3 * __pyx_v_other->data.strides[0]) )) + __pyx_t_2)) ))));
          |                 ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__query_dual_breadthfirst’:
    sklearn/neighbors/_kd_tree.c:37226:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37226 |   __pyx_v_node_data1 = (&(*((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_8)) ))));
          |                      ^
    sklearn/neighbors/_kd_tree.c:37236:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37236 |   __pyx_v_node_data2 = (&(*((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) __pyx_v_other->node_data.data) + __pyx_t_8)) ))));
          |                      ^
    sklearn/neighbors/_kd_tree.c:37247:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37247 |   __pyx_v_data1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_8 * __pyx_v_self->data.strides[0]) )) + __pyx_t_9)) ))));
          |                 ^
    sklearn/neighbors/_kd_tree.c:37258:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37258 |   __pyx_v_data2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_other->data.data + __pyx_t_9 * __pyx_v_other->data.strides[0]) )) + __pyx_t_8)) ))));
          |                 ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__query_radius_single’:
    sklearn/neighbors/_kd_tree.c:37789:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37789 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:37799:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    37799 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__kde_single_breadthfirst’:
    sklearn/neighbors/_kd_tree.c:38304:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38304 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:38332:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38332 |     __pyx_v_sample_weight = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) __pyx_v_self->sample_weight.data) + __pyx_t_2)) ))));
          |                           ^
    sklearn/neighbors/_kd_tree.c:38351:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38351 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c:38361:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    38361 |   __pyx_v_node_data = (&(*((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__kde_single_depthfirst’:
    sklearn/neighbors/_kd_tree.c:39207:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39207 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:39217:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39217 |   __pyx_v_node_data = (&(*((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) ( /* dim=0 */ ((char *) (((struct __pyx_t_7sklearn_9neighbors_8_kd_tree_NodeData_t const  *) __pyx_v_self->node_data.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c:39245:27: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39245 |     __pyx_v_sample_weight = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) __pyx_v_self->sample_weight.data) + __pyx_t_2)) ))));
          |                           ^
    sklearn/neighbors/_kd_tree.c:39264:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39264 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__two_point_single’:
    sklearn/neighbors/_kd_tree.c:39865:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39865 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:39875:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    39875 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_2)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__two_point_dual’:
    sklearn/neighbors/_kd_tree.c:40257:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40257 |   __pyx_v_data1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_self->data.data + __pyx_t_1 * __pyx_v_self->data.strides[0]) )) + __pyx_t_2)) ))));
          |                 ^
    sklearn/neighbors/_kd_tree.c:40268:17: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40268 |   __pyx_v_data2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_other->data.data + __pyx_t_2 * __pyx_v_other->data.strides[0]) )) + __pyx_t_1)) ))));
          |                 ^
    sklearn/neighbors/_kd_tree.c:40278:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40278 |   __pyx_v_idx_array1 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_self->idx_array.data) + __pyx_t_1)) ))));
          |                      ^
    sklearn/neighbors/_kd_tree.c:40288:22: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    40288 |   __pyx_v_idx_array2 = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_other->idx_array.data) + __pyx_t_1)) ))));
          |                      ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_init_node’:
    sklearn/neighbors/_kd_tree.c:42387:24: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42387 |   __pyx_v_lower_bounds = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree->node_bounds.data + __pyx_t_1 * __pyx_v_tree->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree->node_bounds.strides[1]) )) + __pyx_t_3)) ))));
          |                        ^
    sklearn/neighbors/_kd_tree.c:42399:24: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42399 |   __pyx_v_upper_bounds = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=2 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_tree->node_bounds.data + __pyx_t_3 * __pyx_v_tree->node_bounds.strides[0]) ) + __pyx_t_2 * __pyx_v_tree->node_bounds.strides[1]) )) + __pyx_t_1)) ))));
          |                        ^
    sklearn/neighbors/_kd_tree.c:42410:16: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42410 |   __pyx_v_data = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=1 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_float64_t const  *) ( /* dim=0 */ (__pyx_v_tree->data.data + __pyx_t_1 * __pyx_v_tree->data.strides[0]) )) + __pyx_t_3)) ))));
          |                ^
    sklearn/neighbors/_kd_tree.c:42420:21: warning: assignment discards ‘const’ qualifier from pointer target type [-Wdiscarded-qualifiers]
    42420 |   __pyx_v_idx_array = (&(*((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) ( /* dim=0 */ ((char *) (((__pyx_t_7sklearn_5utils_9_typedefs_intp_t const  *) __pyx_v_tree->idx_array.data) + __pyx_t_3)) ))));
          |                     ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__kde_single_breadthfirst’:
    sklearn/neighbors/_kd_tree.c:38748:65: warning: ‘__pyx_v_sample_weight’ may be used uninitialized in this function [-Wmaybe-uninitialized]
    38748 |           __pyx_t_12 = PyFloat_FromDouble((__pyx_v_sample_weight[(__pyx_v_idx_array[__pyx_v_i])])); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 2050, __pyx_L1_error)
          |                                                                 ^
    sklearn/neighbors/_kd_tree.c: In function ‘__pyx_f_7sklearn_9neighbors_8_kd_tree_10BinaryTree__kde_single_depthfirst’:
    sklearn/neighbors/_kd_tree.c:39480:62: warning: ‘__pyx_v_sample_weight’ may be used uninitialized in this function [-Wmaybe-uninitialized]
    39480 |         __pyx_t_9 = PyFloat_FromDouble((__pyx_v_sample_weight[(__pyx_v_idx_array[__pyx_v_i])])); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 2185, __pyx_L1_error)
          |                                                              ^
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/neighbors/_kd_tree.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/neighbors/_kd_tree.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.utils._seq_dataset' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/utils/_seq_dataset.c -o build/temp.linux-x86_64-cpython-39/sklearn/utils/_seq_dataset.o -g0 -O2 -fopenmp
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/utils/_seq_dataset.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/utils/_seq_dataset.cpython-39-x86_64-linux-gnu.so -fopenmp
    building 'sklearn.utils._weight_vector' extension
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -I/opt/miniconda3/envs/testbed/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c sklearn/utils/_weight_vector.c -o build/temp.linux-x86_64-cpython-39/sklearn/utils/_weight_vector.o -g0 -O2 -fopenmp
    gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib build/temp.linux-x86_64-cpython-39/sklearn/utils/_weight_vector.o -Lbuild/temp.linux-x86_64-cpython-39 -lm -llibsvm-skl -lliblinear-skl -o build/lib.linux-x86_64-cpython-39/sklearn/utils/_weight_vector.cpython-39-x86_64-linux-gnu.so -fopenmp
    copying build/lib.linux-x86_64-cpython-39/sklearn/_loss/_loss.cpython-39-x86_64-linux-gnu.so -> sklearn/_loss
    copying build/lib.linux-x86_64-cpython-39/sklearn/cluster/_hierarchical_fast.cpython-39-x86_64-linux-gnu.so -> sklearn/cluster
    copying build/lib.linux-x86_64-cpython-39/sklearn/linear_model/_sgd_fast.cpython-39-x86_64-linux-gnu.so -> sklearn/linear_model
    copying build/lib.linux-x86_64-cpython-39/sklearn/linear_model/_sag_fast.cpython-39-x86_64-linux-gnu.so -> sklearn/linear_model
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_dist_metrics.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_datasets_pair.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics/_pairwise_distances_reduction
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_middle_term_computer.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics/_pairwise_distances_reduction
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_base.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics/_pairwise_distances_reduction
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics/_pairwise_distances_reduction
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_argkmin_classmode.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics/_pairwise_distances_reduction
    copying build/lib.linux-x86_64-cpython-39/sklearn/metrics/_pairwise_distances_reduction/_radius_neighbors.cpython-39-x86_64-linux-gnu.so -> sklearn/metrics/_pairwise_distances_reduction
    copying build/lib.linux-x86_64-cpython-39/sklearn/neighbors/_ball_tree.cpython-39-x86_64-linux-gnu.so -> sklearn/neighbors
    copying build/lib.linux-x86_64-cpython-39/sklearn/neighbors/_kd_tree.cpython-39-x86_64-linux-gnu.so -> sklearn/neighbors
    copying build/lib.linux-x86_64-cpython-39/sklearn/utils/_seq_dataset.cpython-39-x86_64-linux-gnu.so -> sklearn/utils
    copying build/lib.linux-x86_64-cpython-39/sklearn/utils/_weight_vector.cpython-39-x86_64-linux-gnu.so -> sklearn/utils
    Creating /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/scikit-learn.egg-link (link to .)
    Adding scikit-learn 1.3.dev0 to easy-install.pth file

    Installed /testbed
Successfully installed scikit-learn
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-10-04 04:58:41,672 - thread-139911184823872.app.lang_graph.nodes.issue_bug_reproduction_context_message_node - DEBUG - Sending query to context provider subgraph:
Issue title:
Thresholds can exceed 1 in `roc_curve` while providing probability estimate

Issue description: 
While working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:

```python
def test_roc_curve_with_probablity_estimates():
    rng = np.random.RandomState(42)
    y_true = rng.randint(0, 2, size=10)
    y_score = rng.rand(10)
    _, _, thresholds = roc_curve(y_true, y_score)
    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()
```

The reason is due to the following:

https://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086

Basically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.

I am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-10-04 04:58:41,672 - thread-139911184823872.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Enter context retrieval subgraph
2025-10-04 04:58:41,673 - thread-139911184823872.app.lang_graph.nodes.context_query_message_node - DEBUG - Sending query to ContextProviderNode:
content='Issue title:\nThresholds can exceed 1 in `roc_curve` while providing probability estimate\n\nIssue description: \nWhile working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:\n\n```python\ndef test_roc_curve_with_probablity_estimates():\n    rng = np.random.RandomState(42)\n    y_true = rng.randint(0, 2, size=10)\n    y_score = rng.rand(10)\n    _, _, thresholds = roc_curve(y_true, y_score)\n    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()\n```\n\nThe reason is due to the following:\n\nhttps://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086\n\nBasically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.\n\nI am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.\n\nIssue comments:\n\n\nOBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,\nincluding ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.\n\n<reasoning>\n1. Analyze bug characteristics:\n   - Core functionality being tested\n   - Input parameters and configurations\n   - Expected error conditions\n   - Environmental dependencies\n\n2. Search requirements:\n   - Required imports and dependencies\n   - Test files exercising similar functionality\n   - Mock/fixture setup patterns\n   - Assertion styles\n   - Error handling tests\n\n3. Focus areas:\n   - All necessary imports (standard library, testing frameworks, mocking utilities)\n   - Dependencies and third-party packages\n   - Test setup and teardown\n   - Mock object configuration\n   - Network/external service simulation\n   - Error condition verification\n</reasoning>\n\nREQUIREMENTS:\n- Return 5 complete, self-contained test cases most similar to bug scenario\n- Must include ALL necessary imports at the start of each test file\n- Must include full test method implementation\n- Must include ALL mock/fixture setup\n- Must include helper functions used by test\n- Must preserve exact file paths and line numbers\n\n<examples>\n<example id="database-timeout">\n<bug>\ndb.execute("SELECT * FROM users").fetchall() \nraises ConnectionTimeout when load is high\n</bug>\n\n<ideal_test_match>\n# File: tests/test_database.py\nimport pytest\nfrom unittest.mock import Mock, patch\nfrom database.exceptions import ConnectionTimeout\nfrom database.models import QueryResult\nfrom database.client import DatabaseClient\n\nclass TestDatabaseTimeout:\n    @pytest.fixture\n    def mock_db_connection(self):\n        conn = Mock()\n        conn.execute.side_effect = [\n            ConnectionTimeout("Connection timed out"),\n            QueryResult(["user1", "user2"])  # Second try succeeds\n        ]\n        return conn\n        \n    def test_handle_timeout_during_query(self, mock_db_connection):\n        # Complete test showing timeout scenario\n        # Including retry logic verification\n        # With all necessary assertions\n</ideal_test_match>\n</example>\n\n<example id="file-permission">\n<bug>\nFileProcessor(\'/root/data.txt\').process() \nfails with PermissionError\n</bug>\n\n<ideal_test_match>\n# File: tests/test_file_processor.py\nimport os\nimport pytest\nfrom unittest.mock import patch, mock_open\nfrom file_processor import FileProcessor\nfrom file_processor.exceptions import ProcessingError\n\nclass TestFilePermissions:\n    @patch(\'os.access\')\n    @patch(\'builtins.open\')\n    def test_file_permission_denied(self, mock_open, mock_access):\n        # Full test setup with mocked file system\n        # Permission denial simulation\n        # Error handling verification\n</ideal_test_match>\n</example>\n\nSearch priority:\n1. Tests of exact same functionality (including import patterns)\n2. Tests with similar error conditions\n3. Tests with comparable mocking patterns\n4. Tests demonstrating similar assertions\n\nFind the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.\n' additional_kwargs={} response_metadata={}
2025-10-04 04:58:48,144 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='I will begin by exploring the `sklearn/metrics/tests/test_ranking.py` file to locate existing tests for the `roc_curve` function. My plan is to identify all the function definitions within this file and then filter them to find those that are relevant to `roc_curve`. This will help me find test cases that are similar to the one described in the issue.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"type": "function_definition", "relative_path": "sklearn/metrics/tests/test_ranking.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 17879, 'candidates_token_count': 118, 'total_token_count': 18454, 'prompt_tokens_details': [{'modality': 1, 'token_count': 17879}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 118}], 'thoughts_token_count': 457, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.45848519923323294, 'model_name': 'gemini-2.5-pro'} id='run--76dec487-bfd7-4930-b435-87669b3fc0e1-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'type': 'function_definition', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '23530fd7-c84c-4cf6-818a-ddbe0ce03b23', 'type': 'tool_call'}] usage_metadata={'input_tokens': 17879, 'output_tokens': 118, 'total_tokens': 18454, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 457}}
2025-10-04 04:58:52,439 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sklearn/metrics/tests/test_ranking.py"}'}, '__gemini_function_call_thought_signatures__': {'e0cf9468-32dd-4369-9bb2-28e32585b21d': 'CqACAR/MhbYVc8PBXUKdyTnjuA8nfmM6zKtCR2xMDcYA/zrjVXVru1HEuzAPD3293EXSo0jSXsdnxuMCMa6QCabPFyFynivhcn5La5NkOHrQlYZbRa4Qz+addFLcvRta9NmhlUa+oTABoVRY9Jx9HzMBRvuYo5Sz5UYNS10LgnStMI4e0YkFcLhZoR3sTCHuj+LGH2jgdtHnrH53PPt/idVAIhtTsKji8Vcwc/9YL1FJnKOKN+PS1EtFLfQdL6JnX8gZOHKOsekOlCgEvBeuFasLnaFt4E7i2n5OkEJEf1HvIRfNYV73fxJbxHkKgfUgBYHimd33qvPU3PGWxmm7mN2VuYzIg1xXxG78d4cH7HxL6yiiyCra39Du1+kse/6xmgDt'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18917, 'candidates_token_count': 26, 'total_token_count': 19144, 'cached_content_token_count': 17536, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18917}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17536}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 201}, 'finish_reason': 'STOP', 'avg_logprobs': -0.907461899977464, 'model_name': 'gemini-2.5-pro'} id='run--5c20d510-7ca7-4e00-8ed5-1d68b36ecaeb-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': 'e0cf9468-32dd-4369-9bb2-28e32585b21d', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18917, 'output_tokens': 26, 'total_tokens': 19144, 'input_token_details': {'cache_read': 17536}, 'output_token_details': {'reasoning': 201}}
2025-10-04 05:00:16,385 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3772, 'end_index': 4007, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 3988, 'end_index': 4280, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 4541, 'end_index': 4783, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 4669, 'end_index': 4935, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 4820, 'end_index': 5241, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 5481, 'end_index': 6449, 'uri': 'https://gemfury.com/stream/python:scikit-learn/-/content/metrics/tests/test_classification.py', 'title': '', 'license_': ''}, {'start_index': 6532, 'end_index': 6796, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 6798, 'end_index': 7278, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 7278, 'end_index': 7703, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 7607, 'end_index': 7922, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 7827, 'end_index': 8124, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 8010, 'end_index': 8373, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 8265, 'end_index': 8781, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 8927, 'end_index': 9291, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 9575, 'end_index': 9855, 'uri': 'https://github.com/mars-project/mars', 'license_': 'Apache-2.0', 'title': ''}, {'start_index': 10519, 'end_index': 10754, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 10735, 'end_index': 11027, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 11288, 'end_index': 11530, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 11416, 'end_index': 11682, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 11567, 'end_index': 11988, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 12228, 'end_index': 13196, 'uri': 'https://gemfury.com/stream/python:scikit-learn/-/content/metrics/tests/test_classification.py', 'title': '', 'license_': ''}, {'start_index': 13279, 'end_index': 13543, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 13545, 'end_index': 14025, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14025, 'end_index': 14450, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14354, 'end_index': 14669, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14574, 'end_index': 14871, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14757, 'end_index': 15120, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 15012, 'end_index': 15530, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 15676, 'end_index': 16040, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 16324, 'end_index': 16604, 'uri': 'https://github.com/mars-project/mars', 'license_': 'Apache-2.0', 'title': ''}]}, 'usage_metadata': {'prompt_token_count': 27651, 'total_token_count': 27651, 'cached_content_token_count': 26144, 'prompt_tokens_details': [{'modality': 1, 'token_count': 27707}], 'cache_tokens_details': [{'modality': 1, 'token_count': 26144}], 'candidates_token_count': 0, 'thoughts_token_count': 0, 'candidates_tokens_details': []}, 'finish_reason': 'RECITATION', 'model_name': 'gemini-2.5-pro'} id='run--6a095f1a-ce0f-4f92-a43a-ebb257b95100-0' usage_metadata={'input_tokens': 27651, 'output_tokens': 0, 'total_tokens': 27651, 'input_token_details': {'cache_read': 26144}}
2025-10-04 05:00:16,386 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 05:00:16,386 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Thresholds can exceed 1 in `roc_curve` while providing probability estimate

Issue description: 
While working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:

```python
def test_roc_curve_with_probablity_estimates():
    rng = np.random.RandomState(42)
    y_true = rng.randint(0, 2, size=10)
    y_score = rng.rand(10)
    _, _, thresholds = roc_curve(y_true, y_score)
    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()
```

The reason is due to the following:

https://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086

Basically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.

I am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sklearn/metrics/tests/test_ranking.py
Line number range: 1576 - 1577
Content:
def test_lrap_error_raised():
    check_lrap_error_raised(label_ranking_average_precision_score)

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1814 - 1818
Content:
def test_ndcg_ignore_ties_with_k():
    a = np.arange(12).reshape((2, 6))
    assert ndcg_score(a, a, k=3, ignore_ties=True) == pytest.approx(
        ndcg_score(a, a, k=3, ignore_ties=True)
    )

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1260 - 1265
Content:
def test_det_curve_sanity_check():
    # Exactly duplicated inputs yield the same result.
    assert_allclose(
        det_curve([0, 0, 1], [0, 0.5, 1]),
        det_curve([0, 0, 0, 0, 1, 1], [0, 0, 0.5, 0.5, 1, 1]),
    )

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1775 - 1780
Content:
def test_dcg_score():
    _, y_true = make_multilabel_classification(random_state=0, n_classes=10)
    y_score = -y_true + 1
    _test_dcg_score_for(y_true, y_score)
    y_true, y_score = np.random.RandomState(0).random_sample((2, 100, 10))
    _test_dcg_score_for(y_true, y_score)

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1 - 500
Content:
1. import re
2. import pytest
3. import numpy as np
4. import warnings
5. from scipy.sparse import csr_matrix
6. from scipy import stats
7. 
8. from sklearn import datasets
9. from sklearn import svm
10. 
11. from sklearn.utils.extmath import softmax
12. from sklearn.datasets import make_multilabel_classification
13. from sklearn.random_projection import _sparse_random_matrix
14. from sklearn.utils.validation import check_array, check_consistent_length
15. from sklearn.utils.validation import check_random_state
16. 
17. from sklearn.utils._testing import assert_allclose
18. from sklearn.utils._testing import assert_almost_equal
19. from sklearn.utils._testing import assert_array_equal
20. from sklearn.utils._testing import assert_array_almost_equal
21. 
22. from sklearn.metrics import accuracy_score
23. from sklearn.metrics import auc
24. from sklearn.metrics import average_precision_score
25. from sklearn.metrics import coverage_error
26. from sklearn.metrics import det_curve
27. from sklearn.metrics import label_ranking_average_precision_score
28. from sklearn.metrics import precision_recall_curve
29. from sklearn.metrics import label_ranking_loss
30. from sklearn.metrics import roc_auc_score
31. from sklearn.metrics import roc_curve
32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores
33. from sklearn.metrics import ndcg_score, dcg_score
34. from sklearn.metrics import top_k_accuracy_score
35. 
36. from sklearn.exceptions import UndefinedMetricWarning
37. from sklearn.model_selection import train_test_split
38. from sklearn.linear_model import LogisticRegression
39. from sklearn.preprocessing import label_binarize
40. 
41. 
42. ###############################################################################
43. # Utilities for testing
44. 
45. CURVE_FUNCS = [
46.     det_curve,
47.     precision_recall_curve,
48.     roc_curve,
49. ]
50. 
51. 
52. def make_prediction(dataset=None, binary=False):
53.     """Make some classification predictions on a toy dataset using a SVC
54. 
55.     If binary is True restrict to a binary classification problem instead of a
56.     multiclass classification problem
57.     """
58. 
59.     if dataset is None:
60.         # import some data to play with
61.         dataset = datasets.load_iris()
62. 
63.     X = dataset.data
64.     y = dataset.target
65. 
66.     if binary:
67.         # restrict to a binary classification task
68.         X, y = X[y < 2], y[y < 2]
69. 
70.     n_samples, n_features = X.shape
71.     p = np.arange(n_samples)
72. 
73.     rng = check_random_state(37)
74.     rng.shuffle(p)
75.     X, y = X[p], y[p]
76.     half = int(n_samples / 2)
77. 
78.     # add noisy features to make the problem harder and avoid perfect results
79.     rng = np.random.RandomState(0)
80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]
81. 
82.     # run classifier, get class probabilities and label predictions
83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)
84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])
85. 
86.     if binary:
87.         # only interested in probabilities of the positive case
88.         # XXX: do we really want a special API for the binary case?
89.         y_score = y_score[:, 1]
90. 
91.     y_pred = clf.predict(X[half:])
92.     y_true = y[half:]
93.     return y_true, y_pred, y_score
94. 
95. 
96. ###############################################################################
97. # Tests
98. 
99. 
100. def _auc(y_true, y_score):
101.     """Alternative implementation to check for correctness of
102.     `roc_auc_score`."""
103.     pos_label = np.unique(y_true)[1]
104. 
105.     # Count the number of times positive samples are correctly ranked above
106.     # negative samples.
107.     pos = y_score[y_true == pos_label]
108.     neg = y_score[y_true != pos_label]
109.     diff_matrix = pos.reshape(1, -1) - neg.reshape(-1, 1)
110.     n_correct = np.sum(diff_matrix > 0)
111. 
112.     return n_correct / float(len(pos) * len(neg))
113. 
114. 
115. def _average_precision(y_true, y_score):
116.     """Alternative implementation to check for correctness of
117.     `average_precision_score`.
118. 
119.     Note that this implementation fails on some edge cases.
120.     For example, for constant predictions e.g. [0.5, 0.5, 0.5],
121.     y_true = [1, 0, 0] returns an average precision of 0.33...
122.     but y_true = [0, 0, 1] returns 1.0.
123.     """
124.     pos_label = np.unique(y_true)[1]
125.     n_pos = np.sum(y_true == pos_label)
126.     order = np.argsort(y_score)[::-1]
127.     y_score = y_score[order]
128.     y_true = y_true[order]
129. 
130.     score = 0
131.     for i in range(len(y_score)):
132.         if y_true[i] == pos_label:
133.             # Compute precision up to document i
134.             # i.e, percentage of relevant documents up to document i.
135.             prec = 0
136.             for j in range(0, i + 1):
137.                 if y_true[j] == pos_label:
138.                     prec += 1.0
139.             prec /= i + 1.0
140.             score += prec
141. 
142.     return score / n_pos
143. 
144. 
145. def _average_precision_slow(y_true, y_score):
146.     """A second alternative implementation of average precision that closely
147.     follows the Wikipedia article's definition (see References). This should
148.     give identical results as `average_precision_score` for all inputs.
149. 
150.     References
151.     ----------
152.     .. [1] `Wikipedia entry for the Average precision
153.        <https://en.wikipedia.org/wiki/Average_precision>`_
154.     """
155.     precision, recall, threshold = precision_recall_curve(y_true, y_score)
156.     precision = list(reversed(precision))
157.     recall = list(reversed(recall))
158.     average_precision = 0
159.     for i in range(1, len(precision)):
160.         average_precision += precision[i] * (recall[i] - recall[i - 1])
161.     return average_precision
162. 
163. 
164. def _partial_roc_auc_score(y_true, y_predict, max_fpr):
165.     """Alternative implementation to check for correctness of `roc_auc_score`
166.     with `max_fpr` set.
167.     """
168. 
169.     def _partial_roc(y_true, y_predict, max_fpr):
170.         fpr, tpr, _ = roc_curve(y_true, y_predict)
171.         new_fpr = fpr[fpr <= max_fpr]
172.         new_fpr = np.append(new_fpr, max_fpr)
173.         new_tpr = tpr[fpr <= max_fpr]
174.         idx_out = np.argmax(fpr > max_fpr)
175.         idx_in = idx_out - 1
176.         x_interp = [fpr[idx_in], fpr[idx_out]]
177.         y_interp = [tpr[idx_in], tpr[idx_out]]
178.         new_tpr = np.append(new_tpr, np.interp(max_fpr, x_interp, y_interp))
179.         return (new_fpr, new_tpr)
180. 
181.     new_fpr, new_tpr = _partial_roc(y_true, y_predict, max_fpr)
182.     partial_auc = auc(new_fpr, new_tpr)
183. 
184.     # Formula (5) from McClish 1989
185.     fpr1 = 0
186.     fpr2 = max_fpr
187.     min_area = 0.5 * (fpr2 - fpr1) * (fpr2 + fpr1)
188.     max_area = fpr2 - fpr1
189.     return 0.5 * (1 + (partial_auc - min_area) / (max_area - min_area))
190. 
191. 
192. @pytest.mark.parametrize("drop", [True, False])
193. def test_roc_curve(drop):
194.     # Test Area under Receiver Operating Characteristic (ROC) curve
195.     y_true, _, y_score = make_prediction(binary=True)
196.     expected_auc = _auc(y_true, y_score)
197. 
198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)
199.     roc_auc = auc(fpr, tpr)
200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)
201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))
202.     assert fpr.shape == tpr.shape
203.     assert fpr.shape == thresholds.shape
204. 
205. 
206. def test_roc_curve_end_points():
207.     # Make sure that roc_curve returns a curve start at 0 and ending and
208.     # 1 even in corner cases
209.     rng = np.random.RandomState(0)
210.     y_true = np.array([0] * 50 + [1] * 50)
211.     y_pred = rng.randint(3, size=100)
212.     fpr, tpr, thr = roc_curve(y_true, y_pred, drop_intermediate=True)
213.     assert fpr[0] == 0
214.     assert fpr[-1] == 1
215.     assert fpr.shape == tpr.shape
216.     assert fpr.shape == thr.shape
217. 
218. 
219. def test_roc_returns_consistency():
220.     # Test whether the returned threshold matches up with tpr
221.     # make small toy dataset
222.     y_true, _, y_score = make_prediction(binary=True)
223.     fpr, tpr, thresholds = roc_curve(y_true, y_score)
224. 
225.     # use the given thresholds to determine the tpr
226.     tpr_correct = []
227.     for t in thresholds:
228.         tp = np.sum((y_score >= t) & y_true)
229.         p = np.sum(y_true)
230.         tpr_correct.append(1.0 * tp / p)
231. 
232.     # compare tpr and tpr_correct to see if the thresholds' order was correct
233.     assert_array_almost_equal(tpr, tpr_correct, decimal=2)
234.     assert fpr.shape == tpr.shape
235.     assert fpr.shape == thresholds.shape
236. 
237. 
238. def test_roc_curve_multi():
239.     # roc_curve not applicable for multi-class problems
240.     y_true, _, y_score = make_prediction(binary=False)
241. 
242.     with pytest.raises(ValueError):
243.         roc_curve(y_true, y_score)
244. 
245. 
246. def test_roc_curve_confidence():
247.     # roc_curve for confidence scores
248.     y_true, _, y_score = make_prediction(binary=True)
249. 
250.     fpr, tpr, thresholds = roc_curve(y_true, y_score - 0.5)
251.     roc_auc = auc(fpr, tpr)
252.     assert_array_almost_equal(roc_auc, 0.90, decimal=2)
253.     assert fpr.shape == tpr.shape
254.     assert fpr.shape == thresholds.shape
255. 
256. 
257. def test_roc_curve_hard():
258.     # roc_curve for hard decisions
259.     y_true, pred, y_score = make_prediction(binary=True)
260. 
261.     # always predict one
262.     trivial_pred = np.ones(y_true.shape)
263.     fpr, tpr, thresholds = roc_curve(y_true, trivial_pred)
264.     roc_auc = auc(fpr, tpr)
265.     assert_array_almost_equal(roc_auc, 0.50, decimal=2)
266.     assert fpr.shape == tpr.shape
267.     assert fpr.shape == thresholds.shape
268. 
269.     # always predict zero
270.     trivial_pred = np.zeros(y_true.shape)
271.     fpr, tpr, thresholds = roc_curve(y_true, trivial_pred)
272.     roc_auc = auc(fpr, tpr)
273.     assert_array_almost_equal(roc_auc, 0.50, decimal=2)
274.     assert fpr.shape == tpr.shape
275.     assert fpr.shape == thresholds.shape
276. 
277.     # hard decisions
278.     fpr, tpr, thresholds = roc_curve(y_true, pred)
279.     roc_auc = auc(fpr, tpr)
280.     assert_array_almost_equal(roc_auc, 0.78, decimal=2)
281.     assert fpr.shape == tpr.shape
282.     assert fpr.shape == thresholds.shape
283. 
284. 
285. def test_roc_curve_one_label():
286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]
288.     # assert there are warnings
289.     expected_message = (
290.         "No negative samples in y_true, false positive value should be meaningless"
291.     )
292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)
294. 
295.     # all true labels, all fpr should be nan
296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))
297.     assert fpr.shape == tpr.shape
298.     assert fpr.shape == thresholds.shape
299. 
300.     # assert there are warnings
301.     expected_message = (
302.         "No positive samples in y_true, true positive value should be meaningless"
303.     )
304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)
306.     # all negative labels, all tpr should be nan
307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))
308.     assert fpr.shape == tpr.shape
309.     assert fpr.shape == thresholds.shape
310. 
311. 
312. def test_roc_curve_toydata():
313.     # Binary classification
314.     y_true = [0, 1]
315.     y_score = [0, 1]
316.     tpr, fpr, _ = roc_curve(y_true, y_score)
317.     roc_auc = roc_auc_score(y_true, y_score)
318.     assert_array_almost_equal(tpr, [0, 0, 1])
319.     assert_array_almost_equal(fpr, [0, 1, 1])
320.     assert_almost_equal(roc_auc, 1.0)
321. 
322.     y_true = [0, 1]
323.     y_score = [1, 0]
324.     tpr, fpr, _ = roc_curve(y_true, y_score)
325.     roc_auc = roc_auc_score(y_true, y_score)
326.     assert_array_almost_equal(tpr, [0, 1, 1])
327.     assert_array_almost_equal(fpr, [0, 0, 1])
328.     assert_almost_equal(roc_auc, 0.0)
329. 
330.     y_true = [1, 0]
331.     y_score = [1, 1]
332.     tpr, fpr, _ = roc_curve(y_true, y_score)
333.     roc_auc = roc_auc_score(y_true, y_score)
334.     assert_array_almost_equal(tpr, [0, 1])
335.     assert_array_almost_equal(fpr, [0, 1])
336.     assert_almost_equal(roc_auc, 0.5)
337. 
338.     y_true = [1, 0]
339.     y_score = [1, 0]
340.     tpr, fpr, _ = roc_curve(y_true, y_score)
341.     roc_auc = roc_auc_score(y_true, y_score)
342.     assert_array_almost_equal(tpr, [0, 0, 1])
343.     assert_array_almost_equal(fpr, [0, 1, 1])
344.     assert_almost_equal(roc_auc, 1.0)
345. 
346.     y_true = [1, 0]
347.     y_score = [0.5, 0.5]
348.     tpr, fpr, _ = roc_curve(y_true, y_score)
349.     roc_auc = roc_auc_score(y_true, y_score)
350.     assert_array_almost_equal(tpr, [0, 1])
351.     assert_array_almost_equal(fpr, [0, 1])
352.     assert_almost_equal(roc_auc, 0.5)
353. 
354.     y_true = [0, 0]
355.     y_score = [0.25, 0.75]
356.     # assert UndefinedMetricWarning because of no positive sample in y_true
357.     expected_message = (
358.         "No positive samples in y_true, true positive value should be meaningless"
359.     )
360.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
361.         tpr, fpr, _ = roc_curve(y_true, y_score)
362. 
363.     with pytest.raises(ValueError):
364.         roc_auc_score(y_true, y_score)
365.     assert_array_almost_equal(tpr, [0.0, 0.5, 1.0])
366.     assert_array_almost_equal(fpr, [np.nan, np.nan, np.nan])
367. 
368.     y_true = [1, 1]
369.     y_score = [0.25, 0.75]
370.     # assert UndefinedMetricWarning because of no negative sample in y_true
371.     expected_message = (
372.         "No negative samples in y_true, false positive value should be meaningless"
373.     )
374.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
375.         tpr, fpr, _ = roc_curve(y_true, y_score)
376. 
377.     with pytest.raises(ValueError):
378.         roc_auc_score(y_true, y_score)
379.     assert_array_almost_equal(tpr, [np.nan, np.nan, np.nan])
380.     assert_array_almost_equal(fpr, [0.0, 0.5, 1.0])
381. 
382.     # Multi-label classification task
383.     y_true = np.array([[0, 1], [0, 1]])
384.     y_score = np.array([[0, 1], [0, 1]])
385.     with pytest.raises(ValueError):
386.         roc_auc_score(y_true, y_score, average="macro")
387.     with pytest.raises(ValueError):
388.         roc_auc_score(y_true, y_score, average="weighted")
389.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 1.0)
390.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 1.0)
391. 
392.     y_true = np.array([[0, 1], [0, 1]])
393.     y_score = np.array([[0, 1], [1, 0]])
394.     with pytest.raises(ValueError):
395.         roc_auc_score(y_true, y_score, average="macro")
396.     with pytest.raises(ValueError):
397.         roc_auc_score(y_true, y_score, average="weighted")
398.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 0.5)
399.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 0.5)
400. 
401.     y_true = np.array([[1, 0], [0, 1]])
402.     y_score = np.array([[0, 1], [1, 0]])
403.     assert_almost_equal(roc_auc_score(y_true, y_score, average="macro"), 0)
404.     assert_almost_equal(roc_auc_score(y_true, y_score, average="weighted"), 0)
405.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 0)
406.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 0)
407. 
408.     y_true = np.array([[1, 0], [0, 1]])
409.     y_score = np.array([[0.5, 0.5], [0.5, 0.5]])
410.     assert_almost_equal(roc_auc_score(y_true, y_score, average="macro"), 0.5)
411.     assert_almost_equal(roc_auc_score(y_true, y_score, average="weighted"), 0.5)
412.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 0.5)
413.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 0.5)
414. 
415. 
416. def test_roc_curve_drop_intermediate():
417.     # Test that drop_intermediate drops the correct thresholds
418.     y_true = [0, 0, 0, 0, 1, 1]
419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]
420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])
422. 
423.     # Test dropping thresholds with repeating scores
424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]
425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]
426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])
428. 
429. 
430. def test_roc_curve_fpr_tpr_increasing():
431.     # Ensure that fpr and tpr returned by roc_curve are increasing.
432.     # Construct an edge case with float y_score and sample_weight
433.     # when some adjacent values of fpr and tpr are actually the same.
434.     y_true = [0, 0, 1, 1, 1]
435.     y_score = [0.1, 0.7, 0.3, 0.4, 0.5]
436.     sample_weight = np.repeat(0.2, 5)
437.     fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=sample_weight)
438.     assert (np.diff(fpr) < 0).sum() == 0
439.     assert (np.diff(tpr) < 0).sum() == 0
440. 
441. 
442. def test_auc():
443.     # Test Area Under Curve (AUC) computation
444.     x = [0, 1]
445.     y = [0, 1]
446.     assert_array_almost_equal(auc(x, y), 0.5)
447.     x = [1, 0]
448.     y = [0, 1]
449.     assert_array_almost_equal(auc(x, y), 0.5)
450.     x = [1, 0, 0]
451.     y = [0, 1, 1]
452.     assert_array_almost_equal(auc(x, y), 0.5)
453.     x = [0, 1]
454.     y = [1, 1]
455.     assert_array_almost_equal(auc(x, y), 1)
456.     x = [0, 0.5, 1]
457.     y = [0, 0.5, 1]
458.     assert_array_almost_equal(auc(x, y), 0.5)
459. 
460. 
461. def test_auc_errors():
462.     # Incompatible shapes
463.     with pytest.raises(ValueError):
464.         auc([0.0, 0.5, 1.0], [0.1, 0.2])
465. 
466.     # Too few x values
467.     with pytest.raises(ValueError):
468.         auc([0.0], [0.1])
469. 
470.     # x is not in order
471.     x = [2, 1, 3, 4]
472.     y = [5, 6, 7, 8]
473.     error_message = "x is neither increasing nor decreasing : {}".format(np.array(x))
474.     with pytest.raises(ValueError, match=re.escape(error_message)):
475.         auc(x, y)
476. 
477. 
478. @pytest.mark.parametrize(
479.     "y_true, labels",
480.     [
481.         (np.array([0, 1, 0, 2]), [0, 1, 2]),
482.         (np.array([0, 1, 0, 2]), None),
483.         (["a", "b", "a", "c"], ["a", "b", "c"]),
484.         (["a", "b", "a", "c"], None),
485.     ],
486. )
487. def test_multiclass_ovo_roc_auc_toydata(y_true, labels):
488.     # Tests the one-vs-one multiclass ROC AUC algorithm
489.     # on a small example, representative of an expected use case.
490.     y_scores = np.array(
491.         [[0.1, 0.8, 0.1], [0.3, 0.4, 0.3], [0.35, 0.5, 0.15], [0, 0.2, 0.8]]
492.     )
493. 
494.     # Used to compute the expected output.
495.     # Consider labels 0 and 1:
496.     # positive label is 0, negative label is 1
497.     score_01 = roc_auc_score([1, 0, 1], [0.1, 0.3, 0.35])
498.     # positive label is 1, negative label is 0
499.     score_10 = roc_auc_score([0, 1, 0], [0.8, 0.4, 0.5])
500.     average_score_01 = (score_01 + score_10) / 2


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and return it in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-04 05:01:01,767 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to find relevant test cases for a bug in `roc_curve` where thresholds can exceed 1.\n   - The query asks for complete, self-contained test cases, including necessary imports.\n\n2. Context relevance:\n   - This context provides all the necessary imports for the test functions in the file `sklearn/metrics/tests/test_ranking.py`.\n   - It is essential for understanding and running any of the test cases related to `roc_curve` from this file.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=1, end_line=40), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is looking for tests related to `roc_curve` thresholds exceeding 1.\n\n2. Context relevance:\n   - This test, `test_roc_curve_drop_intermediate`, directly demonstrates the reported bug.\n   - The assertion `assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])` explicitly shows a case where the `roc_curve` function produces a threshold of `2.0`, which is greater than 1. This is the most direct and relevant test case for the issue.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=416, end_line=428), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user wants to see how `roc_curve` is tested, especially with probability estimates.\n\n2. Context relevance:\n   - The `make_prediction` function is a crucial helper utility used in several `roc_curve` tests (e.g., `test_roc_curve`, `test_roc_returns_consistency`).\n   - It shows how realistic test data, including probability scores (`y_score`), is generated using an SVC classifier. Including this context is necessary to understand the setup of more complex tests that rely on it.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=52, end_line=94), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is investigating a bug in `roc_curve` and needs to see existing test cases.\n\n2. Context relevance:\n   - `test_roc_curve` is a fundamental test for the `roc_curve` function.\n   - It uses probability scores generated by the `make_prediction` helper function, which is the scenario described in the bug report.\n   - It checks the calculated Area Under Curve (AUC) against a reference implementation and `roc_auc_score`, providing a baseline for the function's correctness.", relative_path='sklearn/metrics/tests/test_ranking.py', start_line=192, end_line=204), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user is looking for tests that cover different scenarios and edge cases for `roc_curve`.\n\n2. Context relevance:\n   - This test, `test_roc_curve_one_label`, examines the behavior of `roc_curve` in an edge case where only a single class is present in the true labels.\n   - It verifies that the correct warning (`UndefinedMetricWarning`) is raised and that the output arrays contain `np.nan` as expected. This is a good example of how to test for specific, well-defined behavior in non-standard situations, which is relevant to the bug concerning an unexpected threshold value.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=285, end_line=310)]
2025-10-04 05:01:01,768 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='1. import re\n2. import pytest\n3. import numpy as np\n4. import warnings\n5. from scipy.sparse import csr_matrix\n6. from scipy import stats\n7. \n8. from sklearn import datasets\n9. from sklearn import svm\n10. \n11. from sklearn.utils.extmath import softmax\n12. from sklearn.datasets import make_multilabel_classification\n13. from sklearn.random_projection import _sparse_random_matrix\n14. from sklearn.utils.validation import check_array, check_consistent_length\n15. from sklearn.utils.validation import check_random_state\n16. \n17. from sklearn.utils._testing import assert_allclose\n18. from sklearn.utils._testing import assert_almost_equal\n19. from sklearn.utils._testing import assert_array_equal\n20. from sklearn.utils._testing import assert_array_almost_equal\n21. \n22. from sklearn.metrics import accuracy_score\n23. from sklearn.metrics import auc\n24. from sklearn.metrics import average_precision_score\n25. from sklearn.metrics import coverage_error\n26. from sklearn.metrics import det_curve\n27. from sklearn.metrics import label_ranking_average_precision_score\n28. from sklearn.metrics import precision_recall_curve\n29. from sklearn.metrics import label_ranking_loss\n30. from sklearn.metrics import roc_auc_score\n31. from sklearn.metrics import roc_curve\n32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\n33. from sklearn.metrics import ndcg_score, dcg_score\n34. from sklearn.metrics import top_k_accuracy_score\n35. \n36. from sklearn.exceptions import UndefinedMetricWarning\n37. from sklearn.model_selection import train_test_split\n38. from sklearn.linear_model import LogisticRegression\n39. from sklearn.preprocessing import label_binarize\n40. ', start_line_number=1, end_line_number=40), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='416. def test_roc_curve_drop_intermediate():\n417.     # Test that drop_intermediate drops the correct thresholds\n418.     y_true = [0, 0, 0, 0, 1, 1]\n419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]\n420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])\n422. \n423.     # Test dropping thresholds with repeating scores\n424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]\n425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]\n426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])\n428. ', start_line_number=416, end_line_number=428), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='52. def make_prediction(dataset=None, binary=False):\n53.     """Make some classification predictions on a toy dataset using a SVC\n54. \n55.     If binary is True restrict to a binary classification problem instead of a\n56.     multiclass classification problem\n57.     """\n58. \n59.     if dataset is None:\n60.         # import some data to play with\n61.         dataset = datasets.load_iris()\n62. \n63.     X = dataset.data\n64.     y = dataset.target\n65. \n66.     if binary:\n67.         # restrict to a binary classification task\n68.         X, y = X[y < 2], y[y < 2]\n69. \n70.     n_samples, n_features = X.shape\n71.     p = np.arange(n_samples)\n72. \n73.     rng = check_random_state(37)\n74.     rng.shuffle(p)\n75.     X, y = X[p], y[p]\n76.     half = int(n_samples / 2)\n77. \n78.     # add noisy features to make the problem harder and avoid perfect results\n79.     rng = np.random.RandomState(0)\n80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]\n81. \n82.     # run classifier, get class probabilities and label predictions\n83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)\n84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])\n85. \n86.     if binary:\n87.         # only interested in probabilities of the positive case\n88.         # XXX: do we really want a special API for the binary case?\n89.         y_score = y_score[:, 1]\n90. \n91.     y_pred = clf.predict(X[half:])\n92.     y_true = y[half:]\n93.     return y_true, y_pred, y_score\n94. ', start_line_number=52, end_line_number=94), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='192. @pytest.mark.parametrize("drop", [True, False])\n193. def test_roc_curve(drop):\n194.     # Test Area under Receiver Operating Characteristic (ROC) curve\n195.     y_true, _, y_score = make_prediction(binary=True)\n196.     expected_auc = _auc(y_true, y_score)\n197. \n198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)\n199.     roc_auc = auc(fpr, tpr)\n200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)\n201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))\n202.     assert fpr.shape == tpr.shape\n203.     assert fpr.shape == thresholds.shape\n204. ', start_line_number=192, end_line_number=204), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='285. def test_roc_curve_one_label():\n286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n288.     # assert there are warnings\n289.     expected_message = (\n290.         "No negative samples in y_true, false positive value should be meaningless"\n291.     )\n292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)\n294. \n295.     # all true labels, all fpr should be nan\n296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))\n297.     assert fpr.shape == tpr.shape\n298.     assert fpr.shape == thresholds.shape\n299. \n300.     # assert there are warnings\n301.     expected_message = (\n302.         "No positive samples in y_true, true positive value should be meaningless"\n303.     )\n304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)\n306.     # all negative labels, all tpr should be nan\n307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))\n308.     assert fpr.shape == tpr.shape\n309.     assert fpr.shape == thresholds.shape\n310. ', start_line_number=285, end_line_number=310)]
2025-10-04 05:01:01,768 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 05:01:01,769 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
scikit-learn
├── .binder
|   ├── requirements.txt
|   └── runtime.txt
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── doc_improvement.yml
|   |   └── feature_request.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── labeler-file-extensions.yml
|   ├── labeler-module.yml
|   ├── scripts
|   |   └── label_title_regex.py
|   └── workflows
|       ├── artifact-redirector.yml
|       ├── assign.yml
|       ├── check-changelog.yml
|       ├── check-manifest.yml
|       ├── label-blank-issue.yml
|       ├── labeler-module.yml
|       ├── labeler-title-regex.yml
|       ├── publish_pypi.yml
|       ├── twitter.yml
|       ├── unassign.yml
|       ├── update_tracking_issue.yml
|       └── wheels.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── README.rst
├── SECURITY.md
├── asv_benchmarks
|   └── benchmarks
|       ├── __init__.py
|       ├── cluster.py
|       ├── common.py
|       ├── datasets.py
|       ├── decomposition.py
|       ├── ensemble.py
|       ├── linear_model.py
|       ├── manifold.py
|       ├── metrics.py
|       ├── model_selection.py
|       ├── neighbors.py
|       ├── svm.py
|       └── utils.py
├── azure-pipelines.yml
├── benchmarks
|   ├── bench_20newsgroups.py
|   ├── bench_covertype.py
|   ├── bench_feature_expansions.py
|   ├── bench_glm.py
|   ├── bench_glmnet.py
|   ├── bench_hist_gradient_boosting.py
|   ├── bench_hist_gradient_boosting_adult.py
|   ├── bench_hist_gradient_boosting_categorical_only.py
|   ├── bench_hist_gradient_boosting_higgsboson.py
|   ├── bench_hist_gradient_boosting_threading.py
|   ├── bench_isolation_forest.py
|   ├── bench_isotonic.py
|   ├── bench_kernel_pca_solvers_time_vs_n_components.py
|   ├── bench_kernel_pca_solvers_time_vs_n_samples.py
|   ├── bench_lasso.py
|   ├── bench_lof.py
|   ├── bench_mnist.py
|   ├── bench_multilabel_metrics.py
|   ├── bench_online_ocsvm.py
|   ├── bench_plot_fastkmeans.py
|   ├── bench_plot_hierarchical.py
|   ├── bench_plot_incremental_pca.py
|   ├── bench_plot_lasso_path.py
|   ├── bench_plot_neighbors.py
|   ├── bench_plot_nmf.py
|   ├── bench_plot_omp_lars.py
|   ├── bench_plot_parallel_pairwise.py
|   ├── bench_plot_polynomial_kernel_approximation.py
|   ├── bench_plot_randomized_svd.py
|   ├── bench_plot_svd.py
|   ├── bench_plot_ward.py
|   ├── bench_random_projections.py
|   ├── bench_rcv1_logreg_convergence.py
|   ├── bench_saga.py
|   ├── bench_sample_without_replacement.py
|   ├── bench_sgd_regression.py
|   ├── bench_sparsify.py
|   ├── bench_text_vectorizers.py
|   ├── bench_tree.py
|   ├── bench_tsne_mnist.py
|   └── plot_tsne_mnist.py
├── build_tools
|   ├── azure
|   |   ├── combine_coverage_reports.sh
|   |   ├── debian_atlas_32bit_lock.txt
|   |   ├── debian_atlas_32bit_requirements.txt
|   |   ├── get_commit_message.py
|   |   ├── get_selected_tests.py
|   |   ├── install.sh
|   |   ├── install_win.sh
|   |   ├── posix-all-parallel.yml
|   |   ├── posix-docker.yml
|   |   ├── posix.yml
|   |   ├── py38_conda_defaults_openblas_environment.yml
|   |   ├── py38_conda_forge_mkl_environment.yml
|   |   ├── py38_conda_forge_openblas_ubuntu_2204_environment.yml
|   |   ├── pylatest_conda_forge_mkl_linux-64_environment.yml
|   |   ├── pylatest_conda_forge_mkl_no_coverage_environment.yml
|   |   ├── pylatest_conda_forge_mkl_osx-64_environment.yml
|   |   ├── pylatest_conda_mkl_no_openmp_environment.yml
|   |   ├── pylatest_pip_openblas_pandas_environment.yml
|   |   ├── pylatest_pip_scipy_dev_environment.yml
|   |   ├── pypy3_environment.yml
|   |   ├── python_nogil_lock.txt
|   |   ├── python_nogil_requirements.txt
|   |   ├── test_docs.sh
|   |   ├── test_pytest_soft_dependency.sh
|   |   ├── test_script.sh
|   |   ├── ubuntu_atlas_lock.txt
|   |   ├── ubuntu_atlas_requirements.txt
|   |   ├── upload_codecov.sh
|   |   └── windows.yml
|   ├── circle
|   |   ├── build_doc.sh
|   |   ├── checkout_merge_commit.sh
|   |   ├── doc_environment.yml
|   |   ├── doc_min_dependencies_environment.yml
|   |   ├── download_documentation.sh
|   |   ├── list_versions.py
|   |   └── push_doc.sh
|   ├── cirrus
|   |   ├── arm_tests.yml
|   |   ├── arm_wheel.yml
|   |   ├── build_test_arm.sh
|   |   ├── py39_conda_forge_environment.yml
|   |   └── update_tracking_issue.sh
|   ├── codespell_ignore_words.txt
|   ├── generate_authors_table.py
|   ├── github
|   |   ├── build_minimal_windows_image.sh
|   |   ├── build_source.sh
|   |   ├── check_build_trigger.sh
|   |   ├── check_wheels.py
|   |   ├── repair_windows_wheels.sh
|   |   ├── test_source.sh
|   |   ├── test_windows_wheels.sh
|   |   ├── upload_anaconda.sh
|   |   └── vendor.py
|   ├── linting.sh
|   ├── shared.sh
|   ├── update_environments_and_lock_files.py
|   └── wheels
|       ├── build_wheels.sh
|       └── test_wheels.sh
├── conftest.py
├── doc
|   ├── README.md
|   ├── about.rst
|   ├── authors.rst
|   ├── authors_emeritus.rst
|   ├── binder
|   |   └── requirements.txt
|   ├── common_pitfalls.rst
|   ├── communication_team.rst
|   ├── communication_team_emeritus.rst
|   ├── computing
|   |   ├── computational_performance.rst
|   |   ├── parallelism.rst
|   |   └── scaling_strategies.rst
|   ├── computing.rst
|   ├── conf.py
|   ├── conftest.py
|   ├── contents.rst
|   ├── contributor_experience_team.rst
|   ├── contributor_experience_team_emeritus.rst
|   ├── data_transforms.rst
|   ├── datasets
|   |   ├── loading_other_datasets.rst
|   |   ├── real_world.rst
|   |   ├── sample_generators.rst
|   |   └── toy_dataset.rst
|   ├── datasets.rst
|   ├── developers
|   |   ├── advanced_installation.rst
|   |   ├── bug_triaging.rst
|   |   ├── contributing.rst
|   |   ├── cython.rst
|   |   ├── develop.rst
|   |   ├── index.rst
|   |   ├── maintainer.rst
|   |   ├── minimal_reproducer.rst
|   |   ├── performance.rst
|   |   ├── plotting.rst
|   |   ├── tips.rst
|   |   └── utilities.rst
|   ├── dispatching.rst
|   ├── faq.rst
|   ├── getting_started.rst
|   ├── glossary.rst
|   ├── governance.rst
|   ├── images
|   ├── includes
|   |   ├── big_toc_css.rst
|   |   └── bigger_toc_css.rst
|   ├── inspection.rst
|   ├── install.rst
|   ├── logos
|   |   ├── README.md
|   |   ├── brand_colors
|   |   └── brand_guidelines
|   ├── model_persistence.rst
|   ├── model_selection.rst
|   ├── modules
|   |   ├── array_api.rst
|   |   ├── biclustering.rst
|   |   ├── calibration.rst
|   |   ├── classes.rst
|   |   ├── clustering.rst
|   |   ├── compose.rst
|   |   ├── covariance.rst
|   |   ├── cross_decomposition.rst
|   |   ├── cross_validation.rst
|   |   ├── decomposition.rst
|   |   ├── density.rst
|   |   ├── ensemble.rst
|   |   ├── feature_extraction.rst
|   |   ├── feature_selection.rst
|   |   ├── gaussian_process.rst
|   |   ├── glm_data
|   |   ├── grid_search.rst
|   |   ├── impute.rst
|   |   ├── isotonic.rst
|   |   ├── kernel_approximation.rst
|   |   ├── kernel_ridge.rst
|   |   ├── lda_qda.rst
|   |   ├── learning_curve.rst
|   |   ├── linear_model.rst
|   |   ├── manifold.rst
|   |   ├── metrics.rst
|   |   ├── mixture.rst
|   |   ├── model_evaluation.rst
|   |   ├── multiclass.rst
|   |   ├── naive_bayes.rst
|   |   ├── neighbors.rst
|   |   ├── neural_networks_supervised.rst
|   |   ├── neural_networks_unsupervised.rst
|   |   ├── outlier_detection.rst
|   |   ├── partial_dependence.rst
|   |   ├── permutation_importance.rst
|   |   ├── pipeline.rst
|   |   ├── preprocessing.rst
|   |   ├── preprocessing_targets.rst
|   |   ├── random_projection.rst
|   |   ├── semi_supervised.rst
|   |   ├── sgd.rst
|   |   ├── svm.rst
|   |   ├── tree.rst
|   |   └── unsupervised_reduction.rst
|   ├── preface.rst
|   ├── presentations.rst
|   ├── related_projects.rst
|   ├── roadmap.rst
|   ├── sphinxext
|   |   ├── add_toctree_functions.py
|   |   ├── allow_nan_estimators.py
|   |   ├── doi_role.py
|   |   ├── github_link.py
|   |   └── sphinx_issues.py
|   ├── supervised_learning.rst
|   ├── support.rst
|   ├── templates
|   |   ├── class.rst
|   |   ├── class_with_call.rst
|   |   ├── deprecated_class.rst
|   |   ├── deprecated_class_with_call.rst
|   |   ├── deprecated_class_without_init.rst
|   |   ├── deprecated_function.rst
|   |   ├── display_all_class_methods.rst
|   |   ├── display_only_from_estimator.rst
|   |   ├── function.rst
|   |   ├── generate_deprecated.sh
|   |   └── numpydoc_docstring.rst
|   ├── testimonials
|   |   ├── README.txt
|   |   ├── images
|   |   └── testimonials.rst
|   ├── themes
|   |   └── scikit-learn-modern
|   |       └── static
|   |           ├── css
|   |           └── js
|   ├── tune_toc.rst
|   ├── tutorial
|   |   ├── basic
|   |   |   └── tutorial.rst
|   |   ├── common_includes
|   |   |   └── info.txt
|   |   ├── index.rst
|   |   ├── machine_learning_map
|   |   |   ├── ML_MAPS_README.txt
|   |   |   ├── index.rst
|   |   |   ├── parse_path.py
|   |   |   ├── pyparsing.py
|   |   |   └── svg2imagemap.py
|   |   ├── statistical_inference
|   |   |   ├── index.rst
|   |   |   ├── model_selection.rst
|   |   |   ├── putting_together.rst
|   |   |   ├── settings.rst
|   |   |   ├── supervised_learning.rst
|   |   |   └── unsupervised_learning.rst
|   |   └── text_analytics
|   |       ├── data
|   |       |   ├── languages
|   |       |   └── movie_reviews
|   |       ├── skeletons
|   |       |   ├── exercise_01_language_train_model.py
|   |       |   └── exercise_02_sentiment.py
|   |       ├── solutions
|   |       |   ├── exercise_01_language_train_model.py
|   |       |   ├── exercise_02_sentiment.py
|   |       |   └── generate_skeletons.py
|   |       └── working_with_text_data.rst
|   ├── unsupervised_learning.rst
|   ├── user_guide.rst
|   ├── visualizations.rst
|   ├── whats_new
|   |   ├── _contributors.rst
|   |   ├── older_versions.rst
|   |   ├── v0.13.rst
|   |   ├── v0.14.rst
|   |   ├── v0.15.rst
|   |   ├── v0.16.rst
|   |   ├── v0.17.rst
|   |   ├── v0.18.rst
|   |   ├── v0.19.rst
|   |   ├── v0.20.rst
|   |   ├── v0.21.rst
|   |   ├── v0.22.rst
|   |   ├── v0.23.rst
|   |   ├── v0.24.rst
|   |   ├── v1.0.rst
|   |   ├── v1.1.rst
|   |   ├── v1.2.rst
|   |   └── v1.3.rst
|   └── whats_new.rst
├── examples
|   ├── README.txt
|   ├── applications
|   |   ├── README.txt
|   |   ├── plot_cyclical_feature_engineering.py
|   |   ├── plot_digits_denoising.py
|   |   ├── plot_face_recognition.py
|   |   ├── plot_model_complexity_influence.py
|   |   ├── plot_out_of_core_classification.py
|   |   ├── plot_outlier_detection_wine.py
|   |   ├── plot_prediction_latency.py
|   |   ├── plot_species_distribution_modeling.py
|   |   ├── plot_stock_market.py
|   |   ├── plot_tomography_l1_reconstruction.py
|   |   ├── plot_topics_extraction_with_nmf_lda.py
|   |   ├── svm_gui.py
|   |   └── wikipedia_principal_eigenvector.py
|   ├── bicluster
|   |   ├── README.txt
|   |   ├── plot_bicluster_newsgroups.py
|   |   ├── plot_spectral_biclustering.py
|   |   └── plot_spectral_coclustering.py
|   ├── calibration
|   |   ├── README.txt
|   |   ├── plot_calibration.py
|   |   ├── plot_calibration_curve.py
|   |   ├── plot_calibration_multiclass.py
|   |   └── plot_compare_calibration.py
|   ├── classification
|   |   ├── README.txt
|   |   ├── plot_classification_probability.py
|   |   ├── plot_classifier_comparison.py
|   |   ├── plot_digits_classification.py
|   |   ├── plot_lda.py
|   |   └── plot_lda_qda.py
|   ├── cluster
|   |   ├── README.txt
|   |   ├── plot_adjusted_for_chance_measures.py
|   |   ├── plot_affinity_propagation.py
|   |   ├── plot_agglomerative_clustering.py
|   |   ├── plot_agglomerative_clustering_metrics.py
|   |   ├── plot_agglomerative_dendrogram.py
|   |   ├── plot_birch_vs_minibatchkmeans.py
|   |   ├── plot_bisect_kmeans.py
|   |   ├── plot_cluster_comparison.py
|   |   ├── plot_cluster_iris.py
|   |   ├── plot_coin_segmentation.py
|   |   ├── plot_coin_ward_segmentation.py
|   |   ├── plot_color_quantization.py
|   |   ├── plot_dbscan.py
|   |   ├── plot_dict_face_patches.py
|   |   ├── plot_digits_agglomeration.py
|   |   ├── plot_digits_linkage.py
|   |   ├── plot_face_compress.py
|   |   ├── plot_feature_agglomeration_vs_univariate_selection.py
|   |   ├── plot_inductive_clustering.py
|   |   ├── plot_kmeans_assumptions.py
|   |   ├── plot_kmeans_digits.py
|   |   ├── plot_kmeans_plusplus.py
|   |   ├── plot_kmeans_silhouette_analysis.py
|   |   ├── plot_kmeans_stability_low_dim_dense.py
|   |   ├── plot_linkage_comparison.py
|   |   ├── plot_mean_shift.py
|   |   ├── plot_mini_batch_kmeans.py
|   |   ├── plot_optics.py
|   |   ├── plot_segmentation_toy.py
|   |   └── plot_ward_structured_vs_unstructured.py
|   ├── compose
|   |   ├── README.txt
|   |   ├── plot_column_transformer.py
|   |   ├── plot_column_transformer_mixed_types.py
|   |   ├── plot_compare_reduction.py
|   |   ├── plot_digits_pipe.py
|   |   ├── plot_feature_union.py
|   |   └── plot_transformed_target.py
|   ├── covariance
|   |   ├── README.txt
|   |   ├── plot_covariance_estimation.py
|   |   ├── plot_lw_vs_oas.py
|   |   ├── plot_mahalanobis_distances.py
|   |   ├── plot_robust_vs_empirical_covariance.py
|   |   └── plot_sparse_cov.py
|   ├── cross_decomposition
|   |   ├── README.txt
|   |   ├── plot_compare_cross_decomposition.py
|   |   └── plot_pcr_vs_pls.py
|   ├── datasets
|   |   ├── README.txt
|   |   ├── plot_digits_last_image.py
|   |   ├── plot_iris_dataset.py
|   |   ├── plot_random_dataset.py
|   |   └── plot_random_multilabel_dataset.py
|   ├── decomposition
|   |   ├── README.txt
|   |   ├── plot_faces_decomposition.py
|   |   ├── plot_ica_blind_source_separation.py
|   |   ├── plot_ica_vs_pca.py
|   |   ├── plot_image_denoising.py
|   |   ├── plot_incremental_pca.py
|   |   ├── plot_kernel_pca.py
|   |   ├── plot_pca_3d.py
|   |   ├── plot_pca_iris.py
|   |   ├── plot_pca_vs_fa_model_selection.py
|   |   ├── plot_pca_vs_lda.py
|   |   ├── plot_sparse_coding.py
|   |   └── plot_varimax_fa.py
|   ├── ensemble
|   |   ├── README.txt
|   |   ├── plot_adaboost_hastie_10_2.py
|   |   ├── plot_adaboost_multiclass.py
|   |   ├── plot_adaboost_regression.py
|   |   ├── plot_adaboost_twoclass.py
|   |   ├── plot_bias_variance.py
|   |   ├── plot_ensemble_oob.py
|   |   ├── plot_feature_transformation.py
|   |   ├── plot_forest_importances.py
|   |   ├── plot_forest_importances_faces.py
|   |   ├── plot_forest_iris.py
|   |   ├── plot_gradient_boosting_categorical.py
|   |   ├── plot_gradient_boosting_early_stopping.py
|   |   ├── plot_gradient_boosting_oob.py
|   |   ├── plot_gradient_boosting_quantile.py
|   |   ├── plot_gradient_boosting_regression.py
|   |   ├── plot_gradient_boosting_regularization.py
|   |   ├── plot_isolation_forest.py
|   |   ├── plot_monotonic_constraints.py
|   |   ├── plot_random_forest_embedding.py
|   |   ├── plot_random_forest_regression_multioutput.py
|   |   ├── plot_stack_predictors.py
|   |   ├── plot_voting_decision_regions.py
|   |   ├── plot_voting_probas.py
|   |   └── plot_voting_regressor.py
|   ├── exercises
|   |   ├── README.txt
|   |   ├── plot_cv_diabetes.py
|   |   ├── plot_cv_digits.py
|   |   ├── plot_digits_classification_exercise.py
|   |   └── plot_iris_exercise.py
|   ├── feature_selection
|   |   ├── README.txt
|   |   ├── plot_f_test_vs_mi.py
|   |   ├── plot_feature_selection.py
|   |   ├── plot_feature_selection_pipeline.py
|   |   ├── plot_rfe_digits.py
|   |   ├── plot_rfe_with_cross_validation.py
|   |   └── plot_select_from_model_diabetes.py
|   ├── gaussian_process
|   |   ├── README.txt
|   |   ├── plot_compare_gpr_krr.py
|   |   ├── plot_gpc.py
|   |   ├── plot_gpc_iris.py
|   |   ├── plot_gpc_isoprobability.py
|   |   ├── plot_gpc_xor.py
|   |   ├── plot_gpr_co2.py
|   |   ├── plot_gpr_noisy.py
|   |   ├── plot_gpr_noisy_targets.py
|   |   ├── plot_gpr_on_structured_data.py
|   |   └── plot_gpr_prior_posterior.py
|   ├── impute
|   |   ├── README.txt
|   |   ├── plot_iterative_imputer_variants_comparison.py
|   |   └── plot_missing_values.py
|   ├── inspection
|   |   ├── README.txt
|   |   ├── plot_causal_interpretation.py
|   |   ├── plot_linear_model_coefficient_interpretation.py
|   |   ├── plot_partial_dependence.py
|   |   ├── plot_permutation_importance.py
|   |   └── plot_permutation_importance_multicollinear.py
|   ├── kernel_approximation
|   |   ├── README.txt
|   |   └── plot_scalable_poly_kernels.py
|   ├── linear_model
|   |   ├── README.txt
|   |   ├── plot_ard.py
|   |   ├── plot_bayesian_ridge_curvefit.py
|   |   ├── plot_elastic_net_precomputed_gram_matrix_with_weighted_samples.py
|   |   ├── plot_huber_vs_ridge.py
|   |   ├── plot_iris_logistic.py
|   |   ├── plot_lasso_and_elasticnet.py
|   |   ├── plot_lasso_coordinate_descent_path.py
|   |   ├── plot_lasso_dense_vs_sparse_data.py
|   |   ├── plot_lasso_lars.py
|   |   ├── plot_lasso_lars_ic.py
|   |   ├── plot_lasso_model_selection.py
|   |   ├── plot_logistic.py
|   |   ├── plot_logistic_l1_l2_sparsity.py
|   |   ├── plot_logistic_multinomial.py
|   |   ├── plot_logistic_path.py
|   |   ├── plot_multi_task_lasso_support.py
|   |   ├── plot_nnls.py
|   |   ├── plot_ols.py
|   |   ├── plot_ols_3d.py
|   |   ├── plot_ols_ridge_variance.py
|   |   ├── plot_omp.py
|   |   ├── plot_poisson_regression_non_normal_loss.py
|   |   ├── plot_polynomial_interpolation.py
|   |   ├── plot_quantile_regression.py
|   |   ├── plot_ransac.py
|   |   ├── plot_ridge_coeffs.py
|   |   ├── plot_ridge_path.py
|   |   ├── plot_robust_fit.py
|   |   ├── plot_sgd_comparison.py
|   |   ├── plot_sgd_early_stopping.py
|   |   ├── plot_sgd_iris.py
|   |   ├── plot_sgd_loss_functions.py
|   |   ├── plot_sgd_penalties.py
|   |   ├── plot_sgd_separating_hyperplane.py
|   |   ├── plot_sgd_weighted_samples.py
|   |   ├── plot_sgdocsvm_vs_ocsvm.py
|   |   ├── plot_sparse_logistic_regression_20newsgroups.py
|   |   ├── plot_sparse_logistic_regression_mnist.py
|   |   ├── plot_theilsen.py
|   |   └── plot_tweedie_regression_insurance_claims.py
|   ├── manifold
|   |   ├── README.txt
|   |   ├── plot_compare_methods.py
|   |   ├── plot_lle_digits.py
|   |   ├── plot_manifold_sphere.py
|   |   ├── plot_mds.py
|   |   ├── plot_swissroll.py
|   |   └── plot_t_sne_perplexity.py
|   ├── miscellaneous
|   |   ├── README.txt
|   |   ├── plot_anomaly_comparison.py
|   |   ├── plot_display_object_visualization.py
|   |   ├── plot_estimator_representation.py
|   |   ├── plot_isotonic_regression.py
|   |   ├── plot_johnson_lindenstrauss_bound.py
|   |   ├── plot_kernel_approximation.py
|   |   ├── plot_kernel_ridge_regression.py
|   |   ├── plot_multilabel.py
|   |   ├── plot_multioutput_face_completion.py
|   |   ├── plot_outlier_detection_bench.py
|   |   ├── plot_partial_dependence_visualization_api.py
|   |   ├── plot_pipeline_display.py
|   |   ├── plot_roc_curve_visualization_api.py
|   |   └── plot_set_output.py
|   ├── mixture
|   |   ├── README.txt
|   |   ├── plot_concentration_prior.py
|   |   ├── plot_gmm.py
|   |   ├── plot_gmm_covariances.py
|   |   ├── plot_gmm_init.py
|   |   ├── plot_gmm_pdf.py
|   |   ├── plot_gmm_selection.py
|   |   └── plot_gmm_sin.py
|   ├── model_selection
|   |   ├── README.txt
|   |   ├── plot_confusion_matrix.py
|   |   ├── plot_cv_indices.py
|   |   ├── plot_cv_predict.py
|   |   ├── plot_det.py
|   |   ├── plot_grid_search_digits.py
|   |   ├── plot_grid_search_refit_callable.py
|   |   ├── plot_grid_search_stats.py
|   |   ├── plot_grid_search_text_feature_extraction.py
|   |   ├── plot_learning_curve.py
|   |   ├── plot_likelihood_ratios.py
|   |   ├── plot_multi_metric_evaluation.py
|   |   ├── plot_nested_cross_validation_iris.py
|   |   ├── plot_permutation_tests_for_classification.py
|   |   ├── plot_precision_recall.py
|   |   ├── plot_randomized_search.py
|   |   ├── plot_roc.py
|   |   ├── plot_roc_crossval.py
|   |   ├── plot_successive_halving_heatmap.py
|   |   ├── plot_successive_halving_iterations.py
|   |   ├── plot_train_error_vs_test_error.py
|   |   ├── plot_underfitting_overfitting.py
|   |   └── plot_validation_curve.py
|   ├── multioutput
|   |   ├── README.txt
|   |   └── plot_classifier_chain_yeast.py
|   ├── neighbors
|   |   ├── README.txt
|   |   ├── approximate_nearest_neighbors.py
|   |   ├── plot_caching_nearest_neighbors.py
|   |   ├── plot_classification.py
|   |   ├── plot_digits_kde_sampling.py
|   |   ├── plot_kde_1d.py
|   |   ├── plot_lof_novelty_detection.py
|   |   ├── plot_lof_outlier_detection.py
|   |   ├── plot_nca_classification.py
|   |   ├── plot_nca_dim_reduction.py
|   |   ├── plot_nca_illustration.py
|   |   ├── plot_nearest_centroid.py
|   |   ├── plot_regression.py
|   |   └── plot_species_kde.py
|   ├── neural_networks
|   |   ├── README.txt
|   |   ├── plot_mlp_alpha.py
|   |   ├── plot_mlp_training_curves.py
|   |   ├── plot_mnist_filters.py
|   |   └── plot_rbm_logistic_classification.py
|   ├── preprocessing
|   |   ├── README.txt
|   |   ├── plot_all_scaling.py
|   |   ├── plot_discretization.py
|   |   ├── plot_discretization_classification.py
|   |   ├── plot_discretization_strategies.py
|   |   ├── plot_map_data_to_normal.py
|   |   ├── plot_scaling_importance.py
|   |   └── plot_target_encoder.py
|   ├── release_highlights
|   |   ├── README.txt
|   |   ├── plot_release_highlights_0_22_0.py
|   |   ├── plot_release_highlights_0_23_0.py
|   |   ├── plot_release_highlights_0_24_0.py
|   |   ├── plot_release_highlights_1_0_0.py
|   |   ├── plot_release_highlights_1_1_0.py
|   |   └── plot_release_highlights_1_2_0.py
|   ├── semi_supervised
|   |   ├── README.txt
|   |   ├── plot_label_propagation_digits.py
|   |   ├── plot_label_propagation_digits_active_learning.py
|   |   ├── plot_label_propagation_structure.py
|   |   ├── plot_self_training_varying_threshold.py
|   |   ├── plot_semi_supervised_newsgroups.py
|   |   └── plot_semi_supervised_versus_svm_iris.py
|   ├── svm
|   |   ├── README.txt
|   |   ├── plot_custom_kernel.py
|   |   ├── plot_iris_svc.py
|   |   ├── plot_linearsvc_support_vectors.py
|   |   ├── plot_oneclass.py
|   |   ├── plot_rbf_parameters.py
|   |   ├── plot_separating_hyperplane.py
|   |   ├── plot_separating_hyperplane_unbalanced.py
|   |   ├── plot_svm_anova.py
|   |   ├── plot_svm_kernels.py
|   |   ├── plot_svm_margin.py
|   |   ├── plot_svm_nonlinear.py
|   |   ├── plot_svm_regression.py
|   |   ├── plot_svm_scale_c.py
|   |   ├── plot_svm_tie_breaking.py
|   |   └── plot_weighted_samples.py
|   ├── text
|   |   ├── README.txt
|   |   ├── plot_document_classification_20newsgroups.py
|   |   ├── plot_document_clustering.py
|   |   └── plot_hashing_vs_dict_vectorizer.py
|   └── tree
|       ├── README.txt
|       ├── plot_cost_complexity_pruning.py
|       ├── plot_iris_dtc.py
|       ├── plot_tree_regression.py
|       ├── plot_tree_regression_multioutput.py
|       └── plot_unveil_tree_structure.py
├── maint_tools
|   ├── check_pxd_in_installation.py
|   ├── sort_whats_new.py
|   ├── update_tracking_issue.py
|   └── whats_missing.sh
├── setup.py
└── sklearn
    ├── __check_build
    |   └── __init__.py
    ├── __init__.py
    ├── _build_utils
    |   ├── __init__.py
    |   ├── openmp_helpers.py
    |   └── pre_build_helpers.py
    ├── _config.py
    ├── _distributor_init.py
    ├── _loss
    |   ├── __init__.py
    |   ├── link.py
    |   ├── loss.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_link.py
    |       └── test_loss.py
    ├── _min_dependencies.py
    ├── base.py
    ├── calibration.py
    ├── cluster
    |   ├── __init__.py
    |   ├── _affinity_propagation.py
    |   ├── _agglomerative.py
    |   ├── _bicluster.py
    |   ├── _birch.py
    |   ├── _bisect_k_means.py
    |   ├── _dbscan.py
    |   ├── _feature_agglomeration.py
    |   ├── _kmeans.py
    |   ├── _mean_shift.py
    |   ├── _optics.py
    |   ├── _spectral.py
    |   └── tests
    |       ├── __init__.py
    |       ├── common.py
    |       ├── test_affinity_propagation.py
    |       ├── test_bicluster.py
    |       ├── test_birch.py
    |       ├── test_bisect_k_means.py
    |       ├── test_dbscan.py
    |       ├── test_feature_agglomeration.py
    |       ├── test_hierarchical.py
    |       ├── test_k_means.py
    |       ├── test_mean_shift.py
    |       ├── test_optics.py
    |       └── test_spectral.py
    ├── compose
    |   ├── __init__.py
    |   ├── _column_transformer.py
    |   ├── _target.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_column_transformer.py
    |       └── test_target.py
    ├── conftest.py
    ├── covariance
    |   ├── __init__.py
    |   ├── _elliptic_envelope.py
    |   ├── _empirical_covariance.py
    |   ├── _graph_lasso.py
    |   ├── _robust_covariance.py
    |   ├── _shrunk_covariance.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_covariance.py
    |       ├── test_elliptic_envelope.py
    |       ├── test_graphical_lasso.py
    |       └── test_robust_covariance.py
    ├── cross_decomposition
    |   ├── __init__.py
    |   ├── _pls.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_pls.py
    ├── datasets
    |   ├── __init__.py
    |   ├── _arff_parser.py
    |   ├── _base.py
    |   ├── _california_housing.py
    |   ├── _covtype.py
    |   ├── _kddcup99.py
    |   ├── _lfw.py
    |   ├── _olivetti_faces.py
    |   ├── _openml.py
    |   ├── _rcv1.py
    |   ├── _samples_generator.py
    |   ├── _species_distributions.py
    |   ├── _svmlight_format_io.py
    |   ├── _twenty_newsgroups.py
    |   ├── data
    |   |   └── __init__.py
    |   ├── descr
    |   |   ├── __init__.py
    |   |   ├── breast_cancer.rst
    |   |   ├── california_housing.rst
    |   |   ├── covtype.rst
    |   |   ├── diabetes.rst
    |   |   ├── digits.rst
    |   |   ├── iris.rst
    |   |   ├── kddcup99.rst
    |   |   ├── lfw.rst
    |   |   ├── linnerud.rst
    |   |   ├── olivetti_faces.rst
    |   |   ├── rcv1.rst
    |   |   ├── twenty_newsgroups.rst
    |   |   └── wine_data.rst
    |   ├── images
    |   |   ├── README.txt
    |   |   └── __init__.py
    |   └── tests
    |       ├── __init__.py
    |       ├── conftest.py
    |       ├── data
    |       |   ├── __init__.py
    |       |   ├── openml
    |       |   ├── svmlight_classification.txt
    |       |   ├── svmlight_invalid.txt
    |       |   ├── svmlight_invalid_order.txt
    |       |   └── svmlight_multilabel.txt
    |       ├── test_20news.py
    |       ├── test_arff_parser.py
    |       ├── test_base.py
    |       ├── test_california_housing.py
    |       ├── test_common.py
    |       ├── test_covtype.py
    |       ├── test_kddcup99.py
    |       ├── test_lfw.py
    |       ├── test_olivetti_faces.py
    |       ├── test_openml.py
    |       ├── test_rcv1.py
    |       ├── test_samples_generator.py
    |       └── test_svmlight_format.py
    ├── decomposition
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _dict_learning.py
    |   ├── _factor_analysis.py
    |   ├── _fastica.py
    |   ├── _incremental_pca.py
    |   ├── _kernel_pca.py
    |   ├── _lda.py
    |   ├── _nmf.py
    |   ├── _pca.py
    |   ├── _sparse_pca.py
    |   ├── _truncated_svd.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_dict_learning.py
    |       ├── test_factor_analysis.py
    |       ├── test_fastica.py
    |       ├── test_incremental_pca.py
    |       ├── test_kernel_pca.py
    |       ├── test_nmf.py
    |       ├── test_online_lda.py
    |       ├── test_pca.py
    |       ├── test_sparse_pca.py
    |       └── test_truncated_svd.py
    ├── discriminant_analysis.py
    ├── dummy.py
    ├── ensemble
    |   ├── __init__.py
    |   ├── _bagging.py
    |   ├── _base.py
    |   ├── _forest.py
    |   ├── _gb.py
    |   ├── _gb_losses.py
    |   ├── _hist_gradient_boosting
    |   |   ├── __init__.py
    |   |   ├── binning.py
    |   |   ├── gradient_boosting.py
    |   |   ├── grower.py
    |   |   ├── predictor.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_binning.py
    |   |       ├── test_bitset.py
    |   |       ├── test_compare_lightgbm.py
    |   |       ├── test_gradient_boosting.py
    |   |       ├── test_grower.py
    |   |       ├── test_histogram.py
    |   |       ├── test_monotonic_contraints.py
    |   |       ├── test_predictor.py
    |   |       ├── test_splitting.py
    |   |       └── test_warm_start.py
    |   ├── _iforest.py
    |   ├── _stacking.py
    |   ├── _voting.py
    |   ├── _weight_boosting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bagging.py
    |       ├── test_base.py
    |       ├── test_common.py
    |       ├── test_forest.py
    |       ├── test_gradient_boosting.py
    |       ├── test_gradient_boosting_loss_functions.py
    |       ├── test_iforest.py
    |       ├── test_stacking.py
    |       ├── test_voting.py
    |       └── test_weight_boosting.py
    ├── exceptions.py
    ├── experimental
    |   ├── __init__.py
    |   ├── enable_halving_search_cv.py
    |   ├── enable_hist_gradient_boosting.py
    |   ├── enable_iterative_imputer.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_enable_hist_gradient_boosting.py
    |       ├── test_enable_iterative_imputer.py
    |       └── test_enable_successive_halving.py
    ├── externals
    |   ├── __init__.py
    |   ├── _arff.py
    |   ├── _lobpcg.py
    |   ├── _packaging
    |   |   ├── __init__.py
    |   |   ├── _structures.py
    |   |   └── version.py
    |   └── conftest.py
    ├── feature_extraction
    |   ├── __init__.py
    |   ├── _dict_vectorizer.py
    |   ├── _hash.py
    |   ├── _stop_words.py
    |   ├── image.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_dict_vectorizer.py
    |   |   ├── test_feature_hasher.py
    |   |   ├── test_image.py
    |   |   └── test_text.py
    |   └── text.py
    ├── feature_selection
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _from_model.py
    |   ├── _mutual_info.py
    |   ├── _rfe.py
    |   ├── _sequential.py
    |   ├── _univariate_selection.py
    |   ├── _variance_threshold.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_chi2.py
    |       ├── test_feature_select.py
    |       ├── test_from_model.py
    |       ├── test_mutual_info.py
    |       ├── test_rfe.py
    |       ├── test_sequential.py
    |       └── test_variance_threshold.py
    ├── gaussian_process
    |   ├── __init__.py
    |   ├── _gpc.py
    |   ├── _gpr.py
    |   ├── kernels.py
    |   └── tests
    |       ├── __init__.py
    |       ├── _mini_sequence_kernel.py
    |       ├── test_gpc.py
    |       ├── test_gpr.py
    |       └── test_kernels.py
    ├── impute
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _iterative.py
    |   ├── _knn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_common.py
    |       ├── test_impute.py
    |       └── test_knn.py
    ├── inspection
    |   ├── __init__.py
    |   ├── _partial_dependence.py
    |   ├── _pd_utils.py
    |   ├── _permutation_importance.py
    |   ├── _plot
    |   |   ├── __init__.py
    |   |   ├── decision_boundary.py
    |   |   ├── partial_dependence.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_boundary_decision_display.py
    |   |       └── test_plot_partial_dependence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_partial_dependence.py
    |       ├── test_pd_utils.py
    |       └── test_permutation_importance.py
    ├── isotonic.py
    ├── kernel_approximation.py
    ├── kernel_ridge.py
    ├── linear_model
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _bayes.py
    |   ├── _coordinate_descent.py
    |   ├── _glm
    |   |   ├── __init__.py
    |   |   ├── _newton_solver.py
    |   |   ├── glm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_glm.py
    |   ├── _huber.py
    |   ├── _least_angle.py
    |   ├── _linear_loss.py
    |   ├── _logistic.py
    |   ├── _omp.py
    |   ├── _passive_aggressive.py
    |   ├── _perceptron.py
    |   ├── _quantile.py
    |   ├── _ransac.py
    |   ├── _ridge.py
    |   ├── _sag.py
    |   ├── _stochastic_gradient.py
    |   ├── _theil_sen.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_bayes.py
    |       ├── test_common.py
    |       ├── test_coordinate_descent.py
    |       ├── test_huber.py
    |       ├── test_least_angle.py
    |       ├── test_linear_loss.py
    |       ├── test_logistic.py
    |       ├── test_omp.py
    |       ├── test_passive_aggressive.py
    |       ├── test_perceptron.py
    |       ├── test_quantile.py
    |       ├── test_ransac.py
    |       ├── test_ridge.py
    |       ├── test_sag.py
    |       ├── test_sgd.py
    |       ├── test_sparse_coordinate_descent.py
    |       └── test_theil_sen.py
    ├── manifold
    |   ├── __init__.py
    |   ├── _isomap.py
    |   ├── _locally_linear.py
    |   ├── _mds.py
    |   ├── _spectral_embedding.py
    |   ├── _t_sne.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_isomap.py
    |       ├── test_locally_linear.py
    |       ├── test_mds.py
    |       ├── test_spectral_embedding.py
    |       └── test_t_sne.py
    ├── metrics
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _classification.py
    |   ├── _pairwise_distances_reduction
    |   |   ├── __init__.py
    |   |   └── _dispatcher.py
    |   ├── _plot
    |   |   ├── __init__.py
    |   |   ├── confusion_matrix.py
    |   |   ├── det_curve.py
    |   |   ├── precision_recall_curve.py
    |   |   ├── regression.py
    |   |   ├── roc_curve.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_common_curve_display.py
    |   |       ├── test_confusion_matrix_display.py
    |   |       ├── test_det_curve_display.py
    |   |       ├── test_precision_recall_display.py
    |   |       ├── test_predict_error_display.py
    |   |       └── test_roc_curve_display.py
    |   ├── _ranking.py
    |   ├── _regression.py
    |   ├── _scorer.py
    |   ├── cluster
    |   |   ├── __init__.py
    |   |   ├── _bicluster.py
    |   |   ├── _supervised.py
    |   |   ├── _unsupervised.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_bicluster.py
    |   |       ├── test_common.py
    |   |       ├── test_supervised.py
    |   |       └── test_unsupervised.py
    |   ├── pairwise.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_classification.py
    |       ├── test_common.py
    |       ├── test_dist_metrics.py
    |       ├── test_pairwise.py
    |       ├── test_pairwise_distances_reduction.py
    |       ├── test_ranking.py
    |       ├── test_regression.py
    |       └── test_score_objects.py
    ├── mixture
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _bayesian_mixture.py
    |   ├── _gaussian_mixture.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bayesian_mixture.py
    |       ├── test_gaussian_mixture.py
    |       └── test_mixture.py
    ├── model_selection
    |   ├── __init__.py
    |   ├── _plot.py
    |   ├── _search.py
    |   ├── _search_successive_halving.py
    |   ├── _split.py
    |   ├── _validation.py
    |   └── tests
    |       ├── __init__.py
    |       ├── common.py
    |       ├── test_plot.py
    |       ├── test_search.py
    |       ├── test_split.py
    |       ├── test_successive_halving.py
    |       └── test_validation.py
    ├── multiclass.py
    ├── multioutput.py
    ├── naive_bayes.py
    ├── neighbors
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _classification.py
    |   ├── _distance_metric.py
    |   ├── _graph.py
    |   ├── _kde.py
    |   ├── _lof.py
    |   ├── _nca.py
    |   ├── _nearest_centroid.py
    |   ├── _regression.py
    |   ├── _unsupervised.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ball_tree.py
    |       ├── test_graph.py
    |       ├── test_kd_tree.py
    |       ├── test_kde.py
    |       ├── test_lof.py
    |       ├── test_nca.py
    |       ├── test_nearest_centroid.py
    |       ├── test_neighbors.py
    |       ├── test_neighbors_pipeline.py
    |       ├── test_neighbors_tree.py
    |       └── test_quad_tree.py
    ├── neural_network
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _multilayer_perceptron.py
    |   ├── _rbm.py
    |   ├── _stochastic_optimizers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_mlp.py
    |       ├── test_rbm.py
    |       └── test_stochastic_optimizers.py
    ├── pipeline.py
    ├── preprocessing
    |   ├── __init__.py
    |   ├── _data.py
    |   ├── _discretization.py
    |   ├── _encoders.py
    |   ├── _function_transformer.py
    |   ├── _label.py
    |   ├── _polynomial.py
    |   ├── _target_encoder.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_common.py
    |       ├── test_data.py
    |       ├── test_discretization.py
    |       ├── test_encoders.py
    |       ├── test_function_transformer.py
    |       ├── test_label.py
    |       ├── test_polynomial.py
    |       └── test_target_encoder.py
    ├── random_projection.py
    ├── semi_supervised
    |   ├── __init__.py
    |   ├── _label_propagation.py
    |   ├── _self_training.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_label_propagation.py
    |       └── test_self_training.py
    ├── svm
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _bounds.py
    |   ├── _classes.py
    |   ├── src
    |   |   ├── liblinear
    |   |   |   ├── liblinear_helper.c
    |   |   |   ├── linear.cpp
    |   |   |   └── tron.cpp
    |   |   ├── libsvm
    |   |   |   ├── libsvm_helper.c
    |   |   |   ├── libsvm_sparse_helper.c
    |   |   |   ├── libsvm_template.cpp
    |   |   |   └── svm.cpp
    |   |   └── newrand
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bounds.py
    |       ├── test_sparse.py
    |       └── test_svm.py
    ├── tests
    |   ├── __init__.py
    |   ├── random_seed.py
    |   ├── test_base.py
    |   ├── test_build.py
    |   ├── test_calibration.py
    |   ├── test_check_build.py
    |   ├── test_common.py
    |   ├── test_config.py
    |   ├── test_discriminant_analysis.py
    |   ├── test_docstring_parameters.py
    |   ├── test_docstrings.py
    |   ├── test_dummy.py
    |   ├── test_init.py
    |   ├── test_isotonic.py
    |   ├── test_kernel_approximation.py
    |   ├── test_kernel_ridge.py
    |   ├── test_metaestimators.py
    |   ├── test_min_dependencies_readme.py
    |   ├── test_multiclass.py
    |   ├── test_multioutput.py
    |   ├── test_naive_bayes.py
    |   ├── test_pipeline.py
    |   ├── test_public_functions.py
    |   └── test_random_projection.py
    ├── tree
    |   ├── __init__.py
    |   ├── _classes.py
    |   ├── _export.py
    |   ├── _reingold_tilford.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_export.py
    |       ├── test_reingold_tilford.py
    |       └── test_tree.py
    └── utils
        ├── __init__.py
        ├── _arpack.py
        ├── _array_api.py
        ├── _available_if.py
        ├── _bunch.py
        ├── _encode.py
        ├── _estimator_html_repr.py
        ├── _joblib.py
        ├── _mask.py
        ├── _mocking.py
        ├── _param_validation.py
        ├── _plotting.py
        ├── _pprint.py
        ├── _response.py
        ├── _set_output.py
        ├── _show_versions.py
        ├── _tags.py
        ├── _testing.py
        ├── class_weight.py
        ├── deprecation.py
        ├── discovery.py
        ├── estimator_checks.py
        ├── extmath.py
        ├── fixes.py
        ├── graph.py
        ├── metaestimators.py
        ├── multiclass.py
        ├── optimize.py
        ├── parallel.py
        ├── random.py
        ├── sparsefuncs.py
        ├── src
        |   └── MurmurHash3.cpp
        ├── stats.py
        ├── tests
        |   ├── __init__.py
        |   ├── conftest.py
        |   ├── test_arpack.py
        |   ├── test_array_api.py
        |   ├── test_arrayfuncs.py
        |   ├── test_bunch.py
        |   ├── test_class_weight.py
        |   ├── test_cython_blas.py
        |   ├── test_cython_templating.py
        |   ├── test_deprecation.py
        |   ├── test_encode.py
        |   ├── test_estimator_checks.py
        |   ├── test_estimator_html_repr.py
        |   ├── test_extmath.py
        |   ├── test_fast_dict.py
        |   ├── test_fixes.py
        |   ├── test_graph.py
        |   ├── test_metaestimators.py
        |   ├── test_mocking.py
        |   ├── test_multiclass.py
        |   ├── test_murmurhash.py
        |   ├── test_optimize.py
        |   ├── test_parallel.py
        |   ├── test_param_validation.py
        |   ├── test_pprint.py
        |   ├── test_random.py
        |   ├── test_response.py
        |   ├── test_seq_dataset.py
        |   ├── test_set_output.py
        |   ├── test_shortest_path.py
        |   ├── test_show_versions.py
        |   ├── test_sparsefuncs.py
        |   ├── test_stats.py
        |   ├── test_tags.py
        |   ├── test_testing.py
        |   ├── test_typedefs.py
        |   ├── test_utils.py
        |   ├── test_validation.py
        |   └── test_weight_vector.py
        └── validation.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Thresholds can exceed 1 in `roc_curve` while providing probability estimate

Issue description: 
While working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:

```python
def test_roc_curve_with_probablity_estimates():
    rng = np.random.RandomState(42)
    y_true = rng.randint(0, 2, size=10)
    y_score = rng.rand(10)
    _, _, thresholds = roc_curve(y_true, y_score)
    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()
```

The reason is due to the following:

https://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086

Basically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.

I am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sklearn/metrics/tests/test_ranking.py
Line number range: 1 - 40
Content:
1. import re
2. import pytest
3. import numpy as np
4. import warnings
5. from scipy.sparse import csr_matrix
6. from scipy import stats
7. 
8. from sklearn import datasets
9. from sklearn import svm
10. 
11. from sklearn.utils.extmath import softmax
12. from sklearn.datasets import make_multilabel_classification
13. from sklearn.random_projection import _sparse_random_matrix
14. from sklearn.utils.validation import check_array, check_consistent_length
15. from sklearn.utils.validation import check_random_state
16. 
17. from sklearn.utils._testing import assert_allclose
18. from sklearn.utils._testing import assert_almost_equal
19. from sklearn.utils._testing import assert_array_equal
20. from sklearn.utils._testing import assert_array_almost_equal
21. 
22. from sklearn.metrics import accuracy_score
23. from sklearn.metrics import auc
24. from sklearn.metrics import average_precision_score
25. from sklearn.metrics import coverage_error
26. from sklearn.metrics import det_curve
27. from sklearn.metrics import label_ranking_average_precision_score
28. from sklearn.metrics import precision_recall_curve
29. from sklearn.metrics import label_ranking_loss
30. from sklearn.metrics import roc_auc_score
31. from sklearn.metrics import roc_curve
32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores
33. from sklearn.metrics import ndcg_score, dcg_score
34. from sklearn.metrics import top_k_accuracy_score
35. 
36. from sklearn.exceptions import UndefinedMetricWarning
37. from sklearn.model_selection import train_test_split
38. from sklearn.linear_model import LogisticRegression
39. from sklearn.preprocessing import label_binarize
40. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 416 - 428
Content:
416. def test_roc_curve_drop_intermediate():
417.     # Test that drop_intermediate drops the correct thresholds
418.     y_true = [0, 0, 0, 0, 1, 1]
419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]
420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])
422. 
423.     # Test dropping thresholds with repeating scores
424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]
425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]
426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])
428. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 52 - 94
Content:
52. def make_prediction(dataset=None, binary=False):
53.     """Make some classification predictions on a toy dataset using a SVC
54. 
55.     If binary is True restrict to a binary classification problem instead of a
56.     multiclass classification problem
57.     """
58. 
59.     if dataset is None:
60.         # import some data to play with
61.         dataset = datasets.load_iris()
62. 
63.     X = dataset.data
64.     y = dataset.target
65. 
66.     if binary:
67.         # restrict to a binary classification task
68.         X, y = X[y < 2], y[y < 2]
69. 
70.     n_samples, n_features = X.shape
71.     p = np.arange(n_samples)
72. 
73.     rng = check_random_state(37)
74.     rng.shuffle(p)
75.     X, y = X[p], y[p]
76.     half = int(n_samples / 2)
77. 
78.     # add noisy features to make the problem harder and avoid perfect results
79.     rng = np.random.RandomState(0)
80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]
81. 
82.     # run classifier, get class probabilities and label predictions
83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)
84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])
85. 
86.     if binary:
87.         # only interested in probabilities of the positive case
88.         # XXX: do we really want a special API for the binary case?
89.         y_score = y_score[:, 1]
90. 
91.     y_pred = clf.predict(X[half:])
92.     y_true = y[half:]
93.     return y_true, y_pred, y_score
94. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 192 - 204
Content:
192. @pytest.mark.parametrize("drop", [True, False])
193. def test_roc_curve(drop):
194.     # Test Area under Receiver Operating Characteristic (ROC) curve
195.     y_true, _, y_score = make_prediction(binary=True)
196.     expected_auc = _auc(y_true, y_score)
197. 
198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)
199.     roc_auc = auc(fpr, tpr)
200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)
201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))
202.     assert fpr.shape == tpr.shape
203.     assert fpr.shape == thresholds.shape
204. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 285 - 310
Content:
285. def test_roc_curve_one_label():
286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]
288.     # assert there are warnings
289.     expected_message = (
290.         "No negative samples in y_true, false positive value should be meaningless"
291.     )
292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)
294. 
295.     # all true labels, all fpr should be nan
296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))
297.     assert fpr.shape == tpr.shape
298.     assert fpr.shape == thresholds.shape
299. 
300.     # assert there are warnings
301.     expected_message = (
302.         "No positive samples in y_true, true positive value should be meaningless"
303.     )
304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)
306.     # all negative labels, all tpr should be nan
307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))
308.     assert fpr.shape == tpr.shape
309.     assert fpr.shape == thresholds.shape
310. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-04 05:01:27,835 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants 5 relevant test cases for a bug in `roc_curve` concerning its returned `thresholds`. The bug is that thresholds can exceed 1 even for probability estimates.\n2. The current context provides snippets from `sklearn/metrics/tests/test_ranking.py`, which includes three test functions for `roc_curve`: `test_roc_curve`, `test_roc_curve_drop_intermediate`, and `test_roc_curve_one_label`. It also includes a helper function `make_prediction` used by these tests.\n3. While these three tests are relevant, to provide the 5 *most* relevant test cases, a broader selection of tests for `roc_curve` is needed. The current context does not show tests for other parameters like `pos_label` or `sample_weight`, which could influence the thresholds. There might be other edge case tests that are more relevant to the reported issue.\n4. To ensure I select the best 5 examples, I need to see more of the available tests for `roc_curve` in the specified test file.' refined_query='Please provide all test functions from `sklearn/metrics/tests/test_ranking.py` that test the `roc_curve` function. I am particularly interested in tests that make assertions on the `thresholds` array, use different `y_score` inputs, or test edge cases and different parameters like `pos_label` and `sample_weight`.'
2025-10-04 05:01:32,850 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"type": "function_definition", "relative_path": "sklearn/metrics/tests/test_ranking.py"}'}, '__gemini_function_call_thought_signatures__': {'768cbde1-d9c5-40db-aa2a-74bfa39e2cd5': 'CosLAR/MhbZsFljXOfwmqc9nTq6tFhGw6exejxzpTHdt4wpdtiCTbi+R8EbD2AVTytLqD0gP28d238U133QPJ8IZgwFCsia+6abRwARGQsY88+3X+xn8lEJVyByYrGT44zb7BXXpovo/iXc6s/nzr25Kf7TcLeUijeuZPMkU1fWg4dyeGe8r3ZKVbLzoM74cBxLwgVCl+r0kGmgzBSbOIuFdA/YWmlQbRlTbWDXhFTne1tcD+r8xi8a2XNfPCWAjYjTu+uqT4G0gW08PKxbf1yi9YQVRvECqNOBv3q0wD0xDeyR94Ke1evha6yc3J3q2KUVZYM/8Mg2lzbPXAGUKV0e94jw/2cDRIo60LeFI869dexWK7KKUjQFf0vfdkxPUulZ+jpUH2mkjZG1Tp0h52bnKCdbY0eQR14XuSI+cNOuMms/yzy45xmJpaybq/1S9OZwMBoCeCzC7x++y85thbbEOQiFase00jPSPbaYCUbruN9P3jsovHRmx0oZ2fLX85fndpm+1m111hnBisiMV/O26uEXBFKZbmNXPWL9Fkw3TbHoRvUbn9XAHlOA4Mc6JaUZEQ9qpq65uhY5eBaBrYQJfQKoUuey43nmNP+7WH4tvu2/Dl/uyqPaQiDd5uD1OG+RHmHhqMHIzTUpSiVJaoBb34fsOq4wk05lxj8tx68bs2kQEeV9n+PMc54hRYEyagNJsY3jhEtLwUVmGTXE/yKZstypXkiIlMHjQmhvJ7VclR90aRnBnDzAoclo47bhjRJlou86BW0n6gMrd3kjVx3BbQZQbZmCDnm7c7iq9nXIZuI8ltSTBPiCAAKITLmgdOeB6UX5O59PPJ1+qMRzDR9GgU8Xwgm1WTpMqSpJrelUR4w1ZO8CTUZyIxo7i4rkP6TqESL89+KZnJU8+nM8QKSYYHBmvRtjsubOvdDrC8GsHaCSbX1x/k3CAkTQaVbguApZOZ4FWqXuyd7etC9T2itiZbv0Ivu/p5LstddusgYTowEt8gYLuXDeZdjyg9DNGhKcohaXymSADkL8/SrYXrb1lKlNtDZgSY3Ewq3CBWvXqZ8IyIttPTDfxgxYUREjtCrwKM+diK0HLnG3vwzHFA9aNPV5169B+iS/1FsxtGwCY67c01yl2DMvxGzCzE4Bj1rzP8nKAR/wueB78Q48dIkYjzw2YA4TD38K80MN4DQ+DO8VGmnpH96KW3FfhiCNR1F0yxea9LRnd/213PmHirxoQWRJ8Agcjunr4teM/470yVYQzbZcPtyslE7KX0j5mSETXNdJg4/oV/uZpBzl+v1TfSFUca04DBGlMFvi7Em1VywaNaDxbqZl+N2idlcUJgyM62Ig6OSjE72fj4v2NZQYvNj3IDA3vnilq33PpLp8+yFT4XGqgg7v8VRjrPBooygjqRCvNn1Zry+zlq1FuqfNVgf3gKpUBhoWHarB7cA72pXCvBqjWclHfhFrcqcwHb2325qqOOgIFur8lThvCoAe04Ve2ErgWEAYdniMxp2wa3zUCD2fx6pKyq6xyqFweRjUYucsKXs0DVtRGtYsy1+NOWxZBjHmo9NDWHLnqmjUzemznOF87w41+YSU7UrcDRwsh82QI+8ZEJIjavVouh0kQqa0O+yzXpg1FsR9RGWOCpLi+MPHIHRo8oI+23AXQe9xTqwVZ1qro2RDFAtQxqzrgMDmUNeGEUcmqvsZ6RNhMNZ3XG53MdCRhZAYULNytajdb/xUjM8kNc6EoY7CqHscP0KCBi2S7RSlS0LZhBfCv5/SZngp9ZhKweXIsu6fKyFcmJP0yCMBVUIPmJeg/ltH2Snr1YsxQ1OB7vwhIn4plMOojDVaZS2Glr09YVpDsjAUsMM5W2jU0D/MQz+yLhiKZGm+pUcdV/V419eH5'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16852, 'candidates_token_count': 38, 'total_token_count': 17257, 'prompt_tokens_details': [{'modality': 1, 'token_count': 16852}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 38}], 'thoughts_token_count': 367, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5202132275230006, 'model_name': 'gemini-2.5-pro'} id='run--bd228b34-1522-4571-9612-637708eb91e0-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'type': 'function_definition', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '768cbde1-d9c5-40db-aa2a-74bfa39e2cd5', 'type': 'tool_call'}] usage_metadata={'input_tokens': 16852, 'output_tokens': 38, 'total_tokens': 17257, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 367}}
2025-10-04 05:02:35,898 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_relative_path', 'arguments': '{"type": "function_definition", "relative_path": "sklearn/metrics/tests/test_ranking.py"}'}, '__gemini_function_call_thought_signatures__': {'8cc04425-c1c5-40c6-b2b2-f8c24eed4ff3': 'CtsEAR/Mhbb3omoeuqP2uPtfTbpSQBYc2pSssPCexX+n9pzdMfVngBhIrPfGOYj/SuXzb4m4hpfK6sWKEzM/oHwfcxJICkk5oYSVJiqDnAmxUfMsLCiSYGKcPWLM37VSI8EyJiSYgTlUzEk0bmpsenx/aF+H2cwHb9dSMwSGB2hYh++f8Tr1peJVvSocEP8W3RYTxbtNNXbDmufY1uuu89EcuAI3vdw1SfVWXYBGRvW3oJ+r4OsWSSW7VRxsh0VWFyLIypybID1Ii7+ChOV0NU8Qd1bjrg6YI9cCSYPpce6Hlcv3pwDvu6knRB/avCw6NXmIKusJfGhn/2ipccrcrBUL8tZPBnYsSxlplrTTVQf3qKxu624IQOxlKznjkOybl8w3ydwev1RCjp4zrd7ZLgvZf8Sa540Q/TgUEa7aSIlWBxHThi7zOVKhmNF5KS6A+MA2VJryJhVw+OaNQgbV8YsJAegmJNF/bFhT504Ge/Zxc9zgZd0s9VbJxSp6DFJmWxv49APBkjjJq20i0y90o9iXQRxwQ5zDnmFZGcE78Nc5winOunVkk8/Z/L0N88uzIeMetP9L+6j+WuJ2KEYFVogugBdsU4krJpeEooGvywo6gCA7IU7cWMymZsa71hWXODVzt+hx0T1gxAce2TwjL1zXG5GEJoPlXBa+5ibKNrE9wBIv6122PYsbH9qH+qPG2PI5gOXstmclSsb4QhtXITeetzVFiYhtYyrPMxYkzqM8IPcftbBt40gtYzaVjGooMOLz1GHvhF2jdNnmtd4diF7BW4tvJwRCNVpvSB51'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 17810, 'candidates_token_count': 38, 'total_token_count': 20538, 'cached_content_token_count': 15559, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18175}], 'cache_tokens_details': [{'modality': 1, 'token_count': 15559}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 38}], 'thoughts_token_count': 2690}, 'finish_reason': 'STOP', 'avg_logprobs': -11.320697985197368, 'model_name': 'gemini-2.5-pro'} id='run--37eaf95f-1d38-4dc7-8215-e8178b8119d7-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_relative_path', 'args': {'type': 'function_definition', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '8cc04425-c1c5-40c6-b2b2-f8c24eed4ff3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 17810, 'output_tokens': 38, 'total_tokens': 20538, 'input_token_details': {'cache_read': 15559}, 'output_token_details': {'reasoning': 2690}}
2025-10-04 05:02:37,914 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "sklearn/metrics/tests/test_ranking.py"}'}, '__gemini_function_call_thought_signatures__': {'76888417-4174-4068-9265-37102fcd3f7c': 'Cu4BAR/Mhba2xe6mdOu0BnhqrBZwkNY9Kwb7vgxZTNX+aC/GUfYp+5WMKmVUigdPnD8qRdwNe8szswQCogT9QMW1KEHXy8vvoLuNVLfiEjPr6rftThl1cZbTLpPv/LEpJ3zl+DXFeuBcJQk7cD/xJ8RzUYNOb9e6eDRN72R6w7EbLJJpWyYjOh8wEYZcBisTHfe7MAJvwL3h9ip8T2ZSv7G+WT70QcBv0GRPzAKBET4v3hoFYnEklWWfobn8NEPZKFYk05o72ng+xWRzAEsZvgN7pCDQoVj/9Gk1JUqHx4VkZL5hEGTuzBU4kjP7YPztAw=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18768, 'candidates_token_count': 26, 'total_token_count': 18838, 'cached_content_token_count': 17443, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19260}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17443}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 44}, 'finish_reason': 'STOP', 'avg_logprobs': -0.22142313076899603, 'model_name': 'gemini-2.5-pro'} id='run--51887392-a95d-482d-b4a6-8cd09bf92240-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '76888417-4174-4068-9265-37102fcd3f7c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 18768, 'output_tokens': 26, 'total_tokens': 18838, 'input_token_details': {'cache_read': 17443}, 'output_token_details': {'reasoning': 44}}
2025-10-04 05:03:02,719 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content="I have found several test functions in `sklearn/metrics/tests/test_ranking.py` that are relevant to your query. I've looked for tests that examine the `thresholds` array, use varied `y_score` inputs, and explore edge cases and parameters such as `pos_label` and `sample_weight`. The functions I found cover a range of scenarios, including basic functionality, handling of confidence scores and hard decisions, and behavior with single-label inputs. Additionally, I located tests that specifically address the `drop_intermediate` parameter's effect on thresholds and the use of `sample_weight`." additional_kwargs={'function_call': {'name': 'read_code_with_relative_path', 'arguments': '{"start_line": 1049.0, "relative_path": "sklearn/metrics/tests/test_ranking.py", "end_line": 1075.0}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 27502, 'candidates_token_count': 786, 'total_token_count': 29690, 'cached_content_token_count': 17709, 'prompt_tokens_details': [{'modality': 1, 'token_count': 28036}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17709}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 786}], 'thoughts_token_count': 1402}, 'finish_reason': 'STOP', 'avg_logprobs': -0.18616077918132753, 'model_name': 'gemini-2.5-pro'} id='run--7dbbac92-9e64-409a-870f-0ca5217c4172-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def test_roc_curve_drop_intermediate():', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '43d77e1b-a0a2-4517-a4c9-dc36631dc255', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def test_roc_curve_fpr_tpr_increasing():', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': 'fd353ccf-7251-45ff-8f0d-bdf3b7e55f93', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def test_roc_auc_score_pos_label():', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': 'd8535352-6ae7-46ba-a16c-b7b0d5ded894', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def test_roc_auc_score_sample_weight():', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '01268476-7be3-4ce8-a932-a0b77a1dd1f8', 'type': 'tool_call'}, {'name': 'find_ast_node_with_text_in_file_with_relative_path', 'args': {'text': 'def test_roc_curve_with_pos_label_promotion():', 'relative_path': 'sklearn/metrics/tests/test_ranking.py'}, 'id': '4d7970e7-fba8-48c3-8fdb-0374d4736307', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 193.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 205.0}, 'id': '79b0d788-873e-4145-b55a-74f88a5a6383', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 206.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 218.0}, 'id': 'be0ef9ff-31f7-47f3-9135-01ff0c82eecc', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 219.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 237.0}, 'id': 'd6df48c2-0ac0-4f69-8309-53f4a591da2d', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 238.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 244.0}, 'id': '99571a11-c8b7-4b9a-8895-bf6c7257804e', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 246.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 256.0}, 'id': '95d074c4-1367-4094-b921-f740ffd4faad', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 257.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 284.0}, 'id': 'ca26662d-4ec7-4a62-9791-b9e136c74396', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'start_line': 285.0, 'end_line': 311.0}, 'id': '56c129c6-f050-47cf-bb5a-eda5b9d11862', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 312.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 415.0}, 'id': '2261171d-1111-4df5-9d13-c1d2ca4dfab3', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 416.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 429.0}, 'id': 'ff33eb4c-9a7b-4802-9341-bbf064c661ce', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'start_line': 430.0, 'end_line': 441.0}, 'id': '83a6f24d-4ccb-4b7e-bd14-5674f52dfb26', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 851.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 872.0}, 'id': '906cc36e-50d3-435a-83ac-37c165ef25b4', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 875.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 911.0}, 'id': 'bc2f4168-09ae-4ab6-94fd-209776363db3', 'type': 'tool_call'}, {'name': 'read_code_with_relative_path', 'args': {'start_line': 1049.0, 'relative_path': 'sklearn/metrics/tests/test_ranking.py', 'end_line': 1075.0}, 'id': '5dd9996b-3fdd-46dd-aa30-dd05f5a2ff4e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 27502, 'output_tokens': 786, 'total_tokens': 29690, 'input_token_details': {'cache_read': 17709}, 'output_token_details': {'reasoning': 1402}}
2025-10-04 05:03:04,201 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={} response_metadata={'usage_metadata': {'prompt_token_count': 36696, 'total_token_count': 36696, 'cached_content_token_count': 26954, 'prompt_tokens_details': [{'modality': 1, 'token_count': 36696}], 'cache_tokens_details': [{'modality': 1, 'token_count': 26954}], 'candidates_token_count': 0, 'thoughts_token_count': 0, 'candidates_tokens_details': []}, 'model_name': 'gemini-2.5-pro'} id='run--86bd56ae-717b-42c2-a3da-77f36fcc5378-0' usage_metadata={'input_tokens': 36696, 'output_tokens': 0, 'total_tokens': 36696, 'input_token_details': {'cache_read': 26954}}
2025-10-04 05:03:04,202 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 05:03:04,203 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
Thresholds can exceed 1 in `roc_curve` while providing probability estimate

Issue description: 
While working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:

```python
def test_roc_curve_with_probablity_estimates():
    rng = np.random.RandomState(42)
    y_true = rng.randint(0, 2, size=10)
    y_score = rng.rand(10)
    _, _, thresholds = roc_curve(y_true, y_score)
    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()
```

The reason is due to the following:

https://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086

Basically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.

I am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide all test functions from `sklearn/metrics/tests/test_ranking.py` that test the `roc_curve` function. I am particularly interested in tests that make assertions on the `thresholds` array, use different `y_score` inputs, or test edge cases and different parameters like `pos_label` and `sample_weight`.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: sklearn/metrics/tests/test_ranking.py
Line number range: 1576 - 1577
Content:
def test_lrap_error_raised():
    check_lrap_error_raised(label_ranking_average_precision_score)

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1814 - 1818
Content:
def test_ndcg_ignore_ties_with_k():
    a = np.arange(12).reshape((2, 6))
    assert ndcg_score(a, a, k=3, ignore_ties=True) == pytest.approx(
        ndcg_score(a, a, k=3, ignore_ties=True)
    )

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1260 - 1265
Content:
def test_det_curve_sanity_check():
    # Exactly duplicated inputs yield the same result.
    assert_allclose(
        det_curve([0, 0, 1], [0, 0.5, 1]),
        det_curve([0, 0, 0, 0, 1, 1], [0, 0, 0.5, 0.5, 1, 1]),
    )

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1775 - 1780
Content:
def test_dcg_score():
    _, y_true = make_multilabel_classification(random_state=0, n_classes=10)
    y_score = -y_true + 1
    _test_dcg_score_for(y_true, y_score)
    y_true, y_score = np.random.RandomState(0).random_sample((2, 100, 10))
    _test_dcg_score_for(y_true, y_score)

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1 - 500
Content:
1. import re
2. import pytest
3. import numpy as np
4. import warnings
5. from scipy.sparse import csr_matrix
6. from scipy import stats
7. 
8. from sklearn import datasets
9. from sklearn import svm
10. 
11. from sklearn.utils.extmath import softmax
12. from sklearn.datasets import make_multilabel_classification
13. from sklearn.random_projection import _sparse_random_matrix
14. from sklearn.utils.validation import check_array, check_consistent_length
15. from sklearn.utils.validation import check_random_state
16. 
17. from sklearn.utils._testing import assert_allclose
18. from sklearn.utils._testing import assert_almost_equal
19. from sklearn.utils._testing import assert_array_equal
20. from sklearn.utils._testing import assert_array_almost_equal
21. 
22. from sklearn.metrics import accuracy_score
23. from sklearn.metrics import auc
24. from sklearn.metrics import average_precision_score
25. from sklearn.metrics import coverage_error
26. from sklearn.metrics import det_curve
27. from sklearn.metrics import label_ranking_average_precision_score
28. from sklearn.metrics import precision_recall_curve
29. from sklearn.metrics import label_ranking_loss
30. from sklearn.metrics import roc_auc_score
31. from sklearn.metrics import roc_curve
32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores
33. from sklearn.metrics import ndcg_score, dcg_score
34. from sklearn.metrics import top_k_accuracy_score
35. 
36. from sklearn.exceptions import UndefinedMetricWarning
37. from sklearn.model_selection import train_test_split
38. from sklearn.linear_model import LogisticRegression
39. from sklearn.preprocessing import label_binarize
40. 
41. 
42. ###############################################################################
43. # Utilities for testing
44. 
45. CURVE_FUNCS = [
46.     det_curve,
47.     precision_recall_curve,
48.     roc_curve,
49. ]
50. 
51. 
52. def make_prediction(dataset=None, binary=False):
53.     """Make some classification predictions on a toy dataset using a SVC
54. 
55.     If binary is True restrict to a binary classification problem instead of a
56.     multiclass classification problem
57.     """
58. 
59.     if dataset is None:
60.         # import some data to play with
61.         dataset = datasets.load_iris()
62. 
63.     X = dataset.data
64.     y = dataset.target
65. 
66.     if binary:
67.         # restrict to a binary classification task
68.         X, y = X[y < 2], y[y < 2]
69. 
70.     n_samples, n_features = X.shape
71.     p = np.arange(n_samples)
72. 
73.     rng = check_random_state(37)
74.     rng.shuffle(p)
75.     X, y = X[p], y[p]
76.     half = int(n_samples / 2)
77. 
78.     # add noisy features to make the problem harder and avoid perfect results
79.     rng = np.random.RandomState(0)
80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]
81. 
82.     # run classifier, get class probabilities and label predictions
83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)
84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])
85. 
86.     if binary:
87.         # only interested in probabilities of the positive case
88.         # XXX: do we really want a special API for the binary case?
89.         y_score = y_score[:, 1]
90. 
91.     y_pred = clf.predict(X[half:])
92.     y_true = y[half:]
93.     return y_true, y_pred, y_score
94. 
95. 
96. ###############################################################################
97. # Tests
98. 
99. 
100. def _auc(y_true, y_score):
101.     """Alternative implementation to check for correctness of
102.     `roc_auc_score`."""
103.     pos_label = np.unique(y_true)[1]
104. 
105.     # Count the number of times positive samples are correctly ranked above
106.     # negative samples.
107.     pos = y_score[y_true == pos_label]
108.     neg = y_score[y_true != pos_label]
109.     diff_matrix = pos.reshape(1, -1) - neg.reshape(-1, 1)
110.     n_correct = np.sum(diff_matrix > 0)
111. 
112.     return n_correct / float(len(pos) * len(neg))
113. 
114. 
115. def _average_precision(y_true, y_score):
116.     """Alternative implementation to check for correctness of
117.     `average_precision_score`.
118. 
119.     Note that this implementation fails on some edge cases.
120.     For example, for constant predictions e.g. [0.5, 0.5, 0.5],
121.     y_true = [1, 0, 0] returns an average precision of 0.33...
122.     but y_true = [0, 0, 1] returns 1.0.
123.     """
124.     pos_label = np.unique(y_true)[1]
125.     n_pos = np.sum(y_true == pos_label)
126.     order = np.argsort(y_score)[::-1]
127.     y_score = y_score[order]
128.     y_true = y_true[order]
129. 
130.     score = 0
131.     for i in range(len(y_score)):
132.         if y_true[i] == pos_label:
133.             # Compute precision up to document i
134.             # i.e, percentage of relevant documents up to document i.
135.             prec = 0
136.             for j in range(0, i + 1):
137.                 if y_true[j] == pos_label:
138.                     prec += 1.0
139.             prec /= i + 1.0
140.             score += prec
141. 
142.     return score / n_pos
143. 
144. 
145. def _average_precision_slow(y_true, y_score):
146.     """A second alternative implementation of average precision that closely
147.     follows the Wikipedia article's definition (see References). This should
148.     give identical results as `average_precision_score` for all inputs.
149. 
150.     References
151.     ----------
152.     .. [1] `Wikipedia entry for the Average precision
153.        <https://en.wikipedia.org/wiki/Average_precision>`_
154.     """
155.     precision, recall, threshold = precision_recall_curve(y_true, y_score)
156.     precision = list(reversed(precision))
157.     recall = list(reversed(recall))
158.     average_precision = 0
159.     for i in range(1, len(precision)):
160.         average_precision += precision[i] * (recall[i] - recall[i - 1])
161.     return average_precision
162. 
163. 
164. def _partial_roc_auc_score(y_true, y_predict, max_fpr):
165.     """Alternative implementation to check for correctness of `roc_auc_score`
166.     with `max_fpr` set.
167.     """
168. 
169.     def _partial_roc(y_true, y_predict, max_fpr):
170.         fpr, tpr, _ = roc_curve(y_true, y_predict)
171.         new_fpr = fpr[fpr <= max_fpr]
172.         new_fpr = np.append(new_fpr, max_fpr)
173.         new_tpr = tpr[fpr <= max_fpr]
174.         idx_out = np.argmax(fpr > max_fpr)
175.         idx_in = idx_out - 1
176.         x_interp = [fpr[idx_in], fpr[idx_out]]
177.         y_interp = [tpr[idx_in], tpr[idx_out]]
178.         new_tpr = np.append(new_tpr, np.interp(max_fpr, x_interp, y_interp))
179.         return (new_fpr, new_tpr)
180. 
181.     new_fpr, new_tpr = _partial_roc(y_true, y_predict, max_fpr)
182.     partial_auc = auc(new_fpr, new_tpr)
183. 
184.     # Formula (5) from McClish 1989
185.     fpr1 = 0
186.     fpr2 = max_fpr
187.     min_area = 0.5 * (fpr2 - fpr1) * (fpr2 + fpr1)
188.     max_area = fpr2 - fpr1
189.     return 0.5 * (1 + (partial_auc - min_area) / (max_area - min_area))
190. 
191. 
192. @pytest.mark.parametrize("drop", [True, False])
193. def test_roc_curve(drop):
194.     # Test Area under Receiver Operating Characteristic (ROC) curve
195.     y_true, _, y_score = make_prediction(binary=True)
196.     expected_auc = _auc(y_true, y_score)
197. 
198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)
199.     roc_auc = auc(fpr, tpr)
200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)
201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))
202.     assert fpr.shape == tpr.shape
203.     assert fpr.shape == thresholds.shape
204. 
205. 
206. def test_roc_curve_end_points():
207.     # Make sure that roc_curve returns a curve start at 0 and ending and
208.     # 1 even in corner cases
209.     rng = np.random.RandomState(0)
210.     y_true = np.array([0] * 50 + [1] * 50)
211.     y_pred = rng.randint(3, size=100)
212.     fpr, tpr, thr = roc_curve(y_true, y_pred, drop_intermediate=True)
213.     assert fpr[0] == 0
214.     assert fpr[-1] == 1
215.     assert fpr.shape == tpr.shape
216.     assert fpr.shape == thr.shape
217. 
218. 
219. def test_roc_returns_consistency():
220.     # Test whether the returned threshold matches up with tpr
221.     # make small toy dataset
222.     y_true, _, y_score = make_prediction(binary=True)
223.     fpr, tpr, thresholds = roc_curve(y_true, y_score)
224. 
225.     # use the given thresholds to determine the tpr
226.     tpr_correct = []
227.     for t in thresholds:
228.         tp = np.sum((y_score >= t) & y_true)
229.         p = np.sum(y_true)
230.         tpr_correct.append(1.0 * tp / p)
231. 
232.     # compare tpr and tpr_correct to see if the thresholds' order was correct
233.     assert_array_almost_equal(tpr, tpr_correct, decimal=2)
234.     assert fpr.shape == tpr.shape
235.     assert fpr.shape == thresholds.shape
236. 
237. 
238. def test_roc_curve_multi():
239.     # roc_curve not applicable for multi-class problems
240.     y_true, _, y_score = make_prediction(binary=False)
241. 
242.     with pytest.raises(ValueError):
243.         roc_curve(y_true, y_score)
244. 
245. 
246. def test_roc_curve_confidence():
247.     # roc_curve for confidence scores
248.     y_true, _, y_score = make_prediction(binary=True)
249. 
250.     fpr, tpr, thresholds = roc_curve(y_true, y_score - 0.5)
251.     roc_auc = auc(fpr, tpr)
252.     assert_array_almost_equal(roc_auc, 0.90, decimal=2)
253.     assert fpr.shape == tpr.shape
254.     assert fpr.shape == thresholds.shape
255. 
256. 
257. def test_roc_curve_hard():
258.     # roc_curve for hard decisions
259.     y_true, pred, y_score = make_prediction(binary=True)
260. 
261.     # always predict one
262.     trivial_pred = np.ones(y_true.shape)
263.     fpr, tpr, thresholds = roc_curve(y_true, trivial_pred)
264.     roc_auc = auc(fpr, tpr)
265.     assert_array_almost_equal(roc_auc, 0.50, decimal=2)
266.     assert fpr.shape == tpr.shape
267.     assert fpr.shape == thresholds.shape
268. 
269.     # always predict zero
270.     trivial_pred = np.zeros(y_true.shape)
271.     fpr, tpr, thresholds = roc_curve(y_true, trivial_pred)
272.     roc_auc = auc(fpr, tpr)
273.     assert_array_almost_equal(roc_auc, 0.50, decimal=2)
274.     assert fpr.shape == tpr.shape
275.     assert fpr.shape == thresholds.shape
276. 
277.     # hard decisions
278.     fpr, tpr, thresholds = roc_curve(y_true, pred)
279.     roc_auc = auc(fpr, tpr)
280.     assert_array_almost_equal(roc_auc, 0.78, decimal=2)
281.     assert fpr.shape == tpr.shape
282.     assert fpr.shape == thresholds.shape
283. 
284. 
285. def test_roc_curve_one_label():
286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]
288.     # assert there are warnings
289.     expected_message = (
290.         "No negative samples in y_true, false positive value should be meaningless"
291.     )
292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)
294. 
295.     # all true labels, all fpr should be nan
296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))
297.     assert fpr.shape == tpr.shape
298.     assert fpr.shape == thresholds.shape
299. 
300.     # assert there are warnings
301.     expected_message = (
302.         "No positive samples in y_true, true positive value should be meaningless"
303.     )
304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)
306.     # all negative labels, all tpr should be nan
307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))
308.     assert fpr.shape == tpr.shape
309.     assert fpr.shape == thresholds.shape
310. 
311. 
312. def test_roc_curve_toydata():
313.     # Binary classification
314.     y_true = [0, 1]
315.     y_score = [0, 1]
316.     tpr, fpr, _ = roc_curve(y_true, y_score)
317.     roc_auc = roc_auc_score(y_true, y_score)
318.     assert_array_almost_equal(tpr, [0, 0, 1])
319.     assert_array_almost_equal(fpr, [0, 1, 1])
320.     assert_almost_equal(roc_auc, 1.0)
321. 
322.     y_true = [0, 1]
323.     y_score = [1, 0]
324.     tpr, fpr, _ = roc_curve(y_true, y_score)
325.     roc_auc = roc_auc_score(y_true, y_score)
326.     assert_array_almost_equal(tpr, [0, 1, 1])
327.     assert_array_almost_equal(fpr, [0, 0, 1])
328.     assert_almost_equal(roc_auc, 0.0)
329. 
330.     y_true = [1, 0]
331.     y_score = [1, 1]
332.     tpr, fpr, _ = roc_curve(y_true, y_score)
333.     roc_auc = roc_auc_score(y_true, y_score)
334.     assert_array_almost_equal(tpr, [0, 1])
335.     assert_array_almost_equal(fpr, [0, 1])
336.     assert_almost_equal(roc_auc, 0.5)
337. 
338.     y_true = [1, 0]
339.     y_score = [1, 0]
340.     tpr, fpr, _ = roc_curve(y_true, y_score)
341.     roc_auc = roc_auc_score(y_true, y_score)
342.     assert_array_almost_equal(tpr, [0, 0, 1])
343.     assert_array_almost_equal(fpr, [0, 1, 1])
344.     assert_almost_equal(roc_auc, 1.0)
345. 
346.     y_true = [1, 0]
347.     y_score = [0.5, 0.5]
348.     tpr, fpr, _ = roc_curve(y_true, y_score)
349.     roc_auc = roc_auc_score(y_true, y_score)
350.     assert_array_almost_equal(tpr, [0, 1])
351.     assert_array_almost_equal(fpr, [0, 1])
352.     assert_almost_equal(roc_auc, 0.5)
353. 
354.     y_true = [0, 0]
355.     y_score = [0.25, 0.75]
356.     # assert UndefinedMetricWarning because of no positive sample in y_true
357.     expected_message = (
358.         "No positive samples in y_true, true positive value should be meaningless"
359.     )
360.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
361.         tpr, fpr, _ = roc_curve(y_true, y_score)
362. 
363.     with pytest.raises(ValueError):
364.         roc_auc_score(y_true, y_score)
365.     assert_array_almost_equal(tpr, [0.0, 0.5, 1.0])
366.     assert_array_almost_equal(fpr, [np.nan, np.nan, np.nan])
367. 
368.     y_true = [1, 1]
369.     y_score = [0.25, 0.75]
370.     # assert UndefinedMetricWarning because of no negative sample in y_true
371.     expected_message = (
372.         "No negative samples in y_true, false positive value should be meaningless"
373.     )
374.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
375.         tpr, fpr, _ = roc_curve(y_true, y_score)
376. 
377.     with pytest.raises(ValueError):
378.         roc_auc_score(y_true, y_score)
379.     assert_array_almost_equal(tpr, [np.nan, np.nan, np.nan])
380.     assert_array_almost_equal(fpr, [0.0, 0.5, 1.0])
381. 
382.     # Multi-label classification task
383.     y_true = np.array([[0, 1], [0, 1]])
384.     y_score = np.array([[0, 1], [0, 1]])
385.     with pytest.raises(ValueError):
386.         roc_auc_score(y_true, y_score, average="macro")
387.     with pytest.raises(ValueError):
388.         roc_auc_score(y_true, y_score, average="weighted")
389.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 1.0)
390.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 1.0)
391. 
392.     y_true = np.array([[0, 1], [0, 1]])
393.     y_score = np.array([[0, 1], [1, 0]])
394.     with pytest.raises(ValueError):
395.         roc_auc_score(y_true, y_score, average="macro")
396.     with pytest.raises(ValueError):
397.         roc_auc_score(y_true, y_score, average="weighted")
398.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 0.5)
399.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 0.5)
400. 
401.     y_true = np.array([[1, 0], [0, 1]])
402.     y_score = np.array([[0, 1], [1, 0]])
403.     assert_almost_equal(roc_auc_score(y_true, y_score, average="macro"), 0)
404.     assert_almost_equal(roc_auc_score(y_true, y_score, average="weighted"), 0)
405.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 0)
406.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 0)
407. 
408.     y_true = np.array([[1, 0], [0, 1]])
409.     y_score = np.array([[0.5, 0.5], [0.5, 0.5]])
410.     assert_almost_equal(roc_auc_score(y_true, y_score, average="macro"), 0.5)
411.     assert_almost_equal(roc_auc_score(y_true, y_score, average="weighted"), 0.5)
412.     assert_almost_equal(roc_auc_score(y_true, y_score, average="samples"), 0.5)
413.     assert_almost_equal(roc_auc_score(y_true, y_score, average="micro"), 0.5)
414. 
415. 
416. def test_roc_curve_drop_intermediate():
417.     # Test that drop_intermediate drops the correct thresholds
418.     y_true = [0, 0, 0, 0, 1, 1]
419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]
420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])
422. 
423.     # Test dropping thresholds with repeating scores
424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]
425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]
426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])
428. 
429. 
430. def test_roc_curve_fpr_tpr_increasing():
431.     # Ensure that fpr and tpr returned by roc_curve are increasing.
432.     # Construct an edge case with float y_score and sample_weight
433.     # when some adjacent values of fpr and tpr are actually the same.
434.     y_true = [0, 0, 1, 1, 1]
435.     y_score = [0.1, 0.7, 0.3, 0.4, 0.5]
436.     sample_weight = np.repeat(0.2, 5)
437.     fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=sample_weight)
438.     assert (np.diff(fpr) < 0).sum() == 0
439.     assert (np.diff(tpr) < 0).sum() == 0
440. 
441. 
442. def test_auc():
443.     # Test Area Under Curve (AUC) computation
444.     x = [0, 1]
445.     y = [0, 1]
446.     assert_array_almost_equal(auc(x, y), 0.5)
447.     x = [1, 0]
448.     y = [0, 1]
449.     assert_array_almost_equal(auc(x, y), 0.5)
450.     x = [1, 0, 0]
451.     y = [0, 1, 1]
452.     assert_array_almost_equal(auc(x, y), 0.5)
453.     x = [0, 1]
454.     y = [1, 1]
455.     assert_array_almost_equal(auc(x, y), 1)
456.     x = [0, 0.5, 1]
457.     y = [0, 0.5, 1]
458.     assert_array_almost_equal(auc(x, y), 0.5)
459. 
460. 
461. def test_auc_errors():
462.     # Incompatible shapes
463.     with pytest.raises(ValueError):
464.         auc([0.0, 0.5, 1.0], [0.1, 0.2])
465. 
466.     # Too few x values
467.     with pytest.raises(ValueError):
468.         auc([0.0], [0.1])
469. 
470.     # x is not in order
471.     x = [2, 1, 3, 4]
472.     y = [5, 6, 7, 8]
473.     error_message = "x is neither increasing nor decreasing : {}".format(np.array(x))
474.     with pytest.raises(ValueError, match=re.escape(error_message)):
475.         auc(x, y)
476. 
477. 
478. @pytest.mark.parametrize(
479.     "y_true, labels",
480.     [
481.         (np.array([0, 1, 0, 2]), [0, 1, 2]),
482.         (np.array([0, 1, 0, 2]), None),
483.         (["a", "b", "a", "c"], ["a", "b", "c"]),
484.         (["a", "b", "a", "c"], None),
485.     ],
486. )
487. def test_multiclass_ovo_roc_auc_toydata(y_true, labels):
488.     # Tests the one-vs-one multiclass ROC AUC algorithm
489.     # on a small example, representative of an expected use case.
490.     y_scores = np.array(
491.         [[0.1, 0.8, 0.1], [0.3, 0.4, 0.3], [0.35, 0.5, 0.15], [0, 0.2, 0.8]]
492.     )
493. 
494.     # Used to compute the expected output.
495.     # Consider labels 0 and 1:
496.     # positive label is 0, negative label is 1
497.     score_01 = roc_auc_score([1, 0, 1], [0.1, 0.3, 0.35])
498.     # positive label is 1, negative label is 0
499.     score_10 = roc_auc_score([0, 1, 0], [0.8, 0.4, 0.5])
500.     average_score_01 = (score_01 + score_10) / 2

File: sklearn/metrics/tests/test_ranking.py
Line number range: 851 - 872
Content:
851.     # error for any supported string dtype:
852.     msg = (
853.         "y_true takes value in {'a', 'b'} and pos_label is "
854.         "not specified: either make y_true take "
855.         "value in {0, 1} or {-1, 1} or pass pos_label "
856.         "explicitly."
857.     )
858.     with pytest.raises(ValueError, match=msg):
859.         curve_func(np.array(["a", "b"], dtype="<U1"), [0.0, 1.0])
860. 
861.     with pytest.raises(ValueError, match=msg):
862.         curve_func(np.array(["a", "b"], dtype=object), [0.0, 1.0])
863. 
864.     # The error message is slightly different for bytes-encoded
865.     # class labels, but otherwise the behavior is the same:
866.     msg = (
867.         "y_true takes value in {b'a', b'b'} and pos_label is "
868.         "not specified: either make y_true take "
869.         "value in {0, 1} or {-1, 1} or pass pos_label "
870.         "explicitly."
871.     )
872.     with pytest.raises(ValueError, match=msg):

File: sklearn/metrics/tests/test_ranking.py
Line number range: 875 - 911
Content:
875.     # Check that it is possible to use floating point class labels
876.     # that are interpreted similarly to integer class labels:
877.     y_pred = [0.0, 1.0, 0.2, 0.42]
878.     int_curve = curve_func([0, 1, 1, 0], y_pred)
879.     float_curve = curve_func([0.0, 1.0, 1.0, 0.0], y_pred)
880.     for int_curve_part, float_curve_part in zip(int_curve, float_curve):
881.         np.testing.assert_allclose(int_curve_part, float_curve_part)
882. 
883. 
884. @pytest.mark.parametrize("curve_func", CURVE_FUNCS)
885. def test_binary_clf_curve_zero_sample_weight(curve_func):
886.     y_true = [0, 0, 1, 1, 1]
887.     y_score = [0.1, 0.2, 0.3, 0.4, 0.5]
888.     sample_weight = [1, 1, 1, 0.5, 0]
889. 
890.     result_1 = curve_func(y_true, y_score, sample_weight=sample_weight)
891.     result_2 = curve_func(y_true[:-1], y_score[:-1], sample_weight=sample_weight[:-1])
892. 
893.     for arr_1, arr_2 in zip(result_1, result_2):
894.         assert_allclose(arr_1, arr_2)
895. 
896. 
897. @pytest.mark.parametrize("drop", [True, False])
898. def test_precision_recall_curve(drop):
899.     y_true, _, y_score = make_prediction(binary=True)
900.     _test_precision_recall_curve(y_true, y_score, drop)
901. 
902.     # Make sure the first point of the Precision-Recall on the right is:
903.     # (p=1.0, r=class balance) on a non-balanced dataset [1:]
904.     p, r, t = precision_recall_curve(y_true[1:], y_score[1:], drop_intermediate=drop)
905.     assert r[0] == 1.0
906.     assert p[0] == y_true[1:].mean()
907. 
908.     # Use {-1, 1} for labels; make sure original labels aren't modified
909.     y_true[np.where(y_true == 0)] = -1
910.     y_true_copy = y_true.copy()
911.     _test_precision_recall_curve(y_true, y_score, drop)

File: sklearn/metrics/tests/test_ranking.py
Line number range: 1049 - 1075
Content:
1049.             average_precision_score(y_true, y_score, average="macro"), 0.5
1050.         )
1051.         assert_almost_equal(
1052.             average_precision_score(y_true, y_score, average="weighted"), 0.5
1053.         )
1054.         assert_almost_equal(
1055.             average_precision_score(y_true, y_score, average="samples"), 0.5
1056.         )
1057.         assert_almost_equal(
1058.             average_precision_score(y_true, y_score, average="micro"), 0.5
1059.         )
1060. 
1061.         y_true = np.array([[0, 0], [0, 0]])
1062.         y_score = np.array([[0, 1], [0, 1]])
1063.         with pytest.warns(UserWarning, match="No positive class found in y_true"):
1064.             assert_allclose(
1065.                 average_precision_score(y_true, y_score, average="macro"), 0.0
1066.             )
1067.         assert_allclose(
1068.             average_precision_score(y_true, y_score, average="weighted"), 0.0
1069.         )
1070.         with pytest.warns(UserWarning, match="No positive class found in y_true"):
1071.             assert_allclose(
1072.                 average_precision_score(y_true, y_score, average="samples"), 0.0
1073.             )
1074.         with pytest.warns(UserWarning, match="No positive class found in y_true"):
1075.             assert_allclose(


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-04 05:04:05,054 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="This test directly addresses the user's concern by testing the values of the `thresholds` array. The bug report mentions that thresholds can exceed 1, which is caused by adding 1 to the max `y_score`. This test demonstrates this behavior by asserting `thresholds[0]` is `2.0` (since `y_score.max()` is 1.0), which is directly related to the reported issue.", relative_path='sklearn/metrics/tests/test_ranking.py', start_line=416, end_line=427), ContextOutput(reasoning='This test is highly relevant because it verifies the consistency between the returned `thresholds` and the calculated true positive rate (`tpr`). It iterates through the thresholds to ensure they produce the correct `tpr`, which is a strong validation of the threshold values themselves. It also uses probability scores from `make_prediction`, which aligns with the bug report scenario.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=219, end_line=235), ContextOutput(reasoning="This test is relevant as it checks a fundamental property of the ROC curve (monotonicity of `fpr` and `tpr`). More importantly, it uses the `sample_weight` parameter, which was explicitly mentioned in the user's refined query as an area of interest.", relative_path='sklearn/metrics/tests/test_ranking.py', start_line=430, end_line=439), ContextOutput(reasoning='This function tests an important edge case for `roc_curve` where `y_true` contains only a single class (all positive or all negative). The user is interested in edge cases. This test checks for the expected `UndefinedMetricWarning` and that the resulting `fpr` or `tpr` arrays contain `np.nan`, which is crucial for robust implementation.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=285, end_line=309), ContextOutput(reasoning='This test function is valuable because it uses multiple small, handcrafted `y_true` and `y_score` pairs to check various scenarios, including different score distributions and cases that should trigger warnings. This directly addresses the user\'s interest in seeing tests with "different `y_score` inputs" and "edge cases". The provided snippet focuses on the binary classification parts of the test which are most relevant to `roc_curve`.', relative_path='sklearn/metrics/tests/test_ranking.py', start_line=312, end_line=381)]
2025-10-04 05:04:05,055 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='1. import re\n2. import pytest\n3. import numpy as np\n4. import warnings\n5. from scipy.sparse import csr_matrix\n6. from scipy import stats\n7. \n8. from sklearn import datasets\n9. from sklearn import svm\n10. \n11. from sklearn.utils.extmath import softmax\n12. from sklearn.datasets import make_multilabel_classification\n13. from sklearn.random_projection import _sparse_random_matrix\n14. from sklearn.utils.validation import check_array, check_consistent_length\n15. from sklearn.utils.validation import check_random_state\n16. \n17. from sklearn.utils._testing import assert_allclose\n18. from sklearn.utils._testing import assert_almost_equal\n19. from sklearn.utils._testing import assert_array_equal\n20. from sklearn.utils._testing import assert_array_almost_equal\n21. \n22. from sklearn.metrics import accuracy_score\n23. from sklearn.metrics import auc\n24. from sklearn.metrics import average_precision_score\n25. from sklearn.metrics import coverage_error\n26. from sklearn.metrics import det_curve\n27. from sklearn.metrics import label_ranking_average_precision_score\n28. from sklearn.metrics import precision_recall_curve\n29. from sklearn.metrics import label_ranking_loss\n30. from sklearn.metrics import roc_auc_score\n31. from sklearn.metrics import roc_curve\n32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\n33. from sklearn.metrics import ndcg_score, dcg_score\n34. from sklearn.metrics import top_k_accuracy_score\n35. \n36. from sklearn.exceptions import UndefinedMetricWarning\n37. from sklearn.model_selection import train_test_split\n38. from sklearn.linear_model import LogisticRegression\n39. from sklearn.preprocessing import label_binarize\n40. ', start_line_number=1, end_line_number=40), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='416. def test_roc_curve_drop_intermediate():\n417.     # Test that drop_intermediate drops the correct thresholds\n418.     y_true = [0, 0, 0, 0, 1, 1]\n419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]\n420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])\n422. \n423.     # Test dropping thresholds with repeating scores\n424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]\n425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]\n426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])\n428. ', start_line_number=416, end_line_number=428), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='52. def make_prediction(dataset=None, binary=False):\n53.     """Make some classification predictions on a toy dataset using a SVC\n54. \n55.     If binary is True restrict to a binary classification problem instead of a\n56.     multiclass classification problem\n57.     """\n58. \n59.     if dataset is None:\n60.         # import some data to play with\n61.         dataset = datasets.load_iris()\n62. \n63.     X = dataset.data\n64.     y = dataset.target\n65. \n66.     if binary:\n67.         # restrict to a binary classification task\n68.         X, y = X[y < 2], y[y < 2]\n69. \n70.     n_samples, n_features = X.shape\n71.     p = np.arange(n_samples)\n72. \n73.     rng = check_random_state(37)\n74.     rng.shuffle(p)\n75.     X, y = X[p], y[p]\n76.     half = int(n_samples / 2)\n77. \n78.     # add noisy features to make the problem harder and avoid perfect results\n79.     rng = np.random.RandomState(0)\n80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]\n81. \n82.     # run classifier, get class probabilities and label predictions\n83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)\n84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])\n85. \n86.     if binary:\n87.         # only interested in probabilities of the positive case\n88.         # XXX: do we really want a special API for the binary case?\n89.         y_score = y_score[:, 1]\n90. \n91.     y_pred = clf.predict(X[half:])\n92.     y_true = y[half:]\n93.     return y_true, y_pred, y_score\n94. ', start_line_number=52, end_line_number=94), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='192. @pytest.mark.parametrize("drop", [True, False])\n193. def test_roc_curve(drop):\n194.     # Test Area under Receiver Operating Characteristic (ROC) curve\n195.     y_true, _, y_score = make_prediction(binary=True)\n196.     expected_auc = _auc(y_true, y_score)\n197. \n198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)\n199.     roc_auc = auc(fpr, tpr)\n200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)\n201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))\n202.     assert fpr.shape == tpr.shape\n203.     assert fpr.shape == thresholds.shape\n204. ', start_line_number=192, end_line_number=204), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='285. def test_roc_curve_one_label():\n286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n288.     # assert there are warnings\n289.     expected_message = (\n290.         "No negative samples in y_true, false positive value should be meaningless"\n291.     )\n292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)\n294. \n295.     # all true labels, all fpr should be nan\n296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))\n297.     assert fpr.shape == tpr.shape\n298.     assert fpr.shape == thresholds.shape\n299. \n300.     # assert there are warnings\n301.     expected_message = (\n302.         "No positive samples in y_true, true positive value should be meaningless"\n303.     )\n304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)\n306.     # all negative labels, all tpr should be nan\n307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))\n308.     assert fpr.shape == tpr.shape\n309.     assert fpr.shape == thresholds.shape\n310. ', start_line_number=285, end_line_number=310), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content="219. def test_roc_returns_consistency():\n220.     # Test whether the returned threshold matches up with tpr\n221.     # make small toy dataset\n222.     y_true, _, y_score = make_prediction(binary=True)\n223.     fpr, tpr, thresholds = roc_curve(y_true, y_score)\n224. \n225.     # use the given thresholds to determine the tpr\n226.     tpr_correct = []\n227.     for t in thresholds:\n228.         tp = np.sum((y_score >= t) & y_true)\n229.         p = np.sum(y_true)\n230.         tpr_correct.append(1.0 * tp / p)\n231. \n232.     # compare tpr and tpr_correct to see if the thresholds' order was correct\n233.     assert_array_almost_equal(tpr, tpr_correct, decimal=2)\n234.     assert fpr.shape == tpr.shape\n235.     assert fpr.shape == thresholds.shape", start_line_number=219, end_line_number=235), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='430. def test_roc_curve_fpr_tpr_increasing():\n431.     # Ensure that fpr and tpr returned by roc_curve are increasing.\n432.     # Construct an edge case with float y_score and sample_weight\n433.     # when some adjacent values of fpr and tpr are actually the same.\n434.     y_true = [0, 0, 1, 1, 1]\n435.     y_score = [0.1, 0.7, 0.3, 0.4, 0.5]\n436.     sample_weight = np.repeat(0.2, 5)\n437.     fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=sample_weight)\n438.     assert (np.diff(fpr) < 0).sum() == 0\n439.     assert (np.diff(tpr) < 0).sum() == 0', start_line_number=430, end_line_number=439), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='312. def test_roc_curve_toydata():\n313.     # Binary classification\n314.     y_true = [0, 1]\n315.     y_score = [0, 1]\n316.     tpr, fpr, _ = roc_curve(y_true, y_score)\n317.     roc_auc = roc_auc_score(y_true, y_score)\n318.     assert_array_almost_equal(tpr, [0, 0, 1])\n319.     assert_array_almost_equal(fpr, [0, 1, 1])\n320.     assert_almost_equal(roc_auc, 1.0)\n321. \n322.     y_true = [0, 1]\n323.     y_score = [1, 0]\n324.     tpr, fpr, _ = roc_curve(y_true, y_score)\n325.     roc_auc = roc_auc_score(y_true, y_score)\n326.     assert_array_almost_equal(tpr, [0, 1, 1])\n327.     assert_array_almost_equal(fpr, [0, 0, 1])\n328.     assert_almost_equal(roc_auc, 0.0)\n329. \n330.     y_true = [1, 0]\n331.     y_score = [1, 1]\n332.     tpr, fpr, _ = roc_curve(y_true, y_score)\n333.     roc_auc = roc_auc_score(y_true, y_score)\n334.     assert_array_almost_equal(tpr, [0, 1])\n335.     assert_array_almost_equal(fpr, [0, 1])\n336.     assert_almost_equal(roc_auc, 0.5)\n337. \n338.     y_true = [1, 0]\n339.     y_score = [1, 0]\n340.     tpr, fpr, _ = roc_curve(y_true, y_score)\n341.     roc_auc = roc_auc_score(y_true, y_score)\n342.     assert_array_almost_equal(tpr, [0, 0, 1])\n343.     assert_array_almost_equal(fpr, [0, 1, 1])\n344.     assert_almost_equal(roc_auc, 1.0)\n345. \n346.     y_true = [1, 0]\n347.     y_score = [0.5, 0.5]\n348.     tpr, fpr, _ = roc_curve(y_true, y_score)\n349.     roc_auc = roc_auc_score(y_true, y_score)\n350.     assert_array_almost_equal(tpr, [0, 1])\n351.     assert_array_almost_equal(fpr, [0, 1])\n352.     assert_almost_equal(roc_auc, 0.5)\n353. \n354.     y_true = [0, 0]\n355.     y_score = [0.25, 0.75]\n356.     # assert UndefinedMetricWarning because of no positive sample in y_true\n357.     expected_message = (\n358.         "No positive samples in y_true, true positive value should be meaningless"\n359.     )\n360.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n361.         tpr, fpr, _ = roc_curve(y_true, y_score)\n362. \n363.     with pytest.raises(ValueError):\n364.         roc_auc_score(y_true, y_score)\n365.     assert_array_almost_equal(tpr, [0.0, 0.5, 1.0])\n366.     assert_array_almost_equal(fpr, [np.nan, np.nan, np.nan])\n367. \n368.     y_true = [1, 1]\n369.     y_score = [0.25, 0.75]\n370.     # assert UndefinedMetricWarning because of no negative sample in y_true\n371.     expected_message = (\n372.         "No negative samples in y_true, false positive value should be meaningless"\n373.     )\n374.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n375.         tpr, fpr, _ = roc_curve(y_true, y_score)\n376. \n377.     with pytest.raises(ValueError):\n378.         roc_auc_score(y_true, y_score)\n379.     assert_array_almost_equal(tpr, [np.nan, np.nan, np.nan])\n380.     assert_array_almost_equal(fpr, [0.0, 0.5, 1.0])\n381. ', start_line_number=312, end_line_number=381)]
2025-10-04 05:04:05,056 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 05:04:05,056 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
scikit-learn
├── .binder
|   ├── requirements.txt
|   └── runtime.txt
├── .circleci
|   └── config.yml
├── .codecov.yml
├── .github
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── doc_improvement.yml
|   |   └── feature_request.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── labeler-file-extensions.yml
|   ├── labeler-module.yml
|   ├── scripts
|   |   └── label_title_regex.py
|   └── workflows
|       ├── artifact-redirector.yml
|       ├── assign.yml
|       ├── check-changelog.yml
|       ├── check-manifest.yml
|       ├── label-blank-issue.yml
|       ├── labeler-module.yml
|       ├── labeler-title-regex.yml
|       ├── publish_pypi.yml
|       ├── twitter.yml
|       ├── unassign.yml
|       ├── update_tracking_issue.yml
|       └── wheels.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── README.rst
├── SECURITY.md
├── asv_benchmarks
|   └── benchmarks
|       ├── __init__.py
|       ├── cluster.py
|       ├── common.py
|       ├── datasets.py
|       ├── decomposition.py
|       ├── ensemble.py
|       ├── linear_model.py
|       ├── manifold.py
|       ├── metrics.py
|       ├── model_selection.py
|       ├── neighbors.py
|       ├── svm.py
|       └── utils.py
├── azure-pipelines.yml
├── benchmarks
|   ├── bench_20newsgroups.py
|   ├── bench_covertype.py
|   ├── bench_feature_expansions.py
|   ├── bench_glm.py
|   ├── bench_glmnet.py
|   ├── bench_hist_gradient_boosting.py
|   ├── bench_hist_gradient_boosting_adult.py
|   ├── bench_hist_gradient_boosting_categorical_only.py
|   ├── bench_hist_gradient_boosting_higgsboson.py
|   ├── bench_hist_gradient_boosting_threading.py
|   ├── bench_isolation_forest.py
|   ├── bench_isotonic.py
|   ├── bench_kernel_pca_solvers_time_vs_n_components.py
|   ├── bench_kernel_pca_solvers_time_vs_n_samples.py
|   ├── bench_lasso.py
|   ├── bench_lof.py
|   ├── bench_mnist.py
|   ├── bench_multilabel_metrics.py
|   ├── bench_online_ocsvm.py
|   ├── bench_plot_fastkmeans.py
|   ├── bench_plot_hierarchical.py
|   ├── bench_plot_incremental_pca.py
|   ├── bench_plot_lasso_path.py
|   ├── bench_plot_neighbors.py
|   ├── bench_plot_nmf.py
|   ├── bench_plot_omp_lars.py
|   ├── bench_plot_parallel_pairwise.py
|   ├── bench_plot_polynomial_kernel_approximation.py
|   ├── bench_plot_randomized_svd.py
|   ├── bench_plot_svd.py
|   ├── bench_plot_ward.py
|   ├── bench_random_projections.py
|   ├── bench_rcv1_logreg_convergence.py
|   ├── bench_saga.py
|   ├── bench_sample_without_replacement.py
|   ├── bench_sgd_regression.py
|   ├── bench_sparsify.py
|   ├── bench_text_vectorizers.py
|   ├── bench_tree.py
|   ├── bench_tsne_mnist.py
|   └── plot_tsne_mnist.py
├── build_tools
|   ├── azure
|   |   ├── combine_coverage_reports.sh
|   |   ├── debian_atlas_32bit_lock.txt
|   |   ├── debian_atlas_32bit_requirements.txt
|   |   ├── get_commit_message.py
|   |   ├── get_selected_tests.py
|   |   ├── install.sh
|   |   ├── install_win.sh
|   |   ├── posix-all-parallel.yml
|   |   ├── posix-docker.yml
|   |   ├── posix.yml
|   |   ├── py38_conda_defaults_openblas_environment.yml
|   |   ├── py38_conda_forge_mkl_environment.yml
|   |   ├── py38_conda_forge_openblas_ubuntu_2204_environment.yml
|   |   ├── pylatest_conda_forge_mkl_linux-64_environment.yml
|   |   ├── pylatest_conda_forge_mkl_no_coverage_environment.yml
|   |   ├── pylatest_conda_forge_mkl_osx-64_environment.yml
|   |   ├── pylatest_conda_mkl_no_openmp_environment.yml
|   |   ├── pylatest_pip_openblas_pandas_environment.yml
|   |   ├── pylatest_pip_scipy_dev_environment.yml
|   |   ├── pypy3_environment.yml
|   |   ├── python_nogil_lock.txt
|   |   ├── python_nogil_requirements.txt
|   |   ├── test_docs.sh
|   |   ├── test_pytest_soft_dependency.sh
|   |   ├── test_script.sh
|   |   ├── ubuntu_atlas_lock.txt
|   |   ├── ubuntu_atlas_requirements.txt
|   |   ├── upload_codecov.sh
|   |   └── windows.yml
|   ├── circle
|   |   ├── build_doc.sh
|   |   ├── checkout_merge_commit.sh
|   |   ├── doc_environment.yml
|   |   ├── doc_min_dependencies_environment.yml
|   |   ├── download_documentation.sh
|   |   ├── list_versions.py
|   |   └── push_doc.sh
|   ├── cirrus
|   |   ├── arm_tests.yml
|   |   ├── arm_wheel.yml
|   |   ├── build_test_arm.sh
|   |   ├── py39_conda_forge_environment.yml
|   |   └── update_tracking_issue.sh
|   ├── codespell_ignore_words.txt
|   ├── generate_authors_table.py
|   ├── github
|   |   ├── build_minimal_windows_image.sh
|   |   ├── build_source.sh
|   |   ├── check_build_trigger.sh
|   |   ├── check_wheels.py
|   |   ├── repair_windows_wheels.sh
|   |   ├── test_source.sh
|   |   ├── test_windows_wheels.sh
|   |   ├── upload_anaconda.sh
|   |   └── vendor.py
|   ├── linting.sh
|   ├── shared.sh
|   ├── update_environments_and_lock_files.py
|   └── wheels
|       ├── build_wheels.sh
|       └── test_wheels.sh
├── conftest.py
├── doc
|   ├── README.md
|   ├── about.rst
|   ├── authors.rst
|   ├── authors_emeritus.rst
|   ├── binder
|   |   └── requirements.txt
|   ├── common_pitfalls.rst
|   ├── communication_team.rst
|   ├── communication_team_emeritus.rst
|   ├── computing
|   |   ├── computational_performance.rst
|   |   ├── parallelism.rst
|   |   └── scaling_strategies.rst
|   ├── computing.rst
|   ├── conf.py
|   ├── conftest.py
|   ├── contents.rst
|   ├── contributor_experience_team.rst
|   ├── contributor_experience_team_emeritus.rst
|   ├── data_transforms.rst
|   ├── datasets
|   |   ├── loading_other_datasets.rst
|   |   ├── real_world.rst
|   |   ├── sample_generators.rst
|   |   └── toy_dataset.rst
|   ├── datasets.rst
|   ├── developers
|   |   ├── advanced_installation.rst
|   |   ├── bug_triaging.rst
|   |   ├── contributing.rst
|   |   ├── cython.rst
|   |   ├── develop.rst
|   |   ├── index.rst
|   |   ├── maintainer.rst
|   |   ├── minimal_reproducer.rst
|   |   ├── performance.rst
|   |   ├── plotting.rst
|   |   ├── tips.rst
|   |   └── utilities.rst
|   ├── dispatching.rst
|   ├── faq.rst
|   ├── getting_started.rst
|   ├── glossary.rst
|   ├── governance.rst
|   ├── images
|   ├── includes
|   |   ├── big_toc_css.rst
|   |   └── bigger_toc_css.rst
|   ├── inspection.rst
|   ├── install.rst
|   ├── logos
|   |   ├── README.md
|   |   ├── brand_colors
|   |   └── brand_guidelines
|   ├── model_persistence.rst
|   ├── model_selection.rst
|   ├── modules
|   |   ├── array_api.rst
|   |   ├── biclustering.rst
|   |   ├── calibration.rst
|   |   ├── classes.rst
|   |   ├── clustering.rst
|   |   ├── compose.rst
|   |   ├── covariance.rst
|   |   ├── cross_decomposition.rst
|   |   ├── cross_validation.rst
|   |   ├── decomposition.rst
|   |   ├── density.rst
|   |   ├── ensemble.rst
|   |   ├── feature_extraction.rst
|   |   ├── feature_selection.rst
|   |   ├── gaussian_process.rst
|   |   ├── glm_data
|   |   ├── grid_search.rst
|   |   ├── impute.rst
|   |   ├── isotonic.rst
|   |   ├── kernel_approximation.rst
|   |   ├── kernel_ridge.rst
|   |   ├── lda_qda.rst
|   |   ├── learning_curve.rst
|   |   ├── linear_model.rst
|   |   ├── manifold.rst
|   |   ├── metrics.rst
|   |   ├── mixture.rst
|   |   ├── model_evaluation.rst
|   |   ├── multiclass.rst
|   |   ├── naive_bayes.rst
|   |   ├── neighbors.rst
|   |   ├── neural_networks_supervised.rst
|   |   ├── neural_networks_unsupervised.rst
|   |   ├── outlier_detection.rst
|   |   ├── partial_dependence.rst
|   |   ├── permutation_importance.rst
|   |   ├── pipeline.rst
|   |   ├── preprocessing.rst
|   |   ├── preprocessing_targets.rst
|   |   ├── random_projection.rst
|   |   ├── semi_supervised.rst
|   |   ├── sgd.rst
|   |   ├── svm.rst
|   |   ├── tree.rst
|   |   └── unsupervised_reduction.rst
|   ├── preface.rst
|   ├── presentations.rst
|   ├── related_projects.rst
|   ├── roadmap.rst
|   ├── sphinxext
|   |   ├── add_toctree_functions.py
|   |   ├── allow_nan_estimators.py
|   |   ├── doi_role.py
|   |   ├── github_link.py
|   |   └── sphinx_issues.py
|   ├── supervised_learning.rst
|   ├── support.rst
|   ├── templates
|   |   ├── class.rst
|   |   ├── class_with_call.rst
|   |   ├── deprecated_class.rst
|   |   ├── deprecated_class_with_call.rst
|   |   ├── deprecated_class_without_init.rst
|   |   ├── deprecated_function.rst
|   |   ├── display_all_class_methods.rst
|   |   ├── display_only_from_estimator.rst
|   |   ├── function.rst
|   |   ├── generate_deprecated.sh
|   |   └── numpydoc_docstring.rst
|   ├── testimonials
|   |   ├── README.txt
|   |   ├── images
|   |   └── testimonials.rst
|   ├── themes
|   |   └── scikit-learn-modern
|   |       └── static
|   |           ├── css
|   |           └── js
|   ├── tune_toc.rst
|   ├── tutorial
|   |   ├── basic
|   |   |   └── tutorial.rst
|   |   ├── common_includes
|   |   |   └── info.txt
|   |   ├── index.rst
|   |   ├── machine_learning_map
|   |   |   ├── ML_MAPS_README.txt
|   |   |   ├── index.rst
|   |   |   ├── parse_path.py
|   |   |   ├── pyparsing.py
|   |   |   └── svg2imagemap.py
|   |   ├── statistical_inference
|   |   |   ├── index.rst
|   |   |   ├── model_selection.rst
|   |   |   ├── putting_together.rst
|   |   |   ├── settings.rst
|   |   |   ├── supervised_learning.rst
|   |   |   └── unsupervised_learning.rst
|   |   └── text_analytics
|   |       ├── data
|   |       |   ├── languages
|   |       |   └── movie_reviews
|   |       ├── skeletons
|   |       |   ├── exercise_01_language_train_model.py
|   |       |   └── exercise_02_sentiment.py
|   |       ├── solutions
|   |       |   ├── exercise_01_language_train_model.py
|   |       |   ├── exercise_02_sentiment.py
|   |       |   └── generate_skeletons.py
|   |       └── working_with_text_data.rst
|   ├── unsupervised_learning.rst
|   ├── user_guide.rst
|   ├── visualizations.rst
|   ├── whats_new
|   |   ├── _contributors.rst
|   |   ├── older_versions.rst
|   |   ├── v0.13.rst
|   |   ├── v0.14.rst
|   |   ├── v0.15.rst
|   |   ├── v0.16.rst
|   |   ├── v0.17.rst
|   |   ├── v0.18.rst
|   |   ├── v0.19.rst
|   |   ├── v0.20.rst
|   |   ├── v0.21.rst
|   |   ├── v0.22.rst
|   |   ├── v0.23.rst
|   |   ├── v0.24.rst
|   |   ├── v1.0.rst
|   |   ├── v1.1.rst
|   |   ├── v1.2.rst
|   |   └── v1.3.rst
|   └── whats_new.rst
├── examples
|   ├── README.txt
|   ├── applications
|   |   ├── README.txt
|   |   ├── plot_cyclical_feature_engineering.py
|   |   ├── plot_digits_denoising.py
|   |   ├── plot_face_recognition.py
|   |   ├── plot_model_complexity_influence.py
|   |   ├── plot_out_of_core_classification.py
|   |   ├── plot_outlier_detection_wine.py
|   |   ├── plot_prediction_latency.py
|   |   ├── plot_species_distribution_modeling.py
|   |   ├── plot_stock_market.py
|   |   ├── plot_tomography_l1_reconstruction.py
|   |   ├── plot_topics_extraction_with_nmf_lda.py
|   |   ├── svm_gui.py
|   |   └── wikipedia_principal_eigenvector.py
|   ├── bicluster
|   |   ├── README.txt
|   |   ├── plot_bicluster_newsgroups.py
|   |   ├── plot_spectral_biclustering.py
|   |   └── plot_spectral_coclustering.py
|   ├── calibration
|   |   ├── README.txt
|   |   ├── plot_calibration.py
|   |   ├── plot_calibration_curve.py
|   |   ├── plot_calibration_multiclass.py
|   |   └── plot_compare_calibration.py
|   ├── classification
|   |   ├── README.txt
|   |   ├── plot_classification_probability.py
|   |   ├── plot_classifier_comparison.py
|   |   ├── plot_digits_classification.py
|   |   ├── plot_lda.py
|   |   └── plot_lda_qda.py
|   ├── cluster
|   |   ├── README.txt
|   |   ├── plot_adjusted_for_chance_measures.py
|   |   ├── plot_affinity_propagation.py
|   |   ├── plot_agglomerative_clustering.py
|   |   ├── plot_agglomerative_clustering_metrics.py
|   |   ├── plot_agglomerative_dendrogram.py
|   |   ├── plot_birch_vs_minibatchkmeans.py
|   |   ├── plot_bisect_kmeans.py
|   |   ├── plot_cluster_comparison.py
|   |   ├── plot_cluster_iris.py
|   |   ├── plot_coin_segmentation.py
|   |   ├── plot_coin_ward_segmentation.py
|   |   ├── plot_color_quantization.py
|   |   ├── plot_dbscan.py
|   |   ├── plot_dict_face_patches.py
|   |   ├── plot_digits_agglomeration.py
|   |   ├── plot_digits_linkage.py
|   |   ├── plot_face_compress.py
|   |   ├── plot_feature_agglomeration_vs_univariate_selection.py
|   |   ├── plot_inductive_clustering.py
|   |   ├── plot_kmeans_assumptions.py
|   |   ├── plot_kmeans_digits.py
|   |   ├── plot_kmeans_plusplus.py
|   |   ├── plot_kmeans_silhouette_analysis.py
|   |   ├── plot_kmeans_stability_low_dim_dense.py
|   |   ├── plot_linkage_comparison.py
|   |   ├── plot_mean_shift.py
|   |   ├── plot_mini_batch_kmeans.py
|   |   ├── plot_optics.py
|   |   ├── plot_segmentation_toy.py
|   |   └── plot_ward_structured_vs_unstructured.py
|   ├── compose
|   |   ├── README.txt
|   |   ├── plot_column_transformer.py
|   |   ├── plot_column_transformer_mixed_types.py
|   |   ├── plot_compare_reduction.py
|   |   ├── plot_digits_pipe.py
|   |   ├── plot_feature_union.py
|   |   └── plot_transformed_target.py
|   ├── covariance
|   |   ├── README.txt
|   |   ├── plot_covariance_estimation.py
|   |   ├── plot_lw_vs_oas.py
|   |   ├── plot_mahalanobis_distances.py
|   |   ├── plot_robust_vs_empirical_covariance.py
|   |   └── plot_sparse_cov.py
|   ├── cross_decomposition
|   |   ├── README.txt
|   |   ├── plot_compare_cross_decomposition.py
|   |   └── plot_pcr_vs_pls.py
|   ├── datasets
|   |   ├── README.txt
|   |   ├── plot_digits_last_image.py
|   |   ├── plot_iris_dataset.py
|   |   ├── plot_random_dataset.py
|   |   └── plot_random_multilabel_dataset.py
|   ├── decomposition
|   |   ├── README.txt
|   |   ├── plot_faces_decomposition.py
|   |   ├── plot_ica_blind_source_separation.py
|   |   ├── plot_ica_vs_pca.py
|   |   ├── plot_image_denoising.py
|   |   ├── plot_incremental_pca.py
|   |   ├── plot_kernel_pca.py
|   |   ├── plot_pca_3d.py
|   |   ├── plot_pca_iris.py
|   |   ├── plot_pca_vs_fa_model_selection.py
|   |   ├── plot_pca_vs_lda.py
|   |   ├── plot_sparse_coding.py
|   |   └── plot_varimax_fa.py
|   ├── ensemble
|   |   ├── README.txt
|   |   ├── plot_adaboost_hastie_10_2.py
|   |   ├── plot_adaboost_multiclass.py
|   |   ├── plot_adaboost_regression.py
|   |   ├── plot_adaboost_twoclass.py
|   |   ├── plot_bias_variance.py
|   |   ├── plot_ensemble_oob.py
|   |   ├── plot_feature_transformation.py
|   |   ├── plot_forest_importances.py
|   |   ├── plot_forest_importances_faces.py
|   |   ├── plot_forest_iris.py
|   |   ├── plot_gradient_boosting_categorical.py
|   |   ├── plot_gradient_boosting_early_stopping.py
|   |   ├── plot_gradient_boosting_oob.py
|   |   ├── plot_gradient_boosting_quantile.py
|   |   ├── plot_gradient_boosting_regression.py
|   |   ├── plot_gradient_boosting_regularization.py
|   |   ├── plot_isolation_forest.py
|   |   ├── plot_monotonic_constraints.py
|   |   ├── plot_random_forest_embedding.py
|   |   ├── plot_random_forest_regression_multioutput.py
|   |   ├── plot_stack_predictors.py
|   |   ├── plot_voting_decision_regions.py
|   |   ├── plot_voting_probas.py
|   |   └── plot_voting_regressor.py
|   ├── exercises
|   |   ├── README.txt
|   |   ├── plot_cv_diabetes.py
|   |   ├── plot_cv_digits.py
|   |   ├── plot_digits_classification_exercise.py
|   |   └── plot_iris_exercise.py
|   ├── feature_selection
|   |   ├── README.txt
|   |   ├── plot_f_test_vs_mi.py
|   |   ├── plot_feature_selection.py
|   |   ├── plot_feature_selection_pipeline.py
|   |   ├── plot_rfe_digits.py
|   |   ├── plot_rfe_with_cross_validation.py
|   |   └── plot_select_from_model_diabetes.py
|   ├── gaussian_process
|   |   ├── README.txt
|   |   ├── plot_compare_gpr_krr.py
|   |   ├── plot_gpc.py
|   |   ├── plot_gpc_iris.py
|   |   ├── plot_gpc_isoprobability.py
|   |   ├── plot_gpc_xor.py
|   |   ├── plot_gpr_co2.py
|   |   ├── plot_gpr_noisy.py
|   |   ├── plot_gpr_noisy_targets.py
|   |   ├── plot_gpr_on_structured_data.py
|   |   └── plot_gpr_prior_posterior.py
|   ├── impute
|   |   ├── README.txt
|   |   ├── plot_iterative_imputer_variants_comparison.py
|   |   └── plot_missing_values.py
|   ├── inspection
|   |   ├── README.txt
|   |   ├── plot_causal_interpretation.py
|   |   ├── plot_linear_model_coefficient_interpretation.py
|   |   ├── plot_partial_dependence.py
|   |   ├── plot_permutation_importance.py
|   |   └── plot_permutation_importance_multicollinear.py
|   ├── kernel_approximation
|   |   ├── README.txt
|   |   └── plot_scalable_poly_kernels.py
|   ├── linear_model
|   |   ├── README.txt
|   |   ├── plot_ard.py
|   |   ├── plot_bayesian_ridge_curvefit.py
|   |   ├── plot_elastic_net_precomputed_gram_matrix_with_weighted_samples.py
|   |   ├── plot_huber_vs_ridge.py
|   |   ├── plot_iris_logistic.py
|   |   ├── plot_lasso_and_elasticnet.py
|   |   ├── plot_lasso_coordinate_descent_path.py
|   |   ├── plot_lasso_dense_vs_sparse_data.py
|   |   ├── plot_lasso_lars.py
|   |   ├── plot_lasso_lars_ic.py
|   |   ├── plot_lasso_model_selection.py
|   |   ├── plot_logistic.py
|   |   ├── plot_logistic_l1_l2_sparsity.py
|   |   ├── plot_logistic_multinomial.py
|   |   ├── plot_logistic_path.py
|   |   ├── plot_multi_task_lasso_support.py
|   |   ├── plot_nnls.py
|   |   ├── plot_ols.py
|   |   ├── plot_ols_3d.py
|   |   ├── plot_ols_ridge_variance.py
|   |   ├── plot_omp.py
|   |   ├── plot_poisson_regression_non_normal_loss.py
|   |   ├── plot_polynomial_interpolation.py
|   |   ├── plot_quantile_regression.py
|   |   ├── plot_ransac.py
|   |   ├── plot_ridge_coeffs.py
|   |   ├── plot_ridge_path.py
|   |   ├── plot_robust_fit.py
|   |   ├── plot_sgd_comparison.py
|   |   ├── plot_sgd_early_stopping.py
|   |   ├── plot_sgd_iris.py
|   |   ├── plot_sgd_loss_functions.py
|   |   ├── plot_sgd_penalties.py
|   |   ├── plot_sgd_separating_hyperplane.py
|   |   ├── plot_sgd_weighted_samples.py
|   |   ├── plot_sgdocsvm_vs_ocsvm.py
|   |   ├── plot_sparse_logistic_regression_20newsgroups.py
|   |   ├── plot_sparse_logistic_regression_mnist.py
|   |   ├── plot_theilsen.py
|   |   └── plot_tweedie_regression_insurance_claims.py
|   ├── manifold
|   |   ├── README.txt
|   |   ├── plot_compare_methods.py
|   |   ├── plot_lle_digits.py
|   |   ├── plot_manifold_sphere.py
|   |   ├── plot_mds.py
|   |   ├── plot_swissroll.py
|   |   └── plot_t_sne_perplexity.py
|   ├── miscellaneous
|   |   ├── README.txt
|   |   ├── plot_anomaly_comparison.py
|   |   ├── plot_display_object_visualization.py
|   |   ├── plot_estimator_representation.py
|   |   ├── plot_isotonic_regression.py
|   |   ├── plot_johnson_lindenstrauss_bound.py
|   |   ├── plot_kernel_approximation.py
|   |   ├── plot_kernel_ridge_regression.py
|   |   ├── plot_multilabel.py
|   |   ├── plot_multioutput_face_completion.py
|   |   ├── plot_outlier_detection_bench.py
|   |   ├── plot_partial_dependence_visualization_api.py
|   |   ├── plot_pipeline_display.py
|   |   ├── plot_roc_curve_visualization_api.py
|   |   └── plot_set_output.py
|   ├── mixture
|   |   ├── README.txt
|   |   ├── plot_concentration_prior.py
|   |   ├── plot_gmm.py
|   |   ├── plot_gmm_covariances.py
|   |   ├── plot_gmm_init.py
|   |   ├── plot_gmm_pdf.py
|   |   ├── plot_gmm_selection.py
|   |   └── plot_gmm_sin.py
|   ├── model_selection
|   |   ├── README.txt
|   |   ├── plot_confusion_matrix.py
|   |   ├── plot_cv_indices.py
|   |   ├── plot_cv_predict.py
|   |   ├── plot_det.py
|   |   ├── plot_grid_search_digits.py
|   |   ├── plot_grid_search_refit_callable.py
|   |   ├── plot_grid_search_stats.py
|   |   ├── plot_grid_search_text_feature_extraction.py
|   |   ├── plot_learning_curve.py
|   |   ├── plot_likelihood_ratios.py
|   |   ├── plot_multi_metric_evaluation.py
|   |   ├── plot_nested_cross_validation_iris.py
|   |   ├── plot_permutation_tests_for_classification.py
|   |   ├── plot_precision_recall.py
|   |   ├── plot_randomized_search.py
|   |   ├── plot_roc.py
|   |   ├── plot_roc_crossval.py
|   |   ├── plot_successive_halving_heatmap.py
|   |   ├── plot_successive_halving_iterations.py
|   |   ├── plot_train_error_vs_test_error.py
|   |   ├── plot_underfitting_overfitting.py
|   |   └── plot_validation_curve.py
|   ├── multioutput
|   |   ├── README.txt
|   |   └── plot_classifier_chain_yeast.py
|   ├── neighbors
|   |   ├── README.txt
|   |   ├── approximate_nearest_neighbors.py
|   |   ├── plot_caching_nearest_neighbors.py
|   |   ├── plot_classification.py
|   |   ├── plot_digits_kde_sampling.py
|   |   ├── plot_kde_1d.py
|   |   ├── plot_lof_novelty_detection.py
|   |   ├── plot_lof_outlier_detection.py
|   |   ├── plot_nca_classification.py
|   |   ├── plot_nca_dim_reduction.py
|   |   ├── plot_nca_illustration.py
|   |   ├── plot_nearest_centroid.py
|   |   ├── plot_regression.py
|   |   └── plot_species_kde.py
|   ├── neural_networks
|   |   ├── README.txt
|   |   ├── plot_mlp_alpha.py
|   |   ├── plot_mlp_training_curves.py
|   |   ├── plot_mnist_filters.py
|   |   └── plot_rbm_logistic_classification.py
|   ├── preprocessing
|   |   ├── README.txt
|   |   ├── plot_all_scaling.py
|   |   ├── plot_discretization.py
|   |   ├── plot_discretization_classification.py
|   |   ├── plot_discretization_strategies.py
|   |   ├── plot_map_data_to_normal.py
|   |   ├── plot_scaling_importance.py
|   |   └── plot_target_encoder.py
|   ├── release_highlights
|   |   ├── README.txt
|   |   ├── plot_release_highlights_0_22_0.py
|   |   ├── plot_release_highlights_0_23_0.py
|   |   ├── plot_release_highlights_0_24_0.py
|   |   ├── plot_release_highlights_1_0_0.py
|   |   ├── plot_release_highlights_1_1_0.py
|   |   └── plot_release_highlights_1_2_0.py
|   ├── semi_supervised
|   |   ├── README.txt
|   |   ├── plot_label_propagation_digits.py
|   |   ├── plot_label_propagation_digits_active_learning.py
|   |   ├── plot_label_propagation_structure.py
|   |   ├── plot_self_training_varying_threshold.py
|   |   ├── plot_semi_supervised_newsgroups.py
|   |   └── plot_semi_supervised_versus_svm_iris.py
|   ├── svm
|   |   ├── README.txt
|   |   ├── plot_custom_kernel.py
|   |   ├── plot_iris_svc.py
|   |   ├── plot_linearsvc_support_vectors.py
|   |   ├── plot_oneclass.py
|   |   ├── plot_rbf_parameters.py
|   |   ├── plot_separating_hyperplane.py
|   |   ├── plot_separating_hyperplane_unbalanced.py
|   |   ├── plot_svm_anova.py
|   |   ├── plot_svm_kernels.py
|   |   ├── plot_svm_margin.py
|   |   ├── plot_svm_nonlinear.py
|   |   ├── plot_svm_regression.py
|   |   ├── plot_svm_scale_c.py
|   |   ├── plot_svm_tie_breaking.py
|   |   └── plot_weighted_samples.py
|   ├── text
|   |   ├── README.txt
|   |   ├── plot_document_classification_20newsgroups.py
|   |   ├── plot_document_clustering.py
|   |   └── plot_hashing_vs_dict_vectorizer.py
|   └── tree
|       ├── README.txt
|       ├── plot_cost_complexity_pruning.py
|       ├── plot_iris_dtc.py
|       ├── plot_tree_regression.py
|       ├── plot_tree_regression_multioutput.py
|       └── plot_unveil_tree_structure.py
├── maint_tools
|   ├── check_pxd_in_installation.py
|   ├── sort_whats_new.py
|   ├── update_tracking_issue.py
|   └── whats_missing.sh
├── setup.py
└── sklearn
    ├── __check_build
    |   └── __init__.py
    ├── __init__.py
    ├── _build_utils
    |   ├── __init__.py
    |   ├── openmp_helpers.py
    |   └── pre_build_helpers.py
    ├── _config.py
    ├── _distributor_init.py
    ├── _loss
    |   ├── __init__.py
    |   ├── link.py
    |   ├── loss.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_link.py
    |       └── test_loss.py
    ├── _min_dependencies.py
    ├── base.py
    ├── calibration.py
    ├── cluster
    |   ├── __init__.py
    |   ├── _affinity_propagation.py
    |   ├── _agglomerative.py
    |   ├── _bicluster.py
    |   ├── _birch.py
    |   ├── _bisect_k_means.py
    |   ├── _dbscan.py
    |   ├── _feature_agglomeration.py
    |   ├── _kmeans.py
    |   ├── _mean_shift.py
    |   ├── _optics.py
    |   ├── _spectral.py
    |   └── tests
    |       ├── __init__.py
    |       ├── common.py
    |       ├── test_affinity_propagation.py
    |       ├── test_bicluster.py
    |       ├── test_birch.py
    |       ├── test_bisect_k_means.py
    |       ├── test_dbscan.py
    |       ├── test_feature_agglomeration.py
    |       ├── test_hierarchical.py
    |       ├── test_k_means.py
    |       ├── test_mean_shift.py
    |       ├── test_optics.py
    |       └── test_spectral.py
    ├── compose
    |   ├── __init__.py
    |   ├── _column_transformer.py
    |   ├── _target.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_column_transformer.py
    |       └── test_target.py
    ├── conftest.py
    ├── covariance
    |   ├── __init__.py
    |   ├── _elliptic_envelope.py
    |   ├── _empirical_covariance.py
    |   ├── _graph_lasso.py
    |   ├── _robust_covariance.py
    |   ├── _shrunk_covariance.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_covariance.py
    |       ├── test_elliptic_envelope.py
    |       ├── test_graphical_lasso.py
    |       └── test_robust_covariance.py
    ├── cross_decomposition
    |   ├── __init__.py
    |   ├── _pls.py
    |   └── tests
    |       ├── __init__.py
    |       └── test_pls.py
    ├── datasets
    |   ├── __init__.py
    |   ├── _arff_parser.py
    |   ├── _base.py
    |   ├── _california_housing.py
    |   ├── _covtype.py
    |   ├── _kddcup99.py
    |   ├── _lfw.py
    |   ├── _olivetti_faces.py
    |   ├── _openml.py
    |   ├── _rcv1.py
    |   ├── _samples_generator.py
    |   ├── _species_distributions.py
    |   ├── _svmlight_format_io.py
    |   ├── _twenty_newsgroups.py
    |   ├── data
    |   |   └── __init__.py
    |   ├── descr
    |   |   ├── __init__.py
    |   |   ├── breast_cancer.rst
    |   |   ├── california_housing.rst
    |   |   ├── covtype.rst
    |   |   ├── diabetes.rst
    |   |   ├── digits.rst
    |   |   ├── iris.rst
    |   |   ├── kddcup99.rst
    |   |   ├── lfw.rst
    |   |   ├── linnerud.rst
    |   |   ├── olivetti_faces.rst
    |   |   ├── rcv1.rst
    |   |   ├── twenty_newsgroups.rst
    |   |   └── wine_data.rst
    |   ├── images
    |   |   ├── README.txt
    |   |   └── __init__.py
    |   └── tests
    |       ├── __init__.py
    |       ├── conftest.py
    |       ├── data
    |       |   ├── __init__.py
    |       |   ├── openml
    |       |   ├── svmlight_classification.txt
    |       |   ├── svmlight_invalid.txt
    |       |   ├── svmlight_invalid_order.txt
    |       |   └── svmlight_multilabel.txt
    |       ├── test_20news.py
    |       ├── test_arff_parser.py
    |       ├── test_base.py
    |       ├── test_california_housing.py
    |       ├── test_common.py
    |       ├── test_covtype.py
    |       ├── test_kddcup99.py
    |       ├── test_lfw.py
    |       ├── test_olivetti_faces.py
    |       ├── test_openml.py
    |       ├── test_rcv1.py
    |       ├── test_samples_generator.py
    |       └── test_svmlight_format.py
    ├── decomposition
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _dict_learning.py
    |   ├── _factor_analysis.py
    |   ├── _fastica.py
    |   ├── _incremental_pca.py
    |   ├── _kernel_pca.py
    |   ├── _lda.py
    |   ├── _nmf.py
    |   ├── _pca.py
    |   ├── _sparse_pca.py
    |   ├── _truncated_svd.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_dict_learning.py
    |       ├── test_factor_analysis.py
    |       ├── test_fastica.py
    |       ├── test_incremental_pca.py
    |       ├── test_kernel_pca.py
    |       ├── test_nmf.py
    |       ├── test_online_lda.py
    |       ├── test_pca.py
    |       ├── test_sparse_pca.py
    |       └── test_truncated_svd.py
    ├── discriminant_analysis.py
    ├── dummy.py
    ├── ensemble
    |   ├── __init__.py
    |   ├── _bagging.py
    |   ├── _base.py
    |   ├── _forest.py
    |   ├── _gb.py
    |   ├── _gb_losses.py
    |   ├── _hist_gradient_boosting
    |   |   ├── __init__.py
    |   |   ├── binning.py
    |   |   ├── gradient_boosting.py
    |   |   ├── grower.py
    |   |   ├── predictor.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_binning.py
    |   |       ├── test_bitset.py
    |   |       ├── test_compare_lightgbm.py
    |   |       ├── test_gradient_boosting.py
    |   |       ├── test_grower.py
    |   |       ├── test_histogram.py
    |   |       ├── test_monotonic_contraints.py
    |   |       ├── test_predictor.py
    |   |       ├── test_splitting.py
    |   |       └── test_warm_start.py
    |   ├── _iforest.py
    |   ├── _stacking.py
    |   ├── _voting.py
    |   ├── _weight_boosting.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bagging.py
    |       ├── test_base.py
    |       ├── test_common.py
    |       ├── test_forest.py
    |       ├── test_gradient_boosting.py
    |       ├── test_gradient_boosting_loss_functions.py
    |       ├── test_iforest.py
    |       ├── test_stacking.py
    |       ├── test_voting.py
    |       └── test_weight_boosting.py
    ├── exceptions.py
    ├── experimental
    |   ├── __init__.py
    |   ├── enable_halving_search_cv.py
    |   ├── enable_hist_gradient_boosting.py
    |   ├── enable_iterative_imputer.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_enable_hist_gradient_boosting.py
    |       ├── test_enable_iterative_imputer.py
    |       └── test_enable_successive_halving.py
    ├── externals
    |   ├── __init__.py
    |   ├── _arff.py
    |   ├── _lobpcg.py
    |   ├── _packaging
    |   |   ├── __init__.py
    |   |   ├── _structures.py
    |   |   └── version.py
    |   └── conftest.py
    ├── feature_extraction
    |   ├── __init__.py
    |   ├── _dict_vectorizer.py
    |   ├── _hash.py
    |   ├── _stop_words.py
    |   ├── image.py
    |   ├── tests
    |   |   ├── __init__.py
    |   |   ├── test_dict_vectorizer.py
    |   |   ├── test_feature_hasher.py
    |   |   ├── test_image.py
    |   |   └── test_text.py
    |   └── text.py
    ├── feature_selection
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _from_model.py
    |   ├── _mutual_info.py
    |   ├── _rfe.py
    |   ├── _sequential.py
    |   ├── _univariate_selection.py
    |   ├── _variance_threshold.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_chi2.py
    |       ├── test_feature_select.py
    |       ├── test_from_model.py
    |       ├── test_mutual_info.py
    |       ├── test_rfe.py
    |       ├── test_sequential.py
    |       └── test_variance_threshold.py
    ├── gaussian_process
    |   ├── __init__.py
    |   ├── _gpc.py
    |   ├── _gpr.py
    |   ├── kernels.py
    |   └── tests
    |       ├── __init__.py
    |       ├── _mini_sequence_kernel.py
    |       ├── test_gpc.py
    |       ├── test_gpr.py
    |       └── test_kernels.py
    ├── impute
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _iterative.py
    |   ├── _knn.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_common.py
    |       ├── test_impute.py
    |       └── test_knn.py
    ├── inspection
    |   ├── __init__.py
    |   ├── _partial_dependence.py
    |   ├── _pd_utils.py
    |   ├── _permutation_importance.py
    |   ├── _plot
    |   |   ├── __init__.py
    |   |   ├── decision_boundary.py
    |   |   ├── partial_dependence.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_boundary_decision_display.py
    |   |       └── test_plot_partial_dependence.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_partial_dependence.py
    |       ├── test_pd_utils.py
    |       └── test_permutation_importance.py
    ├── isotonic.py
    ├── kernel_approximation.py
    ├── kernel_ridge.py
    ├── linear_model
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _bayes.py
    |   ├── _coordinate_descent.py
    |   ├── _glm
    |   |   ├── __init__.py
    |   |   ├── _newton_solver.py
    |   |   ├── glm.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       └── test_glm.py
    |   ├── _huber.py
    |   ├── _least_angle.py
    |   ├── _linear_loss.py
    |   ├── _logistic.py
    |   ├── _omp.py
    |   ├── _passive_aggressive.py
    |   ├── _perceptron.py
    |   ├── _quantile.py
    |   ├── _ransac.py
    |   ├── _ridge.py
    |   ├── _sag.py
    |   ├── _stochastic_gradient.py
    |   ├── _theil_sen.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_bayes.py
    |       ├── test_common.py
    |       ├── test_coordinate_descent.py
    |       ├── test_huber.py
    |       ├── test_least_angle.py
    |       ├── test_linear_loss.py
    |       ├── test_logistic.py
    |       ├── test_omp.py
    |       ├── test_passive_aggressive.py
    |       ├── test_perceptron.py
    |       ├── test_quantile.py
    |       ├── test_ransac.py
    |       ├── test_ridge.py
    |       ├── test_sag.py
    |       ├── test_sgd.py
    |       ├── test_sparse_coordinate_descent.py
    |       └── test_theil_sen.py
    ├── manifold
    |   ├── __init__.py
    |   ├── _isomap.py
    |   ├── _locally_linear.py
    |   ├── _mds.py
    |   ├── _spectral_embedding.py
    |   ├── _t_sne.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_isomap.py
    |       ├── test_locally_linear.py
    |       ├── test_mds.py
    |       ├── test_spectral_embedding.py
    |       └── test_t_sne.py
    ├── metrics
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _classification.py
    |   ├── _pairwise_distances_reduction
    |   |   ├── __init__.py
    |   |   └── _dispatcher.py
    |   ├── _plot
    |   |   ├── __init__.py
    |   |   ├── confusion_matrix.py
    |   |   ├── det_curve.py
    |   |   ├── precision_recall_curve.py
    |   |   ├── regression.py
    |   |   ├── roc_curve.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_common_curve_display.py
    |   |       ├── test_confusion_matrix_display.py
    |   |       ├── test_det_curve_display.py
    |   |       ├── test_precision_recall_display.py
    |   |       ├── test_predict_error_display.py
    |   |       └── test_roc_curve_display.py
    |   ├── _ranking.py
    |   ├── _regression.py
    |   ├── _scorer.py
    |   ├── cluster
    |   |   ├── __init__.py
    |   |   ├── _bicluster.py
    |   |   ├── _supervised.py
    |   |   ├── _unsupervised.py
    |   |   └── tests
    |   |       ├── __init__.py
    |   |       ├── test_bicluster.py
    |   |       ├── test_common.py
    |   |       ├── test_supervised.py
    |   |       └── test_unsupervised.py
    |   ├── pairwise.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_classification.py
    |       ├── test_common.py
    |       ├── test_dist_metrics.py
    |       ├── test_pairwise.py
    |       ├── test_pairwise_distances_reduction.py
    |       ├── test_ranking.py
    |       ├── test_regression.py
    |       └── test_score_objects.py
    ├── mixture
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _bayesian_mixture.py
    |   ├── _gaussian_mixture.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bayesian_mixture.py
    |       ├── test_gaussian_mixture.py
    |       └── test_mixture.py
    ├── model_selection
    |   ├── __init__.py
    |   ├── _plot.py
    |   ├── _search.py
    |   ├── _search_successive_halving.py
    |   ├── _split.py
    |   ├── _validation.py
    |   └── tests
    |       ├── __init__.py
    |       ├── common.py
    |       ├── test_plot.py
    |       ├── test_search.py
    |       ├── test_split.py
    |       ├── test_successive_halving.py
    |       └── test_validation.py
    ├── multiclass.py
    ├── multioutput.py
    ├── naive_bayes.py
    ├── neighbors
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _classification.py
    |   ├── _distance_metric.py
    |   ├── _graph.py
    |   ├── _kde.py
    |   ├── _lof.py
    |   ├── _nca.py
    |   ├── _nearest_centroid.py
    |   ├── _regression.py
    |   ├── _unsupervised.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_ball_tree.py
    |       ├── test_graph.py
    |       ├── test_kd_tree.py
    |       ├── test_kde.py
    |       ├── test_lof.py
    |       ├── test_nca.py
    |       ├── test_nearest_centroid.py
    |       ├── test_neighbors.py
    |       ├── test_neighbors_pipeline.py
    |       ├── test_neighbors_tree.py
    |       └── test_quad_tree.py
    ├── neural_network
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _multilayer_perceptron.py
    |   ├── _rbm.py
    |   ├── _stochastic_optimizers.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_base.py
    |       ├── test_mlp.py
    |       ├── test_rbm.py
    |       └── test_stochastic_optimizers.py
    ├── pipeline.py
    ├── preprocessing
    |   ├── __init__.py
    |   ├── _data.py
    |   ├── _discretization.py
    |   ├── _encoders.py
    |   ├── _function_transformer.py
    |   ├── _label.py
    |   ├── _polynomial.py
    |   ├── _target_encoder.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_common.py
    |       ├── test_data.py
    |       ├── test_discretization.py
    |       ├── test_encoders.py
    |       ├── test_function_transformer.py
    |       ├── test_label.py
    |       ├── test_polynomial.py
    |       └── test_target_encoder.py
    ├── random_projection.py
    ├── semi_supervised
    |   ├── __init__.py
    |   ├── _label_propagation.py
    |   ├── _self_training.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_label_propagation.py
    |       └── test_self_training.py
    ├── svm
    |   ├── __init__.py
    |   ├── _base.py
    |   ├── _bounds.py
    |   ├── _classes.py
    |   ├── src
    |   |   ├── liblinear
    |   |   |   ├── liblinear_helper.c
    |   |   |   ├── linear.cpp
    |   |   |   └── tron.cpp
    |   |   ├── libsvm
    |   |   |   ├── libsvm_helper.c
    |   |   |   ├── libsvm_sparse_helper.c
    |   |   |   ├── libsvm_template.cpp
    |   |   |   └── svm.cpp
    |   |   └── newrand
    |   └── tests
    |       ├── __init__.py
    |       ├── test_bounds.py
    |       ├── test_sparse.py
    |       └── test_svm.py
    ├── tests
    |   ├── __init__.py
    |   ├── random_seed.py
    |   ├── test_base.py
    |   ├── test_build.py
    |   ├── test_calibration.py
    |   ├── test_check_build.py
    |   ├── test_common.py
    |   ├── test_config.py
    |   ├── test_discriminant_analysis.py
    |   ├── test_docstring_parameters.py
    |   ├── test_docstrings.py
    |   ├── test_dummy.py
    |   ├── test_init.py
    |   ├── test_isotonic.py
    |   ├── test_kernel_approximation.py
    |   ├── test_kernel_ridge.py
    |   ├── test_metaestimators.py
    |   ├── test_min_dependencies_readme.py
    |   ├── test_multiclass.py
    |   ├── test_multioutput.py
    |   ├── test_naive_bayes.py
    |   ├── test_pipeline.py
    |   ├── test_public_functions.py
    |   └── test_random_projection.py
    ├── tree
    |   ├── __init__.py
    |   ├── _classes.py
    |   ├── _export.py
    |   ├── _reingold_tilford.py
    |   └── tests
    |       ├── __init__.py
    |       ├── test_export.py
    |       ├── test_reingold_tilford.py
    |       └── test_tree.py
    └── utils
        ├── __init__.py
        ├── _arpack.py
        ├── _array_api.py
        ├── _available_if.py
        ├── _bunch.py
        ├── _encode.py
        ├── _estimator_html_repr.py
        ├── _joblib.py
        ├── _mask.py
        ├── _mocking.py
        ├── _param_validation.py
        ├── _plotting.py
        ├── _pprint.py
        ├── _response.py
        ├── _set_output.py
        ├── _show_versions.py
        ├── _tags.py
        ├── _testing.py
        ├── class_weight.py
        ├── deprecation.py
        ├── discovery.py
        ├── estimator_checks.py
        ├── extmath.py
        ├── fixes.py
        ├── graph.py
        ├── metaestimators.py
        ├── multiclass.py
        ├── optimize.py
        ├── parallel.py
        ├── random.py
        ├── sparsefuncs.py
        ├── src
        |   └── MurmurHash3.cpp
        ├── stats.py
        ├── tests
        |   ├── __init__.py
        |   ├── conftest.py
        |   ├── test_arpack.py
        |   ├── test_array_api.py
        |   ├── test_arrayfuncs.py
        |   ├── test_bunch.py
        |   ├── test_class_weight.py
        |   ├── test_cython_blas.py
        |   ├── test_cython_templating.py
        |   ├── test_deprecation.py
        |   ├── test_encode.py
        |   ├── test_estimator_checks.py
        |   ├── test_estimator_html_repr.py
        |   ├── test_extmath.py
        |   ├── test_fast_dict.py
        |   ├── test_fixes.py
        |   ├── test_graph.py
        |   ├── test_metaestimators.py
        |   ├── test_mocking.py
        |   ├── test_multiclass.py
        |   ├── test_murmurhash.py
        |   ├── test_optimize.py
        |   ├── test_parallel.py
        |   ├── test_param_validation.py
        |   ├── test_pprint.py
        |   ├── test_random.py
        |   ├── test_response.py
        |   ├── test_seq_dataset.py
        |   ├── test_set_output.py
        |   ├── test_shortest_path.py
        |   ├── test_show_versions.py
        |   ├── test_sparsefuncs.py
        |   ├── test_stats.py
        |   ├── test_tags.py
        |   ├── test_testing.py
        |   ├── test_typedefs.py
        |   ├── test_utils.py
        |   ├── test_validation.py
        |   └── test_weight_vector.py
        └── validation.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
Thresholds can exceed 1 in `roc_curve` while providing probability estimate

Issue description: 
While working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:

```python
def test_roc_curve_with_probablity_estimates():
    rng = np.random.RandomState(42)
    y_true = rng.randint(0, 2, size=10)
    y_score = rng.rand(10)
    _, _, thresholds = roc_curve(y_true, y_score)
    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()
```

The reason is due to the following:

https://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086

Basically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.

I am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: sklearn/metrics/tests/test_ranking.py
Line number range: 1 - 40
Content:
1. import re
2. import pytest
3. import numpy as np
4. import warnings
5. from scipy.sparse import csr_matrix
6. from scipy import stats
7. 
8. from sklearn import datasets
9. from sklearn import svm
10. 
11. from sklearn.utils.extmath import softmax
12. from sklearn.datasets import make_multilabel_classification
13. from sklearn.random_projection import _sparse_random_matrix
14. from sklearn.utils.validation import check_array, check_consistent_length
15. from sklearn.utils.validation import check_random_state
16. 
17. from sklearn.utils._testing import assert_allclose
18. from sklearn.utils._testing import assert_almost_equal
19. from sklearn.utils._testing import assert_array_equal
20. from sklearn.utils._testing import assert_array_almost_equal
21. 
22. from sklearn.metrics import accuracy_score
23. from sklearn.metrics import auc
24. from sklearn.metrics import average_precision_score
25. from sklearn.metrics import coverage_error
26. from sklearn.metrics import det_curve
27. from sklearn.metrics import label_ranking_average_precision_score
28. from sklearn.metrics import precision_recall_curve
29. from sklearn.metrics import label_ranking_loss
30. from sklearn.metrics import roc_auc_score
31. from sklearn.metrics import roc_curve
32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores
33. from sklearn.metrics import ndcg_score, dcg_score
34. from sklearn.metrics import top_k_accuracy_score
35. 
36. from sklearn.exceptions import UndefinedMetricWarning
37. from sklearn.model_selection import train_test_split
38. from sklearn.linear_model import LogisticRegression
39. from sklearn.preprocessing import label_binarize
40. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 416 - 428
Content:
416. def test_roc_curve_drop_intermediate():
417.     # Test that drop_intermediate drops the correct thresholds
418.     y_true = [0, 0, 0, 0, 1, 1]
419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]
420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])
422. 
423.     # Test dropping thresholds with repeating scores
424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]
425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]
426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)
427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])
428. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 52 - 94
Content:
52. def make_prediction(dataset=None, binary=False):
53.     """Make some classification predictions on a toy dataset using a SVC
54. 
55.     If binary is True restrict to a binary classification problem instead of a
56.     multiclass classification problem
57.     """
58. 
59.     if dataset is None:
60.         # import some data to play with
61.         dataset = datasets.load_iris()
62. 
63.     X = dataset.data
64.     y = dataset.target
65. 
66.     if binary:
67.         # restrict to a binary classification task
68.         X, y = X[y < 2], y[y < 2]
69. 
70.     n_samples, n_features = X.shape
71.     p = np.arange(n_samples)
72. 
73.     rng = check_random_state(37)
74.     rng.shuffle(p)
75.     X, y = X[p], y[p]
76.     half = int(n_samples / 2)
77. 
78.     # add noisy features to make the problem harder and avoid perfect results
79.     rng = np.random.RandomState(0)
80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]
81. 
82.     # run classifier, get class probabilities and label predictions
83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)
84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])
85. 
86.     if binary:
87.         # only interested in probabilities of the positive case
88.         # XXX: do we really want a special API for the binary case?
89.         y_score = y_score[:, 1]
90. 
91.     y_pred = clf.predict(X[half:])
92.     y_true = y[half:]
93.     return y_true, y_pred, y_score
94. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 192 - 204
Content:
192. @pytest.mark.parametrize("drop", [True, False])
193. def test_roc_curve(drop):
194.     # Test Area under Receiver Operating Characteristic (ROC) curve
195.     y_true, _, y_score = make_prediction(binary=True)
196.     expected_auc = _auc(y_true, y_score)
197. 
198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)
199.     roc_auc = auc(fpr, tpr)
200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)
201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))
202.     assert fpr.shape == tpr.shape
203.     assert fpr.shape == thresholds.shape
204. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 285 - 310
Content:
285. def test_roc_curve_one_label():
286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]
288.     # assert there are warnings
289.     expected_message = (
290.         "No negative samples in y_true, false positive value should be meaningless"
291.     )
292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)
294. 
295.     # all true labels, all fpr should be nan
296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))
297.     assert fpr.shape == tpr.shape
298.     assert fpr.shape == thresholds.shape
299. 
300.     # assert there are warnings
301.     expected_message = (
302.         "No positive samples in y_true, true positive value should be meaningless"
303.     )
304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)
306.     # all negative labels, all tpr should be nan
307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))
308.     assert fpr.shape == tpr.shape
309.     assert fpr.shape == thresholds.shape
310. 


File: sklearn/metrics/tests/test_ranking.py
Line number range: 219 - 235
Content:
219. def test_roc_returns_consistency():
220.     # Test whether the returned threshold matches up with tpr
221.     # make small toy dataset
222.     y_true, _, y_score = make_prediction(binary=True)
223.     fpr, tpr, thresholds = roc_curve(y_true, y_score)
224. 
225.     # use the given thresholds to determine the tpr
226.     tpr_correct = []
227.     for t in thresholds:
228.         tp = np.sum((y_score >= t) & y_true)
229.         p = np.sum(y_true)
230.         tpr_correct.append(1.0 * tp / p)
231. 
232.     # compare tpr and tpr_correct to see if the thresholds' order was correct
233.     assert_array_almost_equal(tpr, tpr_correct, decimal=2)
234.     assert fpr.shape == tpr.shape
235.     assert fpr.shape == thresholds.shape


File: sklearn/metrics/tests/test_ranking.py
Line number range: 430 - 439
Content:
430. def test_roc_curve_fpr_tpr_increasing():
431.     # Ensure that fpr and tpr returned by roc_curve are increasing.
432.     # Construct an edge case with float y_score and sample_weight
433.     # when some adjacent values of fpr and tpr are actually the same.
434.     y_true = [0, 0, 1, 1, 1]
435.     y_score = [0.1, 0.7, 0.3, 0.4, 0.5]
436.     sample_weight = np.repeat(0.2, 5)
437.     fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=sample_weight)
438.     assert (np.diff(fpr) < 0).sum() == 0
439.     assert (np.diff(tpr) < 0).sum() == 0


File: sklearn/metrics/tests/test_ranking.py
Line number range: 312 - 381
Content:
312. def test_roc_curve_toydata():
313.     # Binary classification
314.     y_true = [0, 1]
315.     y_score = [0, 1]
316.     tpr, fpr, _ = roc_curve(y_true, y_score)
317.     roc_auc = roc_auc_score(y_true, y_score)
318.     assert_array_almost_equal(tpr, [0, 0, 1])
319.     assert_array_almost_equal(fpr, [0, 1, 1])
320.     assert_almost_equal(roc_auc, 1.0)
321. 
322.     y_true = [0, 1]
323.     y_score = [1, 0]
324.     tpr, fpr, _ = roc_curve(y_true, y_score)
325.     roc_auc = roc_auc_score(y_true, y_score)
326.     assert_array_almost_equal(tpr, [0, 1, 1])
327.     assert_array_almost_equal(fpr, [0, 0, 1])
328.     assert_almost_equal(roc_auc, 0.0)
329. 
330.     y_true = [1, 0]
331.     y_score = [1, 1]
332.     tpr, fpr, _ = roc_curve(y_true, y_score)
333.     roc_auc = roc_auc_score(y_true, y_score)
334.     assert_array_almost_equal(tpr, [0, 1])
335.     assert_array_almost_equal(fpr, [0, 1])
336.     assert_almost_equal(roc_auc, 0.5)
337. 
338.     y_true = [1, 0]
339.     y_score = [1, 0]
340.     tpr, fpr, _ = roc_curve(y_true, y_score)
341.     roc_auc = roc_auc_score(y_true, y_score)
342.     assert_array_almost_equal(tpr, [0, 0, 1])
343.     assert_array_almost_equal(fpr, [0, 1, 1])
344.     assert_almost_equal(roc_auc, 1.0)
345. 
346.     y_true = [1, 0]
347.     y_score = [0.5, 0.5]
348.     tpr, fpr, _ = roc_curve(y_true, y_score)
349.     roc_auc = roc_auc_score(y_true, y_score)
350.     assert_array_almost_equal(tpr, [0, 1])
351.     assert_array_almost_equal(fpr, [0, 1])
352.     assert_almost_equal(roc_auc, 0.5)
353. 
354.     y_true = [0, 0]
355.     y_score = [0.25, 0.75]
356.     # assert UndefinedMetricWarning because of no positive sample in y_true
357.     expected_message = (
358.         "No positive samples in y_true, true positive value should be meaningless"
359.     )
360.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
361.         tpr, fpr, _ = roc_curve(y_true, y_score)
362. 
363.     with pytest.raises(ValueError):
364.         roc_auc_score(y_true, y_score)
365.     assert_array_almost_equal(tpr, [0.0, 0.5, 1.0])
366.     assert_array_almost_equal(fpr, [np.nan, np.nan, np.nan])
367. 
368.     y_true = [1, 1]
369.     y_score = [0.25, 0.75]
370.     # assert UndefinedMetricWarning because of no negative sample in y_true
371.     expected_message = (
372.         "No negative samples in y_true, false positive value should be meaningless"
373.     )
374.     with pytest.warns(UndefinedMetricWarning, match=expected_message):
375.         tpr, fpr, _ = roc_curve(y_true, y_score)
376. 
377.     with pytest.raises(ValueError):
378.         roc_auc_score(y_true, y_score)
379.     assert_array_almost_equal(tpr, [np.nan, np.nan, np.nan])
380.     assert_array_almost_equal(fpr, [0.0, 0.5, 1.0])
381. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-04 05:04:54,794 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="1. The user's query is to find 5 relevant and complete test cases for a bug in `roc_curve` where thresholds can exceed 1.\n2. The provided context contains snippets from `sklearn/metrics/tests/test_ranking.py`, which is the correct location for `roc_curve` tests.\n3. The context includes necessary imports (lines 1-40) and a key helper function `make_prediction` (lines 52-94).\n4. I have analyzed the provided test cases and found several relevant ones: `test_roc_curve_drop_intermediate` which explicitly asserts the problematic threshold value, `test_roc_returns_consistency` which validates thresholds, `test_roc_curve_one_label` and `test_roc_curve_toydata` which cover edge cases and basic functionality, and `test_roc_curve_fpr_tpr_increasing` which checks output properties.\n5. These 5 tests are self-contained within the provided context and directly address the user's need for examples of `roc_curve` tests.\n6. A potentially relevant test `test_roc_curve` is missing its helper function `_auc`. However, since 5 other complete and relevant tests are available, there is no need to request additional context to fulfill the core request.\n7. Therefore, the provided context is sufficient." refined_query=''
2025-10-04 05:04:54,795 - thread-139911184823872.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Context retrieved: [Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='1. import re\n2. import pytest\n3. import numpy as np\n4. import warnings\n5. from scipy.sparse import csr_matrix\n6. from scipy import stats\n7. \n8. from sklearn import datasets\n9. from sklearn import svm\n10. \n11. from sklearn.utils.extmath import softmax\n12. from sklearn.datasets import make_multilabel_classification\n13. from sklearn.random_projection import _sparse_random_matrix\n14. from sklearn.utils.validation import check_array, check_consistent_length\n15. from sklearn.utils.validation import check_random_state\n16. \n17. from sklearn.utils._testing import assert_allclose\n18. from sklearn.utils._testing import assert_almost_equal\n19. from sklearn.utils._testing import assert_array_equal\n20. from sklearn.utils._testing import assert_array_almost_equal\n21. \n22. from sklearn.metrics import accuracy_score\n23. from sklearn.metrics import auc\n24. from sklearn.metrics import average_precision_score\n25. from sklearn.metrics import coverage_error\n26. from sklearn.metrics import det_curve\n27. from sklearn.metrics import label_ranking_average_precision_score\n28. from sklearn.metrics import precision_recall_curve\n29. from sklearn.metrics import label_ranking_loss\n30. from sklearn.metrics import roc_auc_score\n31. from sklearn.metrics import roc_curve\n32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\n33. from sklearn.metrics import ndcg_score, dcg_score\n34. from sklearn.metrics import top_k_accuracy_score\n35. \n36. from sklearn.exceptions import UndefinedMetricWarning\n37. from sklearn.model_selection import train_test_split\n38. from sklearn.linear_model import LogisticRegression\n39. from sklearn.preprocessing import label_binarize\n40. ', start_line_number=1, end_line_number=40), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='416. def test_roc_curve_drop_intermediate():\n417.     # Test that drop_intermediate drops the correct thresholds\n418.     y_true = [0, 0, 0, 0, 1, 1]\n419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]\n420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])\n422. \n423.     # Test dropping thresholds with repeating scores\n424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]\n425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]\n426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])\n428. ', start_line_number=416, end_line_number=428), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='52. def make_prediction(dataset=None, binary=False):\n53.     """Make some classification predictions on a toy dataset using a SVC\n54. \n55.     If binary is True restrict to a binary classification problem instead of a\n56.     multiclass classification problem\n57.     """\n58. \n59.     if dataset is None:\n60.         # import some data to play with\n61.         dataset = datasets.load_iris()\n62. \n63.     X = dataset.data\n64.     y = dataset.target\n65. \n66.     if binary:\n67.         # restrict to a binary classification task\n68.         X, y = X[y < 2], y[y < 2]\n69. \n70.     n_samples, n_features = X.shape\n71.     p = np.arange(n_samples)\n72. \n73.     rng = check_random_state(37)\n74.     rng.shuffle(p)\n75.     X, y = X[p], y[p]\n76.     half = int(n_samples / 2)\n77. \n78.     # add noisy features to make the problem harder and avoid perfect results\n79.     rng = np.random.RandomState(0)\n80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]\n81. \n82.     # run classifier, get class probabilities and label predictions\n83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)\n84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])\n85. \n86.     if binary:\n87.         # only interested in probabilities of the positive case\n88.         # XXX: do we really want a special API for the binary case?\n89.         y_score = y_score[:, 1]\n90. \n91.     y_pred = clf.predict(X[half:])\n92.     y_true = y[half:]\n93.     return y_true, y_pred, y_score\n94. ', start_line_number=52, end_line_number=94), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='192. @pytest.mark.parametrize("drop", [True, False])\n193. def test_roc_curve(drop):\n194.     # Test Area under Receiver Operating Characteristic (ROC) curve\n195.     y_true, _, y_score = make_prediction(binary=True)\n196.     expected_auc = _auc(y_true, y_score)\n197. \n198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)\n199.     roc_auc = auc(fpr, tpr)\n200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)\n201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))\n202.     assert fpr.shape == tpr.shape\n203.     assert fpr.shape == thresholds.shape\n204. ', start_line_number=192, end_line_number=204), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='285. def test_roc_curve_one_label():\n286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n288.     # assert there are warnings\n289.     expected_message = (\n290.         "No negative samples in y_true, false positive value should be meaningless"\n291.     )\n292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)\n294. \n295.     # all true labels, all fpr should be nan\n296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))\n297.     assert fpr.shape == tpr.shape\n298.     assert fpr.shape == thresholds.shape\n299. \n300.     # assert there are warnings\n301.     expected_message = (\n302.         "No positive samples in y_true, true positive value should be meaningless"\n303.     )\n304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)\n306.     # all negative labels, all tpr should be nan\n307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))\n308.     assert fpr.shape == tpr.shape\n309.     assert fpr.shape == thresholds.shape\n310. ', start_line_number=285, end_line_number=310), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content="219. def test_roc_returns_consistency():\n220.     # Test whether the returned threshold matches up with tpr\n221.     # make small toy dataset\n222.     y_true, _, y_score = make_prediction(binary=True)\n223.     fpr, tpr, thresholds = roc_curve(y_true, y_score)\n224. \n225.     # use the given thresholds to determine the tpr\n226.     tpr_correct = []\n227.     for t in thresholds:\n228.         tp = np.sum((y_score >= t) & y_true)\n229.         p = np.sum(y_true)\n230.         tpr_correct.append(1.0 * tp / p)\n231. \n232.     # compare tpr and tpr_correct to see if the thresholds' order was correct\n233.     assert_array_almost_equal(tpr, tpr_correct, decimal=2)\n234.     assert fpr.shape == tpr.shape\n235.     assert fpr.shape == thresholds.shape", start_line_number=219, end_line_number=235), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='430. def test_roc_curve_fpr_tpr_increasing():\n431.     # Ensure that fpr and tpr returned by roc_curve are increasing.\n432.     # Construct an edge case with float y_score and sample_weight\n433.     # when some adjacent values of fpr and tpr are actually the same.\n434.     y_true = [0, 0, 1, 1, 1]\n435.     y_score = [0.1, 0.7, 0.3, 0.4, 0.5]\n436.     sample_weight = np.repeat(0.2, 5)\n437.     fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=sample_weight)\n438.     assert (np.diff(fpr) < 0).sum() == 0\n439.     assert (np.diff(tpr) < 0).sum() == 0', start_line_number=430, end_line_number=439), Context(relative_path='sklearn/metrics/tests/test_ranking.py', content='312. def test_roc_curve_toydata():\n313.     # Binary classification\n314.     y_true = [0, 1]\n315.     y_score = [0, 1]\n316.     tpr, fpr, _ = roc_curve(y_true, y_score)\n317.     roc_auc = roc_auc_score(y_true, y_score)\n318.     assert_array_almost_equal(tpr, [0, 0, 1])\n319.     assert_array_almost_equal(fpr, [0, 1, 1])\n320.     assert_almost_equal(roc_auc, 1.0)\n321. \n322.     y_true = [0, 1]\n323.     y_score = [1, 0]\n324.     tpr, fpr, _ = roc_curve(y_true, y_score)\n325.     roc_auc = roc_auc_score(y_true, y_score)\n326.     assert_array_almost_equal(tpr, [0, 1, 1])\n327.     assert_array_almost_equal(fpr, [0, 0, 1])\n328.     assert_almost_equal(roc_auc, 0.0)\n329. \n330.     y_true = [1, 0]\n331.     y_score = [1, 1]\n332.     tpr, fpr, _ = roc_curve(y_true, y_score)\n333.     roc_auc = roc_auc_score(y_true, y_score)\n334.     assert_array_almost_equal(tpr, [0, 1])\n335.     assert_array_almost_equal(fpr, [0, 1])\n336.     assert_almost_equal(roc_auc, 0.5)\n337. \n338.     y_true = [1, 0]\n339.     y_score = [1, 0]\n340.     tpr, fpr, _ = roc_curve(y_true, y_score)\n341.     roc_auc = roc_auc_score(y_true, y_score)\n342.     assert_array_almost_equal(tpr, [0, 0, 1])\n343.     assert_array_almost_equal(fpr, [0, 1, 1])\n344.     assert_almost_equal(roc_auc, 1.0)\n345. \n346.     y_true = [1, 0]\n347.     y_score = [0.5, 0.5]\n348.     tpr, fpr, _ = roc_curve(y_true, y_score)\n349.     roc_auc = roc_auc_score(y_true, y_score)\n350.     assert_array_almost_equal(tpr, [0, 1])\n351.     assert_array_almost_equal(fpr, [0, 1])\n352.     assert_almost_equal(roc_auc, 0.5)\n353. \n354.     y_true = [0, 0]\n355.     y_score = [0.25, 0.75]\n356.     # assert UndefinedMetricWarning because of no positive sample in y_true\n357.     expected_message = (\n358.         "No positive samples in y_true, true positive value should be meaningless"\n359.     )\n360.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n361.         tpr, fpr, _ = roc_curve(y_true, y_score)\n362. \n363.     with pytest.raises(ValueError):\n364.         roc_auc_score(y_true, y_score)\n365.     assert_array_almost_equal(tpr, [0.0, 0.5, 1.0])\n366.     assert_array_almost_equal(fpr, [np.nan, np.nan, np.nan])\n367. \n368.     y_true = [1, 1]\n369.     y_score = [0.25, 0.75]\n370.     # assert UndefinedMetricWarning because of no negative sample in y_true\n371.     expected_message = (\n372.         "No negative samples in y_true, false positive value should be meaningless"\n373.     )\n374.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n375.         tpr, fpr, _ = roc_curve(y_true, y_score)\n376. \n377.     with pytest.raises(ValueError):\n378.         roc_auc_score(y_true, y_score)\n379.     assert_array_almost_equal(tpr, [np.nan, np.nan, np.nan])\n380.     assert_array_almost_equal(fpr, [0.0, 0.5, 1.0])\n381. ', start_line_number=312, end_line_number=381)]
2025-10-04 05:04:54,795 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nThresholds can exceed 1 in `roc_curve` while providing probability estimate\n\nIssue description: \nWhile working on https://github.com/scikit-learn/scikit-learn/pull/26120, I found out that something was odd with `roc_curve` that returns a threshold greater than 1. A non-regression test (that could be part of `sklearn/metrics/tests/test_ranking.py`) could be as follow:\n\n```python\ndef test_roc_curve_with_probablity_estimates():\n    rng = np.random.RandomState(42)\n    y_true = rng.randint(0, 2, size=10)\n    y_score = rng.rand(10)\n    _, _, thresholds = roc_curve(y_true, y_score)\n    assert np.logical_or(thresholds <= 1, thresholds >= 0).all()\n```\n\nThe reason is due to the following:\n\nhttps://github.com/scikit-learn/scikit-learn/blob/e886ce4e1444c61b865e7839c9cff5464ee20ace/sklearn/metrics/_ranking.py#L1086\n\nBasically, this is to add a point for `fpr=0` and `tpr=0`. However, the `+ 1` rule does not make sense in the case `y_score` is a probability estimate.\n\nI am not sure what would be the best fix here. A potential workaround would be to check `thresholds.max() <= 1` in which case we should clip `thresholds` to not be above 1.\n\nIssue comments:\n\n\nBug reproducing context:\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 1 - 40\nContent:\n1. import re\n2. import pytest\n3. import numpy as np\n4. import warnings\n5. from scipy.sparse import csr_matrix\n6. from scipy import stats\n7. \n8. from sklearn import datasets\n9. from sklearn import svm\n10. \n11. from sklearn.utils.extmath import softmax\n12. from sklearn.datasets import make_multilabel_classification\n13. from sklearn.random_projection import _sparse_random_matrix\n14. from sklearn.utils.validation import check_array, check_consistent_length\n15. from sklearn.utils.validation import check_random_state\n16. \n17. from sklearn.utils._testing import assert_allclose\n18. from sklearn.utils._testing import assert_almost_equal\n19. from sklearn.utils._testing import assert_array_equal\n20. from sklearn.utils._testing import assert_array_almost_equal\n21. \n22. from sklearn.metrics import accuracy_score\n23. from sklearn.metrics import auc\n24. from sklearn.metrics import average_precision_score\n25. from sklearn.metrics import coverage_error\n26. from sklearn.metrics import det_curve\n27. from sklearn.metrics import label_ranking_average_precision_score\n28. from sklearn.metrics import precision_recall_curve\n29. from sklearn.metrics import label_ranking_loss\n30. from sklearn.metrics import roc_auc_score\n31. from sklearn.metrics import roc_curve\n32. from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\n33. from sklearn.metrics import ndcg_score, dcg_score\n34. from sklearn.metrics import top_k_accuracy_score\n35. \n36. from sklearn.exceptions import UndefinedMetricWarning\n37. from sklearn.model_selection import train_test_split\n38. from sklearn.linear_model import LogisticRegression\n39. from sklearn.preprocessing import label_binarize\n40. \n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 416 - 428\nContent:\n416. def test_roc_curve_drop_intermediate():\n417.     # Test that drop_intermediate drops the correct thresholds\n418.     y_true = [0, 0, 0, 0, 1, 1]\n419.     y_score = [0.0, 0.2, 0.5, 0.6, 0.7, 1.0]\n420.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n421.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.7, 0.0])\n422. \n423.     # Test dropping thresholds with repeating scores\n424.     y_true = [0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1]\n425.     y_score = [0.0, 0.1, 0.6, 0.6, 0.7, 0.8, 0.9, 0.6, 0.7, 0.8, 0.9, 0.9, 1.0]\n426.     tpr, fpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=True)\n427.     assert_array_almost_equal(thresholds, [2.0, 1.0, 0.9, 0.7, 0.6, 0.0])\n428. \n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 52 - 94\nContent:\n52. def make_prediction(dataset=None, binary=False):\n53.     """Make some classification predictions on a toy dataset using a SVC\n54. \n55.     If binary is True restrict to a binary classification problem instead of a\n56.     multiclass classification problem\n57.     """\n58. \n59.     if dataset is None:\n60.         # import some data to play with\n61.         dataset = datasets.load_iris()\n62. \n63.     X = dataset.data\n64.     y = dataset.target\n65. \n66.     if binary:\n67.         # restrict to a binary classification task\n68.         X, y = X[y < 2], y[y < 2]\n69. \n70.     n_samples, n_features = X.shape\n71.     p = np.arange(n_samples)\n72. \n73.     rng = check_random_state(37)\n74.     rng.shuffle(p)\n75.     X, y = X[p], y[p]\n76.     half = int(n_samples / 2)\n77. \n78.     # add noisy features to make the problem harder and avoid perfect results\n79.     rng = np.random.RandomState(0)\n80.     X = np.c_[X, rng.randn(n_samples, 200 * n_features)]\n81. \n82.     # run classifier, get class probabilities and label predictions\n83.     clf = svm.SVC(kernel="linear", probability=True, random_state=0)\n84.     y_score = clf.fit(X[:half], y[:half]).predict_proba(X[half:])\n85. \n86.     if binary:\n87.         # only interested in probabilities of the positive case\n88.         # XXX: do we really want a special API for the binary case?\n89.         y_score = y_score[:, 1]\n90. \n91.     y_pred = clf.predict(X[half:])\n92.     y_true = y[half:]\n93.     return y_true, y_pred, y_score\n94. \n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 192 - 204\nContent:\n192. @pytest.mark.parametrize("drop", [True, False])\n193. def test_roc_curve(drop):\n194.     # Test Area under Receiver Operating Characteristic (ROC) curve\n195.     y_true, _, y_score = make_prediction(binary=True)\n196.     expected_auc = _auc(y_true, y_score)\n197. \n198.     fpr, tpr, thresholds = roc_curve(y_true, y_score, drop_intermediate=drop)\n199.     roc_auc = auc(fpr, tpr)\n200.     assert_array_almost_equal(roc_auc, expected_auc, decimal=2)\n201.     assert_almost_equal(roc_auc, roc_auc_score(y_true, y_score))\n202.     assert fpr.shape == tpr.shape\n203.     assert fpr.shape == thresholds.shape\n204. \n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 285 - 310\nContent:\n285. def test_roc_curve_one_label():\n286.     y_true = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]\n287.     y_pred = [0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n288.     # assert there are warnings\n289.     expected_message = (\n290.         "No negative samples in y_true, false positive value should be meaningless"\n291.     )\n292.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n293.         fpr, tpr, thresholds = roc_curve(y_true, y_pred)\n294. \n295.     # all true labels, all fpr should be nan\n296.     assert_array_equal(fpr, np.full(len(thresholds), np.nan))\n297.     assert fpr.shape == tpr.shape\n298.     assert fpr.shape == thresholds.shape\n299. \n300.     # assert there are warnings\n301.     expected_message = (\n302.         "No positive samples in y_true, true positive value should be meaningless"\n303.     )\n304.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n305.         fpr, tpr, thresholds = roc_curve([1 - x for x in y_true], y_pred)\n306.     # all negative labels, all tpr should be nan\n307.     assert_array_equal(tpr, np.full(len(thresholds), np.nan))\n308.     assert fpr.shape == tpr.shape\n309.     assert fpr.shape == thresholds.shape\n310. \n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 219 - 235\nContent:\n219. def test_roc_returns_consistency():\n220.     # Test whether the returned threshold matches up with tpr\n221.     # make small toy dataset\n222.     y_true, _, y_score = make_prediction(binary=True)\n223.     fpr, tpr, thresholds = roc_curve(y_true, y_score)\n224. \n225.     # use the given thresholds to determine the tpr\n226.     tpr_correct = []\n227.     for t in thresholds:\n228.         tp = np.sum((y_score >= t) & y_true)\n229.         p = np.sum(y_true)\n230.         tpr_correct.append(1.0 * tp / p)\n231. \n232.     # compare tpr and tpr_correct to see if the thresholds\' order was correct\n233.     assert_array_almost_equal(tpr, tpr_correct, decimal=2)\n234.     assert fpr.shape == tpr.shape\n235.     assert fpr.shape == thresholds.shape\n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 430 - 439\nContent:\n430. def test_roc_curve_fpr_tpr_increasing():\n431.     # Ensure that fpr and tpr returned by roc_curve are increasing.\n432.     # Construct an edge case with float y_score and sample_weight\n433.     # when some adjacent values of fpr and tpr are actually the same.\n434.     y_true = [0, 0, 1, 1, 1]\n435.     y_score = [0.1, 0.7, 0.3, 0.4, 0.5]\n436.     sample_weight = np.repeat(0.2, 5)\n437.     fpr, tpr, _ = roc_curve(y_true, y_score, sample_weight=sample_weight)\n438.     assert (np.diff(fpr) < 0).sum() == 0\n439.     assert (np.diff(tpr) < 0).sum() == 0\n\n\nFile: sklearn/metrics/tests/test_ranking.py\nLine number range: 312 - 381\nContent:\n312. def test_roc_curve_toydata():\n313.     # Binary classification\n314.     y_true = [0, 1]\n315.     y_score = [0, 1]\n316.     tpr, fpr, _ = roc_curve(y_true, y_score)\n317.     roc_auc = roc_auc_score(y_true, y_score)\n318.     assert_array_almost_equal(tpr, [0, 0, 1])\n319.     assert_array_almost_equal(fpr, [0, 1, 1])\n320.     assert_almost_equal(roc_auc, 1.0)\n321. \n322.     y_true = [0, 1]\n323.     y_score = [1, 0]\n324.     tpr, fpr, _ = roc_curve(y_true, y_score)\n325.     roc_auc = roc_auc_score(y_true, y_score)\n326.     assert_array_almost_equal(tpr, [0, 1, 1])\n327.     assert_array_almost_equal(fpr, [0, 0, 1])\n328.     assert_almost_equal(roc_auc, 0.0)\n329. \n330.     y_true = [1, 0]\n331.     y_score = [1, 1]\n332.     tpr, fpr, _ = roc_curve(y_true, y_score)\n333.     roc_auc = roc_auc_score(y_true, y_score)\n334.     assert_array_almost_equal(tpr, [0, 1])\n335.     assert_array_almost_equal(fpr, [0, 1])\n336.     assert_almost_equal(roc_auc, 0.5)\n337. \n338.     y_true = [1, 0]\n339.     y_score = [1, 0]\n340.     tpr, fpr, _ = roc_curve(y_true, y_score)\n341.     roc_auc = roc_auc_score(y_true, y_score)\n342.     assert_array_almost_equal(tpr, [0, 0, 1])\n343.     assert_array_almost_equal(fpr, [0, 1, 1])\n344.     assert_almost_equal(roc_auc, 1.0)\n345. \n346.     y_true = [1, 0]\n347.     y_score = [0.5, 0.5]\n348.     tpr, fpr, _ = roc_curve(y_true, y_score)\n349.     roc_auc = roc_auc_score(y_true, y_score)\n350.     assert_array_almost_equal(tpr, [0, 1])\n351.     assert_array_almost_equal(fpr, [0, 1])\n352.     assert_almost_equal(roc_auc, 0.5)\n353. \n354.     y_true = [0, 0]\n355.     y_score = [0.25, 0.75]\n356.     # assert UndefinedMetricWarning because of no positive sample in y_true\n357.     expected_message = (\n358.         "No positive samples in y_true, true positive value should be meaningless"\n359.     )\n360.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n361.         tpr, fpr, _ = roc_curve(y_true, y_score)\n362. \n363.     with pytest.raises(ValueError):\n364.         roc_auc_score(y_true, y_score)\n365.     assert_array_almost_equal(tpr, [0.0, 0.5, 1.0])\n366.     assert_array_almost_equal(fpr, [np.nan, np.nan, np.nan])\n367. \n368.     y_true = [1, 1]\n369.     y_score = [0.25, 0.75]\n370.     # assert UndefinedMetricWarning because of no negative sample in y_true\n371.     expected_message = (\n372.         "No negative samples in y_true, false positive value should be meaningless"\n373.     )\n374.     with pytest.warns(UndefinedMetricWarning, match=expected_message):\n375.         tpr, fpr, _ = roc_curve(y_true, y_score)\n376. \n377.     with pytest.raises(ValueError):\n378.         roc_auc_score(y_true, y_score)\n379.     assert_array_almost_equal(tpr, [np.nan, np.nan, np.nan])\n380.     assert_array_almost_equal(fpr, [0.0, 0.5, 1.0])\n381. \n\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-10-04 05:05:35,923 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport re\nimport pytest\nimport numpy as np\nimport warnings\nfrom scipy.sparse import csr_matrix\nfrom scipy import stats\n\nfrom sklearn import datasets\nfrom sklearn import svm\n\nfrom sklearn.utils.extmath import softmax\nfrom sklearn.datasets import make_multilabel_classification\nfrom sklearn.random_projection import _sparse_random_matrix\nfrom sklearn.utils.validation import check_array, check_consistent_length\nfrom sklearn.utils.validation import check_random_state\n\nfrom sklearn.utils._testing import assert_allclose\nfrom sklearn.utils._testing import assert_almost_equal\nfrom sklearn.utils._testing import assert_array_equal\nfrom sklearn.utils._testing import assert_array_almost_equal\n\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import auc\nfrom sklearn.metrics import average_precision_score\nfrom sklearn.metrics import coverage_error\nfrom sklearn.metrics import det_curve\nfrom sklearn.metrics import label_ranking_average_precision_score\nfrom sklearn.metrics import precision_recall_curve\nfrom sklearn.metrics import label_ranking_loss\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import roc_curve\nfrom sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\nfrom sklearn.metrics import ndcg_score, dcg_score\nfrom sklearn.metrics import top_k_accuracy_score\n\nfrom sklearn.exceptions import UndefinedMetricWarning\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import label_binarize\n\n\ndef test_roc_curve_with_probability_estimates():\n    """Check that roc_curve thresholds are <= 1 for probability estimates.\n\n    When y_score consists of probability estimates, the thresholds should not\n    exceed 1.\n    Non-regression test for gh-26121.\n    """\n    rng = np.random.RandomState(42)\n    y_true = rng.randint(0, 2, size=10)\n    y_score = rng.rand(10)\n    _, _, thresholds = roc_curve(y_true, y_score)\n    assert np.all(thresholds <= 1)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 7838, 'end_index': 8073, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 8054, 'end_index': 8346, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 8607, 'end_index': 8849, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 8735, 'end_index': 9001, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 8886, 'end_index': 9307, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 9705, 'end_index': 9940, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 9921, 'end_index': 10213, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 10474, 'end_index': 10716, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 10602, 'end_index': 10868, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 10753, 'end_index': 11174, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 13482, 'end_index': 13717, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 13698, 'end_index': 13990, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14251, 'end_index': 14493, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14379, 'end_index': 14645, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 14530, 'end_index': 14951, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 16581, 'end_index': 16816, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 16797, 'end_index': 17089, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 17350, 'end_index': 17592, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 17478, 'end_index': 17744, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 17629, 'end_index': 18050, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 5472, 'candidates_token_count': 504, 'total_token_count': 10796, 'prompt_tokens_details': [{'modality': 1, 'token_count': 5472}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 504}], 'thoughts_token_count': 4820, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1530847700815352, 'model_name': 'gemini-2.5-pro'} id='run--8f694b3a-4479-4803-b5a3-1fadc64d35fc-0' usage_metadata={'input_tokens': 5472, 'output_tokens': 504, 'total_tokens': 10796, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 4820}}
2025-10-04 05:06:10,689 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import re\\nimport pytest\\nimport numpy as np\\nimport warnings\\nfrom scipy.sparse import csr_matrix\\nfrom scipy import stats\\n\\nfrom sklearn import datasets\\nfrom sklearn import svm\\n\\nfrom sklearn.utils.extmath import softmax\\nfrom sklearn.datasets import make_multilabel_classification\\nfrom sklearn.random_projection import _sparse_random_matrix\\nfrom sklearn.utils.validation import check_array, check_consistent_length\\nfrom sklearn.utils.validation import check_random_state\\n\\nfrom sklearn.utils._testing import assert_allclose\\nfrom sklearn.utils._testing import assert_almost_equal\\nfrom sklearn.utils._testing import assert_array_equal\\nfrom sklearn.utils._testing import assert_array_almost_equal\\n\\nfrom sklearn.metrics import accuracy_score\\nfrom sklearn.metrics import auc\\nfrom sklearn.metrics import average_precision_score\\nfrom sklearn.metrics import coverage_error\\nfrom sklearn.metrics import det_curve\\nfrom sklearn.metrics import label_ranking_average_precision_score\\nfrom sklearn.metrics import precision_recall_curve\\nfrom sklearn.metrics import label_ranking_loss\\nfrom sklearn.metrics import roc_auc_score\\nfrom sklearn.metrics import roc_curve\\nfrom sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\\nfrom sklearn.metrics import ndcg_score, dcg_score\\nfrom sklearn.metrics import top_k_accuracy_score\\n\\nfrom sklearn.exceptions import UndefinedMetricWarning\\nfrom sklearn.model_selection import train_test_split\\nfrom sklearn.linear_model import LogisticRegression\\nfrom sklearn.preprocessing import label_binarize\\n\\n\\ndef test_roc_curve_with_probability_estimates():\\n    \\"\\"\\"Check that roc_curve thresholds are <= 1 for probability estimates.\\n\\n    When y_score consists of probability estimates, the thresholds should not\\n    exceed 1.\\n    Non-regression test for gh-26121.\\n    \\"\\"\\"\\n    rng = np.random.RandomState(42)\\n    y_true = rng.randint(0, 2, size=10)\\n    y_score = rng.rand(10)\\n    _, _, thresholds = roc_curve(y_true, y_score)\\n    assert np.all(thresholds <= 1)\\n", "relative_path": "sklearn/metrics/tests/test_roc_curve_gh_26121.py"}'}, '__gemini_function_call_thought_signatures__': {'d775c4ab-5a8f-4deb-bf47-4ad4573f829e': 'Co1QAR/MhbZ3cyqWR4HKPYGHdMupRNW4Dg/echYc/m7iFie4t0KtrUTdBV4yQrb6M5jHU8R/8O93+L15AtTwGUzgsPjvvihhQvvUF6OS+B1ypSKUZihig9hvlGMxZu1zqr/Iln/S5iMb89S6wmRBADWrfyJLqi7hmMbrgVe4izQ6Gn9vWiAGMduV7qoS4vExlHnPspKkqLls8Bzn0D3MJ4HSa2aF4jl9nmApFBAbB4USpXUEmnQleRYLLkOebABNui0meWr5ravnZU4fdZ1gf8q2cbjF/jYYnMPP3rhlKrfxKY1gZQjZ8RiyD/4Pu7V+U5oon4QaEmN5ZkJgZ5FV7NJB1RblBI3DYRI0Aj804euSkGi8hxiif6E4LMieA2MfBaRBxK/0zoH2p1INBc7V5A4WaJ9oUaUjBoEZ+I+SZWLs8hAikHIbaLwKrhL9i7qtHbxTlwEUgRq41BUrG+aYMuevglu9lMrj8C/b7Ra5CBHF1Qkhr+H+Du82vt8E6DjNXSaW5n1DN4YFcRTMVqR2QG5KCCH4giMhzTpQYDmX5TdS6SxbrVQ7enul8A0dR/rH6rrCmeWVIs7+zueTl3TNrJ61l2TfM4Ac28SHVLjcUOcAmnLu8toMjPxVXastrdB2HSocBwMK0qfgH1i+D11JUChSD5CCdFGMAZaY959hisVga6uS7V+ixibMkYNbfi761P7rIe0sXYsmxrbsR/4xoGbC0vDNnP54wGuIBEJ8II8NoqV2toJdXIw6p6BRgBIxItkeg4VSMHIV1ooS8F7LThf94SC2cG5GAWgNFXMyH5h1B8HgujORe5C7p6VZ1i+hkDgHjdNtI2X869heKUJdmvpOSVZG+U+QLreEwhISGWS9Zn7BE8fzipquF28179qyMcKP/0I3WdYgu+3N2g5ox6tyUlCmUn02l3StRnWGFnc29tPKge2uoQJGkwBJyJ8on7taF1UkjbeVSsS4iK09lJnZDdi9GfhpYHZ4NuVCxj8bN4JTGIcmLGDGBTPcBcBxBmhegVmgwyZohy2sAHOFyBokboWuSSEIuYP8ky8zhe1aY+A/XaT4WrYP00Sb2cKRxaRg6YogXSjsDP797oxe/wuPQnpUugcxHsQGhAhUjhMcJDewfd7lScPPpYh2SGdUfdgfZfdMuHqVnlyjBy+osTxl5GtzmFtolynGV0PGLA+FpX1m6bgmabSLXo/y/UzKj7q5jxdfPBR3Mz1UoKRXo7MZ/3djsv5dYTOVkJ8caG5fHiHYco9JhUXxAkS8hQ3iDBSbXPb315uGSiA/xnZwtXWupnVBem8o2EGgSrhNOt2KzQGBg8MKRIOY2Ip+n7WGfr/KUTEdzGvrwHn42Jq60zKKd+LyW9LUnQcxk95mlgUXra0j7iauyFdEDfxpWTpg3CALl13OnwgkAFJSIC+z9W0uL2DFFhfZ2HAaYmI9MIr31BFzijGb4CqFJjA/f7GFZOIQpCWd61zCCZ/FE7kzEb3iC3Sqxo/oya/9ks1KOxqeKNTrZbjHZjpgbNR6tq7oDbFXDCr/GTBO9wNE53GjIrdPUmg+jxKfCk/a4j6PAYd+1S/crX3Jwqxn62IV/ZJC979WPHp4pmljhM1NvZyoDQ4UDPZee5zqieXgxi758UYTnlNUMTJMNVl74JZFsFvbVoyiVHpjr3Xr3rpPvboHJIvtYJWpXYv+EEvRxw7NPHyiEc8tWBIVYXyxuFvuFfN9dt9GX3SUdYYYV//uAj94bHWSEnbXd4rCOBRrmixR2zypDfa3Te2qEAUc2/1pEkBw4Oobt/N2vQrBNRAzWvwxbGXJdlgl1rWi8lgUGluNfgzRU33MDbm07hWMWAiEQDa3H5dzQQcU1k9r1Ax5AggyTQEhI7T0PlHS+LBxRA3GMhLT8ZW2y1kwfe5iHx5nk9q/en/n5eUtinfPyxnB6Wd3GVTN2NtoseyIOqItWceo3L+itB1NMVmHacaJgcf7XCl3KPa5w1i2aOMaeyB1TFRt4ioUhaE7G9xohQPu3Kp7NBOnBLX8G5oDUfqnT5OLpQ2OhScm0I4RqQjzRmFywa8/EN/SZthVA0MJ5RImBsKW05nUYWICqNY+bJoRwXBeJCGvMka6x2r7n7z1eaXxquVVwIkZcct5NTsmyGdmaf6EK01+se9zXipJ7jp3QfW9wZp4aW5BStkuxiGY5H4PWVBV+JcUguIYv/RcJkX4o6ckCF5oWDvnkCtVOeNceFMMkxZi2BcCSqXTPy86U1P3XreXoNu4+YzpjnpGGwVTwIKHqyrjcA9oAJMRpaqQuG2nYFzDQHVHp6McsMhVaTnG1KKzQuP8QJDWDZ7fiz6cF3w3aTSTXfkWbeaeSxy+UUwmcYHG8h18TDrsfQtrc9daWCvmSA6cwBHuElmhvOTYBtLoRezaa721Y7Z9E9YEH7l9mej3e3Y2IhEanQuFjIj9x1YkRIStVAhga37IvwcDZnAOI4yfsqNtTM3AzvwUlOBFZ76oqSm7cbKIkvnsD+EW+/L1uRAWe8s0YNGiZTuKuXLXncRHsnOJCFcANQKKD59/stI1UyAPny3uPgn9UuwzAsO+PxQRGJWTf4SilJErciPR3kDSPxQhqxvEWGPxfy47Z2/f6FiQU9dxWer2HA9ALGL5ahtp7OUQgHU78dXgPJs3b9QsPhspj2qHddBphgmDR13OCuxkFZGz5GwPRO1/OwUcCKiY8jp1dQbBxDHCrX/StawwW9ApE8gBZoChv4EFQ90JEIDEpIn77pUx1EQ4EDcfCKdfd8Bc1hJyuZVDYaaq+roRVoKJZDxXknzNniYC7M/GbQr9ussTD1sYM0kpEjDte/zpmYZqrmzeRF1Ysfw2ARRhGq+TLKGxAO30iqPr/EDF88lMrWKiWqQEupqn1fdkhwXieKQ0XDA2ekHmElfps9y1Ipm8qbozfXfANJWxpruR/m3ArIGMjqeV6SgFmdPj3REF8DE6kGJXy0MFg5qNrU6tjYpdernVuhs2Fb0Otu4OBOKa+YBRtEU7k8yx6dsN7GxQtwcbNSHaZ/HqG1VLHO1tZPZIlLkjnIKnICq5onKzhOUO6usufltqmTWs96hal0nlQnEstKZ43TxzCcGeyrWobXrTctl4OVHq/Ycg7tBSGoJAUUuSD019Lu6VHjZw2WuH5f6gCTMBsZ7XR7U+ErszZn4HGtEklNKez0xbQmt+7tnJeoG6pg13Hodt6zrzNUIcM+DDkbT/Kj5Z81RIE0aF4RukPrbmMDalcP+tOZTJqQNK9J3EOJ1t9fXLDqF0uiFBhlMcHSIoSuH+zpdb+yvtWi4PYjpr2Fba7VP7fnDZRo3FTlGmilTDtWBo0aIRRftblnqUW0HgcKgJLFTk8AD8S9pA7jxxS1M4uHnbc5UlKASz1qn/1KZB9j6KyDoSp8CqgFJzrUxSzQ2UeRM7ICfXB5qnHq/740wgVkgKpShSnP/jpepq3GtxSiYua/bcYTE/CXgVOU+FcQaHq46lNKWt+5D+umxpKiO5RRu7+fise9TDS8zvNcUfi/uHL1bJDRMDemrqWzYhUZ8MCwF3+9mq8OTK6e6N099FHsJzWCvrjRbxNPDZHdQbXGCRLbelxQ/gQW2tqjAQe5WbGW9sqhBOqj9ZhLGI9MtcVdLcsp2AOtL479w81lJjz8KoAI4xSTYoTAZnauWStF6MGhzrIXL5H7O0FLLXFrNwnfVViyFXox6q5DzAAM5CVdNWFJQ6L7f/2JIARqdbc3IvtuRQ4/NSGFhkn0uXo/PS0gPIPEkYiaY/P1ZIys/YBHN0ssdwM+7Fp3cLuZ0mLNcFeWYpXkKhjfch4bEuQ8qvfdxkWq2uoMs3QRAjgtHd86ynjrh6IG5KyTJHqvmIMaLWx+6bJfB0Dw3KuQ34J61DFtF3RVWS2hp6a89hg0gU99qfc7RheMH/whvfkn1ytzGSCyfi+Gaa3PByXM0K6zyv+MxY4o1357H9JmR8S8HjSYaB0bFF2MCtBfyCyY/EOL00WMyhWl+2JBE8liSsjXz8+wTltDV3I9ycNxqy0sXb4sF7F8wvmenfco7BiprA5F4KEa5nd4HGs7UuIEDs9VU+3rZsyFfUpGhYwOyK0o4Bvr1SPHgbMeizPWYs7wU1jCEwCD+PX37ur4q8DWoCP0cT6D3DlYQe7mvcbG8JhtUX31meOny7QMSNFFED2Zr+WQI5UT7N6FvmOhaM6VYDwrAjyh8lEQ0Wnm2Y1kH2KYWg/qwUyaGjJAxj9WTa8XIHndWLHSqfNcWqh1txfH1qfRF63u23TL88yGlRviqtVJGaLuyvArzafKfNcyJH4T2xHbpUvz220ofTh3xl0gDvrOYNGJwK1rrwZuQ5bG+O6POFa8CQUdP/DiVRAxRF78HFbRTDpdkkBobmOgpb6WqgjPsl+4aTQ1VHr7i175gY5bHQDN0STwnztEmkAeTS9av4snJZGwojHguky4eGnnrQr77MA8fQ50212la/L/xpAN1amrM2NAzZciKmv7av6jaTqsZy79UuGRMr68mtaVaVIt4GzKSoW/t902QLmlnw4UgZrANFn/8nQ2DHXxwmgfcGqxl6Bzvu439fjisTMLMZXM8fkT6VTGmtROhQ5sOBbkS4NvEoopoaqZ7bI+y6GHxgqH9BdM1MDpWeS5suTNtX5h3yBukCAyugwrdDcCX/J8JtSf9BaRRiALIyAicNoXGPeQf4kByhuknll7ZquoGffNCtIj176YzsLU8JrIHAlvRSR1wh1gW7Nm58Ej/Pnho9u2Ual6r+1Awunounv0Kj71UqOd9s2ijF5c+O3haSDfjFBhr8IOu5Iodep+ygRbeEpIgxqHpNMIkOpa1hmg2ucIQxV1vzH179Qz5Hc+d7dL+5p3pmL/3VW/xpA0RaAkHap5PjBBXtCNWsqHyHl4C+bfRnpI6YcxXjtzVI7Z1t8VsG/R0j8NZsFVh7dD5BpfaiMrN9qVs8pSlNbWk1h1wZ4elW3o7y35nJoUnCMumy7Fm0Ug8Isg8iNnd1P1CXKPsJYitsVPcmXSM8JmgwM9r+O+E1q+B/F/PWTzALaMkJLnPx+zyaxKiES8bLTIBW/Iey2zGvLfyZHHiTF52xGrMH4jAqWccfNLMcXipS5tCAWn9eTnOzQDzZg1DO9O4roInoKH8zXDTec1uZ0JwhqnKcoDIPhKrzRdcD2IWUr+QRoUMarH29VON54BhQ7bBkDCkpTPAuv5xTW1hn/esAQstL6qqVMoaLm0flEFoyfcS/T5soyjWt5TlcFBoeay1wTerreTbNpQoDSzCTE06FOFjyQLew4yU7bvMiPryajNyU4UO2Z9CmG/h+jotsHcw52cgWKCwLLffoKyESJKzR7ZIpiFbkjWfzrovtwOEyZ62KJf44TWO3H3Q7w6ADyL1L250E6HWu1xHtaKTrUJN66QS0r3L1QiM9OeTMbPhqHRH9Mp+pkUr13H5vE1gkG9vw82zmkyhlE9pP8azt8VdP/s4tL7koh4A6knGRL3B9Q3gvf3BB/oDDbfCo9rFhvGLSg2lZ7iR6b1jA8UAx2yy1Ozxr0V4z/syg0kHap3SwLgiOfMBk++0Y/yWpgp6qFFpFAvYGRM9UgYjHfb1ur9iNUKuBiHuoS3RrFTxziwwUkhdcg7dJ81UTJer/N9QaSh4+k6FHFJ79uHpHG+uNBDM16IXMkaap35rMyEXYKcbqAvIqQ9Ld8DJrpx7tG0T8J/jjxxwHOe99DhxFvl9WATkFRWqLSJKd4xjBCvcDI6TzEOLN8BfgoVqD4fAn2VSdSuGcoK6MF5T9taZ9ggtxzV+6weNz7MzhhWNquFzYL0reBCSDaFmfwMQTrmC0NEYdplfwxrGuMomz9VvX/SgNTNHF6LrSCbTtR/wu7g3KLjtz/thgUgXYcvqwArPMOLvVpIkeEOUNJ5N36rp0uLAS++Ugjdal5GAJeqz3T4TvHN2rz9U3ppVb+Ihl5YntIQCSITytCw9YOHFZlH8jF0ehVFArqJEbPtd71A9ZcmVPtabBeHvjXhoKsZVuMq91env2SDc7x9Rdsn4uwoMM4cKvVncVGFuXiocvz0XOuqAJWPjDzS7jZdjA746v8ACjaobIRlZpyKV7vZ6u5TPW5R0uKiitjybQdHCoYLC5TPnk6yDvnMGvmUlJWB5RxCOxznYKiH8w12UWYJuhgKM21b2YuohB3R0MzL/J8f4BLolzM+41Z1M/ER1oF4SmAiZ7DTgOyJN5bE+bSH9GfdRhffFGVT0jITEw6xJBBK4jzH3kD8f1DBtsz1GPfXVGTo1BC6K9ooq3pb/sLO12AVXi0Wx3l3Yk8E7n1M0UyNifntX2/UpMhZC3NXG7BY5rPxGWpQOSR/T2B+Pp8Hhp0oF1ewguwvUZUSqN6GjpurBjHky9/nCRzvuNPPlhjenlUpsgfsvcSfGClAUJwmVAW+lTflZXMLK7GtGlRf41FPpEGND17dfWBG3zZkz+mxxh8Ieisg0R1kPabeAZXe2pJtg4a9EKgJ7kZZyxe7TRNcZzMI8F/MwFSfG7eKSc8LuJbueBCm2wyVcgsgGc2HiYEjxKp+meKY5zL1lkPOf5gPEauvXiS2ibNw/k2hKKgAmb7hwGYpqfyWbiiGs6h55/jpZOubfzmgKz8p+MOlTYShLMc/xjR2kMV7fWwLPnuQ9jsAeOVHDPhjK1hox4OvO5ro6hSKzXGxrLcRbOo82/GMnMdpm4zonImrumX3OD0+N2W5CbWmqyuMqkntTTrIg3ws4lEsxuJ0r6/aSGEF2zN/5AxgBJwfZFswD/xAsNBcpPdqMqraxXk3ZXzCcMvIuiBTkZ+q48ahQipxjDaT57yqdveTvp4olrYJokfGZP8ovvfkFY85TF0CtpYsNFq93PYNFzC07jbpZ9QmBEL+vxtL5QLlZGWaRq96Y7JLE/17F6ntnEXBqJ4W0YJIZnXRITeTdO9KCIgIaekXetHIjVTIrRyWXW8Lf4nXzg4pAHh4SIm8t7YSGvlka5bdGZRNurcti7OCoJgQqV+GmP9ZliGo3fBhOWAkQATZnhUS92W8LLM+V29Pe9r2xoWqfxItkg3cvTK5kuVJY3kZm0Bl8BTf3TdN1WlqUTJa1jIk3/6VMLZsPMwyHusIXbkCGRHG9JY6PZznaOV+6Dj1xktjyLVlQYPC6CxHFYXocM/q9SILue+ye1u3GlnV2jsMXRZL6I4gFxEG+hgSOyNk8on6/fseseen+MX7YWjCfuUWGXqwonf1+zuaWUOEbTUmTf4Xqe9OpdllYfTw1sxtHvJJkdE9X9XSgFY1Fa5uy7tN9+nvLVqDCiVyxRUa2Mghwv2jCJpx41qX/8paB+gl80F4N48oplTJAvnMFMtEsEPBo5tfAPIicT0eYu9W4bKANp8DH0Algag9gYyHQKTrCiHClYaowLETqAglBPv3GxAmvcDBxz+BBmPGkF6uhrytRXRqKP9qBUMD5MQn5zGG1o2tSn1T4tRiSucFlGPNyFpaHarckAE2DEF8wU/8uRBjylIXTG6puZnuT6tjMaOGV68rTkM6xsM0uqGJ8n1imuCV+rbkEOGYJVbZ4NdsEZig4tpA3s7YXPo9OwR0bB4ZPQ+Gyf5yI/GuSWmA3JsvscFc5fYDXoacX9MYbQ/6JIXAsjTZaVR7GfzZOeV4w6xI3TM9a8ipASH/B0EDpVFqAkKygjHjkCr60qRZqO8/Y5GAsLKpfDq4vmNHxEkB/H1J3KAdfMUr0nDOi3B5TXwBnhZbUu1yS7ceXrc4Z3pj2uGErQMqKddwzjpVBpJ2xK92cu11872UfG1Vo4TWKVYSDZ1U7wEE7wRhfGlg1aPC/hwk/HsFWz+f7pPCINQ4rCl2iMSA/fPdoOrNRJbSeRkmeN21NeRWXDFJrzHa5mW4ybNy9MYXohb6t4ybNZ8NymtYBrwf3I34ZLOcSo9t/gqojE+V7sL/kXu7gLwnHHI9JyQsisEtxRsz7x7RlxHJVgwR5Hye/2GMrh6IhRlXo9zxPY5hwo8Q2onj1UGf9ok8cBm41wAzcC/w+VtTKSk1RTtp4gY0gIOSclP9gEcji7zYnzv+g19lHxPu/suLcBwQYH66Ef48LoSWKjCX2pP845ALMh8lMXksFKG/LPobmtEqRfypkdDYQy/XdJWU+kJ1AH7+LEMsepZLbdPmME8Jqaaq8n5WbyAFIxA/vNbsvSBcy3bbhuoMrdMXmIfy1vP8kgqOmxIl4rCS6b+RXgT3SwmbbbFQPC3xcvVI+M+D8gwzVvG5VFu5VecO56T8tjeAEoRsGhShfeBtFzLLxBmZMBGGzfPNeKx1OK7nJ1JBiwP6ILkQFVT2Ae/yDCc/zR1BIvYDg+n807kOcKDLORwOl4vB5mERDt1O7v6bWbde01mMV5weF3lwrFYe446dZ8tOqmEgNp1icCHjQEkRzaipImKCU8URTkheAqK4JkunJNHP2N7NIXF/8EvjbUdcMKRoYMp+ujN+wg64Vw44bsRsZkjLxDaW9EUypHLibAMdPQK6rDe3z4HneiGHpGXatznSja2Aos1jBtfxwFznG/b0Rg2TeXFNj1KerybH8FquuSlj3oo859GoAD4HBU0e03JNyTTDsObAmdzeDzaPbwHU6SiqQbvfwYFFV2OGz8oiqKSxRo3eTbbFEe4VcztQNXD0bteCYhI7uN9dbqHW57tVOudkhg7MAljj5gnJgN9t54gyOHQPdXoI2lQAfmyoxPCrbBkiJJJY2b8UBi9UHeSgj2NJVMcrb6EZ9kKzKmF17S4XilwfB3h2KsUOydKFMARSNC5dHdzSlXqVKmzVWSSUYtCSdIA8g8dhl2FxezUdGGmMRnFakEEwxQuRohmX+r/8OWoMYh/S5z05cctMRoC+vFG8O10HuXIZEpoUYF41t50vfM1DYua4jFxQaEwr6BAz/N3vmZ6MJdOXRFXItS7LceH8a6hTddDaOazO5aeRXM5BXJTHgIdGN2rkJY7hiXaY8TR617t+dhvCxPhytdXSWGdhZxlEvA3TiwYmvL9GItADsxcMjHNkOEmci6l6tu0BNW+Ouy+2PxvYYBUAnZ2ccm10+Lf8XN0XgAVWn6Udo8KZmyao4fzwQVngWFaHnsYUtFN0fjEXHVPQB7psZPywK711aVVuTHkfckzqlIczAnetLwhrf38/jWpiPZdN0oHLcS2ecGKmfKPFwv/2XD9Z19uMoBcXxRlKkSWCkwmKAjfJ6kK9RonTj1wnFgYkbe0yPEFOUimNSGz/hr5ShCUc4j12Sq2wD14sHSOYb8Zn5eZ6xKOzzPHqrTOvtmbSGMKHtbUa8D0pYFQ62PMYbL8EWP7cKIHjFqAlFvxAFr5+BE+/NSvuc7kboHhLeOsLPr83hp936kEpEKpFdLljMbYMYaTBnJ8ZAeNbGxNbUkP89rcgWa2xur4CTRIr+re304EXo5Rpu10bKC94pEo5YnjF+xIkXMuJu7bRUlAl+DxmqYYk1egqJvSXDOVY0CKNiX7oNWYOIcD/xP+JI/P9B4XW/cBgPSUZ/+tTh4CCKs8gOSmtHJHH2IMGGSq4JIDShiPZYjoE0xkRdd+v31ME3GB2o2S3NhUiWmbjcfQ0YC/4+IjwrZtKh+MwcOehvGpa3WW1z0/nHPYiAN5GQ0AwIOjWl8Tga/9JfAmmYzCYvLKEKaS1IYgmRud1opJfi5IunnYcHQ7BtzeDFM4jXsadJR5khaaFRQl0coQ3SW6/vWRcDWbtyUsTPFedw4F3ghpH5ZnNXk5jysF+0aOjymERA3YSy4r7En8vG9eWEJG1pn5KArqRa300l4HiBHNbwICrC0Zy2k8ZDFY5f45tgA0x5YAdTGMacvHewiTIAA9tfNPJR9z/XoZwtvIPMqxWIBeETEbgnfWvs0wcafhuFaHx8uC/JlANuWbANDovf0JY0BczGYuGD3dvXUVSIqOyYB388XisvkpR49h/gRun2zOqti7hy2glodSddJWDY2l76/xNawiua+/P8kpTIgoUK/C0Rk/hxe9c/pc0BcoGNtwtuL7/2jVcw1TVqZ3itytzgsKY+j0oWwR/bJBrrKlanZiVLGW5dgvdAa8pN841lrqWhfSn20UDZntITfxwRBrFnrsxc2GgbzYHnIkv0ib51EplUJUWUvtFoCm5m8B8/HcLBuroiV+sC6qysB461fwBtUuHaVsAaOsWtRFcN0KTDWj5ZmPg4kfRlSpxoSfTUMtJfnkMKZ5S/HX/Vo2QgwmUf5VGObBDSuYv5s+XxGI3f1eCmv4K+NVmBtiZso7zxW6Vo+8YcPUW3RXihs/lZ+OI3G/ldNIr8hOuGZK3aH4MlUfON1uvop/DNJkuLSM5evYnSQkZjutf6nR4czr3co9vQDqlsOXoLVZcTg9ZlRqj4jLgP+CW+xPI60k/+t9O8qn9E/B+5Tw1hAvmqVWmDpLweu+B6JQDeHUh4aGk/ZjHzjRIb3WPquG96fG+BifImcPUj0NLV+kQKNShKtmOliA2hia0BK1dyqB6Pw14J4f5SeWd/j+abwJFwKKKzn/kf8IvYR8+uG74aJDKZMa9kchXG0NgWa06dl6z9+UKUkOYJvFlHxnVg6kjNmGdZwEiZdGlGSm7nFqemsnzJcTJ1MLh7zinpOioin/7CLLJ+mp3jlM0WG7JeyUIx86HSWyxqD9oQn5SuLqdctFKNFjPhm3AEo41okuSt8tzIbU6LBz0n+6CCK/TyHUqQL2NmZDsW9FmSLNKTMTug3L7ibqVJgnubWOTxSPHBZXwBosyVMLCrx97Ik/Rrc3fy8rFA/ktfZVSLZecr3S2q1OC2FYr6JgdQOphpaywpvtMB4qW4J+rXd5MA4ePpCrSuoMwFyrCFh7p8KN86MAj5qXMrpfcvnTrP+Mmd4BLJ9PbV3EX3tOwraAU29GkZNAhbn/Es8ncKySrX2g6+ejoYuOqbae6yBSkHXwhLzRUoVmT2NosiuSPDX7+6D0EQEviByMjskc7voVy4aAUeaUzfnhDEBt7UgisGOUGybGKH9GF8RDQ+vg/mziWHXddAtzKQauvyPHjk2pbgpB27fMDfy2M/rjfL0DVHSx0T9E6YcDmrXfpFfSB90M9uvntHKSx9BQB6ShkJ3f4AZJm+XFZm1yDiOh2C9h+fPozub4c1lbbAHcA8wfbyELbhdwHiEQIGIx/plhDfeiOaUOTg8kyxBfjkQYg0SbHS4F8oWysiQCNs/BBI65LmnD/NS0Gmq6FDnhOrA6BbmI3Mfkqk1PYai0PVcM+TETTxpAR+OqYTZMc58lzPzRnMbLnASPhG5X5LnDzRMSawwJ/H9V4g+Jn+caanpmisvaIIhs0tFkqXMJtHKNfTD3BKTm2Fqxse6MTA9U7J7MpdOD+owWL7P1itlfOI0wwMkA4ufjH2oEIXLPsRndwAc72bCIzsNoMkmh/ikqN6y+Dy9zgQxxwGGQmOnF7VqsHxZFrAyirfWUvn5zqvqPsJY95JF9Adwf86C4q1muzk0EYvRuVy5gokjjt6FaE7qFL4WIyPLkFkdBGeN/qo9T3hFIsHi5caMLJ4e8S7KeE21LiJenT2zhSbj19KIeEsZA19VJYGFm276uGj858/96xuKOg+Cw+KHBownUwC3lt4Pccher3lG86+og1a2vYwtnMUdHBrax30MvyUK+ruqM3m2MBTtFTbDorvVIZpenvD936uTmaJpYdRfnHPs0O5s5WuaFtpIxoykGjD8hTEtjaVMlMVjglnO725Mue5ZjcujqY/JoBBE2XFARGns3rvieyHFvGymNf10BEmJtIhY/TK8GHGEACCUM20Ja5FPg0oDPIgvAeyKdAADs716bWYtZOZpc/vkcJCXerHWLytAnVMhiAAf9ddHS00kEi41jTpLiBMh2EkOOconaK5odSWaDwM2b71XFtFcsjPTr8bncSEYnPJ4jzVlK/OaMCJMrpqpxYiX8Hzui3GOeoZ5kF+CyApg6wA/Ywd3ERwfXf4lrLKo9Ni2CG8gWP4wALF9VmEsxR960LpVnb1IKTv85hHndEjCs+F5SPRL6bKCHge+N2c3oeBZXaYpyfOEfr7lSjrrGPFlN7bW/zHOxNKiLlobfgp3Odmmint5IOF16Ashm2v0t0KO1LuoIklbTmq9B8k0ooMVhNyL0AF7VsGZoKTec+SYu8KJk7qvY4GlHr93SGS3qtB6Gxw00v098S0IoggLF2j5nWo015gK/yqD0bdHTiWeCp+2Wg7wTcc1yTit69gpXXrjcjPx8LepTGxZ/th3CUmeZjCZqZC6OrI8KCQAEnp3FijbFIVVkRrRjYA+TLmRAUcTl/BqrHpfph8ibnB5p86d3j97d90yMMPK1bezIaDnJqw6ff2KjdE9+RRmuINqY7GZPAPKaTJyjxwHNhPxgYX/JAl50UUpxeZdCaLVGeOOJW52Rm+nzwTTGPRHy++EiqyODtvPbFw3dHlYklbOcdks/NdOj7FQuMmPQEtsGhLajDY5XVq1iU89izTkicInsAsHpZbw1NaHSIFmPNYiA265qAqusl34NarL5jN+hyMRqGnyyRnAZi7JTA2qFk5rx8Kiq/ityvuMODmQ6NpGN2DFzknQB/HuWMo0UATjgnhMONhwCdxDbqXrRFVzhkfcBH0ulACnv/X4WdCzl66F0S143rM5jkd/eYg46DQnEQgQWmnICLR5ioelx3MCxod/Ocmg5FrjNLQLSDeQF0xDCscMGkAxWqm7+8glrcE6+9b309v41Z/jPPZefp41IWTOqYSrUHO3ZpkbkMHpUIrNcBtPxyaMlqNxWqt5VZgqks0EeAtLqPYBuvivxmsOUx4oKVgDqxZz+S8nVLCOV9VVbatgrT3u00/gJXEE1/rJviBKfTjbaUhiVMsztVWmsFygOTPKSeON5Oq/PRAzg/vl+vhHr92BPZyPlEUT24PNFWzIOeIJXgMi9WpjxCYbnC4f5ssl/hRcxnZ130BdcFFG/TI49fwujbdW4nYYE3U4VmuaW7D2lSfzWvpz2u/9BA81DECC1r73UDVTz5VytQPnypEl0WVFyMrUVPJ8LGbmkODkn/z3bYpSeocc7Z1QMUMUl3Nzk5cSV5o25xbTtBo9qXf0Pa/n4m+3alElQbdCUBRE6GCJAeAhkZrdLiOM+VeJXuO7qEeqSbIbOnmdEvDRAgM6ovkXH5Up46koUlGCFkz5fP4NqDGv5CMcbQQrmTJiQHj4DKGRlkCCnGrcGLKLJZr4rNHtLf+NJ6SFfdlvI/80+ja21YG1zd0u5RlFbCLdohDoRsrY0J3IUl4IOzyJQLNzZ6fGJkBvOeLjuD+CaPgunr+1py4+GSStmpBwH6qCmo3mGRmSeI26YTJVoLT5OemqicfGARv3HE4GQA+0dW6ATVjta0KtDKfOLs+weqLjQ+tY99JNJ9lkL8baSJ8ic+atF1o5jCs+ktFMS/O1w9OQ1AtkzZjR/uoc08nN70a8J0oFnmFxYbMgT0Nu9H1lRFJ168vTLJICCqYGq9kNAQu2QzbxvEBpnAGQTdwHIDZzqD53KPQ0YOcyCsSt6X0KZ9XvodfCHHbTGofnISF4zgCi4zsqSeYGGLlKi/YRwG8QcilYUnwcanJsjpkxh9zyUUexoaJ608K0HIN8myH9ASZR+q4toWJIir57qxeBZeyETwUU6wQwydPIAjbRkwWpcHsU6Qw='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 6729, 'end_index': 6964, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 6945, 'end_index': 7237, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 7498, 'end_index': 7740, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 7626, 'end_index': 7892, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 7777, 'end_index': 8198, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 10369, 'end_index': 10604, 'uri': 'https://gemfury.com/duality-group/python:scikit-learn/-/content/metrics/tests/test_ranking.py', 'title': '', 'license_': ''}, {'start_index': 10585, 'end_index': 10877, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 11138, 'end_index': 11380, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 11266, 'end_index': 11532, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}, {'start_index': 11417, 'end_index': 11838, 'uri': 'https://github.com/scikit-learn/scikit-learn', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 15573, 'candidates_token_count': 529, 'total_token_count': 18915, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15573}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 529}], 'thoughts_token_count': 2813, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.7495760998788988, 'model_name': 'gemini-2.5-pro'} id='run--a99abee8-9ba1-4e71-98ad-f78df3316e58-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import re\nimport pytest\nimport numpy as np\nimport warnings\nfrom scipy.sparse import csr_matrix\nfrom scipy import stats\n\nfrom sklearn import datasets\nfrom sklearn import svm\n\nfrom sklearn.utils.extmath import softmax\nfrom sklearn.datasets import make_multilabel_classification\nfrom sklearn.random_projection import _sparse_random_matrix\nfrom sklearn.utils.validation import check_array, check_consistent_length\nfrom sklearn.utils.validation import check_random_state\n\nfrom sklearn.utils._testing import assert_allclose\nfrom sklearn.utils._testing import assert_almost_equal\nfrom sklearn.utils._testing import assert_array_equal\nfrom sklearn.utils._testing import assert_array_almost_equal\n\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import auc\nfrom sklearn.metrics import average_precision_score\nfrom sklearn.metrics import coverage_error\nfrom sklearn.metrics import det_curve\nfrom sklearn.metrics import label_ranking_average_precision_score\nfrom sklearn.metrics import precision_recall_curve\nfrom sklearn.metrics import label_ranking_loss\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import roc_curve\nfrom sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores\nfrom sklearn.metrics import ndcg_score, dcg_score\nfrom sklearn.metrics import top_k_accuracy_score\n\nfrom sklearn.exceptions import UndefinedMetricWarning\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import label_binarize\n\n\ndef test_roc_curve_with_probability_estimates():\n    """Check that roc_curve thresholds are <= 1 for probability estimates.\n\n    When y_score consists of probability estimates, the thresholds should not\n    exceed 1.\n    Non-regression test for gh-26121.\n    """\n    rng = np.random.RandomState(42)\n    y_true = rng.randint(0, 2, size=10)\n    y_score = rng.rand(10)\n    _, _, thresholds = roc_curve(y_true, y_score)\n    assert np.all(thresholds <= 1)\n', 'relative_path': 'sklearn/metrics/tests/test_roc_curve_gh_26121.py'}, 'id': 'd775c4ab-5a8f-4deb-bf47-4ad4573f829e', 'type': 'tool_call'}] usage_metadata={'input_tokens': 15573, 'output_tokens': 529, 'total_tokens': 18915, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2813}}
2025-10-04 05:06:11,994 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='sklearn/metrics/tests/test_roc_curve_gh_26121.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 16133, 'candidates_token_count': 22, 'total_token_count': 16155, 'cached_content_token_count': 13907, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18944}], 'cache_tokens_details': [{'modality': 1, 'token_count': 13907}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 22}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -1.8879273821684446e-05, 'model_name': 'gemini-2.5-pro'} id='run--d1f9c6f3-b067-47f6-a391-baf2a4ee5aa8-0' usage_metadata={'input_tokens': 16133, 'output_tokens': 22, 'total_tokens': 16155, 'input_token_details': {'cache_read': 13907}}
2025-10-04 05:06:12,062 - thread-139911184823872.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/sklearn/metrics/tests/test_roc_curve_gh_26121.py b/sklearn/metrics/tests/test_roc_curve_gh_26121.py
new file mode 100644
index 0000000000..40dab21eb8
--- /dev/null
+++ b/sklearn/metrics/tests/test_roc_curve_gh_26121.py
@@ -0,0 +1,53 @@
+import re
+import pytest
+import numpy as np
+import warnings
+from scipy.sparse import csr_matrix
+from scipy import stats
+
+from sklearn import datasets
+from sklearn import svm
+
+from sklearn.utils.extmath import softmax
+from sklearn.datasets import make_multilabel_classification
+from sklearn.random_projection import _sparse_random_matrix
+from sklearn.utils.validation import check_array, check_consistent_length
+from sklearn.utils.validation import check_random_state
+
+from sklearn.utils._testing import assert_allclose
+from sklearn.utils._testing import assert_almost_equal
+from sklearn.utils._testing import assert_array_equal
+from sklearn.utils._testing import assert_array_almost_equal
+
+from sklearn.metrics import accuracy_score
+from sklearn.metrics import auc
+from sklearn.metrics import average_precision_score
+from sklearn.metrics import coverage_error
+from sklearn.metrics import det_curve
+from sklearn.metrics import label_ranking_average_precision_score
+from sklearn.metrics import precision_recall_curve
+from sklearn.metrics import label_ranking_loss
+from sklearn.metrics import roc_auc_score
+from sklearn.metrics import roc_curve
+from sklearn.metrics._ranking import _ndcg_sample_scores, _dcg_sample_scores
+from sklearn.metrics import ndcg_score, dcg_score
+from sklearn.metrics import top_k_accuracy_score
+
+from sklearn.exceptions import UndefinedMetricWarning
+from sklearn.model_selection import train_test_split
+from sklearn.linear_model import LogisticRegression
+from sklearn.preprocessing import label_binarize
+
+
+def test_roc_curve_with_probability_estimates():
+    """Check that roc_curve thresholds are <= 1 for probability estimates.
+
+    When y_score consists of probability estimates, the thresholds should not
+    exceed 1.
+    Non-regression test for gh-26121.
+    """
+    rng = np.random.RandomState(42)
+    y_true = rng.randint(0, 2, size=10)
+    y_score = rng.rand(10)
+    _, _, thresholds = roc_curve(y_true, y_score)
+    assert np.all(thresholds <= 1)

2025-10-04 05:06:12,063 - thread-139911184823872.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-04 05:06:12,075 - thread-139911184823872.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-04 05:06:12,075 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-04 05:06:12,297 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 05:06:12,297 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:

HEAD is now at e886ce4e1 MAINT Parameters validation for sklearn.neighbors.sort_graph_by_row_values (#26173)

2025-10-04 05:06:12,297 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-04 05:06:12,398 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 05:06:12,398 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 05:06:12,398 - thread-139911184823872.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-04 05:06:12,398 - thread-139911184823872.app.docker.base_container - INFO - Creating directory sklearn/metrics/tests in the container
2025-10-04 05:06:12,398 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: mkdir -p sklearn/metrics/tests
2025-10-04 05:06:12,499 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 05:06:12,499 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 05:06:12,499 - thread-139911184823872.app.docker.base_container - INFO - Updating sklearn/metrics/tests/test_roc_curve_gh_26121.py in the container
2025-10-04 05:06:12,502 - thread-139911184823872.app.docker.base_container - INFO - Files updated successfully
2025-10-04 05:06:19,715 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest sklearn/metrics/tests/test_roc_curve_gh_26121.py"}'}, '__gemini_function_call_thought_signatures__': {'bae46a37-c34a-4c9b-ad15-2bc917956ae8': 'CucSAR/MhbaGTDM531orNWUXfPzbEYZLOq9VZpnHc3ppVtLSv9KuKm9ixF0wY9TdCqCNBGWdIowye8IqDU4K/ttTJo09V26H6t5cRktkbDdjK4rnL/59f6ReBnZUrWYCZIFgwxjVoi7QY57bwi/LAYpWQNp2TCKVIS4wayRi52eiKJQg7dZNLp3Ns9uZKGb6lTah7LSyHOK4vXPKvnr4ZF0KckBeBYQ05eIkneQwu1mvOVx5+wYb7k34MYV2LCzyJqeJeaLHb/i2Vz3Yd+pDA/oCXYBAuYfzlbtQWQ8b3mCjdBKQ73IMSaAYJDVKvhbiIvRYu3cfN9Isu2jhYfTNvQ1y/iMKThGqwv3r1HDHRk47AyS/Cu4Ttf4fpa6uf+ivyzgloEOlgmbcZK7s18kILx2zDHQdJ8j8NpnFP2wngtXYdWh9w71apCYISMA6Whpi49iSioKGnLObsJcAVWF+b8bWhl6oXvNfT5epMBmptXhXisYcld7Z3tx7/fipXEm2p4YvipQHvtdBL4TS/WlyLwgE9Y6CW7klam6eFBfo9vlu/ekf7y88Cs9sUtvuYBL71iFpQcALI1I5jIiSQbqkUCrdmwqncgObipWmk1x89m03j0jCtxlfeCovOgBKwLRY6ZF4aEW9e9DNJ5zPuRkGvPJfR8pTYMwUZ/PQnFsWProYN0lwxFIVQnVJ8r5P5icZXn0oK/6b+EKrnH1r5r5CkRckqGqQfnhFSOn0Z/3POjG58SQL8JX4fb5dRNqYUTJb1hmG0+HSguycy4pnPGMEPbaZsVhDY4guSNPts+AVjfd5nMLRhZo8f5T+FTeWMFE4NivQPM+yMSPEeHifwdSOr+noQc+AQTTrn2eJBqV0arAY7LW0sJBWOMTkXyprzqdM7j17GxyVtuBetSEJz5DW9N7ofLRdyPC3cqKFGfDz2AyVSnyWmOewsCXHfAoBXtsonmEhih7cla7VPJu+nPBbRs9RmOcC3tGiTLlSOHlFPTcC5PQwBlHsCIlvWtdHJIgpB3OijkF9hsZyR4R7RQTBW/MBteB5JJZxxAhjbc+jK1bJH9SxSPLD6ODw6Q48903lOIlPv369uga4lOmRjlcILjEOI8iwkmn995XXPxluWyOHYd0YW91Jnzg6jwKLjUAO4G3KBv8YYup2uayd1pFCT08kCRTKtvOqReTkOf8EZXXbpfmHUv/zSFjt5UBj5CAZaY5DibgUmXNpxsAuM9R13J4Qy5bQQcu6zfuP2aI0yFe4Wnsp7P6uRZfvIlfHs48jdK5ayvEHC/5udXtJh6j3Fql0CnsaqeelQvaA+NPOA1JYWBKFSUO1F90ilciVH+DtkGiuVzsPaPSs7/p6mVwZHy8Uuw7OuIKkPa1YQiqpM0cFwwHQhCPk3fyj9MYQ//b9dNU4hjghntdaM1YbgXtoPYjA4EfYcvJ7F10P0nYLtIK3/OPfqvZWkP95BTHoN1LQDM1RiB7DjaqOeb5n/pga1iHtA5zC0P8RrqNuxHLUxMY1I6OjzIXmNbLfUWm3JimAZR9Is3r0XZfzz091LeJHvlIPhE1d5drryGg4v1A33UAT09P6PRB9JRlzhRx2yKFJCbzd99O1nbpgnlhFRmdW517vGTDORhwCReR+88zEgudJQgHVMaJjHxUbDJVAtVvJ+xyA+NHXavV7jZvi7dTUZ4vQfJa4WazeJHhyIXBoqbt7UjftewJRXwnnf58p8I2ULsyhqsy3uceQquA/QsUpTQsj9yUfmu1tm7xAyneJ1ejz+pRmqGfbCYtYH+BA896hHqTPnxzUHiu4olhhp2BYRu1BZKvpUxsdvkWSlbOdDg9zl/Ewb4kHXqQ6T5uHD1mhVJwtBGOOnoNPmAKl/6mN2bpSfYEaymhsSIwhqGFxejXjiNR/LPyL6bcZt5ZKFyChjSVoWj0XBbMpUPSuITEcHJnwp2DkAE3fr6qEy5aDotEaBvBuBnpdlAaNSCfuaeW6YifByY62Kj7mpoYmGvbcSKbmtj8Ak1bwmmxEw78MyLxkLnHgp/6RmiZgQX+6ZivhImsuiuZmMakr2TDP3qfoK7UfTjdGog5OUKlYTnfNEQ37CwpWdagbg2sJtOHMB2lNKmR1O0L5qAh3i0ThkpF7dMisZwEY/ZdgRa9GfIx3oW20hg5lIknTu+X30tsjc+sxPuJEU0QlC9uhiJC9cTXIoHoTtRmvKHhKG5q6skJ+RNOmDfzMzWdY/V12sfZSsdgNWxM42UGHYnU+zfPkMh8KOzfxSzIIj2aqAIoomshF+xT5ySbsl0xUmv2NZU02s5J0nOMQQueUAw+zBcvYSAsa/DWzk2uZPomoEUo1GY1UJRgwS6Yr7zgIgG2WKJAA/VqhDKsVRfuTTLbITK7j/ZCJP28WI88dWhaorCYFZIpAzilBSzPJD4TNw58mLjpvQPNSWeP3wfpDx3ryugWmRF2Uc3B8JyWq/CVcMee0a/w+tHmikzY/DijkXqY2FVaIzH2DZ9mr2fpCGMoTGmkR7bps9AUFqJtG5SHwLDuOiVr5R4OK400G2uOA5jSaBaQzDQulYKFOiiZi46058i580hnxzthsmlpwHyTLnr07S3YNRCU2WxOl//cotW+IKX3S2J1p1OXSliJZSSVwc0xr2v20shks+v0UwA5XJ/tXNwNtBkQ309+GUUT67gvZLPSCZ1NUqzY9SyjegWo+OkwO1WhkU7LDtKzmdlD/z6HB7ag58r6J2H74tMlT7bLtkjp5QvMWfpnZ5GlWBR0ARPD3EI89MpyzOSRFD2UkBnUq7WL1US4MlBo8omk0No9OBLvjdPDixd1uFdlp7PIw0eS6N41q8bCUyPmnuFmjkaMQSyH3GNq6G8WmWSHKai0A3zcpLsPpnTbQa6Auiebm02sh7/wdadbiRXoT2HNvz2hIEupBpUX2L0D8tDpqVSRWhjjtld9EC94OXKV1o6Oje4EQa0xSVjxybc49ts1QV5FNK2aTkcfhK3GnspaitsD8lcu1piSinq0TCnvviiNs1eXlemq41EauHkRDNYNEdIGUk6Ibt4eczIuaystdKqPjVJz0anrg8xP1zDoAvPXXuwd5eZ3wh2yeAN80vjVlt88sU+4AaAYNLrB8DN46pdFlc8j/CWT38FgkTXJ6SMdw5RoV5dgkKT/NKYlJ+fD2gUB1OVrDpPH+/XPjzOwqTE7E6zx3KzbVUzV2FWwN1aALsg=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 605, 'candidates_token_count': 26, 'total_token_count': 1262, 'prompt_tokens_details': [{'modality': 1, 'token_count': 605}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 26}], 'thoughts_token_count': 631, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -3.5586078350360575, 'model_name': 'gemini-2.5-pro'} id='run--bfffd630-4ea0-4abf-a2a8-5da807e01be6-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest sklearn/metrics/tests/test_roc_curve_gh_26121.py'}, 'id': 'bae46a37-c34a-4c9b-ad15-2bc917956ae8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 605, 'output_tokens': 26, 'total_tokens': 1262, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 631}}
2025-10-04 05:06:19,716 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: pytest sklearn/metrics/tests/test_roc_curve_gh_26121.py
2025-10-04 05:06:20,703 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-04 05:06:20,703 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
pytest sklearn/metrics/tests/tes
st_roc_curve_gh_26121.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.21, pytest-7.4.4, pluggy-1.5.0
rootdir: /testbed
configfile: setup.cfg
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

sklearn/metrics/tests/test_roc_curve_gh_26121.py [31mF[0m[31m                       [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________ test_roc_curve_with_probability_estimates ___________________[0m

    def test_roc_curve_with_probability_estimates():
        """Check that roc_curve thresholds are <= 1 for probability estimates.
    
        When y_score consists of probability estimates, the thresholds should not
        exceed 1.
        Non-regression test for gh-26121.
        """
        rng = np.random.RandomState(42)
        y_true = rng.randint(0, 2, size=10)
        y_score = rng.rand(10)
        _, _, thresholds = roc_curve(y_true, y_score)
>       assert np.all(thresholds <= 1)
[1m[31mE       assert False[0m
[1m[31mE        +  where False = <function all at 0x7f94325c0430>(array([1.96990985, 0.96990985, 0.21233911, 0.18182497, 0.15599452,\n       0.02058449]) <= 1)[0m
[1m[31mE        +    where <function all at 0x7f94325c0430> = np.all[0m

[1m[31msklearn/metrics/tests/test_roc_curve_gh_26121.py[0m:53: AssertionError
[31m============================== [31m[1m1 failed[0m[31m in 0.24s[0m[31m ===============================[0m

2025-10-04 05:06:26,658 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='pytest sklearn/metrics/tests/test_roc_curve_gh_26121.py\n============================= test session starts ==============================\nplatform linux -- Python 3.9.21, pytest-7.4.4, pluggy-1.5.0\nrootdir: /testbed\nconfigfile: setup.cfg\ncollecting ... \ncollected 1 item                                                               \n\nsklearn/metrics/tests/test_roc_curve_gh_26121.py F                       [100%]\n\n=================================== FAILURES ===================================\n__________________ test_roc_curve_with_probability_estimates ___________________\n\n    def test_roc_curve_with_probability_estimates():\n        """Check that roc_curve thresholds are <= 1 for probability estimates.\n    \n        When y_score consists of probability estimates, the thresholds should not\n        exceed 1.\n        Non-regression test for gh-26121.\n        """\n        rng = np.random.RandomState(42)\n        y_true = rng.randint(0, 2, size=10)\n        y_score = rng.rand(10)\n        _, _, thresholds = roc_curve(y_true, y_score)\n>       assert np.all(thresholds <= 1)\nE       assert False\nE        +  where False = <function all at 0x7f94325c0430>(array([1.96990985, 0.96990985, 0.21233911, 0.18182497, 0.15599452,\\n       0.02058449]) <= 1)\nE        +    where <function all at 0x7f94325c0430> = np.all\n\nsklearn/metrics/tests/test_roc_curve_gh_26121.py:53: AssertionError\n============================== 1 failed in 0.24s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1261, 'candidates_token_count': 480, 'total_token_count': 1860, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1890}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 480}], 'thoughts_token_count': 119, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.02659481962521871, 'model_name': 'gemini-2.5-pro'} id='run--c35eac58-48a1-42ed-911a-805ac75b7b52-0' usage_metadata={'input_tokens': 1261, 'output_tokens': 480, 'total_tokens': 1860, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 119}}
2025-10-04 05:06:45,432 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='pytest sklearn/metrics/tests/tes\nst_roc_curve_gh_26121.py\n\n\x1b[1m============================= test session starts ==============================\x1b[0m\nplatform linux -- Python 3.9.21, pytest-7.4.4, pluggy-1.5.0\nrootdir: /testbed\nconfigfile: setup.cfg\n\x1b[1mcollecting ... \x1b[0m\x1b[1m\ncollected 1 item                                                               \x1b[0m\n\nsklearn/metrics/tests/test_roc_curve_gh_26121.py \x1b[31mF\x1b[0m\x1b[31m                       [100%]\x1b[0m\n\n=================================== FAILURES ===================================\n\x1b[31m\x1b[1m__________________ test_roc_curve_with_probability_estimates ___________________\x1b[0m\n\n    def test_roc_curve_with_probability_estimates():\n        """Check that roc_curve thresholds are <= 1 for probability estimates.\n    \n        When y_score consists of probability estimates, the thresholds should not\n        exceed 1.\n        Non-regression test for gh-26121.\n        """\n        rng = np.random.RandomState(42)\n        y_true = rng.randint(0, 2, size=10)\n        y_score = rng.rand(10)\n        _, _, thresholds = roc_curve(y_true, y_score)\n>       assert np.all(thresholds <= 1)\n\x1b[1m\x1b[31mE       assert False\x1b[0m\n\x1b[1m\x1b[31mE        +  where False = <function all at 0x7f94325c0430>(array([1.96990985, 0.96990985, 0.21233911, 0.18182497, 0.15599452,\\n       0.02058449]) <= 1)\x1b[0m\n\x1b[1m\x1b[31mE        +    where <function all at 0x7f94325c0430> = np.all\x1b[0m\n\n\x1b[1m\x1b[31msklearn/metrics/tests/test_roc_curve_gh_26121.py\x1b[0m:53: AssertionError\n\x1b[31m============================== \x1b[31m\x1b[1m1 failed\x1b[0m\x1b[31m in 0.24s\x1b[0m\x1b[31m ===============================\x1b[0m' reproduced_bug_commands=['pytest sklearn/metrics/tests/test_roc_curve_gh_26121.py']
2025-10-04 05:06:45,432 - thread-139911184823872.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-10-04 05:06:45,432 - thread-139911184823872.app.docker.base_container - INFO - Closing persistent shell...
2025-10-04 05:06:45,533 - thread-139911184823872.app.docker.base_container - INFO - Cleaning up container and temporary files
