2025-10-06 15:33:38,315 - thread-139660780025408.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpppq4um8t/matplotlib
2025-10-06 15:33:38,315 - thread-139660780025408.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-10-06 15:33:38,315 - thread-139660780025408.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.matplotlib_1776_matplotlib-25332:v1
2025-10-06 15:37:46,675 - thread-139660780025408.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_6c6b32aefd
2025-10-06 15:37:46,776 - thread-139660780025408.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_6c6b32aefd
2025-10-06 15:38:00,427 - thread-139660780025408.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-10-06 15:38:00,602 - thread-139660780025408.app.docker.base_container - INFO - Persistent shell is ready
2025-10-06 15:38:00,602 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-10-06 15:38:00,725 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:38:00,725 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 15:38:00,725 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-10-06 15:38:00,851 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:38:00,851 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 15:38:00,851 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .
2025-10-06 15:38:42,801 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:38:42,801 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

Obtaining file:///testbed
  Installing build dependencies ... [?25l- \ | / - \ done
[?25h  Checking if build backend supports build_editable ... [?25ldone
[?25h  Getting requirements to build editable ... [?25l- \ | done
[?25h  Preparing editable metadata (pyproject.toml) ... [?25l- \ done
[?25hRequirement already satisfied: contourpy>=1.0.1 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (1.1.0)
Requirement already satisfied: cycler>=0.10 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (0.11.0)
Requirement already satisfied: fonttools>=4.22.0 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (4.42.1)
Requirement already satisfied: kiwisolver>=1.0.1 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (1.4.5)
Requirement already satisfied: numpy>=1.21 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (1.25.2)
Requirement already satisfied: packaging>=20.0 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (23.1)
Requirement already satisfied: pillow>=6.2.0 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (10.0.0)
Requirement already satisfied: pyparsing>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (3.0.9)
Requirement already satisfied: python-dateutil>=2.7 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (2.8.2)
Requirement already satisfied: setuptools_scm>=7 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from matplotlib==3.8.0.dev452+g66ba515e6) (7.1.0)
Requirement already satisfied: six>=1.5 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from python-dateutil>=2.7->matplotlib==3.8.0.dev452+g66ba515e6) (1.16.0)
Requirement already satisfied: setuptools in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from setuptools_scm>=7->matplotlib==3.8.0.dev452+g66ba515e6) (68.1.2)
Requirement already satisfied: typing-extensions in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from setuptools_scm>=7->matplotlib==3.8.0.dev452+g66ba515e6) (4.7.1)
Building wheels for collected packages: matplotlib
  Building editable for matplotlib (pyproject.toml) ... [?25l- \ | / - \ | / - \ | / - \ | / - \ | / - \ | / - \ | / - \ | / - \ | / - \ | / - \ | / - \ | done
[?25h  Created wheel for matplotlib: filename=matplotlib-3.8.0.dev452+g66ba515e6-0.editable-cp311-cp311-linux_x86_64.whl size=23372 sha256=df6604e5dfd1d44b19aa7812cb02129d54169e80ea2e77a63682be5c5fe84c96
  Stored in directory: /tmp/pip-ephem-wheel-cache-kb5bz_8o/wheels/49/5f/4f/01b7d31ea6ddac9643da788242d33e5fd3467d95d17b032c6b
Successfully built matplotlib
Installing collected packages: matplotlib
  Attempting uninstall: matplotlib
    Found existing installation: matplotlib 3.8.0.dev452+g66ba515e67
    Uninstalling matplotlib-3.8.0.dev452+g66ba515e67:
      Successfully uninstalled matplotlib-3.8.0.dev452+g66ba515e67
Successfully installed matplotlib-3.8.0.dev452+g66ba515e6
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-10-06 15:38:42,845 - thread-139660780025408.app.lang_graph.nodes.issue_bug_reproduction_context_message_node - DEBUG - Sending query to context provider subgraph:
Issue title:
[Bug]: Unable to pickle figure with aligned labels

Issue description: 
### Bug summary

 Unable to pickle figure after calling `align_labels()`

### Code for reproduction

```python
import matplotlib.pyplot as plt
import pickle

fig = plt.figure()
ax1 = fig.add_subplot(211)
ax2 = fig.add_subplot(212)
time=[0,1,2,3,4]
speed=[40000,4300,4500,4700,4800]
acc=[10,11,12,13,14]
ax1.plot(time,speed)
ax1.set_ylabel('speed')
ax2.plot(time,acc)
ax2.set_ylabel('acc')

fig.align_labels() ##pickling works after removing this line 

pickle.dumps(fig)
plt.show()
```


### Actual outcome
```
align.py", line 16
pickle.dumps(fig)
TypeError: cannot pickle 'weakref.ReferenceType' object
```
### Expected outcome

Pickling successful

### Additional information

_No response_

### Operating system

Windows

### Matplotlib Version

3.7.0

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

None

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-10-06 15:38:42,846 - thread-139660780025408.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Enter context retrieval subgraph
2025-10-06 15:38:42,847 - thread-139660780025408.app.lang_graph.nodes.context_query_message_node - DEBUG - Sending query to ContextProviderNode:
content='Issue title:\n[Bug]: Unable to pickle figure with aligned labels\n\nIssue description: \n### Bug summary\n\n Unable to pickle figure after calling `align_labels()`\n\n### Code for reproduction\n\n```python\nimport matplotlib.pyplot as plt\nimport pickle\n\nfig = plt.figure()\nax1 = fig.add_subplot(211)\nax2 = fig.add_subplot(212)\ntime=[0,1,2,3,4]\nspeed=[40000,4300,4500,4700,4800]\nacc=[10,11,12,13,14]\nax1.plot(time,speed)\nax1.set_ylabel(\'speed\')\nax2.plot(time,acc)\nax2.set_ylabel(\'acc\')\n\nfig.align_labels() ##pickling works after removing this line \n\npickle.dumps(fig)\nplt.show()\n```\n\n\n### Actual outcome\n```\nalign.py", line 16\npickle.dumps(fig)\nTypeError: cannot pickle \'weakref.ReferenceType\' object\n```\n### Expected outcome\n\nPickling successful\n\n### Additional information\n\n_No response_\n\n### Operating system\n\nWindows\n\n### Matplotlib Version\n\n3.7.0\n\n### Matplotlib Backend\n\n_No response_\n\n### Python version\n\n_No response_\n\n### Jupyter version\n\n_No response_\n\n### Installation\n\nNone\n\nIssue comments:\n\n\nOBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,\nincluding ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.\n\n<reasoning>\n1. Analyze bug characteristics:\n   - Core functionality being tested\n   - Input parameters and configurations\n   - Expected error conditions\n   - Environmental dependencies\n\n2. Search requirements:\n   - Required imports and dependencies\n   - Test files exercising similar functionality\n   - Mock/fixture setup patterns\n   - Assertion styles\n   - Error handling tests\n\n3. Focus areas:\n   - All necessary imports (standard library, testing frameworks, mocking utilities)\n   - Dependencies and third-party packages\n   - Test setup and teardown\n   - Mock object configuration\n   - Network/external service simulation\n   - Error condition verification\n</reasoning>\n\nREQUIREMENTS:\n- Return 5 complete, self-contained test cases most similar to bug scenario\n- Must include ALL necessary imports at the start of each test file\n- Must include full test method implementation\n- Must include ALL mock/fixture setup\n- Must include helper functions used by test\n- Must preserve exact file paths and line numbers\n\n<examples>\n<example id="database-timeout">\n<bug>\ndb.execute("SELECT * FROM users").fetchall() \nraises ConnectionTimeout when load is high\n</bug>\n\n<ideal_test_match>\n# File: tests/test_database.py\nimport pytest\nfrom unittest.mock import Mock, patch\nfrom database.exceptions import ConnectionTimeout\nfrom database.models import QueryResult\nfrom database.client import DatabaseClient\n\nclass TestDatabaseTimeout:\n    @pytest.fixture\n    def mock_db_connection(self):\n        conn = Mock()\n        conn.execute.side_effect = [\n            ConnectionTimeout("Connection timed out"),\n            QueryResult(["user1", "user2"])  # Second try succeeds\n        ]\n        return conn\n        \n    def test_handle_timeout_during_query(self, mock_db_connection):\n        # Complete test showing timeout scenario\n        # Including retry logic verification\n        # With all necessary assertions\n</ideal_test_match>\n</example>\n\n<example id="file-permission">\n<bug>\nFileProcessor(\'/root/data.txt\').process() \nfails with PermissionError\n</bug>\n\n<ideal_test_match>\n# File: tests/test_file_processor.py\nimport os\nimport pytest\nfrom unittest.mock import patch, mock_open\nfrom file_processor import FileProcessor\nfrom file_processor.exceptions import ProcessingError\n\nclass TestFilePermissions:\n    @patch(\'os.access\')\n    @patch(\'builtins.open\')\n    def test_file_permission_denied(self, mock_open, mock_access):\n        # Full test setup with mocked file system\n        # Permission denial simulation\n        # Error handling verification\n</ideal_test_match>\n</example>\n\nSearch priority:\n1. Tests of exact same functionality (including import patterns)\n2. Tests with similar error conditions\n3. Tests with comparable mocking patterns\n4. Tests demonstrating similar assertions\n\nFind the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.\n' additional_kwargs={} response_metadata={}
2025-10-06 15:38:53,938 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I have initiated the search by looking for tests related to pickling, as the bug report indicates a problem with `pickle.dumps(fig)`. The most relevant file appears to be `test_pickle.py`, which likely contains tests for pickling various Matplotlib objects. I will now examine the contents of this file to find test cases that are similar to the user's report.\n" additional_kwargs={'function_call': {'name': 'find_ast_node_with_type_in_file_with_basename', 'arguments': '{"type": "function_definition", "basename": "test_pickle.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 22926, 'candidates_token_count': 107, 'total_token_count': 23723, 'prompt_tokens_details': [{'modality': 1, 'token_count': 22926}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 107}], 'thoughts_token_count': 690, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.0122339836904937, 'model_name': 'gemini-2.5-pro'} id='run--6bc0b7a9-fed0-45cc-a575-af26ea90cf43-0' tool_calls=[{'name': 'find_ast_node_with_type_in_file_with_basename', 'args': {'type': 'function_definition', 'basename': 'test_pickle.py'}, 'id': 'cebc9e36-0621-4a64-a7a3-3c25fe6dddf6', 'type': 'tool_call'}] usage_metadata={'input_tokens': 22926, 'output_tokens': 107, 'total_tokens': 23723, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 690}}
2025-10-06 15:38:59,471 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I've found several test functions in `test_pickle.py` that involve pickling, which is at the core of the reported bug. The `test_polar` function is a good starting point, as it pickles a figure with a polar subplot. To find more relevant examples, I will read the entire `test_pickle.py` file to identify other tests that pickle Matplotlib figures, which will help in understanding how pickling is tested across different figure configurations." additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_pickle.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 23765, 'candidates_token_count': 122, 'total_token_count': 24168, 'cached_content_token_count': 21634, 'prompt_tokens_details': [{'modality': 1, 'token_count': 23765}], 'cache_tokens_details': [{'modality': 1, 'token_count': 21634}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 122}], 'thoughts_token_count': 281}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2365912609413022, 'model_name': 'gemini-2.5-pro'} id='run--fcea926e-8a8a-48b0-8b38-4846179d26f6-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_pickle.py'}, 'id': '48418522-ccaa-4cb4-8fe2-7c830ba35b03', 'type': 'tool_call'}] usage_metadata={'input_tokens': 23765, 'output_tokens': 122, 'total_tokens': 24168, 'input_token_details': {'cache_read': 21634}, 'output_token_details': {'reasoning': 281}}
2025-10-06 15:39:08,196 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have analyzed the `test_pickle.py` file and identified several test cases that are relevant to the reported bug. The `test_complete` and `test_pickle_load_from_subprocess` tests are particularly interesting because they involve creating complex figures with multiple subplots, pickling them, and then verifying the unpickled figures. To further refine my search, I will now look for any tests that specifically use the `align_labels` function, as this is the function that triggers the pickling error in the bug report.' additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "align_labels", "basename": "test_figure.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 27855, 'candidates_token_count': 138, 'total_token_count': 28535, 'cached_content_token_count': 23653, 'prompt_tokens_details': [{'modality': 1, 'token_count': 27855}], 'cache_tokens_details': [{'modality': 1, 'token_count': 23653}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 138}], 'thoughts_token_count': 542}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5632971058721128, 'model_name': 'gemini-2.5-pro'} id='run--5db84dda-3e5b-4a9d-b645-7c72c804512d-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'align_labels', 'basename': 'test_figure.py'}, 'id': 'e5b6f737-eb6e-4d54-8393-ae4883916e18', 'type': 'tool_call'}] usage_metadata={'input_tokens': 27855, 'output_tokens': 138, 'total_tokens': 28535, 'input_token_details': {'cache_read': 23653}, 'output_token_details': {'reasoning': 542}}
2025-10-06 15:39:15,220 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I have found tests for `align_labels` in `test_figure.py` and pickling tests in `test_pickle.py`, but no single test combines both. The bug occurs when `align_labels()` is called before pickling, so the most relevant tests would involve pickling a figure after some form of layout adjustment. I will now search for tests that use `constrained_layout` or `tight_layout` in `test_pickle.py`, as these are often used with `align_labels` and may affect the figure's properties in a similar way." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "constrained_layout", "basename": "test_pickle.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 29174, 'candidates_token_count': 148, 'total_token_count': 29676, 'cached_content_token_count': 27543, 'prompt_tokens_details': [{'modality': 1, 'token_count': 29174}], 'cache_tokens_details': [{'modality': 1, 'token_count': 27543}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 148}], 'thoughts_token_count': 354}, 'finish_reason': 'STOP', 'avg_logprobs': -0.37893663870321737, 'model_name': 'gemini-2.5-pro'} id='run--e2e4a760-683d-4992-83e6-438606633a6c-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'constrained_layout', 'basename': 'test_pickle.py'}, 'id': '9dd7c061-0aad-48d4-a838-d400c323f901', 'type': 'tool_call'}] usage_metadata={'input_tokens': 29174, 'output_tokens': 148, 'total_tokens': 29676, 'input_token_details': {'cache_read': 27543}, 'output_token_details': {'reasoning': 354}}
2025-10-06 15:39:22,081 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content="I've searched for tests that use `constrained_layout` within `test_pickle.py` and found no results, so I will now broaden my search to include `tight_layout`. This may reveal test cases that, while not identical to the user's scenario, still involve pickling a figure after a layout adjustment, which could provide relevant insights into the bug." additional_kwargs={'function_call': {'name': 'find_ast_node_with_text_in_file_with_basename', 'arguments': '{"text": "tight_layout", "basename": "test_pickle.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 29352, 'candidates_token_count': 104, 'total_token_count': 29842, 'cached_content_token_count': 27518, 'prompt_tokens_details': [{'modality': 1, 'token_count': 29352}], 'cache_tokens_details': [{'modality': 1, 'token_count': 27518}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 104}], 'thoughts_token_count': 386}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5723119882436899, 'model_name': 'gemini-2.5-pro'} id='run--d32e5691-63ea-4c2c-9955-c7021ff975a8-0' tool_calls=[{'name': 'find_ast_node_with_text_in_file_with_basename', 'args': {'text': 'tight_layout', 'basename': 'test_pickle.py'}, 'id': 'f20cbbc5-9ffc-40f1-a1fe-6e06c0828b14', 'type': 'tool_call'}] usage_metadata={'input_tokens': 29352, 'output_tokens': 104, 'total_tokens': 29842, 'input_token_details': {'cache_read': 27518}, 'output_token_details': {'reasoning': 386}}
2025-10-06 15:39:50,456 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have searched for tests that use `tight_layout` within `test_pickle.py` and found no results. Since there are no existing tests that combine pickling with `align_labels`, `constrained_layout`, or `tight_layout`, I have gathered five relevant test cases from `test_pickle.py` that demonstrate how pickling is tested for various figure configurations. These examples showcase the standard practices for testing figure serialization in the library and provide a solid foundation for creating a new test that reproduces the reported bug.\n\n\n<execute_bash>\n<tool_code>\nprint(default_api.read_code_with_relative_path(relative_path=\'lib/matplotlib/tests/test_pickle.py\', start_line=1, end_line=285))\n</tool_code>\n</execute_bash>\n```\n# File: lib/matplotlib/tests/test_pickle.py\nfrom io import BytesIO\nimport ast\nimport pickle\n\nimport numpy as np\nimport pytest\n\nimport matplotlib as mpl\nfrom matplotlib import cm\nfrom matplotlib.testing import subprocess_run_helper\nfrom matplotlib.testing.decorators import check_figures_equal\nfrom matplotlib.dates import rrulewrapper\nfrom matplotlib.lines import VertexSelector\nimport matplotlib.pyplot as plt\nimport matplotlib.transforms as mtransforms\nimport matplotlib.figure as mfigure\nfrom mpl_toolkits.axes_grid1 import parasite_axes\n\n\ndef test_simple():\n    fig = plt.figure()\n    pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n\n    ax = plt.subplot(121)\n    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n\n    ax = plt.axes(projection=\'polar\')\n    plt.plot(np.arange(10), label=\'foobar\')\n    plt.legend()\n\n    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n\n#    ax = plt.subplot(121, projection=\'hammer\')\n#    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n\n    plt.figure()\n    plt.bar(x=np.arange(10), height=np.arange(10))\n    pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)\n\n    fig = plt.figure()\n    ax = plt.axes()\n    plt.plot(np.arange(10))\n    ax.set_yscale(\'log\')\n    pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n\n\ndef _generate_complete_test_figure(fig_ref):\n    fig_ref.set_size_inches((10, 6))\n    plt.figure(fig_ref)\n\n    plt.suptitle(\'Can you fit any more in a figure?\')\n\n    # make some arbitrary data\n    x, y = np.arange(8), np.arange(10)\n    data = u = v = np.linspace(0, 10, 80).reshape(10, 8)\n    v = np.sin(v * -0.6)\n\n    # Ensure lists also pickle correctly.\n    plt.subplot(3, 3, 1)\n    plt.plot(list(range(10)))\n\n    plt.subplot(3, 3, 2)\n    plt.contourf(data, hatches=[\'//\', \'ooo\'])\n    plt.colorbar()\n\n    plt.subplot(3, 3, 3)\n    plt.pcolormesh(data)\n\n    plt.subplot(3, 3, 4)\n    plt.imshow(data)\n\n    plt.subplot(3, 3, 5)\n    plt.pcolor(data)\n\n    ax = plt.subplot(3, 3, 6)\n    ax.set_xlim(0, 7)\n    ax.set_ylim(0, 9)\n    plt.streamplot(x, y, u, v)\n\n    ax = plt.subplot(3, 3, 7)\n    ax.set_xlim(0, 7)\n    ax.set_ylim(0, 9)\n    plt.quiver(x, y, u, v)\n\n    plt.subplot(3, 3, 8)\n    plt.scatter(x, x ** 2, label=\'$x^2$\')\n    plt.legend(loc=\'upper left\')\n\n    plt.subplot(3, 3, 9)\n    plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)\n\n\n@mpl.style.context("default")\n@check_figures_equal(extensions=["png"])\ndef test_complete(fig_test, fig_ref):\n    _generate_complete_test_figure(fig_ref)\n    # plotting is done, now test its pickle-ability\n    pkl = BytesIO()\n    pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)\n    loaded = pickle.loads(pkl.getbuffer())\n    loaded.canvas.draw()\n\n    fig_test.set_size_inches(loaded.get_size_inches())\n    fig_test.figimage(loaded.canvas.renderer.buffer_rgba())\n\n    plt.close(loaded)\n\n\ndef _pickle_load_subprocess():\n    import os\n    import pickle\n\n    path = os.environ[\'PICKLE_FILE_PATH\']\n\n    with open(path, \'rb\') as blob:\n        fig = pickle.load(blob)\n\n    print(str(pickle.dumps(fig)))\n\n\n@mpl.style.context("default")\n@check_figures_equal(extensions=[\'png\'])\ndef test_pickle_load_from_subprocess(fig_test, fig_ref, tmp_path):\n    _generate_complete_test_figure(fig_ref)\n\n    fp = tmp_path / \'sinus.pickle\'\n    assert not fp.exists()\n\n    with fp.open(\'wb\') as file:\n        pickle.dump(fig_ref, file, pickle.HIGHEST_PROTOCOL)\n    assert fp.exists()\n\n    proc = subprocess_run_helper(\n        _pickle_load_subprocess,\n        timeout=60,\n        extra_env={\'PICKLE_FILE_PATH\': str(fp)}\n    )\n\n    loaded_fig = pickle.loads(ast.literal_eval(proc.stdout))\n\n    loaded_fig.canvas.draw()\n\n    fig_test.set_size_inches(loaded_fig.get_size_inches())\n    fig_test.figimage(loaded_fig.canvas.renderer.buffer_rgba())\n\n    plt.close(loaded_fig)\n\n\ndef test_shared():\n    fig, axs = plt.subplots(2, sharex=True)\n    fig = pickle.loads(pickle.dumps(fig))\n    fig.axes[0].set_xlim(10, 20)\n    assert fig.axes[1].get_xlim() == (10, 20)\n\n\ndef test_inset_and_secondary():\n    fig, ax = plt.subplots()\n    ax.inset_axes([.1, .1, .3, .3])\n    ax.secondary_xaxis("top", functions=(np.square, np.sqrt))\n    pickle.loads(pickle.dumps(fig))\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 5368, 'end_index': 5759, 'uri': 'https://github.com/Steffie254/fraud1', 'title': '', 'license_': ''}, {'start_index': 5654, 'end_index': 5966, 'uri': 'https://github.com/matplotlib/matplotlib', 'title': '', 'license_': ''}, {'start_index': 5818, 'end_index': 6544, 'uri': 'https://www.programcreek.com/python/example/102292/matplotlib.pyplot.bar', 'title': '', 'license_': ''}, {'start_index': 6400, 'end_index': 6730, 'uri': 'https://github.com/Steffie254/fraud1', 'title': '', 'license_': ''}, {'start_index': 6702, 'end_index': 7117, 'uri': 'https://github.com/matplotlib/matplotlib', 'title': '', 'license_': ''}, {'start_index': 7039, 'end_index': 7547, 'uri': 'https://github.com/matplotlib/matplotlib', 'license_': 'Python-2.0', 'title': ''}, {'start_index': 7745, 'end_index': 8077, 'uri': 'https://github.com/matplotlib/matplotlib', 'title': '', 'license_': ''}, {'start_index': 7943, 'end_index': 9042, 'uri': 'https://github.com/Steffie254/fraud1', 'title': '', 'license_': ''}, {'start_index': 9034, 'end_index': 9410, 'uri': 'https://github.com/matplotlib/matplotlib', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 29486, 'candidates_token_count': 1668, 'total_token_count': 32355, 'cached_content_token_count': 27492, 'prompt_tokens_details': [{'modality': 1, 'token_count': 29486}], 'cache_tokens_details': [{'modality': 1, 'token_count': 27492}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 1668}], 'thoughts_token_count': 1201}, 'finish_reason': 'STOP', 'avg_logprobs': -0.09863036999599539, 'model_name': 'gemini-2.5-pro'} id='run--71683ca7-adc5-40a9-a23d-a3a45b3b2234-0' usage_metadata={'input_tokens': 29486, 'output_tokens': 1668, 'total_tokens': 32355, 'input_token_details': {'cache_read': 27492}, 'output_token_details': {'reasoning': 1201}}
2025-10-06 15:39:50,456 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 15:39:50,457 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
[Bug]: Unable to pickle figure with aligned labels

Issue description: 
### Bug summary

 Unable to pickle figure after calling `align_labels()`

### Code for reproduction

```python
import matplotlib.pyplot as plt
import pickle

fig = plt.figure()
ax1 = fig.add_subplot(211)
ax2 = fig.add_subplot(212)
time=[0,1,2,3,4]
speed=[40000,4300,4500,4700,4800]
acc=[10,11,12,13,14]
ax1.plot(time,speed)
ax1.set_ylabel('speed')
ax2.plot(time,acc)
ax2.set_ylabel('acc')

fig.align_labels() ##pickling works after removing this line 

pickle.dumps(fig)
plt.show()
```


### Actual outcome
```
align.py", line 16
pickle.dumps(fig)
TypeError: cannot pickle 'weakref.ReferenceType' object
```
### Expected outcome

Pickling successful

### Additional information

_No response_

### Operating system

Windows

### Matplotlib Version

3.7.0

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

None

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_pickle.py
Line number range: 1 - 284
Content:
1. from io import BytesIO
2. import ast
3. import pickle
4. 
5. import numpy as np
6. import pytest
7. 
8. import matplotlib as mpl
9. from matplotlib import cm
10. from matplotlib.testing import subprocess_run_helper
11. from matplotlib.testing.decorators import check_figures_equal
12. from matplotlib.dates import rrulewrapper
13. from matplotlib.lines import VertexSelector
14. import matplotlib.pyplot as plt
15. import matplotlib.transforms as mtransforms
16. import matplotlib.figure as mfigure
17. from mpl_toolkits.axes_grid1 import parasite_axes
18. 
19. 
20. def test_simple():
21.     fig = plt.figure()
22.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
23. 
24.     ax = plt.subplot(121)
25.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
26. 
27.     ax = plt.axes(projection='polar')
28.     plt.plot(np.arange(10), label='foobar')
29.     plt.legend()
30. 
31.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
32. 
33. #    ax = plt.subplot(121, projection='hammer')
34. #    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
35. 
36.     plt.figure()
37.     plt.bar(x=np.arange(10), height=np.arange(10))
38.     pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)
39. 
40.     fig = plt.figure()
41.     ax = plt.axes()
42.     plt.plot(np.arange(10))
43.     ax.set_yscale('log')
44.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
45. 
46. 
47. def _generate_complete_test_figure(fig_ref):
48.     fig_ref.set_size_inches((10, 6))
49.     plt.figure(fig_ref)
50. 
51.     plt.suptitle('Can you fit any more in a figure?')
52. 
53.     # make some arbitrary data
54.     x, y = np.arange(8), np.arange(10)
55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)
56.     v = np.sin(v * -0.6)
57. 
58.     # Ensure lists also pickle correctly.
59.     plt.subplot(3, 3, 1)
60.     plt.plot(list(range(10)))
61. 
62.     plt.subplot(3, 3, 2)
63.     plt.contourf(data, hatches=['//', 'ooo'])
64.     plt.colorbar()
65. 
66.     plt.subplot(3, 3, 3)
67.     plt.pcolormesh(data)
68. 
69.     plt.subplot(3, 3, 4)
70.     plt.imshow(data)
71. 
72.     plt.subplot(3, 3, 5)
73.     plt.pcolor(data)
74. 
75.     ax = plt.subplot(3, 3, 6)
76.     ax.set_xlim(0, 7)
77.     ax.set_ylim(0, 9)
78.     plt.streamplot(x, y, u, v)
79. 
80.     ax = plt.subplot(3, 3, 7)
81.     ax.set_xlim(0, 7)
82.     ax.set_ylim(0, 9)
83.     plt.quiver(x, y, u, v)
84. 
85.     plt.subplot(3, 3, 8)
86.     plt.scatter(x, x ** 2, label='$x^2$')
87.     plt.legend(loc='upper left')
88. 
89.     plt.subplot(3, 3, 9)
90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)
91. 
92. 
93. @mpl.style.context("default")
94. @check_figures_equal(extensions=["png"])
95. def test_complete(fig_test, fig_ref):
96.     _generate_complete_test_figure(fig_ref)
97.     # plotting is done, now test its pickle-ability
98.     pkl = BytesIO()
99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)
100.     loaded = pickle.loads(pkl.getbuffer())
101.     loaded.canvas.draw()
102. 
103.     fig_test.set_size_inches(loaded.get_size_inches())
104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())
105. 
106.     plt.close(loaded)
107. 
108. 
109. def _pickle_load_subprocess():
110.     import os
111.     import pickle
112. 
113.     path = os.environ['PICKLE_FILE_PATH']
114. 
115.     with open(path, 'rb') as blob:
116.         fig = pickle.load(blob)
117. 
118.     print(str(pickle.dumps(fig)))
119. 
120. 
121. @mpl.style.context("default")
122. @check_figures_equal(extensions=['png'])
123. def test_pickle_load_from_subprocess(fig_test, fig_ref, tmp_path):
124.     _generate_complete_test_figure(fig_ref)
125. 
126.     fp = tmp_path / 'sinus.pickle'
127.     assert not fp.exists()
128. 
129.     with fp.open('wb') as file:
130.         pickle.dump(fig_ref, file, pickle.HIGHEST_PROTOCOL)
131.     assert fp.exists()
132. 
133.     proc = subprocess_run_helper(
134.         _pickle_load_subprocess,
135.         timeout=60,
136.         extra_env={'PICKLE_FILE_PATH': str(fp)}
137.     )
138. 
139.     loaded_fig = pickle.loads(ast.literal_eval(proc.stdout))
140. 
141.     loaded_fig.canvas.draw()
142. 
143.     fig_test.set_size_inches(loaded_fig.get_size_inches())
144.     fig_test.figimage(loaded_fig.canvas.renderer.buffer_rgba())
145. 
146.     plt.close(loaded_fig)
147. 
148. 
149. def test_gcf():
150.     fig = plt.figure("a label")
151.     buf = BytesIO()
152.     pickle.dump(fig, buf, pickle.HIGHEST_PROTOCOL)
153.     plt.close("all")
154.     assert plt._pylab_helpers.Gcf.figs == {}  # No figures must be left.
155.     fig = pickle.loads(buf.getbuffer())
156.     assert plt._pylab_helpers.Gcf.figs != {}  # A manager is there again.
157.     assert fig.get_label() == "a label"
158. 
159. 
160. def test_no_pyplot():
161.     # tests pickle-ability of a figure not created with pyplot
162.     from matplotlib.backends.backend_pdf import FigureCanvasPdf
163.     fig = mfigure.Figure()
164.     _ = FigureCanvasPdf(fig)
165.     ax = fig.add_subplot(1, 1, 1)
166.     ax.plot([1, 2, 3], [1, 2, 3])
167.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
168. 
169. 
170. def test_renderer():
171.     from matplotlib.backends.backend_agg import RendererAgg
172.     renderer = RendererAgg(10, 20, 30)
173.     pickle.dump(renderer, BytesIO())
174. 
175. 
176. def test_image():
177.     # Prior to v1.4.0 the Image would cache data which was not picklable
178.     # once it had been drawn.
179.     from matplotlib.backends.backend_agg import new_figure_manager
180.     manager = new_figure_manager(1000)
181.     fig = manager.canvas.figure
182.     ax = fig.add_subplot(1, 1, 1)
183.     ax.imshow(np.arange(12).reshape(3, 4))
184.     manager.canvas.draw()
185.     pickle.dump(fig, BytesIO())
186. 
187. 
188. def test_polar():
189.     plt.subplot(polar=True)
190.     fig = plt.gcf()
191.     pf = pickle.dumps(fig)
192.     pickle.loads(pf)
193.     plt.draw()
194. 
195. 
196. class TransformBlob:
197.     def __init__(self):
198.         self.identity = mtransforms.IdentityTransform()
199.         self.identity2 = mtransforms.IdentityTransform()
200.         # Force use of the more complex composition.
201.         self.composite = mtransforms.CompositeGenericTransform(
202.             self.identity,
203.             self.identity2)
204.         # Check parent -> child links of TransformWrapper.
205.         self.wrapper = mtransforms.TransformWrapper(self.composite)
206.         # Check child -> parent links of TransformWrapper.
207.         self.composite2 = mtransforms.CompositeGenericTransform(
208.             self.wrapper,
209.             self.identity)
210. 
211. 
212. def test_transform():
213.     obj = TransformBlob()
214.     pf = pickle.dumps(obj)
215.     del obj
216. 
217.     obj = pickle.loads(pf)
218.     # Check parent -> child links of TransformWrapper.
219.     assert obj.wrapper._child == obj.composite
220.     # Check child -> parent links of TransformWrapper.
221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]
222.     # Check input and output dimensions are set as expected.
223.     assert obj.wrapper.input_dims == obj.composite.input_dims
224.     assert obj.wrapper.output_dims == obj.composite.output_dims
225. 
226. 
227. def test_rrulewrapper():
228.     r = rrulewrapper(2)
229.     try:
230.         pickle.loads(pickle.dumps(r))
231.     except RecursionError:
232.         print('rrulewrapper pickling test failed')
233.         raise
234. 
235. 
236. def test_shared():
237.     fig, axs = plt.subplots(2, sharex=True)
238.     fig = pickle.loads(pickle.dumps(fig))
239.     fig.axes[0].set_xlim(10, 20)
240.     assert fig.axes[1].get_xlim() == (10, 20)
241. 
242. 
243. def test_inset_and_secondary():
244.     fig, ax = plt.subplots()
245.     ax.inset_axes([.1, .1, .3, .3])
246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))
247.     pickle.loads(pickle.dumps(fig))
248. 
249. 
250. @pytest.mark.parametrize("cmap", cm._colormaps.values())
251. def test_cmap(cmap):
252.     pickle.dumps(cmap)
253. 
254. 
255. def test_unpickle_canvas():
256.     fig = mfigure.Figure()
257.     assert fig.canvas is not None
258.     out = BytesIO()
259.     pickle.dump(fig, out)
260.     out.seek(0)
261.     fig2 = pickle.load(out)
262.     assert fig2.canvas is not None
263. 
264. 
265. def test_mpl_toolkits():
266.     ax = parasite_axes.host_axes([0, 0, 1, 1])
267.     assert type(pickle.loads(pickle.dumps(ax))) == parasite_axes.HostAxes
268. 
269. 
270. def test_standard_norm():
271.     assert type(pickle.loads(pickle.dumps(mpl.colors.LogNorm()))) \
272.         == mpl.colors.LogNorm
273. 
274. 
275. def test_dynamic_norm():
276.     logit_norm_instance = mpl.colors.make_norm_from_scale(
277.         mpl.scale.LogitScale, mpl.colors.Normalize)()
278.     assert type(pickle.loads(pickle.dumps(logit_norm_instance))) \
279.         == type(logit_norm_instance)
280. 
281. 
282. def test_vertexselector():
283.     line, = plt.plot([0, 1], picker=True)
284.     pickle.loads(pickle.dumps(VertexSelector(line)))

File: lib/matplotlib/tests/test_figure.py
Line number range: 69 - 101
Content:
def test_align_labels_stray_axes():
    fig, axs = plt.subplots(2, 2)
    for nn, ax in enumerate(axs.flat):
        ax.set_xlabel('Boo')
        ax.set_xlabel('Who')
        ax.plot(np.arange(4)**nn, np.arange(4)**nn)
    fig.align_ylabels()
    fig.align_xlabels()
    fig.draw_without_rendering()
    xn = np.zeros(4)
    yn = np.zeros(4)
    for nn, ax in enumerate(axs.flat):
        yn[nn] = ax.xaxis.label.get_position()[1]
        xn[nn] = ax.yaxis.label.get_position()[0]
    np.testing.assert_allclose(xn[:2], xn[2:])
    np.testing.assert_allclose(yn[::2], yn[1::2])

    fig, axs = plt.subplots(2, 2, constrained_layout=True)
    for nn, ax in enumerate(axs.flat):
        ax.set_xlabel('Boo')
        ax.set_xlabel('Who')
        pc = ax.pcolormesh(np.random.randn(10, 10))
    fig.colorbar(pc, ax=ax)
    fig.align_ylabels()
    fig.align_xlabels()
    fig.draw_without_rendering()
    xn = np.zeros(4)
    yn = np.zeros(4)
    for nn, ax in enumerate(axs.flat):
        yn[nn] = ax.xaxis.label.get_position()[1]
        xn[nn] = ax.yaxis.label.get_position()[0]
    np.testing.assert_allclose(xn[:2], xn[2:])
    np.testing.assert_allclose(yn[::2], yn[1::2])

File: lib/matplotlib/tests/test_figure.py
Line number range: 28 - 66
Content:
@image_comparison(['figure_align_labels'], extensions=['png', 'svg'],
                  tol=0 if platform.machine() == 'x86_64' else 0.01)
def test_align_labels():
    fig = plt.figure(layout='tight')
    gs = gridspec.GridSpec(3, 3)

    ax = fig.add_subplot(gs[0, :2])
    ax.plot(np.arange(0, 1e6, 1000))
    ax.set_ylabel('Ylabel0 0')
    ax = fig.add_subplot(gs[0, -1])
    ax.plot(np.arange(0, 1e4, 100))

    for i in range(3):
        ax = fig.add_subplot(gs[1, i])
        ax.set_ylabel('YLabel1 %d' % i)
        ax.set_xlabel('XLabel1 %d' % i)
        if i in [0, 2]:
            ax.xaxis.set_label_position("top")
            ax.xaxis.tick_top()
        if i == 0:
            for tick in ax.get_xticklabels():
                tick.set_rotation(90)
        if i == 2:
            ax.yaxis.set_label_position("right")
            ax.yaxis.tick_right()

    for i in range(3):
        ax = fig.add_subplot(gs[2, i])
        ax.set_xlabel(f'XLabel2 {i}')
        ax.set_ylabel(f'YLabel2 {i}')

        if i == 2:
            ax.plot(np.arange(0, 1e4, 10))
            ax.yaxis.set_label_position("right")
            ax.yaxis.tick_right()
            for tick in ax.get_xticklabels():
                tick.set_rotation(90)

    fig.align_labels()


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and return it in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 15:41:03,812 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='This test is relevant because it specifically tests the `align_labels` function, which is the function causing the pickling issue in the bug report. Although this test does not involve pickling, it shows the intended use of `align_labels` and how it affects figure layout, which is essential for understanding the context of the bug.', relative_path='lib/matplotlib/tests/test_figure.py', start_line=28, end_line=66), ContextOutput(reasoning='This test is highly relevant because it demonstrates the pickling of a complex figure with multiple subplots and various plot types. The bug occurs on a figure with multiple subplots, so this test serves as a comprehensive example of successfully pickling and verifying a complex figure, which is the process that fails in the bug report.', relative_path='lib/matplotlib/tests/test_pickle.py', start_line=47, end_line=106), ContextOutput(reasoning='This test is relevant because it checks the pickling of a figure with shared axes. Shared axes create a relationship between subplots, similar to how `align_labels` creates alignment relationships. The test verifies that these relationships are preserved after pickling, which is analogous to the problem in the bug report where such a relationship (created by `align_labels`) breaks pickling.', relative_path='lib/matplotlib/tests/test_pickle.py', start_line=236, end_line=241), ContextOutput(reasoning='This test is relevant as it deals with pickling a figure with complex inter-axis relationships, namely an inset axis and a secondary axis. This is analogous to the relationships created by `fig.align_labels()`, and the test demonstrates a scenario where such complex figures are expected to be successfully pickled.', relative_path='lib/matplotlib/tests/test_pickle.py', start_line=243, end_line=248), ContextOutput(reasoning="This test is crucial because the bug report shows a `TypeError: cannot pickle 'weakref.ReferenceType' object`. This error is often related to object relationship management. Matplotlib's transform system uses weak references to manage parent-child relationships for positioning. This test specifically verifies that transform objects and their complex relationships can be pickled, which is directly related to the likely root cause of the bug triggered by `align_labels`.", relative_path='lib/matplotlib/tests/test_pickle.py', start_line=196, end_line=225)]
2025-10-06 15:41:03,813 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='lib/matplotlib/tests/test_figure.py', content='28. @image_comparison([\'figure_align_labels\'], extensions=[\'png\', \'svg\'],\n29.                   tol=0 if platform.machine() == \'x86_64\' else 0.01)\n30. def test_align_labels():\n31.     fig = plt.figure(layout=\'tight\')\n32.     gs = gridspec.GridSpec(3, 3)\n33. \n34.     ax = fig.add_subplot(gs[0, :2])\n35.     ax.plot(np.arange(0, 1e6, 1000))\n36.     ax.set_ylabel(\'Ylabel0 0\')\n37.     ax = fig.add_subplot(gs[0, -1])\n38.     ax.plot(np.arange(0, 1e4, 100))\n39. \n40.     for i in range(3):\n41.         ax = fig.add_subplot(gs[1, i])\n42.         ax.set_ylabel(\'YLabel1 %d\' % i)\n43.         ax.set_xlabel(\'XLabel1 %d\' % i)\n44.         if i in [0, 2]:\n45.             ax.xaxis.set_label_position("top")\n46.             ax.xaxis.tick_top()\n47.         if i == 0:\n48.             for tick in ax.get_xticklabels():\n49.                 tick.set_rotation(90)\n50.         if i == 2:\n51.             ax.yaxis.set_label_position("right")\n52.             ax.yaxis.tick_right()\n53. \n54.     for i in range(3):\n55.         ax = fig.add_subplot(gs[2, i])\n56.         ax.set_xlabel(f\'XLabel2 {i}\')\n57.         ax.set_ylabel(f\'YLabel2 {i}\')\n58. \n59.         if i == 2:\n60.             ax.plot(np.arange(0, 1e4, 10))\n61.             ax.yaxis.set_label_position("right")\n62.             ax.yaxis.tick_right()\n63.             for tick in ax.get_xticklabels():\n64.                 tick.set_rotation(90)\n65. \n66.     fig.align_labels()', start_line_number=28, end_line_number=66), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='47. def _generate_complete_test_figure(fig_ref):\n48.     fig_ref.set_size_inches((10, 6))\n49.     plt.figure(fig_ref)\n50. \n51.     plt.suptitle(\'Can you fit any more in a figure?\')\n52. \n53.     # make some arbitrary data\n54.     x, y = np.arange(8), np.arange(10)\n55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)\n56.     v = np.sin(v * -0.6)\n57. \n58.     # Ensure lists also pickle correctly.\n59.     plt.subplot(3, 3, 1)\n60.     plt.plot(list(range(10)))\n61. \n62.     plt.subplot(3, 3, 2)\n63.     plt.contourf(data, hatches=[\'//\', \'ooo\'])\n64.     plt.colorbar()\n65. \n66.     plt.subplot(3, 3, 3)\n67.     plt.pcolormesh(data)\n68. \n69.     plt.subplot(3, 3, 4)\n70.     plt.imshow(data)\n71. \n72.     plt.subplot(3, 3, 5)\n73.     plt.pcolor(data)\n74. \n75.     ax = plt.subplot(3, 3, 6)\n76.     ax.set_xlim(0, 7)\n77.     ax.set_ylim(0, 9)\n78.     plt.streamplot(x, y, u, v)\n79. \n80.     ax = plt.subplot(3, 3, 7)\n81.     ax.set_xlim(0, 7)\n82.     ax.set_ylim(0, 9)\n83.     plt.quiver(x, y, u, v)\n84. \n85.     plt.subplot(3, 3, 8)\n86.     plt.scatter(x, x ** 2, label=\'$x^2$\')\n87.     plt.legend(loc=\'upper left\')\n88. \n89.     plt.subplot(3, 3, 9)\n90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)\n91. \n92. \n93. @mpl.style.context("default")\n94. @check_figures_equal(extensions=["png"])\n95. def test_complete(fig_test, fig_ref):\n96.     _generate_complete_test_figure(fig_ref)\n97.     # plotting is done, now test its pickle-ability\n98.     pkl = BytesIO()\n99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)\n100.     loaded = pickle.loads(pkl.getbuffer())\n101.     loaded.canvas.draw()\n102. \n103.     fig_test.set_size_inches(loaded.get_size_inches())\n104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())\n105. \n106.     plt.close(loaded)', start_line_number=47, end_line_number=106), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='236. def test_shared():\n237.     fig, axs = plt.subplots(2, sharex=True)\n238.     fig = pickle.loads(pickle.dumps(fig))\n239.     fig.axes[0].set_xlim(10, 20)\n240.     assert fig.axes[1].get_xlim() == (10, 20)\n241. ', start_line_number=236, end_line_number=241), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='243. def test_inset_and_secondary():\n244.     fig, ax = plt.subplots()\n245.     ax.inset_axes([.1, .1, .3, .3])\n246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))\n247.     pickle.loads(pickle.dumps(fig))\n248. ', start_line_number=243, end_line_number=248), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='196. class TransformBlob:\n197.     def __init__(self):\n198.         self.identity = mtransforms.IdentityTransform()\n199.         self.identity2 = mtransforms.IdentityTransform()\n200.         # Force use of the more complex composition.\n201.         self.composite = mtransforms.CompositeGenericTransform(\n202.             self.identity,\n203.             self.identity2)\n204.         # Check parent -> child links of TransformWrapper.\n205.         self.wrapper = mtransforms.TransformWrapper(self.composite)\n206.         # Check child -> parent links of TransformWrapper.\n207.         self.composite2 = mtransforms.CompositeGenericTransform(\n208.             self.wrapper,\n209.             self.identity)\n210. \n211. \n212. def test_transform():\n213.     obj = TransformBlob()\n214.     pf = pickle.dumps(obj)\n215.     del obj\n216. \n217.     obj = pickle.loads(pf)\n218.     # Check parent -> child links of TransformWrapper.\n219.     assert obj.wrapper._child == obj.composite\n220.     # Check child -> parent links of TransformWrapper.\n221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]\n222.     # Check input and output dimensions are set as expected.\n223.     assert obj.wrapper.input_dims == obj.composite.input_dims\n224.     assert obj.wrapper.output_dims == obj.composite.output_dims\n225. ', start_line_number=196, end_line_number=225)]
2025-10-06 15:41:03,813 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 15:41:03,814 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       ├── stale.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   └── function.rst
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 25061-DS.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25112-GG.rst
|   |   |   |   ├── 25192-DS.rst
|   |   |   |   └── 25255-RR.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24913-AL.rst
|   |   |   |   ├── 24985-OG.rst
|   |   |   |   ├── 24990-OG.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   └── 25282-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   └── 24919-KS.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24923-ES.rst
|   |   |       └── 24XXX-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.6.0.rst
|   |   |   ├── api_changes_3.6.1.rst
|   |   |   ├── api_changes_3.7.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.7.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── figures.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── README.rst
|       |   ├── pie_hatch.rst
|       |   ├── savefig_bbox_layout.rst
|       |   └── widget_button_styling.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── github_stats_3.6.0.rst
|       |   ├── github_stats_3.6.1.rst
|       |   ├── github_stats_3.6.2.rst
|       |   ├── github_stats_3.6.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   ├── whats_new_3.6.0.rst
|       |   └── whats_new_3.7.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── galleries
|   ├── examples
|   |   ├── README.txt
|   |   ├── animation
|   |   |   ├── README.txt
|   |   |   ├── animate_decay.py
|   |   |   ├── animated_histogram.py
|   |   |   ├── animation_demo.py
|   |   |   ├── bayes_update.py
|   |   |   ├── double_pendulum.py
|   |   |   ├── dynamic_image.py
|   |   |   ├── frame_grabbing_sgskip.py
|   |   |   ├── multiple_axes.py
|   |   |   ├── pause_resume.py
|   |   |   ├── rain.py
|   |   |   ├── random_walk.py
|   |   |   ├── simple_anim.py
|   |   |   ├── simple_scatter.py
|   |   |   ├── strip_chart.py
|   |   |   └── unchained.py
|   |   ├── axes_grid1
|   |   |   ├── README.txt
|   |   |   ├── demo_anchored_direction_arrows.py
|   |   |   ├── demo_axes_divider.py
|   |   |   ├── demo_axes_grid.py
|   |   |   ├── demo_axes_grid2.py
|   |   |   ├── demo_axes_hbox_divider.py
|   |   |   ├── demo_axes_rgb.py
|   |   |   ├── demo_colorbar_of_inset_axes.py
|   |   |   ├── demo_colorbar_with_axes_divider.py
|   |   |   ├── demo_colorbar_with_inset_locator.py
|   |   |   ├── demo_edge_colorbar.py
|   |   |   ├── demo_fixed_size_axes.py
|   |   |   ├── demo_imagegrid_aspect.py
|   |   |   ├── inset_locator_demo.py
|   |   |   ├── inset_locator_demo2.py
|   |   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   |   ├── parasite_simple.py
|   |   |   ├── parasite_simple2.py
|   |   |   ├── scatter_hist_locatable_axes.py
|   |   |   ├── simple_anchored_artists.py
|   |   |   ├── simple_axes_divider1.py
|   |   |   ├── simple_axes_divider3.py
|   |   |   ├── simple_axesgrid.py
|   |   |   ├── simple_axesgrid2.py
|   |   |   ├── simple_axisline4.py
|   |   |   └── simple_colorbar.py
|   |   ├── axisartist
|   |   |   ├── README.txt
|   |   |   ├── axis_direction.py
|   |   |   ├── demo_axis_direction.py
|   |   |   ├── demo_axisline_style.py
|   |   |   ├── demo_curvelinear_grid.py
|   |   |   ├── demo_curvelinear_grid2.py
|   |   |   ├── demo_floating_axes.py
|   |   |   ├── demo_floating_axis.py
|   |   |   ├── demo_parasite_axes.py
|   |   |   ├── demo_parasite_axes2.py
|   |   |   ├── demo_ticklabel_alignment.py
|   |   |   ├── demo_ticklabel_direction.py
|   |   |   ├── simple_axis_direction01.py
|   |   |   ├── simple_axis_direction03.py
|   |   |   ├── simple_axis_pad.py
|   |   |   ├── simple_axisartist1.py
|   |   |   ├── simple_axisline.py
|   |   |   └── simple_axisline3.py
|   |   ├── color
|   |   |   ├── README.txt
|   |   |   ├── color_by_yvalue.py
|   |   |   ├── color_cycle_default.py
|   |   |   ├── color_demo.py
|   |   |   ├── colorbar_basics.py
|   |   |   ├── colormap_reference.py
|   |   |   ├── custom_cmap.py
|   |   |   └── named_colors.py
|   |   ├── event_handling
|   |   |   ├── README.txt
|   |   |   ├── close_event.py
|   |   |   ├── coords_demo.py
|   |   |   ├── cursor_demo.py
|   |   |   ├── data_browser.py
|   |   |   ├── figure_axes_enter_leave.py
|   |   |   ├── ginput_manual_clabel_sgskip.py
|   |   |   ├── image_slices_viewer.py
|   |   |   ├── keypress_demo.py
|   |   |   ├── lasso_demo.py
|   |   |   ├── legend_picking.py
|   |   |   ├── looking_glass.py
|   |   |   ├── path_editor.py
|   |   |   ├── pick_event_demo.py
|   |   |   ├── pick_event_demo2.py
|   |   |   ├── poly_editor.py
|   |   |   ├── pong_sgskip.py
|   |   |   ├── resample.py
|   |   |   ├── timers.py
|   |   |   ├── trifinder_event_demo.py
|   |   |   ├── viewlims.py
|   |   |   └── zoom_window.py
|   |   ├── images_contours_and_fields
|   |   |   ├── README.txt
|   |   |   ├── affine_image.py
|   |   |   ├── barb_demo.py
|   |   |   ├── barcode_demo.py
|   |   |   ├── colormap_interactive_adjustment.py
|   |   |   ├── colormap_normalizations.py
|   |   |   ├── colormap_normalizations_symlognorm.py
|   |   |   ├── contour_corner_mask.py
|   |   |   ├── contour_demo.py
|   |   |   ├── contour_image.py
|   |   |   ├── contour_label_demo.py
|   |   |   ├── contourf_demo.py
|   |   |   ├── contourf_hatching.py
|   |   |   ├── contourf_log.py
|   |   |   ├── contours_in_optimization_demo.py
|   |   |   ├── demo_bboximage.py
|   |   |   ├── figimage_demo.py
|   |   |   ├── image_annotated_heatmap.py
|   |   |   ├── image_antialiasing.py
|   |   |   ├── image_clip_path.py
|   |   |   ├── image_demo.py
|   |   |   ├── image_masked.py
|   |   |   ├── image_nonuniform.py
|   |   |   ├── image_transparency_blend.py
|   |   |   ├── image_zcoord.py
|   |   |   ├── interpolation_methods.py
|   |   |   ├── irregulardatagrid.py
|   |   |   ├── layer_images.py
|   |   |   ├── matshow.py
|   |   |   ├── multi_image.py
|   |   |   ├── pcolor_demo.py
|   |   |   ├── pcolormesh_grids.py
|   |   |   ├── pcolormesh_levels.py
|   |   |   ├── plot_streamplot.py
|   |   |   ├── quadmesh_demo.py
|   |   |   ├── quiver_demo.py
|   |   |   ├── quiver_simple_demo.py
|   |   |   ├── shading_example.py
|   |   |   ├── specgram_demo.py
|   |   |   ├── spy_demos.py
|   |   |   ├── tricontour_demo.py
|   |   |   ├── tricontour_smooth_delaunay.py
|   |   |   ├── tricontour_smooth_user.py
|   |   |   ├── trigradient_demo.py
|   |   |   ├── triinterp_demo.py
|   |   |   ├── tripcolor_demo.py
|   |   |   ├── triplot_demo.py
|   |   |   └── watermark_image.py
|   |   ├── lines_bars_and_markers
|   |   |   ├── README.txt
|   |   |   ├── bar_colors.py
|   |   |   ├── bar_label_demo.py
|   |   |   ├── bar_stacked.py
|   |   |   ├── barchart.py
|   |   |   ├── barh.py
|   |   |   ├── broken_barh.py
|   |   |   ├── capstyle.py
|   |   |   ├── categorical_variables.py
|   |   |   ├── cohere.py
|   |   |   ├── csd_demo.py
|   |   |   ├── curve_error_band.py
|   |   |   ├── errorbar_limits_simple.py
|   |   |   ├── errorbar_subsample.py
|   |   |   ├── eventcollection_demo.py
|   |   |   ├── eventplot_demo.py
|   |   |   ├── fill.py
|   |   |   ├── fill_between_alpha.py
|   |   |   ├── fill_between_demo.py
|   |   |   ├── fill_betweenx_demo.py
|   |   |   ├── filled_step.py
|   |   |   ├── gradient_bar.py
|   |   |   ├── hat_graph.py
|   |   |   ├── horizontal_barchart_distribution.py
|   |   |   ├── joinstyle.py
|   |   |   ├── line_demo_dash_control.py
|   |   |   ├── lines_with_ticks_demo.py
|   |   |   ├── linestyles.py
|   |   |   ├── marker_reference.py
|   |   |   ├── markevery_demo.py
|   |   |   ├── masked_demo.py
|   |   |   ├── multicolored_line.py
|   |   |   ├── multivariate_marker_plot.py
|   |   |   ├── psd_demo.py
|   |   |   ├── scatter_custom_symbol.py
|   |   |   ├── scatter_demo2.py
|   |   |   ├── scatter_hist.py
|   |   |   ├── scatter_masked.py
|   |   |   ├── scatter_star_poly.py
|   |   |   ├── scatter_with_legend.py
|   |   |   ├── simple_plot.py
|   |   |   ├── span_regions.py
|   |   |   ├── spectrum_demo.py
|   |   |   ├── stackplot_demo.py
|   |   |   ├── stairs_demo.py
|   |   |   ├── stem_plot.py
|   |   |   ├── step_demo.py
|   |   |   ├── timeline.py
|   |   |   ├── vline_hline_demo.py
|   |   |   └── xcorr_acorr_demo.py
|   |   ├── misc
|   |   |   ├── README.txt
|   |   |   ├── anchored_artists.py
|   |   |   ├── bbox_intersect.py
|   |   |   ├── contour_manual.py
|   |   |   ├── coords_report.py
|   |   |   ├── custom_projection.py
|   |   |   ├── customize_rc.py
|   |   |   ├── demo_agg_filter.py
|   |   |   ├── demo_ribbon_box.py
|   |   |   ├── fig_x.py
|   |   |   ├── fill_spiral.py
|   |   |   ├── findobj_demo.py
|   |   |   ├── font_indexing.py
|   |   |   ├── ftface_props.py
|   |   |   ├── histogram_path.py
|   |   |   ├── hyperlinks_sgskip.py
|   |   |   ├── image_thumbnail_sgskip.py
|   |   |   ├── keyword_plotting.py
|   |   |   ├── logos2.py
|   |   |   ├── multipage_pdf.py
|   |   |   ├── multiprocess_sgskip.py
|   |   |   ├── packed_bubbles.py
|   |   |   ├── patheffect_demo.py
|   |   |   ├── print_stdout_sgskip.py
|   |   |   ├── rasterization_demo.py
|   |   |   ├── set_and_get.py
|   |   |   ├── svg_filter_line.py
|   |   |   ├── svg_filter_pie.py
|   |   |   ├── table_demo.py
|   |   |   ├── tickedstroke_demo.py
|   |   |   ├── transoffset.py
|   |   |   └── zorder_demo.py
|   |   ├── mplot3d
|   |   |   ├── 2dcollections3d.py
|   |   |   ├── 3d_bars.py
|   |   |   ├── README.txt
|   |   |   ├── bars3d.py
|   |   |   ├── box3d.py
|   |   |   ├── contour3d.py
|   |   |   ├── contour3d_2.py
|   |   |   ├── contour3d_3.py
|   |   |   ├── contourf3d.py
|   |   |   ├── contourf3d_2.py
|   |   |   ├── custom_shaded_3d_surface.py
|   |   |   ├── errorbar3d.py
|   |   |   ├── hist3d.py
|   |   |   ├── lines3d.py
|   |   |   ├── lorenz_attractor.py
|   |   |   ├── mixed_subplots.py
|   |   |   ├── offset.py
|   |   |   ├── pathpatch3d.py
|   |   |   ├── polys3d.py
|   |   |   ├── projections.py
|   |   |   ├── quiver3d.py
|   |   |   ├── rotate_axes3d_sgskip.py
|   |   |   ├── scatter3d.py
|   |   |   ├── stem3d_demo.py
|   |   |   ├── subplot3d.py
|   |   |   ├── surface3d.py
|   |   |   ├── surface3d_2.py
|   |   |   ├── surface3d_3.py
|   |   |   ├── surface3d_radial.py
|   |   |   ├── text3d.py
|   |   |   ├── tricontour3d.py
|   |   |   ├── tricontourf3d.py
|   |   |   ├── trisurf3d.py
|   |   |   ├── trisurf3d_2.py
|   |   |   ├── view_planes_3d.py
|   |   |   ├── voxels.py
|   |   |   ├── voxels_numpy_logo.py
|   |   |   ├── voxels_rgb.py
|   |   |   ├── voxels_torus.py
|   |   |   ├── wire3d.py
|   |   |   ├── wire3d_animation_sgskip.py
|   |   |   └── wire3d_zero_stride.py
|   |   ├── pie_and_polar_charts
|   |   |   ├── README.txt
|   |   |   ├── bar_of_pie.py
|   |   |   ├── nested_pie.py
|   |   |   ├── pie_and_donut_labels.py
|   |   |   ├── pie_demo2.py
|   |   |   ├── pie_features.py
|   |   |   ├── polar_bar.py
|   |   |   ├── polar_demo.py
|   |   |   ├── polar_error_caps.py
|   |   |   ├── polar_legend.py
|   |   |   └── polar_scatter.py
|   |   ├── pyplots
|   |   |   ├── README.txt
|   |   |   ├── axline.py
|   |   |   ├── pyplot_simple.py
|   |   |   ├── pyplot_text.py
|   |   |   ├── pyplot_three.py
|   |   |   └── pyplot_two_subplots.py
|   |   ├── scales
|   |   |   ├── README.txt
|   |   |   ├── asinh_demo.py
|   |   |   ├── aspect_loglog.py
|   |   |   ├── custom_scale.py
|   |   |   ├── log_bar.py
|   |   |   ├── log_demo.py
|   |   |   ├── logit_demo.py
|   |   |   ├── power_norm.py
|   |   |   ├── scales.py
|   |   |   ├── semilogx_demo.py
|   |   |   └── symlog_demo.py
|   |   ├── shapes_and_collections
|   |   |   ├── README.txt
|   |   |   ├── arrow_guide.py
|   |   |   ├── artist_reference.py
|   |   |   ├── collections.py
|   |   |   ├── compound_path.py
|   |   |   ├── dolphin.py
|   |   |   ├── donut.py
|   |   |   ├── ellipse_collection.py
|   |   |   ├── ellipse_demo.py
|   |   |   ├── fancybox_demo.py
|   |   |   ├── hatch_demo.py
|   |   |   ├── hatch_style_reference.py
|   |   |   ├── line_collection.py
|   |   |   ├── patch_collection.py
|   |   |   ├── path_patch.py
|   |   |   ├── quad_bezier.py
|   |   |   └── scatter.py
|   |   ├── showcase
|   |   |   ├── README.txt
|   |   |   ├── anatomy.py
|   |   |   ├── firefox.py
|   |   |   ├── integral.py
|   |   |   ├── mandelbrot.py
|   |   |   ├── stock_prices.py
|   |   |   └── xkcd.py
|   |   ├── specialty_plots
|   |   |   ├── README.txt
|   |   |   ├── advanced_hillshading.py
|   |   |   ├── anscombe.py
|   |   |   ├── hinton_demo.py
|   |   |   ├── leftventricle_bullseye.py
|   |   |   ├── mri_demo.py
|   |   |   ├── mri_with_eeg.py
|   |   |   ├── radar_chart.py
|   |   |   ├── sankey_basics.py
|   |   |   ├── sankey_links.py
|   |   |   ├── sankey_rankine.py
|   |   |   ├── skewt.py
|   |   |   └── topographic_hillshading.py
|   |   ├── spines
|   |   |   ├── README.txt
|   |   |   ├── centered_spines_with_arrows.py
|   |   |   ├── multiple_yaxis_with_spines.py
|   |   |   ├── spine_placement_demo.py
|   |   |   ├── spines.py
|   |   |   └── spines_dropped.py
|   |   ├── statistics
|   |   |   ├── README.txt
|   |   |   ├── barchart_demo.py
|   |   |   ├── boxplot.py
|   |   |   ├── boxplot_color.py
|   |   |   ├── boxplot_demo.py
|   |   |   ├── boxplot_vs_violin.py
|   |   |   ├── bxp.py
|   |   |   ├── confidence_ellipse.py
|   |   |   ├── customized_violin.py
|   |   |   ├── errorbar.py
|   |   |   ├── errorbar_features.py
|   |   |   ├── errorbar_limits.py
|   |   |   ├── errorbars_and_boxes.py
|   |   |   ├── hexbin_demo.py
|   |   |   ├── hist.py
|   |   |   ├── histogram_cumulative.py
|   |   |   ├── histogram_features.py
|   |   |   ├── histogram_histtypes.py
|   |   |   ├── histogram_multihist.py
|   |   |   ├── multiple_histograms_side_by_side.py
|   |   |   ├── time_series_histogram.py
|   |   |   └── violinplot.py
|   |   ├── style_sheets
|   |   |   ├── README.txt
|   |   |   ├── bmh.py
|   |   |   ├── dark_background.py
|   |   |   ├── fivethirtyeight.py
|   |   |   ├── ggplot.py
|   |   |   ├── grayscale.py
|   |   |   ├── plot_solarizedlight2.py
|   |   |   └── style_sheets_reference.py
|   |   ├── subplots_axes_and_figures
|   |   |   ├── README.txt
|   |   |   ├── align_labels_demo.py
|   |   |   ├── auto_subplots_adjust.py
|   |   |   ├── axes_box_aspect.py
|   |   |   ├── axes_demo.py
|   |   |   ├── axes_margins.py
|   |   |   ├── axes_props.py
|   |   |   ├── axes_zoom_effect.py
|   |   |   ├── axhspan_demo.py
|   |   |   ├── axis_equal_demo.py
|   |   |   ├── axis_labels_demo.py
|   |   |   ├── broken_axis.py
|   |   |   ├── colorbar_placement.py
|   |   |   ├── custom_figure_class.py
|   |   |   ├── demo_constrained_layout.py
|   |   |   ├── demo_tight_layout.py
|   |   |   ├── fahrenheit_celsius_scales.py
|   |   |   ├── figure_size_units.py
|   |   |   ├── figure_title.py
|   |   |   ├── ganged_plots.py
|   |   |   ├── geo_demo.py
|   |   |   ├── gridspec_and_subplots.py
|   |   |   ├── gridspec_multicolumn.py
|   |   |   ├── gridspec_nested.py
|   |   |   ├── invert_axes.py
|   |   |   ├── mosaic.py
|   |   |   ├── multiple_figs_demo.py
|   |   |   ├── secondary_axis.py
|   |   |   ├── share_axis_lims_views.py
|   |   |   ├── shared_axis_demo.py
|   |   |   ├── subfigures.py
|   |   |   ├── subplot.py
|   |   |   ├── subplots_adjust.py
|   |   |   ├── subplots_demo.py
|   |   |   ├── two_scales.py
|   |   |   └── zoom_inset_axes.py
|   |   ├── text_labels_and_annotations
|   |   |   ├── README.txt
|   |   |   ├── accented_text.py
|   |   |   ├── align_ylabels.py
|   |   |   ├── angle_annotation.py
|   |   |   ├── angles_on_bracket_arrows.py
|   |   |   ├── annotate_transform.py
|   |   |   ├── annotation_basic.py
|   |   |   ├── annotation_demo.py
|   |   |   ├── annotation_polar.py
|   |   |   ├── arrow_demo.py
|   |   |   ├── autowrap.py
|   |   |   ├── custom_legends.py
|   |   |   ├── date.py
|   |   |   ├── demo_annotation_box.py
|   |   |   ├── demo_text_path.py
|   |   |   ├── demo_text_rotation_mode.py
|   |   |   ├── dfrac_demo.py
|   |   |   ├── engineering_formatter.py
|   |   |   ├── fancyarrow_demo.py
|   |   |   ├── fancytextbox_demo.py
|   |   |   ├── figlegend_demo.py
|   |   |   ├── font_family_rc.py
|   |   |   ├── font_file.py
|   |   |   ├── font_table.py
|   |   |   ├── fonts_demo.py
|   |   |   ├── fonts_demo_kw.py
|   |   |   ├── label_subplots.py
|   |   |   ├── legend.py
|   |   |   ├── legend_demo.py
|   |   |   ├── line_with_text.py
|   |   |   ├── mathtext_asarray.py
|   |   |   ├── mathtext_demo.py
|   |   |   ├── mathtext_examples.py
|   |   |   ├── mathtext_fontfamily_example.py
|   |   |   ├── multiline.py
|   |   |   ├── placing_text_boxes.py
|   |   |   ├── rainbow_text.py
|   |   |   ├── stix_fonts_demo.py
|   |   |   ├── tex_demo.py
|   |   |   ├── text_alignment.py
|   |   |   ├── text_commands.py
|   |   |   ├── text_fontdict.py
|   |   |   ├── text_rotation_relative_to_line.py
|   |   |   ├── titles_demo.py
|   |   |   ├── unicode_minus.py
|   |   |   ├── usetex_baseline_test.py
|   |   |   ├── usetex_fonteffects.py
|   |   |   └── watermark_text.py
|   |   ├── ticks
|   |   |   ├── README.txt
|   |   |   ├── auto_ticks.py
|   |   |   ├── centered_ticklabels.py
|   |   |   ├── colorbar_tick_labelling_demo.py
|   |   |   ├── custom_ticker1.py
|   |   |   ├── date_concise_formatter.py
|   |   |   ├── date_demo_convert.py
|   |   |   ├── date_demo_rrule.py
|   |   |   ├── date_formatters_locators.py
|   |   |   ├── date_index_formatter.py
|   |   |   ├── date_precision_and_epochs.py
|   |   |   ├── dollar_ticks.py
|   |   |   ├── fig_axes_customize_simple.py
|   |   |   ├── major_minor_demo.py
|   |   |   ├── scalarformatter.py
|   |   |   ├── tick-formatters.py
|   |   |   ├── tick-locators.py
|   |   |   ├── tick_label_right.py
|   |   |   ├── tick_labels_from_values.py
|   |   |   ├── tick_xlabel_top.py
|   |   |   ├── ticklabels_rotation.py
|   |   |   └── ticks_too_many.py
|   |   ├── units
|   |   |   ├── README.txt
|   |   |   ├── annotate_with_units.py
|   |   |   ├── artist_tests.py
|   |   |   ├── bar_demo2.py
|   |   |   ├── bar_unit_demo.py
|   |   |   ├── basic_units.py
|   |   |   ├── ellipse_with_units.py
|   |   |   ├── evans_test.py
|   |   |   ├── radian_demo.py
|   |   |   ├── units_sample.py
|   |   |   └── units_scatter.py
|   |   ├── user_interfaces
|   |   |   ├── README.txt
|   |   |   ├── canvasagg.py
|   |   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk3_sgskip.py
|   |   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk4_sgskip.py
|   |   |   ├── embedding_in_qt_sgskip.py
|   |   |   ├── embedding_in_tk_sgskip.py
|   |   |   ├── embedding_in_wx2_sgskip.py
|   |   |   ├── embedding_in_wx3_sgskip.py
|   |   |   ├── embedding_in_wx4_sgskip.py
|   |   |   ├── embedding_in_wx5_sgskip.py
|   |   |   ├── embedding_webagg_sgskip.py
|   |   |   ├── fourier_demo_wx_sgskip.py
|   |   |   ├── gtk3_spreadsheet_sgskip.py
|   |   |   ├── gtk4_spreadsheet_sgskip.py
|   |   |   ├── images
|   |   |   ├── mathtext_wx_sgskip.py
|   |   |   ├── mpl_with_glade3_sgskip.py
|   |   |   ├── mplcvd.py
|   |   |   ├── pylab_with_gtk3_sgskip.py
|   |   |   ├── pylab_with_gtk4_sgskip.py
|   |   |   ├── svg_histogram_sgskip.py
|   |   |   ├── svg_tooltip_sgskip.py
|   |   |   ├── toolmanager_sgskip.py
|   |   |   ├── web_application_server_sgskip.py
|   |   |   └── wxcursor_demo_sgskip.py
|   |   ├── userdemo
|   |   |   ├── README.txt
|   |   |   ├── annotate_explain.py
|   |   |   ├── annotate_simple_coord02.py
|   |   |   ├── annotate_text_arrow.py
|   |   |   ├── connect_simple01.py
|   |   |   ├── connectionstyle_demo.py
|   |   |   ├── custom_boxstyle01.py
|   |   |   ├── demo_gridspec01.py
|   |   |   ├── demo_gridspec03.py
|   |   |   ├── demo_gridspec06.py
|   |   |   ├── pgf_fonts.py
|   |   |   ├── pgf_preamble_sgskip.py
|   |   |   ├── pgf_texsystem.py
|   |   |   ├── simple_annotate01.py
|   |   |   ├── simple_legend01.py
|   |   |   └── simple_legend02.py
|   |   └── widgets
|   |       ├── README.txt
|   |       ├── annotated_cursor.py
|   |       ├── buttons.py
|   |       ├── check_buttons.py
|   |       ├── cursor.py
|   |       ├── lasso_selector_demo_sgskip.py
|   |       ├── menu.py
|   |       ├── mouse_cursor.py
|   |       ├── multicursor.py
|   |       ├── polygon_selector_demo.py
|   |       ├── polygon_selector_simple.py
|   |       ├── radio_buttons.py
|   |       ├── range_slider.py
|   |       ├── rectangle_selector.py
|   |       ├── slider_demo.py
|   |       ├── slider_snap_demo.py
|   |       ├── span_selector.py
|   |       └── textbox.py
|   ├── plot_types
|   |   ├── 3D
|   |   |   ├── README.rst
|   |   |   ├── scatter3d_simple.py
|   |   |   ├── surface3d_simple.py
|   |   |   ├── trisurf3d_simple.py
|   |   |   ├── voxels_simple.py
|   |   |   └── wire3d_simple.py
|   |   ├── README.rst
|   |   ├── arrays
|   |   |   ├── README.rst
|   |   |   ├── barbs.py
|   |   |   ├── contour.py
|   |   |   ├── contourf.py
|   |   |   ├── imshow.py
|   |   |   ├── pcolormesh.py
|   |   |   ├── quiver.py
|   |   |   └── streamplot.py
|   |   ├── basic
|   |   |   ├── README.rst
|   |   |   ├── bar.py
|   |   |   ├── fill_between.py
|   |   |   ├── plot.py
|   |   |   ├── scatter_plot.py
|   |   |   ├── stackplot.py
|   |   |   ├── stem.py
|   |   |   └── step.py
|   |   ├── stats
|   |   |   ├── README.rst
|   |   |   ├── boxplot_plot.py
|   |   |   ├── errorbar_plot.py
|   |   |   ├── eventplot.py
|   |   |   ├── hexbin.py
|   |   |   ├── hist2d.py
|   |   |   ├── hist_plot.py
|   |   |   ├── pie.py
|   |   |   └── violin.py
|   |   └── unstructured
|   |       ├── README.rst
|   |       ├── tricontour.py
|   |       ├── tricontourf.py
|   |       ├── tripcolor.py
|   |       └── triplot.py
|   └── tutorials
|       ├── README.txt
|       ├── advanced
|       |   ├── README.txt
|       |   ├── blitting.py
|       |   ├── path_tutorial.py
|       |   ├── patheffects_guide.py
|       |   └── transforms_tutorial.py
|       ├── colors
|       |   ├── README.txt
|       |   ├── colorbar_only.py
|       |   ├── colormap-manipulation.py
|       |   ├── colormapnorms.py
|       |   ├── colormaps.py
|       |   └── colors.py
|       ├── intermediate
|       |   ├── README.txt
|       |   ├── arranging_axes.py
|       |   ├── artists.py
|       |   ├── autoscale.py
|       |   ├── color_cycle.py
|       |   ├── constrainedlayout_guide.py
|       |   ├── imshow_extent.py
|       |   ├── legend_guide.py
|       |   └── tight_layout_guide.py
|       ├── introductory
|       |   ├── README.txt
|       |   ├── animation_tutorial.py
|       |   ├── customizing.py
|       |   ├── images.py
|       |   ├── lifecycle.py
|       |   ├── pyplot.py
|       |   └── quick_start.py
|       ├── provisional
|       |   └── README.txt
|       ├── text
|       |   ├── README.txt
|       |   ├── annotations.py
|       |   ├── mathtext.py
|       |   ├── pgf.py
|       |   ├── text_intro.py
|       |   ├── text_props.py
|       |   └── usetex.py
|       └── toolkits
|           ├── README.txt
|           ├── axes_grid.py
|           ├── axisartist.py
|           └── mplot3d.py
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── css
|   |   |       └── js
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
└── tools
    ├── README.txt
    ├── boilerplate.py
    ├── cache_zenodo_svg.py
    ├── create_DejaVuDisplay.sh
    ├── embed_js.py
    ├── gh_api.py
    ├── github_stats.py
    ├── make_icons.py
    ├── memleak.py
    ├── run_examples.py
    ├── subset.py
    ├── triage_tests.py
    └── visualize_tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
[Bug]: Unable to pickle figure with aligned labels

Issue description: 
### Bug summary

 Unable to pickle figure after calling `align_labels()`

### Code for reproduction

```python
import matplotlib.pyplot as plt
import pickle

fig = plt.figure()
ax1 = fig.add_subplot(211)
ax2 = fig.add_subplot(212)
time=[0,1,2,3,4]
speed=[40000,4300,4500,4700,4800]
acc=[10,11,12,13,14]
ax1.plot(time,speed)
ax1.set_ylabel('speed')
ax2.plot(time,acc)
ax2.set_ylabel('acc')

fig.align_labels() ##pickling works after removing this line 

pickle.dumps(fig)
plt.show()
```


### Actual outcome
```
align.py", line 16
pickle.dumps(fig)
TypeError: cannot pickle 'weakref.ReferenceType' object
```
### Expected outcome

Pickling successful

### Additional information

_No response_

### Operating system

Windows

### Matplotlib Version

3.7.0

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

None

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_figure.py
Line number range: 28 - 66
Content:
28. @image_comparison(['figure_align_labels'], extensions=['png', 'svg'],
29.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
30. def test_align_labels():
31.     fig = plt.figure(layout='tight')
32.     gs = gridspec.GridSpec(3, 3)
33. 
34.     ax = fig.add_subplot(gs[0, :2])
35.     ax.plot(np.arange(0, 1e6, 1000))
36.     ax.set_ylabel('Ylabel0 0')
37.     ax = fig.add_subplot(gs[0, -1])
38.     ax.plot(np.arange(0, 1e4, 100))
39. 
40.     for i in range(3):
41.         ax = fig.add_subplot(gs[1, i])
42.         ax.set_ylabel('YLabel1 %d' % i)
43.         ax.set_xlabel('XLabel1 %d' % i)
44.         if i in [0, 2]:
45.             ax.xaxis.set_label_position("top")
46.             ax.xaxis.tick_top()
47.         if i == 0:
48.             for tick in ax.get_xticklabels():
49.                 tick.set_rotation(90)
50.         if i == 2:
51.             ax.yaxis.set_label_position("right")
52.             ax.yaxis.tick_right()
53. 
54.     for i in range(3):
55.         ax = fig.add_subplot(gs[2, i])
56.         ax.set_xlabel(f'XLabel2 {i}')
57.         ax.set_ylabel(f'YLabel2 {i}')
58. 
59.         if i == 2:
60.             ax.plot(np.arange(0, 1e4, 10))
61.             ax.yaxis.set_label_position("right")
62.             ax.yaxis.tick_right()
63.             for tick in ax.get_xticklabels():
64.                 tick.set_rotation(90)
65. 
66.     fig.align_labels()


File: lib/matplotlib/tests/test_pickle.py
Line number range: 47 - 106
Content:
47. def _generate_complete_test_figure(fig_ref):
48.     fig_ref.set_size_inches((10, 6))
49.     plt.figure(fig_ref)
50. 
51.     plt.suptitle('Can you fit any more in a figure?')
52. 
53.     # make some arbitrary data
54.     x, y = np.arange(8), np.arange(10)
55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)
56.     v = np.sin(v * -0.6)
57. 
58.     # Ensure lists also pickle correctly.
59.     plt.subplot(3, 3, 1)
60.     plt.plot(list(range(10)))
61. 
62.     plt.subplot(3, 3, 2)
63.     plt.contourf(data, hatches=['//', 'ooo'])
64.     plt.colorbar()
65. 
66.     plt.subplot(3, 3, 3)
67.     plt.pcolormesh(data)
68. 
69.     plt.subplot(3, 3, 4)
70.     plt.imshow(data)
71. 
72.     plt.subplot(3, 3, 5)
73.     plt.pcolor(data)
74. 
75.     ax = plt.subplot(3, 3, 6)
76.     ax.set_xlim(0, 7)
77.     ax.set_ylim(0, 9)
78.     plt.streamplot(x, y, u, v)
79. 
80.     ax = plt.subplot(3, 3, 7)
81.     ax.set_xlim(0, 7)
82.     ax.set_ylim(0, 9)
83.     plt.quiver(x, y, u, v)
84. 
85.     plt.subplot(3, 3, 8)
86.     plt.scatter(x, x ** 2, label='$x^2$')
87.     plt.legend(loc='upper left')
88. 
89.     plt.subplot(3, 3, 9)
90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)
91. 
92. 
93. @mpl.style.context("default")
94. @check_figures_equal(extensions=["png"])
95. def test_complete(fig_test, fig_ref):
96.     _generate_complete_test_figure(fig_ref)
97.     # plotting is done, now test its pickle-ability
98.     pkl = BytesIO()
99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)
100.     loaded = pickle.loads(pkl.getbuffer())
101.     loaded.canvas.draw()
102. 
103.     fig_test.set_size_inches(loaded.get_size_inches())
104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())
105. 
106.     plt.close(loaded)


File: lib/matplotlib/tests/test_pickle.py
Line number range: 236 - 241
Content:
236. def test_shared():
237.     fig, axs = plt.subplots(2, sharex=True)
238.     fig = pickle.loads(pickle.dumps(fig))
239.     fig.axes[0].set_xlim(10, 20)
240.     assert fig.axes[1].get_xlim() == (10, 20)
241. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 243 - 248
Content:
243. def test_inset_and_secondary():
244.     fig, ax = plt.subplots()
245.     ax.inset_axes([.1, .1, .3, .3])
246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))
247.     pickle.loads(pickle.dumps(fig))
248. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 196 - 225
Content:
196. class TransformBlob:
197.     def __init__(self):
198.         self.identity = mtransforms.IdentityTransform()
199.         self.identity2 = mtransforms.IdentityTransform()
200.         # Force use of the more complex composition.
201.         self.composite = mtransforms.CompositeGenericTransform(
202.             self.identity,
203.             self.identity2)
204.         # Check parent -> child links of TransformWrapper.
205.         self.wrapper = mtransforms.TransformWrapper(self.composite)
206.         # Check child -> parent links of TransformWrapper.
207.         self.composite2 = mtransforms.CompositeGenericTransform(
208.             self.wrapper,
209.             self.identity)
210. 
211. 
212. def test_transform():
213.     obj = TransformBlob()
214.     pf = pickle.dumps(obj)
215.     del obj
216. 
217.     obj = pickle.loads(pf)
218.     # Check parent -> child links of TransformWrapper.
219.     assert obj.wrapper._child == obj.composite
220.     # Check child -> parent links of TransformWrapper.
221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]
222.     # Check input and output dimensions are set as expected.
223.     assert obj.wrapper.input_dims == obj.composite.input_dims
224.     assert obj.wrapper.output_dims == obj.composite.output_dims
225. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-06 15:41:25,103 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants 5 complete, self-contained test cases, which must include all necessary imports.\n2. The provided context contains snippets of several relevant test functions from `lib/matplotlib/tests/test_figure.py` and `lib/matplotlib/tests/test_pickle.py`.\n3. However, the file-level imports for these test files are missing from the context.\n4. To provide complete test cases as requested, I need the imports from the top of these files.\n5. Therefore, additional context is required.' refined_query='Please provide the full content of the files `lib/matplotlib/tests/test_figure.py` and `lib/matplotlib/tests/test_pickle.py` to get the necessary imports and helper functions for constructing complete test cases.'
2025-10-06 15:41:29,672 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the contents of both `lib/matplotlib/tests/test_figure.py` and `lib/matplotlib/tests/test_pickle.py` to provide the necessary context for constructing complete test cases, including imports and helper functions. You can find the full contents of these files in the tool output.' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "lib/matplotlib/tests/test_pickle.py"}'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 21933, 'candidates_token_count': 115, 'total_token_count': 22256, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21933}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 115}], 'thoughts_token_count': 208, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.15157759293265965, 'model_name': 'gemini-2.5-pro'} id='run--bf7593d6-ff13-4e9a-a017-ffecfa1e2bc1-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_figure.py'}, 'id': 'f7196b38-ec3a-4bf2-bee8-7c89b19f4e5c', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'lib/matplotlib/tests/test_pickle.py'}, 'id': '96beb352-2ca9-4e5d-ba63-0f1619793a4c', 'type': 'tool_call'}] usage_metadata={'input_tokens': 21933, 'output_tokens': 115, 'total_tokens': 22256, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 208}}
2025-10-06 15:41:49,749 - thread-139660780025408.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have read the contents of both `lib/matplotlib/tests/test_figure.py` and `lib/matplotlib/tests/test_pickle.py` to provide the necessary context for constructing complete test cases, including imports and helper functions. You can find the full contents of these files in the tool output.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 33977, 'candidates_token_count': 65, 'total_token_count': 35793, 'cached_content_token_count': 21796, 'prompt_tokens_details': [{'modality': 1, 'token_count': 33977}], 'cache_tokens_details': [{'modality': 1, 'token_count': 21796}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 65}], 'thoughts_token_count': 1751}, 'finish_reason': 'STOP', 'avg_logprobs': -3.567559579702524, 'model_name': 'gemini-2.5-pro'} id='run--733c6fe1-8ecc-42e7-a94d-e4292a513b77-0' usage_metadata={'input_tokens': 33977, 'output_tokens': 65, 'total_tokens': 35793, 'input_token_details': {'cache_read': 21796}, 'output_token_details': {'reasoning': 1751}}
2025-10-06 15:41:49,749 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-06 15:41:49,750 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
[Bug]: Unable to pickle figure with aligned labels

Issue description: 
### Bug summary

 Unable to pickle figure after calling `align_labels()`

### Code for reproduction

```python
import matplotlib.pyplot as plt
import pickle

fig = plt.figure()
ax1 = fig.add_subplot(211)
ax2 = fig.add_subplot(212)
time=[0,1,2,3,4]
speed=[40000,4300,4500,4700,4800]
acc=[10,11,12,13,14]
ax1.plot(time,speed)
ax1.set_ylabel('speed')
ax2.plot(time,acc)
ax2.set_ylabel('acc')

fig.align_labels() ##pickling works after removing this line 

pickle.dumps(fig)
plt.show()
```


### Actual outcome
```
align.py", line 16
pickle.dumps(fig)
TypeError: cannot pickle 'weakref.ReferenceType' object
```
### Expected outcome

Pickling successful

### Additional information

_No response_

### Operating system

Windows

### Matplotlib Version

3.7.0

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

None

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the full content of the files `lib/matplotlib/tests/test_figure.py` and `lib/matplotlib/tests/test_pickle.py` to get the necessary imports and helper functions for constructing complete test cases.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: lib/matplotlib/tests/test_figure.py
Line number range: 1 - 500
Content:
1. import copy
2. from datetime import datetime
3. import io
4. from pathlib import Path
5. import pickle
6. import platform
7. from threading import Timer
8. from types import SimpleNamespace
9. import warnings
10. 
11. import numpy as np
12. import pytest
13. from PIL import Image
14. 
15. import matplotlib as mpl
16. from matplotlib import gridspec
17. from matplotlib.testing.decorators import image_comparison, check_figures_equal
18. from matplotlib.axes import Axes
19. from matplotlib.figure import Figure, FigureBase
20. from matplotlib.layout_engine import (ConstrainedLayoutEngine,
21.                                       TightLayoutEngine,
22.                                       PlaceHolderLayoutEngine)
23. from matplotlib.ticker import AutoMinorLocator, FixedFormatter, ScalarFormatter
24. import matplotlib.pyplot as plt
25. import matplotlib.dates as mdates
26. 
27. 
28. @image_comparison(['figure_align_labels'], extensions=['png', 'svg'],
29.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
30. def test_align_labels():
31.     fig = plt.figure(layout='tight')
32.     gs = gridspec.GridSpec(3, 3)
33. 
34.     ax = fig.add_subplot(gs[0, :2])
35.     ax.plot(np.arange(0, 1e6, 1000))
36.     ax.set_ylabel('Ylabel0 0')
37.     ax = fig.add_subplot(gs[0, -1])
38.     ax.plot(np.arange(0, 1e4, 100))
39. 
40.     for i in range(3):
41.         ax = fig.add_subplot(gs[1, i])
42.         ax.set_ylabel('YLabel1 %d' % i)
43.         ax.set_xlabel('XLabel1 %d' % i)
44.         if i in [0, 2]:
45.             ax.xaxis.set_label_position("top")
46.             ax.xaxis.tick_top()
47.         if i == 0:
48.             for tick in ax.get_xticklabels():
49.                 tick.set_rotation(90)
50.         if i == 2:
51.             ax.yaxis.set_label_position("right")
52.             ax.yaxis.tick_right()
53. 
54.     for i in range(3):
55.         ax = fig.add_subplot(gs[2, i])
56.         ax.set_xlabel(f'XLabel2 {i}')
57.         ax.set_ylabel(f'YLabel2 {i}')
58. 
59.         if i == 2:
60.             ax.plot(np.arange(0, 1e4, 10))
61.             ax.yaxis.set_label_position("right")
62.             ax.yaxis.tick_right()
63.             for tick in ax.get_xticklabels():
64.                 tick.set_rotation(90)
65. 
66.     fig.align_labels()
67. 
68. 
69. def test_align_labels_stray_axes():
70.     fig, axs = plt.subplots(2, 2)
71.     for nn, ax in enumerate(axs.flat):
72.         ax.set_xlabel('Boo')
73.         ax.set_xlabel('Who')
74.         ax.plot(np.arange(4)**nn, np.arange(4)**nn)
75.     fig.align_ylabels()
76.     fig.align_xlabels()
77.     fig.draw_without_rendering()
78.     xn = np.zeros(4)
79.     yn = np.zeros(4)
80.     for nn, ax in enumerate(axs.flat):
81.         yn[nn] = ax.xaxis.label.get_position()[1]
82.         xn[nn] = ax.yaxis.label.get_position()[0]
83.     np.testing.assert_allclose(xn[:2], xn[2:])
84.     np.testing.assert_allclose(yn[::2], yn[1::2])
85. 
86.     fig, axs = plt.subplots(2, 2, constrained_layout=True)
87.     for nn, ax in enumerate(axs.flat):
88.         ax.set_xlabel('Boo')
89.         ax.set_xlabel('Who')
90.         pc = ax.pcolormesh(np.random.randn(10, 10))
91.     fig.colorbar(pc, ax=ax)
92.     fig.align_ylabels()
93.     fig.align_xlabels()
94.     fig.draw_without_rendering()
95.     xn = np.zeros(4)
96.     yn = np.zeros(4)
97.     for nn, ax in enumerate(axs.flat):
98.         yn[nn] = ax.xaxis.label.get_position()[1]
99.         xn[nn] = ax.yaxis.label.get_position()[0]
100.     np.testing.assert_allclose(xn[:2], xn[2:])
101.     np.testing.assert_allclose(yn[::2], yn[1::2])
102. 
103. 
104. def test_figure_label():
105.     # pyplot figure creation, selection, and closing with label/number/instance
106.     plt.close('all')
107.     fig_today = plt.figure('today')
108.     plt.figure(3)
109.     plt.figure('tomorrow')
110.     plt.figure()
111.     plt.figure(0)
112.     plt.figure(1)
113.     plt.figure(3)
114.     assert plt.get_fignums() == [0, 1, 3, 4, 5]
115.     assert plt.get_figlabels() == ['', 'today', '', 'tomorrow', '']
116.     plt.close(10)
117.     plt.close()
118.     plt.close(5)
119.     plt.close('tomorrow')
120.     assert plt.get_fignums() == [0, 1]
121.     assert plt.get_figlabels() == ['', 'today']
122.     plt.figure(fig_today)
123.     assert plt.gcf() == fig_today
124.     with pytest.raises(ValueError):
125.         plt.figure(Figure())
126. 
127. 
128. def test_fignum_exists():
129.     # pyplot figure creation, selection and closing with fignum_exists
130.     plt.figure('one')
131.     plt.figure(2)
132.     plt.figure('three')
133.     plt.figure()
134.     assert plt.fignum_exists('one')
135.     assert plt.fignum_exists(2)
136.     assert plt.fignum_exists('three')
137.     assert plt.fignum_exists(4)
138.     plt.close('one')
139.     plt.close(4)
140.     assert not plt.fignum_exists('one')
141.     assert not plt.fignum_exists(4)
142. 
143. 
144. def test_clf_keyword():
145.     # test if existing figure is cleared with figure() and subplots()
146.     text1 = 'A fancy plot'
147.     text2 = 'Really fancy!'
148. 
149.     fig0 = plt.figure(num=1)
150.     fig0.suptitle(text1)
151.     assert [t.get_text() for t in fig0.texts] == [text1]
152. 
153.     fig1 = plt.figure(num=1, clear=False)
154.     fig1.text(0.5, 0.5, text2)
155.     assert fig0 is fig1
156.     assert [t.get_text() for t in fig1.texts] == [text1, text2]
157. 
158.     fig2, ax2 = plt.subplots(2, 1, num=1, clear=True)
159.     assert fig0 is fig2
160.     assert [t.get_text() for t in fig2.texts] == []
161. 
162. 
163. @image_comparison(['figure_today'])
164. def test_figure():
165.     # named figure support
166.     fig = plt.figure('today')
167.     ax = fig.add_subplot()
168.     ax.set_title(fig.get_label())
169.     ax.plot(np.arange(5))
170.     # plot red line in a different figure.
171.     plt.figure('tomorrow')
172.     plt.plot([0, 1], [1, 0], 'r')
173.     # Return to the original; make sure the red line is not there.
174.     plt.figure('today')
175.     plt.close('tomorrow')
176. 
177. 
178. @image_comparison(['figure_legend'])
179. def test_figure_legend():
180.     fig, axs = plt.subplots(2)
181.     axs[0].plot([0, 1], [1, 0], label='x', color='g')
182.     axs[0].plot([0, 1], [0, 1], label='y', color='r')
183.     axs[0].plot([0, 1], [0.5, 0.5], label='y', color='k')
184. 
185.     axs[1].plot([0, 1], [1, 0], label='_y', color='r')
186.     axs[1].plot([0, 1], [0, 1], label='z', color='b')
187.     fig.legend()
188. 
189. 
190. def test_gca():
191.     fig = plt.figure()
192. 
193.     # test that gca() picks up Axes created via add_axes()
194.     ax0 = fig.add_axes([0, 0, 1, 1])
195.     assert fig.gca() is ax0
196. 
197.     # test that gca() picks up Axes created via add_subplot()
198.     ax1 = fig.add_subplot(111)
199.     assert fig.gca() is ax1
200. 
201.     # add_axes on an existing Axes should not change stored order, but will
202.     # make it current.
203.     fig.add_axes(ax0)
204.     assert fig.axes == [ax0, ax1]
205.     assert fig.gca() is ax0
206. 
207.     # sca() should not change stored order of Axes, which is order added.
208.     fig.sca(ax0)
209.     assert fig.axes == [ax0, ax1]
210. 
211.     # add_subplot on an existing Axes should not change stored order, but will
212.     # make it current.
213.     fig.add_subplot(ax1)
214.     assert fig.axes == [ax0, ax1]
215.     assert fig.gca() is ax1
216. 
217. 
218. def test_add_subplot_subclass():
219.     fig = plt.figure()
220.     fig.add_subplot(axes_class=Axes)
221.     with pytest.raises(ValueError):
222.         fig.add_subplot(axes_class=Axes, projection="3d")
223.     with pytest.raises(ValueError):
224.         fig.add_subplot(axes_class=Axes, polar=True)
225.     with pytest.raises(ValueError):
226.         fig.add_subplot(projection="3d", polar=True)
227.     with pytest.raises(TypeError):
228.         fig.add_subplot(projection=42)
229. 
230. 
231. def test_add_subplot_invalid():
232.     fig = plt.figure()
233.     with pytest.raises(ValueError,
234.                        match='Number of columns must be a positive integer'):
235.         fig.add_subplot(2, 0, 1)
236.     with pytest.raises(ValueError,
237.                        match='Number of rows must be a positive integer'):
238.         fig.add_subplot(0, 2, 1)
239.     with pytest.raises(ValueError, match='num must be an integer with '
240.                                          '1 <= num <= 4'):
241.         fig.add_subplot(2, 2, 0)
242.     with pytest.raises(ValueError, match='num must be an integer with '
243.                                          '1 <= num <= 4'):
244.         fig.add_subplot(2, 2, 5)
245.     with pytest.raises(ValueError, match='num must be an integer with '
246.                                          '1 <= num <= 4'):
247.         fig.add_subplot(2, 2, 0.5)
248. 
249.     with pytest.raises(ValueError, match='must be a three-digit integer'):
250.         fig.add_subplot(42)
251.     with pytest.raises(ValueError, match='must be a three-digit integer'):
252.         fig.add_subplot(1000)
253. 
254.     with pytest.raises(TypeError, match='takes 1 or 3 positional arguments '
255.                                         'but 2 were given'):
256.         fig.add_subplot(2, 2)
257.     with pytest.raises(TypeError, match='takes 1 or 3 positional arguments '
258.                                         'but 4 were given'):
259.         fig.add_subplot(1, 2, 3, 4)
260.     with pytest.raises(ValueError,
261.                        match="Number of rows must be a positive integer, "
262.                              "not '2'"):
263.         fig.add_subplot('2', 2, 1)
264.     with pytest.raises(ValueError,
265.                        match='Number of columns must be a positive integer, '
266.                              'not 2.0'):
267.         fig.add_subplot(2, 2.0, 1)
268.     _, ax = plt.subplots()
269.     with pytest.raises(ValueError,
270.                        match='The Axes must have been created in the '
271.                              'present figure'):
272.         fig.add_subplot(ax)
273. 
274. 
275. @image_comparison(['figure_suptitle'])
276. def test_suptitle():
277.     fig, _ = plt.subplots()
278.     fig.suptitle('hello', color='r')
279.     fig.suptitle('title', color='g', rotation=30)
280. 
281. 
282. def test_suptitle_fontproperties():
283.     fig, ax = plt.subplots()
284.     fps = mpl.font_manager.FontProperties(size='large', weight='bold')
285.     txt = fig.suptitle('fontprops title', fontproperties=fps)
286.     assert txt.get_fontsize() == fps.get_size_in_points()
287.     assert txt.get_weight() == fps.get_weight()
288. 
289. 
290. def test_suptitle_subfigures():
291.     fig = plt.figure(figsize=(4, 3))
292.     sf1, sf2 = fig.subfigures(1, 2)
293.     sf2.set_facecolor('white')
294.     sf1.subplots()
295.     sf2.subplots()
296.     fig.suptitle("This is a visible suptitle.")
297. 
298.     # verify the first subfigure facecolor is the default transparent
299.     assert sf1.get_facecolor() == (0.0, 0.0, 0.0, 0.0)
300.     # verify the second subfigure facecolor is white
301.     assert sf2.get_facecolor() == (1.0, 1.0, 1.0, 1.0)
302. 
303. 
304. @image_comparison(['alpha_background'],
305.                   # only test png and svg. The PDF output appears correct,
306.                   # but Ghostscript does not preserve the background color.
307.                   extensions=['png', 'svg'],
308.                   savefig_kwarg={'facecolor': (0, 1, 0.4),
309.                                  'edgecolor': 'none'})
310. def test_alpha():
311.     # We want an image which has a background color and an alpha of 0.4.
312.     fig = plt.figure(figsize=[2, 1])
313.     fig.set_facecolor((0, 1, 0.4))
314.     fig.patch.set_alpha(0.4)
315.     fig.patches.append(mpl.patches.CirclePolygon(
316.         [20, 20], radius=15, alpha=0.6, facecolor='red'))
317. 
318. 
319. def test_too_many_figures():
320.     with pytest.warns(RuntimeWarning):
321.         for i in range(mpl.rcParams['figure.max_open_warning'] + 1):
322.             plt.figure()
323. 
324. 
325. def test_iterability_axes_argument():
326. 
327.     # This is a regression test for matplotlib/matplotlib#3196. If one of the
328.     # arguments returned by _as_mpl_axes defines __getitem__ but is not
329.     # iterable, this would raise an exception. This is because we check
330.     # whether the arguments are iterable, and if so we try and convert them
331.     # to a tuple. However, the ``iterable`` function returns True if
332.     # __getitem__ is present, but some classes can define __getitem__ without
333.     # being iterable. The tuple conversion is now done in a try...except in
334.     # case it fails.
335. 
336.     class MyAxes(Axes):
337.         def __init__(self, *args, myclass=None, **kwargs):
338.             Axes.__init__(self, *args, **kwargs)
339. 
340.     class MyClass:
341. 
342.         def __getitem__(self, item):
343.             if item != 'a':
344.                 raise ValueError("item should be a")
345. 
346.         def _as_mpl_axes(self):
347.             return MyAxes, {'myclass': self}
348. 
349.     fig = plt.figure()
350.     fig.add_subplot(1, 1, 1, projection=MyClass())
351.     plt.close(fig)
352. 
353. 
354. def test_set_fig_size():
355.     fig = plt.figure()
356. 
357.     # check figwidth
358.     fig.set_figwidth(5)
359.     assert fig.get_figwidth() == 5
360. 
361.     # check figheight
362.     fig.set_figheight(1)
363.     assert fig.get_figheight() == 1
364. 
365.     # check using set_size_inches
366.     fig.set_size_inches(2, 4)
367.     assert fig.get_figwidth() == 2
368.     assert fig.get_figheight() == 4
369. 
370.     # check using tuple to first argument
371.     fig.set_size_inches((1, 3))
372.     assert fig.get_figwidth() == 1
373.     assert fig.get_figheight() == 3
374. 
375. 
376. def test_axes_remove():
377.     fig, axs = plt.subplots(2, 2)
378.     axs[-1, -1].remove()
379.     for ax in axs.ravel()[:-1]:
380.         assert ax in fig.axes
381.     assert axs[-1, -1] not in fig.axes
382.     assert len(fig.axes) == 3
383. 
384. 
385. def test_figaspect():
386.     w, h = plt.figaspect(np.float64(2) / np.float64(1))
387.     assert h / w == 2
388.     w, h = plt.figaspect(2)
389.     assert h / w == 2
390.     w, h = plt.figaspect(np.zeros((1, 2)))
391.     assert h / w == 0.5
392.     w, h = plt.figaspect(np.zeros((2, 2)))
393.     assert h / w == 1
394. 
395. 
396. @pytest.mark.parametrize('which', ['both', 'major', 'minor'])
397. def test_autofmt_xdate(which):
398.     date = ['3 Jan 2013', '4 Jan 2013', '5 Jan 2013', '6 Jan 2013',
399.             '7 Jan 2013', '8 Jan 2013', '9 Jan 2013', '10 Jan 2013',
400.             '11 Jan 2013', '12 Jan 2013', '13 Jan 2013', '14 Jan 2013']
401. 
402.     time = ['16:44:00', '16:45:00', '16:46:00', '16:47:00', '16:48:00',
403.             '16:49:00', '16:51:00', '16:52:00', '16:53:00', '16:55:00',
404.             '16:56:00', '16:57:00']
405. 
406.     angle = 60
407.     minors = [1, 2, 3, 4, 5, 6, 7]
408. 
409.     x = mdates.datestr2num(date)
410.     y = mdates.datestr2num(time)
411. 
412.     fig, ax = plt.subplots()
413. 
414.     ax.plot(x, y)
415.     ax.yaxis_date()
416.     ax.xaxis_date()
417. 
418.     ax.xaxis.set_minor_locator(AutoMinorLocator(2))
419.     with warnings.catch_warnings():
420.         warnings.filterwarnings(
421.             'ignore',
422.             'FixedFormatter should only be used together with FixedLocator')
423.         ax.xaxis.set_minor_formatter(FixedFormatter(minors))
424. 
425.     fig.autofmt_xdate(0.2, angle, 'right', which)
426. 
427.     if which in ('both', 'major'):
428.         for label in fig.axes[0].get_xticklabels(False, 'major'):
429.             assert int(label.get_rotation()) == angle
430. 
431.     if which in ('both', 'minor'):
432.         for label in fig.axes[0].get_xticklabels(True, 'minor'):
433.             assert int(label.get_rotation()) == angle
434. 
435. 
436. @mpl.style.context('default')
437. def test_change_dpi():
438.     fig = plt.figure(figsize=(4, 4))
439.     fig.draw_without_rendering()
440.     assert fig.canvas.renderer.height == 400
441.     assert fig.canvas.renderer.width == 400
442.     fig.dpi = 50
443.     fig.draw_without_rendering()
444.     assert fig.canvas.renderer.height == 200
445.     assert fig.canvas.renderer.width == 200
446. 
447. 
448. @pytest.mark.parametrize('width, height', [
449.     (1, np.nan),
450.     (-1, 1),
451.     (np.inf, 1)
452. ])
453. def test_invalid_figure_size(width, height):
454.     with pytest.raises(ValueError):
455.         plt.figure(figsize=(width, height))
456. 
457.     fig = plt.figure()
458.     with pytest.raises(ValueError):
459.         fig.set_size_inches(width, height)
460. 
461. 
462. def test_invalid_figure_add_axes():
463.     fig = plt.figure()
464.     with pytest.raises(TypeError,
465.                        match="missing 1 required positional argument: 'rect'"):
466.         fig.add_axes()
467. 
468.     with pytest.raises(ValueError):
469.         fig.add_axes((.1, .1, .5, np.nan))
470. 
471.     with pytest.raises(TypeError, match="multiple values for argument 'rect'"):
472.         fig.add_axes([0, 0, 1, 1], rect=[0, 0, 1, 1])
473. 
474.     _, ax = plt.subplots()
475.     with pytest.raises(ValueError,
476.                        match="The Axes must have been created in the present "
477.                              "figure"):
478.         fig.add_axes(ax)
479. 
480. 
481. def test_subplots_shareax_loglabels():
482.     fig, axs = plt.subplots(2, 2, sharex=True, sharey=True, squeeze=False)
483.     for ax in axs.flat:
484.         ax.plot([10, 20, 30], [10, 20, 30])
485. 
486.     ax.set_yscale("log")
487.     ax.set_xscale("log")
488. 
489.     for ax in axs[0, :]:
490.         assert 0 == len(ax.xaxis.get_ticklabels(which='both'))
491. 
492.     for ax in axs[1, :]:
493.         assert 0 < len(ax.xaxis.get_ticklabels(which='both'))
494. 
495.     for ax in axs[:, 1]:
496.         assert 0 == len(ax.yaxis.get_ticklabels(which='both'))
497. 
498.     for ax in axs[:, 0]:
499.         assert 0 < len(ax.yaxis.get_ticklabels(which='both'))
500.

File: lib/matplotlib/tests/test_pickle.py
Line number range: 1 - 284
Content:
1. from io import BytesIO
2. import ast
3. import pickle
4. 
5. import numpy as np
6. import pytest
7. 
8. import matplotlib as mpl
9. from matplotlib import cm
10. from matplotlib.testing import subprocess_run_helper
11. from matplotlib.testing.decorators import check_figures_equal
12. from matplotlib.dates import rrulewrapper
13. from matplotlib.lines import VertexSelector
14. import matplotlib.pyplot as plt
15. import matplotlib.transforms as mtransforms
16. import matplotlib.figure as mfigure
17. from mpl_toolkits.axes_grid1 import parasite_axes
18. 
19. 
20. def test_simple():
21.     fig = plt.figure()
22.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
23. 
24.     ax = plt.subplot(121)
25.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
26. 
27.     ax = plt.axes(projection='polar')
28.     plt.plot(np.arange(10), label='foobar')
29.     plt.legend()
30. 
31.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
32. 
33. #    ax = plt.subplot(121, projection='hammer')
34. #    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
35. 
36.     plt.figure()
37.     plt.bar(x=np.arange(10), height=np.arange(10))
38.     pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)
39. 
40.     fig = plt.figure()
41.     ax = plt.axes()
42.     plt.plot(np.arange(10))
43.     ax.set_yscale('log')
44.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
45. 
46. 
47. def _generate_complete_test_figure(fig_ref):
48.     fig_ref.set_size_inches((10, 6))
49.     plt.figure(fig_ref)
50. 
51.     plt.suptitle('Can you fit any more in a figure?')
52. 
53.     # make some arbitrary data
54.     x, y = np.arange(8), np.arange(10)
55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)
56.     v = np.sin(v * -0.6)
57. 
58.     # Ensure lists also pickle correctly.
59.     plt.subplot(3, 3, 1)
60.     plt.plot(list(range(10)))
61. 
62.     plt.subplot(3, 3, 2)
63.     plt.contourf(data, hatches=['//', 'ooo'])
64.     plt.colorbar()
65. 
66.     plt.subplot(3, 3, 3)
67.     plt.pcolormesh(data)
68. 
69.     plt.subplot(3, 3, 4)
70.     plt.imshow(data)
71. 
72.     plt.subplot(3, 3, 5)
73.     plt.pcolor(data)
74. 
75.     ax = plt.subplot(3, 3, 6)
76.     ax.set_xlim(0, 7)
77.     ax.set_ylim(0, 9)
78.     plt.streamplot(x, y, u, v)
79. 
80.     ax = plt.subplot(3, 3, 7)
81.     ax.set_xlim(0, 7)
82.     ax.set_ylim(0, 9)
83.     plt.quiver(x, y, u, v)
84. 
85.     plt.subplot(3, 3, 8)
86.     plt.scatter(x, x ** 2, label='$x^2$')
87.     plt.legend(loc='upper left')
88. 
89.     plt.subplot(3, 3, 9)
90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)
91. 
92. 
93. @mpl.style.context("default")
94. @check_figures_equal(extensions=["png"])
95. def test_complete(fig_test, fig_ref):
96.     _generate_complete_test_figure(fig_ref)
97.     # plotting is done, now test its pickle-ability
98.     pkl = BytesIO()
99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)
100.     loaded = pickle.loads(pkl.getbuffer())
101.     loaded.canvas.draw()
102. 
103.     fig_test.set_size_inches(loaded.get_size_inches())
104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())
105. 
106.     plt.close(loaded)
107. 
108. 
109. def _pickle_load_subprocess():
110.     import os
111.     import pickle
112. 
113.     path = os.environ['PICKLE_FILE_PATH']
114. 
115.     with open(path, 'rb') as blob:
116.         fig = pickle.load(blob)
117. 
118.     print(str(pickle.dumps(fig)))
119. 
120. 
121. @mpl.style.context("default")
122. @check_figures_equal(extensions=['png'])
123. def test_pickle_load_from_subprocess(fig_test, fig_ref, tmp_path):
124.     _generate_complete_test_figure(fig_ref)
125. 
126.     fp = tmp_path / 'sinus.pickle'
127.     assert not fp.exists()
128. 
129.     with fp.open('wb') as file:
130.         pickle.dump(fig_ref, file, pickle.HIGHEST_PROTOCOL)
131.     assert fp.exists()
132. 
133.     proc = subprocess_run_helper(
134.         _pickle_load_subprocess,
135.         timeout=60,
136.         extra_env={'PICKLE_FILE_PATH': str(fp)}
137.     )
138. 
139.     loaded_fig = pickle.loads(ast.literal_eval(proc.stdout))
140. 
141.     loaded_fig.canvas.draw()
142. 
143.     fig_test.set_size_inches(loaded_fig.get_size_inches())
144.     fig_test.figimage(loaded_fig.canvas.renderer.buffer_rgba())
145. 
146.     plt.close(loaded_fig)
147. 
148. 
149. def test_gcf():
150.     fig = plt.figure("a label")
151.     buf = BytesIO()
152.     pickle.dump(fig, buf, pickle.HIGHEST_PROTOCOL)
153.     plt.close("all")
154.     assert plt._pylab_helpers.Gcf.figs == {}  # No figures must be left.
155.     fig = pickle.loads(buf.getbuffer())
156.     assert plt._pylab_helpers.Gcf.figs != {}  # A manager is there again.
157.     assert fig.get_label() == "a label"
158. 
159. 
160. def test_no_pyplot():
161.     # tests pickle-ability of a figure not created with pyplot
162.     from matplotlib.backends.backend_pdf import FigureCanvasPdf
163.     fig = mfigure.Figure()
164.     _ = FigureCanvasPdf(fig)
165.     ax = fig.add_subplot(1, 1, 1)
166.     ax.plot([1, 2, 3], [1, 2, 3])
167.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
168. 
169. 
170. def test_renderer():
171.     from matplotlib.backends.backend_agg import RendererAgg
172.     renderer = RendererAgg(10, 20, 30)
173.     pickle.dump(renderer, BytesIO())
174. 
175. 
176. def test_image():
177.     # Prior to v1.4.0 the Image would cache data which was not picklable
178.     # once it had been drawn.
179.     from matplotlib.backends.backend_agg import new_figure_manager
180.     manager = new_figure_manager(1000)
181.     fig = manager.canvas.figure
182.     ax = fig.add_subplot(1, 1, 1)
183.     ax.imshow(np.arange(12).reshape(3, 4))
184.     manager.canvas.draw()
185.     pickle.dump(fig, BytesIO())
186. 
187. 
188. def test_polar():
189.     plt.subplot(polar=True)
190.     fig = plt.gcf()
191.     pf = pickle.dumps(fig)
192.     pickle.loads(pf)
193.     plt.draw()
194. 
195. 
196. class TransformBlob:
197.     def __init__(self):
198.         self.identity = mtransforms.IdentityTransform()
199.         self.identity2 = mtransforms.IdentityTransform()
200.         # Force use of the more complex composition.
201.         self.composite = mtransforms.CompositeGenericTransform(
202.             self.identity,
203.             self.identity2)
204.         # Check parent -> child links of TransformWrapper.
205.         self.wrapper = mtransforms.TransformWrapper(self.composite)
206.         # Check child -> parent links of TransformWrapper.
207.         self.composite2 = mtransforms.CompositeGenericTransform(
208.             self.wrapper,
209.             self.identity)
210. 
211. 
212. def test_transform():
213.     obj = TransformBlob()
214.     pf = pickle.dumps(obj)
215.     del obj
216. 
217.     obj = pickle.loads(pf)
218.     # Check parent -> child links of TransformWrapper.
219.     assert obj.wrapper._child == obj.composite
220.     # Check child -> parent links of TransformWrapper.
221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]
222.     # Check input and output dimensions are set as expected.
223.     assert obj.wrapper.input_dims == obj.composite.input_dims
224.     assert obj.wrapper.output_dims == obj.composite.output_dims
225. 
226. 
227. def test_rrulewrapper():
228.     r = rrulewrapper(2)
229.     try:
230.         pickle.loads(pickle.dumps(r))
231.     except RecursionError:
232.         print('rrulewrapper pickling test failed')
233.         raise
234. 
235. 
236. def test_shared():
237.     fig, axs = plt.subplots(2, sharex=True)
238.     fig = pickle.loads(pickle.dumps(fig))
239.     fig.axes[0].set_xlim(10, 20)
240.     assert fig.axes[1].get_xlim() == (10, 20)
241. 
242. 
243. def test_inset_and_secondary():
244.     fig, ax = plt.subplots()
245.     ax.inset_axes([.1, .1, .3, .3])
246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))
247.     pickle.loads(pickle.dumps(fig))
248. 
249. 
250. @pytest.mark.parametrize("cmap", cm._colormaps.values())
251. def test_cmap(cmap):
252.     pickle.dumps(cmap)
253. 
254. 
255. def test_unpickle_canvas():
256.     fig = mfigure.Figure()
257.     assert fig.canvas is not None
258.     out = BytesIO()
259.     pickle.dump(fig, out)
260.     out.seek(0)
261.     fig2 = pickle.load(out)
262.     assert fig2.canvas is not None
263. 
264. 
265. def test_mpl_toolkits():
266.     ax = parasite_axes.host_axes([0, 0, 1, 1])
267.     assert type(pickle.loads(pickle.dumps(ax))) == parasite_axes.HostAxes
268. 
269. 
270. def test_standard_norm():
271.     assert type(pickle.loads(pickle.dumps(mpl.colors.LogNorm()))) \
272.         == mpl.colors.LogNorm
273. 
274. 
275. def test_dynamic_norm():
276.     logit_norm_instance = mpl.colors.make_norm_from_scale(
277.         mpl.scale.LogitScale, mpl.colors.Normalize)()
278.     assert type(pickle.loads(pickle.dumps(logit_norm_instance))) \
279.         == type(logit_norm_instance)
280. 
281. 
282. def test_vertexselector():
283.     line, = plt.plot([0, 1], picker=True)
284.     pickle.loads(pickle.dumps(VertexSelector(line)))


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-06 15:43:30,332 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user is experiencing a pickling error with `fig.align_labels()`.\n   - This context provides a test case that specifically targets the `align_labels()` method.\n2. Extended relevance:\n   - This test demonstrates the intended use of `align_labels()` with multiple subplots, which is similar to the user's bug report.\n   - It's crucial for understanding how `align_labels()` is supposed to function and how it is tested in the library.", relative_path='lib/matplotlib/tests/test_figure.py', start_line=28, end_line=68), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's bug is a `TypeError` during pickling.\n   - This context provides a foundational test case for pickling a simple Matplotlib figure and axes.\n2. Extended relevance:\n   - This test, `test_simple`, establishes the baseline for expected pickling behavior. It's a starting point for diagnosing why a more complex figure (one with aligned labels) fails to pickle.", relative_path='lib/matplotlib/tests/test_pickle.py', start_line=20, end_line=45), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user needs to understand how to properly test pickling of figures.\n   - This context provides a comprehensive test for pickling a complex figure with multiple plot types.\n2. Extended relevance:\n   - The test includes a helper function `_generate_complete_test_figure` to build the figure, pickles it, loads it, and then compares the rendered output with the original. This pattern is a blueprint for how a regression test for the user's bug should be structured.", relative_path='lib/matplotlib/tests/test_pickle.py', start_line=47, end_line=107), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's bug involves multiple subplots, and `align_labels` coordinates these subplots.\n   - This context tests the pickling of a figure with shared axes, a common feature for subplots.\n2. Extended relevance:\n   - The `weakref` error in the bug report suggests an issue with object relationships. Shared axes create explicit relationships between axes objects. This test is relevant because it shows how such relationships are handled during pickling, which might give clues to the `align_labels` issue.", relative_path='lib/matplotlib/tests/test_pickle.py', start_line=236, end_line=241), ContextOutput(reasoning='1. Query requirement analysis:\n   - The user requested complete, self-contained test cases, which require imports.\n   - This context provides all the necessary imports for the test cases extracted from `lib/matplotlib/tests/test_pickle.py`.\n2. Extended relevance:\n   - Including this context ensures that the provided test snippets from `test_pickle.py` are complete and can be understood and run in the correct environment.', relative_path='lib/matplotlib/tests/test_pickle.py', start_line=1, end_line=18)]
2025-10-06 15:43:30,333 - thread-139660780025408.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='236. def test_shared():\n237.     fig, axs = plt.subplots(2, sharex=True)\n238.     fig = pickle.loads(pickle.dumps(fig))\n239.     fig.axes[0].set_xlim(10, 20)\n240.     assert fig.axes[1].get_xlim() == (10, 20)\n241. ', start_line_number=236, end_line_number=241), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='243. def test_inset_and_secondary():\n244.     fig, ax = plt.subplots()\n245.     ax.inset_axes([.1, .1, .3, .3])\n246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))\n247.     pickle.loads(pickle.dumps(fig))\n248. ', start_line_number=243, end_line_number=248), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='196. class TransformBlob:\n197.     def __init__(self):\n198.         self.identity = mtransforms.IdentityTransform()\n199.         self.identity2 = mtransforms.IdentityTransform()\n200.         # Force use of the more complex composition.\n201.         self.composite = mtransforms.CompositeGenericTransform(\n202.             self.identity,\n203.             self.identity2)\n204.         # Check parent -> child links of TransformWrapper.\n205.         self.wrapper = mtransforms.TransformWrapper(self.composite)\n206.         # Check child -> parent links of TransformWrapper.\n207.         self.composite2 = mtransforms.CompositeGenericTransform(\n208.             self.wrapper,\n209.             self.identity)\n210. \n211. \n212. def test_transform():\n213.     obj = TransformBlob()\n214.     pf = pickle.dumps(obj)\n215.     del obj\n216. \n217.     obj = pickle.loads(pf)\n218.     # Check parent -> child links of TransformWrapper.\n219.     assert obj.wrapper._child == obj.composite\n220.     # Check child -> parent links of TransformWrapper.\n221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]\n222.     # Check input and output dimensions are set as expected.\n223.     assert obj.wrapper.input_dims == obj.composite.input_dims\n224.     assert obj.wrapper.output_dims == obj.composite.output_dims\n225. ', start_line_number=196, end_line_number=225), Context(relative_path='lib/matplotlib/tests/test_figure.py', content='28. @image_comparison([\'figure_align_labels\'], extensions=[\'png\', \'svg\'],\n29.                   tol=0 if platform.machine() == \'x86_64\' else 0.01)\n30. def test_align_labels():\n31.     fig = plt.figure(layout=\'tight\')\n32.     gs = gridspec.GridSpec(3, 3)\n33. \n34.     ax = fig.add_subplot(gs[0, :2])\n35.     ax.plot(np.arange(0, 1e6, 1000))\n36.     ax.set_ylabel(\'Ylabel0 0\')\n37.     ax = fig.add_subplot(gs[0, -1])\n38.     ax.plot(np.arange(0, 1e4, 100))\n39. \n40.     for i in range(3):\n41.         ax = fig.add_subplot(gs[1, i])\n42.         ax.set_ylabel(\'YLabel1 %d\' % i)\n43.         ax.set_xlabel(\'XLabel1 %d\' % i)\n44.         if i in [0, 2]:\n45.             ax.xaxis.set_label_position("top")\n46.             ax.xaxis.tick_top()\n47.         if i == 0:\n48.             for tick in ax.get_xticklabels():\n49.                 tick.set_rotation(90)\n50.         if i == 2:\n51.             ax.yaxis.set_label_position("right")\n52.             ax.yaxis.tick_right()\n53. \n54.     for i in range(3):\n55.         ax = fig.add_subplot(gs[2, i])\n56.         ax.set_xlabel(f\'XLabel2 {i}\')\n57.         ax.set_ylabel(f\'YLabel2 {i}\')\n58. \n59.         if i == 2:\n60.             ax.plot(np.arange(0, 1e4, 10))\n61.             ax.yaxis.set_label_position("right")\n62.             ax.yaxis.tick_right()\n63.             for tick in ax.get_xticklabels():\n64.                 tick.set_rotation(90)\n65. \n66.     fig.align_labels()\n67. \n68. ', start_line_number=28, end_line_number=68), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content="20. def test_simple():\n21.     fig = plt.figure()\n22.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n23. \n24.     ax = plt.subplot(121)\n25.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n26. \n27.     ax = plt.axes(projection='polar')\n28.     plt.plot(np.arange(10), label='foobar')\n29.     plt.legend()\n30. \n31.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n32. \n33. #    ax = plt.subplot(121, projection='hammer')\n34. #    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n35. \n36.     plt.figure()\n37.     plt.bar(x=np.arange(10), height=np.arange(10))\n38.     pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)\n39. \n40.     fig = plt.figure()\n41.     ax = plt.axes()\n42.     plt.plot(np.arange(10))\n43.     ax.set_yscale('log')\n44.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n45. ", start_line_number=20, end_line_number=45), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='47. def _generate_complete_test_figure(fig_ref):\n48.     fig_ref.set_size_inches((10, 6))\n49.     plt.figure(fig_ref)\n50. \n51.     plt.suptitle(\'Can you fit any more in a figure?\')\n52. \n53.     # make some arbitrary data\n54.     x, y = np.arange(8), np.arange(10)\n55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)\n56.     v = np.sin(v * -0.6)\n57. \n58.     # Ensure lists also pickle correctly.\n59.     plt.subplot(3, 3, 1)\n60.     plt.plot(list(range(10)))\n61. \n62.     plt.subplot(3, 3, 2)\n63.     plt.contourf(data, hatches=[\'//\', \'ooo\'])\n64.     plt.colorbar()\n65. \n66.     plt.subplot(3, 3, 3)\n67.     plt.pcolormesh(data)\n68. \n69.     plt.subplot(3, 3, 4)\n70.     plt.imshow(data)\n71. \n72.     plt.subplot(3, 3, 5)\n73.     plt.pcolor(data)\n74. \n75.     ax = plt.subplot(3, 3, 6)\n76.     ax.set_xlim(0, 7)\n77.     ax.set_ylim(0, 9)\n78.     plt.streamplot(x, y, u, v)\n79. \n80.     ax = plt.subplot(3, 3, 7)\n81.     ax.set_xlim(0, 7)\n82.     ax.set_ylim(0, 9)\n83.     plt.quiver(x, y, u, v)\n84. \n85.     plt.subplot(3, 3, 8)\n86.     plt.scatter(x, x ** 2, label=\'$x^2$\')\n87.     plt.legend(loc=\'upper left\')\n88. \n89.     plt.subplot(3, 3, 9)\n90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)\n91. \n92. \n93. @mpl.style.context("default")\n94. @check_figures_equal(extensions=["png"])\n95. def test_complete(fig_test, fig_ref):\n96.     _generate_complete_test_figure(fig_ref)\n97.     # plotting is done, now test its pickle-ability\n98.     pkl = BytesIO()\n99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)\n100.     loaded = pickle.loads(pkl.getbuffer())\n101.     loaded.canvas.draw()\n102. \n103.     fig_test.set_size_inches(loaded.get_size_inches())\n104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())\n105. \n106.     plt.close(loaded)\n107. ', start_line_number=47, end_line_number=107), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='1. from io import BytesIO\n2. import ast\n3. import pickle\n4. \n5. import numpy as np\n6. import pytest\n7. \n8. import matplotlib as mpl\n9. from matplotlib import cm\n10. from matplotlib.testing import subprocess_run_helper\n11. from matplotlib.testing.decorators import check_figures_equal\n12. from matplotlib.dates import rrulewrapper\n13. from matplotlib.lines import VertexSelector\n14. import matplotlib.pyplot as plt\n15. import matplotlib.transforms as mtransforms\n16. import matplotlib.figure as mfigure\n17. from mpl_toolkits.axes_grid1 import parasite_axes\n18. ', start_line_number=1, end_line_number=18)]
2025-10-06 15:43:30,333 - thread-139660780025408.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-06 15:43:30,333 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
matplotlib
├── .appveyor.yml
├── .circleci
|   ├── config.yml
|   ├── deploy-docs.sh
|   └── fetch_doc_logs.py
├── .git_archival.txt
├── .github
|   ├── CONTRIBUTING.md
|   ├── FUNDING.yml
|   ├── ISSUE_TEMPLATE
|   |   ├── bug_report.yml
|   |   ├── config.yml
|   |   ├── documentation.yml
|   |   ├── feature_request.yml
|   |   └── maintenance.yml
|   ├── PULL_REQUEST_TEMPLATE.md
|   ├── codecov.yml
|   ├── dependabot.yml
|   └── workflows
|       ├── cibuildsdist.yml
|       ├── cibuildwheel.yml
|       ├── circleci.yml
|       ├── clean_pr.yml
|       ├── codeql-analysis.yml
|       ├── conflictcheck.yml
|       ├── cygwin.yml
|       ├── nightlies.yml
|       ├── pr_welcome.yml
|       ├── reviewdog.yml
|       ├── stale.yml
|       └── tests.yml
├── .lgtm.yml
├── .meeseeksdev.yml
├── .pre-commit-config.yaml
├── CODE_OF_CONDUCT.md
├── INSTALL.rst
├── LICENSE
├── README.md
├── SECURITY.md
├── azure-pipelines.yml
├── ci
|   ├── check_version_number.py
|   ├── check_wheel_licenses.py
|   └── codespell-ignore-words.txt
├── doc
|   ├── README.txt
|   ├── _static
|   |   ├── fa
|   |   ├── markers
|   |   └── zenodo_cache
|   ├── _templates
|   |   ├── autofunctions.rst
|   |   ├── automodule.rst
|   |   ├── autosummary.rst
|   |   ├── autosummary_class_only.rst
|   |   └── function.rst
|   ├── api
|   |   ├── _api_api.rst
|   |   ├── _enums_api.rst
|   |   ├── afm_api.rst
|   |   ├── animation_api.rst
|   |   ├── artist_api.rst
|   |   ├── axes_api.rst
|   |   ├── axis_api.rst
|   |   ├── backend_agg_api.rst
|   |   ├── backend_bases_api.rst
|   |   ├── backend_cairo_api.rst
|   |   ├── backend_gtk3_api.rst
|   |   ├── backend_gtk4_api.rst
|   |   ├── backend_managers_api.rst
|   |   ├── backend_mixed_api.rst
|   |   ├── backend_nbagg_api.rst
|   |   ├── backend_pdf_api.rst
|   |   ├── backend_pgf_api.rst
|   |   ├── backend_ps_api.rst
|   |   ├── backend_qt_api.rst
|   |   ├── backend_svg_api.rst
|   |   ├── backend_template_api.rst
|   |   ├── backend_tk_api.rst
|   |   ├── backend_tools_api.rst
|   |   ├── backend_webagg_api.rst
|   |   ├── backend_wx_api.rst
|   |   ├── bezier_api.rst
|   |   ├── category_api.rst
|   |   ├── cbook_api.rst
|   |   ├── cm_api.rst
|   |   ├── collections_api.rst
|   |   ├── colorbar_api.rst
|   |   ├── colors_api.rst
|   |   ├── container_api.rst
|   |   ├── contour_api.rst
|   |   ├── dates_api.rst
|   |   ├── docstring_api.rst
|   |   ├── dviread.rst
|   |   ├── figure_api.rst
|   |   ├── font_manager_api.rst
|   |   ├── ft2font.rst
|   |   ├── gridspec_api.rst
|   |   ├── hatch_api.rst
|   |   ├── image_api.rst
|   |   ├── index.rst
|   |   ├── index_backend_api.rst
|   |   ├── layout_engine_api.rst
|   |   ├── legend_api.rst
|   |   ├── legend_handler_api.rst
|   |   ├── lines_api.rst
|   |   ├── markers_api.rst
|   |   ├── mathtext_api.rst
|   |   ├── matplotlib_configuration_api.rst
|   |   ├── mlab_api.rst
|   |   ├── next_api_changes
|   |   |   ├── README.rst
|   |   |   ├── behavior
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 25061-DS.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   ├── 25112-GG.rst
|   |   |   |   ├── 25192-DS.rst
|   |   |   |   └── 25255-RR.rst
|   |   |   ├── deprecations
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   ├── 24913-AL.rst
|   |   |   |   ├── 24985-OG.rst
|   |   |   |   ├── 24990-OG.rst
|   |   |   |   ├── 25101-AL.rst
|   |   |   |   └── 25282-AL.rst
|   |   |   ├── development
|   |   |   |   ├── 00001-ABC.rst
|   |   |   |   └── 24919-KS.rst
|   |   |   └── removals
|   |   |       ├── 00001-ABC.rst
|   |   |       ├── 24923-ES.rst
|   |   |       └── 24XXX-OG.rst
|   |   ├── next_api_changes.rst
|   |   ├── offsetbox_api.rst
|   |   ├── patches_api.rst
|   |   ├── path_api.rst
|   |   ├── patheffects_api.rst
|   |   ├── prev_api_changes
|   |   |   ├── api_changes_0.40.rst
|   |   |   ├── api_changes_0.42.rst
|   |   |   ├── api_changes_0.50.rst
|   |   |   ├── api_changes_0.54.3.rst
|   |   |   ├── api_changes_0.54.rst
|   |   |   ├── api_changes_0.60.rst
|   |   |   ├── api_changes_0.61.rst
|   |   |   ├── api_changes_0.63.rst
|   |   |   ├── api_changes_0.65.1.rst
|   |   |   ├── api_changes_0.65.rst
|   |   |   ├── api_changes_0.70.rst
|   |   |   ├── api_changes_0.71.rst
|   |   |   ├── api_changes_0.72.rst
|   |   |   ├── api_changes_0.73.rst
|   |   |   ├── api_changes_0.80.rst
|   |   |   ├── api_changes_0.81.rst
|   |   |   ├── api_changes_0.82.rst
|   |   |   ├── api_changes_0.83.rst
|   |   |   ├── api_changes_0.84.rst
|   |   |   ├── api_changes_0.85.rst
|   |   |   ├── api_changes_0.86.rst
|   |   |   ├── api_changes_0.87.7.rst
|   |   |   ├── api_changes_0.90.0.rst
|   |   |   ├── api_changes_0.90.1.rst
|   |   |   ├── api_changes_0.91.0.rst
|   |   |   ├── api_changes_0.91.2.rst
|   |   |   ├── api_changes_0.98.0.rst
|   |   |   ├── api_changes_0.98.1.rst
|   |   |   ├── api_changes_0.98.x.rst
|   |   |   ├── api_changes_0.99.rst
|   |   |   ├── api_changes_0.99.x.rst
|   |   |   ├── api_changes_1.1.x.rst
|   |   |   ├── api_changes_1.2.x.rst
|   |   |   ├── api_changes_1.3.x.rst
|   |   |   ├── api_changes_1.4.x.rst
|   |   |   ├── api_changes_1.5.0.rst
|   |   |   ├── api_changes_1.5.2.rst
|   |   |   ├── api_changes_1.5.3.rst
|   |   |   ├── api_changes_2.0.0.rst
|   |   |   ├── api_changes_2.0.1.rst
|   |   |   ├── api_changes_2.1.0.rst
|   |   |   ├── api_changes_2.1.1.rst
|   |   |   ├── api_changes_2.1.2.rst
|   |   |   ├── api_changes_2.2.0.rst
|   |   |   ├── api_changes_3.0.0.rst
|   |   |   ├── api_changes_3.0.1.rst
|   |   |   ├── api_changes_3.1.0.rst
|   |   |   ├── api_changes_3.1.1.rst
|   |   |   ├── api_changes_3.2.0
|   |   |   |   ├── behavior.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.2.0.rst
|   |   |   ├── api_changes_3.3.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.3.0.rst
|   |   |   ├── api_changes_3.3.1.rst
|   |   |   ├── api_changes_3.4.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.4.0.rst
|   |   |   ├── api_changes_3.4.2.rst
|   |   |   ├── api_changes_3.5.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.5.0.rst
|   |   |   ├── api_changes_3.5.2.rst
|   |   |   ├── api_changes_3.5.3.rst
|   |   |   ├── api_changes_3.6.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   ├── api_changes_3.6.0.rst
|   |   |   ├── api_changes_3.6.1.rst
|   |   |   ├── api_changes_3.7.0
|   |   |   |   ├── behaviour.rst
|   |   |   |   ├── deprecations.rst
|   |   |   |   ├── development.rst
|   |   |   |   └── removals.rst
|   |   |   └── api_changes_3.7.0.rst
|   |   ├── projections
|   |   |   ├── geo.rst
|   |   |   └── polar.rst
|   |   ├── projections_api.rst
|   |   ├── pyplot_summary.rst
|   |   ├── quiver_api.rst
|   |   ├── rcsetup_api.rst
|   |   ├── sankey_api.rst
|   |   ├── scale_api.rst
|   |   ├── sphinxext_mathmpl_api.rst
|   |   ├── sphinxext_plot_directive_api.rst
|   |   ├── spines_api.rst
|   |   ├── style_api.rst
|   |   ├── table_api.rst
|   |   ├── testing_api.rst
|   |   ├── texmanager_api.rst
|   |   ├── text_api.rst
|   |   ├── ticker_api.rst
|   |   ├── tight_bbox_api.rst
|   |   ├── tight_layout_api.rst
|   |   ├── toolkits
|   |   |   ├── axes_grid1.rst
|   |   |   ├── axisartist.rst
|   |   |   ├── mplot3d
|   |   |   |   ├── axes3d.rst
|   |   |   |   ├── faq.rst
|   |   |   |   └── view_angles.rst
|   |   |   └── mplot3d.rst
|   |   ├── transformations.rst
|   |   ├── tri_api.rst
|   |   ├── type1font.rst
|   |   ├── units_api.rst
|   |   └── widgets_api.rst
|   ├── conf.py
|   ├── devel
|   |   ├── MEP
|   |   |   ├── MEP08.rst
|   |   |   ├── MEP09.rst
|   |   |   ├── MEP10.rst
|   |   |   ├── MEP11.rst
|   |   |   ├── MEP12.rst
|   |   |   ├── MEP13.rst
|   |   |   ├── MEP14.rst
|   |   |   ├── MEP15.rst
|   |   |   ├── MEP19.rst
|   |   |   ├── MEP21.rst
|   |   |   ├── MEP22.rst
|   |   |   ├── MEP23.rst
|   |   |   ├── MEP24.rst
|   |   |   ├── MEP25.rst
|   |   |   ├── MEP26.rst
|   |   |   ├── MEP27.rst
|   |   |   ├── MEP28.rst
|   |   |   ├── MEP29.rst
|   |   |   ├── README.rst
|   |   |   ├── index.rst
|   |   |   └── template.rst
|   |   ├── README.txt
|   |   ├── coding_guide.rst
|   |   ├── color_changes.rst
|   |   ├── contributing.rst
|   |   ├── dependencies.rst
|   |   ├── development_setup.rst
|   |   ├── development_workflow.rst
|   |   ├── documenting_mpl.rst
|   |   ├── index.rst
|   |   ├── license.rst
|   |   ├── maintainer_workflow.rst
|   |   ├── min_dep_policy.rst
|   |   ├── release_guide.rst
|   |   ├── style_guide.rst
|   |   ├── testing.rst
|   |   └── triage.rst
|   ├── index.rst
|   ├── sphinxext
|   |   ├── __init__.py
|   |   ├── custom_roles.py
|   |   ├── gallery_order.py
|   |   ├── github.py
|   |   ├── math_symbol_table.py
|   |   ├── missing_references.py
|   |   ├── mock_gui_toolkits.py
|   |   ├── redirect_from.py
|   |   └── skip_deprecated.py
|   ├── thirdpartypackages
|   |   └── index.rst
|   └── users
|       ├── explain
|       |   ├── api_interfaces.rst
|       |   ├── backends.rst
|       |   ├── event_handling.rst
|       |   ├── figures.rst
|       |   ├── fonts.rst
|       |   ├── index.rst
|       |   ├── interactive.rst
|       |   ├── interactive_guide.rst
|       |   ├── performance.rst
|       |   └── writing_a_backend_pyplot_interface.rst
|       ├── faq
|       |   ├── environment_variables_faq.rst
|       |   ├── howto_faq.rst
|       |   ├── index.rst
|       |   └── troubleshooting_faq.rst
|       ├── generate_credits.py
|       ├── getting_started
|       |   └── index.rst
|       ├── github_stats.rst
|       ├── index.rst
|       ├── installing
|       |   └── index.rst
|       ├── next_whats_new
|       |   ├── README.rst
|       |   ├── pie_hatch.rst
|       |   ├── savefig_bbox_layout.rst
|       |   └── widget_button_styling.rst
|       ├── next_whats_new.rst
|       ├── prev_whats_new
|       |   ├── changelog.rst
|       |   ├── dflt_style_changes.rst
|       |   ├── github_stats_3.0.0.rst
|       |   ├── github_stats_3.0.1.rst
|       |   ├── github_stats_3.0.2.rst
|       |   ├── github_stats_3.0.3.rst
|       |   ├── github_stats_3.1.0.rst
|       |   ├── github_stats_3.1.1.rst
|       |   ├── github_stats_3.1.2.rst
|       |   ├── github_stats_3.1.3.rst
|       |   ├── github_stats_3.2.0.rst
|       |   ├── github_stats_3.2.1.rst
|       |   ├── github_stats_3.2.2.rst
|       |   ├── github_stats_3.3.0.rst
|       |   ├── github_stats_3.3.1.rst
|       |   ├── github_stats_3.3.2.rst
|       |   ├── github_stats_3.3.3.rst
|       |   ├── github_stats_3.3.4.rst
|       |   ├── github_stats_3.4.0.rst
|       |   ├── github_stats_3.4.1.rst
|       |   ├── github_stats_3.4.2.rst
|       |   ├── github_stats_3.4.3.rst
|       |   ├── github_stats_3.5.0.rst
|       |   ├── github_stats_3.5.1.rst
|       |   ├── github_stats_3.5.2.rst
|       |   ├── github_stats_3.5.3.rst
|       |   ├── github_stats_3.6.0.rst
|       |   ├── github_stats_3.6.1.rst
|       |   ├── github_stats_3.6.2.rst
|       |   ├── github_stats_3.6.3.rst
|       |   ├── whats_new_0.98.4.rst
|       |   ├── whats_new_0.99.rst
|       |   ├── whats_new_1.0.rst
|       |   ├── whats_new_1.1.rst
|       |   ├── whats_new_1.2.2.rst
|       |   ├── whats_new_1.2.rst
|       |   ├── whats_new_1.3.rst
|       |   ├── whats_new_1.4.rst
|       |   ├── whats_new_1.5.rst
|       |   ├── whats_new_2.0.0.rst
|       |   ├── whats_new_2.1.0.rst
|       |   ├── whats_new_2.2.rst
|       |   ├── whats_new_3.0.rst
|       |   ├── whats_new_3.1.0.rst
|       |   ├── whats_new_3.2.0.rst
|       |   ├── whats_new_3.3.0.rst
|       |   ├── whats_new_3.4.0.rst
|       |   ├── whats_new_3.5.0.rst
|       |   ├── whats_new_3.5.2.rst
|       |   ├── whats_new_3.6.0.rst
|       |   └── whats_new_3.7.0.rst
|       ├── project
|       |   ├── citing.rst
|       |   ├── credits.rst
|       |   ├── history.rst
|       |   ├── index.rst
|       |   ├── license.rst
|       |   └── mission.rst
|       ├── release_notes.rst
|       ├── release_notes_next.rst
|       └── resources
|           └── index.rst
├── environment.yml
├── extern
|   ├── agg24-svn
|   |   ├── include
|   |   |   ├── ctrl
|   |   |   ├── platform
|   |   |   |   ├── mac
|   |   |   |   └── win32
|   |   |   └── util
|   |   └── src
|   |       ├── agg_arc.cpp
|   |       ├── agg_arrowhead.cpp
|   |       ├── agg_bezier_arc.cpp
|   |       ├── agg_bspline.cpp
|   |       ├── agg_color_rgba.cpp
|   |       ├── agg_curves.cpp
|   |       ├── agg_embedded_raster_fonts.cpp
|   |       ├── agg_gsv_text.cpp
|   |       ├── agg_image_filters.cpp
|   |       ├── agg_line_aa_basics.cpp
|   |       ├── agg_line_profile_aa.cpp
|   |       ├── agg_rounded_rect.cpp
|   |       ├── agg_sqrt_tables.cpp
|   |       ├── agg_trans_affine.cpp
|   |       ├── agg_trans_double_path.cpp
|   |       ├── agg_trans_single_path.cpp
|   |       ├── agg_trans_warp_magnifier.cpp
|   |       ├── agg_vcgen_bspline.cpp
|   |       ├── agg_vcgen_contour.cpp
|   |       ├── agg_vcgen_dash.cpp
|   |       ├── agg_vcgen_markers_term.cpp
|   |       ├── agg_vcgen_smooth_poly1.cpp
|   |       ├── agg_vcgen_stroke.cpp
|   |       ├── agg_vpgen_clip_polygon.cpp
|   |       ├── agg_vpgen_clip_polyline.cpp
|   |       ├── agg_vpgen_segmentator.cpp
|   |       ├── ctrl
|   |       |   ├── agg_bezier_ctrl.cpp
|   |       |   ├── agg_cbox_ctrl.cpp
|   |       |   ├── agg_gamma_ctrl.cpp
|   |       |   ├── agg_gamma_spline.cpp
|   |       |   ├── agg_polygon_ctrl.cpp
|   |       |   ├── agg_rbox_ctrl.cpp
|   |       |   ├── agg_scale_ctrl.cpp
|   |       |   ├── agg_slider_ctrl.cpp
|   |       |   └── agg_spline_ctrl.cpp
|   |       └── platform
|   |           ├── AmigaOS
|   |           ├── BeOS
|   |           ├── X11
|   |           ├── mac
|   |           ├── sdl
|   |           └── win32
|   └── ttconv
|       ├── pprdrv_tt.cpp
|       ├── pprdrv_tt2.cpp
|       └── ttutil.cpp
├── galleries
|   ├── examples
|   |   ├── README.txt
|   |   ├── animation
|   |   |   ├── README.txt
|   |   |   ├── animate_decay.py
|   |   |   ├── animated_histogram.py
|   |   |   ├── animation_demo.py
|   |   |   ├── bayes_update.py
|   |   |   ├── double_pendulum.py
|   |   |   ├── dynamic_image.py
|   |   |   ├── frame_grabbing_sgskip.py
|   |   |   ├── multiple_axes.py
|   |   |   ├── pause_resume.py
|   |   |   ├── rain.py
|   |   |   ├── random_walk.py
|   |   |   ├── simple_anim.py
|   |   |   ├── simple_scatter.py
|   |   |   ├── strip_chart.py
|   |   |   └── unchained.py
|   |   ├── axes_grid1
|   |   |   ├── README.txt
|   |   |   ├── demo_anchored_direction_arrows.py
|   |   |   ├── demo_axes_divider.py
|   |   |   ├── demo_axes_grid.py
|   |   |   ├── demo_axes_grid2.py
|   |   |   ├── demo_axes_hbox_divider.py
|   |   |   ├── demo_axes_rgb.py
|   |   |   ├── demo_colorbar_of_inset_axes.py
|   |   |   ├── demo_colorbar_with_axes_divider.py
|   |   |   ├── demo_colorbar_with_inset_locator.py
|   |   |   ├── demo_edge_colorbar.py
|   |   |   ├── demo_fixed_size_axes.py
|   |   |   ├── demo_imagegrid_aspect.py
|   |   |   ├── inset_locator_demo.py
|   |   |   ├── inset_locator_demo2.py
|   |   |   ├── make_room_for_ylabel_using_axesgrid.py
|   |   |   ├── parasite_simple.py
|   |   |   ├── parasite_simple2.py
|   |   |   ├── scatter_hist_locatable_axes.py
|   |   |   ├── simple_anchored_artists.py
|   |   |   ├── simple_axes_divider1.py
|   |   |   ├── simple_axes_divider3.py
|   |   |   ├── simple_axesgrid.py
|   |   |   ├── simple_axesgrid2.py
|   |   |   ├── simple_axisline4.py
|   |   |   └── simple_colorbar.py
|   |   ├── axisartist
|   |   |   ├── README.txt
|   |   |   ├── axis_direction.py
|   |   |   ├── demo_axis_direction.py
|   |   |   ├── demo_axisline_style.py
|   |   |   ├── demo_curvelinear_grid.py
|   |   |   ├── demo_curvelinear_grid2.py
|   |   |   ├── demo_floating_axes.py
|   |   |   ├── demo_floating_axis.py
|   |   |   ├── demo_parasite_axes.py
|   |   |   ├── demo_parasite_axes2.py
|   |   |   ├── demo_ticklabel_alignment.py
|   |   |   ├── demo_ticklabel_direction.py
|   |   |   ├── simple_axis_direction01.py
|   |   |   ├── simple_axis_direction03.py
|   |   |   ├── simple_axis_pad.py
|   |   |   ├── simple_axisartist1.py
|   |   |   ├── simple_axisline.py
|   |   |   └── simple_axisline3.py
|   |   ├── color
|   |   |   ├── README.txt
|   |   |   ├── color_by_yvalue.py
|   |   |   ├── color_cycle_default.py
|   |   |   ├── color_demo.py
|   |   |   ├── colorbar_basics.py
|   |   |   ├── colormap_reference.py
|   |   |   ├── custom_cmap.py
|   |   |   └── named_colors.py
|   |   ├── event_handling
|   |   |   ├── README.txt
|   |   |   ├── close_event.py
|   |   |   ├── coords_demo.py
|   |   |   ├── cursor_demo.py
|   |   |   ├── data_browser.py
|   |   |   ├── figure_axes_enter_leave.py
|   |   |   ├── ginput_manual_clabel_sgskip.py
|   |   |   ├── image_slices_viewer.py
|   |   |   ├── keypress_demo.py
|   |   |   ├── lasso_demo.py
|   |   |   ├── legend_picking.py
|   |   |   ├── looking_glass.py
|   |   |   ├── path_editor.py
|   |   |   ├── pick_event_demo.py
|   |   |   ├── pick_event_demo2.py
|   |   |   ├── poly_editor.py
|   |   |   ├── pong_sgskip.py
|   |   |   ├── resample.py
|   |   |   ├── timers.py
|   |   |   ├── trifinder_event_demo.py
|   |   |   ├── viewlims.py
|   |   |   └── zoom_window.py
|   |   ├── images_contours_and_fields
|   |   |   ├── README.txt
|   |   |   ├── affine_image.py
|   |   |   ├── barb_demo.py
|   |   |   ├── barcode_demo.py
|   |   |   ├── colormap_interactive_adjustment.py
|   |   |   ├── colormap_normalizations.py
|   |   |   ├── colormap_normalizations_symlognorm.py
|   |   |   ├── contour_corner_mask.py
|   |   |   ├── contour_demo.py
|   |   |   ├── contour_image.py
|   |   |   ├── contour_label_demo.py
|   |   |   ├── contourf_demo.py
|   |   |   ├── contourf_hatching.py
|   |   |   ├── contourf_log.py
|   |   |   ├── contours_in_optimization_demo.py
|   |   |   ├── demo_bboximage.py
|   |   |   ├── figimage_demo.py
|   |   |   ├── image_annotated_heatmap.py
|   |   |   ├── image_antialiasing.py
|   |   |   ├── image_clip_path.py
|   |   |   ├── image_demo.py
|   |   |   ├── image_masked.py
|   |   |   ├── image_nonuniform.py
|   |   |   ├── image_transparency_blend.py
|   |   |   ├── image_zcoord.py
|   |   |   ├── interpolation_methods.py
|   |   |   ├── irregulardatagrid.py
|   |   |   ├── layer_images.py
|   |   |   ├── matshow.py
|   |   |   ├── multi_image.py
|   |   |   ├── pcolor_demo.py
|   |   |   ├── pcolormesh_grids.py
|   |   |   ├── pcolormesh_levels.py
|   |   |   ├── plot_streamplot.py
|   |   |   ├── quadmesh_demo.py
|   |   |   ├── quiver_demo.py
|   |   |   ├── quiver_simple_demo.py
|   |   |   ├── shading_example.py
|   |   |   ├── specgram_demo.py
|   |   |   ├── spy_demos.py
|   |   |   ├── tricontour_demo.py
|   |   |   ├── tricontour_smooth_delaunay.py
|   |   |   ├── tricontour_smooth_user.py
|   |   |   ├── trigradient_demo.py
|   |   |   ├── triinterp_demo.py
|   |   |   ├── tripcolor_demo.py
|   |   |   ├── triplot_demo.py
|   |   |   └── watermark_image.py
|   |   ├── lines_bars_and_markers
|   |   |   ├── README.txt
|   |   |   ├── bar_colors.py
|   |   |   ├── bar_label_demo.py
|   |   |   ├── bar_stacked.py
|   |   |   ├── barchart.py
|   |   |   ├── barh.py
|   |   |   ├── broken_barh.py
|   |   |   ├── capstyle.py
|   |   |   ├── categorical_variables.py
|   |   |   ├── cohere.py
|   |   |   ├── csd_demo.py
|   |   |   ├── curve_error_band.py
|   |   |   ├── errorbar_limits_simple.py
|   |   |   ├── errorbar_subsample.py
|   |   |   ├── eventcollection_demo.py
|   |   |   ├── eventplot_demo.py
|   |   |   ├── fill.py
|   |   |   ├── fill_between_alpha.py
|   |   |   ├── fill_between_demo.py
|   |   |   ├── fill_betweenx_demo.py
|   |   |   ├── filled_step.py
|   |   |   ├── gradient_bar.py
|   |   |   ├── hat_graph.py
|   |   |   ├── horizontal_barchart_distribution.py
|   |   |   ├── joinstyle.py
|   |   |   ├── line_demo_dash_control.py
|   |   |   ├── lines_with_ticks_demo.py
|   |   |   ├── linestyles.py
|   |   |   ├── marker_reference.py
|   |   |   ├── markevery_demo.py
|   |   |   ├── masked_demo.py
|   |   |   ├── multicolored_line.py
|   |   |   ├── multivariate_marker_plot.py
|   |   |   ├── psd_demo.py
|   |   |   ├── scatter_custom_symbol.py
|   |   |   ├── scatter_demo2.py
|   |   |   ├── scatter_hist.py
|   |   |   ├── scatter_masked.py
|   |   |   ├── scatter_star_poly.py
|   |   |   ├── scatter_with_legend.py
|   |   |   ├── simple_plot.py
|   |   |   ├── span_regions.py
|   |   |   ├── spectrum_demo.py
|   |   |   ├── stackplot_demo.py
|   |   |   ├── stairs_demo.py
|   |   |   ├── stem_plot.py
|   |   |   ├── step_demo.py
|   |   |   ├── timeline.py
|   |   |   ├── vline_hline_demo.py
|   |   |   └── xcorr_acorr_demo.py
|   |   ├── misc
|   |   |   ├── README.txt
|   |   |   ├── anchored_artists.py
|   |   |   ├── bbox_intersect.py
|   |   |   ├── contour_manual.py
|   |   |   ├── coords_report.py
|   |   |   ├── custom_projection.py
|   |   |   ├── customize_rc.py
|   |   |   ├── demo_agg_filter.py
|   |   |   ├── demo_ribbon_box.py
|   |   |   ├── fig_x.py
|   |   |   ├── fill_spiral.py
|   |   |   ├── findobj_demo.py
|   |   |   ├── font_indexing.py
|   |   |   ├── ftface_props.py
|   |   |   ├── histogram_path.py
|   |   |   ├── hyperlinks_sgskip.py
|   |   |   ├── image_thumbnail_sgskip.py
|   |   |   ├── keyword_plotting.py
|   |   |   ├── logos2.py
|   |   |   ├── multipage_pdf.py
|   |   |   ├── multiprocess_sgskip.py
|   |   |   ├── packed_bubbles.py
|   |   |   ├── patheffect_demo.py
|   |   |   ├── print_stdout_sgskip.py
|   |   |   ├── rasterization_demo.py
|   |   |   ├── set_and_get.py
|   |   |   ├── svg_filter_line.py
|   |   |   ├── svg_filter_pie.py
|   |   |   ├── table_demo.py
|   |   |   ├── tickedstroke_demo.py
|   |   |   ├── transoffset.py
|   |   |   └── zorder_demo.py
|   |   ├── mplot3d
|   |   |   ├── 2dcollections3d.py
|   |   |   ├── 3d_bars.py
|   |   |   ├── README.txt
|   |   |   ├── bars3d.py
|   |   |   ├── box3d.py
|   |   |   ├── contour3d.py
|   |   |   ├── contour3d_2.py
|   |   |   ├── contour3d_3.py
|   |   |   ├── contourf3d.py
|   |   |   ├── contourf3d_2.py
|   |   |   ├── custom_shaded_3d_surface.py
|   |   |   ├── errorbar3d.py
|   |   |   ├── hist3d.py
|   |   |   ├── lines3d.py
|   |   |   ├── lorenz_attractor.py
|   |   |   ├── mixed_subplots.py
|   |   |   ├── offset.py
|   |   |   ├── pathpatch3d.py
|   |   |   ├── polys3d.py
|   |   |   ├── projections.py
|   |   |   ├── quiver3d.py
|   |   |   ├── rotate_axes3d_sgskip.py
|   |   |   ├── scatter3d.py
|   |   |   ├── stem3d_demo.py
|   |   |   ├── subplot3d.py
|   |   |   ├── surface3d.py
|   |   |   ├── surface3d_2.py
|   |   |   ├── surface3d_3.py
|   |   |   ├── surface3d_radial.py
|   |   |   ├── text3d.py
|   |   |   ├── tricontour3d.py
|   |   |   ├── tricontourf3d.py
|   |   |   ├── trisurf3d.py
|   |   |   ├── trisurf3d_2.py
|   |   |   ├── view_planes_3d.py
|   |   |   ├── voxels.py
|   |   |   ├── voxels_numpy_logo.py
|   |   |   ├── voxels_rgb.py
|   |   |   ├── voxels_torus.py
|   |   |   ├── wire3d.py
|   |   |   ├── wire3d_animation_sgskip.py
|   |   |   └── wire3d_zero_stride.py
|   |   ├── pie_and_polar_charts
|   |   |   ├── README.txt
|   |   |   ├── bar_of_pie.py
|   |   |   ├── nested_pie.py
|   |   |   ├── pie_and_donut_labels.py
|   |   |   ├── pie_demo2.py
|   |   |   ├── pie_features.py
|   |   |   ├── polar_bar.py
|   |   |   ├── polar_demo.py
|   |   |   ├── polar_error_caps.py
|   |   |   ├── polar_legend.py
|   |   |   └── polar_scatter.py
|   |   ├── pyplots
|   |   |   ├── README.txt
|   |   |   ├── axline.py
|   |   |   ├── pyplot_simple.py
|   |   |   ├── pyplot_text.py
|   |   |   ├── pyplot_three.py
|   |   |   └── pyplot_two_subplots.py
|   |   ├── scales
|   |   |   ├── README.txt
|   |   |   ├── asinh_demo.py
|   |   |   ├── aspect_loglog.py
|   |   |   ├── custom_scale.py
|   |   |   ├── log_bar.py
|   |   |   ├── log_demo.py
|   |   |   ├── logit_demo.py
|   |   |   ├── power_norm.py
|   |   |   ├── scales.py
|   |   |   ├── semilogx_demo.py
|   |   |   └── symlog_demo.py
|   |   ├── shapes_and_collections
|   |   |   ├── README.txt
|   |   |   ├── arrow_guide.py
|   |   |   ├── artist_reference.py
|   |   |   ├── collections.py
|   |   |   ├── compound_path.py
|   |   |   ├── dolphin.py
|   |   |   ├── donut.py
|   |   |   ├── ellipse_collection.py
|   |   |   ├── ellipse_demo.py
|   |   |   ├── fancybox_demo.py
|   |   |   ├── hatch_demo.py
|   |   |   ├── hatch_style_reference.py
|   |   |   ├── line_collection.py
|   |   |   ├── patch_collection.py
|   |   |   ├── path_patch.py
|   |   |   ├── quad_bezier.py
|   |   |   └── scatter.py
|   |   ├── showcase
|   |   |   ├── README.txt
|   |   |   ├── anatomy.py
|   |   |   ├── firefox.py
|   |   |   ├── integral.py
|   |   |   ├── mandelbrot.py
|   |   |   ├── stock_prices.py
|   |   |   └── xkcd.py
|   |   ├── specialty_plots
|   |   |   ├── README.txt
|   |   |   ├── advanced_hillshading.py
|   |   |   ├── anscombe.py
|   |   |   ├── hinton_demo.py
|   |   |   ├── leftventricle_bullseye.py
|   |   |   ├── mri_demo.py
|   |   |   ├── mri_with_eeg.py
|   |   |   ├── radar_chart.py
|   |   |   ├── sankey_basics.py
|   |   |   ├── sankey_links.py
|   |   |   ├── sankey_rankine.py
|   |   |   ├── skewt.py
|   |   |   └── topographic_hillshading.py
|   |   ├── spines
|   |   |   ├── README.txt
|   |   |   ├── centered_spines_with_arrows.py
|   |   |   ├── multiple_yaxis_with_spines.py
|   |   |   ├── spine_placement_demo.py
|   |   |   ├── spines.py
|   |   |   └── spines_dropped.py
|   |   ├── statistics
|   |   |   ├── README.txt
|   |   |   ├── barchart_demo.py
|   |   |   ├── boxplot.py
|   |   |   ├── boxplot_color.py
|   |   |   ├── boxplot_demo.py
|   |   |   ├── boxplot_vs_violin.py
|   |   |   ├── bxp.py
|   |   |   ├── confidence_ellipse.py
|   |   |   ├── customized_violin.py
|   |   |   ├── errorbar.py
|   |   |   ├── errorbar_features.py
|   |   |   ├── errorbar_limits.py
|   |   |   ├── errorbars_and_boxes.py
|   |   |   ├── hexbin_demo.py
|   |   |   ├── hist.py
|   |   |   ├── histogram_cumulative.py
|   |   |   ├── histogram_features.py
|   |   |   ├── histogram_histtypes.py
|   |   |   ├── histogram_multihist.py
|   |   |   ├── multiple_histograms_side_by_side.py
|   |   |   ├── time_series_histogram.py
|   |   |   └── violinplot.py
|   |   ├── style_sheets
|   |   |   ├── README.txt
|   |   |   ├── bmh.py
|   |   |   ├── dark_background.py
|   |   |   ├── fivethirtyeight.py
|   |   |   ├── ggplot.py
|   |   |   ├── grayscale.py
|   |   |   ├── plot_solarizedlight2.py
|   |   |   └── style_sheets_reference.py
|   |   ├── subplots_axes_and_figures
|   |   |   ├── README.txt
|   |   |   ├── align_labels_demo.py
|   |   |   ├── auto_subplots_adjust.py
|   |   |   ├── axes_box_aspect.py
|   |   |   ├── axes_demo.py
|   |   |   ├── axes_margins.py
|   |   |   ├── axes_props.py
|   |   |   ├── axes_zoom_effect.py
|   |   |   ├── axhspan_demo.py
|   |   |   ├── axis_equal_demo.py
|   |   |   ├── axis_labels_demo.py
|   |   |   ├── broken_axis.py
|   |   |   ├── colorbar_placement.py
|   |   |   ├── custom_figure_class.py
|   |   |   ├── demo_constrained_layout.py
|   |   |   ├── demo_tight_layout.py
|   |   |   ├── fahrenheit_celsius_scales.py
|   |   |   ├── figure_size_units.py
|   |   |   ├── figure_title.py
|   |   |   ├── ganged_plots.py
|   |   |   ├── geo_demo.py
|   |   |   ├── gridspec_and_subplots.py
|   |   |   ├── gridspec_multicolumn.py
|   |   |   ├── gridspec_nested.py
|   |   |   ├── invert_axes.py
|   |   |   ├── mosaic.py
|   |   |   ├── multiple_figs_demo.py
|   |   |   ├── secondary_axis.py
|   |   |   ├── share_axis_lims_views.py
|   |   |   ├── shared_axis_demo.py
|   |   |   ├── subfigures.py
|   |   |   ├── subplot.py
|   |   |   ├── subplots_adjust.py
|   |   |   ├── subplots_demo.py
|   |   |   ├── two_scales.py
|   |   |   └── zoom_inset_axes.py
|   |   ├── text_labels_and_annotations
|   |   |   ├── README.txt
|   |   |   ├── accented_text.py
|   |   |   ├── align_ylabels.py
|   |   |   ├── angle_annotation.py
|   |   |   ├── angles_on_bracket_arrows.py
|   |   |   ├── annotate_transform.py
|   |   |   ├── annotation_basic.py
|   |   |   ├── annotation_demo.py
|   |   |   ├── annotation_polar.py
|   |   |   ├── arrow_demo.py
|   |   |   ├── autowrap.py
|   |   |   ├── custom_legends.py
|   |   |   ├── date.py
|   |   |   ├── demo_annotation_box.py
|   |   |   ├── demo_text_path.py
|   |   |   ├── demo_text_rotation_mode.py
|   |   |   ├── dfrac_demo.py
|   |   |   ├── engineering_formatter.py
|   |   |   ├── fancyarrow_demo.py
|   |   |   ├── fancytextbox_demo.py
|   |   |   ├── figlegend_demo.py
|   |   |   ├── font_family_rc.py
|   |   |   ├── font_file.py
|   |   |   ├── font_table.py
|   |   |   ├── fonts_demo.py
|   |   |   ├── fonts_demo_kw.py
|   |   |   ├── label_subplots.py
|   |   |   ├── legend.py
|   |   |   ├── legend_demo.py
|   |   |   ├── line_with_text.py
|   |   |   ├── mathtext_asarray.py
|   |   |   ├── mathtext_demo.py
|   |   |   ├── mathtext_examples.py
|   |   |   ├── mathtext_fontfamily_example.py
|   |   |   ├── multiline.py
|   |   |   ├── placing_text_boxes.py
|   |   |   ├── rainbow_text.py
|   |   |   ├── stix_fonts_demo.py
|   |   |   ├── tex_demo.py
|   |   |   ├── text_alignment.py
|   |   |   ├── text_commands.py
|   |   |   ├── text_fontdict.py
|   |   |   ├── text_rotation_relative_to_line.py
|   |   |   ├── titles_demo.py
|   |   |   ├── unicode_minus.py
|   |   |   ├── usetex_baseline_test.py
|   |   |   ├── usetex_fonteffects.py
|   |   |   └── watermark_text.py
|   |   ├── ticks
|   |   |   ├── README.txt
|   |   |   ├── auto_ticks.py
|   |   |   ├── centered_ticklabels.py
|   |   |   ├── colorbar_tick_labelling_demo.py
|   |   |   ├── custom_ticker1.py
|   |   |   ├── date_concise_formatter.py
|   |   |   ├── date_demo_convert.py
|   |   |   ├── date_demo_rrule.py
|   |   |   ├── date_formatters_locators.py
|   |   |   ├── date_index_formatter.py
|   |   |   ├── date_precision_and_epochs.py
|   |   |   ├── dollar_ticks.py
|   |   |   ├── fig_axes_customize_simple.py
|   |   |   ├── major_minor_demo.py
|   |   |   ├── scalarformatter.py
|   |   |   ├── tick-formatters.py
|   |   |   ├── tick-locators.py
|   |   |   ├── tick_label_right.py
|   |   |   ├── tick_labels_from_values.py
|   |   |   ├── tick_xlabel_top.py
|   |   |   ├── ticklabels_rotation.py
|   |   |   └── ticks_too_many.py
|   |   ├── units
|   |   |   ├── README.txt
|   |   |   ├── annotate_with_units.py
|   |   |   ├── artist_tests.py
|   |   |   ├── bar_demo2.py
|   |   |   ├── bar_unit_demo.py
|   |   |   ├── basic_units.py
|   |   |   ├── ellipse_with_units.py
|   |   |   ├── evans_test.py
|   |   |   ├── radian_demo.py
|   |   |   ├── units_sample.py
|   |   |   └── units_scatter.py
|   |   ├── user_interfaces
|   |   |   ├── README.txt
|   |   |   ├── canvasagg.py
|   |   |   ├── embedding_in_gtk3_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk3_sgskip.py
|   |   |   ├── embedding_in_gtk4_panzoom_sgskip.py
|   |   |   ├── embedding_in_gtk4_sgskip.py
|   |   |   ├── embedding_in_qt_sgskip.py
|   |   |   ├── embedding_in_tk_sgskip.py
|   |   |   ├── embedding_in_wx2_sgskip.py
|   |   |   ├── embedding_in_wx3_sgskip.py
|   |   |   ├── embedding_in_wx4_sgskip.py
|   |   |   ├── embedding_in_wx5_sgskip.py
|   |   |   ├── embedding_webagg_sgskip.py
|   |   |   ├── fourier_demo_wx_sgskip.py
|   |   |   ├── gtk3_spreadsheet_sgskip.py
|   |   |   ├── gtk4_spreadsheet_sgskip.py
|   |   |   ├── images
|   |   |   ├── mathtext_wx_sgskip.py
|   |   |   ├── mpl_with_glade3_sgskip.py
|   |   |   ├── mplcvd.py
|   |   |   ├── pylab_with_gtk3_sgskip.py
|   |   |   ├── pylab_with_gtk4_sgskip.py
|   |   |   ├── svg_histogram_sgskip.py
|   |   |   ├── svg_tooltip_sgskip.py
|   |   |   ├── toolmanager_sgskip.py
|   |   |   ├── web_application_server_sgskip.py
|   |   |   └── wxcursor_demo_sgskip.py
|   |   ├── userdemo
|   |   |   ├── README.txt
|   |   |   ├── annotate_explain.py
|   |   |   ├── annotate_simple_coord02.py
|   |   |   ├── annotate_text_arrow.py
|   |   |   ├── connect_simple01.py
|   |   |   ├── connectionstyle_demo.py
|   |   |   ├── custom_boxstyle01.py
|   |   |   ├── demo_gridspec01.py
|   |   |   ├── demo_gridspec03.py
|   |   |   ├── demo_gridspec06.py
|   |   |   ├── pgf_fonts.py
|   |   |   ├── pgf_preamble_sgskip.py
|   |   |   ├── pgf_texsystem.py
|   |   |   ├── simple_annotate01.py
|   |   |   ├── simple_legend01.py
|   |   |   └── simple_legend02.py
|   |   └── widgets
|   |       ├── README.txt
|   |       ├── annotated_cursor.py
|   |       ├── buttons.py
|   |       ├── check_buttons.py
|   |       ├── cursor.py
|   |       ├── lasso_selector_demo_sgskip.py
|   |       ├── menu.py
|   |       ├── mouse_cursor.py
|   |       ├── multicursor.py
|   |       ├── polygon_selector_demo.py
|   |       ├── polygon_selector_simple.py
|   |       ├── radio_buttons.py
|   |       ├── range_slider.py
|   |       ├── rectangle_selector.py
|   |       ├── slider_demo.py
|   |       ├── slider_snap_demo.py
|   |       ├── span_selector.py
|   |       └── textbox.py
|   ├── plot_types
|   |   ├── 3D
|   |   |   ├── README.rst
|   |   |   ├── scatter3d_simple.py
|   |   |   ├── surface3d_simple.py
|   |   |   ├── trisurf3d_simple.py
|   |   |   ├── voxels_simple.py
|   |   |   └── wire3d_simple.py
|   |   ├── README.rst
|   |   ├── arrays
|   |   |   ├── README.rst
|   |   |   ├── barbs.py
|   |   |   ├── contour.py
|   |   |   ├── contourf.py
|   |   |   ├── imshow.py
|   |   |   ├── pcolormesh.py
|   |   |   ├── quiver.py
|   |   |   └── streamplot.py
|   |   ├── basic
|   |   |   ├── README.rst
|   |   |   ├── bar.py
|   |   |   ├── fill_between.py
|   |   |   ├── plot.py
|   |   |   ├── scatter_plot.py
|   |   |   ├── stackplot.py
|   |   |   ├── stem.py
|   |   |   └── step.py
|   |   ├── stats
|   |   |   ├── README.rst
|   |   |   ├── boxplot_plot.py
|   |   |   ├── errorbar_plot.py
|   |   |   ├── eventplot.py
|   |   |   ├── hexbin.py
|   |   |   ├── hist2d.py
|   |   |   ├── hist_plot.py
|   |   |   ├── pie.py
|   |   |   └── violin.py
|   |   └── unstructured
|   |       ├── README.rst
|   |       ├── tricontour.py
|   |       ├── tricontourf.py
|   |       ├── tripcolor.py
|   |       └── triplot.py
|   └── tutorials
|       ├── README.txt
|       ├── advanced
|       |   ├── README.txt
|       |   ├── blitting.py
|       |   ├── path_tutorial.py
|       |   ├── patheffects_guide.py
|       |   └── transforms_tutorial.py
|       ├── colors
|       |   ├── README.txt
|       |   ├── colorbar_only.py
|       |   ├── colormap-manipulation.py
|       |   ├── colormapnorms.py
|       |   ├── colormaps.py
|       |   └── colors.py
|       ├── intermediate
|       |   ├── README.txt
|       |   ├── arranging_axes.py
|       |   ├── artists.py
|       |   ├── autoscale.py
|       |   ├── color_cycle.py
|       |   ├── constrainedlayout_guide.py
|       |   ├── imshow_extent.py
|       |   ├── legend_guide.py
|       |   └── tight_layout_guide.py
|       ├── introductory
|       |   ├── README.txt
|       |   ├── animation_tutorial.py
|       |   ├── customizing.py
|       |   ├── images.py
|       |   ├── lifecycle.py
|       |   ├── pyplot.py
|       |   └── quick_start.py
|       ├── provisional
|       |   └── README.txt
|       ├── text
|       |   ├── README.txt
|       |   ├── annotations.py
|       |   ├── mathtext.py
|       |   ├── pgf.py
|       |   ├── text_intro.py
|       |   ├── text_props.py
|       |   └── usetex.py
|       └── toolkits
|           ├── README.txt
|           ├── axes_grid.py
|           ├── axisartist.py
|           └── mplot3d.py
├── lib
|   ├── matplotlib
|   |   ├── __init__.py
|   |   ├── _afm.py
|   |   ├── _animation_data.py
|   |   ├── _api
|   |   |   ├── __init__.py
|   |   |   └── deprecation.py
|   |   ├── _blocking_input.py
|   |   ├── _cm.py
|   |   ├── _cm_listed.py
|   |   ├── _color_data.py
|   |   ├── _constrained_layout.py
|   |   ├── _docstring.py
|   |   ├── _enums.py
|   |   ├── _fontconfig_pattern.py
|   |   ├── _internal_utils.py
|   |   ├── _layoutgrid.py
|   |   ├── _mathtext.py
|   |   ├── _mathtext_data.py
|   |   ├── _pylab_helpers.py
|   |   ├── _text_helpers.py
|   |   ├── _tight_bbox.py
|   |   ├── _tight_layout.py
|   |   ├── _type1font.py
|   |   ├── animation.py
|   |   ├── artist.py
|   |   ├── axes
|   |   |   ├── __init__.py
|   |   |   ├── _axes.py
|   |   |   ├── _base.py
|   |   |   └── _secondary_axes.py
|   |   ├── axis.py
|   |   ├── backend_bases.py
|   |   ├── backend_managers.py
|   |   ├── backend_tools.py
|   |   ├── backends
|   |   |   ├── __init__.py
|   |   |   ├── _backend_gtk.py
|   |   |   ├── _backend_pdf_ps.py
|   |   |   ├── _backend_tk.py
|   |   |   ├── backend_agg.py
|   |   |   ├── backend_cairo.py
|   |   |   ├── backend_gtk3.py
|   |   |   ├── backend_gtk3agg.py
|   |   |   ├── backend_gtk3cairo.py
|   |   |   ├── backend_gtk4.py
|   |   |   ├── backend_gtk4agg.py
|   |   |   ├── backend_gtk4cairo.py
|   |   |   ├── backend_macosx.py
|   |   |   ├── backend_mixed.py
|   |   |   ├── backend_nbagg.py
|   |   |   ├── backend_pdf.py
|   |   |   ├── backend_pgf.py
|   |   |   ├── backend_ps.py
|   |   |   ├── backend_qt.py
|   |   |   ├── backend_qt5.py
|   |   |   ├── backend_qt5agg.py
|   |   |   ├── backend_qt5cairo.py
|   |   |   ├── backend_qtagg.py
|   |   |   ├── backend_qtcairo.py
|   |   |   ├── backend_svg.py
|   |   |   ├── backend_template.py
|   |   |   ├── backend_tkagg.py
|   |   |   ├── backend_tkcairo.py
|   |   |   ├── backend_webagg.py
|   |   |   ├── backend_webagg_core.py
|   |   |   ├── backend_wx.py
|   |   |   ├── backend_wxagg.py
|   |   |   ├── backend_wxcairo.py
|   |   |   ├── qt_compat.py
|   |   |   ├── qt_editor
|   |   |   |   ├── __init__.py
|   |   |   |   ├── _formlayout.py
|   |   |   |   └── figureoptions.py
|   |   |   └── web_backend
|   |   |       ├── .eslintrc.js
|   |   |       ├── css
|   |   |       └── js
|   |   ├── bezier.py
|   |   ├── category.py
|   |   ├── cbook.py
|   |   ├── cm.py
|   |   ├── collections.py
|   |   ├── colorbar.py
|   |   ├── colors.py
|   |   ├── container.py
|   |   ├── contour.py
|   |   ├── dates.py
|   |   ├── dviread.py
|   |   ├── figure.py
|   |   ├── font_manager.py
|   |   ├── gridspec.py
|   |   ├── hatch.py
|   |   ├── image.py
|   |   ├── layout_engine.py
|   |   ├── legend.py
|   |   ├── legend_handler.py
|   |   ├── lines.py
|   |   ├── markers.py
|   |   ├── mathtext.py
|   |   ├── mlab.py
|   |   ├── mpl-data
|   |   |   ├── fonts
|   |   |   |   ├── afm
|   |   |   |   ├── pdfcorefonts
|   |   |   |   └── ttf
|   |   |   ├── images
|   |   |   ├── plot_directive
|   |   |   ├── sample_data
|   |   |   |   ├── README.txt
|   |   |   |   └── axes_grid
|   |   |   └── stylelib
|   |   ├── offsetbox.py
|   |   ├── patches.py
|   |   ├── path.py
|   |   ├── patheffects.py
|   |   ├── projections
|   |   |   ├── __init__.py
|   |   |   ├── geo.py
|   |   |   └── polar.py
|   |   ├── pylab.py
|   |   ├── pyplot.py
|   |   ├── quiver.py
|   |   ├── rcsetup.py
|   |   ├── sankey.py
|   |   ├── scale.py
|   |   ├── sphinxext
|   |   |   ├── __init__.py
|   |   |   ├── mathmpl.py
|   |   |   └── plot_directive.py
|   |   ├── spines.py
|   |   ├── stackplot.py
|   |   ├── streamplot.py
|   |   ├── style
|   |   |   ├── __init__.py
|   |   |   └── core.py
|   |   ├── table.py
|   |   ├── testing
|   |   |   ├── __init__.py
|   |   |   ├── _markers.py
|   |   |   ├── compare.py
|   |   |   ├── conftest.py
|   |   |   ├── decorators.py
|   |   |   ├── exceptions.py
|   |   |   ├── jpl_units
|   |   |   |   ├── Duration.py
|   |   |   |   ├── Epoch.py
|   |   |   |   ├── EpochConverter.py
|   |   |   |   ├── StrConverter.py
|   |   |   |   ├── UnitDbl.py
|   |   |   |   ├── UnitDblConverter.py
|   |   |   |   ├── UnitDblFormatter.py
|   |   |   |   └── __init__.py
|   |   |   └── widgets.py
|   |   ├── tests
|   |   |   ├── __init__.py
|   |   |   ├── baseline_images
|   |   |   |   ├── dviread
|   |   |   |   ├── pngsuite
|   |   |   |   ├── test_agg
|   |   |   |   ├── test_agg_filter
|   |   |   |   ├── test_arrow_patches
|   |   |   |   ├── test_artist
|   |   |   |   ├── test_axes
|   |   |   |   ├── test_backend_pdf
|   |   |   |   ├── test_backend_pgf
|   |   |   |   ├── test_backend_ps
|   |   |   |   ├── test_backend_svg
|   |   |   |   ├── test_bbox_tight
|   |   |   |   ├── test_collections
|   |   |   |   ├── test_colorbar
|   |   |   |   ├── test_colors
|   |   |   |   ├── test_compare_images
|   |   |   |   ├── test_constrainedlayout
|   |   |   |   ├── test_contour
|   |   |   |   ├── test_dates
|   |   |   |   ├── test_figure
|   |   |   |   ├── test_image
|   |   |   |   ├── test_legend
|   |   |   |   ├── test_lines
|   |   |   |   ├── test_mathtext
|   |   |   |   ├── test_offsetbox
|   |   |   |   ├── test_patches
|   |   |   |   ├── test_path
|   |   |   |   ├── test_patheffects
|   |   |   |   ├── test_png
|   |   |   |   ├── test_polar
|   |   |   |   ├── test_quiver
|   |   |   |   ├── test_scale
|   |   |   |   ├── test_simplification
|   |   |   |   ├── test_skew
|   |   |   |   ├── test_spines
|   |   |   |   ├── test_streamplot
|   |   |   |   ├── test_subplots
|   |   |   |   ├── test_table
|   |   |   |   ├── test_text
|   |   |   |   ├── test_tightlayout
|   |   |   |   ├── test_transforms
|   |   |   |   ├── test_triangulation
|   |   |   |   ├── test_ttconv
|   |   |   |   ├── test_units
|   |   |   |   ├── test_usetex
|   |   |   |   └── test_widgets
|   |   |   ├── conftest.py
|   |   |   ├── test_afm.py
|   |   |   ├── test_agg.py
|   |   |   ├── test_agg_filter.py
|   |   |   ├── test_animation.py
|   |   |   ├── test_api.py
|   |   |   ├── test_arrow_patches.py
|   |   |   ├── test_artist.py
|   |   |   ├── test_axes.py
|   |   |   ├── test_backend_bases.py
|   |   |   ├── test_backend_cairo.py
|   |   |   ├── test_backend_gtk3.py
|   |   |   ├── test_backend_macosx.py
|   |   |   ├── test_backend_nbagg.py
|   |   |   ├── test_backend_pdf.py
|   |   |   ├── test_backend_pgf.py
|   |   |   ├── test_backend_ps.py
|   |   |   ├── test_backend_qt.py
|   |   |   ├── test_backend_svg.py
|   |   |   ├── test_backend_template.py
|   |   |   ├── test_backend_tk.py
|   |   |   ├── test_backend_tools.py
|   |   |   ├── test_backend_webagg.py
|   |   |   ├── test_backends_interactive.py
|   |   |   ├── test_basic.py
|   |   |   ├── test_bbox_tight.py
|   |   |   ├── test_category.py
|   |   |   ├── test_cbook.py
|   |   |   ├── test_collections.py
|   |   |   ├── test_colorbar.py
|   |   |   ├── test_colors.py
|   |   |   ├── test_compare_images.py
|   |   |   ├── test_constrainedlayout.py
|   |   |   ├── test_container.py
|   |   |   ├── test_contour.py
|   |   |   ├── test_cycles.py
|   |   |   ├── test_dates.py
|   |   |   ├── test_determinism.py
|   |   |   ├── test_doc.py
|   |   |   ├── test_dviread.py
|   |   |   ├── test_figure.py
|   |   |   ├── test_font_manager.py
|   |   |   ├── test_fontconfig_pattern.py
|   |   |   ├── test_ft2font.py
|   |   |   ├── test_getattr.py
|   |   |   ├── test_gridspec.py
|   |   |   ├── test_image.py
|   |   |   ├── test_legend.py
|   |   |   ├── test_lines.py
|   |   |   ├── test_marker.py
|   |   |   ├── test_mathtext.py
|   |   |   ├── test_matplotlib.py
|   |   |   ├── test_mlab.py
|   |   |   ├── test_offsetbox.py
|   |   |   ├── test_patches.py
|   |   |   ├── test_path.py
|   |   |   ├── test_patheffects.py
|   |   |   ├── test_pickle.py
|   |   |   ├── test_png.py
|   |   |   ├── test_polar.py
|   |   |   ├── test_preprocess_data.py
|   |   |   ├── test_pyplot.py
|   |   |   ├── test_quiver.py
|   |   |   ├── test_rcparams.py
|   |   |   ├── test_sankey.py
|   |   |   ├── test_scale.py
|   |   |   ├── test_simplification.py
|   |   |   ├── test_skew.py
|   |   |   ├── test_sphinxext.py
|   |   |   ├── test_spines.py
|   |   |   ├── test_streamplot.py
|   |   |   ├── test_style.py
|   |   |   ├── test_subplots.py
|   |   |   ├── test_table.py
|   |   |   ├── test_testing.py
|   |   |   ├── test_texmanager.py
|   |   |   ├── test_text.py
|   |   |   ├── test_textpath.py
|   |   |   ├── test_ticker.py
|   |   |   ├── test_tightlayout.py
|   |   |   ├── test_transforms.py
|   |   |   ├── test_triangulation.py
|   |   |   ├── test_ttconv.py
|   |   |   ├── test_type1font.py
|   |   |   ├── test_units.py
|   |   |   ├── test_usetex.py
|   |   |   ├── test_widgets.py
|   |   |   └── tinypages
|   |   |       ├── README.md
|   |   |       ├── _static
|   |   |       ├── conf.py
|   |   |       ├── included_plot_21.rst
|   |   |       ├── index.rst
|   |   |       ├── range4.py
|   |   |       ├── range6.py
|   |   |       └── some_plots.rst
|   |   ├── texmanager.py
|   |   ├── text.py
|   |   ├── textpath.py
|   |   ├── ticker.py
|   |   ├── transforms.py
|   |   ├── tri
|   |   |   ├── __init__.py
|   |   |   ├── _triangulation.py
|   |   |   ├── _tricontour.py
|   |   |   ├── _trifinder.py
|   |   |   ├── _triinterpolate.py
|   |   |   ├── _tripcolor.py
|   |   |   ├── _triplot.py
|   |   |   ├── _trirefine.py
|   |   |   ├── _tritools.py
|   |   |   ├── triangulation.py
|   |   |   ├── tricontour.py
|   |   |   ├── trifinder.py
|   |   |   ├── triinterpolate.py
|   |   |   ├── tripcolor.py
|   |   |   ├── triplot.py
|   |   |   ├── trirefine.py
|   |   |   └── tritools.py
|   |   ├── units.py
|   |   └── widgets.py
|   ├── mpl_toolkits
|   |   ├── __init__.py
|   |   ├── axes_grid1
|   |   |   ├── __init__.py
|   |   |   ├── anchored_artists.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axes_size.py
|   |   |   ├── inset_locator.py
|   |   |   ├── mpl_axes.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       └── test_axes_grid1.py
|   |   ├── axisartist
|   |   |   ├── __init__.py
|   |   |   ├── angle_helper.py
|   |   |   ├── axes_divider.py
|   |   |   ├── axes_grid.py
|   |   |   ├── axes_rgb.py
|   |   |   ├── axis_artist.py
|   |   |   ├── axisline_style.py
|   |   |   ├── axislines.py
|   |   |   ├── floating_axes.py
|   |   |   ├── grid_finder.py
|   |   |   ├── grid_helper_curvelinear.py
|   |   |   ├── parasite_axes.py
|   |   |   └── tests
|   |   |       ├── __init__.py
|   |   |       ├── baseline_images
|   |   |       ├── conftest.py
|   |   |       ├── test_angle_helper.py
|   |   |       ├── test_axis_artist.py
|   |   |       ├── test_axislines.py
|   |   |       ├── test_floating_axes.py
|   |   |       ├── test_grid_finder.py
|   |   |       └── test_grid_helper_curvelinear.py
|   |   └── mplot3d
|   |       ├── __init__.py
|   |       ├── art3d.py
|   |       ├── axes3d.py
|   |       ├── axis3d.py
|   |       ├── proj3d.py
|   |       └── tests
|   |           ├── __init__.py
|   |           ├── baseline_images
|   |           ├── conftest.py
|   |           ├── test_art3d.py
|   |           ├── test_axes3d.py
|   |           └── test_legend3d.py
|   └── pylab.py
├── requirements
|   ├── dev
|   |   └── dev-requirements.txt
|   ├── doc
|   |   └── doc-requirements.txt
|   └── testing
|       ├── all.txt
|       ├── extra.txt
|       ├── flake8.txt
|       └── minver.txt
├── setup.py
├── setupext.py
├── src
|   ├── _backend_agg.cpp
|   ├── _backend_agg_wrapper.cpp
|   ├── _c_internal_utils.c
|   ├── _image_wrapper.cpp
|   ├── _path_wrapper.cpp
|   ├── _qhull_wrapper.cpp
|   ├── _tkagg.cpp
|   ├── _ttconv.cpp
|   ├── checkdep_freetype2.c
|   ├── doc
|   ├── ft2font.cpp
|   ├── ft2font_wrapper.cpp
|   ├── py_converters.cpp
|   └── tri
|       ├── _tri.cpp
|       └── _tri_wrapper.cpp
└── tools
    ├── README.txt
    ├── boilerplate.py
    ├── cache_zenodo_svg.py
    ├── create_DejaVuDisplay.sh
    ├── embed_js.py
    ├── gh_api.py
    ├── github_stats.py
    ├── make_icons.py
    ├── memleak.py
    ├── run_examples.py
    ├── subset.py
    ├── triage_tests.py
    └── visualize_tests.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
[Bug]: Unable to pickle figure with aligned labels

Issue description: 
### Bug summary

 Unable to pickle figure after calling `align_labels()`

### Code for reproduction

```python
import matplotlib.pyplot as plt
import pickle

fig = plt.figure()
ax1 = fig.add_subplot(211)
ax2 = fig.add_subplot(212)
time=[0,1,2,3,4]
speed=[40000,4300,4500,4700,4800]
acc=[10,11,12,13,14]
ax1.plot(time,speed)
ax1.set_ylabel('speed')
ax2.plot(time,acc)
ax2.set_ylabel('acc')

fig.align_labels() ##pickling works after removing this line 

pickle.dumps(fig)
plt.show()
```


### Actual outcome
```
align.py", line 16
pickle.dumps(fig)
TypeError: cannot pickle 'weakref.ReferenceType' object
```
### Expected outcome

Pickling successful

### Additional information

_No response_

### Operating system

Windows

### Matplotlib Version

3.7.0

### Matplotlib Backend

_No response_

### Python version

_No response_

### Jupyter version

_No response_

### Installation

None

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: lib/matplotlib/tests/test_pickle.py
Line number range: 236 - 241
Content:
236. def test_shared():
237.     fig, axs = plt.subplots(2, sharex=True)
238.     fig = pickle.loads(pickle.dumps(fig))
239.     fig.axes[0].set_xlim(10, 20)
240.     assert fig.axes[1].get_xlim() == (10, 20)
241. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 243 - 248
Content:
243. def test_inset_and_secondary():
244.     fig, ax = plt.subplots()
245.     ax.inset_axes([.1, .1, .3, .3])
246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))
247.     pickle.loads(pickle.dumps(fig))
248. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 196 - 225
Content:
196. class TransformBlob:
197.     def __init__(self):
198.         self.identity = mtransforms.IdentityTransform()
199.         self.identity2 = mtransforms.IdentityTransform()
200.         # Force use of the more complex composition.
201.         self.composite = mtransforms.CompositeGenericTransform(
202.             self.identity,
203.             self.identity2)
204.         # Check parent -> child links of TransformWrapper.
205.         self.wrapper = mtransforms.TransformWrapper(self.composite)
206.         # Check child -> parent links of TransformWrapper.
207.         self.composite2 = mtransforms.CompositeGenericTransform(
208.             self.wrapper,
209.             self.identity)
210. 
211. 
212. def test_transform():
213.     obj = TransformBlob()
214.     pf = pickle.dumps(obj)
215.     del obj
216. 
217.     obj = pickle.loads(pf)
218.     # Check parent -> child links of TransformWrapper.
219.     assert obj.wrapper._child == obj.composite
220.     # Check child -> parent links of TransformWrapper.
221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]
222.     # Check input and output dimensions are set as expected.
223.     assert obj.wrapper.input_dims == obj.composite.input_dims
224.     assert obj.wrapper.output_dims == obj.composite.output_dims
225. 


File: lib/matplotlib/tests/test_figure.py
Line number range: 28 - 68
Content:
28. @image_comparison(['figure_align_labels'], extensions=['png', 'svg'],
29.                   tol=0 if platform.machine() == 'x86_64' else 0.01)
30. def test_align_labels():
31.     fig = plt.figure(layout='tight')
32.     gs = gridspec.GridSpec(3, 3)
33. 
34.     ax = fig.add_subplot(gs[0, :2])
35.     ax.plot(np.arange(0, 1e6, 1000))
36.     ax.set_ylabel('Ylabel0 0')
37.     ax = fig.add_subplot(gs[0, -1])
38.     ax.plot(np.arange(0, 1e4, 100))
39. 
40.     for i in range(3):
41.         ax = fig.add_subplot(gs[1, i])
42.         ax.set_ylabel('YLabel1 %d' % i)
43.         ax.set_xlabel('XLabel1 %d' % i)
44.         if i in [0, 2]:
45.             ax.xaxis.set_label_position("top")
46.             ax.xaxis.tick_top()
47.         if i == 0:
48.             for tick in ax.get_xticklabels():
49.                 tick.set_rotation(90)
50.         if i == 2:
51.             ax.yaxis.set_label_position("right")
52.             ax.yaxis.tick_right()
53. 
54.     for i in range(3):
55.         ax = fig.add_subplot(gs[2, i])
56.         ax.set_xlabel(f'XLabel2 {i}')
57.         ax.set_ylabel(f'YLabel2 {i}')
58. 
59.         if i == 2:
60.             ax.plot(np.arange(0, 1e4, 10))
61.             ax.yaxis.set_label_position("right")
62.             ax.yaxis.tick_right()
63.             for tick in ax.get_xticklabels():
64.                 tick.set_rotation(90)
65. 
66.     fig.align_labels()
67. 
68. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 20 - 45
Content:
20. def test_simple():
21.     fig = plt.figure()
22.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
23. 
24.     ax = plt.subplot(121)
25.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
26. 
27.     ax = plt.axes(projection='polar')
28.     plt.plot(np.arange(10), label='foobar')
29.     plt.legend()
30. 
31.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
32. 
33. #    ax = plt.subplot(121, projection='hammer')
34. #    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)
35. 
36.     plt.figure()
37.     plt.bar(x=np.arange(10), height=np.arange(10))
38.     pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)
39. 
40.     fig = plt.figure()
41.     ax = plt.axes()
42.     plt.plot(np.arange(10))
43.     ax.set_yscale('log')
44.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)
45. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 47 - 107
Content:
47. def _generate_complete_test_figure(fig_ref):
48.     fig_ref.set_size_inches((10, 6))
49.     plt.figure(fig_ref)
50. 
51.     plt.suptitle('Can you fit any more in a figure?')
52. 
53.     # make some arbitrary data
54.     x, y = np.arange(8), np.arange(10)
55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)
56.     v = np.sin(v * -0.6)
57. 
58.     # Ensure lists also pickle correctly.
59.     plt.subplot(3, 3, 1)
60.     plt.plot(list(range(10)))
61. 
62.     plt.subplot(3, 3, 2)
63.     plt.contourf(data, hatches=['//', 'ooo'])
64.     plt.colorbar()
65. 
66.     plt.subplot(3, 3, 3)
67.     plt.pcolormesh(data)
68. 
69.     plt.subplot(3, 3, 4)
70.     plt.imshow(data)
71. 
72.     plt.subplot(3, 3, 5)
73.     plt.pcolor(data)
74. 
75.     ax = plt.subplot(3, 3, 6)
76.     ax.set_xlim(0, 7)
77.     ax.set_ylim(0, 9)
78.     plt.streamplot(x, y, u, v)
79. 
80.     ax = plt.subplot(3, 3, 7)
81.     ax.set_xlim(0, 7)
82.     ax.set_ylim(0, 9)
83.     plt.quiver(x, y, u, v)
84. 
85.     plt.subplot(3, 3, 8)
86.     plt.scatter(x, x ** 2, label='$x^2$')
87.     plt.legend(loc='upper left')
88. 
89.     plt.subplot(3, 3, 9)
90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)
91. 
92. 
93. @mpl.style.context("default")
94. @check_figures_equal(extensions=["png"])
95. def test_complete(fig_test, fig_ref):
96.     _generate_complete_test_figure(fig_ref)
97.     # plotting is done, now test its pickle-ability
98.     pkl = BytesIO()
99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)
100.     loaded = pickle.loads(pkl.getbuffer())
101.     loaded.canvas.draw()
102. 
103.     fig_test.set_size_inches(loaded.get_size_inches())
104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())
105. 
106.     plt.close(loaded)
107. 


File: lib/matplotlib/tests/test_pickle.py
Line number range: 1 - 18
Content:
1. from io import BytesIO
2. import ast
3. import pickle
4. 
5. import numpy as np
6. import pytest
7. 
8. import matplotlib as mpl
9. from matplotlib import cm
10. from matplotlib.testing import subprocess_run_helper
11. from matplotlib.testing.decorators import check_figures_equal
12. from matplotlib.dates import rrulewrapper
13. from matplotlib.lines import VertexSelector
14. import matplotlib.pyplot as plt
15. import matplotlib.transforms as mtransforms
16. import matplotlib.figure as mfigure
17. from mpl_toolkits.axes_grid1 import parasite_axes
18. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-06 15:44:15,777 - thread-139660780025408.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning="The user is reporting a bug where pickling a matplotlib figure fails after calling `fig.align_labels()`, with a `TypeError` related to `weakref.ReferenceType`. The goal is to find 5 relevant existing test cases.\n\n1. The provided context includes `lib/matplotlib/tests/test_pickle.py` along with its necessary imports. This file is dedicated to testing the pickling of matplotlib objects, which is the core of the reported issue.\n2. The context also includes `lib/matplotlib/tests/test_figure.py`, which contains `test_align_labels`. While this test uses the function that triggers the bug, it does not test the pickling functionality itself. Furthermore, the imports for `test_figure.py` are missing, preventing the creation of a complete, self-contained test case as required.\n3. Within `test_pickle.py`, the test `test_transform` is highly relevant. It specifically tests the pickling of objects containing `mtransforms.TransformWrapper` and weak references, which directly relates to the `TypeError: cannot pickle 'weakref.ReferenceType' object` error message.\n4. Other tests in `test_pickle.py` such as `test_simple`, `test_complete`, `test_shared`, and `test_inset_and_secondary` provide comprehensive examples of how pickling is tested for various figure configurations, from simple to complex.\n5. Therefore, the provided context is sufficient to extract 5 complete and relevant test cases from `lib/matplotlib/tests/test_pickle.py` that demonstrate functionality similar to the bug report (i.e., testing the pickling of matplotlib figures and their components, including complex object graphs with weak references)." refined_query=''
2025-10-06 15:44:15,778 - thread-139660780025408.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Context retrieved: [Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='236. def test_shared():\n237.     fig, axs = plt.subplots(2, sharex=True)\n238.     fig = pickle.loads(pickle.dumps(fig))\n239.     fig.axes[0].set_xlim(10, 20)\n240.     assert fig.axes[1].get_xlim() == (10, 20)\n241. ', start_line_number=236, end_line_number=241), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='243. def test_inset_and_secondary():\n244.     fig, ax = plt.subplots()\n245.     ax.inset_axes([.1, .1, .3, .3])\n246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))\n247.     pickle.loads(pickle.dumps(fig))\n248. ', start_line_number=243, end_line_number=248), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='196. class TransformBlob:\n197.     def __init__(self):\n198.         self.identity = mtransforms.IdentityTransform()\n199.         self.identity2 = mtransforms.IdentityTransform()\n200.         # Force use of the more complex composition.\n201.         self.composite = mtransforms.CompositeGenericTransform(\n202.             self.identity,\n203.             self.identity2)\n204.         # Check parent -> child links of TransformWrapper.\n205.         self.wrapper = mtransforms.TransformWrapper(self.composite)\n206.         # Check child -> parent links of TransformWrapper.\n207.         self.composite2 = mtransforms.CompositeGenericTransform(\n208.             self.wrapper,\n209.             self.identity)\n210. \n211. \n212. def test_transform():\n213.     obj = TransformBlob()\n214.     pf = pickle.dumps(obj)\n215.     del obj\n216. \n217.     obj = pickle.loads(pf)\n218.     # Check parent -> child links of TransformWrapper.\n219.     assert obj.wrapper._child == obj.composite\n220.     # Check child -> parent links of TransformWrapper.\n221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]\n222.     # Check input and output dimensions are set as expected.\n223.     assert obj.wrapper.input_dims == obj.composite.input_dims\n224.     assert obj.wrapper.output_dims == obj.composite.output_dims\n225. ', start_line_number=196, end_line_number=225), Context(relative_path='lib/matplotlib/tests/test_figure.py', content='28. @image_comparison([\'figure_align_labels\'], extensions=[\'png\', \'svg\'],\n29.                   tol=0 if platform.machine() == \'x86_64\' else 0.01)\n30. def test_align_labels():\n31.     fig = plt.figure(layout=\'tight\')\n32.     gs = gridspec.GridSpec(3, 3)\n33. \n34.     ax = fig.add_subplot(gs[0, :2])\n35.     ax.plot(np.arange(0, 1e6, 1000))\n36.     ax.set_ylabel(\'Ylabel0 0\')\n37.     ax = fig.add_subplot(gs[0, -1])\n38.     ax.plot(np.arange(0, 1e4, 100))\n39. \n40.     for i in range(3):\n41.         ax = fig.add_subplot(gs[1, i])\n42.         ax.set_ylabel(\'YLabel1 %d\' % i)\n43.         ax.set_xlabel(\'XLabel1 %d\' % i)\n44.         if i in [0, 2]:\n45.             ax.xaxis.set_label_position("top")\n46.             ax.xaxis.tick_top()\n47.         if i == 0:\n48.             for tick in ax.get_xticklabels():\n49.                 tick.set_rotation(90)\n50.         if i == 2:\n51.             ax.yaxis.set_label_position("right")\n52.             ax.yaxis.tick_right()\n53. \n54.     for i in range(3):\n55.         ax = fig.add_subplot(gs[2, i])\n56.         ax.set_xlabel(f\'XLabel2 {i}\')\n57.         ax.set_ylabel(f\'YLabel2 {i}\')\n58. \n59.         if i == 2:\n60.             ax.plot(np.arange(0, 1e4, 10))\n61.             ax.yaxis.set_label_position("right")\n62.             ax.yaxis.tick_right()\n63.             for tick in ax.get_xticklabels():\n64.                 tick.set_rotation(90)\n65. \n66.     fig.align_labels()\n67. \n68. ', start_line_number=28, end_line_number=68), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content="20. def test_simple():\n21.     fig = plt.figure()\n22.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n23. \n24.     ax = plt.subplot(121)\n25.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n26. \n27.     ax = plt.axes(projection='polar')\n28.     plt.plot(np.arange(10), label='foobar')\n29.     plt.legend()\n30. \n31.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n32. \n33. #    ax = plt.subplot(121, projection='hammer')\n34. #    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n35. \n36.     plt.figure()\n37.     plt.bar(x=np.arange(10), height=np.arange(10))\n38.     pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)\n39. \n40.     fig = plt.figure()\n41.     ax = plt.axes()\n42.     plt.plot(np.arange(10))\n43.     ax.set_yscale('log')\n44.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n45. ", start_line_number=20, end_line_number=45), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='47. def _generate_complete_test_figure(fig_ref):\n48.     fig_ref.set_size_inches((10, 6))\n49.     plt.figure(fig_ref)\n50. \n51.     plt.suptitle(\'Can you fit any more in a figure?\')\n52. \n53.     # make some arbitrary data\n54.     x, y = np.arange(8), np.arange(10)\n55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)\n56.     v = np.sin(v * -0.6)\n57. \n58.     # Ensure lists also pickle correctly.\n59.     plt.subplot(3, 3, 1)\n60.     plt.plot(list(range(10)))\n61. \n62.     plt.subplot(3, 3, 2)\n63.     plt.contourf(data, hatches=[\'//\', \'ooo\'])\n64.     plt.colorbar()\n65. \n66.     plt.subplot(3, 3, 3)\n67.     plt.pcolormesh(data)\n68. \n69.     plt.subplot(3, 3, 4)\n70.     plt.imshow(data)\n71. \n72.     plt.subplot(3, 3, 5)\n73.     plt.pcolor(data)\n74. \n75.     ax = plt.subplot(3, 3, 6)\n76.     ax.set_xlim(0, 7)\n77.     ax.set_ylim(0, 9)\n78.     plt.streamplot(x, y, u, v)\n79. \n80.     ax = plt.subplot(3, 3, 7)\n81.     ax.set_xlim(0, 7)\n82.     ax.set_ylim(0, 9)\n83.     plt.quiver(x, y, u, v)\n84. \n85.     plt.subplot(3, 3, 8)\n86.     plt.scatter(x, x ** 2, label=\'$x^2$\')\n87.     plt.legend(loc=\'upper left\')\n88. \n89.     plt.subplot(3, 3, 9)\n90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)\n91. \n92. \n93. @mpl.style.context("default")\n94. @check_figures_equal(extensions=["png"])\n95. def test_complete(fig_test, fig_ref):\n96.     _generate_complete_test_figure(fig_ref)\n97.     # plotting is done, now test its pickle-ability\n98.     pkl = BytesIO()\n99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)\n100.     loaded = pickle.loads(pkl.getbuffer())\n101.     loaded.canvas.draw()\n102. \n103.     fig_test.set_size_inches(loaded.get_size_inches())\n104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())\n105. \n106.     plt.close(loaded)\n107. ', start_line_number=47, end_line_number=107), Context(relative_path='lib/matplotlib/tests/test_pickle.py', content='1. from io import BytesIO\n2. import ast\n3. import pickle\n4. \n5. import numpy as np\n6. import pytest\n7. \n8. import matplotlib as mpl\n9. from matplotlib import cm\n10. from matplotlib.testing import subprocess_run_helper\n11. from matplotlib.testing.decorators import check_figures_equal\n12. from matplotlib.dates import rrulewrapper\n13. from matplotlib.lines import VertexSelector\n14. import matplotlib.pyplot as plt\n15. import matplotlib.transforms as mtransforms\n16. import matplotlib.figure as mfigure\n17. from mpl_toolkits.axes_grid1 import parasite_axes\n18. ', start_line_number=1, end_line_number=18)]
2025-10-06 15:44:15,778 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\n[Bug]: Unable to pickle figure with aligned labels\n\nIssue description: \n### Bug summary\n\n Unable to pickle figure after calling `align_labels()`\n\n### Code for reproduction\n\n```python\nimport matplotlib.pyplot as plt\nimport pickle\n\nfig = plt.figure()\nax1 = fig.add_subplot(211)\nax2 = fig.add_subplot(212)\ntime=[0,1,2,3,4]\nspeed=[40000,4300,4500,4700,4800]\nacc=[10,11,12,13,14]\nax1.plot(time,speed)\nax1.set_ylabel(\'speed\')\nax2.plot(time,acc)\nax2.set_ylabel(\'acc\')\n\nfig.align_labels() ##pickling works after removing this line \n\npickle.dumps(fig)\nplt.show()\n```\n\n\n### Actual outcome\n```\nalign.py", line 16\npickle.dumps(fig)\nTypeError: cannot pickle \'weakref.ReferenceType\' object\n```\n### Expected outcome\n\nPickling successful\n\n### Additional information\n\n_No response_\n\n### Operating system\n\nWindows\n\n### Matplotlib Version\n\n3.7.0\n\n### Matplotlib Backend\n\n_No response_\n\n### Python version\n\n_No response_\n\n### Jupyter version\n\n_No response_\n\n### Installation\n\nNone\n\nIssue comments:\n\n\nBug reproducing context:\nFile: lib/matplotlib/tests/test_pickle.py\nLine number range: 236 - 241\nContent:\n236. def test_shared():\n237.     fig, axs = plt.subplots(2, sharex=True)\n238.     fig = pickle.loads(pickle.dumps(fig))\n239.     fig.axes[0].set_xlim(10, 20)\n240.     assert fig.axes[1].get_xlim() == (10, 20)\n241. \n\n\nFile: lib/matplotlib/tests/test_pickle.py\nLine number range: 243 - 248\nContent:\n243. def test_inset_and_secondary():\n244.     fig, ax = plt.subplots()\n245.     ax.inset_axes([.1, .1, .3, .3])\n246.     ax.secondary_xaxis("top", functions=(np.square, np.sqrt))\n247.     pickle.loads(pickle.dumps(fig))\n248. \n\n\nFile: lib/matplotlib/tests/test_pickle.py\nLine number range: 196 - 225\nContent:\n196. class TransformBlob:\n197.     def __init__(self):\n198.         self.identity = mtransforms.IdentityTransform()\n199.         self.identity2 = mtransforms.IdentityTransform()\n200.         # Force use of the more complex composition.\n201.         self.composite = mtransforms.CompositeGenericTransform(\n202.             self.identity,\n203.             self.identity2)\n204.         # Check parent -> child links of TransformWrapper.\n205.         self.wrapper = mtransforms.TransformWrapper(self.composite)\n206.         # Check child -> parent links of TransformWrapper.\n207.         self.composite2 = mtransforms.CompositeGenericTransform(\n208.             self.wrapper,\n209.             self.identity)\n210. \n211. \n212. def test_transform():\n213.     obj = TransformBlob()\n214.     pf = pickle.dumps(obj)\n215.     del obj\n216. \n217.     obj = pickle.loads(pf)\n218.     # Check parent -> child links of TransformWrapper.\n219.     assert obj.wrapper._child == obj.composite\n220.     # Check child -> parent links of TransformWrapper.\n221.     assert [v() for v in obj.wrapper._parents.values()] == [obj.composite2]\n222.     # Check input and output dimensions are set as expected.\n223.     assert obj.wrapper.input_dims == obj.composite.input_dims\n224.     assert obj.wrapper.output_dims == obj.composite.output_dims\n225. \n\n\nFile: lib/matplotlib/tests/test_figure.py\nLine number range: 28 - 68\nContent:\n28. @image_comparison([\'figure_align_labels\'], extensions=[\'png\', \'svg\'],\n29.                   tol=0 if platform.machine() == \'x86_64\' else 0.01)\n30. def test_align_labels():\n31.     fig = plt.figure(layout=\'tight\')\n32.     gs = gridspec.GridSpec(3, 3)\n33. \n34.     ax = fig.add_subplot(gs[0, :2])\n35.     ax.plot(np.arange(0, 1e6, 1000))\n36.     ax.set_ylabel(\'Ylabel0 0\')\n37.     ax = fig.add_subplot(gs[0, -1])\n38.     ax.plot(np.arange(0, 1e4, 100))\n39. \n40.     for i in range(3):\n41.         ax = fig.add_subplot(gs[1, i])\n42.         ax.set_ylabel(\'YLabel1 %d\' % i)\n43.         ax.set_xlabel(\'XLabel1 %d\' % i)\n44.         if i in [0, 2]:\n45.             ax.xaxis.set_label_position("top")\n46.             ax.xaxis.tick_top()\n47.         if i == 0:\n48.             for tick in ax.get_xticklabels():\n49.                 tick.set_rotation(90)\n50.         if i == 2:\n51.             ax.yaxis.set_label_position("right")\n52.             ax.yaxis.tick_right()\n53. \n54.     for i in range(3):\n55.         ax = fig.add_subplot(gs[2, i])\n56.         ax.set_xlabel(f\'XLabel2 {i}\')\n57.         ax.set_ylabel(f\'YLabel2 {i}\')\n58. \n59.         if i == 2:\n60.             ax.plot(np.arange(0, 1e4, 10))\n61.             ax.yaxis.set_label_position("right")\n62.             ax.yaxis.tick_right()\n63.             for tick in ax.get_xticklabels():\n64.                 tick.set_rotation(90)\n65. \n66.     fig.align_labels()\n67. \n68. \n\n\nFile: lib/matplotlib/tests/test_pickle.py\nLine number range: 20 - 45\nContent:\n20. def test_simple():\n21.     fig = plt.figure()\n22.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n23. \n24.     ax = plt.subplot(121)\n25.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n26. \n27.     ax = plt.axes(projection=\'polar\')\n28.     plt.plot(np.arange(10), label=\'foobar\')\n29.     plt.legend()\n30. \n31.     pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n32. \n33. #    ax = plt.subplot(121, projection=\'hammer\')\n34. #    pickle.dump(ax, BytesIO(), pickle.HIGHEST_PROTOCOL)\n35. \n36.     plt.figure()\n37.     plt.bar(x=np.arange(10), height=np.arange(10))\n38.     pickle.dump(plt.gca(), BytesIO(), pickle.HIGHEST_PROTOCOL)\n39. \n40.     fig = plt.figure()\n41.     ax = plt.axes()\n42.     plt.plot(np.arange(10))\n43.     ax.set_yscale(\'log\')\n44.     pickle.dump(fig, BytesIO(), pickle.HIGHEST_PROTOCOL)\n45. \n\n\nFile: lib/matplotlib/tests/test_pickle.py\nLine number range: 47 - 107\nContent:\n47. def _generate_complete_test_figure(fig_ref):\n48.     fig_ref.set_size_inches((10, 6))\n49.     plt.figure(fig_ref)\n50. \n51.     plt.suptitle(\'Can you fit any more in a figure?\')\n52. \n53.     # make some arbitrary data\n54.     x, y = np.arange(8), np.arange(10)\n55.     data = u = v = np.linspace(0, 10, 80).reshape(10, 8)\n56.     v = np.sin(v * -0.6)\n57. \n58.     # Ensure lists also pickle correctly.\n59.     plt.subplot(3, 3, 1)\n60.     plt.plot(list(range(10)))\n61. \n62.     plt.subplot(3, 3, 2)\n63.     plt.contourf(data, hatches=[\'//\', \'ooo\'])\n64.     plt.colorbar()\n65. \n66.     plt.subplot(3, 3, 3)\n67.     plt.pcolormesh(data)\n68. \n69.     plt.subplot(3, 3, 4)\n70.     plt.imshow(data)\n71. \n72.     plt.subplot(3, 3, 5)\n73.     plt.pcolor(data)\n74. \n75.     ax = plt.subplot(3, 3, 6)\n76.     ax.set_xlim(0, 7)\n77.     ax.set_ylim(0, 9)\n78.     plt.streamplot(x, y, u, v)\n79. \n80.     ax = plt.subplot(3, 3, 7)\n81.     ax.set_xlim(0, 7)\n82.     ax.set_ylim(0, 9)\n83.     plt.quiver(x, y, u, v)\n84. \n85.     plt.subplot(3, 3, 8)\n86.     plt.scatter(x, x ** 2, label=\'$x^2$\')\n87.     plt.legend(loc=\'upper left\')\n88. \n89.     plt.subplot(3, 3, 9)\n90.     plt.errorbar(x, x * -0.5, xerr=0.2, yerr=0.4)\n91. \n92. \n93. @mpl.style.context("default")\n94. @check_figures_equal(extensions=["png"])\n95. def test_complete(fig_test, fig_ref):\n96.     _generate_complete_test_figure(fig_ref)\n97.     # plotting is done, now test its pickle-ability\n98.     pkl = BytesIO()\n99.     pickle.dump(fig_ref, pkl, pickle.HIGHEST_PROTOCOL)\n100.     loaded = pickle.loads(pkl.getbuffer())\n101.     loaded.canvas.draw()\n102. \n103.     fig_test.set_size_inches(loaded.get_size_inches())\n104.     fig_test.figimage(loaded.canvas.renderer.buffer_rgba())\n105. \n106.     plt.close(loaded)\n107. \n\n\nFile: lib/matplotlib/tests/test_pickle.py\nLine number range: 1 - 18\nContent:\n1. from io import BytesIO\n2. import ast\n3. import pickle\n4. \n5. import numpy as np\n6. import pytest\n7. \n8. import matplotlib as mpl\n9. from matplotlib import cm\n10. from matplotlib.testing import subprocess_run_helper\n11. from matplotlib.testing.decorators import check_figures_equal\n12. from matplotlib.dates import rrulewrapper\n13. from matplotlib.lines import VertexSelector\n14. import matplotlib.pyplot as plt\n15. import matplotlib.transforms as mtransforms\n16. import matplotlib.figure as mfigure\n17. from mpl_toolkits.axes_grid1 import parasite_axes\n18. \n\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-10-06 15:44:35,814 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport pickle\nimport matplotlib.pyplot as plt\n\n\ndef test_pickle_aligned_labels():\n    """\n    Test that pickling a figure with aligned labels works.\n\n    Regression test for https://github.com/matplotlib/matplotlib/issues/25429\n    """\n    fig = plt.figure()\n    ax1 = fig.add_subplot(211)\n    ax2 = fig.add_subplot(212)\n    time = [0, 1, 2, 3, 4]\n    speed = [40000, 4300, 4500, 4700, 4800]\n    acc = [10, 11, 12, 13, 14]\n    ax1.plot(time, speed)\n    ax1.set_ylabel(\'speed\')\n    ax2.plot(time, acc)\n    ax2.set_ylabel(\'acc\')\n\n    fig.align_labels()\n\n    # This should not raise "TypeError: cannot pickle \'weakref.ReferenceType\'"\n    pickle.dumps(fig)\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 294, 'end_index': 678, 'uri': 'https://huggingface.co/datasets/vgaraujov/swe-lite-clf', 'title': '', 'license_': ''}, {'start_index': 3359, 'end_index': 3664, 'uri': 'https://huggingface.co/datasets/vgaraujov/swe-lite-clf', 'title': '', 'license_': ''}, {'start_index': 5698, 'end_index': 6003, 'uri': 'https://huggingface.co/datasets/vgaraujov/swe-lite-clf', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 4002, 'candidates_token_count': 260, 'total_token_count': 5838, 'prompt_tokens_details': [{'modality': 1, 'token_count': 4002}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 260}], 'thoughts_token_count': 1576, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8986009451059195, 'model_name': 'gemini-2.5-pro'} id='run--37fc38d4-ad14-4424-a077-dba840123284-0' usage_metadata={'input_tokens': 4002, 'output_tokens': 260, 'total_tokens': 5838, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 1576}}
2025-10-06 15:44:48,302 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import pickle\\nimport matplotlib.pyplot as plt\\n\\n\\ndef test_pickle_aligned_labels():\\n    \\"\\"\\"\\n    Test that pickling a figure with aligned labels works.\\n\\n    Regression test for https://github.com/matplotlib/matplotlib/issues/25429\\n    \\"\\"\\"\\n    fig = plt.figure()\\n    ax1 = fig.add_subplot(211)\\n    ax2 = fig.add_subplot(212)\\n    time = [0, 1, 2, 3, 4]\\n    speed = [40000, 4300, 4500, 4700, 4800]\\n    acc = [10, 11, 12, 13, 14]\\n    ax1.plot(time, speed)\\n    ax1.set_ylabel(\'speed\')\\n    ax2.plot(time, acc)\\n    ax2.set_ylabel(\'acc\')\\n\\n    fig.align_labels()\\n\\n    # This should not raise \\"TypeError: cannot pickle \'weakref.ReferenceType\'\\"\\n    pickle.dumps(fig)\\n", "relative_path": "lib/matplotlib/tests/test_pickle_aligned_labels.py"}'}, '__gemini_function_call_thought_signatures__': {'cd9de45c-93fe-4c8e-9654-435994532399': 'CqcaAR/MhbYmaTGcwPUAHu7NfmCmD56Ih8zoRfQ2nFeaVwyHk/xqLln7pgppNypWQHAPxmOaRWzPI8g6TROGDjTQicPWajSmaGixrQE/h7zCJiP1IuB9Eo01I0hQtaEnyS3fAPMuEU8CJCiwRpNe5HE4YTdhdACfPblHshdQKA6oDwJGUfNlZYynNhXOr3Vjn/OOad/XLTiiz+t5lAJkNAvQlVoX0Rxy+Hqf4llUfKn8Fw6f7zMRx/InotG5TfCO70RysIaEJ4sIKx3pt5lO36nHMaH47Imkio9oK01d5tO8tpSlq/iOM9YZ2N1Q05oxQArtz/IGJAWfNBF/WO+vv11zelLB05bvV6digMIEbY8aZ2ZJPzdFHC5CGbeI5xrHL2vBf9CS/z4uxXYRdZ9PRxVnTsycP/gSZoS28LeBd4yj1ch4IRZ85bOQMaTLGNl0dIh+qoXFSYYPBXz8qUDQnDPwnMjIOR/P+AuTnK8hoC4sXXcbp/AhviPwUOvFwJfdAltPaMWG2RHrlrdlYDOPkKvCk2MhN6aH77Rlm0h7E8GjCaFmToT2IumHRbI9FciHcEf8+S1t+tN7747F6X/BkfcSUUjPoGW9Ue3V2NB17NsFhOmICQfv0Gw/+OOcJqL8xJYZ0OHdTanxFK6bFF7tuKxOmYp2X4Dlt6amViHlpN5lKdasaS5vO0aPuVGhKWEsNdkw3asaq6kRyGA88DGczEtAZz8ErrXGmKjsmt+b4aYKd8E+xLs8uOQiaLWpB+UIi/yAnEBscq3+jHMvwHAixEso48R3DcP2jgudnOUcniG6Q8pXBiInknOtdv0gZJ3ESAx/nclM8oHUAHYuFLkp4Tf5Ol8OkmOF6qNcpYD73GiAblEpt0DaL5WEnjqByscZqOHMxOERUhX7rRkNGqscWFO1M8OjgiWidL6Ji8u1ZYfcBTl3nm2DHfzRzAo4tvFgq0Fk0GwSqFkkUr7RF5ULgRDqfWNLMXoPlzT3jlPZCo06c83QQuA+Kxsl9iOH9W4eyuoxtVeGbFUvVeuoZzlmo5yrBDJlNKSV2/ducBmeZdhDNvTmJHTidsAaZZ3OJ7uW+4t5+0G7rEncXYwpQm06iNA2mZOZiuIm8lwOscB5SaE5tyB/GL0PlMr757FwE0nRbbds0VT80mLYJeGkNm5y4giGScxpSRN9/tr5we5YlYMdh/cGNgkaTqSz07LFQ7JkfzwwqeXgEx3K8QLLffn7FjnXCAerZ2vSLoQr+ofeXdJYbNQo7FLMgau09AYFpP5Oce/iZHJ+Q2FVmOvoL5q1DfAd1dVeLpPiXGugRlVcNIhfaaRia34PI6WT2wgFwiE2BCCrrpe/vj53pY5WJiXNBy7ieUqy/rLxe+GYogI/lUBdEYlzz8TIYRfHv5AuPOVT0IO48WEhGUFtA07D7YXULzeKtUB2pA4OmHBwfT5ZXcjw3ViAM/ur9ALE9V0a5+0mpMCqsd7WnISjaMzCBpTa54AlGLtrUUOpzJZYgduVcWVTo4P4dqKTn+g4cSV07CSh32I+HF7zwdgqtHnKmRtt+PMkgH/a8JoKTXsee7vmetaVAQzv0f/BCvvrWAOB/96N45vuj7XxTedpXoQKYgsg7ZNlXzXheWlqsjGHfotOUijp2LWdhe1tmmN39iRRn4KiGcHlZ5HvjtgPyKRWeFKQcYKlrzD2cKfsAtwl1vyST9lQCPBt5e1BXYlrTG0F8DiqzDIEWhAErhdIOvUwr0241g8tIwxYGK8QOyD5SwMZ8Uhcha+29SCij68O3cC9Fk3Ygn+eQhdDeCMJ97VwShTWFcUgK9ohoEjq94UtcA1fmrjNUZcheM6FXoBT/b8d6EVT3TiNkww5s2Stl2zTB1739rJKr73xLyY7z/TtlQ9/7l58QChAV/2a/u6Bu7tzQvyjRpJCLA/duOV/IGHd0orVTNw+tbrk3jOsXjFOQLx0U5qzZRzMCXQ4ydjHwEcsLLqotAE5tNEfIq9xfmbACnbwRF5K8nl7APO1E46O/vwPZI2tdtDnKoD6g4et4RgZX8Co9w74p2VY2ocK63vVOBtLCdiTFfBMSDP9RNPjy+BtWTrW82yVrhmiNzUaPjiYaKF4RB02Jeh1bQQuDNzD3zIw7uG8Yi0P5yyyQQxPIxNr+GKdsc5rSbC/ml7VgiKMRYjZFdRfdh5ZZ6jelBEf7kCNzwKjRN41pcv9EaZd69CpUQI0Rt5B/ulQIcm3+9+2KZ/YJOVzpJTEz+7eQyJcMRgvcpGgNSEMxv0rkLCytqfYz4sJEblhwqi4DF8KkDTd4V1MbCnz0V7oV67agSUGSMj5ottYQEVs8S02ALNz1S45M70kPFaKCkHD0SA9tPm9ugjqKVh67mHFmHS45HUvzjVeB5iQVMjMMNRkwkAtrOqO9M9e60zjgKQ6XISHStn9mLHu4OgF1vseXd3v9b2k2ry2lz+Q8TjGK++I0LDZN1EPwqSbieyM4kFcqJxX8TcHX6BBiyiuPeoUhBXoPHVYJbC2VSWkPmP1dJxc1Sk2DLVePQKss72b/7izl3Lghh+Gf0zKT2If8QcokFUWP8lsvrmgwyEXtmctkke6HEdGPCvcGjiWrNRwcSVz2rFlo4UCVJNk8gUtR+V+bgGR6gO+nxaNtvK9FjMNrzycn6bn7dKtaPoLpnJNylsZx0v8YsDQTa9OEOZ47ozDSufLr7E6H4zt9/w1Z2dsJE2CxzMuWzr8jRmHTTMobl6BldDns5tV9pD20cW5eYZLmqPn+Kqdm8fCrrnMwXvreXuSqUGBRGokoSQwdBpywFoT0eq+jlnj3jvzTIxs9QDijJQ1RkuUe6p/LS7St3oTw+PZ+QnrKLGyUU+k3vxR6/vhu9eNEFIZzkMhbnbCFYBGUK5HEl6mPKHkf+apbtsJmqezr3gGwB/iaKI3dl+jSCmDwv6DjtIB0pfECqDKVT55RdEgVh0/Yj/K4TvLmDd9D8FkWIPsPdZ/m2QoBiuXF8SkcTgBKTibScISVwYgqdHSy75u7nyub1rWpjD3kJxPwrjDMMFZa7o9h+nNmaGOsi3nfNpPkKHgNxf63jtMa+9PHPu7+nAHrY/eFv5Kk/z6B51Tcif0NkyNwJ7jvUnwioXGwseds53YpfwseWzKQeUu1YjcF2Sy2DObzTlAsEqnEfrWDbpMu4VJyeG/R3IwsKqt2EaecUJy7jKFWQ9SzVLOIcoWTUMF/+gC3tCqg1nfwQAqM0zQGIg0vtRnrtwJF9fGq3X3V2FW/o/pYlMODHN5V6cPwT6+6EMZchEwlbxjqlHbLlYAk3W0EwaPKmQyn4hjHhOI3TLNpa1LfbQPEwhCCvR3HqQAo1QVdZR5Mc3i6L7fL1nZEBv4ED6aLMT2s7NgWE/bCrNapQGSrU3QX+duVITmdJOTxKyXSV5dAp+Ye1HUD6sh0miTUfGAwd2PZOJk04COGi5xvgUzXodPLnRsr8Lq+k7qT9lI3cRLO5KlOUgJa6Z5LIxqTNAEppTKew1hJn5SKsH6RYyc3xEnwQCwHkUFeTzMzfGFfGVtmTrm8tSk5XAu4R+xJb57gtEUq+TtZ/ZRYG+VgSZ6HKsvq89VY0t8KdqI8okjTpsPKmlQ1lnqkjjlPAkcHLLyYt7weGpObaJZrdd9ywCenbc19G3JXjynf9kFls0J5rhXfeS6ALPY0IYJePfQO3Zq9qlDMTnLdOQqd3cwinoWE7deDJ/bx/JZ5hDNyvCOW74CAvoKkZ7SjR9IcF4u/3yWPLqgyPVZaq3ns3cuU9zDJmtpd/a19iqkgItuhvhO4IhtOKQNPKMBUBE1+Mdnx+wthUUaVpTuu1oqbb+6whLyxjow8MbONF/5F99TXVnFqAtLXy8OshM/b6+2kqhW+5DQclRxOu7jnBaMFaaKScpHoKLnBEfDr5ZzInlV1JgI+cu8157D1n2+BM2r9Vd4+EzKGMV4ZjGe6jb8ljWLgIAuam3PT0/y0gq4QrAHD2vFu+pFxQww3AFXmDN7thYNYif4nxbI5Zfz+QT2Jvbv8gj5CZdZL6QizbEYNRjQympJEoTj+zRMlfSFn4RGx/A6Za/Vmu93hlY4QKlbuj3mJLRlBDFPiPhDCT/z+jSX+KRsSRoWCQRKJEMP4wSRg8KVlIWocYsMA1V4zBv7/8pxp/XMI5gj6xFjuYVEezcANTBj4VKKiiXboW2W0SMk6HXzTCpTuZpToGQzDMPSQ+Pavf6NGoZLUANLPDAXhgsO7GYvktsa6sUkiO4yN6TcgTg71XvTBD+j6rizxsdb+6H6PaB44pLWbZq3Q0eu5wz4m/SRrIhf8gAXsxcPGgSE+ZQS5Gaum91Y56MXUMVVzf0xfpt9HEFatTgY+n9LpjLMU3VFRkTuNdfZ6TdqttRRtu2x5LbtGDF5oLysNJSY3r73Kfkd9MxerSILKF/NwKwRFdEc9X9n7e5v6/uBtTteZQFYAdtylCrW5ExKV0U4Yggl+PVPbt+jG1Jk5844WA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 3725, 'end_index': 4030, 'uri': 'https://huggingface.co/datasets/vgaraujov/swe-lite-clf', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 20437, 'candidates_token_count': 278, 'total_token_count': 21634, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20437}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 278}], 'thoughts_token_count': 919, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.5121199793095211, 'model_name': 'gemini-2.5-pro'} id='run--a30eceed-5603-4ac0-abe4-aa37520e23d6-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import pickle\nimport matplotlib.pyplot as plt\n\n\ndef test_pickle_aligned_labels():\n    """\n    Test that pickling a figure with aligned labels works.\n\n    Regression test for https://github.com/matplotlib/matplotlib/issues/25429\n    """\n    fig = plt.figure()\n    ax1 = fig.add_subplot(211)\n    ax2 = fig.add_subplot(212)\n    time = [0, 1, 2, 3, 4]\n    speed = [40000, 4300, 4500, 4700, 4800]\n    acc = [10, 11, 12, 13, 14]\n    ax1.plot(time, speed)\n    ax1.set_ylabel(\'speed\')\n    ax2.plot(time, acc)\n    ax2.set_ylabel(\'acc\')\n\n    fig.align_labels()\n\n    # This should not raise "TypeError: cannot pickle \'weakref.ReferenceType\'"\n    pickle.dumps(fig)\n', 'relative_path': 'lib/matplotlib/tests/test_pickle_aligned_labels.py'}, 'id': 'cd9de45c-93fe-4c8e-9654-435994532399', 'type': 'tool_call'}] usage_metadata={'input_tokens': 20437, 'output_tokens': 278, 'total_tokens': 21634, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 919}}
2025-10-06 15:44:49,315 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='lib/matplotlib/tests/test_pickle_aligned_labels.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20740, 'candidates_token_count': 15, 'total_token_count': 20755, 'cached_content_token_count': 19966, 'prompt_tokens_details': [{'modality': 1, 'token_count': 21657}], 'cache_tokens_details': [{'modality': 1, 'token_count': 19966}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 15}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -3.1868051640534154e-06, 'model_name': 'gemini-2.5-pro'} id='run--acd53490-9698-4aa1-a090-1c48851367a8-0' usage_metadata={'input_tokens': 20740, 'output_tokens': 15, 'total_tokens': 20755, 'input_token_details': {'cache_read': 19966}}
2025-10-06 15:44:49,512 - thread-139660780025408.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/lib/matplotlib/tests/test_pickle_aligned_labels.py b/lib/matplotlib/tests/test_pickle_aligned_labels.py
new file mode 100644
index 0000000000..24a76fab94
--- /dev/null
+++ b/lib/matplotlib/tests/test_pickle_aligned_labels.py
@@ -0,0 +1,25 @@
+import pickle
+import matplotlib.pyplot as plt
+
+
+def test_pickle_aligned_labels():
+    """
+    Test that pickling a figure with aligned labels works.
+
+    Regression test for https://github.com/matplotlib/matplotlib/issues/25429
+    """
+    fig = plt.figure()
+    ax1 = fig.add_subplot(211)
+    ax2 = fig.add_subplot(212)
+    time = [0, 1, 2, 3, 4]
+    speed = [40000, 4300, 4500, 4700, 4800]
+    acc = [10, 11, 12, 13, 14]
+    ax1.plot(time, speed)
+    ax1.set_ylabel('speed')
+    ax2.plot(time, acc)
+    ax2.set_ylabel('acc')
+
+    fig.align_labels()
+
+    # This should not raise "TypeError: cannot pickle 'weakref.ReferenceType'"
+    pickle.dumps(fig)

2025-10-06 15:44:49,513 - thread-139660780025408.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-06 15:44:49,532 - thread-139660780025408.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-06 15:44:49,532 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-06 15:44:49,633 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:49,633 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

HEAD is now at 66ba515e67 Merge pull request #25334 from xtanion/contour_nan

2025-10-06 15:44:49,633 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-06 15:44:49,733 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:49,734 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 15:44:49,734 - thread-139660780025408.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-06 15:44:49,734 - thread-139660780025408.app.docker.base_container - INFO - Creating directory lib/matplotlib/tests in the container
2025-10-06 15:44:49,734 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: mkdir -p lib/matplotlib/tests
2025-10-06 15:44:49,834 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:49,834 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:


2025-10-06 15:44:49,835 - thread-139660780025408.app.docker.base_container - INFO - Updating lib/matplotlib/tests/test_pickle_aligned_labels.py in the container
2025-10-06 15:44:49,837 - thread-139660780025408.app.docker.base_container - INFO - Files updated successfully
2025-10-06 15:44:53,136 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls -F"}'}, '__gemini_function_call_thought_signatures__': {'19b41448-2927-4a90-9455-d77f77fc02ed': 'CooGAR/MhbbSpP7VsXqyMe7DWtamcrd0ATxefvPfDt035PjE7H1e0lXq98PlLwOeJejVl8EVdoPi5EBp6M+9agGOtjURw6sjuIJQyaTI6KjMtsCkMzkVcIMJU0OCHI7FMKSxE+1jWWPkJq39s3/rGgU/3XNSkHyifN7Ig/OSTEEGPQkNqAViyzBGOr805B0hHvAOXf2VgQheMH93peuID3R4C5Ze2vUyXz3CfUDgCgjx5S6EAX4m+SAlLvK648AKfoobQO+802L/lqmzu7xKAfMowOzOSuvBYSphwUvoYzRWJ+9bSQ1E5qIn1lEaH7KNwB8Gp+G/8Qr+4WzTbiyKiZYh7roa6rTDSC2vkyDkQ5C7DtlWmJMzrsoYm3UHNEt8ZWQSRZ6Mq+C2aTTp/T4fU/bqRWnYqNWbiLvaZ+RqKXRuO5QQy+v6aqeWPpt3W8KqZJa7Tk1zszKoQsTN0iIRbq5vlpSf6cyHMLB2UMH/dr8aF1FnD0TGwwfCp6j4/Xi4ADc9NMuWPFfkSPO7OhZ7pt5AsrDJMr/jegTtyhtmWtfSwyO95Tf0Fm/8wMs+N7acINwVTSYpq5/UNqVGL0Yr1qr9gOHNd2Gj2peYTW2/HMNFOpincEY0IIh6x071Qqtt4q1aRGPnqEamunNtXiia8uUEpQ3OmeuP6x8oQ8uz5HUxcB5/hRMa0AmHaNWok5i0ICmwuAQCNmXFj0OErol6xXOoalTPViCcCoOz9rI9iL+zT6cr44+il+urRYgyVRsO4JyKCDZEJ5kVdArk3BzD+BQVDnBlEyGpOG0Xrua8ab7vOWVP7u7LmBy+wwlROOdxHpO8A0rWJfr8tC10dEcxz5s27qlGPL3bwqtxz4DuFB357X2IoCU6uiI9LIyertgNPLO73KvgqyinlZ6hNrtDNnfnF+d1uLFbMeZMK1jQsZEldFmPzorGvD0fntnHlXnivd8atdCFgLhgA8RsNNQkLqW8bx2Y/u1TAunW9yrD/uMUSgN6TSuI4uUeIh/QRv5+HoAvXR2UzOGZErIZQA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 539, 'candidates_token_count': 7, 'total_token_count': 730, 'prompt_tokens_details': [{'modality': 1, 'token_count': 539}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 7}], 'thoughts_token_count': 184, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.7585296630859375, 'model_name': 'gemini-2.5-pro'} id='run--9adf3bdb-29d5-40a1-bb00-11e5e877d352-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls -F'}, 'id': '19b41448-2927-4a90-9455-d77f77fc02ed', 'type': 'tool_call'}] usage_metadata={'input_tokens': 539, 'output_tokens': 7, 'total_tokens': 730, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 184}}
2025-10-06 15:44:53,138 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls -F
2025-10-06 15:44:53,239 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:53,239 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

CITATION.bib	    azure-pipelines.yml  lib/			setupext.py
CODE_OF_CONDUCT.md  build/		 mplsetup.cfg.template	src/
INSTALL.rst	    ci/			 pyproject.toml		tmp/
LICENSE/	    doc/		 pytest.ini		tools/
README.md	    environment.yml	 requirements/		tox.ini
SECURITY.md	    extern/		 setup.cfg
__pycache__/	    galleries/		 setup.py

2025-10-06 15:44:54,847 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls -F requirements/"}'}, '__gemini_function_call_thought_signatures__': {'87275d99-77a1-49f9-b1c4-8a83242ef945': 'CsgCAR/MhbYY8zfmRxlb8i3Wr8AibpSAY6++/nHzqYKH6jT+6pF8nBtqbD0DRwdMSS+iqQJeRWdeh0RPFdMezYSZYXmJmsYnKo8L7+GtPDgQNVb/+nIRlNgksyjlqJDRDZNvIDoCE+Al6rzLOvAl8yT8mkt3ARBxnyPN6rmC47hpMNxkTJ2WTRCmvzzY2uag3/Ddlys69Te1X+oH6pidvE4wu3uUoDpXZ8D86ZRX60OOutEoijeqSHDKy8MgbAShPNiYF6BPckND+oySnNl+SV+fUj1mzFKE2BpUT+0yVXOSjauxQ1xycSRl1/z5ty5qt2lsIBDdAiSoRnAvqgQ+FxkUle6kQFaJShiyzrCRcKHxGkXAx+l4GmzpXtPngXOBIGg/TGBK7d+N670f9/bmS5yi+oM90vhtUHDPgUcQqqjN4tT2Yc1ehGAewA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 666, 'candidates_token_count': 9, 'total_token_count': 746, 'prompt_tokens_details': [{'modality': 1, 'token_count': 848}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 9}], 'thoughts_token_count': 71, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.8236445320977105, 'model_name': 'gemini-2.5-pro'} id='run--89ed4430-b2c4-4c38-a988-dddae31b917c-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls -F requirements/'}, 'id': '87275d99-77a1-49f9-b1c4-8a83242ef945', 'type': 'tool_call'}] usage_metadata={'input_tokens': 666, 'output_tokens': 9, 'total_tokens': 746, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 71}}
2025-10-06 15:44:54,848 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls -F requirements/
2025-10-06 15:44:54,949 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:54,949 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

dev/  doc/  testing/

2025-10-06 15:44:56,348 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "ls -F requirements/testing/"}'}, '__gemini_function_call_thought_signatures__': {'346fb824-f06f-46db-916b-e50ed935c146': 'CqsCAR/MhbZAkBFGw7pq7EIWJ8AIlCaJReeQ/SccXAZ8xEqHbcTg9zbU294kPC9l65rpuWzY7jpLkdsTXYgVpYcUul8VUzbD36ds6pIHMJp93y8mVcC5g8dAutvVpLThZIbB5BzUUIzNQxW1I01ZkvAwbuTndopzENv3Evn2KJPbIFfCYI1vsDs9BBI7IVmfG7hzPFy2W3SbKZMf21o7ff4L48enf69R1WRX6iGaVYi2T9V2klNO5I/PzKvhv4WfHG94V5+1lnQVmaycf9DEhcVUsPpQ94gP8gYs0wj70uepssmoUBsNKcQ61eTwK75T+BVJBb8IhaMawnoUbnTFAoozsYku98EAh7OWGuVcrUibCvBSjDA3uZUi5N3S5mYCd1wL4ig5VTdXemvJjX0='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 689, 'candidates_token_count': 11, 'total_token_count': 765, 'prompt_tokens_details': [{'modality': 1, 'token_count': 940}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 11}], 'thoughts_token_count': 65, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.36190893433310767, 'model_name': 'gemini-2.5-pro'} id='run--6bb0d83c-2b78-4098-81be-5632f0b880d2-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'ls -F requirements/testing/'}, 'id': '346fb824-f06f-46db-916b-e50ed935c146', 'type': 'tool_call'}] usage_metadata={'input_tokens': 689, 'output_tokens': 11, 'total_tokens': 765, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 65}}
2025-10-06 15:44:56,350 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: ls -F requirements/testing/
2025-10-06 15:44:56,451 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:56,451 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:

all.txt  extra.txt  flake8.txt	minver.txt

2025-10-06 15:44:57,893 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pip install -r requirements/testing/all.txt"}'}, '__gemini_function_call_thought_signatures__': {'d56db767-8c4b-4687-ad19-445397b583c8': 'CpICAR/MhbYS41MLx8xrH5kM8FuBAuRnO6ILLcv6bSXvcr3XhxN/ykLNn3Y407I4GGecMEujhwQku2KiBTukz5MdFjm8mewoQo+nqP/j2l6GClSYhm6vO0dO2xeIyD+cvlyMsQJoRIrnFhtKSrAi+LghBCgNmK3YQHDOve49tcsDvupzNSbvLgz65vrxrCgaRlqRja5gNGcwQRES8If0HOhmSBzZDvK0ZRlVMuCsok132U+os3HUKBS/2z/tcYjAUT+qVPnIwBhwEOihCfmKW3yp1VHrsnNp9MqiG1eWg0QZURR7DLSdYFUn9SuwAp13INx0JQeUEsZB645BTCNJO1yNn3EdOa5aA7mNjQjeW0NkOIlYXA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 723, 'candidates_token_count': 15, 'total_token_count': 793, 'prompt_tokens_details': [{'modality': 1, 'token_count': 1037}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 15}], 'thoughts_token_count': 55, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.2049887816111247, 'model_name': 'gemini-2.5-pro'} id='run--8269a63b-f00e-48bd-b14a-f2241e1ea09e-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pip install -r requirements/testing/all.txt'}, 'id': 'd56db767-8c4b-4687-ad19-445397b583c8', 'type': 'tool_call'}] usage_metadata={'input_tokens': 723, 'output_tokens': 15, 'total_tokens': 793, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 55}}
2025-10-06 15:44:57,895 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: pip install -r requirements/testing/all.txt
2025-10-06 15:44:58,528 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-06 15:44:58,528 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
pip install -r requirements/test
ting/all.txt

Requirement already satisfied: certifi in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 3)) (2024.8.30)
Requirement already satisfied: coverage!=6.3 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 4)) (7.6.1)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 5)) (5.9.0)
Requirement already satisfied: pytest!=4.6.0,!=5.4.0 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 6)) (8.3.3)
Requirement already satisfied: pytest-cov in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 7)) (5.0.0)
Requirement already satisfied: pytest-rerunfailures in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 8)) (14.0)
Requirement already satisfied: pytest-timeout in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 9)) (2.3.1)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 10)) (3.6.1)
Collecting pytest-xvfb (from -r requirements/testing/all.txt (line 11))
  Downloading pytest_xvfb-3.1.1-py3-none-any.whl.metadata (5.0 kB)
Requirement already satisfied: tornado in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from -r requirements/testing/all.txt (line 12)) (6.4.1)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from pytest!=4.6.0,!=5.4.0->-r requirements/testing/all.txt (line 6)) (2.0.0)
Requirement already satisfied: packaging in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from pytest!=4.6.0,!=5.4.0->-r requirements/testing/all.txt (line 6)) (23.1)
Requirement already satisfied: pluggy<2,>=1.5 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from pytest!=4.6.0,!=5.4.0->-r requirements/testing/all.txt (line 6)) (1.5.0)
Requirement already satisfied: execnet>=2.1 in /opt/miniconda3/envs/testbed/lib/python3.11/site-packages (from pytest-xdist->-r requirements/testing/all.txt (line 10)) (2.1.1)
Collecting pyvirtualdisplay>=1.3 (from pytest-xvfb->-r requirements/testing/all.txt (line 11))
  Downloading PyVirtualDisplay-3.0-py3-none-any.whl.metadata (943 bytes)
Downloading pytest_xvfb-3.1.1-py3-none-any.whl (5.9 kB)
Downloading PyVirtualDisplay-3.0-py3-none-any.whl (15 kB)
Installing collected packages: pyvirtualdisplay, pytest-xvfb
Successfully installed pytest-xvfb-3.1.1 pyvirtualdisplay-3.0
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-10-06 15:44:59,676 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest lib/matplotlib/tests/test_pickle_aligned_labels.py"}'}, '__gemini_function_call_thought_signatures__': {'28722978-0a5c-4e2b-b29b-0f71099d2ce3': 'CtoBAR/MhbYVhBpyjSXto0k4yDAdhkGFfHDpuYRvsNgmnmAq/wx3gn2nrzEKs+jr8cTJnYR2aR+0Flpw2JKG9g13RGKq8tGqEFb1EC0S/IpUYFno1B0gDMMzsH0vO+o62X7PPabefgXXKOHRw7YEWja2zgj4/qdiKoIbpJeg64haNWxsMKWH5lq3FjS0I1tLZ/Yq/Ml5u9zx/OV2YNqEKhoZMq6QsTcknqZmZEHMqoHmvrDrgptS6bYrv+XrCJZfLibkKvLTJc6xGiyMkMyAPr6M7QxMSbiNrA+QHwA='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 1848, 'candidates_token_count': 20, 'total_token_count': 1918, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2215}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 20}], 'thoughts_token_count': 50, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.06344793438911438, 'model_name': 'gemini-2.5-pro'} id='run--9da63092-ec6e-4023-b882-be4c087c7999-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest lib/matplotlib/tests/test_pickle_aligned_labels.py'}, 'id': '28722978-0a5c-4e2b-b29b-0f71099d2ce3', 'type': 'tool_call'}] usage_metadata={'input_tokens': 1848, 'output_tokens': 20, 'total_tokens': 1918, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 50}}
2025-10-06 15:44:59,678 - thread-139660780025408.app.docker.base_container - DEBUG - Executing command: pytest lib/matplotlib/tests/test_pickle_aligned_labels.py
2025-10-06 15:45:01,969 - thread-139660780025408.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-06 15:45:01,969 - thread-139660780025408.app.docker.base_container - DEBUG - Command output:
pytest lib/matplotlib/tests/test
t_pickle_aligned_labels.py

[1m============================= test session starts ==============================[0m
platform linux -- Python 3.11.10, pytest-8.3.3, pluggy-1.5.0
rootdir: /testbed
configfile: pytest.ini
plugins: xdist-3.6.1, rerunfailures-14.0, timeout-2.3.1, cov-5.0.0, xvfb-3.1.1
[1mcollecting ... [0m[1m
collecting 1 item                                                              [0m[1m
collected 1 item                                                               [0m

lib/matplotlib/tests/test_pickle_aligned_labels.py [31mF[0m[31m                     [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________________ test_pickle_aligned_labels __________________________[0m

    [0m[94mdef[39;49;00m [92mtest_pickle_aligned_labels[39;49;00m():[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Test that pickling a figure with aligned labels works.[39;49;00m
    [33m[39;49;00m
    [33m    Regression test for https://github.com/matplotlib/matplotlib/issues/25429[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        fig = plt.figure()[90m[39;49;00m
        ax1 = fig.add_subplot([94m211[39;49;00m)[90m[39;49;00m
        ax2 = fig.add_subplot([94m212[39;49;00m)[90m[39;49;00m
        time = [[94m0[39;49;00m, [94m1[39;49;00m, [94m2[39;49;00m, [94m3[39;49;00m, [94m4[39;49;00m][90m[39;49;00m
        speed = [[94m40000[39;49;00m, [94m4300[39;49;00m, [94m4500[39;49;00m, [94m4700[39;49;00m, [94m4800[39;49;00m][90m[39;49;00m
        acc = [[94m10[39;49;00m, [94m11[39;49;00m, [94m12[39;49;00m, [94m13[39;49;00m, [94m14[39;49;00m][90m[39;49;00m
        ax1.plot(time, speed)[90m[39;49;00m
        ax1.set_ylabel([33m'[39;49;00m[33mspeed[39;49;00m[33m'[39;49;00m)[90m[39;49;00m
        ax2.plot(time, acc)[90m[39;49;00m
        ax2.set_ylabel([33m'[39;49;00m[33macc[39;49;00m[33m'[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        fig.align_labels()[90m[39;49;00m
    [90m[39;49;00m
        [90m# This should not raise "TypeError: cannot pickle 'weakref.ReferenceType'"[39;49;00m[90m[39;49;00m
>       pickle.dumps(fig)[90m[39;49;00m
[1m[31mE       TypeError: cannot pickle 'weakref.ReferenceType' object[0m

[1m[31mlib/matplotlib/tests/test_pickle_aligned_labels.py[0m:25: TypeError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m lib/matplotlib/tests/test_pickle_aligned_labels.py::[1mtest_pickle_aligned_labels[0m - TypeError: cannot pickle 'weakref.ReferenceType' object
[31m============================== [31m[1m1 failed[0m[31m in 1.82s[0m[31m ===============================[0m

2025-10-06 15:45:07,437 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='I have successfully executed the test file `lib/matplotlib/tests/test_pickle_aligned_labels.py`.\n\nThe test failed with the following error:\n```\nTypeError: cannot pickle \'weakref.ReferenceType\' object\n```\n\nThis confirms the bug described in the issue. Here is the full output of the test execution:\n```\npytest lib/matplotlib/tests/test_pickle_aligned_labels.py\n\n============================= test session starts ==============================\nplatform linux -- Python 3.11.10, pytest-8.3.3, pluggy-1.5.0\nrootdir: /testbed\nconfigfile: pytest.ini\nplugins: xdist-3.6.1, rerunfailures-14.0, timeout-2.3.1, cov-5.0.0, xvfb-3.1.1\ncollecting ... \ncollecting 1 item                                                              \ncollected 1 item                                                               \n\nlib/matplotlib/tests/test_pickle_aligned_labels.py F                     [100%]\n\n=================================== FAILURES ===================================\n__________________________ test_pickle_aligned_labels __________________________\n\n    def test_pickle_aligned_labels():\n        """\n        Test that pickling a figure with aligned labels works.\n    \n        Regression test for https://github.com/matplotlib/matplotlib/issues/25429\n        """\n        fig = plt.figure()\n        ax1 = fig.add_subplot(211)\n        ax2 = fig.add_subplot(212)\n        time = [0, 1, 2, 3, 4]\n        speed = [40000, 4300, 4500, 4700, 4800]\n        acc = [10, 11, 12, 13, 14]\n        ax1.plot(time, speed)\n        ax1.set_ylabel(\'speed\')\n        ax2.plot(time, acc)\n        ax2.set_ylabel(\'acc\')\n    \n        fig.align_labels()\n    \n        # This should not raise "TypeError: cannot pickle \'weakref.ReferenceType\'"\n>       pickle.dumps(fig)\nE       TypeError: cannot pickle \'weakref.ReferenceType\' object\n\nlib/matplotlib/tests/test_pickle_aligned_labels.py:25: TypeError\n=========================== short test summary info ============================\nFAILED lib/matplotlib/tests/test_pickle_aligned_labels.py::test_pickle_aligned_labels - TypeError: cannot pickle \'weakref.ReferenceType\' object\n============================== 1 failed in 1.82s ===============================\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'citation_metadata': {'citations': [{'start_index': 1673, 'end_index': 2022, 'uri': 'https://huggingface.co/datasets/vgaraujov/swe-lite-clf', 'title': '', 'license_': ''}]}, 'usage_metadata': {'prompt_token_count': 3360, 'candidates_token_count': 607, 'total_token_count': 4063, 'cached_content_token_count': 1590, 'prompt_tokens_details': [{'modality': 1, 'token_count': 3775}], 'cache_tokens_details': [{'modality': 1, 'token_count': 1590}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 607}], 'thoughts_token_count': 96}, 'finish_reason': 'STOP', 'avg_logprobs': -0.018970409374457018, 'model_name': 'gemini-2.5-pro'} id='run--628b8418-6a21-4e6d-9bd8-f9fbeae3fe6c-0' usage_metadata={'input_tokens': 3360, 'output_tokens': 607, 'total_tokens': 4063, 'input_token_details': {'cache_read': 1590}, 'output_token_details': {'reasoning': 96}}
2025-10-06 15:45:15,968 - thread-139660780025408.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log="FAILED lib/matplotlib/tests/test_pickle_aligned_labels.py::test_pickle_aligned_labels - TypeError: cannot pickle 'weakref.ReferenceType' object" reproduced_bug_commands=['pytest lib/matplotlib/tests/test_pickle_aligned_labels.py']
2025-10-06 15:45:15,969 - thread-139660780025408.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-10-06 15:45:15,969 - thread-139660780025408.app.docker.base_container - INFO - Closing persistent shell...
2025-10-06 15:45:16,069 - thread-139660780025408.app.docker.base_container - INFO - Cleaning up container and temporary files
