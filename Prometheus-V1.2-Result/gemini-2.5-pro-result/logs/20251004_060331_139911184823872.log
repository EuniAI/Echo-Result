2025-10-04 06:03:31,322 - thread-139911184823872.app.docker.base_container - INFO - Created temporary project directory: /tmp/tmpfytaj7s7/astropy
2025-10-04 06:03:31,323 - thread-139911184823872.app.docker.base_container - DEBUG - Using workdir: /testbed
2025-10-04 06:03:31,323 - thread-139911184823872.app.docker.base_container - INFO - Pulling docker image: swebench/sweb.eval.x86_64.astropy_1776_astropy-13033:v1
2025-10-04 06:03:49,363 - thread-139911184823872.app.docker.base_container - INFO - Tagging pulled image as: prometheus_user_defined_container_2255dcbb27
2025-10-04 06:03:49,367 - thread-139911184823872.app.docker.base_container - INFO - Starting container from image prometheus_user_defined_container_2255dcbb27
2025-10-04 06:03:51,239 - thread-139911184823872.app.docker.base_container - INFO - Starting persistent shell for interactive mode...
2025-10-04 06:03:54,377 - thread-139911184823872.app.docker.base_container - INFO - Persistent shell is ready
2025-10-04 06:03:54,378 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: . /opt/miniconda3/bin/activate
2025-10-04 06:03:54,501 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:03:54,501 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:03:54,501 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: conda activate testbed
2025-10-04 06:03:54,625 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:03:54,625 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:03:54,625 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: python -m pip install -e .[test] --verbose
2025-10-04 06:04:38,609 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:04:38,609 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
python -m pip install -e .[test]
] --verbose

Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
Obtaining file:///testbed
  Running command pip subprocess to install build dependencies
  Using pip 24.2 from /opt/miniconda3/envs/testbed/lib/python3.9/site-packages/pip (python 3.9)
  Collecting setuptools==68.0.0
    Obtaining dependency information for setuptools==68.0.0 from https://files.pythonhosted.org/packages/c7/42/be1c7bbdd83e1bfb160c94b9cafd8e25efc7400346cf7ccdbdb452c467fa/setuptools-68.0.0-py3-none-any.whl.metadata
    Using cached setuptools-68.0.0-py3-none-any.whl.metadata (6.4 kB)
  Collecting setuptools_scm>=6.2
    Obtaining dependency information for setuptools_scm>=6.2 from https://files.pythonhosted.org/packages/f7/14/dd3a6053325e882fe191fb4b42289bbdfabf5f44307c302903a8a3236a0a/setuptools_scm-9.2.0-py3-none-any.whl.metadata
    Downloading setuptools_scm-9.2.0-py3-none-any.whl.metadata (7.7 kB)
  Collecting wheel
    Obtaining dependency information for wheel from https://files.pythonhosted.org/packages/0b/2c/87f3254fd8ffd29e4c02732eee68a83a1d3c346ae39bc6822dcbcb697f2b/wheel-0.45.1-py3-none-any.whl.metadata
    Downloading wheel-0.45.1-py3-none-any.whl.metadata (2.3 kB)
  Collecting cython==0.29.22
    Obtaining dependency information for cython==0.29.22 from https://files.pythonhosted.org/packages/08/3b/7697d21e325f27946ee41ef1c78648b6009b609ff22d8614270a758706a1/Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl.metadata
    Using cached Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl.metadata (2.6 kB)
  Collecting oldest-supported-numpy
    Obtaining dependency information for oldest-supported-numpy from https://files.pythonhosted.org/packages/dc/5c/e3c84cfdd488701aa074b22cf5bd227fb15d26e1d55a66d9088c39afa123/oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata
    Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl.metadata (9.8 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/88/ff/5a7cd8c9698628b3c04215ee3a96c69865477f451b4f096682e78d085bfc/extension_helpers-1.3.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/8e/b1/73ce2924fe46281faf31567e96fb9eee4eca02fd1cb852562bb2971e9df1/extension_helpers-1.3.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f8/fb/f9a88ccea5377736d5d1e53c8a6c70207178cdc1ebbf305a50a610cbb751/extension_helpers-1.4.0-py3-none-any.whl (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/24/51/d03359b683ed288b34d713dea97d2aee87a9bd866af1652554d9f643b47d/extension_helpers-1.4.0.tar.gz (from https://pypi.org/simple/extension-helpers/) (requires-python:>=3.10)
  Collecting extension-helpers
    Obtaining dependency information for extension-helpers from https://files.pythonhosted.org/packages/b3/0e/22599eac9e50f4274e78e47cef7e760d7a1bb2f0d0fdfb0bb5b0d2da263a/extension_helpers-1.2.0-py3-none-any.whl.metadata
    Using cached extension_helpers-1.2.0-py3-none-any.whl.metadata (2.2 kB)
  Collecting packaging>=20 (from setuptools_scm>=6.2)
    Obtaining dependency information for packaging>=20 from https://files.pythonhosted.org/packages/20/12/38679034af332785aac8774540895e234f4d07f7545804097de4b666afd8/packaging-25.0-py3-none-any.whl.metadata
    Downloading packaging-25.0-py3-none-any.whl.metadata (3.3 kB)
  Collecting tomli>=1 (from setuptools_scm>=6.2)
    Obtaining dependency information for tomli>=1 from https://files.pythonhosted.org/packages/6e/c2/61d3e0f47e2b74ef40a68b9e6ad5984f6241a942f7cd3bbfbdbd03861ea9/tomli-2.2.1-py3-none-any.whl.metadata
    Downloading tomli-2.2.1-py3-none-any.whl.metadata (10 kB)
  Collecting typing-extensions (from setuptools_scm>=6.2)
    Obtaining dependency information for typing-extensions from https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
    Downloading typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/54/a4/f8188c4f3e07f7737683588210c073478abcb542048cf4ab6fedad0b458a/numpy-2.1.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/59/5f/9003bb3e632f2b58f5e3a3378902dcc73c5518070736c6740fe52454e8e1/numpy-2.1.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/4b/d1/8a730ea07f4a37d94f9172f4ce1d81064b7a64766b460378be278952de75/numpy-2.1.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/25/ca/1166b75c21abd1da445b97bf1fa2f14f423c6cfb4fc7c4ef31dccf9f6a94/numpy-2.1.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/47/1b/1d565e0f6e156e1522ab564176b8b29d71e13d8caf003a08768df3d5cec5/numpy-2.2.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/f2/a5/fdbf6a7871703df6160b5cf3dd774074b086d278172285c52c2758b76305/numpy-2.2.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/ec/d0/c12ddfd3a02274be06ffc71f3efc6d0e457b0409c4481596881e748cb264/numpy-2.2.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/fb/90/8956572f5c4ae52201fdec7ba2044b2c882832dcec7d5d0922c9e9acf2de/numpy-2.2.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/e1/78/31103410a57bc2c2b93a3597340a8119588571f6a4539067546cb9a0bfac/numpy-2.2.4.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/dc/b2/ce4b867d8cd9c0ee84938ae1e6a6f7926ebf928c9090d036fc3c6a04f946/numpy-2.2.5.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.10'): https://files.pythonhosted.org/packages/76/21/7d2a95e4bba9dc13d043ee156a356c0a8f0c6309dff6b21b4d71a073b8a8/numpy-2.2.6.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.10)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/f3/db/8e12381333aea300890829a0a36bfa738cac95475d88982d538725143fd9/numpy-2.3.0.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/2e/19/d7c972dfe90a353dbd3efbbe1d14a5951de80c99c9dc1b93cd998d51dc0f/numpy-2.3.1.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/37/7d/3fec4199c5ffb892bed55cff901e4f39a58c81df9c44c280499e92cad264/numpy-2.3.2.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
    Link requires a different Python (3.9.20 not in: '>=3.11'): https://files.pythonhosted.org/packages/d0/19/95b3d357407220ed24c139018d2518fab0a61a948e68286a25f1a4d049ff/numpy-2.3.3.tar.gz (from https://pypi.org/simple/numpy/) (requires-python:>=3.11)
  Collecting numpy==1.19.3 (from oldest-supported-numpy)
    Obtaining dependency information for numpy==1.19.3 from https://files.pythonhosted.org/packages/c3/8d/2ae53d96a92a66b8daa3dfb2dd6cf4bfcb8e3d4148bdd713c8fc7de83141/numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata
    Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl.metadata (2.0 kB)
  Using cached setuptools-68.0.0-py3-none-any.whl (804 kB)
  Using cached Cython-0.29.22-cp39-cp39-manylinux1_x86_64.whl (1.9 MB)
  Downloading setuptools_scm-9.2.0-py3-none-any.whl (62 kB)
  Downloading wheel-0.45.1-py3-none-any.whl (72 kB)
  Using cached oldest_supported_numpy-2023.12.21-py3-none-any.whl (4.9 kB)
  Using cached numpy-1.19.3-cp39-cp39-manylinux2010_x86_64.whl (14.9 MB)
  Using cached extension_helpers-1.2.0-py3-none-any.whl (23 kB)
  Downloading packaging-25.0-py3-none-any.whl (66 kB)
  Downloading tomli-2.2.1-py3-none-any.whl (14 kB)
  Downloading typing_extensions-4.15.0-py3-none-any.whl (44 kB)
  Installing collected packages: wheel, typing-extensions, tomli, setuptools, packaging, numpy, cython, setuptools_scm, oldest-supported-numpy, extension-helpers
    Creating /tmp/pip-build-env-ka93clb_/overlay/bin
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/wheel to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/f2py to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/f2py3 to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/f2py3.9 to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/cygdb to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/cython to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/cythonize to 755
    changing mode of /tmp/pip-build-env-ka93clb_/overlay/bin/setuptools-scm to 755
  Successfully installed cython-0.29.22 extension-helpers-1.2.0 numpy-1.19.3 oldest-supported-numpy-2023.12.21 packaging-25.0 setuptools-68.0.0 setuptools_scm-9.2.0 tomli-2.2.1 typing-extensions-4.15.0 wheel-0.45.1
  WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  Installing build dependencies ... [?25l[?25hdone
  Running command Checking if build backend supports build_editable
  Checking if build backend supports build_editable ... [?25l[?25hdone
  Running command Getting requirements to build editable
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running egg_info
  writing astropy.egg-info/PKG-INFO
  writing dependency_links to astropy.egg-info/dependency_links.txt
  writing entry points to astropy.egg-info/entry_points.txt
  writing requirements to astropy.egg-info/requires.txt
  writing top-level names to astropy.egg-info/top_level.txt
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file 'astropy.egg-info/SOURCES.txt'
  Getting requirements to build editable ... [?25l[?25hdone
  Running command Preparing editable metadata (pyproject.toml)
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running dist_info
  creating /tmp/pip-modern-metadata-f4oqobef/astropy.egg-info
  writing /tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-modern-metadata-f4oqobef/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-modern-metadata-f4oqobef/astropy-5.1.dev761+g298ccb478.d20251003.dist-info'
  Preparing editable metadata (pyproject.toml) ... [?25l[?25hdone
Requirement already satisfied: numpy>=1.18 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (1.25.2)
Requirement already satisfied: pyerfa>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (2.0.0.3)
Requirement already satisfied: PyYAML>=3.13 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (6.0.1)
Requirement already satisfied: packaging>=19.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (23.1)
Requirement already satisfied: pytest>=7.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (7.4.0)
Requirement already satisfied: pytest-doctestplus>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (1.0.0)
Requirement already satisfied: pytest-astropy-header>=0.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (0.2.2)
Requirement already satisfied: pytest-astropy>=0.9 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (0.10.0)
Requirement already satisfied: pytest-xdist in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from astropy==5.1.dev761+g298ccb478.d20251003) (3.3.1)
Requirement already satisfied: iniconfig in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.1.dev761+g298ccb478.d20251003) (2.0.0)
Requirement already satisfied: pluggy<2.0,>=0.12 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.1.dev761+g298ccb478.d20251003) (1.3.0)
Requirement already satisfied: exceptiongroup>=1.0.0rc8 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.1.dev761+g298ccb478.d20251003) (1.1.3)
Requirement already satisfied: tomli>=1.0.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest>=7.0->astropy==5.1.dev761+g298ccb478.d20251003) (2.0.1)
Requirement already satisfied: pytest-remotedata>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (0.4.0)
Requirement already satisfied: pytest-openfiles>=0.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (0.5.0)
Requirement already satisfied: pytest-arraydiff>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (0.5.0)
Requirement already satisfied: pytest-filter-subpackage>=0.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (0.1.2)
Requirement already satisfied: pytest-cov>=2.3.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (4.1.0)
Requirement already satisfied: pytest-mock>=2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (3.11.1)
Requirement already satisfied: attrs>=19.2.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (23.1.0)
Requirement already satisfied: hypothesis>=5.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (6.82.6)
Requirement already satisfied: setuptools>=30.3.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-doctestplus>=0.12->astropy==5.1.dev761+g298ccb478.d20251003) (68.0.0)
Requirement already satisfied: execnet>=1.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-xdist->astropy==5.1.dev761+g298ccb478.d20251003) (2.0.2)
Requirement already satisfied: sortedcontainers<3.0.0,>=2.1.0 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from hypothesis>=5.1->pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (2.4.0)
Requirement already satisfied: coverage>=5.2.1 in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from coverage[toml]>=5.2.1->pytest-cov>=2.3.1->pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (7.6.2)
Requirement already satisfied: psutil in /opt/miniconda3/envs/testbed/lib/python3.9/site-packages (from pytest-openfiles>=0.3.1->pytest-astropy>=0.9->astropy==5.1.dev761+g298ccb478.d20251003) (5.9.5)
Building wheels for collected packages: astropy
  Running command Building editable for astropy (pyproject.toml)
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/setuptools/config/setupcfg.py:293: _DeprecatedConfig: Deprecated config in `setup.cfg`
  !!

          ********************************************************************************
          The license_file parameter is deprecated, use license_files instead.

          This deprecation is overdue, please update your project and remove deprecated
          calls to avoid build errors in the future.

          See https://setuptools.pypa.io/en/latest/userguide/declarative_config.html for details.
          ********************************************************************************

  !!
    parsed = self.parsers.get(option_name, lambda x: x)(value)
  running editable_wheel
  creating /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info
  writing /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/PKG-INFO
  writing dependency_links to /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/dependency_links.txt
  writing entry points to /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/entry_points.txt
  writing requirements to /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/requires.txt
  writing top-level names to /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/top_level.txt
  writing manifest file '/tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/SOURCES.txt'
  reading manifest template 'MANIFEST.in'
  warning: no files found matching '*.templ' under directory 'astropy'
  warning: no files found matching 'astropy/astropy.cfg'
  warning: no files found matching '*' under directory 'scripts'
  warning: no files found matching '*' under directory 'static'
  no previously-included directories found matching 'docs/_build'
  no previously-included directories found matching 'build'
  warning: no previously-included files matching '*.pyc' found anywhere in distribution
  warning: no previously-included files matching '*.o' found anywhere in distribution
  adding license file 'LICENSE.rst'
  writing manifest file '/tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy.egg-info/SOURCES.txt'
  creating '/tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy-5.1.dev761+g298ccb478.d20251003.dist-info'
  creating /tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy-5.1.dev761+g298ccb478.d20251003.dist-info/WHEEL
  running build_py
  running build_ext
  skipping 'astropy/table/_np_utils.c' Cython extension (up-to-date)
  skipping 'astropy/table/_column_mixins.c' Cython extension (up-to-date)
  skipping 'astropy/io/ascii/cparser.c' Cython extension (up-to-date)
  skipping 'astropy/timeseries/periodograms/bls/_impl.c' Cython extension (up-to-date)
  skipping './astropy/stats/_stats.c' Cython extension (up-to-date)
  skipping './astropy/io/fits/_utils.c' Cython extension (up-to-date)
  skipping './astropy/cosmology/flrw/scalar_inv_efuncs.c' Cython extension (up-to-date)
  skipping './astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c' Cython extension (up-to-date)
  building 'astropy.stats._fast_sigma_clip' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/stats
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/compute_bounds.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src/compute_bounds.o
  astropy/stats/src/compute_bounds.c: In function â€˜compute_sigma_clipped_boundsâ€™:
  astropy/stats/src/compute_bounds.c:53:24: warning: â€˜cenâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     53 |     *upper_bound = cen + sigma_upper * std;
        |                    ~~~~^~~~~~~~~~~~~~~~~~~
  astropy/stats/src/compute_bounds.c:38:45: warning: â€˜medianâ€™ may be used uninitialized in this function [-Wmaybe-uninitialized]
     38 |         mad_buffer[i] = fabs(data_buffer[i] - median);
        |                              ~~~~~~~~~~~~~~~^~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/fast_sigma_clip.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src/fast_sigma_clip.o
  astropy/stats/src/fast_sigma_clip.c: In function â€˜PyInit__fast_sigma_clipâ€™:
  astropy/stats/src/fast_sigma_clip.c:44:48: warning: initialization of â€˜void (*)(char **, const npy_intp *, const npy_intp *, void *)â€™ {aka â€˜void (*)(char **, const long int *, const long int *, void *)â€™} from incompatible pointer type â€˜void (*)(char **, npy_intp *, npy_intp *, void *)â€™ {aka â€˜void (*)(char **, long int *, long int *, void *)â€™} [-Wincompatible-pointer-types]
     44 |     static PyUFuncGenericFunction funcs[1] = { &_sigma_clip_fast };
        |                                                ^
  astropy/stats/src/fast_sigma_clip.c:44:48: note: (near initialization for â€˜funcs[0]â€™)
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/pytime.h:6,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:81,
                   from astropy/stats/src/fast_sigma_clip.c:3:
  /opt/miniconda3/envs/testbed/include/python3.9/object.h:496:8: warning: â€˜dâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    496 |     if (op != NULL) {
        |        ^
  astropy/stats/src/fast_sigma_clip.c:30:19: note: â€˜dâ€™ was declared here
     30 |     PyObject *m, *d;
        |                   ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/stats/src/wirth_select.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src/wirth_select.o
  creating /tmp/tmp_xl1m6kt.build-lib/astropy
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/stats
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src/compute_bounds.o /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src/fast_sigma_clip.o /tmp/tmpxaiz8kpi.build-temp/astropy/stats/src/wirth_select.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._np_utils' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_np_utils.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/table/_np_utils.o
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_np_utils.c:610:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/table
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/table/_np_utils.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.table._column_mixins' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/table/_column_mixins.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/table/_column_mixins.o
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:608:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:21,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/table/_column_mixins.c:608:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/__multiarray_api.h:1463:1: warning: â€˜_import_arrayâ€™ defined but not used [-Wunused-function]
   1463 | _import_array(void)
        | ^~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/table/_column_mixins.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils._compiler' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/utils
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/utils/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/src/compiler.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/utils/src/compiler.o
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/utils
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/utils/src/compiler.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so
  building 'astropy.wcs._wcs' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/wcs
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src
  creating /tmp/tmpxaiz8kpi.build-temp/cextern
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/astropy_wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/astropy_wcs_api.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/astropy_wcs_api.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/distortion.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/distortion_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/distortion_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/docstrings.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/docstrings.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pipeline.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/pipeline.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/pyutil.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/pyutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/src/pyutil.c:9:
  In function â€˜strncpyâ€™,
      inlined from â€˜set_pscardsâ€™ at astropy/wcs/src/pyutil.c:807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 72 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/sip.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/sip_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/sip_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/str_list_proxy.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/str_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/unit_list_proxy.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/unit_list_proxy.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/util.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/util.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_auxprm_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_celprm_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:167:22: warning: initialization of â€˜PyCelprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    167 |     PyCelprm* copy = PyCelprm_new(&PyCelprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c: In function â€˜PyCelprm_set_refâ€™:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  astropy/wcs/src/wcslib_celprm_wrap.c:327:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    327 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_celprm_wrap.c:348:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    348 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_celprm_wrap.c:3:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_prjprm_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_deepcopyâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:149:22: warning: initialization of â€˜PyPrjprm *â€™ from incompatible pointer type â€˜PyObject *â€™ {aka â€˜struct _object *â€™} [-Wincompatible-pointer-types]
    149 |     PyPrjprm* copy = PyPrjprm_new(&PyPrjprmType, NULL, NULL);
        |                      ^~~~~~~~~~~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:517:14: warning: assignment to â€˜PyObject *â€™ {aka â€˜struct _object *â€™} from incompatible pointer type â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} [-Wincompatible-pointer-types]
    517 |     pv_array = (PyArrayObject*) PyArray_SimpleNew(1, &size, NPY_DOUBLE);
        |              ^
  astropy/wcs/src/wcslib_prjprm_wrap.c:519:33: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    519 |     pv = (double*) PyArray_DATA(pv_array);
        |                                 ^~~~~~~~
        |                                 |
        |                                 PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pvâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:556:25: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    556 |     size = PyArray_SIZE(value_array);
        |                         ^~~~~~~~~~~
        |                         |
        |                         PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c:583:35: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    583 |     data = (double*) PyArray_DATA(value_array);
        |                                   ^~~~~~~~~~~
        |                                   |
        |                                   PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:615:15: warning: unused variable â€˜valueâ€™ [-Wunused-variable]
    615 |     PyObject* value = NULL;
        |               ^~~~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_set_pviâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_DIMSâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:59: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                           ^
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1487:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1487 | PyArray_DIMS(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:712:29: warning: passing argument 1 of â€˜PyArray_NDIMâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    712 |         size = PyArray_SIZE(value_array);
        |                             ^~~~~~~~~~~
        |                             |
        |                             PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:73:76: note: in definition of macro â€˜PyArray_SIZEâ€™
     73 | #define PyArray_SIZE(m) PyArray_MultiplyList(PyArray_DIMS(m), PyArray_NDIM(m))
        |                                                                            ^
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1469:35: note: expected â€˜const PyArrayObject *â€™ {aka â€˜const struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1469 | PyArray_NDIM(const PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:48: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                ^~~~~~~~~~~
        |                                                |
        |                                                PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:24: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                        ^~~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  astropy/wcs/src/wcslib_prjprm_wrap.c:720:62: warning: passing argument 1 of â€˜PyArray_DESCRâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    720 |         scalar = PyArray_ToScalar(PyArray_DATA(value_array), value_array);
        |                                                              ^~~~~~~~~~~
        |                                                              |
        |                                                              PyObject * {aka struct _object *}
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:129:44: note: in definition of macro â€˜PyArray_ToScalarâ€™
    129 |         PyArray_Scalar(data, PyArray_DESCR(arr), (PyObject *)arr)
        |                                            ^~~
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1517:30: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1517 | PyArray_DESCR(PyArrayObject *arr)
        |               ~~~~~~~~~~~~~~~^~~
  astropy/wcs/src/wcslib_prjprm_wrap.c: In function â€˜PyPrjprm_get_wâ€™:
  astropy/wcs/src/wcslib_prjprm_wrap.c:780:32: warning: passing argument 1 of â€˜PyArray_DATAâ€™ from incompatible pointer type [-Wincompatible-pointer-types]
    780 |     w = (double*) PyArray_DATA(w_array);
        |                                ^~~~~~~
        |                                |
        |                                PyObject * {aka struct _object *}
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:16,
                   from astropy/wcs/include/astropy_wcs/wcslib_celprm_wrap.h:4,
                   from astropy/wcs/src/wcslib_prjprm_wrap.c:5:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1475:29: note: expected â€˜PyArrayObject *â€™ {aka â€˜struct tagPyArrayObject *â€™} but argument is of type â€˜PyObject *â€™ {aka â€˜struct _object *â€™}
   1475 | PyArray_DATA(PyArrayObject *arr)
        |              ~~~~~~~~~~~~~~~^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_tabprm_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  In file included from /usr/include/string.h:535,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:30,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜PyWcsprm_sptrâ€™ at astropy/wcs/src/wcslib_wrap.c:1789:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ specified bound 9 equals destination size [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wrap.c: In function â€˜PyWcsprm_copyâ€™:
  astropy/wcs/src/wcslib_wrap.c:672:32: warning: argument 1 range [18446744071562067968, 18446744073709551615] exceeds maximum object size 9223372036854775807 [-Walloc-size-larger-than=]
    672 |         if (!((*wtb->arrayp) = calloc((size_t)nelem, sizeof(double)))) {
        |                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:34,
                   from astropy/wcs/include/astropy_wcs/pyutil.h:13,
                   from astropy/wcs/include/astropy_wcs/wcslib_wrap.h:8,
                   from astropy/wcs/src/wcslib_wrap.c:8:
  /usr/include/stdlib.h:543:14: note: in a call to allocation function â€˜callocâ€™ declared here
    543 | extern void *calloc (size_t __nmemb, size_t __size)
        |              ^~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/wcs/src/wcslib_wtbarr_wrap.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: warning: initialization of â€˜int (*)(PyObject *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(struct _object *, int (*)(struct _object *, void *), void *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *, int (*)(PyObject *, void *), void *)â€™ {aka â€˜int (*)(PyWtbarr *, int (*)(struct _object *, void *), void *)â€™} [-Wincompatible-pointer-types]
    208 |   PyWtbarr_traverse,            /* tp_traverse */
        |   ^~~~~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:208:3: note: (near initialization for â€˜PyWtbarrType.tp_traverseâ€™)
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: warning: initialization of â€˜int (*)(PyObject *)â€™ {aka â€˜int (*)(struct _object *)â€™} from incompatible pointer type â€˜int (*)(PyWtbarr *)â€™ [-Wincompatible-pointer-types]
    209 |   PyWtbarr_clear,               /* tp_clear */
        |   ^~~~~~~~~~~~~~
  astropy/wcs/src/wcslib_wtbarr_wrap.c:209:3: note: (near initialization for â€˜PyWtbarrType.tp_clearâ€™)
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/cel.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/cel.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/dis.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/dis.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsbth.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcsbth.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcspih.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcspih.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsulex.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcsulex.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/flexed/wcsutrn.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcsutrn.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/lin.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/lin.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/log.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/log.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/prj.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/prj.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spc.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/spc.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/sph.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/sph.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/spx.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/spx.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/tab.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/tab.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcs.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcs.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcserr.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcserr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsfix.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsfix.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcshdr.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcshdr.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsprintf.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsprintf.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsunits.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsunits.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DECHO -DWCSTRIG_MACRO -DASTROPY_WCS_BUILD -D_GNU_SOURCE -DNDEBUG -DHAVE_SINCOS -UDEBUG -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/wcslib/C -Iastropy/wcs/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/wcslib/C/wcsutil.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsutil.o -std=gnu99 -Wno-strict-prototypes -Wno-unused-function -Wno-unused-value -Wno-uninitialized
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/wcs
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/astropy_wcs.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/astropy_wcs_api.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/distortion.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/distortion_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/docstrings.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/pipeline.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/pyutil.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/sip.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/sip_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/str_list_proxy.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/unit_list_proxy.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/util.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_auxprm_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_celprm_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_prjprm_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_tabprm_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_wrap.o /tmp/tmpxaiz8kpi.build-temp/astropy/wcs/src/wcslib_wtbarr_wrap.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/cel.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/dis.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcsbth.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcspih.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcsulex.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/flexed/wcsutrn.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/lin.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/log.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/prj.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/spc.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/sph.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/spx.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/tab.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcs.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcserr.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsfix.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcshdr.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsprintf.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsunits.o /tmp/tmpxaiz8kpi.build-temp/cextern/wcslib/C/wcsutil.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.time._parse_times' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/time
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/time/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/time/src/parse_times.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/time/src/parse_times.o
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/time
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/time/src/parse_times.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so
  building 'astropy.convolution._convolve' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/convolution
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/convolution/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/convolution/src/convolve.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/convolution/src/convolve.o -UNDEBUG -fPIC
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/convolution
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/convolution/src/convolve.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so
  building 'astropy.utils.xml._iterparser' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/utils/xml
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/utils/xml/src
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/expat
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/utils/xml/src/iterparse.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/utils/xml/src/iterparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlparse.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmlparse.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmlrole.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmlrole.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmltok.o
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingNSâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1657:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  In file included from cextern/expat/lib/xmltok.c:55:
  cextern/expat/lib/xmltok_ns.c: In function â€˜findEncodingâ€™:
  cextern/expat/lib/xmltok.h:272:10: warning: â€˜bufâ€™ may be used uninitialized [-Wmaybe-uninitialized]
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  cextern/expat/lib/xmltok.h:272:10: note: by argument 5 of type â€˜const char *â€™ to â€˜enum XML_Convert_Result(const ENCODING *, const char **, const char *, char **, const char *)â€™ {aka â€˜enum XML_Convert_Result(const struct encoding *, const char **, const char *, char **, const char *)â€™}
    272 |   (((enc)->utf8Convert)(enc, fromP, fromLim, toP, toLim))
        |   ~~~~~~~^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/expat/lib/xmltok_ns.c:95:3: note: in expansion of macro â€˜XmlUtf8Convertâ€™
     95 |   XmlUtf8Convert(enc, &ptr, end, &p, p + ENCODING_MAX - 1);
        |   ^~~~~~~~~~~~~~
  In file included from cextern/expat/lib/xmltok.c:1646:
  cextern/expat/lib/xmltok_ns.c:92:8: note: â€˜bufâ€™ declared here
     92 |   char buf[ENCODING_MAX];
        |        ^~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_EXPAT_CONFIG_H=1 -DBYTEORDER=1234 -DHAVE_UNISTD_H -Iastropy/utils/xml/src -Icextern/expat/lib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/expat/lib/xmltok_impl.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmltok_impl.o
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/utils/xml
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/utils/xml/src/iterparse.o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmlparse.o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmlrole.o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmltok.o /tmp/tmpxaiz8kpi.build-temp/cextern/expat/lib/xmltok_impl.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -Wl,--version-script=astropy/utils/xml/src/iterparse.map
  building 'astropy.io.votable.tablewriter' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io/votable
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io/votable/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -Iastropy/io/votable/src -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/votable/src/tablewriter.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/io/votable/src/tablewriter.o
  astropy/io/votable/src/tablewriter.c: In function â€˜write_tabledataâ€™:
  astropy/io/votable/src/tablewriter.c:270:30: warning: assignment discards â€˜constâ€™ qualifier from pointer target type [-Wdiscarded-qualifiers]
    270 |                 if ((str_tmp = PyUnicode_AsUTF8AndSize(str_val, &str_len)) == NULL) {
        |                              ^
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/io
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/io/votable
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/io/votable/src/tablewriter.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits.compression' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io/fits
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io/fits/src
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib
  creating /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/fits/src/compressionmodule.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/io/fits/src/compressionmodule.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  astropy/io/fits/src/compressionmodule.c: In function â€˜compression_compress_hduâ€™:
  astropy/io/fits/src/compressionmodule.c:1042:16: warning: comparison of integer expressions of different signedness: â€˜npy_intpâ€™ {aka â€˜long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1042 |     if (znaxis < outbufsize) {
        |                ^
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:446:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:446:26: note: directive argument in the range [1, 2147483647]
    446 |         snprintf(tkw, 9, "TTYPE%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:450:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 69 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:453:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:453:26: note: directive argument in the range [1, 2147483647]
    453 |         snprintf(tkw, 9, "TFORM%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜tcolumns_from_headerâ€™ at astropy/io/fits/src/compressionmodule.c:457:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 9 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜tcolumns_from_headerâ€™:
  astropy/io/fits/src/compressionmodule.c:469:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:469:26: note: directive argument in the range [1, 2147483647]
    469 |         snprintf(tkw, 9, "TSCAL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:474:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:474:26: note: directive argument in the range [1, 2147483647]
    474 |         snprintf(tkw, 9, "TZERO%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:479:32: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                                ^~
  astropy/io/fits/src/compressionmodule.c:479:26: note: directive argument in the range [1, 2147483647]
    479 |         snprintf(tkw, 9, "TNULL%u", idx);
        |                          ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from astropy/io/fits/src/compressionmodule.c:96:
  In function â€˜strncpyâ€™,
      inlined from â€˜configure_compressionâ€™ at astropy/io/fits/src/compressionmodule.c:600:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 11 bytes from a string of length 71 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜configure_compressionâ€™:
  astropy/io/fits/src/compressionmodule.c:643:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:643:30: note: directive argument in the range [1, 2147483647]
    643 |         snprintf(keyword, 9, "ZNAME%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c:654:35: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 5 [-Wformat-truncation=]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                                   ^~
  astropy/io/fits/src/compressionmodule.c:654:30: note: directive argument in the range [1, 2147483647]
    654 |         snprintf(keyword, 9, "ZVAL%u", idx);
        |                              ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 6 and 15 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  astropy/io/fits/src/compressionmodule.c: In function â€˜init_output_bufferâ€™:
  astropy/io/fits/src/compressionmodule.c:776:36: warning: â€˜%uâ€™ directive output may be truncated writing between 1 and 10 bytes into a region of size 4 [-Wformat-truncation=]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                                    ^~
  astropy/io/fits/src/compressionmodule.c:776:30: note: directive argument in the range [1, 2147483647]
    776 |         snprintf(keyword, 9, "ZTILE%u", idx);
        |                              ^~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from /opt/miniconda3/envs/testbed/include/python3.9/Python.h:25,
                   from astropy/io/fits/src/compressionmodule.c:98:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 7 and 16 bytes into a destination of size 9
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/buffers.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/buffers.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/cfileio.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/cfileio.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/cfileio.c:7:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffoptpltâ€™ at cextern/cfitsio/lib/cfileio.c:7788:7:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 30 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1711:13,
      inlined from â€˜fits_is_this_a_copyâ€™ at cextern/cfitsio/lib/cfileio.c:1693:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 5 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffomemâ€™:
  cextern/cfitsio/lib/cfileio.c:339:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    339 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/cfileio.c: In function â€˜ffopenâ€™:
  cextern/cfitsio/lib/cfileio.c:971:38: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 55 [-Wformat-truncation=]
    971 |           " extension with EXTNAME = %s,", extname);
        |                                      ^~    ~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/cfileio.c:13:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 28 and 98 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/checksum.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/checksum.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrfile.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrfile.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrmem.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/drvrmem.c: In function â€˜mem_truncateâ€™:
  cextern/cfitsio/lib/drvrmem.c:273:23: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    273 |         if ( filesize > *(memTable[handle].memsizeptr) )
        |                       ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrnet.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrnet.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/drvrsmem.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrsmem.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/editcol.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/editcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/editcol.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2849:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 8 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2809:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 4 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2844:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 4 and 5 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffkshfâ€™ at cextern/cfitsio/lib/editcol.c:2851:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/editcol.c: In function â€˜ffkshfâ€™:
  cextern/cfitsio/lib/editcol.c:2850:24: note: length computed here
   2850 |                   i1 = strlen(newkey);
        |                        ^~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/edithdu.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/edithdu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_f.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/eval_f.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_l.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/eval_l.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/eval_y.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/eval_y.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hcompress.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/fits_hcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fits_hdecompress.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/fits_hdecompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/fitscore.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/fitscore.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkkyâ€™:
  cextern/cfitsio/lib/fitscore.c:1118:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1118 |             if (strlen(cptr) > maxlen) maxlen = strlen(cptr); /* find longest token */
        |                              ^
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffmkeyâ€™:
  cextern/cfitsio/lib/fitscore.c:1295:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   1295 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/fitscore.c:37:
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1115:8:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffmkkyâ€™ at cextern/cfitsio/lib/fitscore.c:1159:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 74 bytes from a string of length 74 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffbinit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:5098:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   5098 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffbinit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffainit.part.0â€™:
  cextern/cfitsio/lib/fitscore.c:4901:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                                    ^~
   4902 |             name, (long) tbcoln);
        |             ~~~~
  cextern/cfitsio/lib/fitscore.c:4901:42: note: using the range [-9223372036854775808, 9223372036854775807] for directive argument
   4901 |             snprintf(message,FLEN_ERRMSG,"Value of %s keyword out of range: %ld (ffainit).",
        |                                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 45 and 138 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4892:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4892 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:4884:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 72 [-Wformat-truncation=]
   4884 |             snprintf(message,FLEN_ERRMSG,"Required %s keyword not found (ffainit).", name);
        |                                                    ^~                                ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 39 and 113 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜fftheapâ€™:
  cextern/cfitsio/lib/fitscore.c:6083:75: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   6083 |                 "Descriptor in row %ld, column %d has invalid heap address",
        |                                                                           ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 55 and 82 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffcmphâ€™:
  cextern/cfitsio/lib/fitscore.c:6221:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   6221 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c: In function â€˜ffgcprllâ€™:
  cextern/cfitsio/lib/fitscore.c:5959:69: warning: â€˜ blocks.â€™ directive output may be truncated writing 8 bytes into a region of size between 7 and 23 [-Wformat-truncation=]
   5959 |        "Failed to extend the size of the variable length heap by %ld blocks.",
        |                                                                     ^~~~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 67 and 83 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/fitscore.c:5761:76: warning: â€˜__builtin___snprintf_chkâ€™ output may be truncated before the last format character [-Wformat-truncation=]
   5761 |         "First element to write is too large: %ld; max allowed value is %ld",
        |                                                                            ^
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/fitscore.c:46:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 63 and 101 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcol.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolb.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcold.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcole.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoli.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolj.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolk.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoll.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcols.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getcols.c:9:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:442:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:423:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:384:15:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying 20 bytes from a string of length 399 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:365:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgclsâ€™ at cextern/cfitsio/lib/getcols.c:587:19:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 78 bytes from a string of length 79 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolsb.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcolui.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluj.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getcoluj.c: In function â€˜fffi8u4â€™:
  cextern/cfitsio/lib/getcoluj.c:1331:36: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1331 |                 else if (input[ii] > ULONG_MAX)
        |                                    ^
  cextern/cfitsio/lib/getcoluj.c:1414:40: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜long unsigned intâ€™ [-Wsign-compare]
   1414 |                     else if (input[ii] > ULONG_MAX)
        |                                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getcoluk.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/getkey.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgskyâ€™:
  cextern/cfitsio/lib/getkey.c:1080:23: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   1080 |         if (firstchar <= len)
        |                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/getkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffgcntâ€™ at cextern/cfitsio/lib/getkey.c:1134:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 10 bytes from a string of length 11 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffgphd.part.0â€™:
  cextern/cfitsio/lib/getkey.c:2855:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2855 |             "First keyword of the extension is not XTENSION: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2847:53: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 49 [-Wformat-truncation=]
   2847 |                    "This is not an IMAGE extension: %s", value);
        |                                                     ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 33 and 103 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2821:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 40 [-Wformat-truncation=]
   2821 |                    "First keyword of the file is not SIMPLE: %s", name);
        |                                                              ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 42 and 116 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2930:48: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2930 |             "Illegal value for BITPIX keyword: %s", value);
        |                                                ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2921:57: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 38 [-Wformat-truncation=]
   2921 |             "Value of BITPIX keyword is not an integer: %s", value);
        |                                                         ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 44 and 114 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2913:61: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 34 [-Wformat-truncation=]
   2913 |             "Second keyword of the extension is not BITPIX: %s", name);
        |                                                             ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3021:70: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size between 19 and 28 [-Wformat-truncation=]
   3021 |               "Name of keyword no. %d contains illegal character(s): %s",
        |                                                                      ^~
   3022 |               nextkey, name);
        |                        ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 54 and 137 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3118:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3118 |                 "Error reading EXTEND keyword value as a logical: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3101:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3101 |                 "Error reading GCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3088:68: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 31 [-Wformat-truncation=]
   3088 |                 "Error reading PCOUNT keyword value as an integer: %s", value);
        |                                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 51 and 121 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3075:67: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 32 [-Wformat-truncation=]
   3075 |                 "Error reading BLANK keyword value as an integer: %s", value);
        |                                                                   ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 50 and 120 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3058:65: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 34 [-Wformat-truncation=]
   3058 |                 "Error reading BZERO keyword value as a double: %s", value);
        |                                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 48 and 118 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:3041:66: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 33 [-Wformat-truncation=]
   3041 |                 "Error reading BSCALE keyword value as a double: %s", value);
        |                                                                  ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 119 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbâ€™:
  cextern/cfitsio/lib/getkey.c:2282:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2282 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2273:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2273 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghtbllâ€™:
  cextern/cfitsio/lib/getkey.c:2425:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2425 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2416:49: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 50 [-Wformat-truncation=]
   2416 |                 "This is not a TABLE extension: %s", value);
        |                                                 ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 32 and 102 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnâ€™:
  cextern/cfitsio/lib/getkey.c:2570:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2570 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2561:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2561 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c: In function â€˜ffghbnllâ€™:
  cextern/cfitsio/lib/getkey.c:2693:58: warning: â€˜%sâ€™ directive output may be truncated writing up to 74 bytes into a region of size 33 [-Wformat-truncation=]
   2693 |         "First keyword of the extension is not XTENSION: %s", name);
        |                                                          ^~   ~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 49 and 123 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/getkey.c:2684:52: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 47 [-Wformat-truncation=]
   2684 |                 "This is not a BINTABLE extension: %s", value);
        |                                                    ^~   ~~~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/getkey.c:14:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 35 and 105 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/group.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/group.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/group.c: In function â€˜ffgmopâ€™:
  cextern/cfitsio/lib/group.c:2290:62: warning: â€˜%sâ€™ directive output may be truncated writing up to 70 bytes into a region of size 39 [-Wformat-truncation=]
   2290 |                   "Cannot open member HDU file with URI type %s (ffgmop)",
        |                                                              ^~
   2291 |                           uri);
        |                           ~~~
  In file included from /usr/include/stdio.h:894,
                   from cextern/cfitsio/lib/fitsio.h:64,
                   from cextern/cfitsio/lib/fitsio2.h:4,
                   from cextern/cfitsio/lib/group.c:17:
  /usr/include/x86_64-linux-gnu/bits/stdio2.h:71:10: note: â€˜__builtin___snprintf_chkâ€™ output between 52 and 122 bytes into a destination of size 81
     71 |   return __builtin___snprintf_chk (__s, __n, __USE_FORTIFY_LEVEL - 1,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     72 |                                    __glibc_objsize (__s), __fmt,
        |                                    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     73 |                                    __va_arg_pack ());
        |                                    ~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/grparser.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/grparser.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/histo.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/histo.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/imcompress.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/imcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/imcompress.c: In function â€˜imcomp_decompress_tileâ€™:
  cextern/cfitsio/lib/imcompress.c:6072:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6072 |             if (tilebytesize == 4 * tilelen) {  /* float pixels */
        |                              ^~
  cextern/cfitsio/lib/imcompress.c:6103:37: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
   6103 |             } else if (tilebytesize == 8 * tilelen) { /* double pixels */
        |                                     ^~
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_compress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:8517:30: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} [-Wsign-compare]
   8517 |                     if (dlen < vlamemlen) {
        |                              ^
  cextern/cfitsio/lib/imcompress.c: In function â€˜fits_uncompress_tableâ€™:
  cextern/cfitsio/lib/imcompress.c:9258:39: warning: comparison of integer expressions of different signedness: â€˜LONGLONGâ€™ {aka â€˜long long intâ€™} and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
   9258 |                         if (cvlalen   == vlamemlen ) {
        |                                       ^~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/imcompress.c:3:
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8170:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8174:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8178:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8803:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8807:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜fits_uncompress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8811:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 7 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜imcomp_get_compressed_image_parâ€™ at cextern/cfitsio/lib/imcompress.c:5271:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying 11 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8671:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜fits_compress_tableâ€™ at cextern/cfitsio/lib/imcompress.c:8544:3:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin_strncatâ€™ output may be truncated copying between 0 and 29 bytes from a string of length 70 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/iraffits.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/iraffits.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:576:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofitsâ€™ at cextern/cfitsio/lib/iraffits.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 3 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcomâ€™ at cextern/cfitsio/lib/iraffits.c:2088:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying 2 bytes from a string of the same length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1930:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:1992:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1908:16: note: length computed here
   1908 |     lkeyword = strlen (keyword);
        |                ^~~~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2009:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2001:2:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated before terminating nul copying as many bytes from a string as its length [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputcâ€™:
  cextern/cfitsio/lib/iraffits.c:1909:12: note: length computed here
   1909 |     lval = strlen (value);
        |            ^~~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜hputcâ€™ at cextern/cfitsio/lib/iraffits.c:2020:6:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying between 0 and 49 bytes from a string of length 49 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜hputsâ€™ at cextern/cfitsio/lib/iraffits.c:1875:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin___strncpy_chkâ€™ specified bound depends on the length of the source argument [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  cextern/cfitsio/lib/iraffits.c: In function â€˜hputsâ€™:
  cextern/cfitsio/lib/iraffits.c:1869:13: note: length computed here
   1869 |     lcval = strlen (cval);
        |             ^~~~~~~~~~~~~
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/iraffits.c:51:
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:624:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:864:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:853:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:823:10:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:811:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜iraftofits.israâ€™ at cextern/cfitsio/lib/iraffits.c:880:11:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output may be truncated copying 80 bytes from a string of length 80 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/modkey.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/modkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/modkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffiklsâ€™ at cextern/cfitsio/lib/modkey.c:1282:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncpyâ€™,
      inlined from â€˜ffmklsâ€™ at cextern/cfitsio/lib/modkey.c:783:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:567:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffpuntâ€™ at cextern/cfitsio/lib/modkey.c:562:13:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output may be truncated copying between 0 and 72 bytes from a string of length 72 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/pliocomp.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/pliocomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcol.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcol.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolb.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcold.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcold.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcole.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcole.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoli.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoli.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolj.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolk.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoll.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoll.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcols.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcols.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolsb.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolsb.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolu.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolu.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcolui.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolui.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluj.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoluj.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putcoluk.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoluk.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/putkey.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putkey.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/putkey.c: In function â€˜ffprecâ€™:
  cextern/cfitsio/lib/putkey.c:326:19: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    326 |     for (ii=0; ii < keylength; ii++)       /* make sure keyword name is uppercase */
        |                   ^
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/putkey.c:8:
  In function â€˜strncpyâ€™,
      inlined from â€˜ffpklsâ€™ at cextern/cfitsio/lib/putkey.c:483:12:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:95:10: warning: â€˜__builtin_strncpyâ€™ output truncated copying 2 bytes from a string of length 3 [-Wstringop-truncation]
     95 |   return __builtin___strncpy_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     96 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/quantize.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/quantize.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/region.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/region.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/region.c:988:1: warning: "/*" within comment [-Wcomment]
    988 | /*---------------------------------------------------------------------------*/
        |
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/ricecomp.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/ricecomp.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/scalnull.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/scalnull.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/simplerng.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/simplerng.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/swapproc.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/swapproc.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/swapproc.c: In function â€˜ffswap2â€™:
  cextern/cfitsio/lib/swapproc.c:87:24: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
     87 |     for (ii = peel; ii < (nvals - peel - (nvals - peel) % 8); ii+=8) {
        |                        ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcssub.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/wcssub.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  In file included from /usr/include/string.h:535,
                   from cextern/cfitsio/lib/wcssub.c:3:
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:847:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:852:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:858:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:889:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:898:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:907:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:916:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:925:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:934:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:945:9:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 50 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  In function â€˜strncatâ€™,
      inlined from â€˜ffgtwcsâ€™ at cextern/cfitsio/lib/wcssub.c:1040:5:
  /usr/include/x86_64-linux-gnu/bits/string_fortified.h:138:10: warning: â€˜__builtin___strncat_chkâ€™ output truncated copying 77 bytes from a string of length 80 [-Wstringop-truncation]
    138 |   return __builtin___strncat_chk (__dest, __src, __len,
        |          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    139 |                                   __glibc_objsize (__dest));
        |                                   ~~~~~~~~~~~~~~~~~~~~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/wcsutil.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/wcsutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zcompress.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/zcompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zcompress.c: In function â€˜uncompress2fileâ€™:
  cextern/cfitsio/lib/zcompress.c:347:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    347 |             != (d_stream.total_out - bytes_out)) {
        |             ^~
  cextern/cfitsio/lib/zcompress.c: In function â€˜compress2file_from_memâ€™:
  cextern/cfitsio/lib/zcompress.c:515:13: warning: comparison of integer expressions of different signedness: â€˜intâ€™ and â€˜long unsigned intâ€™ [-Wsign-compare]
    515 |             != (c_stream.total_out - bytes_out)) {
        |             ^~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/lib/zuncompress.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/zuncompress.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  cextern/cfitsio/lib/zuncompress.c: In function â€˜write_bufâ€™:
  cextern/cfitsio/lib/zuncompress.c:581:27: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    581 |       if (bytes_out + cnt > *memsize)
        |                           ^
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/adler32.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/adler32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/crc32.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/crc32.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/deflate.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/deflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/infback.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/infback.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inffast.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/inffast.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inflate.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/inflate.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/inftrees.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/inftrees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/trees.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/trees.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/uncompr.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/uncompr.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -DHAVE_UNISTD_H -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -Icextern/cfitsio/lib -Icextern/cfitsio/zlib -I/opt/miniconda3/envs/testbed/include/python3.9 -c cextern/cfitsio/zlib/zutil.c -o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/zutil.o -Wno-declaration-after-statement -Wno-strict-prototypes -Wno-unused -Wno-uninitialized -Wno-unused-result -Wno-misleading-indentation -Wno-format-overflow
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/io/fits
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/io/fits/src/compressionmodule.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/buffers.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/cfileio.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/checksum.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrfile.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrmem.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrnet.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/drvrsmem.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/editcol.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/edithdu.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/eval_f.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/eval_l.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/eval_y.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/fits_hcompress.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/fits_hdecompress.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/fitscore.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcol.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolb.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcold.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcole.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoli.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolj.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolk.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoll.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcols.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolsb.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcolui.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoluj.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getcoluk.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/getkey.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/group.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/grparser.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/histo.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/imcompress.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/iraffits.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/modkey.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/pliocomp.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcol.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolb.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcold.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcole.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoli.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolj.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolk.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoll.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcols.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolsb.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolu.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcolui.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoluj.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putcoluk.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/putkey.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/quantize.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/region.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/ricecomp.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/scalnull.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/simplerng.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/swapproc.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/wcssub.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/wcsutil.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/zcompress.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/lib/zuncompress.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/adler32.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/crc32.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/deflate.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/infback.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/inffast.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/inflate.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/inftrees.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/trees.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/uncompr.o /tmp/tmpxaiz8kpi.build-temp/cextern/cfitsio/zlib/zutil.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.ascii.cparser' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io/ascii
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/io/ascii/src
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/cparser.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/io/ascii/cparser.o
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/io/ascii/cparser.c:610:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/io/ascii/src/tokenizer.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/io/ascii/src/tokenizer.o
  astropy/io/ascii/src/tokenizer.c: In function â€˜pushâ€™:
  astropy/io/ascii/src/tokenizer.c:124:54: warning: comparison of integer expressions of different signedness: â€˜long intâ€™ and â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} [-Wsign-compare]
    124 |     if (self->col_ptrs[col] - self->output_cols[col] >=
        |                                                      ^~
  astropy/io/ascii/src/tokenizer.c: In function â€˜tokenizeâ€™:
  astropy/io/ascii/src/tokenizer.c:424:42: warning: comparison of integer expressions of different signedness: â€˜size_tâ€™ {aka â€˜long unsigned intâ€™} and â€˜intâ€™ [-Wsign-compare]
    424 |                     if (self->source_pos == -1
        |                                          ^~
  astropy/io/ascii/src/tokenizer.c:360:9: warning: enumeration value â€˜QUOTED_FIELD_NEWLINEâ€™ not handled in switch [-Wswitch]
    360 |         switch (self->state)
        |         ^~~~~~
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/io/ascii
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/io/ascii/cparser.o /tmp/tmpxaiz8kpi.build-temp/astropy/io/ascii/src/tokenizer.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.bls._impl' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/_impl.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/bls/_impl.o
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from astropy/timeseries/periodograms/bls/_impl.c:610:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/timeseries/periodograms/bls/bls.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/bls/bls.o
  astropy/timeseries/periodograms/bls/bls.c: In function â€˜run_blsâ€™:
  astropy/timeseries/periodograms/bls/bls.c:92: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
     92 | #pragma omp parallel
        |
  astropy/timeseries/periodograms/bls/bls.c:116: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    116 |     #pragma omp parallel for reduction(+:sum_y), reduction(+:sum_ivar)
        |
  astropy/timeseries/periodograms/bls/bls.c:125: warning: ignoring â€˜#pragma omp parallelâ€™ [-Wunknown-pragmas]
    125 |     #pragma omp parallel for
        |
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/bls
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/bls/_impl.o /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/bls/bls.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.stats._stats' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/stats/_stats.c -o /tmp/tmpxaiz8kpi.build-temp/./astropy/stats/_stats.o
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/stats/_stats.c:611:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/./astropy/stats/_stats.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so
  building 'astropy.io.fits._utils' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/io/fits/_utils.c -o /tmp/tmpxaiz8kpi.build-temp/./astropy/io/fits/_utils.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/./astropy/io/fits/_utils.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so
  building 'astropy.cosmology.flrw.scalar_inv_efuncs' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/cosmology
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/cosmology/flrw/scalar_inv_efuncs.c -o /tmp/tmpxaiz8kpi.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c: In function â€˜__pyx_f_7astropy_9cosmology_4flrw_17scalar_inv_efuncs_nufuncâ€™:
  ./astropy/cosmology/flrw/scalar_inv_efuncs.c:6281:33: warning: comparison of integer expressions of different signedness: â€˜unsigned intâ€™ and â€˜intâ€™ [-Wsign-compare]
   6281 |   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
        |                                 ^
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/cosmology
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/cosmology/flrw
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/./astropy/cosmology/flrw/scalar_inv_efuncs.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so
  building 'astropy.timeseries.periodograms.lombscargle.implementations.cython_impl' extension
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmpxaiz8kpi.build-temp/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include -I/opt/miniconda3/envs/testbed/include/python3.9 -c ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c -o /tmp/tmpxaiz8kpi.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o
  In file included from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarraytypes.h:1822,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/ndarrayobject.h:12,
                   from /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/arrayobject.h:4,
                   from ./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.c:610:
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/numpy/core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning "Using deprecated NumPy API, disable it with " "#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION" [-Wcpp]
     17 | #warning "Using deprecated NumPy API, disable it with " \
        |  ^~~~~~~
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/lombscargle
  creating /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/lombscargle/implementations
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/./astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so
  building 'astropy.compiler_version' extension
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -Wno-unused-result -Wsign-compare -DNDEBUG -O2 -Wall -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -I/opt/miniconda3/envs/testbed/include -fPIC -O2 -isystem /opt/miniconda3/envs/testbed/include -fPIC -I/opt/miniconda3/envs/testbed/include/python3.9 -c astropy/_compiler.c -o /tmp/tmpxaiz8kpi.build-temp/astropy/_compiler.o
  gcc -pthread -B /opt/miniconda3/envs/testbed/compiler_compat -shared -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib -Wl,-rpath,/opt/miniconda3/envs/testbed/lib -Wl,-rpath-link,/opt/miniconda3/envs/testbed/lib -L/opt/miniconda3/envs/testbed/lib /tmp/tmpxaiz8kpi.build-temp/astropy/_compiler.o -o /tmp/tmp_xl1m6kt.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/stats/_fast_sigma_clip.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/table/_np_utils.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/table/_column_mixins.cpython-39-x86_64-linux-gnu.so -> astropy/table
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/utils/_compiler.cpython-39-x86_64-linux-gnu.so -> astropy/utils
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/wcs/_wcs.cpython-39-x86_64-linux-gnu.so -> astropy/wcs
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/time/_parse_times.cpython-39-x86_64-linux-gnu.so -> astropy/time
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/convolution/_convolve.cpython-39-x86_64-linux-gnu.so -> astropy/convolution
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/utils/xml/_iterparser.cpython-39-x86_64-linux-gnu.so -> astropy/utils/xml
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/io/votable/tablewriter.cpython-39-x86_64-linux-gnu.so -> astropy/io/votable
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/io/fits/compression.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/io/ascii/cparser.cpython-39-x86_64-linux-gnu.so -> astropy/io/ascii
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/bls/_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/bls
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/stats/_stats.cpython-39-x86_64-linux-gnu.so -> astropy/stats
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/io/fits/_utils.cpython-39-x86_64-linux-gnu.so -> astropy/io/fits
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/cosmology/flrw/scalar_inv_efuncs.cpython-39-x86_64-linux-gnu.so -> astropy/cosmology/flrw
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/timeseries/periodograms/lombscargle/implementations/cython_impl.cpython-39-x86_64-linux-gnu.so -> astropy/timeseries/periodograms/lombscargle/implementations
  copying /tmp/tmp_xl1m6kt.build-lib/astropy/compiler_version.cpython-39-x86_64-linux-gnu.so -> astropy
  Editable install will be performed using a meta path finder.

  Options like `package-data`, `include/exclude-package-data` or
  `packages.find.exclude/include` may have no effect.

  adding '__editable___astropy_5_1_dev761_g298ccb478_d20251003_finder.py'
  adding '__editable__.astropy-5.1.dev761+g298ccb478.d20251003.pth'
  creating '/tmp/pip-wheel-8ssnv_os/.tmp-k7o8wgh6/astropy-5.1.dev761+g298ccb478.d20251003-0.editable-cp39-cp39-linux_x86_64.whl' and adding '/tmp/tmp66biqtj3astropy-5.1.dev761+g298ccb478.d20251003-0.editable-cp39-cp39-linux_x86_64.whl' to it
  adding 'astropy-5.1.dev761+g298ccb478.d20251003.dist-info/LICENSE.rst'
  adding 'astropy-5.1.dev761+g298ccb478.d20251003.dist-info/METADATA'
  adding 'astropy-5.1.dev761+g298ccb478.d20251003.dist-info/WHEEL'
  adding 'astropy-5.1.dev761+g298ccb478.d20251003.dist-info/entry_points.txt'
  adding 'astropy-5.1.dev761+g298ccb478.d20251003.dist-info/top_level.txt'
  adding 'astropy-5.1.dev761+g298ccb478.d20251003.dist-info/RECORD'
  /tmp/pip-build-env-ka93clb_/overlay/lib/python3.9/site-packages/setuptools/command/editable_wheel.py:348: InformationOnly: Editable installation.
  !!

          ********************************************************************************
          Please be careful with folders in your working directory with the same
          name as your package as they may take precedence during imports.
          ********************************************************************************

  !!
    wheel_obj.write_files(unpacked)
  Building editable for astropy (pyproject.toml) ... [?25l[?25hdone
  Created wheel for astropy: filename=astropy-5.1.dev761+g298ccb478.d20251003-0.editable-cp39-cp39-linux_x86_64.whl size=6825 sha256=349cb453c5fbf3700184f0ed439783e887f21592e41565bd7fefd3b3a8fbfef2
  Stored in directory: /tmp/pip-ephem-wheel-cache-cl18djoy/wheels/7d/66/67/70d1ee2124ccf21d601c352e25cdca10f611f7c8b3f9ffb9e4
Successfully built astropy
Installing collected packages: astropy
  Attempting uninstall: astropy
    Found existing installation: astropy 5.1.dev761+g298ccb478e.d20241024
    Uninstalling astropy-5.1.dev761+g298ccb478e.d20241024:
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fits2bitmap
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitscheck
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsdiff
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsheader
      Removing file or directory /opt/miniconda3/envs/testbed/bin/fitsinfo
      Removing file or directory /opt/miniconda3/envs/testbed/bin/samp_hub
      Removing file or directory /opt/miniconda3/envs/testbed/bin/showtable
      Removing file or directory /opt/miniconda3/envs/testbed/bin/volint
      Removing file or directory /opt/miniconda3/envs/testbed/bin/wcslint
      Successfully uninstalled astropy-5.1.dev761+g298ccb478e.d20241024
  changing mode of /opt/miniconda3/envs/testbed/bin/fits2bitmap to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitscheck to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsdiff to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsheader to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/fitsinfo to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/samp_hub to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/showtable to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/volint to 755
  changing mode of /opt/miniconda3/envs/testbed/bin/wcslint to 755
Successfully installed astropy-5.1.dev761+g298ccb478.d20251003
[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.[0m[33m

2025-10-04 06:04:38,654 - thread-139911184823872.app.lang_graph.nodes.issue_bug_reproduction_context_message_node - DEBUG - Sending query to context provider subgraph:
Issue title:
TimeSeries: misleading exception when required column check fails.

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

2025-10-04 06:04:38,654 - thread-139911184823872.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Enter context retrieval subgraph
2025-10-04 06:04:38,655 - thread-139911184823872.app.lang_graph.nodes.context_query_message_node - DEBUG - Sending query to ContextProviderNode:
content='Issue title:\nTimeSeries: misleading exception when required column check fails.\n\nIssue description: \n<!-- This comments are hidden when you submit the issue,\nso you do not need to remove them! -->\n\n<!-- Please be sure to check out our contributing guidelines,\nhttps://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .\nPlease be sure to check out our code of conduct,\nhttps://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->\n\n<!-- Please have a search on our GitHub repository to see if a similar\nissue has already been posted.\nIf a similar issue is closed, have a quick look to see if you are satisfied\nby the resolution.\nIf not please go ahead and open an issue! -->\n\n<!-- Please check that the development version still produces the same bug.\nYou can install development version with\npip install git+https://github.com/astropy/astropy\ncommand. -->\n\n### Description\n<!-- Provide a general description of the bug. -->\n\nFor a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.\n\n### Expected behavior\n<!-- What did you expect to happen. -->\nAn exception that informs the users required columns are missing.\n\n### Actual behavior\nThe actual exception message is confusing:\n`ValueError: TimeSeries object is invalid - expected \'time\' as the first columns but found \'time\'`\n\n### Steps to Reproduce\n<!-- Ideally a code example could be provided so we can run it ourselves. -->\n<!-- If you are pasting code, use triple backticks (```) around\nyour code snippet. -->\n<!-- If necessary, sanitize your screen output to be pasted so you do not\nreveal secrets like tokens and passwords. -->\n\n```python\nfrom astropy.time import Time\nfrom astropy.timeseries import TimeSeries\n\ntime=Time(np.arange(100000, 100003), format=\'jd\')\nts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})\nts._required_columns = ["time", "flux"]                                   \nts.remove_column("flux")\n\n```\n\n### System Details\n<!-- Even if you do not think this is necessary, it is useful information for the maintainers.\nPlease run the following snippet and paste the output below:\nimport platform; print(platform.platform())\nimport sys; print("Python", sys.version)\nimport numpy; print("Numpy", numpy.__version__)\nimport erfa; print("pyerfa", erfa.__version__)\nimport astropy; print("astropy", astropy.__version__)\nimport scipy; print("Scipy", scipy.__version__)\nimport matplotlib; print("Matplotlib", matplotlib.__version__)\n-->\n```\nWindows-10-10.0.22000-SP0\nPython 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]\nNumpy 1.22.3\npyerfa 2.0.0.1\nastropy 5.0.3\nScipy 1.8.0\nMatplotlib 3.5.1\n```\n\nIssue comments:\n\n\nOBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,\nincluding ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.\n\n<reasoning>\n1. Analyze bug characteristics:\n   - Core functionality being tested\n   - Input parameters and configurations\n   - Expected error conditions\n   - Environmental dependencies\n\n2. Search requirements:\n   - Required imports and dependencies\n   - Test files exercising similar functionality\n   - Mock/fixture setup patterns\n   - Assertion styles\n   - Error handling tests\n\n3. Focus areas:\n   - All necessary imports (standard library, testing frameworks, mocking utilities)\n   - Dependencies and third-party packages\n   - Test setup and teardown\n   - Mock object configuration\n   - Network/external service simulation\n   - Error condition verification\n</reasoning>\n\nREQUIREMENTS:\n- Return 5 complete, self-contained test cases most similar to bug scenario\n- Must include ALL necessary imports at the start of each test file\n- Must include full test method implementation\n- Must include ALL mock/fixture setup\n- Must include helper functions used by test\n- Must preserve exact file paths and line numbers\n\n<examples>\n<example id="database-timeout">\n<bug>\ndb.execute("SELECT * FROM users").fetchall() \nraises ConnectionTimeout when load is high\n</bug>\n\n<ideal_test_match>\n# File: tests/test_database.py\nimport pytest\nfrom unittest.mock import Mock, patch\nfrom database.exceptions import ConnectionTimeout\nfrom database.models import QueryResult\nfrom database.client import DatabaseClient\n\nclass TestDatabaseTimeout:\n    @pytest.fixture\n    def mock_db_connection(self):\n        conn = Mock()\n        conn.execute.side_effect = [\n            ConnectionTimeout("Connection timed out"),\n            QueryResult(["user1", "user2"])  # Second try succeeds\n        ]\n        return conn\n        \n    def test_handle_timeout_during_query(self, mock_db_connection):\n        # Complete test showing timeout scenario\n        # Including retry logic verification\n        # With all necessary assertions\n</ideal_test_match>\n</example>\n\n<example id="file-permission">\n<bug>\nFileProcessor(\'/root/data.txt\').process() \nfails with PermissionError\n</bug>\n\n<ideal_test_match>\n# File: tests/test_file_processor.py\nimport os\nimport pytest\nfrom unittest.mock import patch, mock_open\nfrom file_processor import FileProcessor\nfrom file_processor.exceptions import ProcessingError\n\nclass TestFilePermissions:\n    @patch(\'os.access\')\n    @patch(\'builtins.open\')\n    def test_file_permission_denied(self, mock_open, mock_access):\n        # Full test setup with mocked file system\n        # Permission denial simulation\n        # Error handling verification\n</ideal_test_match>\n</example>\n\nSearch priority:\n1. Tests of exact same functionality (including import patterns)\n2. Tests with similar error conditions\n3. Tests with comparable mocking patterns\n4. Tests demonstrating similar assertions\n\nFind the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.\n' additional_kwargs={} response_metadata={}
2025-10-04 06:05:32,248 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 20967, 'total_token_count': 26406, 'prompt_tokens_details': [{'modality': 1, 'token_count': 20967}], 'thoughts_token_count': 5439, 'candidates_token_count': 0, 'cached_content_token_count': 0, 'cache_tokens_details': [], 'candidates_tokens_details': []}, 'finish_reason': 'STOP', 'model_name': 'gemini-2.5-pro'} id='run--3d1f9000-aa2f-490d-87da-799431b2d25a-0' usage_metadata={'input_tokens': 20967, 'output_tokens': 0, 'total_tokens': 26406, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 5439}}
2025-10-04 06:05:32,249 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 06:05:32,249 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - No context available from tool messages, returning existing context
2025-10-04 06:05:32,249 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 06:05:32,249 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
â”œâ”€â”€ .circleci
|   â””â”€â”€ config.yml
â”œâ”€â”€ .github
|   â”œâ”€â”€ ISSUE_TEMPLATE
|   |   â”œâ”€â”€ bug_report.md
|   |   â””â”€â”€ feature_request.md
|   â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md
|   â”œâ”€â”€ labeler.yml
|   â””â”€â”€ workflows
|       â”œâ”€â”€ cancel_workflows.yml
|       â”œâ”€â”€ check_changelog.yml
|       â”œâ”€â”€ ci_cron_daily.yml
|       â”œâ”€â”€ ci_cron_weekly.yml
|       â”œâ”€â”€ ci_workflows.yml
|       â”œâ”€â”€ codeql-analysis.yml
|       â”œâ”€â”€ open_actions.yml
|       â”œâ”€â”€ stalebot.yml
|       â””â”€â”€ update_iers.yml
â”œâ”€â”€ .pep8speaks.yml
â”œâ”€â”€ .pre-commit-config.yaml
â”œâ”€â”€ .pyinstaller
|   â”œâ”€â”€ hooks
|   |   â””â”€â”€ hook-skyfield.py
|   â””â”€â”€ run_astropy_tests.py
â”œâ”€â”€ .readthedocs.yml
â”œâ”€â”€ CHANGES.rst
â”œâ”€â”€ CODE_OF_CONDUCT.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ GOVERNANCE.md
â”œâ”€â”€ LICENSE.rst
â”œâ”€â”€ README.rst
â”œâ”€â”€ astropy
|   â”œâ”€â”€ __init__.py
|   â”œâ”€â”€ _dev
|   |   â”œâ”€â”€ __init__.py
|   |   â””â”€â”€ scm_version.py
|   â”œâ”€â”€ _erfa
|   |   â””â”€â”€ __init__.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ affiliated.py
|   |   â”œâ”€â”€ configuration.py
|   |   â”œâ”€â”€ paths.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â””â”€â”€ test_configs.py
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ astropyconst13.py
|   |   â”œâ”€â”€ astropyconst20.py
|   |   â”œâ”€â”€ astropyconst40.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ codata2010.py
|   |   â”œâ”€â”€ codata2014.py
|   |   â”œâ”€â”€ codata2018.py
|   |   â”œâ”€â”€ config.py
|   |   â”œâ”€â”€ constant.py
|   |   â”œâ”€â”€ iau2012.py
|   |   â”œâ”€â”€ iau2015.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_constant.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_prior_version.py
|   |   |   â””â”€â”€ test_sciencestate.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ convolve.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ kernels.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ convolve.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_convolve.py
|   |   |   â”œâ”€â”€ test_convolve_fft.py
|   |   |   â”œâ”€â”€ test_convolve_kernels.py
|   |   |   â”œâ”€â”€ test_convolve_models.py
|   |   |   â”œâ”€â”€ test_convolve_nddata.py
|   |   |   â”œâ”€â”€ test_convolve_speeds.py
|   |   |   â”œâ”€â”€ test_discretize.py
|   |   |   â”œâ”€â”€ test_kernel_class.py
|   |   |   â””â”€â”€ test_pickle.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ angle_formats.py
|   |   â”œâ”€â”€ angle_lextab.py
|   |   â”œâ”€â”€ angle_parsetab.py
|   |   â”œâ”€â”€ angle_utilities.py
|   |   â”œâ”€â”€ angles.py
|   |   â”œâ”€â”€ attributes.py
|   |   â”œâ”€â”€ baseframe.py
|   |   â”œâ”€â”€ builtin_frames
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ altaz.py
|   |   |   â”œâ”€â”€ baseradec.py
|   |   |   â”œâ”€â”€ cirs.py
|   |   |   â”œâ”€â”€ cirs_observed_transforms.py
|   |   |   â”œâ”€â”€ ecliptic.py
|   |   |   â”œâ”€â”€ ecliptic_transforms.py
|   |   |   â”œâ”€â”€ equatorial.py
|   |   |   â”œâ”€â”€ fk4.py
|   |   |   â”œâ”€â”€ fk4_fk5_transforms.py
|   |   |   â”œâ”€â”€ fk5.py
|   |   |   â”œâ”€â”€ galactic.py
|   |   |   â”œâ”€â”€ galactic_transforms.py
|   |   |   â”œâ”€â”€ galactocentric.py
|   |   |   â”œâ”€â”€ gcrs.py
|   |   |   â”œâ”€â”€ hadec.py
|   |   |   â”œâ”€â”€ hcrs.py
|   |   |   â”œâ”€â”€ icrs.py
|   |   |   â”œâ”€â”€ icrs_cirs_transforms.py
|   |   |   â”œâ”€â”€ icrs_fk5_transforms.py
|   |   |   â”œâ”€â”€ icrs_observed_transforms.py
|   |   |   â”œâ”€â”€ intermediate_rotation_transforms.py
|   |   |   â”œâ”€â”€ itrs.py
|   |   |   â”œâ”€â”€ lsr.py
|   |   |   â”œâ”€â”€ skyoffset.py
|   |   |   â”œâ”€â”€ supergalactic.py
|   |   |   â”œâ”€â”€ supergalactic_transforms.py
|   |   |   â””â”€â”€ utils.py
|   |   â”œâ”€â”€ calculation.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ distances.py
|   |   â”œâ”€â”€ earth.py
|   |   â”œâ”€â”€ earth_orientation.py
|   |   â”œâ”€â”€ erfa_astrom.py
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ jparser.py
|   |   â”œâ”€â”€ matching.py
|   |   â”œâ”€â”€ matrix_utilities.py
|   |   â”œâ”€â”€ name_resolve.py
|   |   â”œâ”€â”€ orbital_elements.py
|   |   â”œâ”€â”€ representation.py
|   |   â”œâ”€â”€ sites.py
|   |   â”œâ”€â”€ sky_coordinate.py
|   |   â”œâ”€â”€ sky_coordinate_parsers.py
|   |   â”œâ”€â”€ solar_system.py
|   |   â”œâ”€â”€ spectral_coordinate.py
|   |   â”œâ”€â”€ spectral_quantity.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ accuracy
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ generate_ref_ast.py
|   |   |   |   â”œâ”€â”€ generate_spectralcoord_ref.py
|   |   |   |   â”œâ”€â”€ test_altaz_icrs.py
|   |   |   |   â”œâ”€â”€ test_ecliptic.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk4.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk5.py
|   |   |   |   â”œâ”€â”€ test_galactic_fk4.py
|   |   |   |   â””â”€â”€ test_icrs_fk5.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_angle_generators.py
|   |   |   â”œâ”€â”€ test_angles.py
|   |   |   â”œâ”€â”€ test_angular_separation.py
|   |   |   â”œâ”€â”€ test_api_ape5.py
|   |   |   â”œâ”€â”€ test_arrays.py
|   |   |   â”œâ”€â”€ test_atc_replacements.py
|   |   |   â”œâ”€â”€ test_celestial_transformations.py
|   |   |   â”œâ”€â”€ test_distance.py
|   |   |   â”œâ”€â”€ test_earth.py
|   |   |   â”œâ”€â”€ test_erfa_astrom.py
|   |   |   â”œâ”€â”€ test_finite_difference_velocities.py
|   |   |   â”œâ”€â”€ test_formatting.py
|   |   |   â”œâ”€â”€ test_frames.py
|   |   |   â”œâ”€â”€ test_frames_with_velocity.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_geodetic_representations.py
|   |   |   â”œâ”€â”€ test_iau_fullstack.py
|   |   |   â”œâ”€â”€ test_icrs_observed_transformations.py
|   |   |   â”œâ”€â”€ test_intermediate_transformations.py
|   |   |   â”œâ”€â”€ test_matching.py
|   |   |   â”œâ”€â”€ test_matrix_utilities.py
|   |   |   â”œâ”€â”€ test_name_resolve.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_regression.py
|   |   |   â”œâ”€â”€ test_representation.py
|   |   |   â”œâ”€â”€ test_representation_arithmetic.py
|   |   |   â”œâ”€â”€ test_representation_methods.py
|   |   |   â”œâ”€â”€ test_shape_manipulation.py
|   |   |   â”œâ”€â”€ test_sites.py
|   |   |   â”œâ”€â”€ test_sky_coord.py
|   |   |   â”œâ”€â”€ test_sky_coord_velocities.py
|   |   |   â”œâ”€â”€ test_skyoffset_transformations.py
|   |   |   â”œâ”€â”€ test_solar_system.py
|   |   |   â”œâ”€â”€ test_spectral_coordinate.py
|   |   |   â”œâ”€â”€ test_spectral_quantity.py
|   |   |   â”œâ”€â”€ test_transformations.py
|   |   |   â”œâ”€â”€ test_unit_representation.py
|   |   |   â”œâ”€â”€ test_utils.py
|   |   |   â””â”€â”€ test_velocity_corrs.py
|   |   â””â”€â”€ transformations.py
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ flrw
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ lambdacdm.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ test_base.py
|   |   |   |   â”œâ”€â”€ test_lambdacdm.py
|   |   |   |   â”œâ”€â”€ test_w0cdm.py
|   |   |   |   â”œâ”€â”€ test_w0wacdm.py
|   |   |   |   â”œâ”€â”€ test_w0wzcdm.py
|   |   |   |   â””â”€â”€ test_wpwazpcdm.py
|   |   |   â”œâ”€â”€ w0cdm.py
|   |   |   â”œâ”€â”€ w0wacdm.py
|   |   |   â”œâ”€â”€ w0wzcdm.py
|   |   |   â””â”€â”€ wpwazpcdm.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ cosmology.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ mapping.py
|   |   |   â”œâ”€â”€ model.py
|   |   |   â”œâ”€â”€ row.py
|   |   |   â”œâ”€â”€ table.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_json.py
|   |   |   |   â”œâ”€â”€ test_mapping.py
|   |   |   |   â”œâ”€â”€ test_model.py
|   |   |   |   â”œâ”€â”€ test_row.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ parameter.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ realizations.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ conftest.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_connect.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_parameter.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_realizations.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _strptime.py
|   |   â”œâ”€â”€ configobj
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ configobj.py
|   |   |   â””â”€â”€ validate.py
|   |   â”œâ”€â”€ jquery
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ data
|   |   |       â”œâ”€â”€ css
|   |   |       â”œâ”€â”€ images
|   |   |       â””â”€â”€ js
|   |   â””â”€â”€ ply
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ cpp.py
|   |       â”œâ”€â”€ ctokens.py
|   |       â”œâ”€â”€ lex.py
|   |       â”œâ”€â”€ yacc.py
|   |       â””â”€â”€ ygen.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ basic.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ daophot.py
|   |   |   â”œâ”€â”€ docs.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ fastbasic.py
|   |   |   â”œâ”€â”€ fixedwidth.py
|   |   |   â”œâ”€â”€ html.py
|   |   |   â”œâ”€â”€ ipac.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ mrt.py
|   |   |   â”œâ”€â”€ qdp.py
|   |   |   â”œâ”€â”€ rst.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ sextractor.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ common.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_c_reader.py
|   |   |   |   â”œâ”€â”€ test_cds.py
|   |   |   |   â”œâ”€â”€ test_cds_header_from_readme.py
|   |   |   |   â”œâ”€â”€ test_compressed.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_fixedwidth.py
|   |   |   |   â”œâ”€â”€ test_html.py
|   |   |   |   â”œâ”€â”€ test_ipac_definitions.py
|   |   |   |   â”œâ”€â”€ test_qdp.py
|   |   |   |   â”œâ”€â”€ test_read.py
|   |   |   |   â”œâ”€â”€ test_rst.py
|   |   |   |   â”œâ”€â”€ test_types.py
|   |   |   |   â””â”€â”€ test_write.py
|   |   |   â””â”€â”€ ui.py
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ card.py
|   |   |   â”œâ”€â”€ column.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ convenience.py
|   |   |   â”œâ”€â”€ diff.py
|   |   |   â”œâ”€â”€ file.py
|   |   |   â”œâ”€â”€ fitsrec.py
|   |   |   â”œâ”€â”€ fitstime.py
|   |   |   â”œâ”€â”€ hdu
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ compressed.py
|   |   |   |   â”œâ”€â”€ groups.py
|   |   |   |   â”œâ”€â”€ hdulist.py
|   |   |   |   â”œâ”€â”€ image.py
|   |   |   |   â”œâ”€â”€ nonstandard.py
|   |   |   |   â”œâ”€â”€ streaming.py
|   |   |   |   â””â”€â”€ table.py
|   |   |   â”œâ”€â”€ header.py
|   |   |   â”œâ”€â”€ scripts
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ fitscheck.py
|   |   |   |   â”œâ”€â”€ fitsdiff.py
|   |   |   |   â”œâ”€â”€ fitsheader.py
|   |   |   |   â””â”€â”€ fitsinfo.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_checksum.py
|   |   |   |   â”œâ”€â”€ test_compression_failures.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_convenience.py
|   |   |   |   â”œâ”€â”€ test_core.py
|   |   |   |   â”œâ”€â”€ test_diff.py
|   |   |   |   â”œâ”€â”€ test_division.py
|   |   |   |   â”œâ”€â”€ test_fitscheck.py
|   |   |   |   â”œâ”€â”€ test_fitsdiff.py
|   |   |   |   â”œâ”€â”€ test_fitsheader.py
|   |   |   |   â”œâ”€â”€ test_fitsinfo.py
|   |   |   |   â”œâ”€â”€ test_fitstime.py
|   |   |   |   â”œâ”€â”€ test_groups.py
|   |   |   |   â”œâ”€â”€ test_hdulist.py
|   |   |   |   â”œâ”€â”€ test_header.py
|   |   |   |   â”œâ”€â”€ test_image.py
|   |   |   |   â”œâ”€â”€ test_image_dask.py
|   |   |   |   â”œâ”€â”€ test_nonstandard.py
|   |   |   |   â”œâ”€â”€ test_structured.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â”œâ”€â”€ test_uint.py
|   |   |   |   â””â”€â”€ test_util.py
|   |   |   â”œâ”€â”€ util.py
|   |   |   â””â”€â”€ verify.py
|   |   â”œâ”€â”€ misc
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ asdf
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ connect.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ deprecation.py
|   |   |   |   â”œâ”€â”€ extension.py
|   |   |   |   â”œâ”€â”€ tags
|   |   |   |   â”œâ”€â”€ tests
|   |   |   |   â””â”€â”€ types.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ hdf5.py
|   |   |   â”œâ”€â”€ pandas
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ connect.py
|   |   |   â”œâ”€â”€ parquet.py
|   |   |   â”œâ”€â”€ pickle_helpers.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_hdf5.py
|   |   |   |   â”œâ”€â”€ test_pandas.py
|   |   |   |   â”œâ”€â”€ test_parquet.py
|   |   |   |   â”œâ”€â”€ test_pickle_helpers.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ registry
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ compat.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ interface.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_registries.py
|   |   |       â””â”€â”€ test_registry_help.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ mixin_columns.py
|   |   |   â””â”€â”€ safeio.py
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ connect.py
|   |       â”œâ”€â”€ converters.py
|   |       â”œâ”€â”€ data
|   |       |   â””â”€â”€ ucd1p-words.txt
|   |       â”œâ”€â”€ exceptions.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ tablewriter.c
|   |       â”œâ”€â”€ table.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ converter_test.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ exception_test.py
|   |       |   â”œâ”€â”€ resource_test.py
|   |       |   â”œâ”€â”€ table_test.py
|   |       |   â”œâ”€â”€ tree_test.py
|   |       |   â”œâ”€â”€ ucd_test.py
|   |       |   â”œâ”€â”€ util_test.py
|   |       |   â””â”€â”€ vo_test.py
|   |       â”œâ”€â”€ tree.py
|   |       â”œâ”€â”€ ucd.py
|   |       â”œâ”€â”€ util.py
|   |       â”œâ”€â”€ validator
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ html.py
|   |       |   â”œâ”€â”€ main.py
|   |       |   â””â”€â”€ result.py
|   |       â”œâ”€â”€ volint.py
|   |       â””â”€â”€ xmlutil.py
|   â”œâ”€â”€ logger.py
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bounding_box.py
|   |   â”œâ”€â”€ convolution.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ fitting.py
|   |   â”œâ”€â”€ functional_models.py
|   |   â”œâ”€â”€ mappings.py
|   |   â”œâ”€â”€ math_functions.py
|   |   â”œâ”€â”€ models.py
|   |   â”œâ”€â”€ optimizers.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ physical_models.py
|   |   â”œâ”€â”€ polynomial.py
|   |   â”œâ”€â”€ powerlaws.py
|   |   â”œâ”€â”€ projections.py
|   |   â”œâ”€â”€ rotations.py
|   |   â”œâ”€â”€ separable.py
|   |   â”œâ”€â”€ spline.py
|   |   â”œâ”€â”€ statistic.py
|   |   â”œâ”€â”€ tabular.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ spec.txt
|   |   |   â”œâ”€â”€ example_models.py
|   |   |   â”œâ”€â”€ irafutil.py
|   |   |   â”œâ”€â”€ test_bounding_box.py
|   |   |   â”œâ”€â”€ test_compound.py
|   |   |   â”œâ”€â”€ test_constraints.py
|   |   |   â”œâ”€â”€ test_convolution.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_fitters.py
|   |   |   â”œâ”€â”€ test_functional_models.py
|   |   |   â”œâ”€â”€ test_input.py
|   |   |   â”œâ”€â”€ test_mappings.py
|   |   |   â”œâ”€â”€ test_math_func.py
|   |   |   â”œâ”€â”€ test_model_sets.py
|   |   |   â”œâ”€â”€ test_models.py
|   |   |   â”œâ”€â”€ test_models_quantities.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_physical_models.py
|   |   |   â”œâ”€â”€ test_polynomial.py
|   |   |   â”œâ”€â”€ test_projections.py
|   |   |   â”œâ”€â”€ test_quantities_evaluation.py
|   |   |   â”œâ”€â”€ test_quantities_fitting.py
|   |   |   â”œâ”€â”€ test_quantities_model.py
|   |   |   â”œâ”€â”€ test_quantities_parameters.py
|   |   |   â”œâ”€â”€ test_quantities_rotations.py
|   |   |   â”œâ”€â”€ test_rotations.py
|   |   |   â”œâ”€â”€ test_separable.py
|   |   |   â”œâ”€â”€ test_spline.py
|   |   |   â”œâ”€â”€ test_statistics.py
|   |   |   â”œâ”€â”€ test_units_mapping.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _testing.py
|   |   â”œâ”€â”€ bitmask.py
|   |   â”œâ”€â”€ blocks.py
|   |   â”œâ”€â”€ ccddata.py
|   |   â”œâ”€â”€ compat.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ flag_collection.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ ndarithmetic.py
|   |   |   â”œâ”€â”€ ndio.py
|   |   |   â”œâ”€â”€ ndslicing.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_ndarithmetic.py
|   |   |       â”œâ”€â”€ test_ndio.py
|   |   |       â””â”€â”€ test_ndslicing.py
|   |   â”œâ”€â”€ nddata.py
|   |   â”œâ”€â”€ nddata_base.py
|   |   â”œâ”€â”€ nddata_withmixins.py
|   |   â”œâ”€â”€ nduncertainty.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   â”œâ”€â”€ test_bitmask.py
|   |   |   â”œâ”€â”€ test_blocks.py
|   |   |   â”œâ”€â”€ test_ccddata.py
|   |   |   â”œâ”€â”€ test_compat.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_flag_collection.py
|   |   |   â”œâ”€â”€ test_nddata.py
|   |   |   â”œâ”€â”€ test_nddata_base.py
|   |   |   â”œâ”€â”€ test_nduncertainty.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ client.py
|   |   â”œâ”€â”€ constants.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ hub.py
|   |   â”œâ”€â”€ hub_proxy.py
|   |   â”œâ”€â”€ hub_script.py
|   |   â”œâ”€â”€ integrated_client.py
|   |   â”œâ”€â”€ lockfile_helpers.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ standard_profile.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_client.py
|   |   |   â”œâ”€â”€ test_errors.py
|   |   |   â”œâ”€â”€ test_helpers.py
|   |   |   â”œâ”€â”€ test_hub.py
|   |   |   â”œâ”€â”€ test_hub_proxy.py
|   |   |   â”œâ”€â”€ test_hub_script.py
|   |   |   â”œâ”€â”€ test_standard_profile.py
|   |   |   â”œâ”€â”€ test_web_profile.py
|   |   |   â””â”€â”€ web_profile_test_helpers.py
|   |   â”œâ”€â”€ utils.py
|   |   â””â”€â”€ web_profile.py
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bayesian_blocks.py
|   |   â”œâ”€â”€ biweight.py
|   |   â”œâ”€â”€ bls
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ circstats.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ histogram.py
|   |   â”œâ”€â”€ info_theory.py
|   |   â”œâ”€â”€ jackknife.py
|   |   â”œâ”€â”€ lombscargle
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ sigma_clipping.py
|   |   â”œâ”€â”€ spatial.py
|   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ compute_bounds.c
|   |   |   â”œâ”€â”€ fast_sigma_clip.c
|   |   |   â””â”€â”€ wirth_select.c
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_bayesian_blocks.py
|   |       â”œâ”€â”€ test_biweight.py
|   |       â”œâ”€â”€ test_circstats.py
|   |       â”œâ”€â”€ test_funcs.py
|   |       â”œâ”€â”€ test_histogram.py
|   |       â”œâ”€â”€ test_info_theory.py
|   |       â”œâ”€â”€ test_jackknife.py
|   |       â”œâ”€â”€ test_sigma_clipping.py
|   |       â””â”€â”€ test_spatial.py
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bst.py
|   |   â”œâ”€â”€ column.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ groups.py
|   |   â”œâ”€â”€ index.py
|   |   â”œâ”€â”€ info.py
|   |   â”œâ”€â”€ jsviewer.py
|   |   â”œâ”€â”€ meta.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ dask.py
|   |   |   â”œâ”€â”€ registry.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_dask.py
|   |   |       â””â”€â”€ test_registry.py
|   |   â”œâ”€â”€ ndarray_mixin.py
|   |   â”œâ”€â”€ np_utils.py
|   |   â”œâ”€â”€ operations.py
|   |   â”œâ”€â”€ pandas.py
|   |   â”œâ”€â”€ pprint.py
|   |   â”œâ”€â”€ row.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ showtable.py
|   |   â”œâ”€â”€ serialize.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ soco.py
|   |   â”œâ”€â”€ sorted_array.py
|   |   â”œâ”€â”€ table.py
|   |   â”œâ”€â”€ table_helpers.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ conftest.py
|   |       â”œâ”€â”€ test_array.py
|   |       â”œâ”€â”€ test_bst.py
|   |       â”œâ”€â”€ test_column.py
|   |       â”œâ”€â”€ test_groups.py
|   |       â”œâ”€â”€ test_index.py
|   |       â”œâ”€â”€ test_info.py
|   |       â”œâ”€â”€ test_init_table.py
|   |       â”œâ”€â”€ test_item_access.py
|   |       â”œâ”€â”€ test_jsviewer.py
|   |       â”œâ”€â”€ test_masked.py
|   |       â”œâ”€â”€ test_mixin.py
|   |       â”œâ”€â”€ test_np_utils.py
|   |       â”œâ”€â”€ test_operations.py
|   |       â”œâ”€â”€ test_pickle.py
|   |       â”œâ”€â”€ test_pprint.py
|   |       â”œâ”€â”€ test_row.py
|   |       â”œâ”€â”€ test_showtable.py
|   |       â”œâ”€â”€ test_subclass.py
|   |       â””â”€â”€ test_table.py
|   â”œâ”€â”€ tests
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ command.py
|   |   â”œâ”€â”€ helper.py
|   |   â”œâ”€â”€ image_tests.py
|   |   â”œâ”€â”€ runner.py
|   |   â”œâ”€â”€ test_logger.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_imports.py
|   |       â”œâ”€â”€ test_quantity_helpers.py
|   |       â”œâ”€â”€ test_run_tests.py
|   |       â””â”€â”€ test_runner.py
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ formats.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ parse_times.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_basic.py
|   |   |   â”œâ”€â”€ test_comparisons.py
|   |   |   â”œâ”€â”€ test_corrs.py
|   |   |   â”œâ”€â”€ test_custom_formats.py
|   |   |   â”œâ”€â”€ test_delta.py
|   |   |   â”œâ”€â”€ test_fast_parser.py
|   |   |   â”œâ”€â”€ test_functions.py
|   |   |   â”œâ”€â”€ test_guess.py
|   |   |   â”œâ”€â”€ test_mask.py
|   |   |   â”œâ”€â”€ test_methods.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_precision.py
|   |   |   â”œâ”€â”€ test_quantity_interaction.py
|   |   |   â”œâ”€â”€ test_sidereal.py
|   |   |   â”œâ”€â”€ test_update_leap_seconds.py
|   |   |   â””â”€â”€ test_ut1.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ binned.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ downsample.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ kepler.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_kepler.py
|   |   â”œâ”€â”€ periodograms
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ bls
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ core.py
|   |   |   |   â”œâ”€â”€ methods.py
|   |   |   |   â”œâ”€â”€ setup_package.py
|   |   |   |   â””â”€â”€ tests
|   |   |   â””â”€â”€ lombscargle
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ _statistics.py
|   |   |       â”œâ”€â”€ core.py
|   |   |       â”œâ”€â”€ implementations
|   |   |       â”œâ”€â”€ tests
|   |   |       â””â”€â”€ utils.py
|   |   â”œâ”€â”€ sampled.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â”œâ”€â”€ test_binned.py
|   |       â”œâ”€â”€ test_common.py
|   |       â”œâ”€â”€ test_downsample.py
|   |       â””â”€â”€ test_sampled.py
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ distributions.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â””â”€â”€ test_distribution.py
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _typing.py
|   |   â”œâ”€â”€ astrophys.py
|   |   â”œâ”€â”€ cds.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ deprecated.py
|   |   â”œâ”€â”€ equivalencies.py
|   |   â”œâ”€â”€ format
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ cds_lextab.py
|   |   |   â”œâ”€â”€ cds_parsetab.py
|   |   |   â”œâ”€â”€ console.py
|   |   |   â”œâ”€â”€ fits.py
|   |   |   â”œâ”€â”€ generic.py
|   |   |   â”œâ”€â”€ generic_lextab.py
|   |   |   â”œâ”€â”€ generic_parsetab.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ ogip.py
|   |   |   â”œâ”€â”€ ogip_lextab.py
|   |   |   â”œâ”€â”€ ogip_parsetab.py
|   |   |   â”œâ”€â”€ unicode_format.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ vounit.py
|   |   â”œâ”€â”€ function
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ logarithmic.py
|   |   |   â”œâ”€â”€ mixin.py
|   |   |   â””â”€â”€ units.py
|   |   â”œâ”€â”€ imperial.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ photometric.py
|   |   â”œâ”€â”€ physical.py
|   |   â”œâ”€â”€ quantity.py
|   |   â”œâ”€â”€ quantity_helper
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ converters.py
|   |   |   â”œâ”€â”€ erfa.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â”œâ”€â”€ helpers.py
|   |   |   â””â”€â”€ scipy_special.py
|   |   â”œâ”€â”€ required_by_vounit.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ structured.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_aliases.py
|   |   |   â”œâ”€â”€ test_deprecated.py
|   |   |   â”œâ”€â”€ test_equivalencies.py
|   |   |   â”œâ”€â”€ test_format.py
|   |   |   â”œâ”€â”€ test_logarithmic.py
|   |   |   â”œâ”€â”€ test_photometric.py
|   |   |   â”œâ”€â”€ test_physical.py
|   |   |   â”œâ”€â”€ test_quantity.py
|   |   |   â”œâ”€â”€ test_quantity_annotations.py
|   |   |   â”œâ”€â”€ test_quantity_array_methods.py
|   |   |   â”œâ”€â”€ test_quantity_decorator.py
|   |   |   â”œâ”€â”€ test_quantity_helpers.py
|   |   |   â”œâ”€â”€ test_quantity_non_ufuncs.py
|   |   |   â”œâ”€â”€ test_quantity_typing.py
|   |   |   â”œâ”€â”€ test_quantity_ufuncs.py
|   |   |   â”œâ”€â”€ test_structured.py
|   |   |   â”œâ”€â”€ test_structured_erfa_ufuncs.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ argparse.py
|   |   â”œâ”€â”€ codegen.py
|   |   â”œâ”€â”€ collections.py
|   |   â”œâ”€â”€ compat
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ numpycompat.py
|   |   |   â””â”€â”€ optional_deps.py
|   |   â”œâ”€â”€ console.py
|   |   â”œâ”€â”€ data.py
|   |   â”œâ”€â”€ data_info.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ diff.py
|   |   â”œâ”€â”€ exceptions.py
|   |   â”œâ”€â”€ iers
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â””â”€â”€ update_builtin_iers.sh
|   |   |   â”œâ”€â”€ iers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ data
|   |   |       â”œâ”€â”€ test_iers.py
|   |   |       â””â”€â”€ test_leap_second.py
|   |   â”œâ”€â”€ introspection.py
|   |   â”œâ”€â”€ masked
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_containers.py
|   |   |       â”œâ”€â”€ test_function_helpers.py
|   |   |       â”œâ”€â”€ test_functions.py
|   |   |       â”œâ”€â”€ test_masked.py
|   |   |       â””â”€â”€ test_table.py
|   |   â”œâ”€â”€ metadata.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ parsing.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ shapes.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ compiler.c
|   |   â”œâ”€â”€ state.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ .hidden_file.txt
|   |   |   |   â”œâ”€â”€ dataurl
|   |   |   |   â”œâ”€â”€ dataurl_mirror
|   |   |   |   â”œâ”€â”€ test_package
|   |   |   |   â””â”€â”€ unicode.txt
|   |   |   â”œâ”€â”€ test_codegen.py
|   |   |   â”œâ”€â”€ test_collections.py
|   |   |   â”œâ”€â”€ test_console.py
|   |   |   â”œâ”€â”€ test_data.py
|   |   |   â”œâ”€â”€ test_data_info.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_diff.py
|   |   |   â”œâ”€â”€ test_introspection.py
|   |   |   â”œâ”€â”€ test_metadata.py
|   |   |   â”œâ”€â”€ test_misc.py
|   |   |   â”œâ”€â”€ test_parsing.py
|   |   |   â”œâ”€â”€ test_progress_bar_func.py
|   |   |   â”œâ”€â”€ test_shapes.py
|   |   |   â”œâ”€â”€ test_state.py
|   |   |   â””â”€â”€ test_xml.py
|   |   â””â”€â”€ xml
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ check.py
|   |       â”œâ”€â”€ iterparser.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ iterparse.c
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â””â”€â”€ test_iterparse.py
|   |       â”œâ”€â”€ unescaper.py
|   |       â”œâ”€â”€ validate.py
|   |       â””â”€â”€ writer.py
|   â”œâ”€â”€ version.py
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ hist.py
|   |   â”œâ”€â”€ interval.py
|   |   â”œâ”€â”€ lupton_rgb.py
|   |   â”œâ”€â”€ mpl_normalize.py
|   |   â”œâ”€â”€ mpl_style.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ fits2bitmap.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_fits2bitmap.py
|   |   â”œâ”€â”€ stretch.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_histogram.py
|   |   |   â”œâ”€â”€ test_interval.py
|   |   |   â”œâ”€â”€ test_lupton_rgb.py
|   |   |   â”œâ”€â”€ test_norm.py
|   |   |   â”œâ”€â”€ test_stretch.py
|   |   |   â”œâ”€â”€ test_time.py
|   |   |   â””â”€â”€ test_units.py
|   |   â”œâ”€â”€ time.py
|   |   â”œâ”€â”€ transform.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ axislabels.py
|   |       â”œâ”€â”€ coordinate_helpers.py
|   |       â”œâ”€â”€ coordinate_range.py
|   |       â”œâ”€â”€ coordinates_map.py
|   |       â”œâ”€â”€ core.py
|   |       â”œâ”€â”€ formatter_locator.py
|   |       â”œâ”€â”€ frame.py
|   |       â”œâ”€â”€ grid_paths.py
|   |       â”œâ”€â”€ patches.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ test_coordinate_helpers.py
|   |       |   â”œâ”€â”€ test_display_world_coordinates.py
|   |       |   â”œâ”€â”€ test_formatter_locator.py
|   |       |   â”œâ”€â”€ test_frame.py
|   |       |   â”œâ”€â”€ test_grid_paths.py
|   |       |   â”œâ”€â”€ test_images.py
|   |       |   â”œâ”€â”€ test_misc.py
|   |       |   â”œâ”€â”€ test_transform_coord_meta.py
|   |       |   â”œâ”€â”€ test_transforms.py
|   |       |   â”œâ”€â”€ test_utils.py
|   |       |   â””â”€â”€ test_wcsapi.py
|   |       â”œâ”€â”€ ticklabels.py
|   |       â”œâ”€â”€ ticks.py
|   |       â”œâ”€â”€ transforms.py
|   |       â”œâ”€â”€ utils.py
|   |       â””â”€â”€ wcsapi.py
|   â””â”€â”€ wcs
|       â”œâ”€â”€ __init__.py
|       â”œâ”€â”€ docstrings.py
|       â”œâ”€â”€ include
|       |   â”œâ”€â”€ astropy_wcs
|       |   â””â”€â”€ wcslib
|       â”œâ”€â”€ setup_package.py
|       â”œâ”€â”€ src
|       |   â”œâ”€â”€ astropy_wcs.c
|       |   â”œâ”€â”€ astropy_wcs_api.c
|       |   â”œâ”€â”€ distortion.c
|       |   â”œâ”€â”€ distortion_wrap.c
|       |   â”œâ”€â”€ pipeline.c
|       |   â”œâ”€â”€ pyutil.c
|       |   â”œâ”€â”€ sip.c
|       |   â”œâ”€â”€ sip_wrap.c
|       |   â”œâ”€â”€ str_list_proxy.c
|       |   â”œâ”€â”€ unit_list_proxy.c
|       |   â”œâ”€â”€ util.c
|       |   â”œâ”€â”€ wcslib_auxprm_wrap.c
|       |   â”œâ”€â”€ wcslib_celprm_wrap.c
|       |   â”œâ”€â”€ wcslib_prjprm_wrap.c
|       |   â”œâ”€â”€ wcslib_tabprm_wrap.c
|       |   â”œâ”€â”€ wcslib_wrap.c
|       |   â””â”€â”€ wcslib_wtbarr_wrap.c
|       â”œâ”€â”€ tests
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â”œâ”€â”€ maps
|       |   |   â”œâ”€â”€ spectra
|       |   |   â”œâ”€â”€ validate.5.0.txt
|       |   |   â”œâ”€â”€ validate.5.13.txt
|       |   |   â”œâ”€â”€ validate.6.txt
|       |   |   â”œâ”€â”€ validate.7.4.txt
|       |   |   â”œâ”€â”€ validate.7.6.txt
|       |   |   â””â”€â”€ validate.txt
|       |   â”œâ”€â”€ helper.py
|       |   â”œâ”€â”€ test_auxprm.py
|       |   â”œâ”€â”€ test_celprm.py
|       |   â”œâ”€â”€ test_pickle.py
|       |   â”œâ”€â”€ test_prjprm.py
|       |   â”œâ”€â”€ test_profiling.py
|       |   â”œâ”€â”€ test_tab.py
|       |   â”œâ”€â”€ test_tabprm.py
|       |   â”œâ”€â”€ test_utils.py
|       |   â”œâ”€â”€ test_wcs.py
|       |   â”œâ”€â”€ test_wcsprm.py
|       |   â””â”€â”€ test_wtbarr.py
|       â”œâ”€â”€ utils.py
|       â”œâ”€â”€ wcs.py
|       â”œâ”€â”€ wcsapi
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â””â”€â”€ ucds.txt
|       |   â”œâ”€â”€ fitswcs.py
|       |   â”œâ”€â”€ high_level_api.py
|       |   â”œâ”€â”€ high_level_wcs_wrapper.py
|       |   â”œâ”€â”€ low_level_api.py
|       |   â”œâ”€â”€ sliced_low_level_wcs.py
|       |   â”œâ”€â”€ tests
|       |   |   â”œâ”€â”€ __init__.py
|       |   |   â”œâ”€â”€ test_fitswcs.py
|       |   |   â”œâ”€â”€ test_high_level_api.py
|       |   |   â”œâ”€â”€ test_high_level_wcs_wrapper.py
|       |   |   â”œâ”€â”€ test_low_level_api.py
|       |   |   â””â”€â”€ test_utils.py
|       |   â”œâ”€â”€ utils.py
|       |   â””â”€â”€ wrappers
|       |       â”œâ”€â”€ __init__.py
|       |       â”œâ”€â”€ base.py
|       |       â”œâ”€â”€ sliced_wcs.py
|       |       â””â”€â”€ tests
|       â””â”€â”€ wcslint.py
â”œâ”€â”€ azure-pipelines.yml
â”œâ”€â”€ cextern
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ cfitsio
|   |   â”œâ”€â”€ License.txt
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ docs
|   |   |   â””â”€â”€ changes.txt
|   |   â”œâ”€â”€ lib
|   |   |   â”œâ”€â”€ buffers.c
|   |   |   â”œâ”€â”€ cfileio.c
|   |   |   â”œâ”€â”€ checksum.c
|   |   |   â”œâ”€â”€ drvrfile.c
|   |   |   â”œâ”€â”€ drvrmem.c
|   |   |   â”œâ”€â”€ drvrnet.c
|   |   |   â”œâ”€â”€ drvrsmem.c
|   |   |   â”œâ”€â”€ editcol.c
|   |   |   â”œâ”€â”€ edithdu.c
|   |   |   â”œâ”€â”€ eval_f.c
|   |   |   â”œâ”€â”€ eval_l.c
|   |   |   â”œâ”€â”€ eval_y.c
|   |   |   â”œâ”€â”€ fits_hcompress.c
|   |   |   â”œâ”€â”€ fits_hdecompress.c
|   |   |   â”œâ”€â”€ fitscore.c
|   |   |   â”œâ”€â”€ getcol.c
|   |   |   â”œâ”€â”€ getcolb.c
|   |   |   â”œâ”€â”€ getcold.c
|   |   |   â”œâ”€â”€ getcole.c
|   |   |   â”œâ”€â”€ getcoli.c
|   |   |   â”œâ”€â”€ getcolj.c
|   |   |   â”œâ”€â”€ getcolk.c
|   |   |   â”œâ”€â”€ getcoll.c
|   |   |   â”œâ”€â”€ getcols.c
|   |   |   â”œâ”€â”€ getcolsb.c
|   |   |   â”œâ”€â”€ getcolui.c
|   |   |   â”œâ”€â”€ getcoluj.c
|   |   |   â”œâ”€â”€ getcoluk.c
|   |   |   â”œâ”€â”€ getkey.c
|   |   |   â”œâ”€â”€ group.c
|   |   |   â”œâ”€â”€ grparser.c
|   |   |   â”œâ”€â”€ histo.c
|   |   |   â”œâ”€â”€ imcompress.c
|   |   |   â”œâ”€â”€ iraffits.c
|   |   |   â”œâ”€â”€ modkey.c
|   |   |   â”œâ”€â”€ pliocomp.c
|   |   |   â”œâ”€â”€ putcol.c
|   |   |   â”œâ”€â”€ putcolb.c
|   |   |   â”œâ”€â”€ putcold.c
|   |   |   â”œâ”€â”€ putcole.c
|   |   |   â”œâ”€â”€ putcoli.c
|   |   |   â”œâ”€â”€ putcolj.c
|   |   |   â”œâ”€â”€ putcolk.c
|   |   |   â”œâ”€â”€ putcoll.c
|   |   |   â”œâ”€â”€ putcols.c
|   |   |   â”œâ”€â”€ putcolsb.c
|   |   |   â”œâ”€â”€ putcolu.c
|   |   |   â”œâ”€â”€ putcolui.c
|   |   |   â”œâ”€â”€ putcoluj.c
|   |   |   â”œâ”€â”€ putcoluk.c
|   |   |   â”œâ”€â”€ putkey.c
|   |   |   â”œâ”€â”€ quantize.c
|   |   |   â”œâ”€â”€ region.c
|   |   |   â”œâ”€â”€ ricecomp.c
|   |   |   â”œâ”€â”€ scalnull.c
|   |   |   â”œâ”€â”€ simplerng.c
|   |   |   â”œâ”€â”€ swapproc.c
|   |   |   â”œâ”€â”€ wcssub.c
|   |   |   â”œâ”€â”€ wcsutil.c
|   |   |   â”œâ”€â”€ zcompress.c
|   |   |   â””â”€â”€ zuncompress.c
|   |   â””â”€â”€ zlib
|   |       â”œâ”€â”€ adler32.c
|   |       â”œâ”€â”€ crc32.c
|   |       â”œâ”€â”€ deflate.c
|   |       â”œâ”€â”€ infback.c
|   |       â”œâ”€â”€ inffast.c
|   |       â”œâ”€â”€ inflate.c
|   |       â”œâ”€â”€ inftrees.c
|   |       â”œâ”€â”€ trees.c
|   |       â”œâ”€â”€ uncompr.c
|   |       â””â”€â”€ zutil.c
|   â”œâ”€â”€ expat
|   |   â”œâ”€â”€ README.md
|   |   â”œâ”€â”€ README.txt
|   |   â””â”€â”€ lib
|   |       â”œâ”€â”€ xmlparse.c
|   |       â”œâ”€â”€ xmlrole.c
|   |       â”œâ”€â”€ xmltok.c
|   |       â”œâ”€â”€ xmltok_impl.c
|   |       â””â”€â”€ xmltok_ns.c
|   â”œâ”€â”€ trim_cfitsio.sh
|   â”œâ”€â”€ trim_expat.sh
|   â”œâ”€â”€ trim_wcslib.sh
|   â””â”€â”€ wcslib
|       â”œâ”€â”€ C
|       |   â”œâ”€â”€ cel.c
|       |   â”œâ”€â”€ dis.c
|       |   â”œâ”€â”€ flexed
|       |   |   â”œâ”€â”€ fitshdr.c
|       |   |   â”œâ”€â”€ wcsbth.c
|       |   |   â”œâ”€â”€ wcspih.c
|       |   |   â”œâ”€â”€ wcsulex.c
|       |   |   â””â”€â”€ wcsutrn.c
|       |   â”œâ”€â”€ getwcstab.c
|       |   â”œâ”€â”€ lin.c
|       |   â”œâ”€â”€ log.c
|       |   â”œâ”€â”€ prj.c
|       |   â”œâ”€â”€ spc.c
|       |   â”œâ”€â”€ sph.c
|       |   â”œâ”€â”€ spx.c
|       |   â”œâ”€â”€ tab.c
|       |   â”œâ”€â”€ wcs.c
|       |   â”œâ”€â”€ wcserr.c
|       |   â”œâ”€â”€ wcsfix.c
|       |   â”œâ”€â”€ wcshdr.c
|       |   â”œâ”€â”€ wcsprintf.c
|       |   â”œâ”€â”€ wcstrig.c
|       |   â”œâ”€â”€ wcsunits.c
|       |   â””â”€â”€ wcsutil.c
|       â””â”€â”€ config
â”œâ”€â”€ codecov.yml
â”œâ”€â”€ conftest.py
â”œâ”€â”€ docs
|   â”œâ”€â”€ _pkgtemplate.rst
|   â”œâ”€â”€ _static
|   â”œâ”€â”€ _templates
|   â”œâ”€â”€ changelog.rst
|   â”œâ”€â”€ changes
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ config
|   |   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ cosmology
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12313.feature.rst
|   |   |   â”œâ”€â”€ 12354.api.rst
|   |   |   â”œâ”€â”€ 12375.api.rst
|   |   |   â”œâ”€â”€ 12479.feature.rst
|   |   |   â”œâ”€â”€ 12590.feature.rst
|   |   |   â”œâ”€â”€ 12606.feature.rst
|   |   |   â”œâ”€â”€ 12612.api.rst
|   |   |   â”œâ”€â”€ 12624.api.rst
|   |   |   â”œâ”€â”€ 12710.feature.rst
|   |   |   â”œâ”€â”€ 12736.feature.rst
|   |   |   â”œâ”€â”€ 12740.feature.rst
|   |   |   â”œâ”€â”€ 12746.api.rst
|   |   |   â””â”€â”€ 12966.feature.rst
|   |   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ io.ascii
|   |   |   â”œâ”€â”€ 12631.bugfix.rst
|   |   |   â””â”€â”€ 12841.api.rst
|   |   â”œâ”€â”€ io.fits
|   |   |   â”œâ”€â”€ 11843.feature.rst
|   |   |   â””â”€â”€ 12258.api.rst
|   |   â”œâ”€â”€ io.misc
|   |   |   â”œâ”€â”€ 10198.feature.rst
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12895.feature.rst
|   |   |   â”œâ”€â”€ 12897.feature.rst
|   |   |   â”œâ”€â”€ 12903.api.rst
|   |   |   â””â”€â”€ 12930.api.rst
|   |   â”œâ”€â”€ io.registry
|   |   â”œâ”€â”€ io.votable
|   |   â”œâ”€â”€ modeling
|   |   |   â”œâ”€â”€ 12384.feature.rst
|   |   |   â”œâ”€â”€ 12558.feature.rst
|   |   |   â”œâ”€â”€ 12585.api.rst
|   |   |   â””â”€â”€ 12811.feature.rst
|   |   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ table
|   |   |   â”œâ”€â”€ 12631.api.rst
|   |   |   â”œâ”€â”€ 12637.api.rst
|   |   |   â”œâ”€â”€ 12637.feature.rst
|   |   |   â”œâ”€â”€ 12680.feature.rst
|   |   |   â””â”€â”€ 12716.bugfix.rst
|   |   â”œâ”€â”€ template.rst
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ 12633.api.1.rst
|   |   |   â”œâ”€â”€ 12633.api.2.rst
|   |   |   â”œâ”€â”€ 12633.api.3.rst
|   |   |   â””â”€â”€ 12633.api.4.rst
|   |   â”œâ”€â”€ time
|   |   |   â””â”€â”€ 12888.api.rst
|   |   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ units
|   |   |   â”œâ”€â”€ 12486.feature.rst
|   |   |   â”œâ”€â”€ 12566.feature.rst
|   |   |   â”œâ”€â”€ 12709.feature.rst
|   |   |   â””â”€â”€ 12975.feature.rst
|   |   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ visualization
|   |   â””â”€â”€ wcs
|   |       â””â”€â”€ 12514.feature.rst
|   â”œâ”€â”€ common_links.txt
|   â”œâ”€â”€ conf.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ astropy_config.rst
|   |   â””â”€â”€ index.rst
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ images
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ kernels.rst
|   |   â”œâ”€â”€ non_normalized_kernels.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â””â”€â”€ using.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ angles.rst
|   |   â”œâ”€â”€ apply_space_motion.rst
|   |   â”œâ”€â”€ common_errors.rst
|   |   â”œâ”€â”€ definitions.rst
|   |   â”œâ”€â”€ formatting.rst
|   |   â”œâ”€â”€ frames.rst
|   |   â”œâ”€â”€ galactocentric.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ inplace.rst
|   |   â”œâ”€â”€ matchsep.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ remote_methods.rst
|   |   â”œâ”€â”€ representations.rst
|   |   â”œâ”€â”€ satellites.rst
|   |   â”œâ”€â”€ skycoord.rst
|   |   â”œâ”€â”€ solarsystem.rst
|   |   â”œâ”€â”€ spectralcoord.rst
|   |   â”œâ”€â”€ transforming.rst
|   |   â””â”€â”€ velocities.rst
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ dev.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ io.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ credits.rst
|   â”œâ”€â”€ development
|   |   â”œâ”€â”€ astropy-package-template.rst
|   |   â”œâ”€â”€ building.rst
|   |   â”œâ”€â”€ ccython.rst
|   |   â”œâ”€â”€ codeguide.rst
|   |   â”œâ”€â”€ codeguide_emacs.rst
|   |   â”œâ”€â”€ docguide.rst
|   |   â”œâ”€â”€ docrules.rst
|   |   â”œâ”€â”€ releasing.rst
|   |   â”œâ”€â”€ scripts.rst
|   |   â”œâ”€â”€ style-guide.rst
|   |   â”œâ”€â”€ testguide.rst
|   |   â”œâ”€â”€ vision.rst
|   |   â”œâ”€â”€ when_to_rebase.rst
|   |   â””â”€â”€ workflow
|   |       â”œâ”€â”€ additional_git_topics.rst
|   |       â”œâ”€â”€ development_workflow.rst
|   |       â”œâ”€â”€ get_devel_version.rst
|   |       â”œâ”€â”€ git_edit_workflow_examples.rst
|   |       â”œâ”€â”€ git_install.rst
|   |       â”œâ”€â”€ git_resources.rst
|   |       â”œâ”€â”€ maintainer_workflow.rst
|   |       â”œâ”€â”€ patches.rst
|   |       â””â”€â”€ virtual_pythons.rst
|   â”œâ”€â”€ getting_started.rst
|   â”œâ”€â”€ glossary.rst
|   â”œâ”€â”€ importing_astropy.rst
|   â”œâ”€â”€ index.rst
|   â”œâ”€â”€ install.rst
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ base_classes.rst
|   |   |   â”œâ”€â”€ ecsv.rst
|   |   |   â”œâ”€â”€ extension_classes.rst
|   |   |   â”œâ”€â”€ fast_ascii_io.rst
|   |   |   â”œâ”€â”€ fixed_width_gallery.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â”œâ”€â”€ read.rst
|   |   |   â”œâ”€â”€ references.txt
|   |   |   â”œâ”€â”€ toc.txt
|   |   |   â””â”€â”€ write.rst
|   |   â”œâ”€â”€ asdf-schemas.rst
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ api
|   |   |   |   â”œâ”€â”€ cards.rst
|   |   |   |   â”œâ”€â”€ diff.rst
|   |   |   |   â”œâ”€â”€ files.rst
|   |   |   |   â”œâ”€â”€ hdulists.rst
|   |   |   |   â”œâ”€â”€ hdus.rst
|   |   |   |   â”œâ”€â”€ headers.rst
|   |   |   |   â”œâ”€â”€ images.rst
|   |   |   |   â”œâ”€â”€ tables.rst
|   |   |   |   â””â”€â”€ verification.rst
|   |   |   â”œâ”€â”€ appendix
|   |   |   |   â”œâ”€â”€ faq.rst
|   |   |   |   â”œâ”€â”€ header_transition.rst
|   |   |   |   â””â”€â”€ history.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â””â”€â”€ usage
|   |   |       â”œâ”€â”€ headers.rst
|   |   |       â”œâ”€â”€ image.rst
|   |   |       â”œâ”€â”€ misc.rst
|   |   |       â”œâ”€â”€ scripts.rst
|   |   |       â”œâ”€â”€ table.rst
|   |   |       â”œâ”€â”€ unfamiliar.rst
|   |   |       â””â”€â”€ verification.rst
|   |   â”œâ”€â”€ misc.rst
|   |   â”œâ”€â”€ registry.rst
|   |   â”œâ”€â”€ unified.rst
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ api_exceptions.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ performance.inc.rst
|   |       â””â”€â”€ references.txt
|   â”œâ”€â”€ known_issues.rst
|   â”œâ”€â”€ license.rst
|   â”œâ”€â”€ logging.rst
|   â”œâ”€â”€ lts_policy.rst
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ add-units.rst
|   |   â”œâ”€â”€ compound-models.rst
|   |   â”œâ”€â”€ example-fitting-constraints.rst
|   |   â”œâ”€â”€ example-fitting-line.rst
|   |   â”œâ”€â”€ example-fitting-model-sets.rst
|   |   â”œâ”€â”€ fitting.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ jointfitter.rst
|   |   â”œâ”€â”€ models.rst
|   |   â”œâ”€â”€ new-fitter.rst
|   |   â”œâ”€â”€ new-model.rst
|   |   â”œâ”€â”€ parameters.rst
|   |   â”œâ”€â”€ performance.rst
|   |   â”œâ”€â”€ physical_models.rst
|   |   â”œâ”€â”€ polynomial_models.rst
|   |   â”œâ”€â”€ predef_models1D.rst
|   |   â”œâ”€â”€ predef_models2D.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ spline_models.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ bitmask.rst
|   |   â”œâ”€â”€ ccddata.rst
|   |   â”œâ”€â”€ decorator.rst
|   |   â”œâ”€â”€ examples
|   |   |   â””â”€â”€ cutout2d_tofits.py
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ ndarithmetic.rst
|   |   |   â”œâ”€â”€ ndio.rst
|   |   |   â””â”€â”€ ndslicing.rst
|   |   â”œâ”€â”€ nddata.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ subclassing.rst
|   |   â””â”€â”€ utils.rst
|   â”œâ”€â”€ overview.rst
|   â”œâ”€â”€ robots.txt
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ advanced_embed_samp_hub.rst
|   |   â”œâ”€â”€ example_clients.rst
|   |   â”œâ”€â”€ example_hub.rst
|   |   â”œâ”€â”€ example_table_image.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ circ.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ ripley.rst
|   |   â””â”€â”€ robust.rst
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ access_table.rst
|   |   â”œâ”€â”€ construct_table.rst
|   |   â”œâ”€â”€ implementation_details.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ indexing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ mixin_columns.rst
|   |   â”œâ”€â”€ modify_table.rst
|   |   â”œâ”€â”€ operations.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ testhelpers.rst
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ analysis.rst
|   |   â”œâ”€â”€ bls.rst
|   |   â”œâ”€â”€ data_access.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ initializing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ lombscargle.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ times.rst
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ combining_and_defining.rst
|   |   â”œâ”€â”€ constants_versions.rst
|   |   â”œâ”€â”€ conversion.rst
|   |   â”œâ”€â”€ decomposing_and_composing.rst
|   |   â”œâ”€â”€ equivalencies.rst
|   |   â”œâ”€â”€ format.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ logarithmic_units.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ physical_types.rst
|   |   â”œâ”€â”€ quantity.rst
|   |   â”œâ”€â”€ standard_units.rst
|   |   â”œâ”€â”€ structured_units.rst
|   |   â””â”€â”€ type_hints.rst
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ data.rst
|   |   â”œâ”€â”€ iers.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ masked
|   |       â””â”€â”€ index.rst
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ histogram.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ matplotlib_integration.rst
|   |   â”œâ”€â”€ normalization.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ rgb.rst
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ controlling_axes.rst
|   |       â”œâ”€â”€ custom_frames.rst
|   |       â”œâ”€â”€ generic_transforms.rst
|   |       â”œâ”€â”€ images_contours.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ initializing_axes.rst
|   |       â”œâ”€â”€ overlaying_coordinate_systems.rst
|   |       â”œâ”€â”€ overlays.rst
|   |       â”œâ”€â”€ slicing_datacubes.rst
|   |       â””â”€â”€ ticks_labels_grid.rst
|   â”œâ”€â”€ warnings.rst
|   â”œâ”€â”€ wcs
|   |   â”œâ”€â”€ example_create_imaging.rst
|   |   â”œâ”€â”€ example_cube_wcs.rst
|   |   â”œâ”€â”€ examples
|   |   |   â”œâ”€â”€ cube_wcs.py
|   |   |   â”œâ”€â”€ from_file.py
|   |   |   â””â”€â”€ programmatic.py
|   |   â”œâ”€â”€ history.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ legacy_interface.rst
|   |   â”œâ”€â”€ loading_from_fits.rst
|   |   â”œâ”€â”€ note_sip.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ references.rst
|   |   â”œâ”€â”€ references.txt
|   |   â”œâ”€â”€ relax.rst
|   |   â”œâ”€â”€ supported_projections.rst
|   |   â”œâ”€â”€ validation.rst
|   |   â”œâ”€â”€ wcsapi.rst
|   |   â””â”€â”€ wcstools.rst
|   â””â”€â”€ whatsnew
|       â”œâ”€â”€ 0.1.rst
|       â”œâ”€â”€ 0.2.rst
|       â”œâ”€â”€ 0.3.rst
|       â”œâ”€â”€ 0.4.rst
|       â”œâ”€â”€ 1.0.rst
|       â”œâ”€â”€ 1.1.rst
|       â”œâ”€â”€ 1.2.rst
|       â”œâ”€â”€ 1.3.rst
|       â”œâ”€â”€ 2.0.rst
|       â”œâ”€â”€ 3.0.rst
|       â”œâ”€â”€ 3.1.rst
|       â”œâ”€â”€ 3.2.rst
|       â”œâ”€â”€ 4.0.rst
|       â”œâ”€â”€ 4.1.rst
|       â”œâ”€â”€ 4.2.rst
|       â”œâ”€â”€ 4.3.rst
|       â”œâ”€â”€ 5.0.rst
|       â”œâ”€â”€ 5.1.rst
|       â””â”€â”€ index.rst
â”œâ”€â”€ examples
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ plot_galactocentric-frame.py
|   |   â”œâ”€â”€ plot_obs-planning.py
|   |   â”œâ”€â”€ plot_sgr-coordinate-frame.py
|   |   â””â”€â”€ rv-to-gsr.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ create-mef.py
|   |   â”œâ”€â”€ fits-tables.py
|   |   â”œâ”€â”€ modify-fits-header.py
|   |   â”œâ”€â”€ plot_fits-image.py
|   |   â”œâ”€â”€ skip_create-large-fits.py
|   |   â””â”€â”€ split-jpeg-to-fits.py
|   â””â”€â”€ template
|       â””â”€â”€ example-template.py
â”œâ”€â”€ licenses
|   â”œâ”€â”€ AURA_LICENSE.rst
|   â”œâ”€â”€ CONFIGOBJ_LICENSE.rst
|   â”œâ”€â”€ DATATABLES_LICENSE.rst
|   â”œâ”€â”€ ERFA.rst
|   â”œâ”€â”€ EXPAT_LICENSE.rst
|   â”œâ”€â”€ JQUERY_LICENSE.rst
|   â”œâ”€â”€ NUMPY_LICENSE.rst
|   â”œâ”€â”€ PLY_LICENSE.rst
|   â”œâ”€â”€ PYFITS.rst
|   â”œâ”€â”€ PYTHON.rst
|   â”œâ”€â”€ README.rst
|   â””â”€â”€ WCSLIB_LICENSE.rst
â””â”€â”€ setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
TimeSeries: misleading exception when required column check fails.

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-04 06:05:56,580 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants to find relevant test cases for a bug in `astropy.timeseries.TimeSeries`.\n2. The bug is related to a misleading exception when a required column is removed.\n3. To find similar test cases, I need to analyze the existing tests for `TimeSeries` and related components.\n4. The file tree indicates that the most relevant test files are likely `astropy/timeseries/tests/test_sampled.py` (since `TimeSeries` is a `SampledTimeSeries`) and `astropy/timeseries/tests/test_binned.py` (for the related `BinnedTimeSeries` class).\n5. Understanding the implementation of `TimeSeries` from `astropy/timeseries/sampled.py` is crucial to pinpoint the validation logic that is failing and to select the most relevant tests that exercise this logic.' refined_query='Please provide the contents of the following files:\n1. `astropy/timeseries/tests/test_sampled.py`\n2. `astropy/timeseries/tests/test_binned.py`\n3. `astropy/timeseries/sampled.py`'
2025-10-04 06:05:59,674 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/timeseries/sampled.py"}'}, '__gemini_function_call_thought_signatures__': {'df756c57-ec53-4ba4-8f3f-3bdcaa2c7eb4': 'CugCAR/MhbZRs+YF2uwiGldnY7akPQDhOFhYvmiQgnHMyHC5TGBlaSb+l7Ipf4AVr3+/7LcU7BWjlUUJK0H9rnvxikqCBDuVOcbvfqLeSZF2G46c+lFDY92lJxt3/aOwnMAI0QJ8rqyJ85zlRxt1VMlPWoLXzxeVare+SWKCZ92j9GG9qOWbD73lD3qTQA1wi4bUMvyLE2h4VMPMLn7q89hTY0BAjGSsD+dC3h4vxZEnXgG/PTA1wKBwYEeMGRzIfjyhWdjuYNz8L+9zBp009AdBO+n4w5W5c+0LptKucE7xiJcwWHv1r9mxi9H9iIm9YoV+BhQwNmRIUXf+BDrDuCoXbHk3JPTKyF5iMcp1cZLhGwgpXqgO6qQCB6qnpohVu0ILXtAA4uMNQHkwXpRBJZTxixq+k23lAnXcby3l3co6GBq3e+kZZE1tjsEaFdHZficzd78HJ6O/mEvuzzDwI7WvW9sw8BhM0bqW'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19546, 'candidates_token_count': 78, 'total_token_count': 19728, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19546}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 78}], 'thoughts_token_count': 104, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.03093566955664219, 'model_name': 'gemini-2.5-pro'} id='run--c1eb8746-3e11-47ff-a052-98cf9891ed86-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/tests/test_sampled.py'}, 'id': 'df756c57-ec53-4ba4-8f3f-3bdcaa2c7eb4', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/tests/test_binned.py'}, 'id': 'e8649088-0932-4d9f-a7a8-bf872ff49e4d', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/sampled.py'}, 'id': '8e9dd3b4-34ff-4d54-a3ea-a60961a8a465', 'type': 'tool_call'}] usage_metadata={'input_tokens': 19546, 'output_tokens': 78, 'total_tokens': 19728, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 104}}
2025-10-04 06:06:02,557 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have successfully retrieved the contents of the three requested files: `astropy/timeseries/tests/test_sampled.py`, `astropy/timeseries/tests/test_binned.py`, and `astropy/timeseries/sampled.py`. The contents of these files are now available for your review.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 40110, 'candidates_token_count': 67, 'total_token_count': 40240, 'cached_content_token_count': 17773, 'prompt_tokens_details': [{'modality': 1, 'token_count': 40211}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17773}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 67}], 'thoughts_token_count': 63}, 'finish_reason': 'STOP', 'avg_logprobs': -0.055460751946292706, 'model_name': 'gemini-2.5-pro'} id='run--31d2a5e9-c703-498d-bb15-343fa014e30d-0' usage_metadata={'input_tokens': 40110, 'output_tokens': 67, 'total_tokens': 40240, 'input_token_details': {'cache_read': 17773}, 'output_token_details': {'reasoning': 63}}
2025-10-04 06:06:02,558 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 06:06:02,558 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
TimeSeries: misleading exception when required column check fails.

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the contents of the following files:
1. `astropy/timeseries/tests/test_sampled.py`
2. `astropy/timeseries/tests/test_binned.py`
3. `astropy/timeseries/sampled.py`
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/timeseries/tests/test_sampled.py
Line number range: 1 - 420
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. from datetime import datetime
4. 
5. import pytest
6. 
7. from numpy.testing import assert_equal, assert_allclose
8. 
9. from astropy.table import Table, Column
10. from astropy.time import Time, TimeDelta
11. from astropy import units as u
12. from astropy.units import Quantity
13. from astropy.utils.data import get_pkg_data_filename
14. from astropy.tests.helper import assert_quantity_allclose
15. 
16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
17. from astropy.timeseries.sampled import TimeSeries
18. 
19. INPUT_TIME = Time(['2016-03-22T12:30:31',
20.                    '2015-01-21T12:30:32',
21.                    '2016-03-22T12:30:40'])
22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=['a', 'b', 'c'])
23. 
24. CSV_FILE = get_pkg_data_filename('data/sampled.csv')
25. 
26. 
27. def test_empty_initialization():
28.     ts = TimeSeries()
29.     ts['time'] = Time([50001, 50002, 50003], format='mjd')
30. 
31. 
32. def test_empty_initialization_invalid():
33.     # Make sure things crash when the first column added is not a time column
34.     ts = TimeSeries()
35.     with pytest.raises(ValueError) as exc:
36.         ts['flux'] = [1, 2, 3]
37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
38.                                  "'time' as the first column but found 'flux'")
39. 
40. 
41. def test_initialize_only_time():
42.     ts = TimeSeries(time=INPUT_TIME)
43.     assert ts['time'] is ts.time
44.     # NOTE: the object in the table is a copy
45.     assert_equal(ts.time.isot, INPUT_TIME.isot)
46. 
47. 
48. def test_initialization_with_data():
49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
50.     assert_equal(ts.time.isot, INPUT_TIME.isot)
51.     assert_equal(ts['a'], [10, 2, 3])
52.     assert_equal(ts['b'], [4, 5, 6])
53. 
54. 
55. def test_initialize_only_data():
56.     with pytest.raises(TypeError) as exc:
57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
58.     assert exc.value.args[0] == "Either 'time' or 'time_start' should be specified"
59. 
60. 
61. def test_initialization_with_table():
62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)
63.     assert ts.colnames == ['time', 'a', 'b', 'c']
64. 
65. 
66. def test_initialization_with_time_delta():
67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
68.                     time_delta=TimeDelta(3, format='sec'),
69.                     data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
70.     assert_equal(ts.time.isot, ['2018-07-01T10:10:10.000',
71.                                 '2018-07-01T10:10:13.000',
72.                                 '2018-07-01T10:10:16.000'])
73. 
74. 
75. def test_initialization_missing_time_delta():
76.     with pytest.raises(TypeError) as exc:
77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
78.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
79.     assert exc.value.args[0] == "'time' is scalar, so 'time_delta' is required"
80. 
81. 
82. def test_initialization_invalid_time_and_time_start():
83.     with pytest.raises(TypeError) as exc:
84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),
85.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
86.     assert exc.value.args[0] == "Cannot specify both 'time' and 'time_start'"
87. 
88. 
89. def test_initialization_invalid_time_delta():
90.     with pytest.raises(TypeError) as exc:
91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
92.                    time_delta=[1, 4, 3],
93.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
94.     assert exc.value.args[0] == "'time_delta' should be a Quantity or a TimeDelta"
95. 
96. 
97. def test_initialization_with_time_in_data():
98. 
99.     data = PLAIN_TABLE.copy()
100.     data['time'] = INPUT_TIME
101. 
102.     ts1 = TimeSeries(data=data)
103. 
104.     assert set(ts1.colnames) == set(['time', 'a', 'b', 'c'])
105.     assert all(ts1.time == INPUT_TIME)
106. 
107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
108.     assert set(ts2.colnames) == set(['time', 'a'])
109.     assert all(ts2.time == INPUT_TIME)
110. 
111.     with pytest.raises(TypeError) as exc:
112.         # Don't allow ambiguous cases of passing multiple 'time' columns
113.         TimeSeries(data=data, time=INPUT_TIME)
114.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
115. 
116.     with pytest.raises(TypeError) as exc:
117.         # 'time' is a protected name, don't allow ambiguous cases
118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
119.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
120. 
121. 
122. def test_initialization_n_samples():
123. 
124.     # Make sure things crash with incorrect n_samples
125. 
126.     with pytest.raises(TypeError) as exc:
127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)
128.     assert exc.value.args[0] == ("'n_samples' has been given both and it is not the "
129.                                  "same length as the input data.")
130. 
131. 
132. def test_initialization_length_mismatch():
133.     with pytest.raises(ValueError) as exc:
134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=['a', 'b'])
135.     assert exc.value.args[0] == "Length of 'time' (3) should match data length (2)"
136. 
137. 
138. def test_initialization_invalid_both_time_and_time_delta():
139.     with pytest.raises(TypeError) as exc:
140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format='sec'))
141.     assert exc.value.args[0] == ("'time_delta' should not be specified since "
142.                                  "'time' is an array")
143. 
144. 
145. def test_fold():
146. 
147.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
148. 
149.     ts = TimeSeries(time=times)
150.     ts['flux'] = [1, 4, 4, 3, 2, 3]
151. 
152.     # Try without epoch time, as it should default to the first time and
153.     # wrapping at half the period.
154.     tsf = ts.fold(period=3.2 * u.s)
155.     assert isinstance(tsf.time, TimeDelta)
156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)
157. 
158.     # Try with epoch time
159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'))
160.     assert isinstance(tsf.time, TimeDelta)
161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)
162. 
163.     # Now with wrap_phase set to the full period
164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)
165.     assert isinstance(tsf.time, TimeDelta)
166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)
167. 
168.     # Now set epoch_phase to be 1/4 of the way through the phase
169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)
170.     assert isinstance(tsf.time, TimeDelta)
171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)
172. 
173.     # And combining epoch_phase and wrap_phase
174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)
175.     assert isinstance(tsf.time, TimeDelta)
176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)
177. 
178.     # Now repeat the above tests but with normalization applied
179. 
180.     # Try without epoch time, as it should default to the first time and
181.     # wrapping at half the period.
182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)
183.     assert isinstance(tsf.time, Quantity)
184.     assert_allclose(tsf.time.to_value(u.one),
185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],
186.                     rtol=1e-6)
187. 
188.     # Try with epoch time
189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'),
190.                   normalize_phase=True)
191.     assert isinstance(tsf.time, Quantity)
192.     assert_allclose(tsf.time.to_value(u.one),
193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],
194.                     rtol=1e-6, atol=1e-6)
195. 
196.     # Now with wrap_phase set to the full period
197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)
198.     assert isinstance(tsf.time, Quantity)
199.     assert_allclose(tsf.time.to_value(u.one),
200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],
201.                     rtol=1e-6)
202. 
203.     # Now set epoch_phase to be 1/4 of the way through the phase
204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)
205.     assert isinstance(tsf.time, Quantity)
206.     assert_allclose(tsf.time.to_value(u.one),
207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],
208.                     rtol=1e-6)
209. 
210.     # And combining epoch_phase and wrap_phase
211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,
212.                   normalize_phase=True)
213.     assert isinstance(tsf.time, Quantity)
214.     assert_allclose(tsf.time.to_value(u.one),
215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],
216.                     rtol=1e-6)
217. 
218. 
219. def test_fold_invalid_options():
220. 
221.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
222. 
223.     ts = TimeSeries(time=times)
224.     ts['flux'] = [1, 4, 4, 3, 2, 3]
225. 
226.     with pytest.raises(u.UnitsError,
227.                        match='period should be a Quantity in units of time'):
228.         ts.fold(period=3.2)
229. 
230.     with pytest.raises(u.UnitsError,
231.                        match='period should be a Quantity in units of time'):
232.         ts.fold(period=3.2 * u.m)
233. 
234.     with pytest.raises(u.UnitsError,
235.                        match='epoch_phase should be a Quantity in units of '
236.                              'time when normalize_phase=False'):
237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)
238. 
239.     with pytest.raises(u.UnitsError,
240.                        match='epoch_phase should be a dimensionless Quantity '
241.                              'or a float when normalize_phase=True'):
242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)
243. 
244.     with pytest.raises(u.UnitsError,
245.                        match='wrap_phase should be a Quantity in units of '
246.                              'time when normalize_phase=False'):
247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)
248. 
249.     with pytest.raises(u.UnitsError,
250.                        match='wrap_phase should be dimensionless when '
251.                              'normalize_phase=True'):
252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)
253. 
254.     with pytest.raises(ValueError,
255.                        match='wrap_phase should be between 0 and the period'):
256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)
257. 
258.     with pytest.raises(ValueError,
259.                        match='wrap_phase should be between 0 and the period'):
260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)
261. 
262.     with pytest.raises(ValueError,
263.                        match='wrap_phase should be between 0 and 1'):
264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)
265. 
266.     with pytest.raises(ValueError,
267.                        match='wrap_phase should be between 0 and 1'):
268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)
269. 
270. 
271. def test_pandas():
272.     pandas = pytest.importorskip("pandas")
273. 
274.     df1 = pandas.DataFrame()
275.     df1['a'] = [1, 2, 3]
276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)
277. 
278.     ts = TimeSeries.from_pandas(df1)
279.     assert_equal(ts.time.isot, INPUT_TIME.isot)
280.     assert ts.colnames == ['time', 'a']
281.     assert len(ts.indices) == 1
282.     assert (ts.indices['time'].columns[0] == INPUT_TIME).all()
283. 
284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale='tcb')
285.     assert ts_tcb.time.scale == 'tcb'
286. 
287.     df2 = ts.to_pandas()
288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()
289.     assert df2.columns == pandas.Index(['a'])
290.     assert (df1['a'] == df2['a']).all()
291. 
292.     with pytest.raises(TypeError) as exc:
293.         TimeSeries.from_pandas(None)
294.     assert exc.value.args[0] == 'Input should be a pandas DataFrame'
295. 
296.     df4 = pandas.DataFrame()
297.     df4['a'] = [1, 2, 3]
298. 
299.     with pytest.raises(TypeError) as exc:
300.         TimeSeries.from_pandas(df4)
301.     assert exc.value.args[0] == 'DataFrame does not have a DatetimeIndex'
302. 
303. 
304. def test_read_time_missing():
305.     with pytest.raises(ValueError) as exc:
306.         TimeSeries.read(CSV_FILE, format='csv')
307.     assert exc.value.args[0] == '``time_column`` should be provided since the default Table readers are being used.'
308. 
309. 
310. def test_read_time_wrong():
311.     with pytest.raises(ValueError) as exc:
312.         TimeSeries.read(CSV_FILE, time_column='abc', format='csv')
313.     assert exc.value.args[0] == "Time column 'abc' not found in the input data."
314. 
315. 
316. def test_read():
317.     timeseries = TimeSeries.read(CSV_FILE, time_column='Date', format='csv')
318.     assert timeseries.colnames == ['time', 'A', 'B', 'C', 'D', 'E', 'F', 'G']
319.     assert len(timeseries) == 11
320.     assert timeseries['time'].format == 'iso'
321.     assert timeseries['A'].sum() == 266.5
322. 
323. 
324. @pytest.mark.remote_data(source='astropy')
325. def test_kepler_astropy():
326.     from astropy.units import UnitsWarning
327. 
328.     filename = get_pkg_data_filename('timeseries/kplr010666592-2009131110544_slc.fits')
329. 
330.     with pytest.warns(UnitsWarning):
331.         timeseries = TimeSeries.read(filename, format='kepler.fits')
332. 
333.     assert timeseries["time"].format == 'isot'
334.     assert timeseries["time"].scale == 'tdb'
335.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
336.     assert len(timeseries) == 14280
337.     assert len(timeseries.columns) == 20
338. 
339. 
340. @pytest.mark.remote_data(source='astropy')
341. def test_tess_astropy():
342.     filename = get_pkg_data_filename('timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits')
343.     with pytest.warns(UserWarning, match='Ignoring 815 rows with NaN times'):
344.         timeseries = TimeSeries.read(filename, format='tess.fits')
345.     assert timeseries["time"].format == 'isot'
346.     assert timeseries["time"].scale == 'tdb'
347.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
348.     assert len(timeseries) == 19261
349.     assert len(timeseries.columns) == 20
350. 
351. 
352. def test_required_columns():
353. 
354.     # Test the machinery that makes sure that the required columns are present
355. 
356.     ts = TimeSeries(time=INPUT_TIME,
357.                     data=[[10, 2, 3], [4, 5, 6]],
358.                     names=['a', 'b'])
359. 
360.     # In the examples below, the operation (e.g. remove_column) is actually
361.     # carried out before the checks are made, so we need to use copy() so that
362.     # we don't change the main version of the time series.
363. 
364.     # Make sure copy works fine
365.     ts.copy()
366. 
367.     with pytest.raises(ValueError) as exc:
368.         ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
370.                                  "'time' as the first column but found 'c'")
371. 
372.     with pytest.raises(ValueError) as exc:
373.         ts.copy().add_columns([Column([3, 4, 5], name='d'),
374.                                Column([3, 4, 5], name='e')], indexes=[0, 1])
375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
376.                                  "'time' as the first column but found 'd'")
377. 
378.     with pytest.raises(ValueError) as exc:
379.         ts.copy().keep_columns(['a', 'b'])
380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
381.                                  "'time' as the first column but found 'a'")
382. 
383.     with pytest.raises(ValueError) as exc:
384.         ts.copy().remove_column('time')
385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
386.                                  "'time' as the first column but found 'a'")
387. 
388.     with pytest.raises(ValueError) as exc:
389.         ts.copy().remove_columns(['time', 'a'])
390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
391.                                  "'time' as the first column but found 'b'")
392. 
393.     with pytest.raises(ValueError) as exc:
394.         ts.copy().rename_column('time', 'banana')
395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
396.                                  "'time' as the first column but found 'banana'")
397. 
398. 
399. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
400. def test_periodogram(cls):
401. 
402.     # Note that we don't need to check the actual results from the periodogram
403.     # classes here since these are tested extensively in
404.     # astropy.timeseries.periodograms.
405. 
406.     ts = TimeSeries(time=INPUT_TIME,
407.                     data=[[10, 2, 3], [4, 5, 6]],
408.                     names=['a', 'b'])
409. 
410.     p1 = cls.from_timeseries(ts, 'a')
411.     assert isinstance(p1, cls)
412.     assert_allclose(p1.t.jd, ts.time.jd)
413.     assert_equal(p1.y, ts['a'])
414.     assert p1.dy is None
415. 
416.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
417.     assert_quantity_allclose(p2.dy, ts['b'])
418. 
419.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
420.     assert_allclose(p3.dy, 0.1)

File: astropy/timeseries/tests/test_binned.py
Line number range: 1 - 317
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import pytest
4. from numpy.testing import assert_equal, assert_allclose
5. 
6. from astropy import units as u
7. from astropy.time import Time, TimeDelta
8. from astropy.utils.data import get_pkg_data_filename
9. 
10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
11. from astropy.timeseries.binned import BinnedTimeSeries
12. from astropy.tests.helper import assert_quantity_allclose
13. 
14. 
15. CSV_FILE = get_pkg_data_filename('data/binned.csv')
16. 
17. 
18. def test_empty_initialization():
19.     ts = BinnedTimeSeries()
20.     ts['time_bin_start'] = Time([1, 2, 3], format='mjd')
21. 
22. 
23. def test_empty_initialization_invalid():
24. 
25.     # Make sure things crash when the first column added is not a time column
26. 
27.     ts = BinnedTimeSeries()
28.     with pytest.raises(ValueError) as exc:
29.         ts['flux'] = [1, 2, 3]
30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "
31.                                  "'time_bin_start' as the first column but found 'flux'")
32. 
33. 
34. def test_initialization_time_bin_invalid():
35. 
36.     # Make sure things crash when time_bin_* is passed incorrectly.
37. 
38.     with pytest.raises(TypeError) as exc:
39.         BinnedTimeSeries(data=[[1, 4, 3]])
40.     assert exc.value.args[0] == ("'time_bin_start' has not been specified")
41. 
42.     with pytest.raises(TypeError) as exc:
43.         BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31', data=[[1, 4, 3]])
44.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
45. 
46. 
47. def test_initialization_time_bin_both():
48. 
49.     # Make sure things crash when time_bin_* is passed twice.
50. 
51.     with pytest.raises(TypeError) as exc:
52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},
53.                          time_bin_start="2016-03-22T12:30:31")
54.     assert exc.value.args[0] == ("'time_bin_start' has been given both in the table "
55.                                  "and as a keyword argument")
56. 
57.     with pytest.raises(TypeError) as exc:
58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},
59.                          time_bin_size=[1]*u.s)
60.     assert exc.value.args[0] == ("'time_bin_size' has been given both in the table "
61.                                  "and as a keyword argument")
62. 
63. 
64. def test_initialization_time_bin_size():
65. 
66.     # Make sure things crash when time_bin_size has no units
67. 
68.     with pytest.raises(TypeError) as exc:
69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
70.                          time_bin_start="2016-03-22T12:30:31",
71.                          time_bin_size=1)
72.     assert exc.value.args[0] == ("'time_bin_size' should be a Quantity or a TimeDelta")
73. 
74.     # TimeDelta for time_bin_size
75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
76.                           time_bin_start="2016-03-22T12:30:31",
77.                           time_bin_size=TimeDelta(1, format="jd"))
78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)
79. 
80. 
81. def test_initialization_time_bin_start_scalar():
82. 
83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size
84. 
85.     with pytest.raises(TypeError) as exc:
86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
87.                          time_bin_start=Time(1, format='mjd'),
88.                          time_bin_end=Time(1, format='mjd'))
89.     assert exc.value.args[0] == ("'time_bin_start' is scalar, so 'time_bin_size' is required")
90. 
91. 
92. def test_initialization_n_bins_invalid_arguments():
93. 
94.     # Make sure an exception is raised when n_bins is passed as an argument while
95.     # any of the parameters 'time_bin_start' or 'time_bin_end' is not scalar.
96. 
97.     with pytest.raises(TypeError) as exc:
98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format='cxcsec'),
99.                          time_bin_size=1*u.s,
100.                          n_bins=10)
101.     assert exc.value.args[0] == ("'n_bins' cannot be specified if 'time_bin_start' or "
102.                                  "'time_bin_size' are not scalar'")
103. 
104. 
105. def test_initialization_n_bins():
106. 
107.     # Make sure things crash with incorrect n_bins
108. 
109.     with pytest.raises(TypeError) as exc:
110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
111.                          time_bin_start=Time(1, format='mjd'),
112.                          time_bin_size=1*u.s,
113.                          time_bin_end=Time(1, format='mjd'),
114.                          n_bins=10)
115.     assert exc.value.args[0] == ("'n_bins' has been given and it is not the "
116.                                  "same length as the input data.")
117. 
118. 
119. def test_initialization_non_scalar_time():
120. 
121.     # Make sure things crash with incorrect size of time_bin_start
122. 
123.     with pytest.raises(ValueError) as exc:
124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],
126.                          time_bin_size=1*u.s,
127.                          time_bin_end=Time(1, format='mjd'))
128.     assert exc.value.args[0] == ("Length of 'time_bin_start' (2) should match table length (1)")
129. 
130.     with pytest.raises(TypeError) as exc:
131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
132.                          time_bin_start=["2016-03-22T12:30:31"],
133.                          time_bin_size=None,
134.                          time_bin_end=None)
135.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
136. 
137. 
138. def test_even_contiguous():
139. 
140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying
141.     # the bin width:
142. 
143.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])
145. 
146.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
147.                                           '2016-03-22T12:30:34.000',
148.                                           '2016-03-22T12:30:37.000'])
149. 
150.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:32.500',
151.                                            '2016-03-22T12:30:35.500',
152.                                            '2016-03-22T12:30:38.500'])
153. 
154.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:34.000',
155.                                         '2016-03-22T12:30:37.000',
156.                                         '2016-03-22T12:30:40.000'])
157. 
158. 
159. def test_uneven_contiguous():
160. 
161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an
162.     # end time:
163. 
164.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
165.                                           '2016-03-22T12:30:32',
166.                                           '2016-03-22T12:30:40'],
167.                           time_bin_end='2016-03-22T12:30:55',
168.                           data=[[1, 4, 3]])
169. 
170.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
171.                                           '2016-03-22T12:30:32.000',
172.                                           '2016-03-22T12:30:40.000'])
173. 
174.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
175.                                            '2016-03-22T12:30:36.000',
176.                                            '2016-03-22T12:30:47.500'])
177. 
178.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
179.                                         '2016-03-22T12:30:40.000',
180.                                         '2016-03-22T12:30:55.000'])
181. 
182. 
183. def test_uneven_non_contiguous():
184. 
185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with
186.     # lists of start times, bin sizes and data:
187. 
188.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
189.                                           '2016-03-22T12:30:38',
190.                                           '2016-03-22T12:34:40'],
191.                           time_bin_size=[5, 100, 2]*u.s,
192.                           data=[[1, 4, 3]])
193. 
194.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
195.                                           '2016-03-22T12:30:38.000',
196.                                           '2016-03-22T12:34:40.000'])
197. 
198.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:33.500',
199.                                            '2016-03-22T12:31:28.000',
200.                                            '2016-03-22T12:34:41.000'])
201. 
202.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:36.000',
203.                                         '2016-03-22T12:32:18.000',
204.                                         '2016-03-22T12:34:42.000'])
205. 
206. 
207. def test_uneven_non_contiguous_full():
208. 
209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by
210.     # specifying the start and end times for the bins:
211. 
212.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
213.                                           '2016-03-22T12:30:33',
214.                                           '2016-03-22T12:30:40'],
215.                           time_bin_end=['2016-03-22T12:30:32',
216.                                         '2016-03-22T12:30:35',
217.                                         '2016-03-22T12:30:41'],
218.                           data=[[1, 4, 3]])
219. 
220.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
221.                                           '2016-03-22T12:30:33.000',
222.                                           '2016-03-22T12:30:40.000'])
223. 
224.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
225.                                            '2016-03-22T12:30:34.000',
226.                                            '2016-03-22T12:30:40.500'])
227. 
228.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
229.                                         '2016-03-22T12:30:35.000',
230.                                         '2016-03-22T12:30:41.000'])
231. 
232. 
233. def test_read_empty():
234.     with pytest.raises(ValueError) as exc:
235.         BinnedTimeSeries.read(CSV_FILE, format='csv')
236.     assert exc.value.args[0] == '``time_bin_start_column`` should be provided since the default Table readers are being used.'
237. 
238. 
239. def test_read_no_size_end():
240.     with pytest.raises(ValueError) as exc:
241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', format='csv')
242.     assert exc.value.args[0] == 'Either `time_bin_end_column` or `time_bin_size_column` should be provided.'
243. 
244. 
245. def test_read_both_extra_bins():
246.     with pytest.raises(ValueError) as exc:
247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column='END', time_bin_size_column='bin_size', format='csv')
248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."
249. 
250. 
251. def test_read_size_no_unit():
252.     with pytest.raises(ValueError) as exc:
253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column='bin_size', format='csv')
254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
255. 
256. 
257. def test_read_start_time_missing():
258.     with pytest.raises(ValueError) as exc:
259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='abc', time_bin_size_column='bin_size', time_bin_size_unit=u.second, format='csv')
260.     assert exc.value.args[0] == "Bin start time column 'abc' not found in the input data."
261. 
262. 
263. def test_read_end_time_missing():
264.     with pytest.raises(ValueError) as exc:
265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column="missing", format='csv')
266.     assert exc.value.args[0] == "Bin end time column 'missing' not found in the input data."
267. 
268. 
269. def test_read_size_missing():
270.     with pytest.raises(ValueError) as exc:
271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="missing", time_bin_size_unit=u.second, format='csv')
272.     assert exc.value.args[0] == "Bin size column 'missing' not found in the input data."
273. 
274. 
275. def test_read_time_unit_missing():
276.     with pytest.raises(ValueError) as exc:
277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="bin_size", format='csv')
278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
279. 
280. 
281. def test_read():
282. 
283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
284.                                        time_bin_end_column='time_end', format='csv')
285.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'bin_size', 'A', 'B', 'C', 'D', 'E', 'F']
286.     assert len(timeseries) == 10
287.     assert timeseries['B'].sum() == 1151.54
288. 
289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
290.                                        time_bin_size_column='bin_size',
291.                                        time_bin_size_unit=u.second, format='csv')
292.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'time_end', 'A', 'B', 'C', 'D', 'E', 'F']
293.     assert len(timeseries) == 10
294.     assert timeseries['B'].sum() == 1151.54
295. 
296. 
297. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
298. def test_periodogram(cls):
299. 
300.     # Note that we don't need to check the actual results from the periodogram
301.     # classes here since these are tested extensively in
302.     # astropy.timeseries.periodograms.
303. 
304.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=['a', 'b'])
306. 
307.     p1 = cls.from_timeseries(ts, 'a')
308.     assert isinstance(p1, cls)
309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)
310.     assert_equal(p1.y, ts['a'])
311.     assert p1.dy is None
312. 
313.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
314.     assert_quantity_allclose(p2.dy, ts['b'])
315. 
316.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
317.     assert_allclose(p3.dy, 0.1)

File: astropy/timeseries/sampled.py
Line number range: 1 - 383
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. from copy import deepcopy
4. 
5. import numpy as np
6. 
7. from astropy.table import groups, QTable, Table
8. from astropy.time import Time, TimeDelta
9. from astropy import units as u
10. from astropy.units import Quantity, UnitsError
11. from astropy.utils.decorators import deprecated_renamed_argument
12. from astropy.timeseries.core import BaseTimeSeries, autocheck_required_columns
13. 
14. __all__ = ['TimeSeries']
15. 
16. 
17. @autocheck_required_columns
18. class TimeSeries(BaseTimeSeries):
19.     """
20.     A class to represent time series data in tabular form.
21. 
22.     `~astropy.timeseries.TimeSeries` provides a class for representing time
23.     series as a collection of values of different quantities measured at specific
24.     points in time (for time series with finite time bins, see the
25.     `~astropy.timeseries.BinnedTimeSeries` class).
26.     `~astropy.timeseries.TimeSeries` is a sub-class of `~astropy.table.QTable`
27.     and thus provides all the standard table maniplation methods available to
28.     tables, but it also provides additional conveniences for dealing with time
29.     series, such as a flexible initializer for setting up the times, a method
30.     for folding time series, and a ``time`` attribute for easy access to the
31.     time values.
32. 
33.     See also: https://docs.astropy.org/en/stable/timeseries/
34. 
35.     Parameters
36.     ----------
37.     data : numpy ndarray, dict, list, `~astropy.table.Table`, or table-like object, optional
38.         Data to initialize time series. This does not need to contain the times,
39.         which can be provided separately, but if it does contain the times they
40.         should be in a column called ``'time'`` to be automatically recognized.
41.     time : `~astropy.time.Time`, `~astropy.time.TimeDelta` or iterable
42.         The times at which the values are sampled - this can be either given
43.         directly as a `~astropy.time.Time` or `~astropy.time.TimeDelta` array
44.         or as any iterable that initializes the `~astropy.time.Time` class. If
45.         this is given, then the remaining time-related arguments should not be used.
46.     time_start : `~astropy.time.Time` or str
47.         The time of the first sample in the time series. This is an alternative
48.         to providing ``time`` and requires that ``time_delta`` is also provided.
49.     time_delta : `~astropy.time.TimeDelta` or `~astropy.units.Quantity` ['time']
50.         The step size in time for the series. This can either be a scalar if
51.         the time series is evenly sampled, or an array of values if it is not.
52.     n_samples : int
53.         The number of time samples for the series. This is only used if both
54.         ``time_start`` and ``time_delta`` are provided and are scalar values.
55.     **kwargs : dict, optional
56.         Additional keyword arguments are passed to `~astropy.table.QTable`.
57.     """
58. 
59.     _required_columns = ['time']
60. 
61.     def __init__(self, data=None, *, time=None, time_start=None,
62.                  time_delta=None, n_samples=None, **kwargs):
63. 
64.         super().__init__(data=data, **kwargs)
65. 
66.         # For some operations, an empty time series needs to be created, then
67.         # columns added one by one. We should check that when columns are added
68.         # manually, time is added first and is of the right type.
69.         if data is None and time is None and time_start is None and time_delta is None:
70.             self._required_columns_relax = True
71.             return
72. 
73.         # First if time has been given in the table data, we should extract it
74.         # and treat it as if it had been passed as a keyword argument.
75. 
76.         if data is not None:
77.             if n_samples is not None:
78.                 if n_samples != len(self):
79.                     raise TypeError("'n_samples' has been given both and it is not the "
80.                                     "same length as the input data.")
81.             else:
82.                 n_samples = len(self)
83. 
84.         if 'time' in self.colnames:
85.             if time is None:
86.                 time = self.columns['time']
87.             else:
88.                 raise TypeError("'time' has been given both in the table and as a keyword argument")
89. 
90.         if time is None and time_start is None:
91.             raise TypeError("Either 'time' or 'time_start' should be specified")
92.         elif time is not None and time_start is not None:
93.             raise TypeError("Cannot specify both 'time' and 'time_start'")
94. 
95.         if time is not None and not isinstance(time, (Time, TimeDelta)):
96.             time = Time(time)
97. 
98.         if time_start is not None and not isinstance(time_start, (Time, TimeDelta)):
99.             time_start = Time(time_start)
100. 
101.         if time_delta is not None and not isinstance(time_delta, (Quantity, TimeDelta)):
102.             raise TypeError("'time_delta' should be a Quantity or a TimeDelta")
103. 
104.         if isinstance(time_delta, TimeDelta):
105.             time_delta = time_delta.sec * u.s
106. 
107.         if time_start is not None:
108. 
109.             # We interpret this as meaning that time is that of the first
110.             # sample and that the interval is given by time_delta.
111. 
112.             if time_delta is None:
113.                 raise TypeError("'time' is scalar, so 'time_delta' is required")
114. 
115.             if time_delta.isscalar:
116.                 time_delta = np.repeat(time_delta, n_samples)
117. 
118.             time_delta = np.cumsum(time_delta)
119.             time_delta = np.roll(time_delta, 1)
120.             time_delta[0] = 0. * u.s
121. 
122.             time = time_start + time_delta
123. 
124.         elif len(self.colnames) > 0 and len(time) != len(self):
125.             raise ValueError("Length of 'time' ({}) should match "
126.                              "data length ({})".format(len(time), n_samples))
127. 
128.         elif time_delta is not None:
129.             raise TypeError("'time_delta' should not be specified since "
130.                             "'time' is an array")
131. 
132.         with self._delay_required_column_checks():
133.             if 'time' in self.colnames:
134.                 self.remove_column('time')
135.             self.add_column(time, index=0, name='time')
136. 
137.     @property
138.     def time(self):
139.         """
140.         The time values.
141.         """
142.         return self['time']
143. 
144.     @deprecated_renamed_argument('midpoint_epoch', 'epoch_time', '4.0')
145.     def fold(self, period=None, epoch_time=None, epoch_phase=0,
146.              wrap_phase=None, normalize_phase=False):
147.         """
148.         Return a new `~astropy.timeseries.TimeSeries` folded with a period and
149.         epoch.
150. 
151.         Parameters
152.         ----------
153.         period : `~astropy.units.Quantity` ['time']
154.             The period to use for folding
155.         epoch_time : `~astropy.time.Time`
156.             The time to use as the reference epoch, at which the relative time
157.             offset / phase will be ``epoch_phase``. Defaults to the first time
158.             in the time series.
159.         epoch_phase : float or `~astropy.units.Quantity` ['dimensionless', 'time']
160.             Phase of ``epoch_time``. If ``normalize_phase`` is `True`, this
161.             should be a dimensionless value, while if ``normalize_phase`` is
162.             ``False``, this should be a `~astropy.units.Quantity` with time
163.             units. Defaults to 0.
164.         wrap_phase : float or `~astropy.units.Quantity` ['dimensionless', 'time']
165.             The value of the phase above which values are wrapped back by one
166.             period. If ``normalize_phase`` is `True`, this should be a
167.             dimensionless value, while if ``normalize_phase`` is ``False``,
168.             this should be a `~astropy.units.Quantity` with time units.
169.             Defaults to half the period, so that the resulting time series goes
170.             from ``-period / 2`` to ``period / 2`` (if ``normalize_phase`` is
171.             `False`) or -0.5 to 0.5 (if ``normalize_phase`` is `True`).
172.         normalize_phase : bool
173.             If `False` phase is returned as `~astropy.time.TimeDelta`,
174.             otherwise as a dimensionless `~astropy.units.Quantity`.
175. 
176.         Returns
177.         -------
178.         folded_timeseries : `~astropy.timeseries.TimeSeries`
179.             The folded time series object with phase as the ``time`` column.
180.         """
181. 
182.         if not isinstance(period, Quantity) or period.unit.physical_type != 'time':
183.             raise UnitsError('period should be a Quantity in units of time')
184. 
185.         folded = self.copy()
186. 
187.         if epoch_time is None:
188.             epoch_time = self.time[0]
189.         else:
190.             epoch_time = Time(epoch_time)
191. 
192.         period_sec = period.to_value(u.s)
193. 
194.         if normalize_phase:
195.             if isinstance(epoch_phase, Quantity) and epoch_phase.unit.physical_type != 'dimensionless':
196.                 raise UnitsError('epoch_phase should be a dimensionless Quantity '
197.                                  'or a float when normalize_phase=True')
198.             epoch_phase_sec = epoch_phase * period_sec
199.         else:
200.             if epoch_phase == 0:
201.                 epoch_phase_sec = 0.
202.             else:
203.                 if not isinstance(epoch_phase, Quantity) or epoch_phase.unit.physical_type != 'time':
204.                     raise UnitsError('epoch_phase should be a Quantity in units '
205.                                      'of time when normalize_phase=False')
206.                 epoch_phase_sec = epoch_phase.to_value(u.s)
207. 
208.         if wrap_phase is None:
209.             wrap_phase = period_sec / 2
210.         else:
211.             if normalize_phase:
212.                 if isinstance(wrap_phase, Quantity) and not wrap_phase.unit.is_equivalent(u.one):
213.                     raise UnitsError('wrap_phase should be dimensionless when '
214.                                      'normalize_phase=True')
215.                 else:
216.                     if wrap_phase < 0 or wrap_phase > 1:
217.                         raise ValueError('wrap_phase should be between 0 and 1')
218.                     else:
219.                         wrap_phase = wrap_phase * period_sec
220.             else:
221.                 if isinstance(wrap_phase, Quantity) and wrap_phase.unit.physical_type == 'time':
222.                     if wrap_phase < 0 or wrap_phase > period:
223.                         raise ValueError('wrap_phase should be between 0 and the period')
224.                     else:
225.                         wrap_phase = wrap_phase.to_value(u.s)
226.                 else:
227.                     raise UnitsError('wrap_phase should be a Quantity in units '
228.                                      'of time when normalize_phase=False')
229. 
230.         relative_time_sec = (((self.time - epoch_time).sec
231.                               + epoch_phase_sec
232.                               + (period_sec - wrap_phase)) % period_sec
233.                              - (period_sec - wrap_phase))
234. 
235.         folded_time = TimeDelta(relative_time_sec * u.s)
236. 
237.         if normalize_phase:
238.             folded_time = (folded_time / period).decompose()
239.             period = period_sec = 1
240. 
241.         with folded._delay_required_column_checks():
242.             folded.remove_column('time')
243.             folded.add_column(folded_time, name='time', index=0)
244. 
245.         return folded
246. 
247.     def __getitem__(self, item):
248.         if self._is_list_or_tuple_of_str(item):
249.             if 'time' not in item:
250.                 out = QTable([self[x] for x in item],
251.                              meta=deepcopy(self.meta),
252.                              copy_indices=self._copy_indices)
253.                 out._groups = groups.TableGroups(out, indices=self.groups._indices,
254.                                                  keys=self.groups._keys)
255.                 return out
256.         return super().__getitem__(item)
257. 
258.     def add_column(self, *args, **kwargs):
259.         """
260.         See :meth:`~astropy.table.Table.add_column`.
261.         """
262.         # Note that the docstring is inherited from QTable
263.         result = super().add_column(*args, **kwargs)
264.         if len(self.indices) == 0 and 'time' in self.colnames:
265.             self.add_index('time')
266.         return result
267. 
268.     def add_columns(self, *args, **kwargs):
269.         """
270.         See :meth:`~astropy.table.Table.add_columns`.
271.         """
272.         # Note that the docstring is inherited from QTable
273.         result = super().add_columns(*args, **kwargs)
274.         if len(self.indices) == 0 and 'time' in self.colnames:
275.             self.add_index('time')
276.         return result
277. 
278.     @classmethod
279.     def from_pandas(self, df, time_scale='utc'):
280.         """
281.         Convert a :class:`~pandas.DataFrame` to a
282.         :class:`astropy.timeseries.TimeSeries`.
283. 
284.         Parameters
285.         ----------
286.         df : :class:`pandas.DataFrame`
287.             A pandas :class:`pandas.DataFrame` instance.
288.         time_scale : str
289.             The time scale to pass into `astropy.time.Time`.
290.             Defaults to ``UTC``.
291. 
292.         """
293.         from pandas import DataFrame, DatetimeIndex
294. 
295.         if not isinstance(df, DataFrame):
296.             raise TypeError("Input should be a pandas DataFrame")
297. 
298.         if not isinstance(df.index, DatetimeIndex):
299.             raise TypeError("DataFrame does not have a DatetimeIndex")
300. 
301.         time = Time(df.index, scale=time_scale)
302.         table = Table.from_pandas(df)
303. 
304.         return TimeSeries(time=time, data=table)
305. 
306.     def to_pandas(self):
307.         """
308.         Convert this :class:`~astropy.timeseries.TimeSeries` to a
309.         :class:`~pandas.DataFrame` with a :class:`~pandas.DatetimeIndex` index.
310. 
311.         Returns
312.         -------
313.         dataframe : :class:`pandas.DataFrame`
314.             A pandas :class:`pandas.DataFrame` instance
315.         """
316.         return Table(self).to_pandas(index='time')
317. 
318.     @classmethod
319.     def read(self, filename, time_column=None, time_format=None, time_scale=None, format=None, *args, **kwargs):
320.         """
321.         Read and parse a file and returns a `astropy.timeseries.TimeSeries`.
322. 
323.         This method uses the unified I/O infrastructure in Astropy which makes
324.         it easy to define readers/writers for various classes
325.         (https://docs.astropy.org/en/stable/io/unified.html). By default, this
326.         method will try and use readers defined specifically for the
327.         `astropy.timeseries.TimeSeries` class - however, it is also
328.         possible to use the ``format`` keyword to specify formats defined for
329.         the `astropy.table.Table` class - in this case, you will need to also
330.         provide the column names for column containing the start times for the
331.         bins, as well as other column names (see the Parameters section below
332.         for details)::
333. 
334.             >>> from astropy.timeseries import TimeSeries
335.             >>> ts = TimeSeries.read('sampled.dat', format='ascii.ecsv',
336.             ...                      time_column='date')  # doctest: +SKIP
337. 
338.         Parameters
339.         ----------
340.         filename : str
341.             File to parse.
342.         format : str
343.             File format specifier.
344.         time_column : str, optional
345.             The name of the time column.
346.         time_format : str, optional
347.             The time format for the time column.
348.         time_scale : str, optional
349.             The time scale for the time column.
350.         *args : tuple, optional
351.             Positional arguments passed through to the data reader.
352.         **kwargs : dict, optional
353.             Keyword arguments passed through to the data reader.
354. 
355.         Returns
356.         -------
357.         out : `astropy.timeseries.sampled.TimeSeries`
358.             TimeSeries corresponding to file contents.
359. 
360.         Notes
361.         -----
362.         """
363.         try:
364. 
365.             # First we try the readers defined for the BinnedTimeSeries class
366.             return super().read(filename, format=format, *args, **kwargs)
367. 
368.         except TypeError:
369. 
370.             # Otherwise we fall back to the default Table readers
371. 
372.             if time_column is None:
373.                 raise ValueError("``time_column`` should be provided since the default Table readers are being used.")
374. 
375.             table = Table.read(filename, format=format, *args, **kwargs)
376. 
377.             if time_column in table.colnames:
378.                 time = Time(table.columns[time_column], scale=time_scale, format=time_format)
379.                 table.remove_column(time_column)
380.             else:
381.                 raise ValueError(f"Time column '{time_column}' not found in the input data.")
382. 
383.             return TimeSeries(time=time, data=table)


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-04 06:07:09,498 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning='This test directly examines the validation logic for required columns in `TimeSeries`, which is the core of the reported bug. It tests various table operations like `remove_column` and `rename_column` and asserts the exact `ValueError` message that the user finds misleading, demonstrating the current state of the validation that needs to be fixed.', relative_path='astropy/timeseries/tests/test_sampled.py', start_line=352, end_line=397), ContextOutput(reasoning="This test case demonstrates the most basic validation check that ensures the 'time' column is the first one added to an empty `TimeSeries`. This is relevant because the bug's misleading error message originates from this fundamental check.", relative_path='astropy/timeseries/tests/test_sampled.py', start_line=32, end_line=39), ContextOutput(reasoning='This test shows that the same required column validation pattern (`time_bin_start` must be the first column) is also implemented for the `BinnedTimeSeries` class. This provides context that the validation logic is a shared design pattern within the `astropy.timeseries` module, and a fix might be applicable to more than just `TimeSeries`.', relative_path='astropy/timeseries/tests/test_binned.py', start_line=23, end_line=32), ContextOutput(reasoning="This test case covers the validation of the time column in a different scenario: reading data from a file. It shows what happens when the specified `time_column` does not exist in the source. The resulting `ValueError` is clear and specific, which serves as a good example of the 'expected behavior' mentioned in the bug report, contrasting with the misleading error from the column removal operation.", relative_path='astropy/timeseries/tests/test_sampled.py', start_line=310, end_line=314), ContextOutput(reasoning='Similar to the previous example, this test demonstrates I/O validation for `BinnedTimeSeries`. It checks for a missing `time_bin_start_column` when reading a file and raises a specific `ValueError`. This reinforces the I/O validation pattern and provides another example of clear error messaging that could be a model for the fix.', relative_path='astropy/timeseries/tests/test_binned.py', start_line=257, end_line=261)]
2025-10-04 06:07:09,499 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='astropy/timeseries/tests/test_sampled.py', content='352. def test_required_columns():\n353. \n354.     # Test the machinery that makes sure that the required columns are present\n355. \n356.     ts = TimeSeries(time=INPUT_TIME,\n357.                     data=[[10, 2, 3], [4, 5, 6]],\n358.                     names=[\'a\', \'b\'])\n359. \n360.     # In the examples below, the operation (e.g. remove_column) is actually\n361.     # carried out before the checks are made, so we need to use copy() so that\n362.     # we don\'t change the main version of the time series.\n363. \n364.     # Make sure copy works fine\n365.     ts.copy()\n366. \n367.     with pytest.raises(ValueError) as exc:\n368.         ts.copy().add_column(Column([3, 4, 5], name=\'c\'), index=0)\n369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n370.                                  "\'time\' as the first column but found \'c\'")\n371. \n372.     with pytest.raises(ValueError) as exc:\n373.         ts.copy().add_columns([Column([3, 4, 5], name=\'d\'),\n374.                                Column([3, 4, 5], name=\'e\')], indexes=[0, 1])\n375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n376.                                  "\'time\' as the first column but found \'d\'")\n377. \n378.     with pytest.raises(ValueError) as exc:\n379.         ts.copy().keep_columns([\'a\', \'b\'])\n380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n381.                                  "\'time\' as the first column but found \'a\'")\n382. \n383.     with pytest.raises(ValueError) as exc:\n384.         ts.copy().remove_column(\'time\')\n385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n386.                                  "\'time\' as the first column but found \'a\'")\n387. \n388.     with pytest.raises(ValueError) as exc:\n389.         ts.copy().remove_columns([\'time\', \'a\'])\n390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n391.                                  "\'time\' as the first column but found \'b\'")\n392. \n393.     with pytest.raises(ValueError) as exc:\n394.         ts.copy().rename_column(\'time\', \'banana\')\n395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n396.                                  "\'time\' as the first column but found \'banana\'")\n397. ', start_line_number=352, end_line_number=397), Context(relative_path='astropy/timeseries/tests/test_sampled.py', content='32. def test_empty_initialization_invalid():\n33.     # Make sure things crash when the first column added is not a time column\n34.     ts = TimeSeries()\n35.     with pytest.raises(ValueError) as exc:\n36.         ts[\'flux\'] = [1, 2, 3]\n37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n38.                                  "\'time\' as the first column but found \'flux\'")\n39. ', start_line_number=32, end_line_number=39), Context(relative_path='astropy/timeseries/tests/test_binned.py', content='23. def test_empty_initialization_invalid():\n24. \n25.     # Make sure things crash when the first column added is not a time column\n26. \n27.     ts = BinnedTimeSeries()\n28.     with pytest.raises(ValueError) as exc:\n29.         ts[\'flux\'] = [1, 2, 3]\n30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "\n31.                                  "\'time_bin_start\' as the first column but found \'flux\'")\n32. ', start_line_number=23, end_line_number=32), Context(relative_path='astropy/timeseries/tests/test_sampled.py', content='310. def test_read_time_wrong():\n311.     with pytest.raises(ValueError) as exc:\n312.         TimeSeries.read(CSV_FILE, time_column=\'abc\', format=\'csv\')\n313.     assert exc.value.args[0] == "Time column \'abc\' not found in the input data."\n314. ', start_line_number=310, end_line_number=314), Context(relative_path='astropy/timeseries/tests/test_binned.py', content='257. def test_read_start_time_missing():\n258.     with pytest.raises(ValueError) as exc:\n259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'abc\', time_bin_size_column=\'bin_size\', time_bin_size_unit=u.second, format=\'csv\')\n260.     assert exc.value.args[0] == "Bin start time column \'abc\' not found in the input data."\n261. ', start_line_number=257, end_line_number=261)]
2025-10-04 06:07:09,500 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 06:07:09,500 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - This is the codebase structure:
--- BEGIN FILE TREE ---
astropy
â”œâ”€â”€ .circleci
|   â””â”€â”€ config.yml
â”œâ”€â”€ .github
|   â”œâ”€â”€ ISSUE_TEMPLATE
|   |   â”œâ”€â”€ bug_report.md
|   |   â””â”€â”€ feature_request.md
|   â”œâ”€â”€ PULL_REQUEST_TEMPLATE.md
|   â”œâ”€â”€ labeler.yml
|   â””â”€â”€ workflows
|       â”œâ”€â”€ cancel_workflows.yml
|       â”œâ”€â”€ check_changelog.yml
|       â”œâ”€â”€ ci_cron_daily.yml
|       â”œâ”€â”€ ci_cron_weekly.yml
|       â”œâ”€â”€ ci_workflows.yml
|       â”œâ”€â”€ codeql-analysis.yml
|       â”œâ”€â”€ open_actions.yml
|       â”œâ”€â”€ stalebot.yml
|       â””â”€â”€ update_iers.yml
â”œâ”€â”€ .pep8speaks.yml
â”œâ”€â”€ .pre-commit-config.yaml
â”œâ”€â”€ .pyinstaller
|   â”œâ”€â”€ hooks
|   |   â””â”€â”€ hook-skyfield.py
|   â””â”€â”€ run_astropy_tests.py
â”œâ”€â”€ .readthedocs.yml
â”œâ”€â”€ CHANGES.rst
â”œâ”€â”€ CODE_OF_CONDUCT.md
â”œâ”€â”€ CONTRIBUTING.md
â”œâ”€â”€ GOVERNANCE.md
â”œâ”€â”€ LICENSE.rst
â”œâ”€â”€ README.rst
â”œâ”€â”€ astropy
|   â”œâ”€â”€ __init__.py
|   â”œâ”€â”€ _dev
|   |   â”œâ”€â”€ __init__.py
|   |   â””â”€â”€ scm_version.py
|   â”œâ”€â”€ _erfa
|   |   â””â”€â”€ __init__.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ affiliated.py
|   |   â”œâ”€â”€ configuration.py
|   |   â”œâ”€â”€ paths.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â””â”€â”€ test_configs.py
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ astropyconst13.py
|   |   â”œâ”€â”€ astropyconst20.py
|   |   â”œâ”€â”€ astropyconst40.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ codata2010.py
|   |   â”œâ”€â”€ codata2014.py
|   |   â”œâ”€â”€ codata2018.py
|   |   â”œâ”€â”€ config.py
|   |   â”œâ”€â”€ constant.py
|   |   â”œâ”€â”€ iau2012.py
|   |   â”œâ”€â”€ iau2015.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_constant.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_prior_version.py
|   |   |   â””â”€â”€ test_sciencestate.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ convolve.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ kernels.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ convolve.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_convolve.py
|   |   |   â”œâ”€â”€ test_convolve_fft.py
|   |   |   â”œâ”€â”€ test_convolve_kernels.py
|   |   |   â”œâ”€â”€ test_convolve_models.py
|   |   |   â”œâ”€â”€ test_convolve_nddata.py
|   |   |   â”œâ”€â”€ test_convolve_speeds.py
|   |   |   â”œâ”€â”€ test_discretize.py
|   |   |   â”œâ”€â”€ test_kernel_class.py
|   |   |   â””â”€â”€ test_pickle.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ angle_formats.py
|   |   â”œâ”€â”€ angle_lextab.py
|   |   â”œâ”€â”€ angle_parsetab.py
|   |   â”œâ”€â”€ angle_utilities.py
|   |   â”œâ”€â”€ angles.py
|   |   â”œâ”€â”€ attributes.py
|   |   â”œâ”€â”€ baseframe.py
|   |   â”œâ”€â”€ builtin_frames
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ altaz.py
|   |   |   â”œâ”€â”€ baseradec.py
|   |   |   â”œâ”€â”€ cirs.py
|   |   |   â”œâ”€â”€ cirs_observed_transforms.py
|   |   |   â”œâ”€â”€ ecliptic.py
|   |   |   â”œâ”€â”€ ecliptic_transforms.py
|   |   |   â”œâ”€â”€ equatorial.py
|   |   |   â”œâ”€â”€ fk4.py
|   |   |   â”œâ”€â”€ fk4_fk5_transforms.py
|   |   |   â”œâ”€â”€ fk5.py
|   |   |   â”œâ”€â”€ galactic.py
|   |   |   â”œâ”€â”€ galactic_transforms.py
|   |   |   â”œâ”€â”€ galactocentric.py
|   |   |   â”œâ”€â”€ gcrs.py
|   |   |   â”œâ”€â”€ hadec.py
|   |   |   â”œâ”€â”€ hcrs.py
|   |   |   â”œâ”€â”€ icrs.py
|   |   |   â”œâ”€â”€ icrs_cirs_transforms.py
|   |   |   â”œâ”€â”€ icrs_fk5_transforms.py
|   |   |   â”œâ”€â”€ icrs_observed_transforms.py
|   |   |   â”œâ”€â”€ intermediate_rotation_transforms.py
|   |   |   â”œâ”€â”€ itrs.py
|   |   |   â”œâ”€â”€ lsr.py
|   |   |   â”œâ”€â”€ skyoffset.py
|   |   |   â”œâ”€â”€ supergalactic.py
|   |   |   â”œâ”€â”€ supergalactic_transforms.py
|   |   |   â””â”€â”€ utils.py
|   |   â”œâ”€â”€ calculation.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ distances.py
|   |   â”œâ”€â”€ earth.py
|   |   â”œâ”€â”€ earth_orientation.py
|   |   â”œâ”€â”€ erfa_astrom.py
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ jparser.py
|   |   â”œâ”€â”€ matching.py
|   |   â”œâ”€â”€ matrix_utilities.py
|   |   â”œâ”€â”€ name_resolve.py
|   |   â”œâ”€â”€ orbital_elements.py
|   |   â”œâ”€â”€ representation.py
|   |   â”œâ”€â”€ sites.py
|   |   â”œâ”€â”€ sky_coordinate.py
|   |   â”œâ”€â”€ sky_coordinate_parsers.py
|   |   â”œâ”€â”€ solar_system.py
|   |   â”œâ”€â”€ spectral_coordinate.py
|   |   â”œâ”€â”€ spectral_quantity.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ accuracy
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ generate_ref_ast.py
|   |   |   |   â”œâ”€â”€ generate_spectralcoord_ref.py
|   |   |   |   â”œâ”€â”€ test_altaz_icrs.py
|   |   |   |   â”œâ”€â”€ test_ecliptic.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk4.py
|   |   |   |   â”œâ”€â”€ test_fk4_no_e_fk5.py
|   |   |   |   â”œâ”€â”€ test_galactic_fk4.py
|   |   |   |   â””â”€â”€ test_icrs_fk5.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_angle_generators.py
|   |   |   â”œâ”€â”€ test_angles.py
|   |   |   â”œâ”€â”€ test_angular_separation.py
|   |   |   â”œâ”€â”€ test_api_ape5.py
|   |   |   â”œâ”€â”€ test_arrays.py
|   |   |   â”œâ”€â”€ test_atc_replacements.py
|   |   |   â”œâ”€â”€ test_celestial_transformations.py
|   |   |   â”œâ”€â”€ test_distance.py
|   |   |   â”œâ”€â”€ test_earth.py
|   |   |   â”œâ”€â”€ test_erfa_astrom.py
|   |   |   â”œâ”€â”€ test_finite_difference_velocities.py
|   |   |   â”œâ”€â”€ test_formatting.py
|   |   |   â”œâ”€â”€ test_frames.py
|   |   |   â”œâ”€â”€ test_frames_with_velocity.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_geodetic_representations.py
|   |   |   â”œâ”€â”€ test_iau_fullstack.py
|   |   |   â”œâ”€â”€ test_icrs_observed_transformations.py
|   |   |   â”œâ”€â”€ test_intermediate_transformations.py
|   |   |   â”œâ”€â”€ test_matching.py
|   |   |   â”œâ”€â”€ test_matrix_utilities.py
|   |   |   â”œâ”€â”€ test_name_resolve.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_regression.py
|   |   |   â”œâ”€â”€ test_representation.py
|   |   |   â”œâ”€â”€ test_representation_arithmetic.py
|   |   |   â”œâ”€â”€ test_representation_methods.py
|   |   |   â”œâ”€â”€ test_shape_manipulation.py
|   |   |   â”œâ”€â”€ test_sites.py
|   |   |   â”œâ”€â”€ test_sky_coord.py
|   |   |   â”œâ”€â”€ test_sky_coord_velocities.py
|   |   |   â”œâ”€â”€ test_skyoffset_transformations.py
|   |   |   â”œâ”€â”€ test_solar_system.py
|   |   |   â”œâ”€â”€ test_spectral_coordinate.py
|   |   |   â”œâ”€â”€ test_spectral_quantity.py
|   |   |   â”œâ”€â”€ test_transformations.py
|   |   |   â”œâ”€â”€ test_unit_representation.py
|   |   |   â”œâ”€â”€ test_utils.py
|   |   |   â””â”€â”€ test_velocity_corrs.py
|   |   â””â”€â”€ transformations.py
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ flrw
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ lambdacdm.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ test_base.py
|   |   |   |   â”œâ”€â”€ test_lambdacdm.py
|   |   |   |   â”œâ”€â”€ test_w0cdm.py
|   |   |   |   â”œâ”€â”€ test_w0wacdm.py
|   |   |   |   â”œâ”€â”€ test_w0wzcdm.py
|   |   |   |   â””â”€â”€ test_wpwazpcdm.py
|   |   |   â”œâ”€â”€ w0cdm.py
|   |   |   â”œâ”€â”€ w0wacdm.py
|   |   |   â”œâ”€â”€ w0wzcdm.py
|   |   |   â””â”€â”€ wpwazpcdm.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ cosmology.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ mapping.py
|   |   |   â”œâ”€â”€ model.py
|   |   |   â”œâ”€â”€ row.py
|   |   |   â”œâ”€â”€ table.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_json.py
|   |   |   |   â”œâ”€â”€ test_mapping.py
|   |   |   |   â”œâ”€â”€ test_model.py
|   |   |   |   â”œâ”€â”€ test_row.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ parameter.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ realizations.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ conftest.py
|   |   |   â”œâ”€â”€ helper.py
|   |   |   â”œâ”€â”€ test_connect.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_cosmology.py
|   |   |   â”œâ”€â”€ test_funcs.py
|   |   |   â”œâ”€â”€ test_parameter.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_realizations.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _strptime.py
|   |   â”œâ”€â”€ configobj
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ configobj.py
|   |   |   â””â”€â”€ validate.py
|   |   â”œâ”€â”€ jquery
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ data
|   |   |       â”œâ”€â”€ css
|   |   |       â”œâ”€â”€ images
|   |   |       â””â”€â”€ js
|   |   â””â”€â”€ ply
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ cpp.py
|   |       â”œâ”€â”€ ctokens.py
|   |       â”œâ”€â”€ lex.py
|   |       â”œâ”€â”€ yacc.py
|   |       â””â”€â”€ ygen.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ basic.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ daophot.py
|   |   |   â”œâ”€â”€ docs.py
|   |   |   â”œâ”€â”€ ecsv.py
|   |   |   â”œâ”€â”€ fastbasic.py
|   |   |   â”œâ”€â”€ fixedwidth.py
|   |   |   â”œâ”€â”€ html.py
|   |   |   â”œâ”€â”€ ipac.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ mrt.py
|   |   |   â”œâ”€â”€ qdp.py
|   |   |   â”œâ”€â”€ rst.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ sextractor.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ common.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_c_reader.py
|   |   |   |   â”œâ”€â”€ test_cds.py
|   |   |   |   â”œâ”€â”€ test_cds_header_from_readme.py
|   |   |   |   â”œâ”€â”€ test_compressed.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_ecsv.py
|   |   |   |   â”œâ”€â”€ test_fixedwidth.py
|   |   |   |   â”œâ”€â”€ test_html.py
|   |   |   |   â”œâ”€â”€ test_ipac_definitions.py
|   |   |   |   â”œâ”€â”€ test_qdp.py
|   |   |   |   â”œâ”€â”€ test_read.py
|   |   |   |   â”œâ”€â”€ test_rst.py
|   |   |   |   â”œâ”€â”€ test_types.py
|   |   |   |   â””â”€â”€ test_write.py
|   |   |   â””â”€â”€ ui.py
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ card.py
|   |   |   â”œâ”€â”€ column.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ convenience.py
|   |   |   â”œâ”€â”€ diff.py
|   |   |   â”œâ”€â”€ file.py
|   |   |   â”œâ”€â”€ fitsrec.py
|   |   |   â”œâ”€â”€ fitstime.py
|   |   |   â”œâ”€â”€ hdu
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ base.py
|   |   |   |   â”œâ”€â”€ compressed.py
|   |   |   |   â”œâ”€â”€ groups.py
|   |   |   |   â”œâ”€â”€ hdulist.py
|   |   |   |   â”œâ”€â”€ image.py
|   |   |   |   â”œâ”€â”€ nonstandard.py
|   |   |   |   â”œâ”€â”€ streaming.py
|   |   |   |   â””â”€â”€ table.py
|   |   |   â”œâ”€â”€ header.py
|   |   |   â”œâ”€â”€ scripts
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ fitscheck.py
|   |   |   |   â”œâ”€â”€ fitsdiff.py
|   |   |   |   â”œâ”€â”€ fitsheader.py
|   |   |   |   â””â”€â”€ fitsinfo.py
|   |   |   â”œâ”€â”€ setup_package.py
|   |   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_checksum.py
|   |   |   |   â”œâ”€â”€ test_compression_failures.py
|   |   |   |   â”œâ”€â”€ test_connect.py
|   |   |   |   â”œâ”€â”€ test_convenience.py
|   |   |   |   â”œâ”€â”€ test_core.py
|   |   |   |   â”œâ”€â”€ test_diff.py
|   |   |   |   â”œâ”€â”€ test_division.py
|   |   |   |   â”œâ”€â”€ test_fitscheck.py
|   |   |   |   â”œâ”€â”€ test_fitsdiff.py
|   |   |   |   â”œâ”€â”€ test_fitsheader.py
|   |   |   |   â”œâ”€â”€ test_fitsinfo.py
|   |   |   |   â”œâ”€â”€ test_fitstime.py
|   |   |   |   â”œâ”€â”€ test_groups.py
|   |   |   |   â”œâ”€â”€ test_hdulist.py
|   |   |   |   â”œâ”€â”€ test_header.py
|   |   |   |   â”œâ”€â”€ test_image.py
|   |   |   |   â”œâ”€â”€ test_image_dask.py
|   |   |   |   â”œâ”€â”€ test_nonstandard.py
|   |   |   |   â”œâ”€â”€ test_structured.py
|   |   |   |   â”œâ”€â”€ test_table.py
|   |   |   |   â”œâ”€â”€ test_uint.py
|   |   |   |   â””â”€â”€ test_util.py
|   |   |   â”œâ”€â”€ util.py
|   |   |   â””â”€â”€ verify.py
|   |   â”œâ”€â”€ misc
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ asdf
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ conftest.py
|   |   |   |   â”œâ”€â”€ connect.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ deprecation.py
|   |   |   |   â”œâ”€â”€ extension.py
|   |   |   |   â”œâ”€â”€ tags
|   |   |   |   â”œâ”€â”€ tests
|   |   |   |   â””â”€â”€ types.py
|   |   |   â”œâ”€â”€ connect.py
|   |   |   â”œâ”€â”€ hdf5.py
|   |   |   â”œâ”€â”€ pandas
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ connect.py
|   |   |   â”œâ”€â”€ parquet.py
|   |   |   â”œâ”€â”€ pickle_helpers.py
|   |   |   â”œâ”€â”€ tests
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ test_hdf5.py
|   |   |   |   â”œâ”€â”€ test_pandas.py
|   |   |   |   â”œâ”€â”€ test_parquet.py
|   |   |   |   â”œâ”€â”€ test_pickle_helpers.py
|   |   |   |   â””â”€â”€ test_yaml.py
|   |   |   â””â”€â”€ yaml.py
|   |   â”œâ”€â”€ registry
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ compat.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ interface.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_registries.py
|   |   |       â””â”€â”€ test_registry_help.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ mixin_columns.py
|   |   |   â””â”€â”€ safeio.py
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ connect.py
|   |       â”œâ”€â”€ converters.py
|   |       â”œâ”€â”€ data
|   |       |   â””â”€â”€ ucd1p-words.txt
|   |       â”œâ”€â”€ exceptions.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ tablewriter.c
|   |       â”œâ”€â”€ table.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ converter_test.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ exception_test.py
|   |       |   â”œâ”€â”€ resource_test.py
|   |       |   â”œâ”€â”€ table_test.py
|   |       |   â”œâ”€â”€ tree_test.py
|   |       |   â”œâ”€â”€ ucd_test.py
|   |       |   â”œâ”€â”€ util_test.py
|   |       |   â””â”€â”€ vo_test.py
|   |       â”œâ”€â”€ tree.py
|   |       â”œâ”€â”€ ucd.py
|   |       â”œâ”€â”€ util.py
|   |       â”œâ”€â”€ validator
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ html.py
|   |       |   â”œâ”€â”€ main.py
|   |       |   â””â”€â”€ result.py
|   |       â”œâ”€â”€ volint.py
|   |       â””â”€â”€ xmlutil.py
|   â”œâ”€â”€ logger.py
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bounding_box.py
|   |   â”œâ”€â”€ convolution.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ fitting.py
|   |   â”œâ”€â”€ functional_models.py
|   |   â”œâ”€â”€ mappings.py
|   |   â”œâ”€â”€ math_functions.py
|   |   â”œâ”€â”€ models.py
|   |   â”œâ”€â”€ optimizers.py
|   |   â”œâ”€â”€ parameters.py
|   |   â”œâ”€â”€ physical_models.py
|   |   â”œâ”€â”€ polynomial.py
|   |   â”œâ”€â”€ powerlaws.py
|   |   â”œâ”€â”€ projections.py
|   |   â”œâ”€â”€ rotations.py
|   |   â”œâ”€â”€ separable.py
|   |   â”œâ”€â”€ spline.py
|   |   â”œâ”€â”€ statistic.py
|   |   â”œâ”€â”€ tabular.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â””â”€â”€ spec.txt
|   |   |   â”œâ”€â”€ example_models.py
|   |   |   â”œâ”€â”€ irafutil.py
|   |   |   â”œâ”€â”€ test_bounding_box.py
|   |   |   â”œâ”€â”€ test_compound.py
|   |   |   â”œâ”€â”€ test_constraints.py
|   |   |   â”œâ”€â”€ test_convolution.py
|   |   |   â”œâ”€â”€ test_core.py
|   |   |   â”œâ”€â”€ test_fitters.py
|   |   |   â”œâ”€â”€ test_functional_models.py
|   |   |   â”œâ”€â”€ test_input.py
|   |   |   â”œâ”€â”€ test_mappings.py
|   |   |   â”œâ”€â”€ test_math_func.py
|   |   |   â”œâ”€â”€ test_model_sets.py
|   |   |   â”œâ”€â”€ test_models.py
|   |   |   â”œâ”€â”€ test_models_quantities.py
|   |   |   â”œâ”€â”€ test_parameters.py
|   |   |   â”œâ”€â”€ test_physical_models.py
|   |   |   â”œâ”€â”€ test_polynomial.py
|   |   |   â”œâ”€â”€ test_projections.py
|   |   |   â”œâ”€â”€ test_quantities_evaluation.py
|   |   |   â”œâ”€â”€ test_quantities_fitting.py
|   |   |   â”œâ”€â”€ test_quantities_model.py
|   |   |   â”œâ”€â”€ test_quantities_parameters.py
|   |   |   â”œâ”€â”€ test_quantities_rotations.py
|   |   |   â”œâ”€â”€ test_rotations.py
|   |   |   â”œâ”€â”€ test_separable.py
|   |   |   â”œâ”€â”€ test_spline.py
|   |   |   â”œâ”€â”€ test_statistics.py
|   |   |   â”œâ”€â”€ test_units_mapping.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _testing.py
|   |   â”œâ”€â”€ bitmask.py
|   |   â”œâ”€â”€ blocks.py
|   |   â”œâ”€â”€ ccddata.py
|   |   â”œâ”€â”€ compat.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ flag_collection.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ ndarithmetic.py
|   |   |   â”œâ”€â”€ ndio.py
|   |   |   â”œâ”€â”€ ndslicing.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_ndarithmetic.py
|   |   |       â”œâ”€â”€ test_ndio.py
|   |   |       â””â”€â”€ test_ndslicing.py
|   |   â”œâ”€â”€ nddata.py
|   |   â”œâ”€â”€ nddata_base.py
|   |   â”œâ”€â”€ nddata_withmixins.py
|   |   â”œâ”€â”€ nduncertainty.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   â”œâ”€â”€ test_bitmask.py
|   |   |   â”œâ”€â”€ test_blocks.py
|   |   |   â”œâ”€â”€ test_ccddata.py
|   |   |   â”œâ”€â”€ test_compat.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_flag_collection.py
|   |   |   â”œâ”€â”€ test_nddata.py
|   |   |   â”œâ”€â”€ test_nddata_base.py
|   |   |   â”œâ”€â”€ test_nduncertainty.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ client.py
|   |   â”œâ”€â”€ constants.py
|   |   â”œâ”€â”€ data
|   |   â”œâ”€â”€ errors.py
|   |   â”œâ”€â”€ hub.py
|   |   â”œâ”€â”€ hub_proxy.py
|   |   â”œâ”€â”€ hub_script.py
|   |   â”œâ”€â”€ integrated_client.py
|   |   â”œâ”€â”€ lockfile_helpers.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ standard_profile.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_client.py
|   |   |   â”œâ”€â”€ test_errors.py
|   |   |   â”œâ”€â”€ test_helpers.py
|   |   |   â”œâ”€â”€ test_hub.py
|   |   |   â”œâ”€â”€ test_hub_proxy.py
|   |   |   â”œâ”€â”€ test_hub_script.py
|   |   |   â”œâ”€â”€ test_standard_profile.py
|   |   |   â”œâ”€â”€ test_web_profile.py
|   |   |   â””â”€â”€ web_profile_test_helpers.py
|   |   â”œâ”€â”€ utils.py
|   |   â””â”€â”€ web_profile.py
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bayesian_blocks.py
|   |   â”œâ”€â”€ biweight.py
|   |   â”œâ”€â”€ bls
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ circstats.py
|   |   â”œâ”€â”€ funcs.py
|   |   â”œâ”€â”€ histogram.py
|   |   â”œâ”€â”€ info_theory.py
|   |   â”œâ”€â”€ jackknife.py
|   |   â”œâ”€â”€ lombscargle
|   |   |   â””â”€â”€ __init__.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ sigma_clipping.py
|   |   â”œâ”€â”€ spatial.py
|   |   â”œâ”€â”€ src
|   |   |   â”œâ”€â”€ compute_bounds.c
|   |   |   â”œâ”€â”€ fast_sigma_clip.c
|   |   |   â””â”€â”€ wirth_select.c
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_bayesian_blocks.py
|   |       â”œâ”€â”€ test_biweight.py
|   |       â”œâ”€â”€ test_circstats.py
|   |       â”œâ”€â”€ test_funcs.py
|   |       â”œâ”€â”€ test_histogram.py
|   |       â”œâ”€â”€ test_info_theory.py
|   |       â”œâ”€â”€ test_jackknife.py
|   |       â”œâ”€â”€ test_sigma_clipping.py
|   |       â””â”€â”€ test_spatial.py
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ bst.py
|   |   â”œâ”€â”€ column.py
|   |   â”œâ”€â”€ connect.py
|   |   â”œâ”€â”€ groups.py
|   |   â”œâ”€â”€ index.py
|   |   â”œâ”€â”€ info.py
|   |   â”œâ”€â”€ jsviewer.py
|   |   â”œâ”€â”€ meta.py
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ dask.py
|   |   |   â”œâ”€â”€ registry.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_dask.py
|   |   |       â””â”€â”€ test_registry.py
|   |   â”œâ”€â”€ ndarray_mixin.py
|   |   â”œâ”€â”€ np_utils.py
|   |   â”œâ”€â”€ operations.py
|   |   â”œâ”€â”€ pandas.py
|   |   â”œâ”€â”€ pprint.py
|   |   â”œâ”€â”€ row.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â””â”€â”€ showtable.py
|   |   â”œâ”€â”€ serialize.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ soco.py
|   |   â”œâ”€â”€ sorted_array.py
|   |   â”œâ”€â”€ table.py
|   |   â”œâ”€â”€ table_helpers.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ conftest.py
|   |       â”œâ”€â”€ test_array.py
|   |       â”œâ”€â”€ test_bst.py
|   |       â”œâ”€â”€ test_column.py
|   |       â”œâ”€â”€ test_groups.py
|   |       â”œâ”€â”€ test_index.py
|   |       â”œâ”€â”€ test_info.py
|   |       â”œâ”€â”€ test_init_table.py
|   |       â”œâ”€â”€ test_item_access.py
|   |       â”œâ”€â”€ test_jsviewer.py
|   |       â”œâ”€â”€ test_masked.py
|   |       â”œâ”€â”€ test_mixin.py
|   |       â”œâ”€â”€ test_np_utils.py
|   |       â”œâ”€â”€ test_operations.py
|   |       â”œâ”€â”€ test_pickle.py
|   |       â”œâ”€â”€ test_pprint.py
|   |       â”œâ”€â”€ test_row.py
|   |       â”œâ”€â”€ test_showtable.py
|   |       â”œâ”€â”€ test_subclass.py
|   |       â””â”€â”€ test_table.py
|   â”œâ”€â”€ tests
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ command.py
|   |   â”œâ”€â”€ helper.py
|   |   â”œâ”€â”€ image_tests.py
|   |   â”œâ”€â”€ runner.py
|   |   â”œâ”€â”€ test_logger.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ test_imports.py
|   |       â”œâ”€â”€ test_quantity_helpers.py
|   |       â”œâ”€â”€ test_run_tests.py
|   |       â””â”€â”€ test_runner.py
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ formats.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ parse_times.c
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_basic.py
|   |   |   â”œâ”€â”€ test_comparisons.py
|   |   |   â”œâ”€â”€ test_corrs.py
|   |   |   â”œâ”€â”€ test_custom_formats.py
|   |   |   â”œâ”€â”€ test_delta.py
|   |   |   â”œâ”€â”€ test_fast_parser.py
|   |   |   â”œâ”€â”€ test_functions.py
|   |   |   â”œâ”€â”€ test_guess.py
|   |   |   â”œâ”€â”€ test_mask.py
|   |   |   â”œâ”€â”€ test_methods.py
|   |   |   â”œâ”€â”€ test_pickle.py
|   |   |   â”œâ”€â”€ test_precision.py
|   |   |   â”œâ”€â”€ test_quantity_interaction.py
|   |   |   â”œâ”€â”€ test_sidereal.py
|   |   |   â”œâ”€â”€ test_update_leap_seconds.py
|   |   |   â””â”€â”€ test_ut1.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ binned.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ downsample.py
|   |   â”œâ”€â”€ io
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ kepler.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_kepler.py
|   |   â”œâ”€â”€ periodograms
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ bls
|   |   |   |   â”œâ”€â”€ __init__.py
|   |   |   |   â”œâ”€â”€ core.py
|   |   |   |   â”œâ”€â”€ methods.py
|   |   |   |   â”œâ”€â”€ setup_package.py
|   |   |   |   â””â”€â”€ tests
|   |   |   â””â”€â”€ lombscargle
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ _statistics.py
|   |   |       â”œâ”€â”€ core.py
|   |   |       â”œâ”€â”€ implementations
|   |   |       â”œâ”€â”€ tests
|   |   |       â””â”€â”€ utils.py
|   |   â”œâ”€â”€ sampled.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ data
|   |       â”œâ”€â”€ test_binned.py
|   |       â”œâ”€â”€ test_common.py
|   |       â”œâ”€â”€ test_downsample.py
|   |       â””â”€â”€ test_sampled.py
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ distributions.py
|   |   â””â”€â”€ tests
|   |       â”œâ”€â”€ __init__.py
|   |       â””â”€â”€ test_distribution.py
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ _typing.py
|   |   â”œâ”€â”€ astrophys.py
|   |   â”œâ”€â”€ cds.py
|   |   â”œâ”€â”€ cgs.py
|   |   â”œâ”€â”€ core.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ deprecated.py
|   |   â”œâ”€â”€ equivalencies.py
|   |   â”œâ”€â”€ format
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ base.py
|   |   |   â”œâ”€â”€ cds.py
|   |   |   â”œâ”€â”€ cds_lextab.py
|   |   |   â”œâ”€â”€ cds_parsetab.py
|   |   |   â”œâ”€â”€ console.py
|   |   |   â”œâ”€â”€ fits.py
|   |   |   â”œâ”€â”€ generic.py
|   |   |   â”œâ”€â”€ generic_lextab.py
|   |   |   â”œâ”€â”€ generic_parsetab.py
|   |   |   â”œâ”€â”€ latex.py
|   |   |   â”œâ”€â”€ ogip.py
|   |   |   â”œâ”€â”€ ogip_lextab.py
|   |   |   â”œâ”€â”€ ogip_parsetab.py
|   |   |   â”œâ”€â”€ unicode_format.py
|   |   |   â”œâ”€â”€ utils.py
|   |   |   â””â”€â”€ vounit.py
|   |   â”œâ”€â”€ function
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ logarithmic.py
|   |   |   â”œâ”€â”€ mixin.py
|   |   |   â””â”€â”€ units.py
|   |   â”œâ”€â”€ imperial.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ photometric.py
|   |   â”œâ”€â”€ physical.py
|   |   â”œâ”€â”€ quantity.py
|   |   â”œâ”€â”€ quantity_helper
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ converters.py
|   |   |   â”œâ”€â”€ erfa.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â”œâ”€â”€ helpers.py
|   |   |   â””â”€â”€ scipy_special.py
|   |   â”œâ”€â”€ required_by_vounit.py
|   |   â”œâ”€â”€ si.py
|   |   â”œâ”€â”€ structured.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_aliases.py
|   |   |   â”œâ”€â”€ test_deprecated.py
|   |   |   â”œâ”€â”€ test_equivalencies.py
|   |   |   â”œâ”€â”€ test_format.py
|   |   |   â”œâ”€â”€ test_logarithmic.py
|   |   |   â”œâ”€â”€ test_photometric.py
|   |   |   â”œâ”€â”€ test_physical.py
|   |   |   â”œâ”€â”€ test_quantity.py
|   |   |   â”œâ”€â”€ test_quantity_annotations.py
|   |   |   â”œâ”€â”€ test_quantity_array_methods.py
|   |   |   â”œâ”€â”€ test_quantity_decorator.py
|   |   |   â”œâ”€â”€ test_quantity_helpers.py
|   |   |   â”œâ”€â”€ test_quantity_non_ufuncs.py
|   |   |   â”œâ”€â”€ test_quantity_typing.py
|   |   |   â”œâ”€â”€ test_quantity_ufuncs.py
|   |   |   â”œâ”€â”€ test_structured.py
|   |   |   â”œâ”€â”€ test_structured_erfa_ufuncs.py
|   |   |   â”œâ”€â”€ test_units.py
|   |   |   â””â”€â”€ test_utils.py
|   |   â””â”€â”€ utils.py
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ argparse.py
|   |   â”œâ”€â”€ codegen.py
|   |   â”œâ”€â”€ collections.py
|   |   â”œâ”€â”€ compat
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ misc.py
|   |   |   â”œâ”€â”€ numpycompat.py
|   |   |   â””â”€â”€ optional_deps.py
|   |   â”œâ”€â”€ console.py
|   |   â”œâ”€â”€ data.py
|   |   â”œâ”€â”€ data_info.py
|   |   â”œâ”€â”€ decorators.py
|   |   â”œâ”€â”€ diff.py
|   |   â”œâ”€â”€ exceptions.py
|   |   â”œâ”€â”€ iers
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â””â”€â”€ update_builtin_iers.sh
|   |   |   â”œâ”€â”€ iers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ data
|   |   |       â”œâ”€â”€ test_iers.py
|   |   |       â””â”€â”€ test_leap_second.py
|   |   â”œâ”€â”€ introspection.py
|   |   â”œâ”€â”€ masked
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ core.py
|   |   |   â”œâ”€â”€ function_helpers.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â”œâ”€â”€ test_containers.py
|   |   |       â”œâ”€â”€ test_function_helpers.py
|   |   |       â”œâ”€â”€ test_functions.py
|   |   |       â”œâ”€â”€ test_masked.py
|   |   |       â””â”€â”€ test_table.py
|   |   â”œâ”€â”€ metadata.py
|   |   â”œâ”€â”€ misc.py
|   |   â”œâ”€â”€ parsing.py
|   |   â”œâ”€â”€ setup_package.py
|   |   â”œâ”€â”€ shapes.py
|   |   â”œâ”€â”€ src
|   |   |   â””â”€â”€ compiler.c
|   |   â”œâ”€â”€ state.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ data
|   |   |   |   â”œâ”€â”€ .hidden_file.txt
|   |   |   |   â”œâ”€â”€ dataurl
|   |   |   |   â”œâ”€â”€ dataurl_mirror
|   |   |   |   â”œâ”€â”€ test_package
|   |   |   |   â””â”€â”€ unicode.txt
|   |   |   â”œâ”€â”€ test_codegen.py
|   |   |   â”œâ”€â”€ test_collections.py
|   |   |   â”œâ”€â”€ test_console.py
|   |   |   â”œâ”€â”€ test_data.py
|   |   |   â”œâ”€â”€ test_data_info.py
|   |   |   â”œâ”€â”€ test_decorators.py
|   |   |   â”œâ”€â”€ test_diff.py
|   |   |   â”œâ”€â”€ test_introspection.py
|   |   |   â”œâ”€â”€ test_metadata.py
|   |   |   â”œâ”€â”€ test_misc.py
|   |   |   â”œâ”€â”€ test_parsing.py
|   |   |   â”œâ”€â”€ test_progress_bar_func.py
|   |   |   â”œâ”€â”€ test_shapes.py
|   |   |   â”œâ”€â”€ test_state.py
|   |   |   â””â”€â”€ test_xml.py
|   |   â””â”€â”€ xml
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ check.py
|   |       â”œâ”€â”€ iterparser.py
|   |       â”œâ”€â”€ setup_package.py
|   |       â”œâ”€â”€ src
|   |       |   â””â”€â”€ iterparse.c
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â””â”€â”€ test_iterparse.py
|   |       â”œâ”€â”€ unescaper.py
|   |       â”œâ”€â”€ validate.py
|   |       â””â”€â”€ writer.py
|   â”œâ”€â”€ version.py
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ __init__.py
|   |   â”œâ”€â”€ hist.py
|   |   â”œâ”€â”€ interval.py
|   |   â”œâ”€â”€ lupton_rgb.py
|   |   â”œâ”€â”€ mpl_normalize.py
|   |   â”œâ”€â”€ mpl_style.py
|   |   â”œâ”€â”€ scripts
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ fits2bitmap.py
|   |   |   â””â”€â”€ tests
|   |   |       â”œâ”€â”€ __init__.py
|   |   |       â””â”€â”€ test_fits2bitmap.py
|   |   â”œâ”€â”€ stretch.py
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ __init__.py
|   |   |   â”œâ”€â”€ test_histogram.py
|   |   |   â”œâ”€â”€ test_interval.py
|   |   |   â”œâ”€â”€ test_lupton_rgb.py
|   |   |   â”œâ”€â”€ test_norm.py
|   |   |   â”œâ”€â”€ test_stretch.py
|   |   |   â”œâ”€â”€ test_time.py
|   |   |   â””â”€â”€ test_units.py
|   |   â”œâ”€â”€ time.py
|   |   â”œâ”€â”€ transform.py
|   |   â”œâ”€â”€ units.py
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ __init__.py
|   |       â”œâ”€â”€ axislabels.py
|   |       â”œâ”€â”€ coordinate_helpers.py
|   |       â”œâ”€â”€ coordinate_range.py
|   |       â”œâ”€â”€ coordinates_map.py
|   |       â”œâ”€â”€ core.py
|   |       â”œâ”€â”€ formatter_locator.py
|   |       â”œâ”€â”€ frame.py
|   |       â”œâ”€â”€ grid_paths.py
|   |       â”œâ”€â”€ patches.py
|   |       â”œâ”€â”€ tests
|   |       |   â”œâ”€â”€ __init__.py
|   |       |   â”œâ”€â”€ data
|   |       |   â”œâ”€â”€ test_coordinate_helpers.py
|   |       |   â”œâ”€â”€ test_display_world_coordinates.py
|   |       |   â”œâ”€â”€ test_formatter_locator.py
|   |       |   â”œâ”€â”€ test_frame.py
|   |       |   â”œâ”€â”€ test_grid_paths.py
|   |       |   â”œâ”€â”€ test_images.py
|   |       |   â”œâ”€â”€ test_misc.py
|   |       |   â”œâ”€â”€ test_transform_coord_meta.py
|   |       |   â”œâ”€â”€ test_transforms.py
|   |       |   â”œâ”€â”€ test_utils.py
|   |       |   â””â”€â”€ test_wcsapi.py
|   |       â”œâ”€â”€ ticklabels.py
|   |       â”œâ”€â”€ ticks.py
|   |       â”œâ”€â”€ transforms.py
|   |       â”œâ”€â”€ utils.py
|   |       â””â”€â”€ wcsapi.py
|   â””â”€â”€ wcs
|       â”œâ”€â”€ __init__.py
|       â”œâ”€â”€ docstrings.py
|       â”œâ”€â”€ include
|       |   â”œâ”€â”€ astropy_wcs
|       |   â””â”€â”€ wcslib
|       â”œâ”€â”€ setup_package.py
|       â”œâ”€â”€ src
|       |   â”œâ”€â”€ astropy_wcs.c
|       |   â”œâ”€â”€ astropy_wcs_api.c
|       |   â”œâ”€â”€ distortion.c
|       |   â”œâ”€â”€ distortion_wrap.c
|       |   â”œâ”€â”€ pipeline.c
|       |   â”œâ”€â”€ pyutil.c
|       |   â”œâ”€â”€ sip.c
|       |   â”œâ”€â”€ sip_wrap.c
|       |   â”œâ”€â”€ str_list_proxy.c
|       |   â”œâ”€â”€ unit_list_proxy.c
|       |   â”œâ”€â”€ util.c
|       |   â”œâ”€â”€ wcslib_auxprm_wrap.c
|       |   â”œâ”€â”€ wcslib_celprm_wrap.c
|       |   â”œâ”€â”€ wcslib_prjprm_wrap.c
|       |   â”œâ”€â”€ wcslib_tabprm_wrap.c
|       |   â”œâ”€â”€ wcslib_wrap.c
|       |   â””â”€â”€ wcslib_wtbarr_wrap.c
|       â”œâ”€â”€ tests
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â”œâ”€â”€ maps
|       |   |   â”œâ”€â”€ spectra
|       |   |   â”œâ”€â”€ validate.5.0.txt
|       |   |   â”œâ”€â”€ validate.5.13.txt
|       |   |   â”œâ”€â”€ validate.6.txt
|       |   |   â”œâ”€â”€ validate.7.4.txt
|       |   |   â”œâ”€â”€ validate.7.6.txt
|       |   |   â””â”€â”€ validate.txt
|       |   â”œâ”€â”€ helper.py
|       |   â”œâ”€â”€ test_auxprm.py
|       |   â”œâ”€â”€ test_celprm.py
|       |   â”œâ”€â”€ test_pickle.py
|       |   â”œâ”€â”€ test_prjprm.py
|       |   â”œâ”€â”€ test_profiling.py
|       |   â”œâ”€â”€ test_tab.py
|       |   â”œâ”€â”€ test_tabprm.py
|       |   â”œâ”€â”€ test_utils.py
|       |   â”œâ”€â”€ test_wcs.py
|       |   â”œâ”€â”€ test_wcsprm.py
|       |   â””â”€â”€ test_wtbarr.py
|       â”œâ”€â”€ utils.py
|       â”œâ”€â”€ wcs.py
|       â”œâ”€â”€ wcsapi
|       |   â”œâ”€â”€ __init__.py
|       |   â”œâ”€â”€ conftest.py
|       |   â”œâ”€â”€ data
|       |   |   â””â”€â”€ ucds.txt
|       |   â”œâ”€â”€ fitswcs.py
|       |   â”œâ”€â”€ high_level_api.py
|       |   â”œâ”€â”€ high_level_wcs_wrapper.py
|       |   â”œâ”€â”€ low_level_api.py
|       |   â”œâ”€â”€ sliced_low_level_wcs.py
|       |   â”œâ”€â”€ tests
|       |   |   â”œâ”€â”€ __init__.py
|       |   |   â”œâ”€â”€ test_fitswcs.py
|       |   |   â”œâ”€â”€ test_high_level_api.py
|       |   |   â”œâ”€â”€ test_high_level_wcs_wrapper.py
|       |   |   â”œâ”€â”€ test_low_level_api.py
|       |   |   â””â”€â”€ test_utils.py
|       |   â”œâ”€â”€ utils.py
|       |   â””â”€â”€ wrappers
|       |       â”œâ”€â”€ __init__.py
|       |       â”œâ”€â”€ base.py
|       |       â”œâ”€â”€ sliced_wcs.py
|       |       â””â”€â”€ tests
|       â””â”€â”€ wcslint.py
â”œâ”€â”€ azure-pipelines.yml
â”œâ”€â”€ cextern
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ cfitsio
|   |   â”œâ”€â”€ License.txt
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ docs
|   |   |   â””â”€â”€ changes.txt
|   |   â”œâ”€â”€ lib
|   |   |   â”œâ”€â”€ buffers.c
|   |   |   â”œâ”€â”€ cfileio.c
|   |   |   â”œâ”€â”€ checksum.c
|   |   |   â”œâ”€â”€ drvrfile.c
|   |   |   â”œâ”€â”€ drvrmem.c
|   |   |   â”œâ”€â”€ drvrnet.c
|   |   |   â”œâ”€â”€ drvrsmem.c
|   |   |   â”œâ”€â”€ editcol.c
|   |   |   â”œâ”€â”€ edithdu.c
|   |   |   â”œâ”€â”€ eval_f.c
|   |   |   â”œâ”€â”€ eval_l.c
|   |   |   â”œâ”€â”€ eval_y.c
|   |   |   â”œâ”€â”€ fits_hcompress.c
|   |   |   â”œâ”€â”€ fits_hdecompress.c
|   |   |   â”œâ”€â”€ fitscore.c
|   |   |   â”œâ”€â”€ getcol.c
|   |   |   â”œâ”€â”€ getcolb.c
|   |   |   â”œâ”€â”€ getcold.c
|   |   |   â”œâ”€â”€ getcole.c
|   |   |   â”œâ”€â”€ getcoli.c
|   |   |   â”œâ”€â”€ getcolj.c
|   |   |   â”œâ”€â”€ getcolk.c
|   |   |   â”œâ”€â”€ getcoll.c
|   |   |   â”œâ”€â”€ getcols.c
|   |   |   â”œâ”€â”€ getcolsb.c
|   |   |   â”œâ”€â”€ getcolui.c
|   |   |   â”œâ”€â”€ getcoluj.c
|   |   |   â”œâ”€â”€ getcoluk.c
|   |   |   â”œâ”€â”€ getkey.c
|   |   |   â”œâ”€â”€ group.c
|   |   |   â”œâ”€â”€ grparser.c
|   |   |   â”œâ”€â”€ histo.c
|   |   |   â”œâ”€â”€ imcompress.c
|   |   |   â”œâ”€â”€ iraffits.c
|   |   |   â”œâ”€â”€ modkey.c
|   |   |   â”œâ”€â”€ pliocomp.c
|   |   |   â”œâ”€â”€ putcol.c
|   |   |   â”œâ”€â”€ putcolb.c
|   |   |   â”œâ”€â”€ putcold.c
|   |   |   â”œâ”€â”€ putcole.c
|   |   |   â”œâ”€â”€ putcoli.c
|   |   |   â”œâ”€â”€ putcolj.c
|   |   |   â”œâ”€â”€ putcolk.c
|   |   |   â”œâ”€â”€ putcoll.c
|   |   |   â”œâ”€â”€ putcols.c
|   |   |   â”œâ”€â”€ putcolsb.c
|   |   |   â”œâ”€â”€ putcolu.c
|   |   |   â”œâ”€â”€ putcolui.c
|   |   |   â”œâ”€â”€ putcoluj.c
|   |   |   â”œâ”€â”€ putcoluk.c
|   |   |   â”œâ”€â”€ putkey.c
|   |   |   â”œâ”€â”€ quantize.c
|   |   |   â”œâ”€â”€ region.c
|   |   |   â”œâ”€â”€ ricecomp.c
|   |   |   â”œâ”€â”€ scalnull.c
|   |   |   â”œâ”€â”€ simplerng.c
|   |   |   â”œâ”€â”€ swapproc.c
|   |   |   â”œâ”€â”€ wcssub.c
|   |   |   â”œâ”€â”€ wcsutil.c
|   |   |   â”œâ”€â”€ zcompress.c
|   |   |   â””â”€â”€ zuncompress.c
|   |   â””â”€â”€ zlib
|   |       â”œâ”€â”€ adler32.c
|   |       â”œâ”€â”€ crc32.c
|   |       â”œâ”€â”€ deflate.c
|   |       â”œâ”€â”€ infback.c
|   |       â”œâ”€â”€ inffast.c
|   |       â”œâ”€â”€ inflate.c
|   |       â”œâ”€â”€ inftrees.c
|   |       â”œâ”€â”€ trees.c
|   |       â”œâ”€â”€ uncompr.c
|   |       â””â”€â”€ zutil.c
|   â”œâ”€â”€ expat
|   |   â”œâ”€â”€ README.md
|   |   â”œâ”€â”€ README.txt
|   |   â””â”€â”€ lib
|   |       â”œâ”€â”€ xmlparse.c
|   |       â”œâ”€â”€ xmlrole.c
|   |       â”œâ”€â”€ xmltok.c
|   |       â”œâ”€â”€ xmltok_impl.c
|   |       â””â”€â”€ xmltok_ns.c
|   â”œâ”€â”€ trim_cfitsio.sh
|   â”œâ”€â”€ trim_expat.sh
|   â”œâ”€â”€ trim_wcslib.sh
|   â””â”€â”€ wcslib
|       â”œâ”€â”€ C
|       |   â”œâ”€â”€ cel.c
|       |   â”œâ”€â”€ dis.c
|       |   â”œâ”€â”€ flexed
|       |   |   â”œâ”€â”€ fitshdr.c
|       |   |   â”œâ”€â”€ wcsbth.c
|       |   |   â”œâ”€â”€ wcspih.c
|       |   |   â”œâ”€â”€ wcsulex.c
|       |   |   â””â”€â”€ wcsutrn.c
|       |   â”œâ”€â”€ getwcstab.c
|       |   â”œâ”€â”€ lin.c
|       |   â”œâ”€â”€ log.c
|       |   â”œâ”€â”€ prj.c
|       |   â”œâ”€â”€ spc.c
|       |   â”œâ”€â”€ sph.c
|       |   â”œâ”€â”€ spx.c
|       |   â”œâ”€â”€ tab.c
|       |   â”œâ”€â”€ wcs.c
|       |   â”œâ”€â”€ wcserr.c
|       |   â”œâ”€â”€ wcsfix.c
|       |   â”œâ”€â”€ wcshdr.c
|       |   â”œâ”€â”€ wcsprintf.c
|       |   â”œâ”€â”€ wcstrig.c
|       |   â”œâ”€â”€ wcsunits.c
|       |   â””â”€â”€ wcsutil.c
|       â””â”€â”€ config
â”œâ”€â”€ codecov.yml
â”œâ”€â”€ conftest.py
â”œâ”€â”€ docs
|   â”œâ”€â”€ _pkgtemplate.rst
|   â”œâ”€â”€ _static
|   â”œâ”€â”€ _templates
|   â”œâ”€â”€ changelog.rst
|   â”œâ”€â”€ changes
|   |   â”œâ”€â”€ README.rst
|   |   â”œâ”€â”€ config
|   |   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ cosmology
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12313.feature.rst
|   |   |   â”œâ”€â”€ 12354.api.rst
|   |   |   â”œâ”€â”€ 12375.api.rst
|   |   |   â”œâ”€â”€ 12479.feature.rst
|   |   |   â”œâ”€â”€ 12590.feature.rst
|   |   |   â”œâ”€â”€ 12606.feature.rst
|   |   |   â”œâ”€â”€ 12612.api.rst
|   |   |   â”œâ”€â”€ 12624.api.rst
|   |   |   â”œâ”€â”€ 12710.feature.rst
|   |   |   â”œâ”€â”€ 12736.feature.rst
|   |   |   â”œâ”€â”€ 12740.feature.rst
|   |   |   â”œâ”€â”€ 12746.api.rst
|   |   |   â””â”€â”€ 12966.feature.rst
|   |   â”œâ”€â”€ extern
|   |   â”œâ”€â”€ io.ascii
|   |   |   â”œâ”€â”€ 12631.bugfix.rst
|   |   |   â””â”€â”€ 12841.api.rst
|   |   â”œâ”€â”€ io.fits
|   |   |   â”œâ”€â”€ 11843.feature.rst
|   |   |   â””â”€â”€ 12258.api.rst
|   |   â”œâ”€â”€ io.misc
|   |   |   â”œâ”€â”€ 10198.feature.rst
|   |   |   â”œâ”€â”€ 12279.feature.rst
|   |   |   â”œâ”€â”€ 12895.feature.rst
|   |   |   â”œâ”€â”€ 12897.feature.rst
|   |   |   â”œâ”€â”€ 12903.api.rst
|   |   |   â””â”€â”€ 12930.api.rst
|   |   â”œâ”€â”€ io.registry
|   |   â”œâ”€â”€ io.votable
|   |   â”œâ”€â”€ modeling
|   |   |   â”œâ”€â”€ 12384.feature.rst
|   |   |   â”œâ”€â”€ 12558.feature.rst
|   |   |   â”œâ”€â”€ 12585.api.rst
|   |   |   â””â”€â”€ 12811.feature.rst
|   |   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ table
|   |   |   â”œâ”€â”€ 12631.api.rst
|   |   |   â”œâ”€â”€ 12637.api.rst
|   |   |   â”œâ”€â”€ 12637.feature.rst
|   |   |   â”œâ”€â”€ 12680.feature.rst
|   |   |   â””â”€â”€ 12716.bugfix.rst
|   |   â”œâ”€â”€ template.rst
|   |   â”œâ”€â”€ tests
|   |   |   â”œâ”€â”€ 12633.api.1.rst
|   |   |   â”œâ”€â”€ 12633.api.2.rst
|   |   |   â”œâ”€â”€ 12633.api.3.rst
|   |   |   â””â”€â”€ 12633.api.4.rst
|   |   â”œâ”€â”€ time
|   |   |   â””â”€â”€ 12888.api.rst
|   |   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ units
|   |   |   â”œâ”€â”€ 12486.feature.rst
|   |   |   â”œâ”€â”€ 12566.feature.rst
|   |   |   â”œâ”€â”€ 12709.feature.rst
|   |   |   â””â”€â”€ 12975.feature.rst
|   |   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ visualization
|   |   â””â”€â”€ wcs
|   |       â””â”€â”€ 12514.feature.rst
|   â”œâ”€â”€ common_links.txt
|   â”œâ”€â”€ conf.py
|   â”œâ”€â”€ config
|   |   â”œâ”€â”€ astropy_config.rst
|   |   â””â”€â”€ index.rst
|   â”œâ”€â”€ conftest.py
|   â”œâ”€â”€ constants
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ convolution
|   |   â”œâ”€â”€ images
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ kernels.rst
|   |   â”œâ”€â”€ non_normalized_kernels.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â””â”€â”€ using.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ angles.rst
|   |   â”œâ”€â”€ apply_space_motion.rst
|   |   â”œâ”€â”€ common_errors.rst
|   |   â”œâ”€â”€ definitions.rst
|   |   â”œâ”€â”€ formatting.rst
|   |   â”œâ”€â”€ frames.rst
|   |   â”œâ”€â”€ galactocentric.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ inplace.rst
|   |   â”œâ”€â”€ matchsep.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ remote_methods.rst
|   |   â”œâ”€â”€ representations.rst
|   |   â”œâ”€â”€ satellites.rst
|   |   â”œâ”€â”€ skycoord.rst
|   |   â”œâ”€â”€ solarsystem.rst
|   |   â”œâ”€â”€ spectralcoord.rst
|   |   â”œâ”€â”€ transforming.rst
|   |   â””â”€â”€ velocities.rst
|   â”œâ”€â”€ cosmology
|   |   â”œâ”€â”€ dev.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ io.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ credits.rst
|   â”œâ”€â”€ development
|   |   â”œâ”€â”€ astropy-package-template.rst
|   |   â”œâ”€â”€ building.rst
|   |   â”œâ”€â”€ ccython.rst
|   |   â”œâ”€â”€ codeguide.rst
|   |   â”œâ”€â”€ codeguide_emacs.rst
|   |   â”œâ”€â”€ docguide.rst
|   |   â”œâ”€â”€ docrules.rst
|   |   â”œâ”€â”€ releasing.rst
|   |   â”œâ”€â”€ scripts.rst
|   |   â”œâ”€â”€ style-guide.rst
|   |   â”œâ”€â”€ testguide.rst
|   |   â”œâ”€â”€ vision.rst
|   |   â”œâ”€â”€ when_to_rebase.rst
|   |   â””â”€â”€ workflow
|   |       â”œâ”€â”€ additional_git_topics.rst
|   |       â”œâ”€â”€ development_workflow.rst
|   |       â”œâ”€â”€ get_devel_version.rst
|   |       â”œâ”€â”€ git_edit_workflow_examples.rst
|   |       â”œâ”€â”€ git_install.rst
|   |       â”œâ”€â”€ git_resources.rst
|   |       â”œâ”€â”€ maintainer_workflow.rst
|   |       â”œâ”€â”€ patches.rst
|   |       â””â”€â”€ virtual_pythons.rst
|   â”œâ”€â”€ getting_started.rst
|   â”œâ”€â”€ glossary.rst
|   â”œâ”€â”€ importing_astropy.rst
|   â”œâ”€â”€ index.rst
|   â”œâ”€â”€ install.rst
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ ascii
|   |   |   â”œâ”€â”€ base_classes.rst
|   |   |   â”œâ”€â”€ ecsv.rst
|   |   |   â”œâ”€â”€ extension_classes.rst
|   |   |   â”œâ”€â”€ fast_ascii_io.rst
|   |   |   â”œâ”€â”€ fixed_width_gallery.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â”œâ”€â”€ read.rst
|   |   |   â”œâ”€â”€ references.txt
|   |   |   â”œâ”€â”€ toc.txt
|   |   |   â””â”€â”€ write.rst
|   |   â”œâ”€â”€ asdf-schemas.rst
|   |   â”œâ”€â”€ fits
|   |   |   â”œâ”€â”€ api
|   |   |   |   â”œâ”€â”€ cards.rst
|   |   |   |   â”œâ”€â”€ diff.rst
|   |   |   |   â”œâ”€â”€ files.rst
|   |   |   |   â”œâ”€â”€ hdulists.rst
|   |   |   |   â”œâ”€â”€ hdus.rst
|   |   |   |   â”œâ”€â”€ headers.rst
|   |   |   |   â”œâ”€â”€ images.rst
|   |   |   |   â”œâ”€â”€ tables.rst
|   |   |   |   â””â”€â”€ verification.rst
|   |   |   â”œâ”€â”€ appendix
|   |   |   |   â”œâ”€â”€ faq.rst
|   |   |   |   â”œâ”€â”€ header_transition.rst
|   |   |   |   â””â”€â”€ history.rst
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ performance.inc.rst
|   |   |   â””â”€â”€ usage
|   |   |       â”œâ”€â”€ headers.rst
|   |   |       â”œâ”€â”€ image.rst
|   |   |       â”œâ”€â”€ misc.rst
|   |   |       â”œâ”€â”€ scripts.rst
|   |   |       â”œâ”€â”€ table.rst
|   |   |       â”œâ”€â”€ unfamiliar.rst
|   |   |       â””â”€â”€ verification.rst
|   |   â”œâ”€â”€ misc.rst
|   |   â”œâ”€â”€ registry.rst
|   |   â”œâ”€â”€ unified.rst
|   |   â””â”€â”€ votable
|   |       â”œâ”€â”€ api_exceptions.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ performance.inc.rst
|   |       â””â”€â”€ references.txt
|   â”œâ”€â”€ known_issues.rst
|   â”œâ”€â”€ license.rst
|   â”œâ”€â”€ logging.rst
|   â”œâ”€â”€ lts_policy.rst
|   â”œâ”€â”€ modeling
|   |   â”œâ”€â”€ add-units.rst
|   |   â”œâ”€â”€ compound-models.rst
|   |   â”œâ”€â”€ example-fitting-constraints.rst
|   |   â”œâ”€â”€ example-fitting-line.rst
|   |   â”œâ”€â”€ example-fitting-model-sets.rst
|   |   â”œâ”€â”€ fitting.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ jointfitter.rst
|   |   â”œâ”€â”€ models.rst
|   |   â”œâ”€â”€ new-fitter.rst
|   |   â”œâ”€â”€ new-model.rst
|   |   â”œâ”€â”€ parameters.rst
|   |   â”œâ”€â”€ performance.rst
|   |   â”œâ”€â”€ physical_models.rst
|   |   â”œâ”€â”€ polynomial_models.rst
|   |   â”œâ”€â”€ predef_models1D.rst
|   |   â”œâ”€â”€ predef_models2D.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ spline_models.rst
|   |   â””â”€â”€ units.rst
|   â”œâ”€â”€ nddata
|   |   â”œâ”€â”€ bitmask.rst
|   |   â”œâ”€â”€ ccddata.rst
|   |   â”œâ”€â”€ decorator.rst
|   |   â”œâ”€â”€ examples
|   |   |   â””â”€â”€ cutout2d_tofits.py
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ mixins
|   |   |   â”œâ”€â”€ index.rst
|   |   |   â”œâ”€â”€ ndarithmetic.rst
|   |   |   â”œâ”€â”€ ndio.rst
|   |   |   â””â”€â”€ ndslicing.rst
|   |   â”œâ”€â”€ nddata.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ subclassing.rst
|   |   â””â”€â”€ utils.rst
|   â”œâ”€â”€ overview.rst
|   â”œâ”€â”€ robots.txt
|   â”œâ”€â”€ samp
|   |   â”œâ”€â”€ advanced_embed_samp_hub.rst
|   |   â”œâ”€â”€ example_clients.rst
|   |   â”œâ”€â”€ example_hub.rst
|   |   â”œâ”€â”€ example_table_image.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ stats
|   |   â”œâ”€â”€ circ.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ ripley.rst
|   |   â””â”€â”€ robust.rst
|   â”œâ”€â”€ table
|   |   â”œâ”€â”€ access_table.rst
|   |   â”œâ”€â”€ construct_table.rst
|   |   â”œâ”€â”€ implementation_details.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ indexing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ mixin_columns.rst
|   |   â”œâ”€â”€ modify_table.rst
|   |   â”œâ”€â”€ operations.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ testhelpers.rst
|   â”œâ”€â”€ time
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ timeseries
|   |   â”œâ”€â”€ analysis.rst
|   |   â”œâ”€â”€ bls.rst
|   |   â”œâ”€â”€ data_access.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ initializing.rst
|   |   â”œâ”€â”€ io.rst
|   |   â”œâ”€â”€ lombscargle.rst
|   |   â”œâ”€â”€ masking.rst
|   |   â”œâ”€â”€ pandas.rst
|   |   â””â”€â”€ times.rst
|   â”œâ”€â”€ uncertainty
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ performance.inc.rst
|   â”œâ”€â”€ units
|   |   â”œâ”€â”€ combining_and_defining.rst
|   |   â”œâ”€â”€ constants_versions.rst
|   |   â”œâ”€â”€ conversion.rst
|   |   â”œâ”€â”€ decomposing_and_composing.rst
|   |   â”œâ”€â”€ equivalencies.rst
|   |   â”œâ”€â”€ format.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ logarithmic_units.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ physical_types.rst
|   |   â”œâ”€â”€ quantity.rst
|   |   â”œâ”€â”€ standard_units.rst
|   |   â”œâ”€â”€ structured_units.rst
|   |   â””â”€â”€ type_hints.rst
|   â”œâ”€â”€ utils
|   |   â”œâ”€â”€ data.rst
|   |   â”œâ”€â”€ iers.rst
|   |   â”œâ”€â”€ index.rst
|   |   â””â”€â”€ masked
|   |       â””â”€â”€ index.rst
|   â”œâ”€â”€ visualization
|   |   â”œâ”€â”€ histogram.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ matplotlib_integration.rst
|   |   â”œâ”€â”€ normalization.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ rgb.rst
|   |   â””â”€â”€ wcsaxes
|   |       â”œâ”€â”€ controlling_axes.rst
|   |       â”œâ”€â”€ custom_frames.rst
|   |       â”œâ”€â”€ generic_transforms.rst
|   |       â”œâ”€â”€ images_contours.rst
|   |       â”œâ”€â”€ index.rst
|   |       â”œâ”€â”€ initializing_axes.rst
|   |       â”œâ”€â”€ overlaying_coordinate_systems.rst
|   |       â”œâ”€â”€ overlays.rst
|   |       â”œâ”€â”€ slicing_datacubes.rst
|   |       â””â”€â”€ ticks_labels_grid.rst
|   â”œâ”€â”€ warnings.rst
|   â”œâ”€â”€ wcs
|   |   â”œâ”€â”€ example_create_imaging.rst
|   |   â”œâ”€â”€ example_cube_wcs.rst
|   |   â”œâ”€â”€ examples
|   |   |   â”œâ”€â”€ cube_wcs.py
|   |   |   â”œâ”€â”€ from_file.py
|   |   |   â””â”€â”€ programmatic.py
|   |   â”œâ”€â”€ history.rst
|   |   â”œâ”€â”€ index.rst
|   |   â”œâ”€â”€ legacy_interface.rst
|   |   â”œâ”€â”€ loading_from_fits.rst
|   |   â”œâ”€â”€ note_sip.rst
|   |   â”œâ”€â”€ performance.inc.rst
|   |   â”œâ”€â”€ reference_api.rst
|   |   â”œâ”€â”€ references.rst
|   |   â”œâ”€â”€ references.txt
|   |   â”œâ”€â”€ relax.rst
|   |   â”œâ”€â”€ supported_projections.rst
|   |   â”œâ”€â”€ validation.rst
|   |   â”œâ”€â”€ wcsapi.rst
|   |   â””â”€â”€ wcstools.rst
|   â””â”€â”€ whatsnew
|       â”œâ”€â”€ 0.1.rst
|       â”œâ”€â”€ 0.2.rst
|       â”œâ”€â”€ 0.3.rst
|       â”œâ”€â”€ 0.4.rst
|       â”œâ”€â”€ 1.0.rst
|       â”œâ”€â”€ 1.1.rst
|       â”œâ”€â”€ 1.2.rst
|       â”œâ”€â”€ 1.3.rst
|       â”œâ”€â”€ 2.0.rst
|       â”œâ”€â”€ 3.0.rst
|       â”œâ”€â”€ 3.1.rst
|       â”œâ”€â”€ 3.2.rst
|       â”œâ”€â”€ 4.0.rst
|       â”œâ”€â”€ 4.1.rst
|       â”œâ”€â”€ 4.2.rst
|       â”œâ”€â”€ 4.3.rst
|       â”œâ”€â”€ 5.0.rst
|       â”œâ”€â”€ 5.1.rst
|       â””â”€â”€ index.rst
â”œâ”€â”€ examples
|   â”œâ”€â”€ README.rst
|   â”œâ”€â”€ coordinates
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ plot_galactocentric-frame.py
|   |   â”œâ”€â”€ plot_obs-planning.py
|   |   â”œâ”€â”€ plot_sgr-coordinate-frame.py
|   |   â””â”€â”€ rv-to-gsr.py
|   â”œâ”€â”€ io
|   |   â”œâ”€â”€ README.txt
|   |   â”œâ”€â”€ create-mef.py
|   |   â”œâ”€â”€ fits-tables.py
|   |   â”œâ”€â”€ modify-fits-header.py
|   |   â”œâ”€â”€ plot_fits-image.py
|   |   â”œâ”€â”€ skip_create-large-fits.py
|   |   â””â”€â”€ split-jpeg-to-fits.py
|   â””â”€â”€ template
|       â””â”€â”€ example-template.py
â”œâ”€â”€ licenses
|   â”œâ”€â”€ AURA_LICENSE.rst
|   â”œâ”€â”€ CONFIGOBJ_LICENSE.rst
|   â”œâ”€â”€ DATATABLES_LICENSE.rst
|   â”œâ”€â”€ ERFA.rst
|   â”œâ”€â”€ EXPAT_LICENSE.rst
|   â”œâ”€â”€ JQUERY_LICENSE.rst
|   â”œâ”€â”€ NUMPY_LICENSE.rst
|   â”œâ”€â”€ PLY_LICENSE.rst
|   â”œâ”€â”€ PYFITS.rst
|   â”œâ”€â”€ PYTHON.rst
|   â”œâ”€â”€ README.rst
|   â””â”€â”€ WCSLIB_LICENSE.rst
â””â”€â”€ setup.py
--- END FILE TREE ---
    
This is the original user query:
--- BEGIN ORIGINAL QUERY ---
Issue title:
TimeSeries: misleading exception when required column check fails.

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

All aggregated context for the queries:
--- BEGIN AGGREGATED CONTEXT ---
File: astropy/timeseries/tests/test_sampled.py
Line number range: 352 - 397
Content:
352. def test_required_columns():
353. 
354.     # Test the machinery that makes sure that the required columns are present
355. 
356.     ts = TimeSeries(time=INPUT_TIME,
357.                     data=[[10, 2, 3], [4, 5, 6]],
358.                     names=['a', 'b'])
359. 
360.     # In the examples below, the operation (e.g. remove_column) is actually
361.     # carried out before the checks are made, so we need to use copy() so that
362.     # we don't change the main version of the time series.
363. 
364.     # Make sure copy works fine
365.     ts.copy()
366. 
367.     with pytest.raises(ValueError) as exc:
368.         ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
370.                                  "'time' as the first column but found 'c'")
371. 
372.     with pytest.raises(ValueError) as exc:
373.         ts.copy().add_columns([Column([3, 4, 5], name='d'),
374.                                Column([3, 4, 5], name='e')], indexes=[0, 1])
375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
376.                                  "'time' as the first column but found 'd'")
377. 
378.     with pytest.raises(ValueError) as exc:
379.         ts.copy().keep_columns(['a', 'b'])
380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
381.                                  "'time' as the first column but found 'a'")
382. 
383.     with pytest.raises(ValueError) as exc:
384.         ts.copy().remove_column('time')
385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
386.                                  "'time' as the first column but found 'a'")
387. 
388.     with pytest.raises(ValueError) as exc:
389.         ts.copy().remove_columns(['time', 'a'])
390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
391.                                  "'time' as the first column but found 'b'")
392. 
393.     with pytest.raises(ValueError) as exc:
394.         ts.copy().rename_column('time', 'banana')
395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
396.                                  "'time' as the first column but found 'banana'")
397. 


File: astropy/timeseries/tests/test_sampled.py
Line number range: 32 - 39
Content:
32. def test_empty_initialization_invalid():
33.     # Make sure things crash when the first column added is not a time column
34.     ts = TimeSeries()
35.     with pytest.raises(ValueError) as exc:
36.         ts['flux'] = [1, 2, 3]
37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
38.                                  "'time' as the first column but found 'flux'")
39. 


File: astropy/timeseries/tests/test_binned.py
Line number range: 23 - 32
Content:
23. def test_empty_initialization_invalid():
24. 
25.     # Make sure things crash when the first column added is not a time column
26. 
27.     ts = BinnedTimeSeries()
28.     with pytest.raises(ValueError) as exc:
29.         ts['flux'] = [1, 2, 3]
30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "
31.                                  "'time_bin_start' as the first column but found 'flux'")
32. 


File: astropy/timeseries/tests/test_sampled.py
Line number range: 310 - 314
Content:
310. def test_read_time_wrong():
311.     with pytest.raises(ValueError) as exc:
312.         TimeSeries.read(CSV_FILE, time_column='abc', format='csv')
313.     assert exc.value.args[0] == "Time column 'abc' not found in the input data."
314. 


File: astropy/timeseries/tests/test_binned.py
Line number range: 257 - 261
Content:
257. def test_read_start_time_missing():
258.     with pytest.raises(ValueError) as exc:
259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='abc', time_bin_size_column='bin_size', time_bin_size_unit=u.second, format='csv')
260.     assert exc.value.args[0] == "Bin start time column 'abc' not found in the input data."
261. 

--- END AGGREGATED CONTEXT ---

Analyze if the current context is sufficient to complete the user query by considering:
1. Do you understand the full scope and requirements of the user query?
2. Do you have access to all relevant code that needs to be examined or modified?
3. Are all critical dependencies and their interfaces visible?
4. Is there enough context about the system architecture and design patterns?
5. Do you have access to relevant documentation or tests if needed?

Only request additional context if essential information is missing. Ensure you're not requesting:
- Information already provided in previous queries
- Nice-to-have but non-essential details
- Implementation details that aren't relevant to the current task

If additional context is needed:
- Be specific about what you're looking for
- Consider both code and documentation that might be relevant

2025-10-04 06:07:30,330 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - DEBUG - reasoning='1. The user wants 5 complete and self-contained test cases. The current context provides snippets of test functions from `astropy/timeseries/tests/test_sampled.py` and `astropy/timeseries/tests/test_binned.py`. \n2. These snippets are not self-contained. They are missing necessary imports (e.g., `pytest`, `numpy`, `astropy.units`, `astropy.time`, `astropy.table.Column`, `astropy.timeseries.TimeSeries`, `astropy.timeseries.BinnedTimeSeries`).\n3. The snippets also reference undefined variables like `INPUT_TIME` and `CSV_FILE`, which are likely defined as fixtures or global variables within the test files.\n4. To fulfill the request for complete and runnable test cases, I need the full content of the files containing these test functions.' refined_query='Please provide the full content of the files `astropy/timeseries/tests/test_sampled.py` and `astropy/timeseries/tests/test_binned.py`.'
2025-10-04 06:07:34,523 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'read_file_with_knowledge_graph_data', 'arguments': '{"relative_path": "astropy/timeseries/tests/test_binned.py"}'}, '__gemini_function_call_thought_signatures__': {'c6f83379-bade-4471-8d17-a07e973cbca2': 'Ct0FAR/MhbbW4sAJGVMxenppcOx0NleN/um5epaKwDe+JJ41g1fnP7PBo2ZsJjYixYWmwE5sVdXuHV4StrMvn7ZAg+/BRnCre0VG/Hikea44Qb8U6FnxChcjKfUVvdBv+/1rp0MYPy5rboIRJHdMBrfE2hom/Kh3M8xcFISqlcmcuvlj/1u1Xy422kR5EfKKvVPucwKECXZYFEyKl45P6QUXRUYQC9x9+3A2c0KMdE29btkUHs/NjLg11MOR7x1G89xzbBGJ+VI19F3Ewtu6E2ajegFDcxFwyvGcetyUFEUnsPUDFeM1K8v8SnfQqdHGgXBe+HsNXwuTO7GEIHHzkexbn6cp5mWNIAvhkexRLkNefepXin0cfjnRfd0bwcMumazUND0+G0amQgKj91pgVB/TZRY+JHFeEPmKyVUS4QOprVXocnO9r+2MHc1tAEYpVG400pObXVF8Rizx0CHOAfs88EY7eZTCNeWKFHBtjNWd8oU6Ijq/Kv9PFLxKE97FCtwJUvyqlB4QMpK5SCv+BtPctxzrZAy/2cgS50BMmWxAl+/FePJ7QGhJVjNBuqnZdSUNw8NvQz3MD/EzQ/KVSfPkjnq1bxlxCkFhuwGZxYu9jizPYhrjHZ3ots12yDf9g1KXYvepCzvmscScHMNemqbPbF+gmWlgx0KpAtsHZKosspi+AczLKw6MNDIiXmHY0UvKHEbWseeYu8zAYWebJortoYU58EGejQ3bRugX6+7I3e/1Sfyvd1Ng3uX9jkx7H8m4x6JLTcRidfkh8p27Z8521EHxV7HKH3vYa8+GDHnzLMI3GBpaFinCKNm8emLEkjAUe9bx+WFNYTpudabo7JZG0dFGoZVRcuuwHHMqspljJxrX+XaIPub5ixqVB/41nQca5Z++XoEJoIA6NXyM1CDKuHW3CXEExLoS0ZUSh4vkyQkfhpH13/gv9yk1dLdGrGwuYMap1kkyDZykxKCK8g=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 19526, 'candidates_token_count': 55, 'total_token_count': 19805, 'prompt_tokens_details': [{'modality': 1, 'token_count': 19526}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 55}], 'thoughts_token_count': 224, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08842720551924273, 'model_name': 'gemini-2.5-pro'} id='run--c9e3c45d-d31d-4416-9a35-d05201009289-0' tool_calls=[{'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/tests/test_sampled.py'}, 'id': 'c6f83379-bade-4471-8d17-a07e973cbca2', 'type': 'tool_call'}, {'name': 'read_file_with_knowledge_graph_data', 'args': {'relative_path': 'astropy/timeseries/tests/test_binned.py'}, 'id': '079f25e2-b781-4e85-8914-fa896d859ba4', 'type': 'tool_call'}] usage_metadata={'input_tokens': 19526, 'output_tokens': 55, 'total_tokens': 19805, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 224}}
2025-10-04 06:07:36,914 - thread-139911184823872.app.lang_graph.nodes.context_provider_node - DEBUG - content='I have retrieved the full contents of the files `astropy/timeseries/tests/test_sampled.py` and `astropy/timeseries/tests/test_binned.py` as requested. The contents of these files are now available for your review.' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 34128, 'candidates_token_count': 56, 'total_token_count': 34238, 'cached_content_token_count': 17730, 'prompt_tokens_details': [{'modality': 1, 'token_count': 34350}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17730}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 56}], 'thoughts_token_count': 54}, 'finish_reason': 'STOP', 'avg_logprobs': -0.08182963303157262, 'model_name': 'gemini-2.5-pro'} id='run--b5728aeb-82b7-412f-b802-0b85ebb6dba9-0' usage_metadata={'input_tokens': 34128, 'output_tokens': 56, 'total_tokens': 34238, 'input_token_details': {'cache_read': 17730}, 'output_token_details': {'reasoning': 54}}
2025-10-04 06:07:36,915 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Starting context extraction process
2025-10-04 06:07:36,915 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - This is the original user query:

--- BEGIN ORIGINAL QUERY ---
Issue title:
TimeSeries: misleading exception when required column check fails.

Issue description: 
<!-- This comments are hidden when you submit the issue,
so you do not need to remove them! -->

<!-- Please be sure to check out our contributing guidelines,
https://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .
Please be sure to check out our code of conduct,
https://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->

<!-- Please have a search on our GitHub repository to see if a similar
issue has already been posted.
If a similar issue is closed, have a quick look to see if you are satisfied
by the resolution.
If not please go ahead and open an issue! -->

<!-- Please check that the development version still produces the same bug.
You can install development version with
pip install git+https://github.com/astropy/astropy
command. -->

### Description
<!-- Provide a general description of the bug. -->

For a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.

### Expected behavior
<!-- What did you expect to happen. -->
An exception that informs the users required columns are missing.

### Actual behavior
The actual exception message is confusing:
`ValueError: TimeSeries object is invalid - expected 'time' as the first columns but found 'time'`

### Steps to Reproduce
<!-- Ideally a code example could be provided so we can run it ourselves. -->
<!-- If you are pasting code, use triple backticks (```) around
your code snippet. -->
<!-- If necessary, sanitize your screen output to be pasted so you do not
reveal secrets like tokens and passwords. -->

```python
from astropy.time import Time
from astropy.timeseries import TimeSeries

time=Time(np.arange(100000, 100003), format='jd')
ts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})
ts._required_columns = ["time", "flux"]                                   
ts.remove_column("flux")

```

### System Details
<!-- Even if you do not think this is necessary, it is useful information for the maintainers.
Please run the following snippet and paste the output below:
import platform; print(platform.platform())
import sys; print("Python", sys.version)
import numpy; print("Numpy", numpy.__version__)
import erfa; print("pyerfa", erfa.__version__)
import astropy; print("astropy", astropy.__version__)
import scipy; print("Scipy", scipy.__version__)
import matplotlib; print("Matplotlib", matplotlib.__version__)
-->
```
Windows-10-10.0.22000-SP0
Python 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]
Numpy 1.22.3
pyerfa 2.0.0.1
astropy 5.0.3
Scipy 1.8.0
Matplotlib 3.5.1
```

Issue comments:


OBJECTIVE: Find 5 relevant existing test cases that demonstrates similar functionality to the reported bug,
including ALL necessary imports, test setup, mocking, assertions, and any test method used in the test case.

<reasoning>
1. Analyze bug characteristics:
   - Core functionality being tested
   - Input parameters and configurations
   - Expected error conditions
   - Environmental dependencies

2. Search requirements:
   - Required imports and dependencies
   - Test files exercising similar functionality
   - Mock/fixture setup patterns
   - Assertion styles
   - Error handling tests

3. Focus areas:
   - All necessary imports (standard library, testing frameworks, mocking utilities)
   - Dependencies and third-party packages
   - Test setup and teardown
   - Mock object configuration
   - Network/external service simulation
   - Error condition verification
</reasoning>

REQUIREMENTS:
- Return 5 complete, self-contained test cases most similar to bug scenario
- Must include ALL necessary imports at the start of each test file
- Must include full test method implementation
- Must include ALL mock/fixture setup
- Must include helper functions used by test
- Must preserve exact file paths and line numbers

<examples>
<example id="database-timeout">
<bug>
db.execute("SELECT * FROM users").fetchall() 
raises ConnectionTimeout when load is high
</bug>

<ideal_test_match>
# File: tests/test_database.py
import pytest
from unittest.mock import Mock, patch
from database.exceptions import ConnectionTimeout
from database.models import QueryResult
from database.client import DatabaseClient

class TestDatabaseTimeout:
    @pytest.fixture
    def mock_db_connection(self):
        conn = Mock()
        conn.execute.side_effect = [
            ConnectionTimeout("Connection timed out"),
            QueryResult(["user1", "user2"])  # Second try succeeds
        ]
        return conn
        
    def test_handle_timeout_during_query(self, mock_db_connection):
        # Complete test showing timeout scenario
        # Including retry logic verification
        # With all necessary assertions
</ideal_test_match>
</example>

<example id="file-permission">
<bug>
FileProcessor('/root/data.txt').process() 
fails with PermissionError
</bug>

<ideal_test_match>
# File: tests/test_file_processor.py
import os
import pytest
from unittest.mock import patch, mock_open
from file_processor import FileProcessor
from file_processor.exceptions import ProcessingError

class TestFilePermissions:
    @patch('os.access')
    @patch('builtins.open')
    def test_file_permission_denied(self, mock_open, mock_access):
        # Full test setup with mocked file system
        # Permission denial simulation
        # Error handling verification
</ideal_test_match>
</example>

Search priority:
1. Tests of exact same functionality (including import patterns)
2. Tests with similar error conditions
3. Tests with comparable mocking patterns
4. Tests demonstrating similar assertions

Find the 5 most relevant test cases with complete context, ensuring ALL necessary imports are included at the start of each test file.

--- END ORIGINAL QUERY ---

This is the refinement query. Please consider it together with the original query. It's really IMPORTANT!!!

--- BEGIN REFINEMENT QUERY ---
Please provide the full content of the files `astropy/timeseries/tests/test_sampled.py` and `astropy/timeseries/tests/test_binned.py`.
--- END REFINEMENT QUERY ---

The context or file content that you have seen so far (Some of the context may be IRRELEVANT to the query!!!):

--- BEGIN CONTEXT ---
File: astropy/timeseries/tests/test_sampled.py
Line number range: 1 - 420
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. from datetime import datetime
4. 
5. import pytest
6. 
7. from numpy.testing import assert_equal, assert_allclose
8. 
9. from astropy.table import Table, Column
10. from astropy.time import Time, TimeDelta
11. from astropy import units as u
12. from astropy.units import Quantity
13. from astropy.utils.data import get_pkg_data_filename
14. from astropy.tests.helper import assert_quantity_allclose
15. 
16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
17. from astropy.timeseries.sampled import TimeSeries
18. 
19. INPUT_TIME = Time(['2016-03-22T12:30:31',
20.                    '2015-01-21T12:30:32',
21.                    '2016-03-22T12:30:40'])
22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=['a', 'b', 'c'])
23. 
24. CSV_FILE = get_pkg_data_filename('data/sampled.csv')
25. 
26. 
27. def test_empty_initialization():
28.     ts = TimeSeries()
29.     ts['time'] = Time([50001, 50002, 50003], format='mjd')
30. 
31. 
32. def test_empty_initialization_invalid():
33.     # Make sure things crash when the first column added is not a time column
34.     ts = TimeSeries()
35.     with pytest.raises(ValueError) as exc:
36.         ts['flux'] = [1, 2, 3]
37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
38.                                  "'time' as the first column but found 'flux'")
39. 
40. 
41. def test_initialize_only_time():
42.     ts = TimeSeries(time=INPUT_TIME)
43.     assert ts['time'] is ts.time
44.     # NOTE: the object in the table is a copy
45.     assert_equal(ts.time.isot, INPUT_TIME.isot)
46. 
47. 
48. def test_initialization_with_data():
49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
50.     assert_equal(ts.time.isot, INPUT_TIME.isot)
51.     assert_equal(ts['a'], [10, 2, 3])
52.     assert_equal(ts['b'], [4, 5, 6])
53. 
54. 
55. def test_initialize_only_data():
56.     with pytest.raises(TypeError) as exc:
57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
58.     assert exc.value.args[0] == "Either 'time' or 'time_start' should be specified"
59. 
60. 
61. def test_initialization_with_table():
62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)
63.     assert ts.colnames == ['time', 'a', 'b', 'c']
64. 
65. 
66. def test_initialization_with_time_delta():
67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
68.                     time_delta=TimeDelta(3, format='sec'),
69.                     data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
70.     assert_equal(ts.time.isot, ['2018-07-01T10:10:10.000',
71.                                 '2018-07-01T10:10:13.000',
72.                                 '2018-07-01T10:10:16.000'])
73. 
74. 
75. def test_initialization_missing_time_delta():
76.     with pytest.raises(TypeError) as exc:
77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
78.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
79.     assert exc.value.args[0] == "'time' is scalar, so 'time_delta' is required"
80. 
81. 
82. def test_initialization_invalid_time_and_time_start():
83.     with pytest.raises(TypeError) as exc:
84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),
85.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
86.     assert exc.value.args[0] == "Cannot specify both 'time' and 'time_start'"
87. 
88. 
89. def test_initialization_invalid_time_delta():
90.     with pytest.raises(TypeError) as exc:
91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),
92.                    time_delta=[1, 4, 3],
93.                    data=[[10, 2, 3], [4, 5, 6]], names=['a', 'b'])
94.     assert exc.value.args[0] == "'time_delta' should be a Quantity or a TimeDelta"
95. 
96. 
97. def test_initialization_with_time_in_data():
98. 
99.     data = PLAIN_TABLE.copy()
100.     data['time'] = INPUT_TIME
101. 
102.     ts1 = TimeSeries(data=data)
103. 
104.     assert set(ts1.colnames) == set(['time', 'a', 'b', 'c'])
105.     assert all(ts1.time == INPUT_TIME)
106. 
107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
108.     assert set(ts2.colnames) == set(['time', 'a'])
109.     assert all(ts2.time == INPUT_TIME)
110. 
111.     with pytest.raises(TypeError) as exc:
112.         # Don't allow ambiguous cases of passing multiple 'time' columns
113.         TimeSeries(data=data, time=INPUT_TIME)
114.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
115. 
116.     with pytest.raises(TypeError) as exc:
117.         # 'time' is a protected name, don't allow ambiguous cases
118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=['a', 'time'])
119.     assert exc.value.args[0] == "'time' has been given both in the table and as a keyword argument"
120. 
121. 
122. def test_initialization_n_samples():
123. 
124.     # Make sure things crash with incorrect n_samples
125. 
126.     with pytest.raises(TypeError) as exc:
127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)
128.     assert exc.value.args[0] == ("'n_samples' has been given both and it is not the "
129.                                  "same length as the input data.")
130. 
131. 
132. def test_initialization_length_mismatch():
133.     with pytest.raises(ValueError) as exc:
134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=['a', 'b'])
135.     assert exc.value.args[0] == "Length of 'time' (3) should match data length (2)"
136. 
137. 
138. def test_initialization_invalid_both_time_and_time_delta():
139.     with pytest.raises(TypeError) as exc:
140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format='sec'))
141.     assert exc.value.args[0] == ("'time_delta' should not be specified since "
142.                                  "'time' is an array")
143. 
144. 
145. def test_fold():
146. 
147.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
148. 
149.     ts = TimeSeries(time=times)
150.     ts['flux'] = [1, 4, 4, 3, 2, 3]
151. 
152.     # Try without epoch time, as it should default to the first time and
153.     # wrapping at half the period.
154.     tsf = ts.fold(period=3.2 * u.s)
155.     assert isinstance(tsf.time, TimeDelta)
156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)
157. 
158.     # Try with epoch time
159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'))
160.     assert isinstance(tsf.time, TimeDelta)
161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)
162. 
163.     # Now with wrap_phase set to the full period
164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)
165.     assert isinstance(tsf.time, TimeDelta)
166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)
167. 
168.     # Now set epoch_phase to be 1/4 of the way through the phase
169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)
170.     assert isinstance(tsf.time, TimeDelta)
171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)
172. 
173.     # And combining epoch_phase and wrap_phase
174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)
175.     assert isinstance(tsf.time, TimeDelta)
176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)
177. 
178.     # Now repeat the above tests but with normalization applied
179. 
180.     # Try without epoch time, as it should default to the first time and
181.     # wrapping at half the period.
182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)
183.     assert isinstance(tsf.time, Quantity)
184.     assert_allclose(tsf.time.to_value(u.one),
185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],
186.                     rtol=1e-6)
187. 
188.     # Try with epoch time
189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format='unix'),
190.                   normalize_phase=True)
191.     assert isinstance(tsf.time, Quantity)
192.     assert_allclose(tsf.time.to_value(u.one),
193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],
194.                     rtol=1e-6, atol=1e-6)
195. 
196.     # Now with wrap_phase set to the full period
197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)
198.     assert isinstance(tsf.time, Quantity)
199.     assert_allclose(tsf.time.to_value(u.one),
200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],
201.                     rtol=1e-6)
202. 
203.     # Now set epoch_phase to be 1/4 of the way through the phase
204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)
205.     assert isinstance(tsf.time, Quantity)
206.     assert_allclose(tsf.time.to_value(u.one),
207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],
208.                     rtol=1e-6)
209. 
210.     # And combining epoch_phase and wrap_phase
211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,
212.                   normalize_phase=True)
213.     assert isinstance(tsf.time, Quantity)
214.     assert_allclose(tsf.time.to_value(u.one),
215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],
216.                     rtol=1e-6)
217. 
218. 
219. def test_fold_invalid_options():
220. 
221.     times = Time([1, 2, 3, 8, 9, 12], format='unix')
222. 
223.     ts = TimeSeries(time=times)
224.     ts['flux'] = [1, 4, 4, 3, 2, 3]
225. 
226.     with pytest.raises(u.UnitsError,
227.                        match='period should be a Quantity in units of time'):
228.         ts.fold(period=3.2)
229. 
230.     with pytest.raises(u.UnitsError,
231.                        match='period should be a Quantity in units of time'):
232.         ts.fold(period=3.2 * u.m)
233. 
234.     with pytest.raises(u.UnitsError,
235.                        match='epoch_phase should be a Quantity in units of '
236.                              'time when normalize_phase=False'):
237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)
238. 
239.     with pytest.raises(u.UnitsError,
240.                        match='epoch_phase should be a dimensionless Quantity '
241.                              'or a float when normalize_phase=True'):
242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)
243. 
244.     with pytest.raises(u.UnitsError,
245.                        match='wrap_phase should be a Quantity in units of '
246.                              'time when normalize_phase=False'):
247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)
248. 
249.     with pytest.raises(u.UnitsError,
250.                        match='wrap_phase should be dimensionless when '
251.                              'normalize_phase=True'):
252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)
253. 
254.     with pytest.raises(ValueError,
255.                        match='wrap_phase should be between 0 and the period'):
256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)
257. 
258.     with pytest.raises(ValueError,
259.                        match='wrap_phase should be between 0 and the period'):
260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)
261. 
262.     with pytest.raises(ValueError,
263.                        match='wrap_phase should be between 0 and 1'):
264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)
265. 
266.     with pytest.raises(ValueError,
267.                        match='wrap_phase should be between 0 and 1'):
268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)
269. 
270. 
271. def test_pandas():
272.     pandas = pytest.importorskip("pandas")
273. 
274.     df1 = pandas.DataFrame()
275.     df1['a'] = [1, 2, 3]
276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)
277. 
278.     ts = TimeSeries.from_pandas(df1)
279.     assert_equal(ts.time.isot, INPUT_TIME.isot)
280.     assert ts.colnames == ['time', 'a']
281.     assert len(ts.indices) == 1
282.     assert (ts.indices['time'].columns[0] == INPUT_TIME).all()
283. 
284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale='tcb')
285.     assert ts_tcb.time.scale == 'tcb'
286. 
287.     df2 = ts.to_pandas()
288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()
289.     assert df2.columns == pandas.Index(['a'])
290.     assert (df1['a'] == df2['a']).all()
291. 
292.     with pytest.raises(TypeError) as exc:
293.         TimeSeries.from_pandas(None)
294.     assert exc.value.args[0] == 'Input should be a pandas DataFrame'
295. 
296.     df4 = pandas.DataFrame()
297.     df4['a'] = [1, 2, 3]
298. 
299.     with pytest.raises(TypeError) as exc:
300.         TimeSeries.from_pandas(df4)
301.     assert exc.value.args[0] == 'DataFrame does not have a DatetimeIndex'
302. 
303. 
304. def test_read_time_missing():
305.     with pytest.raises(ValueError) as exc:
306.         TimeSeries.read(CSV_FILE, format='csv')
307.     assert exc.value.args[0] == '``time_column`` should be provided since the default Table readers are being used.'
308. 
309. 
310. def test_read_time_wrong():
311.     with pytest.raises(ValueError) as exc:
312.         TimeSeries.read(CSV_FILE, time_column='abc', format='csv')
313.     assert exc.value.args[0] == "Time column 'abc' not found in the input data."
314. 
315. 
316. def test_read():
317.     timeseries = TimeSeries.read(CSV_FILE, time_column='Date', format='csv')
318.     assert timeseries.colnames == ['time', 'A', 'B', 'C', 'D', 'E', 'F', 'G']
319.     assert len(timeseries) == 11
320.     assert timeseries['time'].format == 'iso'
321.     assert timeseries['A'].sum() == 266.5
322. 
323. 
324. @pytest.mark.remote_data(source='astropy')
325. def test_kepler_astropy():
326.     from astropy.units import UnitsWarning
327. 
328.     filename = get_pkg_data_filename('timeseries/kplr010666592-2009131110544_slc.fits')
329. 
330.     with pytest.warns(UnitsWarning):
331.         timeseries = TimeSeries.read(filename, format='kepler.fits')
332. 
333.     assert timeseries["time"].format == 'isot'
334.     assert timeseries["time"].scale == 'tdb'
335.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
336.     assert len(timeseries) == 14280
337.     assert len(timeseries.columns) == 20
338. 
339. 
340. @pytest.mark.remote_data(source='astropy')
341. def test_tess_astropy():
342.     filename = get_pkg_data_filename('timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits')
343.     with pytest.warns(UserWarning, match='Ignoring 815 rows with NaN times'):
344.         timeseries = TimeSeries.read(filename, format='tess.fits')
345.     assert timeseries["time"].format == 'isot'
346.     assert timeseries["time"].scale == 'tdb'
347.     assert timeseries["sap_flux"].unit.to_string() == 'electron / s'
348.     assert len(timeseries) == 19261
349.     assert len(timeseries.columns) == 20
350. 
351. 
352. def test_required_columns():
353. 
354.     # Test the machinery that makes sure that the required columns are present
355. 
356.     ts = TimeSeries(time=INPUT_TIME,
357.                     data=[[10, 2, 3], [4, 5, 6]],
358.                     names=['a', 'b'])
359. 
360.     # In the examples below, the operation (e.g. remove_column) is actually
361.     # carried out before the checks are made, so we need to use copy() so that
362.     # we don't change the main version of the time series.
363. 
364.     # Make sure copy works fine
365.     ts.copy()
366. 
367.     with pytest.raises(ValueError) as exc:
368.         ts.copy().add_column(Column([3, 4, 5], name='c'), index=0)
369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
370.                                  "'time' as the first column but found 'c'")
371. 
372.     with pytest.raises(ValueError) as exc:
373.         ts.copy().add_columns([Column([3, 4, 5], name='d'),
374.                                Column([3, 4, 5], name='e')], indexes=[0, 1])
375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
376.                                  "'time' as the first column but found 'd'")
377. 
378.     with pytest.raises(ValueError) as exc:
379.         ts.copy().keep_columns(['a', 'b'])
380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
381.                                  "'time' as the first column but found 'a'")
382. 
383.     with pytest.raises(ValueError) as exc:
384.         ts.copy().remove_column('time')
385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
386.                                  "'time' as the first column but found 'a'")
387. 
388.     with pytest.raises(ValueError) as exc:
389.         ts.copy().remove_columns(['time', 'a'])
390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
391.                                  "'time' as the first column but found 'b'")
392. 
393.     with pytest.raises(ValueError) as exc:
394.         ts.copy().rename_column('time', 'banana')
395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "
396.                                  "'time' as the first column but found 'banana'")
397. 
398. 
399. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
400. def test_periodogram(cls):
401. 
402.     # Note that we don't need to check the actual results from the periodogram
403.     # classes here since these are tested extensively in
404.     # astropy.timeseries.periodograms.
405. 
406.     ts = TimeSeries(time=INPUT_TIME,
407.                     data=[[10, 2, 3], [4, 5, 6]],
408.                     names=['a', 'b'])
409. 
410.     p1 = cls.from_timeseries(ts, 'a')
411.     assert isinstance(p1, cls)
412.     assert_allclose(p1.t.jd, ts.time.jd)
413.     assert_equal(p1.y, ts['a'])
414.     assert p1.dy is None
415. 
416.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
417.     assert_quantity_allclose(p2.dy, ts['b'])
418. 
419.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
420.     assert_allclose(p3.dy, 0.1)

File: astropy/timeseries/tests/test_binned.py
Line number range: 1 - 317
Content:
1. # Licensed under a 3-clause BSD style license - see LICENSE.rst
2. 
3. import pytest
4. from numpy.testing import assert_equal, assert_allclose
5. 
6. from astropy import units as u
7. from astropy.time import Time, TimeDelta
8. from astropy.utils.data import get_pkg_data_filename
9. 
10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle
11. from astropy.timeseries.binned import BinnedTimeSeries
12. from astropy.tests.helper import assert_quantity_allclose
13. 
14. 
15. CSV_FILE = get_pkg_data_filename('data/binned.csv')
16. 
17. 
18. def test_empty_initialization():
19.     ts = BinnedTimeSeries()
20.     ts['time_bin_start'] = Time([1, 2, 3], format='mjd')
21. 
22. 
23. def test_empty_initialization_invalid():
24. 
25.     # Make sure things crash when the first column added is not a time column
26. 
27.     ts = BinnedTimeSeries()
28.     with pytest.raises(ValueError) as exc:
29.         ts['flux'] = [1, 2, 3]
30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "
31.                                  "'time_bin_start' as the first column but found 'flux'")
32. 
33. 
34. def test_initialization_time_bin_invalid():
35. 
36.     # Make sure things crash when time_bin_* is passed incorrectly.
37. 
38.     with pytest.raises(TypeError) as exc:
39.         BinnedTimeSeries(data=[[1, 4, 3]])
40.     assert exc.value.args[0] == ("'time_bin_start' has not been specified")
41. 
42.     with pytest.raises(TypeError) as exc:
43.         BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31', data=[[1, 4, 3]])
44.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
45. 
46. 
47. def test_initialization_time_bin_both():
48. 
49.     # Make sure things crash when time_bin_* is passed twice.
50. 
51.     with pytest.raises(TypeError) as exc:
52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},
53.                          time_bin_start="2016-03-22T12:30:31")
54.     assert exc.value.args[0] == ("'time_bin_start' has been given both in the table "
55.                                  "and as a keyword argument")
56. 
57.     with pytest.raises(TypeError) as exc:
58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},
59.                          time_bin_size=[1]*u.s)
60.     assert exc.value.args[0] == ("'time_bin_size' has been given both in the table "
61.                                  "and as a keyword argument")
62. 
63. 
64. def test_initialization_time_bin_size():
65. 
66.     # Make sure things crash when time_bin_size has no units
67. 
68.     with pytest.raises(TypeError) as exc:
69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
70.                          time_bin_start="2016-03-22T12:30:31",
71.                          time_bin_size=1)
72.     assert exc.value.args[0] == ("'time_bin_size' should be a Quantity or a TimeDelta")
73. 
74.     # TimeDelta for time_bin_size
75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
76.                           time_bin_start="2016-03-22T12:30:31",
77.                           time_bin_size=TimeDelta(1, format="jd"))
78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)
79. 
80. 
81. def test_initialization_time_bin_start_scalar():
82. 
83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size
84. 
85.     with pytest.raises(TypeError) as exc:
86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
87.                          time_bin_start=Time(1, format='mjd'),
88.                          time_bin_end=Time(1, format='mjd'))
89.     assert exc.value.args[0] == ("'time_bin_start' is scalar, so 'time_bin_size' is required")
90. 
91. 
92. def test_initialization_n_bins_invalid_arguments():
93. 
94.     # Make sure an exception is raised when n_bins is passed as an argument while
95.     # any of the parameters 'time_bin_start' or 'time_bin_end' is not scalar.
96. 
97.     with pytest.raises(TypeError) as exc:
98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format='cxcsec'),
99.                          time_bin_size=1*u.s,
100.                          n_bins=10)
101.     assert exc.value.args[0] == ("'n_bins' cannot be specified if 'time_bin_start' or "
102.                                  "'time_bin_size' are not scalar'")
103. 
104. 
105. def test_initialization_n_bins():
106. 
107.     # Make sure things crash with incorrect n_bins
108. 
109.     with pytest.raises(TypeError) as exc:
110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
111.                          time_bin_start=Time(1, format='mjd'),
112.                          time_bin_size=1*u.s,
113.                          time_bin_end=Time(1, format='mjd'),
114.                          n_bins=10)
115.     assert exc.value.args[0] == ("'n_bins' has been given and it is not the "
116.                                  "same length as the input data.")
117. 
118. 
119. def test_initialization_non_scalar_time():
120. 
121.     # Make sure things crash with incorrect size of time_bin_start
122. 
123.     with pytest.raises(ValueError) as exc:
124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],
126.                          time_bin_size=1*u.s,
127.                          time_bin_end=Time(1, format='mjd'))
128.     assert exc.value.args[0] == ("Length of 'time_bin_start' (2) should match table length (1)")
129. 
130.     with pytest.raises(TypeError) as exc:
131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},
132.                          time_bin_start=["2016-03-22T12:30:31"],
133.                          time_bin_size=None,
134.                          time_bin_end=None)
135.     assert exc.value.args[0] == ("Either 'time_bin_size' or 'time_bin_end' should be specified")
136. 
137. 
138. def test_even_contiguous():
139. 
140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying
141.     # the bin width:
142. 
143.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])
145. 
146.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
147.                                           '2016-03-22T12:30:34.000',
148.                                           '2016-03-22T12:30:37.000'])
149. 
150.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:32.500',
151.                                            '2016-03-22T12:30:35.500',
152.                                            '2016-03-22T12:30:38.500'])
153. 
154.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:34.000',
155.                                         '2016-03-22T12:30:37.000',
156.                                         '2016-03-22T12:30:40.000'])
157. 
158. 
159. def test_uneven_contiguous():
160. 
161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an
162.     # end time:
163. 
164.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
165.                                           '2016-03-22T12:30:32',
166.                                           '2016-03-22T12:30:40'],
167.                           time_bin_end='2016-03-22T12:30:55',
168.                           data=[[1, 4, 3]])
169. 
170.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
171.                                           '2016-03-22T12:30:32.000',
172.                                           '2016-03-22T12:30:40.000'])
173. 
174.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
175.                                            '2016-03-22T12:30:36.000',
176.                                            '2016-03-22T12:30:47.500'])
177. 
178.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
179.                                         '2016-03-22T12:30:40.000',
180.                                         '2016-03-22T12:30:55.000'])
181. 
182. 
183. def test_uneven_non_contiguous():
184. 
185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with
186.     # lists of start times, bin sizes and data:
187. 
188.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
189.                                           '2016-03-22T12:30:38',
190.                                           '2016-03-22T12:34:40'],
191.                           time_bin_size=[5, 100, 2]*u.s,
192.                           data=[[1, 4, 3]])
193. 
194.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
195.                                           '2016-03-22T12:30:38.000',
196.                                           '2016-03-22T12:34:40.000'])
197. 
198.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:33.500',
199.                                            '2016-03-22T12:31:28.000',
200.                                            '2016-03-22T12:34:41.000'])
201. 
202.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:36.000',
203.                                         '2016-03-22T12:32:18.000',
204.                                         '2016-03-22T12:34:42.000'])
205. 
206. 
207. def test_uneven_non_contiguous_full():
208. 
209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by
210.     # specifying the start and end times for the bins:
211. 
212.     ts = BinnedTimeSeries(time_bin_start=['2016-03-22T12:30:31',
213.                                           '2016-03-22T12:30:33',
214.                                           '2016-03-22T12:30:40'],
215.                           time_bin_end=['2016-03-22T12:30:32',
216.                                         '2016-03-22T12:30:35',
217.                                         '2016-03-22T12:30:41'],
218.                           data=[[1, 4, 3]])
219. 
220.     assert_equal(ts.time_bin_start.isot, ['2016-03-22T12:30:31.000',
221.                                           '2016-03-22T12:30:33.000',
222.                                           '2016-03-22T12:30:40.000'])
223. 
224.     assert_equal(ts.time_bin_center.isot, ['2016-03-22T12:30:31.500',
225.                                            '2016-03-22T12:30:34.000',
226.                                            '2016-03-22T12:30:40.500'])
227. 
228.     assert_equal(ts.time_bin_end.isot, ['2016-03-22T12:30:32.000',
229.                                         '2016-03-22T12:30:35.000',
230.                                         '2016-03-22T12:30:41.000'])
231. 
232. 
233. def test_read_empty():
234.     with pytest.raises(ValueError) as exc:
235.         BinnedTimeSeries.read(CSV_FILE, format='csv')
236.     assert exc.value.args[0] == '``time_bin_start_column`` should be provided since the default Table readers are being used.'
237. 
238. 
239. def test_read_no_size_end():
240.     with pytest.raises(ValueError) as exc:
241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', format='csv')
242.     assert exc.value.args[0] == 'Either `time_bin_end_column` or `time_bin_size_column` should be provided.'
243. 
244. 
245. def test_read_both_extra_bins():
246.     with pytest.raises(ValueError) as exc:
247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column='END', time_bin_size_column='bin_size', format='csv')
248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."
249. 
250. 
251. def test_read_size_no_unit():
252.     with pytest.raises(ValueError) as exc:
253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column='bin_size', format='csv')
254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
255. 
256. 
257. def test_read_start_time_missing():
258.     with pytest.raises(ValueError) as exc:
259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='abc', time_bin_size_column='bin_size', time_bin_size_unit=u.second, format='csv')
260.     assert exc.value.args[0] == "Bin start time column 'abc' not found in the input data."
261. 
262. 
263. def test_read_end_time_missing():
264.     with pytest.raises(ValueError) as exc:
265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_end_column="missing", format='csv')
266.     assert exc.value.args[0] == "Bin end time column 'missing' not found in the input data."
267. 
268. 
269. def test_read_size_missing():
270.     with pytest.raises(ValueError) as exc:
271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="missing", time_bin_size_unit=u.second, format='csv')
272.     assert exc.value.args[0] == "Bin size column 'missing' not found in the input data."
273. 
274. 
275. def test_read_time_unit_missing():
276.     with pytest.raises(ValueError) as exc:
277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start', time_bin_size_column="bin_size", format='csv')
278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."
279. 
280. 
281. def test_read():
282. 
283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
284.                                        time_bin_end_column='time_end', format='csv')
285.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'bin_size', 'A', 'B', 'C', 'D', 'E', 'F']
286.     assert len(timeseries) == 10
287.     assert timeseries['B'].sum() == 1151.54
288. 
289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column='time_start',
290.                                        time_bin_size_column='bin_size',
291.                                        time_bin_size_unit=u.second, format='csv')
292.     assert timeseries.colnames == ['time_bin_start', 'time_bin_size', 'time_end', 'A', 'B', 'C', 'D', 'E', 'F']
293.     assert len(timeseries) == 10
294.     assert timeseries['B'].sum() == 1151.54
295. 
296. 
297. @pytest.mark.parametrize('cls', [BoxLeastSquares, LombScargle])
298. def test_periodogram(cls):
299. 
300.     # Note that we don't need to check the actual results from the periodogram
301.     # classes here since these are tested extensively in
302.     # astropy.timeseries.periodograms.
303. 
304.     ts = BinnedTimeSeries(time_bin_start='2016-03-22T12:30:31',
305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=['a', 'b'])
306. 
307.     p1 = cls.from_timeseries(ts, 'a')
308.     assert isinstance(p1, cls)
309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)
310.     assert_equal(p1.y, ts['a'])
311.     assert p1.dy is None
312. 
313.     p2 = cls.from_timeseries(ts, 'a', uncertainty='b')
314.     assert_quantity_allclose(p2.dy, ts['b'])
315. 
316.     p3 = cls.from_timeseries(ts, 'a', uncertainty=0.1)
317.     assert_allclose(p3.dy, 0.1)


--- END CONTEXT ---

REMEMBER: Your task is to summarize the relevant contexts to a given query and the refinement query, and return your response in the specified format!
EVERY context object MUST include: reasoning, relative_path, start_line, and end_line.

2025-10-04 06:08:30,923 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - DEBUG - Model response: context=[ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's refinement query explicitly asks for the full content of the file `astropy/timeseries/tests/test_sampled.py`.\n   - The original query is about a bug in the `TimeSeries` class related to required column validation.\n\n2. Extended relevance:\n   - This file contains the entire test suite for `TimeSeries`, the class at the center of the bug report.\n   - It includes the highly relevant test `test_required_columns` (lines 352-397), which checks the validation logic when columns like 'time' are removed or reordered. This is directly related to the user's problem of removing a required column.\n   - It also contains `test_empty_initialization_invalid` (lines 32-39), which tests the exact validation check that produces the misleading error message seen by the user.\n   - Providing the full file ensures all imports and helper variables are included, which satisfies the original query's requirement for complete and self-contained test cases.", relative_path='astropy/timeseries/tests/test_sampled.py', start_line=1, end_line=420), ContextOutput(reasoning="1. Query requirement analysis:\n   - The user's refinement query explicitly asks for the full content of the file `astropy/timeseries/tests/test_binned.py`.\n\n2. Extended relevance:\n   - This file contains tests for `BinnedTimeSeries`, a class that is related to `TimeSeries` and shares similar design principles for data validation.\n   - Tests like `test_empty_initialization_invalid` (lines 23-32) and other initialization tests show how required columns (in this case, `time_bin_start`) are handled, which provides a broader context for the design pattern that is causing the issue in `TimeSeries`.\n   - Comparing the tests in this file with those for `TimeSeries` can help in understanding the intended behavior of validation across the timeseries module.", relative_path='astropy/timeseries/tests/test_binned.py', start_line=1, end_line=317)]
2025-10-04 06:08:30,924 - thread-139911184823872.app.lang_graph.nodes.context_extraction_node - INFO - Context extraction complete, returning context [Context(relative_path='astropy/timeseries/tests/test_sampled.py', content='1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n2. \n3. from datetime import datetime\n4. \n5. import pytest\n6. \n7. from numpy.testing import assert_equal, assert_allclose\n8. \n9. from astropy.table import Table, Column\n10. from astropy.time import Time, TimeDelta\n11. from astropy import units as u\n12. from astropy.units import Quantity\n13. from astropy.utils.data import get_pkg_data_filename\n14. from astropy.tests.helper import assert_quantity_allclose\n15. \n16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle\n17. from astropy.timeseries.sampled import TimeSeries\n18. \n19. INPUT_TIME = Time([\'2016-03-22T12:30:31\',\n20.                    \'2015-01-21T12:30:32\',\n21.                    \'2016-03-22T12:30:40\'])\n22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=[\'a\', \'b\', \'c\'])\n23. \n24. CSV_FILE = get_pkg_data_filename(\'data/sampled.csv\')\n25. \n26. \n27. def test_empty_initialization():\n28.     ts = TimeSeries()\n29.     ts[\'time\'] = Time([50001, 50002, 50003], format=\'mjd\')\n30. \n31. \n32. def test_empty_initialization_invalid():\n33.     # Make sure things crash when the first column added is not a time column\n34.     ts = TimeSeries()\n35.     with pytest.raises(ValueError) as exc:\n36.         ts[\'flux\'] = [1, 2, 3]\n37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n38.                                  "\'time\' as the first column but found \'flux\'")\n39. \n40. \n41. def test_initialize_only_time():\n42.     ts = TimeSeries(time=INPUT_TIME)\n43.     assert ts[\'time\'] is ts.time\n44.     # NOTE: the object in the table is a copy\n45.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n46. \n47. \n48. def test_initialization_with_data():\n49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n50.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n51.     assert_equal(ts[\'a\'], [10, 2, 3])\n52.     assert_equal(ts[\'b\'], [4, 5, 6])\n53. \n54. \n55. def test_initialize_only_data():\n56.     with pytest.raises(TypeError) as exc:\n57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n58.     assert exc.value.args[0] == "Either \'time\' or \'time_start\' should be specified"\n59. \n60. \n61. def test_initialization_with_table():\n62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)\n63.     assert ts.colnames == [\'time\', \'a\', \'b\', \'c\']\n64. \n65. \n66. def test_initialization_with_time_delta():\n67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n68.                     time_delta=TimeDelta(3, format=\'sec\'),\n69.                     data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n70.     assert_equal(ts.time.isot, [\'2018-07-01T10:10:10.000\',\n71.                                 \'2018-07-01T10:10:13.000\',\n72.                                 \'2018-07-01T10:10:16.000\'])\n73. \n74. \n75. def test_initialization_missing_time_delta():\n76.     with pytest.raises(TypeError) as exc:\n77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n78.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n79.     assert exc.value.args[0] == "\'time\' is scalar, so \'time_delta\' is required"\n80. \n81. \n82. def test_initialization_invalid_time_and_time_start():\n83.     with pytest.raises(TypeError) as exc:\n84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),\n85.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n86.     assert exc.value.args[0] == "Cannot specify both \'time\' and \'time_start\'"\n87. \n88. \n89. def test_initialization_invalid_time_delta():\n90.     with pytest.raises(TypeError) as exc:\n91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n92.                    time_delta=[1, 4, 3],\n93.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n94.     assert exc.value.args[0] == "\'time_delta\' should be a Quantity or a TimeDelta"\n95. \n96. \n97. def test_initialization_with_time_in_data():\n98. \n99.     data = PLAIN_TABLE.copy()\n100.     data[\'time\'] = INPUT_TIME\n101. \n102.     ts1 = TimeSeries(data=data)\n103. \n104.     assert set(ts1.colnames) == set([\'time\', \'a\', \'b\', \'c\'])\n105.     assert all(ts1.time == INPUT_TIME)\n106. \n107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=[\'a\', \'time\'])\n108.     assert set(ts2.colnames) == set([\'time\', \'a\'])\n109.     assert all(ts2.time == INPUT_TIME)\n110. \n111.     with pytest.raises(TypeError) as exc:\n112.         # Don\'t allow ambiguous cases of passing multiple \'time\' columns\n113.         TimeSeries(data=data, time=INPUT_TIME)\n114.     assert exc.value.args[0] == "\'time\' has been given both in the table and as a keyword argument"\n115. \n116.     with pytest.raises(TypeError) as exc:\n117.         # \'time\' is a protected name, don\'t allow ambiguous cases\n118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=[\'a\', \'time\'])\n119.     assert exc.value.args[0] == "\'time\' has been given both in the table and as a keyword argument"\n120. \n121. \n122. def test_initialization_n_samples():\n123. \n124.     # Make sure things crash with incorrect n_samples\n125. \n126.     with pytest.raises(TypeError) as exc:\n127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)\n128.     assert exc.value.args[0] == ("\'n_samples\' has been given both and it is not the "\n129.                                  "same length as the input data.")\n130. \n131. \n132. def test_initialization_length_mismatch():\n133.     with pytest.raises(ValueError) as exc:\n134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=[\'a\', \'b\'])\n135.     assert exc.value.args[0] == "Length of \'time\' (3) should match data length (2)"\n136. \n137. \n138. def test_initialization_invalid_both_time_and_time_delta():\n139.     with pytest.raises(TypeError) as exc:\n140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format=\'sec\'))\n141.     assert exc.value.args[0] == ("\'time_delta\' should not be specified since "\n142.                                  "\'time\' is an array")\n143. \n144. \n145. def test_fold():\n146. \n147.     times = Time([1, 2, 3, 8, 9, 12], format=\'unix\')\n148. \n149.     ts = TimeSeries(time=times)\n150.     ts[\'flux\'] = [1, 4, 4, 3, 2, 3]\n151. \n152.     # Try without epoch time, as it should default to the first time and\n153.     # wrapping at half the period.\n154.     tsf = ts.fold(period=3.2 * u.s)\n155.     assert isinstance(tsf.time, TimeDelta)\n156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)\n157. \n158.     # Try with epoch time\n159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format=\'unix\'))\n160.     assert isinstance(tsf.time, TimeDelta)\n161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)\n162. \n163.     # Now with wrap_phase set to the full period\n164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)\n165.     assert isinstance(tsf.time, TimeDelta)\n166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)\n167. \n168.     # Now set epoch_phase to be 1/4 of the way through the phase\n169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)\n170.     assert isinstance(tsf.time, TimeDelta)\n171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)\n172. \n173.     # And combining epoch_phase and wrap_phase\n174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)\n175.     assert isinstance(tsf.time, TimeDelta)\n176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)\n177. \n178.     # Now repeat the above tests but with normalization applied\n179. \n180.     # Try without epoch time, as it should default to the first time and\n181.     # wrapping at half the period.\n182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)\n183.     assert isinstance(tsf.time, Quantity)\n184.     assert_allclose(tsf.time.to_value(u.one),\n185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],\n186.                     rtol=1e-6)\n187. \n188.     # Try with epoch time\n189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format=\'unix\'),\n190.                   normalize_phase=True)\n191.     assert isinstance(tsf.time, Quantity)\n192.     assert_allclose(tsf.time.to_value(u.one),\n193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],\n194.                     rtol=1e-6, atol=1e-6)\n195. \n196.     # Now with wrap_phase set to the full period\n197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)\n198.     assert isinstance(tsf.time, Quantity)\n199.     assert_allclose(tsf.time.to_value(u.one),\n200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],\n201.                     rtol=1e-6)\n202. \n203.     # Now set epoch_phase to be 1/4 of the way through the phase\n204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)\n205.     assert isinstance(tsf.time, Quantity)\n206.     assert_allclose(tsf.time.to_value(u.one),\n207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],\n208.                     rtol=1e-6)\n209. \n210.     # And combining epoch_phase and wrap_phase\n211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,\n212.                   normalize_phase=True)\n213.     assert isinstance(tsf.time, Quantity)\n214.     assert_allclose(tsf.time.to_value(u.one),\n215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],\n216.                     rtol=1e-6)\n217. \n218. \n219. def test_fold_invalid_options():\n220. \n221.     times = Time([1, 2, 3, 8, 9, 12], format=\'unix\')\n222. \n223.     ts = TimeSeries(time=times)\n224.     ts[\'flux\'] = [1, 4, 4, 3, 2, 3]\n225. \n226.     with pytest.raises(u.UnitsError,\n227.                        match=\'period should be a Quantity in units of time\'):\n228.         ts.fold(period=3.2)\n229. \n230.     with pytest.raises(u.UnitsError,\n231.                        match=\'period should be a Quantity in units of time\'):\n232.         ts.fold(period=3.2 * u.m)\n233. \n234.     with pytest.raises(u.UnitsError,\n235.                        match=\'epoch_phase should be a Quantity in units of \'\n236.                              \'time when normalize_phase=False\'):\n237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)\n238. \n239.     with pytest.raises(u.UnitsError,\n240.                        match=\'epoch_phase should be a dimensionless Quantity \'\n241.                              \'or a float when normalize_phase=True\'):\n242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)\n243. \n244.     with pytest.raises(u.UnitsError,\n245.                        match=\'wrap_phase should be a Quantity in units of \'\n246.                              \'time when normalize_phase=False\'):\n247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)\n248. \n249.     with pytest.raises(u.UnitsError,\n250.                        match=\'wrap_phase should be dimensionless when \'\n251.                              \'normalize_phase=True\'):\n252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)\n253. \n254.     with pytest.raises(ValueError,\n255.                        match=\'wrap_phase should be between 0 and the period\'):\n256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)\n257. \n258.     with pytest.raises(ValueError,\n259.                        match=\'wrap_phase should be between 0 and the period\'):\n260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)\n261. \n262.     with pytest.raises(ValueError,\n263.                        match=\'wrap_phase should be between 0 and 1\'):\n264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)\n265. \n266.     with pytest.raises(ValueError,\n267.                        match=\'wrap_phase should be between 0 and 1\'):\n268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)\n269. \n270. \n271. def test_pandas():\n272.     pandas = pytest.importorskip("pandas")\n273. \n274.     df1 = pandas.DataFrame()\n275.     df1[\'a\'] = [1, 2, 3]\n276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)\n277. \n278.     ts = TimeSeries.from_pandas(df1)\n279.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n280.     assert ts.colnames == [\'time\', \'a\']\n281.     assert len(ts.indices) == 1\n282.     assert (ts.indices[\'time\'].columns[0] == INPUT_TIME).all()\n283. \n284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale=\'tcb\')\n285.     assert ts_tcb.time.scale == \'tcb\'\n286. \n287.     df2 = ts.to_pandas()\n288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()\n289.     assert df2.columns == pandas.Index([\'a\'])\n290.     assert (df1[\'a\'] == df2[\'a\']).all()\n291. \n292.     with pytest.raises(TypeError) as exc:\n293.         TimeSeries.from_pandas(None)\n294.     assert exc.value.args[0] == \'Input should be a pandas DataFrame\'\n295. \n296.     df4 = pandas.DataFrame()\n297.     df4[\'a\'] = [1, 2, 3]\n298. \n299.     with pytest.raises(TypeError) as exc:\n300.         TimeSeries.from_pandas(df4)\n301.     assert exc.value.args[0] == \'DataFrame does not have a DatetimeIndex\'\n302. \n303. \n304. def test_read_time_missing():\n305.     with pytest.raises(ValueError) as exc:\n306.         TimeSeries.read(CSV_FILE, format=\'csv\')\n307.     assert exc.value.args[0] == \'``time_column`` should be provided since the default Table readers are being used.\'\n308. \n309. \n310. def test_read_time_wrong():\n311.     with pytest.raises(ValueError) as exc:\n312.         TimeSeries.read(CSV_FILE, time_column=\'abc\', format=\'csv\')\n313.     assert exc.value.args[0] == "Time column \'abc\' not found in the input data."\n314. \n315. \n316. def test_read():\n317.     timeseries = TimeSeries.read(CSV_FILE, time_column=\'Date\', format=\'csv\')\n318.     assert timeseries.colnames == [\'time\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\', \'G\']\n319.     assert len(timeseries) == 11\n320.     assert timeseries[\'time\'].format == \'iso\'\n321.     assert timeseries[\'A\'].sum() == 266.5\n322. \n323. \n324. @pytest.mark.remote_data(source=\'astropy\')\n325. def test_kepler_astropy():\n326.     from astropy.units import UnitsWarning\n327. \n328.     filename = get_pkg_data_filename(\'timeseries/kplr010666592-2009131110544_slc.fits\')\n329. \n330.     with pytest.warns(UnitsWarning):\n331.         timeseries = TimeSeries.read(filename, format=\'kepler.fits\')\n332. \n333.     assert timeseries["time"].format == \'isot\'\n334.     assert timeseries["time"].scale == \'tdb\'\n335.     assert timeseries["sap_flux"].unit.to_string() == \'electron / s\'\n336.     assert len(timeseries) == 14280\n337.     assert len(timeseries.columns) == 20\n338. \n339. \n340. @pytest.mark.remote_data(source=\'astropy\')\n341. def test_tess_astropy():\n342.     filename = get_pkg_data_filename(\'timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits\')\n343.     with pytest.warns(UserWarning, match=\'Ignoring 815 rows with NaN times\'):\n344.         timeseries = TimeSeries.read(filename, format=\'tess.fits\')\n345.     assert timeseries["time"].format == \'isot\'\n346.     assert timeseries["time"].scale == \'tdb\'\n347.     assert timeseries["sap_flux"].unit.to_string() == \'electron / s\'\n348.     assert len(timeseries) == 19261\n349.     assert len(timeseries.columns) == 20\n350. \n351. \n352. def test_required_columns():\n353. \n354.     # Test the machinery that makes sure that the required columns are present\n355. \n356.     ts = TimeSeries(time=INPUT_TIME,\n357.                     data=[[10, 2, 3], [4, 5, 6]],\n358.                     names=[\'a\', \'b\'])\n359. \n360.     # In the examples below, the operation (e.g. remove_column) is actually\n361.     # carried out before the checks are made, so we need to use copy() so that\n362.     # we don\'t change the main version of the time series.\n363. \n364.     # Make sure copy works fine\n365.     ts.copy()\n366. \n367.     with pytest.raises(ValueError) as exc:\n368.         ts.copy().add_column(Column([3, 4, 5], name=\'c\'), index=0)\n369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n370.                                  "\'time\' as the first column but found \'c\'")\n371. \n372.     with pytest.raises(ValueError) as exc:\n373.         ts.copy().add_columns([Column([3, 4, 5], name=\'d\'),\n374.                                Column([3, 4, 5], name=\'e\')], indexes=[0, 1])\n375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n376.                                  "\'time\' as the first column but found \'d\'")\n377. \n378.     with pytest.raises(ValueError) as exc:\n379.         ts.copy().keep_columns([\'a\', \'b\'])\n380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n381.                                  "\'time\' as the first column but found \'a\'")\n382. \n383.     with pytest.raises(ValueError) as exc:\n384.         ts.copy().remove_column(\'time\')\n385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n386.                                  "\'time\' as the first column but found \'a\'")\n387. \n388.     with pytest.raises(ValueError) as exc:\n389.         ts.copy().remove_columns([\'time\', \'a\'])\n390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n391.                                  "\'time\' as the first column but found \'b\'")\n392. \n393.     with pytest.raises(ValueError) as exc:\n394.         ts.copy().rename_column(\'time\', \'banana\')\n395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n396.                                  "\'time\' as the first column but found \'banana\'")\n397. \n398. \n399. @pytest.mark.parametrize(\'cls\', [BoxLeastSquares, LombScargle])\n400. def test_periodogram(cls):\n401. \n402.     # Note that we don\'t need to check the actual results from the periodogram\n403.     # classes here since these are tested extensively in\n404.     # astropy.timeseries.periodograms.\n405. \n406.     ts = TimeSeries(time=INPUT_TIME,\n407.                     data=[[10, 2, 3], [4, 5, 6]],\n408.                     names=[\'a\', \'b\'])\n409. \n410.     p1 = cls.from_timeseries(ts, \'a\')\n411.     assert isinstance(p1, cls)\n412.     assert_allclose(p1.t.jd, ts.time.jd)\n413.     assert_equal(p1.y, ts[\'a\'])\n414.     assert p1.dy is None\n415. \n416.     p2 = cls.from_timeseries(ts, \'a\', uncertainty=\'b\')\n417.     assert_quantity_allclose(p2.dy, ts[\'b\'])\n418. \n419.     p3 = cls.from_timeseries(ts, \'a\', uncertainty=0.1)\n420.     assert_allclose(p3.dy, 0.1)', start_line_number=1, end_line_number=420), Context(relative_path='astropy/timeseries/tests/test_binned.py', content='1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n2. \n3. import pytest\n4. from numpy.testing import assert_equal, assert_allclose\n5. \n6. from astropy import units as u\n7. from astropy.time import Time, TimeDelta\n8. from astropy.utils.data import get_pkg_data_filename\n9. \n10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle\n11. from astropy.timeseries.binned import BinnedTimeSeries\n12. from astropy.tests.helper import assert_quantity_allclose\n13. \n14. \n15. CSV_FILE = get_pkg_data_filename(\'data/binned.csv\')\n16. \n17. \n18. def test_empty_initialization():\n19.     ts = BinnedTimeSeries()\n20.     ts[\'time_bin_start\'] = Time([1, 2, 3], format=\'mjd\')\n21. \n22. \n23. def test_empty_initialization_invalid():\n24. \n25.     # Make sure things crash when the first column added is not a time column\n26. \n27.     ts = BinnedTimeSeries()\n28.     with pytest.raises(ValueError) as exc:\n29.         ts[\'flux\'] = [1, 2, 3]\n30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "\n31.                                  "\'time_bin_start\' as the first column but found \'flux\'")\n32. \n33. \n34. def test_initialization_time_bin_invalid():\n35. \n36.     # Make sure things crash when time_bin_* is passed incorrectly.\n37. \n38.     with pytest.raises(TypeError) as exc:\n39.         BinnedTimeSeries(data=[[1, 4, 3]])\n40.     assert exc.value.args[0] == ("\'time_bin_start\' has not been specified")\n41. \n42.     with pytest.raises(TypeError) as exc:\n43.         BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\', data=[[1, 4, 3]])\n44.     assert exc.value.args[0] == ("Either \'time_bin_size\' or \'time_bin_end\' should be specified")\n45. \n46. \n47. def test_initialization_time_bin_both():\n48. \n49.     # Make sure things crash when time_bin_* is passed twice.\n50. \n51.     with pytest.raises(TypeError) as exc:\n52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},\n53.                          time_bin_start="2016-03-22T12:30:31")\n54.     assert exc.value.args[0] == ("\'time_bin_start\' has been given both in the table "\n55.                                  "and as a keyword argument")\n56. \n57.     with pytest.raises(TypeError) as exc:\n58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},\n59.                          time_bin_size=[1]*u.s)\n60.     assert exc.value.args[0] == ("\'time_bin_size\' has been given both in the table "\n61.                                  "and as a keyword argument")\n62. \n63. \n64. def test_initialization_time_bin_size():\n65. \n66.     # Make sure things crash when time_bin_size has no units\n67. \n68.     with pytest.raises(TypeError) as exc:\n69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n70.                          time_bin_start="2016-03-22T12:30:31",\n71.                          time_bin_size=1)\n72.     assert exc.value.args[0] == ("\'time_bin_size\' should be a Quantity or a TimeDelta")\n73. \n74.     # TimeDelta for time_bin_size\n75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n76.                           time_bin_start="2016-03-22T12:30:31",\n77.                           time_bin_size=TimeDelta(1, format="jd"))\n78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)\n79. \n80. \n81. def test_initialization_time_bin_start_scalar():\n82. \n83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size\n84. \n85.     with pytest.raises(TypeError) as exc:\n86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n87.                          time_bin_start=Time(1, format=\'mjd\'),\n88.                          time_bin_end=Time(1, format=\'mjd\'))\n89.     assert exc.value.args[0] == ("\'time_bin_start\' is scalar, so \'time_bin_size\' is required")\n90. \n91. \n92. def test_initialization_n_bins_invalid_arguments():\n93. \n94.     # Make sure an exception is raised when n_bins is passed as an argument while\n95.     # any of the parameters \'time_bin_start\' or \'time_bin_end\' is not scalar.\n96. \n97.     with pytest.raises(TypeError) as exc:\n98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format=\'cxcsec\'),\n99.                          time_bin_size=1*u.s,\n100.                          n_bins=10)\n101.     assert exc.value.args[0] == ("\'n_bins\' cannot be specified if \'time_bin_start\' or "\n102.                                  "\'time_bin_size\' are not scalar\'")\n103. \n104. \n105. def test_initialization_n_bins():\n106. \n107.     # Make sure things crash with incorrect n_bins\n108. \n109.     with pytest.raises(TypeError) as exc:\n110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n111.                          time_bin_start=Time(1, format=\'mjd\'),\n112.                          time_bin_size=1*u.s,\n113.                          time_bin_end=Time(1, format=\'mjd\'),\n114.                          n_bins=10)\n115.     assert exc.value.args[0] == ("\'n_bins\' has been given and it is not the "\n116.                                  "same length as the input data.")\n117. \n118. \n119. def test_initialization_non_scalar_time():\n120. \n121.     # Make sure things crash with incorrect size of time_bin_start\n122. \n123.     with pytest.raises(ValueError) as exc:\n124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],\n126.                          time_bin_size=1*u.s,\n127.                          time_bin_end=Time(1, format=\'mjd\'))\n128.     assert exc.value.args[0] == ("Length of \'time_bin_start\' (2) should match table length (1)")\n129. \n130.     with pytest.raises(TypeError) as exc:\n131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n132.                          time_bin_start=["2016-03-22T12:30:31"],\n133.                          time_bin_size=None,\n134.                          time_bin_end=None)\n135.     assert exc.value.args[0] == ("Either \'time_bin_size\' or \'time_bin_end\' should be specified")\n136. \n137. \n138. def test_even_contiguous():\n139. \n140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying\n141.     # the bin width:\n142. \n143.     ts = BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\',\n144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])\n145. \n146.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n147.                                           \'2016-03-22T12:30:34.000\',\n148.                                           \'2016-03-22T12:30:37.000\'])\n149. \n150.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:32.500\',\n151.                                            \'2016-03-22T12:30:35.500\',\n152.                                            \'2016-03-22T12:30:38.500\'])\n153. \n154.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:34.000\',\n155.                                         \'2016-03-22T12:30:37.000\',\n156.                                         \'2016-03-22T12:30:40.000\'])\n157. \n158. \n159. def test_uneven_contiguous():\n160. \n161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an\n162.     # end time:\n163. \n164.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n165.                                           \'2016-03-22T12:30:32\',\n166.                                           \'2016-03-22T12:30:40\'],\n167.                           time_bin_end=\'2016-03-22T12:30:55\',\n168.                           data=[[1, 4, 3]])\n169. \n170.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n171.                                           \'2016-03-22T12:30:32.000\',\n172.                                           \'2016-03-22T12:30:40.000\'])\n173. \n174.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:31.500\',\n175.                                            \'2016-03-22T12:30:36.000\',\n176.                                            \'2016-03-22T12:30:47.500\'])\n177. \n178.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:32.000\',\n179.                                         \'2016-03-22T12:30:40.000\',\n180.                                         \'2016-03-22T12:30:55.000\'])\n181. \n182. \n183. def test_uneven_non_contiguous():\n184. \n185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with\n186.     # lists of start times, bin sizes and data:\n187. \n188.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n189.                                           \'2016-03-22T12:30:38\',\n190.                                           \'2016-03-22T12:34:40\'],\n191.                           time_bin_size=[5, 100, 2]*u.s,\n192.                           data=[[1, 4, 3]])\n193. \n194.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n195.                                           \'2016-03-22T12:30:38.000\',\n196.                                           \'2016-03-22T12:34:40.000\'])\n197. \n198.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:33.500\',\n199.                                            \'2016-03-22T12:31:28.000\',\n200.                                            \'2016-03-22T12:34:41.000\'])\n201. \n202.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:36.000\',\n203.                                         \'2016-03-22T12:32:18.000\',\n204.                                         \'2016-03-22T12:34:42.000\'])\n205. \n206. \n207. def test_uneven_non_contiguous_full():\n208. \n209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by\n210.     # specifying the start and end times for the bins:\n211. \n212.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n213.                                           \'2016-03-22T12:30:33\',\n214.                                           \'2016-03-22T12:30:40\'],\n215.                           time_bin_end=[\'2016-03-22T12:30:32\',\n216.                                         \'2016-03-22T12:30:35\',\n217.                                         \'2016-03-22T12:30:41\'],\n218.                           data=[[1, 4, 3]])\n219. \n220.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n221.                                           \'2016-03-22T12:30:33.000\',\n222.                                           \'2016-03-22T12:30:40.000\'])\n223. \n224.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:31.500\',\n225.                                            \'2016-03-22T12:30:34.000\',\n226.                                            \'2016-03-22T12:30:40.500\'])\n227. \n228.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:32.000\',\n229.                                         \'2016-03-22T12:30:35.000\',\n230.                                         \'2016-03-22T12:30:41.000\'])\n231. \n232. \n233. def test_read_empty():\n234.     with pytest.raises(ValueError) as exc:\n235.         BinnedTimeSeries.read(CSV_FILE, format=\'csv\')\n236.     assert exc.value.args[0] == \'``time_bin_start_column`` should be provided since the default Table readers are being used.\'\n237. \n238. \n239. def test_read_no_size_end():\n240.     with pytest.raises(ValueError) as exc:\n241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', format=\'csv\')\n242.     assert exc.value.args[0] == \'Either `time_bin_end_column` or `time_bin_size_column` should be provided.\'\n243. \n244. \n245. def test_read_both_extra_bins():\n246.     with pytest.raises(ValueError) as exc:\n247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_end_column=\'END\', time_bin_size_column=\'bin_size\', format=\'csv\')\n248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."\n249. \n250. \n251. def test_read_size_no_unit():\n252.     with pytest.raises(ValueError) as exc:\n253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column=\'bin_size\', format=\'csv\')\n254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."\n255. \n256. \n257. def test_read_start_time_missing():\n258.     with pytest.raises(ValueError) as exc:\n259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'abc\', time_bin_size_column=\'bin_size\', time_bin_size_unit=u.second, format=\'csv\')\n260.     assert exc.value.args[0] == "Bin start time column \'abc\' not found in the input data."\n261. \n262. \n263. def test_read_end_time_missing():\n264.     with pytest.raises(ValueError) as exc:\n265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_end_column="missing", format=\'csv\')\n266.     assert exc.value.args[0] == "Bin end time column \'missing\' not found in the input data."\n267. \n268. \n269. def test_read_size_missing():\n270.     with pytest.raises(ValueError) as exc:\n271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column="missing", time_bin_size_unit=u.second, format=\'csv\')\n272.     assert exc.value.args[0] == "Bin size column \'missing\' not found in the input data."\n273. \n274. \n275. def test_read_time_unit_missing():\n276.     with pytest.raises(ValueError) as exc:\n277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column="bin_size", format=\'csv\')\n278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."\n279. \n280. \n281. def test_read():\n282. \n283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\',\n284.                                        time_bin_end_column=\'time_end\', format=\'csv\')\n285.     assert timeseries.colnames == [\'time_bin_start\', \'time_bin_size\', \'bin_size\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\']\n286.     assert len(timeseries) == 10\n287.     assert timeseries[\'B\'].sum() == 1151.54\n288. \n289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\',\n290.                                        time_bin_size_column=\'bin_size\',\n291.                                        time_bin_size_unit=u.second, format=\'csv\')\n292.     assert timeseries.colnames == [\'time_bin_start\', \'time_bin_size\', \'time_end\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\']\n293.     assert len(timeseries) == 10\n294.     assert timeseries[\'B\'].sum() == 1151.54\n295. \n296. \n297. @pytest.mark.parametrize(\'cls\', [BoxLeastSquares, LombScargle])\n298. def test_periodogram(cls):\n299. \n300.     # Note that we don\'t need to check the actual results from the periodogram\n301.     # classes here since these are tested extensively in\n302.     # astropy.timeseries.periodograms.\n303. \n304.     ts = BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\',\n305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=[\'a\', \'b\'])\n306. \n307.     p1 = cls.from_timeseries(ts, \'a\')\n308.     assert isinstance(p1, cls)\n309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)\n310.     assert_equal(p1.y, ts[\'a\'])\n311.     assert p1.dy is None\n312. \n313.     p2 = cls.from_timeseries(ts, \'a\', uncertainty=\'b\')\n314.     assert_quantity_allclose(p2.dy, ts[\'b\'])\n315. \n316.     p3 = cls.from_timeseries(ts, \'a\', uncertainty=0.1)\n317.     assert_allclose(p3.dy, 0.1)', start_line_number=1, end_line_number=317)]
2025-10-04 06:08:30,924 - thread-139911184823872.app.lang_graph.nodes.reset_messages_node - DEBUG - Resetting context_provider_messages in state.
2025-10-04 06:08:30,924 - thread-139911184823872.app.lang_graph.nodes.context_refine_node - INFO - Reached max_refined_query_loop, not asking for more context
2025-10-04 06:08:30,925 - thread-139911184823872.app.lang_graph.nodes.context_retrieval_subgraph_node - INFO - Context retrieved: [Context(relative_path='astropy/timeseries/tests/test_sampled.py', content='1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n2. \n3. from datetime import datetime\n4. \n5. import pytest\n6. \n7. from numpy.testing import assert_equal, assert_allclose\n8. \n9. from astropy.table import Table, Column\n10. from astropy.time import Time, TimeDelta\n11. from astropy import units as u\n12. from astropy.units import Quantity\n13. from astropy.utils.data import get_pkg_data_filename\n14. from astropy.tests.helper import assert_quantity_allclose\n15. \n16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle\n17. from astropy.timeseries.sampled import TimeSeries\n18. \n19. INPUT_TIME = Time([\'2016-03-22T12:30:31\',\n20.                    \'2015-01-21T12:30:32\',\n21.                    \'2016-03-22T12:30:40\'])\n22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=[\'a\', \'b\', \'c\'])\n23. \n24. CSV_FILE = get_pkg_data_filename(\'data/sampled.csv\')\n25. \n26. \n27. def test_empty_initialization():\n28.     ts = TimeSeries()\n29.     ts[\'time\'] = Time([50001, 50002, 50003], format=\'mjd\')\n30. \n31. \n32. def test_empty_initialization_invalid():\n33.     # Make sure things crash when the first column added is not a time column\n34.     ts = TimeSeries()\n35.     with pytest.raises(ValueError) as exc:\n36.         ts[\'flux\'] = [1, 2, 3]\n37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n38.                                  "\'time\' as the first column but found \'flux\'")\n39. \n40. \n41. def test_initialize_only_time():\n42.     ts = TimeSeries(time=INPUT_TIME)\n43.     assert ts[\'time\'] is ts.time\n44.     # NOTE: the object in the table is a copy\n45.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n46. \n47. \n48. def test_initialization_with_data():\n49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n50.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n51.     assert_equal(ts[\'a\'], [10, 2, 3])\n52.     assert_equal(ts[\'b\'], [4, 5, 6])\n53. \n54. \n55. def test_initialize_only_data():\n56.     with pytest.raises(TypeError) as exc:\n57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n58.     assert exc.value.args[0] == "Either \'time\' or \'time_start\' should be specified"\n59. \n60. \n61. def test_initialization_with_table():\n62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)\n63.     assert ts.colnames == [\'time\', \'a\', \'b\', \'c\']\n64. \n65. \n66. def test_initialization_with_time_delta():\n67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n68.                     time_delta=TimeDelta(3, format=\'sec\'),\n69.                     data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n70.     assert_equal(ts.time.isot, [\'2018-07-01T10:10:10.000\',\n71.                                 \'2018-07-01T10:10:13.000\',\n72.                                 \'2018-07-01T10:10:16.000\'])\n73. \n74. \n75. def test_initialization_missing_time_delta():\n76.     with pytest.raises(TypeError) as exc:\n77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n78.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n79.     assert exc.value.args[0] == "\'time\' is scalar, so \'time_delta\' is required"\n80. \n81. \n82. def test_initialization_invalid_time_and_time_start():\n83.     with pytest.raises(TypeError) as exc:\n84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),\n85.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n86.     assert exc.value.args[0] == "Cannot specify both \'time\' and \'time_start\'"\n87. \n88. \n89. def test_initialization_invalid_time_delta():\n90.     with pytest.raises(TypeError) as exc:\n91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n92.                    time_delta=[1, 4, 3],\n93.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n94.     assert exc.value.args[0] == "\'time_delta\' should be a Quantity or a TimeDelta"\n95. \n96. \n97. def test_initialization_with_time_in_data():\n98. \n99.     data = PLAIN_TABLE.copy()\n100.     data[\'time\'] = INPUT_TIME\n101. \n102.     ts1 = TimeSeries(data=data)\n103. \n104.     assert set(ts1.colnames) == set([\'time\', \'a\', \'b\', \'c\'])\n105.     assert all(ts1.time == INPUT_TIME)\n106. \n107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=[\'a\', \'time\'])\n108.     assert set(ts2.colnames) == set([\'time\', \'a\'])\n109.     assert all(ts2.time == INPUT_TIME)\n110. \n111.     with pytest.raises(TypeError) as exc:\n112.         # Don\'t allow ambiguous cases of passing multiple \'time\' columns\n113.         TimeSeries(data=data, time=INPUT_TIME)\n114.     assert exc.value.args[0] == "\'time\' has been given both in the table and as a keyword argument"\n115. \n116.     with pytest.raises(TypeError) as exc:\n117.         # \'time\' is a protected name, don\'t allow ambiguous cases\n118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=[\'a\', \'time\'])\n119.     assert exc.value.args[0] == "\'time\' has been given both in the table and as a keyword argument"\n120. \n121. \n122. def test_initialization_n_samples():\n123. \n124.     # Make sure things crash with incorrect n_samples\n125. \n126.     with pytest.raises(TypeError) as exc:\n127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)\n128.     assert exc.value.args[0] == ("\'n_samples\' has been given both and it is not the "\n129.                                  "same length as the input data.")\n130. \n131. \n132. def test_initialization_length_mismatch():\n133.     with pytest.raises(ValueError) as exc:\n134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=[\'a\', \'b\'])\n135.     assert exc.value.args[0] == "Length of \'time\' (3) should match data length (2)"\n136. \n137. \n138. def test_initialization_invalid_both_time_and_time_delta():\n139.     with pytest.raises(TypeError) as exc:\n140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format=\'sec\'))\n141.     assert exc.value.args[0] == ("\'time_delta\' should not be specified since "\n142.                                  "\'time\' is an array")\n143. \n144. \n145. def test_fold():\n146. \n147.     times = Time([1, 2, 3, 8, 9, 12], format=\'unix\')\n148. \n149.     ts = TimeSeries(time=times)\n150.     ts[\'flux\'] = [1, 4, 4, 3, 2, 3]\n151. \n152.     # Try without epoch time, as it should default to the first time and\n153.     # wrapping at half the period.\n154.     tsf = ts.fold(period=3.2 * u.s)\n155.     assert isinstance(tsf.time, TimeDelta)\n156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)\n157. \n158.     # Try with epoch time\n159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format=\'unix\'))\n160.     assert isinstance(tsf.time, TimeDelta)\n161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)\n162. \n163.     # Now with wrap_phase set to the full period\n164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)\n165.     assert isinstance(tsf.time, TimeDelta)\n166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)\n167. \n168.     # Now set epoch_phase to be 1/4 of the way through the phase\n169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)\n170.     assert isinstance(tsf.time, TimeDelta)\n171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)\n172. \n173.     # And combining epoch_phase and wrap_phase\n174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)\n175.     assert isinstance(tsf.time, TimeDelta)\n176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)\n177. \n178.     # Now repeat the above tests but with normalization applied\n179. \n180.     # Try without epoch time, as it should default to the first time and\n181.     # wrapping at half the period.\n182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)\n183.     assert isinstance(tsf.time, Quantity)\n184.     assert_allclose(tsf.time.to_value(u.one),\n185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],\n186.                     rtol=1e-6)\n187. \n188.     # Try with epoch time\n189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format=\'unix\'),\n190.                   normalize_phase=True)\n191.     assert isinstance(tsf.time, Quantity)\n192.     assert_allclose(tsf.time.to_value(u.one),\n193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],\n194.                     rtol=1e-6, atol=1e-6)\n195. \n196.     # Now with wrap_phase set to the full period\n197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)\n198.     assert isinstance(tsf.time, Quantity)\n199.     assert_allclose(tsf.time.to_value(u.one),\n200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],\n201.                     rtol=1e-6)\n202. \n203.     # Now set epoch_phase to be 1/4 of the way through the phase\n204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)\n205.     assert isinstance(tsf.time, Quantity)\n206.     assert_allclose(tsf.time.to_value(u.one),\n207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],\n208.                     rtol=1e-6)\n209. \n210.     # And combining epoch_phase and wrap_phase\n211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,\n212.                   normalize_phase=True)\n213.     assert isinstance(tsf.time, Quantity)\n214.     assert_allclose(tsf.time.to_value(u.one),\n215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],\n216.                     rtol=1e-6)\n217. \n218. \n219. def test_fold_invalid_options():\n220. \n221.     times = Time([1, 2, 3, 8, 9, 12], format=\'unix\')\n222. \n223.     ts = TimeSeries(time=times)\n224.     ts[\'flux\'] = [1, 4, 4, 3, 2, 3]\n225. \n226.     with pytest.raises(u.UnitsError,\n227.                        match=\'period should be a Quantity in units of time\'):\n228.         ts.fold(period=3.2)\n229. \n230.     with pytest.raises(u.UnitsError,\n231.                        match=\'period should be a Quantity in units of time\'):\n232.         ts.fold(period=3.2 * u.m)\n233. \n234.     with pytest.raises(u.UnitsError,\n235.                        match=\'epoch_phase should be a Quantity in units of \'\n236.                              \'time when normalize_phase=False\'):\n237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)\n238. \n239.     with pytest.raises(u.UnitsError,\n240.                        match=\'epoch_phase should be a dimensionless Quantity \'\n241.                              \'or a float when normalize_phase=True\'):\n242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)\n243. \n244.     with pytest.raises(u.UnitsError,\n245.                        match=\'wrap_phase should be a Quantity in units of \'\n246.                              \'time when normalize_phase=False\'):\n247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)\n248. \n249.     with pytest.raises(u.UnitsError,\n250.                        match=\'wrap_phase should be dimensionless when \'\n251.                              \'normalize_phase=True\'):\n252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)\n253. \n254.     with pytest.raises(ValueError,\n255.                        match=\'wrap_phase should be between 0 and the period\'):\n256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)\n257. \n258.     with pytest.raises(ValueError,\n259.                        match=\'wrap_phase should be between 0 and the period\'):\n260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)\n261. \n262.     with pytest.raises(ValueError,\n263.                        match=\'wrap_phase should be between 0 and 1\'):\n264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)\n265. \n266.     with pytest.raises(ValueError,\n267.                        match=\'wrap_phase should be between 0 and 1\'):\n268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)\n269. \n270. \n271. def test_pandas():\n272.     pandas = pytest.importorskip("pandas")\n273. \n274.     df1 = pandas.DataFrame()\n275.     df1[\'a\'] = [1, 2, 3]\n276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)\n277. \n278.     ts = TimeSeries.from_pandas(df1)\n279.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n280.     assert ts.colnames == [\'time\', \'a\']\n281.     assert len(ts.indices) == 1\n282.     assert (ts.indices[\'time\'].columns[0] == INPUT_TIME).all()\n283. \n284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale=\'tcb\')\n285.     assert ts_tcb.time.scale == \'tcb\'\n286. \n287.     df2 = ts.to_pandas()\n288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()\n289.     assert df2.columns == pandas.Index([\'a\'])\n290.     assert (df1[\'a\'] == df2[\'a\']).all()\n291. \n292.     with pytest.raises(TypeError) as exc:\n293.         TimeSeries.from_pandas(None)\n294.     assert exc.value.args[0] == \'Input should be a pandas DataFrame\'\n295. \n296.     df4 = pandas.DataFrame()\n297.     df4[\'a\'] = [1, 2, 3]\n298. \n299.     with pytest.raises(TypeError) as exc:\n300.         TimeSeries.from_pandas(df4)\n301.     assert exc.value.args[0] == \'DataFrame does not have a DatetimeIndex\'\n302. \n303. \n304. def test_read_time_missing():\n305.     with pytest.raises(ValueError) as exc:\n306.         TimeSeries.read(CSV_FILE, format=\'csv\')\n307.     assert exc.value.args[0] == \'``time_column`` should be provided since the default Table readers are being used.\'\n308. \n309. \n310. def test_read_time_wrong():\n311.     with pytest.raises(ValueError) as exc:\n312.         TimeSeries.read(CSV_FILE, time_column=\'abc\', format=\'csv\')\n313.     assert exc.value.args[0] == "Time column \'abc\' not found in the input data."\n314. \n315. \n316. def test_read():\n317.     timeseries = TimeSeries.read(CSV_FILE, time_column=\'Date\', format=\'csv\')\n318.     assert timeseries.colnames == [\'time\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\', \'G\']\n319.     assert len(timeseries) == 11\n320.     assert timeseries[\'time\'].format == \'iso\'\n321.     assert timeseries[\'A\'].sum() == 266.5\n322. \n323. \n324. @pytest.mark.remote_data(source=\'astropy\')\n325. def test_kepler_astropy():\n326.     from astropy.units import UnitsWarning\n327. \n328.     filename = get_pkg_data_filename(\'timeseries/kplr010666592-2009131110544_slc.fits\')\n329. \n330.     with pytest.warns(UnitsWarning):\n331.         timeseries = TimeSeries.read(filename, format=\'kepler.fits\')\n332. \n333.     assert timeseries["time"].format == \'isot\'\n334.     assert timeseries["time"].scale == \'tdb\'\n335.     assert timeseries["sap_flux"].unit.to_string() == \'electron / s\'\n336.     assert len(timeseries) == 14280\n337.     assert len(timeseries.columns) == 20\n338. \n339. \n340. @pytest.mark.remote_data(source=\'astropy\')\n341. def test_tess_astropy():\n342.     filename = get_pkg_data_filename(\'timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits\')\n343.     with pytest.warns(UserWarning, match=\'Ignoring 815 rows with NaN times\'):\n344.         timeseries = TimeSeries.read(filename, format=\'tess.fits\')\n345.     assert timeseries["time"].format == \'isot\'\n346.     assert timeseries["time"].scale == \'tdb\'\n347.     assert timeseries["sap_flux"].unit.to_string() == \'electron / s\'\n348.     assert len(timeseries) == 19261\n349.     assert len(timeseries.columns) == 20\n350. \n351. \n352. def test_required_columns():\n353. \n354.     # Test the machinery that makes sure that the required columns are present\n355. \n356.     ts = TimeSeries(time=INPUT_TIME,\n357.                     data=[[10, 2, 3], [4, 5, 6]],\n358.                     names=[\'a\', \'b\'])\n359. \n360.     # In the examples below, the operation (e.g. remove_column) is actually\n361.     # carried out before the checks are made, so we need to use copy() so that\n362.     # we don\'t change the main version of the time series.\n363. \n364.     # Make sure copy works fine\n365.     ts.copy()\n366. \n367.     with pytest.raises(ValueError) as exc:\n368.         ts.copy().add_column(Column([3, 4, 5], name=\'c\'), index=0)\n369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n370.                                  "\'time\' as the first column but found \'c\'")\n371. \n372.     with pytest.raises(ValueError) as exc:\n373.         ts.copy().add_columns([Column([3, 4, 5], name=\'d\'),\n374.                                Column([3, 4, 5], name=\'e\')], indexes=[0, 1])\n375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n376.                                  "\'time\' as the first column but found \'d\'")\n377. \n378.     with pytest.raises(ValueError) as exc:\n379.         ts.copy().keep_columns([\'a\', \'b\'])\n380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n381.                                  "\'time\' as the first column but found \'a\'")\n382. \n383.     with pytest.raises(ValueError) as exc:\n384.         ts.copy().remove_column(\'time\')\n385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n386.                                  "\'time\' as the first column but found \'a\'")\n387. \n388.     with pytest.raises(ValueError) as exc:\n389.         ts.copy().remove_columns([\'time\', \'a\'])\n390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n391.                                  "\'time\' as the first column but found \'b\'")\n392. \n393.     with pytest.raises(ValueError) as exc:\n394.         ts.copy().rename_column(\'time\', \'banana\')\n395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n396.                                  "\'time\' as the first column but found \'banana\'")\n397. \n398. \n399. @pytest.mark.parametrize(\'cls\', [BoxLeastSquares, LombScargle])\n400. def test_periodogram(cls):\n401. \n402.     # Note that we don\'t need to check the actual results from the periodogram\n403.     # classes here since these are tested extensively in\n404.     # astropy.timeseries.periodograms.\n405. \n406.     ts = TimeSeries(time=INPUT_TIME,\n407.                     data=[[10, 2, 3], [4, 5, 6]],\n408.                     names=[\'a\', \'b\'])\n409. \n410.     p1 = cls.from_timeseries(ts, \'a\')\n411.     assert isinstance(p1, cls)\n412.     assert_allclose(p1.t.jd, ts.time.jd)\n413.     assert_equal(p1.y, ts[\'a\'])\n414.     assert p1.dy is None\n415. \n416.     p2 = cls.from_timeseries(ts, \'a\', uncertainty=\'b\')\n417.     assert_quantity_allclose(p2.dy, ts[\'b\'])\n418. \n419.     p3 = cls.from_timeseries(ts, \'a\', uncertainty=0.1)\n420.     assert_allclose(p3.dy, 0.1)', start_line_number=1, end_line_number=420), Context(relative_path='astropy/timeseries/tests/test_binned.py', content='1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n2. \n3. import pytest\n4. from numpy.testing import assert_equal, assert_allclose\n5. \n6. from astropy import units as u\n7. from astropy.time import Time, TimeDelta\n8. from astropy.utils.data import get_pkg_data_filename\n9. \n10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle\n11. from astropy.timeseries.binned import BinnedTimeSeries\n12. from astropy.tests.helper import assert_quantity_allclose\n13. \n14. \n15. CSV_FILE = get_pkg_data_filename(\'data/binned.csv\')\n16. \n17. \n18. def test_empty_initialization():\n19.     ts = BinnedTimeSeries()\n20.     ts[\'time_bin_start\'] = Time([1, 2, 3], format=\'mjd\')\n21. \n22. \n23. def test_empty_initialization_invalid():\n24. \n25.     # Make sure things crash when the first column added is not a time column\n26. \n27.     ts = BinnedTimeSeries()\n28.     with pytest.raises(ValueError) as exc:\n29.         ts[\'flux\'] = [1, 2, 3]\n30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "\n31.                                  "\'time_bin_start\' as the first column but found \'flux\'")\n32. \n33. \n34. def test_initialization_time_bin_invalid():\n35. \n36.     # Make sure things crash when time_bin_* is passed incorrectly.\n37. \n38.     with pytest.raises(TypeError) as exc:\n39.         BinnedTimeSeries(data=[[1, 4, 3]])\n40.     assert exc.value.args[0] == ("\'time_bin_start\' has not been specified")\n41. \n42.     with pytest.raises(TypeError) as exc:\n43.         BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\', data=[[1, 4, 3]])\n44.     assert exc.value.args[0] == ("Either \'time_bin_size\' or \'time_bin_end\' should be specified")\n45. \n46. \n47. def test_initialization_time_bin_both():\n48. \n49.     # Make sure things crash when time_bin_* is passed twice.\n50. \n51.     with pytest.raises(TypeError) as exc:\n52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},\n53.                          time_bin_start="2016-03-22T12:30:31")\n54.     assert exc.value.args[0] == ("\'time_bin_start\' has been given both in the table "\n55.                                  "and as a keyword argument")\n56. \n57.     with pytest.raises(TypeError) as exc:\n58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},\n59.                          time_bin_size=[1]*u.s)\n60.     assert exc.value.args[0] == ("\'time_bin_size\' has been given both in the table "\n61.                                  "and as a keyword argument")\n62. \n63. \n64. def test_initialization_time_bin_size():\n65. \n66.     # Make sure things crash when time_bin_size has no units\n67. \n68.     with pytest.raises(TypeError) as exc:\n69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n70.                          time_bin_start="2016-03-22T12:30:31",\n71.                          time_bin_size=1)\n72.     assert exc.value.args[0] == ("\'time_bin_size\' should be a Quantity or a TimeDelta")\n73. \n74.     # TimeDelta for time_bin_size\n75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n76.                           time_bin_start="2016-03-22T12:30:31",\n77.                           time_bin_size=TimeDelta(1, format="jd"))\n78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)\n79. \n80. \n81. def test_initialization_time_bin_start_scalar():\n82. \n83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size\n84. \n85.     with pytest.raises(TypeError) as exc:\n86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n87.                          time_bin_start=Time(1, format=\'mjd\'),\n88.                          time_bin_end=Time(1, format=\'mjd\'))\n89.     assert exc.value.args[0] == ("\'time_bin_start\' is scalar, so \'time_bin_size\' is required")\n90. \n91. \n92. def test_initialization_n_bins_invalid_arguments():\n93. \n94.     # Make sure an exception is raised when n_bins is passed as an argument while\n95.     # any of the parameters \'time_bin_start\' or \'time_bin_end\' is not scalar.\n96. \n97.     with pytest.raises(TypeError) as exc:\n98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format=\'cxcsec\'),\n99.                          time_bin_size=1*u.s,\n100.                          n_bins=10)\n101.     assert exc.value.args[0] == ("\'n_bins\' cannot be specified if \'time_bin_start\' or "\n102.                                  "\'time_bin_size\' are not scalar\'")\n103. \n104. \n105. def test_initialization_n_bins():\n106. \n107.     # Make sure things crash with incorrect n_bins\n108. \n109.     with pytest.raises(TypeError) as exc:\n110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n111.                          time_bin_start=Time(1, format=\'mjd\'),\n112.                          time_bin_size=1*u.s,\n113.                          time_bin_end=Time(1, format=\'mjd\'),\n114.                          n_bins=10)\n115.     assert exc.value.args[0] == ("\'n_bins\' has been given and it is not the "\n116.                                  "same length as the input data.")\n117. \n118. \n119. def test_initialization_non_scalar_time():\n120. \n121.     # Make sure things crash with incorrect size of time_bin_start\n122. \n123.     with pytest.raises(ValueError) as exc:\n124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],\n126.                          time_bin_size=1*u.s,\n127.                          time_bin_end=Time(1, format=\'mjd\'))\n128.     assert exc.value.args[0] == ("Length of \'time_bin_start\' (2) should match table length (1)")\n129. \n130.     with pytest.raises(TypeError) as exc:\n131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n132.                          time_bin_start=["2016-03-22T12:30:31"],\n133.                          time_bin_size=None,\n134.                          time_bin_end=None)\n135.     assert exc.value.args[0] == ("Either \'time_bin_size\' or \'time_bin_end\' should be specified")\n136. \n137. \n138. def test_even_contiguous():\n139. \n140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying\n141.     # the bin width:\n142. \n143.     ts = BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\',\n144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])\n145. \n146.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n147.                                           \'2016-03-22T12:30:34.000\',\n148.                                           \'2016-03-22T12:30:37.000\'])\n149. \n150.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:32.500\',\n151.                                            \'2016-03-22T12:30:35.500\',\n152.                                            \'2016-03-22T12:30:38.500\'])\n153. \n154.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:34.000\',\n155.                                         \'2016-03-22T12:30:37.000\',\n156.                                         \'2016-03-22T12:30:40.000\'])\n157. \n158. \n159. def test_uneven_contiguous():\n160. \n161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an\n162.     # end time:\n163. \n164.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n165.                                           \'2016-03-22T12:30:32\',\n166.                                           \'2016-03-22T12:30:40\'],\n167.                           time_bin_end=\'2016-03-22T12:30:55\',\n168.                           data=[[1, 4, 3]])\n169. \n170.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n171.                                           \'2016-03-22T12:30:32.000\',\n172.                                           \'2016-03-22T12:30:40.000\'])\n173. \n174.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:31.500\',\n175.                                            \'2016-03-22T12:30:36.000\',\n176.                                            \'2016-03-22T12:30:47.500\'])\n177. \n178.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:32.000\',\n179.                                         \'2016-03-22T12:30:40.000\',\n180.                                         \'2016-03-22T12:30:55.000\'])\n181. \n182. \n183. def test_uneven_non_contiguous():\n184. \n185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with\n186.     # lists of start times, bin sizes and data:\n187. \n188.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n189.                                           \'2016-03-22T12:30:38\',\n190.                                           \'2016-03-22T12:34:40\'],\n191.                           time_bin_size=[5, 100, 2]*u.s,\n192.                           data=[[1, 4, 3]])\n193. \n194.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n195.                                           \'2016-03-22T12:30:38.000\',\n196.                                           \'2016-03-22T12:34:40.000\'])\n197. \n198.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:33.500\',\n199.                                            \'2016-03-22T12:31:28.000\',\n200.                                            \'2016-03-22T12:34:41.000\'])\n201. \n202.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:36.000\',\n203.                                         \'2016-03-22T12:32:18.000\',\n204.                                         \'2016-03-22T12:34:42.000\'])\n205. \n206. \n207. def test_uneven_non_contiguous_full():\n208. \n209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by\n210.     # specifying the start and end times for the bins:\n211. \n212.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n213.                                           \'2016-03-22T12:30:33\',\n214.                                           \'2016-03-22T12:30:40\'],\n215.                           time_bin_end=[\'2016-03-22T12:30:32\',\n216.                                         \'2016-03-22T12:30:35\',\n217.                                         \'2016-03-22T12:30:41\'],\n218.                           data=[[1, 4, 3]])\n219. \n220.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n221.                                           \'2016-03-22T12:30:33.000\',\n222.                                           \'2016-03-22T12:30:40.000\'])\n223. \n224.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:31.500\',\n225.                                            \'2016-03-22T12:30:34.000\',\n226.                                            \'2016-03-22T12:30:40.500\'])\n227. \n228.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:32.000\',\n229.                                         \'2016-03-22T12:30:35.000\',\n230.                                         \'2016-03-22T12:30:41.000\'])\n231. \n232. \n233. def test_read_empty():\n234.     with pytest.raises(ValueError) as exc:\n235.         BinnedTimeSeries.read(CSV_FILE, format=\'csv\')\n236.     assert exc.value.args[0] == \'``time_bin_start_column`` should be provided since the default Table readers are being used.\'\n237. \n238. \n239. def test_read_no_size_end():\n240.     with pytest.raises(ValueError) as exc:\n241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', format=\'csv\')\n242.     assert exc.value.args[0] == \'Either `time_bin_end_column` or `time_bin_size_column` should be provided.\'\n243. \n244. \n245. def test_read_both_extra_bins():\n246.     with pytest.raises(ValueError) as exc:\n247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_end_column=\'END\', time_bin_size_column=\'bin_size\', format=\'csv\')\n248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."\n249. \n250. \n251. def test_read_size_no_unit():\n252.     with pytest.raises(ValueError) as exc:\n253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column=\'bin_size\', format=\'csv\')\n254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."\n255. \n256. \n257. def test_read_start_time_missing():\n258.     with pytest.raises(ValueError) as exc:\n259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'abc\', time_bin_size_column=\'bin_size\', time_bin_size_unit=u.second, format=\'csv\')\n260.     assert exc.value.args[0] == "Bin start time column \'abc\' not found in the input data."\n261. \n262. \n263. def test_read_end_time_missing():\n264.     with pytest.raises(ValueError) as exc:\n265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_end_column="missing", format=\'csv\')\n266.     assert exc.value.args[0] == "Bin end time column \'missing\' not found in the input data."\n267. \n268. \n269. def test_read_size_missing():\n270.     with pytest.raises(ValueError) as exc:\n271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column="missing", time_bin_size_unit=u.second, format=\'csv\')\n272.     assert exc.value.args[0] == "Bin size column \'missing\' not found in the input data."\n273. \n274. \n275. def test_read_time_unit_missing():\n276.     with pytest.raises(ValueError) as exc:\n277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column="bin_size", format=\'csv\')\n278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."\n279. \n280. \n281. def test_read():\n282. \n283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\',\n284.                                        time_bin_end_column=\'time_end\', format=\'csv\')\n285.     assert timeseries.colnames == [\'time_bin_start\', \'time_bin_size\', \'bin_size\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\']\n286.     assert len(timeseries) == 10\n287.     assert timeseries[\'B\'].sum() == 1151.54\n288. \n289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\',\n290.                                        time_bin_size_column=\'bin_size\',\n291.                                        time_bin_size_unit=u.second, format=\'csv\')\n292.     assert timeseries.colnames == [\'time_bin_start\', \'time_bin_size\', \'time_end\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\']\n293.     assert len(timeseries) == 10\n294.     assert timeseries[\'B\'].sum() == 1151.54\n295. \n296. \n297. @pytest.mark.parametrize(\'cls\', [BoxLeastSquares, LombScargle])\n298. def test_periodogram(cls):\n299. \n300.     # Note that we don\'t need to check the actual results from the periodogram\n301.     # classes here since these are tested extensively in\n302.     # astropy.timeseries.periodograms.\n303. \n304.     ts = BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\',\n305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=[\'a\', \'b\'])\n306. \n307.     p1 = cls.from_timeseries(ts, \'a\')\n308.     assert isinstance(p1, cls)\n309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)\n310.     assert_equal(p1.y, ts[\'a\'])\n311.     assert p1.dy is None\n312. \n313.     p2 = cls.from_timeseries(ts, \'a\', uncertainty=\'b\')\n314.     assert_quantity_allclose(p2.dy, ts[\'b\'])\n315. \n316.     p3 = cls.from_timeseries(ts, \'a\', uncertainty=0.1)\n317.     assert_allclose(p3.dy, 0.1)', start_line_number=1, end_line_number=317)]
2025-10-04 06:08:30,925 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_write_message_node - DEBUG - Sending message to BugReproducingWriteNode:
content='Issue title:\nTimeSeries: misleading exception when required column check fails.\n\nIssue description: \n<!-- This comments are hidden when you submit the issue,\nso you do not need to remove them! -->\n\n<!-- Please be sure to check out our contributing guidelines,\nhttps://github.com/astropy/astropy/blob/main/CONTRIBUTING.md .\nPlease be sure to check out our code of conduct,\nhttps://github.com/astropy/astropy/blob/main/CODE_OF_CONDUCT.md . -->\n\n<!-- Please have a search on our GitHub repository to see if a similar\nissue has already been posted.\nIf a similar issue is closed, have a quick look to see if you are satisfied\nby the resolution.\nIf not please go ahead and open an issue! -->\n\n<!-- Please check that the development version still produces the same bug.\nYou can install development version with\npip install git+https://github.com/astropy/astropy\ncommand. -->\n\n### Description\n<!-- Provide a general description of the bug. -->\n\nFor a `TimeSeries` object that has additional required columns (in addition to `time`), when codes mistakenly try to remove a required column, the exception it produces is misleading.\n\n### Expected behavior\n<!-- What did you expect to happen. -->\nAn exception that informs the users required columns are missing.\n\n### Actual behavior\nThe actual exception message is confusing:\n`ValueError: TimeSeries object is invalid - expected \'time\' as the first columns but found \'time\'`\n\n### Steps to Reproduce\n<!-- Ideally a code example could be provided so we can run it ourselves. -->\n<!-- If you are pasting code, use triple backticks (```) around\nyour code snippet. -->\n<!-- If necessary, sanitize your screen output to be pasted so you do not\nreveal secrets like tokens and passwords. -->\n\n```python\nfrom astropy.time import Time\nfrom astropy.timeseries import TimeSeries\n\ntime=Time(np.arange(100000, 100003), format=\'jd\')\nts = TimeSeries(time=time, data = {"flux": [99.9, 99.8, 99.7]})\nts._required_columns = ["time", "flux"]                                   \nts.remove_column("flux")\n\n```\n\n### System Details\n<!-- Even if you do not think this is necessary, it is useful information for the maintainers.\nPlease run the following snippet and paste the output below:\nimport platform; print(platform.platform())\nimport sys; print("Python", sys.version)\nimport numpy; print("Numpy", numpy.__version__)\nimport erfa; print("pyerfa", erfa.__version__)\nimport astropy; print("astropy", astropy.__version__)\nimport scipy; print("Scipy", scipy.__version__)\nimport matplotlib; print("Matplotlib", matplotlib.__version__)\n-->\n```\nWindows-10-10.0.22000-SP0\nPython 3.9.10 | packaged by conda-forge | (main, Feb  1 2022, 21:21:54) [MSC v.1929 64 bit (AMD64)]\nNumpy 1.22.3\npyerfa 2.0.0.1\nastropy 5.0.3\nScipy 1.8.0\nMatplotlib 3.5.1\n```\n\nIssue comments:\n\n\nBug reproducing context:\nFile: astropy/timeseries/tests/test_sampled.py\nLine number range: 1 - 420\nContent:\n1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n2. \n3. from datetime import datetime\n4. \n5. import pytest\n6. \n7. from numpy.testing import assert_equal, assert_allclose\n8. \n9. from astropy.table import Table, Column\n10. from astropy.time import Time, TimeDelta\n11. from astropy import units as u\n12. from astropy.units import Quantity\n13. from astropy.utils.data import get_pkg_data_filename\n14. from astropy.tests.helper import assert_quantity_allclose\n15. \n16. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle\n17. from astropy.timeseries.sampled import TimeSeries\n18. \n19. INPUT_TIME = Time([\'2016-03-22T12:30:31\',\n20.                    \'2015-01-21T12:30:32\',\n21.                    \'2016-03-22T12:30:40\'])\n22. PLAIN_TABLE = Table([[1, 2, 11], [3, 4, 1], [1, 1, 1]], names=[\'a\', \'b\', \'c\'])\n23. \n24. CSV_FILE = get_pkg_data_filename(\'data/sampled.csv\')\n25. \n26. \n27. def test_empty_initialization():\n28.     ts = TimeSeries()\n29.     ts[\'time\'] = Time([50001, 50002, 50003], format=\'mjd\')\n30. \n31. \n32. def test_empty_initialization_invalid():\n33.     # Make sure things crash when the first column added is not a time column\n34.     ts = TimeSeries()\n35.     with pytest.raises(ValueError) as exc:\n36.         ts[\'flux\'] = [1, 2, 3]\n37.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n38.                                  "\'time\' as the first column but found \'flux\'")\n39. \n40. \n41. def test_initialize_only_time():\n42.     ts = TimeSeries(time=INPUT_TIME)\n43.     assert ts[\'time\'] is ts.time\n44.     # NOTE: the object in the table is a copy\n45.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n46. \n47. \n48. def test_initialization_with_data():\n49.     ts = TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n50.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n51.     assert_equal(ts[\'a\'], [10, 2, 3])\n52.     assert_equal(ts[\'b\'], [4, 5, 6])\n53. \n54. \n55. def test_initialize_only_data():\n56.     with pytest.raises(TypeError) as exc:\n57.         TimeSeries(data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n58.     assert exc.value.args[0] == "Either \'time\' or \'time_start\' should be specified"\n59. \n60. \n61. def test_initialization_with_table():\n62.     ts = TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE)\n63.     assert ts.colnames == [\'time\', \'a\', \'b\', \'c\']\n64. \n65. \n66. def test_initialization_with_time_delta():\n67.     ts = TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n68.                     time_delta=TimeDelta(3, format=\'sec\'),\n69.                     data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n70.     assert_equal(ts.time.isot, [\'2018-07-01T10:10:10.000\',\n71.                                 \'2018-07-01T10:10:13.000\',\n72.                                 \'2018-07-01T10:10:16.000\'])\n73. \n74. \n75. def test_initialization_missing_time_delta():\n76.     with pytest.raises(TypeError) as exc:\n77.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n78.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n79.     assert exc.value.args[0] == "\'time\' is scalar, so \'time_delta\' is required"\n80. \n81. \n82. def test_initialization_invalid_time_and_time_start():\n83.     with pytest.raises(TypeError) as exc:\n84.         TimeSeries(time=INPUT_TIME, time_start=datetime(2018, 7, 1, 10, 10, 10),\n85.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n86.     assert exc.value.args[0] == "Cannot specify both \'time\' and \'time_start\'"\n87. \n88. \n89. def test_initialization_invalid_time_delta():\n90.     with pytest.raises(TypeError) as exc:\n91.         TimeSeries(time_start=datetime(2018, 7, 1, 10, 10, 10),\n92.                    time_delta=[1, 4, 3],\n93.                    data=[[10, 2, 3], [4, 5, 6]], names=[\'a\', \'b\'])\n94.     assert exc.value.args[0] == "\'time_delta\' should be a Quantity or a TimeDelta"\n95. \n96. \n97. def test_initialization_with_time_in_data():\n98. \n99.     data = PLAIN_TABLE.copy()\n100.     data[\'time\'] = INPUT_TIME\n101. \n102.     ts1 = TimeSeries(data=data)\n103. \n104.     assert set(ts1.colnames) == set([\'time\', \'a\', \'b\', \'c\'])\n105.     assert all(ts1.time == INPUT_TIME)\n106. \n107.     ts2 = TimeSeries(data=[[10, 2, 3], INPUT_TIME], names=[\'a\', \'time\'])\n108.     assert set(ts2.colnames) == set([\'time\', \'a\'])\n109.     assert all(ts2.time == INPUT_TIME)\n110. \n111.     with pytest.raises(TypeError) as exc:\n112.         # Don\'t allow ambiguous cases of passing multiple \'time\' columns\n113.         TimeSeries(data=data, time=INPUT_TIME)\n114.     assert exc.value.args[0] == "\'time\' has been given both in the table and as a keyword argument"\n115. \n116.     with pytest.raises(TypeError) as exc:\n117.         # \'time\' is a protected name, don\'t allow ambiguous cases\n118.         TimeSeries(time=INPUT_TIME, data=[[10, 2, 3], INPUT_TIME], names=[\'a\', \'time\'])\n119.     assert exc.value.args[0] == "\'time\' has been given both in the table and as a keyword argument"\n120. \n121. \n122. def test_initialization_n_samples():\n123. \n124.     # Make sure things crash with incorrect n_samples\n125. \n126.     with pytest.raises(TypeError) as exc:\n127.         TimeSeries(time=INPUT_TIME, data=PLAIN_TABLE, n_samples=1000)\n128.     assert exc.value.args[0] == ("\'n_samples\' has been given both and it is not the "\n129.                                  "same length as the input data.")\n130. \n131. \n132. def test_initialization_length_mismatch():\n133.     with pytest.raises(ValueError) as exc:\n134.         TimeSeries(time=INPUT_TIME, data=[[10, 2], [4, 5]], names=[\'a\', \'b\'])\n135.     assert exc.value.args[0] == "Length of \'time\' (3) should match data length (2)"\n136. \n137. \n138. def test_initialization_invalid_both_time_and_time_delta():\n139.     with pytest.raises(TypeError) as exc:\n140.         TimeSeries(time=INPUT_TIME, time_delta=TimeDelta(3, format=\'sec\'))\n141.     assert exc.value.args[0] == ("\'time_delta\' should not be specified since "\n142.                                  "\'time\' is an array")\n143. \n144. \n145. def test_fold():\n146. \n147.     times = Time([1, 2, 3, 8, 9, 12], format=\'unix\')\n148. \n149.     ts = TimeSeries(time=times)\n150.     ts[\'flux\'] = [1, 4, 4, 3, 2, 3]\n151. \n152.     # Try without epoch time, as it should default to the first time and\n153.     # wrapping at half the period.\n154.     tsf = ts.fold(period=3.2 * u.s)\n155.     assert isinstance(tsf.time, TimeDelta)\n156.     assert_allclose(tsf.time.sec, [0, 1, -1.2, 0.6, -1.6, 1.4], rtol=1e-6)\n157. \n158.     # Try with epoch time\n159.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format=\'unix\'))\n160.     assert isinstance(tsf.time, TimeDelta)\n161.     assert_allclose(tsf.time.sec, [-0.6, 0.4, 1.4, 0.0, 1.0, 0.8], rtol=1e-6, atol=1e-6)\n162. \n163.     # Now with wrap_phase set to the full period\n164.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=3.2 * u.s)\n165.     assert isinstance(tsf.time, TimeDelta)\n166.     assert_allclose(tsf.time.sec, [0, 1, 2, 0.6, 1.6, 1.4], rtol=1e-6)\n167. \n168.     # Now set epoch_phase to be 1/4 of the way through the phase\n169.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s)\n170.     assert isinstance(tsf.time, TimeDelta)\n171.     assert_allclose(tsf.time.sec, [0.8, -1.4, -0.4, 1.4, -0.8, -1.0], rtol=1e-6)\n172. \n173.     # And combining epoch_phase and wrap_phase\n174.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.8 * u.s, wrap_phase=3.2 * u.s)\n175.     assert isinstance(tsf.time, TimeDelta)\n176.     assert_allclose(tsf.time.sec, [0.8, 1.8, 2.8, 1.4, 2.4, 2.2], rtol=1e-6)\n177. \n178.     # Now repeat the above tests but with normalization applied\n179. \n180.     # Try without epoch time, as it should default to the first time and\n181.     # wrapping at half the period.\n182.     tsf = ts.fold(period=3.2 * u.s, normalize_phase=True)\n183.     assert isinstance(tsf.time, Quantity)\n184.     assert_allclose(tsf.time.to_value(u.one),\n185.                     [0, 1/3.2, -1.2/3.2, 0.6/3.2, -1.6/3.2, 1.4/3.2],\n186.                     rtol=1e-6)\n187. \n188.     # Try with epoch time\n189.     tsf = ts.fold(period=3.2 * u.s, epoch_time=Time(1.6, format=\'unix\'),\n190.                   normalize_phase=True)\n191.     assert isinstance(tsf.time, Quantity)\n192.     assert_allclose(tsf.time.to_value(u.one),\n193.                     [-0.6/3.2, 0.4/3.2, 1.4/3.2, 0.0/3.2, 1.0/3.2, 0.8/3.2],\n194.                     rtol=1e-6, atol=1e-6)\n195. \n196.     # Now with wrap_phase set to the full period\n197.     tsf = ts.fold(period=3.2 * u.s, wrap_phase=1, normalize_phase=True)\n198.     assert isinstance(tsf.time, Quantity)\n199.     assert_allclose(tsf.time.to_value(u.one),\n200.                     [0, 1/3.2, 2/3.2, 0.6/3.2, 1.6/3.2, 1.4/3.2],\n201.                     rtol=1e-6)\n202. \n203.     # Now set epoch_phase to be 1/4 of the way through the phase\n204.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, normalize_phase=True)\n205.     assert isinstance(tsf.time, Quantity)\n206.     assert_allclose(tsf.time.to_value(u.one),\n207.                     [0.8/3.2, -1.4/3.2, -0.4/3.2, 1.4/3.2, -0.8/3.2, -1.0/3.2],\n208.                     rtol=1e-6)\n209. \n210.     # And combining epoch_phase and wrap_phase\n211.     tsf = ts.fold(period=3.2 * u.s, epoch_phase=0.25, wrap_phase=1,\n212.                   normalize_phase=True)\n213.     assert isinstance(tsf.time, Quantity)\n214.     assert_allclose(tsf.time.to_value(u.one),\n215.                     [0.8/3.2, 1.8/3.2, 2.8/3.2, 1.4/3.2, 2.4/3.2, 2.2/3.2],\n216.                     rtol=1e-6)\n217. \n218. \n219. def test_fold_invalid_options():\n220. \n221.     times = Time([1, 2, 3, 8, 9, 12], format=\'unix\')\n222. \n223.     ts = TimeSeries(time=times)\n224.     ts[\'flux\'] = [1, 4, 4, 3, 2, 3]\n225. \n226.     with pytest.raises(u.UnitsError,\n227.                        match=\'period should be a Quantity in units of time\'):\n228.         ts.fold(period=3.2)\n229. \n230.     with pytest.raises(u.UnitsError,\n231.                        match=\'period should be a Quantity in units of time\'):\n232.         ts.fold(period=3.2 * u.m)\n233. \n234.     with pytest.raises(u.UnitsError,\n235.                        match=\'epoch_phase should be a Quantity in units of \'\n236.                              \'time when normalize_phase=False\'):\n237.         ts.fold(period=3.2 * u.s, epoch_phase=0.2)\n238. \n239.     with pytest.raises(u.UnitsError,\n240.                        match=\'epoch_phase should be a dimensionless Quantity \'\n241.                              \'or a float when normalize_phase=True\'):\n242.         ts.fold(period=3.2 * u.s, epoch_phase=0.2 * u.s, normalize_phase=True)\n243. \n244.     with pytest.raises(u.UnitsError,\n245.                        match=\'wrap_phase should be a Quantity in units of \'\n246.                              \'time when normalize_phase=False\'):\n247.         ts.fold(period=3.2 * u.s, wrap_phase=0.2)\n248. \n249.     with pytest.raises(u.UnitsError,\n250.                        match=\'wrap_phase should be dimensionless when \'\n251.                              \'normalize_phase=True\'):\n252.         ts.fold(period=3.2 * u.s, wrap_phase=0.2 * u.s, normalize_phase=True)\n253. \n254.     with pytest.raises(ValueError,\n255.                        match=\'wrap_phase should be between 0 and the period\'):\n256.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1 * u.s)\n257. \n258.     with pytest.raises(ValueError,\n259.                        match=\'wrap_phase should be between 0 and the period\'):\n260.         ts.fold(period=3.2 * u.s, wrap_phase=-4.2 * u.s)\n261. \n262.     with pytest.raises(ValueError,\n263.                        match=\'wrap_phase should be between 0 and 1\'):\n264.         ts.fold(period=3.2 * u.s, wrap_phase=-0.1, normalize_phase=True)\n265. \n266.     with pytest.raises(ValueError,\n267.                        match=\'wrap_phase should be between 0 and 1\'):\n268.         ts.fold(period=3.2 * u.s, wrap_phase=2.2, normalize_phase=True)\n269. \n270. \n271. def test_pandas():\n272.     pandas = pytest.importorskip("pandas")\n273. \n274.     df1 = pandas.DataFrame()\n275.     df1[\'a\'] = [1, 2, 3]\n276.     df1.set_index(pandas.DatetimeIndex(INPUT_TIME.datetime64), inplace=True)\n277. \n278.     ts = TimeSeries.from_pandas(df1)\n279.     assert_equal(ts.time.isot, INPUT_TIME.isot)\n280.     assert ts.colnames == [\'time\', \'a\']\n281.     assert len(ts.indices) == 1\n282.     assert (ts.indices[\'time\'].columns[0] == INPUT_TIME).all()\n283. \n284.     ts_tcb = TimeSeries.from_pandas(df1, time_scale=\'tcb\')\n285.     assert ts_tcb.time.scale == \'tcb\'\n286. \n287.     df2 = ts.to_pandas()\n288.     assert (df2.index.values == pandas.Index(INPUT_TIME.datetime64).values).all()\n289.     assert df2.columns == pandas.Index([\'a\'])\n290.     assert (df1[\'a\'] == df2[\'a\']).all()\n291. \n292.     with pytest.raises(TypeError) as exc:\n293.         TimeSeries.from_pandas(None)\n294.     assert exc.value.args[0] == \'Input should be a pandas DataFrame\'\n295. \n296.     df4 = pandas.DataFrame()\n297.     df4[\'a\'] = [1, 2, 3]\n298. \n299.     with pytest.raises(TypeError) as exc:\n300.         TimeSeries.from_pandas(df4)\n301.     assert exc.value.args[0] == \'DataFrame does not have a DatetimeIndex\'\n302. \n303. \n304. def test_read_time_missing():\n305.     with pytest.raises(ValueError) as exc:\n306.         TimeSeries.read(CSV_FILE, format=\'csv\')\n307.     assert exc.value.args[0] == \'``time_column`` should be provided since the default Table readers are being used.\'\n308. \n309. \n310. def test_read_time_wrong():\n311.     with pytest.raises(ValueError) as exc:\n312.         TimeSeries.read(CSV_FILE, time_column=\'abc\', format=\'csv\')\n313.     assert exc.value.args[0] == "Time column \'abc\' not found in the input data."\n314. \n315. \n316. def test_read():\n317.     timeseries = TimeSeries.read(CSV_FILE, time_column=\'Date\', format=\'csv\')\n318.     assert timeseries.colnames == [\'time\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\', \'G\']\n319.     assert len(timeseries) == 11\n320.     assert timeseries[\'time\'].format == \'iso\'\n321.     assert timeseries[\'A\'].sum() == 266.5\n322. \n323. \n324. @pytest.mark.remote_data(source=\'astropy\')\n325. def test_kepler_astropy():\n326.     from astropy.units import UnitsWarning\n327. \n328.     filename = get_pkg_data_filename(\'timeseries/kplr010666592-2009131110544_slc.fits\')\n329. \n330.     with pytest.warns(UnitsWarning):\n331.         timeseries = TimeSeries.read(filename, format=\'kepler.fits\')\n332. \n333.     assert timeseries["time"].format == \'isot\'\n334.     assert timeseries["time"].scale == \'tdb\'\n335.     assert timeseries["sap_flux"].unit.to_string() == \'electron / s\'\n336.     assert len(timeseries) == 14280\n337.     assert len(timeseries.columns) == 20\n338. \n339. \n340. @pytest.mark.remote_data(source=\'astropy\')\n341. def test_tess_astropy():\n342.     filename = get_pkg_data_filename(\'timeseries/hlsp_tess-data-alerts_tess_phot_00025155310-s01_tess_v1_lc.fits\')\n343.     with pytest.warns(UserWarning, match=\'Ignoring 815 rows with NaN times\'):\n344.         timeseries = TimeSeries.read(filename, format=\'tess.fits\')\n345.     assert timeseries["time"].format == \'isot\'\n346.     assert timeseries["time"].scale == \'tdb\'\n347.     assert timeseries["sap_flux"].unit.to_string() == \'electron / s\'\n348.     assert len(timeseries) == 19261\n349.     assert len(timeseries.columns) == 20\n350. \n351. \n352. def test_required_columns():\n353. \n354.     # Test the machinery that makes sure that the required columns are present\n355. \n356.     ts = TimeSeries(time=INPUT_TIME,\n357.                     data=[[10, 2, 3], [4, 5, 6]],\n358.                     names=[\'a\', \'b\'])\n359. \n360.     # In the examples below, the operation (e.g. remove_column) is actually\n361.     # carried out before the checks are made, so we need to use copy() so that\n362.     # we don\'t change the main version of the time series.\n363. \n364.     # Make sure copy works fine\n365.     ts.copy()\n366. \n367.     with pytest.raises(ValueError) as exc:\n368.         ts.copy().add_column(Column([3, 4, 5], name=\'c\'), index=0)\n369.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n370.                                  "\'time\' as the first column but found \'c\'")\n371. \n372.     with pytest.raises(ValueError) as exc:\n373.         ts.copy().add_columns([Column([3, 4, 5], name=\'d\'),\n374.                                Column([3, 4, 5], name=\'e\')], indexes=[0, 1])\n375.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n376.                                  "\'time\' as the first column but found \'d\'")\n377. \n378.     with pytest.raises(ValueError) as exc:\n379.         ts.copy().keep_columns([\'a\', \'b\'])\n380.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n381.                                  "\'time\' as the first column but found \'a\'")\n382. \n383.     with pytest.raises(ValueError) as exc:\n384.         ts.copy().remove_column(\'time\')\n385.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n386.                                  "\'time\' as the first column but found \'a\'")\n387. \n388.     with pytest.raises(ValueError) as exc:\n389.         ts.copy().remove_columns([\'time\', \'a\'])\n390.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n391.                                  "\'time\' as the first column but found \'b\'")\n392. \n393.     with pytest.raises(ValueError) as exc:\n394.         ts.copy().rename_column(\'time\', \'banana\')\n395.     assert exc.value.args[0] == ("TimeSeries object is invalid - expected "\n396.                                  "\'time\' as the first column but found \'banana\'")\n397. \n398. \n399. @pytest.mark.parametrize(\'cls\', [BoxLeastSquares, LombScargle])\n400. def test_periodogram(cls):\n401. \n402.     # Note that we don\'t need to check the actual results from the periodogram\n403.     # classes here since these are tested extensively in\n404.     # astropy.timeseries.periodograms.\n405. \n406.     ts = TimeSeries(time=INPUT_TIME,\n407.                     data=[[10, 2, 3], [4, 5, 6]],\n408.                     names=[\'a\', \'b\'])\n409. \n410.     p1 = cls.from_timeseries(ts, \'a\')\n411.     assert isinstance(p1, cls)\n412.     assert_allclose(p1.t.jd, ts.time.jd)\n413.     assert_equal(p1.y, ts[\'a\'])\n414.     assert p1.dy is None\n415. \n416.     p2 = cls.from_timeseries(ts, \'a\', uncertainty=\'b\')\n417.     assert_quantity_allclose(p2.dy, ts[\'b\'])\n418. \n419.     p3 = cls.from_timeseries(ts, \'a\', uncertainty=0.1)\n420.     assert_allclose(p3.dy, 0.1)\n\n\nFile: astropy/timeseries/tests/test_binned.py\nLine number range: 1 - 317\nContent:\n1. # Licensed under a 3-clause BSD style license - see LICENSE.rst\n2. \n3. import pytest\n4. from numpy.testing import assert_equal, assert_allclose\n5. \n6. from astropy import units as u\n7. from astropy.time import Time, TimeDelta\n8. from astropy.utils.data import get_pkg_data_filename\n9. \n10. from astropy.timeseries.periodograms import BoxLeastSquares, LombScargle\n11. from astropy.timeseries.binned import BinnedTimeSeries\n12. from astropy.tests.helper import assert_quantity_allclose\n13. \n14. \n15. CSV_FILE = get_pkg_data_filename(\'data/binned.csv\')\n16. \n17. \n18. def test_empty_initialization():\n19.     ts = BinnedTimeSeries()\n20.     ts[\'time_bin_start\'] = Time([1, 2, 3], format=\'mjd\')\n21. \n22. \n23. def test_empty_initialization_invalid():\n24. \n25.     # Make sure things crash when the first column added is not a time column\n26. \n27.     ts = BinnedTimeSeries()\n28.     with pytest.raises(ValueError) as exc:\n29.         ts[\'flux\'] = [1, 2, 3]\n30.     assert exc.value.args[0] == ("BinnedTimeSeries object is invalid - expected "\n31.                                  "\'time_bin_start\' as the first column but found \'flux\'")\n32. \n33. \n34. def test_initialization_time_bin_invalid():\n35. \n36.     # Make sure things crash when time_bin_* is passed incorrectly.\n37. \n38.     with pytest.raises(TypeError) as exc:\n39.         BinnedTimeSeries(data=[[1, 4, 3]])\n40.     assert exc.value.args[0] == ("\'time_bin_start\' has not been specified")\n41. \n42.     with pytest.raises(TypeError) as exc:\n43.         BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\', data=[[1, 4, 3]])\n44.     assert exc.value.args[0] == ("Either \'time_bin_size\' or \'time_bin_end\' should be specified")\n45. \n46. \n47. def test_initialization_time_bin_both():\n48. \n49.     # Make sure things crash when time_bin_* is passed twice.\n50. \n51.     with pytest.raises(TypeError) as exc:\n52.         BinnedTimeSeries(data={"time_bin_start": ["2016-03-22T12:30:31"]},\n53.                          time_bin_start="2016-03-22T12:30:31")\n54.     assert exc.value.args[0] == ("\'time_bin_start\' has been given both in the table "\n55.                                  "and as a keyword argument")\n56. \n57.     with pytest.raises(TypeError) as exc:\n58.         BinnedTimeSeries(data={"time_bin_size": ["2016-03-22T12:30:31"]},\n59.                          time_bin_size=[1]*u.s)\n60.     assert exc.value.args[0] == ("\'time_bin_size\' has been given both in the table "\n61.                                  "and as a keyword argument")\n62. \n63. \n64. def test_initialization_time_bin_size():\n65. \n66.     # Make sure things crash when time_bin_size has no units\n67. \n68.     with pytest.raises(TypeError) as exc:\n69.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n70.                          time_bin_start="2016-03-22T12:30:31",\n71.                          time_bin_size=1)\n72.     assert exc.value.args[0] == ("\'time_bin_size\' should be a Quantity or a TimeDelta")\n73. \n74.     # TimeDelta for time_bin_size\n75.     ts = BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n76.                           time_bin_start="2016-03-22T12:30:31",\n77.                           time_bin_size=TimeDelta(1, format="jd"))\n78.     assert isinstance(ts.time_bin_size, u.quantity.Quantity)\n79. \n80. \n81. def test_initialization_time_bin_start_scalar():\n82. \n83.     # Make sure things crash when time_bin_start is a scalar with no time_bin_size\n84. \n85.     with pytest.raises(TypeError) as exc:\n86.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n87.                          time_bin_start=Time(1, format=\'mjd\'),\n88.                          time_bin_end=Time(1, format=\'mjd\'))\n89.     assert exc.value.args[0] == ("\'time_bin_start\' is scalar, so \'time_bin_size\' is required")\n90. \n91. \n92. def test_initialization_n_bins_invalid_arguments():\n93. \n94.     # Make sure an exception is raised when n_bins is passed as an argument while\n95.     # any of the parameters \'time_bin_start\' or \'time_bin_end\' is not scalar.\n96. \n97.     with pytest.raises(TypeError) as exc:\n98.         BinnedTimeSeries(time_bin_start=Time([1, 2, 3], format=\'cxcsec\'),\n99.                          time_bin_size=1*u.s,\n100.                          n_bins=10)\n101.     assert exc.value.args[0] == ("\'n_bins\' cannot be specified if \'time_bin_start\' or "\n102.                                  "\'time_bin_size\' are not scalar\'")\n103. \n104. \n105. def test_initialization_n_bins():\n106. \n107.     # Make sure things crash with incorrect n_bins\n108. \n109.     with pytest.raises(TypeError) as exc:\n110.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n111.                          time_bin_start=Time(1, format=\'mjd\'),\n112.                          time_bin_size=1*u.s,\n113.                          time_bin_end=Time(1, format=\'mjd\'),\n114.                          n_bins=10)\n115.     assert exc.value.args[0] == ("\'n_bins\' has been given and it is not the "\n116.                                  "same length as the input data.")\n117. \n118. \n119. def test_initialization_non_scalar_time():\n120. \n121.     # Make sure things crash with incorrect size of time_bin_start\n122. \n123.     with pytest.raises(ValueError) as exc:\n124.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n125.                          time_bin_start=["2016-03-22T12:30:31", "2016-03-22T12:30:32"],\n126.                          time_bin_size=1*u.s,\n127.                          time_bin_end=Time(1, format=\'mjd\'))\n128.     assert exc.value.args[0] == ("Length of \'time_bin_start\' (2) should match table length (1)")\n129. \n130.     with pytest.raises(TypeError) as exc:\n131.         BinnedTimeSeries(data={"time": ["2016-03-22T12:30:31"]},\n132.                          time_bin_start=["2016-03-22T12:30:31"],\n133.                          time_bin_size=None,\n134.                          time_bin_end=None)\n135.     assert exc.value.args[0] == ("Either \'time_bin_size\' or \'time_bin_end\' should be specified")\n136. \n137. \n138. def test_even_contiguous():\n139. \n140.     # Initialize a ``BinnedTimeSeries`` with even contiguous bins by specifying\n141.     # the bin width:\n142. \n143.     ts = BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\',\n144.                           time_bin_size=3 * u.s, data=[[1, 4, 3]])\n145. \n146.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n147.                                           \'2016-03-22T12:30:34.000\',\n148.                                           \'2016-03-22T12:30:37.000\'])\n149. \n150.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:32.500\',\n151.                                            \'2016-03-22T12:30:35.500\',\n152.                                            \'2016-03-22T12:30:38.500\'])\n153. \n154.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:34.000\',\n155.                                         \'2016-03-22T12:30:37.000\',\n156.                                         \'2016-03-22T12:30:40.000\'])\n157. \n158. \n159. def test_uneven_contiguous():\n160. \n161.     # Initialize a ``BinnedTimeSeries`` with uneven contiguous bins by giving an\n162.     # end time:\n163. \n164.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n165.                                           \'2016-03-22T12:30:32\',\n166.                                           \'2016-03-22T12:30:40\'],\n167.                           time_bin_end=\'2016-03-22T12:30:55\',\n168.                           data=[[1, 4, 3]])\n169. \n170.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n171.                                           \'2016-03-22T12:30:32.000\',\n172.                                           \'2016-03-22T12:30:40.000\'])\n173. \n174.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:31.500\',\n175.                                            \'2016-03-22T12:30:36.000\',\n176.                                            \'2016-03-22T12:30:47.500\'])\n177. \n178.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:32.000\',\n179.                                         \'2016-03-22T12:30:40.000\',\n180.                                         \'2016-03-22T12:30:55.000\'])\n181. \n182. \n183. def test_uneven_non_contiguous():\n184. \n185.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins with\n186.     # lists of start times, bin sizes and data:\n187. \n188.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n189.                                           \'2016-03-22T12:30:38\',\n190.                                           \'2016-03-22T12:34:40\'],\n191.                           time_bin_size=[5, 100, 2]*u.s,\n192.                           data=[[1, 4, 3]])\n193. \n194.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n195.                                           \'2016-03-22T12:30:38.000\',\n196.                                           \'2016-03-22T12:34:40.000\'])\n197. \n198.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:33.500\',\n199.                                            \'2016-03-22T12:31:28.000\',\n200.                                            \'2016-03-22T12:34:41.000\'])\n201. \n202.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:36.000\',\n203.                                         \'2016-03-22T12:32:18.000\',\n204.                                         \'2016-03-22T12:34:42.000\'])\n205. \n206. \n207. def test_uneven_non_contiguous_full():\n208. \n209.     # Initialize a ``BinnedTimeSeries`` with uneven non-contiguous bins by\n210.     # specifying the start and end times for the bins:\n211. \n212.     ts = BinnedTimeSeries(time_bin_start=[\'2016-03-22T12:30:31\',\n213.                                           \'2016-03-22T12:30:33\',\n214.                                           \'2016-03-22T12:30:40\'],\n215.                           time_bin_end=[\'2016-03-22T12:30:32\',\n216.                                         \'2016-03-22T12:30:35\',\n217.                                         \'2016-03-22T12:30:41\'],\n218.                           data=[[1, 4, 3]])\n219. \n220.     assert_equal(ts.time_bin_start.isot, [\'2016-03-22T12:30:31.000\',\n221.                                           \'2016-03-22T12:30:33.000\',\n222.                                           \'2016-03-22T12:30:40.000\'])\n223. \n224.     assert_equal(ts.time_bin_center.isot, [\'2016-03-22T12:30:31.500\',\n225.                                            \'2016-03-22T12:30:34.000\',\n226.                                            \'2016-03-22T12:30:40.500\'])\n227. \n228.     assert_equal(ts.time_bin_end.isot, [\'2016-03-22T12:30:32.000\',\n229.                                         \'2016-03-22T12:30:35.000\',\n230.                                         \'2016-03-22T12:30:41.000\'])\n231. \n232. \n233. def test_read_empty():\n234.     with pytest.raises(ValueError) as exc:\n235.         BinnedTimeSeries.read(CSV_FILE, format=\'csv\')\n236.     assert exc.value.args[0] == \'``time_bin_start_column`` should be provided since the default Table readers are being used.\'\n237. \n238. \n239. def test_read_no_size_end():\n240.     with pytest.raises(ValueError) as exc:\n241.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', format=\'csv\')\n242.     assert exc.value.args[0] == \'Either `time_bin_end_column` or `time_bin_size_column` should be provided.\'\n243. \n244. \n245. def test_read_both_extra_bins():\n246.     with pytest.raises(ValueError) as exc:\n247.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_end_column=\'END\', time_bin_size_column=\'bin_size\', format=\'csv\')\n248.     assert exc.value.args[0] == "Cannot specify both `time_bin_end_column` and `time_bin_size_column`."\n249. \n250. \n251. def test_read_size_no_unit():\n252.     with pytest.raises(ValueError) as exc:\n253.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column=\'bin_size\', format=\'csv\')\n254.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."\n255. \n256. \n257. def test_read_start_time_missing():\n258.     with pytest.raises(ValueError) as exc:\n259.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'abc\', time_bin_size_column=\'bin_size\', time_bin_size_unit=u.second, format=\'csv\')\n260.     assert exc.value.args[0] == "Bin start time column \'abc\' not found in the input data."\n261. \n262. \n263. def test_read_end_time_missing():\n264.     with pytest.raises(ValueError) as exc:\n265.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_end_column="missing", format=\'csv\')\n266.     assert exc.value.args[0] == "Bin end time column \'missing\' not found in the input data."\n267. \n268. \n269. def test_read_size_missing():\n270.     with pytest.raises(ValueError) as exc:\n271.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column="missing", time_bin_size_unit=u.second, format=\'csv\')\n272.     assert exc.value.args[0] == "Bin size column \'missing\' not found in the input data."\n273. \n274. \n275. def test_read_time_unit_missing():\n276.     with pytest.raises(ValueError) as exc:\n277.         BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\', time_bin_size_column="bin_size", format=\'csv\')\n278.     assert exc.value.args[0] == "The bin size unit should be specified as an astropy Unit using ``time_bin_size_unit``."\n279. \n280. \n281. def test_read():\n282. \n283.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\',\n284.                                        time_bin_end_column=\'time_end\', format=\'csv\')\n285.     assert timeseries.colnames == [\'time_bin_start\', \'time_bin_size\', \'bin_size\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\']\n286.     assert len(timeseries) == 10\n287.     assert timeseries[\'B\'].sum() == 1151.54\n288. \n289.     timeseries = BinnedTimeSeries.read(CSV_FILE, time_bin_start_column=\'time_start\',\n290.                                        time_bin_size_column=\'bin_size\',\n291.                                        time_bin_size_unit=u.second, format=\'csv\')\n292.     assert timeseries.colnames == [\'time_bin_start\', \'time_bin_size\', \'time_end\', \'A\', \'B\', \'C\', \'D\', \'E\', \'F\']\n293.     assert len(timeseries) == 10\n294.     assert timeseries[\'B\'].sum() == 1151.54\n295. \n296. \n297. @pytest.mark.parametrize(\'cls\', [BoxLeastSquares, LombScargle])\n298. def test_periodogram(cls):\n299. \n300.     # Note that we don\'t need to check the actual results from the periodogram\n301.     # classes here since these are tested extensively in\n302.     # astropy.timeseries.periodograms.\n303. \n304.     ts = BinnedTimeSeries(time_bin_start=\'2016-03-22T12:30:31\',\n305.                           time_bin_size=3 * u.s, data=[[1, 4, 3], [3, 4, 3]], names=[\'a\', \'b\'])\n306. \n307.     p1 = cls.from_timeseries(ts, \'a\')\n308.     assert isinstance(p1, cls)\n309.     assert_allclose(p1.t.jd, ts.time_bin_center.jd)\n310.     assert_equal(p1.y, ts[\'a\'])\n311.     assert p1.dy is None\n312. \n313.     p2 = cls.from_timeseries(ts, \'a\', uncertainty=\'b\')\n314.     assert_quantity_allclose(p2.dy, ts[\'b\'])\n315. \n316.     p3 = cls.from_timeseries(ts, \'a\', uncertainty=0.1)\n317.     assert_allclose(p3.dy, 0.1)\n\n\nNow generate the complete self-contained test case that reproduces the bug with the same error/exception.\n' additional_kwargs={} response_metadata={}
2025-10-04 06:08:57,518 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_write_node - DEBUG - content='```python\nimport pytest\nimport numpy as np\nfrom astropy.time import Time\nfrom astropy.timeseries import TimeSeries\n\n\ndef test_remove_required_column_error_message():\n    """\n    Test for a helpful error message when a required column is removed.\n\n    Regression test for a bug that caused a misleading ValueError when a\n    required column was removed from a TimeSeries. The error message should\n    clearly indicate which required column is missing.\n    """\n    time = Time(np.arange(100000, 100003), format=\'jd\')\n    ts = TimeSeries(time=time, data={"flux": [99.9, 99.8, 99.7]})\n    ts._required_columns = ["time", "flux"]\n    with pytest.raises(ValueError) as exc:\n        ts.remove_column("flux")\n    assert exc.value.args[0] == "TimeSeries object is invalid - required column \'flux\' is missing"\n```' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 15384, 'candidates_token_count': 229, 'total_token_count': 18029, 'prompt_tokens_details': [{'modality': 1, 'token_count': 15384}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 229}], 'thoughts_token_count': 2416, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -1.598954646347912, 'model_name': 'gemini-2.5-pro'} id='run--8d413abe-fb75-4088-9d66-7d2a42e87fbd-0' usage_metadata={'input_tokens': 15384, 'output_tokens': 229, 'total_tokens': 18029, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 2416}}
2025-10-04 06:09:18,995 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'create_file', 'arguments': '{"content": "import pytest\\nimport numpy as np\\nfrom astropy.time import Time\\nfrom astropy.timeseries import TimeSeries\\n\\n\\ndef test_remove_required_column_error_message():\\n    \\"\\"\\"\\n    Test for a helpful error message when a required column is removed.\\n\\n    Regression test for a bug that caused a misleading ValueError when a\\n    required column was removed from a TimeSeries. The error message should\\n    clearly indicate which required column is missing.\\n    \\"\\"\\"\\n    time = Time(np.arange(100000, 100003), format=\'jd\')\\n    ts = TimeSeries(time=time, data={\\"flux\\": [99.9, 99.8, 99.7]})\\n    ts._required_columns = [\\"time\\", \\"flux\\"]\\n    with pytest.raises(ValueError) as exc:\\n        ts.remove_column(\\"flux\\")\\n    assert exc.value.args[0] == \\"TimeSeries object is invalid - required column \'flux\' is missing\\"\\n", "relative_path": "astropy/timeseries/tests/test_core.py"}'}, '__gemini_function_call_thought_signatures__': {'d8843e81-b16f-443a-b0c9-e915a01454f9': 'CpIVAR/MhbaXs8heaNWLBMG9UKLcxJ9hX7Kt+xzVDh5G0FD5imL3Bb64a1JAumDPB5J0UU8tyqhK1fphtpTl+raulllf2MWgbBo0zpgctzr1HhqZLlcr20M+DLENBVFDAyvjNQEBa8MnE2FsiK6E2badXzX90xdKul75HEL+A8lsOd+3m/fGb86Zi1KEir51HmUooYz5PyNGDDzaLyW0V1AlHnKivj2gUhV9B3Onvd4FK5jM7GYFy1Dm5DsQSpNgIk/GTYjrwk2soPb21Z0MIBt9mVtbhKDAJ1qVODADVQhcyB3lZzy31hgZPRO9Cm1NvBMbMMCbUEOllhZnP1B186OzE4v3s7Hp0/ETjBxrIGVKP55dneNDsoy3JeVl2dB/FT8tN2YfpkxTn9HijdSZPmDFm74ViiIBbkZRn/Ax8X5m+pQKCgadeHt2NridSlwwm5kQnxhe3Ogakwa1g1iQ/VS7xAddBC0OVmQ+7Vp7PPJS/+tSfUAr454daiApqTBwD5JgFNojib/bFYYw6A9clClrHwm6ZL/j8bUQB/pMjXxo9DMCW90PJM2JycM8/ZjfV4ruKtb4GMw36RLCkVECaauiGqFoc8xl6fcnJfDNPaM6zJ26NM6eqZ9Wcb/xVzdubyjegYMWpf+TGzDleEiaccOVG8tyh73JUIhDqLYyDltEy58sxWkzWsGO7MsBWiuQImX3e4DmiLkkwg9ylYWz+iMJ3QptOAMZJxKtPosizHJK18wln3yFpK2wtSuqlQvI+hTWbsLNa09NjCQ7tcH/25oCjUsT2OJ7RF+v2cSBwBgwiyuSyC96UE8u3Zap4sVDmgy+dUHUxXwGYYfaBJysZqQbiQ2WMXafFskDL9cQwjWM1ZcUIMCq0bvMLOnltmSvaY04JaldKY/jo4xdZokw/FxeDVm+J9CNa6x9vJD9XHSnIZQvURBL9oRA7Muq/isnRBJbIuXPelVECa66j2msuUQ2HvZR+9lhVGE6FPY81zAJJh4MNy12r4PADmwIU2CAd0DdMFeJpP67Z4w6jPRm7KBKaiKfZhd9D6yfT3h5alXNxwxkf+ZEHiSu2OQDQrkSuf1I5lAWQsp2svtEvoFrvjsUxczDA8famiWcMrfXlYbrOJTCKInCrDnJ0NYpCoi/1TioywRZufJhdzU2QLaZUSKXpZ3bgaJ68wWIowU4Dmo++NNQHzvcl+Jd1HapAkw/Vlfj5lZfpWyDqfHxOdatjQqjxnZ8P35ZxPVgGfJZz1a/Vpp5Xe+jmTn+6o22YLIMsxRemdMArdbYVHEiXFJQdQEZrxq12tfe+IA0fQWkGH0quAgBtWKRE9O/T9rBM/ij7f9B6ryQpLungLDffuKb7XwBO4pydfwgeEtF+gWmSV2lOZ4B4WYcOtFyYwV8L7qdatQEKt6hGB2OIOgTLdMzMWfcHwhGoiZVdFYRHCL5+Dqv6HSdzCG44JYpI2FGymc/OakgNBI97e1AwFsEI+1YfDfgyB2NPfRRoekQ9No504AkvD7zreCDcvxmztqIkh3bGRRs2RL2a6yWzd/NpOUs82cofUKeapf4lIy147JR5N1wpgvQ2RjI3MTwkLyf3pzGRdTcJJuyxh/lt0J8n98Ga/yk7EFP9Wce4tXLPhFqSF8VHmB0r8+lFZ1vRIQZc05nHFq+oKQl1bhI14VTGzlfNkKKCfmsoNqtNJT8owEpHUvSTj942JQxXIQtd0GndWFIMIwSUaiJKYCWjL7/rx2GiqNuOy8KEuWX7BGDGtykPpYaNGxCBwM7vJ4gq2k1LaqZ7OOBMU+9KLPfjFZqB4OuYlPq5Ssn6iClvBPEiK43gEh9XOEVY5gC3CF3B7XZKlFZ0VkbBO7II+4Ygx3RvTUW1zQwaOeh3PiVgyn89PwvwaW0KFPec7FUZ9C4IVSYITb3aAtf4idJA/wYJ9ZNSBGJVlxKRZmzngGnmPhkWUnyUICNuF3XnHM+YKwdNuE6PR0+ZRaqKY7sRqlbAkyWXhkNE/rUDkMoZZO7ecvBKFCsMM5tSUPqOqRFqq/2kYRTt3i6MsAa1lsuJ/xvgDEdtKe2hCZAlUzAjSBAGYw+Hqsi9a0rJNejXEL8+dcAVJbsL0n/UU8BLr11UoxCuY/P5gmD2cB/ZzwVmiTYi3RxFXP8BhpGHkBP2g266QFq+W9hGikFBi7dtXbuymRbMfZVKD5cKAvuhRitHUHW98sgNckBqIZnqi/ApC6TQQhBFYMuEhjUonzUp96DgAUpeTNKIbnKaObZiHK1/GBUA8kXhFforivetp4zplEyyTAIs/8ozX3OqR8hIMSJJ+AD67OqS8rp23hz7WAUziDvJRj6Zbqy2iPbLfokK+EMnC2nfKB5U1K8ri3Jaaa3QYsvsuHS0DUVFTDIoZtjqJvj1YAaO9FG5AYjNiR1DcHLYykNckbvvQYM3pAT+WId9mwto9fSCekcEXhtCahyFD/DqalsdTxG5eLRtdjxy1CSULJJgs9KDlfA46nkRCAaHF6HfPBt+lOX7L8FUvKeNXhf3sUDratmU9Se9uRjOBmbLzyLVEzva8RebLA4FyUa0wRb0CzTgEuK+MpX5BIAz6/LgnvOHNxyAdTG+cUkI4d65MSrv8DhJ3r5HHdnfAvuhHnrWkzFaAg2LiqY66J9Cls1e2abb+h4srnV8jZrGzBiy9cqQF64jGdQrdrALg7t/CzcjM+UPj54HatnuUsRL7v6WbYQreXZGdfUHnw+lZPeVTCKmmWK2Q8dBJETmI0Qv8TJRPgB+LNBOy9rIWmkBBygGo1o3SE7k/qoEIsID+HoOTZswlCxn/QSbzwYn61cwpWl9JDenXtjlQucWuKe4myDyCyX2MDi3+ifQ8a29Xn9mrMZC6KTcIpVwVYZm/JLF01/0MLYnYpC2DS/O+ae1dKTqRUryIBiuyCKn6X+MmXsrjjgR6nKDGBJqrN3IiWMScVg5e+WoMQnWn7WnAm1NpTWwq/jyIg6GbjLUv73E33YRVVziED59OyPLWGb4qFGp2/4TO/oQZeYTcwA73KgA0lqi2eW8KsLKxmAi6zTXpPe/uGn3CYg2n6tJ1kBHZE9SyuATnEMWH0YdFjTsfuiq+r3Uc+l3a2/seYIlCZLwNYuDdRZK0wjhIK8DtucIZbsFN1mmE+4WCZhfHESwLpS6Te8ruOvSbLqYpdwYGGUUPAerjoAcXubK2DUOo+JpJ/pmqCx8n4+hXVAgjlBRYL+eIkLxpVCzDSJ61CO4NCWMmafaMFfZjJU9Tn0CxxmjpqjSuEIfeJ9n7AzjkxTLcmZbuqd3GFck7yrs/p5A3frUMyxbpZ9snDAF4aio6XSlseF283Kpxl+VEZpq8X7vPp7ngLsS52hv1NU0qZu1oOTKqNY+DIXLAvNqlQX1Qmh5ghow+7hvpylC8mvKNbtqRure8cV9l4/A7QjftzmOkfX2NDfZMeZe124gtFNkr7STsGTU0SaYwDdKkkimVjSt/A0vnj22cNJMGa5SeyeeN14Jh50+TslyfDWebFVSPDzko2fv2VgL7AB9eZx7GkNyQFLHSTEeT05Aq635yeWWM+2aW2gRhkMi5T2VYAHpKwDwkU2/EA4HDsT3C28B8OJl+7m'}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 17980, 'candidates_token_count': 245, 'total_token_count': 18973, 'prompt_tokens_details': [{'modality': 1, 'token_count': 17980}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 245}], 'thoughts_token_count': 748, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.33140554622727997, 'model_name': 'gemini-2.5-pro'} id='run--203fdd0b-0c1c-4dc7-a4b7-7e56f2f57112-0' tool_calls=[{'name': 'create_file', 'args': {'content': 'import pytest\nimport numpy as np\nfrom astropy.time import Time\nfrom astropy.timeseries import TimeSeries\n\n\ndef test_remove_required_column_error_message():\n    """\n    Test for a helpful error message when a required column is removed.\n\n    Regression test for a bug that caused a misleading ValueError when a\n    required column was removed from a TimeSeries. The error message should\n    clearly indicate which required column is missing.\n    """\n    time = Time(np.arange(100000, 100003), format=\'jd\')\n    ts = TimeSeries(time=time, data={"flux": [99.9, 99.8, 99.7]})\n    ts._required_columns = ["time", "flux"]\n    with pytest.raises(ValueError) as exc:\n        ts.remove_column("flux")\n    assert exc.value.args[0] == "TimeSeries object is invalid - required column \'flux\' is missing"\n', 'relative_path': 'astropy/timeseries/tests/test_core.py'}, 'id': 'd8843e81-b16f-443a-b0c9-e915a01454f9', 'type': 'tool_call'}] usage_metadata={'input_tokens': 17980, 'output_tokens': 245, 'total_tokens': 18973, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 748}}
2025-10-04 06:09:20,567 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_file_node - DEBUG - content='astropy/timeseries/tests/test_core.py' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 18248, 'candidates_token_count': 13, 'total_token_count': 18261, 'cached_content_token_count': 17871, 'prompt_tokens_details': [{'modality': 1, 'token_count': 18994}], 'cache_tokens_details': [{'modality': 1, 'token_count': 17871}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 13}], 'thoughts_token_count': 0}, 'finish_reason': 'STOP', 'avg_logprobs': -1.1433624492313425e-05, 'model_name': 'gemini-2.5-pro'} id='run--f46fc286-ac6c-4cd8-bd24-57cb784ae72d-0' usage_metadata={'input_tokens': 18248, 'output_tokens': 13, 'total_tokens': 18261, 'input_token_details': {'cache_read': 17871}}
2025-10-04 06:09:20,669 - thread-139911184823872.app.lang_graph.nodes.git_diff_node - INFO - Generated patch:
diff --git a/astropy/timeseries/tests/test_core.py b/astropy/timeseries/tests/test_core.py
new file mode 100644
index 0000000000..164d7c5568
--- /dev/null
+++ b/astropy/timeseries/tests/test_core.py
@@ -0,0 +1,20 @@
+import pytest
+import numpy as np
+from astropy.time import Time
+from astropy.timeseries import TimeSeries
+
+
+def test_remove_required_column_error_message():
+    """
+    Test for a helpful error message when a required column is removed.
+
+    Regression test for a bug that caused a misleading ValueError when a
+    required column was removed from a TimeSeries. The error message should
+    clearly indicate which required column is missing.
+    """
+    time = Time(np.arange(100000, 100003), format='jd')
+    ts = TimeSeries(time=time, data={"flux": [99.9, 99.8, 99.7]})
+    ts._required_columns = ["time", "flux"]
+    with pytest.raises(ValueError) as exc:
+        ts.remove_column("flux")
+    assert exc.value.args[0] == "TimeSeries object is invalid - required column 'flux' is missing"

2025-10-04 06:09:20,670 - thread-139911184823872.app.lang_graph.nodes.update_container_node - INFO - Copy over all updated files to the container
2025-10-04 06:09:20,683 - thread-139911184823872.app.docker.base_container - INFO - Resetting git repository in the container
2025-10-04 06:09:20,683 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: git reset --hard
2025-10-04 06:09:20,784 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:09:20,784 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:

HEAD is now at 298ccb478e Merge pull request #13031 from meeseeksmachine/auto-backport-of-pr-13027-on-main

2025-10-04 06:09:20,784 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: git clean -fd
2025-10-04 06:09:20,885 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:09:20,885 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:


2025-10-04 06:09:20,885 - thread-139911184823872.app.docker.base_container - INFO - Updating files in the container after edits.
2025-10-04 06:09:20,885 - thread-139911184823872.app.docker.base_container - INFO - Creating directory astropy/timeseries/tests in the container
2025-10-04 06:09:20,885 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: mkdir -p astropy/timeseries/tests
2025-10-04 06:09:20,986 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 0
2025-10-04 06:09:20,986 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
mkdir -p astropy/timeseries/test
ts


2025-10-04 06:09:20,986 - thread-139911184823872.app.docker.base_container - INFO - Updating astropy/timeseries/tests/test_core.py in the container
2025-10-04 06:09:20,989 - thread-139911184823872.app.docker.base_container - INFO - Files updated successfully
2025-10-04 06:09:26,779 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='' additional_kwargs={'function_call': {'name': 'run_command', 'arguments': '{"command": "pytest astropy/timeseries/tests/test_core.py"}'}, '__gemini_function_call_thought_signatures__': {'0aac3726-84f9-4ff3-80bc-624e93dbea42': 'CtMKAR/MhbYJ0MGT+878M1JZ72owtEmj6lCYhSfcmmgs3pyGEecVH2aw1RQWv3qrkErggIS2vqpVvC7z41/yvqUbFj1SG/DYe0vv9O/o39tY1s3d/czggY623R+qNRzwTWqXfxIxmuHj8wj/ZIvOygIJiTQWAlxne+d53ZMY7SYhhSw5KfKUqaPCC19Relq+Y6BwZtbKycv2OArB3FJrWYHBBjvjA7AjbdMBNuMxkXeGmk2tcq4qL24PBPvu4NR3hbWYVFJOKfEVUsXTVa5i69gaLO5jfJd6eJI/hOGVRovQnTX0VAoUhJfueAI3NWDrOtsWp4reCetFUUelH0ZMwbabJQM5hJUYW75xPIskd3dLE86hGLA+WlPZEfapoDDxAoPXMW54l+E3CNmxG2tk8nh9D3PS/FFAu8xeHowmKeuNwO+Z/dJElL/29HByOH9F7bnE5uw4JpZjANuyd7uVLjRHERIOwLKMaVy7fJObqPaPiNfZE9C8FQ2pE3TIg/p59PXEmgZOoO4+hBqY+Jf3DtocJh8TUc+QkwwMg75Cf8DjjzERJccL2Im2ycAeZxpeGiwJlnz3PT4SyZrVwOUo2Z6OsoBExgKR0v8jthBByR8lwgLhU3Emf5urpJSMCX+DsEz69RoF7NsHS7PTCD2sh06cY3QmrizKfFVrSJYlkUWIHlpqVGMHWA7ma3BJy615fvhTaJVEl1CymaLE7bKkMvGJU3ZX6g2rkT88N42RkKKTfmH3DECAroDcucyxLK2MlI6PjlccVLhnOu9JWy0dVPNPHroccUpp8JA9KFaFSe7KTyAH7W39tDv0cBvhNCOEoDrqubY6ocm4368KznHoVfj+hbFR/3QwCn7Dv4/kqf6JIhwF1vAhLixfizW4cfGCDaMlBeRchedzkRr63MMudz8k4XhCG8AIz+gecWU1kyTWbAQEQ9IYRrw0ZrVxHKsJFXmeVJtUZrgr273L/l1DjFg1K1GuehF4/bT4L+NeMVxN5DGQCVuOuA/vS2o2g9Fo5+s+PypErsb8my6/Kvrdx3CzXDr9sY3llV/jHSt3bjRZ4+K6PSf/8tUrQgTr/1EBWHE2hUh4uuqEphSfBpC/Tntb9iKNCkHofALXQ+7WL6TCkaG+97tJ3Tr3lmsH6DyIboNj5IQyhvNJ8qOZflNstpkDQXeFrxp0uHvbpCYaooCIDzNSlOS0kPzGO4saK4PYnuwVfjcTV0AGFEWdr7OZRhbWBokqFyrvDmZ9GL6xeP+ii9A3Y8xKRMVP4dN5mcTWru+H6BUNN9It3G3ZMSO0lZ0HLDzAlCRDKnXIg3Z2g+gKUnsAsYVQmhpuLg1k9jrlhaNj5R7tCSfoVcgn31pTrCHLYBKQd5ieHSzt6WmWXGpCOqM06TyVAmiz3LUYRu7J5AnueldWDNRoE+OKf0GRohfTohvlrNObmvMqZKA0bivvW2q2QeDMp0gwVZh/lxPYTMZucUInI20kGLd+FSKVFgiMtbK0PP3tCIxHxXUDhmTzH+ZBYcJlah5xfBn59o3LWuKNzOJLxkPN49jsFs7S4f0H1r0SyK1WPhCTSAhLaAUCUsRhARq/buDk9gKFbKTbHht2TuBwobZQop+dNVvMWHpkQKgi5fE7x1Nht4ODZ/DeiRlxtYTzmBYg7QceDYgX2aAbsu+Vkkx0/1dCjV8oQS54SsfaD4OZjw+Ls0xcDkdGs2ZRHMsOgsn411C9QG+H9Ms5gLqyVM1Z7R52t+LkAVWcftvNJWFhlEp8smWcd7lFfJNZfByIbhwI//+ffzxVLNh57Xorfe4YFyWsD9daQs5lMX7sQA=='}} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 976, 'candidates_token_count': 18, 'total_token_count': 1339, 'prompt_tokens_details': [{'modality': 1, 'token_count': 976}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 18}], 'thoughts_token_count': 345, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -2.2311058044433594, 'model_name': 'gemini-2.5-pro'} id='run--18a9913f-929f-4fca-a6df-55021975570e-0' tool_calls=[{'name': 'run_command', 'args': {'command': 'pytest astropy/timeseries/tests/test_core.py'}, 'id': '0aac3726-84f9-4ff3-80bc-624e93dbea42', 'type': 'tool_call'}] usage_metadata={'input_tokens': 976, 'output_tokens': 18, 'total_tokens': 1339, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 345}}
2025-10-04 06:09:26,780 - thread-139911184823872.app.docker.base_container - DEBUG - Executing command: pytest astropy/timeseries/tests/test_core.py
2025-10-04 06:09:27,918 - thread-139911184823872.app.docker.base_container - DEBUG - Command exit code: 1
2025-10-04 06:09:27,918 - thread-139911184823872.app.docker.base_container - DEBUG - Command output:
pytest astropy/timeseries/tests/
/test_core.py

<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0

Running tests with Astropy version 5.1.dev761+g298ccb478.d20251003.
Running tests in astropy/timeseries/tests/test_core.py.

Date: 2025-10-03T22:09:27

Platform: Linux-5.15.0-142-generic-x86_64-with-glibc2.35

Executable: /opt/miniconda3/envs/testbed/bin/python

Full Python Version: 
3.9.20 (main, Oct  3 2024, 07:27:41) 
[GCC 11.2.0]

encodings: sys: utf-8, locale: UTF-8, filesystem: utf-8
byteorder: little
float info: dig: 15, mant_dig: 15

Package versions: 
Numpy: 1.25.2
Scipy: not available
Matplotlib: not available
h5py: not available
Pandas: not available
PyERFA: 2.0.0.3
Cython: not available
Scikit-image: not available
asdf: not available
pyarrow: not available

Using Astropy options: remote_data: none.

ARCH_ON_CI: undefined
IS_CRON: undefined

rootdir: /testbed
configfile: setup.cfg
plugins: filter-subpackage-0.1.2, openfiles-0.5.0, cov-4.1.0, arraydiff-0.5.0, remotedata-0.4.0, xdist-3.3.1, astropy-header-0.2.2, astropy-0.10.0, hypothesis-6.82.6, mock-3.11.1, doctestplus-1.0.0
[1mcollecting ... [0m[1m
collected 1 item                                                               [0m

astropy/timeseries/tests/test_core.py [31mF[0m[31m                                  [100%][0m

=================================== FAILURES ===================================
[31m[1m__________________ test_remove_required_column_error_message ___________________[0m

    def test_remove_required_column_error_message():
        """
        Test for a helpful error message when a required column is removed.
    
        Regression test for a bug that caused a misleading ValueError when a
        required column was removed from a TimeSeries. The error message should
        clearly indicate which required column is missing.
        """
        time = Time(np.arange(100000, 100003), format='jd')
        ts = TimeSeries(time=time, data={"flux": [99.9, 99.8, 99.7]})
        ts._required_columns = ["time", "flux"]
        with pytest.raises(ValueError) as exc:
            ts.remove_column("flux")
>       assert exc.value.args[0] == "TimeSeries object is invalid - required column 'flux' is missing"
[1m[31mE       assert "TimeSeries o... found 'time'" == "TimeSeries o...x' is missing"[0m
[1m[31mE         - TimeSeries object is invalid - required column 'flux' is missing[0m
[1m[31mE         + TimeSeries object is invalid - expected 'time' as the first columns but found 'time'[0m

[1m[31mastropy/timeseries/tests/test_core.py[0m:20: AssertionError
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m astropy/timeseries/tests/test_core.py::[1mtest_remove_required_column_error_message[0m - assert "TimeSeries o... found 'time'" == "TimeSeries o...x' is missing"
[31m============================== [31m[1m1 failed[0m[31m in 0.04s[0m[31m ===============================[0m

2025-10-04 06:09:37,563 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_execute_node - DEBUG - content='pytest astropy/timeseries/tests/test_core.py\n\n<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.1.dev761+g298ccb478.d20251003.\nRunning tests in astropy/timeseries/tests/test_core.py.\n\nDate: 2025-10-03T22:09:27\n\nPlatform: Linux-5.15.0-142-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: filter-subpackage-0.1.2, openfiles-0.5.0, cov-4.1.0, arraydiff-0.5.0, remotedata-0.4.0, xdist-3.3.1, astropy-header-0.2.2, astropy-0.10.0, hypothesis-6.82.6, mock-3.11.1, doctestplus-1.0.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/timeseries/tests/test_core.py F                                  [100%]\n\n=================================== FAILURES ===================================\n__________________ test_remove_required_column_error_message ___________________\n\n    def test_remove_required_column_error_message():\n        """\n        Test for a helpful error message when a required column is removed.\n    \n        Regression test for a bug that caused a misleading ValueError when a\n        required column was removed from a TimeSeries. The error message should\n        clearly indicate which required column is missing.\n        """\n        time = Time(np.arange(100000, 100003), format=\'jd\')\n        ts = TimeSeries(time=time, data={"flux": [99.9, 99.8, 99.7]})\n        ts._required_columns = ["time", "flux"]\n        with pytest.raises(ValueError) as exc:\n            ts.remove_column("flux")\n>       assert exc.value.args[0] == "TimeSeries object is invalid - required column \'flux\' is missing"\nE       assert "TimeSeries o... found \'time\'" == "TimeSeries o...x\' is missing"\nE         - TimeSeries object is invalid - required column \'flux\' is missing\nE         + TimeSeries object is invalid - expected \'time\' as the first columns but found \'time\'\n\nastropy/timeseries/tests/test_core.py:20: AssertionError\n=========================== short test summary info ============================\nFAILED astropy/timeseries/tests/test_core.py::test_remove_required_column_error_message - assert "TimeSeries o... found \'time\'" == "TimeSeries o...x\' is missing"\n============================== 1 failed in 0.04s ===============================' additional_kwargs={} response_metadata={'is_blocked': False, 'safety_ratings': [], 'usage_metadata': {'prompt_token_count': 2132, 'candidates_token_count': 958, 'total_token_count': 3131, 'prompt_tokens_details': [{'modality': 1, 'token_count': 2475}], 'candidates_tokens_details': [{'modality': 1, 'token_count': 958}], 'thoughts_token_count': 41, 'cached_content_token_count': 0, 'cache_tokens_details': []}, 'finish_reason': 'STOP', 'avg_logprobs': -0.012485241342437043, 'model_name': 'gemini-2.5-pro'} id='run--bdbbe63d-5ddf-4421-af09-95656f9e869b-0' usage_metadata={'input_tokens': 2132, 'output_tokens': 958, 'total_tokens': 3131, 'input_token_details': {'cache_read': 0}, 'output_token_details': {'reasoning': 41}}
2025-10-04 06:09:59,104 - thread-139911184823872.app.lang_graph.nodes.bug_reproducing_structured_node - DEBUG - reproduced_bug=True reproduced_bug_failure_log='pytest astropy/timeseries/tests/\n/test_core.py\n\n<frozen importlib._bootstrap>:228: RuntimeWarning: numpy.ndarray size changed, may indicate binary incompatibility. Expected 80 from C header, got 96 from PyObject\n============================= test session starts ==============================\nplatform linux -- Python 3.9.20, pytest-7.4.0, pluggy-1.3.0\n\nRunning tests with Astropy version 5.1.dev761+g298ccb478.d20251003.\nRunning tests in astropy/timeseries/tests/test_core.py.\n\nDate: 2025-10-03T22:09:27\n\nPlatform: Linux-5.15.0-142-generic-x86_64-with-glibc2.35\n\nExecutable: /opt/miniconda3/envs/testbed/bin/python\n\nFull Python Version: \n3.9.20 (main, Oct  3 2024, 07:27:41) \n[GCC 11.2.0]\n\nencodings: sys: utf-8, locale: UTF-8, filesystem: utf-8\nbyteorder: little\nfloat info: dig: 15, mant_dig: 15\n\nPackage versions: \nNumpy: 1.25.2\nScipy: not available\nMatplotlib: not available\nh5py: not available\nPandas: not available\nPyERFA: 2.0.0.3\nCython: not available\nScikit-image: not available\nasdf: not available\npyarrow: not available\n\nUsing Astropy options: remote_data: none.\n\nARCH_ON_CI: undefined\nIS_CRON: undefined\n\nrootdir: /testbed\nconfigfile: setup.cfg\nplugins: filter-subpackage-0.1.2, openfiles-0.5.0, cov-4.1.0, arraydiff-0.5.0, remotedata-0.4.0, xdist-3.3.1, astropy-header-0.2.2, astropy-0.10.0, hypothesis-6.82.6, mock-3.11.1, doctestplus-1.0.0\ncollecting ... \ncollected 1 item                                                               \n\nastropy/timeseries/tests/test_core.py F                                  [100%]\n\n=================================== FAILURES ===================================\n__________________ test_remove_required_column_error_message ___________________\n\n    def test_remove_required_column_error_message():\n        """\n        Test for a helpful error message when a required column is removed.\n    \n        Regression test for a bug that caused a misleading ValueError when a\n        required column was removed from a TimeSeries. The error message should\n        clearly indicate which required column is missing.\n        """\n        time = Time(np.arange(100000, 100003), format=\'jd\')\n        ts = TimeSeries(time=time, data={"flux": [99.9, 99.8, 99.7]})\n        ts._required_columns = ["time", "flux"]\n        with pytest.raises(ValueError) as exc:\n            ts.remove_column("flux")\n>       assert exc.value.args[0] == "TimeSeries object is invalid - required column \'flux\' is missing"\nE       assert "TimeSeries o... found \'time\'" == "TimeSeries o...x\' is missing"\nE         - TimeSeries object is invalid - required column \'flux\' is missing\nE         + TimeSeries object is invalid - expected \'time\' as the first columns but found \'time\'\n\nastropy/timeseries/tests/test_core.py:20: AssertionError\n=========================== short test summary info ============================\nFAILED astropy/timeseries/tests/test_core.py::test_remove_required_column_error_message - assert "TimeSeries o... found \'time\'" == "TimeSeries o...x\' is missing"\n============================== 1 failed in 0.04s ===============================' reproduced_bug_commands=['pytest astropy/timeseries/tests/test_core.py']
2025-10-04 06:09:59,105 - thread-139911184823872.app.docker.base_container - INFO - Cleaning up container and temporary files
2025-10-04 06:09:59,105 - thread-139911184823872.app.docker.base_container - INFO - Closing persistent shell...
2025-10-04 06:09:59,206 - thread-139911184823872.app.docker.base_container - INFO - Cleaning up container and temporary files
